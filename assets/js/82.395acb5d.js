(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{562:function(s,a,t){"use strict";t.r(a);var n=t(20),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("应用部署需要关注的信息【应用部署三要素】")]),s._v(" "),t("ul",[t("li",[t("ol",[t("li",[s._v("应用的部署方式（Deployment、StatefulSet、DaemonSet）")])])]),s._v(" "),t("li",[t("ol",{attrs:{start:"2"}},[t("li",[s._v("应用的数据挂载（数据，配置文件）")])])]),s._v(" "),t("li",[t("ol",{attrs:{start:"3"}},[t("li",[s._v("应用的可访问性")])])])]),s._v(" "),t("blockquote",[t("p",[s._v("ConfigMap用来配置配置文件，可以配置多个key-value，key就是配置文件名，value就是配置文件的内容")])]),s._v(" "),t("h1",{attrs:{id:""}},[t("a",{staticClass:"header-anchor",attrs:{href:"#"}},[s._v("#")]),s._v(" "),t("img",{attrs:{src:"https://code-starter-1302897259.cos.ap-beijing.myqcloud.com/image/1631603837148-120309a6-5fac-4467-a585-eb8971c7640f.png",alt:"img"}})]),s._v(" "),t("h1",{attrs:{id:"_1-部署mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-部署mysql"}},[s._v("#")]),s._v(" 1. 部署MySQL")]),s._v(" "),t("h2",{attrs:{id:"_1-mysql容器启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-mysql容器启动"}},[s._v("#")]),s._v(" 1. mysql容器启动")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 --name mysql-01 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /mydata/mysql/log:/var/log/mysql "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /mydata/mysql/data:/var/lib/mysql "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /mydata/mysql/conf:/etc/mysql/conf.d "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--restart"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-d mysql:5.7 \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"_2-mysql配置示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-mysql配置示例"}},[s._v("#")]),s._v(" 2. mysql配置示例")]),s._v(" "),t("div",{staticClass:"language-plain line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-plain"}},[t("code",[s._v("[client]\ndefault-character-set=utf8mb4\n \n[mysql]\ndefault-character-set=utf8mb4\n \n[mysqld]\ninit_connect='SET collation_connection = utf8mb4_unicode_ci'\ninit_connect='SET NAMES utf8mb4'\ncharacter-set-server=utf8mb4\ncollation-server=utf8mb4_unicode_ci\nskip-character-set-client-handshake\nskip-name-resolve\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h2",{attrs:{id:"_3-mysql部署分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-mysql部署分析"}},[s._v("#")]),s._v(" 3. mysql部署分析")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://code-starter-1302897259.cos.ap-beijing.myqcloud.com/image/1631544800244-cd4ed8a8-06d0-40bc-9752-dd0ba9df325c.png",alt:"img"}})]),s._v(" "),t("ol",[t("li",[s._v("集群内部，直接通过应用的  【服务名.项目名】 直接访问")])]),s._v(" "),t("p",[s._v("​        mysql -uroot -h"),t("strong",[s._v("his-mysql-glgf.his")]),s._v(" -p")]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("集群外部，")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://code-starter-1302897259.cos.ap-beijing.myqcloud.com/image/1631621925918-a87cc4f8-be27-4d76-aafb-f47e32c692b3.png",alt:"img"}})]),s._v(" "),t("h1",{attrs:{id:"_2-部署redis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-部署redis"}},[s._v("#")]),s._v(" 2. 部署Redis")]),s._v(" "),t("h2",{attrs:{id:"_1-redis容器启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-redis容器启动"}},[s._v("#")]),s._v(" 1. redis容器启动")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建配置文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 1. 准备redis配置文件内容")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /mydata/redis/conf "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /mydata/redis/conf/redis.conf\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##配置示例")]),s._v("\nappendonly "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\nport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker启动redis")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 --restart"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /mydata/redis/conf/redis.conf:/etc/redis/redis.conf "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v  /mydata/redis-01/data:/data "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n --name redis-01 redis:6.2.5 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n redis-server /etc/redis/redis.conf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h2",{attrs:{id:"_2-redis部署分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-redis部署分析"}},[s._v("#")]),s._v(" 2. redis部署分析")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://code-starter-1302897259.cos.ap-beijing.myqcloud.com/image/1631610241479-a4dc9586-872d-49ef-95a0-2d0116c9b9ed.png",alt:"img"}})]),s._v(" "),t("h1",{attrs:{id:"_3-部署elasticsearch"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-部署elasticsearch"}},[s._v("#")]),s._v(" 3. 部署ElasticSearch")]),s._v(" "),t("h2",{attrs:{id:"_1-es容器启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-es容器启动"}},[s._v("#")]),s._v(" 1. es容器启动")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建数据目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /mydata/es-01 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" -R /mydata/es-01\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 容器启动")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --restart"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always -d -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v(":9200 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9300")]),s._v(":9300 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovery.type=single-node"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ES_JAVA_OPTS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-Xms512m -Xmx512m"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v es-config:/usr/share/elasticsearch/config "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /mydata/es-01/data:/usr/share/elasticsearch/data "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--name es-01 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nelasticsearch:7.13.4\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h2",{attrs:{id:"_2-es部署分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-es部署分析"}},[s._v("#")]),s._v(" 2. es部署分析")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://code-starter-1302897259.cos.ap-beijing.myqcloud.com/image/1631609524580-f264a6dc-e619-4843-a717-b8852716785d.png",alt:"img"}})]),s._v(" "),t("p",[s._v("注意： 子路径挂载，配置修改后，k8s不会对其Pod内的相关配置文件进行热更新，需要自己重启Pod")]),s._v(" "),t("h1",{attrs:{id:"_4-应用商店"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-应用商店"}},[s._v("#")]),s._v(" 4. 应用商店")]),s._v(" "),t("p",[s._v("可以使用 dev-zhao 登录，从应用商店部署")]),s._v(" "),t("h1",{attrs:{id:"_5-应用仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-应用仓库"}},[s._v("#")]),s._v(" 5. 应用仓库")]),s._v(" "),t("p",[s._v("使用企业空间管理员（wuhan-boss）登录，设置应用仓库")]),s._v(" "),t("p",[s._v("学习Helm即可，去helm的应用市场添加一个仓库地址，比如：bitnami")]),s._v(" "),t("p",[s._v("在这里，我们不涉及高可用部署相关内容。想了解详情，可以关注后续的课程，或者"),t("a",{attrs:{href:"https://www.itdachang.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("大厂学苑"),t("OutboundLink")],1),s._v(" 《拥抱云原生》专题")])])}),[],!1,null,null,null);a.default=e.exports}}]);