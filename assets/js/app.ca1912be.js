(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[]]);!function(n){function e(e){for(var r,i,s=e[0],l=e[1],c=e[2],d=0,p=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(n[r]=l[r]);for(u&&u(e);p.length;)p.shift()();return a.push.apply(a,c||[]),t()}function t(){for(var n,e=0;e<a.length;e++){for(var t=a[e],r=!0,s=1;s<t.length;s++){var l=t[s];0!==o[l]&&(r=!1)}r&&(a.splice(e--,1),n=i(i.s=t[0]))}return n}var r={},o={1:0},a=[];function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.e=function(n){var e=[],t=o[n];if(0!==t)if(t)e.push(t[2]);else{var r=new Promise((function(e,r){t=o[n]=[e,r]}));e.push(t[2]=r);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(n){return i.p+"assets/js/"+({}[n]||n)+"."+{2:"37ecbe42",3:"a94bca7d",4:"3c076cc1",5:"3dee0b9e",6:"0dcf2416",7:"a75b65b8",8:"582cb1a2",9:"f40f686d",10:"2ad00bc5",11:"e24d2f56",12:"3a27f131",13:"b6c6f6ed",14:"1383a07d",15:"6dce59fe",16:"cc0de160",17:"21cffd14",18:"412c079a",19:"f7ec127c",20:"ee23c0a2",21:"6996f638",22:"fb5cb604",23:"9a79f539",24:"c4098bb2",25:"26896566",26:"b3b7b1f8",27:"2f4919b8",28:"41ce159e",29:"857c5a00",30:"73ac0d38",31:"e96f7fa9",32:"f0d079fc",33:"57ada703",34:"8ef1ee2e",35:"0172bc08",36:"8b609cff",37:"05a3472a",38:"8fc94eac",39:"1364ec49",40:"642118ec",41:"b73ba281",42:"3d43de4e",43:"7c72be71",44:"e6fd7e4c",45:"80270188",46:"20881084",47:"975d4d88",48:"74b7de4e",49:"badbc0fd",50:"4c105fff",51:"25618f4f",52:"24235da6",53:"bac66d66",54:"117a0bb3",55:"0829c544",56:"684c301f",57:"5c65fff0",58:"361747fe",59:"99e7433b",60:"db51bb23",61:"c9388467",62:"73be41ca",63:"42267e85",64:"6e55cf49",65:"7bd0e226",66:"46825ce5",67:"e276ad2d",68:"9e00518b",69:"d03e9c5a",70:"a448d15a",71:"b4778cbc",72:"7663bb72",73:"35693a6f",74:"6d9cec5f",75:"26a8fef6",76:"26904992",77:"089f5015",78:"825deb78",79:"8ac0a277",80:"35039c22",81:"527864c6",82:"3713630e",83:"d8654624",84:"ea03a364",85:"1169f938",86:"96946ce2",87:"6fb1e0a8",88:"db7ce45e",89:"ae4b6ca3",90:"1c88216c",91:"2e73462f",92:"965b6ed1",93:"494f97bf",94:"a9757aab",95:"3512cd58",96:"ca19c3ce",97:"1a66afdc",98:"e9e54416",99:"01a5f660",100:"cff83e16",101:"af5089f1",102:"81995db6",103:"c943a5f6",104:"ce2ad0f3",105:"1696773d",106:"a07ceca8",107:"bfb7f78f",108:"59f0a0d6",109:"1bf5c0bb",110:"cfe0a758",111:"62e94687",112:"d45fb7d0",113:"dc814acb",114:"b44a2b77",115:"4f2cc537",116:"eaceb24a",117:"85b5e167",118:"8af761ee",119:"1025fe9b",120:"1affad3e",121:"f1700b48",122:"3936e268",123:"7da9c65e",124:"8173a20f",125:"66c21c7b",126:"6fce0578",127:"a8c9a0a5",128:"b177933f",129:"fe4f9bc1",130:"02e75196",131:"09677d21",132:"508c2407",133:"1b66877a",134:"fd563475",135:"f384514b",136:"885853d4",137:"aee09014",138:"11973b09",139:"1d9322fe",140:"d75c01e5",141:"2c0d8203",142:"85455350",143:"9941bb73",144:"b8c6c02e",145:"83acaa33",146:"09c690f8",147:"1081f9ee",148:"4fefd78f"}[n]+".js"}(n);var l=new Error;a=function(e){s.onerror=s.onload=null,clearTimeout(c);var t=o[n];if(0!==t){if(t){var r=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;l.message="Loading chunk "+n+" failed.\n("+r+": "+a+")",l.name="ChunkLoadError",l.type=r,l.request=a,t[1](l)}o[n]=void 0}};var c=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(e)},i.m=n,i.c=r,i.d=function(n,e,t){i.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:t})},i.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},i.t=function(n,e){if(1&e&&(n=i(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var r in n)i.d(t,r,function(e){return n[e]}.bind(null,r));return t},i.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return i.d(e,"a",e),e},i.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},i.p="/",i.oe=function(n){throw console.error(n),n};var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=l;a.push([237,0]),t()}([function(n,e){var t=function(n){return n&&n.Math==Math&&n};n.exports=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof global&&global)||function(){return this}()||Function("return this")()},function(n,e,t){var r=t(0),o=t(38).f,a=t(27),i=t(14),s=t(112),l=t(119),c=t(105);n.exports=function(n,e){var t,u,d,p,m,f=n.target,h=n.global,g=n.stat;if(t=h?r:g?r[f]||s(f,{}):(r[f]||{}).prototype)for(u in e){if(p=e[u],d=n.noTargetGet?(m=o(t,u))&&m.value:t[u],!c(h?u:f+(g?".":"#")+u,n.forced)&&void 0!==d){if(typeof p==typeof d)continue;l(p,d)}(n.sham||d&&d.sham)&&a(p,"sham",!0),i(t,u,p,n)}}},function(n,e,t){var r=t(63),o=Function.prototype,a=o.bind,i=o.call,s=r&&a.bind(i,i);n.exports=r?function(n){return n&&s(n)}:function(n){return n&&function(){return i.apply(n,arguments)}}},function(n,e){n.exports=function(n){try{return!!n()}catch(n){return!0}}},function(n,e,t){var r=t(123),o=t(14),a=t(253);r||o(Object.prototype,"toString",a,{unsafe:!0})},function(n,e){n.exports=function(n){return"function"==typeof n}},function(n,e,t){var r=t(0),o=t(79),a=t(10),i=t(80),s=t(113),l=t(156),c=o("wks"),u=r.Symbol,d=u&&u.for,p=l?u:u&&u.withoutSetter||i;n.exports=function(n){if(!a(c,n)||!s&&"string"!=typeof c[n]){var e="Symbol."+n;s&&a(u,n)?c[n]=u[n]:c[n]=l&&d?d(e):p(e)}return c[n]}},function(n,e,t){var r=t(3);n.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(n,e,t){var r=t(0),o=t(9),a=r.String,i=r.TypeError;n.exports=function(n){if(o(n))return n;throw i(a(n)+" is not an object")}},function(n,e,t){var r=t(5);n.exports=function(n){return"object"==typeof n?null!==n:r(n)}},function(n,e,t){var r=t(2),o=t(15),a=r({}.hasOwnProperty);n.exports=Object.hasOwn||function(n,e){return a(o(n),e)}},function(n,e,t){var r=t(63),o=Function.prototype.call;n.exports=r?o.bind(o):function(){return o.apply(o,arguments)}},function(n,e,t){var r=t(0),o=t(76),a=r.String;n.exports=function(n){if("Symbol"===o(n))throw TypeError("Cannot convert a Symbol value to a string");return a(n)}},function(n,e,t){var r=t(0),o=t(7),a=t(158),i=t(157),s=t(8),l=t(82),c=r.TypeError,u=Object.defineProperty,d=Object.getOwnPropertyDescriptor;e.f=o?i?function(n,e,t){if(s(n),e=l(e),s(t),"function"==typeof n&&"prototype"===e&&"value"in t&&"writable"in t&&!t.writable){var r=d(n,e);r&&r.writable&&(n[e]=t.value,t={configurable:"configurable"in t?t.configurable:r.configurable,enumerable:"enumerable"in t?t.enumerable:r.enumerable,writable:!1})}return u(n,e,t)}:u:function(n,e,t){if(s(n),e=l(e),s(t),a)try{return u(n,e,t)}catch(n){}if("get"in t||"set"in t)throw c("Accessors not supported");return"value"in t&&(n[e]=t.value),n}},function(n,e,t){var r=t(0),o=t(5),a=t(10),i=t(27),s=t(112),l=t(87),c=t(39),u=t(66).CONFIGURABLE,d=c.get,p=c.enforce,m=String(String).split("String");(n.exports=function(n,e,t,l){var c,d=!!l&&!!l.unsafe,f=!!l&&!!l.enumerable,h=!!l&&!!l.noTargetGet,g=l&&void 0!==l.name?l.name:e;o(t)&&("Symbol("===String(g).slice(0,7)&&(g="["+String(g).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!a(t,"name")||u&&t.name!==g)&&i(t,"name",g),(c=p(t)).source||(c.source=m.join("string"==typeof g?g:""))),n!==r?(d?!h&&n[e]&&(f=!0):delete n[e],f?n[e]=t:i(n,e,t)):f?n[e]=t:s(e,t)})(Function.prototype,"toString",(function(){return o(this)&&d(this).source||l(this)}))},function(n,e,t){var r=t(0),o=t(18),a=r.Object;n.exports=function(n){return a(o(n))}},function(n,e,t){var r=t(0),o=t(5),a=function(n){return o(n)?n:void 0};n.exports=function(n,e){return arguments.length<2?a(r[n]):r[n]&&r[n][e]}},function(n,e,t){"use strict";var r=t(1),o=t(93);r({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},function(n,e,t){var r=t(0).TypeError;n.exports=function(n){if(null==n)throw r("Can't call method on "+n);return n}},function(n,e,t){var r=t(62),o=t(18);n.exports=function(n){return r(o(n))}},function(n,e,t){"use strict";function r(n,e,t,r,o,a,i,s){var l,c="function"==typeof n?n.options:n;if(e&&(c.render=e,c.staticRenderFns=t,c._compiled=!0),r&&(c.functional=!0),a&&(c._scopeId="data-v-"+a),i?(l=function(n){(n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(n=__VUE_SSR_CONTEXT__),o&&o.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(i)},c._ssrRegister=l):o&&(l=s?function(){o.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:o),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(n,e){return l.call(e),u(n,e)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:n,options:c}}t.d(e,"a",(function(){return r}))},function(n,e,t){"use strict";var r=t(174).charAt,o=t(12),a=t(39),i=t(162),s=a.set,l=a.getterFor("String Iterator");i(String,"String",(function(n){s(this,{type:"String Iterator",string:o(n),index:0})}),(function(){var n,e=l(this),t=e.string,o=e.index;return o>=t.length?{value:void 0,done:!0}:(n=r(t,o),e.index+=n.length,{value:n,done:!1})}))},function(n,e,t){var r=t(52);n.exports=function(n){return r(n.length)}},function(n,e,t){"use strict";var r=t(1),o=t(57).filter;r({target:"Array",proto:!0,forced:!t(91)("filter")},{filter:function(n){return o(this,n,arguments.length>1?arguments[1]:void 0)}})},function(n,e,t){var r=t(0),o=t(175),a=t(176),i=t(144),s=t(27),l=t(6),c=l("iterator"),u=l("toStringTag"),d=i.values,p=function(n,e){if(n){if(n[c]!==d)try{s(n,c,d)}catch(e){n[c]=d}if(n[u]||s(n,u,e),o[e])for(var t in i)if(n[t]!==i[t])try{s(n,t,i[t])}catch(e){n[t]=i[t]}}};for(var m in o)p(r[m]&&r[m].prototype,m);p(a,"DOMTokenList")},function(n,e,t){var r=t(2),o=r({}.toString),a=r("".slice);n.exports=function(n){return a(o(n),8,-1)}},function(n,e){n.exports=!1},function(n,e,t){var r=t(7),o=t(13),a=t(48);n.exports=r?function(n,e,t){return o.f(n,e,a(1,t))}:function(n,e,t){return n[e]=t,n}},function(n,e,t){"use strict";var r=t(1),o=t(182);r({target:"Array",proto:!0,forced:[].forEach!=o},{forEach:o})},function(n,e,t){var r=t(0),o=t(175),a=t(176),i=t(182),s=t(27),l=function(n){if(n&&n.forEach!==i)try{s(n,"forEach",i)}catch(e){n.forEach=i}};for(var c in o)o[c]&&l(r[c]&&r[c].prototype);l(a)},function(n,e,t){var r=t(14),o=t(268),a=Error.prototype;a.toString!==o&&r(a,"toString",o)},function(n,e){var t=Array.isArray;n.exports=t},function(n,e,t){var r=t(16);n.exports=r("navigator","userAgent")||""},function(n,e,t){var r=t(192),o="object"==typeof self&&self&&self.Object===Object&&self,a=r||o||Function("return this")();n.exports=a},function(n,e,t){var r,o=t(8),a=t(114),i=t(117),s=t(64),l=t(161),c=t(81),u=t(86),d=u("IE_PROTO"),p=function(){},m=function(n){return"<script>"+n+"<\/script>"},f=function(n){n.write(m("")),n.close();var e=n.parentWindow.Object;return n=null,e},h=function(){try{r=new ActiveXObject("htmlfile")}catch(n){}var n,e;h="undefined"!=typeof document?document.domain&&r?f(r):((e=c("iframe")).style.display="none",l.appendChild(e),e.src=String("javascript:"),(n=e.contentWindow.document).open(),n.write(m("document.F=Object")),n.close(),n.F):f(r);for(var t=i.length;t--;)delete h.prototype[i[t]];return h()};s[d]=!0,n.exports=Object.create||function(n,e){var t;return null!==n?(p.prototype=o(n),t=new p,p.prototype=null,t[d]=n):t=h(),void 0===e?t:a.f(t,e)}},function(n,e,t){var r=t(2);n.exports=r({}.isPrototypeOf)},function(n,e,t){var r=t(63),o=Function.prototype,a=o.apply,i=o.call;n.exports="object"==typeof Reflect&&Reflect.apply||(r?i.bind(a):function(){return i.apply(a,arguments)})},function(n,e,t){var r=t(0),o=t(5),a=t(84),i=r.TypeError;n.exports=function(n){if(o(n))return n;throw i(a(n)+" is not a function")}},function(n,e,t){var r=t(7),o=t(11),a=t(118),i=t(48),s=t(19),l=t(82),c=t(10),u=t(158),d=Object.getOwnPropertyDescriptor;e.f=r?d:function(n,e){if(n=s(n),e=l(e),u)try{return d(n,e)}catch(n){}if(c(n,e))return i(!o(a.f,n,e),n[e])}},function(n,e,t){var r,o,a,i=t(239),s=t(0),l=t(2),c=t(9),u=t(27),d=t(10),p=t(111),m=t(86),f=t(64),h=s.TypeError,g=s.WeakMap;if(i||p.state){var b=p.state||(p.state=new g),y=l(b.get),v=l(b.has),x=l(b.set);r=function(n,e){if(v(b,n))throw new h("Object already initialized");return e.facade=n,x(b,n,e),e},o=function(n){return y(b,n)||{}},a=function(n){return v(b,n)}}else{var w=m("state");f[w]=!0,r=function(n,e){if(d(n,w))throw new h("Object already initialized");return e.facade=n,u(n,w,e),e},o=function(n){return d(n,w)?n[w]:{}},a=function(n){return d(n,w)}}n.exports={set:r,get:o,has:a,enforce:function(n){return a(n)?o(n):r(n,{})},getterFor:function(n){return function(e){var t;if(!c(e)||(t=o(e)).type!==n)throw h("Incompatible receiver, "+n+" required");return t}}}},function(n,e,t){var r=t(1),o=t(0),a=t(36),i=t(264),s=o.WebAssembly,l=7!==Error("e",{cause:7}).cause,c=function(n,e){var t={};t[n]=i(n,e,l),r({global:!0,forced:l},t)},u=function(n,e){if(s&&s[n]){var t={};t[n]=i("WebAssembly."+n,e,l),r({target:"WebAssembly",stat:!0,forced:l},t)}};c("Error",(function(n){return function(e){return a(n,this,arguments)}})),c("EvalError",(function(n){return function(e){return a(n,this,arguments)}})),c("RangeError",(function(n){return function(e){return a(n,this,arguments)}})),c("ReferenceError",(function(n){return function(e){return a(n,this,arguments)}})),c("SyntaxError",(function(n){return function(e){return a(n,this,arguments)}})),c("TypeError",(function(n){return function(e){return a(n,this,arguments)}})),c("URIError",(function(n){return function(e){return a(n,this,arguments)}})),u("CompileError",(function(n){return function(e){return a(n,this,arguments)}})),u("LinkError",(function(n){return function(e){return a(n,this,arguments)}})),u("RuntimeError",(function(n){return function(e){return a(n,this,arguments)}}))},function(n,e,t){var r=t(288),o=t(291);n.exports=function(n,e){var t=o(n,e);return r(t)?t:void 0}},function(n,e,t){"use strict";var r=t(1),o=t(0),a=t(60),i=t(88),s=t(9),l=t(116),c=t(22),u=t(19),d=t(69),p=t(6),m=t(91),f=t(68),h=m("slice"),g=p("species"),b=o.Array,y=Math.max;r({target:"Array",proto:!0,forced:!h},{slice:function(n,e){var t,r,o,p=u(this),m=c(p),h=l(n,m),v=l(void 0===e?m:e,m);if(a(p)&&(t=p.constructor,(i(t)&&(t===b||a(t.prototype))||s(t)&&null===(t=t[g]))&&(t=void 0),t===b||void 0===t))return f(p,h,v);for(r=new(void 0===t?b:t)(y(v-h,0)),o=0;h<v;h++,o++)h in p&&d(r,o,p[h]);return r.length=o,r}})},function(n,e,t){"use strict";t.d(e,"e",(function(){return r})),t.d(e,"b",(function(){return a})),t.d(e,"j",(function(){return i})),t.d(e,"g",(function(){return l})),t.d(e,"h",(function(){return c})),t.d(e,"i",(function(){return u})),t.d(e,"c",(function(){return d})),t.d(e,"f",(function(){return p})),t.d(e,"l",(function(){return m})),t.d(e,"m",(function(){return f})),t.d(e,"d",(function(){return g})),t.d(e,"k",(function(){return b})),t.d(e,"n",(function(){return y})),t.d(e,"a",(function(){return x}));t(17),t(45),t(140),t(74),t(103),t(110),t(44),t(28),t(4),t(29),t(23),t(77),t(104),t(155),t(53),t(212),t(30),t(143);var r=/#.*$/,o=/\.(md|html)$/,a=/\/$/,i=/^[a-z]+:/i;function s(n){return decodeURI(n).replace(r,"").replace(o,"")}function l(n){return i.test(n)}function c(n){return/^mailto:/.test(n)}function u(n){return/^tel:/.test(n)}function d(n){if(l(n))return n;var e=n.match(r),t=e?e[0]:"",o=s(n);return a.test(o)?n:o+".html"+t}function p(n,e){var t=n.hash,o=function(n){var e=n.match(r);if(e)return e[0]}(e);return(!o||t===o)&&s(n.path)===s(e)}function m(n,e,t){if(l(e))return{type:"external",path:e};t&&(e=function(n,e,t){var r=n.charAt(0);if("/"===r)return n;if("?"===r||"#"===r)return e+n;var o=e.split("/");t&&o[o.length-1]||o.pop();for(var a=n.replace(/^\//,"").split("/"),i=0;i<a.length;i++){var s=a[i];".."===s?o.pop():"."!==s&&o.push(s)}""!==o[0]&&o.unshift("");return o.join("/")}(e,t));for(var r=s(e),o=0;o<n.length;o++)if(s(n[o].regularPath)===r)return Object.assign({},n[o],{type:"page",path:d(n[o].path)});return console.error('[vuepress] No matching page found for sidebar item "'.concat(e,'"')),{}}function f(n,e,t,r){var o=t.pages,a=t.themeConfig,i=r&&a.locales&&a.locales[r]||a;if("auto"===(n.frontmatter.sidebar||i.sidebar||a.sidebar))return h(n);var s=i.sidebar||a.sidebar;if(s){var l=function(n,e){if(Array.isArray(e))return{base:"/",config:e};for(var t in e)if(0===(r=n,/(\.html|\/)$/.test(r)?r:r+"/").indexOf(encodeURI(t)))return{base:t,config:e[t]};var r;return{}}(e,s),c=l.base,u=l.config;return"auto"===u?h(n):u?u.map((function(n){return function n(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if("string"==typeof e)return m(t,e,r);if(Array.isArray(e))return Object.assign(m(t,e[0],r),{title:e[1]});o>3&&console.error("[vuepress] detected a too deep nested sidebar group.");var a=e.children||[];return 0===a.length&&e.path?Object.assign(m(t,e.path,r),{title:e.title}):{type:"group",path:e.path,title:e.title,sidebarDepth:e.sidebarDepth,initialOpenGroupIndex:e.initialOpenGroupIndex,children:a.map((function(e){return n(e,t,r,o+1)})),collapsable:!1!==e.collapsable}}(n,o,c)})):[]}return[]}function h(n){var e=g(n.headers||[]);return[{type:"group",collapsable:!1,title:n.title,path:null,children:e.map((function(e){return{type:"auto",title:e.title,basePath:n.path,path:n.path+"#"+e.slug,children:e.children||[]}}))}]}function g(n){var e;return(n=n.map((function(n){return Object.assign({},n)}))).forEach((function(n){2===n.level?e=n:e&&(e.children||(e.children=[])).push(n)})),n.filter((function(n){return 2===n.level}))}function b(n){return Object.assign(n,{type:n.items&&n.items.length?"links":"link"})}function y(n){return Object.prototype.toString.call(n).match(/\[object (.*?)\]/)[1].toLowerCase()}function v(n){var e=n.frontmatter.date||n.lastUpdated||new Date,t=new Date(e);return"Invalid Date"==t&&e&&(t=new Date(e.replace(/-/g,"/"))),t.getTime()}function x(n,e){return v(e)-v(n)}},function(n,e,t){"use strict";var r=t(1),o=t(57).map;r({target:"Array",proto:!0,forced:!t(91)("map")},{map:function(n){return o(this,n,arguments.length>1?arguments[1]:void 0)}})},function(n,e,t){"use strict";var r=t(36),o=t(11),a=t(2),i=t(108),s=t(3),l=t(8),c=t(5),u=t(55),d=t(52),p=t(12),m=t(18),f=t(127),h=t(47),g=t(269),b=t(109),y=t(6)("replace"),v=Math.max,x=Math.min,w=a([].concat),k=a([].push),S=a("".indexOf),j=a("".slice),E="$0"==="a".replace(/./,"$0"),A=!!/./[y]&&""===/./[y]("a","$0");i("replace",(function(n,e,t){var a=A?"$":"$0";return[function(n,t){var r=m(this),a=null==n?void 0:h(n,y);return a?o(a,n,r,t):o(e,p(r),n,t)},function(n,o){var i=l(this),s=p(n);if("string"==typeof o&&-1===S(o,a)&&-1===S(o,"$<")){var m=t(e,i,s,o);if(m.done)return m.value}var h=c(o);h||(o=p(o));var y=i.global;if(y){var E=i.unicode;i.lastIndex=0}for(var A=[];;){var I=b(i,s);if(null===I)break;if(k(A,I),!y)break;""===p(I[0])&&(i.lastIndex=f(s,d(i.lastIndex),E))}for(var T,z="",_=0,C=0;C<A.length;C++){for(var P=p((I=A[C])[0]),O=v(x(u(I.index),s.length),0),M=[],D=1;D<I.length;D++)k(M,void 0===(T=I[D])?T:String(T));var R=I.groups;if(h){var B=w([P],M,O,s);void 0!==R&&k(B,R);var L=p(r(o,void 0,B))}else L=g(P,s,O,M,R,o);O>=_&&(z+=j(s,_,O)+L,_=O+P.length)}return z+j(s,_)}]}),!!s((function(){var n=/./;return n.exec=function(){var n=[];return n.groups={a:"7"},n},"7"!=="".replace(n,"$<a>")}))||!E||A)},function(n,e,t){"use strict";var r=t(3);n.exports=function(n,e){var t=[][n];return!!t&&r((function(){t.call(null,e||function(){throw 1},1)}))}},function(n,e,t){var r=t(37);n.exports=function(n,e){var t=n[e];return null==t?void 0:r(t)}},function(n,e){n.exports=function(n,e){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:e}}},function(n,e){n.exports=function(n){return null!=n&&"object"==typeof n}},function(n,e,t){"use strict";t.d(e,"a",(function(){return a}));t(75),t(70),t(23),t(4),t(380),t(28),t(29),t(177),t(381),t(99);function r(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function o(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function a(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?o(Object(t),!0).forEach((function(e){r(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}},function(n,e,t){var r,o,a=t(0),i=t(32),s=a.process,l=a.Deno,c=s&&s.versions||l&&l.version,u=c&&c.v8;u&&(o=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&i&&(!(r=i.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=i.match(/Chrome\/(\d+)/))&&(o=+r[1]),n.exports=o},function(n,e,t){var r=t(55),o=Math.min;n.exports=function(n){return n>0?o(r(n),9007199254740991):0}},function(n,e,t){"use strict";var r=t(1),o=t(0),a=t(3),i=t(60),s=t(9),l=t(15),c=t(22),u=t(69),d=t(147),p=t(91),m=t(6),f=t(51),h=m("isConcatSpreadable"),g=o.TypeError,b=f>=51||!a((function(){var n=[];return n[h]=!1,n.concat()[0]!==n})),y=p("concat"),v=function(n){if(!s(n))return!1;var e=n[h];return void 0!==e?!!e:i(n)};r({target:"Array",proto:!0,forced:!b||!y},{concat:function(n){var e,t,r,o,a,i=l(this),s=d(i,0),p=0;for(e=-1,r=arguments.length;e<r;e++)if(v(a=-1===e?i:arguments[e])){if(p+(o=c(a))>9007199254740991)throw g("Maximum allowed index exceeded");for(t=0;t<o;t++,p++)t in a&&u(s,p,a[t])}else{if(p>=9007199254740991)throw g("Maximum allowed index exceeded");u(s,p++,a)}return s.length=p,s}})},function(n,e,t){var r=t(1),o=t(0),a=t(36),i=t(5),s=t(32),l=t(68),c=t(146),u=/MSIE .\./.test(s),d=o.Function,p=function(n){return function(e,t){var r=c(arguments.length,1)>2,o=i(e)?e:d(e),s=r?l(arguments,2):void 0;return n(r?function(){a(o,this,s)}:o,t)}};r({global:!0,bind:!0,forced:u},{setTimeout:p(o.setTimeout),setInterval:p(o.setInterval)})},function(n,e){var t=Math.ceil,r=Math.floor;n.exports=function(n){var e=+n;return e!=e||0===e?0:(e>0?r:t)(e)}},function(n,e,t){var r=t(2),o=t(37),a=t(63),i=r(r.bind);n.exports=function(n,e){return o(n),void 0===e?n:a?i(n,e):function(){return n.apply(e,arguments)}}},function(n,e,t){var r=t(56),o=t(2),a=t(62),i=t(15),s=t(22),l=t(147),c=o([].push),u=function(n){var e=1==n,t=2==n,o=3==n,u=4==n,d=6==n,p=7==n,m=5==n||d;return function(f,h,g,b){for(var y,v,x=i(f),w=a(x),k=r(h,g),S=s(w),j=0,E=b||l,A=e?E(f,S):t||p?E(f,0):void 0;S>j;j++)if((m||j in w)&&(v=k(y=w[j],j,x),n))if(e)A[j]=v;else if(v)switch(n){case 3:return!0;case 5:return y;case 6:return j;case 2:c(A,y)}else switch(n){case 4:return!1;case 7:c(A,y)}return d?-1:o||u?u:A}};n.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}},function(n,e,t){var r=t(160),o=t(117).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(n){return r(n,o)}},function(n,e,t){var r=t(13).f,o=t(10),a=t(6)("toStringTag");n.exports=function(n,e,t){n&&!t&&(n=n.prototype),n&&!o(n,a)&&r(n,a,{configurable:!0,value:e})}},function(n,e,t){var r=t(25);n.exports=Array.isArray||function(n){return"Array"==r(n)}},function(n,e,t){var r=t(71),o=t(273),a=t(274),i=r?r.toStringTag:void 0;n.exports=function(n){return null==n?void 0===n?"[object Undefined]":"[object Null]":i&&i in Object(n)?o(n):a(n)}},function(n,e,t){var r=t(0),o=t(2),a=t(3),i=t(25),s=r.Object,l=o("".split);n.exports=a((function(){return!s("z").propertyIsEnumerable(0)}))?function(n){return"String"==i(n)?l(n,""):s(n)}:s},function(n,e,t){var r=t(3);n.exports=!r((function(){var n=function(){}.bind();return"function"!=typeof n||n.hasOwnProperty("prototype")}))},function(n,e){n.exports={}},function(n,e){n.exports={}},function(n,e,t){var r=t(7),o=t(10),a=Function.prototype,i=r&&Object.getOwnPropertyDescriptor,s=o(a,"name"),l=s&&"something"===function(){}.name,c=s&&(!r||r&&i(a,"name").configurable);n.exports={EXISTS:s,PROPER:l,CONFIGURABLE:c}},function(n,e,t){var r=t(2),o=t(8),a=t(240);n.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var n,e=!1,t={};try{(n=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(t,[]),e=t instanceof Array}catch(n){}return function(t,r){return o(t),a(r),e?n(t,r):t.__proto__=r,t}}():void 0)},function(n,e,t){var r=t(2);n.exports=r([].slice)},function(n,e,t){"use strict";var r=t(82),o=t(13),a=t(48);n.exports=function(n,e,t){var i=r(e);i in n?o.f(n,i,a(0,t)):n[i]=t}},function(n,e,t){"use strict";var r=t(1),o=t(0),a=t(16),i=t(36),s=t(11),l=t(2),c=t(26),u=t(7),d=t(113),p=t(3),m=t(10),f=t(60),h=t(5),g=t(9),b=t(35),y=t(83),v=t(8),x=t(15),w=t(19),k=t(82),S=t(12),j=t(48),E=t(34),A=t(85),I=t(58),T=t(184),z=t(121),_=t(38),C=t(13),P=t(114),O=t(118),M=t(68),D=t(14),R=t(79),B=t(86),L=t(64),N=t(80),F=t(6),q=t(185),$=t(186),G=t(59),U=t(39),H=t(57).forEach,J=B("hidden"),W=F("toPrimitive"),V=U.set,K=U.getterFor("Symbol"),Z=Object.prototype,Y=o.Symbol,X=Y&&Y.prototype,Q=o.TypeError,nn=o.QObject,en=a("JSON","stringify"),tn=_.f,rn=C.f,on=T.f,an=O.f,sn=l([].push),ln=R("symbols"),cn=R("op-symbols"),un=R("string-to-symbol-registry"),dn=R("symbol-to-string-registry"),pn=R("wks"),mn=!nn||!nn.prototype||!nn.prototype.findChild,fn=u&&p((function(){return 7!=E(rn({},"a",{get:function(){return rn(this,"a",{value:7}).a}})).a}))?function(n,e,t){var r=tn(Z,e);r&&delete Z[e],rn(n,e,t),r&&n!==Z&&rn(Z,e,r)}:rn,hn=function(n,e){var t=ln[n]=E(X);return V(t,{type:"Symbol",tag:n,description:e}),u||(t.description=e),t},gn=function(n,e,t){n===Z&&gn(cn,e,t),v(n);var r=k(e);return v(t),m(ln,r)?(t.enumerable?(m(n,J)&&n[J][r]&&(n[J][r]=!1),t=E(t,{enumerable:j(0,!1)})):(m(n,J)||rn(n,J,j(1,{})),n[J][r]=!0),fn(n,r,t)):rn(n,r,t)},bn=function(n,e){v(n);var t=w(e),r=A(t).concat(wn(t));return H(r,(function(e){u&&!s(yn,t,e)||gn(n,e,t[e])})),n},yn=function(n){var e=k(n),t=s(an,this,e);return!(this===Z&&m(ln,e)&&!m(cn,e))&&(!(t||!m(this,e)||!m(ln,e)||m(this,J)&&this[J][e])||t)},vn=function(n,e){var t=w(n),r=k(e);if(t!==Z||!m(ln,r)||m(cn,r)){var o=tn(t,r);return!o||!m(ln,r)||m(t,J)&&t[J][r]||(o.enumerable=!0),o}},xn=function(n){var e=on(w(n)),t=[];return H(e,(function(n){m(ln,n)||m(L,n)||sn(t,n)})),t},wn=function(n){var e=n===Z,t=on(e?cn:w(n)),r=[];return H(t,(function(n){!m(ln,n)||e&&!m(Z,n)||sn(r,ln[n])})),r};(d||(D(X=(Y=function(){if(b(X,this))throw Q("Symbol is not a constructor");var n=arguments.length&&void 0!==arguments[0]?S(arguments[0]):void 0,e=N(n),t=function(n){this===Z&&s(t,cn,n),m(this,J)&&m(this[J],e)&&(this[J][e]=!1),fn(this,e,j(1,n))};return u&&mn&&fn(Z,e,{configurable:!0,set:t}),hn(e,n)}).prototype,"toString",(function(){return K(this).tag})),D(Y,"withoutSetter",(function(n){return hn(N(n),n)})),O.f=yn,C.f=gn,P.f=bn,_.f=vn,I.f=T.f=xn,z.f=wn,q.f=function(n){return hn(F(n),n)},u&&(rn(X,"description",{configurable:!0,get:function(){return K(this).description}}),c||D(Z,"propertyIsEnumerable",yn,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!d,sham:!d},{Symbol:Y}),H(A(pn),(function(n){$(n)})),r({target:"Symbol",stat:!0,forced:!d},{for:function(n){var e=S(n);if(m(un,e))return un[e];var t=Y(e);return un[e]=t,dn[t]=e,t},keyFor:function(n){if(!y(n))throw Q(n+" is not a symbol");if(m(dn,n))return dn[n]},useSetter:function(){mn=!0},useSimple:function(){mn=!1}}),r({target:"Object",stat:!0,forced:!d,sham:!u},{create:function(n,e){return void 0===e?E(n):bn(E(n),e)},defineProperty:gn,defineProperties:bn,getOwnPropertyDescriptor:vn}),r({target:"Object",stat:!0,forced:!d},{getOwnPropertyNames:xn,getOwnPropertySymbols:wn}),r({target:"Object",stat:!0,forced:p((function(){z.f(1)}))},{getOwnPropertySymbols:function(n){return z.f(x(n))}}),en)&&r({target:"JSON",stat:!0,forced:!d||p((function(){var n=Y();return"[null]"!=en([n])||"{}"!=en({a:n})||"{}"!=en(Object(n))}))},{stringify:function(n,e,t){var r=M(arguments),o=e;if((g(e)||void 0!==n)&&!y(n))return f(e)||(e=function(n,e){if(h(o)&&(e=s(o,this,n,e)),!y(e))return e}),r[1]=e,i(en,null,r)}});if(!X[W]){var kn=X.valueOf;D(X,W,(function(n){return s(kn,this)}))}G(Y,"Symbol"),L[J]=!0},function(n,e,t){var r=t(33).Symbol;n.exports=r},function(n,e,t){"use strict";t.d(e,"a",(function(){return a}));t(77);var r=t(73);t(70),t(92),t(4),t(126),t(21),t(24),t(187);var o=t(100);t(40),t(30);function a(n){return function(n){if(Array.isArray(n))return Object(r.a)(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||Object(o.a)(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(n,e,t){"use strict";function r(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}t.d(e,"a",(function(){return r}))},function(n,e,t){"use strict";t(17);var r,o,a=t(1),i=t(0),s=t(11),l=t(2),c=t(5),u=t(9),d=(r=!1,(o=/[ac]/).exec=function(){return r=!0,/./.exec.apply(this,arguments)},!0===o.test("abc")&&r),p=i.Error,m=l(/./.test);a({target:"RegExp",proto:!0,forced:!d},{test:function(n){var e=this.exec;if(!c(e))return m(this,n);var t=s(e,this,n);if(null!==t&&!u(t))throw new p("RegExp exec method returned something other than an Object or null");return!!t}})},function(n,e,t){var r=t(1),o=t(15),a=t(85);r({target:"Object",stat:!0,forced:t(3)((function(){a(1)}))},{keys:function(n){return a(o(n))}})},function(n,e,t){var r=t(0),o=t(123),a=t(5),i=t(25),s=t(6)("toStringTag"),l=r.Object,c="Arguments"==i(function(){return arguments}());n.exports=o?i:function(n){var e,t,r;return void 0===n?"Undefined":null===n?"Null":"string"==typeof(t=function(n,e){try{return n[e]}catch(n){}}(e=l(n),s))?t:c?i(e):"Object"==(r=i(e))&&a(e.callee)?"Arguments":r}},function(n,e,t){t(1)({target:"Array",stat:!0},{isArray:t(60)})},function(n,e,t){var r=t(7),o=t(66).EXISTS,a=t(2),i=t(13).f,s=Function.prototype,l=a(s.toString),c=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=a(c.exec);r&&!o&&i(s,"name",{configurable:!0,get:function(){try{return u(c,l(this))[1]}catch(n){return""}}})},function(n,e,t){var r=t(26),o=t(111);(n.exports=function(n,e){return o[n]||(o[n]=void 0!==e?e:{})})("versions",[]).push({version:"3.21.0",mode:r?"pure":"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.0/LICENSE",source:"https://github.com/zloirock/core-js"})},function(n,e,t){var r=t(2),o=0,a=Math.random(),i=r(1..toString);n.exports=function(n){return"Symbol("+(void 0===n?"":n)+")_"+i(++o+a,36)}},function(n,e,t){var r=t(0),o=t(9),a=r.document,i=o(a)&&o(a.createElement);n.exports=function(n){return i?a.createElement(n):{}}},function(n,e,t){var r=t(159),o=t(83);n.exports=function(n){var e=r(n,"string");return o(e)?e:e+""}},function(n,e,t){var r=t(0),o=t(16),a=t(5),i=t(35),s=t(156),l=r.Object;n.exports=s?function(n){return"symbol"==typeof n}:function(n){var e=o("Symbol");return a(e)&&i(e.prototype,l(n))}},function(n,e,t){var r=t(0).String;n.exports=function(n){try{return r(n)}catch(n){return"Object"}}},function(n,e,t){var r=t(160),o=t(117);n.exports=Object.keys||function(n){return r(n,o)}},function(n,e,t){var r=t(79),o=t(80),a=r("keys");n.exports=function(n){return a[n]||(a[n]=o(n))}},function(n,e,t){var r=t(2),o=t(5),a=t(111),i=r(Function.toString);o(a.inspectSource)||(a.inspectSource=function(n){return i(n)}),n.exports=a.inspectSource},function(n,e,t){var r=t(2),o=t(3),a=t(5),i=t(76),s=t(16),l=t(87),c=function(){},u=[],d=s("Reflect","construct"),p=/^\s*(?:class|function)\b/,m=r(p.exec),f=!p.exec(c),h=function(n){if(!a(n))return!1;try{return d(c,u,n),!0}catch(n){return!1}},g=function(n){if(!a(n))return!1;switch(i(n)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!m(p,l(n))}catch(n){return!0}};g.sham=!0,n.exports=!d||o((function(){var n;return h(h.call)||!h(Object)||!h((function(){n=!0}))||n}))?g:h},function(n,e,t){var r=t(25),o=t(0);n.exports="process"==r(o.process)},function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));t(4);function r(n,e,t,r,o,a,i){try{var s=n[a](i),l=s.value}catch(n){return void t(n)}s.done?e(l):Promise.resolve(l).then(r,o)}function o(n){return function(){var e=this,t=arguments;return new Promise((function(o,a){var i=n.apply(e,t);function s(n){r(i,o,a,s,l,"next",n)}function l(n){r(i,o,a,s,l,"throw",n)}s(void 0)}))}}},function(n,e,t){var r=t(3),o=t(6),a=t(51),i=o("species");n.exports=function(n){return a>=51||!r((function(){var e=[];return(e.constructor={})[i]=function(){return{foo:1}},1!==e[n](Boolean).foo}))}},function(n,e,t){"use strict";var r=t(1),o=t(7),a=t(0),i=t(2),s=t(10),l=t(5),c=t(35),u=t(12),d=t(13).f,p=t(119),m=a.Symbol,f=m&&m.prototype;if(o&&l(m)&&(!("description"in f)||void 0!==m().description)){var h={},g=function(){var n=arguments.length<1||void 0===arguments[0]?void 0:u(arguments[0]),e=c(f,this)?new m(n):void 0===n?m():m(n);return""===n&&(h[e]=!0),e};p(g,m),g.prototype=f,f.constructor=g;var b="Symbol(test)"==String(m("test")),y=i(f.toString),v=i(f.valueOf),x=/^Symbol\((.*)\)[^)]+$/,w=i("".replace),k=i("".slice);d(f,"description",{configurable:!0,get:function(){var n=v(this),e=y(n);if(s(h,n))return"";var t=b?k(e,7,-1):w(e,x,"$1");return""===t?void 0:t}}),r({global:!0,forced:!0},{Symbol:g})}},function(n,e,t){"use strict";var r,o,a=t(11),i=t(2),s=t(12),l=t(149),c=t(107),u=t(79),d=t(34),p=t(39).get,m=t(225),f=t(230),h=u("native-string-replace",String.prototype.replace),g=RegExp.prototype.exec,b=g,y=i("".charAt),v=i("".indexOf),x=i("".replace),w=i("".slice),k=(o=/b*/g,a(g,r=/a/,"a"),a(g,o,"a"),0!==r.lastIndex||0!==o.lastIndex),S=c.BROKEN_CARET,j=void 0!==/()??/.exec("")[1];(k||j||S||m||f)&&(b=function(n){var e,t,r,o,i,c,u,m=this,f=p(m),E=s(n),A=f.raw;if(A)return A.lastIndex=m.lastIndex,e=a(b,A,E),m.lastIndex=A.lastIndex,e;var I=f.groups,T=S&&m.sticky,z=a(l,m),_=m.source,C=0,P=E;if(T&&(z=x(z,"y",""),-1===v(z,"g")&&(z+="g"),P=w(E,m.lastIndex),m.lastIndex>0&&(!m.multiline||m.multiline&&"\n"!==y(E,m.lastIndex-1))&&(_="(?: "+_+")",P=" "+P,C++),t=new RegExp("^(?:"+_+")",z)),j&&(t=new RegExp("^"+_+"$(?!\\s)",z)),k&&(r=m.lastIndex),o=a(g,T?t:m,P),T?o?(o.input=w(o.input,C),o[0]=w(o[0],C),o.index=m.lastIndex,m.lastIndex+=o[0].length):m.lastIndex=0:k&&o&&(m.lastIndex=m.global?o.index+o[0].length:r),j&&o&&o.length>1&&a(h,o[0],t,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o&&I)for(o.groups=c=d(null),i=0;i<I.length;i++)c[(u=I[i])[0]]=o[u[1]];return o}),n.exports=b},function(n,e,t){var r=t(278),o=t(279),a=t(280),i=t(281),s=t(282);function l(n){var e=-1,t=null==n?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=o,l.prototype.get=a,l.prototype.has=i,l.prototype.set=s,n.exports=l},function(n,e,t){var r=t(194);n.exports=function(n,e){for(var t=n.length;t--;)if(r(n[t][0],e))return t;return-1}},function(n,e,t){var r=t(41)(Object,"create");n.exports=r},function(n,e,t){var r=t(300);n.exports=function(n,e){var t=n.__data__;return r(e)?t["string"==typeof e?"string":"hash"]:t.map}},function(n,e,t){var r=t(135);n.exports=function(n){if("string"==typeof n||r(n))return n;var e=n+"";return"0"==e&&1/n==-1/0?"-0":e}},function(n,e,t){var r=t(1),o=t(7),a=t(13).f;r({target:"Object",stat:!0,forced:Object.defineProperty!==a,sham:!o},{defineProperty:a})},function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));t(42),t(4),t(78),t(187),t(21),t(17),t(74);var r=t(73);function o(n,e){if(n){if("string"==typeof n)return Object(r.a)(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Object(r.a)(n,e):void 0}}},function(n,e,t){var r,o;
/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */void 0===(o="function"==typeof(r=function(){var n,e,t={version:"0.2.0"},r=t.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};function o(n,e,t){return n<e?e:n>t?t:n}function a(n){return 100*(-1+n)}t.configure=function(n){var e,t;for(e in n)void 0!==(t=n[e])&&n.hasOwnProperty(e)&&(r[e]=t);return this},t.status=null,t.set=function(n){var e=t.isStarted();n=o(n,r.minimum,1),t.status=1===n?null:n;var l=t.render(!e),c=l.querySelector(r.barSelector),u=r.speed,d=r.easing;return l.offsetWidth,i((function(e){""===r.positionUsing&&(r.positionUsing=t.getPositioningCSS()),s(c,function(n,e,t){var o;return(o="translate3d"===r.positionUsing?{transform:"translate3d("+a(n)+"%,0,0)"}:"translate"===r.positionUsing?{transform:"translate("+a(n)+"%,0)"}:{"margin-left":a(n)+"%"}).transition="all "+e+"ms "+t,o}(n,u,d)),1===n?(s(l,{transition:"none",opacity:1}),l.offsetWidth,setTimeout((function(){s(l,{transition:"all "+u+"ms linear",opacity:0}),setTimeout((function(){t.remove(),e()}),u)}),u)):setTimeout(e,u)})),this},t.isStarted=function(){return"number"==typeof t.status},t.start=function(){t.status||t.set(0);var n=function(){setTimeout((function(){t.status&&(t.trickle(),n())}),r.trickleSpeed)};return r.trickle&&n(),this},t.done=function(n){return n||t.status?t.inc(.3+.5*Math.random()).set(1):this},t.inc=function(n){var e=t.status;return e?("number"!=typeof n&&(n=(1-e)*o(Math.random()*e,.1,.95)),e=o(e+n,0,.994),t.set(e)):t.start()},t.trickle=function(){return t.inc(Math.random()*r.trickleRate)},n=0,e=0,t.promise=function(r){return r&&"resolved"!==r.state()?(0===e&&t.start(),n++,e++,r.always((function(){0==--e?(n=0,t.done()):t.set((n-e)/n)})),this):this},t.render=function(n){if(t.isRendered())return document.getElementById("nprogress");c(document.documentElement,"nprogress-busy");var e=document.createElement("div");e.id="nprogress",e.innerHTML=r.template;var o,i=e.querySelector(r.barSelector),l=n?"-100":a(t.status||0),u=document.querySelector(r.parent);return s(i,{transition:"all 0 linear",transform:"translate3d("+l+"%,0,0)"}),r.showSpinner||(o=e.querySelector(r.spinnerSelector))&&p(o),u!=document.body&&c(u,"nprogress-custom-parent"),u.appendChild(e),e},t.remove=function(){u(document.documentElement,"nprogress-busy"),u(document.querySelector(r.parent),"nprogress-custom-parent");var n=document.getElementById("nprogress");n&&p(n)},t.isRendered=function(){return!!document.getElementById("nprogress")},t.getPositioningCSS=function(){var n=document.body.style,e="WebkitTransform"in n?"Webkit":"MozTransform"in n?"Moz":"msTransform"in n?"ms":"OTransform"in n?"O":"";return e+"Perspective"in n?"translate3d":e+"Transform"in n?"translate":"margin"};var i=function(){var n=[];function e(){var t=n.shift();t&&t(e)}return function(t){n.push(t),1==n.length&&e()}}(),s=function(){var n=["Webkit","O","Moz","ms"],e={};function t(t){return t=t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(n,e){return e.toUpperCase()})),e[t]||(e[t]=function(e){var t=document.body.style;if(e in t)return e;for(var r,o=n.length,a=e.charAt(0).toUpperCase()+e.slice(1);o--;)if((r=n[o]+a)in t)return r;return e}(t))}function r(n,e,r){e=t(e),n.style[e]=r}return function(n,e){var t,o,a=arguments;if(2==a.length)for(t in e)void 0!==(o=e[t])&&e.hasOwnProperty(t)&&r(n,t,o);else r(n,a[1],a[2])}}();function l(n,e){return("string"==typeof n?n:d(n)).indexOf(" "+e+" ")>=0}function c(n,e){var t=d(n),r=t+e;l(t,e)||(n.className=r.substring(1))}function u(n,e){var t,r=d(n);l(n,e)&&(t=r.replace(" "+e+" "," "),n.className=t.substring(1,t.length-1))}function d(n){return(" "+(n.className||"")+" ").replace(/\s+/gi," ")}function p(n){n&&n.parentNode&&n.parentNode.removeChild(n)}return t})?r.call(e,t,e,n):r)||(n.exports=o)},function(n){n.exports=JSON.parse('{"name":"vuepress-plugin-comment","version":"0.7.3","description":"Comment plugin in vuepress, such as Gitalk, Valine...","main":"index.js","scripts":{"test":"echo \\"Error: no test specified\\" && exit 1"},"repository":{"type":"git","url":"git+ssh://git@github.com/dongyuanxin/vuepress-plugin-comment.git"},"keywords":["vuepress","comment","plugin","vue","gitalk","valine"],"author":"dongyuanxin","license":"MIT","bugs":{"url":"https://github.com/dongyuanxin/vuepress-plugin-comment/issues"},"homepage":"https://github.com/dongyuanxin/vuepress-plugin-comment#readme","dependencies":{"ejs":"^2.6.1","gitalk":"^1.5.0","gitalk-fix":"^1.5.2","i":"^0.3.6","npm":"^6.9.0","valine":"^1.3.9"}}')},function(n,e,t){"use strict";var r=t(36),o=t(11),a=t(2),i=t(108),s=t(148),l=t(8),c=t(18),u=t(124),d=t(127),p=t(52),m=t(12),f=t(47),h=t(125),g=t(109),b=t(93),y=t(107),v=t(3),x=y.UNSUPPORTED_Y,w=Math.min,k=[].push,S=a(/./.exec),j=a(k),E=a("".slice);i("split",(function(n,e,t){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(n,t){var a=m(c(this)),i=void 0===t?4294967295:t>>>0;if(0===i)return[];if(void 0===n)return[a];if(!s(n))return o(e,a,n,i);for(var l,u,d,p=[],f=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")+(n.sticky?"y":""),g=0,y=new RegExp(n.source,f+"g");(l=o(b,y,a))&&!((u=y.lastIndex)>g&&(j(p,E(a,g,l.index)),l.length>1&&l.index<a.length&&r(k,p,h(l,1)),d=l[0].length,g=u,p.length>=i));)y.lastIndex===l.index&&y.lastIndex++;return g===a.length?!d&&S(y,"")||j(p,""):j(p,E(a,g)),p.length>i?h(p,0,i):p}:"0".split(void 0,0).length?function(n,t){return void 0===n&&0===t?[]:o(e,this,n,t)}:e,[function(e,t){var r=c(this),i=null==e?void 0:f(e,n);return i?o(i,e,r,t):o(a,m(r),e,t)},function(n,r){var o=l(this),i=m(n),s=t(a,o,i,r,a!==e);if(s.done)return s.value;var c=u(o,RegExp),f=o.unicode,h=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(x?"g":"y"),b=new c(x?"^(?:"+o.source+")":o,h),y=void 0===r?4294967295:r>>>0;if(0===y)return[];if(0===i.length)return null===g(b,i)?[i]:[];for(var v=0,k=0,S=[];k<i.length;){b.lastIndex=x?0:k;var A,I=g(b,x?E(i,k):i);if(null===I||(A=w(p(b.lastIndex+(x?k:0)),i.length))===v)k=d(i,k,f);else{if(j(S,E(i,v,k)),S.length===y)return S;for(var T=1;T<=I.length-1;T++)if(j(S,I[T]),S.length===y)return S;k=v=A}}return j(S,E(i,v)),S}]}),!!v((function(){var n=/(?:)/,e=n.exec;n.exec=function(){return e.apply(this,arguments)};var t="ab".split(n);return 2!==t.length||"a"!==t[0]||"b"!==t[1]})),x)},function(n,e,t){"use strict";var r=t(1),o=t(2),a=t(115).indexOf,i=t(46),s=o([].indexOf),l=!!s&&1/s([1],1,-0)<0,c=i("indexOf");r({target:"Array",proto:!0,forced:l||!c},{indexOf:function(n){var e=arguments.length>1?arguments[1]:void 0;return l?s(this,n,e)||0:a(this,n,e)}})},function(n,e,t){var r=t(3),o=t(5),a=/#|\.prototype\./,i=function(n,e){var t=l[s(n)];return t==u||t!=c&&(o(e)?r(e):!!e)},s=i.normalize=function(n){return String(n).replace(a,".").toLowerCase()},l=i.data={},c=i.NATIVE="N",u=i.POLYFILL="P";n.exports=i},function(n,e,t){var r=t(76),o=t(47),a=t(65),i=t(6)("iterator");n.exports=function(n){if(null!=n)return o(n,i)||o(n,"@@iterator")||a[r(n)]}},function(n,e,t){var r=t(3),o=t(0).RegExp,a=r((function(){var n=o("a","y");return n.lastIndex=2,null!=n.exec("abcd")})),i=a||r((function(){return!o("a","y").sticky})),s=a||r((function(){var n=o("^r","gy");return n.lastIndex=2,null!=n.exec("str")}));n.exports={BROKEN_CARET:s,MISSED_STICKY:i,UNSUPPORTED_Y:a}},function(n,e,t){"use strict";t(17);var r=t(2),o=t(14),a=t(93),i=t(3),s=t(6),l=t(27),c=s("species"),u=RegExp.prototype;n.exports=function(n,e,t,d){var p=s(n),m=!i((function(){var e={};return e[p]=function(){return 7},7!=""[n](e)})),f=m&&!i((function(){var e=!1,t=/a/;return"split"===n&&((t={}).constructor={},t.constructor[c]=function(){return t},t.flags="",t[p]=/./[p]),t.exec=function(){return e=!0,null},t[p](""),!e}));if(!m||!f||t){var h=r(/./[p]),g=e(p,""[n],(function(n,e,t,o,i){var s=r(n),l=e.exec;return l===a||l===u.exec?m&&!i?{done:!0,value:h(e,t,o)}:{done:!0,value:s(t,e,o)}:{done:!1}}));o(String.prototype,n,g[0]),o(u,p,g[1])}d&&l(u[p],"sham",!0)}},function(n,e,t){var r=t(0),o=t(11),a=t(8),i=t(5),s=t(25),l=t(93),c=r.TypeError;n.exports=function(n,e){var t=n.exec;if(i(t)){var r=o(t,n,e);return null!==r&&a(r),r}if("RegExp"===s(n))return o(l,n,e);throw c("RegExp#exec called on incompatible receiver")}},function(n,e,t){"use strict";var r=t(1),o=t(2),a=t(62),i=t(19),s=t(46),l=o([].join),c=a!=Object,u=s("join",",");r({target:"Array",proto:!0,forced:c||!u},{join:function(n){return l(i(this),void 0===n?",":n)}})},function(n,e,t){var r=t(0),o=t(112),a=r["__core-js_shared__"]||o("__core-js_shared__",{});n.exports=a},function(n,e,t){var r=t(0),o=Object.defineProperty;n.exports=function(n,e){try{o(r,n,{value:e,configurable:!0,writable:!0})}catch(t){r[n]=e}return e}},function(n,e,t){var r=t(51),o=t(3);n.exports=!!Object.getOwnPropertySymbols&&!o((function(){var n=Symbol();return!String(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},function(n,e,t){var r=t(7),o=t(157),a=t(13),i=t(8),s=t(19),l=t(85);e.f=r&&!o?Object.defineProperties:function(n,e){i(n);for(var t,r=s(e),o=l(e),c=o.length,u=0;c>u;)a.f(n,t=o[u++],r[t]);return n}},function(n,e,t){var r=t(19),o=t(116),a=t(22),i=function(n){return function(e,t,i){var s,l=r(e),c=a(l),u=o(i,c);if(n&&t!=t){for(;c>u;)if((s=l[u++])!=s)return!0}else for(;c>u;u++)if((n||u in l)&&l[u]===t)return n||u||0;return!n&&-1}};n.exports={includes:i(!0),indexOf:i(!1)}},function(n,e,t){var r=t(55),o=Math.max,a=Math.min;n.exports=function(n,e){var t=r(n);return t<0?o(t+e,0):a(t,e)}},function(n,e){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(n,e,t){"use strict";var r={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,a=o&&!r.call({1:2},1);e.f=a?function(n){var e=o(this,n);return!!e&&e.enumerable}:r},function(n,e,t){var r=t(10),o=t(120),a=t(38),i=t(13);n.exports=function(n,e,t){for(var s=o(e),l=i.f,c=a.f,u=0;u<s.length;u++){var d=s[u];r(n,d)||t&&r(t,d)||l(n,d,c(e,d))}}},function(n,e,t){var r=t(16),o=t(2),a=t(58),i=t(121),s=t(8),l=o([].concat);n.exports=r("Reflect","ownKeys")||function(n){var e=a.f(s(n)),t=i.f;return t?l(e,t(n)):e}},function(n,e){e.f=Object.getOwnPropertySymbols},function(n,e,t){var r=t(0),o=t(10),a=t(5),i=t(15),s=t(86),l=t(164),c=s("IE_PROTO"),u=r.Object,d=u.prototype;n.exports=l?u.getPrototypeOf:function(n){var e=i(n);if(o(e,c))return e[c];var t=e.constructor;return a(t)&&e instanceof t?t.prototype:e instanceof u?d:null}},function(n,e,t){var r={};r[t(6)("toStringTag")]="z",n.exports="[object z]"===String(r)},function(n,e,t){var r=t(8),o=t(169),a=t(6)("species");n.exports=function(n,e){var t,i=r(n).constructor;return void 0===i||null==(t=r(i)[a])?e:o(t)}},function(n,e,t){var r=t(0),o=t(116),a=t(22),i=t(69),s=r.Array,l=Math.max;n.exports=function(n,e,t){for(var r=a(n),c=o(e,r),u=o(void 0===t?r:t,r),d=s(l(u-c,0)),p=0;c<u;c++,p++)i(d,p,n[c]);return d.length=p,d}},function(n,e,t){t(186)("iterator")},function(n,e,t){"use strict";var r=t(174).charAt;n.exports=function(n,e,t){return e+(t?r(n,e).length:1)}},function(n,e,t){var r=t(272),o=t(49),a=Object.prototype,i=a.hasOwnProperty,s=a.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(n){return o(n)&&i.call(n,"callee")&&!s.call(n,"callee")};n.exports=l},function(n,e,t){var r=t(41)(t(33),"Map");n.exports=r},function(n,e){n.exports=function(n){var e=typeof n;return null!=n&&("object"==e||"function"==e)}},function(n,e,t){var r=t(292),o=t(299),a=t(301),i=t(302),s=t(303);function l(n){var e=-1,t=null==n?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=o,l.prototype.get=a,l.prototype.has=i,l.prototype.set=s,n.exports=l},function(n,e){n.exports=function(n){var e=-1,t=Array(n.size);return n.forEach((function(n){t[++e]=n})),t}},function(n,e){n.exports=function(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=9007199254740991}},function(n,e,t){var r=t(31),o=t(135),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;n.exports=function(n,e){if(r(n))return!1;var t=typeof n;return!("number"!=t&&"symbol"!=t&&"boolean"!=t&&null!=n&&!o(n))||(i.test(n)||!a.test(n)||null!=e&&n in Object(e))}},function(n,e,t){var r=t(61),o=t(49);n.exports=function(n){return"symbol"==typeof n||o(n)&&"[object Symbol]"==r(n)}},function(n,e){n.exports=function(n){return n}},function(n,e,t){var r=t(1),o=t(0),a=t(59);r({global:!0},{Reflect:{}}),a(o.Reflect,"Reflect",!0)},function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));t(77);t(70),t(92),t(4),t(126),t(21),t(24);var r=t(100);t(40),t(30);function o(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var r,o,a=[],i=!0,s=!1;try{for(t=t.call(n);!(i=(r=t.next()).done)&&(a.push(r.value),!e||a.length!==e);i=!0);}catch(n){s=!0,o=n}finally{try{i||null==t.return||t.return()}finally{if(s)throw o}}return a}}(n,e)||Object(r.a)(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(n,e,t){"use strict";var r=t(1),o=t(57).some;r({target:"Array",proto:!0,forced:!t(46)("some")},{some:function(n){return o(this,n,arguments.length>1?arguments[1]:void 0)}})},function(n,e,t){"use strict";var r=t(11),o=t(108),a=t(8),i=t(52),s=t(12),l=t(18),c=t(47),u=t(127),d=t(109);o("match",(function(n,e,t){return[function(e){var t=l(this),o=null==e?void 0:c(e,n);return o?r(o,e,t):new RegExp(e)[n](s(t))},function(n){var r=a(this),o=s(n),l=t(e,r,o);if(l.done)return l.value;if(!r.global)return d(r,o);var c=r.unicode;r.lastIndex=0;for(var p,m=[],f=0;null!==(p=d(r,o));){var h=s(p[0]);m[f]=h,""===h&&(r.lastIndex=u(o,i(r.lastIndex),c)),f++}return 0===f?null:m}]}))},function(n,e,t){var r=t(6),o=t(34),a=t(13),i=r("unscopables"),s=Array.prototype;null==s[i]&&a.f(s,i,{configurable:!0,value:o(null)}),n.exports=function(n){s[i][n]=!0}},function(n,e,t){var r=function(n){"use strict";var e=Object.prototype,t=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag";function s(n,e,t){return Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}),n[e]}try{s({},"")}catch(n){s=function(n,e,t){return n[e]=t}}function l(n,e,t,r){var o=e&&e.prototype instanceof d?e:d,a=Object.create(o.prototype),i=new S(r||[]);return a._invoke=function(n,e,t){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return E()}for(t.method=o,t.arg=a;;){var i=t.delegate;if(i){var s=x(i,t);if(s){if(s===u)continue;return s}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if("suspendedStart"===r)throw r="completed",t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);r="executing";var l=c(n,e,t);if("normal"===l.type){if(r=t.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:t.done}}"throw"===l.type&&(r="completed",t.method="throw",t.arg=l.arg)}}}(n,t,i),a}function c(n,e,t){try{return{type:"normal",arg:n.call(e,t)}}catch(n){return{type:"throw",arg:n}}}n.wrap=l;var u={};function d(){}function p(){}function m(){}var f={};s(f,o,(function(){return this}));var h=Object.getPrototypeOf,g=h&&h(h(j([])));g&&g!==e&&t.call(g,o)&&(f=g);var b=m.prototype=d.prototype=Object.create(f);function y(n){["next","throw","return"].forEach((function(e){s(n,e,(function(n){return this._invoke(e,n)}))}))}function v(n,e){var r;this._invoke=function(o,a){function i(){return new e((function(r,i){!function r(o,a,i,s){var l=c(n[o],n,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==typeof d&&t.call(d,"__await")?e.resolve(d.__await).then((function(n){r("next",n,i,s)}),(function(n){r("throw",n,i,s)})):e.resolve(d).then((function(n){u.value=n,i(u)}),(function(n){return r("throw",n,i,s)}))}s(l.arg)}(o,a,r,i)}))}return r=r?r.then(i,i):i()}}function x(n,e){var t=n.iterator[e.method];if(void 0===t){if(e.delegate=null,"throw"===e.method){if(n.iterator.return&&(e.method="return",e.arg=void 0,x(n,e),"throw"===e.method))return u;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=c(t,n.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,u;var o=r.arg;return o?o.done?(e[n.resultName]=o.value,e.next=n.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,u):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,u)}function w(n){var e={tryLoc:n[0]};1 in n&&(e.catchLoc=n[1]),2 in n&&(e.finallyLoc=n[2],e.afterLoc=n[3]),this.tryEntries.push(e)}function k(n){var e=n.completion||{};e.type="normal",delete e.arg,n.completion=e}function S(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(w,this),this.reset(!0)}function j(n){if(n){var e=n[o];if(e)return e.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var r=-1,a=function e(){for(;++r<n.length;)if(t.call(n,r))return e.value=n[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:E}}function E(){return{value:void 0,done:!0}}return p.prototype=m,s(b,"constructor",m),s(m,"constructor",p),p.displayName=s(m,i,"GeneratorFunction"),n.isGeneratorFunction=function(n){var e="function"==typeof n&&n.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,m):(n.__proto__=m,s(n,i,"GeneratorFunction")),n.prototype=Object.create(b),n},n.awrap=function(n){return{__await:n}},y(v.prototype),s(v.prototype,a,(function(){return this})),n.AsyncIterator=v,n.async=function(e,t,r,o,a){void 0===a&&(a=Promise);var i=new v(l(e,t,r,o),a);return n.isGeneratorFunction(t)?i:i.next().then((function(n){return n.done?n.value:i.next()}))},y(b),s(b,i,"Generator"),s(b,o,(function(){return this})),s(b,"toString",(function(){return"[object Generator]"})),n.keys=function(n){var e=[];for(var t in n)e.push(t);return e.reverse(),function t(){for(;e.length;){var r=e.pop();if(r in n)return t.value=r,t.done=!1,t}return t.done=!0,t}},n.values=j,S.prototype={constructor:S,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!n)for(var e in this)"t"===e.charAt(0)&&t.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var e=this;function r(t,r){return i.type="throw",i.arg=n,e.next=t,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=t.call(a,"catchLoc"),l=t.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(n,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&t.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===n||"continue"===n)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=n,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,u):this.complete(i)},complete:function(n,e){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&e&&(this.next=e),u},finish:function(n){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===n)return this.complete(t.completion,t.afterLoc),k(t),u}},catch:function(n){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===n){var r=t.completion;if("throw"===r.type){var o=r.arg;k(t)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(n,e,t){return this.delegate={iterator:j(n),resultName:e,nextLoc:t},"next"===this.method&&(this.arg=void 0),u}},n}(n.exports);try{regeneratorRuntime=r}catch(n){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},function(n,e,t){"use strict";var r=t(2),o=t(66).PROPER,a=t(14),i=t(8),s=t(35),l=t(12),c=t(3),u=t(149),d=RegExp.prototype,p=d.toString,m=r(u),f=c((function(){return"/a/b"!=p.call({source:"a",flags:"b"})})),h=o&&"toString"!=p.name;(f||h)&&a(RegExp.prototype,"toString",(function(){var n=i(this),e=l(n.source),t=n.flags;return"/"+e+"/"+l(void 0===t&&s(d,n)&&!("flags"in d)?m(n):t)}),{unsafe:!0})},function(n,e,t){"use strict";var r=t(19),o=t(141),a=t(65),i=t(39),s=t(13).f,l=t(162),c=t(26),u=t(7),d=i.set,p=i.getterFor("Array Iterator");n.exports=l(Array,"Array",(function(n,e){d(this,{type:"Array Iterator",target:r(n),index:0,kind:e})}),(function(){var n=p(this),e=n.target,t=n.kind,r=n.index++;return!e||r>=e.length?(n.target=void 0,{value:void 0,done:!0}):"keys"==t?{value:r,done:!1}:"values"==t?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values");var m=a.Arguments=a.Array;if(o("keys"),o("values"),o("entries"),!c&&u&&"values"!==m.name)try{s(m,"name",{value:"values"})}catch(n){}},function(n,e,t){var r=t(0),o=t(11),a=t(37),i=t(8),s=t(84),l=t(106),c=r.TypeError;n.exports=function(n,e){var t=arguments.length<2?l(n):e;if(a(t))return i(o(t,n));throw c(s(n)+" is not iterable")}},function(n,e,t){var r=t(0).TypeError;n.exports=function(n,e){if(n<e)throw r("Not enough arguments");return n}},function(n,e,t){var r=t(254);n.exports=function(n,e){return new(r(n))(0===e?0:e)}},function(n,e,t){var r=t(9),o=t(25),a=t(6)("match");n.exports=function(n){var e;return r(n)&&(void 0!==(e=n[a])?!!e:"RegExp"==o(n))}},function(n,e,t){"use strict";var r=t(8);n.exports=function(){var n=r(this),e="";return n.global&&(e+="g"),n.ignoreCase&&(e+="i"),n.multiline&&(e+="m"),n.dotAll&&(e+="s"),n.unicode&&(e+="u"),n.sticky&&(e+="y"),e}},function(n,e,t){var r=t(5),o=t(9),a=t(67);n.exports=function(n,e,t){var i,s;return a&&r(i=e.constructor)&&i!==t&&o(s=i.prototype)&&s!==t.prototype&&a(n,s),n}},function(n,e){n.exports=function(n){return n.webpackPolyfill||(n.deprecate=function(){},n.paths=[],n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),n.webpackPolyfill=1),n}},function(n,e){var t=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,i=parseInt,s="object"==typeof global&&global&&global.Object===Object&&global,l="object"==typeof self&&self&&self.Object===Object&&self,c=s||l||Function("return this")(),u=Object.prototype.toString,d=Math.max,p=Math.min,m=function(){return c.Date.now()};function f(n){var e=typeof n;return!!n&&("object"==e||"function"==e)}function h(n){if("number"==typeof n)return n;if(function(n){return"symbol"==typeof n||function(n){return!!n&&"object"==typeof n}(n)&&"[object Symbol]"==u.call(n)}(n))return NaN;if(f(n)){var e="function"==typeof n.valueOf?n.valueOf():n;n=f(e)?e+"":e}if("string"!=typeof n)return 0===n?n:+n;n=n.replace(t,"");var s=o.test(n);return s||a.test(n)?i(n.slice(2),s?2:8):r.test(n)?NaN:+n}n.exports=function(n,e,t){var r,o,a,i,s,l,c=0,u=!1,g=!1,b=!0;if("function"!=typeof n)throw new TypeError("Expected a function");function y(e){var t=r,a=o;return r=o=void 0,c=e,i=n.apply(a,t)}function v(n){return c=n,s=setTimeout(w,e),u?y(n):i}function x(n){var t=n-l;return void 0===l||t>=e||t<0||g&&n-c>=a}function w(){var n=m();if(x(n))return k(n);s=setTimeout(w,function(n){var t=e-(n-l);return g?p(t,a-(n-c)):t}(n))}function k(n){return s=void 0,b&&r?y(n):(r=o=void 0,i)}function S(){var n=m(),t=x(n);if(r=arguments,o=this,l=n,t){if(void 0===s)return v(l);if(g)return s=setTimeout(w,e),y(l)}return void 0===s&&(s=setTimeout(w,e)),i}return e=h(e)||0,f(t)&&(u=!!t.leading,a=(g="maxWait"in t)?d(h(t.maxWait)||0,e):a,b="trailing"in t?!!t.trailing:b),S.cancel=function(){void 0!==s&&clearTimeout(s),c=0,r=l=o=s=void 0},S.flush=function(){return void 0===s?i:k(m())},S}},function(n,e,t){var r=t(2),o=t(18),a=t(12),i=t(154),s=r("".replace),l="["+i+"]",c=RegExp("^"+l+l+"*"),u=RegExp(l+l+"*$"),d=function(n){return function(e){var t=a(o(e));return 1&n&&(t=s(t,c,"")),2&n&&(t=s(t,u,"")),t}};n.exports={start:d(1),end:d(2),trim:d(3)}},function(n,e){n.exports="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff"},function(n,e,t){var r=t(2),o=t(14),a=Date.prototype,i=r(a.toString),s=r(a.getTime);"Invalid Date"!=String(new Date(NaN))&&o(a,"toString",(function(){var n=s(this);return n==n?i(this):"Invalid Date"}))},function(n,e,t){var r=t(113);n.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(n,e,t){var r=t(7),o=t(3);n.exports=r&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(n,e,t){var r=t(7),o=t(3),a=t(81);n.exports=!r&&!o((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},function(n,e,t){var r=t(0),o=t(11),a=t(9),i=t(83),s=t(47),l=t(238),c=t(6),u=r.TypeError,d=c("toPrimitive");n.exports=function(n,e){if(!a(n)||i(n))return n;var t,r=s(n,d);if(r){if(void 0===e&&(e="default"),t=o(r,n,e),!a(t)||i(t))return t;throw u("Can't convert object to primitive value")}return void 0===e&&(e="number"),l(n,e)}},function(n,e,t){var r=t(2),o=t(10),a=t(19),i=t(115).indexOf,s=t(64),l=r([].push);n.exports=function(n,e){var t,r=a(n),c=0,u=[];for(t in r)!o(s,t)&&o(r,t)&&l(u,t);for(;e.length>c;)o(r,t=e[c++])&&(~i(u,t)||l(u,t));return u}},function(n,e,t){var r=t(16);n.exports=r("document","documentElement")},function(n,e,t){"use strict";var r=t(1),o=t(11),a=t(26),i=t(66),s=t(5),l=t(226),c=t(122),u=t(67),d=t(59),p=t(27),m=t(14),f=t(6),h=t(65),g=t(163),b=i.PROPER,y=i.CONFIGURABLE,v=g.IteratorPrototype,x=g.BUGGY_SAFARI_ITERATORS,w=f("iterator"),k=function(){return this};n.exports=function(n,e,t,i,f,g,S){l(t,e,i);var j,E,A,I=function(n){if(n===f&&P)return P;if(!x&&n in _)return _[n];switch(n){case"keys":case"values":case"entries":return function(){return new t(this,n)}}return function(){return new t(this)}},T=e+" Iterator",z=!1,_=n.prototype,C=_[w]||_["@@iterator"]||f&&_[f],P=!x&&C||I(f),O="Array"==e&&_.entries||C;if(O&&(j=c(O.call(new n)))!==Object.prototype&&j.next&&(a||c(j)===v||(u?u(j,v):s(j[w])||m(j,w,k)),d(j,T,!0,!0),a&&(h[T]=k)),b&&"values"==f&&C&&"values"!==C.name&&(!a&&y?p(_,"name","values"):(z=!0,P=function(){return o(C,this)})),f)if(E={values:I("values"),keys:g?P:I("keys"),entries:I("entries")},S)for(A in E)(x||z||!(A in _))&&m(_,A,E[A]);else r({target:e,proto:!0,forced:x||z},E);return a&&!S||_[w]===P||m(_,w,P,{name:f}),h[e]=P,E}},function(n,e,t){"use strict";var r,o,a,i=t(3),s=t(5),l=t(34),c=t(122),u=t(14),d=t(6),p=t(26),m=d("iterator"),f=!1;[].keys&&("next"in(a=[].keys())?(o=c(c(a)))!==Object.prototype&&(r=o):f=!0),null==r||i((function(){var n={};return r[m].call(n)!==n}))?r={}:p&&(r=l(r)),s(r[m])||u(r,m,(function(){return this})),n.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:f}},function(n,e,t){var r=t(3);n.exports=!r((function(){function n(){}return n.prototype.constructor=null,Object.getPrototypeOf(new n)!==n.prototype}))},function(n,e,t){var r=t(0);n.exports=r.Promise},function(n,e,t){var r=t(6),o=t(65),a=r("iterator"),i=Array.prototype;n.exports=function(n){return void 0!==n&&(o.Array===n||i[a]===n)}},function(n,e,t){var r=t(11),o=t(8),a=t(47);n.exports=function(n,e,t){var i,s;o(n);try{if(!(i=a(n,"return"))){if("throw"===e)throw t;return t}i=r(i,n)}catch(n){s=!0,i=n}if("throw"===e)throw t;if(s)throw i;return o(i),t}},function(n,e,t){var r=t(6)("iterator"),o=!1;try{var a=0,i={next:function(){return{done:!!a++}},return:function(){o=!0}};i[r]=function(){return this},Array.from(i,(function(){throw 2}))}catch(n){}n.exports=function(n,e){if(!e&&!o)return!1;var t=!1;try{var a={};a[r]=function(){return{next:function(){return{done:t=!0}}}},n(a)}catch(n){}return t}},function(n,e,t){var r=t(0),o=t(88),a=t(84),i=r.TypeError;n.exports=function(n){if(o(n))return n;throw i(a(n)+" is not a constructor")}},function(n,e,t){var r,o,a,i,s=t(0),l=t(36),c=t(56),u=t(5),d=t(10),p=t(3),m=t(161),f=t(68),h=t(81),g=t(146),b=t(171),y=t(89),v=s.setImmediate,x=s.clearImmediate,w=s.process,k=s.Dispatch,S=s.Function,j=s.MessageChannel,E=s.String,A=0,I={};try{r=s.location}catch(n){}var T=function(n){if(d(I,n)){var e=I[n];delete I[n],e()}},z=function(n){return function(){T(n)}},_=function(n){T(n.data)},C=function(n){s.postMessage(E(n),r.protocol+"//"+r.host)};v&&x||(v=function(n){g(arguments.length,1);var e=u(n)?n:S(n),t=f(arguments,1);return I[++A]=function(){l(e,void 0,t)},o(A),A},x=function(n){delete I[n]},y?o=function(n){w.nextTick(z(n))}:k&&k.now?o=function(n){k.now(z(n))}:j&&!b?(i=(a=new j).port2,a.port1.onmessage=_,o=c(i.postMessage,i)):s.addEventListener&&u(s.postMessage)&&!s.importScripts&&r&&"file:"!==r.protocol&&!p(C)?(o=C,s.addEventListener("message",_,!1)):o="onreadystatechange"in h("script")?function(n){m.appendChild(h("script")).onreadystatechange=function(){m.removeChild(this),T(n)}}:function(n){setTimeout(z(n),0)}),n.exports={set:v,clear:x}},function(n,e,t){var r=t(32);n.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},function(n,e,t){var r=t(8),o=t(9),a=t(173);n.exports=function(n,e){if(r(n),o(e)&&e.constructor===n)return e;var t=a.f(n);return(0,t.resolve)(e),t.promise}},function(n,e,t){"use strict";var r=t(37),o=function(n){var e,t;this.promise=new n((function(n,r){if(void 0!==e||void 0!==t)throw TypeError("Bad Promise constructor");e=n,t=r})),this.resolve=r(e),this.reject=r(t)};n.exports.f=function(n){return new o(n)}},function(n,e,t){var r=t(2),o=t(55),a=t(12),i=t(18),s=r("".charAt),l=r("".charCodeAt),c=r("".slice),u=function(n){return function(e,t){var r,u,d=a(i(e)),p=o(t),m=d.length;return p<0||p>=m?n?"":void 0:(r=l(d,p))<55296||r>56319||p+1===m||(u=l(d,p+1))<56320||u>57343?n?s(d,p):r:n?c(d,p,p+2):u-56320+(r-55296<<10)+65536}};n.exports={codeAt:u(!1),charAt:u(!0)}},function(n,e){n.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(n,e,t){var r=t(81)("span").classList,o=r&&r.constructor&&r.constructor.prototype;n.exports=o===Object.prototype?void 0:o},function(n,e,t){var r=t(1),o=t(7),a=t(120),i=t(19),s=t(38),l=t(69);r({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(n){for(var e,t,r=i(n),o=s.f,c=a(r),u={},d=0;c.length>d;)void 0!==(t=o(r,e=c[d++]))&&l(u,e,t);return u}})},function(n,e,t){var r=t(1),o=t(3),a=t(15),i=t(122),s=t(164);r({target:"Object",stat:!0,forced:o((function(){i(1)})),sham:!s},{getPrototypeOf:function(n){return i(a(n))}})},function(n,e,t){"use strict";var r,o=t(1),a=t(2),i=t(38).f,s=t(52),l=t(12),c=t(180),u=t(18),d=t(181),p=t(26),m=a("".startsWith),f=a("".slice),h=Math.min,g=d("startsWith");o({target:"String",proto:!0,forced:!!(p||g||(r=i(String.prototype,"startsWith"),!r||r.writable))&&!g},{startsWith:function(n){var e=l(u(this));c(n);var t=s(h(arguments.length>1?arguments[1]:void 0,e.length)),r=l(n);return m?m(e,r,t):f(e,t,t+r.length)===r}})},function(n,e,t){var r=t(0),o=t(148),a=r.TypeError;n.exports=function(n){if(o(n))throw a("The method doesn't accept regular expressions");return n}},function(n,e,t){var r=t(6)("match");n.exports=function(n){var e=/./;try{"/./"[n](e)}catch(t){try{return e[r]=!1,"/./"[n](e)}catch(n){}}return!1}},function(n,e,t){"use strict";var r=t(57).forEach,o=t(46)("forEach");n.exports=o?[].forEach:function(n){return r(this,n,arguments.length>1?arguments[1]:void 0)}},function(n,e,t){var r=t(3);n.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(n,e,t){var r=t(25),o=t(19),a=t(58).f,i=t(125),s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(n){return s&&"Window"==r(n)?function(n){try{return a(n)}catch(n){return i(s)}}(n):a(o(n))}},function(n,e,t){var r=t(6);e.f=r},function(n,e,t){var r=t(261),o=t(10),a=t(185),i=t(13).f;n.exports=function(n){var e=r.Symbol||(r.Symbol={});o(e,n)||i(e,n,{value:a.f(n)})}},function(n,e,t){var r=t(1),o=t(262);r({target:"Array",stat:!0,forced:!t(168)((function(n){Array.from(n)}))},{from:o})},function(n,e,t){var r=t(12);n.exports=function(n,e){return void 0===n?arguments.length<2?"":e:r(n)}},function(n,e,t){t(1)({target:"Object",stat:!0,sham:!t(7)},{create:t(34)})},function(n,e,t){var r=t(1),o=t(0),a=t(16),i=t(36),s=t(2),l=t(3),c=o.Array,u=a("JSON","stringify"),d=s(/./.exec),p=s("".charAt),m=s("".charCodeAt),f=s("".replace),h=s(1..toString),g=/[\uD800-\uDFFF]/g,b=/^[\uD800-\uDBFF]$/,y=/^[\uDC00-\uDFFF]$/,v=function(n,e,t){var r=p(t,e-1),o=p(t,e+1);return d(b,n)&&!d(y,o)||d(y,n)&&!d(b,r)?"\\u"+h(m(n,0),16):n},x=l((function(){return'"\\udf06\\ud834"'!==u("\udf06\ud834")||'"\\udead"'!==u("\udead")}));u&&r({target:"JSON",stat:!0,forced:x},{stringify:function(n,e,t){for(var r=0,o=arguments.length,a=c(o);r<o;r++)a[r]=arguments[r];var s=i(u,null,a);return"string"==typeof s?f(s,g,v):s}})},function(n,e){n.exports=function(n,e){for(var t=-1,r=e.length,o=n.length;++t<r;)n[o+t]=e[t];return n}},function(n,e){var t="object"==typeof global&&global&&global.Object===Object&&global;n.exports=t},function(n,e,t){var r=t(94),o=t(283),a=t(284),i=t(285),s=t(286),l=t(287);function c(n){var e=this.__data__=new r(n);this.size=e.size}c.prototype.clear=o,c.prototype.delete=a,c.prototype.get=i,c.prototype.has=s,c.prototype.set=l,n.exports=c},function(n,e){n.exports=function(n,e){return n===e||n!=n&&e!=e}},function(n,e,t){var r=t(61),o=t(130);n.exports=function(n){if(!o(n))return!1;var e=r(n);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(n,e){var t=Function.prototype.toString;n.exports=function(n){if(null!=n){try{return t.call(n)}catch(n){}try{return n+""}catch(n){}}return""}},function(n,e,t){var r=t(304),o=t(49);n.exports=function n(e,t,a,i,s){return e===t||(null==e||null==t||!o(e)&&!o(t)?e!=e&&t!=t:r(e,t,a,i,n,s))}},function(n,e,t){var r=t(199),o=t(307),a=t(200);n.exports=function(n,e,t,i,s,l){var c=1&t,u=n.length,d=e.length;if(u!=d&&!(c&&d>u))return!1;var p=l.get(n),m=l.get(e);if(p&&m)return p==e&&m==n;var f=-1,h=!0,g=2&t?new r:void 0;for(l.set(n,e),l.set(e,n);++f<u;){var b=n[f],y=e[f];if(i)var v=c?i(y,b,f,e,n,l):i(b,y,f,n,e,l);if(void 0!==v){if(v)continue;h=!1;break}if(g){if(!o(e,(function(n,e){if(!a(g,e)&&(b===n||s(b,n,t,i,l)))return g.push(e)}))){h=!1;break}}else if(b!==y&&!s(b,y,t,i,l)){h=!1;break}}return l.delete(n),l.delete(e),h}},function(n,e,t){var r=t(131),o=t(305),a=t(306);function i(n){var e=-1,t=null==n?0:n.length;for(this.__data__=new r;++e<t;)this.add(n[e])}i.prototype.add=i.prototype.push=o,i.prototype.has=a,n.exports=i},function(n,e){n.exports=function(n,e){return n.has(e)}},function(n,e,t){var r=t(317),o=t(323),a=t(205);n.exports=function(n){return a(n)?r(n):o(n)}},function(n,e,t){(function(n){var r=t(33),o=t(319),a=e&&!e.nodeType&&e,i=a&&"object"==typeof n&&n&&!n.nodeType&&n,s=i&&i.exports===a?r.Buffer:void 0,l=(s?s.isBuffer:void 0)||o;n.exports=l}).call(this,t(151)(n))},function(n,e){var t=/^(?:0|[1-9]\d*)$/;n.exports=function(n,e){var r=typeof n;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&t.test(n))&&n>-1&&n%1==0&&n<e}},function(n,e,t){var r=t(320),o=t(321),a=t(322),i=a&&a.isTypedArray,s=i?o(i):r;n.exports=s},function(n,e,t){var r=t(195),o=t(133);n.exports=function(n){return null!=n&&o(n.length)&&!r(n)}},function(n,e,t){var r=t(41)(t(33),"Set");n.exports=r},function(n,e,t){var r=t(130);n.exports=function(n){return n==n&&!r(n)}},function(n,e){n.exports=function(n,e){return function(t){return null!=t&&(t[n]===e&&(void 0!==e||n in Object(t)))}}},function(n,e,t){var r=t(210),o=t(98);n.exports=function(n,e){for(var t=0,a=(e=r(e,n)).length;null!=n&&t<a;)n=n[o(e[t++])];return t&&t==a?n:void 0}},function(n,e,t){var r=t(31),o=t(134),a=t(334),i=t(337);n.exports=function(n,e){return r(n)?n:o(n,e)?[n]:a(i(n))}},function(n,e,t){"use strict";var r=t(0),o=t(2),a=t(37),i=t(9),s=t(10),l=t(68),c=t(63),u=r.Function,d=o([].concat),p=o([].join),m={},f=function(n,e,t){if(!s(m,e)){for(var r=[],o=0;o<e;o++)r[o]="a["+o+"]";m[e]=u("C,a","return new C("+p(r,",")+")")}return m[e](n,t)};n.exports=c?u.bind:function(n){var e=a(this),t=e.prototype,r=l(arguments,1),o=function(){var t=d(r,l(arguments));return this instanceof o?f(e,t.length,t):e.apply(n,t)};return i(t)&&(o.prototype=t),o}},function(n,e,t){"use strict";var r=t(1),o=t(369).start;r({target:"String",proto:!0,forced:t(371)},{padStart:function(n){return o(this,n,arguments.length>1?arguments[1]:void 0)}})},function(n,e,t){},function(n,e,t){},function(n,e,t){t(1)({target:"Object",stat:!0},{setPrototypeOf:t(67)})},function(n,e,t){var r=t(1),o=t(16),a=t(36),i=t(211),s=t(169),l=t(8),c=t(9),u=t(34),d=t(3),p=o("Reflect","construct"),m=Object.prototype,f=[].push,h=d((function(){function n(){}return!(p((function(){}),[],n)instanceof n)})),g=!d((function(){p((function(){}))})),b=h||g;r({target:"Reflect",stat:!0,forced:b,sham:b},{construct:function(n,e){s(n),l(e);var t=arguments.length<3?n:s(arguments[2]);if(g&&!h)return p(n,e,t);if(n==t){switch(e.length){case 0:return new n;case 1:return new n(e[0]);case 2:return new n(e[0],e[1]);case 3:return new n(e[0],e[1],e[2]);case 4:return new n(e[0],e[1],e[2],e[3])}var r=[null];return a(f,r,e),new(a(i,n,r))}var o=t.prototype,d=u(c(o)?o:m),b=a(n,d,e);return c(b)?b:d}})},function(n,e,t){},function(n,e,t){},function(n,e,t){var r=t(270),o=t(275),a=t(346),i=t(354),s=t(363),l=t(233),c=a((function(n){var e=l(n);return s(e)&&(e=void 0),i(r(n,1,s,!0),o(e,2))}));n.exports=c},function(n,e,t){"use strict";
/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */var r=/["'&<>]/;n.exports=function(n){var e,t=""+n,o=r.exec(t);if(!o)return t;var a="",i=0,s=0;for(i=o.index;i<t.length;i++){switch(t.charCodeAt(i)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#39;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}s!==i&&(a+=t.substring(s,i)),s=i+1,a+=e}return s!==i?a+t.substring(s,i):a}},function(n,e,t){"use strict";
/**
 * @file Embedded JavaScript templating engine. {@link http://ejs.co}
 * @author Matthew Eernisse <mde@fleegix.org>
 * @author Tiancheng "Timothy" Gu <timothygu99@gmail.com>
 * @project EJS
 * @license {@link http://www.apache.org/licenses/LICENSE-2.0 Apache License, Version 2.0}
 */var r=t(383),o=t(384),a=t(385),i=!1,s=t(386).version,l=["delimiter","scope","context","debug","compileDebug","client","_with","rmWhitespace","strict","filename","async"],c=l.concat("cache"),u=/^\uFEFF/;function d(n,t){var o,a,i=t.views,s=/^[A-Za-z]+:\\|^\//.exec(n);if(s&&s.length)o=e.resolveInclude(n.replace(/^\/*/,""),t.root||"/",!0);else if(t.filename&&(a=e.resolveInclude(n,t.filename),r.existsSync(a)&&(o=a)),o||Array.isArray(i)&&i.some((function(t){return a=e.resolveInclude(n,t,!0),r.existsSync(a)}))&&(o=a),!o)throw new Error('Could not find the include file "'+t.escapeFunction(n)+'"');return o}function p(n,t){var r,o=n.filename,a=arguments.length>1;if(n.cache){if(!o)throw new Error("cache option requires a filename");if(r=e.cache.get(o))return r;a||(t=f(o).toString().replace(u,""))}else if(!a){if(!o)throw new Error("Internal EJS error: no file name or template provided");t=f(o).toString().replace(u,"")}return r=e.compile(t,n),n.cache&&e.cache.set(o,r),r}function m(n,t,r){var o;if(!r){if("function"==typeof e.promiseImpl)return new e.promiseImpl((function(e,r){try{e(o=p(n)(t))}catch(n){r(n)}}));throw new Error("Please provide a callback function")}try{o=p(n)(t)}catch(n){return r(n)}r(null,o)}function f(n){return e.fileLoader(n)}function h(n,e,t,r,o){var a=e.split("\n"),i=Math.max(r-3,0),s=Math.min(a.length,r+3),l=o(t),c=a.slice(i,s).map((function(n,e){var t=e+i+1;return(t==r?" >> ":"    ")+t+"| "+n})).join("\n");throw n.path=l,n.message=(l||"ejs")+":"+r+"\n"+c+"\n\n"+n.message,n}function g(n){return n.replace(/;(\s*$)/,"$1")}function b(n,t){t=t||{};var r={};this.templateText=n,this.mode=null,this.truncate=!1,this.currentLine=1,this.source="",this.dependencies=[],r.client=t.client||!1,r.escapeFunction=t.escape||t.escapeFunction||a.escapeXML,r.compileDebug=!1!==t.compileDebug,r.debug=!!t.debug,r.filename=t.filename,r.openDelimiter=t.openDelimiter||e.openDelimiter||"<",r.closeDelimiter=t.closeDelimiter||e.closeDelimiter||">",r.delimiter=t.delimiter||e.delimiter||"%",r.strict=t.strict||!1,r.context=t.context,r.cache=t.cache||!1,r.rmWhitespace=t.rmWhitespace,r.root=t.root,r.outputFunctionName=t.outputFunctionName,r.localsName=t.localsName||e.localsName||"locals",r.views=t.views,r.async=t.async,r.destructuredLocals=t.destructuredLocals,r.legacyInclude=void 0===t.legacyInclude||!!t.legacyInclude,r.strict?r._with=!1:r._with=void 0===t._with||t._with,this.opts=r,this.regex=this.createRegex()}e.cache=a.cache,e.fileLoader=r.readFileSync,e.localsName="locals",e.promiseImpl=new Function("return this;")().Promise,e.resolveInclude=function(n,e,t){var r=o.dirname,a=o.extname,i=(0,o.resolve)(t?e:r(e),n);return a(n)||(i+=".ejs"),i},e.compile=function(n,e){return e&&e.scope&&(i||(console.warn("`scope` option is deprecated and will be removed in EJS 3"),i=!0),e.context||(e.context=e.scope),delete e.scope),new b(n,e).compile()},e.render=function(n,e,t){var r=e||{},o=t||{};return 2==arguments.length&&a.shallowCopyFromList(o,r,l),p(o,n)(r)},e.renderFile=function(){var n,e,t,r=Array.prototype.slice.call(arguments),o=r.shift(),i={filename:o};return"function"==typeof arguments[arguments.length-1]&&(n=r.pop()),r.length?(e=r.shift(),r.length?a.shallowCopy(i,r.pop()):(e.settings&&(e.settings.views&&(i.views=e.settings.views),e.settings["view cache"]&&(i.cache=!0),(t=e.settings["view options"])&&a.shallowCopy(i,t)),a.shallowCopyFromList(i,e,c)),i.filename=o):e={},m(i,e,n)},e.Template=b,e.clearCache=function(){e.cache.reset()},b.modes={EVAL:"eval",ESCAPED:"escaped",RAW:"raw",COMMENT:"comment",LITERAL:"literal"},b.prototype={createRegex:function(){var n="(<%%|%%>|<%=|<%-|<%_|<%#|<%|%>|-%>|_%>)",e=a.escapeRegExpChars(this.opts.delimiter),t=a.escapeRegExpChars(this.opts.openDelimiter),r=a.escapeRegExpChars(this.opts.closeDelimiter);return n=n.replace(/%/g,e).replace(/</g,t).replace(/>/g,r),new RegExp(n)},compile:function(){var n,e,t,r=this.opts,i="",s="",l=r.escapeFunction;if(!this.source){if(this.generateSource(),i+='  var __output = "";\n  function __append(s) { if (s !== undefined && s !== null) __output += s }\n',r.outputFunctionName&&(i+="  var "+r.outputFunctionName+" = __append;\n"),r.destructuredLocals&&r.destructuredLocals.length){for(var c="  var __locals = ("+r.localsName+" || {}),\n",u=0;u<r.destructuredLocals.length;u++){var m=r.destructuredLocals[u];u>0&&(c+=",\n  "),c+=m+" = __locals."+m}i+=c+";\n"}!1!==r._with&&(i+="  with ("+r.localsName+" || {}) {\n",s+="  }\n"),s+="  return __output;\n",this.source=i+this.source+s}n=r.compileDebug?"var __line = 1\n  , __lines = "+JSON.stringify(this.templateText)+"\n  , __filename = "+(r.filename?JSON.stringify(r.filename):"undefined")+";\ntry {\n"+this.source+"} catch (e) {\n  rethrow(e, __lines, __filename, __line, escapeFn);\n}\n":this.source,r.client&&(n="escapeFn = escapeFn || "+l.toString()+";\n"+n,r.compileDebug&&(n="rethrow = rethrow || "+h.toString()+";\n"+n)),r.strict&&(n='"use strict";\n'+n),r.debug&&console.log(n),r.compileDebug&&r.filename&&(n=n+"\n//# sourceURL="+r.filename+"\n");try{if(r.async)try{t=new Function("return (async function(){}).constructor;")()}catch(n){throw n instanceof SyntaxError?new Error("This environment does not support async/await"):n}else t=Function;e=new t(r.localsName+", escapeFn, include, rethrow",n)}catch(n){throw n instanceof SyntaxError&&(r.filename&&(n.message+=" in "+r.filename),n.message+=" while compiling ejs\n\n",n.message+="If the above error is not helpful, you may want to try EJS-Lint:\n",n.message+="https://github.com/RyanZim/EJS-Lint",r.async||(n.message+="\n",n.message+="Or, if you meant to create an async function, pass `async: true` as an option.")),n}var f=r.client?e:function(n){return e.apply(r.context,[n||{},l,function(e,t){var o=a.shallowCopy({},n);return t&&(o=a.shallowCopy(o,t)),function(n,e){var t=a.shallowCopy({},e);return t.filename=d(n,t),p(t)}(e,r)(o)},h])};if(f.dependencies=this.dependencies,r.filename&&"function"==typeof Object.defineProperty){var g=r.filename,b=o.basename(g,o.extname(g));try{Object.defineProperty(f,"name",{value:b,writable:!1,enumerable:!1,configurable:!0})}catch(n){}}return f},generateSource:function(){var n=this.opts;n.rmWhitespace&&(this.templateText=this.templateText.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),this.templateText=this.templateText.replace(/[ \t]*<%_/gm,"<%_").replace(/_%>[ \t]*/gm,"_%>");var t=this,r=this.parseTemplateText(),o=this.opts.delimiter,i=this.opts.openDelimiter,s=this.opts.closeDelimiter;r&&r.length&&r.forEach((function(l,c){var p,m,h,g,y,v;if(0===l.indexOf(i+o)&&0!==l.indexOf(i+o+o)&&(m=r[c+2])!=o+s&&m!="-"+o+s&&m!="_"+o+s)throw new Error('Could not find matching close tag for "'+l+'".');if(n.legacyInclude&&(h=l.match(/^\s*include\s+(\S+)/))&&(p=r[c-1])&&(p==i+o||p==i+o+"-"||p==i+o+"_"))return g=a.shallowCopy({},t.opts),y=function(n,e){var t,r,o=a.shallowCopy({},e);r=f(t=d(n,o)).toString().replace(u,""),o.filename=t;var i=new b(r,o);return i.generateSource(),{source:i.source,filename:t,template:r}}(h[1],g),v=t.opts.compileDebug?"    ; (function(){\n      var __line = 1\n      , __lines = "+JSON.stringify(y.template)+"\n      , __filename = "+JSON.stringify(y.filename)+";\n      try {\n"+y.source+"      } catch (e) {\n        rethrow(e, __lines, __filename, __line, escapeFn);\n      }\n    ; }).call(this)\n":"    ; (function(){\n"+y.source+"    ; }).call(this)\n",t.source+=v,void t.dependencies.push(e.resolveInclude(h[1],g.filename));t.scanLine(l)}))},parseTemplateText:function(){for(var n,e=this.templateText,t=this.regex,r=t.exec(e),o=[];r;)0!==(n=r.index)&&(o.push(e.substring(0,n)),e=e.slice(n)),o.push(r[0]),e=e.slice(r[0].length),r=t.exec(e);return e&&o.push(e),o},_addOutput:function(n){if(this.truncate&&(n=n.replace(/^(?:\r\n|\r|\n)/,""),this.truncate=!1),!n)return n;n=(n=(n=(n=n.replace(/\\/g,"\\\\")).replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/"/g,'\\"'),this.source+='    ; __append("'+n+'")\n'},scanLine:function(n){var e,t=this.opts.delimiter,r=this.opts.openDelimiter,o=this.opts.closeDelimiter;switch(e=n.split("\n").length-1,n){case r+t:case r+t+"_":this.mode=b.modes.EVAL;break;case r+t+"=":this.mode=b.modes.ESCAPED;break;case r+t+"-":this.mode=b.modes.RAW;break;case r+t+"#":this.mode=b.modes.COMMENT;break;case r+t+t:this.mode=b.modes.LITERAL,this.source+='    ; __append("'+n.replace(r+t+t,r+t)+'")\n';break;case t+t+o:this.mode=b.modes.LITERAL,this.source+='    ; __append("'+n.replace(t+t+o,t+o)+'")\n';break;case t+o:case"-"+t+o:case"_"+t+o:this.mode==b.modes.LITERAL&&this._addOutput(n),this.mode=null,this.truncate=0===n.indexOf("-")||0===n.indexOf("_");break;default:if(this.mode){switch(this.mode){case b.modes.EVAL:case b.modes.ESCAPED:case b.modes.RAW:n.lastIndexOf("//")>n.lastIndexOf("\n")&&(n+="\n")}switch(this.mode){case b.modes.EVAL:this.source+="    ; "+n+"\n";break;case b.modes.ESCAPED:this.source+="    ; __append(escapeFn("+g(n)+"))\n";break;case b.modes.RAW:this.source+="    ; __append("+g(n)+")\n";break;case b.modes.COMMENT:break;case b.modes.LITERAL:this._addOutput(n)}}else this._addOutput(n)}this.opts.compileDebug&&e&&(this.currentLine+=e,this.source+="    ; __line = "+this.currentLine+"\n")}},e.escapeXML=a.escapeXML,e.__express=e.renderFile,e.VERSION=s,e.name="ejs","undefined"!=typeof window&&(window.ejs=e)},function(n,e,t){"use strict";t.r(e);var r={name:"CodeBlock",props:{title:{type:String,required:!0},active:{type:Boolean,default:!1}}},o=(t(372),t(20)),a=Object(o.a)(r,(function(){var n=this.$createElement;return(this._self._c||n)("div",{staticClass:"theme-code-block",class:{"theme-code-block__active":this.active}},[this._t("default")],2)}),[],!1,null,"4f1e9d0c",null);e.default=a.exports},function(n,e,t){"use strict";t.r(e);t(28),t(4),t(29),t(44),t(23);var r={name:"CodeGroup",data:function(){return{codeTabs:[],activeCodeTabIndex:-1}},watch:{activeCodeTabIndex:function(n){this.codeTabs.forEach((function(n){n.elm.classList.remove("theme-code-block__active")})),this.codeTabs[n].elm.classList.add("theme-code-block__active")}},mounted:function(){var n=this;this.codeTabs=(this.$slots.default||[]).filter((function(n){return Boolean(n.componentOptions)})).map((function(e,t){return""===e.componentOptions.propsData.active&&(n.activeCodeTabIndex=t),{title:e.componentOptions.propsData.title,elm:e.elm}})),-1===this.activeCodeTabIndex&&this.codeTabs.length>0&&(this.activeCodeTabIndex=0)},methods:{changeCodeTab:function(n){this.activeCodeTabIndex=n}}},o=(t(373),t(20)),a=Object(o.a)(r,(function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"theme-code-group"},[t("div",{staticClass:"theme-code-group__nav"},[t("ul",{staticClass:"theme-code-group__ul"},n._l(n.codeTabs,(function(e,r){return t("li",{key:e.title,staticClass:"theme-code-group__li"},[t("button",{staticClass:"theme-code-group__nav-tab",class:{"theme-code-group__nav-tab-active":r===n.activeCodeTabIndex},on:{click:function(e){return n.changeCodeTab(r)}}},[n._v("\n            "+n._s(e.title)+"\n          ")])])})),0)]),n._v(" "),n._t("default"),n._v(" "),n.codeTabs.length<1?t("pre",{staticClass:"pre-blank"},[n._v("// Make sure to add code blocks to your code group")]):n._e()],2)}),[],!1,null,"2f5f1757",null);e.default=a.exports},function(n,e,t){"use strict";var r=t(7),o=t(0),a=t(2),i=t(105),s=t(14),l=t(10),c=t(150),u=t(35),d=t(83),p=t(159),m=t(3),f=t(58).f,h=t(38).f,g=t(13).f,b=t(368),y=t(153).trim,v=o.Number,x=v.prototype,w=o.TypeError,k=a("".slice),S=a("".charCodeAt),j=function(n){var e=p(n,"number");return"bigint"==typeof e?e:E(e)},E=function(n){var e,t,r,o,a,i,s,l,c=p(n,"number");if(d(c))throw w("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=y(c),43===(e=S(c,0))||45===e){if(88===(t=S(c,2))||120===t)return NaN}else if(48===e){switch(S(c,1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+c}for(i=(a=k(c,2)).length,s=0;s<i;s++)if((l=S(a,s))<48||l>o)return NaN;return parseInt(a,r)}return+c};if(i("Number",!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var A,I=function(n){var e=arguments.length<1?0:v(j(n)),t=this;return u(x,t)&&m((function(){b(t)}))?c(Object(e),t,I):e},T=r?f(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),z=0;T.length>z;z++)l(v,A=T[z])&&!l(I,A)&&g(I,A,h(v,A));I.prototype=x,x.constructor=I,s(o,"Number",I)}},function(n,e,t){var r=t(3),o=t(0).RegExp;n.exports=r((function(){var n=o(".","s");return!(n.dotAll&&n.exec("\n")&&"s"===n.flags)}))},function(n,e,t){"use strict";var r=t(163).IteratorPrototype,o=t(34),a=t(48),i=t(59),s=t(65),l=function(){return this};n.exports=function(n,e,t,c){var u=e+" Iterator";return n.prototype=o(r,{next:a(+!c,t)}),i(n,u,!1,!0),s[u]=l,n}},function(n,e,t){var r=t(14);n.exports=function(n,e,t){for(var o in e)r(n,o,e[o],t);return n}},function(n,e,t){"use strict";var r=t(16),o=t(13),a=t(6),i=t(7),s=a("species");n.exports=function(n){var e=r(n),t=o.f;i&&e&&!e[s]&&t(e,s,{configurable:!0,get:function(){return this}})}},function(n,e,t){var r=t(0),o=t(35),a=r.TypeError;n.exports=function(n,e){if(o(e,n))return n;throw a("Incorrect invocation")}},function(n,e,t){var r=t(3),o=t(0).RegExp;n.exports=r((function(){var n=o("(?<a>b)","g");return"b"!==n.exec("b").groups.a||"bc"!=="b".replace(n,"$<a>c")}))},function(n,e,t){"use strict";var r=t(1),o=t(115).includes,a=t(141);r({target:"Array",proto:!0},{includes:function(n){return o(this,n,arguments.length>1?arguments[1]:void 0)}}),a("includes")},function(n,e,t){"use strict";var r=t(1),o=t(2),a=t(180),i=t(18),s=t(12),l=t(181),c=o("".indexOf);r({target:"String",proto:!0,forced:!l("includes")},{includes:function(n){return!!~c(s(i(this)),s(a(n)),arguments.length>1?arguments[1]:void 0)}})},function(n,e){n.exports=function(n){var e=null==n?0:n.length;return e?n[e-1]:void 0}},function(n,e,t){"use strict";var r=t(1),o=t(153).trim;r({target:"String",proto:!0,forced:t(366)("trim")},{trim:function(){return o(this)}})},function(n,e,t){var r=t(125),o=Math.floor,a=function(n,e){var t=n.length,l=o(t/2);return t<8?i(n,e):s(n,a(r(n,0,l),e),a(r(n,l),e),e)},i=function(n,e){for(var t,r,o=n.length,a=1;a<o;){for(r=a,t=n[a];r&&e(n[r-1],t)>0;)n[r]=n[--r];r!==a++&&(n[r]=t)}return n},s=function(n,e,t,r){for(var o=e.length,a=t.length,i=0,s=0;i<o||s<a;)n[i+s]=i<o&&s<a?r(e[i],t[s])<=0?e[i++]:t[s++]:i<o?e[i++]:t[s++];return n};n.exports=a},function(n,e,t){var r=t(0),o=t(7),a=t(107).MISSED_STICKY,i=t(25),s=t(13).f,l=t(39).get,c=RegExp.prototype,u=r.TypeError;o&&a&&s(c,"sticky",{configurable:!0,get:function(){if(this!==c){if("RegExp"===i(this))return!!l(this).sticky;throw u("Incompatible receiver, RegExp required")}}})},function(n,e,t){n.exports=t(389)},function(n,e,t){var r=t(0),o=t(11),a=t(5),i=t(9),s=r.TypeError;n.exports=function(n,e){var t,r;if("string"===e&&a(t=n.toString)&&!i(r=o(t,n)))return r;if(a(t=n.valueOf)&&!i(r=o(t,n)))return r;if("string"!==e&&a(t=n.toString)&&!i(r=o(t,n)))return r;throw s("Can't convert object to primitive value")}},function(n,e,t){var r=t(0),o=t(5),a=t(87),i=r.WeakMap;n.exports=o(i)&&/native code/.test(a(i))},function(n,e,t){var r=t(0),o=t(5),a=r.String,i=r.TypeError;n.exports=function(n){if("object"==typeof n||o(n))return n;throw i("Can't set "+a(n)+" as a prototype")}},function(n,e,t){"use strict";var r,o,a,i,s=t(1),l=t(26),c=t(0),u=t(16),d=t(11),p=t(165),m=t(14),f=t(227),h=t(67),g=t(59),b=t(228),y=t(37),v=t(5),x=t(9),w=t(229),k=t(87),S=t(242),j=t(168),E=t(124),A=t(170).set,I=t(243),T=t(172),z=t(246),_=t(173),C=t(247),P=t(248),O=t(39),M=t(105),D=t(6),R=t(249),B=t(89),L=t(51),N=D("species"),F="Promise",q=O.getterFor(F),$=O.set,G=O.getterFor(F),U=p&&p.prototype,H=p,J=U,W=c.TypeError,V=c.document,K=c.process,Z=_.f,Y=Z,X=!!(V&&V.createEvent&&c.dispatchEvent),Q=v(c.PromiseRejectionEvent),nn=!1,en=M(F,(function(){var n=k(H),e=n!==String(H);if(!e&&66===L)return!0;if(l&&!J.finally)return!0;if(L>=51&&/native code/.test(n))return!1;var t=new H((function(n){n(1)})),r=function(n){n((function(){}),(function(){}))};return(t.constructor={})[N]=r,!(nn=t.then((function(){}))instanceof r)||!e&&R&&!Q})),tn=en||!j((function(n){H.all(n).catch((function(){}))})),rn=function(n){var e;return!(!x(n)||!v(e=n.then))&&e},on=function(n,e){var t,r,o,a=e.value,i=1==e.state,s=i?n.ok:n.fail,l=n.resolve,c=n.reject,u=n.domain;try{s?(i||(2===e.rejection&&un(e),e.rejection=1),!0===s?t=a:(u&&u.enter(),t=s(a),u&&(u.exit(),o=!0)),t===n.promise?c(W("Promise-chain cycle")):(r=rn(t))?d(r,t,l,c):l(t)):c(a)}catch(n){u&&!o&&u.exit(),c(n)}},an=function(n,e){n.notified||(n.notified=!0,I((function(){for(var t,r=n.reactions;t=r.get();)on(t,n);n.notified=!1,e&&!n.rejection&&ln(n)})))},sn=function(n,e,t){var r,o;X?((r=V.createEvent("Event")).promise=e,r.reason=t,r.initEvent(n,!1,!0),c.dispatchEvent(r)):r={promise:e,reason:t},!Q&&(o=c["on"+n])?o(r):"unhandledrejection"===n&&z("Unhandled promise rejection",t)},ln=function(n){d(A,c,(function(){var e,t=n.facade,r=n.value;if(cn(n)&&(e=C((function(){B?K.emit("unhandledRejection",r,t):sn("unhandledrejection",t,r)})),n.rejection=B||cn(n)?2:1,e.error))throw e.value}))},cn=function(n){return 1!==n.rejection&&!n.parent},un=function(n){d(A,c,(function(){var e=n.facade;B?K.emit("rejectionHandled",e):sn("rejectionhandled",e,n.value)}))},dn=function(n,e,t){return function(r){n(e,r,t)}},pn=function(n,e,t){n.done||(n.done=!0,t&&(n=t),n.value=e,n.state=2,an(n,!0))},mn=function(n,e,t){if(!n.done){n.done=!0,t&&(n=t);try{if(n.facade===e)throw W("Promise can't be resolved itself");var r=rn(e);r?I((function(){var t={done:!1};try{d(r,e,dn(mn,t,n),dn(pn,t,n))}catch(e){pn(t,e,n)}})):(n.value=e,n.state=1,an(n,!1))}catch(e){pn({done:!1},e,n)}}};if(en&&(J=(H=function(n){w(this,J),y(n),d(r,this);var e=q(this);try{n(dn(mn,e),dn(pn,e))}catch(n){pn(e,n)}}).prototype,(r=function(n){$(this,{type:F,done:!1,notified:!1,parent:!1,reactions:new P,rejection:!1,state:0,value:void 0})}).prototype=f(J,{then:function(n,e){var t=G(this),r=Z(E(this,H));return t.parent=!0,r.ok=!v(n)||n,r.fail=v(e)&&e,r.domain=B?K.domain:void 0,0==t.state?t.reactions.add(r):I((function(){on(r,t)})),r.promise},catch:function(n){return this.then(void 0,n)}}),o=function(){var n=new r,e=q(n);this.promise=n,this.resolve=dn(mn,e),this.reject=dn(pn,e)},_.f=Z=function(n){return n===H||n===a?new o(n):Y(n)},!l&&v(p)&&U!==Object.prototype)){i=U.then,nn||(m(U,"then",(function(n,e){var t=this;return new H((function(n,e){d(i,t,n,e)})).then(n,e)}),{unsafe:!0}),m(U,"catch",J.catch,{unsafe:!0}));try{delete U.constructor}catch(n){}h&&h(U,J)}s({global:!0,wrap:!0,forced:en},{Promise:H}),g(H,F,!1,!0),b(F),a=u(F),s({target:F,stat:!0,forced:en},{reject:function(n){var e=Z(this);return d(e.reject,void 0,n),e.promise}}),s({target:F,stat:!0,forced:l||en},{resolve:function(n){return T(l&&this===a?H:this,n)}}),s({target:F,stat:!0,forced:tn},{all:function(n){var e=this,t=Z(e),r=t.resolve,o=t.reject,a=C((function(){var t=y(e.resolve),a=[],i=0,s=1;S(n,(function(n){var l=i++,c=!1;s++,d(t,e,n).then((function(n){c||(c=!0,a[l]=n,--s||r(a))}),o)})),--s||r(a)}));return a.error&&o(a.value),t.promise},race:function(n){var e=this,t=Z(e),r=t.reject,o=C((function(){var o=y(e.resolve);S(n,(function(n){d(o,e,n).then(t.resolve,r)}))}));return o.error&&r(o.value),t.promise}})},function(n,e,t){var r=t(0),o=t(56),a=t(11),i=t(8),s=t(84),l=t(166),c=t(22),u=t(35),d=t(145),p=t(106),m=t(167),f=r.TypeError,h=function(n,e){this.stopped=n,this.result=e},g=h.prototype;n.exports=function(n,e,t){var r,b,y,v,x,w,k,S=t&&t.that,j=!(!t||!t.AS_ENTRIES),E=!(!t||!t.IS_ITERATOR),A=!(!t||!t.INTERRUPTED),I=o(e,S),T=function(n){return r&&m(r,"normal",n),new h(!0,n)},z=function(n){return j?(i(n),A?I(n[0],n[1],T):I(n[0],n[1])):A?I(n,T):I(n)};if(E)r=n;else{if(!(b=p(n)))throw f(s(n)+" is not iterable");if(l(b)){for(y=0,v=c(n);v>y;y++)if((x=z(n[y]))&&u(g,x))return x;return new h(!1)}r=d(n,b)}for(w=r.next;!(k=a(w,r)).done;){try{x=z(k.value)}catch(n){m(r,"throw",n)}if("object"==typeof x&&x&&u(g,x))return x}return new h(!1)}},function(n,e,t){var r,o,a,i,s,l,c,u,d=t(0),p=t(56),m=t(38).f,f=t(170).set,h=t(171),g=t(244),b=t(245),y=t(89),v=d.MutationObserver||d.WebKitMutationObserver,x=d.document,w=d.process,k=d.Promise,S=m(d,"queueMicrotask"),j=S&&S.value;j||(r=function(){var n,e;for(y&&(n=w.domain)&&n.exit();o;){e=o.fn,o=o.next;try{e()}catch(n){throw o?i():a=void 0,n}}a=void 0,n&&n.enter()},h||y||b||!v||!x?!g&&k&&k.resolve?((c=k.resolve(void 0)).constructor=k,u=p(c.then,c),i=function(){u(r)}):y?i=function(){w.nextTick(r)}:(f=p(f,d),i=function(){f(r)}):(s=!0,l=x.createTextNode(""),new v(r).observe(l,{characterData:!0}),i=function(){l.data=s=!s})),n.exports=j||function(n){var e={fn:n,next:void 0};a&&(a.next=e),o||(o=e,i()),a=e}},function(n,e,t){var r=t(32),o=t(0);n.exports=/ipad|iphone|ipod/i.test(r)&&void 0!==o.Pebble},function(n,e,t){var r=t(32);n.exports=/web0s(?!.*chrome)/i.test(r)},function(n,e,t){var r=t(0);n.exports=function(n,e){var t=r.console;t&&t.error&&(1==arguments.length?t.error(n):t.error(n,e))}},function(n,e){n.exports=function(n){try{return{error:!1,value:n()}}catch(n){return{error:!0,value:n}}}},function(n,e){var t=function(){this.head=null,this.tail=null};t.prototype={add:function(n){var e={item:n,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var n=this.head;if(n)return this.head=n.next,this.tail===n&&(this.tail=null),n.item}},n.exports=t},function(n,e){n.exports="object"==typeof window},function(n,e,t){var r=t(1),o=t(251);r({target:"Object",stat:!0,forced:Object.assign!==o},{assign:o})},function(n,e,t){"use strict";var r=t(7),o=t(2),a=t(11),i=t(3),s=t(85),l=t(121),c=t(118),u=t(15),d=t(62),p=Object.assign,m=Object.defineProperty,f=o([].concat);n.exports=!p||i((function(){if(r&&1!==p({b:1},p(m({},"a",{enumerable:!0,get:function(){m(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var n={},e={},t=Symbol();return n[t]=7,"abcdefghijklmnopqrst".split("").forEach((function(n){e[n]=n})),7!=p({},n)[t]||"abcdefghijklmnopqrst"!=s(p({},e)).join("")}))?function(n,e){for(var t=u(n),o=arguments.length,i=1,p=l.f,m=c.f;o>i;)for(var h,g=d(arguments[i++]),b=p?f(s(g),p(g)):s(g),y=b.length,v=0;y>v;)h=b[v++],r&&!a(m,g,h)||(t[h]=g[h]);return t}:p},function(n,e,t){"use strict";var r=t(1),o=t(26),a=t(165),i=t(3),s=t(16),l=t(5),c=t(124),u=t(172),d=t(14);if(r({target:"Promise",proto:!0,real:!0,forced:!!a&&i((function(){a.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(n){var e=c(this,s("Promise")),t=l(n);return this.then(t?function(t){return u(e,n()).then((function(){return t}))}:n,t?function(t){return u(e,n()).then((function(){throw t}))}:n)}}),!o&&l(a)){var p=s("Promise").prototype.finally;a.prototype.finally!==p&&d(a.prototype,"finally",p,{unsafe:!0})}},function(n,e,t){"use strict";var r=t(123),o=t(76);n.exports=r?{}.toString:function(){return"[object "+o(this)+"]"}},function(n,e,t){var r=t(0),o=t(60),a=t(88),i=t(9),s=t(6)("species"),l=r.Array;n.exports=function(n){var e;return o(n)&&(e=n.constructor,(a(e)&&(e===l||o(e.prototype))||i(e)&&null===(e=e[s]))&&(e=void 0)),void 0===e?l:e}},function(n,e,t){"use strict";var r=t(1),o=t(256).left,a=t(46),i=t(51),s=t(89);r({target:"Array",proto:!0,forced:!a("reduce")||!s&&i>79&&i<83},{reduce:function(n){var e=arguments.length;return o(this,n,e,e>1?arguments[1]:void 0)}})},function(n,e,t){var r=t(0),o=t(37),a=t(15),i=t(62),s=t(22),l=r.TypeError,c=function(n){return function(e,t,r,c){o(t);var u=a(e),d=i(u),p=s(u),m=n?p-1:0,f=n?-1:1;if(r<2)for(;;){if(m in d){c=d[m],m+=f;break}if(m+=f,n?m<0:p<=m)throw l("Reduce of empty array with no initial value")}for(;n?m>=0:p>m;m+=f)m in d&&(c=t(c,d[m],m,u));return c}};n.exports={left:c(!1),right:c(!0)}},function(n,e,t){var r=t(1),o=t(183),a=t(3),i=t(9),s=t(258).onFreeze,l=Object.freeze;r({target:"Object",stat:!0,forced:a((function(){l(1)})),sham:!o},{freeze:function(n){return l&&i(n)?l(s(n)):n}})},function(n,e,t){var r=t(1),o=t(2),a=t(64),i=t(9),s=t(10),l=t(13).f,c=t(58),u=t(184),d=t(259),p=t(80),m=t(183),f=!1,h=p("meta"),g=0,b=function(n){l(n,h,{value:{objectID:"O"+g++,weakData:{}}})},y=n.exports={enable:function(){y.enable=function(){},f=!0;var n=c.f,e=o([].splice),t={};t[h]=1,n(t).length&&(c.f=function(t){for(var r=n(t),o=0,a=r.length;o<a;o++)if(r[o]===h){e(r,o,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},fastKey:function(n,e){if(!i(n))return"symbol"==typeof n?n:("string"==typeof n?"S":"P")+n;if(!s(n,h)){if(!d(n))return"F";if(!e)return"E";b(n)}return n[h].objectID},getWeakData:function(n,e){if(!s(n,h)){if(!d(n))return!0;if(!e)return!1;b(n)}return n[h].weakData},onFreeze:function(n){return m&&f&&d(n)&&!s(n,h)&&b(n),n}};a[h]=!0},function(n,e,t){var r=t(3),o=t(9),a=t(25),i=t(260),s=Object.isExtensible,l=r((function(){s(1)}));n.exports=l||i?function(n){return!!o(n)&&((!i||"ArrayBuffer"!=a(n))&&(!s||s(n)))}:s},function(n,e,t){var r=t(3);n.exports=r((function(){if("function"==typeof ArrayBuffer){var n=new ArrayBuffer(8);Object.isExtensible(n)&&Object.defineProperty(n,"a",{value:8})}}))},function(n,e,t){var r=t(0);n.exports=r},function(n,e,t){"use strict";var r=t(0),o=t(56),a=t(11),i=t(15),s=t(263),l=t(166),c=t(88),u=t(22),d=t(69),p=t(145),m=t(106),f=r.Array;n.exports=function(n){var e=i(n),t=c(this),r=arguments.length,h=r>1?arguments[1]:void 0,g=void 0!==h;g&&(h=o(h,r>2?arguments[2]:void 0));var b,y,v,x,w,k,S=m(e),j=0;if(!S||this==f&&l(S))for(b=u(e),y=t?new this(b):f(b);b>j;j++)k=g?h(e[j],j):e[j],d(y,j,k);else for(w=(x=p(e,S)).next,y=t?new this:[];!(v=a(w,x)).done;j++)k=g?s(x,h,[v.value,j],!0):v.value,d(y,j,k);return y.length=j,y}},function(n,e,t){var r=t(8),o=t(167);n.exports=function(n,e,t,a){try{return a?e(r(t)[0],t[1]):e(t)}catch(e){o(n,"throw",e)}}},function(n,e,t){"use strict";var r=t(16),o=t(10),a=t(27),i=t(35),s=t(67),l=t(119),c=t(150),u=t(188),d=t(265),p=t(266),m=t(267),f=t(26);n.exports=function(n,e,t,h){var g=h?2:1,b=n.split("."),y=b[b.length-1],v=r.apply(null,b);if(v){var x=v.prototype;if(!f&&o(x,"cause")&&delete x.cause,!t)return v;var w=r("Error"),k=e((function(n,e){var t=u(h?e:n,void 0),r=h?new v(n):new v;return void 0!==t&&a(r,"message",t),m&&a(r,"stack",p(r.stack,2)),this&&i(x,this)&&c(r,this,k),arguments.length>g&&d(r,arguments[g]),r}));if(k.prototype=x,"Error"!==y&&(s?s(k,w):l(k,w,{name:!0})),l(k,v),!f)try{x.name!==y&&a(x,"name",y),x.constructor=k}catch(n){}return k}}},function(n,e,t){var r=t(9),o=t(27);n.exports=function(n,e){r(e)&&"cause"in e&&o(n,"cause",e.cause)}},function(n,e,t){var r=t(2)("".replace),o=String(Error("zxcasd").stack),a=/\n\s*at [^:]*:[^\n]*/,i=a.test(o);n.exports=function(n,e){if(i&&"string"==typeof n)for(;e--;)n=r(n,a,"");return n}},function(n,e,t){var r=t(3),o=t(48);n.exports=!r((function(){var n=Error("a");return!("stack"in n)||(Object.defineProperty(n,"stack",o(1,7)),7!==n.stack)}))},function(n,e,t){"use strict";var r=t(7),o=t(3),a=t(8),i=t(34),s=t(188),l=Error.prototype.toString,c=o((function(){if(r){var n=i(Object.defineProperty({},"name",{get:function(){return this===n}}));if("true"!==l.call(n))return!0}return"2: 1"!==l.call({message:1,name:2})||"Error"!==l.call({})}));n.exports=c?function(){var n=a(this),e=s(n.name,"Error"),t=s(n.message);return e?t?e+": "+t:e:t}:l},function(n,e,t){var r=t(2),o=t(15),a=Math.floor,i=r("".charAt),s=r("".replace),l=r("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;n.exports=function(n,e,t,r,d,p){var m=t+n.length,f=r.length,h=u;return void 0!==d&&(d=o(d),h=c),s(p,h,(function(o,s){var c;switch(i(s,0)){case"$":return"$";case"&":return n;case"`":return l(e,0,t);case"'":return l(e,m);case"<":c=d[l(s,1,-1)];break;default:var u=+s;if(0===u)return o;if(u>f){var p=a(u/10);return 0===p?o:p<=f?void 0===r[p-1]?i(s,1):r[p-1]+i(s,1):o}c=r[u-1]}return void 0===c?"":c}))}},function(n,e,t){var r=t(191),o=t(271);n.exports=function n(e,t,a,i,s){var l=-1,c=e.length;for(a||(a=o),s||(s=[]);++l<c;){var u=e[l];t>0&&a(u)?t>1?n(u,t-1,a,i,s):r(s,u):i||(s[s.length]=u)}return s}},function(n,e,t){var r=t(71),o=t(128),a=t(31),i=r?r.isConcatSpreadable:void 0;n.exports=function(n){return a(n)||o(n)||!!(i&&n&&n[i])}},function(n,e,t){var r=t(61),o=t(49);n.exports=function(n){return o(n)&&"[object Arguments]"==r(n)}},function(n,e,t){var r=t(71),o=Object.prototype,a=o.hasOwnProperty,i=o.toString,s=r?r.toStringTag:void 0;n.exports=function(n){var e=a.call(n,s),t=n[s];try{n[s]=void 0;var r=!0}catch(n){}var o=i.call(n);return r&&(e?n[s]=t:delete n[s]),o}},function(n,e){var t=Object.prototype.toString;n.exports=function(n){return t.call(n)}},function(n,e,t){var r=t(276),o=t(332),a=t(136),i=t(31),s=t(343);n.exports=function(n){return"function"==typeof n?n:null==n?a:"object"==typeof n?i(n)?o(n[0],n[1]):r(n):s(n)}},function(n,e,t){var r=t(277),o=t(331),a=t(208);n.exports=function(n){var e=o(n);return 1==e.length&&e[0][2]?a(e[0][0],e[0][1]):function(t){return t===n||r(t,n,e)}}},function(n,e,t){var r=t(193),o=t(197);n.exports=function(n,e,t,a){var i=t.length,s=i,l=!a;if(null==n)return!s;for(n=Object(n);i--;){var c=t[i];if(l&&c[2]?c[1]!==n[c[0]]:!(c[0]in n))return!1}for(;++i<s;){var u=(c=t[i])[0],d=n[u],p=c[1];if(l&&c[2]){if(void 0===d&&!(u in n))return!1}else{var m=new r;if(a)var f=a(d,p,u,n,e,m);if(!(void 0===f?o(p,d,3,a,m):f))return!1}}return!0}},function(n,e){n.exports=function(){this.__data__=[],this.size=0}},function(n,e,t){var r=t(95),o=Array.prototype.splice;n.exports=function(n){var e=this.__data__,t=r(e,n);return!(t<0)&&(t==e.length-1?e.pop():o.call(e,t,1),--this.size,!0)}},function(n,e,t){var r=t(95);n.exports=function(n){var e=this.__data__,t=r(e,n);return t<0?void 0:e[t][1]}},function(n,e,t){var r=t(95);n.exports=function(n){return r(this.__data__,n)>-1}},function(n,e,t){var r=t(95);n.exports=function(n,e){var t=this.__data__,o=r(t,n);return o<0?(++this.size,t.push([n,e])):t[o][1]=e,this}},function(n,e,t){var r=t(94);n.exports=function(){this.__data__=new r,this.size=0}},function(n,e){n.exports=function(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}},function(n,e){n.exports=function(n){return this.__data__.get(n)}},function(n,e){n.exports=function(n){return this.__data__.has(n)}},function(n,e,t){var r=t(94),o=t(129),a=t(131);n.exports=function(n,e){var t=this.__data__;if(t instanceof r){var i=t.__data__;if(!o||i.length<199)return i.push([n,e]),this.size=++t.size,this;t=this.__data__=new a(i)}return t.set(n,e),this.size=t.size,this}},function(n,e,t){var r=t(195),o=t(289),a=t(130),i=t(196),s=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,u=l.toString,d=c.hasOwnProperty,p=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");n.exports=function(n){return!(!a(n)||o(n))&&(r(n)?p:s).test(i(n))}},function(n,e,t){var r,o=t(290),a=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";n.exports=function(n){return!!a&&a in n}},function(n,e,t){var r=t(33)["__core-js_shared__"];n.exports=r},function(n,e){n.exports=function(n,e){return null==n?void 0:n[e]}},function(n,e,t){var r=t(293),o=t(94),a=t(129);n.exports=function(){this.size=0,this.__data__={hash:new r,map:new(a||o),string:new r}}},function(n,e,t){var r=t(294),o=t(295),a=t(296),i=t(297),s=t(298);function l(n){var e=-1,t=null==n?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=o,l.prototype.get=a,l.prototype.has=i,l.prototype.set=s,n.exports=l},function(n,e,t){var r=t(96);n.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(n,e){n.exports=function(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}},function(n,e,t){var r=t(96),o=Object.prototype.hasOwnProperty;n.exports=function(n){var e=this.__data__;if(r){var t=e[n];return"__lodash_hash_undefined__"===t?void 0:t}return o.call(e,n)?e[n]:void 0}},function(n,e,t){var r=t(96),o=Object.prototype.hasOwnProperty;n.exports=function(n){var e=this.__data__;return r?void 0!==e[n]:o.call(e,n)}},function(n,e,t){var r=t(96);n.exports=function(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},function(n,e,t){var r=t(97);n.exports=function(n){var e=r(this,n).delete(n);return this.size-=e?1:0,e}},function(n,e){n.exports=function(n){var e=typeof n;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==n:null===n}},function(n,e,t){var r=t(97);n.exports=function(n){return r(this,n).get(n)}},function(n,e,t){var r=t(97);n.exports=function(n){return r(this,n).has(n)}},function(n,e,t){var r=t(97);n.exports=function(n,e){var t=r(this,n),o=t.size;return t.set(n,e),this.size+=t.size==o?0:1,this}},function(n,e,t){var r=t(193),o=t(198),a=t(308),i=t(311),s=t(327),l=t(31),c=t(202),u=t(204),d="[object Object]",p=Object.prototype.hasOwnProperty;n.exports=function(n,e,t,m,f,h){var g=l(n),b=l(e),y=g?"[object Array]":s(n),v=b?"[object Array]":s(e),x=(y="[object Arguments]"==y?d:y)==d,w=(v="[object Arguments]"==v?d:v)==d,k=y==v;if(k&&c(n)){if(!c(e))return!1;g=!0,x=!1}if(k&&!x)return h||(h=new r),g||u(n)?o(n,e,t,m,f,h):a(n,e,y,t,m,f,h);if(!(1&t)){var S=x&&p.call(n,"__wrapped__"),j=w&&p.call(e,"__wrapped__");if(S||j){var E=S?n.value():n,A=j?e.value():e;return h||(h=new r),f(E,A,t,m,h)}}return!!k&&(h||(h=new r),i(n,e,t,m,f,h))}},function(n,e){n.exports=function(n){return this.__data__.set(n,"__lodash_hash_undefined__"),this}},function(n,e){n.exports=function(n){return this.__data__.has(n)}},function(n,e){n.exports=function(n,e){for(var t=-1,r=null==n?0:n.length;++t<r;)if(e(n[t],t,n))return!0;return!1}},function(n,e,t){var r=t(71),o=t(309),a=t(194),i=t(198),s=t(310),l=t(132),c=r?r.prototype:void 0,u=c?c.valueOf:void 0;n.exports=function(n,e,t,r,c,d,p){switch(t){case"[object DataView]":if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(n.byteLength!=e.byteLength||!d(new o(n),new o(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+n,+e);case"[object Error]":return n.name==e.name&&n.message==e.message;case"[object RegExp]":case"[object String]":return n==e+"";case"[object Map]":var m=s;case"[object Set]":var f=1&r;if(m||(m=l),n.size!=e.size&&!f)return!1;var h=p.get(n);if(h)return h==e;r|=2,p.set(n,e);var g=i(m(n),m(e),r,c,d,p);return p.delete(n),g;case"[object Symbol]":if(u)return u.call(n)==u.call(e)}return!1}},function(n,e,t){var r=t(33).Uint8Array;n.exports=r},function(n,e){n.exports=function(n){var e=-1,t=Array(n.size);return n.forEach((function(n,r){t[++e]=[r,n]})),t}},function(n,e,t){var r=t(312),o=Object.prototype.hasOwnProperty;n.exports=function(n,e,t,a,i,s){var l=1&t,c=r(n),u=c.length;if(u!=r(e).length&&!l)return!1;for(var d=u;d--;){var p=c[d];if(!(l?p in e:o.call(e,p)))return!1}var m=s.get(n),f=s.get(e);if(m&&f)return m==e&&f==n;var h=!0;s.set(n,e),s.set(e,n);for(var g=l;++d<u;){var b=n[p=c[d]],y=e[p];if(a)var v=l?a(y,b,p,e,n,s):a(b,y,p,n,e,s);if(!(void 0===v?b===y||i(b,y,t,a,s):v)){h=!1;break}g||(g="constructor"==p)}if(h&&!g){var x=n.constructor,w=e.constructor;x==w||!("constructor"in n)||!("constructor"in e)||"function"==typeof x&&x instanceof x&&"function"==typeof w&&w instanceof w||(h=!1)}return s.delete(n),s.delete(e),h}},function(n,e,t){var r=t(313),o=t(314),a=t(201);n.exports=function(n){return r(n,a,o)}},function(n,e,t){var r=t(191),o=t(31);n.exports=function(n,e,t){var a=e(n);return o(n)?a:r(a,t(n))}},function(n,e,t){var r=t(315),o=t(316),a=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols,s=i?function(n){return null==n?[]:(n=Object(n),r(i(n),(function(e){return a.call(n,e)})))}:o;n.exports=s},function(n,e){n.exports=function(n,e){for(var t=-1,r=null==n?0:n.length,o=0,a=[];++t<r;){var i=n[t];e(i,t,n)&&(a[o++]=i)}return a}},function(n,e){n.exports=function(){return[]}},function(n,e,t){var r=t(318),o=t(128),a=t(31),i=t(202),s=t(203),l=t(204),c=Object.prototype.hasOwnProperty;n.exports=function(n,e){var t=a(n),u=!t&&o(n),d=!t&&!u&&i(n),p=!t&&!u&&!d&&l(n),m=t||u||d||p,f=m?r(n.length,String):[],h=f.length;for(var g in n)!e&&!c.call(n,g)||m&&("length"==g||d&&("offset"==g||"parent"==g)||p&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,h))||f.push(g);return f}},function(n,e){n.exports=function(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}},function(n,e){n.exports=function(){return!1}},function(n,e,t){var r=t(61),o=t(133),a=t(49),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,n.exports=function(n){return a(n)&&o(n.length)&&!!i[r(n)]}},function(n,e){n.exports=function(n){return function(e){return n(e)}}},function(n,e,t){(function(n){var r=t(192),o=e&&!e.nodeType&&e,a=o&&"object"==typeof n&&n&&!n.nodeType&&n,i=a&&a.exports===o&&r.process,s=function(){try{var n=a&&a.require&&a.require("util").types;return n||i&&i.binding&&i.binding("util")}catch(n){}}();n.exports=s}).call(this,t(151)(n))},function(n,e,t){var r=t(324),o=t(325),a=Object.prototype.hasOwnProperty;n.exports=function(n){if(!r(n))return o(n);var e=[];for(var t in Object(n))a.call(n,t)&&"constructor"!=t&&e.push(t);return e}},function(n,e){var t=Object.prototype;n.exports=function(n){var e=n&&n.constructor;return n===("function"==typeof e&&e.prototype||t)}},function(n,e,t){var r=t(326)(Object.keys,Object);n.exports=r},function(n,e){n.exports=function(n,e){return function(t){return n(e(t))}}},function(n,e,t){var r=t(328),o=t(129),a=t(329),i=t(206),s=t(330),l=t(61),c=t(196),u=c(r),d=c(o),p=c(a),m=c(i),f=c(s),h=l;(r&&"[object DataView]"!=h(new r(new ArrayBuffer(1)))||o&&"[object Map]"!=h(new o)||a&&"[object Promise]"!=h(a.resolve())||i&&"[object Set]"!=h(new i)||s&&"[object WeakMap]"!=h(new s))&&(h=function(n){var e=l(n),t="[object Object]"==e?n.constructor:void 0,r=t?c(t):"";if(r)switch(r){case u:return"[object DataView]";case d:return"[object Map]";case p:return"[object Promise]";case m:return"[object Set]";case f:return"[object WeakMap]"}return e}),n.exports=h},function(n,e,t){var r=t(41)(t(33),"DataView");n.exports=r},function(n,e,t){var r=t(41)(t(33),"Promise");n.exports=r},function(n,e,t){var r=t(41)(t(33),"WeakMap");n.exports=r},function(n,e,t){var r=t(207),o=t(201);n.exports=function(n){for(var e=o(n),t=e.length;t--;){var a=e[t],i=n[a];e[t]=[a,i,r(i)]}return e}},function(n,e,t){var r=t(197),o=t(333),a=t(340),i=t(134),s=t(207),l=t(208),c=t(98);n.exports=function(n,e){return i(n)&&s(e)?l(c(n),e):function(t){var i=o(t,n);return void 0===i&&i===e?a(t,n):r(e,i,3)}}},function(n,e,t){var r=t(209);n.exports=function(n,e,t){var o=null==n?void 0:r(n,e);return void 0===o?t:o}},function(n,e,t){var r=t(335),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,i=r((function(n){var e=[];return 46===n.charCodeAt(0)&&e.push(""),n.replace(o,(function(n,t,r,o){e.push(r?o.replace(a,"$1"):t||n)})),e}));n.exports=i},function(n,e,t){var r=t(336);n.exports=function(n){var e=r(n,(function(n){return 500===t.size&&t.clear(),n})),t=e.cache;return e}},function(n,e,t){var r=t(131);function o(n,e){if("function"!=typeof n||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var t=function(){var r=arguments,o=e?e.apply(this,r):r[0],a=t.cache;if(a.has(o))return a.get(o);var i=n.apply(this,r);return t.cache=a.set(o,i)||a,i};return t.cache=new(o.Cache||r),t}o.Cache=r,n.exports=o},function(n,e,t){var r=t(338);n.exports=function(n){return null==n?"":r(n)}},function(n,e,t){var r=t(71),o=t(339),a=t(31),i=t(135),s=r?r.prototype:void 0,l=s?s.toString:void 0;n.exports=function n(e){if("string"==typeof e)return e;if(a(e))return o(e,n)+"";if(i(e))return l?l.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(n,e){n.exports=function(n,e){for(var t=-1,r=null==n?0:n.length,o=Array(r);++t<r;)o[t]=e(n[t],t,n);return o}},function(n,e,t){var r=t(341),o=t(342);n.exports=function(n,e){return null!=n&&o(n,e,r)}},function(n,e){n.exports=function(n,e){return null!=n&&e in Object(n)}},function(n,e,t){var r=t(210),o=t(128),a=t(31),i=t(203),s=t(133),l=t(98);n.exports=function(n,e,t){for(var c=-1,u=(e=r(e,n)).length,d=!1;++c<u;){var p=l(e[c]);if(!(d=null!=n&&t(n,p)))break;n=n[p]}return d||++c!=u?d:!!(u=null==n?0:n.length)&&s(u)&&i(p,u)&&(a(n)||o(n))}},function(n,e,t){var r=t(344),o=t(345),a=t(134),i=t(98);n.exports=function(n){return a(n)?r(i(n)):o(n)}},function(n,e){n.exports=function(n){return function(e){return null==e?void 0:e[n]}}},function(n,e,t){var r=t(209);n.exports=function(n){return function(e){return r(e,n)}}},function(n,e,t){var r=t(136),o=t(347),a=t(349);n.exports=function(n,e){return a(o(n,e,r),n+"")}},function(n,e,t){var r=t(348),o=Math.max;n.exports=function(n,e,t){return e=o(void 0===e?n.length-1:e,0),function(){for(var a=arguments,i=-1,s=o(a.length-e,0),l=Array(s);++i<s;)l[i]=a[e+i];i=-1;for(var c=Array(e+1);++i<e;)c[i]=a[i];return c[e]=t(l),r(n,this,c)}}},function(n,e){n.exports=function(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}},function(n,e,t){var r=t(350),o=t(353)(r);n.exports=o},function(n,e,t){var r=t(351),o=t(352),a=t(136),i=o?function(n,e){return o(n,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:a;n.exports=i},function(n,e){n.exports=function(n){return function(){return n}}},function(n,e,t){var r=t(41),o=function(){try{var n=r(Object,"defineProperty");return n({},"",{}),n}catch(n){}}();n.exports=o},function(n,e){var t=Date.now;n.exports=function(n){var e=0,r=0;return function(){var o=t(),a=16-(o-r);if(r=o,a>0){if(++e>=800)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}},function(n,e,t){var r=t(199),o=t(355),a=t(360),i=t(200),s=t(361),l=t(132);n.exports=function(n,e,t){var c=-1,u=o,d=n.length,p=!0,m=[],f=m;if(t)p=!1,u=a;else if(d>=200){var h=e?null:s(n);if(h)return l(h);p=!1,u=i,f=new r}else f=e?[]:m;n:for(;++c<d;){var g=n[c],b=e?e(g):g;if(g=t||0!==g?g:0,p&&b==b){for(var y=f.length;y--;)if(f[y]===b)continue n;e&&f.push(b),m.push(g)}else u(f,b,t)||(f!==m&&f.push(b),m.push(g))}return m}},function(n,e,t){var r=t(356);n.exports=function(n,e){return!!(null==n?0:n.length)&&r(n,e,0)>-1}},function(n,e,t){var r=t(357),o=t(358),a=t(359);n.exports=function(n,e,t){return e==e?a(n,e,t):r(n,o,t)}},function(n,e){n.exports=function(n,e,t,r){for(var o=n.length,a=t+(r?1:-1);r?a--:++a<o;)if(e(n[a],a,n))return a;return-1}},function(n,e){n.exports=function(n){return n!=n}},function(n,e){n.exports=function(n,e,t){for(var r=t-1,o=n.length;++r<o;)if(n[r]===e)return r;return-1}},function(n,e){n.exports=function(n,e,t){for(var r=-1,o=null==n?0:n.length;++r<o;)if(t(e,n[r]))return!0;return!1}},function(n,e,t){var r=t(206),o=t(362),a=t(132),i=r&&1/a(new r([,-0]))[1]==1/0?function(n){return new r(n)}:o;n.exports=i},function(n,e){n.exports=function(){}},function(n,e,t){var r=t(205),o=t(49);n.exports=function(n){return o(n)&&r(n)}},function(n,e,t){},function(n,e,t){},function(n,e,t){var r=t(66).PROPER,o=t(3),a=t(154);n.exports=function(n){return o((function(){return!!a[n]()||"âÂá "!=="âÂá "[n]()||r&&a[n].name!==n}))}},function(n,e,t){var r=t(1),o=t(211);r({target:"Function",proto:!0,forced:Function.bind!==o},{bind:o})},function(n,e,t){var r=t(2);n.exports=r(1..valueOf)},function(n,e,t){var r=t(2),o=t(52),a=t(12),i=t(370),s=t(18),l=r(i),c=r("".slice),u=Math.ceil,d=function(n){return function(e,t,r){var i,d,p=a(s(e)),m=o(t),f=p.length,h=void 0===r?" ":a(r);return m<=f||""==h?p:((d=l(h,u((i=m-f)/h.length))).length>i&&(d=c(d,0,i)),n?p+d:d+p)}};n.exports={start:d(!1),end:d(!0)}},function(n,e,t){"use strict";var r=t(0),o=t(55),a=t(12),i=t(18),s=r.RangeError;n.exports=function(n){var e=a(i(this)),t="",r=o(n);if(r<0||r==1/0)throw s("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(t+=e);return t}},function(n,e,t){var r=t(32);n.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(r)},function(n,e,t){"use strict";t(213)},function(n,e,t){"use strict";t(214)},function(n,e,t){"use strict";var r=t(1),o=t(2),a=t(37),i=t(15),s=t(22),l=t(12),c=t(3),u=t(235),d=t(46),p=t(375),m=t(376),f=t(51),h=t(377),g=[],b=o(g.sort),y=o(g.push),v=c((function(){g.sort(void 0)})),x=c((function(){g.sort(null)})),w=d("sort"),k=!c((function(){if(f)return f<70;if(!(p&&p>3)){if(m)return!0;if(h)return h<603;var n,e,t,r,o="";for(n=65;n<76;n++){switch(e=String.fromCharCode(n),n){case 66:case 69:case 70:case 72:t=3;break;case 68:case 71:t=4;break;default:t=2}for(r=0;r<47;r++)g.push({k:e+r,v:t})}for(g.sort((function(n,e){return e.v-n.v})),r=0;r<g.length;r++)e=g[r].k.charAt(0),o.charAt(o.length-1)!==e&&(o+=e);return"DGBEFHACIJK"!==o}}));r({target:"Array",proto:!0,forced:v||!x||!w||!k},{sort:function(n){void 0!==n&&a(n);var e=i(this);if(k)return void 0===n?b(e):b(e,n);var t,r,o=[],c=s(e);for(r=0;r<c;r++)r in e&&y(o,e[r]);for(u(o,function(n){return function(e,t){return void 0===t?-1:void 0===e?1:void 0!==n?+n(e,t)||0:l(e)>l(t)?1:-1}}(n)),t=o.length,r=0;r<t;)e[r]=o[r++];for(;r<c;)delete e[r++];return e}})},function(n,e,t){var r=t(32).match(/firefox\/(\d+)/i);n.exports=!!r&&+r[1]},function(n,e,t){var r=t(32);n.exports=/MSIE|Trident/.test(r)},function(n,e,t){var r=t(32).match(/AppleWebKit\/(\d+)\./);n.exports=!!r&&+r[1]},function(n,e,t){},function(n,e,t){},function(n,e,t){var r=t(1),o=t(3),a=t(19),i=t(38).f,s=t(7),l=o((function(){i(1)}));r({target:"Object",stat:!0,forced:!s||l,sham:!s},{getOwnPropertyDescriptor:function(n,e){return i(a(n),e)}})},function(n,e,t){var r=t(1),o=t(7),a=t(114).f;r({target:"Object",stat:!0,forced:Object.defineProperties!==a,sham:!o},{defineProperties:a})},function(n,e,t){t(1)({target:"Reflect",stat:!0},{ownKeys:t(120)})},function(n,e){},function(n,e){function t(n,e){for(var t=0,r=n.length-1;r>=0;r--){var o=n[r];"."===o?n.splice(r,1):".."===o?(n.splice(r,1),t++):t&&(n.splice(r,1),t--)}if(e)for(;t--;t)n.unshift("..");return n}function r(n,e){if(n.filter)return n.filter(e);for(var t=[],r=0;r<n.length;r++)e(n[r],r,n)&&t.push(n[r]);return t}e.resolve=function(){for(var n="",e=!1,o=arguments.length-1;o>=-1&&!e;o--){var a=o>=0?arguments[o]:process.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(n=a+"/"+n,e="/"===a.charAt(0))}return(e?"/":"")+(n=t(r(n.split("/"),(function(n){return!!n})),!e).join("/"))||"."},e.normalize=function(n){var a=e.isAbsolute(n),i="/"===o(n,-1);return(n=t(r(n.split("/"),(function(n){return!!n})),!a).join("/"))||a||(n="."),n&&i&&(n+="/"),(a?"/":"")+n},e.isAbsolute=function(n){return"/"===n.charAt(0)},e.join=function(){var n=Array.prototype.slice.call(arguments,0);return e.normalize(r(n,(function(n,e){if("string"!=typeof n)throw new TypeError("Arguments to path.join must be strings");return n})).join("/"))},e.relative=function(n,t){function r(n){for(var e=0;e<n.length&&""===n[e];e++);for(var t=n.length-1;t>=0&&""===n[t];t--);return e>t?[]:n.slice(e,t-e+1)}n=e.resolve(n).substr(1),t=e.resolve(t).substr(1);for(var o=r(n.split("/")),a=r(t.split("/")),i=Math.min(o.length,a.length),s=i,l=0;l<i;l++)if(o[l]!==a[l]){s=l;break}var c=[];for(l=s;l<o.length;l++)c.push("..");return(c=c.concat(a.slice(s))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(n){if("string"!=typeof n&&(n+=""),0===n.length)return".";for(var e=n.charCodeAt(0),t=47===e,r=-1,o=!0,a=n.length-1;a>=1;--a)if(47===(e=n.charCodeAt(a))){if(!o){r=a;break}}else o=!1;return-1===r?t?"/":".":t&&1===r?"/":n.slice(0,r)},e.basename=function(n,e){var t=function(n){"string"!=typeof n&&(n+="");var e,t=0,r=-1,o=!0;for(e=n.length-1;e>=0;--e)if(47===n.charCodeAt(e)){if(!o){t=e+1;break}}else-1===r&&(o=!1,r=e+1);return-1===r?"":n.slice(t,r)}(n);return e&&t.substr(-1*e.length)===e&&(t=t.substr(0,t.length-e.length)),t},e.extname=function(n){"string"!=typeof n&&(n+="");for(var e=-1,t=0,r=-1,o=!0,a=0,i=n.length-1;i>=0;--i){var s=n.charCodeAt(i);if(47!==s)-1===r&&(o=!1,r=i+1),46===s?-1===e?e=i:1!==a&&(a=1):-1!==e&&(a=-1);else if(!o){t=i+1;break}}return-1===e||-1===r||0===a||1===a&&e===r-1&&e===t+1?"":n.slice(e,r)};var o="b"==="ab".substr(-1)?function(n,e,t){return n.substr(e,t)}:function(n,e,t){return e<0&&(e=n.length+e),n.substr(e,t)}},function(n,e,t){"use strict";var r=/[|\\{}()[\]^$+*?.]/g;e.escapeRegExpChars=function(n){return n?String(n).replace(r,"\\$&"):""};var o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},a=/[&<>'"]/g;function i(n){return o[n]||n}e.escapeXML=function(n){return null==n?"":String(n).replace(a,i)},e.escapeXML.toString=function(){return Function.prototype.toString.call(this)+';\nvar _ENCODE_HTML_RULES = {\n      "&": "&amp;"\n    , "<": "&lt;"\n    , ">": "&gt;"\n    , \'"\': "&#34;"\n    , "\'": "&#39;"\n    }\n  , _MATCH_HTML = /[&<>\'"]/g;\nfunction encode_char(c) {\n  return _ENCODE_HTML_RULES[c] || c;\n};\n'},e.shallowCopy=function(n,e){for(var t in e=e||{})n[t]=e[t];return n},e.shallowCopyFromList=function(n,e,t){for(var r=0;r<t.length;r++){var o=t[r];void 0!==e[o]&&(n[o]=e[o])}return n},e.cache={_data:{},set:function(n,e){this._data[n]=e},get:function(n){return this._data[n]},remove:function(n){delete this._data[n]},reset:function(){this._data={}}}},function(n){n.exports=JSON.parse('{"name":"ejs","description":"Embedded JavaScript templates","keywords":["template","engine","ejs"],"version":"2.7.4","author":"Matthew Eernisse <mde@fleegix.org> (http://fleegix.org)","license":"Apache-2.0","main":"./lib/ejs.js","repository":{"type":"git","url":"git://github.com/mde/ejs.git"},"bugs":"https://github.com/mde/ejs/issues","homepage":"https://github.com/mde/ejs","dependencies":{},"devDependencies":{"browserify":"^13.1.1","eslint":"^4.14.0","git-directory-deploy":"^1.5.1","jake":"^10.3.1","jsdoc":"^3.4.0","lru-cache":"^4.0.1","mocha":"^5.0.5","uglify-js":"^3.3.16"},"engines":{"node":">=0.10.0"},"scripts":{"test":"mocha","postinstall":"node ./postinstall.js"}}')},function(n,e,t){"use strict";t(217)},function(n,e,t){"use strict";t(218)},function(n,e,t){"use strict";t.r(e);t(144),t(241),t(250),t(252);var r=t(90),o=(t(142),t(42),t(4),t(21),t(24),t(44),t(23),Object.freeze({}));function a(n){return null==n}function i(n){return null!=n}function s(n){return!0===n}function l(n){return"string"==typeof n||"number"==typeof n||"symbol"==typeof n||"boolean"==typeof n}function c(n){return null!==n&&"object"==typeof n}var u=Object.prototype.toString;function d(n){return"[object Object]"===u.call(n)}function p(n){return"[object RegExp]"===u.call(n)}function m(n){var e=parseFloat(String(n));return e>=0&&Math.floor(e)===e&&isFinite(n)}function f(n){return i(n)&&"function"==typeof n.then&&"function"==typeof n.catch}function h(n){return null==n?"":Array.isArray(n)||d(n)&&n.toString===u?JSON.stringify(n,null,2):String(n)}function g(n){var e=parseFloat(n);return isNaN(e)?n:e}function b(n,e){for(var t=Object.create(null),r=n.split(","),o=0;o<r.length;o++)t[r[o]]=!0;return e?function(n){return t[n.toLowerCase()]}:function(n){return t[n]}}b("slot,component",!0);var y=b("key,ref,slot,slot-scope,is");function v(n,e){if(n.length){var t=n.indexOf(e);if(t>-1)return n.splice(t,1)}}var x=Object.prototype.hasOwnProperty;function w(n,e){return x.call(n,e)}function k(n){var e=Object.create(null);return function(t){return e[t]||(e[t]=n(t))}}var S=/-(\w)/g,j=k((function(n){return n.replace(S,(function(n,e){return e?e.toUpperCase():""}))})),E=k((function(n){return n.charAt(0).toUpperCase()+n.slice(1)})),A=/\B([A-Z])/g,I=k((function(n){return n.replace(A,"-$1").toLowerCase()}));var T=Function.prototype.bind?function(n,e){return n.bind(e)}:function(n,e){function t(t){var r=arguments.length;return r?r>1?n.apply(e,arguments):n.call(e,t):n.call(e)}return t._length=n.length,t};function z(n,e){e=e||0;for(var t=n.length-e,r=new Array(t);t--;)r[t]=n[t+e];return r}function _(n,e){for(var t in e)n[t]=e[t];return n}function C(n){for(var e={},t=0;t<n.length;t++)n[t]&&_(e,n[t]);return e}function P(n,e,t){}var O=function(n,e,t){return!1},M=function(n){return n};function D(n,e){if(n===e)return!0;var t=c(n),r=c(e);if(!t||!r)return!t&&!r&&String(n)===String(e);try{var o=Array.isArray(n),a=Array.isArray(e);if(o&&a)return n.length===e.length&&n.every((function(n,t){return D(n,e[t])}));if(n instanceof Date&&e instanceof Date)return n.getTime()===e.getTime();if(o||a)return!1;var i=Object.keys(n),s=Object.keys(e);return i.length===s.length&&i.every((function(t){return D(n[t],e[t])}))}catch(n){return!1}}function R(n,e){for(var t=0;t<n.length;t++)if(D(n[t],e))return t;return-1}function B(n){var e=!1;return function(){e||(e=!0,n.apply(this,arguments))}}var L=["component","directive","filter"],N=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],F={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:O,isReservedAttr:O,isUnknownElement:O,getTagNamespace:P,parsePlatformTagName:M,mustUseProp:O,async:!0,_lifecycleHooks:N},q=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function $(n,e,t,r){Object.defineProperty(n,e,{value:t,enumerable:!!r,writable:!0,configurable:!0})}var G=new RegExp("[^"+q.source+".$_\\d]");var U,H="__proto__"in{},J="undefined"!=typeof window,W="undefined"!=typeof WXEnvironment&&!!WXEnvironment.platform,V=W&&WXEnvironment.platform.toLowerCase(),K=J&&window.navigator.userAgent.toLowerCase(),Z=K&&/msie|trident/.test(K),Y=K&&K.indexOf("msie 9.0")>0,X=K&&K.indexOf("edge/")>0,Q=(K&&K.indexOf("android"),K&&/iphone|ipad|ipod|ios/.test(K)||"ios"===V),nn=(K&&/chrome\/\d+/.test(K),K&&/phantomjs/.test(K),K&&K.match(/firefox\/(\d+)/)),en={}.watch,tn=!1;if(J)try{var rn={};Object.defineProperty(rn,"passive",{get:function(){tn=!0}}),window.addEventListener("test-passive",null,rn)}catch(n){}var on=function(){return void 0===U&&(U=!J&&!W&&"undefined"!=typeof global&&(global.process&&"server"===global.process.env.VUE_ENV)),U},an=J&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function sn(n){return"function"==typeof n&&/native code/.test(n.toString())}var ln,cn="undefined"!=typeof Symbol&&sn(Symbol)&&"undefined"!=typeof Reflect&&sn(Reflect.ownKeys);ln="undefined"!=typeof Set&&sn(Set)?Set:function(){function n(){this.set=Object.create(null)}return n.prototype.has=function(n){return!0===this.set[n]},n.prototype.add=function(n){this.set[n]=!0},n.prototype.clear=function(){this.set=Object.create(null)},n}();var un=P,dn=0,pn=function(){this.id=dn++,this.subs=[]};pn.prototype.addSub=function(n){this.subs.push(n)},pn.prototype.removeSub=function(n){v(this.subs,n)},pn.prototype.depend=function(){pn.target&&pn.target.addDep(this)},pn.prototype.notify=function(){var n=this.subs.slice();for(var e=0,t=n.length;e<t;e++)n[e].update()},pn.target=null;var mn=[];function fn(n){mn.push(n),pn.target=n}function hn(){mn.pop(),pn.target=mn[mn.length-1]}var gn=function(n,e,t,r,o,a,i,s){this.tag=n,this.data=e,this.children=t,this.text=r,this.elm=o,this.ns=void 0,this.context=a,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=i,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},bn={child:{configurable:!0}};bn.child.get=function(){return this.componentInstance},Object.defineProperties(gn.prototype,bn);var yn=function(n){void 0===n&&(n="");var e=new gn;return e.text=n,e.isComment=!0,e};function vn(n){return new gn(void 0,void 0,void 0,String(n))}function xn(n){var e=new gn(n.tag,n.data,n.children&&n.children.slice(),n.text,n.elm,n.context,n.componentOptions,n.asyncFactory);return e.ns=n.ns,e.isStatic=n.isStatic,e.key=n.key,e.isComment=n.isComment,e.fnContext=n.fnContext,e.fnOptions=n.fnOptions,e.fnScopeId=n.fnScopeId,e.asyncMeta=n.asyncMeta,e.isCloned=!0,e}var wn=Array.prototype,kn=Object.create(wn);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(n){var e=wn[n];$(kn,n,(function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];var o,a=e.apply(this,t),i=this.__ob__;switch(n){case"push":case"unshift":o=t;break;case"splice":o=t.slice(2)}return o&&i.observeArray(o),i.dep.notify(),a}))}));var Sn=Object.getOwnPropertyNames(kn),jn=!0;function En(n){jn=n}var An=function(n){this.value=n,this.dep=new pn,this.vmCount=0,$(n,"__ob__",this),Array.isArray(n)?(H?function(n,e){n.__proto__=e}(n,kn):function(n,e,t){for(var r=0,o=t.length;r<o;r++){var a=t[r];$(n,a,e[a])}}(n,kn,Sn),this.observeArray(n)):this.walk(n)};function In(n,e){var t;if(c(n)&&!(n instanceof gn))return w(n,"__ob__")&&n.__ob__ instanceof An?t=n.__ob__:jn&&!on()&&(Array.isArray(n)||d(n))&&Object.isExtensible(n)&&!n._isVue&&(t=new An(n)),e&&t&&t.vmCount++,t}function Tn(n,e,t,r,o){var a=new pn,i=Object.getOwnPropertyDescriptor(n,e);if(!i||!1!==i.configurable){var s=i&&i.get,l=i&&i.set;s&&!l||2!==arguments.length||(t=n[e]);var c=!o&&In(t);Object.defineProperty(n,e,{enumerable:!0,configurable:!0,get:function(){var e=s?s.call(n):t;return pn.target&&(a.depend(),c&&(c.dep.depend(),Array.isArray(e)&&Cn(e))),e},set:function(e){var r=s?s.call(n):t;e===r||e!=e&&r!=r||s&&!l||(l?l.call(n,e):t=e,c=!o&&In(e),a.notify())}})}}function zn(n,e,t){if(Array.isArray(n)&&m(e))return n.length=Math.max(n.length,e),n.splice(e,1,t),t;if(e in n&&!(e in Object.prototype))return n[e]=t,t;var r=n.__ob__;return n._isVue||r&&r.vmCount?t:r?(Tn(r.value,e,t),r.dep.notify(),t):(n[e]=t,t)}function _n(n,e){if(Array.isArray(n)&&m(e))n.splice(e,1);else{var t=n.__ob__;n._isVue||t&&t.vmCount||w(n,e)&&(delete n[e],t&&t.dep.notify())}}function Cn(n){for(var e=void 0,t=0,r=n.length;t<r;t++)(e=n[t])&&e.__ob__&&e.__ob__.dep.depend(),Array.isArray(e)&&Cn(e)}An.prototype.walk=function(n){for(var e=Object.keys(n),t=0;t<e.length;t++)Tn(n,e[t])},An.prototype.observeArray=function(n){for(var e=0,t=n.length;e<t;e++)In(n[e])};var Pn=F.optionMergeStrategies;function On(n,e){if(!e)return n;for(var t,r,o,a=cn?Reflect.ownKeys(e):Object.keys(e),i=0;i<a.length;i++)"__ob__"!==(t=a[i])&&(r=n[t],o=e[t],w(n,t)?r!==o&&d(r)&&d(o)&&On(r,o):zn(n,t,o));return n}function Mn(n,e,t){return t?function(){var r="function"==typeof e?e.call(t,t):e,o="function"==typeof n?n.call(t,t):n;return r?On(r,o):o}:e?n?function(){return On("function"==typeof e?e.call(this,this):e,"function"==typeof n?n.call(this,this):n)}:e:n}function Dn(n,e){var t=e?n?n.concat(e):Array.isArray(e)?e:[e]:n;return t?function(n){for(var e=[],t=0;t<n.length;t++)-1===e.indexOf(n[t])&&e.push(n[t]);return e}(t):t}function Rn(n,e,t,r){var o=Object.create(n||null);return e?_(o,e):o}Pn.data=function(n,e,t){return t?Mn(n,e,t):e&&"function"!=typeof e?n:Mn(n,e)},N.forEach((function(n){Pn[n]=Dn})),L.forEach((function(n){Pn[n+"s"]=Rn})),Pn.watch=function(n,e,t,r){if(n===en&&(n=void 0),e===en&&(e=void 0),!e)return Object.create(n||null);if(!n)return e;var o={};for(var a in _(o,n),e){var i=o[a],s=e[a];i&&!Array.isArray(i)&&(i=[i]),o[a]=i?i.concat(s):Array.isArray(s)?s:[s]}return o},Pn.props=Pn.methods=Pn.inject=Pn.computed=function(n,e,t,r){if(!n)return e;var o=Object.create(null);return _(o,n),e&&_(o,e),o},Pn.provide=Mn;var Bn=function(n,e){return void 0===e?n:e};function Ln(n,e,t){if("function"==typeof e&&(e=e.options),function(n,e){var t=n.props;if(t){var r,o,a={};if(Array.isArray(t))for(r=t.length;r--;)"string"==typeof(o=t[r])&&(a[j(o)]={type:null});else if(d(t))for(var i in t)o=t[i],a[j(i)]=d(o)?o:{type:o};else 0;n.props=a}}(e),function(n,e){var t=n.inject;if(t){var r=n.inject={};if(Array.isArray(t))for(var o=0;o<t.length;o++)r[t[o]]={from:t[o]};else if(d(t))for(var a in t){var i=t[a];r[a]=d(i)?_({from:a},i):{from:i}}else 0}}(e),function(n){var e=n.directives;if(e)for(var t in e){var r=e[t];"function"==typeof r&&(e[t]={bind:r,update:r})}}(e),!e._base&&(e.extends&&(n=Ln(n,e.extends,t)),e.mixins))for(var r=0,o=e.mixins.length;r<o;r++)n=Ln(n,e.mixins[r],t);var a,i={};for(a in n)s(a);for(a in e)w(n,a)||s(a);function s(r){var o=Pn[r]||Bn;i[r]=o(n[r],e[r],t,r)}return i}function Nn(n,e,t,r){if("string"==typeof t){var o=n[e];if(w(o,t))return o[t];var a=j(t);if(w(o,a))return o[a];var i=E(a);return w(o,i)?o[i]:o[t]||o[a]||o[i]}}function Fn(n,e,t,r){var o=e[n],a=!w(t,n),i=t[n],s=Un(Boolean,o.type);if(s>-1)if(a&&!w(o,"default"))i=!1;else if(""===i||i===I(n)){var l=Un(String,o.type);(l<0||s<l)&&(i=!0)}if(void 0===i){i=function(n,e,t){if(!w(e,"default"))return;var r=e.default;0;if(n&&n.$options.propsData&&void 0===n.$options.propsData[t]&&void 0!==n._props[t])return n._props[t];return"function"==typeof r&&"Function"!==$n(e.type)?r.call(n):r}(r,o,n);var c=jn;En(!0),In(i),En(c)}return i}var qn=/^\s*function (\w+)/;function $n(n){var e=n&&n.toString().match(qn);return e?e[1]:""}function Gn(n,e){return $n(n)===$n(e)}function Un(n,e){if(!Array.isArray(e))return Gn(e,n)?0:-1;for(var t=0,r=e.length;t<r;t++)if(Gn(e[t],n))return t;return-1}function Hn(n,e,t){fn();try{if(e)for(var r=e;r=r.$parent;){var o=r.$options.errorCaptured;if(o)for(var a=0;a<o.length;a++)try{if(!1===o[a].call(r,n,e,t))return}catch(n){Wn(n,r,"errorCaptured hook")}}Wn(n,e,t)}finally{hn()}}function Jn(n,e,t,r,o){var a;try{(a=t?n.apply(e,t):n.call(e))&&!a._isVue&&f(a)&&!a._handled&&(a.catch((function(n){return Hn(n,r,o+" (Promise/async)")})),a._handled=!0)}catch(n){Hn(n,r,o)}return a}function Wn(n,e,t){if(F.errorHandler)try{return F.errorHandler.call(null,n,e,t)}catch(e){e!==n&&Vn(e,null,"config.errorHandler")}Vn(n,e,t)}function Vn(n,e,t){if(!J&&!W||"undefined"==typeof console)throw n;console.error(n)}var Kn,Zn=!1,Yn=[],Xn=!1;function Qn(){Xn=!1;var n=Yn.slice(0);Yn.length=0;for(var e=0;e<n.length;e++)n[e]()}if("undefined"!=typeof Promise&&sn(Promise)){var ne=Promise.resolve();Kn=function(){ne.then(Qn),Q&&setTimeout(P)},Zn=!0}else if(Z||"undefined"==typeof MutationObserver||!sn(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Kn="undefined"!=typeof setImmediate&&sn(setImmediate)?function(){setImmediate(Qn)}:function(){setTimeout(Qn,0)};else{var ee=1,te=new MutationObserver(Qn),re=document.createTextNode(String(ee));te.observe(re,{characterData:!0}),Kn=function(){ee=(ee+1)%2,re.data=String(ee)},Zn=!0}function oe(n,e){var t;if(Yn.push((function(){if(n)try{n.call(e)}catch(n){Hn(n,e,"nextTick")}else t&&t(e)})),Xn||(Xn=!0,Kn()),!n&&"undefined"!=typeof Promise)return new Promise((function(n){t=n}))}var ae=new ln;function ie(n){!function n(e,t){var r,o,a=Array.isArray(e);if(!a&&!c(e)||Object.isFrozen(e)||e instanceof gn)return;if(e.__ob__){var i=e.__ob__.dep.id;if(t.has(i))return;t.add(i)}if(a)for(r=e.length;r--;)n(e[r],t);else for(o=Object.keys(e),r=o.length;r--;)n(e[o[r]],t)}(n,ae),ae.clear()}var se=k((function(n){var e="&"===n.charAt(0),t="~"===(n=e?n.slice(1):n).charAt(0),r="!"===(n=t?n.slice(1):n).charAt(0);return{name:n=r?n.slice(1):n,once:t,capture:r,passive:e}}));function le(n,e){function t(){var n=arguments,r=t.fns;if(!Array.isArray(r))return Jn(r,null,arguments,e,"v-on handler");for(var o=r.slice(),a=0;a<o.length;a++)Jn(o[a],null,n,e,"v-on handler")}return t.fns=n,t}function ce(n,e,t,r,o,i){var l,c,u,d;for(l in n)c=n[l],u=e[l],d=se(l),a(c)||(a(u)?(a(c.fns)&&(c=n[l]=le(c,i)),s(d.once)&&(c=n[l]=o(d.name,c,d.capture)),t(d.name,c,d.capture,d.passive,d.params)):c!==u&&(u.fns=c,n[l]=u));for(l in e)a(n[l])&&r((d=se(l)).name,e[l],d.capture)}function ue(n,e,t){var r;n instanceof gn&&(n=n.data.hook||(n.data.hook={}));var o=n[e];function l(){t.apply(this,arguments),v(r.fns,l)}a(o)?r=le([l]):i(o.fns)&&s(o.merged)?(r=o).fns.push(l):r=le([o,l]),r.merged=!0,n[e]=r}function de(n,e,t,r,o){if(i(e)){if(w(e,t))return n[t]=e[t],o||delete e[t],!0;if(w(e,r))return n[t]=e[r],o||delete e[r],!0}return!1}function pe(n){return l(n)?[vn(n)]:Array.isArray(n)?function n(e,t){var r,o,c,u,d=[];for(r=0;r<e.length;r++)a(o=e[r])||"boolean"==typeof o||(c=d.length-1,u=d[c],Array.isArray(o)?o.length>0&&(me((o=n(o,(t||"")+"_"+r))[0])&&me(u)&&(d[c]=vn(u.text+o[0].text),o.shift()),d.push.apply(d,o)):l(o)?me(u)?d[c]=vn(u.text+o):""!==o&&d.push(vn(o)):me(o)&&me(u)?d[c]=vn(u.text+o.text):(s(e._isVList)&&i(o.tag)&&a(o.key)&&i(t)&&(o.key="__vlist"+t+"_"+r+"__"),d.push(o)));return d}(n):void 0}function me(n){return i(n)&&i(n.text)&&!1===n.isComment}function fe(n,e){if(n){for(var t=Object.create(null),r=cn?Reflect.ownKeys(n):Object.keys(n),o=0;o<r.length;o++){var a=r[o];if("__ob__"!==a){for(var i=n[a].from,s=e;s;){if(s._provided&&w(s._provided,i)){t[a]=s._provided[i];break}s=s.$parent}if(!s)if("default"in n[a]){var l=n[a].default;t[a]="function"==typeof l?l.call(e):l}else 0}}return t}}function he(n,e){if(!n||!n.length)return{};for(var t={},r=0,o=n.length;r<o;r++){var a=n[r],i=a.data;if(i&&i.attrs&&i.attrs.slot&&delete i.attrs.slot,a.context!==e&&a.fnContext!==e||!i||null==i.slot)(t.default||(t.default=[])).push(a);else{var s=i.slot,l=t[s]||(t[s]=[]);"template"===a.tag?l.push.apply(l,a.children||[]):l.push(a)}}for(var c in t)t[c].every(ge)&&delete t[c];return t}function ge(n){return n.isComment&&!n.asyncFactory||" "===n.text}function be(n){return n.isComment&&n.asyncFactory}function ye(n,e,t){var r,a=Object.keys(e).length>0,i=n?!!n.$stable:!a,s=n&&n.$key;if(n){if(n._normalized)return n._normalized;if(i&&t&&t!==o&&s===t.$key&&!a&&!t.$hasNormal)return t;for(var l in r={},n)n[l]&&"$"!==l[0]&&(r[l]=ve(e,l,n[l]))}else r={};for(var c in e)c in r||(r[c]=xe(e,c));return n&&Object.isExtensible(n)&&(n._normalized=r),$(r,"$stable",i),$(r,"$key",s),$(r,"$hasNormal",a),r}function ve(n,e,t){var r=function(){var n=arguments.length?t.apply(null,arguments):t({}),e=(n=n&&"object"==typeof n&&!Array.isArray(n)?[n]:pe(n))&&n[0];return n&&(!e||1===n.length&&e.isComment&&!be(e))?void 0:n};return t.proxy&&Object.defineProperty(n,e,{get:r,enumerable:!0,configurable:!0}),r}function xe(n,e){return function(){return n[e]}}function we(n,e){var t,r,o,a,s;if(Array.isArray(n)||"string"==typeof n)for(t=new Array(n.length),r=0,o=n.length;r<o;r++)t[r]=e(n[r],r);else if("number"==typeof n)for(t=new Array(n),r=0;r<n;r++)t[r]=e(r+1,r);else if(c(n))if(cn&&n[Symbol.iterator]){t=[];for(var l=n[Symbol.iterator](),u=l.next();!u.done;)t.push(e(u.value,t.length)),u=l.next()}else for(a=Object.keys(n),t=new Array(a.length),r=0,o=a.length;r<o;r++)s=a[r],t[r]=e(n[s],s,r);return i(t)||(t=[]),t._isVList=!0,t}function ke(n,e,t,r){var o,a=this.$scopedSlots[n];a?(t=t||{},r&&(t=_(_({},r),t)),o=a(t)||("function"==typeof e?e():e)):o=this.$slots[n]||("function"==typeof e?e():e);var i=t&&t.slot;return i?this.$createElement("template",{slot:i},o):o}function Se(n){return Nn(this.$options,"filters",n)||M}function je(n,e){return Array.isArray(n)?-1===n.indexOf(e):n!==e}function Ee(n,e,t,r,o){var a=F.keyCodes[e]||t;return o&&r&&!F.keyCodes[e]?je(o,r):a?je(a,n):r?I(r)!==e:void 0===n}function Ae(n,e,t,r,o){if(t)if(c(t)){var a;Array.isArray(t)&&(t=C(t));var i=function(i){if("class"===i||"style"===i||y(i))a=n;else{var s=n.attrs&&n.attrs.type;a=r||F.mustUseProp(e,s,i)?n.domProps||(n.domProps={}):n.attrs||(n.attrs={})}var l=j(i),c=I(i);l in a||c in a||(a[i]=t[i],o&&((n.on||(n.on={}))["update:"+i]=function(n){t[i]=n}))};for(var s in t)i(s)}else;return n}function Ie(n,e){var t=this._staticTrees||(this._staticTrees=[]),r=t[n];return r&&!e||ze(r=t[n]=this.$options.staticRenderFns[n].call(this._renderProxy,null,this),"__static__"+n,!1),r}function Te(n,e,t){return ze(n,"__once__"+e+(t?"_"+t:""),!0),n}function ze(n,e,t){if(Array.isArray(n))for(var r=0;r<n.length;r++)n[r]&&"string"!=typeof n[r]&&_e(n[r],e+"_"+r,t);else _e(n,e,t)}function _e(n,e,t){n.isStatic=!0,n.key=e,n.isOnce=t}function Ce(n,e){if(e)if(d(e)){var t=n.on=n.on?_({},n.on):{};for(var r in e){var o=t[r],a=e[r];t[r]=o?[].concat(o,a):a}}else;return n}function Pe(n,e,t,r){e=e||{$stable:!t};for(var o=0;o<n.length;o++){var a=n[o];Array.isArray(a)?Pe(a,e,t):a&&(a.proxy&&(a.fn.proxy=!0),e[a.key]=a.fn)}return r&&(e.$key=r),e}function Oe(n,e){for(var t=0;t<e.length;t+=2){var r=e[t];"string"==typeof r&&r&&(n[e[t]]=e[t+1])}return n}function Me(n,e){return"string"==typeof n?e+n:n}function De(n){n._o=Te,n._n=g,n._s=h,n._l=we,n._t=ke,n._q=D,n._i=R,n._m=Ie,n._f=Se,n._k=Ee,n._b=Ae,n._v=vn,n._e=yn,n._u=Pe,n._g=Ce,n._d=Oe,n._p=Me}function Re(n,e,t,r,a){var i,l=this,c=a.options;w(r,"_uid")?(i=Object.create(r))._original=r:(i=r,r=r._original);var u=s(c._compiled),d=!u;this.data=n,this.props=e,this.children=t,this.parent=r,this.listeners=n.on||o,this.injections=fe(c.inject,r),this.slots=function(){return l.$slots||ye(n.scopedSlots,l.$slots=he(t,r)),l.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return ye(n.scopedSlots,this.slots())}}),u&&(this.$options=c,this.$slots=this.slots(),this.$scopedSlots=ye(n.scopedSlots,this.$slots)),c._scopeId?this._c=function(n,e,t,o){var a=Ge(i,n,e,t,o,d);return a&&!Array.isArray(a)&&(a.fnScopeId=c._scopeId,a.fnContext=r),a}:this._c=function(n,e,t,r){return Ge(i,n,e,t,r,d)}}function Be(n,e,t,r,o){var a=xn(n);return a.fnContext=t,a.fnOptions=r,e.slot&&((a.data||(a.data={})).slot=e.slot),a}function Le(n,e){for(var t in e)n[j(t)]=e[t]}De(Re.prototype);var Ne={init:function(n,e){if(n.componentInstance&&!n.componentInstance._isDestroyed&&n.data.keepAlive){var t=n;Ne.prepatch(t,t)}else{(n.componentInstance=function(n,e){var t={_isComponent:!0,_parentVnode:n,parent:e},r=n.data.inlineTemplate;i(r)&&(t.render=r.render,t.staticRenderFns=r.staticRenderFns);return new n.componentOptions.Ctor(t)}(n,Xe)).$mount(e?n.elm:void 0,e)}},prepatch:function(n,e){var t=e.componentOptions;!function(n,e,t,r,a){0;var i=r.data.scopedSlots,s=n.$scopedSlots,l=!!(i&&!i.$stable||s!==o&&!s.$stable||i&&n.$scopedSlots.$key!==i.$key||!i&&n.$scopedSlots.$key),c=!!(a||n.$options._renderChildren||l);n.$options._parentVnode=r,n.$vnode=r,n._vnode&&(n._vnode.parent=r);if(n.$options._renderChildren=a,n.$attrs=r.data.attrs||o,n.$listeners=t||o,e&&n.$options.props){En(!1);for(var u=n._props,d=n.$options._propKeys||[],p=0;p<d.length;p++){var m=d[p],f=n.$options.props;u[m]=Fn(m,f,e,n)}En(!0),n.$options.propsData=e}t=t||o;var h=n.$options._parentListeners;n.$options._parentListeners=t,Ye(n,t,h),c&&(n.$slots=he(a,r.context),n.$forceUpdate());0}(e.componentInstance=n.componentInstance,t.propsData,t.listeners,e,t.children)},insert:function(n){var e,t=n.context,r=n.componentInstance;r._isMounted||(r._isMounted=!0,tt(r,"mounted")),n.data.keepAlive&&(t._isMounted?((e=r)._inactive=!1,ot.push(e)):et(r,!0))},destroy:function(n){var e=n.componentInstance;e._isDestroyed||(n.data.keepAlive?function n(e,t){if(t&&(e._directInactive=!0,nt(e)))return;if(!e._inactive){e._inactive=!0;for(var r=0;r<e.$children.length;r++)n(e.$children[r]);tt(e,"deactivated")}}(e,!0):e.$destroy())}},Fe=Object.keys(Ne);function qe(n,e,t,r,l){if(!a(n)){var u=t.$options._base;if(c(n)&&(n=u.extend(n)),"function"==typeof n){var d;if(a(n.cid)&&void 0===(n=function(n,e){if(s(n.error)&&i(n.errorComp))return n.errorComp;if(i(n.resolved))return n.resolved;var t=He;t&&i(n.owners)&&-1===n.owners.indexOf(t)&&n.owners.push(t);if(s(n.loading)&&i(n.loadingComp))return n.loadingComp;if(t&&!i(n.owners)){var r=n.owners=[t],o=!0,l=null,u=null;t.$on("hook:destroyed",(function(){return v(r,t)}));var d=function(n){for(var e=0,t=r.length;e<t;e++)r[e].$forceUpdate();n&&(r.length=0,null!==l&&(clearTimeout(l),l=null),null!==u&&(clearTimeout(u),u=null))},p=B((function(t){n.resolved=Je(t,e),o?r.length=0:d(!0)})),m=B((function(e){i(n.errorComp)&&(n.error=!0,d(!0))})),h=n(p,m);return c(h)&&(f(h)?a(n.resolved)&&h.then(p,m):f(h.component)&&(h.component.then(p,m),i(h.error)&&(n.errorComp=Je(h.error,e)),i(h.loading)&&(n.loadingComp=Je(h.loading,e),0===h.delay?n.loading=!0:l=setTimeout((function(){l=null,a(n.resolved)&&a(n.error)&&(n.loading=!0,d(!1))}),h.delay||200)),i(h.timeout)&&(u=setTimeout((function(){u=null,a(n.resolved)&&m(null)}),h.timeout)))),o=!1,n.loading?n.loadingComp:n.resolved}}(d=n,u)))return function(n,e,t,r,o){var a=yn();return a.asyncFactory=n,a.asyncMeta={data:e,context:t,children:r,tag:o},a}(d,e,t,r,l);e=e||{},jt(n),i(e.model)&&function(n,e){var t=n.model&&n.model.prop||"value",r=n.model&&n.model.event||"input";(e.attrs||(e.attrs={}))[t]=e.model.value;var o=e.on||(e.on={}),a=o[r],s=e.model.callback;i(a)?(Array.isArray(a)?-1===a.indexOf(s):a!==s)&&(o[r]=[s].concat(a)):o[r]=s}(n.options,e);var p=function(n,e,t){var r=e.options.props;if(!a(r)){var o={},s=n.attrs,l=n.props;if(i(s)||i(l))for(var c in r){var u=I(c);de(o,l,c,u,!0)||de(o,s,c,u,!1)}return o}}(e,n);if(s(n.options.functional))return function(n,e,t,r,a){var s=n.options,l={},c=s.props;if(i(c))for(var u in c)l[u]=Fn(u,c,e||o);else i(t.attrs)&&Le(l,t.attrs),i(t.props)&&Le(l,t.props);var d=new Re(t,l,a,r,n),p=s.render.call(null,d._c,d);if(p instanceof gn)return Be(p,t,d.parent,s,d);if(Array.isArray(p)){for(var m=pe(p)||[],f=new Array(m.length),h=0;h<m.length;h++)f[h]=Be(m[h],t,d.parent,s,d);return f}}(n,p,e,t,r);var m=e.on;if(e.on=e.nativeOn,s(n.options.abstract)){var h=e.slot;e={},h&&(e.slot=h)}!function(n){for(var e=n.hook||(n.hook={}),t=0;t<Fe.length;t++){var r=Fe[t],o=e[r],a=Ne[r];o===a||o&&o._merged||(e[r]=o?$e(a,o):a)}}(e);var g=n.options.name||l;return new gn("vue-component-"+n.cid+(g?"-"+g:""),e,void 0,void 0,void 0,t,{Ctor:n,propsData:p,listeners:m,tag:l,children:r},d)}}}function $e(n,e){var t=function(t,r){n(t,r),e(t,r)};return t._merged=!0,t}function Ge(n,e,t,r,o,u){return(Array.isArray(t)||l(t))&&(o=r,r=t,t=void 0),s(u)&&(o=2),function(n,e,t,r,o){if(i(t)&&i(t.__ob__))return yn();i(t)&&i(t.is)&&(e=t.is);if(!e)return yn();0;Array.isArray(r)&&"function"==typeof r[0]&&((t=t||{}).scopedSlots={default:r[0]},r.length=0);2===o?r=pe(r):1===o&&(r=function(n){for(var e=0;e<n.length;e++)if(Array.isArray(n[e]))return Array.prototype.concat.apply([],n);return n}(r));var l,u;if("string"==typeof e){var d;u=n.$vnode&&n.$vnode.ns||F.getTagNamespace(e),l=F.isReservedTag(e)?new gn(F.parsePlatformTagName(e),t,r,void 0,void 0,n):t&&t.pre||!i(d=Nn(n.$options,"components",e))?new gn(e,t,r,void 0,void 0,n):qe(d,t,n,r,e)}else l=qe(e,t,n,r);return Array.isArray(l)?l:i(l)?(i(u)&&function n(e,t,r){e.ns=t,"foreignObject"===e.tag&&(t=void 0,r=!0);if(i(e.children))for(var o=0,l=e.children.length;o<l;o++){var c=e.children[o];i(c.tag)&&(a(c.ns)||s(r)&&"svg"!==c.tag)&&n(c,t,r)}}(l,u),i(t)&&function(n){c(n.style)&&ie(n.style);c(n.class)&&ie(n.class)}(t),l):yn()}(n,e,t,r,o)}var Ue,He=null;function Je(n,e){return(n.__esModule||cn&&"Module"===n[Symbol.toStringTag])&&(n=n.default),c(n)?e.extend(n):n}function We(n){if(Array.isArray(n))for(var e=0;e<n.length;e++){var t=n[e];if(i(t)&&(i(t.componentOptions)||be(t)))return t}}function Ve(n,e){Ue.$on(n,e)}function Ke(n,e){Ue.$off(n,e)}function Ze(n,e){var t=Ue;return function r(){var o=e.apply(null,arguments);null!==o&&t.$off(n,r)}}function Ye(n,e,t){Ue=n,ce(e,t||{},Ve,Ke,Ze,n),Ue=void 0}var Xe=null;function Qe(n){var e=Xe;return Xe=n,function(){Xe=e}}function nt(n){for(;n&&(n=n.$parent);)if(n._inactive)return!0;return!1}function et(n,e){if(e){if(n._directInactive=!1,nt(n))return}else if(n._directInactive)return;if(n._inactive||null===n._inactive){n._inactive=!1;for(var t=0;t<n.$children.length;t++)et(n.$children[t]);tt(n,"activated")}}function tt(n,e){fn();var t=n.$options[e],r=e+" hook";if(t)for(var o=0,a=t.length;o<a;o++)Jn(t[o],n,null,n,r);n._hasHookEvent&&n.$emit("hook:"+e),hn()}var rt=[],ot=[],at={},it=!1,st=!1,lt=0;var ct=0,ut=Date.now;if(J&&!Z){var dt=window.performance;dt&&"function"==typeof dt.now&&ut()>document.createEvent("Event").timeStamp&&(ut=function(){return dt.now()})}function pt(){var n,e;for(ct=ut(),st=!0,rt.sort((function(n,e){return n.id-e.id})),lt=0;lt<rt.length;lt++)(n=rt[lt]).before&&n.before(),e=n.id,at[e]=null,n.run();var t=ot.slice(),r=rt.slice();lt=rt.length=ot.length=0,at={},it=st=!1,function(n){for(var e=0;e<n.length;e++)n[e]._inactive=!0,et(n[e],!0)}(t),function(n){var e=n.length;for(;e--;){var t=n[e],r=t.vm;r._watcher===t&&r._isMounted&&!r._isDestroyed&&tt(r,"updated")}}(r),an&&F.devtools&&an.emit("flush")}var mt=0,ft=function(n,e,t,r,o){this.vm=n,o&&(n._watcher=this),n._watchers.push(this),r?(this.deep=!!r.deep,this.user=!!r.user,this.lazy=!!r.lazy,this.sync=!!r.sync,this.before=r.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=t,this.id=++mt,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new ln,this.newDepIds=new ln,this.expression="","function"==typeof e?this.getter=e:(this.getter=function(n){if(!G.test(n)){var e=n.split(".");return function(n){for(var t=0;t<e.length;t++){if(!n)return;n=n[e[t]]}return n}}}(e),this.getter||(this.getter=P)),this.value=this.lazy?void 0:this.get()};ft.prototype.get=function(){var n;fn(this);var e=this.vm;try{n=this.getter.call(e,e)}catch(n){if(!this.user)throw n;Hn(n,e,'getter for watcher "'+this.expression+'"')}finally{this.deep&&ie(n),hn(),this.cleanupDeps()}return n},ft.prototype.addDep=function(n){var e=n.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(n),this.depIds.has(e)||n.addSub(this))},ft.prototype.cleanupDeps=function(){for(var n=this.deps.length;n--;){var e=this.deps[n];this.newDepIds.has(e.id)||e.removeSub(this)}var t=this.depIds;this.depIds=this.newDepIds,this.newDepIds=t,this.newDepIds.clear(),t=this.deps,this.deps=this.newDeps,this.newDeps=t,this.newDeps.length=0},ft.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():function(n){var e=n.id;if(null==at[e]){if(at[e]=!0,st){for(var t=rt.length-1;t>lt&&rt[t].id>n.id;)t--;rt.splice(t+1,0,n)}else rt.push(n);it||(it=!0,oe(pt))}}(this)},ft.prototype.run=function(){if(this.active){var n=this.get();if(n!==this.value||c(n)||this.deep){var e=this.value;if(this.value=n,this.user){var t='callback for watcher "'+this.expression+'"';Jn(this.cb,this.vm,[n,e],this.vm,t)}else this.cb.call(this.vm,n,e)}}},ft.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},ft.prototype.depend=function(){for(var n=this.deps.length;n--;)this.deps[n].depend()},ft.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||v(this.vm._watchers,this);for(var n=this.deps.length;n--;)this.deps[n].removeSub(this);this.active=!1}};var ht={enumerable:!0,configurable:!0,get:P,set:P};function gt(n,e,t){ht.get=function(){return this[e][t]},ht.set=function(n){this[e][t]=n},Object.defineProperty(n,t,ht)}function bt(n){n._watchers=[];var e=n.$options;e.props&&function(n,e){var t=n.$options.propsData||{},r=n._props={},o=n.$options._propKeys=[];n.$parent&&En(!1);var a=function(a){o.push(a);var i=Fn(a,e,t,n);Tn(r,a,i),a in n||gt(n,"_props",a)};for(var i in e)a(i);En(!0)}(n,e.props),e.methods&&function(n,e){n.$options.props;for(var t in e)n[t]="function"!=typeof e[t]?P:T(e[t],n)}(n,e.methods),e.data?function(n){var e=n.$options.data;d(e=n._data="function"==typeof e?function(n,e){fn();try{return n.call(e,e)}catch(n){return Hn(n,e,"data()"),{}}finally{hn()}}(e,n):e||{})||(e={});var t=Object.keys(e),r=n.$options.props,o=(n.$options.methods,t.length);for(;o--;){var a=t[o];0,r&&w(r,a)||(i=void 0,36!==(i=(a+"").charCodeAt(0))&&95!==i&&gt(n,"_data",a))}var i;In(e,!0)}(n):In(n._data={},!0),e.computed&&function(n,e){var t=n._computedWatchers=Object.create(null),r=on();for(var o in e){var a=e[o],i="function"==typeof a?a:a.get;0,r||(t[o]=new ft(n,i||P,P,yt)),o in n||vt(n,o,a)}}(n,e.computed),e.watch&&e.watch!==en&&function(n,e){for(var t in e){var r=e[t];if(Array.isArray(r))for(var o=0;o<r.length;o++)kt(n,t,r[o]);else kt(n,t,r)}}(n,e.watch)}var yt={lazy:!0};function vt(n,e,t){var r=!on();"function"==typeof t?(ht.get=r?xt(e):wt(t),ht.set=P):(ht.get=t.get?r&&!1!==t.cache?xt(e):wt(t.get):P,ht.set=t.set||P),Object.defineProperty(n,e,ht)}function xt(n){return function(){var e=this._computedWatchers&&this._computedWatchers[n];if(e)return e.dirty&&e.evaluate(),pn.target&&e.depend(),e.value}}function wt(n){return function(){return n.call(this,this)}}function kt(n,e,t,r){return d(t)&&(r=t,t=t.handler),"string"==typeof t&&(t=n[t]),n.$watch(e,t,r)}var St=0;function jt(n){var e=n.options;if(n.super){var t=jt(n.super);if(t!==n.superOptions){n.superOptions=t;var r=function(n){var e,t=n.options,r=n.sealedOptions;for(var o in t)t[o]!==r[o]&&(e||(e={}),e[o]=t[o]);return e}(n);r&&_(n.extendOptions,r),(e=n.options=Ln(t,n.extendOptions)).name&&(e.components[e.name]=n)}}return e}function Et(n){this._init(n)}function At(n){n.cid=0;var e=1;n.extend=function(n){n=n||{};var t=this,r=t.cid,o=n._Ctor||(n._Ctor={});if(o[r])return o[r];var a=n.name||t.options.name;var i=function(n){this._init(n)};return(i.prototype=Object.create(t.prototype)).constructor=i,i.cid=e++,i.options=Ln(t.options,n),i.super=t,i.options.props&&function(n){var e=n.options.props;for(var t in e)gt(n.prototype,"_props",t)}(i),i.options.computed&&function(n){var e=n.options.computed;for(var t in e)vt(n.prototype,t,e[t])}(i),i.extend=t.extend,i.mixin=t.mixin,i.use=t.use,L.forEach((function(n){i[n]=t[n]})),a&&(i.options.components[a]=i),i.superOptions=t.options,i.extendOptions=n,i.sealedOptions=_({},i.options),o[r]=i,i}}function It(n){return n&&(n.Ctor.options.name||n.tag)}function Tt(n,e){return Array.isArray(n)?n.indexOf(e)>-1:"string"==typeof n?n.split(",").indexOf(e)>-1:!!p(n)&&n.test(e)}function zt(n,e){var t=n.cache,r=n.keys,o=n._vnode;for(var a in t){var i=t[a];if(i){var s=i.name;s&&!e(s)&&_t(t,a,r,o)}}}function _t(n,e,t,r){var o=n[e];!o||r&&o.tag===r.tag||o.componentInstance.$destroy(),n[e]=null,v(t,e)}!function(n){n.prototype._init=function(n){var e=this;e._uid=St++,e._isVue=!0,n&&n._isComponent?function(n,e){var t=n.$options=Object.create(n.constructor.options),r=e._parentVnode;t.parent=e.parent,t._parentVnode=r;var o=r.componentOptions;t.propsData=o.propsData,t._parentListeners=o.listeners,t._renderChildren=o.children,t._componentTag=o.tag,e.render&&(t.render=e.render,t.staticRenderFns=e.staticRenderFns)}(e,n):e.$options=Ln(jt(e.constructor),n||{},e),e._renderProxy=e,e._self=e,function(n){var e=n.$options,t=e.parent;if(t&&!e.abstract){for(;t.$options.abstract&&t.$parent;)t=t.$parent;t.$children.push(n)}n.$parent=t,n.$root=t?t.$root:n,n.$children=[],n.$refs={},n._watcher=null,n._inactive=null,n._directInactive=!1,n._isMounted=!1,n._isDestroyed=!1,n._isBeingDestroyed=!1}(e),function(n){n._events=Object.create(null),n._hasHookEvent=!1;var e=n.$options._parentListeners;e&&Ye(n,e)}(e),function(n){n._vnode=null,n._staticTrees=null;var e=n.$options,t=n.$vnode=e._parentVnode,r=t&&t.context;n.$slots=he(e._renderChildren,r),n.$scopedSlots=o,n._c=function(e,t,r,o){return Ge(n,e,t,r,o,!1)},n.$createElement=function(e,t,r,o){return Ge(n,e,t,r,o,!0)};var a=t&&t.data;Tn(n,"$attrs",a&&a.attrs||o,null,!0),Tn(n,"$listeners",e._parentListeners||o,null,!0)}(e),tt(e,"beforeCreate"),function(n){var e=fe(n.$options.inject,n);e&&(En(!1),Object.keys(e).forEach((function(t){Tn(n,t,e[t])})),En(!0))}(e),bt(e),function(n){var e=n.$options.provide;e&&(n._provided="function"==typeof e?e.call(n):e)}(e),tt(e,"created"),e.$options.el&&e.$mount(e.$options.el)}}(Et),function(n){var e={get:function(){return this._data}},t={get:function(){return this._props}};Object.defineProperty(n.prototype,"$data",e),Object.defineProperty(n.prototype,"$props",t),n.prototype.$set=zn,n.prototype.$delete=_n,n.prototype.$watch=function(n,e,t){if(d(e))return kt(this,n,e,t);(t=t||{}).user=!0;var r=new ft(this,n,e,t);if(t.immediate){var o='callback for immediate watcher "'+r.expression+'"';fn(),Jn(e,this,[r.value],this,o),hn()}return function(){r.teardown()}}}(Et),function(n){var e=/^hook:/;n.prototype.$on=function(n,t){var r=this;if(Array.isArray(n))for(var o=0,a=n.length;o<a;o++)r.$on(n[o],t);else(r._events[n]||(r._events[n]=[])).push(t),e.test(n)&&(r._hasHookEvent=!0);return r},n.prototype.$once=function(n,e){var t=this;function r(){t.$off(n,r),e.apply(t,arguments)}return r.fn=e,t.$on(n,r),t},n.prototype.$off=function(n,e){var t=this;if(!arguments.length)return t._events=Object.create(null),t;if(Array.isArray(n)){for(var r=0,o=n.length;r<o;r++)t.$off(n[r],e);return t}var a,i=t._events[n];if(!i)return t;if(!e)return t._events[n]=null,t;for(var s=i.length;s--;)if((a=i[s])===e||a.fn===e){i.splice(s,1);break}return t},n.prototype.$emit=function(n){var e=this,t=e._events[n];if(t){t=t.length>1?z(t):t;for(var r=z(arguments,1),o='event handler for "'+n+'"',a=0,i=t.length;a<i;a++)Jn(t[a],e,r,e,o)}return e}}(Et),function(n){n.prototype._update=function(n,e){var t=this,r=t.$el,o=t._vnode,a=Qe(t);t._vnode=n,t.$el=o?t.__patch__(o,n):t.__patch__(t.$el,n,e,!1),a(),r&&(r.__vue__=null),t.$el&&(t.$el.__vue__=t),t.$vnode&&t.$parent&&t.$vnode===t.$parent._vnode&&(t.$parent.$el=t.$el)},n.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},n.prototype.$destroy=function(){var n=this;if(!n._isBeingDestroyed){tt(n,"beforeDestroy"),n._isBeingDestroyed=!0;var e=n.$parent;!e||e._isBeingDestroyed||n.$options.abstract||v(e.$children,n),n._watcher&&n._watcher.teardown();for(var t=n._watchers.length;t--;)n._watchers[t].teardown();n._data.__ob__&&n._data.__ob__.vmCount--,n._isDestroyed=!0,n.__patch__(n._vnode,null),tt(n,"destroyed"),n.$off(),n.$el&&(n.$el.__vue__=null),n.$vnode&&(n.$vnode.parent=null)}}}(Et),function(n){De(n.prototype),n.prototype.$nextTick=function(n){return oe(n,this)},n.prototype._render=function(){var n,e=this,t=e.$options,r=t.render,o=t._parentVnode;o&&(e.$scopedSlots=ye(o.data.scopedSlots,e.$slots,e.$scopedSlots)),e.$vnode=o;try{He=e,n=r.call(e._renderProxy,e.$createElement)}catch(t){Hn(t,e,"render"),n=e._vnode}finally{He=null}return Array.isArray(n)&&1===n.length&&(n=n[0]),n instanceof gn||(n=yn()),n.parent=o,n}}(Et);var Ct=[String,RegExp,Array],Pt={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:Ct,exclude:Ct,max:[String,Number]},methods:{cacheVNode:function(){var n=this.cache,e=this.keys,t=this.vnodeToCache,r=this.keyToCache;if(t){var o=t.tag,a=t.componentInstance,i=t.componentOptions;n[r]={name:It(i),tag:o,componentInstance:a},e.push(r),this.max&&e.length>parseInt(this.max)&&_t(n,e[0],e,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var n in this.cache)_t(this.cache,n,this.keys)},mounted:function(){var n=this;this.cacheVNode(),this.$watch("include",(function(e){zt(n,(function(n){return Tt(e,n)}))})),this.$watch("exclude",(function(e){zt(n,(function(n){return!Tt(e,n)}))}))},updated:function(){this.cacheVNode()},render:function(){var n=this.$slots.default,e=We(n),t=e&&e.componentOptions;if(t){var r=It(t),o=this.include,a=this.exclude;if(o&&(!r||!Tt(o,r))||a&&r&&Tt(a,r))return e;var i=this.cache,s=this.keys,l=null==e.key?t.Ctor.cid+(t.tag?"::"+t.tag:""):e.key;i[l]?(e.componentInstance=i[l].componentInstance,v(s,l),s.push(l)):(this.vnodeToCache=e,this.keyToCache=l),e.data.keepAlive=!0}return e||n&&n[0]}}};!function(n){var e={get:function(){return F}};Object.defineProperty(n,"config",e),n.util={warn:un,extend:_,mergeOptions:Ln,defineReactive:Tn},n.set=zn,n.delete=_n,n.nextTick=oe,n.observable=function(n){return In(n),n},n.options=Object.create(null),L.forEach((function(e){n.options[e+"s"]=Object.create(null)})),n.options._base=n,_(n.options.components,Pt),function(n){n.use=function(n){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(n)>-1)return this;var t=z(arguments,1);return t.unshift(this),"function"==typeof n.install?n.install.apply(n,t):"function"==typeof n&&n.apply(null,t),e.push(n),this}}(n),function(n){n.mixin=function(n){return this.options=Ln(this.options,n),this}}(n),At(n),function(n){L.forEach((function(e){n[e]=function(n,t){return t?("component"===e&&d(t)&&(t.name=t.name||n,t=this.options._base.extend(t)),"directive"===e&&"function"==typeof t&&(t={bind:t,update:t}),this.options[e+"s"][n]=t,t):this.options[e+"s"][n]}}))}(n)}(Et),Object.defineProperty(Et.prototype,"$isServer",{get:on}),Object.defineProperty(Et.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(Et,"FunctionalRenderContext",{value:Re}),Et.version="2.6.14";var Ot=b("style,class"),Mt=b("input,textarea,option,select,progress"),Dt=b("contenteditable,draggable,spellcheck"),Rt=b("events,caret,typing,plaintext-only"),Bt=b("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),Lt="http://www.w3.org/1999/xlink",Nt=function(n){return":"===n.charAt(5)&&"xlink"===n.slice(0,5)},Ft=function(n){return Nt(n)?n.slice(6,n.length):""},qt=function(n){return null==n||!1===n};function $t(n){for(var e=n.data,t=n,r=n;i(r.componentInstance);)(r=r.componentInstance._vnode)&&r.data&&(e=Gt(r.data,e));for(;i(t=t.parent);)t&&t.data&&(e=Gt(e,t.data));return function(n,e){if(i(n)||i(e))return Ut(n,Ht(e));return""}(e.staticClass,e.class)}function Gt(n,e){return{staticClass:Ut(n.staticClass,e.staticClass),class:i(n.class)?[n.class,e.class]:e.class}}function Ut(n,e){return n?e?n+" "+e:n:e||""}function Ht(n){return Array.isArray(n)?function(n){for(var e,t="",r=0,o=n.length;r<o;r++)i(e=Ht(n[r]))&&""!==e&&(t&&(t+=" "),t+=e);return t}(n):c(n)?function(n){var e="";for(var t in n)n[t]&&(e&&(e+=" "),e+=t);return e}(n):"string"==typeof n?n:""}var Jt={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},Wt=b("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),Vt=b("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),Kt=function(n){return Wt(n)||Vt(n)};var Zt=Object.create(null);var Yt=b("text,number,password,search,email,tel,url");var Xt=Object.freeze({createElement:function(n,e){var t=document.createElement(n);return"select"!==n||e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&t.setAttribute("multiple","multiple"),t},createElementNS:function(n,e){return document.createElementNS(Jt[n],e)},createTextNode:function(n){return document.createTextNode(n)},createComment:function(n){return document.createComment(n)},insertBefore:function(n,e,t){n.insertBefore(e,t)},removeChild:function(n,e){n.removeChild(e)},appendChild:function(n,e){n.appendChild(e)},parentNode:function(n){return n.parentNode},nextSibling:function(n){return n.nextSibling},tagName:function(n){return n.tagName},setTextContent:function(n,e){n.textContent=e},setStyleScope:function(n,e){n.setAttribute(e,"")}}),Qt={create:function(n,e){nr(e)},update:function(n,e){n.data.ref!==e.data.ref&&(nr(n,!0),nr(e))},destroy:function(n){nr(n,!0)}};function nr(n,e){var t=n.data.ref;if(i(t)){var r=n.context,o=n.componentInstance||n.elm,a=r.$refs;e?Array.isArray(a[t])?v(a[t],o):a[t]===o&&(a[t]=void 0):n.data.refInFor?Array.isArray(a[t])?a[t].indexOf(o)<0&&a[t].push(o):a[t]=[o]:a[t]=o}}var er=new gn("",{},[]),tr=["create","activate","update","remove","destroy"];function rr(n,e){return n.key===e.key&&n.asyncFactory===e.asyncFactory&&(n.tag===e.tag&&n.isComment===e.isComment&&i(n.data)===i(e.data)&&function(n,e){if("input"!==n.tag)return!0;var t,r=i(t=n.data)&&i(t=t.attrs)&&t.type,o=i(t=e.data)&&i(t=t.attrs)&&t.type;return r===o||Yt(r)&&Yt(o)}(n,e)||s(n.isAsyncPlaceholder)&&a(e.asyncFactory.error))}function or(n,e,t){var r,o,a={};for(r=e;r<=t;++r)i(o=n[r].key)&&(a[o]=r);return a}var ar={create:ir,update:ir,destroy:function(n){ir(n,er)}};function ir(n,e){(n.data.directives||e.data.directives)&&function(n,e){var t,r,o,a=n===er,i=e===er,s=lr(n.data.directives,n.context),l=lr(e.data.directives,e.context),c=[],u=[];for(t in l)r=s[t],o=l[t],r?(o.oldValue=r.value,o.oldArg=r.arg,ur(o,"update",e,n),o.def&&o.def.componentUpdated&&u.push(o)):(ur(o,"bind",e,n),o.def&&o.def.inserted&&c.push(o));if(c.length){var d=function(){for(var t=0;t<c.length;t++)ur(c[t],"inserted",e,n)};a?ue(e,"insert",d):d()}u.length&&ue(e,"postpatch",(function(){for(var t=0;t<u.length;t++)ur(u[t],"componentUpdated",e,n)}));if(!a)for(t in s)l[t]||ur(s[t],"unbind",n,n,i)}(n,e)}var sr=Object.create(null);function lr(n,e){var t,r,o=Object.create(null);if(!n)return o;for(t=0;t<n.length;t++)(r=n[t]).modifiers||(r.modifiers=sr),o[cr(r)]=r,r.def=Nn(e.$options,"directives",r.name);return o}function cr(n){return n.rawName||n.name+"."+Object.keys(n.modifiers||{}).join(".")}function ur(n,e,t,r,o){var a=n.def&&n.def[e];if(a)try{a(t.elm,n,t,r,o)}catch(r){Hn(r,t.context,"directive "+n.name+" "+e+" hook")}}var dr=[Qt,ar];function pr(n,e){var t=e.componentOptions;if(!(i(t)&&!1===t.Ctor.options.inheritAttrs||a(n.data.attrs)&&a(e.data.attrs))){var r,o,s=e.elm,l=n.data.attrs||{},c=e.data.attrs||{};for(r in i(c.__ob__)&&(c=e.data.attrs=_({},c)),c)o=c[r],l[r]!==o&&mr(s,r,o,e.data.pre);for(r in(Z||X)&&c.value!==l.value&&mr(s,"value",c.value),l)a(c[r])&&(Nt(r)?s.removeAttributeNS(Lt,Ft(r)):Dt(r)||s.removeAttribute(r))}}function mr(n,e,t,r){r||n.tagName.indexOf("-")>-1?fr(n,e,t):Bt(e)?qt(t)?n.removeAttribute(e):(t="allowfullscreen"===e&&"EMBED"===n.tagName?"true":e,n.setAttribute(e,t)):Dt(e)?n.setAttribute(e,function(n,e){return qt(e)||"false"===e?"false":"contenteditable"===n&&Rt(e)?e:"true"}(e,t)):Nt(e)?qt(t)?n.removeAttributeNS(Lt,Ft(e)):n.setAttributeNS(Lt,e,t):fr(n,e,t)}function fr(n,e,t){if(qt(t))n.removeAttribute(e);else{if(Z&&!Y&&"TEXTAREA"===n.tagName&&"placeholder"===e&&""!==t&&!n.__ieph){var r=function(e){e.stopImmediatePropagation(),n.removeEventListener("input",r)};n.addEventListener("input",r),n.__ieph=!0}n.setAttribute(e,t)}}var hr={create:pr,update:pr};function gr(n,e){var t=e.elm,r=e.data,o=n.data;if(!(a(r.staticClass)&&a(r.class)&&(a(o)||a(o.staticClass)&&a(o.class)))){var s=$t(e),l=t._transitionClasses;i(l)&&(s=Ut(s,Ht(l))),s!==t._prevClass&&(t.setAttribute("class",s),t._prevClass=s)}}var br,yr={create:gr,update:gr};function vr(n,e,t){var r=br;return function o(){var a=e.apply(null,arguments);null!==a&&kr(n,o,t,r)}}var xr=Zn&&!(nn&&Number(nn[1])<=53);function wr(n,e,t,r){if(xr){var o=ct,a=e;e=a._wrapper=function(n){if(n.target===n.currentTarget||n.timeStamp>=o||n.timeStamp<=0||n.target.ownerDocument!==document)return a.apply(this,arguments)}}br.addEventListener(n,e,tn?{capture:t,passive:r}:t)}function kr(n,e,t,r){(r||br).removeEventListener(n,e._wrapper||e,t)}function Sr(n,e){if(!a(n.data.on)||!a(e.data.on)){var t=e.data.on||{},r=n.data.on||{};br=e.elm,function(n){if(i(n.__r)){var e=Z?"change":"input";n[e]=[].concat(n.__r,n[e]||[]),delete n.__r}i(n.__c)&&(n.change=[].concat(n.__c,n.change||[]),delete n.__c)}(t),ce(t,r,wr,kr,vr,e.context),br=void 0}}var jr,Er={create:Sr,update:Sr};function Ar(n,e){if(!a(n.data.domProps)||!a(e.data.domProps)){var t,r,o=e.elm,s=n.data.domProps||{},l=e.data.domProps||{};for(t in i(l.__ob__)&&(l=e.data.domProps=_({},l)),s)t in l||(o[t]="");for(t in l){if(r=l[t],"textContent"===t||"innerHTML"===t){if(e.children&&(e.children.length=0),r===s[t])continue;1===o.childNodes.length&&o.removeChild(o.childNodes[0])}if("value"===t&&"PROGRESS"!==o.tagName){o._value=r;var c=a(r)?"":String(r);Ir(o,c)&&(o.value=c)}else if("innerHTML"===t&&Vt(o.tagName)&&a(o.innerHTML)){(jr=jr||document.createElement("div")).innerHTML="<svg>"+r+"</svg>";for(var u=jr.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;u.firstChild;)o.appendChild(u.firstChild)}else if(r!==s[t])try{o[t]=r}catch(n){}}}}function Ir(n,e){return!n.composing&&("OPTION"===n.tagName||function(n,e){var t=!0;try{t=document.activeElement!==n}catch(n){}return t&&n.value!==e}(n,e)||function(n,e){var t=n.value,r=n._vModifiers;if(i(r)){if(r.number)return g(t)!==g(e);if(r.trim)return t.trim()!==e.trim()}return t!==e}(n,e))}var Tr={create:Ar,update:Ar},zr=k((function(n){var e={},t=/:(.+)/;return n.split(/;(?![^(]*\))/g).forEach((function(n){if(n){var r=n.split(t);r.length>1&&(e[r[0].trim()]=r[1].trim())}})),e}));function _r(n){var e=Cr(n.style);return n.staticStyle?_(n.staticStyle,e):e}function Cr(n){return Array.isArray(n)?C(n):"string"==typeof n?zr(n):n}var Pr,Or=/^--/,Mr=/\s*!important$/,Dr=function(n,e,t){if(Or.test(e))n.style.setProperty(e,t);else if(Mr.test(t))n.style.setProperty(I(e),t.replace(Mr,""),"important");else{var r=Br(e);if(Array.isArray(t))for(var o=0,a=t.length;o<a;o++)n.style[r]=t[o];else n.style[r]=t}},Rr=["Webkit","Moz","ms"],Br=k((function(n){if(Pr=Pr||document.createElement("div").style,"filter"!==(n=j(n))&&n in Pr)return n;for(var e=n.charAt(0).toUpperCase()+n.slice(1),t=0;t<Rr.length;t++){var r=Rr[t]+e;if(r in Pr)return r}}));function Lr(n,e){var t=e.data,r=n.data;if(!(a(t.staticStyle)&&a(t.style)&&a(r.staticStyle)&&a(r.style))){var o,s,l=e.elm,c=r.staticStyle,u=r.normalizedStyle||r.style||{},d=c||u,p=Cr(e.data.style)||{};e.data.normalizedStyle=i(p.__ob__)?_({},p):p;var m=function(n,e){var t,r={};if(e)for(var o=n;o.componentInstance;)(o=o.componentInstance._vnode)&&o.data&&(t=_r(o.data))&&_(r,t);(t=_r(n.data))&&_(r,t);for(var a=n;a=a.parent;)a.data&&(t=_r(a.data))&&_(r,t);return r}(e,!0);for(s in d)a(m[s])&&Dr(l,s,"");for(s in m)(o=m[s])!==d[s]&&Dr(l,s,null==o?"":o)}}var Nr={create:Lr,update:Lr},Fr=/\s+/;function qr(n,e){if(e&&(e=e.trim()))if(n.classList)e.indexOf(" ")>-1?e.split(Fr).forEach((function(e){return n.classList.add(e)})):n.classList.add(e);else{var t=" "+(n.getAttribute("class")||"")+" ";t.indexOf(" "+e+" ")<0&&n.setAttribute("class",(t+e).trim())}}function $r(n,e){if(e&&(e=e.trim()))if(n.classList)e.indexOf(" ")>-1?e.split(Fr).forEach((function(e){return n.classList.remove(e)})):n.classList.remove(e),n.classList.length||n.removeAttribute("class");else{for(var t=" "+(n.getAttribute("class")||"")+" ",r=" "+e+" ";t.indexOf(r)>=0;)t=t.replace(r," ");(t=t.trim())?n.setAttribute("class",t):n.removeAttribute("class")}}function Gr(n){if(n){if("object"==typeof n){var e={};return!1!==n.css&&_(e,Ur(n.name||"v")),_(e,n),e}return"string"==typeof n?Ur(n):void 0}}var Ur=k((function(n){return{enterClass:n+"-enter",enterToClass:n+"-enter-to",enterActiveClass:n+"-enter-active",leaveClass:n+"-leave",leaveToClass:n+"-leave-to",leaveActiveClass:n+"-leave-active"}})),Hr=J&&!Y,Jr="transition",Wr="transitionend",Vr="animation",Kr="animationend";Hr&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(Jr="WebkitTransition",Wr="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Vr="WebkitAnimation",Kr="webkitAnimationEnd"));var Zr=J?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(n){return n()};function Yr(n){Zr((function(){Zr(n)}))}function Xr(n,e){var t=n._transitionClasses||(n._transitionClasses=[]);t.indexOf(e)<0&&(t.push(e),qr(n,e))}function Qr(n,e){n._transitionClasses&&v(n._transitionClasses,e),$r(n,e)}function no(n,e,t){var r=to(n,e),o=r.type,a=r.timeout,i=r.propCount;if(!o)return t();var s="transition"===o?Wr:Kr,l=0,c=function(){n.removeEventListener(s,u),t()},u=function(e){e.target===n&&++l>=i&&c()};setTimeout((function(){l<i&&c()}),a+1),n.addEventListener(s,u)}var eo=/\b(transform|all)(,|$)/;function to(n,e){var t,r=window.getComputedStyle(n),o=(r[Jr+"Delay"]||"").split(", "),a=(r[Jr+"Duration"]||"").split(", "),i=ro(o,a),s=(r[Vr+"Delay"]||"").split(", "),l=(r[Vr+"Duration"]||"").split(", "),c=ro(s,l),u=0,d=0;return"transition"===e?i>0&&(t="transition",u=i,d=a.length):"animation"===e?c>0&&(t="animation",u=c,d=l.length):d=(t=(u=Math.max(i,c))>0?i>c?"transition":"animation":null)?"transition"===t?a.length:l.length:0,{type:t,timeout:u,propCount:d,hasTransform:"transition"===t&&eo.test(r[Jr+"Property"])}}function ro(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max.apply(null,e.map((function(e,t){return oo(e)+oo(n[t])})))}function oo(n){return 1e3*Number(n.slice(0,-1).replace(",","."))}function ao(n,e){var t=n.elm;i(t._leaveCb)&&(t._leaveCb.cancelled=!0,t._leaveCb());var r=Gr(n.data.transition);if(!a(r)&&!i(t._enterCb)&&1===t.nodeType){for(var o=r.css,s=r.type,l=r.enterClass,u=r.enterToClass,d=r.enterActiveClass,p=r.appearClass,m=r.appearToClass,f=r.appearActiveClass,h=r.beforeEnter,b=r.enter,y=r.afterEnter,v=r.enterCancelled,x=r.beforeAppear,w=r.appear,k=r.afterAppear,S=r.appearCancelled,j=r.duration,E=Xe,A=Xe.$vnode;A&&A.parent;)E=A.context,A=A.parent;var I=!E._isMounted||!n.isRootInsert;if(!I||w||""===w){var T=I&&p?p:l,z=I&&f?f:d,_=I&&m?m:u,C=I&&x||h,P=I&&"function"==typeof w?w:b,O=I&&k||y,M=I&&S||v,D=g(c(j)?j.enter:j);0;var R=!1!==o&&!Y,L=lo(P),N=t._enterCb=B((function(){R&&(Qr(t,_),Qr(t,z)),N.cancelled?(R&&Qr(t,T),M&&M(t)):O&&O(t),t._enterCb=null}));n.data.show||ue(n,"insert",(function(){var e=t.parentNode,r=e&&e._pending&&e._pending[n.key];r&&r.tag===n.tag&&r.elm._leaveCb&&r.elm._leaveCb(),P&&P(t,N)})),C&&C(t),R&&(Xr(t,T),Xr(t,z),Yr((function(){Qr(t,T),N.cancelled||(Xr(t,_),L||(so(D)?setTimeout(N,D):no(t,s,N)))}))),n.data.show&&(e&&e(),P&&P(t,N)),R||L||N()}}}function io(n,e){var t=n.elm;i(t._enterCb)&&(t._enterCb.cancelled=!0,t._enterCb());var r=Gr(n.data.transition);if(a(r)||1!==t.nodeType)return e();if(!i(t._leaveCb)){var o=r.css,s=r.type,l=r.leaveClass,u=r.leaveToClass,d=r.leaveActiveClass,p=r.beforeLeave,m=r.leave,f=r.afterLeave,h=r.leaveCancelled,b=r.delayLeave,y=r.duration,v=!1!==o&&!Y,x=lo(m),w=g(c(y)?y.leave:y);0;var k=t._leaveCb=B((function(){t.parentNode&&t.parentNode._pending&&(t.parentNode._pending[n.key]=null),v&&(Qr(t,u),Qr(t,d)),k.cancelled?(v&&Qr(t,l),h&&h(t)):(e(),f&&f(t)),t._leaveCb=null}));b?b(S):S()}function S(){k.cancelled||(!n.data.show&&t.parentNode&&((t.parentNode._pending||(t.parentNode._pending={}))[n.key]=n),p&&p(t),v&&(Xr(t,l),Xr(t,d),Yr((function(){Qr(t,l),k.cancelled||(Xr(t,u),x||(so(w)?setTimeout(k,w):no(t,s,k)))}))),m&&m(t,k),v||x||k())}}function so(n){return"number"==typeof n&&!isNaN(n)}function lo(n){if(a(n))return!1;var e=n.fns;return i(e)?lo(Array.isArray(e)?e[0]:e):(n._length||n.length)>1}function co(n,e){!0!==e.data.show&&ao(e)}var uo=function(n){var e,t,r={},o=n.modules,c=n.nodeOps;for(e=0;e<tr.length;++e)for(r[tr[e]]=[],t=0;t<o.length;++t)i(o[t][tr[e]])&&r[tr[e]].push(o[t][tr[e]]);function u(n){var e=c.parentNode(n);i(e)&&c.removeChild(e,n)}function d(n,e,t,o,a,l,u){if(i(n.elm)&&i(l)&&(n=l[u]=xn(n)),n.isRootInsert=!a,!function(n,e,t,o){var a=n.data;if(i(a)){var l=i(n.componentInstance)&&a.keepAlive;if(i(a=a.hook)&&i(a=a.init)&&a(n,!1),i(n.componentInstance))return p(n,e),m(t,n.elm,o),s(l)&&function(n,e,t,o){var a,s=n;for(;s.componentInstance;)if(s=s.componentInstance._vnode,i(a=s.data)&&i(a=a.transition)){for(a=0;a<r.activate.length;++a)r.activate[a](er,s);e.push(s);break}m(t,n.elm,o)}(n,e,t,o),!0}}(n,e,t,o)){var d=n.data,h=n.children,b=n.tag;i(b)?(n.elm=n.ns?c.createElementNS(n.ns,b):c.createElement(b,n),y(n),f(n,h,e),i(d)&&g(n,e),m(t,n.elm,o)):s(n.isComment)?(n.elm=c.createComment(n.text),m(t,n.elm,o)):(n.elm=c.createTextNode(n.text),m(t,n.elm,o))}}function p(n,e){i(n.data.pendingInsert)&&(e.push.apply(e,n.data.pendingInsert),n.data.pendingInsert=null),n.elm=n.componentInstance.$el,h(n)?(g(n,e),y(n)):(nr(n),e.push(n))}function m(n,e,t){i(n)&&(i(t)?c.parentNode(t)===n&&c.insertBefore(n,e,t):c.appendChild(n,e))}function f(n,e,t){if(Array.isArray(e)){0;for(var r=0;r<e.length;++r)d(e[r],t,n.elm,null,!0,e,r)}else l(n.text)&&c.appendChild(n.elm,c.createTextNode(String(n.text)))}function h(n){for(;n.componentInstance;)n=n.componentInstance._vnode;return i(n.tag)}function g(n,t){for(var o=0;o<r.create.length;++o)r.create[o](er,n);i(e=n.data.hook)&&(i(e.create)&&e.create(er,n),i(e.insert)&&t.push(n))}function y(n){var e;if(i(e=n.fnScopeId))c.setStyleScope(n.elm,e);else for(var t=n;t;)i(e=t.context)&&i(e=e.$options._scopeId)&&c.setStyleScope(n.elm,e),t=t.parent;i(e=Xe)&&e!==n.context&&e!==n.fnContext&&i(e=e.$options._scopeId)&&c.setStyleScope(n.elm,e)}function v(n,e,t,r,o,a){for(;r<=o;++r)d(t[r],a,n,e,!1,t,r)}function x(n){var e,t,o=n.data;if(i(o))for(i(e=o.hook)&&i(e=e.destroy)&&e(n),e=0;e<r.destroy.length;++e)r.destroy[e](n);if(i(e=n.children))for(t=0;t<n.children.length;++t)x(n.children[t])}function w(n,e,t){for(;e<=t;++e){var r=n[e];i(r)&&(i(r.tag)?(k(r),x(r)):u(r.elm))}}function k(n,e){if(i(e)||i(n.data)){var t,o=r.remove.length+1;for(i(e)?e.listeners+=o:e=function(n,e){function t(){0==--t.listeners&&u(n)}return t.listeners=e,t}(n.elm,o),i(t=n.componentInstance)&&i(t=t._vnode)&&i(t.data)&&k(t,e),t=0;t<r.remove.length;++t)r.remove[t](n,e);i(t=n.data.hook)&&i(t=t.remove)?t(n,e):e()}else u(n.elm)}function S(n,e,t,r){for(var o=t;o<r;o++){var a=e[o];if(i(a)&&rr(n,a))return o}}function j(n,e,t,o,l,u){if(n!==e){i(e.elm)&&i(o)&&(e=o[l]=xn(e));var p=e.elm=n.elm;if(s(n.isAsyncPlaceholder))i(e.asyncFactory.resolved)?I(n.elm,e,t):e.isAsyncPlaceholder=!0;else if(s(e.isStatic)&&s(n.isStatic)&&e.key===n.key&&(s(e.isCloned)||s(e.isOnce)))e.componentInstance=n.componentInstance;else{var m,f=e.data;i(f)&&i(m=f.hook)&&i(m=m.prepatch)&&m(n,e);var g=n.children,b=e.children;if(i(f)&&h(e)){for(m=0;m<r.update.length;++m)r.update[m](n,e);i(m=f.hook)&&i(m=m.update)&&m(n,e)}a(e.text)?i(g)&&i(b)?g!==b&&function(n,e,t,r,o){var s,l,u,p=0,m=0,f=e.length-1,h=e[0],g=e[f],b=t.length-1,y=t[0],x=t[b],k=!o;for(0;p<=f&&m<=b;)a(h)?h=e[++p]:a(g)?g=e[--f]:rr(h,y)?(j(h,y,r,t,m),h=e[++p],y=t[++m]):rr(g,x)?(j(g,x,r,t,b),g=e[--f],x=t[--b]):rr(h,x)?(j(h,x,r,t,b),k&&c.insertBefore(n,h.elm,c.nextSibling(g.elm)),h=e[++p],x=t[--b]):rr(g,y)?(j(g,y,r,t,m),k&&c.insertBefore(n,g.elm,h.elm),g=e[--f],y=t[++m]):(a(s)&&(s=or(e,p,f)),a(l=i(y.key)?s[y.key]:S(y,e,p,f))?d(y,r,n,h.elm,!1,t,m):rr(u=e[l],y)?(j(u,y,r,t,m),e[l]=void 0,k&&c.insertBefore(n,u.elm,h.elm)):d(y,r,n,h.elm,!1,t,m),y=t[++m]);p>f?v(n,a(t[b+1])?null:t[b+1].elm,t,m,b,r):m>b&&w(e,p,f)}(p,g,b,t,u):i(b)?(i(n.text)&&c.setTextContent(p,""),v(p,null,b,0,b.length-1,t)):i(g)?w(g,0,g.length-1):i(n.text)&&c.setTextContent(p,""):n.text!==e.text&&c.setTextContent(p,e.text),i(f)&&i(m=f.hook)&&i(m=m.postpatch)&&m(n,e)}}}function E(n,e,t){if(s(t)&&i(n.parent))n.parent.data.pendingInsert=e;else for(var r=0;r<e.length;++r)e[r].data.hook.insert(e[r])}var A=b("attrs,class,staticClass,staticStyle,key");function I(n,e,t,r){var o,a=e.tag,l=e.data,c=e.children;if(r=r||l&&l.pre,e.elm=n,s(e.isComment)&&i(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(i(l)&&(i(o=l.hook)&&i(o=o.init)&&o(e,!0),i(o=e.componentInstance)))return p(e,t),!0;if(i(a)){if(i(c))if(n.hasChildNodes())if(i(o=l)&&i(o=o.domProps)&&i(o=o.innerHTML)){if(o!==n.innerHTML)return!1}else{for(var u=!0,d=n.firstChild,m=0;m<c.length;m++){if(!d||!I(d,c[m],t,r)){u=!1;break}d=d.nextSibling}if(!u||d)return!1}else f(e,c,t);if(i(l)){var h=!1;for(var b in l)if(!A(b)){h=!0,g(e,t);break}!h&&l.class&&ie(l.class)}}else n.data!==e.text&&(n.data=e.text);return!0}return function(n,e,t,o){if(!a(e)){var l,u=!1,p=[];if(a(n))u=!0,d(e,p);else{var m=i(n.nodeType);if(!m&&rr(n,e))j(n,e,p,null,null,o);else{if(m){if(1===n.nodeType&&n.hasAttribute("data-server-rendered")&&(n.removeAttribute("data-server-rendered"),t=!0),s(t)&&I(n,e,p))return E(e,p,!0),n;l=n,n=new gn(c.tagName(l).toLowerCase(),{},[],void 0,l)}var f=n.elm,g=c.parentNode(f);if(d(e,p,f._leaveCb?null:g,c.nextSibling(f)),i(e.parent))for(var b=e.parent,y=h(e);b;){for(var v=0;v<r.destroy.length;++v)r.destroy[v](b);if(b.elm=e.elm,y){for(var k=0;k<r.create.length;++k)r.create[k](er,b);var S=b.data.hook.insert;if(S.merged)for(var A=1;A<S.fns.length;A++)S.fns[A]()}else nr(b);b=b.parent}i(g)?w([n],0,0):i(n.tag)&&x(n)}}return E(e,p,u),e.elm}i(n)&&x(n)}}({nodeOps:Xt,modules:[hr,yr,Er,Tr,Nr,J?{create:co,activate:co,remove:function(n,e){!0!==n.data.show?io(n,e):e()}}:{}].concat(dr)});Y&&document.addEventListener("selectionchange",(function(){var n=document.activeElement;n&&n.vmodel&&vo(n,"input")}));var po={inserted:function(n,e,t,r){"select"===t.tag?(r.elm&&!r.elm._vOptions?ue(t,"postpatch",(function(){po.componentUpdated(n,e,t)})):mo(n,e,t.context),n._vOptions=[].map.call(n.options,go)):("textarea"===t.tag||Yt(n.type))&&(n._vModifiers=e.modifiers,e.modifiers.lazy||(n.addEventListener("compositionstart",bo),n.addEventListener("compositionend",yo),n.addEventListener("change",yo),Y&&(n.vmodel=!0)))},componentUpdated:function(n,e,t){if("select"===t.tag){mo(n,e,t.context);var r=n._vOptions,o=n._vOptions=[].map.call(n.options,go);if(o.some((function(n,e){return!D(n,r[e])})))(n.multiple?e.value.some((function(n){return ho(n,o)})):e.value!==e.oldValue&&ho(e.value,o))&&vo(n,"change")}}};function mo(n,e,t){fo(n,e,t),(Z||X)&&setTimeout((function(){fo(n,e,t)}),0)}function fo(n,e,t){var r=e.value,o=n.multiple;if(!o||Array.isArray(r)){for(var a,i,s=0,l=n.options.length;s<l;s++)if(i=n.options[s],o)a=R(r,go(i))>-1,i.selected!==a&&(i.selected=a);else if(D(go(i),r))return void(n.selectedIndex!==s&&(n.selectedIndex=s));o||(n.selectedIndex=-1)}}function ho(n,e){return e.every((function(e){return!D(e,n)}))}function go(n){return"_value"in n?n._value:n.value}function bo(n){n.target.composing=!0}function yo(n){n.target.composing&&(n.target.composing=!1,vo(n.target,"input"))}function vo(n,e){var t=document.createEvent("HTMLEvents");t.initEvent(e,!0,!0),n.dispatchEvent(t)}function xo(n){return!n.componentInstance||n.data&&n.data.transition?n:xo(n.componentInstance._vnode)}var wo={model:po,show:{bind:function(n,e,t){var r=e.value,o=(t=xo(t)).data&&t.data.transition,a=n.__vOriginalDisplay="none"===n.style.display?"":n.style.display;r&&o?(t.data.show=!0,ao(t,(function(){n.style.display=a}))):n.style.display=r?a:"none"},update:function(n,e,t){var r=e.value;!r!=!e.oldValue&&((t=xo(t)).data&&t.data.transition?(t.data.show=!0,r?ao(t,(function(){n.style.display=n.__vOriginalDisplay})):io(t,(function(){n.style.display="none"}))):n.style.display=r?n.__vOriginalDisplay:"none")},unbind:function(n,e,t,r,o){o||(n.style.display=n.__vOriginalDisplay)}}},ko={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function So(n){var e=n&&n.componentOptions;return e&&e.Ctor.options.abstract?So(We(e.children)):n}function jo(n){var e={},t=n.$options;for(var r in t.propsData)e[r]=n[r];var o=t._parentListeners;for(var a in o)e[j(a)]=o[a];return e}function Eo(n,e){if(/\d-keep-alive$/.test(e.tag))return n("keep-alive",{props:e.componentOptions.propsData})}var Ao=function(n){return n.tag||be(n)},Io=function(n){return"show"===n.name},To={name:"transition",props:ko,abstract:!0,render:function(n){var e=this,t=this.$slots.default;if(t&&(t=t.filter(Ao)).length){0;var r=this.mode;0;var o=t[0];if(function(n){for(;n=n.parent;)if(n.data.transition)return!0}(this.$vnode))return o;var a=So(o);if(!a)return o;if(this._leaving)return Eo(n,o);var i="__transition-"+this._uid+"-";a.key=null==a.key?a.isComment?i+"comment":i+a.tag:l(a.key)?0===String(a.key).indexOf(i)?a.key:i+a.key:a.key;var s=(a.data||(a.data={})).transition=jo(this),c=this._vnode,u=So(c);if(a.data.directives&&a.data.directives.some(Io)&&(a.data.show=!0),u&&u.data&&!function(n,e){return e.key===n.key&&e.tag===n.tag}(a,u)&&!be(u)&&(!u.componentInstance||!u.componentInstance._vnode.isComment)){var d=u.data.transition=_({},s);if("out-in"===r)return this._leaving=!0,ue(d,"afterLeave",(function(){e._leaving=!1,e.$forceUpdate()})),Eo(n,o);if("in-out"===r){if(be(a))return c;var p,m=function(){p()};ue(s,"afterEnter",m),ue(s,"enterCancelled",m),ue(d,"delayLeave",(function(n){p=n}))}}return o}}},zo=_({tag:String,moveClass:String},ko);function _o(n){n.elm._moveCb&&n.elm._moveCb(),n.elm._enterCb&&n.elm._enterCb()}function Co(n){n.data.newPos=n.elm.getBoundingClientRect()}function Po(n){var e=n.data.pos,t=n.data.newPos,r=e.left-t.left,o=e.top-t.top;if(r||o){n.data.moved=!0;var a=n.elm.style;a.transform=a.WebkitTransform="translate("+r+"px,"+o+"px)",a.transitionDuration="0s"}}delete zo.mode;var Oo={Transition:To,TransitionGroup:{props:zo,beforeMount:function(){var n=this,e=this._update;this._update=function(t,r){var o=Qe(n);n.__patch__(n._vnode,n.kept,!1,!0),n._vnode=n.kept,o(),e.call(n,t,r)}},render:function(n){for(var e=this.tag||this.$vnode.data.tag||"span",t=Object.create(null),r=this.prevChildren=this.children,o=this.$slots.default||[],a=this.children=[],i=jo(this),s=0;s<o.length;s++){var l=o[s];if(l.tag)if(null!=l.key&&0!==String(l.key).indexOf("__vlist"))a.push(l),t[l.key]=l,(l.data||(l.data={})).transition=i;else;}if(r){for(var c=[],u=[],d=0;d<r.length;d++){var p=r[d];p.data.transition=i,p.data.pos=p.elm.getBoundingClientRect(),t[p.key]?c.push(p):u.push(p)}this.kept=n(e,null,c),this.removed=u}return n(e,null,a)},updated:function(){var n=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";n.length&&this.hasMove(n[0].elm,e)&&(n.forEach(_o),n.forEach(Co),n.forEach(Po),this._reflow=document.body.offsetHeight,n.forEach((function(n){if(n.data.moved){var t=n.elm,r=t.style;Xr(t,e),r.transform=r.WebkitTransform=r.transitionDuration="",t.addEventListener(Wr,t._moveCb=function n(r){r&&r.target!==t||r&&!/transform$/.test(r.propertyName)||(t.removeEventListener(Wr,n),t._moveCb=null,Qr(t,e))})}})))},methods:{hasMove:function(n,e){if(!Hr)return!1;if(this._hasMove)return this._hasMove;var t=n.cloneNode();n._transitionClasses&&n._transitionClasses.forEach((function(n){$r(t,n)})),qr(t,e),t.style.display="none",this.$el.appendChild(t);var r=to(t);return this.$el.removeChild(t),this._hasMove=r.hasTransform}}}};Et.config.mustUseProp=function(n,e,t){return"value"===t&&Mt(n)&&"button"!==e||"selected"===t&&"option"===n||"checked"===t&&"input"===n||"muted"===t&&"video"===n},Et.config.isReservedTag=Kt,Et.config.isReservedAttr=Ot,Et.config.getTagNamespace=function(n){return Vt(n)?"svg":"math"===n?"math":void 0},Et.config.isUnknownElement=function(n){if(!J)return!0;if(Kt(n))return!1;if(n=n.toLowerCase(),null!=Zt[n])return Zt[n];var e=document.createElement(n);return n.indexOf("-")>-1?Zt[n]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:Zt[n]=/HTMLUnknownElement/.test(e.toString())},_(Et.options.directives,wo),_(Et.options.components,Oo),Et.prototype.__patch__=J?uo:P,Et.prototype.$mount=function(n,e){return function(n,e,t){var r;return n.$el=e,n.$options.render||(n.$options.render=yn),tt(n,"beforeMount"),r=function(){n._update(n._render(),t)},new ft(n,r,P,{before:function(){n._isMounted&&!n._isDestroyed&&tt(n,"beforeUpdate")}},!0),t=!1,null==n.$vnode&&(n._isMounted=!0,tt(n,"mounted")),n}(this,n=n&&J?function(n){if("string"==typeof n){var e=document.querySelector(n);return e||document.createElement("div")}return n}(n):void 0,e)},J&&setTimeout((function(){F.devtools&&an&&an.emit("init",Et)}),0);var Mo=Et;
/*!
  * vue-router v3.5.3
  * (c) 2021 Evan You
  * @license MIT
  */function Do(n,e){for(var t in e)n[t]=e[t];return n}var Ro=/[!'()*]/g,Bo=function(n){return"%"+n.charCodeAt(0).toString(16)},Lo=/%2C/g,No=function(n){return encodeURIComponent(n).replace(Ro,Bo).replace(Lo,",")};function Fo(n){try{return decodeURIComponent(n)}catch(n){0}return n}var qo=function(n){return null==n||"object"==typeof n?n:String(n)};function $o(n){var e={};return(n=n.trim().replace(/^(\?|#|&)/,""))?(n.split("&").forEach((function(n){var t=n.replace(/\+/g," ").split("="),r=Fo(t.shift()),o=t.length>0?Fo(t.join("=")):null;void 0===e[r]?e[r]=o:Array.isArray(e[r])?e[r].push(o):e[r]=[e[r],o]})),e):e}function Go(n){var e=n?Object.keys(n).map((function(e){var t=n[e];if(void 0===t)return"";if(null===t)return No(e);if(Array.isArray(t)){var r=[];return t.forEach((function(n){void 0!==n&&(null===n?r.push(No(e)):r.push(No(e)+"="+No(n)))})),r.join("&")}return No(e)+"="+No(t)})).filter((function(n){return n.length>0})).join("&"):null;return e?"?"+e:""}var Uo=/\/?$/;function Ho(n,e,t,r){var o=r&&r.options.stringifyQuery,a=e.query||{};try{a=Jo(a)}catch(n){}var i={name:e.name||n&&n.name,meta:n&&n.meta||{},path:e.path||"/",hash:e.hash||"",query:a,params:e.params||{},fullPath:Ko(e,o),matched:n?Vo(n):[]};return t&&(i.redirectedFrom=Ko(t,o)),Object.freeze(i)}function Jo(n){if(Array.isArray(n))return n.map(Jo);if(n&&"object"==typeof n){var e={};for(var t in n)e[t]=Jo(n[t]);return e}return n}var Wo=Ho(null,{path:"/"});function Vo(n){for(var e=[];n;)e.unshift(n),n=n.parent;return e}function Ko(n,e){var t=n.path,r=n.query;void 0===r&&(r={});var o=n.hash;return void 0===o&&(o=""),(t||"/")+(e||Go)(r)+o}function Zo(n,e,t){return e===Wo?n===e:!!e&&(n.path&&e.path?n.path.replace(Uo,"")===e.path.replace(Uo,"")&&(t||n.hash===e.hash&&Yo(n.query,e.query)):!(!n.name||!e.name)&&(n.name===e.name&&(t||n.hash===e.hash&&Yo(n.query,e.query)&&Yo(n.params,e.params))))}function Yo(n,e){if(void 0===n&&(n={}),void 0===e&&(e={}),!n||!e)return n===e;var t=Object.keys(n).sort(),r=Object.keys(e).sort();return t.length===r.length&&t.every((function(t,o){var a=n[t];if(r[o]!==t)return!1;var i=e[t];return null==a||null==i?a===i:"object"==typeof a&&"object"==typeof i?Yo(a,i):String(a)===String(i)}))}function Xo(n){for(var e=0;e<n.matched.length;e++){var t=n.matched[e];for(var r in t.instances){var o=t.instances[r],a=t.enteredCbs[r];if(o&&a){delete t.enteredCbs[r];for(var i=0;i<a.length;i++)o._isBeingDestroyed||a[i](o)}}}}var Qo={name:"RouterView",functional:!0,props:{name:{type:String,default:"default"}},render:function(n,e){var t=e.props,r=e.children,o=e.parent,a=e.data;a.routerView=!0;for(var i=o.$createElement,s=t.name,l=o.$route,c=o._routerViewCache||(o._routerViewCache={}),u=0,d=!1;o&&o._routerRoot!==o;){var p=o.$vnode?o.$vnode.data:{};p.routerView&&u++,p.keepAlive&&o._directInactive&&o._inactive&&(d=!0),o=o.$parent}if(a.routerViewDepth=u,d){var m=c[s],f=m&&m.component;return f?(m.configProps&&na(f,a,m.route,m.configProps),i(f,a,r)):i()}var h=l.matched[u],g=h&&h.components[s];if(!h||!g)return c[s]=null,i();c[s]={component:g},a.registerRouteInstance=function(n,e){var t=h.instances[s];(e&&t!==n||!e&&t===n)&&(h.instances[s]=e)},(a.hook||(a.hook={})).prepatch=function(n,e){h.instances[s]=e.componentInstance},a.hook.init=function(n){n.data.keepAlive&&n.componentInstance&&n.componentInstance!==h.instances[s]&&(h.instances[s]=n.componentInstance),Xo(l)};var b=h.props&&h.props[s];return b&&(Do(c[s],{route:l,configProps:b}),na(g,a,l,b)),i(g,a,r)}};function na(n,e,t,r){var o=e.props=function(n,e){switch(typeof e){case"undefined":return;case"object":return e;case"function":return e(n);case"boolean":return e?n.params:void 0;default:0}}(t,r);if(o){o=e.props=Do({},o);var a=e.attrs=e.attrs||{};for(var i in o)n.props&&i in n.props||(a[i]=o[i],delete o[i])}}function ea(n,e,t){var r=n.charAt(0);if("/"===r)return n;if("?"===r||"#"===r)return e+n;var o=e.split("/");t&&o[o.length-1]||o.pop();for(var a=n.replace(/^\//,"").split("/"),i=0;i<a.length;i++){var s=a[i];".."===s?o.pop():"."!==s&&o.push(s)}return""!==o[0]&&o.unshift(""),o.join("/")}function ta(n){return n.replace(/\/+/g,"/")}var ra=Array.isArray||function(n){return"[object Array]"==Object.prototype.toString.call(n)},oa=ya,aa=ua,ia=function(n,e){return pa(ua(n,e),e)},sa=pa,la=ba,ca=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function ua(n,e){for(var t,r=[],o=0,a=0,i="",s=e&&e.delimiter||"/";null!=(t=ca.exec(n));){var l=t[0],c=t[1],u=t.index;if(i+=n.slice(a,u),a=u+l.length,c)i+=c[1];else{var d=n[a],p=t[2],m=t[3],f=t[4],h=t[5],g=t[6],b=t[7];i&&(r.push(i),i="");var y=null!=p&&null!=d&&d!==p,v="+"===g||"*"===g,x="?"===g||"*"===g,w=t[2]||s,k=f||h;r.push({name:m||o++,prefix:p||"",delimiter:w,optional:x,repeat:v,partial:y,asterisk:!!b,pattern:k?fa(k):b?".*":"[^"+ma(w)+"]+?"})}}return a<n.length&&(i+=n.substr(a)),i&&r.push(i),r}function da(n){return encodeURI(n).replace(/[\/?#]/g,(function(n){return"%"+n.charCodeAt(0).toString(16).toUpperCase()}))}function pa(n,e){for(var t=new Array(n.length),r=0;r<n.length;r++)"object"==typeof n[r]&&(t[r]=new RegExp("^(?:"+n[r].pattern+")$",ga(e)));return function(e,r){for(var o="",a=e||{},i=(r||{}).pretty?da:encodeURIComponent,s=0;s<n.length;s++){var l=n[s];if("string"!=typeof l){var c,u=a[l.name];if(null==u){if(l.optional){l.partial&&(o+=l.prefix);continue}throw new TypeError('Expected "'+l.name+'" to be defined')}if(ra(u)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but received `'+JSON.stringify(u)+"`");if(0===u.length){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var d=0;d<u.length;d++){if(c=i(u[d]),!t[s].test(c))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'", but received `'+JSON.stringify(c)+"`");o+=(0===d?l.prefix:l.delimiter)+c}}else{if(c=l.asterisk?encodeURI(u).replace(/[?#]/g,(function(n){return"%"+n.charCodeAt(0).toString(16).toUpperCase()})):i(u),!t[s].test(c))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but received "'+c+'"');o+=l.prefix+c}}else o+=l}return o}}function ma(n){return n.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function fa(n){return n.replace(/([=!:$\/()])/g,"\\$1")}function ha(n,e){return n.keys=e,n}function ga(n){return n&&n.sensitive?"":"i"}function ba(n,e,t){ra(e)||(t=e||t,e=[]);for(var r=(t=t||{}).strict,o=!1!==t.end,a="",i=0;i<n.length;i++){var s=n[i];if("string"==typeof s)a+=ma(s);else{var l=ma(s.prefix),c="(?:"+s.pattern+")";e.push(s),s.repeat&&(c+="(?:"+l+c+")*"),a+=c=s.optional?s.partial?l+"("+c+")?":"(?:"+l+"("+c+"))?":l+"("+c+")"}}var u=ma(t.delimiter||"/"),d=a.slice(-u.length)===u;return r||(a=(d?a.slice(0,-u.length):a)+"(?:"+u+"(?=$))?"),a+=o?"$":r&&d?"":"(?="+u+"|$)",ha(new RegExp("^"+a,ga(t)),e)}function ya(n,e,t){return ra(e)||(t=e||t,e=[]),t=t||{},n instanceof RegExp?function(n,e){var t=n.source.match(/\((?!\?)/g);if(t)for(var r=0;r<t.length;r++)e.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return ha(n,e)}(n,e):ra(n)?function(n,e,t){for(var r=[],o=0;o<n.length;o++)r.push(ya(n[o],e,t).source);return ha(new RegExp("(?:"+r.join("|")+")",ga(t)),e)}(n,e,t):function(n,e,t){return ba(ua(n,t),e,t)}(n,e,t)}oa.parse=aa,oa.compile=ia,oa.tokensToFunction=sa,oa.tokensToRegExp=la;var va=Object.create(null);function xa(n,e,t){e=e||{};try{var r=va[n]||(va[n]=oa.compile(n));return"string"==typeof e.pathMatch&&(e[0]=e.pathMatch),r(e,{pretty:!0})}catch(n){return""}finally{delete e[0]}}function wa(n,e,t,r){var o="string"==typeof n?{path:n}:n;if(o._normalized)return o;if(o.name){var a=(o=Do({},n)).params;return a&&"object"==typeof a&&(o.params=Do({},a)),o}if(!o.path&&o.params&&e){(o=Do({},o))._normalized=!0;var i=Do(Do({},e.params),o.params);if(e.name)o.name=e.name,o.params=i;else if(e.matched.length){var s=e.matched[e.matched.length-1].path;o.path=xa(s,i,e.path)}else 0;return o}var l=function(n){var e="",t="",r=n.indexOf("#");r>=0&&(e=n.slice(r),n=n.slice(0,r));var o=n.indexOf("?");return o>=0&&(t=n.slice(o+1),n=n.slice(0,o)),{path:n,query:t,hash:e}}(o.path||""),c=e&&e.path||"/",u=l.path?ea(l.path,c,t||o.append):c,d=function(n,e,t){void 0===e&&(e={});var r,o=t||$o;try{r=o(n||"")}catch(n){r={}}for(var a in e){var i=e[a];r[a]=Array.isArray(i)?i.map(qo):qo(i)}return r}(l.query,o.query,r&&r.options.parseQuery),p=o.hash||l.hash;return p&&"#"!==p.charAt(0)&&(p="#"+p),{_normalized:!0,path:u,query:d,hash:p}}var ka,Sa=function(){},ja={name:"RouterLink",props:{to:{type:[String,Object],required:!0},tag:{type:String,default:"a"},custom:Boolean,exact:Boolean,exactPath:Boolean,append:Boolean,replace:Boolean,activeClass:String,exactActiveClass:String,ariaCurrentValue:{type:String,default:"page"},event:{type:[String,Array],default:"click"}},render:function(n){var e=this,t=this.$router,r=this.$route,o=t.resolve(this.to,r,this.append),a=o.location,i=o.route,s=o.href,l={},c=t.options.linkActiveClass,u=t.options.linkExactActiveClass,d=null==c?"router-link-active":c,p=null==u?"router-link-exact-active":u,m=null==this.activeClass?d:this.activeClass,f=null==this.exactActiveClass?p:this.exactActiveClass,h=i.redirectedFrom?Ho(null,wa(i.redirectedFrom),null,t):i;l[f]=Zo(r,h,this.exactPath),l[m]=this.exact||this.exactPath?l[f]:function(n,e){return 0===n.path.replace(Uo,"/").indexOf(e.path.replace(Uo,"/"))&&(!e.hash||n.hash===e.hash)&&function(n,e){for(var t in e)if(!(t in n))return!1;return!0}(n.query,e.query)}(r,h);var g=l[f]?this.ariaCurrentValue:null,b=function(n){Ea(n)&&(e.replace?t.replace(a,Sa):t.push(a,Sa))},y={click:Ea};Array.isArray(this.event)?this.event.forEach((function(n){y[n]=b})):y[this.event]=b;var v={class:l},x=!this.$scopedSlots.$hasNormal&&this.$scopedSlots.default&&this.$scopedSlots.default({href:s,route:i,navigate:b,isActive:l[m],isExactActive:l[f]});if(x){if(1===x.length)return x[0];if(x.length>1||!x.length)return 0===x.length?n():n("span",{},x)}if("a"===this.tag)v.on=y,v.attrs={href:s,"aria-current":g};else{var w=function n(e){var t;if(e)for(var r=0;r<e.length;r++){if("a"===(t=e[r]).tag)return t;if(t.children&&(t=n(t.children)))return t}}(this.$slots.default);if(w){w.isStatic=!1;var k=w.data=Do({},w.data);for(var S in k.on=k.on||{},k.on){var j=k.on[S];S in y&&(k.on[S]=Array.isArray(j)?j:[j])}for(var E in y)E in k.on?k.on[E].push(y[E]):k.on[E]=b;var A=w.data.attrs=Do({},w.data.attrs);A.href=s,A["aria-current"]=g}else v.on=y}return n(this.tag,v,this.$slots.default)}};function Ea(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey||n.defaultPrevented||void 0!==n.button&&0!==n.button)){if(n.currentTarget&&n.currentTarget.getAttribute){var e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}var Aa="undefined"!=typeof window;function Ia(n,e,t,r,o){var a=e||[],i=t||Object.create(null),s=r||Object.create(null);n.forEach((function(n){!function n(e,t,r,o,a,i){var s=o.path,l=o.name;0;var c=o.pathToRegexpOptions||{},u=function(n,e,t){t||(n=n.replace(/\/$/,""));if("/"===n[0])return n;if(null==e)return n;return ta(e.path+"/"+n)}(s,a,c.strict);"boolean"==typeof o.caseSensitive&&(c.sensitive=o.caseSensitive);var d={path:u,regex:Ta(u,c),components:o.components||{default:o.component},alias:o.alias?"string"==typeof o.alias?[o.alias]:o.alias:[],instances:{},enteredCbs:{},name:l,parent:a,matchAs:i,redirect:o.redirect,beforeEnter:o.beforeEnter,meta:o.meta||{},props:null==o.props?{}:o.components?o.props:{default:o.props}};o.children&&o.children.forEach((function(o){var a=i?ta(i+"/"+o.path):void 0;n(e,t,r,o,d,a)}));t[d.path]||(e.push(d.path),t[d.path]=d);if(void 0!==o.alias)for(var p=Array.isArray(o.alias)?o.alias:[o.alias],m=0;m<p.length;++m){0;var f={path:p[m],children:o.children};n(e,t,r,f,a,d.path||"/")}l&&(r[l]||(r[l]=d))}(a,i,s,n,o)}));for(var l=0,c=a.length;l<c;l++)"*"===a[l]&&(a.push(a.splice(l,1)[0]),c--,l--);return{pathList:a,pathMap:i,nameMap:s}}function Ta(n,e){return oa(n,[],e)}function za(n,e){var t=Ia(n),r=t.pathList,o=t.pathMap,a=t.nameMap;function i(n,t,i){var s=wa(n,t,!1,e),c=s.name;if(c){var u=a[c];if(!u)return l(null,s);var d=u.regex.keys.filter((function(n){return!n.optional})).map((function(n){return n.name}));if("object"!=typeof s.params&&(s.params={}),t&&"object"==typeof t.params)for(var p in t.params)!(p in s.params)&&d.indexOf(p)>-1&&(s.params[p]=t.params[p]);return s.path=xa(u.path,s.params),l(u,s,i)}if(s.path){s.params={};for(var m=0;m<r.length;m++){var f=r[m],h=o[f];if(_a(h.regex,s.path,s.params))return l(h,s,i)}}return l(null,s)}function s(n,t){var r=n.redirect,o="function"==typeof r?r(Ho(n,t,null,e)):r;if("string"==typeof o&&(o={path:o}),!o||"object"!=typeof o)return l(null,t);var s=o,c=s.name,u=s.path,d=t.query,p=t.hash,m=t.params;if(d=s.hasOwnProperty("query")?s.query:d,p=s.hasOwnProperty("hash")?s.hash:p,m=s.hasOwnProperty("params")?s.params:m,c){a[c];return i({_normalized:!0,name:c,query:d,hash:p,params:m},void 0,t)}if(u){var f=function(n,e){return ea(n,e.parent?e.parent.path:"/",!0)}(u,n);return i({_normalized:!0,path:xa(f,m),query:d,hash:p},void 0,t)}return l(null,t)}function l(n,t,r){return n&&n.redirect?s(n,r||t):n&&n.matchAs?function(n,e,t){var r=i({_normalized:!0,path:xa(t,e.params)});if(r){var o=r.matched,a=o[o.length-1];return e.params=r.params,l(a,e)}return l(null,e)}(0,t,n.matchAs):Ho(n,t,r,e)}return{match:i,addRoute:function(n,e){var t="object"!=typeof n?a[n]:void 0;Ia([e||n],r,o,a,t),t&&t.alias.length&&Ia(t.alias.map((function(n){return{path:n,children:[e]}})),r,o,a,t)},getRoutes:function(){return r.map((function(n){return o[n]}))},addRoutes:function(n){Ia(n,r,o,a)}}}function _a(n,e,t){var r=e.match(n);if(!r)return!1;if(!t)return!0;for(var o=1,a=r.length;o<a;++o){var i=n.keys[o-1];i&&(t[i.name||"pathMatch"]="string"==typeof r[o]?Fo(r[o]):r[o])}return!0}var Ca=Aa&&window.performance&&window.performance.now?window.performance:Date;function Pa(){return Ca.now().toFixed(3)}var Oa=Pa();function Ma(){return Oa}function Da(n){return Oa=n}var Ra=Object.create(null);function Ba(){"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual");var n=window.location.protocol+"//"+window.location.host,e=window.location.href.replace(n,""),t=Do({},window.history.state);return t.key=Ma(),window.history.replaceState(t,"",e),window.addEventListener("popstate",Fa),function(){window.removeEventListener("popstate",Fa)}}function La(n,e,t,r){if(n.app){var o=n.options.scrollBehavior;o&&n.app.$nextTick((function(){var a=function(){var n=Ma();if(n)return Ra[n]}(),i=o.call(n,e,t,r?a:null);i&&("function"==typeof i.then?i.then((function(n){Ha(n,a)})).catch((function(n){0})):Ha(i,a))}))}}function Na(){var n=Ma();n&&(Ra[n]={x:window.pageXOffset,y:window.pageYOffset})}function Fa(n){Na(),n.state&&n.state.key&&Da(n.state.key)}function qa(n){return Ga(n.x)||Ga(n.y)}function $a(n){return{x:Ga(n.x)?n.x:window.pageXOffset,y:Ga(n.y)?n.y:window.pageYOffset}}function Ga(n){return"number"==typeof n}var Ua=/^#\d/;function Ha(n,e){var t,r="object"==typeof n;if(r&&"string"==typeof n.selector){var o=Ua.test(n.selector)?document.getElementById(n.selector.slice(1)):document.querySelector(n.selector);if(o){var a=n.offset&&"object"==typeof n.offset?n.offset:{};e=function(n,e){var t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{x:r.left-t.left-e.x,y:r.top-t.top-e.y}}(o,a={x:Ga((t=a).x)?t.x:0,y:Ga(t.y)?t.y:0})}else qa(n)&&(e=$a(n))}else r&&qa(n)&&(e=$a(n));e&&("scrollBehavior"in document.documentElement.style?window.scrollTo({left:e.x,top:e.y,behavior:n.behavior}):window.scrollTo(e.x,e.y))}var Ja,Wa=Aa&&((-1===(Ja=window.navigator.userAgent).indexOf("Android 2.")&&-1===Ja.indexOf("Android 4.0")||-1===Ja.indexOf("Mobile Safari")||-1!==Ja.indexOf("Chrome")||-1!==Ja.indexOf("Windows Phone"))&&window.history&&"function"==typeof window.history.pushState);function Va(n,e){Na();var t=window.history;try{if(e){var r=Do({},t.state);r.key=Ma(),t.replaceState(r,"",n)}else t.pushState({key:Da(Pa())},"",n)}catch(t){window.location[e?"replace":"assign"](n)}}function Ka(n){Va(n,!0)}function Za(n,e,t){var r=function(o){o>=n.length?t():n[o]?e(n[o],(function(){r(o+1)})):r(o+1)};r(0)}var Ya={redirected:2,aborted:4,cancelled:8,duplicated:16};function Xa(n,e){return ni(n,e,Ya.redirected,'Redirected when going from "'+n.fullPath+'" to "'+function(n){if("string"==typeof n)return n;if("path"in n)return n.path;var e={};return ei.forEach((function(t){t in n&&(e[t]=n[t])})),JSON.stringify(e,null,2)}(e)+'" via a navigation guard.')}function Qa(n,e){return ni(n,e,Ya.cancelled,'Navigation cancelled from "'+n.fullPath+'" to "'+e.fullPath+'" with a new navigation.')}function ni(n,e,t,r){var o=new Error(r);return o._isRouter=!0,o.from=n,o.to=e,o.type=t,o}var ei=["params","query","hash"];function ti(n){return Object.prototype.toString.call(n).indexOf("Error")>-1}function ri(n,e){return ti(n)&&n._isRouter&&(null==e||n.type===e)}function oi(n){return function(e,t,r){var o=!1,a=0,i=null;ai(n,(function(n,e,t,s){if("function"==typeof n&&void 0===n.cid){o=!0,a++;var l,c=li((function(e){var o;((o=e).__esModule||si&&"Module"===o[Symbol.toStringTag])&&(e=e.default),n.resolved="function"==typeof e?e:ka.extend(e),t.components[s]=e,--a<=0&&r()})),u=li((function(n){var e="Failed to resolve async component "+s+": "+n;i||(i=ti(n)?n:new Error(e),r(i))}));try{l=n(c,u)}catch(n){u(n)}if(l)if("function"==typeof l.then)l.then(c,u);else{var d=l.component;d&&"function"==typeof d.then&&d.then(c,u)}}})),o||r()}}function ai(n,e){return ii(n.map((function(n){return Object.keys(n.components).map((function(t){return e(n.components[t],n.instances[t],n,t)}))})))}function ii(n){return Array.prototype.concat.apply([],n)}var si="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;function li(n){var e=!1;return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];if(!e)return e=!0,n.apply(this,t)}}var ci=function(n,e){this.router=n,this.base=function(n){if(!n)if(Aa){var e=document.querySelector("base");n=(n=e&&e.getAttribute("href")||"/").replace(/^https?:\/\/[^\/]+/,"")}else n="/";"/"!==n.charAt(0)&&(n="/"+n);return n.replace(/\/$/,"")}(e),this.current=Wo,this.pending=null,this.ready=!1,this.readyCbs=[],this.readyErrorCbs=[],this.errorCbs=[],this.listeners=[]};function ui(n,e,t,r){var o=ai(n,(function(n,r,o,a){var i=function(n,e){"function"!=typeof n&&(n=ka.extend(n));return n.options[e]}(n,e);if(i)return Array.isArray(i)?i.map((function(n){return t(n,r,o,a)})):t(i,r,o,a)}));return ii(r?o.reverse():o)}function di(n,e){if(e)return function(){return n.apply(e,arguments)}}ci.prototype.listen=function(n){this.cb=n},ci.prototype.onReady=function(n,e){this.ready?n():(this.readyCbs.push(n),e&&this.readyErrorCbs.push(e))},ci.prototype.onError=function(n){this.errorCbs.push(n)},ci.prototype.transitionTo=function(n,e,t){var r,o=this;try{r=this.router.match(n,this.current)}catch(n){throw this.errorCbs.forEach((function(e){e(n)})),n}var a=this.current;this.confirmTransition(r,(function(){o.updateRoute(r),e&&e(r),o.ensureURL(),o.router.afterHooks.forEach((function(n){n&&n(r,a)})),o.ready||(o.ready=!0,o.readyCbs.forEach((function(n){n(r)})))}),(function(n){t&&t(n),n&&!o.ready&&(ri(n,Ya.redirected)&&a===Wo||(o.ready=!0,o.readyErrorCbs.forEach((function(e){e(n)}))))}))},ci.prototype.confirmTransition=function(n,e,t){var r=this,o=this.current;this.pending=n;var a,i,s=function(n){!ri(n)&&ti(n)&&(r.errorCbs.length?r.errorCbs.forEach((function(e){e(n)})):console.error(n)),t&&t(n)},l=n.matched.length-1,c=o.matched.length-1;if(Zo(n,o)&&l===c&&n.matched[l]===o.matched[c])return this.ensureURL(),n.hash&&La(this.router,o,n,!1),s(((i=ni(a=o,n,Ya.duplicated,'Avoided redundant navigation to current location: "'+a.fullPath+'".')).name="NavigationDuplicated",i));var u=function(n,e){var t,r=Math.max(n.length,e.length);for(t=0;t<r&&n[t]===e[t];t++);return{updated:e.slice(0,t),activated:e.slice(t),deactivated:n.slice(t)}}(this.current.matched,n.matched),d=u.updated,p=u.deactivated,m=u.activated,f=[].concat(function(n){return ui(n,"beforeRouteLeave",di,!0)}(p),this.router.beforeHooks,function(n){return ui(n,"beforeRouteUpdate",di)}(d),m.map((function(n){return n.beforeEnter})),oi(m)),h=function(e,t){if(r.pending!==n)return s(Qa(o,n));try{e(n,o,(function(e){!1===e?(r.ensureURL(!0),s(function(n,e){return ni(n,e,Ya.aborted,'Navigation aborted from "'+n.fullPath+'" to "'+e.fullPath+'" via a navigation guard.')}(o,n))):ti(e)?(r.ensureURL(!0),s(e)):"string"==typeof e||"object"==typeof e&&("string"==typeof e.path||"string"==typeof e.name)?(s(Xa(o,n)),"object"==typeof e&&e.replace?r.replace(e):r.push(e)):t(e)}))}catch(n){s(n)}};Za(f,h,(function(){Za(function(n){return ui(n,"beforeRouteEnter",(function(n,e,t,r){return function(n,e,t){return function(r,o,a){return n(r,o,(function(n){"function"==typeof n&&(e.enteredCbs[t]||(e.enteredCbs[t]=[]),e.enteredCbs[t].push(n)),a(n)}))}}(n,t,r)}))}(m).concat(r.router.resolveHooks),h,(function(){if(r.pending!==n)return s(Qa(o,n));r.pending=null,e(n),r.router.app&&r.router.app.$nextTick((function(){Xo(n)}))}))}))},ci.prototype.updateRoute=function(n){this.current=n,this.cb&&this.cb(n)},ci.prototype.setupListeners=function(){},ci.prototype.teardown=function(){this.listeners.forEach((function(n){n()})),this.listeners=[],this.current=Wo,this.pending=null};var pi=function(n){function e(e,t){n.call(this,e,t),this._startLocation=mi(this.base)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.setupListeners=function(){var n=this;if(!(this.listeners.length>0)){var e=this.router,t=e.options.scrollBehavior,r=Wa&&t;r&&this.listeners.push(Ba());var o=function(){var t=n.current,o=mi(n.base);n.current===Wo&&o===n._startLocation||n.transitionTo(o,(function(n){r&&La(e,n,t,!0)}))};window.addEventListener("popstate",o),this.listeners.push((function(){window.removeEventListener("popstate",o)}))}},e.prototype.go=function(n){window.history.go(n)},e.prototype.push=function(n,e,t){var r=this,o=this.current;this.transitionTo(n,(function(n){Va(ta(r.base+n.fullPath)),La(r.router,n,o,!1),e&&e(n)}),t)},e.prototype.replace=function(n,e,t){var r=this,o=this.current;this.transitionTo(n,(function(n){Ka(ta(r.base+n.fullPath)),La(r.router,n,o,!1),e&&e(n)}),t)},e.prototype.ensureURL=function(n){if(mi(this.base)!==this.current.fullPath){var e=ta(this.base+this.current.fullPath);n?Va(e):Ka(e)}},e.prototype.getCurrentLocation=function(){return mi(this.base)},e}(ci);function mi(n){var e=window.location.pathname,t=e.toLowerCase(),r=n.toLowerCase();return!n||t!==r&&0!==t.indexOf(ta(r+"/"))||(e=e.slice(n.length)),(e||"/")+window.location.search+window.location.hash}var fi=function(n){function e(e,t,r){n.call(this,e,t),r&&function(n){var e=mi(n);if(!/^\/#/.test(e))return window.location.replace(ta(n+"/#"+e)),!0}(this.base)||hi()}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.setupListeners=function(){var n=this;if(!(this.listeners.length>0)){var e=this.router.options.scrollBehavior,t=Wa&&e;t&&this.listeners.push(Ba());var r=function(){var e=n.current;hi()&&n.transitionTo(gi(),(function(r){t&&La(n.router,r,e,!0),Wa||vi(r.fullPath)}))},o=Wa?"popstate":"hashchange";window.addEventListener(o,r),this.listeners.push((function(){window.removeEventListener(o,r)}))}},e.prototype.push=function(n,e,t){var r=this,o=this.current;this.transitionTo(n,(function(n){yi(n.fullPath),La(r.router,n,o,!1),e&&e(n)}),t)},e.prototype.replace=function(n,e,t){var r=this,o=this.current;this.transitionTo(n,(function(n){vi(n.fullPath),La(r.router,n,o,!1),e&&e(n)}),t)},e.prototype.go=function(n){window.history.go(n)},e.prototype.ensureURL=function(n){var e=this.current.fullPath;gi()!==e&&(n?yi(e):vi(e))},e.prototype.getCurrentLocation=function(){return gi()},e}(ci);function hi(){var n=gi();return"/"===n.charAt(0)||(vi("/"+n),!1)}function gi(){var n=window.location.href,e=n.indexOf("#");return e<0?"":n=n.slice(e+1)}function bi(n){var e=window.location.href,t=e.indexOf("#");return(t>=0?e.slice(0,t):e)+"#"+n}function yi(n){Wa?Va(bi(n)):window.location.hash=n}function vi(n){Wa?Ka(bi(n)):window.location.replace(bi(n))}var xi=function(n){function e(e,t){n.call(this,e,t),this.stack=[],this.index=-1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.push=function(n,e,t){var r=this;this.transitionTo(n,(function(n){r.stack=r.stack.slice(0,r.index+1).concat(n),r.index++,e&&e(n)}),t)},e.prototype.replace=function(n,e,t){var r=this;this.transitionTo(n,(function(n){r.stack=r.stack.slice(0,r.index).concat(n),e&&e(n)}),t)},e.prototype.go=function(n){var e=this,t=this.index+n;if(!(t<0||t>=this.stack.length)){var r=this.stack[t];this.confirmTransition(r,(function(){var n=e.current;e.index=t,e.updateRoute(r),e.router.afterHooks.forEach((function(e){e&&e(r,n)}))}),(function(n){ri(n,Ya.duplicated)&&(e.index=t)}))}},e.prototype.getCurrentLocation=function(){var n=this.stack[this.stack.length-1];return n?n.fullPath:"/"},e.prototype.ensureURL=function(){},e}(ci),wi=function(n){void 0===n&&(n={}),this.app=null,this.apps=[],this.options=n,this.beforeHooks=[],this.resolveHooks=[],this.afterHooks=[],this.matcher=za(n.routes||[],this);var e=n.mode||"hash";switch(this.fallback="history"===e&&!Wa&&!1!==n.fallback,this.fallback&&(e="hash"),Aa||(e="abstract"),this.mode=e,e){case"history":this.history=new pi(this,n.base);break;case"hash":this.history=new fi(this,n.base,this.fallback);break;case"abstract":this.history=new xi(this,n.base);break;default:0}},ki={currentRoute:{configurable:!0}};function Si(n,e){return n.push(e),function(){var t=n.indexOf(e);t>-1&&n.splice(t,1)}}wi.prototype.match=function(n,e,t){return this.matcher.match(n,e,t)},ki.currentRoute.get=function(){return this.history&&this.history.current},wi.prototype.init=function(n){var e=this;if(this.apps.push(n),n.$once("hook:destroyed",(function(){var t=e.apps.indexOf(n);t>-1&&e.apps.splice(t,1),e.app===n&&(e.app=e.apps[0]||null),e.app||e.history.teardown()})),!this.app){this.app=n;var t=this.history;if(t instanceof pi||t instanceof fi){var r=function(n){t.setupListeners(),function(n){var r=t.current,o=e.options.scrollBehavior;Wa&&o&&"fullPath"in n&&La(e,n,r,!1)}(n)};t.transitionTo(t.getCurrentLocation(),r,r)}t.listen((function(n){e.apps.forEach((function(e){e._route=n}))}))}},wi.prototype.beforeEach=function(n){return Si(this.beforeHooks,n)},wi.prototype.beforeResolve=function(n){return Si(this.resolveHooks,n)},wi.prototype.afterEach=function(n){return Si(this.afterHooks,n)},wi.prototype.onReady=function(n,e){this.history.onReady(n,e)},wi.prototype.onError=function(n){this.history.onError(n)},wi.prototype.push=function(n,e,t){var r=this;if(!e&&!t&&"undefined"!=typeof Promise)return new Promise((function(e,t){r.history.push(n,e,t)}));this.history.push(n,e,t)},wi.prototype.replace=function(n,e,t){var r=this;if(!e&&!t&&"undefined"!=typeof Promise)return new Promise((function(e,t){r.history.replace(n,e,t)}));this.history.replace(n,e,t)},wi.prototype.go=function(n){this.history.go(n)},wi.prototype.back=function(){this.go(-1)},wi.prototype.forward=function(){this.go(1)},wi.prototype.getMatchedComponents=function(n){var e=n?n.matched?n:this.resolve(n).route:this.currentRoute;return e?[].concat.apply([],e.matched.map((function(n){return Object.keys(n.components).map((function(e){return n.components[e]}))}))):[]},wi.prototype.resolve=function(n,e,t){var r=wa(n,e=e||this.history.current,t,this),o=this.match(r,e),a=o.redirectedFrom||o.fullPath;return{location:r,route:o,href:function(n,e,t){var r="hash"===t?"#"+e:e;return n?ta(n+"/"+r):r}(this.history.base,a,this.mode),normalizedTo:r,resolved:o}},wi.prototype.getRoutes=function(){return this.matcher.getRoutes()},wi.prototype.addRoute=function(n,e){this.matcher.addRoute(n,e),this.history.current!==Wo&&this.history.transitionTo(this.history.getCurrentLocation())},wi.prototype.addRoutes=function(n){this.matcher.addRoutes(n),this.history.current!==Wo&&this.history.transitionTo(this.history.getCurrentLocation())},Object.defineProperties(wi.prototype,ki),wi.install=function n(e){if(!n.installed||ka!==e){n.installed=!0,ka=e;var t=function(n){return void 0!==n},r=function(n,e){var r=n.$options._parentVnode;t(r)&&t(r=r.data)&&t(r=r.registerRouteInstance)&&r(n,e)};e.mixin({beforeCreate:function(){t(this.$options.router)?(this._routerRoot=this,this._router=this.$options.router,this._router.init(this),e.util.defineReactive(this,"_route",this._router.history.current)):this._routerRoot=this.$parent&&this.$parent._routerRoot||this,r(this,this)},destroyed:function(){r(this)}}),Object.defineProperty(e.prototype,"$router",{get:function(){return this._routerRoot._router}}),Object.defineProperty(e.prototype,"$route",{get:function(){return this._routerRoot._route}}),e.component("RouterView",Qo),e.component("RouterLink",ja);var o=e.config.optionMergeStrategies;o.beforeRouteEnter=o.beforeRouteLeave=o.beforeRouteUpdate=o.created}},wi.version="3.5.3",wi.isNavigationFailure=ri,wi.NavigationFailureType=Ya,wi.START_LOCATION=Wo,Aa&&window.Vue&&window.Vue.use(wi);var ji=wi;t(177),t(178),t(255),t(75),t(179),t(28),t(29),t(257);function Ei(n){n.locales&&Object.keys(n.locales).forEach((function(e){n.locales[e].path=e})),Object.freeze(n)}t(70),t(92),t(126);function Ai(n){return(Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}var Ii=t(72),Ti=(t(189),t(17),t(45),t(231),t(232),t(40),t(30),{NotFound:function(){return Promise.all([t.e(0),t.e(4)]).then(t.bind(null,484))},Layout:function(){return Promise.all([t.e(0),t.e(2)]).then(t.bind(null,483))}}),zi={"v-1df4d616":function(){return t.e(6).then(t.bind(null,485))},"v-10284f70":function(){return t.e(7).then(t.bind(null,486))},"v-27875be3":function(){return t.e(9).then(t.bind(null,487))},"v-326b4e84":function(){return t.e(10).then(t.bind(null,488))},"v-223d701a":function(){return t.e(11).then(t.bind(null,489))},"v-7d49cd87":function(){return t.e(12).then(t.bind(null,490))},"v-130f5d29":function(){return t.e(13).then(t.bind(null,491))},"v-17af0f12":function(){return t.e(14).then(t.bind(null,492))},"v-5621ad6f":function(){return t.e(15).then(t.bind(null,493))},"v-120fd95f":function(){return t.e(16).then(t.bind(null,494))},"v-3ef46c3e":function(){return t.e(8).then(t.bind(null,495))},"v-20167b32":function(){return t.e(17).then(t.bind(null,496))},"v-061159fa":function(){return t.e(18).then(t.bind(null,497))},"v-2b0b1b3e":function(){return t.e(19).then(t.bind(null,498))},"v-2b72ba50":function(){return t.e(20).then(t.bind(null,499))},"v-d22b1d0e":function(){return t.e(21).then(t.bind(null,500))},"v-30695d13":function(){return t.e(22).then(t.bind(null,501))},"v-27133cbb":function(){return t.e(23).then(t.bind(null,502))},"v-2203d9c2":function(){return t.e(24).then(t.bind(null,503))},"v-2bdfec00":function(){return t.e(25).then(t.bind(null,504))},"v-f7677c3c":function(){return t.e(26).then(t.bind(null,505))},"v-83400752":function(){return t.e(28).then(t.bind(null,506))},"v-6c08538d":function(){return t.e(27).then(t.bind(null,507))},"v-4c61c5bc":function(){return t.e(29).then(t.bind(null,508))},"v-3f5b59cf":function(){return t.e(30).then(t.bind(null,509))},"v-a5a12a48":function(){return t.e(31).then(t.bind(null,510))},"v-58f14e65":function(){return t.e(33).then(t.bind(null,511))},"v-35bfa9e0":function(){return t.e(34).then(t.bind(null,512))},"v-363cf0bc":function(){return t.e(35).then(t.bind(null,513))},"v-6756bb32":function(){return t.e(36).then(t.bind(null,514))},"v-6e63d81a":function(){return t.e(37).then(t.bind(null,515))},"v-2fe45ff3":function(){return t.e(38).then(t.bind(null,516))},"v-350792bc":function(){return t.e(39).then(t.bind(null,517))},"v-3913f24b":function(){return t.e(40).then(t.bind(null,518))},"v-fa3822fc":function(){return t.e(32).then(t.bind(null,519))},"v-614b0a72":function(){return t.e(41).then(t.bind(null,520))},"v-36fb0f35":function(){return t.e(42).then(t.bind(null,521))},"v-47148396":function(){return t.e(43).then(t.bind(null,522))},"v-38b5a542":function(){return t.e(44).then(t.bind(null,523))},"v-a5b0f788":function(){return t.e(45).then(t.bind(null,524))},"v-5746bea6":function(){return t.e(46).then(t.bind(null,525))},"v-0e65177a":function(){return t.e(47).then(t.bind(null,526))},"v-936eed32":function(){return t.e(48).then(t.bind(null,527))},"v-0944f7ee":function(){return t.e(49).then(t.bind(null,528))},"v-638f70fb":function(){return t.e(50).then(t.bind(null,529))},"v-6d7302f2":function(){return t.e(51).then(t.bind(null,530))},"v-1de1c18a":function(){return t.e(53).then(t.bind(null,531))},"v-f465e8f0":function(){return t.e(54).then(t.bind(null,532))},"v-1a36efce":function(){return t.e(55).then(t.bind(null,533))},"v-1426c78e":function(){return Promise.all([t.e(0),t.e(5)]).then(t.bind(null,534))},"v-8b61ee12":function(){return t.e(56).then(t.bind(null,535))},"v-01eb52f2":function(){return t.e(57).then(t.bind(null,536))},"v-0832524d":function(){return t.e(58).then(t.bind(null,537))},"v-3e241928":function(){return t.e(52).then(t.bind(null,538))},"v-85694126":function(){return t.e(59).then(t.bind(null,539))},"v-7db0be6d":function(){return t.e(61).then(t.bind(null,540))},"v-0033648a":function(){return t.e(60).then(t.bind(null,541))},"v-315c4010":function(){return t.e(62).then(t.bind(null,542))},"v-50864176":function(){return t.e(64).then(t.bind(null,543))},"v-520c0bed":function(){return t.e(63).then(t.bind(null,544))},"v-7284126c":function(){return t.e(66).then(t.bind(null,545))},"v-462b4ed7":function(){return t.e(65).then(t.bind(null,546))},"v-64279124":function(){return t.e(67).then(t.bind(null,547))},"v-10cc5422":function(){return t.e(68).then(t.bind(null,548))},"v-61d376a8":function(){return t.e(69).then(t.bind(null,549))},"v-529de428":function(){return t.e(70).then(t.bind(null,550))},"v-69bafd4e":function(){return t.e(72).then(t.bind(null,551))},"v-485c8077":function(){return t.e(71).then(t.bind(null,552))},"v-25458d2a":function(){return t.e(73).then(t.bind(null,553))},"v-dc7c1222":function(){return t.e(74).then(t.bind(null,554))},"v-69d48d6a":function(){return t.e(75).then(t.bind(null,555))},"v-252683df":function(){return t.e(76).then(t.bind(null,556))},"v-e8a298c2":function(){return t.e(77).then(t.bind(null,557))},"v-dbcc7c0e":function(){return t.e(79).then(t.bind(null,558))},"v-2dd7091f":function(){return t.e(80).then(t.bind(null,559))},"v-67e77451":function(){return t.e(81).then(t.bind(null,560))},"v-18cea7e8":function(){return t.e(82).then(t.bind(null,561))},"v-fdf3da36":function(){return t.e(83).then(t.bind(null,562))},"v-52f3ee7a":function(){return t.e(84).then(t.bind(null,563))},"v-6e96fc20":function(){return t.e(85).then(t.bind(null,564))},"v-3cfa8772":function(){return t.e(86).then(t.bind(null,565))},"v-2a641a1f":function(){return t.e(78).then(t.bind(null,566))},"v-abf399c4":function(){return t.e(87).then(t.bind(null,567))},"v-dc40f1c0":function(){return t.e(88).then(t.bind(null,568))},"v-10ef9d52":function(){return t.e(89).then(t.bind(null,569))},"v-3b86a05e":function(){return t.e(90).then(t.bind(null,570))},"v-5176e105":function(){return t.e(91).then(t.bind(null,571))},"v-75e41c65":function(){return t.e(92).then(t.bind(null,572))},"v-3249c685":function(){return t.e(93).then(t.bind(null,573))},"v-ec84fed2":function(){return t.e(94).then(t.bind(null,574))},"v-2100b3d2":function(){return t.e(95).then(t.bind(null,575))},"v-2b7111c4":function(){return t.e(96).then(t.bind(null,576))},"v-7b48c50c":function(){return t.e(97).then(t.bind(null,577))},"v-399fd293":function(){return t.e(98).then(t.bind(null,578))},"v-346f208f":function(){return t.e(99).then(t.bind(null,579))},"v-4d3a6db4":function(){return t.e(101).then(t.bind(null,580))},"v-05ba6584":function(){return t.e(102).then(t.bind(null,581))},"v-e165eb18":function(){return t.e(103).then(t.bind(null,582))},"v-d6f05d32":function(){return t.e(104).then(t.bind(null,583))},"v-1f0d05a1":function(){return t.e(105).then(t.bind(null,584))},"v-c1496618":function(){return t.e(106).then(t.bind(null,585))},"v-2b833066":function(){return t.e(107).then(t.bind(null,586))},"v-0a300e27":function(){return t.e(100).then(t.bind(null,587))},"v-1f5f8d8a":function(){return t.e(108).then(t.bind(null,588))},"v-2ec63a50":function(){return t.e(109).then(t.bind(null,589))},"v-7055771a":function(){return t.e(110).then(t.bind(null,590))},"v-20b8f620":function(){return t.e(114).then(t.bind(null,591))},"v-1bbe4ea2":function(){return t.e(115).then(t.bind(null,592))},"v-f6e3cecc":function(){return t.e(111).then(t.bind(null,593))},"v-4685ff34":function(){return t.e(116).then(t.bind(null,594))},"v-44d2c0fc":function(){return t.e(118).then(t.bind(null,595))},"v-73e6fcbe":function(){return t.e(117).then(t.bind(null,596))},"v-ad45f6fa":function(){return t.e(119).then(t.bind(null,597))},"v-25827231":function(){return t.e(120).then(t.bind(null,598))},"v-092c0610":function(){return t.e(121).then(t.bind(null,599))},"v-31cb3fe6":function(){return t.e(123).then(t.bind(null,600))},"v-6145bf5a":function(){return t.e(124).then(t.bind(null,601))},"v-733dba34":function(){return t.e(125).then(t.bind(null,602))},"v-3b44ff9b":function(){return t.e(126).then(t.bind(null,603))},"v-4248c6f3":function(){return t.e(122).then(t.bind(null,604))},"v-0bfabf3c":function(){return t.e(127).then(t.bind(null,605))},"v-8b56fb8c":function(){return t.e(128).then(t.bind(null,606))},"v-07dc7dde":function(){return t.e(129).then(t.bind(null,607))},"v-21627c86":function(){return t.e(130).then(t.bind(null,608))},"v-16bacf9d":function(){return t.e(131).then(t.bind(null,609))},"v-720d8224":function(){return t.e(133).then(t.bind(null,610))},"v-52f1734b":function(){return t.e(132).then(t.bind(null,611))},"v-449301a8":function(){return t.e(134).then(t.bind(null,612))},"v-364e812a":function(){return t.e(135).then(t.bind(null,613))},"v-0dd61c07":function(){return t.e(136).then(t.bind(null,614))},"v-59177494":function(){return t.e(138).then(t.bind(null,615))},"v-7c3437ac":function(){return t.e(139).then(t.bind(null,616))},"v-60ad1438":function(){return t.e(140).then(t.bind(null,617))},"v-42d161dc":function(){return t.e(141).then(t.bind(null,618))},"v-92c363a2":function(){return t.e(137).then(t.bind(null,619))},"v-1d730a99":function(){return t.e(142).then(t.bind(null,620))},"v-34d42a50":function(){return t.e(144).then(t.bind(null,621))},"v-546fd54a":function(){return t.e(143).then(t.bind(null,622))},"v-03537083":function(){return t.e(145).then(t.bind(null,623))},"v-51ad7edb":function(){return t.e(112).then(t.bind(null,624))},"v-584aa1ec":function(){return t.e(113).then(t.bind(null,625))}};function _i(n){var e=Object.create(null);return function(t){return e[t]||(e[t]=n(t))}}var Ci=/-(\w)/g,Pi=_i((function(n){return n.replace(Ci,(function(n,e){return e?e.toUpperCase():""}))})),Oi=/\B([A-Z])/g,Mi=_i((function(n){return n.replace(Oi,"-$1").toLowerCase()})),Di=_i((function(n){return n.charAt(0).toUpperCase()+n.slice(1)}));function Ri(n,e){if(e)return n(e)?n(e):e.includes("-")?n(Di(Pi(e))):n(Di(e))||n(Mi(e))}var Bi=Object.assign({},Ti,zi),Li=function(n){return Bi[n]},Ni=function(n){return zi[n]},Fi=function(n){return Ti[n]},qi=function(n){return Mo.component(n)};function $i(n){return Ri(Ni,n)}function Gi(n){return Ri(Fi,n)}function Ui(n){return Ri(Li,n)}function Hi(n){return Ri(qi,n)}function Ji(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return Promise.all(e.filter((function(n){return n})).map(function(){var n=Object(r.a)(regeneratorRuntime.mark((function n(e){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(Hi(e)||!Ui(e)){n.next=5;break}return n.next=3,Ui(e)();case 3:t=n.sent,Mo.component(e,t.default);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()))}function Wi(n,e){"undefined"!=typeof window&&window.__VUEPRESS__&&(window.__VUEPRESS__[n]=e)}var Vi=t(138),Ki=(t(190),t(110),t(53),t(219)),Zi=t.n(Ki),Yi=t(220),Xi=t.n(Yi),Qi={created:function(){if(this.siteMeta=this.$site.headTags.filter((function(n){return"meta"===Object(Vi.a)(n,1)[0]})).map((function(n){var e=Object(Vi.a)(n,2);e[0];return e[1]})),this.$ssrContext){var n=this.getMergedMetaTags();this.$ssrContext.title=this.$title,this.$ssrContext.lang=this.$lang,this.$ssrContext.pageMeta=(e=n)?e.map((function(n){var e="<meta";return Object.keys(n).forEach((function(t){e+=" ".concat(t,'="').concat(Xi()(n[t]),'"')})),e+">"})).join("\n    "):"",this.$ssrContext.canonicalLink=es(this.$canonicalUrl)}var e},mounted:function(){this.currentMetaTags=Object(Ii.a)(document.querySelectorAll("meta")),this.updateMeta(),this.updateCanonicalLink()},methods:{updateMeta:function(){document.title=this.$title,document.documentElement.lang=this.$lang;var n=this.getMergedMetaTags();this.currentMetaTags=ts(n,this.currentMetaTags)},getMergedMetaTags:function(){var n=this.$page.frontmatter.meta||[];return Zi()([{name:"description",content:this.$description}],n,this.siteMeta,rs)},updateCanonicalLink:function(){ns(),this.$canonicalUrl&&document.head.insertAdjacentHTML("beforeend",es(this.$canonicalUrl))}},watch:{$page:function(){this.updateMeta(),this.updateCanonicalLink()}},beforeDestroy:function(){ts(null,this.currentMetaTags),ns()}};function ns(){var n=document.querySelector("link[rel='canonical']");n&&n.remove()}function es(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return n?'<link href="'.concat(n,'" rel="canonical" />'):""}function ts(n,e){if(e&&Object(Ii.a)(e).filter((function(n){return n.parentNode===document.head})).forEach((function(n){return document.head.removeChild(n)})),n)return n.map((function(n){var e=document.createElement("meta");return Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])})),document.head.appendChild(e),e}))}function rs(n){for(var e=0,t=["name","property","itemprop"];e<t.length;e++){var r=t[e];if(n.hasOwnProperty(r))return n[r]+r}return JSON.stringify(n)}t(139);var os=t(152),as={mounted:function(){window.addEventListener("scroll",this.onScroll)},methods:{onScroll:t.n(os)()((function(){this.setActiveHash()}),300),setActiveHash:function(){for(var n=this,e=[].slice.call(document.querySelectorAll(".sidebar-link")),t=[].slice.call(document.querySelectorAll(".header-anchor")).filter((function(n){return e.some((function(e){return e.hash===n.hash}))})),r=Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop),o=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),a=window.innerHeight+r,i=0;i<t.length;i++){var s=t[i],l=t[i+1],c=0===i&&0===r||r>=s.parentElement.offsetTop+10&&(!l||r<l.parentElement.offsetTop-10),u=decodeURIComponent(this.$route.hash);if(c&&u!==decodeURIComponent(s.hash)){var d=s;if(a===o)for(var p=i+1;p<t.length;p++)if(u===decodeURIComponent(t[p].hash))return;return this.$vuepress.$set("disableScrollBehavior",!0),void this.$router.replace(decodeURIComponent(d.hash),(function(){n.$nextTick((function(){n.$vuepress.$set("disableScrollBehavior",!1)}))}))}}}},beforeDestroy:function(){window.removeEventListener("scroll",this.onScroll)}},is=(t(78),t(101)),ss=t.n(is),ls={mounted:function(){var n=this;ss.a.configure({showSpinner:!1}),this.$router.beforeEach((function(n,e,t){n.path===e.path||Mo.component(n.name)||ss.a.start(),t()})),this.$router.afterEach((function(){ss.a.done(),n.isSidebarOpen=!1}))}};t(74),t(54),t(77),t(364);function cs(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}t(99);function us(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function ds(n,e,t){return e&&us(n.prototype,e),t&&us(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}t(365);var ps=function(){function n(){cs(this,n);this.containerEl=document.getElementById("message-container"),this.containerEl||(this.containerEl=document.createElement("div"),this.containerEl.id="message-container",document.body.appendChild(this.containerEl))}return ds(n,[{key:"show",value:function(n){var e=this,t=n.text,r=void 0===t?"":t,o=n.duration,a=void 0===o?3e3:o,i=document.createElement("div");i.className="message move-in",i.innerHTML='\n      <i style="fill: #06a35a;font-size: 14px;display:inline-flex;align-items: center;">\n        <svg style="fill: #06a35a;font-size: 14px;" t="1572421810237" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2323" width="16" height="16"><path d="M822.811993 824.617989c-83.075838 81.99224-188.546032 124.613757-316.049383 127.86455-122.085362-3.250794-223.943563-45.87231-305.935802-127.86455s-124.613757-184.21164-127.86455-305.935802c3.250794-127.503351 45.87231-232.973545 127.86455-316.049383 81.99224-83.075838 184.21164-126.058554 305.935802-129.309347 127.503351 3.250794 232.973545 46.23351 316.049383 129.309347 83.075838 83.075838 126.058554 188.546032 129.309347 316.049383C949.231746 640.406349 905.887831 742.62575 822.811993 824.617989zM432.716755 684.111464c3.973192 3.973192 8.307584 5.779189 13.364374 6.140388 5.05679 0.361199 9.752381-1.444797 13.364374-5.417989l292.571429-287.514638c3.973192-3.973192 5.779189-8.307584 5.779189-13.364374 0-5.05679-1.805996-9.752381-5.779189-13.364374l1.805996 1.805996c-3.973192-3.973192-8.668783-5.779189-14.086772-6.140388-5.417989-0.361199-10.47478 1.444797-14.809171 5.417989l-264.397884 220.33157c-3.973192 3.250794-8.668783 4.695591-14.447972 4.695591-5.779189 0-10.835979-1.444797-15.53157-3.973192l-94.273016-72.962257c-4.334392-3.250794-9.391182-4.334392-14.447972-3.973192s-9.391182 3.250794-12.641975 7.585185l-2.889594 3.973192c-3.250794 4.334392-4.334392 9.391182-3.973192 14.809171 0.722399 5.417989 2.528395 10.11358 5.779189 14.086772L432.716755 684.111464z" p-id="2324"></path></svg>\n      </i>\n      <div class="text">'.concat(r,"</div>\n    "),this.containerEl.appendChild(i),a>0&&setTimeout((function(){e.close(i)}),a)}},{key:"close",value:function(n){n.className=n.className.replace("move-in",""),n.className+="move-out",n.addEventListener("animationend",(function(){n.remove()}))}}]),n}(),ms={mounted:function(){!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||this.updateCopy()},updated:function(){!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||this.updateCopy()},methods:{updateCopy:function(){var n=this;setTimeout((function(){(['div[class*="language-"] pre','div[class*="aside-code"] aside']instanceof Array||Array.isArray(['div[class*="language-"] pre','div[class*="aside-code"] aside']))&&['div[class*="language-"] pre','div[class*="aside-code"] aside'].forEach((function(e){document.querySelectorAll(e).forEach(n.generateCopyButton)}))}),1e3)},generateCopyButton:function(n){var e=this;if(!n.classList.contains("codecopy-enabled")){var t=document.createElement("i");t.className="code-copy",t.innerHTML='<svg  style="color:#aaa;font-size:14px" t="1572422231464" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3201" width="14" height="14"><path d="M866.461538 39.384615H354.461538c-43.323077 0-78.769231 35.446154-78.76923 78.769231v39.384616h472.615384c43.323077 0 78.769231 35.446154 78.769231 78.76923v551.384616h39.384615c43.323077 0 78.769231-35.446154 78.769231-78.769231V118.153846c0-43.323077-35.446154-78.769231-78.769231-78.769231z m-118.153846 275.692308c0-43.323077-35.446154-78.769231-78.76923-78.769231H157.538462c-43.323077 0-78.769231 35.446154-78.769231 78.769231v590.769231c0 43.323077 35.446154 78.769231 78.769231 78.769231h512c43.323077 0 78.769231-35.446154 78.76923-78.769231V315.076923z m-354.461538 137.846154c0 11.815385-7.876923 19.692308-19.692308 19.692308h-157.538461c-11.815385 0-19.692308-7.876923-19.692308-19.692308v-39.384615c0-11.815385 7.876923-19.692308 19.692308-19.692308h157.538461c11.815385 0 19.692308 7.876923 19.692308 19.692308v39.384615z m157.538461 315.076923c0 11.815385-7.876923 19.692308-19.692307 19.692308H216.615385c-11.815385 0-19.692308-7.876923-19.692308-19.692308v-39.384615c0-11.815385 7.876923-19.692308 19.692308-19.692308h315.076923c11.815385 0 19.692308 7.876923 19.692307 19.692308v39.384615z m78.769231-157.538462c0 11.815385-7.876923 19.692308-19.692308 19.692308H216.615385c-11.815385 0-19.692308-7.876923-19.692308-19.692308v-39.384615c0-11.815385 7.876923-19.692308 19.692308-19.692308h393.846153c11.815385 0 19.692308 7.876923 19.692308 19.692308v39.384615z" p-id="3202"></path></svg>',t.title="Copy to clipboard",t.addEventListener("click",(function(){e.copyToClipboard(n.innerText)})),n.appendChild(t),n.classList.add("codecopy-enabled")}},copyToClipboard:function(n){var e=document.createElement("textarea");e.value=n,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e);var t=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);e.select(),document.execCommand("copy"),(new ps).show({text:"å¤å¶æå",duration:1e3}),document.body.removeChild(e),t&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(t))}}};t(234),t(104),t(103),t(140),t(367);!function(n,e){void 0===e&&(e={});var t=e.insertAt;if(n&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===t&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=n:o.appendChild(document.createTextNode(n))}}("@media (max-width: 1000px) {\n  .vuepress-plugin-demo-block__h_code {\n    display: none;\n  }\n  .vuepress-plugin-demo-block__app {\n    margin-left: auto !important;\n    margin-right: auto !important;\n  }\n}\n.vuepress-plugin-demo-block__wrapper {\n  margin-top: 10px;\n  border: 1px solid #ebebeb;\n  border-radius: 4px;\n  transition: all 0.2s;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display {\n  height: 400px;\n  display: flex;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display .vuepress-plugin-demo-block__app {\n  width: 300px;\n  border: 1px solid #ebebeb;\n  box-shadow: 1px 1px 3px #ebebeb;\n  margin-right: 5px;\n  overflow: auto;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display .vuepress-plugin-demo-block__h_code {\n  flex: 1;\n  overflow: auto;\n  height: 100%;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display .vuepress-plugin-demo-block__h_code > pre {\n  overflow: visible;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__display {\n  max-height: 400px;\n  overflow: auto;\n}\n.vuepress-plugin-demo-block__wrapper div {\n  box-sizing: border-box;\n}\n.vuepress-plugin-demo-block__wrapper:hover {\n  box-shadow: 0 0 11px rgba(33, 33, 33, 0.2);\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__code {\n  overflow: hidden;\n  height: 0;\n  padding: 0 !important;\n  background-color: #282c34;\n  border-radius: 0 !important;\n  transition: height 0.5s;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__code pre {\n  margin: 0 !important;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__display {\n  padding: 20px;\n  border-bottom: 1px solid #ebebeb;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer {\n  position: relative;\n  text-align: center;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer.vuepress-plugin-demo-block__show-link .vuepress-plugin-demo-block__jsfiddle,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer.vuepress-plugin-demo-block__show-link .vuepress-plugin-demo-block__codepen {\n  opacity: 1;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer.vuepress-plugin-demo-block__show-link .vuepress-plugin-demo-block__expand::before {\n  border-top: none;\n  border-right: 6px solid transparent;\n  border-bottom: 6px solid #ccc;\n  border-left: 6px solid transparent;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__jsfiddle,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__codepen,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__expand span,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__expand {\n  opacity: 1;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__expand::before {\n  border-top-color: #3eaf7c !important;\n  border-bottom-color: #3eaf7c !important;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover svg {\n  fill: #3eaf7c !important;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__expand-text {\n  transition: all 0.5s;\n  opacity: 0;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer form:nth-last-child(2) {\n  right: 50px;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer form:last-child {\n  right: 10px;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button {\n  border-color: transparent;\n  background-color: transparent;\n  font-size: 14px;\n  color: #3eaf7c;\n  cursor: pointer;\n  outline: none;\n  margin: 0;\n  width: 46px;\n  position: relative;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button:hover::before {\n  content: attr(data-tip);\n  white-space: nowrap;\n  position: absolute;\n  top: -30px;\n  left: 50%;\n  color: #eee;\n  line-height: 1;\n  z-index: 1000;\n  border-radius: 4px;\n  padding: 6px;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n  background-color: rgba(0, 0, 0, 0.8);\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button:hover::after {\n  content: '' !important;\n  display: block;\n  position: absolute;\n  left: 50%;\n  top: -5px;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n  border: 5px solid transparent;\n  border-top-color: rgba(0, 0, 0, 0.8);\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button svg {\n  width: 34px;\n  height: 20px;\n  fill: #ccc;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__jsfiddle,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__codepen {\n  position: absolute;\n  top: 10px;\n  transition: all 0.5s;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__expand {\n  position: relative;\n  width: 100px;\n  height: 40px;\n  margin: 0;\n  color: #3eaf7c;\n  font-size: 14px;\n  background-color: transparent;\n  border-color: transparent;\n  outline: none;\n  transition: all 0.5s;\n  cursor: pointer;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__expand::before {\n  content: \"\";\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 0;\n  height: 0;\n  border-top: 6px solid #ccc;\n  border-right: 6px solid transparent;\n  border-left: 6px solid transparent;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n}\n");var fs={jsLib:[],cssLib:[],jsfiddle:!0,codepen:!0,codepenLayout:"left",codepenJsProcessor:"babel",codepenEditors:"101",horizontal:!1,vue:"https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js",react:"https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js",reactDOM:"https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"},hs={},gs=function(n){return'<div id="app">\n'.concat(n,"\n</div>")},bs=function(n){return window.$VUEPRESS_DEMO_BLOCK&&void 0!==window.$VUEPRESS_DEMO_BLOCK[n]?window.$VUEPRESS_DEMO_BLOCK[n]:fs[n]},ys=function n(e,t,r){var o=document.createElement(e);return t&&Object.keys(t).forEach((function(n){if(n.indexOf("data"))o[n]=t[n];else{var e=n.replace("data","");o.dataset[e]=t[n]}})),r&&r.forEach((function(e){var t=e.tag,r=e.attrs,a=e.children;o.appendChild(n(t,r,a))})),o},vs=function(n,e,t){var r,o=(r=n.querySelectorAll(".".concat(e)),Array.prototype.slice.call(r));return 1!==o.length||t?o:o[0]},xs=function(n,e){var t,r,o=n.match(/<style>([\s\S]+)<\/style>/),a=n.match(/<template>([\s\S]+)<\/template>/),i=n.match(/<script>([\s\S]+)<\/script>/),s={css:o&&o[1].replace(/^\n|\n$/g,""),html:a&&a[1].replace(/^\n|\n$/g,""),js:i&&i[1].replace(/^\n|\n$/g,""),jsLib:e.jsLib||[],cssLib:e.cssLib||[]};s.htmlTpl=gs(s.html),s.jsTpl=(t=s.js,r=t.replace(/export\s+default\s*?\{\n*/,"").replace(/\n*\}\s*$/,"").trim(),"new Vue({\n  el: '#app',\n  ".concat(r,"\n})")),s.script=function(n,e){var t=n.split(/export\s+default/),r="(function() {".concat(t[0]," ; return ").concat(t[1],"})()"),o=window.Babel?window.Babel.transform(r,{presets:["es2015"]}).code:r,a=[eval][0](o);return a.template=e,a}(s.js,s.html);var l=bs("vue");return s.jsLib.unshift(l),s},ws=function(n,e){var t,r=n.match(/<style>([\s\S]+)<\/style>/),o=n.match(/<html>([\s\S]+)<\/html>/),a=n.match(/<script>([\s\S]+)<\/script>/),i={css:r&&r[1].replace(/^\n|\n$/g,""),html:o&&o[1].replace(/^\n|\n$/g,""),js:a&&a[1].replace(/^\n|\n$/g,""),jsLib:e.jsLib||[],cssLib:e.cssLib||[]};return i.htmlTpl=i.html,i.jsTpl=i.js,i.script=(t=i.js,window.Babel?window.Babel.transform(t,{presets:["es2015"]}).code:t),i},ks=function(n){return n=n.replace("export default ","").replace(/App\.__style__(\s*)=(\s*)`([\s\S]*)?`/,""),n+='ReactDOM.render(React.createElement(App), document.getElementById("app"))'};function Ss(){var n=vs(document,"vuepress-plugin-demo-block__wrapper",!0);n.length?n.forEach((function(n){if("true"!==n.dataset.created){n.style.display="block";var e=vs(n,"vuepress-plugin-demo-block__code"),t=vs(n,"vuepress-plugin-demo-block__display"),r=vs(n,"vuepress-plugin-demo-block__footer"),o=vs(t,"vuepress-plugin-demo-block__app"),a=decodeURIComponent(n.dataset.code),i=decodeURIComponent(n.dataset.config),s=decodeURIComponent(n.dataset.type);i=i?JSON.parse(i):{};var l=e.querySelector("div").clientHeight,c="react"===s?function(n,e){var t=(0,window.Babel.transform)(n,{presets:["es2015","react"]}).code,r="(function(exports){var module={};module.exports=exports;".concat(t,";return module.exports.__esModule?module.exports.default:module.exports;})({})"),o=new Function("return ".concat(r))(),a={js:o,css:o.__style__||"",jsLib:e.jsLib||[],cssLib:e.cssLib||[],jsTpl:ks(n),htmlTpl:gs("")},i=bs("react"),s=bs("reactDOM");return a.jsLib.unshift(i,s),a}(a,i):"vanilla"===s?ws(a,i):xs(a,i),u=ys("button",{className:"".concat("vuepress-plugin-demo-block__expand")});if(r.appendChild(u),u.addEventListener("click",js.bind(null,u,l,e,r)),bs("jsfiddle")&&r.appendChild(function(n){var e=n.css,t=n.htmlTpl,r=n.jsTpl,o=n.jsLib,a=n.cssLib,i=o.concat(a).concat(bs("cssLib")).concat(bs("jsLib")).join(",");return ys("form",{className:"vuepress-plugin-demo-block__jsfiddle",target:"_blank",action:"https://jsfiddle.net/api/post/library/pure/",method:"post"},[{tag:"input",attrs:{type:"hidden",name:"css",value:e}},{tag:"input",attrs:{type:"hidden",name:"html",value:t}},{tag:"input",attrs:{type:"hidden",name:"js",value:r}},{tag:"input",attrs:{type:"hidden",name:"panel_js",value:3}},{tag:"input",attrs:{type:"hidden",name:"wrap",value:1}},{tag:"input",attrs:{type:"hidden",name:"resources",value:i}},{tag:"button",attrs:{type:"submit",className:"vuepress-plugin-demo-block__button",innerHTML:'<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1547088289967" class="icon" style="" viewBox="0 0 1170 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1952" xmlns:xlink="http://www.w3.org/1999/xlink" width="228.515625" height="200"><defs><style type="text/css"></style></defs><path d="M1028.571429 441.142857q63.428571 26.285714 102.571428 83.142857T1170.285714 650.857143q0 93.714286-67.428571 160.285714T940 877.714286q-2.285714 0-6.571429-0.285715t-6-0.285714H232q-97.142857-5.714286-164.571429-71.714286T0 645.142857q0-62.857143 31.428571-116t84-84q-6.857143-22.285714-6.857142-46.857143 0-65.714286 46.857142-112t113.714286-46.285714q54.285714 0 98.285714 33.142857 42.857143-88 127.142858-141.714286t186.571428-53.714285q94.857143 0 174.857143 46T982.571429 248.571429t46.571428 172q0 3.428571-0.285714 10.285714t-0.285714 10.285714zM267.428571 593.142857q0 69.714286 48 110.285714t118.857143 40.571429q78.285714 0 137.142857-56.571429-9.142857-11.428571-27.142857-32.285714T519.428571 626.285714q-38.285714 37.142857-82.285714 37.142857-31.428571 0-53.428571-19.142857T361.714286 594.285714q0-30.285714 22-49.714285t52.285714-19.428572q25.142857 0 48.285714 12t41.714286 31.428572 37.142857 42.857142 39.428572 46.857143 44 42.857143 55.428571 31.428572 69.428571 12q69.142857 0 116.857143-40.857143T936 594.857143q0-69.142857-48-109.714286t-118.285714-40.571428q-81.714286 0-137.714286 55.428571l53.142857 61.714286q37.714286-36.571429 81.142857-36.571429 29.714286 0 52.571429 18.857143t22.857143 48q0 32.571429-21.142857 52.285714t-53.714286 19.714286q-24.571429 0-47.142857-12t-41.142857-31.428571-37.428572-42.857143-39.714286-46.857143-44.285714-42.857143-55.142857-31.428571T434.285714 444.571429q-69.714286 0-118.285714 40.285714T267.428571 593.142857z" p-id="1953"></path></svg>',datatip:"JSFiddle"}}])}(c)),bs("codepen")&&r.appendChild(function(n){var e=n.css,t=n.htmlTpl,r=n.jsTpl,o=n.jsLib,a=n.cssLib,i=JSON.stringify({css:e,html:t,js:r,js_external:o.concat(bs("jsLib")).join(";"),css_external:a.concat(bs("cssLib")).join(";"),layout:bs("codepenLayout"),js_pre_processor:bs("codepenJsProcessor"),editors:bs("codepenEditors")});return ys("form",{className:"vuepress-plugin-demo-block__codepen",target:"_blank",action:"https://codepen.io/pen/define",method:"post"},[{tag:"input",attrs:{type:"hidden",name:"data",value:i}},{tag:"button",attrs:{type:"submit",innerHTML:'<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1547088271207" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1737" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M123.428571 668l344.571429 229.714286v-205.142857L277.142857 565.142857z m-35.428571-82.285714l110.285714-73.714286-110.285714-73.714286v147.428572z m468 312l344.571429-229.714286-153.714286-102.857143-190.857143 127.428572v205.142857z m-44-281.714286l155.428571-104-155.428571-104-155.428571 104zM277.142857 458.857143l190.857143-127.428572V126.285714L123.428571 356z m548.571429 53.142857l110.285714 73.714286V438.285714z m-78.857143-53.142857l153.714286-102.857143-344.571429-229.714286v205.142857z m277.142857-102.857143v312q0 23.428571-19.428571 36.571429l-468 312q-12 7.428571-24.571429 7.428571t-24.571429-7.428571L19.428571 704.571429q-19.428571-13.142857-19.428571-36.571429V356q0-23.428571 19.428571-36.571429L487.428571 7.428571q12-7.428571 24.571429-7.428571t24.571429 7.428571l468 312q19.428571 13.142857 19.428571 36.571429z" p-id="1738"></path></svg>',className:"vuepress-plugin-demo-block__button",datatip:"Codepen"}}])}(c)),void 0!==i.horizontal?i.horizontal:bs("horizontal")){n.classList.add("vuepress-plugin-demo-block__horizontal");var d=e.firstChild.cloneNode(!0);d.classList.add("vuepress-plugin-demo-block__h_code"),t.appendChild(d)}if(c.css&&function(n){if(!hs[n]){var e=ys("style",{innerHTML:n});document.body.appendChild(e),hs[n]=!0}}(c.css),"react"===s)ReactDOM.render(React.createElement(c.js),o);else if("vue"===s){var p=(new(Vue.extend(c.script))).$mount();o.appendChild(p.$el)}else"vanilla"===s&&(o.innerHTML=c.html,new Function("return (function(){".concat(c.script,"})()"))());n.dataset.created="true"}})):setTimeout((function(n){Ss()}),300)}function js(n,e,t,r){var o="1"!==n.dataset.isExpand;t.style.height=o?"".concat(e,"px"):0,o?r.classList.add("vuepress-plugin-demo-block__show-link"):r.classList.remove("vuepress-plugin-demo-block__show-link"),n.dataset.isExpand=o?"1":"0"}var Es={mounted:function(){window.$VUEPRESS_DEMO_BLOCK={jsfiddle:!1,codepen:!0,horizontal:!1},Ss()},updated:function(){Ss()}},As=(t(224),"auto"),Is="zoom-in",Ts="zoom-out",zs="grab",_s="move";function Cs(n,e,t){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o={passive:!1};r?n.addEventListener(e,t,o):n.removeEventListener(e,t,o)}function Ps(n,e){if(n){var t=new Image;t.onload=function(){e&&e(t)},t.src=n}}function Os(n){return n.dataset.original?n.dataset.original:"A"===n.parentNode.tagName?n.parentNode.getAttribute("href"):null}function Ms(n,e,t){!function(n){var e=Ds,t=Rs;if(n.transition){var r=n.transition;delete n.transition,n[e]=r}if(n.transform){var o=n.transform;delete n.transform,n[t]=o}}(e);var r=n.style,o={};for(var a in e)t&&(o[a]=r[a]||""),r[a]=e[a];return o}var Ds="transition",Rs="transform",Bs="transform",Ls="transitionend";var Ns=function(){},Fs={enableGrab:!0,preloadImage:!1,closeOnWindowResize:!0,transitionDuration:.4,transitionTimingFunction:"cubic-bezier(0.4, 0, 0, 1)",bgColor:"rgb(255, 255, 255)",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,zIndex:998,customSize:null,onOpen:Ns,onClose:Ns,onGrab:Ns,onMove:Ns,onRelease:Ns,onBeforeOpen:Ns,onBeforeClose:Ns,onBeforeGrab:Ns,onBeforeRelease:Ns,onImageLoading:Ns,onImageLoaded:Ns},qs={init:function(n){var e,t;e=this,t=n,Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach((function(n){e[n]=e[n].bind(t)}))},click:function(n){if(n.preventDefault(),Gs(n))return window.open(this.target.srcOriginal||n.currentTarget.src,"_blank");this.shown?this.released?this.close():this.release():this.open(n.currentTarget)},scroll:function(){var n=document.documentElement||document.body.parentNode||document.body,e=window.pageXOffset||n.scrollLeft,t=window.pageYOffset||n.scrollTop;null===this.lastScrollPosition&&(this.lastScrollPosition={x:e,y:t});var r=this.lastScrollPosition.x-e,o=this.lastScrollPosition.y-t,a=this.options.scrollThreshold;(Math.abs(o)>=a||Math.abs(r)>=a)&&(this.lastScrollPosition=null,this.close())},keydown:function(n){(function(n){return"Escape"===(n.key||n.code)||27===n.keyCode})(n)&&(this.released?this.close():this.release(this.close))},mousedown:function(n){if($s(n)&&!Gs(n)){n.preventDefault();var e=n.clientX,t=n.clientY;this.pressTimer=setTimeout(function(){this.grab(e,t)}.bind(this),200)}},mousemove:function(n){this.released||this.move(n.clientX,n.clientY)},mouseup:function(n){$s(n)&&!Gs(n)&&(clearTimeout(this.pressTimer),this.released?this.close():this.release())},touchstart:function(n){n.preventDefault();var e=n.touches[0],t=e.clientX,r=e.clientY;this.pressTimer=setTimeout(function(){this.grab(t,r)}.bind(this),200)},touchmove:function(n){if(!this.released){var e=n.touches[0],t=e.clientX,r=e.clientY;this.move(t,r)}},touchend:function(n){(function(n){n.targetTouches.length})(n)||(clearTimeout(this.pressTimer),this.released?this.close():this.release())},clickOverlay:function(){this.close()},resizeWindow:function(){this.close()}};function $s(n){return 0===n.button}function Gs(n){return n.metaKey||n.ctrlKey}var Us={init:function(n){this.el=document.createElement("div"),this.instance=n,this.parent=document.body,Ms(this.el,{position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0}),this.updateStyle(n.options),Cs(this.el,"click",n.handler.clickOverlay.bind(n))},updateStyle:function(n){Ms(this.el,{zIndex:n.zIndex,backgroundColor:n.bgColor,transition:"opacity\n        "+n.transitionDuration+"s\n        "+n.transitionTimingFunction})},insert:function(){this.parent.appendChild(this.el)},remove:function(){this.parent.removeChild(this.el)},fadeIn:function(){this.el.offsetWidth,this.el.style.opacity=this.instance.options.bgOpacity},fadeOut:function(){this.el.style.opacity=0}},Hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Js=function(){function n(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),Ws=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Vs={init:function(n,e){this.el=n,this.instance=e,this.srcThumbnail=this.el.getAttribute("src"),this.srcset=this.el.getAttribute("srcset"),this.srcOriginal=Os(this.el),this.rect=this.el.getBoundingClientRect(),this.translate=null,this.scale=null,this.styleOpen=null,this.styleClose=null},zoomIn:function(){var n=this.instance.options,e=n.zIndex,t=n.enableGrab,r=n.transitionDuration,o=n.transitionTimingFunction;this.translate=this.calculateTranslate(),this.scale=this.calculateScale(),this.styleOpen={position:"relative",zIndex:e+1,cursor:t?zs:Ts,transition:Bs+"\n        "+r+"s\n        "+o,transform:"translate3d("+this.translate.x+"px, "+this.translate.y+"px, 0px)\n        scale("+this.scale.x+","+this.scale.y+")",height:this.rect.height+"px",width:this.rect.width+"px"},this.el.offsetWidth,this.styleClose=Ms(this.el,this.styleOpen,!0)},zoomOut:function(){this.el.offsetWidth,Ms(this.el,{transform:"none"})},grab:function(n,e,t){var r=Ks(),o=r.x-n,a=r.y-e;Ms(this.el,{cursor:_s,transform:"translate3d(\n        "+(this.translate.x+o)+"px, "+(this.translate.y+a)+"px, 0px)\n        scale("+(this.scale.x+t)+","+(this.scale.y+t)+")"})},move:function(n,e,t){var r=Ks(),o=r.x-n,a=r.y-e;Ms(this.el,{transition:Bs,transform:"translate3d(\n        "+(this.translate.x+o)+"px, "+(this.translate.y+a)+"px, 0px)\n        scale("+(this.scale.x+t)+","+(this.scale.y+t)+")"})},restoreCloseStyle:function(){Ms(this.el,this.styleClose)},restoreOpenStyle:function(){Ms(this.el,this.styleOpen)},upgradeSource:function(){if(this.srcOriginal){var n=this.el.parentNode;this.srcset&&this.el.removeAttribute("srcset");var e=this.el.cloneNode(!1);e.setAttribute("src",this.srcOriginal),e.style.position="fixed",e.style.visibility="hidden",n.appendChild(e),setTimeout(function(){this.el.setAttribute("src",this.srcOriginal),n.removeChild(e)}.bind(this),50)}},downgradeSource:function(){this.srcOriginal&&(this.srcset&&this.el.setAttribute("srcset",this.srcset),this.el.setAttribute("src",this.srcThumbnail))},calculateTranslate:function(){var n=Ks(),e=this.rect.left+this.rect.width/2,t=this.rect.top+this.rect.height/2;return{x:n.x-e,y:n.y-t}},calculateScale:function(){var n=this.el.dataset,e=n.zoomingHeight,t=n.zoomingWidth,r=this.instance.options,o=r.customSize,a=r.scaleBase;if(!o&&e&&t)return{x:t/this.rect.width,y:e/this.rect.height};if(o&&"object"===(void 0===o?"undefined":Hs(o)))return{x:o.width/this.rect.width,y:o.height/this.rect.height};var i=this.rect.width/2,s=this.rect.height/2,l=Ks(),c={x:l.x-i,y:l.y-s},u=c.x/i,d=c.y/s,p=a+Math.min(u,d);if(o&&"string"==typeof o){var m=t||this.el.naturalWidth,f=e||this.el.naturalHeight,h=parseFloat(o)*m/(100*this.rect.width),g=parseFloat(o)*f/(100*this.rect.height);if(p>h||p>g)return{x:h,y:g}}return{x:p,y:p}}};function Ks(){var n=document.documentElement;return{x:Math.min(n.clientWidth,window.innerWidth)/2,y:Math.min(n.clientHeight,window.innerHeight)/2}}function Zs(n,e,t){["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"].forEach((function(r){Cs(n,r,e[r],t)}))}var Ys=function(){function n(e){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.target=Object.create(Vs),this.overlay=Object.create(Us),this.handler=Object.create(qs),this.body=document.body,this.shown=!1,this.lock=!1,this.released=!0,this.lastScrollPosition=null,this.pressTimer=null,this.options=Ws({},Fs,e),this.overlay.init(this),this.handler.init(this)}return Js(n,[{key:"listen",value:function(n){if("string"==typeof n)for(var e=document.querySelectorAll(n),t=e.length;t--;)this.listen(e[t]);else"IMG"===n.tagName&&(n.style.cursor=Is,Cs(n,"click",this.handler.click),this.options.preloadImage&&Ps(Os(n)));return this}},{key:"config",value:function(n){return n?(Ws(this.options,n),this.overlay.updateStyle(this.options),this):this.options}},{key:"open",value:function(n){var e=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.onOpen;if(!this.shown&&!this.lock){var r="string"==typeof n?document.querySelector(n):n;if("IMG"===r.tagName){if(this.options.onBeforeOpen(r),this.target.init(r,this),!this.options.preloadImage){var o=this.target.srcOriginal;null!=o&&(this.options.onImageLoading(r),Ps(o,this.options.onImageLoaded))}this.shown=!0,this.lock=!0,this.target.zoomIn(),this.overlay.insert(),this.overlay.fadeIn(),Cs(document,"scroll",this.handler.scroll),Cs(document,"keydown",this.handler.keydown),this.options.closeOnWindowResize&&Cs(window,"resize",this.handler.resizeWindow);var a=function n(){Cs(r,Ls,n,!1),e.lock=!1,e.target.upgradeSource(),e.options.enableGrab&&Zs(document,e.handler,!0),t(r)};return Cs(r,Ls,a),this}}}},{key:"close",value:function(){var n=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.onClose;if(this.shown&&!this.lock){var t=this.target.el;this.options.onBeforeClose(t),this.lock=!0,this.body.style.cursor=As,this.overlay.fadeOut(),this.target.zoomOut(),Cs(document,"scroll",this.handler.scroll,!1),Cs(document,"keydown",this.handler.keydown,!1),this.options.closeOnWindowResize&&Cs(window,"resize",this.handler.resizeWindow,!1);var r=function r(){Cs(t,Ls,r,!1),n.shown=!1,n.lock=!1,n.target.downgradeSource(),n.options.enableGrab&&Zs(document,n.handler,!1),n.target.restoreCloseStyle(),n.overlay.remove(),e(t)};return Cs(t,Ls,r),this}}},{key:"grab",value:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options.scaleExtra,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.options.onGrab;if(this.shown&&!this.lock){var o=this.target.el;this.options.onBeforeGrab(o),this.released=!1,this.target.grab(n,e,t);var a=function n(){Cs(o,Ls,n,!1),r(o)};return Cs(o,Ls,a),this}}},{key:"move",value:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options.scaleExtra,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.options.onMove;if(this.shown&&!this.lock){this.released=!1,this.body.style.cursor=_s,this.target.move(n,e,t);var o=this.target.el,a=function n(){Cs(o,Ls,n,!1),r(o)};return Cs(o,Ls,a),this}}},{key:"release",value:function(){var n=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.onRelease;if(this.shown&&!this.lock){var t=this.target.el;this.options.onBeforeRelease(t),this.lock=!0,this.body.style.cursor=As,this.target.restoreOpenStyle();var r=function r(){Cs(t,Ls,r,!1),n.lock=!1,n.released=!0,e(t)};return Cs(t,Ls,r),this}}}]),n}(),Xs=".theme-vdoing-content img:not(.no-zoom)",Qs=JSON.parse('{"bgColor":"rgba(0,0,0,0.6)"}'),nl=Number("500"),el=function(){function n(){cs(this,n),this.instance=new Ys(Qs)}return ds(n,[{key:"update",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xs;"undefined"!=typeof window&&this.instance.listen(n)}},{key:"updateDelay",value:function(){var n=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xs,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nl;setTimeout((function(){return n.update(e)}),t)}}]),n}(),tl=[Qi,as,ls,ms,Es,{watch:{"$page.path":function(){void 0!==this.$vuepress.zooming&&this.$vuepress.zooming.updateDelay()}},mounted:function(){this.$vuepress.zooming=new el,this.$vuepress.zooming.updateDelay()}}],rl={name:"GlobalLayout",computed:{layout:function(){var n=this.getLayout();return Wi("layout",n),Mo.component(n)}},methods:{getLayout:function(){if(this.$page.path){var n=this.$page.frontmatter.layout;return n&&(this.$vuepress.getLayoutAsyncComponent(n)||this.$vuepress.getVueComponent(n))?n:"Layout"}return"NotFound"}}},ol=t(20),al=Object(ol.a)(rl,(function(){var n=this.$createElement;return(this._self._c||n)(this.layout,{tag:"component"})}),[],!1,null,null,null).exports;!function(n,e,t){var r;switch(e){case"components":n[e]||(n[e]={}),Object.assign(n[e],t);break;case"mixins":n[e]||(n[e]=[]),(r=n[e]).push.apply(r,Object(Ii.a)(t));break;default:throw new Error("Unknown option name.")}}(al,"mixins",tl);var il=[{name:"v-1df4d616",path:"/interview/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-1df4d616").then(t)}},{path:"/interview/index.html",redirect:"/interview/"},{path:"/00.ç®å½é¡µ/50.é¢è¯.html",redirect:"/interview/"},{name:"v-10284f70",path:"/pages/8a3d2e/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-10284f70").then(t)}},{path:"/pages/8a3d2e/index.html",redirect:"/pages/8a3d2e/"},{path:"/05.Java/05.Javaåºç¡/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/8a3d2e/"},{name:"v-27875be3",path:"/pages/14d613/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-27875be3").then(t)}},{path:"/pages/14d613/index.html",redirect:"/pages/14d613/"},{path:"/05.Java/15.Javaèææº/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/14d613/"},{name:"v-326b4e84",path:"/pages/101235/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-326b4e84").then(t)}},{path:"/pages/101235/index.html",redirect:"/pages/101235/"},{path:"/05.Java/20.JDKæ°ç¹æ§/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/101235/"},{name:"v-223d701a",path:"/pages/b9843d/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-223d701a").then(t)}},{path:"/pages/b9843d/index.html",redirect:"/pages/b9843d/"},{path:"/05.Java/25.Java Web/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/b9843d/"},{name:"v-7d49cd87",path:"/pages/48f257/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-7d49cd87").then(t)}},{path:"/pages/48f257/index.html",redirect:"/pages/48f257/"},{path:"/05.Java/30.æ°æ®ç»æåç®æ³/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/48f257/"},{name:"v-130f5d29",path:"/pages/f9d65e/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-130f5d29").then(t)}},{path:"/pages/f9d65e/index.html",redirect:"/pages/f9d65e/"},{path:"/05.Java/35.è®¡ç®æºç½ç»/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/f9d65e/"},{name:"v-17af0f12",path:"/pages/d4d364/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-17af0f12").then(t)}},{path:"/pages/d4d364/index.html",redirect:"/pages/d4d364/"},{path:"/10.æ¡æ¶/05.Spring/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/d4d364/"},{name:"v-5621ad6f",path:"/pages/72f279/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-5621ad6f").then(t)}},{path:"/pages/72f279/index.html",redirect:"/pages/72f279/"},{path:"/10.æ¡æ¶/10.Spring MVC/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/72f279/"},{name:"v-120fd95f",path:"/pages/815499/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-120fd95f").then(t)}},{path:"/pages/815499/index.html",redirect:"/pages/815499/"},{path:"/10.æ¡æ¶/15.Spring Boot/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/815499/"},{name:"v-3ef46c3e",path:"/pages/616956/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-3ef46c3e").then(t)}},{path:"/pages/616956/index.html",redirect:"/pages/616956/"},{path:"/05.Java/10.Javaå¹¶å/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/616956/"},{name:"v-20167b32",path:"/pages/82b6d4/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-20167b32").then(t)}},{path:"/pages/82b6d4/index.html",redirect:"/pages/82b6d4/"},{path:"/10.æ¡æ¶/20.Spring Cloud/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/82b6d4/"},{name:"v-061159fa",path:"/pages/075df8/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-061159fa").then(t)}},{path:"/pages/075df8/index.html",redirect:"/pages/075df8/"},{path:"/10.æ¡æ¶/21.Spring Cloud Alibaba/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/075df8/"},{name:"v-2b0b1b3e",path:"/pages/c55839/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-2b0b1b3e").then(t)}},{path:"/pages/c55839/index.html",redirect:"/pages/c55839/"},{path:"/10.æ¡æ¶/25.Spring Security/01.ãèå¾ãSpring Security(ä¸) ââ Architecture Overview.html",redirect:"/pages/c55839/"},{name:"v-2b72ba50",path:"/pages/188a19/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-2b72ba50").then(t)}},{path:"/pages/188a19/index.html",redirect:"/pages/188a19/"},{path:"/10.æ¡æ¶/25.Spring Security/02.ãèå¾ãSpring Security(äº) ââ Guides.html",redirect:"/pages/188a19/"},{name:"v-d22b1d0e",path:"/pages/9327fd/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-d22b1d0e").then(t)}},{path:"/pages/9327fd/index.html",redirect:"/pages/9327fd/"},{path:"/10.æ¡æ¶/25.Spring Security/03.ãèå¾ãSpring Security(ä¸) ââ æ ¸å¿éç½®è§£è¯».html",redirect:"/pages/9327fd/"},{name:"v-30695d13",path:"/pages/bb2ce5/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-30695d13").then(t)}},{path:"/pages/bb2ce5/index.html",redirect:"/pages/bb2ce5/"},{path:"/10.æ¡æ¶/25.Spring Security/04.ãèå¾ãSpring Security(å) ââ æ ¸å¿è¿æ»¤å¨æºç åæ.html",redirect:"/pages/bb2ce5/"},{name:"v-27133cbb",path:"/pages/754b42/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-27133cbb").then(t)}},{path:"/pages/754b42/index.html",redirect:"/pages/754b42/"},{path:"/10.æ¡æ¶/25.Spring Security/05.ãèå¾ãSpring Security(äº) ââ å¨æå®ç°ä¸ä¸ª IP_Login.html",redirect:"/pages/754b42/"},{name:"v-2203d9c2",path:"/pages/79202c/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-2203d9c2").then(t)}},{path:"/pages/79202c/index.html",redirect:"/pages/79202c/"},{path:"/10.æ¡æ¶/25.Spring Security/06.ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼ä¸ï¼.html",redirect:"/pages/79202c/"},{name:"v-2bdfec00",path:"/pages/3e6453/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-2bdfec00").then(t)}},{path:"/pages/3e6453/index.html",redirect:"/pages/3e6453/"},{path:"/10.æ¡æ¶/25.Spring Security/07.ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼äºï¼.html",redirect:"/pages/3e6453/"},{name:"v-f7677c3c",path:"/pages/202614/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-f7677c3c").then(t)}},{path:"/pages/202614/index.html",redirect:"/pages/202614/"},{path:"/10.æ¡æ¶/25.Spring Security/08.ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼ä¸ï¼.html",redirect:"/pages/202614/"},{name:"v-83400752",path:"/pages/605664/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-83400752").then(t)}},{path:"/pages/605664/index.html",redirect:"/pages/605664/"},{path:"/10.æ¡æ¶/25.Spring Security/10.Spring Security å¥é¨ç¯.html",redirect:"/pages/605664/"},{name:"v-6c08538d",path:"/pages/9be0a1/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-6c08538d").then(t)}},{path:"/pages/9be0a1/index.html",redirect:"/pages/9be0a1/"},{path:"/10.æ¡æ¶/25.Spring Security/09.ãèå¾ãè¯¥å¦ä½è®¾è®¡ä½ ç PasswordEncoder.html",redirect:"/pages/9be0a1/"},{name:"v-4c61c5bc",path:"/pages/d07b16/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-4c61c5bc").then(t)}},{path:"/pages/d07b16/index.html",redirect:"/pages/d07b16/"},{path:"/10.æ¡æ¶/30.Mybatis/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/d07b16/"},{name:"v-3f5b59cf",path:"/pages/d35a9e/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-3f5b59cf").then(t)}},{path:"/pages/d35a9e/index.html",redirect:"/pages/d35a9e/"},{path:"/10.æ¡æ¶/35.Mybatis Plus/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/d35a9e/"},{name:"v-a5a12a48",path:"/pages/b8166d/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-a5a12a48").then(t)}},{path:"/pages/b8166d/index.html",redirect:"/pages/b8166d/"},{path:"/10.æ¡æ¶/40.Redis/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/b8166d/"},{name:"v-58f14e65",path:"/pages/ee8f7b/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-58f14e65").then(t)}},{path:"/pages/ee8f7b/index.html",redirect:"/pages/ee8f7b/"},{path:"/10.æ¡æ¶/45.Mysql/05.SQL/05.EXISTSï¼NOT EXISTS ï¼ è¯­å¥.html",redirect:"/pages/ee8f7b/"},{name:"v-35bfa9e0",path:"/pages/bc1a45/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-35bfa9e0").then(t)}},{path:"/pages/bc1a45/index.html",redirect:"/pages/bc1a45/"},{path:"/10.æ¡æ¶/50.Zookeeper/10.å®ä¾è¯¦è§£ZooKeeper ZABåè®®ãåå¸å¼éä¸é¢å¯¼éä¸¾.html",redirect:"/pages/bc1a45/"},{name:"v-363cf0bc",path:"/pages/017da3/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-363cf0bc").then(t)}},{path:"/pages/017da3/index.html",redirect:"/pages/017da3/"},{path:"/10.æ¡æ¶/55.Dubbo/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/017da3/"},{name:"v-6756bb32",path:"/pages/e5e3af/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-6756bb32").then(t)}},{path:"/pages/e5e3af/index.html",redirect:"/pages/e5e3af/"},{path:"/10.æ¡æ¶/60.Kafka/01.Kafkaåæºçå®è£.html",redirect:"/pages/e5e3af/"},{name:"v-6e63d81a",path:"/pages/bc987c/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-6e63d81a").then(t)}},{path:"/pages/bc987c/index.html",redirect:"/pages/bc987c/"},{path:"/10.æ¡æ¶/60.Kafka/10.kafkaå½ä»¤æ´ç.html",redirect:"/pages/bc987c/"},{name:"v-2fe45ff3",path:"/pages/4975ea/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-2fe45ff3").then(t)}},{path:"/pages/4975ea/index.html",redirect:"/pages/4975ea/"},{path:"/10.æ¡æ¶/60.Kafka/20.kafkaå®¢æ·ç«¯ç¤ºä¾ä»£ç .html",redirect:"/pages/4975ea/"},{name:"v-350792bc",path:"/pages/fb3719/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-350792bc").then(t)}},{path:"/pages/fb3719/index.html",redirect:"/pages/fb3719/"},{path:"/10.æ¡æ¶/65.Apollo/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/fb3719/"},{name:"v-3913f24b",path:"/pages/7f0c55/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-3913f24b").then(t)}},{path:"/pages/7f0c55/index.html",redirect:"/pages/7f0c55/"},{path:"/10.æ¡æ¶/70.å¤§æ°æ®/05.Hbase/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/7f0c55/"},{name:"v-fa3822fc",path:"/pages/d09904/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-fa3822fc").then(t)}},{path:"/pages/d09904/index.html",redirect:"/pages/d09904/"},{path:"/10.æ¡æ¶/40.Redis/20.å¸éè¿æ»¤å¨.html",redirect:"/pages/d09904/"},{name:"v-614b0a72",path:"/pages/466af9/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-614b0a72").then(t)}},{path:"/pages/466af9/index.html",redirect:"/pages/466af9/"},{path:"/10.æ¡æ¶/70.å¤§æ°æ®/10.Spark/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/466af9/"},{name:"v-36fb0f35",path:"/pages/d96f04/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-36fb0f35").then(t)}},{path:"/pages/d96f04/index.html",redirect:"/pages/d96f04/"},{path:"/10.æ¡æ¶/70.å¤§æ°æ®/15.ClickHouse/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/d96f04/"},{name:"v-47148396",path:"/pages/9a7ee40fc232253e/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-47148396").then(t)}},{path:"/pages/9a7ee40fc232253e/index.html",redirect:"/pages/9a7ee40fc232253e/"},{path:"/100.å¶ä»/01.ææ¯ææ¡£/01.Gitä½¿ç¨æå.html",redirect:"/pages/9a7ee40fc232253e/"},{name:"v-38b5a542",path:"/pages/ad247c4332211551/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-38b5a542").then(t)}},{path:"/pages/ad247c4332211551/index.html",redirect:"/pages/ad247c4332211551/"},{path:"/100.å¶ä»/01.ææ¯ææ¡£/02.Markdownä½¿ç¨æç¨.html",redirect:"/pages/ad247c4332211551/"},{name:"v-a5b0f788",path:"/pages/61f2f95fd7da14fd/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-a5b0f788").then(t)}},{path:"/pages/61f2f95fd7da14fd/index.html",redirect:"/pages/61f2f95fd7da14fd/"},{path:"/100.å¶ä»/01.ææ¯ææ¡£/03.npmå¸¸ç¨å½ä»¤.html",redirect:"/pages/61f2f95fd7da14fd/"},{name:"v-5746bea6",path:"/pages/dec4f3f00e71a312/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-5746bea6").then(t)}},{path:"/pages/dec4f3f00e71a312/index.html",redirect:"/pages/dec4f3f00e71a312/"},{path:"/100.å¶ä»/01.ææ¯ææ¡£/10.npm packageJsonå±æ§è¯¦è§£.html",redirect:"/pages/dec4f3f00e71a312/"},{name:"v-0e65177a",path:"/pages/4e8444e2d534d14f/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-0e65177a").then(t)}},{path:"/pages/4e8444e2d534d14f/index.html",redirect:"/pages/4e8444e2d534d14f/"},{path:"/100.å¶ä»/01.ææ¯ææ¡£/15.yamlè¯­è¨æç¨.html",redirect:"/pages/4e8444e2d534d14f/"},{name:"v-936eed32",path:"/pages/4c778760be26d8b3/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-936eed32").then(t)}},{path:"/pages/4c778760be26d8b3/index.html",redirect:"/pages/4c778760be26d8b3/"},{path:"/100.å¶ä»/02.GitHubæå·§/01.GitHubé«çº§æç´¢æå·§.html",redirect:"/pages/4c778760be26d8b3/"},{name:"v-0944f7ee",path:"/pages/6b9d359ec5aa5019/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-0944f7ee").then(t)}},{path:"/pages/6b9d359ec5aa5019/index.html",redirect:"/pages/6b9d359ec5aa5019/"},{path:"/100.å¶ä»/02.GitHubæå·§/02.GitHub Actions å®ç°èªå¨é¨ç½²éæåå®¢.html",redirect:"/pages/6b9d359ec5aa5019/"},{name:"v-638f70fb",path:"/pages/f44d2f9ad04ab8d3/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-638f70fb").then(t)}},{path:"/pages/f44d2f9ad04ab8d3/index.html",redirect:"/pages/f44d2f9ad04ab8d3/"},{path:"/100.å¶ä»/02.GitHubæå·§/03.GitHub Actions å®æ¶è¿è¡ä»£ç ï¼æ¯å¤©å®æ¶ç¾åº¦é¾æ¥æ¨é.html",redirect:"/pages/f44d2f9ad04ab8d3/"},{name:"v-6d7302f2",path:"/pages/95331c6a9613faf8/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-6d7302f2").then(t)}},{path:"/pages/95331c6a9613faf8/index.html",redirect:"/pages/95331c6a9613faf8/"},{path:"/100.å¶ä»/02.GitHubæå·§/10.GitHubå éä¸è½½é¡¹ç®çæ¹æ³.html",redirect:"/pages/95331c6a9613faf8/"},{name:"v-1de1c18a",path:"/pages/41f87d890d0a02af/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-1de1c18a").then(t)}},{path:"/pages/41f87d890d0a02af/index.html",redirect:"/pages/41f87d890d0a02af/"},{path:"/100.å¶ä»/04.åå®¢æ­å»º/01.è§£å³ç¾åº¦æ æ³æ¶å½æ­å»ºå¨GitHubä¸çä¸ªäººåå®¢çé®é¢.html",redirect:"/pages/41f87d890d0a02af/"},{name:"v-f465e8f0",path:"/pages/1da0bf9a988eafe5/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-f465e8f0").then(t)}},{path:"/pages/1da0bf9a988eafe5/index.html",redirect:"/pages/1da0bf9a988eafe5/"},{path:"/100.å¶ä»/04.åå®¢æ­å»º/02.ä½¿ç¨Gitalkå®ç°éæåå®¢æ åå°è¯è®ºç³»ç».html",redirect:"/pages/1da0bf9a988eafe5/"},{name:"v-1a36efce",path:"/pages/a5f73af5185fdf0a/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-1a36efce").then(t)}},{path:"/pages/a5f73af5185fdf0a/index.html",redirect:"/pages/a5f73af5185fdf0a/"},{path:"/100.å¶ä»/04.åå®¢æ­å»º/03.GitHub + jsDelivr + TinyPNG+ PicGo æé ç¨³å®å¿«éãé«æåè´¹å¾åº.html",redirect:"/pages/a5f73af5185fdf0a/"},{name:"v-1426c78e",path:"/pages/d557b9a89a215d2e/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-1426c78e").then(t)}},{path:"/pages/d557b9a89a215d2e/index.html",redirect:"/pages/d557b9a89a215d2e/"},{path:"/100.å¶ä»/04.åå®¢æ­å»º/10.vdoingä¸»é¢ææå¾.html",redirect:"/pages/d557b9a89a215d2e/"},{name:"v-8b61ee12",path:"/pages/f1cf70/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-8b61ee12").then(t)}},{path:"/pages/f1cf70/index.html",redirect:"/pages/f1cf70/"},{path:"/15.åç«¯/05.HTML/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/f1cf70/"},{name:"v-01eb52f2",path:"/pages/b0cbfe/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-01eb52f2").then(t)}},{path:"/pages/b0cbfe/index.html",redirect:"/pages/b0cbfe/"},{path:"/15.åç«¯/10.JavaScript/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/b0cbfe/"},{name:"v-0832524d",path:"/pages/1b9d03/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-0832524d").then(t)}},{path:"/pages/1b9d03/index.html",redirect:"/pages/1b9d03/"},{path:"/15.åç«¯/15.CSS/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/1b9d03/"},{name:"v-3e241928",path:"/pages/117708e0af7f0bd9/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-3e241928").then(t)}},{path:"/pages/117708e0af7f0bd9/index.html",redirect:"/pages/117708e0af7f0bd9/"},{path:"/100.å¶ä»/03.Nodejs/01.nodejséå½è¯»åæææä»¶.html",redirect:"/pages/117708e0af7f0bd9/"},{name:"v-85694126",path:"/pages/f94942/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-85694126").then(t)}},{path:"/pages/f94942/index.html",redirect:"/pages/f94942/"},{path:"/15.åç«¯/20.ES6/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/f94942/"},{name:"v-7db0be6d",path:"/pages/3a3093/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-7db0be6d").then(t)}},{path:"/pages/3a3093/index.html",redirect:"/pages/3a3093/"},{path:"/15.åç«¯/30.Webpack/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/3a3093/"},{name:"v-0033648a",path:"/pages/6397c2/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-0033648a").then(t)}},{path:"/pages/6397c2/index.html",redirect:"/pages/6397c2/"},{path:"/15.åç«¯/25.Nodejs/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/6397c2/"},{name:"v-315c4010",path:"/pages/45f613/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-315c4010").then(t)}},{path:"/pages/45f613/index.html",redirect:"/pages/45f613/"},{path:"/15.åç«¯/35.Vue/05.Vue Router/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/45f613/"},{name:"v-50864176",path:"/note/es6/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-50864176").then(t)}},{path:"/note/es6/index.html",redirect:"/note/es6/"},{path:"/15.åç«¯/40.å­¦ä¹ ç¬è®°/10.ãES6 æç¨ãç¬è®°.html",redirect:"/note/es6/"},{name:"v-520c0bed",path:"/pages/8b11e8/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-520c0bed").then(t)}},{path:"/pages/8b11e8/index.html",redirect:"/pages/8b11e8/"},{path:"/15.åç«¯/35.Vue/10.Vuex/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/8b11e8/"},{name:"v-7284126c",path:"/pages/be47c5/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-7284126c").then(t)}},{path:"/pages/be47c5/index.html",redirect:"/pages/be47c5/"},{path:"/25.è¿ç»´/05.Linux/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/be47c5/"},{name:"v-462b4ed7",path:"/pages/1cbc1f/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-462b4ed7").then(t)}},{path:"/pages/1cbc1f/index.html",redirect:"/pages/1cbc1f/"},{path:"/20.æ¶æ/05.è®¾è®¡æ¨¡å¼/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/1cbc1f/"},{name:"v-64279124",path:"/pages/48ee28/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-64279124").then(t)}},{path:"/pages/48ee28/index.html",redirect:"/pages/48ee28/"},{path:"/25.è¿ç»´/10.Shellèæ¬/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/48ee28/"},{name:"v-10cc5422",path:"/pages/c0a158/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-10cc5422").then(t)}},{path:"/pages/c0a158/index.html",redirect:"/pages/c0a158/"},{path:"/25.è¿ç»´/40.Tomcat/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/c0a158/"},{name:"v-61d376a8",path:"/pages/22279f/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-61d376a8").then(t)}},{path:"/pages/22279f/index.html",redirect:"/pages/22279f/"},{path:"/25.è¿ç»´/45.Nginx/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/22279f/"},{name:"v-529de428",path:"/pages/261b24/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-529de428").then(t)}},{path:"/pages/261b24/index.html",redirect:"/pages/261b24/"},{path:"/25.è¿ç»´/50.Docker/01.Docker åçº§ç¯.html",redirect:"/pages/261b24/"},{name:"v-69bafd4e",path:"/pages/a24e91/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-69bafd4e").then(t)}},{path:"/pages/a24e91/index.html",redirect:"/pages/a24e91/"},{path:"/25.è¿ç»´/50.Docker/03.Docker é«çº§å®è·µç¯.html",redirect:"/pages/a24e91/"},{name:"v-485c8077",path:"/pages/5ca863/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-485c8077").then(t)}},{path:"/pages/5ca863/index.html",redirect:"/pages/5ca863/"},{path:"/25.è¿ç»´/50.Docker/02.Docker ä¸­çº§ç¯.html",redirect:"/pages/5ca863/"},{name:"v-25458d2a",path:"/pages/8a7664/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-25458d2a").then(t)}},{path:"/pages/8a7664/index.html",redirect:"/pages/8a7664/"},{path:"/25.è¿ç»´/50.Docker/04.Docker ç½ç»æ¨¡å¼åå®¹å¨é´éä¿¡.html",redirect:"/pages/8a7664/"},{name:"v-dc7c1222",path:"/pages/457953/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-dc7c1222").then(t)}},{path:"/pages/457953/index.html",redirect:"/pages/457953/"},{path:"/25.è¿ç»´/50.Docker/05.Docker æ­å»º Redis Cluster éç¾¤.html",redirect:"/pages/457953/"},{name:"v-69d48d6a",path:"/pages/1b1528/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-69d48d6a").then(t)}},{path:"/pages/1b1528/index.html",redirect:"/pages/1b1528/"},{path:"/25.è¿ç»´/60.kubernetes/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/1b1528/"},{name:"v-252683df",path:"/pages/2c13c2/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-252683df").then(t)}},{path:"/pages/2c13c2/index.html",redirect:"/pages/2c13c2/"},{path:"/30.å·¥å·/05.maven/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/2c13c2/"},{name:"v-e8a298c2",path:"/pages/2ec465/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-e8a298c2").then(t)}},{path:"/pages/2ec465/index.html",redirect:"/pages/2ec465/"},{path:"/30.å·¥å·/10.svn/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/2ec465/"},{name:"v-dbcc7c0e",path:"/pages/891624/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-dbcc7c0e").then(t)}},{path:"/pages/891624/index.html",redirect:"/pages/891624/"},{path:"/30.å·¥å·/20.idea/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/891624/"},{name:"v-2dd7091f",path:"/pages/df2d8d/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-2dd7091f").then(t)}},{path:"/pages/df2d8d/index.html",redirect:"/pages/df2d8d/"},{path:"/30.å·¥å·/25.windows/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/df2d8d/"},{name:"v-67e77451",path:"/pages/bbda94/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-67e77451").then(t)}},{path:"/pages/bbda94/index.html",redirect:"/pages/bbda94/"},{path:"/35.é¢è¯/05.Java/05.Javaåºç¡/05.Java åºç¡.html",redirect:"/pages/bbda94/"},{name:"v-18cea7e8",path:"/pages/17acab/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-18cea7e8").then(t)}},{path:"/pages/17acab/index.html",redirect:"/pages/17acab/"},{path:"/35.é¢è¯/05.Java/05.Javaåºç¡/10.Java å®¹å¨.html",redirect:"/pages/17acab/"},{name:"v-fdf3da36",path:"/pages/5859c4/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-fdf3da36").then(t)}},{path:"/pages/5859c4/index.html",redirect:"/pages/5859c4/"},{path:"/35.é¢è¯/05.Java/05.Javaåºç¡/15.Java IO.html",redirect:"/pages/5859c4/"},{name:"v-52f3ee7a",path:"/pages/e5ea78/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-52f3ee7a").then(t)}},{path:"/pages/e5ea78/index.html",redirect:"/pages/e5ea78/"},{path:"/35.é¢è¯/05.Java/05.Javaåºç¡/30.JDK å¨æä»£ç.html",redirect:"/pages/e5ea78/"},{name:"v-6e96fc20",path:"/pages/14fc4f/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-6e96fc20").then(t)}},{path:"/pages/14fc4f/index.html",redirect:"/pages/14fc4f/"},{path:"/35.é¢è¯/10.Java Web/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/14fc4f/"},{name:"v-3cfa8772",path:"/pages/1ca50c/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-3cfa8772").then(t)}},{path:"/pages/1ca50c/index.html",redirect:"/pages/1ca50c/"},{path:"/35.é¢è¯/15.æ¡æ¶åç/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/1ca50c/"},{name:"v-2a641a1f",path:"/pages/657a34/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-2a641a1f").then(t)}},{path:"/pages/657a34/index.html",redirect:"/pages/657a34/"},{path:"/30.å·¥å·/15.git/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/657a34/"},{name:"v-abf399c4",path:"/pages/6678f4/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-abf399c4").then(t)}},{path:"/pages/6678f4/index.html",redirect:"/pages/6678f4/"},{path:"/35.é¢è¯/20.æ°æ®åº/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/6678f4/"},{name:"v-dc40f1c0",path:"/pages/ddeaf7/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-dc40f1c0").then(t)}},{path:"/pages/ddeaf7/index.html",redirect:"/pages/ddeaf7/"},{path:"/35.é¢è¯/25.è®¾è®¡æ¨¡å¼/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/ddeaf7/"},{name:"v-10ef9d52",path:"/pages/bc7c50/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-10ef9d52").then(t)}},{path:"/pages/bc7c50/index.html",redirect:"/pages/bc7c50/"},{path:"/35.é¢è¯/30.è®¡ç®æºåºç¡/10.IO æ¨¡å.html",redirect:"/pages/bc7c50/"},{name:"v-3b86a05e",path:"/pages/bdd0da/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-3b86a05e").then(t)}},{path:"/pages/bdd0da/index.html",redirect:"/pages/bdd0da/"},{path:"/40.æ´å¤/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.html",redirect:"/pages/bdd0da/"},{name:"v-5176e105",path:"/archives/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-5176e105").then(t)}},{path:"/archives/index.html",redirect:"/archives/"},{path:"/@pages/archivesPage.html",redirect:"/archives/"},{name:"v-75e41c65",path:"/categories/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-75e41c65").then(t)}},{path:"/categories/index.html",redirect:"/categories/"},{path:"/@pages/categoriesPage.html",redirect:"/categories/"},{name:"v-3249c685",path:"/tags/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-3249c685").then(t)}},{path:"/tags/index.html",redirect:"/tags/"},{path:"/@pages/tagsPage.html",redirect:"/tags/"},{name:"v-ec84fed2",path:"/pages/f2e63f/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-ec84fed2").then(t)}},{path:"/pages/f2e63f/index.html",redirect:"/pages/f2e63f/"},{path:"/_posts/éç¬/ä½ ç¥éçè¶å¤ï¼ä¸ç¥éçä¹å°±è¶å¤.html",redirect:"/pages/f2e63f/"},{name:"v-2100b3d2",path:"/pages/cd8bde/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-2100b3d2").then(t)}},{path:"/pages/cd8bde/index.html",redirect:"/pages/cd8bde/"},{path:"/_posts/éç¬/æ¥æ±çæ´»ï¼æ¥æ±å¿«ä¹.html",redirect:"/pages/cd8bde/"},{name:"v-2b7111c4",path:"/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-2b7111c4").then(t)}},{path:"/index.html",redirect:"/"},{name:"v-7b48c50c",path:"/pages/f344d070a1031ef7/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-7b48c50c").then(t)}},{path:"/pages/f344d070a1031ef7/index.html",redirect:"/pages/f344d070a1031ef7/"},{path:"/ãES6 æç¨ãç¬è®°/01.ECMAScript 6 ç®ä».html",redirect:"/pages/f344d070a1031ef7/"},{name:"v-399fd293",path:"/pages/c1edd70a6b7c7872/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-399fd293").then(t)}},{path:"/pages/c1edd70a6b7c7872/index.html",redirect:"/pages/c1edd70a6b7c7872/"},{path:"/ãES6 æç¨ãç¬è®°/02.let å const å½ä»¤.html",redirect:"/pages/c1edd70a6b7c7872/"},{name:"v-346f208f",path:"/pages/b1ab10a62f7564da/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-346f208f").then(t)}},{path:"/pages/b1ab10a62f7564da/index.html",redirect:"/pages/b1ab10a62f7564da/"},{path:"/ãES6 æç¨ãç¬è®°/03.åéçè§£æèµå¼.html",redirect:"/pages/b1ab10a62f7564da/"},{name:"v-4d3a6db4",path:"/pages/a650b4a0ebfc9350/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-4d3a6db4").then(t)}},{path:"/pages/a650b4a0ebfc9350/index.html",redirect:"/pages/a650b4a0ebfc9350/"},{path:"/ãES6 æç¨ãç¬è®°/05.å­ç¬¦ä¸²çæ°å¢æ¹æ³.html",redirect:"/pages/a650b4a0ebfc9350/"},{name:"v-05ba6584",path:"/pages/0473261a6ab0ee8c/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-05ba6584").then(t)}},{path:"/pages/0473261a6ab0ee8c/index.html",redirect:"/pages/0473261a6ab0ee8c/"},{path:"/ãES6 æç¨ãç¬è®°/06.æ­£åçæ©å±.html",redirect:"/pages/0473261a6ab0ee8c/"},{name:"v-e165eb18",path:"/pages/5dfea9a0f2d1a392/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-e165eb18").then(t)}},{path:"/pages/5dfea9a0f2d1a392/index.html",redirect:"/pages/5dfea9a0f2d1a392/"},{path:"/ãES6 æç¨ãç¬è®°/07.æ°å¼çæ©å±.html",redirect:"/pages/5dfea9a0f2d1a392/"},{name:"v-d6f05d32",path:"/pages/8ed309d668b20264/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-d6f05d32").then(t)}},{path:"/pages/8ed309d668b20264/index.html",redirect:"/pages/8ed309d668b20264/"},{path:"/ãES6 æç¨ãç¬è®°/08.å½æ°çæ©å±.html",redirect:"/pages/8ed309d668b20264/"},{name:"v-1f0d05a1",path:"/pages/e34009d60d8bc4b2/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-1f0d05a1").then(t)}},{path:"/pages/e34009d60d8bc4b2/index.html",redirect:"/pages/e34009d60d8bc4b2/"},{path:"/ãES6 æç¨ãç¬è®°/09.æ°ç»çæ©å±.html",redirect:"/pages/e34009d60d8bc4b2/"},{name:"v-c1496618",path:"/pages/b5e3e0a0ff6e9c25/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-c1496618").then(t)}},{path:"/pages/b5e3e0a0ff6e9c25/index.html",redirect:"/pages/b5e3e0a0ff6e9c25/"},{path:"/ãES6 æç¨ãç¬è®°/10.å¯¹è±¡çæ©å±.html",redirect:"/pages/b5e3e0a0ff6e9c25/"},{name:"v-2b833066",path:"/pages/e85e68947502cf90/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-2b833066").then(t)}},{path:"/pages/e85e68947502cf90/index.html",redirect:"/pages/e85e68947502cf90/"},{path:"/ãES6 æç¨ãç¬è®°/11.å¯¹è±¡çæ°å¢æ¹æ³.html",redirect:"/pages/e85e68947502cf90/"},{name:"v-0a300e27",path:"/pages/ca89eca8adeba5f4/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-0a300e27").then(t)}},{path:"/pages/ca89eca8adeba5f4/index.html",redirect:"/pages/ca89eca8adeba5f4/"},{path:"/ãES6 æç¨ãç¬è®°/04.å­ç¬¦ä¸²çæ©å±.html",redirect:"/pages/ca89eca8adeba5f4/"},{name:"v-1f5f8d8a",path:"/pages/02c86eb2792f3262/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-1f5f8d8a").then(t)}},{path:"/pages/02c86eb2792f3262/index.html",redirect:"/pages/02c86eb2792f3262/"},{path:"/ãES6 æç¨ãç¬è®°/12.Symbol.html",redirect:"/pages/02c86eb2792f3262/"},{name:"v-2ec63a50",path:"/pages/0c21dae358fca16b/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-2ec63a50").then(t)}},{path:"/pages/0c21dae358fca16b/index.html",redirect:"/pages/0c21dae358fca16b/"},{path:"/ãES6 æç¨ãç¬è®°/13.Set å Map æ°æ®ç»æ.html",redirect:"/pages/0c21dae358fca16b/"},{name:"v-7055771a",path:"/pages/f56ec2ab97d60483/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-7055771a").then(t)}},{path:"/pages/f56ec2ab97d60483/index.html",redirect:"/pages/f56ec2ab97d60483/"},{path:"/ãES6 æç¨ãç¬è®°/14.Proxy.html",redirect:"/pages/f56ec2ab97d60483/"},{name:"v-20b8f620",path:"/pages/718b48ed9ce0adce/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-20b8f620").then(t)}},{path:"/pages/718b48ed9ce0adce/index.html",redirect:"/pages/718b48ed9ce0adce/"},{path:"/ãES6 æç¨ãç¬è®°/18.Generator å½æ°çè¯­æ³.html",redirect:"/pages/718b48ed9ce0adce/"},{name:"v-1bbe4ea2",path:"/pages/75af7031eb66847b/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-1bbe4ea2").then(t)}},{path:"/pages/75af7031eb66847b/index.html",redirect:"/pages/75af7031eb66847b/"},{path:"/ãES6 æç¨ãç¬è®°/19.Generator å½æ°çå¼æ­¥åºç¨.html",redirect:"/pages/75af7031eb66847b/"},{name:"v-f6e3cecc",path:"/pages/74de3e45e4491e95/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-f6e3cecc").then(t)}},{path:"/pages/74de3e45e4491e95/index.html",redirect:"/pages/74de3e45e4491e95/"},{path:"/ãES6 æç¨ãç¬è®°/15.Reflect.html",redirect:"/pages/74de3e45e4491e95/"},{name:"v-4685ff34",path:"/pages/3777253e65bac487/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-4685ff34").then(t)}},{path:"/pages/3777253e65bac487/index.html",redirect:"/pages/3777253e65bac487/"},{path:"/ãES6 æç¨ãç¬è®°/20.async å½æ°.html",redirect:"/pages/3777253e65bac487/"},{name:"v-44d2c0fc",path:"/pages/83f8c3a0cd87dd83/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-44d2c0fc").then(t)}},{path:"/pages/83f8c3a0cd87dd83/index.html",redirect:"/pages/83f8c3a0cd87dd83/"},{path:"/ãES6 æç¨ãç¬è®°/22.Class çç»§æ¿.html",redirect:"/pages/83f8c3a0cd87dd83/"},{name:"v-73e6fcbe",path:"/pages/e831e1593c82bbe0/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-73e6fcbe").then(t)}},{path:"/pages/e831e1593c82bbe0/index.html",redirect:"/pages/e831e1593c82bbe0/"},{path:"/ãES6 æç¨ãç¬è®°/21.Class çåºæ¬è¯­æ³.html",redirect:"/pages/e831e1593c82bbe0/"},{name:"v-ad45f6fa",path:"/pages/efe2fb04eb8ac5fb/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-ad45f6fa").then(t)}},{path:"/pages/efe2fb04eb8ac5fb/index.html",redirect:"/pages/efe2fb04eb8ac5fb/"},{path:"/ãES6 æç¨ãç¬è®°/23.Module çè¯­æ³.html",redirect:"/pages/efe2fb04eb8ac5fb/"},{name:"v-25827231",path:"/pages/a79ca2e64ceae213/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-25827231").then(t)}},{path:"/pages/a79ca2e64ceae213/index.html",redirect:"/pages/a79ca2e64ceae213/"},{path:"/ãES6 æç¨ãç¬è®°/24.Module çå è½½å®ç°.html",redirect:"/pages/a79ca2e64ceae213/"},{name:"v-092c0610",path:"/pages/984bf549204bb266/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-092c0610").then(t)}},{path:"/pages/984bf549204bb266/index.html",redirect:"/pages/984bf549204bb266/"},{path:"/ãES6 æç¨ãç¬è®°/25.ç¼ç¨é£æ ¼.html",redirect:"/pages/984bf549204bb266/"},{name:"v-31cb3fe6",path:"/pages/16121351be68691b/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-31cb3fe6").then(t)}},{path:"/pages/16121351be68691b/index.html",redirect:"/pages/16121351be68691b/"},{path:"/ãES6 æç¨ãç¬è®°/27.å¼æ­¥éåå¨.html",redirect:"/pages/16121351be68691b/"},{name:"v-6145bf5a",path:"/pages/a2ba314746bfdbdd/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-6145bf5a").then(t)}},{path:"/pages/a2ba314746bfdbdd/index.html",redirect:"/pages/a2ba314746bfdbdd/"},{path:"/ãES6 æç¨ãç¬è®°/28.ArrayBuffer.html",redirect:"/pages/a2ba314746bfdbdd/"},{name:"v-733dba34",path:"/pages/7188882b8d65af1b/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-733dba34").then(t)}},{path:"/pages/7188882b8d65af1b/index.html",redirect:"/pages/7188882b8d65af1b/"},{path:"/ãES6 æç¨ãç¬è®°/29.ææ°ææ¡.html",redirect:"/pages/7188882b8d65af1b/"},{name:"v-3b44ff9b",path:"/pages/e97bc1e5626b082c/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-3b44ff9b").then(t)}},{path:"/pages/e97bc1e5626b082c/index.html",redirect:"/pages/e97bc1e5626b082c/"},{path:"/ãES6 æç¨ãç¬è®°/30.è£é¥°å¨.html",redirect:"/pages/e97bc1e5626b082c/"},{name:"v-4248c6f3",path:"/pages/32c35f7651d6e58e/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-4248c6f3").then(t)}},{path:"/pages/32c35f7651d6e58e/index.html",redirect:"/pages/32c35f7651d6e58e/"},{path:"/ãES6 æç¨ãç¬è®°/26.è¯»æ ECMAScript è§æ ¼.html",redirect:"/pages/32c35f7651d6e58e/"},{name:"v-0bfabf3c",path:"/pages/1cf50330655efc69/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-0bfabf3c").then(t)}},{path:"/pages/1cf50330655efc69/index.html",redirect:"/pages/1cf50330655efc69/"},{path:"/ãES6 æç¨ãç¬è®°/31.å½æ°å¼ç¼ç¨.html",redirect:"/pages/1cf50330655efc69/"},{name:"v-8b56fb8c",path:"/pages/6a8e2dc558da1b39/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-8b56fb8c").then(t)}},{path:"/pages/6a8e2dc558da1b39/index.html",redirect:"/pages/6a8e2dc558da1b39/"},{path:"/ãES6 æç¨ãç¬è®°/32.Mixin.html",redirect:"/pages/6a8e2dc558da1b39/"},{name:"v-07dc7dde",path:"/pages/8e8f80f69b775a56/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-07dc7dde").then(t)}},{path:"/pages/8e8f80f69b775a56/index.html",redirect:"/pages/8e8f80f69b775a56/"},{path:"/ãES6 æç¨ãç¬è®°/33.SIMD.html",redirect:"/pages/8e8f80f69b775a56/"},{name:"v-21627c86",path:"/pages/ea6f3b870f6dab69/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-21627c86").then(t)}},{path:"/pages/ea6f3b870f6dab69/index.html",redirect:"/pages/ea6f3b870f6dab69/"},{path:"/ãES6 æç¨ãç¬è®°/34.åèé¾æ¥.html",redirect:"/pages/ea6f3b870f6dab69/"},{name:"v-16bacf9d",path:"/pages/8292d8/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-16bacf9d").then(t)}},{path:"/pages/8292d8/index.html",redirect:"/pages/8292d8/"},{path:"/ãGitãå­¦ä¹ ç¬è®°/10.æå/00.å¸¸ç¨Gitå½ä»¤æ¸å.html",redirect:"/pages/8292d8/"},{name:"v-720d8224",path:"/pages/4cbc21/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-720d8224").then(t)}},{path:"/pages/4cbc21/index.html",redirect:"/pages/4cbc21/"},{path:"/ãGitãå­¦ä¹ ç¬è®°/10.æå/06.Gitå½ä»¤æç»´å¯¼å¾.html",redirect:"/pages/4cbc21/"},{name:"v-52f1734b",path:"/pages/c10281/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-52f1734b").then(t)}},{path:"/pages/c10281/index.html",redirect:"/pages/c10281/"},{path:"/ãGitãå­¦ä¹ ç¬è®°/10.æå/03.Gitååºåå¹¶.html",redirect:"/pages/c10281/"},{name:"v-449301a8",path:"/pages/4bdb82/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-449301a8").then(t)}},{path:"/pages/4bdb82/index.html",redirect:"/pages/4bdb82/"},{path:"/ãGitãå­¦ä¹ ç¬è®°/10.æå/07.æ¹åç§å¤§è®¡ç®æºç½ç».html",redirect:"/pages/4bdb82/"},{name:"v-364e812a",path:"/pages/635088/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-364e812a").then(t)}},{path:"/pages/635088/index.html",redirect:"/pages/635088/"},{path:"/ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/10.Gitåºç¡ä¸å½ä»¤.html",redirect:"/pages/635088/"},{name:"v-0dd61c07",path:"/pages/1832fe/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-0dd61c07").then(t)}},{path:"/pages/1832fe/index.html",redirect:"/pages/1832fe/"},{path:"/ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/100.Gitå·¥å·-éååå².html",redirect:"/pages/1832fe/"},{name:"v-59177494",path:"/pages/4bef1a/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-59177494").then(t)}},{path:"/pages/4bef1a/index.html",redirect:"/pages/4bef1a/"},{path:"/ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/20.Gitåæ¯-åæ¯åç.html",redirect:"/pages/4bef1a/"},{name:"v-7c3437ac",path:"/pages/ea5a8c/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-7c3437ac").then(t)}},{path:"/pages/ea5a8c/index.html",redirect:"/pages/ea5a8c/"},{path:"/ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/30.Gitåæ¯çæ°å»ºä¸åå¹¶-åæ¯æä½.html",redirect:"/pages/ea5a8c/"},{name:"v-60ad1438",path:"/pages/a399b3/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-60ad1438").then(t)}},{path:"/pages/a399b3/index.html",redirect:"/pages/a399b3/"},{path:"/ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/40.Gitåæ¯ç®¡ç-æ¥çåæ¯.html",redirect:"/pages/a399b3/"},{name:"v-42d161dc",path:"/pages/49ee30/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-42d161dc").then(t)}},{path:"/pages/49ee30/index.html",redirect:"/pages/49ee30/"},{path:"/ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/50.Gitåæ¯å¼åå·¥ä½æµ.html",redirect:"/pages/49ee30/"},{name:"v-92c363a2",path:"/pages/d9e9c6/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-92c363a2").then(t)}},{path:"/pages/d9e9c6/index.html",redirect:"/pages/d9e9c6/"},{path:"/ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/110.Gitå·¥å·-éç½®æ­å¯.html",redirect:"/pages/d9e9c6/"},{name:"v-1d730a99",path:"/pages/574d62/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-1d730a99").then(t)}},{path:"/pages/574d62/index.html",redirect:"/pages/574d62/"},{path:"/ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/60.Gitåæ¯-è¿ç¨åæ¯.html",redirect:"/pages/574d62/"},{name:"v-34d42a50",path:"/pages/c984d1/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-34d42a50").then(t)}},{path:"/pages/c984d1/index.html",redirect:"/pages/c984d1/"},{path:"/ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/80.Gitå·¥å·-æ¥çä¿®è®¢çæ¬.html",redirect:"/pages/c984d1/"},{name:"v-546fd54a",path:"/pages/3a3247/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-546fd54a").then(t)}},{path:"/pages/3a3247/index.html",redirect:"/pages/3a3247/"},{path:"/ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/70.Gitåæ¯-ååº.html",redirect:"/pages/3a3247/"},{name:"v-03537083",path:"/pages/76d859/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-03537083").then(t)}},{path:"/pages/76d859/index.html",redirect:"/pages/76d859/"},{path:"/ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/90.Gitå·¥å·-äº¤äºå¼æå­.html",redirect:"/pages/76d859/"},{name:"v-51ad7edb",path:"/pages/2810ae8985e9bd52/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-51ad7edb").then(t)}},{path:"/pages/2810ae8985e9bd52/index.html",redirect:"/pages/2810ae8985e9bd52/"},{path:"/ãES6 æç¨ãç¬è®°/16.Promise å¯¹è±¡.html",redirect:"/pages/2810ae8985e9bd52/"},{name:"v-584aa1ec",path:"/pages/48df907ad3570f3d/",component:al,beforeEnter:function(n,e,t){Ji("Layout","v-584aa1ec").then(t)}},{path:"/pages/48df907ad3570f3d/index.html",redirect:"/pages/48df907ad3570f3d/"},{path:"/ãES6 æç¨ãç¬è®°/17.Iterator å for-of å¾ªç¯.html",redirect:"/pages/48df907ad3570f3d/"},{path:"*",component:al}],sl={title:"",description:"",base:"/",headTags:[["link",{rel:"icon",href:"/img/favicon.ico"}],["meta",{name:"keywords",content:"åç«¯åå®¢,ä¸ªäººææ¯åå®¢,åç«¯,åç«¯å¼å,åç«¯æ¡æ¶,webåç«¯,åç«¯é¢è¯é¢,ææ¯ææ¡£,å­¦ä¹ ,é¢è¯,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown"}],["meta",{name:"baidu-site-verification",content:"7F55weZDDc"}],["meta",{name:"theme-color",content:"#11a8cd"}]],pages:[{title:"é¢è¯",frontmatter:{pageComponent:{name:"Catalogue",data:{key:"35.é¢è¯",imgUrl:"/img/web.png",description:"é¢è¯æå"}},title:"é¢è¯",date:"2020-03-11T21:50:53.000Z",permalink:"/interview",sidebar:!1,article:!0,comment:!1,editLink:!1},regularPath:"/00.%E7%9B%AE%E5%BD%95%E9%A1%B5/50.%E9%9D%A2%E8%AF%95.html",relativePath:"00.ç®å½é¡µ/50.é¢è¯.md",key:"v-1df4d616",path:"/interview/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/8a3d2e/"},regularPath:"/05.Java/05.Java%E5%9F%BA%E7%A1%80/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"05.Java/05.Javaåºç¡/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-10284f70",path:"/pages/8a3d2e/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/14d613/"},regularPath:"/05.Java/15.Java%E8%99%9A%E6%8B%9F%E6%9C%BA/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"05.Java/15.Javaèææº/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-27875be3",path:"/pages/14d613/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/101235/"},regularPath:"/05.Java/20.JDK%E6%96%B0%E7%89%B9%E6%80%A7/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"05.Java/20.JDKæ°ç¹æ§/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-326b4e84",path:"/pages/101235/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/b9843d/"},regularPath:"/05.Java/25.Java%20Web/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"05.Java/25.Java Web/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-223d701a",path:"/pages/b9843d/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/48f257/"},regularPath:"/05.Java/30.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"05.Java/30.æ°æ®ç»æåç®æ³/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-7d49cd87",path:"/pages/48f257/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/f9d65e/"},regularPath:"/05.Java/35.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"05.Java/35.è®¡ç®æºç½ç»/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-130f5d29",path:"/pages/f9d65e/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/d4d364/"},regularPath:"/10.%E6%A1%86%E6%9E%B6/05.Spring/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"10.æ¡æ¶/05.Spring/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-17af0f12",path:"/pages/d4d364/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/72f279/"},regularPath:"/10.%E6%A1%86%E6%9E%B6/10.Spring%20MVC/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"10.æ¡æ¶/10.Spring MVC/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-5621ad6f",path:"/pages/72f279/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/815499/"},regularPath:"/10.%E6%A1%86%E6%9E%B6/15.Spring%20Boot/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"10.æ¡æ¶/15.Spring Boot/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-120fd95f",path:"/pages/815499/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/616956/"},regularPath:"/05.Java/10.Java%E5%B9%B6%E5%8F%91/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"05.Java/10.Javaå¹¶å/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-3ef46c3e",path:"/pages/616956/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/82b6d4/"},regularPath:"/10.%E6%A1%86%E6%9E%B6/20.Spring%20Cloud/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"10.æ¡æ¶/20.Spring Cloud/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-20167b32",path:"/pages/82b6d4/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-04T10:02:50.000Z",permalink:"/pages/075df8/",categories:["æ¡æ¶","Spring Cloud Alibaba"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/21.Spring%20Cloud%20Alibaba/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"10.æ¡æ¶/21.Spring Cloud Alibaba/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-061159fa",path:"/pages/075df8/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ãèå¾ãSpring Security(ä¸) ââ Architecture Overview",frontmatter:{title:"ãèå¾ãSpring Security(ä¸) ââ Architecture Overview",date:"2022-02-03T00:03:27.000Z",permalink:"/pages/c55839/",categories:["åç«¯","Spring Security"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/25.Spring%20Security/01.%E3%80%90%E8%80%81%E5%BE%90%E3%80%91Spring%20Security(%E4%B8%80)%20%E2%80%94%E2%80%94%20Architecture%20Overview.html",relativePath:"10.æ¡æ¶/25.Spring Security/01.ãèå¾ãSpring Security(ä¸) ââ Architecture Overview.md",key:"v-2b0b1b3e",path:"/pages/c55839/",headers:[{level:3,title:"1.1 SecurityContextHolder",slug:"_1-1-securitycontextholder",normalizedTitle:"1.1 securitycontextholder",charIndex:743},{level:3,title:"1.2 Authentication",slug:"_1-2-authentication",normalizedTitle:"1.2 authentication",charIndex:1676},{level:3,title:"1.3 AuthenticationManager",slug:"_1-3-authenticationmanager",normalizedTitle:"1.3 authenticationmanager",charIndex:5220},{level:3,title:"1.4 DaoAuthenticationProvider",slug:"_1-4-daoauthenticationprovider",normalizedTitle:"1.4 daoauthenticationprovider",charIndex:8209},{level:3,title:"1.5 UserDetailsä¸UserDetailsService",slug:"_1-5-userdetailsä¸userdetailsservice",normalizedTitle:"1.5 userdetailsä¸userdetailsservice",charIndex:9001},{level:3,title:"1.6 æ¶ææ¦è§å¾",slug:"_1-6-æ¶ææ¦è§å¾",normalizedTitle:"1.6 æ¶ææ¦è§å¾",charIndex:10207}],headersStr:"1.1 SecurityContextHolder 1.2 Authentication 1.3 AuthenticationManager 1.4 DaoAuthenticationProvider 1.5 UserDetailsä¸UserDetailsService 1.6 æ¶ææ¦è§å¾",content:' * 1 æ ¸å¿ç»ä»¶\n\n----------------------------------------\n\n----------------------------------------\n\nä¸ç´ä»¥æ¥æé½æ³åä¸åSpring Securityç³»åçæç« ï¼ä½æ¯æ´ä¸ªSpring Securityä½ç³»å¼ºå¤§å´åç¹æãééç»­ç»­ä»æå¼å§çguidesæ¥è§¦å®ï¼å°é¡¹ç®ä¸­çäºä¸äºæºç ï¼å°æè¿è¿ä¸ªæä¸ºäºåä¸åè¿ä¸ªç³»åçæç« ï¼éè¯»äºå¥½å éææ¡£ï¼æç»æç®å°è¯ä¸ä¸ï¼åä¸ä¸ªè¾ä¸ºå®æ´çç³»åæç« ã\n\nè¾ä¸ºç®åæèä½éè¾å°çææ¯ï¼å®å¨å¯ä»¥åèçdemoç´æ¥ä¸æï¼ä½ç³»ç»çå­¦ä¹ ä¸é¨ææ¯åä¸ç¶ãä»¥æçè®¤ç¥ï¼ä¸è¬çææ¡£å¤§è´æä¸¤ç§é£æ ¼ï¼Architecture FirståCode Firstãåèè´åäºè®©è¯»èåäºè§£æ´ä½çæ¶æï¼æ¹ä¾¿æä»¬å¯¹èªå·±çè®¤ç¥æä¸ä¸ªå®è§çææ§ï¼èåèä»¥ç¹å®çdemoéåè®²è§£ï¼å¯ä»¥è®©è¯»èå¨è§£å³é®é¢çè¿ç¨ä¸­é¡ºä¾¿ææ¡ä¸é¨ææ¯ãå³æ³¨è¿æåå®¢æèå¬ä¼å·çæåä¼åç°ï¼æä¹åä»ç»ææ¯çæç« ï¼å¤§å¤æ°æ¯Code Firstï¼æåºä¸ä¸ªéæ±ï¼ä»ç»ä¸ä¸ªæè·¯ï¼è§£å³ä¸ä¸ªé®é¢ï¼åæä¸ä¸æºç ï¼å¤§å¤å¦æ­¤ãèå­¦ä¹ ä¸ä¸ªä½ç³»çææ¯ï¼ææ¨èArchitecture Firstï¼æ­£å¦æ¬ææ é¢æè¨ï¼è¿ç¯æç« æ¯æSpring Securityç³»åçç¬¬ä¸ç¯ï¼ä¸»è¦æ¯æ ¹æ®Spring Securityææ¡£éæ©æ§ç¿»è¯æ´çèæçä¸ä¸ªæ¶ææ¦è§ï¼éåèªå·±çä¸äºæ³¨éæ¹ä¾¿å¤§å®¶çè§£ãåä½æ¬ç³»åæç« æ¶ï¼åèçæ¬ä¸ºSpring Security 4.2.3.RELEASEã\n\n\n# 1 æ ¸å¿ç»ä»¶\n\nè¿ä¸èä¸»è¦ä»ç»ä¸äºå¨Spring Securityä¸­å¸¸è§ä¸æ ¸å¿çJavaç±»ï¼å®ä»¬ä¹é´çä¾èµï¼æå»ºèµ·äºæ´ä¸ªæ¡æ¶ãæ³è¦çè§£æ´ä¸ªæ¶æï¼æèµ·ç å¾å¯¹è¿äºç±»ç¼çã\n\n\n# 1.1 SecurityContextHolder\n\nSecurityContextHolderç¨äºå­å¨å®å¨ä¸ä¸æï¼security contextï¼çä¿¡æ¯ãå½åæä½çç¨æ·æ¯è°ï¼è¯¥ç¨æ·æ¯å¦å·²ç»è¢«è®¤è¯ï¼ä»æ¥æåªäºè§è²æéâ¦è¿äºé½è¢«ä¿å­å¨SecurityContextHolderä¸­ãSecurityContextHolderé»è®¤ä½¿ç¨ThreadLocal ç­ç¥æ¥å­å¨è®¤è¯ä¿¡æ¯ãçå°ThreadLocal ä¹å°±æå³çï¼è¿æ¯ä¸ç§ä¸çº¿ç¨ç»å®çç­ç¥ãSpring Securityå¨ç¨æ·ç»å½æ¶èªå¨ç»å®è®¤è¯ä¿¡æ¯å°å½åçº¿ç¨ï¼å¨ç¨æ·éåºæ¶ï¼èªå¨æ¸é¤å½åçº¿ç¨çè®¤è¯ä¿¡æ¯ãä½è¿ä¸åçåæï¼æ¯ä½ å¨webåºæ¯ä¸ä½¿ç¨Spring Securityï¼èå¦ææ¯Swingçé¢ï¼Springä¹æä¾äºæ¯æï¼SecurityContextHolderçç­ç¥åéè¦è¢«æ¿æ¢ï¼é´äºæçåè¡·æ¯åºäºwebæ¥ä»ç»Spring Securityï¼æä»¥è¿éä»¥ååç»­ï¼éwebçç¸å³çåå®¹é½ä¸ç¬å¸¦è¿ã\n\n# è·åå½åç¨æ·çä¿¡æ¯\n\nå ä¸ºèº«ä»½ä¿¡æ¯æ¯ä¸çº¿ç¨ç»å®çï¼æä»¥å¯ä»¥å¨ç¨åºçä»»ä½å°æ¹ä½¿ç¨éææ¹æ³è·åç¨æ·ä¿¡æ¯ãä¸ä¸ªå¸åçè·åå½åç»å½ç¨æ·çå§åçä¾å­å¦ä¸æç¤ºï¼\n\nObject principal = SecurityContextHolder.getContext().getAuthentication().getPrincipal();\n\nif (principal instanceof UserDetails) {\n    String username = ((UserDetails)principal).getUsername();\n} else {\n    String username = principal.toString();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\ngetAuthentication()è¿åäºè®¤è¯ä¿¡æ¯ï¼åæ¬¡getPrincipal()è¿åäºèº«ä»½ä¿¡æ¯ï¼UserDetailsä¾¿æ¯Springå¯¹èº«ä»½ä¿¡æ¯å°è£çä¸ä¸ªæ¥å£ãAuthenticationåUserDetailsçä»ç»å¨ä¸é¢çå°èå·ä½è®²è§£ï¼æ¬èéè¦çåå®¹æ¯ä»ç»SecurityContextHolderè¿ä¸ªå®¹å¨ã\n\n\n# 1.2 Authentication\n\nåççè¿ä¸ªæ¥å£çæºç é¿ä»ä¹æ ·ï¼\n\npackage org.springframework.security.core;// <1>\n\npublic interface Authentication extends Principal, Serializable { // <1>\n    \n    Collection<? extends GrantedAuthority> getAuthorities(); // <2>\n\n    Object getCredentials();// <2>\n\n    Object getDetails();// <2>\n\n    Object getPrincipal();// <2>\n\n    boolean isAuthenticated();// <2>\n\n    void setAuthenticated(boolean var1) throws IllegalArgumentException;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n<1> Authenticationæ¯spring securityåä¸­çæ¥å£ï¼ç´æ¥ç»§æ¿èªPrincipalç±»ï¼èPrincipalæ¯ä½äºjava.securityåä¸­çãå¯ä»¥è§å¾ï¼Authenticationå¨spring securityä¸­æ¯æé«çº§å«çèº«ä»½/è®¤è¯çæ½è±¡ã\n\n<2> ç±è¿ä¸ªé¡¶çº§æ¥å£ï¼æä»¬å¯ä»¥å¾å°ç¨æ·æ¥æçæéä¿¡æ¯åè¡¨ï¼å¯ç ï¼ç¨æ·ç»èä¿¡æ¯ï¼ç¨æ·èº«ä»½ä¿¡æ¯ï¼è®¤è¯ä¿¡æ¯ã\n\nè¿è®°å¾1.1èä¸­ï¼authentication.getPrincipal()è¿åäºä¸ä¸ªObjectï¼æä»¬å°Principalå¼ºè½¬æäºSpring Securityä¸­æå¸¸ç¨çUserDetailsï¼è¿å¨Spring Securityä¸­éå¸¸å¸¸è§ï¼æ¥å£è¿åObjectï¼ä½¿ç¨instanceofå¤æ­ç±»åï¼å¼ºè½¬æå¯¹åºçå·ä½å®ç°ç±»ãæ¥å£è¯¦ç»è§£è¯»å¦ä¸ï¼\n\n * getAuthorities()ï¼æéä¿¡æ¯åè¡¨ï¼é»è®¤æ¯GrantedAuthorityæ¥å£çä¸äºå®ç°ç±»ï¼éå¸¸æ¯ä»£è¡¨æéä¿¡æ¯çä¸ç³»åå­ç¬¦ä¸²ã\n * getCredentials()ï¼å¯ç ä¿¡æ¯ï¼ç¨æ·è¾å¥çå¯ç å­ç¬¦ä¸²ï¼å¨è®¤è¯è¿åéå¸¸ä¼è¢«ç§»é¤ï¼ç¨äºä¿éå®å¨ã\n * getDetails()ï¼ç»èä¿¡æ¯ï¼webåºç¨ä¸­çå®ç°æ¥å£éå¸¸ä¸º WebAuthenticationDetailsï¼å®è®°å½äºè®¿é®èçipå°ååsessionIdçå¼ã\n * getPrincipal()ï¼æ²é»æ¿ï¼ï¼ï¼æéè¦çèº«ä»½ä¿¡æ¯ï¼å¤§é¨åæåµä¸è¿åçæ¯UserDetailsæ¥å£çå®ç°ç±»ï¼ä¹æ¯æ¡æ¶ä¸­çå¸¸ç¨æ¥å£ä¹ä¸ãUserDetailsæ¥å£å°ä¼å¨ä¸é¢çå°èéç¹ä»ç»ã\n\n# Spring Securityæ¯å¦ä½å®æèº«ä»½è®¤è¯çï¼\n\n1 ç¨æ·ååå¯ç è¢«è¿æ»¤å¨è·åå°ï¼å°è£æAuthentication,éå¸¸æåµä¸æ¯UsernamePasswordAuthenticationTokenè¿ä¸ªå®ç°ç±»ã\n\n2 AuthenticationManager èº«ä»½ç®¡çå¨è´è´£éªè¯è¿ä¸ªAuthentication\n\n3 è®¤è¯æååï¼AuthenticationManagerèº«ä»½ç®¡çå¨è¿åä¸ä¸ªè¢«å¡«åæ»¡äºä¿¡æ¯çï¼åæ¬ä¸é¢æå°çæéä¿¡æ¯ï¼èº«ä»½ä¿¡æ¯ï¼ç»èä¿¡æ¯ï¼ä½å¯ç éå¸¸ä¼è¢«ç§»é¤ï¼Authenticationå®ä¾ã\n\n4 SecurityContextHolderå®å¨ä¸ä¸æå®¹å¨å°ç¬¬3æ­¥å¡«åäºä¿¡æ¯çAuthenticationï¼éè¿SecurityContextHolder.getContext().setAuthentication(â¦)æ¹æ³ï¼è®¾ç½®å°å¶ä¸­ã\n\nè¿æ¯ä¸ä¸ªæ½è±¡çè®¤è¯æµç¨ï¼èæ´ä¸ªè¿ç¨ä¸­ï¼å¦æä¸çº ç»äºç»èï¼å¶å®åªå©ä¸ä¸ä¸ªAuthenticationManager æ¯æä»¬æ²¡ææ¥è§¦è¿çäºï¼è¿ä¸ªèº«ä»½ç®¡çå¨æä»¬å¨åé¢çå°èä»ç»ãå°ä¸è¿°çæµç¨è½¬æ¢æä»£ç ï¼ä¾¿æ¯å¦ä¸çæµç¨ï¼\n\npublic class AuthenticationExample {\nprivate static AuthenticationManager am = new SampleAuthenticationManager();\n\npublic static void main(String[] args) throws Exception {\n\tBufferedReader in = new BufferedReader(new InputStreamReader(System.in));\n\n\twhile(true) {\n        System.out.println("Please enter your username:");\n        String name = in.readLine();\n        System.out.println("Please enter your password:");\n        String password = in.readLine();\n        try {\n                Authentication request = new UsernamePasswordAuthenticationToken(name, password);\n                Authentication result = am.authenticate(request);\n                SecurityContextHolder.getContext().setAuthentication(result);\n                break;\n            } catch(AuthenticationException e) {\n                System.out.println("Authentication failed: " + e.getMessage());\n            }\n        }\n        System.out.println("Successfully authenticated. Security context contains: " +\n                SecurityContextHolder.getContext().getAuthentication());\n    }\n}\n\nclass SampleAuthenticationManager implements AuthenticationManager {\n    static final List<GrantedAuthority> AUTHORITIES = new ArrayList<GrantedAuthority>();\n\n    static {\n        AUTHORITIES.add(new SimpleGrantedAuthority("ROLE_USER"));\n    }\n\n    public Authentication authenticate(Authentication auth) throws AuthenticationException {\n        if (auth.getName().equals(auth.getCredentials())) {\n            return new UsernamePasswordAuthenticationToken(auth.getName(),\n                   auth.getCredentials(), AUTHORITIES);\n        }\n        throw new BadCredentialsException("Bad Credentials");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n\n\næ³¨æï¼ä¸è¿°è¿æ®µä»£ç åªæ¯ä¸ºäºè®©å¤§å®¶äºè§£Spring Securityçå·¥ä½æµç¨èåçï¼ä¸æ¯ä»ä¹æºç ãå¨å®éä½¿ç¨ä¸­ï¼æ´ä¸ªæµç¨ä¼åå¾æ´å çå¤æï¼ä½æ¯åºæ¬ææ³ï¼åä¸è¿°ä»£ç å¦åºä¸è¾ã\n\n\n# 1.3 AuthenticationManager\n\nåæ¬¡æ¥è§¦Spring Securityçæåç¸ä¿¡ä¼è¢«AuthenticationManagerï¼ProviderManager ï¼AuthenticationProvider â¦è¿ä¹å¤ç¸ä¼¼çSpringè®¤è¯ç±»æå¾æå¤´è½¬åï¼ä½åªè¦ç¨å¾®æ¢³çä¸ä¸å°±å¯ä»¥çè§£æ¸æ¥å®ä»¬çèç³»åè®¾è®¡èçç¨æãAuthenticationManagerï¼æ¥å£ï¼æ¯è®¤è¯ç¸å³çæ ¸å¿æ¥å£ï¼ä¹æ¯åèµ·è®¤è¯çåºåç¹ï¼å ä¸ºå¨å®ééæ±ä¸­ï¼æä»¬å¯è½ä¼åè®¸ç¨æ·ä½¿ç¨ç¨æ·å+å¯ç ç»å½ï¼åæ¶åè®¸ç¨æ·ä½¿ç¨é®ç®±+å¯ç ï¼ææºå·ç +å¯ç ç»å½ï¼çè³ï¼å¯è½åè®¸ç¨æ·ä½¿ç¨æçº¹ç»å½ï¼è¿æè¿æ ·çæä½ï¼æ²¡æ³å°å§ï¼ï¼æä»¥è¯´AuthenticationManagerä¸è¬ä¸ç´æ¥è®¤è¯ï¼AuthenticationManageræ¥å£çå¸¸ç¨å®ç°ç±»ProviderManager åé¨ä¼ç»´æ¤ä¸ä¸ªList<AuthenticationProvider>åè¡¨ï¼å­æ¾å¤ç§è®¤è¯æ¹å¼ï¼å®éä¸è¿æ¯å§æèæ¨¡å¼çåºç¨ï¼Delegateï¼ãä¹å°±æ¯è¯´ï¼æ ¸å¿çè®¤è¯å¥å£å§ç»åªæä¸ä¸ªï¼AuthenticationManagerï¼ä¸åçè®¤è¯æ¹å¼ï¼ç¨æ·å+å¯ç ï¼UsernamePasswordAuthenticationTokenï¼ï¼é®ç®±+å¯ç ï¼ææºå·ç +å¯ç ç»å½åå¯¹åºäºä¸ä¸ªAuthenticationProviderãè¿æ ·ä¸æ¥åä¸åå°±å¥½çè§£å¤äºï¼çæshiroçæåå¯ä»¥æAuthenticationProviderçè§£æRealmãå¨é»è®¤ç­ç¥ä¸ï¼åªéè¦éè¿ä¸ä¸ªAuthenticationProviderçè®¤è¯ï¼å³å¯è¢«è®¤ä¸ºæ¯ç»å½æåã\n\nåªä¿çäºå³é®è®¤è¯é¨åçProviderManageræºç ï¼\n\npublic class ProviderManager implements AuthenticationManager, MessageSourceAware,\n\t\tInitializingBean {\n\n    // ç»´æ¤ä¸ä¸ªAuthenticationProvideråè¡¨\n    private List<AuthenticationProvider> providers = Collections.emptyList();\n\n    public Authentication authenticate(Authentication authentication)\n          throws AuthenticationException {\n       Class<? extends Authentication> toTest = authentication.getClass();\n       AuthenticationException lastException = null;\n       Authentication result = null;\n\n       // ä¾æ¬¡è®¤è¯\n       for (AuthenticationProvider provider : getProviders()) {\n          if (!provider.supports(toTest)) {\n             continue;\n          }\n          try {\n             result = provider.authenticate(authentication);\n\n             if (result != null) {\n                copyDetails(authentication, result);\n                break;\n             }\n          }\n          ...\n          catch (AuthenticationException e) {\n             lastException = e;\n          }\n       }\n       // å¦ææAuthenticationä¿¡æ¯ï¼åç´æ¥è¿å\n       if (result != null) {\n\t\t\tif (eraseCredentialsAfterAuthentication\n\t\t\t\t\t&& (result instanceof CredentialsContainer)) {\n              \t //ç§»é¤å¯ç \n\t\t\t\t((CredentialsContainer) result).eraseCredentials();\n\t\t\t}\n             //åå¸ç»å½æåäºä»¶\n\t\t\teventPublisher.publishAuthenticationSuccess(result);\n\t\t\treturn result;\n\t   }\n\t   ...\n       //æ§è¡å°æ­¤ï¼è¯´ææ²¡æè®¤è¯æåï¼åè£å¼å¸¸ä¿¡æ¯\n       if (lastException == null) {\n          lastException = new ProviderNotFoundException(messages.getMessage(\n                "ProviderManager.providerNotFound",\n                new Object[] { toTest.getName() },\n                "No AuthenticationProvider found for {0}"));\n       }\n       prepareException(lastException, authentication);\n       throw lastException;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n\n\nProviderManager ä¸­çListï¼ä¼ä¾ç§æ¬¡åºå»è®¤è¯ï¼è®¤è¯æååç«å³è¿åï¼è¥è®¤è¯å¤±è´¥åè¿ånullï¼ä¸ä¸ä¸ªAuthenticationProviderä¼ç»§ç»­å°è¯è®¤è¯ï¼å¦æææè®¤è¯å¨é½æ æ³è®¤è¯æåï¼åProviderManager ä¼æåºä¸ä¸ªProviderNotFoundExceptionå¼å¸¸ã\n\nå°è¿éï¼å¦æä¸çº ç»äºAuthenticationProviderçå®ç°ç»èä»¥åå®å¨ç¸å³çè¿æ»¤å¨ï¼è®¤è¯ç¸å³çæ ¸å¿ç±»å¶å®é½å·²ç»ä»ç»å®æ¯äºï¼èº«ä»½ä¿¡æ¯çå­æ¾å®¹å¨SecurityContextHolderï¼èº«ä»½ä¿¡æ¯çæ½è±¡Authenticationï¼èº«ä»½è®¤è¯å¨AuthenticationManageråå¶è®¤è¯æµç¨ãå§ä¸å¨è¿éåä¸ä¸ªåéçº¿ãä¸é¢æ¥ä»ç»ä¸AuthenticationProvideræ¥å£çå·ä½å®ç°ã\n\n\n# 1.4 DaoAuthenticationProvider\n\nAuthenticationProvideræææå¸¸ç¨çä¸ä¸ªå®ç°ä¾¿æ¯DaoAuthenticationProviderãé¡¾åæä¹ï¼Daoæ­£æ¯æ°æ®è®¿é®å±çç¼©åï¼ä¹æç¤ºäºè¿ä¸ªèº«ä»½è®¤è¯å¨çå®ç°æè·¯ãç±äºæ¬ææ¯ä¸ä¸ªOverviewï¼å§ä¸åªç»åºå¶UMLç±»å¾ï¼\n\nDaoAuthenticationProvider UML\n\næç§æä»¬æç´è§çæè·¯ï¼æä¹å»è®¤è¯ä¸ä¸ªç¨æ·å¢ï¼ç¨æ·åå°æäº¤äºç¨æ·ååå¯ç ï¼èæ°æ®åºä¸­ä¿å­äºç¨æ·ååå¯ç ï¼è®¤è¯ä¾¿æ¯è´è´£æ¯å¯¹åä¸ä¸ªç¨æ·åï¼æäº¤çå¯ç åä¿å­çå¯ç æ¯å¦ç¸åä¾¿æ¯äºãå¨Spring Securityä¸­ãæäº¤çç¨æ·ååå¯ç ï¼è¢«å°è£æäºUsernamePasswordAuthenticationTokenï¼èæ ¹æ®ç¨æ·åå è½½ç¨æ·çä»»å¡åæ¯äº¤ç»äºUserDetailsServiceï¼å¨DaoAuthenticationProviderä¸­ï¼å¯¹åºçæ¹æ³ä¾¿æ¯retrieveUserï¼è½ç¶æä¸¤ä¸ªåæ°ï¼ä½æ¯retrieveUseråªæç¬¬ä¸ä¸ªåæ°èµ·ä¸»è¦ä½ç¨ï¼è¿åä¸ä¸ªUserDetailsãè¿éè¦å®æUsernamePasswordAuthenticationTokenåUserDetailså¯ç çæ¯å¯¹ï¼è¿ä¾¿æ¯äº¤ç»additionalAuthenticationChecksæ¹æ³å®æçï¼å¦æè¿ä¸ªvoidæ¹æ³æ²¡ææå¼å¸¸ï¼åè®¤ä¸ºæ¯å¯¹æåãæ¯å¯¹å¯ç çè¿ç¨ï¼ç¨å°äºPasswordEncoderåSaltSourceï¼å¯ç å å¯åççæ¦å¿µç¸ä¿¡ä¸ç¨æèµè¿°äºï¼å®ä»¬ä¸ºä¿éå®å¨èè®¾è®¡ï¼é½æ¯æ¯è¾åºç¡çæ¦å¿µã\n\nå¦æä½ å·²ç»è¢«è¿äºæ¦å¿µæå¾æå¤´è½¬åäºï¼ä¸å¦¨è¿ä¹çè§£DaoAuthenticationProviderï¼å®è·åç¨æ·æäº¤çç¨æ·ååå¯ç ï¼æ¯å¯¹å¶æ­£ç¡®æ§ï¼å¦ææ­£ç¡®ï¼è¿åä¸ä¸ªæ°æ®åºä¸­çç¨æ·ä¿¡æ¯ï¼åè®¾ç¨æ·ä¿¡æ¯è¢«ä¿å­å¨æ°æ®åºä¸­ï¼ã\n\n\n# 1.5 UserDetailsä¸UserDetailsService\n\nä¸é¢ä¸æ­æå°äºUserDetailsè¿ä¸ªæ¥å£ï¼å®ä»£è¡¨äºæè¯¦ç»çç¨æ·ä¿¡æ¯ï¼è¿ä¸ªæ¥å£æ¶µçäºä¸äºå¿è¦çç¨æ·ä¿¡æ¯å­æ®µï¼å·ä½çå®ç°ç±»å¯¹å®è¿è¡äºæ©å±ã\n\npublic interface UserDetails extends Serializable {\n\n   Collection<? extends GrantedAuthority> getAuthorities();\n\n   String getPassword();\n\n   String getUsername();\n\n   boolean isAccountNonExpired();\n\n   boolean isAccountNonLocked();\n\n   boolean isCredentialsNonExpired();\n\n   boolean isEnabled();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nå®åAuthenticationæ¥å£å¾ç±»ä¼¼ï¼æ¯å¦å®ä»¬é½æ¥æusernameï¼authoritiesï¼åºåä»ä»¬ä¹æ¯æ¬æçéç¹åå®¹ä¹ä¸ãAuthenticationçgetCredentials()ä¸UserDetailsä¸­çgetPassword()éè¦è¢«åºåå¯¹å¾ï¼åèæ¯ç¨æ·æäº¤çå¯ç å­è¯ï¼åèæ¯ç¨æ·æ­£ç¡®çå¯ç ï¼è®¤è¯å¨å¶å®å°±æ¯å¯¹è¿ä¸¤èçæ¯å¯¹ãAuthenticationä¸­çgetAuthorities()å®éæ¯ç±UserDetailsçgetAuthorities()ä¼ éèå½¢æçãè¿è®°å¾Authenticationæ¥å£ä¸­çgetUserDetails()æ¹æ³åï¼å¶ä¸­çUserDetailsç¨æ·è¯¦ç»ä¿¡æ¯ä¾¿æ¯ç»è¿äºAuthenticationProviderä¹åè¢«å¡«åçã\n\npublic interface UserDetailsService {\n   UserDetails loadUserByUsername(String username) throws UsernameNotFoundException;\n}\n\n\n1\n2\n3\n\n\nUserDetailsServiceåAuthenticationProviderä¸¤èçèè´£å¸¸å¸¸è¢«äººä»¬ææ··ï¼å³äºä»ä»¬çé®é¢å¨ææ¡£çFAQåissuesä¸­å±¡è§ä¸é²ãè®°ä½ä¸ç¹å³å¯ï¼æ²é»æ¿ï¼ï¼ï¼UserDetailsServiceåªè´è´£ä»ç¹å®çå°æ¹ï¼éå¸¸æ¯æ°æ®åºï¼å è½½ç¨æ·ä¿¡æ¯ï¼ä»æ­¤èå·²ï¼è®°ä½è¿ä¸ç¹ï¼å¯ä»¥é¿åèµ°å¾å¤å¼¯è·¯ãUserDetailsServiceå¸¸è§çå®ç°ç±»æJdbcDaoImplï¼InMemoryUserDetailsManagerï¼åèä»æ°æ®åºå è½½ç¨æ·ï¼åèä»åå­ä¸­å è½½ç¨æ·ï¼ä¹å¯ä»¥èªå·±å®ç°UserDetailsServiceï¼éå¸¸è¿æ´å çµæ´»ã\n\n\n# 1.6 æ¶ææ¦è§å¾\n\nä¸ºäºæ´å å½¢è±¡ççè§£ä¸è¿°æä»ç»çè¿äºæ ¸å¿ç±»ï¼éä¸ä¸å¼ æç§æççè§£ï¼æç»åºSpring Securityçä¸å¼ éå¸åçUMLå¾\n\n[](http://kirito.iocoder.cn/spring security architecture.png)æ¶ææ¦è§å¾\n\nå¦æå¯¹Spring Securityçè¿äºæ¦å¿µæå°çè§£ä¸è½ï¼ä¸ç¨æå¿ï¼å ä¸ºè¿æ¯Architecture Firstå¯¼è´çå¿ç¶ç»æï¼åè¿ä¸ªç¼çãåç»­çæç« ä¼ç§æCode Firstççå¿µï¼éç»­è¯¦ç»å°è®²è§£è¿äºå®ç°ç±»çä½¿ç¨åºæ¯ï¼æºç åæï¼ä»¥åæåºæ¬çï¼å¦ä½éç½®Spring Securityï¼å¨åé¢çæç« ä¸­å¯ä»¥ä¸æ¶ç¿»çè¿ç¯æç« ï¼æ¾å°å·ä½çç±»å¨æ´ä¸ªæ¶æä¸­æå¤çä½ç½®ï¼è¿ä¹æ¯æ¬ç¯æç« çå®ä½ãå¦å¤ï¼ä¸äºSpring Securityçè¿æ»¤å¨è¿æªåæ¬å¨æ¶ææ¦è§ä¸­ï¼å¦å°è¡¨åä¿¡æ¯åè£æUsernamePasswordAuthenticationTokençè¿æ»¤å¨ï¼èèå°è¿äºè½ç¶ä¹æ¯æ¶æçä¸é¨åï¼ä½æ¯çæ­£éåä»ä»¬çå¯è½æ§è¾å°ï¼æä»¥æç®æ¾å°åé¢çç« èè®²è§£ã',normalizedContent:' * 1 æ ¸å¿ç»ä»¶\n\n----------------------------------------\n\n----------------------------------------\n\nä¸ç´ä»¥æ¥æé½æ³åä¸åspring securityç³»åçæç« ï¼ä½æ¯æ´ä¸ªspring securityä½ç³»å¼ºå¤§å´åç¹æãééç»­ç»­ä»æå¼å§çguidesæ¥è§¦å®ï¼å°é¡¹ç®ä¸­çäºä¸äºæºç ï¼å°æè¿è¿ä¸ªæä¸ºäºåä¸åè¿ä¸ªç³»åçæç« ï¼éè¯»äºå¥½å éææ¡£ï¼æç»æç®å°è¯ä¸ä¸ï¼åä¸ä¸ªè¾ä¸ºå®æ´çç³»åæç« ã\n\nè¾ä¸ºç®åæèä½éè¾å°çææ¯ï¼å®å¨å¯ä»¥åèçdemoç´æ¥ä¸æï¼ä½ç³»ç»çå­¦ä¹ ä¸é¨ææ¯åä¸ç¶ãä»¥æçè®¤ç¥ï¼ä¸è¬çææ¡£å¤§è´æä¸¤ç§é£æ ¼ï¼architecture firståcode firstãåèè´åäºè®©è¯»èåäºè§£æ´ä½çæ¶æï¼æ¹ä¾¿æä»¬å¯¹èªå·±çè®¤ç¥æä¸ä¸ªå®è§çææ§ï¼èåèä»¥ç¹å®çdemoéåè®²è§£ï¼å¯ä»¥è®©è¯»èå¨è§£å³é®é¢çè¿ç¨ä¸­é¡ºä¾¿ææ¡ä¸é¨ææ¯ãå³æ³¨è¿æåå®¢æèå¬ä¼å·çæåä¼åç°ï¼æä¹åä»ç»ææ¯çæç« ï¼å¤§å¤æ°æ¯code firstï¼æåºä¸ä¸ªéæ±ï¼ä»ç»ä¸ä¸ªæè·¯ï¼è§£å³ä¸ä¸ªé®é¢ï¼åæä¸ä¸æºç ï¼å¤§å¤å¦æ­¤ãèå­¦ä¹ ä¸ä¸ªä½ç³»çææ¯ï¼ææ¨èarchitecture firstï¼æ­£å¦æ¬ææ é¢æè¨ï¼è¿ç¯æç« æ¯æspring securityç³»åçç¬¬ä¸ç¯ï¼ä¸»è¦æ¯æ ¹æ®spring securityææ¡£éæ©æ§ç¿»è¯æ´çèæçä¸ä¸ªæ¶ææ¦è§ï¼éåèªå·±çä¸äºæ³¨éæ¹ä¾¿å¤§å®¶çè§£ãåä½æ¬ç³»åæç« æ¶ï¼åèçæ¬ä¸ºspring security 4.2.3.releaseã\n\n\n# 1 æ ¸å¿ç»ä»¶\n\nè¿ä¸èä¸»è¦ä»ç»ä¸äºå¨spring securityä¸­å¸¸è§ä¸æ ¸å¿çjavaç±»ï¼å®ä»¬ä¹é´çä¾èµï¼æå»ºèµ·äºæ´ä¸ªæ¡æ¶ãæ³è¦çè§£æ´ä¸ªæ¶æï¼æèµ·ç å¾å¯¹è¿äºç±»ç¼çã\n\n\n# 1.1 securitycontextholder\n\nsecuritycontextholderç¨äºå­å¨å®å¨ä¸ä¸æï¼security contextï¼çä¿¡æ¯ãå½åæä½çç¨æ·æ¯è°ï¼è¯¥ç¨æ·æ¯å¦å·²ç»è¢«è®¤è¯ï¼ä»æ¥æåªäºè§è²æéâ¦è¿äºé½è¢«ä¿å­å¨securitycontextholderä¸­ãsecuritycontextholderé»è®¤ä½¿ç¨threadlocal ç­ç¥æ¥å­å¨è®¤è¯ä¿¡æ¯ãçå°threadlocal ä¹å°±æå³çï¼è¿æ¯ä¸ç§ä¸çº¿ç¨ç»å®çç­ç¥ãspring securityå¨ç¨æ·ç»å½æ¶èªå¨ç»å®è®¤è¯ä¿¡æ¯å°å½åçº¿ç¨ï¼å¨ç¨æ·éåºæ¶ï¼èªå¨æ¸é¤å½åçº¿ç¨çè®¤è¯ä¿¡æ¯ãä½è¿ä¸åçåæï¼æ¯ä½ å¨webåºæ¯ä¸ä½¿ç¨spring securityï¼èå¦ææ¯swingçé¢ï¼springä¹æä¾äºæ¯æï¼securitycontextholderçç­ç¥åéè¦è¢«æ¿æ¢ï¼é´äºæçåè¡·æ¯åºäºwebæ¥ä»ç»spring securityï¼æä»¥è¿éä»¥ååç»­ï¼éwebçç¸å³çåå®¹é½ä¸ç¬å¸¦è¿ã\n\n# è·åå½åç¨æ·çä¿¡æ¯\n\nå ä¸ºèº«ä»½ä¿¡æ¯æ¯ä¸çº¿ç¨ç»å®çï¼æä»¥å¯ä»¥å¨ç¨åºçä»»ä½å°æ¹ä½¿ç¨éææ¹æ³è·åç¨æ·ä¿¡æ¯ãä¸ä¸ªå¸åçè·åå½åç»å½ç¨æ·çå§åçä¾å­å¦ä¸æç¤ºï¼\n\nobject principal = securitycontextholder.getcontext().getauthentication().getprincipal();\n\nif (principal instanceof userdetails) {\n    string username = ((userdetails)principal).getusername();\n} else {\n    string username = principal.tostring();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\ngetauthentication()è¿åäºè®¤è¯ä¿¡æ¯ï¼åæ¬¡getprincipal()è¿åäºèº«ä»½ä¿¡æ¯ï¼userdetailsä¾¿æ¯springå¯¹èº«ä»½ä¿¡æ¯å°è£çä¸ä¸ªæ¥å£ãauthenticationåuserdetailsçä»ç»å¨ä¸é¢çå°èå·ä½è®²è§£ï¼æ¬èéè¦çåå®¹æ¯ä»ç»securitycontextholderè¿ä¸ªå®¹å¨ã\n\n\n# 1.2 authentication\n\nåççè¿ä¸ªæ¥å£çæºç é¿ä»ä¹æ ·ï¼\n\npackage org.springframework.security.core;// <1>\n\npublic interface authentication extends principal, serializable { // <1>\n    \n    collection<? extends grantedauthority> getauthorities(); // <2>\n\n    object getcredentials();// <2>\n\n    object getdetails();// <2>\n\n    object getprincipal();// <2>\n\n    boolean isauthenticated();// <2>\n\n    void setauthenticated(boolean var1) throws illegalargumentexception;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n<1> authenticationæ¯spring securityåä¸­çæ¥å£ï¼ç´æ¥ç»§æ¿èªprincipalç±»ï¼èprincipalæ¯ä½äºjava.securityåä¸­çãå¯ä»¥è§å¾ï¼authenticationå¨spring securityä¸­æ¯æé«çº§å«çèº«ä»½/è®¤è¯çæ½è±¡ã\n\n<2> ç±è¿ä¸ªé¡¶çº§æ¥å£ï¼æä»¬å¯ä»¥å¾å°ç¨æ·æ¥æçæéä¿¡æ¯åè¡¨ï¼å¯ç ï¼ç¨æ·ç»èä¿¡æ¯ï¼ç¨æ·èº«ä»½ä¿¡æ¯ï¼è®¤è¯ä¿¡æ¯ã\n\nè¿è®°å¾1.1èä¸­ï¼authentication.getprincipal()è¿åäºä¸ä¸ªobjectï¼æä»¬å°principalå¼ºè½¬æäºspring securityä¸­æå¸¸ç¨çuserdetailsï¼è¿å¨spring securityä¸­éå¸¸å¸¸è§ï¼æ¥å£è¿åobjectï¼ä½¿ç¨instanceofå¤æ­ç±»åï¼å¼ºè½¬æå¯¹åºçå·ä½å®ç°ç±»ãæ¥å£è¯¦ç»è§£è¯»å¦ä¸ï¼\n\n * getauthorities()ï¼æéä¿¡æ¯åè¡¨ï¼é»è®¤æ¯grantedauthorityæ¥å£çä¸äºå®ç°ç±»ï¼éå¸¸æ¯ä»£è¡¨æéä¿¡æ¯çä¸ç³»åå­ç¬¦ä¸²ã\n * getcredentials()ï¼å¯ç ä¿¡æ¯ï¼ç¨æ·è¾å¥çå¯ç å­ç¬¦ä¸²ï¼å¨è®¤è¯è¿åéå¸¸ä¼è¢«ç§»é¤ï¼ç¨äºä¿éå®å¨ã\n * getdetails()ï¼ç»èä¿¡æ¯ï¼webåºç¨ä¸­çå®ç°æ¥å£éå¸¸ä¸º webauthenticationdetailsï¼å®è®°å½äºè®¿é®èçipå°ååsessionidçå¼ã\n * getprincipal()ï¼æ²é»æ¿ï¼ï¼ï¼æéè¦çèº«ä»½ä¿¡æ¯ï¼å¤§é¨åæåµä¸è¿åçæ¯userdetailsæ¥å£çå®ç°ç±»ï¼ä¹æ¯æ¡æ¶ä¸­çå¸¸ç¨æ¥å£ä¹ä¸ãuserdetailsæ¥å£å°ä¼å¨ä¸é¢çå°èéç¹ä»ç»ã\n\n# spring securityæ¯å¦ä½å®æèº«ä»½è®¤è¯çï¼\n\n1 ç¨æ·ååå¯ç è¢«è¿æ»¤å¨è·åå°ï¼å°è£æauthentication,éå¸¸æåµä¸æ¯usernamepasswordauthenticationtokenè¿ä¸ªå®ç°ç±»ã\n\n2 authenticationmanager èº«ä»½ç®¡çå¨è´è´£éªè¯è¿ä¸ªauthentication\n\n3 è®¤è¯æååï¼authenticationmanagerèº«ä»½ç®¡çå¨è¿åä¸ä¸ªè¢«å¡«åæ»¡äºä¿¡æ¯çï¼åæ¬ä¸é¢æå°çæéä¿¡æ¯ï¼èº«ä»½ä¿¡æ¯ï¼ç»èä¿¡æ¯ï¼ä½å¯ç éå¸¸ä¼è¢«ç§»é¤ï¼authenticationå®ä¾ã\n\n4 securitycontextholderå®å¨ä¸ä¸æå®¹å¨å°ç¬¬3æ­¥å¡«åäºä¿¡æ¯çauthenticationï¼éè¿securitycontextholder.getcontext().setauthentication(â¦)æ¹æ³ï¼è®¾ç½®å°å¶ä¸­ã\n\nè¿æ¯ä¸ä¸ªæ½è±¡çè®¤è¯æµç¨ï¼èæ´ä¸ªè¿ç¨ä¸­ï¼å¦æä¸çº ç»äºç»èï¼å¶å®åªå©ä¸ä¸ä¸ªauthenticationmanager æ¯æä»¬æ²¡ææ¥è§¦è¿çäºï¼è¿ä¸ªèº«ä»½ç®¡çå¨æä»¬å¨åé¢çå°èä»ç»ãå°ä¸è¿°çæµç¨è½¬æ¢æä»£ç ï¼ä¾¿æ¯å¦ä¸çæµç¨ï¼\n\npublic class authenticationexample {\nprivate static authenticationmanager am = new sampleauthenticationmanager();\n\npublic static void main(string[] args) throws exception {\n\tbufferedreader in = new bufferedreader(new inputstreamreader(system.in));\n\n\twhile(true) {\n        system.out.println("please enter your username:");\n        string name = in.readline();\n        system.out.println("please enter your password:");\n        string password = in.readline();\n        try {\n                authentication request = new usernamepasswordauthenticationtoken(name, password);\n                authentication result = am.authenticate(request);\n                securitycontextholder.getcontext().setauthentication(result);\n                break;\n            } catch(authenticationexception e) {\n                system.out.println("authentication failed: " + e.getmessage());\n            }\n        }\n        system.out.println("successfully authenticated. security context contains: " +\n                securitycontextholder.getcontext().getauthentication());\n    }\n}\n\nclass sampleauthenticationmanager implements authenticationmanager {\n    static final list<grantedauthority> authorities = new arraylist<grantedauthority>();\n\n    static {\n        authorities.add(new simplegrantedauthority("role_user"));\n    }\n\n    public authentication authenticate(authentication auth) throws authenticationexception {\n        if (auth.getname().equals(auth.getcredentials())) {\n            return new usernamepasswordauthenticationtoken(auth.getname(),\n                   auth.getcredentials(), authorities);\n        }\n        throw new badcredentialsexception("bad credentials");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n\n\næ³¨æï¼ä¸è¿°è¿æ®µä»£ç åªæ¯ä¸ºäºè®©å¤§å®¶äºè§£spring securityçå·¥ä½æµç¨èåçï¼ä¸æ¯ä»ä¹æºç ãå¨å®éä½¿ç¨ä¸­ï¼æ´ä¸ªæµç¨ä¼åå¾æ´å çå¤æï¼ä½æ¯åºæ¬ææ³ï¼åä¸è¿°ä»£ç å¦åºä¸è¾ã\n\n\n# 1.3 authenticationmanager\n\nåæ¬¡æ¥è§¦spring securityçæåç¸ä¿¡ä¼è¢«authenticationmanagerï¼providermanager ï¼authenticationprovider â¦è¿ä¹å¤ç¸ä¼¼çspringè®¤è¯ç±»æå¾æå¤´è½¬åï¼ä½åªè¦ç¨å¾®æ¢³çä¸ä¸å°±å¯ä»¥çè§£æ¸æ¥å®ä»¬çèç³»åè®¾è®¡èçç¨æãauthenticationmanagerï¼æ¥å£ï¼æ¯è®¤è¯ç¸å³çæ ¸å¿æ¥å£ï¼ä¹æ¯åèµ·è®¤è¯çåºåç¹ï¼å ä¸ºå¨å®ééæ±ä¸­ï¼æä»¬å¯è½ä¼åè®¸ç¨æ·ä½¿ç¨ç¨æ·å+å¯ç ç»å½ï¼åæ¶åè®¸ç¨æ·ä½¿ç¨é®ç®±+å¯ç ï¼ææºå·ç +å¯ç ç»å½ï¼çè³ï¼å¯è½åè®¸ç¨æ·ä½¿ç¨æçº¹ç»å½ï¼è¿æè¿æ ·çæä½ï¼æ²¡æ³å°å§ï¼ï¼æä»¥è¯´authenticationmanagerä¸è¬ä¸ç´æ¥è®¤è¯ï¼authenticationmanageræ¥å£çå¸¸ç¨å®ç°ç±»providermanager åé¨ä¼ç»´æ¤ä¸ä¸ªlist<authenticationprovider>åè¡¨ï¼å­æ¾å¤ç§è®¤è¯æ¹å¼ï¼å®éä¸è¿æ¯å§æèæ¨¡å¼çåºç¨ï¼delegateï¼ãä¹å°±æ¯è¯´ï¼æ ¸å¿çè®¤è¯å¥å£å§ç»åªæä¸ä¸ªï¼authenticationmanagerï¼ä¸åçè®¤è¯æ¹å¼ï¼ç¨æ·å+å¯ç ï¼usernamepasswordauthenticationtokenï¼ï¼é®ç®±+å¯ç ï¼ææºå·ç +å¯ç ç»å½åå¯¹åºäºä¸ä¸ªauthenticationproviderãè¿æ ·ä¸æ¥åä¸åå°±å¥½çè§£å¤äºï¼çæshiroçæåå¯ä»¥æauthenticationproviderçè§£ærealmãå¨é»è®¤ç­ç¥ä¸ï¼åªéè¦éè¿ä¸ä¸ªauthenticationproviderçè®¤è¯ï¼å³å¯è¢«è®¤ä¸ºæ¯ç»å½æåã\n\nåªä¿çäºå³é®è®¤è¯é¨åçprovidermanageræºç ï¼\n\npublic class providermanager implements authenticationmanager, messagesourceaware,\n\t\tinitializingbean {\n\n    // ç»´æ¤ä¸ä¸ªauthenticationprovideråè¡¨\n    private list<authenticationprovider> providers = collections.emptylist();\n\n    public authentication authenticate(authentication authentication)\n          throws authenticationexception {\n       class<? extends authentication> totest = authentication.getclass();\n       authenticationexception lastexception = null;\n       authentication result = null;\n\n       // ä¾æ¬¡è®¤è¯\n       for (authenticationprovider provider : getproviders()) {\n          if (!provider.supports(totest)) {\n             continue;\n          }\n          try {\n             result = provider.authenticate(authentication);\n\n             if (result != null) {\n                copydetails(authentication, result);\n                break;\n             }\n          }\n          ...\n          catch (authenticationexception e) {\n             lastexception = e;\n          }\n       }\n       // å¦ææauthenticationä¿¡æ¯ï¼åç´æ¥è¿å\n       if (result != null) {\n\t\t\tif (erasecredentialsafterauthentication\n\t\t\t\t\t&& (result instanceof credentialscontainer)) {\n              \t //ç§»é¤å¯ç \n\t\t\t\t((credentialscontainer) result).erasecredentials();\n\t\t\t}\n             //åå¸ç»å½æåäºä»¶\n\t\t\teventpublisher.publishauthenticationsuccess(result);\n\t\t\treturn result;\n\t   }\n\t   ...\n       //æ§è¡å°æ­¤ï¼è¯´ææ²¡æè®¤è¯æåï¼åè£å¼å¸¸ä¿¡æ¯\n       if (lastexception == null) {\n          lastexception = new providernotfoundexception(messages.getmessage(\n                "providermanager.providernotfound",\n                new object[] { totest.getname() },\n                "no authenticationprovider found for {0}"));\n       }\n       prepareexception(lastexception, authentication);\n       throw lastexception;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n\n\nprovidermanager ä¸­çlistï¼ä¼ä¾ç§æ¬¡åºå»è®¤è¯ï¼è®¤è¯æååç«å³è¿åï¼è¥è®¤è¯å¤±è´¥åè¿ånullï¼ä¸ä¸ä¸ªauthenticationproviderä¼ç»§ç»­å°è¯è®¤è¯ï¼å¦æææè®¤è¯å¨é½æ æ³è®¤è¯æåï¼åprovidermanager ä¼æåºä¸ä¸ªprovidernotfoundexceptionå¼å¸¸ã\n\nå°è¿éï¼å¦æä¸çº ç»äºauthenticationproviderçå®ç°ç»èä»¥åå®å¨ç¸å³çè¿æ»¤å¨ï¼è®¤è¯ç¸å³çæ ¸å¿ç±»å¶å®é½å·²ç»ä»ç»å®æ¯äºï¼èº«ä»½ä¿¡æ¯çå­æ¾å®¹å¨securitycontextholderï¼èº«ä»½ä¿¡æ¯çæ½è±¡authenticationï¼èº«ä»½è®¤è¯å¨authenticationmanageråå¶è®¤è¯æµç¨ãå§ä¸å¨è¿éåä¸ä¸ªåéçº¿ãä¸é¢æ¥ä»ç»ä¸authenticationprovideræ¥å£çå·ä½å®ç°ã\n\n\n# 1.4 daoauthenticationprovider\n\nauthenticationprovideræææå¸¸ç¨çä¸ä¸ªå®ç°ä¾¿æ¯daoauthenticationproviderãé¡¾åæä¹ï¼daoæ­£æ¯æ°æ®è®¿é®å±çç¼©åï¼ä¹æç¤ºäºè¿ä¸ªèº«ä»½è®¤è¯å¨çå®ç°æè·¯ãç±äºæ¬ææ¯ä¸ä¸ªoverviewï¼å§ä¸åªç»åºå¶umlç±»å¾ï¼\n\ndaoauthenticationprovider uml\n\næç§æä»¬æç´è§çæè·¯ï¼æä¹å»è®¤è¯ä¸ä¸ªç¨æ·å¢ï¼ç¨æ·åå°æäº¤äºç¨æ·ååå¯ç ï¼èæ°æ®åºä¸­ä¿å­äºç¨æ·ååå¯ç ï¼è®¤è¯ä¾¿æ¯è´è´£æ¯å¯¹åä¸ä¸ªç¨æ·åï¼æäº¤çå¯ç åä¿å­çå¯ç æ¯å¦ç¸åä¾¿æ¯äºãå¨spring securityä¸­ãæäº¤çç¨æ·ååå¯ç ï¼è¢«å°è£æäºusernamepasswordauthenticationtokenï¼èæ ¹æ®ç¨æ·åå è½½ç¨æ·çä»»å¡åæ¯äº¤ç»äºuserdetailsserviceï¼å¨daoauthenticationproviderä¸­ï¼å¯¹åºçæ¹æ³ä¾¿æ¯retrieveuserï¼è½ç¶æä¸¤ä¸ªåæ°ï¼ä½æ¯retrieveuseråªæç¬¬ä¸ä¸ªåæ°èµ·ä¸»è¦ä½ç¨ï¼è¿åä¸ä¸ªuserdetailsãè¿éè¦å®æusernamepasswordauthenticationtokenåuserdetailså¯ç çæ¯å¯¹ï¼è¿ä¾¿æ¯äº¤ç»additionalauthenticationchecksæ¹æ³å®æçï¼å¦æè¿ä¸ªvoidæ¹æ³æ²¡ææå¼å¸¸ï¼åè®¤ä¸ºæ¯å¯¹æåãæ¯å¯¹å¯ç çè¿ç¨ï¼ç¨å°äºpasswordencoderåsaltsourceï¼å¯ç å å¯åççæ¦å¿µç¸ä¿¡ä¸ç¨æèµè¿°äºï¼å®ä»¬ä¸ºä¿éå®å¨èè®¾è®¡ï¼é½æ¯æ¯è¾åºç¡çæ¦å¿µã\n\nå¦æä½ å·²ç»è¢«è¿äºæ¦å¿µæå¾æå¤´è½¬åäºï¼ä¸å¦¨è¿ä¹çè§£daoauthenticationproviderï¼å®è·åç¨æ·æäº¤çç¨æ·ååå¯ç ï¼æ¯å¯¹å¶æ­£ç¡®æ§ï¼å¦ææ­£ç¡®ï¼è¿åä¸ä¸ªæ°æ®åºä¸­çç¨æ·ä¿¡æ¯ï¼åè®¾ç¨æ·ä¿¡æ¯è¢«ä¿å­å¨æ°æ®åºä¸­ï¼ã\n\n\n# 1.5 userdetailsä¸userdetailsservice\n\nä¸é¢ä¸æ­æå°äºuserdetailsè¿ä¸ªæ¥å£ï¼å®ä»£è¡¨äºæè¯¦ç»çç¨æ·ä¿¡æ¯ï¼è¿ä¸ªæ¥å£æ¶µçäºä¸äºå¿è¦çç¨æ·ä¿¡æ¯å­æ®µï¼å·ä½çå®ç°ç±»å¯¹å®è¿è¡äºæ©å±ã\n\npublic interface userdetails extends serializable {\n\n   collection<? extends grantedauthority> getauthorities();\n\n   string getpassword();\n\n   string getusername();\n\n   boolean isaccountnonexpired();\n\n   boolean isaccountnonlocked();\n\n   boolean iscredentialsnonexpired();\n\n   boolean isenabled();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nå®åauthenticationæ¥å£å¾ç±»ä¼¼ï¼æ¯å¦å®ä»¬é½æ¥æusernameï¼authoritiesï¼åºåä»ä»¬ä¹æ¯æ¬æçéç¹åå®¹ä¹ä¸ãauthenticationçgetcredentials()ä¸userdetailsä¸­çgetpassword()éè¦è¢«åºåå¯¹å¾ï¼åèæ¯ç¨æ·æäº¤çå¯ç å­è¯ï¼åèæ¯ç¨æ·æ­£ç¡®çå¯ç ï¼è®¤è¯å¨å¶å®å°±æ¯å¯¹è¿ä¸¤èçæ¯å¯¹ãauthenticationä¸­çgetauthorities()å®éæ¯ç±userdetailsçgetauthorities()ä¼ éèå½¢æçãè¿è®°å¾authenticationæ¥å£ä¸­çgetuserdetails()æ¹æ³åï¼å¶ä¸­çuserdetailsç¨æ·è¯¦ç»ä¿¡æ¯ä¾¿æ¯ç»è¿äºauthenticationproviderä¹åè¢«å¡«åçã\n\npublic interface userdetailsservice {\n   userdetails loaduserbyusername(string username) throws usernamenotfoundexception;\n}\n\n\n1\n2\n3\n\n\nuserdetailsserviceåauthenticationproviderä¸¤èçèè´£å¸¸å¸¸è¢«äººä»¬ææ··ï¼å³äºä»ä»¬çé®é¢å¨ææ¡£çfaqåissuesä¸­å±¡è§ä¸é²ãè®°ä½ä¸ç¹å³å¯ï¼æ²é»æ¿ï¼ï¼ï¼userdetailsserviceåªè´è´£ä»ç¹å®çå°æ¹ï¼éå¸¸æ¯æ°æ®åºï¼å è½½ç¨æ·ä¿¡æ¯ï¼ä»æ­¤èå·²ï¼è®°ä½è¿ä¸ç¹ï¼å¯ä»¥é¿åèµ°å¾å¤å¼¯è·¯ãuserdetailsserviceå¸¸è§çå®ç°ç±»æjdbcdaoimplï¼inmemoryuserdetailsmanagerï¼åèä»æ°æ®åºå è½½ç¨æ·ï¼åèä»åå­ä¸­å è½½ç¨æ·ï¼ä¹å¯ä»¥èªå·±å®ç°userdetailsserviceï¼éå¸¸è¿æ´å çµæ´»ã\n\n\n# 1.6 æ¶ææ¦è§å¾\n\nä¸ºäºæ´å å½¢è±¡ççè§£ä¸è¿°æä»ç»çè¿äºæ ¸å¿ç±»ï¼éä¸ä¸å¼ æç§æççè§£ï¼æç»åºspring securityçä¸å¼ éå¸åçumlå¾\n\n[](http://kirito.iocoder.cn/spring security architecture.png)æ¶ææ¦è§å¾\n\nå¦æå¯¹spring securityçè¿äºæ¦å¿µæå°çè§£ä¸è½ï¼ä¸ç¨æå¿ï¼å ä¸ºè¿æ¯architecture firstå¯¼è´çå¿ç¶ç»æï¼åè¿ä¸ªç¼çãåç»­çæç« ä¼ç§æcode firstççå¿µï¼éç»­è¯¦ç»å°è®²è§£è¿äºå®ç°ç±»çä½¿ç¨åºæ¯ï¼æºç åæï¼ä»¥åæåºæ¬çï¼å¦ä½éç½®spring securityï¼å¨åé¢çæç« ä¸­å¯ä»¥ä¸æ¶ç¿»çè¿ç¯æç« ï¼æ¾å°å·ä½çç±»å¨æ´ä¸ªæ¶æä¸­æå¤çä½ç½®ï¼è¿ä¹æ¯æ¬ç¯æç« çå®ä½ãå¦å¤ï¼ä¸äºspring securityçè¿æ»¤å¨è¿æªåæ¬å¨æ¶ææ¦è§ä¸­ï¼å¦å°è¡¨åä¿¡æ¯åè£æusernamepasswordauthenticationtokençè¿æ»¤å¨ï¼èèå°è¿äºè½ç¶ä¹æ¯æ¶æçä¸é¨åï¼ä½æ¯çæ­£éåä»ä»¬çå¯è½æ§è¾å°ï¼æä»¥æç®æ¾å°åé¢çç« èè®²è§£ã',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ãèå¾ãSpring Security(äº) ââ Guides",frontmatter:{title:"ãèå¾ãSpring Security(äº) ââ Guides",date:"2022-02-03T00:03:27.000Z",permalink:"/pages/188a19/",categories:["åç«¯","Spring Security"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/25.Spring%20Security/02.%E3%80%90%E8%80%81%E5%BE%90%E3%80%91Spring%20Security(%E4%BA%8C)%20%E2%80%94%E2%80%94%20Guides.html",relativePath:"10.æ¡æ¶/25.Spring Security/02.ãèå¾ãSpring Security(äº) ââ Guides.md",key:"v-2b72ba50",path:"/pages/188a19/",headers:[{level:2,title:"2 Spring Security Guides",slug:"_2-spring-security-guides",normalizedTitle:"2 spring security guides",charIndex:75},{level:3,title:"2.1 å¼å¥ä¾èµ",slug:"_2-1-å¼å¥ä¾èµ",normalizedTitle:"2.1 å¼å¥ä¾èµ",charIndex:363},{level:3,title:"2.2 åå»ºä¸ä¸ªä¸åå®å¨éå¶çwebåºç¨",slug:"_2-2-åå»ºä¸ä¸ªä¸åå®å¨éå¶çwebåºç¨",normalizedTitle:"2.2 åå»ºä¸ä¸ªä¸åå®å¨éå¶çwebåºç¨",charIndex:987},{level:3,title:"2.3 éç½®Spring Security",slug:"_2-3-éç½®spring-security",normalizedTitle:"2.3 éç½®spring security",charIndex:2343},{level:3,title:"2.4 æ·»å å¯å¨ç±»",slug:"_2-4-æ·»å å¯å¨ç±»",normalizedTitle:"2.4 æ·»å å¯å¨ç±»",charIndex:5360},{level:3,title:"2.5 æµè¯",slug:"_2-5-æµè¯",normalizedTitle:"2.5 æµè¯",charIndex:5572},{level:3,title:"2.6 æ»ç»",slug:"_2-6-æ»ç»",normalizedTitle:"2.6 æ»ç»",charIndex:5778}],headersStr:"2 Spring Security Guides 2.1 å¼å¥ä¾èµ 2.2 åå»ºä¸ä¸ªä¸åå®å¨éå¶çwebåºç¨ 2.3 éç½®Spring Security 2.4 æ·»å å¯å¨ç±» 2.5 æµè¯ 2.6 æ»ç»",content:'æè¦: åååºå¤ https://www.cnkirito.moe/spring-security-2/ ãèå¾ãæ¬¢è¿è½¬è½½ï¼ä¿çæè¦ï¼è°¢è°¢ï¼\n\n * 2 Spring Security Guides\n\n----------------------------------------\n\n----------------------------------------\n\nä¸ä¸ç¯æç« ãSpring Security(ä¸)âArchitecture Overviewãï¼æä»¬ä»ç»äºSpring Securityçåºç¡æ¶æï¼è¿ä¸èæä»¬éè¿Springå®æ¹ç»åºçä¸ä¸ªguidesä¾å­ï¼æ¥äºè§£Spring Securityæ¯å¦ä½ä¿æ¤æä»¬çåºç¨çï¼ä¹åä¼å¯¹è¿è¡ä¸ä¸ªè§£è¯»ã\n\n\n# 2 Spring Security Guides\n\n\n# 2.1 å¼å¥ä¾èµ\n\n<dependencies>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-web</artifactId>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-security</artifactId>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-thymeleaf</artifactId>\n    </dependency>\n</dependencies>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nç±äºæä»¬éæäºspringbootï¼æä»¥ä¸éè¦æ¾ç¤ºçå¼å¥Spring Securityææ¡£ä¸­æè¿°coreï¼configä¾èµï¼åªéè¦å¼å¥spring-boot-starter-securityå³å¯ã\n\n\n# 2.2 åå»ºä¸ä¸ªä¸åå®å¨éå¶çwebåºç¨\n\nè¿æ¯ä¸ä¸ªé¦é¡µï¼ä¸åå®å¨éå¶\n\nsrc/main/resources/templates/home.html\n<!DOCTYPE html>\n<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">\n    <head>\n        <title>Spring Security Example</title>\n    </head>\n    <body>\n        <h1>Welcome!</h1>\n        <p>Click <a th:href="@{/hello}">here</a> to see a greeting.</p>\n    </body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nè¿ä¸ªç®åçé¡µé¢ä¸åå«äºä¸ä¸ªé¾æ¥ï¼è·³è½¬å°â/helloâãå¯¹åºå¦ä¸çé¡µé¢\n\nsrc/main/resources/templates/hello.html\n<!DOCTYPE html>\n<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"\n      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">\n    <head>\n        <title>Hello World!</title>\n    </head>\n    <body>\n        <h1>Hello world!</h1>\n    </body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\næ¥ä¸æ¥éç½®Spring MVCï¼ä½¿å¾æä»¬è½å¤è®¿é®å°é¡µé¢ã\n\n@Configuration\npublic class MvcConfig extends WebMvcConfigurerAdapter {\n\n    @Override\n    public void addViewControllers(ViewControllerRegistry registry) {\n        registry.addViewController("/home").setViewName("home");\n        registry.addViewController("/").setViewName("home");\n        registry.addViewController("/hello").setViewName("hello");\n        registry.addViewController("/login").setViewName("login");\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n\n# 2.3 éç½®Spring Security\n\nä¸ä¸ªå¸åçå®å¨éç½®å¦ä¸æç¤ºï¼\n\n@Configuration\n@EnableWebSecurity <1>\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter { <1>\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        http <2>\n            .authorizeRequests()\n                .antMatchers("/", "/home").permitAll()\n                .anyRequest().authenticated()\n                .and()\n            .formLogin()\n                .loginPage("/login")\n                .permitAll()\n                .and()\n            .logout()\n                .permitAll();\n    }\n\n    @Autowired\n    public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\n        auth <3>\n            .inMemoryAuthentication()\n                .withUser("admin").password("admin").roles("USER");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\n<1> @EnableWebSecurityæ³¨è§£ä½¿å¾SpringMVCéæäºSpring Securityçwebå®å¨æ¯æãå¦å¤ï¼WebSecurityConfigéç½®ç±»åæ¶éæäºWebSecurityConfigurerAdapterï¼éåäºå¶ä¸­çç¹å®æ¹æ³ï¼ç¨äºèªå®ä¹Spring Securityéç½®ãæ´ä¸ªSpring Securityçå·¥ä½éï¼å¶å®é½æ¯éä¸­å¨è¯¥éç½®ç±»ï¼ä¸ä»ä»æ¯è¿ä¸ªguidesï¼å®éé¡¹ç®ä¸­ä¹æ¯å¦æ­¤ã\n\n<2> configure(HttpSecurity)å®ä¹äºåªäºURLè·¯å¾åºè¯¥è¢«æ¦æªï¼å¦å­é¢ææææè¿°ï¼â/â, â/homeâåè®¸ææäººè®¿é®ï¼â/loginâä½ä¸ºç»å½å¥å£ï¼ä¹è¢«åè®¸è®¿é®ï¼èå©ä¸çâ/helloâåéè¦ç»å½åæå¯ä»¥è®¿é®ã\n\n<3> configureGlobal(AuthenticationManagerBuilder)å¨åå­ä¸­éç½®ä¸ä¸ªç¨æ·ï¼admin/adminåå«æ¯ç¨æ·ååå¯ç ï¼è¿ä¸ªç¨æ·æ¥æUSERè§è²ã\n\næä»¬ç®åè¿æ²¡æç»å½é¡µé¢ï¼ä¸é¢åå»ºç»å½é¡µé¢ï¼\n\n<!DOCTYPE html>\n<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"\n      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">\n    <head>\n        <title>Spring Security Example </title>\n    </head>\n    <body>\n        <div th:if="${param.error}">\n            Invalid username and password.\n        </div>\n        <div th:if="${param.logout}">\n            You have been logged out.\n        </div>\n        <form th:action="@{/login}" method="post">\n            <div><label> User Name : <input type="text" name="username"/> </label></div>\n            <div><label> Password: <input type="password" name="password"/> </label></div>\n            <div><input type="submit" value="Sign In"/></div>\n        </form>\n    </body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nè¿ä¸ªThymeleafæ¨¡æ¿æä¾äºä¸ä¸ªç¨äºæäº¤ç¨æ·ååå¯ç çè¡¨å,å¶ä¸­name=âusernameâï¼name=âpasswordâæ¯é»è®¤çè¡¨åå¼ï¼å¹¶åéå°â/ loginâã å¨é»è®¤éç½®ä¸­ï¼Spring Securityæä¾äºä¸ä¸ªæ¦æªè¯¥è¯·æ±å¹¶éªè¯ç¨æ·çè¿æ»¤å¨ã å¦æéªè¯å¤±è´¥ï¼è¯¥é¡µé¢å°éå®åå°â/ login?errorâï¼å¹¶æ¾ç¤ºç¸åºçéè¯¯æ¶æ¯ã å½ç¨æ·éæ©æ³¨éï¼è¯·æ±ä¼è¢«åéå°â/ login?logoutâã\n\næåï¼æä»¬ä¸ºhello.htmlæ·»å ä¸äºåå®¹ï¼ç¨äºå±ç¤ºç¨æ·ä¿¡æ¯ã\n\n<!DOCTYPE html>\n<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"\n      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">\n    <head>\n        <title>Hello World!</title>\n    </head>\n    <body>\n        <h1 th:inline="text">Hello [[${#httpServletRequest.remoteUser}]]!</h1>\n        <form th:action="@{/logout}" method="post">\n            <input type="submit" value="Sign Out"/>\n        </form>\n    </body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\næä»¬ä½¿ç¨Spring Securityä¹åï¼HttpServletRequest#getRemoteUser()å¯ä»¥ç¨æ¥è·åç¨æ·åã ç»åºè¯·æ±å°è¢«åéå°â/ logoutâã æåæ³¨éåï¼ä¼å°ç¨æ·éå®åå°â/ login?logoutâã\n\n\n# 2.4 æ·»å å¯å¨ç±»\n\n@SpringBootApplication\npublic class Application {\n\n    public static void main(String[] args) throws Throwable {\n        SpringApplication.run(Application.class, args);\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# 2.5 æµè¯\n\nè®¿é®é¦é¡µhttp://localhost:8080/:\n\nhome.html\n\nç¹å»hereï¼å°è¯è®¿é®åéçé¡µé¢ï¼/hello,ç±äºæªç»å½ï¼ç»æè¢«å¼ºå¶è·³è½¬å°ç»å½ä¹/loginï¼\n\nlogin.html\n\nè¾å¥æ­£ç¡®çç¨æ·ååå¯ç ä¹åï¼è·³è½¬å°ä¹åæ³è¦è®¿é®ç/hello:\n\nhello.html\n\nç¹å»Sign outéåºæé®ï¼è®¿é®:/logout,åå°ç»å½é¡µé¢:\n\nlogout.html\n\n\n# 2.6 æ»ç»\n\næ¬ç¯æç« æ²¡æä»ä¹å¹²è´§ï¼åºæ¬ç®æ¯ç¿»è¯äºSpring Security Guidesçåå®¹ï¼ç¨å¾®äºè§£Spring Securityçæåé½ä¸ä¼å¯¹è¿ä¸ªç¿»è¯æå°éçãèèå°åä¼çé®é¢ï¼ä¸ä¸ªå¥é¨çä¾å­æ¯å¿é¡»å¾æçï¼æ¹ä¾¿åç»­å¯¹Spring Securityçèªå®ä¹éç½®è¿è¡è®²è§£ãä¸ä¸èï¼ä»¥æ­¤guidesä¸ºä¾ï¼è®²è§£è¿äºæç®åçéç½®èåï¼Spring Securityé½å¸®æä»¬åäºä»ä¹å·¥ä½ã\n\næ¬èææçä»£ç ï¼å¯ä»¥ç´æ¥å¨Springçå®æ¹ä»åºä¸è½½å¾å°ï¼git clone https://github.com/spring-guides/gs-securing-web.gitãä¸è¿ï¼å»ºè®®åå­¦èæ ¹æ®æç« åä¸æ­¥æ­¥éç½®ï¼åºäºé®é¢ï¼åä¸demoè¿è¡å¯¹æ¯ã',normalizedContent:'æè¦: åååºå¤ https://www.cnkirito.moe/spring-security-2/ ãèå¾ãæ¬¢è¿è½¬è½½ï¼ä¿çæè¦ï¼è°¢è°¢ï¼\n\n * 2 spring security guides\n\n----------------------------------------\n\n----------------------------------------\n\nä¸ä¸ç¯æç« ãspring security(ä¸)âarchitecture overviewãï¼æä»¬ä»ç»äºspring securityçåºç¡æ¶æï¼è¿ä¸èæä»¬éè¿springå®æ¹ç»åºçä¸ä¸ªguidesä¾å­ï¼æ¥äºè§£spring securityæ¯å¦ä½ä¿æ¤æä»¬çåºç¨çï¼ä¹åä¼å¯¹è¿è¡ä¸ä¸ªè§£è¯»ã\n\n\n# 2 spring security guides\n\n\n# 2.1 å¼å¥ä¾èµ\n\n<dependencies>\n    <dependency>\n        <groupid>org.springframework.boot</groupid>\n        <artifactid>spring-boot-starter-web</artifactid>\n    </dependency>\n    <dependency>\n        <groupid>org.springframework.boot</groupid>\n        <artifactid>spring-boot-starter-security</artifactid>\n    </dependency>\n    <dependency>\n        <groupid>org.springframework.boot</groupid>\n        <artifactid>spring-boot-starter-thymeleaf</artifactid>\n    </dependency>\n</dependencies>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nç±äºæä»¬éæäºspringbootï¼æä»¥ä¸éè¦æ¾ç¤ºçå¼å¥spring securityææ¡£ä¸­æè¿°coreï¼configä¾èµï¼åªéè¦å¼å¥spring-boot-starter-securityå³å¯ã\n\n\n# 2.2 åå»ºä¸ä¸ªä¸åå®å¨éå¶çwebåºç¨\n\nè¿æ¯ä¸ä¸ªé¦é¡µï¼ä¸åå®å¨éå¶\n\nsrc/main/resources/templates/home.html\n<!doctype html>\n<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">\n    <head>\n        <title>spring security example</title>\n    </head>\n    <body>\n        <h1>welcome!</h1>\n        <p>click <a th:href="@{/hello}">here</a> to see a greeting.</p>\n    </body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nè¿ä¸ªç®åçé¡µé¢ä¸åå«äºä¸ä¸ªé¾æ¥ï¼è·³è½¬å°â/helloâãå¯¹åºå¦ä¸çé¡µé¢\n\nsrc/main/resources/templates/hello.html\n<!doctype html>\n<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"\n      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">\n    <head>\n        <title>hello world!</title>\n    </head>\n    <body>\n        <h1>hello world!</h1>\n    </body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\næ¥ä¸æ¥éç½®spring mvcï¼ä½¿å¾æä»¬è½å¤è®¿é®å°é¡µé¢ã\n\n@configuration\npublic class mvcconfig extends webmvcconfigureradapter {\n\n    @override\n    public void addviewcontrollers(viewcontrollerregistry registry) {\n        registry.addviewcontroller("/home").setviewname("home");\n        registry.addviewcontroller("/").setviewname("home");\n        registry.addviewcontroller("/hello").setviewname("hello");\n        registry.addviewcontroller("/login").setviewname("login");\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n\n# 2.3 éç½®spring security\n\nä¸ä¸ªå¸åçå®å¨éç½®å¦ä¸æç¤ºï¼\n\n@configuration\n@enablewebsecurity <1>\npublic class websecurityconfig extends websecurityconfigureradapter { <1>\n    @override\n    protected void configure(httpsecurity http) throws exception {\n        http <2>\n            .authorizerequests()\n                .antmatchers("/", "/home").permitall()\n                .anyrequest().authenticated()\n                .and()\n            .formlogin()\n                .loginpage("/login")\n                .permitall()\n                .and()\n            .logout()\n                .permitall();\n    }\n\n    @autowired\n    public void configureglobal(authenticationmanagerbuilder auth) throws exception {\n        auth <3>\n            .inmemoryauthentication()\n                .withuser("admin").password("admin").roles("user");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\n<1> @enablewebsecurityæ³¨è§£ä½¿å¾springmvcéæäºspring securityçwebå®å¨æ¯æãå¦å¤ï¼websecurityconfigéç½®ç±»åæ¶éæäºwebsecurityconfigureradapterï¼éåäºå¶ä¸­çç¹å®æ¹æ³ï¼ç¨äºèªå®ä¹spring securityéç½®ãæ´ä¸ªspring securityçå·¥ä½éï¼å¶å®é½æ¯éä¸­å¨è¯¥éç½®ç±»ï¼ä¸ä»ä»æ¯è¿ä¸ªguidesï¼å®éé¡¹ç®ä¸­ä¹æ¯å¦æ­¤ã\n\n<2> configure(httpsecurity)å®ä¹äºåªäºurlè·¯å¾åºè¯¥è¢«æ¦æªï¼å¦å­é¢ææææè¿°ï¼â/â, â/homeâåè®¸ææäººè®¿é®ï¼â/loginâä½ä¸ºç»å½å¥å£ï¼ä¹è¢«åè®¸è®¿é®ï¼èå©ä¸çâ/helloâåéè¦ç»å½åæå¯ä»¥è®¿é®ã\n\n<3> configureglobal(authenticationmanagerbuilder)å¨åå­ä¸­éç½®ä¸ä¸ªç¨æ·ï¼admin/adminåå«æ¯ç¨æ·ååå¯ç ï¼è¿ä¸ªç¨æ·æ¥æuserè§è²ã\n\næä»¬ç®åè¿æ²¡æç»å½é¡µé¢ï¼ä¸é¢åå»ºç»å½é¡µé¢ï¼\n\n<!doctype html>\n<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"\n      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">\n    <head>\n        <title>spring security example </title>\n    </head>\n    <body>\n        <div th:if="${param.error}">\n            invalid username and password.\n        </div>\n        <div th:if="${param.logout}">\n            you have been logged out.\n        </div>\n        <form th:action="@{/login}" method="post">\n            <div><label> user name : <input type="text" name="username"/> </label></div>\n            <div><label> password: <input type="password" name="password"/> </label></div>\n            <div><input type="submit" value="sign in"/></div>\n        </form>\n    </body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nè¿ä¸ªthymeleafæ¨¡æ¿æä¾äºä¸ä¸ªç¨äºæäº¤ç¨æ·ååå¯ç çè¡¨å,å¶ä¸­name=âusernameâï¼name=âpasswordâæ¯é»è®¤çè¡¨åå¼ï¼å¹¶åéå°â/ loginâã å¨é»è®¤éç½®ä¸­ï¼spring securityæä¾äºä¸ä¸ªæ¦æªè¯¥è¯·æ±å¹¶éªè¯ç¨æ·çè¿æ»¤å¨ã å¦æéªè¯å¤±è´¥ï¼è¯¥é¡µé¢å°éå®åå°â/ login?errorâï¼å¹¶æ¾ç¤ºç¸åºçéè¯¯æ¶æ¯ã å½ç¨æ·éæ©æ³¨éï¼è¯·æ±ä¼è¢«åéå°â/ login?logoutâã\n\næåï¼æä»¬ä¸ºhello.htmlæ·»å ä¸äºåå®¹ï¼ç¨äºå±ç¤ºç¨æ·ä¿¡æ¯ã\n\n<!doctype html>\n<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"\n      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">\n    <head>\n        <title>hello world!</title>\n    </head>\n    <body>\n        <h1 th:inline="text">hello [[${#httpservletrequest.remoteuser}]]!</h1>\n        <form th:action="@{/logout}" method="post">\n            <input type="submit" value="sign out"/>\n        </form>\n    </body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\næä»¬ä½¿ç¨spring securityä¹åï¼httpservletrequest#getremoteuser()å¯ä»¥ç¨æ¥è·åç¨æ·åã ç»åºè¯·æ±å°è¢«åéå°â/ logoutâã æåæ³¨éåï¼ä¼å°ç¨æ·éå®åå°â/ login?logoutâã\n\n\n# 2.4 æ·»å å¯å¨ç±»\n\n@springbootapplication\npublic class application {\n\n    public static void main(string[] args) throws throwable {\n        springapplication.run(application.class, args);\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# 2.5 æµè¯\n\nè®¿é®é¦é¡µhttp://localhost:8080/:\n\nhome.html\n\nç¹å»hereï¼å°è¯è®¿é®åéçé¡µé¢ï¼/hello,ç±äºæªç»å½ï¼ç»æè¢«å¼ºå¶è·³è½¬å°ç»å½ä¹/loginï¼\n\nlogin.html\n\nè¾å¥æ­£ç¡®çç¨æ·ååå¯ç ä¹åï¼è·³è½¬å°ä¹åæ³è¦è®¿é®ç/hello:\n\nhello.html\n\nç¹å»sign outéåºæé®ï¼è®¿é®:/logout,åå°ç»å½é¡µé¢:\n\nlogout.html\n\n\n# 2.6 æ»ç»\n\næ¬ç¯æç« æ²¡æä»ä¹å¹²è´§ï¼åºæ¬ç®æ¯ç¿»è¯äºspring security guidesçåå®¹ï¼ç¨å¾®äºè§£spring securityçæåé½ä¸ä¼å¯¹è¿ä¸ªç¿»è¯æå°éçãèèå°åä¼çé®é¢ï¼ä¸ä¸ªå¥é¨çä¾å­æ¯å¿é¡»å¾æçï¼æ¹ä¾¿åç»­å¯¹spring securityçèªå®ä¹éç½®è¿è¡è®²è§£ãä¸ä¸èï¼ä»¥æ­¤guidesä¸ºä¾ï¼è®²è§£è¿äºæç®åçéç½®èåï¼spring securityé½å¸®æä»¬åäºä»ä¹å·¥ä½ã\n\næ¬èææçä»£ç ï¼å¯ä»¥ç´æ¥å¨springçå®æ¹ä»åºä¸è½½å¾å°ï¼git clone https://github.com/spring-guides/gs-securing-web.gitãä¸è¿ï¼å»ºè®®åå­¦èæ ¹æ®æç« åä¸æ­¥æ­¥éç½®ï¼åºäºé®é¢ï¼åä¸demoè¿è¡å¯¹æ¯ã',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ãèå¾ãSpring Security(ä¸) ââ æ ¸å¿éç½®è§£è¯»",frontmatter:{title:"ãèå¾ãSpring Security(ä¸) ââ æ ¸å¿éç½®è§£è¯»",date:"2022-02-03T00:03:27.000Z",permalink:"/pages/9327fd/",categories:["åç«¯","Spring Security"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/25.Spring%20Security/03.%E3%80%90%E8%80%81%E5%BE%90%E3%80%91Spring%20Security(%E4%B8%89)%20%E2%80%94%E2%80%94%20%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE%E8%A7%A3%E8%AF%BB.html",relativePath:"10.æ¡æ¶/25.Spring Security/03.ãèå¾ãSpring Security(ä¸) ââ æ ¸å¿éç½®è§£è¯».md",key:"v-d22b1d0e",path:"/pages/9327fd/",headers:[{level:2,title:"3 æ ¸å¿éç½®è§£è¯»",slug:"_3-æ ¸å¿éç½®è§£è¯»",normalizedTitle:"3 æ ¸å¿éç½®è§£è¯»",charIndex:75},{level:3,title:"3.1 åè½ä»ç»",slug:"_3-1-åè½ä»ç»",normalizedTitle:"3.1 åè½ä»ç»",charIndex:288},{level:3,title:"3.2 @EnableWebSecurity",slug:"_3-2-enablewebsecurity",normalizedTitle:"3.2 @enablewebsecurity",charIndex:2093},{level:3,title:"3.3 WebSecurityConfigurerAdapter",slug:"_3-3-websecurityconfigureradapter",normalizedTitle:"3.3 websecurityconfigureradapter",charIndex:4850}],headersStr:"3 æ ¸å¿éç½®è§£è¯» 3.1 åè½ä»ç» 3.2 @EnableWebSecurity 3.3 WebSecurityConfigurerAdapter",content:'æè¦: åååºå¤ https://www.cnkirito.moe/spring-security-3/ ãèå¾ãæ¬¢è¿è½¬è½½ï¼ä¿çæè¦ï¼è°¢è°¢ï¼\n\n * 3 æ ¸å¿éç½®è§£è¯»\n\n----------------------------------------\n\n----------------------------------------\n\nä¸ä¸ç¯æç« ãSpring Security(äº)âGuidesãï¼éè¿Spring Securityçéç½®é¡¹äºè§£äºSpring Securityæ¯å¦ä½ä¿æ¤æä»¬çåºç¨çï¼æ¬ç¯æç« å¯¹ä¸ä¸æ¬¡çéç½®åä¸ä¸ªåæã\n\n\n# 3 æ ¸å¿éç½®è§£è¯»\n\n\n# 3.1 åè½ä»ç»\n\nè¿æ¯Spring Securityå¥é¨æåä¸­çéç½®é¡¹ï¼\n\n@Configuration\n@EnableWebSecurity\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n\n  @Override\n  protected void configure(HttpSecurity http) throws Exception {\n      http\n          .authorizeRequests()\n              .antMatchers("/", "/home").permitAll()\n              .anyRequest().authenticated()\n              .and()\n          .formLogin()\n              .loginPage("/login")\n              .permitAll()\n              .and()\n          .logout()\n              .permitAll();\n  }\n\n  @Autowired\n  public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\n      auth\n          .inMemoryAuthentication()\n              .withUser("admin").password("admin").roles("USER");\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nå½éç½®äºä¸è¿°çjavaconfigä¹åï¼æä»¬çåºç¨ä¾¿å·å¤äºå¦ä¸çåè½ï¼\n\n * é¤äºâ/â,â/homeâ(é¦é¡µ),â/loginâ(ç»å½),â/logoutâ(æ³¨é),ä¹å¤ï¼å¶ä»è·¯å¾é½éè¦è®¤è¯ã\n\n * æå®â/loginâè¯¥è·¯å¾ä¸ºç»å½é¡µé¢ï¼å½æªè®¤è¯çç¨æ·å°è¯è®¿é®ä»»ä½åä¿æ¤çèµæºæ¶ï¼é½ä¼è·³è½¬å°â/loginâã\n\n * é»è®¤æå®â/logoutâä¸ºæ³¨éé¡µé¢\n\n * éç½®ä¸ä¸ªåå­ä¸­çç¨æ·è®¤è¯å¨ï¼ä½¿ç¨admin/adminä½ä¸ºç¨æ·ååå¯ç ï¼å·æUSERè§è²\n\n * é²æ­¢CSRFæ»å»\n\n * Session Fixation protection(å¯ä»¥åèæä¹åè®²è§£Spring Sessionçæç« ï¼é²æ­¢å«äººç¯¡æ¹sessionId)\n\n * Security Header(æ·»å ä¸ç³»ååHeaderç¸å³çæ§å¶)\n   \n   * HTTP Strict Transport Security for secure requests\n   * éæX-Content-Type-Options\n   * ç¼å­æ§å¶\n   * éæX-XSS-Protection\n   * X-Frame-Options integration to help prevent Clickjacking(iframeè¢«é»è®¤ç¦æ­¢ä½¿ç¨)\n\n * ä¸ºServlet APIéæäºå¦ä¸çå ä¸ªæ¹æ³\n   \n   * HttpServletRequest#getRemoteUser()\n   * HttpServletRequest.html#getUserPrincipal()\n   * HttpServletRequest.html#isUserInRole(java.lang.String)\n   * [HttpServletRequest.html#login(java.lang.String, java.lang.String)](https://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#login(java.lang.String, java.lang.String))\n   * HttpServletRequest.html#logout()\n\n\n# 3.2 @EnableWebSecurity\n\næä»¬èªå·±å®ä¹çéç½®ç±»WebSecurityConfigå ä¸äº@EnableWebSecurityæ³¨è§£ï¼åæ¶ç»§æ¿äºWebSecurityConfigurerAdapterãä½ å¯è½ä¼å¨æ³è°çä½ç¨å¤§ä¸ç¹ï¼æ¯«æ çé®@EnableWebSecurityèµ·å°å³å®æ§çéç½®ä½ç¨ï¼å®å¶å®æ¯ä¸ªç»åæ³¨è§£ã\n\n@Import({ WebSecurityConfiguration.class, // <2>\n      SpringWebMvcImportSelector.class }) // <1>\n@EnableGlobalAuthentication // <3>\n@Configuration\npublic @interface EnableWebSecurity {\n   boolean debug() default false;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n@Importæ¯springbootæä¾çç¨äºå¼å¥å¤é¨çéç½®çæ³¨è§£ï¼å¯ä»¥çè§£ä¸ºï¼@EnableWebSecurityæ³¨è§£æ¿æ´»äº@Importæ³¨è§£ä¸­åå«çéç½®ç±»ã\n\n<1> SpringWebMvcImportSelectorçä½ç¨æ¯å¤æ­å½åçç¯å¢æ¯å¦åå«springmvcï¼å ä¸ºspring securityå¯ä»¥å¨éspringç¯å¢ä¸ä½¿ç¨ï¼ä¸ºäºé¿åDispatcherServletçéå¤éç½®ï¼æä»¥ä½¿ç¨äºè¿ä¸ªæ³¨è§£æ¥åºåã\n\n<2> WebSecurityConfigurationé¡¾åæä¹ï¼æ¯ç¨æ¥éç½®webå®å¨çï¼ä¸é¢çå°èä¼è¯¦ç»ä»ç»ã\n\n<3> @EnableGlobalAuthenticationæ³¨è§£çæºç å¦ä¸ï¼\n\n@Import(AuthenticationConfiguration.class)\n@Configuration\npublic @interface EnableGlobalAuthentication {\n}\n\n\n1\n2\n3\n4\n\n\næ³¨æç¹åæ ·å¨@Importä¹ä¸­ï¼å®å®éä¸æ¿æ´»äºAuthenticationConfigurationè¿æ ·çä¸ä¸ªéç½®ç±»ï¼ç¨æ¥éç½®è®¤è¯ç¸å³çæ ¸å¿ç±»ã\n\nä¹å°±æ¯è¯´ï¼@EnableWebSecurityå®æçå·¥ä½ä¾¿æ¯å è½½äºWebSecurityConfigurationï¼AuthenticationConfigurationè¿ä¸¤ä¸ªæ ¸å¿éç½®ç±»ï¼ä¹å°±æ­¤å°spring securityçèè´£ååä¸ºäºéç½®å®å¨ä¿¡æ¯ï¼éç½®è®¤è¯ä¿¡æ¯ä¸¤é¨åã\n\n# WebSecurityConfiguration\n\nå¨è¿ä¸ªéç½®ç±»ä¸­ï¼æä¸ä¸ªéå¸¸éè¦çBeanè¢«æ³¨åäºã\n\n@Configuration\npublic class WebSecurityConfiguration {\n\n\t//DEFAULT_FILTER_NAME = "springSecurityFilterChain"\n\t@Bean(name = AbstractSecurityWebApplicationInitializer.DEFAULT_FILTER_NAME)\n    public Filter springSecurityFilterChain() throws Exception {\n    \t...\n    }\n\n }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¨æªä½¿ç¨springbootä¹åï¼å¤§å¤æ°äººé½åºè¯¥å¯¹âspringSecurityFilterChainâè¿ä¸ªåè¯ä¸ä¼éçï¼ä»æ¯spring securityçæ ¸å¿è¿æ»¤å¨ï¼æ¯æ´ä¸ªè®¤è¯çå¥å£ãå¨æ¾ç»çXMLéç½®ä¸­ï¼æ³è¦å¯ç¨spring securityï¼éè¦å¨web.xmlä¸­è¿è¡å¦ä¸éç½®ï¼\n\n\x3c!-- Spring Security --\x3e\n<filter>\n    <filter-name>springSecurityFilterChain</filter-name>\n    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>\n</filter>\n\n<filter-mapping>\n    <filter-name>springSecurityFilterChain</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nèå¨springbootéæä¹åï¼è¿æ ·çXMLè¢«javaéç½®åä»£ãWebSecurityConfigurationä¸­å®æäºå£°æspringSecurityFilterChainçä½ç¨ï¼å¹¶ä¸æç»äº¤ç»DelegatingFilterProxyè¿ä¸ªä»£çç±»ï¼è´è´£æ¦æªè¯·æ±ï¼æ³¨æDelegatingFilterProxyè¿ä¸ªç±»ä¸æ¯spring securityåä¸­çï¼èæ¯å­å¨äºwebåä¸­ï¼springä½¿ç¨äºä»£çæ¨¡å¼æ¥å®ç°å®å¨è¿æ»¤çè§£è¦ï¼ã\n\n# AuthenticationConfiguration\n\n@Configuration\n@Import(ObjectPostProcessorConfiguration.class)\npublic class AuthenticationConfiguration {\n\n  \t@Bean\n\tpublic AuthenticationManagerBuilder authenticationManagerBuilder(\n\t\t\tObjectPostProcessor<Object> objectPostProcessor) {\n\t\treturn new AuthenticationManagerBuilder(objectPostProcessor);\n\t}\n\n  \tpublic AuthenticationManager getAuthenticationManager() throws Exception {\n    \t...\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nAuthenticationConfigurationçä¸»è¦ä»»å¡ï¼ä¾¿æ¯è´è´£çæå¨å±çèº«ä»½è®¤è¯ç®¡çèAuthenticationManagerãè¿è®°å¾å¨ãSpring Security(ä¸)âArchitecture Overviewãä¸­ï¼ä»ç»äºSpring Securityçè®¤è¯ä½ç³»ï¼AuthenticationManagerä¾¿æ¯ææ ¸å¿çèº«ä»½è®¤è¯ç®¡çå¨ã\n\n\n# 3.3 WebSecurityConfigurerAdapter\n\nééå¨æ¨¡å¼å¨springä¸­è¢«å¹¿æ³çä½¿ç¨ï¼å¨éç½®ä¸­ä½¿ç¨Adapterçå¥½å¤ä¾¿æ¯ï¼æä»¬å¯ä»¥éæ©æ§çéç½®æ³è¦ä¿®æ¹çé£ä¸é¨åéç½®ï¼èä¸ç¨è¦çå¶ä»ä¸ç¸å³çéç½®ãWebSecurityConfigurerAdapterä¸­æä»¬å¯ä»¥éæ©èªå·±æ³è¦ä¿®æ¹çåå®¹ï¼æ¥è¿è¡éåï¼èå¶æä¾äºä¸ä¸ªconfigureéè½½æ¹æ³ï¼æ¯æä»¬ä¸»è¦å³å¿çï¼\n\n\n\nWebSecurityConfigurerAdapterä¸­çconfigure\n\nç±åæ°å°±å¯ä»¥ç¥éï¼åå«æ¯å¯¹AuthenticationManagerBuilderï¼WebSecurityï¼HttpSecurityè¿è¡ä¸ªæ§åçéç½®ã\n\n# HttpSecurityå¸¸ç¨éç½®\n\n@Configuration\n@EnableWebSecurity\npublic class CustomWebSecurityConfig extends WebSecurityConfigurerAdapter {\n\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        http\n            .authorizeRequests()\n                .antMatchers("/resources/**", "/signup", "/about").permitAll()\n                .antMatchers("/admin/**").hasRole("ADMIN")\n                .antMatchers("/db/**").access("hasRole(\'ADMIN\') and hasRole(\'DBA\')")\n                .anyRequest().authenticated()\n                .and()\n            .formLogin()\n                .usernameParameter("username")\n                .passwordParameter("password")\n                .failureForwardUrl("/login?error")\n                .loginPage("/login")\n                .permitAll()\n                .and()\n            .logout()\n                .logoutUrl("/logout")\n                .logoutSuccessUrl("/index")\n                .permitAll()\n                .and()\n            .httpBasic()\n                .disable();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nä¸è¿°æ¯ä¸ä¸ªä½¿ç¨Java Configurationéç½®HttpSecurityçå¸åéç½®ï¼å¶ä¸­httpä½ä¸ºæ ¹å¼å§éç½®ï¼æ¯ä¸ä¸ªand()å¯¹åºäºä¸ä¸ªæ¨¡åçéç½®ï¼ç­åäºxmléç½®ä¸­çç»ææ ç­¾ï¼ï¼å¹¶ä¸and()è¿åäºHttpSecurityæ¬èº«ï¼äºæ¯å¯ä»¥è¿ç»­è¿è¡éç½®ãä»ä»¬éç½®çå«ä¹ä¹éå¸¸å®¹æéè¿åéæ¬èº«æ¥æ¨æµï¼\n\n * authorizeRequests()éç½®è·¯å¾æ¦æªï¼è¡¨æè·¯å¾è®¿é®æå¯¹åºçæéï¼è§è²ï¼è®¤è¯ä¿¡æ¯ã\n * formLogin()å¯¹åºè¡¨åè®¤è¯ç¸å³çéç½®\n * logout()å¯¹åºäºæ³¨éç¸å³çéç½®\n * httpBasic()å¯ä»¥éç½®basicç»å½\n * etc\n\nä»ä»¬åå«ä»£è¡¨äºhttpè¯·æ±ç¸å³çå®å¨éç½®ï¼è¿äºéç½®é¡¹æ ä¸ä¾å¤çè¿åäºConfigurerç±»ï¼èææçhttpç¸å³éç½®å¯ä»¥éè¿æ¥çHttpSecurityçä¸»è¦æ¹æ³å¾ç¥ï¼\n\nhttp://kirito.iocoder.cn/QQ%E5%9B%BE%E7%89%8720170924223252.png\n\néè¦å¯¹httpåè®®æä¸å®çäºè§£æè½å®å¨ææ¡ææçéç½®ï¼ä¸è¿ï¼springbootåspring securityçèªå¨éç½®å·²ç»è¶³å¤ä½¿ç¨äºãå¶ä¸­æ¯ä¸é¡¹Configurerï¼e.g.FormLoginConfigurer,CsrfConfigurerï¼é½æ¯HttpConfigurerçç»åéç½®é¡¹ã\n\n# WebSecurityBuilder\n\n@Configuration\n@EnableWebSecurity\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n    @Override\n    public void configure(WebSecurity web) throws Exception {\n        web\n            .ignoring()\n            .antMatchers("/resources/**");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä»¥ç¬èçç»éªï¼è¿ä¸ªéç½®ä¸­å¹¶ä¸ä¼åºç°å¤ªå¤çéç½®ä¿¡æ¯ã\n\n# AuthenticationManagerBuilder\n\n@Configuration\n@EnableWebSecurity\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n\n    @Override\n    protected void configure(AuthenticationManagerBuilder auth) throws Exception {\n        auth\n            .inMemoryAuthentication()\n            .withUser("admin").password("admin").roles("USER");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\næ³è¦å¨WebSecurityConfigurerAdapterä¸­è¿è¡è®¤è¯ç¸å³çéç½®ï¼å¯ä»¥ä½¿ç¨configure(AuthenticationManagerBuilder auth)æ´é²ä¸ä¸ªAuthenticationManagerçå»ºé å¨ï¼AuthenticationManagerBuilder ãå¦ä¸æç¤ºï¼æä»¬ä¾¿å®æäºåå­ä¸­ç¨æ·çéç½®ã\n\nç»å¿çæåä¼åç°ï¼å¨åé¢çæç« ä¸­æä»¬éç½®åå­ä¸­çç¨æ·æ¶ï¼ä¼¼ä¹ä¸æ¯è¿ä¹éç½®çï¼èæ¯ï¼\n\n@Configuration\n@EnableWebSecurity\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n\n    @Autowired\n    public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\n        auth\n            .inMemoryAuthentication()\n                .withUser("admin").password("admin").roles("USER");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¦æä½ çåºç¨åªæå¯ä¸ä¸ä¸ªWebSecurityConfigurerAdapterï¼é£ä¹ä»ä»¬ä¹é´çå·®è·å¯ä»¥è¢«å¿½ç¥ï¼ä»æ¹æ³åå¯ä»¥çåºä¸¤èçåºå«ï¼ä½¿ç¨@Autowiredæ³¨å¥çAuthenticationManagerBuilderæ¯å¨å±çèº«ä»½è®¤è¯å¨ï¼ä½ç¨åå¯ä»¥è·¨è¶å¤ä¸ªWebSecurityConfigurerAdapterï¼ä»¥åå½±åå°åºäºMethodçå®å¨æ§å¶ï¼è protected configure()çæ¹å¼åç±»ä¼¼äºä¸ä¸ªå¿ååé¨ç±»ï¼å®çä½ç¨åå±éäºä¸ä¸ªWebSecurityConfigurerAdapteråé¨ãå³äºè¿ä¸ç¹çåºå«ï¼å¯ä»¥åèææ¾ç»æåºçissuespring-security#issues4571ãå®æ¹ææ¡£ä¸­ï¼ä¹ç»åºäºéç½®å¤ä¸ªWebSecurityConfigurerAdapterçåºæ¯ä»¥ådemoï¼å°å¨è¯¥ç³»åçåç»­æç« ä¸­è§£è¯»ã',normalizedContent:'æè¦: åååºå¤ https://www.cnkirito.moe/spring-security-3/ ãèå¾ãæ¬¢è¿è½¬è½½ï¼ä¿çæè¦ï¼è°¢è°¢ï¼\n\n * 3 æ ¸å¿éç½®è§£è¯»\n\n----------------------------------------\n\n----------------------------------------\n\nä¸ä¸ç¯æç« ãspring security(äº)âguidesãï¼éè¿spring securityçéç½®é¡¹äºè§£äºspring securityæ¯å¦ä½ä¿æ¤æä»¬çåºç¨çï¼æ¬ç¯æç« å¯¹ä¸ä¸æ¬¡çéç½®åä¸ä¸ªåæã\n\n\n# 3 æ ¸å¿éç½®è§£è¯»\n\n\n# 3.1 åè½ä»ç»\n\nè¿æ¯spring securityå¥é¨æåä¸­çéç½®é¡¹ï¼\n\n@configuration\n@enablewebsecurity\npublic class websecurityconfig extends websecurityconfigureradapter {\n\n  @override\n  protected void configure(httpsecurity http) throws exception {\n      http\n          .authorizerequests()\n              .antmatchers("/", "/home").permitall()\n              .anyrequest().authenticated()\n              .and()\n          .formlogin()\n              .loginpage("/login")\n              .permitall()\n              .and()\n          .logout()\n              .permitall();\n  }\n\n  @autowired\n  public void configureglobal(authenticationmanagerbuilder auth) throws exception {\n      auth\n          .inmemoryauthentication()\n              .withuser("admin").password("admin").roles("user");\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nå½éç½®äºä¸è¿°çjavaconfigä¹åï¼æä»¬çåºç¨ä¾¿å·å¤äºå¦ä¸çåè½ï¼\n\n * é¤äºâ/â,â/homeâ(é¦é¡µ),â/loginâ(ç»å½),â/logoutâ(æ³¨é),ä¹å¤ï¼å¶ä»è·¯å¾é½éè¦è®¤è¯ã\n\n * æå®â/loginâè¯¥è·¯å¾ä¸ºç»å½é¡µé¢ï¼å½æªè®¤è¯çç¨æ·å°è¯è®¿é®ä»»ä½åä¿æ¤çèµæºæ¶ï¼é½ä¼è·³è½¬å°â/loginâã\n\n * é»è®¤æå®â/logoutâä¸ºæ³¨éé¡µé¢\n\n * éç½®ä¸ä¸ªåå­ä¸­çç¨æ·è®¤è¯å¨ï¼ä½¿ç¨admin/adminä½ä¸ºç¨æ·ååå¯ç ï¼å·æuserè§è²\n\n * é²æ­¢csrfæ»å»\n\n * session fixation protection(å¯ä»¥åèæä¹åè®²è§£spring sessionçæç« ï¼é²æ­¢å«äººç¯¡æ¹sessionid)\n\n * security header(æ·»å ä¸ç³»ååheaderç¸å³çæ§å¶)\n   \n   * http strict transport security for secure requests\n   * éæx-content-type-options\n   * ç¼å­æ§å¶\n   * éæx-xss-protection\n   * x-frame-options integration to help prevent clickjacking(iframeè¢«é»è®¤ç¦æ­¢ä½¿ç¨)\n\n * ä¸ºservlet apiéæäºå¦ä¸çå ä¸ªæ¹æ³\n   \n   * httpservletrequest#getremoteuser()\n   * httpservletrequest.html#getuserprincipal()\n   * httpservletrequest.html#isuserinrole(java.lang.string)\n   * [httpservletrequest.html#login(java.lang.string, java.lang.string)](https://docs.oracle.com/javaee/6/api/javax/servlet/http/httpservletrequest.html#login(java.lang.string, java.lang.string))\n   * httpservletrequest.html#logout()\n\n\n# 3.2 @enablewebsecurity\n\næä»¬èªå·±å®ä¹çéç½®ç±»websecurityconfigå ä¸äº@enablewebsecurityæ³¨è§£ï¼åæ¶ç»§æ¿äºwebsecurityconfigureradapterãä½ å¯è½ä¼å¨æ³è°çä½ç¨å¤§ä¸ç¹ï¼æ¯«æ çé®@enablewebsecurityèµ·å°å³å®æ§çéç½®ä½ç¨ï¼å®å¶å®æ¯ä¸ªç»åæ³¨è§£ã\n\n@import({ websecurityconfiguration.class, // <2>\n      springwebmvcimportselector.class }) // <1>\n@enableglobalauthentication // <3>\n@configuration\npublic @interface enablewebsecurity {\n   boolean debug() default false;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n@importæ¯springbootæä¾çç¨äºå¼å¥å¤é¨çéç½®çæ³¨è§£ï¼å¯ä»¥çè§£ä¸ºï¼@enablewebsecurityæ³¨è§£æ¿æ´»äº@importæ³¨è§£ä¸­åå«çéç½®ç±»ã\n\n<1> springwebmvcimportselectorçä½ç¨æ¯å¤æ­å½åçç¯å¢æ¯å¦åå«springmvcï¼å ä¸ºspring securityå¯ä»¥å¨éspringç¯å¢ä¸ä½¿ç¨ï¼ä¸ºäºé¿ådispatcherservletçéå¤éç½®ï¼æä»¥ä½¿ç¨äºè¿ä¸ªæ³¨è§£æ¥åºåã\n\n<2> websecurityconfigurationé¡¾åæä¹ï¼æ¯ç¨æ¥éç½®webå®å¨çï¼ä¸é¢çå°èä¼è¯¦ç»ä»ç»ã\n\n<3> @enableglobalauthenticationæ³¨è§£çæºç å¦ä¸ï¼\n\n@import(authenticationconfiguration.class)\n@configuration\npublic @interface enableglobalauthentication {\n}\n\n\n1\n2\n3\n4\n\n\næ³¨æç¹åæ ·å¨@importä¹ä¸­ï¼å®å®éä¸æ¿æ´»äºauthenticationconfigurationè¿æ ·çä¸ä¸ªéç½®ç±»ï¼ç¨æ¥éç½®è®¤è¯ç¸å³çæ ¸å¿ç±»ã\n\nä¹å°±æ¯è¯´ï¼@enablewebsecurityå®æçå·¥ä½ä¾¿æ¯å è½½äºwebsecurityconfigurationï¼authenticationconfigurationè¿ä¸¤ä¸ªæ ¸å¿éç½®ç±»ï¼ä¹å°±æ­¤å°spring securityçèè´£ååä¸ºäºéç½®å®å¨ä¿¡æ¯ï¼éç½®è®¤è¯ä¿¡æ¯ä¸¤é¨åã\n\n# websecurityconfiguration\n\nå¨è¿ä¸ªéç½®ç±»ä¸­ï¼æä¸ä¸ªéå¸¸éè¦çbeanè¢«æ³¨åäºã\n\n@configuration\npublic class websecurityconfiguration {\n\n\t//default_filter_name = "springsecurityfilterchain"\n\t@bean(name = abstractsecuritywebapplicationinitializer.default_filter_name)\n    public filter springsecurityfilterchain() throws exception {\n    \t...\n    }\n\n }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¨æªä½¿ç¨springbootä¹åï¼å¤§å¤æ°äººé½åºè¯¥å¯¹âspringsecurityfilterchainâè¿ä¸ªåè¯ä¸ä¼éçï¼ä»æ¯spring securityçæ ¸å¿è¿æ»¤å¨ï¼æ¯æ´ä¸ªè®¤è¯çå¥å£ãå¨æ¾ç»çxmléç½®ä¸­ï¼æ³è¦å¯ç¨spring securityï¼éè¦å¨web.xmlä¸­è¿è¡å¦ä¸éç½®ï¼\n\n\x3c!-- spring security --\x3e\n<filter>\n    <filter-name>springsecurityfilterchain</filter-name>\n    <filter-class>org.springframework.web.filter.delegatingfilterproxy</filter-class>\n</filter>\n\n<filter-mapping>\n    <filter-name>springsecurityfilterchain</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nèå¨springbootéæä¹åï¼è¿æ ·çxmlè¢«javaéç½®åä»£ãwebsecurityconfigurationä¸­å®æäºå£°æspringsecurityfilterchainçä½ç¨ï¼å¹¶ä¸æç»äº¤ç»delegatingfilterproxyè¿ä¸ªä»£çç±»ï¼è´è´£æ¦æªè¯·æ±ï¼æ³¨ædelegatingfilterproxyè¿ä¸ªç±»ä¸æ¯spring securityåä¸­çï¼èæ¯å­å¨äºwebåä¸­ï¼springä½¿ç¨äºä»£çæ¨¡å¼æ¥å®ç°å®å¨è¿æ»¤çè§£è¦ï¼ã\n\n# authenticationconfiguration\n\n@configuration\n@import(objectpostprocessorconfiguration.class)\npublic class authenticationconfiguration {\n\n  \t@bean\n\tpublic authenticationmanagerbuilder authenticationmanagerbuilder(\n\t\t\tobjectpostprocessor<object> objectpostprocessor) {\n\t\treturn new authenticationmanagerbuilder(objectpostprocessor);\n\t}\n\n  \tpublic authenticationmanager getauthenticationmanager() throws exception {\n    \t...\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nauthenticationconfigurationçä¸»è¦ä»»å¡ï¼ä¾¿æ¯è´è´£çæå¨å±çèº«ä»½è®¤è¯ç®¡çèauthenticationmanagerãè¿è®°å¾å¨ãspring security(ä¸)âarchitecture overviewãä¸­ï¼ä»ç»äºspring securityçè®¤è¯ä½ç³»ï¼authenticationmanagerä¾¿æ¯ææ ¸å¿çèº«ä»½è®¤è¯ç®¡çå¨ã\n\n\n# 3.3 websecurityconfigureradapter\n\nééå¨æ¨¡å¼å¨springä¸­è¢«å¹¿æ³çä½¿ç¨ï¼å¨éç½®ä¸­ä½¿ç¨adapterçå¥½å¤ä¾¿æ¯ï¼æä»¬å¯ä»¥éæ©æ§çéç½®æ³è¦ä¿®æ¹çé£ä¸é¨åéç½®ï¼èä¸ç¨è¦çå¶ä»ä¸ç¸å³çéç½®ãwebsecurityconfigureradapterä¸­æä»¬å¯ä»¥éæ©èªå·±æ³è¦ä¿®æ¹çåå®¹ï¼æ¥è¿è¡éåï¼èå¶æä¾äºä¸ä¸ªconfigureéè½½æ¹æ³ï¼æ¯æä»¬ä¸»è¦å³å¿çï¼\n\n\n\nwebsecurityconfigureradapterä¸­çconfigure\n\nç±åæ°å°±å¯ä»¥ç¥éï¼åå«æ¯å¯¹authenticationmanagerbuilderï¼websecurityï¼httpsecurityè¿è¡ä¸ªæ§åçéç½®ã\n\n# httpsecurityå¸¸ç¨éç½®\n\n@configuration\n@enablewebsecurity\npublic class customwebsecurityconfig extends websecurityconfigureradapter {\n\n    @override\n    protected void configure(httpsecurity http) throws exception {\n        http\n            .authorizerequests()\n                .antmatchers("/resources/**", "/signup", "/about").permitall()\n                .antmatchers("/admin/**").hasrole("admin")\n                .antmatchers("/db/**").access("hasrole(\'admin\') and hasrole(\'dba\')")\n                .anyrequest().authenticated()\n                .and()\n            .formlogin()\n                .usernameparameter("username")\n                .passwordparameter("password")\n                .failureforwardurl("/login?error")\n                .loginpage("/login")\n                .permitall()\n                .and()\n            .logout()\n                .logouturl("/logout")\n                .logoutsuccessurl("/index")\n                .permitall()\n                .and()\n            .httpbasic()\n                .disable();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nä¸è¿°æ¯ä¸ä¸ªä½¿ç¨java configurationéç½®httpsecurityçå¸åéç½®ï¼å¶ä¸­httpä½ä¸ºæ ¹å¼å§éç½®ï¼æ¯ä¸ä¸ªand()å¯¹åºäºä¸ä¸ªæ¨¡åçéç½®ï¼ç­åäºxmléç½®ä¸­çç»ææ ç­¾ï¼ï¼å¹¶ä¸and()è¿åäºhttpsecurityæ¬èº«ï¼äºæ¯å¯ä»¥è¿ç»­è¿è¡éç½®ãä»ä»¬éç½®çå«ä¹ä¹éå¸¸å®¹æéè¿åéæ¬èº«æ¥æ¨æµï¼\n\n * authorizerequests()éç½®è·¯å¾æ¦æªï¼è¡¨æè·¯å¾è®¿é®æå¯¹åºçæéï¼è§è²ï¼è®¤è¯ä¿¡æ¯ã\n * formlogin()å¯¹åºè¡¨åè®¤è¯ç¸å³çéç½®\n * logout()å¯¹åºäºæ³¨éç¸å³çéç½®\n * httpbasic()å¯ä»¥éç½®basicç»å½\n * etc\n\nä»ä»¬åå«ä»£è¡¨äºhttpè¯·æ±ç¸å³çå®å¨éç½®ï¼è¿äºéç½®é¡¹æ ä¸ä¾å¤çè¿åäºconfigurerç±»ï¼èææçhttpç¸å³éç½®å¯ä»¥éè¿æ¥çhttpsecurityçä¸»è¦æ¹æ³å¾ç¥ï¼\n\nhttp://kirito.iocoder.cn/qq%e5%9b%be%e7%89%8720170924223252.png\n\néè¦å¯¹httpåè®®æä¸å®çäºè§£æè½å®å¨ææ¡ææçéç½®ï¼ä¸è¿ï¼springbootåspring securityçèªå¨éç½®å·²ç»è¶³å¤ä½¿ç¨äºãå¶ä¸­æ¯ä¸é¡¹configurerï¼e.g.formloginconfigurer,csrfconfigurerï¼é½æ¯httpconfigurerçç»åéç½®é¡¹ã\n\n# websecuritybuilder\n\n@configuration\n@enablewebsecurity\npublic class websecurityconfig extends websecurityconfigureradapter {\n    @override\n    public void configure(websecurity web) throws exception {\n        web\n            .ignoring()\n            .antmatchers("/resources/**");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä»¥ç¬èçç»éªï¼è¿ä¸ªéç½®ä¸­å¹¶ä¸ä¼åºç°å¤ªå¤çéç½®ä¿¡æ¯ã\n\n# authenticationmanagerbuilder\n\n@configuration\n@enablewebsecurity\npublic class websecurityconfig extends websecurityconfigureradapter {\n\n    @override\n    protected void configure(authenticationmanagerbuilder auth) throws exception {\n        auth\n            .inmemoryauthentication()\n            .withuser("admin").password("admin").roles("user");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\næ³è¦å¨websecurityconfigureradapterä¸­è¿è¡è®¤è¯ç¸å³çéç½®ï¼å¯ä»¥ä½¿ç¨configure(authenticationmanagerbuilder auth)æ´é²ä¸ä¸ªauthenticationmanagerçå»ºé å¨ï¼authenticationmanagerbuilder ãå¦ä¸æç¤ºï¼æä»¬ä¾¿å®æäºåå­ä¸­ç¨æ·çéç½®ã\n\nç»å¿çæåä¼åç°ï¼å¨åé¢çæç« ä¸­æä»¬éç½®åå­ä¸­çç¨æ·æ¶ï¼ä¼¼ä¹ä¸æ¯è¿ä¹éç½®çï¼èæ¯ï¼\n\n@configuration\n@enablewebsecurity\npublic class websecurityconfig extends websecurityconfigureradapter {\n\n    @autowired\n    public void configureglobal(authenticationmanagerbuilder auth) throws exception {\n        auth\n            .inmemoryauthentication()\n                .withuser("admin").password("admin").roles("user");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¦æä½ çåºç¨åªæå¯ä¸ä¸ä¸ªwebsecurityconfigureradapterï¼é£ä¹ä»ä»¬ä¹é´çå·®è·å¯ä»¥è¢«å¿½ç¥ï¼ä»æ¹æ³åå¯ä»¥çåºä¸¤èçåºå«ï¼ä½¿ç¨@autowiredæ³¨å¥çauthenticationmanagerbuilderæ¯å¨å±çèº«ä»½è®¤è¯å¨ï¼ä½ç¨åå¯ä»¥è·¨è¶å¤ä¸ªwebsecurityconfigureradapterï¼ä»¥åå½±åå°åºäºmethodçå®å¨æ§å¶ï¼è protected configure()çæ¹å¼åç±»ä¼¼äºä¸ä¸ªå¿ååé¨ç±»ï¼å®çä½ç¨åå±éäºä¸ä¸ªwebsecurityconfigureradapteråé¨ãå³äºè¿ä¸ç¹çåºå«ï¼å¯ä»¥åèææ¾ç»æåºçissuespring-security#issues4571ãå®æ¹ææ¡£ä¸­ï¼ä¹ç»åºäºéç½®å¤ä¸ªwebsecurityconfigureradapterçåºæ¯ä»¥ådemoï¼å°å¨è¯¥ç³»åçåç»­æç« ä¸­è§£è¯»ã',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ãèå¾ãSpring Security(å) ââ æ ¸å¿è¿æ»¤å¨æºç åæ",frontmatter:{title:"ãèå¾ãSpring Security(å) ââ æ ¸å¿è¿æ»¤å¨æºç åæ",date:"2022-02-03T00:03:27.000Z",permalink:"/pages/bb2ce5/",categories:["åç«¯","Spring Security"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/25.Spring%20Security/04.%E3%80%90%E8%80%81%E5%BE%90%E3%80%91Spring%20Security(%E5%9B%9B)%20%E2%80%94%E2%80%94%20%E6%A0%B8%E5%BF%83%E8%BF%87%E6%BB%A4%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90.html",relativePath:"10.æ¡æ¶/25.Spring Security/04.ãèå¾ãSpring Security(å) ââ æ ¸å¿è¿æ»¤å¨æºç åæ.md",key:"v-30695d13",path:"/pages/bb2ce5/",headers:[{level:2,title:"4 è¿æ»¤å¨è¯¦è§£",slug:"_4-è¿æ»¤å¨è¯¦è§£",normalizedTitle:"4 è¿æ»¤å¨è¯¦è§£",charIndex:75},{level:3,title:"4.1 æ ¸å¿è¿æ»¤å¨æ¦è¿°",slug:"_4-1-æ ¸å¿è¿æ»¤å¨æ¦è¿°",normalizedTitle:"4.1 æ ¸å¿è¿æ»¤å¨æ¦è¿°",charIndex:345},{level:3,title:"4.2 SecurityContextPersistenceFilter",slug:"_4-2-securitycontextpersistencefilter",normalizedTitle:"4.2 securitycontextpersistencefilter",charIndex:2831},{level:3,title:"4.3 UsernamePasswordAuthenticationFilter",slug:"_4-3-usernamepasswordauthenticationfilter",normalizedTitle:"4.3 usernamepasswordauthenticationfilter",charIndex:8105},{level:3,title:"4.4 AnonymousAuthenticationFilter",slug:"_4-4-anonymousauthenticationfilter",normalizedTitle:"4.4 anonymousauthenticationfilter",charIndex:11442},{level:3,title:"4.5 ExceptionTranslationFilter",slug:"_4-5-exceptiontranslationfilter",normalizedTitle:"4.5 exceptiontranslationfilter",charIndex:14196},{level:3,title:"4.6 FilterSecurityInterceptor",slug:"_4-6-filtersecurityinterceptor",normalizedTitle:"4.6 filtersecurityinterceptor",charIndex:18631},{level:3,title:"æ»ç»",slug:"æ»ç»",normalizedTitle:"æ»ç»",charIndex:19866}],headersStr:"4 è¿æ»¤å¨è¯¦è§£ 4.1 æ ¸å¿è¿æ»¤å¨æ¦è¿° 4.2 SecurityContextPersistenceFilter 4.3 UsernamePasswordAuthenticationFilter 4.4 AnonymousAuthenticationFilter 4.5 ExceptionTranslationFilter 4.6 FilterSecurityInterceptor æ»ç»",content:'æè¦: åååºå¤ https://www.cnkirito.moe/spring-security-4/ ãèå¾ãæ¬¢è¿è½¬è½½ï¼ä¿çæè¦ï¼è°¢è°¢ï¼\n\n * 4 è¿æ»¤å¨è¯¦è§£\n\n----------------------------------------\n\n----------------------------------------\n\nåé¢çé¨åï¼æä»¬å³æ³¨äºSpring Securityæ¯å¦ä½å®æè®¤è¯å·¥ä½çï¼ä½æ¯å¦å¤ä¸é¨åæ ¸å¿çåå®¹ï¼è¿æ»¤å¨ï¼ä¸ç´æ²¡ææå°ï¼æä»¬å·²ç»ç¥éSpring Securityä½¿ç¨äºspringSecurityFilterChainä½ä¸ºäºå®å¨è¿æ»¤çå¥å£ï¼è¿ä¸èä¸»è¦åæä¸ä¸è¿ä¸ªè¿æ»¤å¨é¾é½åå«äºåªäºå³é®çè¿æ»¤å¨ï¼å¹¶ä¸åèªçä½¿å½æ¯ä»ä¹ã\n\n\n# 4 è¿æ»¤å¨è¯¦è§£\n\n\n# 4.1 æ ¸å¿è¿æ»¤å¨æ¦è¿°\n\nç±äºè¿æ»¤å¨é¾è·¯ä¸­çè¿æ»¤è¾å¤ï¼å³ä½¿æ¯Spring Securityçå®æ¹ææ¡£ä¸­ä¹å¹¶æªå¯¹ææçè¿æ»¤å¨è¿è¡ä»ç»ï¼å¨ä¹åï¼ãSpring Security(äº)âGuidesãå¥é¨æåä¸­æä»¬éç½®äºä¸ä¸ªè¡¨åç»å½çdemoï¼ä»¥æ­¤ä¸ºä¾ï¼æ¥ççè¿è¿ç¨ä¸­Spring Securityé½å¸®æä»¬èªå¨éç½®äºåªäºè¿æ»¤å¨ã\n\nCreating filter chain: o.s.s.web.util.matcher.AnyRequestMatcher@1,\n[o.s.s.web.context.SecurityContextPersistenceFilter@8851ce1,\no.s.s.web.header.HeaderWriterFilter@6a472566, o.s.s.web.csrf.CsrfFilter@61cd1c71,\no.s.s.web.authentication.logout.LogoutFilter@5e1d03d7,\no.s.s.web.authentication.UsernamePasswordAuthenticationFilter@122d6c22,\no.s.s.web.savedrequest.RequestCacheAwareFilter@5ef6fd7f,\no.s.s.web.servletapi.SecurityContextHolderAwareRequestFilter@4beaf6bd,\no.s.s.web.authentication.AnonymousAuthenticationFilter@6edcad64,\no.s.s.web.session.SessionManagementFilter@5e65afb6,\no.s.s.web.access.ExceptionTranslationFilter@5b9396d3,\no.s.s.web.access.intercept.FilterSecurityInterceptor@3c5dbdf8\n]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸è¿°çlogä¿¡æ¯æ¯æä»springbootå¯å¨çæ¥å¿ä¸­CVæå¾ï¼spring securityçè¿æ»¤å¨æ¥å¿æä¸ä¸ªç¹ç¹ï¼logæå°é¡ºåºä¸å®ééç½®é¡ºåºç¬¦åï¼ä¹å°±æå³çSecurityContextPersistenceFilteræ¯æ´ä¸ªè¿æ»¤å¨é¾çç¬¬ä¸ä¸ªè¿æ»¤å¨ï¼èFilterSecurityInterceptoråæ¯æ«ç½®çè¿æ»¤å¨ãå¦å¤éè¿è§å¯è¿æ»¤å¨çåç§°ï¼åæå¨çååï¼å¯ä»¥å¤§è´å°åæåºä»ä»¬åèªçä½ç¨ï¼å¦UsernamePasswordAuthenticationFilterææ¾ä¾¿æ¯ä¸ä½¿ç¨ç¨æ·ååå¯ç ç»å½ç¸å³çè¿æ»¤å¨ï¼èFilterSecurityInterceptoræä»¬ä¼¼ä¹çä¸åºå®çä½ç¨ï¼ä½æ¯å¶ä½äºweb.accessåä¸ï¼å¤§è´å¯ä»¥åæåºä»ä¸è®¿é®éå¶ç¸å³ãç¬¬åç¯æç« ä¸»è¦å°±æ¯ä»ç»è¿äºå¸¸ç¨çè¿æ»¤å¨ï¼å¯¹å¶ä¸­å³é®çè¿æ»¤å¨è¿è¡ä¸äºæºç åæãåå¤§è´ä»ç»ä¸æ¯ä¸ªè¿æ»¤å¨çä½ç¨ï¼\n\n * SecurityContextPersistenceFilter ä¸¤ä¸ªä¸»è¦èè´£ï¼è¯·æ±æ¥ä¸´æ¶ï¼åå»ºSecurityContextå®å¨ä¸ä¸æä¿¡æ¯ï¼è¯·æ±ç»ææ¶æ¸ç©ºSecurityContextHolderã\n * HeaderWriterFilter (ææ¡£ä¸­å¹¶æªä»ç»ï¼éæ ¸å¿è¿æ»¤å¨) ç¨æ¥ç»httpååºæ·»å ä¸äºHeader,æ¯å¦X-Frame-Options, X-XSS-Protection*ï¼X-Content-Type-Options.\n * CsrfFilter å¨spring4è¿ä¸ªçæ¬ä¸­è¢«é»è®¤å¼å¯çä¸ä¸ªè¿æ»¤å¨ï¼ç¨äºé²æ­¢csrfæ»å»ï¼äºè§£ååç«¯åç¦»çäººä¸å®ä¸ä¼å¯¹è¿ä¸ªæ»å»æ¹å¼æå°éçï¼ååç«¯ä½¿ç¨jsonäº¤äºéè¦æ³¨æçä¸ä¸ªé®é¢ã\n * LogoutFilter é¡¾åæä¹ï¼å¤çæ³¨éçè¿æ»¤å¨\n * UsernamePasswordAuthenticationFilter è¿ä¸ªä¼éç¹åæï¼è¡¨åæäº¤äºusernameåpasswordï¼è¢«å°è£ætokenè¿è¡ä¸ç³»åçè®¤è¯ï¼ä¾¿æ¯ä¸»è¦éè¿è¿ä¸ªè¿æ»¤å¨å®æçï¼å¨è¡¨åè®¤è¯çæ¹æ³ä¸­ï¼è¿æ¯ææå³é®çè¿æ»¤å¨ã\n * RequestCacheAwareFilter (ææ¡£ä¸­å¹¶æªä»ç»ï¼éæ ¸å¿è¿æ»¤å¨) åé¨ç»´æ¤äºä¸ä¸ªRequestCacheï¼ç¨äºç¼å­requestè¯·æ±\n * SecurityContextHolderAwareRequestFilter æ­¤è¿æ»¤å¨å¯¹ServletRequestè¿è¡äºä¸æ¬¡åè£ï¼ä½¿å¾requestå·ææ´å ä¸°å¯çAPI\n * AnonymousAuthenticationFilter å¿åèº«ä»½è¿æ»¤å¨ï¼è¿ä¸ªè¿æ»¤å¨ä¸ªäººè®¤ä¸ºå¾éè¦ï¼éè¦å°å®ä¸UsernamePasswordAuthenticationFilter æ¾å¨ä¸èµ·æ¯è¾çè§£ï¼spring securityä¸ºäºå¼å®¹æªç»å½çè®¿é®ï¼ä¹èµ°äºä¸å¥è®¤è¯æµç¨ï¼åªä¸è¿æ¯ä¸ä¸ªå¿åçèº«ä»½ã\n * SessionManagementFilter åsessionç¸å³çè¿æ»¤å¨ï¼åé¨ç»´æ¤äºä¸ä¸ªSessionAuthenticationStrategyï¼ä¸¤èç»åä½¿ç¨ï¼å¸¸ç¨æ¥é²æ­¢session-fixation protection attackï¼ä»¥åéå¶åä¸ç¨æ·å¼å¯å¤ä¸ªä¼è¯çæ°é\n * ExceptionTranslationFilter ç´è¯æå¼å¸¸ç¿»è¯è¿æ»¤å¨ï¼è¿æ¯æ¯è¾å½¢è±¡çï¼è¿ä¸ªè¿æ»¤å¨æ¬èº«ä¸å¤çå¼å¸¸ï¼èæ¯å°è®¤è¯è¿ç¨ä¸­åºç°çå¼å¸¸äº¤ç»åé¨ç»´æ¤çä¸äºç±»å»å¤çï¼å·ä½æ¯é£äºç±»ä¸é¢è¯¦ç»ä»ç»\n * FilterSecurityInterceptor è¿ä¸ªè¿æ»¤å¨å³å®äºè®¿é®ç¹å®è·¯å¾åºè¯¥å·å¤çæéï¼è®¿é®çç¨æ·çè§è²ï¼æéæ¯ä»ä¹ï¼è®¿é®çè·¯å¾éè¦ä»ä¹æ ·çè§è²åæéï¼è¿äºå¤æ­åå¤çé½æ¯ç±è¯¥ç±»è¿è¡çã\n\nå¶ä¸­å ç²çè¿æ»¤å¨å¯ä»¥è¢«è®¤ä¸ºæ¯Spring Securityçæ ¸å¿è¿æ»¤å¨ï¼å°å¨ä¸é¢ï¼ä¸ä¸ªè¿æ»¤å¨å¯¹åºä¸ä¸ªå°èæ¥è®²è§£ã\n\n\n# 4.2 SecurityContextPersistenceFilter\n\nè¯æ³ä¸ä¸ï¼å¦ææä»¬ä¸ä½¿ç¨Spring Securityï¼å¦æä¿å­ç¨æ·ä¿¡æ¯å¢ï¼å¤§å¤æ°æåµä¸ä¼èèä½¿ç¨Sessionå¯¹å§ï¼å¨Spring Securityä¸­ä¹æ¯å¦æ­¤ï¼ç¨æ·å¨ç»å½è¿ä¸æ¬¡ä¹åï¼åç»­çè®¿é®ä¾¿æ¯éè¿sessionIdæ¥è¯å«ï¼ä»èè®¤ä¸ºç¨æ·å·²ç»è¢«è®¤è¯ãå·ä½å¨ä½å¤å­æ¾ç¨æ·ä¿¡æ¯ï¼ä¾¿æ¯ç¬¬ä¸ç¯æç« ä¸­æå°çSecurityContextHolderï¼è®¤è¯ç¸å³çä¿¡æ¯æ¯å¦ä½è¢«å­æ¾å°å¶ä¸­çï¼ä¾¿æ¯éè¿SecurityContextPersistenceFilterãå¨4.1æ¦è¿°ä¸­ä¹æå°äºï¼SecurityContextPersistenceFilterçä¸¤ä¸ªä¸»è¦ä½ç¨ä¾¿æ¯è¯·æ±æ¥ä¸´æ¶ï¼åå»ºSecurityContextå®å¨ä¸ä¸æä¿¡æ¯åè¯·æ±ç»ææ¶æ¸ç©ºSecurityContextHolderãé¡ºå¸¦æä¸ä¸ï¼å¾®æå¡çä¸ä¸ªè®¾è®¡çå¿µéè¦å®ç°æå¡éä¿¡çæ ç¶æï¼èhttpåè®®ä¸­çæ ç¶ææå³çä¸åè®¸å­å¨sessionï¼è¿å¯ä»¥éè¿setAllowSessionCreation(false) å®ç°ï¼è¿å¹¶ä¸æå³çSecurityContextPersistenceFilteråå¾æ ç¨ï¼å ä¸ºå®è¿éè¦è´è´£æ¸é¤ç¨æ·ä¿¡æ¯ãå¨Spring Securityä¸­ï¼è½ç¶å®å¨ä¸ä¸æä¿¡æ¯è¢«å­å¨äºSessionä¸­ï¼ä½æä»¬å¨å®éä½¿ç¨ä¸­ä¸åºè¯¥ç´æ¥æä½Sessionï¼èåºå½ä½¿ç¨SecurityContextHolderã\n\n# æºç åæ\n\norg.springframework.security.web.context.SecurityContextPersistenceFilter\npublic class SecurityContextPersistenceFilter extends GenericFilterBean {\n\n   static final String FILTER_APPLIED = "__spring_security_scpf_applied";\n   //å®å¨ä¸ä¸æå­å¨çä»åº\n   private SecurityContextRepository repo;\n\n   public SecurityContextPersistenceFilter() {\n      //HttpSessionSecurityContextRepositoryæ¯SecurityContextRepositoryæ¥å£çä¸ä¸ªå®ç°ç±»\n      //ä½¿ç¨HttpSessionæ¥å­å¨SecurityContext\n      this(new HttpSessionSecurityContextRepository());\n   }\n\n   public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain)\n         throws IOException, ServletException {\n      HttpServletRequest request = (HttpServletRequest) req;\n      HttpServletResponse response = (HttpServletResponse) res;\n\n      if (request.getAttribute(FILTER_APPLIED) != null) {\n         // ensure that filter is only applied once per request\n         chain.doFilter(request, response);\n         return;\n      }\n      request.setAttribute(FILTER_APPLIED, Boolean.TRUE);\n      //åè£requestï¼response\n      HttpRequestResponseHolder holder = new HttpRequestResponseHolder(request,\n            response);\n      //ä»Sessionä¸­è·åå®å¨ä¸ä¸æä¿¡æ¯\n      SecurityContext contextBeforeChainExecution = repo.loadContext(holder);\n      try {\n         //è¯·æ±å¼å§æ¶ï¼è®¾ç½®å®å¨ä¸ä¸æä¿¡æ¯ï¼è¿æ ·å°±é¿åäºç¨æ·ç´æ¥ä»Sessionä¸­è·åå®å¨ä¸ä¸æä¿¡æ¯\n         SecurityContextHolder.setContext(contextBeforeChainExecution);\n         chain.doFilter(holder.getRequest(), holder.getResponse());\n      }\n      finally {\n         //è¯·æ±ç»æåï¼æ¸ç©ºå®å¨ä¸ä¸æä¿¡æ¯\n         SecurityContext contextAfterChainExecution = SecurityContextHolder\n               .getContext();\n         SecurityContextHolder.clearContext();\n         repo.saveContext(contextAfterChainExecution, holder.getRequest(),\n               holder.getResponse());\n         request.removeAttribute(FILTER_APPLIED);\n         if (debug) {\n            logger.debug("SecurityContextHolder now cleared, as request processing completed");\n         }\n      }\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n\n\nè¿æ»¤å¨ä¸è¬è´è´£æ ¸å¿çå¤çæµç¨ï¼èå·ä½çä¸å¡å®ç°ï¼éå¸¸äº¤ç»å¶ä¸­èåçå¶ä»å®ä½ç±»ï¼è¿å¨Filterçè®¾è®¡ä¸­å¾å¸¸è§ï¼åæ¶ä¹ç¬¦åèè´£åç¦»æ¨¡å¼ãä¾å¦å­å¨å®å¨ä¸ä¸æåè¯»åå®å¨ä¸ä¸æçå·¥ä½å®å¨å§æç»äºHttpSessionSecurityContextRepositoryå»å¤çï¼èè¿ä¸ªç±»ä¸­ä¹æå ä¸ªæ¹æ³å¯ä»¥ç¨å¾®è§£è¯»ä¸ï¼æ¹ä¾¿æä»¬çè§£åé¨çå·¥ä½æµç¨\n\norg.springframework.security.web.context.HttpSessionSecurityContextRepository\npublic class HttpSessionSecurityContextRepository implements SecurityContextRepository {\n   // \'SPRING_SECURITY_CONTEXT\'æ¯å®å¨ä¸ä¸æé»è®¤å­å¨å¨Sessionä¸­çé®å¼\n   public static final String SPRING_SECURITY_CONTEXT_KEY = "SPRING_SECURITY_CONTEXT";\n   ...\n   private final Object contextObject = SecurityContextHolder.createEmptyContext();\n   private boolean allowSessionCreation = true;\n   private boolean disableUrlRewriting = false;\n   private String springSecurityContextKey = SPRING_SECURITY_CONTEXT_KEY;\n\n   private AuthenticationTrustResolver trustResolver = new AuthenticationTrustResolverImpl();\n\n   //ä»å½årequestä¸­ååºå®å¨ä¸ä¸æï¼å¦æsessionä¸ºç©ºï¼åä¼è¿åä¸ä¸ªæ°çå®å¨ä¸ä¸æ\n   public SecurityContext loadContext(HttpRequestResponseHolder requestResponseHolder) {\n      HttpServletRequest request = requestResponseHolder.getRequest();\n      HttpServletResponse response = requestResponseHolder.getResponse();\n      HttpSession httpSession = request.getSession(false);\n      SecurityContext context = readSecurityContextFromSession(httpSession);\n      if (context == null) {\n         context = generateNewContext();\n      }\n      ...\n      return context;\n   }\n\n   ...\n\n   public boolean containsContext(HttpServletRequest request) {\n      HttpSession session = request.getSession(false);\n      if (session == null) {\n         return false;\n      }\n      return session.getAttribute(springSecurityContextKey) != null;\n   }\n\n   private SecurityContext readSecurityContextFromSession(HttpSession httpSession) {\n      if (httpSession == null) {\n         return null;\n      }\n      ...\n      // Sessionå­å¨çæåµä¸ï¼å°è¯è·åå¶ä¸­çSecurityContext\n      Object contextFromSession = httpSession.getAttribute(springSecurityContextKey);\n      if (contextFromSession == null) {\n         return null;\n      }\n      ...\n      return (SecurityContext) contextFromSession;\n   }\n\n   //åæ¬¡è¯·æ±æ¶åå»ºä¸ä¸ªæ°çSecurityContextå®ä¾\n   protected SecurityContext generateNewContext() {\n      return SecurityContextHolder.createEmptyContext();\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n\n\nSecurityContextPersistenceFilteråHttpSessionSecurityContextRepositoryéåä½¿ç¨ï¼ææäºSpring Securityæ´ä¸ªè°ç¨é¾è·¯çå¥å£ï¼ä¸ºä»ä¹å°å®æ¾å¨æå¼å§çå°æ¹ä¹æ¯æ¾èæè§çï¼åç»­çè¿æ»¤å¨ä¸­å¤§æ¦çä¼ä¾èµSessionä¿¡æ¯åå®å¨ä¸ä¸æä¿¡æ¯ã\n\n\n# 4.3 UsernamePasswordAuthenticationFilter\n\nè¡¨åè®¤è¯æ¯æå¸¸ç¨çä¸ä¸ªè®¤è¯æ¹å¼ï¼ä¸ä¸ªæç´è§çä¸å¡åºæ¯ä¾¿æ¯åè®¸ç¨æ·å¨è¡¨åä¸­è¾å¥ç¨æ·ååå¯ç è¿è¡ç»å½ï¼èè¿èåçUsernamePasswordAuthenticationFilterï¼å¨æ´ä¸ªSpring Securityçè®¤è¯ä½ç³»ä¸­åæ®æ¼çè³å³éè¦çè§è²ã\n\nhttp://kirito.iocoder.cn/2011121410543010.jpg\n\nä¸è¿°çæ¶åºå¾ï¼å¯ä»¥çåºUsernamePasswordAuthenticationFilterä¸»è¦è©è´èµ·äºè°ç¨èº«ä»½è®¤è¯å¨ï¼æ ¡éªèº«ä»½çä½ç¨ï¼è³äºè®¤è¯çç»èï¼å¨åé¢å ç« è±äºå¾å¤§ç¯å¹è¿è¡äºä»ç»ï¼å°è¿éï¼å¶å®Spring Securityçåºæ¬æµç¨å°±å·²ç»èµ°éäºã\n\n# æºç åæ\n\norg.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter#attemptAuthentication\npublic Authentication attemptAuthentication(HttpServletRequest request,\n      HttpServletResponse response) throws AuthenticationException {\n   //è·åè¡¨åä¸­çç¨æ·ååå¯ç \n   String username = obtainUsername(request);\n   String password = obtainPassword(request);\n   ...\n   username = username.trim();\n   //ç»è£æusername+passwordå½¢å¼çtoken\n   UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(\n         username, password);\n   // Allow subclasses to set the "details" property\n   setDetails(request, authRequest);\n   //äº¤ç»åé¨çAuthenticationManagerå»è®¤è¯ï¼å¹¶è¿åè®¤è¯ä¿¡æ¯\n   return this.getAuthenticationManager().authenticate(authRequest);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nUsernamePasswordAuthenticationFilteræ¬èº«çä»£ç åªåå«äºä¸è¿°è¿ä¹ä¸ä¸ªæ¹æ³ï¼éå¸¸ç®ç¥ï¼èå¨å¶ç¶ç±»AbstractAuthenticationProcessingFilterä¸­åå«äºå¤§éçç»èï¼å¼å¾æä»¬åæï¼\n\npublic abstract class AbstractAuthenticationProcessingFilter extends GenericFilterBean\n      implements ApplicationEventPublisherAware, MessageSourceAware {\n\t//åå«äºä¸ä¸ªèº«ä»½è®¤è¯å¨\n\tprivate AuthenticationManager authenticationManager;\n\t//ç¨äºå®ç°remeberMe\n\tprivate RememberMeServices rememberMeServices = new NullRememberMeServices();\n\tprivate RequestMatcher requiresAuthenticationRequestMatcher;\n\t//è¿ä¸¤ä¸ªHandlerå¾å³é®ï¼åå«ä»£è¡¨äºè®¤è¯æååå¤±è´¥ç¸åºçå¤çå¨\n\tprivate AuthenticationSuccessHandler successHandler = new SavedRequestAwareAuthenticationSuccessHandler();\n\tprivate AuthenticationFailureHandler failureHandler = new SimpleUrlAuthenticationFailureHandler();\n\n\tpublic void doFilter(ServletRequest req, ServletResponse res, FilterChain chain)\n\t\t\tthrows IOException, ServletException {\n\n\t\tHttpServletRequest request = (HttpServletRequest) req;\n\t\tHttpServletResponse response = (HttpServletResponse) res;\n\t\t...\n\t\tAuthentication authResult;\n\t\ttry {\n\t\t\t//æ­¤å¤å®éä¸å°±æ¯è°ç¨UsernamePasswordAuthenticationFilterçattemptAuthenticationæ¹æ³\n\t\t\tauthResult = attemptAuthentication(request, response);\n\t\t\tif (authResult == null) {\n\t\t\t\t//å­ç±»æªå®æè®¤è¯ï¼ç«å»è¿å\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsessionStrategy.onAuthentication(authResult, request, response);\n\t\t}\n\t\t//å¨è®¤è¯è¿ç¨ä¸­å¯ä»¥ç´æ¥æåºå¼å¸¸ï¼å¨è¿æ»¤å¨ä¸­ï¼å°±åæ­¤å¤ä¸æ ·ï¼è¿è¡æè·\n\t\tcatch (InternalAuthenticationServiceException failed) {\n\t\t\t//åé¨æå¡å¼å¸¸\n\t\t\tunsuccessfulAuthentication(request, response, failed);\n\t\t\treturn;\n\t\t}\n\t\tcatch (AuthenticationException failed) {\n\t\t\t//è®¤è¯å¤±è´¥\n\t\t\tunsuccessfulAuthentication(request, response, failed);\n\t\t\treturn;\n\t\t}\n\t\t//è®¤è¯æå\n\t\tif (continueChainBeforeSuccessfulAuthentication) {\n\t\t\tchain.doFilter(request, response);\n\t\t}\n\t\t//æ³¨æï¼è®¤è¯æååè¿æ»¤å¨æauthResultç»æä¹ä¼ éç»äºæåå¤çå¨\n\t\tsuccessfulAuthentication(request, response, chain, authResult);\n\t}\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n\n\næ´ä¸ªæµç¨çè§£èµ·æ¥ä¹å¹¶ä¸é¾ï¼ä¸»è¦å°±æ¯åé¨è°ç¨äºauthenticationManagerå®æè®¤è¯ï¼æ ¹æ®è®¤è¯ç»ææ§è¡successfulAuthenticationæèunsuccessfulAuthenticationï¼æ è®ºæåå¤±è´¥ï¼ä¸è¬çå®ç°é½æ¯è½¬åæèéå®åç­å¤çï¼ä¸åç»ç©¶AuthenticationSuccessHandleråAuthenticationFailureHandlerï¼æå´è¶£çæåï¼å¯ä»¥å»ççä¸¤èçå®ç°ç±»ã\n\n\n# 4.4 AnonymousAuthenticationFilter\n\nå¿åè®¤è¯è¿æ»¤å¨ï¼å¯è½æäººä¼æ³ï¼å¿åäºè¿æèº«ä»½ï¼æèªå·±å¯¹äºAnonymouså¿åèº«ä»½ççè§£æ¯Spirng Securityä¸ºäºæ´ä½é»è¾çç»ä¸æ§ï¼å³ä½¿æ¯æªéè¿è®¤è¯çç¨æ·ï¼ä¹ç»äºäºä¸ä¸ªå¿åèº«ä»½ãèAnonymousAuthenticationFilterè¯¥è¿æ»¤å¨çä½ç½®ä¹æ¯éå¸¸çç§å­¦çï¼å®ä½äºå¸¸ç¨çèº«ä»½è®¤è¯è¿æ»¤å¨ï¼å¦UsernamePasswordAuthenticationFilterãBasicAuthenticationFilterãRememberMeAuthenticationFilterï¼ä¹åï¼æå³çåªæå¨ä¸è¿°èº«ä»½è¿æ»¤å¨æ§è¡å®æ¯åï¼SecurityContextä¾æ§æ²¡æç¨æ·ä¿¡æ¯ï¼AnonymousAuthenticationFilterè¯¥è¿æ»¤å¨æä¼ææä¹â-åºäºç¨æ·ä¸ä¸ªå¿åèº«ä»½ã\n\n# æºç åæ\n\norg.springframework.security.web.authentication.AnonymousAuthenticationFilter\npublic class AnonymousAuthenticationFilter extends GenericFilterBean implements\n      InitializingBean {\n\n   private AuthenticationDetailsSource<HttpServletRequest, ?> authenticationDetailsSource = new WebAuthenticationDetailsSource();\n   private String key;\n   private Object principal;\n   private List<GrantedAuthority> authorities;\n\n\n   //èªå¨åå»ºä¸ä¸ª"anonymousUser"çå¿åç¨æ·,å¶å·æANONYMOUSè§è²\n   public AnonymousAuthenticationFilter(String key) {\n      this(key, "anonymousUser", AuthorityUtils.createAuthorityList("ROLE_ANONYMOUS"));\n   }\n\n   /**\n    *\n    * @param key keyç¨æ¥è¯å«è¯¥è¿æ»¤å¨åå»ºçèº«ä»½\n    * @param principal principalä»£è¡¨å¿åç¨æ·çèº«ä»½\n    * @param authorities authoritiesä»£è¡¨å¿åç¨æ·çæééå\n    */\n   public AnonymousAuthenticationFilter(String key, Object principal,\n         List<GrantedAuthority> authorities) {\n      Assert.hasLength(key, "key cannot be null or empty");\n      Assert.notNull(principal, "Anonymous authentication principal must be set");\n      Assert.notNull(authorities, "Anonymous authorities must be set");\n      this.key = key;\n      this.principal = principal;\n      this.authorities = authorities;\n   }\n\n   ...\n\n   public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain)\n         throws IOException, ServletException {\n      //è¿æ»¤å¨é¾é½æ§è¡å°å¿åè®¤è¯è¿æ»¤å¨è¿å¿äºè¿æ²¡æèº«ä»½ä¿¡æ¯ï¼å¡ä¸ä¸ªå¿åèº«ä»½è¿å»\n      if (SecurityContextHolder.getContext().getAuthentication() == null) {\n         SecurityContextHolder.getContext().setAuthentication(\n               createAuthentication((HttpServletRequest) req));\n      }\n      chain.doFilter(req, res);\n   }\n\n   protected Authentication createAuthentication(HttpServletRequest request) {\n     //åå»ºä¸ä¸ªAnonymousAuthenticationToken\n      AnonymousAuthenticationToken auth = new AnonymousAuthenticationToken(key,\n            principal, authorities);\n      auth.setDetails(authenticationDetailsSource.buildDetails(request));\n\n      return auth;\n   }\n   ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n\n\nå¶å®å¯¹æ¯AnonymousAuthenticationFilteråUsernamePasswordAuthenticationFilterå°±å¯ä»¥åç°ä¸äºé¨éäºï¼UsernamePasswordAuthenticationTokenå¯¹åºAnonymousAuthenticationTokenï¼ä»ä»¬é½æ¯Authenticationçå®ç°ç±»ï¼èAuthenticationåæ¯è¢«SecurityContextHolder(SecurityContext)ææçï¼ä¸åé½è¢«ä¸²èå¨äºä¸èµ·ã\n\n\n# 4.5 ExceptionTranslationFilter\n\nExceptionTranslationFilterå¼å¸¸è½¬æ¢è¿æ»¤å¨ä½äºæ´ä¸ªspringSecurityFilterChainçåæ¹ï¼ç¨æ¥è½¬æ¢æ´ä¸ªé¾è·¯ä¸­åºç°çå¼å¸¸ï¼å°å¶è½¬åï¼é¡¾åæä¹ï¼è½¬åä»¥æå³æ¬èº«å¹¶ä¸å¤çãä¸è¬å¶åªå¤çä¸¤å¤§ç±»å¼å¸¸ï¼AccessDeniedExceptionè®¿é®å¼å¸¸åAuthenticationExceptionè®¤è¯å¼å¸¸ã\n\nè¿ä¸ªè¿æ»¤å¨éå¸¸éè¦ï¼å ä¸ºå®å°Javaä¸­çå¼å¸¸åHTTPçååºè¿æ¥å¨äºä¸èµ·ï¼è¿æ ·å¨å¤çå¼å¸¸æ¶ï¼æä»¬ä¸ç¨èèå¯ç éè¯¯è¯¥è·³å°ä»ä¹é¡µé¢ï¼è´¦å·éå®è¯¥å¦ä½ï¼åªéè¦å³æ³¨èªå·±çä¸å¡é»è¾ï¼æåºç¸åºçå¼å¸¸ä¾¿å¯ãå¦æè¯¥è¿æ»¤å¨æ£æµå°AuthenticationExceptionï¼åå°ä¼äº¤ç»åé¨çAuthenticationEntryPointå»å¤çï¼å¦ææ£æµå°AccessDeniedExceptionï¼éè¦åå¤æ­å½åç¨æ·æ¯ä¸æ¯å¿åç¨æ·ï¼å¦ææ¯å¿åè®¿é®ï¼åååé¢ä¸æ ·è¿è¡AuthenticationEntryPointï¼å¦åä¼å§æç»AccessDeniedHandlerå»å¤çï¼èAccessDeniedHandlerçé»è®¤å®ç°ï¼æ¯AccessDeniedHandlerImplãæä»¥ExceptionTranslationFilteråé¨çAuthenticationEntryPointæ¯è³å³éè¦çï¼é¡¾åæä¹ï¼è®¤è¯çå¥å£ç¹ã\n\n# æºç åæ\n\npublic class ExceptionTranslationFilter extends GenericFilterBean {\n  //å¤çå¼å¸¸è½¬æ¢çæ ¸å¿æ¹æ³\n  private void handleSpringSecurityException(HttpServletRequest request,\n        HttpServletResponse response, FilterChain chain, RuntimeException exception)\n        throws IOException, ServletException {\n     if (exception instanceof AuthenticationException) {\n       \t//éå®åå°ç»å½ç«¯ç¹\n        sendStartAuthentication(request, response, chain,\n              (AuthenticationException) exception);\n     }\n     else if (exception instanceof AccessDeniedException) {\n        Authentication authentication = SecurityContextHolder.getContext().getAuthentication();\n        if (authenticationTrustResolver.isAnonymous(authentication) || authenticationTrustResolver.isRememberMe(authentication)) {\n\t\t  //éå®åå°ç»å½ç«¯ç¹\n           sendStartAuthentication(\n                 request,\n                 response,\n                 chain,\n                 new InsufficientAuthenticationException(\n                       "Full authentication is required to access this resource"));\n        }\n        else {\n           //äº¤ç»accessDeniedHandlerå¤ç\n           accessDeniedHandler.handle(request, response,\n                 (AccessDeniedException) exception);\n        }\n     }\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nå©ä¸çä¾¿æ¯è¦ææAuthenticationEntryPointåAccessDeniedHandlerå°±å¯ä»¥äºã\n\nAuthenticationEntryPoint\n\néæ©äºå ä¸ªå¸¸ç¨çç»å½ç«¯ç¹ï¼ä»¥å¶ä¸­ç¬¬ä¸ä¸ªä¸ºä¾æ¥ä»ç»ï¼çåå­å°±è½çå°æ¯è®¤è¯å¤±è´¥ä¹åï¼è®©ç¨æ·è·³è½¬å°ç»å½é¡µé¢ãè¿è®°å¾æä»¬ä¸å¼å§æä¹éç½®è¡¨åç»å½é¡µé¢çåï¼\n\n@Configuration\n@EnableWebSecurity\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        http\n            .authorizeRequests()\n                .antMatchers("/", "/home").permitAll()\n                .anyRequest().authenticated()\n                .and()\n            .formLogin()//FormLoginConfigurer\n                .loginPage("/login")\n                .permitAll()\n                .and()\n            .logout()\n                .permitAll();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\næä»¬é¡ºçformLoginè¿åçFormLoginConfigurerå¾ä¸æ¾ï¼ççè½åç°ä»ä¹ï¼æç»å¨FormLoginConfigurerçç¶ç±»AbstractAuthenticationFilterConfigurerä¸­æäºä¸å°çæ¶è·ï¼\n\npublic abstract class AbstractAuthenticationFilterConfigurer extends ...{\n   ...\n   //formLoginä¸åºææéç½®äºAuthenticationEntryPoint\n   private LoginUrlAuthenticationEntryPoint authenticationEntryPoint;\n   //è®¤è¯å¤±è´¥çå¤çå¨\n   private AuthenticationFailureHandler failureHandler;\n   ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå·ä½å¦ä½éç½®çå°±ä¸çäºï¼æä»¬å¾åºäºç»è®ºï¼formLogin()éç½®äºä¹åæèµ·ç åäºä¸¤ä»¶äºï¼å¶ä¸ï¼ä¸ºUsernamePasswordAuthenticationFilterè®¾ç½®äºç¸å³çéç½®ï¼å¶äºéç½®äºAuthenticationEntryPointã\n\nç»å½ç«¯ç¹è¿æHttp401AuthenticationEntryPointï¼Http403ForbiddenEntryPointè¿äºé½æ¯å¾ç®åçå®ç°ï¼ææ¶åæä»¬è®¿é®åéé¡µé¢ï¼åæ²¡æéç½®ç»å½ï¼å°±çå°äºä¸ä¸ªç©ºè¡è¡çé»è®¤éè¯¯é¡µé¢ï¼ä¸é¢æ¾ç¤ºç401,403ï¼å°±æ¯è¿ä¸¤ä¸ªå¥å£èµ·äºä½ç¨ã\n\nè¿å©ä¸ä¸ä¸ªAccessDeniedHandlerè®¿é®å³ç­å¨æªè¢«è®²è§£ï¼ç®åæä¸ä¸ï¼AccessDeniedHandlerImplè¿ä¸ªé»è®¤å®ç°ç±»ä¼æ ¹æ®errorPageåç¶æç æ¥å¤æ­ï¼æç»å³å®è·³è½¬çé¡µé¢\n\norg.springframework.security.web.access.AccessDeniedHandlerImpl#handle\npublic void handle(HttpServletRequest request, HttpServletResponse response,\n      AccessDeniedException accessDeniedException) throws IOException,\n      ServletException {\n   if (!response.isCommitted()) {\n      if (errorPage != null) {\n         // Put exception into request scope (perhaps of use to a view)\n         request.setAttribute(WebAttributes.ACCESS_DENIED_403,\n               accessDeniedException);\n         // Set the 403 status code.\n         response.setStatus(HttpServletResponse.SC_FORBIDDEN);\n         // forward to error page.\n         RequestDispatcher dispatcher = request.getRequestDispatcher(errorPage);\n         dispatcher.forward(request, response);\n      }\n      else {\n         response.sendError(HttpServletResponse.SC_FORBIDDEN,\n               accessDeniedException.getMessage());\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n\n# 4.6 FilterSecurityInterceptor\n\næ³æ³æ´ä¸ªè®¤è¯å®å¨æ§å¶æµç¨è¿ç¼ºäºä»ä¹ï¼æä»¬å·²ç»æäºè®¤è¯ï¼æäºè¯·æ±çå°è£ï¼æäºSessionçå³èâ¦è¿ç¼ºä¸ä¸ªï¼ç±ä»ä¹æ§å¶åªäºèµæºæ¯åéçï¼è¿äºåéçèµæºéè¦ä»ä¹æéï¼éè¦ä»ä¹è§è²â¦è¿ä¸ååè®¿é®æ§å¶ç¸å³çæä½ï¼é½æ¯ç±FilterSecurityInterceptorå®æçã\n\nFilterSecurityInterceptorçå·¥ä½æµç¨ç¨ç¬èççè§£å¯ä»¥çè§£å¦ä¸ï¼FilterSecurityInterceptorä»SecurityContextHolderä¸­è·åAuthenticationå¯¹è±¡ï¼ç¶åæ¯å¯¹ç¨æ·æ¥æçæéåèµæºæéçæéãåèå¯ä»¥éè¿Authenticationå¯¹è±¡ç´æ¥è·å¾ï¼èåèåéè¦å¼å¥æä»¬ä¹åä¸ç´æªæå°è¿çä¸¤ä¸ªç±»ï¼SecurityMetadataSourceï¼AccessDecisionManagerãçè§£æ¸æ¥å³ç­ç®¡çå¨çæ´ä¸ªåå»ºæµç¨åSecurityMetadataSourceçä½ç¨éè¦è±å¾å¤§ä¸ç¬åå¤«ï¼è¿éï¼ææ¶åªä»ç»å¶å¤§æ¦çä½ç¨ã\n\nå¨JavaConfigçéç½®ä¸­ï¼æä»¬éå¸¸å¦ä¸éç½®è·¯å¾çè®¿é®æ§å¶ï¼\n\n@Override\nprotected void configure(HttpSecurity http) throws Exception {\n\thttp\n\t\t.authorizeRequests()\n\t\t\t.antMatchers("/resources/**", "/signup", "/about").permitAll()\n             .antMatchers("/admin/**").hasRole("ADMIN")\n             .antMatchers("/db/**").access("hasRole(\'ADMIN\') and hasRole(\'DBA\')")\n             .anyRequest().authenticated()\n\t\t\t.withObjectPostProcessor(new ObjectPostProcessor<FilterSecurityInterceptor>() {\n\t\t\t\tpublic <O extends FilterSecurityInterceptor> O postProcess(\n\t\t\t\t\t\tO fsi) {\n\t\t\t\t\tfsi.setPublishAuthorizationSuccess(true);\n\t\t\t\t\treturn fsi;\n\t\t\t\t}\n\t\t\t});\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nå¨ObjectPostProcessorçæ³åä¸­çå°äºFilterSecurityInterceptorï¼ä»¥ç¬èçç»éªï¼ç®åå¹¶æ²¡æå¤ªå¤æºä¼éè¦ä¿®æ¹FilterSecurityInterceptorçéç½®ã\n\n\n# æ»ç»\n\næ¬ç¯æç« å¨ä»ç»è¿æ»¤å¨æ¶ï¼é¡ºä¾¿è¿è¡äºä¸äºæºç çåæï¼ç®çæ¯æ¹ä¾¿çè§£æ´ä¸ªSpring Securityçå·¥ä½æµãä¼´éçæ´ä¸ªè¿æ»¤å¨é¾çä»ç»ï¼å®å¨æ¡æ¶çè½®å»åºè¯¥å·²ç»æµ®åºæ°´é¢äºï¼ä¸é¢çç« èï¼ä¸»è¦æç®éè¿èªå®ä¹ä¸äºéæ±ï¼åæ¬¡åæå¶ä»ç»ä»¶çæºç ï¼å­¦ä¹ åºè¯¥å¦ä½æ¹é Spring Securityï¼ä¸ºæä»¬æç¨ã',normalizedContent:'æè¦: åååºå¤ https://www.cnkirito.moe/spring-security-4/ ãèå¾ãæ¬¢è¿è½¬è½½ï¼ä¿çæè¦ï¼è°¢è°¢ï¼\n\n * 4 è¿æ»¤å¨è¯¦è§£\n\n----------------------------------------\n\n----------------------------------------\n\nåé¢çé¨åï¼æä»¬å³æ³¨äºspring securityæ¯å¦ä½å®æè®¤è¯å·¥ä½çï¼ä½æ¯å¦å¤ä¸é¨åæ ¸å¿çåå®¹ï¼è¿æ»¤å¨ï¼ä¸ç´æ²¡ææå°ï¼æä»¬å·²ç»ç¥éspring securityä½¿ç¨äºspringsecurityfilterchainä½ä¸ºäºå®å¨è¿æ»¤çå¥å£ï¼è¿ä¸èä¸»è¦åæä¸ä¸è¿ä¸ªè¿æ»¤å¨é¾é½åå«äºåªäºå³é®çè¿æ»¤å¨ï¼å¹¶ä¸åèªçä½¿å½æ¯ä»ä¹ã\n\n\n# 4 è¿æ»¤å¨è¯¦è§£\n\n\n# 4.1 æ ¸å¿è¿æ»¤å¨æ¦è¿°\n\nç±äºè¿æ»¤å¨é¾è·¯ä¸­çè¿æ»¤è¾å¤ï¼å³ä½¿æ¯spring securityçå®æ¹ææ¡£ä¸­ä¹å¹¶æªå¯¹ææçè¿æ»¤å¨è¿è¡ä»ç»ï¼å¨ä¹åï¼ãspring security(äº)âguidesãå¥é¨æåä¸­æä»¬éç½®äºä¸ä¸ªè¡¨åç»å½çdemoï¼ä»¥æ­¤ä¸ºä¾ï¼æ¥ççè¿è¿ç¨ä¸­spring securityé½å¸®æä»¬èªå¨éç½®äºåªäºè¿æ»¤å¨ã\n\ncreating filter chain: o.s.s.web.util.matcher.anyrequestmatcher@1,\n[o.s.s.web.context.securitycontextpersistencefilter@8851ce1,\no.s.s.web.header.headerwriterfilter@6a472566, o.s.s.web.csrf.csrffilter@61cd1c71,\no.s.s.web.authentication.logout.logoutfilter@5e1d03d7,\no.s.s.web.authentication.usernamepasswordauthenticationfilter@122d6c22,\no.s.s.web.savedrequest.requestcacheawarefilter@5ef6fd7f,\no.s.s.web.servletapi.securitycontextholderawarerequestfilter@4beaf6bd,\no.s.s.web.authentication.anonymousauthenticationfilter@6edcad64,\no.s.s.web.session.sessionmanagementfilter@5e65afb6,\no.s.s.web.access.exceptiontranslationfilter@5b9396d3,\no.s.s.web.access.intercept.filtersecurityinterceptor@3c5dbdf8\n]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸è¿°çlogä¿¡æ¯æ¯æä»springbootå¯å¨çæ¥å¿ä¸­cvæå¾ï¼spring securityçè¿æ»¤å¨æ¥å¿æä¸ä¸ªç¹ç¹ï¼logæå°é¡ºåºä¸å®ééç½®é¡ºåºç¬¦åï¼ä¹å°±æå³çsecuritycontextpersistencefilteræ¯æ´ä¸ªè¿æ»¤å¨é¾çç¬¬ä¸ä¸ªè¿æ»¤å¨ï¼èfiltersecurityinterceptoråæ¯æ«ç½®çè¿æ»¤å¨ãå¦å¤éè¿è§å¯è¿æ»¤å¨çåç§°ï¼åæå¨çååï¼å¯ä»¥å¤§è´å°åæåºä»ä»¬åèªçä½ç¨ï¼å¦usernamepasswordauthenticationfilterææ¾ä¾¿æ¯ä¸ä½¿ç¨ç¨æ·ååå¯ç ç»å½ç¸å³çè¿æ»¤å¨ï¼èfiltersecurityinterceptoræä»¬ä¼¼ä¹çä¸åºå®çä½ç¨ï¼ä½æ¯å¶ä½äºweb.accessåä¸ï¼å¤§è´å¯ä»¥åæåºä»ä¸è®¿é®éå¶ç¸å³ãç¬¬åç¯æç« ä¸»è¦å°±æ¯ä»ç»è¿äºå¸¸ç¨çè¿æ»¤å¨ï¼å¯¹å¶ä¸­å³é®çè¿æ»¤å¨è¿è¡ä¸äºæºç åæãåå¤§è´ä»ç»ä¸æ¯ä¸ªè¿æ»¤å¨çä½ç¨ï¼\n\n * securitycontextpersistencefilter ä¸¤ä¸ªä¸»è¦èè´£ï¼è¯·æ±æ¥ä¸´æ¶ï¼åå»ºsecuritycontextå®å¨ä¸ä¸æä¿¡æ¯ï¼è¯·æ±ç»ææ¶æ¸ç©ºsecuritycontextholderã\n * headerwriterfilter (ææ¡£ä¸­å¹¶æªä»ç»ï¼éæ ¸å¿è¿æ»¤å¨) ç¨æ¥ç»httpååºæ·»å ä¸äºheader,æ¯å¦x-frame-options, x-xss-protection*ï¼x-content-type-options.\n * csrffilter å¨spring4è¿ä¸ªçæ¬ä¸­è¢«é»è®¤å¼å¯çä¸ä¸ªè¿æ»¤å¨ï¼ç¨äºé²æ­¢csrfæ»å»ï¼äºè§£ååç«¯åç¦»çäººä¸å®ä¸ä¼å¯¹è¿ä¸ªæ»å»æ¹å¼æå°éçï¼ååç«¯ä½¿ç¨jsonäº¤äºéè¦æ³¨æçä¸ä¸ªé®é¢ã\n * logoutfilter é¡¾åæä¹ï¼å¤çæ³¨éçè¿æ»¤å¨\n * usernamepasswordauthenticationfilter è¿ä¸ªä¼éç¹åæï¼è¡¨åæäº¤äºusernameåpasswordï¼è¢«å°è£ætokenè¿è¡ä¸ç³»åçè®¤è¯ï¼ä¾¿æ¯ä¸»è¦éè¿è¿ä¸ªè¿æ»¤å¨å®æçï¼å¨è¡¨åè®¤è¯çæ¹æ³ä¸­ï¼è¿æ¯ææå³é®çè¿æ»¤å¨ã\n * requestcacheawarefilter (ææ¡£ä¸­å¹¶æªä»ç»ï¼éæ ¸å¿è¿æ»¤å¨) åé¨ç»´æ¤äºä¸ä¸ªrequestcacheï¼ç¨äºç¼å­requestè¯·æ±\n * securitycontextholderawarerequestfilter æ­¤è¿æ»¤å¨å¯¹servletrequestè¿è¡äºä¸æ¬¡åè£ï¼ä½¿å¾requestå·ææ´å ä¸°å¯çapi\n * anonymousauthenticationfilter å¿åèº«ä»½è¿æ»¤å¨ï¼è¿ä¸ªè¿æ»¤å¨ä¸ªäººè®¤ä¸ºå¾éè¦ï¼éè¦å°å®ä¸usernamepasswordauthenticationfilter æ¾å¨ä¸èµ·æ¯è¾çè§£ï¼spring securityä¸ºäºå¼å®¹æªç»å½çè®¿é®ï¼ä¹èµ°äºä¸å¥è®¤è¯æµç¨ï¼åªä¸è¿æ¯ä¸ä¸ªå¿åçèº«ä»½ã\n * sessionmanagementfilter åsessionç¸å³çè¿æ»¤å¨ï¼åé¨ç»´æ¤äºä¸ä¸ªsessionauthenticationstrategyï¼ä¸¤èç»åä½¿ç¨ï¼å¸¸ç¨æ¥é²æ­¢session-fixation protection attackï¼ä»¥åéå¶åä¸ç¨æ·å¼å¯å¤ä¸ªä¼è¯çæ°é\n * exceptiontranslationfilter ç´è¯æå¼å¸¸ç¿»è¯è¿æ»¤å¨ï¼è¿æ¯æ¯è¾å½¢è±¡çï¼è¿ä¸ªè¿æ»¤å¨æ¬èº«ä¸å¤çå¼å¸¸ï¼èæ¯å°è®¤è¯è¿ç¨ä¸­åºç°çå¼å¸¸äº¤ç»åé¨ç»´æ¤çä¸äºç±»å»å¤çï¼å·ä½æ¯é£äºç±»ä¸é¢è¯¦ç»ä»ç»\n * filtersecurityinterceptor è¿ä¸ªè¿æ»¤å¨å³å®äºè®¿é®ç¹å®è·¯å¾åºè¯¥å·å¤çæéï¼è®¿é®çç¨æ·çè§è²ï¼æéæ¯ä»ä¹ï¼è®¿é®çè·¯å¾éè¦ä»ä¹æ ·çè§è²åæéï¼è¿äºå¤æ­åå¤çé½æ¯ç±è¯¥ç±»è¿è¡çã\n\nå¶ä¸­å ç²çè¿æ»¤å¨å¯ä»¥è¢«è®¤ä¸ºæ¯spring securityçæ ¸å¿è¿æ»¤å¨ï¼å°å¨ä¸é¢ï¼ä¸ä¸ªè¿æ»¤å¨å¯¹åºä¸ä¸ªå°èæ¥è®²è§£ã\n\n\n# 4.2 securitycontextpersistencefilter\n\nè¯æ³ä¸ä¸ï¼å¦ææä»¬ä¸ä½¿ç¨spring securityï¼å¦æä¿å­ç¨æ·ä¿¡æ¯å¢ï¼å¤§å¤æ°æåµä¸ä¼èèä½¿ç¨sessionå¯¹å§ï¼å¨spring securityä¸­ä¹æ¯å¦æ­¤ï¼ç¨æ·å¨ç»å½è¿ä¸æ¬¡ä¹åï¼åç»­çè®¿é®ä¾¿æ¯éè¿sessionidæ¥è¯å«ï¼ä»èè®¤ä¸ºç¨æ·å·²ç»è¢«è®¤è¯ãå·ä½å¨ä½å¤å­æ¾ç¨æ·ä¿¡æ¯ï¼ä¾¿æ¯ç¬¬ä¸ç¯æç« ä¸­æå°çsecuritycontextholderï¼è®¤è¯ç¸å³çä¿¡æ¯æ¯å¦ä½è¢«å­æ¾å°å¶ä¸­çï¼ä¾¿æ¯éè¿securitycontextpersistencefilterãå¨4.1æ¦è¿°ä¸­ä¹æå°äºï¼securitycontextpersistencefilterçä¸¤ä¸ªä¸»è¦ä½ç¨ä¾¿æ¯è¯·æ±æ¥ä¸´æ¶ï¼åå»ºsecuritycontextå®å¨ä¸ä¸æä¿¡æ¯åè¯·æ±ç»ææ¶æ¸ç©ºsecuritycontextholderãé¡ºå¸¦æä¸ä¸ï¼å¾®æå¡çä¸ä¸ªè®¾è®¡çå¿µéè¦å®ç°æå¡éä¿¡çæ ç¶æï¼èhttpåè®®ä¸­çæ ç¶ææå³çä¸åè®¸å­å¨sessionï¼è¿å¯ä»¥éè¿setallowsessioncreation(false) å®ç°ï¼è¿å¹¶ä¸æå³çsecuritycontextpersistencefilteråå¾æ ç¨ï¼å ä¸ºå®è¿éè¦è´è´£æ¸é¤ç¨æ·ä¿¡æ¯ãå¨spring securityä¸­ï¼è½ç¶å®å¨ä¸ä¸æä¿¡æ¯è¢«å­å¨äºsessionä¸­ï¼ä½æä»¬å¨å®éä½¿ç¨ä¸­ä¸åºè¯¥ç´æ¥æä½sessionï¼èåºå½ä½¿ç¨securitycontextholderã\n\n# æºç åæ\n\norg.springframework.security.web.context.securitycontextpersistencefilter\npublic class securitycontextpersistencefilter extends genericfilterbean {\n\n   static final string filter_applied = "__spring_security_scpf_applied";\n   //å®å¨ä¸ä¸æå­å¨çä»åº\n   private securitycontextrepository repo;\n\n   public securitycontextpersistencefilter() {\n      //httpsessionsecuritycontextrepositoryæ¯securitycontextrepositoryæ¥å£çä¸ä¸ªå®ç°ç±»\n      //ä½¿ç¨httpsessionæ¥å­å¨securitycontext\n      this(new httpsessionsecuritycontextrepository());\n   }\n\n   public void dofilter(servletrequest req, servletresponse res, filterchain chain)\n         throws ioexception, servletexception {\n      httpservletrequest request = (httpservletrequest) req;\n      httpservletresponse response = (httpservletresponse) res;\n\n      if (request.getattribute(filter_applied) != null) {\n         // ensure that filter is only applied once per request\n         chain.dofilter(request, response);\n         return;\n      }\n      request.setattribute(filter_applied, boolean.true);\n      //åè£requestï¼response\n      httprequestresponseholder holder = new httprequestresponseholder(request,\n            response);\n      //ä»sessionä¸­è·åå®å¨ä¸ä¸æä¿¡æ¯\n      securitycontext contextbeforechainexecution = repo.loadcontext(holder);\n      try {\n         //è¯·æ±å¼å§æ¶ï¼è®¾ç½®å®å¨ä¸ä¸æä¿¡æ¯ï¼è¿æ ·å°±é¿åäºç¨æ·ç´æ¥ä»sessionä¸­è·åå®å¨ä¸ä¸æä¿¡æ¯\n         securitycontextholder.setcontext(contextbeforechainexecution);\n         chain.dofilter(holder.getrequest(), holder.getresponse());\n      }\n      finally {\n         //è¯·æ±ç»æåï¼æ¸ç©ºå®å¨ä¸ä¸æä¿¡æ¯\n         securitycontext contextafterchainexecution = securitycontextholder\n               .getcontext();\n         securitycontextholder.clearcontext();\n         repo.savecontext(contextafterchainexecution, holder.getrequest(),\n               holder.getresponse());\n         request.removeattribute(filter_applied);\n         if (debug) {\n            logger.debug("securitycontextholder now cleared, as request processing completed");\n         }\n      }\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n\n\nè¿æ»¤å¨ä¸è¬è´è´£æ ¸å¿çå¤çæµç¨ï¼èå·ä½çä¸å¡å®ç°ï¼éå¸¸äº¤ç»å¶ä¸­èåçå¶ä»å®ä½ç±»ï¼è¿å¨filterçè®¾è®¡ä¸­å¾å¸¸è§ï¼åæ¶ä¹ç¬¦åèè´£åç¦»æ¨¡å¼ãä¾å¦å­å¨å®å¨ä¸ä¸æåè¯»åå®å¨ä¸ä¸æçå·¥ä½å®å¨å§æç»äºhttpsessionsecuritycontextrepositoryå»å¤çï¼èè¿ä¸ªç±»ä¸­ä¹æå ä¸ªæ¹æ³å¯ä»¥ç¨å¾®è§£è¯»ä¸ï¼æ¹ä¾¿æä»¬çè§£åé¨çå·¥ä½æµç¨\n\norg.springframework.security.web.context.httpsessionsecuritycontextrepository\npublic class httpsessionsecuritycontextrepository implements securitycontextrepository {\n   // \'spring_security_context\'æ¯å®å¨ä¸ä¸æé»è®¤å­å¨å¨sessionä¸­çé®å¼\n   public static final string spring_security_context_key = "spring_security_context";\n   ...\n   private final object contextobject = securitycontextholder.createemptycontext();\n   private boolean allowsessioncreation = true;\n   private boolean disableurlrewriting = false;\n   private string springsecuritycontextkey = spring_security_context_key;\n\n   private authenticationtrustresolver trustresolver = new authenticationtrustresolverimpl();\n\n   //ä»å½årequestä¸­ååºå®å¨ä¸ä¸æï¼å¦æsessionä¸ºç©ºï¼åä¼è¿åä¸ä¸ªæ°çå®å¨ä¸ä¸æ\n   public securitycontext loadcontext(httprequestresponseholder requestresponseholder) {\n      httpservletrequest request = requestresponseholder.getrequest();\n      httpservletresponse response = requestresponseholder.getresponse();\n      httpsession httpsession = request.getsession(false);\n      securitycontext context = readsecuritycontextfromsession(httpsession);\n      if (context == null) {\n         context = generatenewcontext();\n      }\n      ...\n      return context;\n   }\n\n   ...\n\n   public boolean containscontext(httpservletrequest request) {\n      httpsession session = request.getsession(false);\n      if (session == null) {\n         return false;\n      }\n      return session.getattribute(springsecuritycontextkey) != null;\n   }\n\n   private securitycontext readsecuritycontextfromsession(httpsession httpsession) {\n      if (httpsession == null) {\n         return null;\n      }\n      ...\n      // sessionå­å¨çæåµä¸ï¼å°è¯è·åå¶ä¸­çsecuritycontext\n      object contextfromsession = httpsession.getattribute(springsecuritycontextkey);\n      if (contextfromsession == null) {\n         return null;\n      }\n      ...\n      return (securitycontext) contextfromsession;\n   }\n\n   //åæ¬¡è¯·æ±æ¶åå»ºä¸ä¸ªæ°çsecuritycontextå®ä¾\n   protected securitycontext generatenewcontext() {\n      return securitycontextholder.createemptycontext();\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n\n\nsecuritycontextpersistencefilteråhttpsessionsecuritycontextrepositoryéåä½¿ç¨ï¼ææäºspring securityæ´ä¸ªè°ç¨é¾è·¯çå¥å£ï¼ä¸ºä»ä¹å°å®æ¾å¨æå¼å§çå°æ¹ä¹æ¯æ¾èæè§çï¼åç»­çè¿æ»¤å¨ä¸­å¤§æ¦çä¼ä¾èµsessionä¿¡æ¯åå®å¨ä¸ä¸æä¿¡æ¯ã\n\n\n# 4.3 usernamepasswordauthenticationfilter\n\nè¡¨åè®¤è¯æ¯æå¸¸ç¨çä¸ä¸ªè®¤è¯æ¹å¼ï¼ä¸ä¸ªæç´è§çä¸å¡åºæ¯ä¾¿æ¯åè®¸ç¨æ·å¨è¡¨åä¸­è¾å¥ç¨æ·ååå¯ç è¿è¡ç»å½ï¼èè¿èåçusernamepasswordauthenticationfilterï¼å¨æ´ä¸ªspring securityçè®¤è¯ä½ç³»ä¸­åæ®æ¼çè³å³éè¦çè§è²ã\n\nhttp://kirito.iocoder.cn/2011121410543010.jpg\n\nä¸è¿°çæ¶åºå¾ï¼å¯ä»¥çåºusernamepasswordauthenticationfilterä¸»è¦è©è´èµ·äºè°ç¨èº«ä»½è®¤è¯å¨ï¼æ ¡éªèº«ä»½çä½ç¨ï¼è³äºè®¤è¯çç»èï¼å¨åé¢å ç« è±äºå¾å¤§ç¯å¹è¿è¡äºä»ç»ï¼å°è¿éï¼å¶å®spring securityçåºæ¬æµç¨å°±å·²ç»èµ°éäºã\n\n# æºç åæ\n\norg.springframework.security.web.authentication.usernamepasswordauthenticationfilter#attemptauthentication\npublic authentication attemptauthentication(httpservletrequest request,\n      httpservletresponse response) throws authenticationexception {\n   //è·åè¡¨åä¸­çç¨æ·ååå¯ç \n   string username = obtainusername(request);\n   string password = obtainpassword(request);\n   ...\n   username = username.trim();\n   //ç»è£æusername+passwordå½¢å¼çtoken\n   usernamepasswordauthenticationtoken authrequest = new usernamepasswordauthenticationtoken(\n         username, password);\n   // allow subclasses to set the "details" property\n   setdetails(request, authrequest);\n   //äº¤ç»åé¨çauthenticationmanagerå»è®¤è¯ï¼å¹¶è¿åè®¤è¯ä¿¡æ¯\n   return this.getauthenticationmanager().authenticate(authrequest);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nusernamepasswordauthenticationfilteræ¬èº«çä»£ç åªåå«äºä¸è¿°è¿ä¹ä¸ä¸ªæ¹æ³ï¼éå¸¸ç®ç¥ï¼èå¨å¶ç¶ç±»abstractauthenticationprocessingfilterä¸­åå«äºå¤§éçç»èï¼å¼å¾æä»¬åæï¼\n\npublic abstract class abstractauthenticationprocessingfilter extends genericfilterbean\n      implements applicationeventpublisheraware, messagesourceaware {\n\t//åå«äºä¸ä¸ªèº«ä»½è®¤è¯å¨\n\tprivate authenticationmanager authenticationmanager;\n\t//ç¨äºå®ç°remeberme\n\tprivate remembermeservices remembermeservices = new nullremembermeservices();\n\tprivate requestmatcher requiresauthenticationrequestmatcher;\n\t//è¿ä¸¤ä¸ªhandlerå¾å³é®ï¼åå«ä»£è¡¨äºè®¤è¯æååå¤±è´¥ç¸åºçå¤çå¨\n\tprivate authenticationsuccesshandler successhandler = new savedrequestawareauthenticationsuccesshandler();\n\tprivate authenticationfailurehandler failurehandler = new simpleurlauthenticationfailurehandler();\n\n\tpublic void dofilter(servletrequest req, servletresponse res, filterchain chain)\n\t\t\tthrows ioexception, servletexception {\n\n\t\thttpservletrequest request = (httpservletrequest) req;\n\t\thttpservletresponse response = (httpservletresponse) res;\n\t\t...\n\t\tauthentication authresult;\n\t\ttry {\n\t\t\t//æ­¤å¤å®éä¸å°±æ¯è°ç¨usernamepasswordauthenticationfilterçattemptauthenticationæ¹æ³\n\t\t\tauthresult = attemptauthentication(request, response);\n\t\t\tif (authresult == null) {\n\t\t\t\t//å­ç±»æªå®æè®¤è¯ï¼ç«å»è¿å\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsessionstrategy.onauthentication(authresult, request, response);\n\t\t}\n\t\t//å¨è®¤è¯è¿ç¨ä¸­å¯ä»¥ç´æ¥æåºå¼å¸¸ï¼å¨è¿æ»¤å¨ä¸­ï¼å°±åæ­¤å¤ä¸æ ·ï¼è¿è¡æè·\n\t\tcatch (internalauthenticationserviceexception failed) {\n\t\t\t//åé¨æå¡å¼å¸¸\n\t\t\tunsuccessfulauthentication(request, response, failed);\n\t\t\treturn;\n\t\t}\n\t\tcatch (authenticationexception failed) {\n\t\t\t//è®¤è¯å¤±è´¥\n\t\t\tunsuccessfulauthentication(request, response, failed);\n\t\t\treturn;\n\t\t}\n\t\t//è®¤è¯æå\n\t\tif (continuechainbeforesuccessfulauthentication) {\n\t\t\tchain.dofilter(request, response);\n\t\t}\n\t\t//æ³¨æï¼è®¤è¯æååè¿æ»¤å¨æauthresultç»æä¹ä¼ éç»äºæåå¤çå¨\n\t\tsuccessfulauthentication(request, response, chain, authresult);\n\t}\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n\n\næ´ä¸ªæµç¨çè§£èµ·æ¥ä¹å¹¶ä¸é¾ï¼ä¸»è¦å°±æ¯åé¨è°ç¨äºauthenticationmanagerå®æè®¤è¯ï¼æ ¹æ®è®¤è¯ç»ææ§è¡successfulauthenticationæèunsuccessfulauthenticationï¼æ è®ºæåå¤±è´¥ï¼ä¸è¬çå®ç°é½æ¯è½¬åæèéå®åç­å¤çï¼ä¸åç»ç©¶authenticationsuccesshandleråauthenticationfailurehandlerï¼æå´è¶£çæåï¼å¯ä»¥å»ççä¸¤èçå®ç°ç±»ã\n\n\n# 4.4 anonymousauthenticationfilter\n\nå¿åè®¤è¯è¿æ»¤å¨ï¼å¯è½æäººä¼æ³ï¼å¿åäºè¿æèº«ä»½ï¼æèªå·±å¯¹äºanonymouså¿åèº«ä»½ççè§£æ¯spirng securityä¸ºäºæ´ä½é»è¾çç»ä¸æ§ï¼å³ä½¿æ¯æªéè¿è®¤è¯çç¨æ·ï¼ä¹ç»äºäºä¸ä¸ªå¿åèº«ä»½ãèanonymousauthenticationfilterè¯¥è¿æ»¤å¨çä½ç½®ä¹æ¯éå¸¸çç§å­¦çï¼å®ä½äºå¸¸ç¨çèº«ä»½è®¤è¯è¿æ»¤å¨ï¼å¦usernamepasswordauthenticationfilterãbasicauthenticationfilterãremembermeauthenticationfilterï¼ä¹åï¼æå³çåªæå¨ä¸è¿°èº«ä»½è¿æ»¤å¨æ§è¡å®æ¯åï¼securitycontextä¾æ§æ²¡æç¨æ·ä¿¡æ¯ï¼anonymousauthenticationfilterè¯¥è¿æ»¤å¨æä¼ææä¹â-åºäºç¨æ·ä¸ä¸ªå¿åèº«ä»½ã\n\n# æºç åæ\n\norg.springframework.security.web.authentication.anonymousauthenticationfilter\npublic class anonymousauthenticationfilter extends genericfilterbean implements\n      initializingbean {\n\n   private authenticationdetailssource<httpservletrequest, ?> authenticationdetailssource = new webauthenticationdetailssource();\n   private string key;\n   private object principal;\n   private list<grantedauthority> authorities;\n\n\n   //èªå¨åå»ºä¸ä¸ª"anonymoususer"çå¿åç¨æ·,å¶å·æanonymousè§è²\n   public anonymousauthenticationfilter(string key) {\n      this(key, "anonymoususer", authorityutils.createauthoritylist("role_anonymous"));\n   }\n\n   /**\n    *\n    * @param key keyç¨æ¥è¯å«è¯¥è¿æ»¤å¨åå»ºçèº«ä»½\n    * @param principal principalä»£è¡¨å¿åç¨æ·çèº«ä»½\n    * @param authorities authoritiesä»£è¡¨å¿åç¨æ·çæééå\n    */\n   public anonymousauthenticationfilter(string key, object principal,\n         list<grantedauthority> authorities) {\n      assert.haslength(key, "key cannot be null or empty");\n      assert.notnull(principal, "anonymous authentication principal must be set");\n      assert.notnull(authorities, "anonymous authorities must be set");\n      this.key = key;\n      this.principal = principal;\n      this.authorities = authorities;\n   }\n\n   ...\n\n   public void dofilter(servletrequest req, servletresponse res, filterchain chain)\n         throws ioexception, servletexception {\n      //è¿æ»¤å¨é¾é½æ§è¡å°å¿åè®¤è¯è¿æ»¤å¨è¿å¿äºè¿æ²¡æèº«ä»½ä¿¡æ¯ï¼å¡ä¸ä¸ªå¿åèº«ä»½è¿å»\n      if (securitycontextholder.getcontext().getauthentication() == null) {\n         securitycontextholder.getcontext().setauthentication(\n               createauthentication((httpservletrequest) req));\n      }\n      chain.dofilter(req, res);\n   }\n\n   protected authentication createauthentication(httpservletrequest request) {\n     //åå»ºä¸ä¸ªanonymousauthenticationtoken\n      anonymousauthenticationtoken auth = new anonymousauthenticationtoken(key,\n            principal, authorities);\n      auth.setdetails(authenticationdetailssource.builddetails(request));\n\n      return auth;\n   }\n   ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n\n\nå¶å®å¯¹æ¯anonymousauthenticationfilteråusernamepasswordauthenticationfilterå°±å¯ä»¥åç°ä¸äºé¨éäºï¼usernamepasswordauthenticationtokenå¯¹åºanonymousauthenticationtokenï¼ä»ä»¬é½æ¯authenticationçå®ç°ç±»ï¼èauthenticationåæ¯è¢«securitycontextholder(securitycontext)ææçï¼ä¸åé½è¢«ä¸²èå¨äºä¸èµ·ã\n\n\n# 4.5 exceptiontranslationfilter\n\nexceptiontranslationfilterå¼å¸¸è½¬æ¢è¿æ»¤å¨ä½äºæ´ä¸ªspringsecurityfilterchainçåæ¹ï¼ç¨æ¥è½¬æ¢æ´ä¸ªé¾è·¯ä¸­åºç°çå¼å¸¸ï¼å°å¶è½¬åï¼é¡¾åæä¹ï¼è½¬åä»¥æå³æ¬èº«å¹¶ä¸å¤çãä¸è¬å¶åªå¤çä¸¤å¤§ç±»å¼å¸¸ï¼accessdeniedexceptionè®¿é®å¼å¸¸åauthenticationexceptionè®¤è¯å¼å¸¸ã\n\nè¿ä¸ªè¿æ»¤å¨éå¸¸éè¦ï¼å ä¸ºå®å°javaä¸­çå¼å¸¸åhttpçååºè¿æ¥å¨äºä¸èµ·ï¼è¿æ ·å¨å¤çå¼å¸¸æ¶ï¼æä»¬ä¸ç¨èèå¯ç éè¯¯è¯¥è·³å°ä»ä¹é¡µé¢ï¼è´¦å·éå®è¯¥å¦ä½ï¼åªéè¦å³æ³¨èªå·±çä¸å¡é»è¾ï¼æåºç¸åºçå¼å¸¸ä¾¿å¯ãå¦æè¯¥è¿æ»¤å¨æ£æµå°authenticationexceptionï¼åå°ä¼äº¤ç»åé¨çauthenticationentrypointå»å¤çï¼å¦ææ£æµå°accessdeniedexceptionï¼éè¦åå¤æ­å½åç¨æ·æ¯ä¸æ¯å¿åç¨æ·ï¼å¦ææ¯å¿åè®¿é®ï¼åååé¢ä¸æ ·è¿è¡authenticationentrypointï¼å¦åä¼å§æç»accessdeniedhandlerå»å¤çï¼èaccessdeniedhandlerçé»è®¤å®ç°ï¼æ¯accessdeniedhandlerimplãæä»¥exceptiontranslationfilteråé¨çauthenticationentrypointæ¯è³å³éè¦çï¼é¡¾åæä¹ï¼è®¤è¯çå¥å£ç¹ã\n\n# æºç åæ\n\npublic class exceptiontranslationfilter extends genericfilterbean {\n  //å¤çå¼å¸¸è½¬æ¢çæ ¸å¿æ¹æ³\n  private void handlespringsecurityexception(httpservletrequest request,\n        httpservletresponse response, filterchain chain, runtimeexception exception)\n        throws ioexception, servletexception {\n     if (exception instanceof authenticationexception) {\n       \t//éå®åå°ç»å½ç«¯ç¹\n        sendstartauthentication(request, response, chain,\n              (authenticationexception) exception);\n     }\n     else if (exception instanceof accessdeniedexception) {\n        authentication authentication = securitycontextholder.getcontext().getauthentication();\n        if (authenticationtrustresolver.isanonymous(authentication) || authenticationtrustresolver.isrememberme(authentication)) {\n\t\t  //éå®åå°ç»å½ç«¯ç¹\n           sendstartauthentication(\n                 request,\n                 response,\n                 chain,\n                 new insufficientauthenticationexception(\n                       "full authentication is required to access this resource"));\n        }\n        else {\n           //äº¤ç»accessdeniedhandlerå¤ç\n           accessdeniedhandler.handle(request, response,\n                 (accessdeniedexception) exception);\n        }\n     }\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nå©ä¸çä¾¿æ¯è¦ææauthenticationentrypointåaccessdeniedhandlerå°±å¯ä»¥äºã\n\nauthenticationentrypoint\n\néæ©äºå ä¸ªå¸¸ç¨çç»å½ç«¯ç¹ï¼ä»¥å¶ä¸­ç¬¬ä¸ä¸ªä¸ºä¾æ¥ä»ç»ï¼çåå­å°±è½çå°æ¯è®¤è¯å¤±è´¥ä¹åï¼è®©ç¨æ·è·³è½¬å°ç»å½é¡µé¢ãè¿è®°å¾æä»¬ä¸å¼å§æä¹éç½®è¡¨åç»å½é¡µé¢çåï¼\n\n@configuration\n@enablewebsecurity\npublic class websecurityconfig extends websecurityconfigureradapter {\n\n    @override\n    protected void configure(httpsecurity http) throws exception {\n        http\n            .authorizerequests()\n                .antmatchers("/", "/home").permitall()\n                .anyrequest().authenticated()\n                .and()\n            .formlogin()//formloginconfigurer\n                .loginpage("/login")\n                .permitall()\n                .and()\n            .logout()\n                .permitall();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\næä»¬é¡ºçformloginè¿åçformloginconfigurerå¾ä¸æ¾ï¼ççè½åç°ä»ä¹ï¼æç»å¨formloginconfigurerçç¶ç±»abstractauthenticationfilterconfigurerä¸­æäºä¸å°çæ¶è·ï¼\n\npublic abstract class abstractauthenticationfilterconfigurer extends ...{\n   ...\n   //formloginä¸åºææéç½®äºauthenticationentrypoint\n   private loginurlauthenticationentrypoint authenticationentrypoint;\n   //è®¤è¯å¤±è´¥çå¤çå¨\n   private authenticationfailurehandler failurehandler;\n   ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå·ä½å¦ä½éç½®çå°±ä¸çäºï¼æä»¬å¾åºäºç»è®ºï¼formlogin()éç½®äºä¹åæèµ·ç åäºä¸¤ä»¶äºï¼å¶ä¸ï¼ä¸ºusernamepasswordauthenticationfilterè®¾ç½®äºç¸å³çéç½®ï¼å¶äºéç½®äºauthenticationentrypointã\n\nç»å½ç«¯ç¹è¿æhttp401authenticationentrypointï¼http403forbiddenentrypointè¿äºé½æ¯å¾ç®åçå®ç°ï¼ææ¶åæä»¬è®¿é®åéé¡µé¢ï¼åæ²¡æéç½®ç»å½ï¼å°±çå°äºä¸ä¸ªç©ºè¡è¡çé»è®¤éè¯¯é¡µé¢ï¼ä¸é¢æ¾ç¤ºç401,403ï¼å°±æ¯è¿ä¸¤ä¸ªå¥å£èµ·äºä½ç¨ã\n\nè¿å©ä¸ä¸ä¸ªaccessdeniedhandlerè®¿é®å³ç­å¨æªè¢«è®²è§£ï¼ç®åæä¸ä¸ï¼accessdeniedhandlerimplè¿ä¸ªé»è®¤å®ç°ç±»ä¼æ ¹æ®errorpageåç¶æç æ¥å¤æ­ï¼æç»å³å®è·³è½¬çé¡µé¢\n\norg.springframework.security.web.access.accessdeniedhandlerimpl#handle\npublic void handle(httpservletrequest request, httpservletresponse response,\n      accessdeniedexception accessdeniedexception) throws ioexception,\n      servletexception {\n   if (!response.iscommitted()) {\n      if (errorpage != null) {\n         // put exception into request scope (perhaps of use to a view)\n         request.setattribute(webattributes.access_denied_403,\n               accessdeniedexception);\n         // set the 403 status code.\n         response.setstatus(httpservletresponse.sc_forbidden);\n         // forward to error page.\n         requestdispatcher dispatcher = request.getrequestdispatcher(errorpage);\n         dispatcher.forward(request, response);\n      }\n      else {\n         response.senderror(httpservletresponse.sc_forbidden,\n               accessdeniedexception.getmessage());\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n\n# 4.6 filtersecurityinterceptor\n\næ³æ³æ´ä¸ªè®¤è¯å®å¨æ§å¶æµç¨è¿ç¼ºäºä»ä¹ï¼æä»¬å·²ç»æäºè®¤è¯ï¼æäºè¯·æ±çå°è£ï¼æäºsessionçå³èâ¦è¿ç¼ºä¸ä¸ªï¼ç±ä»ä¹æ§å¶åªäºèµæºæ¯åéçï¼è¿äºåéçèµæºéè¦ä»ä¹æéï¼éè¦ä»ä¹è§è²â¦è¿ä¸ååè®¿é®æ§å¶ç¸å³çæä½ï¼é½æ¯ç±filtersecurityinterceptorå®æçã\n\nfiltersecurityinterceptorçå·¥ä½æµç¨ç¨ç¬èççè§£å¯ä»¥çè§£å¦ä¸ï¼filtersecurityinterceptorä»securitycontextholderä¸­è·åauthenticationå¯¹è±¡ï¼ç¶åæ¯å¯¹ç¨æ·æ¥æçæéåèµæºæéçæéãåèå¯ä»¥éè¿authenticationå¯¹è±¡ç´æ¥è·å¾ï¼èåèåéè¦å¼å¥æä»¬ä¹åä¸ç´æªæå°è¿çä¸¤ä¸ªç±»ï¼securitymetadatasourceï¼accessdecisionmanagerãçè§£æ¸æ¥å³ç­ç®¡çå¨çæ´ä¸ªåå»ºæµç¨åsecuritymetadatasourceçä½ç¨éè¦è±å¾å¤§ä¸ç¬åå¤«ï¼è¿éï¼ææ¶åªä»ç»å¶å¤§æ¦çä½ç¨ã\n\nå¨javaconfigçéç½®ä¸­ï¼æä»¬éå¸¸å¦ä¸éç½®è·¯å¾çè®¿é®æ§å¶ï¼\n\n@override\nprotected void configure(httpsecurity http) throws exception {\n\thttp\n\t\t.authorizerequests()\n\t\t\t.antmatchers("/resources/**", "/signup", "/about").permitall()\n             .antmatchers("/admin/**").hasrole("admin")\n             .antmatchers("/db/**").access("hasrole(\'admin\') and hasrole(\'dba\')")\n             .anyrequest().authenticated()\n\t\t\t.withobjectpostprocessor(new objectpostprocessor<filtersecurityinterceptor>() {\n\t\t\t\tpublic <o extends filtersecurityinterceptor> o postprocess(\n\t\t\t\t\t\to fsi) {\n\t\t\t\t\tfsi.setpublishauthorizationsuccess(true);\n\t\t\t\t\treturn fsi;\n\t\t\t\t}\n\t\t\t});\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nå¨objectpostprocessorçæ³åä¸­çå°äºfiltersecurityinterceptorï¼ä»¥ç¬èçç»éªï¼ç®åå¹¶æ²¡æå¤ªå¤æºä¼éè¦ä¿®æ¹filtersecurityinterceptorçéç½®ã\n\n\n# æ»ç»\n\næ¬ç¯æç« å¨ä»ç»è¿æ»¤å¨æ¶ï¼é¡ºä¾¿è¿è¡äºä¸äºæºç çåæï¼ç®çæ¯æ¹ä¾¿çè§£æ´ä¸ªspring securityçå·¥ä½æµãä¼´éçæ´ä¸ªè¿æ»¤å¨é¾çä»ç»ï¼å®å¨æ¡æ¶çè½®å»åºè¯¥å·²ç»æµ®åºæ°´é¢äºï¼ä¸é¢çç« èï¼ä¸»è¦æç®éè¿èªå®ä¹ä¸äºéæ±ï¼åæ¬¡åæå¶ä»ç»ä»¶çæºç ï¼å­¦ä¹ åºè¯¥å¦ä½æ¹é spring securityï¼ä¸ºæä»¬æç¨ã',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ãèå¾ãSpring Security(äº) ââ å¨æå®ç°ä¸ä¸ª IP_Login",frontmatter:{title:"ãèå¾ãSpring Security(äº) ââ å¨æå®ç°ä¸ä¸ª IP_Login",date:"2022-02-03T00:03:27.000Z",permalink:"/pages/754b42/",categories:["åç«¯","Spring Security"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/25.Spring%20Security/05.%E3%80%90%E8%80%81%E5%BE%90%E3%80%91Spring%20Security(%E4%BA%94)%20%E2%80%94%E2%80%94%20%E5%8A%A8%E6%89%8B%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%20IP_Login.html",relativePath:"10.æ¡æ¶/25.Spring Security/05.ãèå¾ãSpring Security(äº) ââ å¨æå®ç°ä¸ä¸ª IP_Login.md",key:"v-27133cbb",path:"/pages/754b42/",headers:[{level:2,title:"5 å¨æå®ç°ä¸ä¸ªIP_Login",slug:"_5-å¨æå®ç°ä¸ä¸ªip-login",normalizedTitle:"5 å¨æå®ç°ä¸ä¸ªip_login",charIndex:75},{level:3,title:"5.1 å®ä¹éæ±",slug:"_5-1-å®ä¹éæ±",normalizedTitle:"5.1 å®ä¹éæ±",charIndex:943},{level:3,title:"5.2 è®¾è®¡æ¦è¿°",slug:"_5-2-è®¾è®¡æ¦è¿°",normalizedTitle:"5.2 è®¾è®¡æ¦è¿°",charIndex:1330},{level:3,title:"5.3 IpAuthenticationToken",slug:"_5-3-ipauthenticationtoken",normalizedTitle:"5.3 ipauthenticationtoken",charIndex:1944},{level:3,title:"5.4 IpAuthenticationProcessingFilter",slug:"_5-4-ipauthenticationprocessingfilter",normalizedTitle:"5.4 ipauthenticationprocessingfilter",charIndex:3010},{level:3,title:"5.5 IpAuthenticationProvider",slug:"_5-5-ipauthenticationprovider",normalizedTitle:"5.5 ipauthenticationprovider",charIndex:3945},{level:3,title:"5.6 éç½®WebSecurityConfigAdapter",slug:"_5-6-éç½®websecurityconfigadapter",normalizedTitle:"5.6 éç½®websecurityconfigadapter",charIndex:5460},{level:3,title:"5.7 éç½®SpringMVC",slug:"_5-7-éç½®springmvc",normalizedTitle:"5.7 éç½®springmvc",charIndex:7922},{level:3,title:"5.8 è¿è¡ææ",slug:"_5-8-è¿è¡ææ",normalizedTitle:"5.8 è¿è¡ææ",charIndex:8507},{level:3,title:"æåçæµç¨",slug:"æåçæµç¨",normalizedTitle:"æåçæµç¨",charIndex:8520},{level:3,title:"å¤±è´¥çæµç¨",slug:"å¤±è´¥çæµç¨",normalizedTitle:"å¤±è´¥çæµç¨",charIndex:8760},{level:3,title:"5.9 æ»ç»",slug:"_5-9-æ»ç»",normalizedTitle:"5.9 æ»ç»",charIndex:8961}],headersStr:"5 å¨æå®ç°ä¸ä¸ªIP_Login 5.1 å®ä¹éæ± 5.2 è®¾è®¡æ¦è¿° 5.3 IpAuthenticationToken 5.4 IpAuthenticationProcessingFilter 5.5 IpAuthenticationProvider 5.6 éç½®WebSecurityConfigAdapter 5.7 éç½®SpringMVC 5.8 è¿è¡ææ æåçæµç¨ å¤±è´¥çæµç¨ 5.9 æ»ç»",content:'æè¦: åååºå¤ https://www.cnkirito.moe/spring-security-5/ ãèå¾ãæ¬¢è¿è½¬è½½ï¼ä¿çæè¦ï¼è°¢è°¢ï¼\n\n * 5 å¨æå®ç°ä¸ä¸ªIP_Login\n\n----------------------------------------\n\n----------------------------------------\n\nå¨å¼å§è¿ç¯æç« ä¹åï¼æä»¬ä¼¼ä¹åºè¯¥æèä¸ä¸ºä»ä¹éè¦ææ¸æ¥Spring Securityçåé¨å·¥ä½åçï¼æç§ç¬¬äºç¯æç« ä¸­çéç½®ï¼ä¸ä¸ªç®åçè¡¨åè®¤è¯ä¸å°±è¾¾æäºåï¼æ´æçèï¼ä¸ºä»ä¹æä»¬ä¸èªå·±åä¸ä¸ªè¡¨åè®¤è¯ï¼ç¨è¿æ»¤å¨å³å¯å®æï¼å¤§è´¹å¨ç« å¼å¥Spring Securityï¼çèµ·æ¥ä¹å¹¶æ²¡ææ¹ä¾¿å¤å°ãå¯¹çï¼å¨å¼å¥Spring Securityä¹åï¼æä»¬å¾é¦åæ³å°ï¼æ¯ä»ä¹éæ±è®©æä»¬å¼å¥äºSpring Securityï¼ä»¥åä¸ºä»ä¹æ¯Spring Securityï¼èä¸æ¯shiroç­ç­å¶ä»å®å¨æ¡æ¶ãæççè§£æ¯æå¦ä¸å ç¹ï¼\n\n1 å¨åæçä»ç»ä¸­ï¼Spring Securityæ¯æé²æ­¢csrfæ»å»ï¼session-fixation protectionï¼æ¯æè¡¨åè®¤è¯ï¼basicè®¤è¯ï¼rememberMeâ¦ç­ç­ä¸äºç¹æ§ï¼æå¾å¤æ¯å¼ç®±å³ç¨çåè½ï¼èå¤§å¤ç¹æ§é½å¯ä»¥éè¿éç½®çµæ´»çåæ´ï¼è¿æ¯å®çå¼ºå¤§ä¹å¤ã\n\n2 Spring Securityçåå¼çé¡¹ç®Spring Security SSOï¼OAuth2ç­æ¯æäºå¤ç§åè®®ï¼èè¿äºé½æ¯åºäºSpring Securityçï¼æ¹ä¾¿äºé¡¹ç®çæ©å±ã\n\n3 SpringBootçæ¯æï¼æ´å ä¿è¯äºSpring Securityçå¼ç®±å³ç¨ã\n\n4 ä¸ºä»ä¹éè¦çè§£å¶åé¨å·¥ä½åç?ä¸ä¸ªæèªæè¿½æ±çç¨åºåé½ä¸ä¼æ»¡è¶³äºæµå°è¾æ­¢ï¼å¦æä¸ä¸ªå¼æºææ¯å¨æä»¬çæ¥å¸¸å·¥ä½ä¸­ååå¸¸ç¨ï¼é£ä¹æååäºéè¯»å¶æºç ï¼è¿æ ·å¯ä»¥è®©æä»¬å³ä½¿ææ¥ä¸æèè³çé®é¢ï¼ä¹æ¹ä¾¿æ¥åéæ±æ©å±ã\n\n5 Springåå¶å­é¡¹ç®çå®æ¹ææ¡£æ¯æè§è¿çæè¯å¿çææ¡£ï¼ç¸æ¯è¾äºApacheçé¨åææ¡£\n\nè¿ä¸èï¼ä¸ºäºå¯¹ä¹ååæçSpring Securityæºç åç»ä»¶æä¸ä¸ªæ¸æ°çè®¤è¯ï¼ä»ç»ä¸ä¸ªä½¿ç¨IPå®æç»å½çç®ådemoã\n\n\n# 5 å¨æå®ç°ä¸ä¸ªIP_Login\n\n\n# 5.1 å®ä¹éæ±\n\nå¨è¡¨åç»å½ä¸­ï¼ä¸è¬ä½¿ç¨æ°æ®åºä¸­éç½®çç¨æ·è¡¨ï¼æéè¡¨ï¼è§è²è¡¨ï¼æéç»è¡¨â¦è¿åå³äºä½ çæéç²åº¦ï¼ä½æ¬è´¨é½æ¯åå©äºä¸ä¸ªæä¹åå­å¨ï¼ç»´æ¤äºç¨æ·çè§è²æéï¼èåç»åºä¸ä¸ª/loginä½ä¸ºç»å½ç«¯ç¹ï¼ä½¿ç¨è¡¨åæäº¤ç¨æ·ååå¯ç ï¼èåå®æç»å½åå¯èªç±è®¿é®åéé¡µé¢ã\n\nå¨æä»¬çIPç»å½demoä¸­ï¼ä¹æ¯ç±»ä¼¼çï¼ä½¿ç¨IPå°åä½ä¸ºèº«ä»½ï¼åå­ä¸­çä¸ä¸ªConcurrentHashMapç»´æ¤IPå°ååæéçæ å°ï¼å¦æå¨è®¤è¯æ¶æ¾ä¸å°ç¸åºçæéï¼åè®¤ä¸ºè®¤è¯å¤±è´¥ã\n\nå®éä¸ï¼å¨è¡¨åç»å½ä¸­ï¼ç¨æ·çIPå°åå·²ç»è¢«å­æ¾å¨Authentication.getDetails()ä¸­äºï¼å®å¨å¯ä»¥åªéåä¸ä¸ªAuthenticationProviderè®¤è¯è¿ä¸ªIPå°åå³å¯ï¼ä½æ¯ï¼æ¬demoæ¯ä¸ºäºåæ¸Spring Securityåé¨å·¥ä½åçèè®¾ç½®ï¼ä¸ºäºè®¾è®¡å°æ´å¤çç±»ï¼æå®å¨éåäºIPè¿æ»¤å¨ã\n\n\n# 5.2 è®¾è®¡æ¦è¿°\n\næä»¬çåèå®å¨æ¯è¡¨åè®¤è¯ï¼å¨ä¹åç« èä¸­ï¼å·²ç»äºè§£äºè¡¨åè®¤è¯ç¸å³çæ ¸å¿æµç¨ï¼å°æ­¤å¾åè´´ä¸éï¼\n\nhttp://kirito.iocoder.cn/2011121410543010.jpg\n\nå¨IPç»å½çdemoä¸­ï¼ä½¿ç¨IpAuthenticationProcessingFilteræ¦æªIPç»å½è¯·æ±ï¼åæ ·ä½¿ç¨ProviderManagerä½ä¸ºå¨å±AuthenticationManageræ¥å£çå®ç°ç±»ï¼å°ProviderManageråé¨çDaoAuthenticationProvideræ¿æ¢ä¸ºIpAuthenticationProviderï¼èUserDetailsServiceåä½¿ç¨ä¸ä¸ªConcurrentHashMapä»£æ¿ãæ´è¯¦ç»ä¸ç¹çè®¾è®¡ï¼\n\n 1. IpAuthenticationProcessingFilterâ>UsernamePasswordAuthenticationFilter\n 2. IpAuthenticationTokenâ>UsernamePasswordAuthenticationToken\n 3. ProviderManagerâ>ProviderManager\n 4. IpAuthenticationProviderâ>DaoAuthenticationProvider\n 5. ConcurrentHashMapâ>UserDetailsService\n\n\n# 5.3 IpAuthenticationToken\n\npublic class IpAuthenticationToken extends AbstractAuthenticationToken {\n\n    private String ip;\n\n    public String getIp() {\n        return ip;\n    }\n\n    public void setIp(String ip) {\n        this.ip = ip;\n    }\n\n    public IpAuthenticationToken(String ip) {\n        super(null);\n        this.ip = ip;\n        super.setAuthenticated(false);//æ³¨æè¿ä¸ªæé æ¹æ³æ¯è®¤è¯æ¶ä½¿ç¨ç\n    }\n\n    public IpAuthenticationToken(String ip, Collection<? extends GrantedAuthority> authorities) {\n        super(authorities);\n        this.ip = ip;\n        super.setAuthenticated(true);//æ³¨æè¿ä¸ªæé æ¹æ³æ¯è®¤è¯æååä½¿ç¨ç\n\n    }\n\n    @Override\n    public Object getCredentials() {\n        return null;\n    }\n\n    @Override\n    public Object getPrincipal() {\n        return this.ip;\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n\n\nä¸¤ä¸ªæé æ¹æ³éè¦å¼èµ·æä»¬çæ³¨æï¼è¿éè®¾è®¡çç¨ææ¯æ¨¡ä»¿çUsernamePasswordAuthenticationTokenï¼ç¬¬ä¸ä¸ªæé å¨æ¯ç¨äºè®¤è¯ä¹åï¼ä¼ éç»è®¤è¯å¨ä½¿ç¨çï¼æä»¥åªæIPå°åï¼èªç¶æ¯æªè®¤è¯ï¼ç¬¬äºä¸ªæé å¨ç¨äºè®¤è¯æåä¹åï¼å°è£è®¤è¯ç¨æ·çä¿¡æ¯ï¼æ­¤æ¶éè¦å°æéä¹è®¾ç½®å°å¶ä¸­ï¼å¹¶ä¸setAuthenticated(true)ãè¿æ ·çè®¾è®¡å¨è¯¸å¤çTokenç±»è®¾è®¡ä¸­å¾å¸¸è§ã\n\n\n# 5.4 IpAuthenticationProcessingFilter\n\npublic class IpAuthenticationProcessingFilter extends AbstractAuthenticationProcessingFilter {\n    //ä½¿ç¨/ipVerifyè¯¥ç«¯ç¹è¿è¡ipè®¤è¯\n    IpAuthenticationProcessingFilter() {\n        super(new AntPathRequestMatcher("/ipVerify"));\n    }\n\n    @Override\n    public Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response) throws AuthenticationException, IOException, ServletException {\n        //è·åhostä¿¡æ¯\n        String host = request.getRemoteHost();\n        //äº¤ç»åé¨çAuthenticationManagerå»è®¤è¯ï¼å®ç°è§£è¦\n        return getAuthenticationManager().authenticate(new IpAuthenticationToken(host));\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n 1. AbstractAuthenticationProcessingFilterè¿ä¸ªè¿æ»¤å¨å¨åé¢ä¸èä»ç»è¿ï¼æ¯UsernamePasswordAuthenticationFilterçç¶ç±»ï¼æä»¬çIpAuthenticationProcessingFilterä¹ç»§æ¿äºå®\n 2. æé å¨ä¸­ä¼ å¥äº/ipVerifyä½ä¸ºIPç»å½çç«¯ç¹\n 3. attemptAuthentication()æ¹æ³ä¸­å è½½è¯·æ±çIPå°åï¼ä¹åäº¤ç»åé¨çAuthenticationManagerå»è®¤è¯\n\n\n# 5.5 IpAuthenticationProvider\n\npublic class IpAuthenticationProvider implements AuthenticationProvider {\n\tfinal static Map<String, SimpleGrantedAuthority> ipAuthorityMap = new ConcurrenHashMap();\n    //ç»´æ¤ä¸ä¸ªipç½åååè¡¨ï¼æ¯ä¸ªipå¯¹åºä¸å®çæé\n    static {\n        ipAuthorityMap.put("127.0.0.1", new SimpleGrantedAuthority("ADMIN"));\n        ipAuthorityMap.put("10.236.69.103", new SimpleGrantedAuthority("ADMIN"));\n        ipAuthorityMap.put("10.236.69.104", new SimpleGrantedAuthority("FRIEND"));\n    }\n\n    @Override\n    public Authentication authenticate(Authentication authentication) throws AuthenticationException {\n        IpAuthenticationToken ipAuthenticationToken = (IpAuthenticationToken) authentication;\n        String ip = ipAuthenticationToken.getIp();\n        SimpleGrantedAuthority simpleGrantedAuthority = ipAuthorityMap.get(ip);\n        //ä¸å¨ç½åååè¡¨ä¸­\n        if (simpleGrantedAuthority == null) {\n            return null;\n        } else {\n            //å°è£æéä¿¡æ¯ï¼å¹¶ä¸æ­¤æ¶èº«ä»½å·²ç»è¢«è®¤è¯\n            return new IpAuthenticationToken(ip, Arrays.asList(simpleGrantedAuthority));\n        }\n    }\n\n    //åªæ¯æIpAuthenticationTokenè¯¥èº«ä»½\n    @Override\n    public boolean supports(Class<?> authentication) {\n        return (IpAuthenticationToken.class\n                .isAssignableFrom(authentication));\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\nreturn new IpAuthenticationToken(ip, Arrays.asList(simpleGrantedAuthority));ä½¿ç¨äºIpAuthenticationTokençç¬¬äºä¸ªæé å¨ï¼è¿åäºä¸ä¸ªå·²ç»ç»è¿è®¤è¯çIpAuthenticationTokenã\n\n\n# 5.6 éç½®WebSecurityConfigAdapter\n\n@Configuration\n@EnableWebSecurity\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n\n    //ipè®¤è¯èéç½®\n    @Bean\n    IpAuthenticationProvider ipAuthenticationProvider() {\n        return new IpAuthenticationProvider();\n    }\n\n    //éç½®å°è£ipAuthenticationTokençè¿æ»¤å¨\n    IpAuthenticationProcessingFilter ipAuthenticationProcessingFilter(AuthenticationManager authenticationManager) {\n        IpAuthenticationProcessingFilter ipAuthenticationProcessingFilter = new IpAuthenticationProcessingFilter();\n        //ä¸ºè¿æ»¤å¨æ·»å è®¤è¯å¨\n        ipAuthenticationProcessingFilter.setAuthenticationManager(authenticationManager);\n        //éåè®¤è¯å¤±è´¥æ¶çè·³è½¬é¡µé¢\n        ipAuthenticationProcessingFilter.setAuthenticationFailureHandler(new SimpleUrlAuthenticationFailureHandler("/ipLogin?error"));\n        return ipAuthenticationProcessingFilter;\n    }\n\n    //éç½®ç»å½ç«¯ç¹\n    @Bean\n    LoginUrlAuthenticationEntryPoint loginUrlAuthenticationEntryPoint(){\n        LoginUrlAuthenticationEntryPoint loginUrlAuthenticationEntryPoint = new LoginUrlAuthenticationEntryPoint\n                ("/ipLogin");\n        return loginUrlAuthenticationEntryPoint;\n    }\n\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        http\n            .authorizeRequests()\n                .antMatchers("/", "/home").permitAll()\n                .antMatchers("/ipLogin").permitAll()\n                .anyRequest().authenticated()\n                .and()\n            .logout()\n                .logoutSuccessUrl("/")\n                .permitAll()\n                .and()\n            .exceptionHandling()\n                .accessDeniedPage("/ipLogin")\n                .authenticationEntryPoint(loginUrlAuthenticationEntryPoint())\n        ;\n\n        //æ³¨åIpAuthenticationProcessingFilter  æ³¨ææ¾ç½®çé¡ºåº è¿å¾å³é®\n        http.addFilterBefore(ipAuthenticationProcessingFilter(authenticationManager()), UsernamePasswordAuthenticationFilter.class);\n\n    }\n\n    @Override\n    protected void configure(AuthenticationManagerBuilder auth) throws Exception {\n        auth.authenticationProvider(ipAuthenticationProvider());\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n\n\nWebSecurityConfigAdapteræä¾äºæä»¬å¾å¤§çä¾¿å©ï¼ä¸éè¦å³æ³¨AuthenticationManagerä»ä¹æ¶åè¢«åå»ºï¼åªéè¦ä½¿ç¨å¶æ´é²çconfigure(AuthenticationManagerBuilder auth)ä¾¿å¯ä»¥æ·»å æä»¬èªå®ä¹çipAuthenticationProviderãå©ä¸çä¸äºç»èï¼æ³¨éä¸­åºæ¬é½åäºåºæ¥ã\n\n\n# 5.7 éç½®SpringMVC\n\n@Configuration\npublic class MvcConfig extends WebMvcConfigurerAdapter {\n\n    @Override\n    public void addViewControllers(ViewControllerRegistry registry) {\n        registry.addViewController("/home").setViewName("home");\n        registry.addViewController("/").setViewName("home");\n        registry.addViewController("/hello").setViewName("hello");\n        registry.addViewController("/ip").setViewName("ipHello");\n        registry.addViewController("/ipLogin").setViewName("ipLogin");\n\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\né¡µé¢çå·ä½åå®¹åè¡¨åç»å½åºæ¬ä¸è´ï¼å¯ä»¥å¨ææ«çæºç ä¸­æ¥çã\n\n\n# 5.8 è¿è¡ææ\n\n\n# æåçæµç¨\n\n * http://127.0.0.1:8080/è®¿é®é¦é¡µï¼å¶ä¸­hereé¾æ¥å°çå°åä¸ºï¼http://127.0.0.1:8080/hello\n\né¦é¡µ\n\n * ç¹å»hereï¼ç±äºhttp://127.0.0.1:8080/helloæ¯åä¿æ¤èµæºï¼æä»¥è·³è½¬å°äºæ ¡éªIPçé¡µé¢ãæ­¤æ¶è¥ç¹å»Sign In by IPæé®ï¼å°ä¼æäº¤å°/ipVerifyç«¯ç¹ï¼è¿è¡IPçè®¤è¯ã\n\nç»å½\n\n * ç»å½æ ¡éªæåä¹åï¼é¡µé¢è¢«æåéå®åå°äºååè®¿é®ç\n\nåä¿æ¤çhelloé¡µ\n\n\n# å¤±è´¥çæµç¨\n\n * æ³¨ææ­¤æ¶å·²ç»æ³¨éäºä¸æ¬¡çç»å½ï¼å¹¶ä¸ï¼ä½¿ç¨äºlocalhost(localhostå127.0.0.1æ¯ä¸¤ä¸ªä¸åçIPå°åï¼æä»¬çåå­ä¸­åªæ127.0.0.1çç¨æ·,æ²¡ælocalhostçç¨æ·)\n\né¦é¡µ\n\n * ç¹å»hereåï¼ç±äºæ²¡æè®¤è¯è¿ï¼ä¾æ§è·³è½¬å°ç»å½é¡µé¢\n   \n   ç»å½\n\n * æ­¤æ¶ï¼æä»¬åç°ä½¿ç¨localhostï¼å¹¶æ²¡æè®¤è¯æåï¼ç¬¦åæä»¬çé¢æ\n\nè®¤è¯å¤±è´¥\n\n\n# 5.9 æ»ç»\n\nä¸ä¸ªç®åçä½¿ç¨Spring Securityæ¥è¿è¡éªè¯IPå°åçç»å½demoå°±å·²ç»å®æäºï¼è¿ä¸ªdemoä¸»è¦æ¯ä¸ºäºæ´å æ¸æ°å°ééSpring Securityåé¨å·¥ä½çåçè®¾ç½®çï¼å¶æ¬èº«æ²¡æå®éçé¡¹ç®æä¹ï¼è®¤è¯IPå¶å®ä¹ä¸åºè¯¥éè¿Spring Securityçè¿æ»¤å¨å»åï¼éä¸æ­¥ä¹åºè¯¥äº¤ç»Filterå»åï¼è¿ä¸ªFilterä¸å­å¨äºSpring Securityçè¿æ»¤å¨é¾ä¸­ï¼ï¼èçæ­£é¡¹ç®ä¸­ï¼å¦æçæ­£è¦åé»ç½ååè¿æ ·çåè½ï¼ä¸è¬éæ©å¨ç½å³å±æènginxçæ©å±æ¨¡åä¸­åãåæ¬¡ç¹å°å¼ºè°ä¸ï¼æå¤§å®¶è¯¯è§£ã\n\næåç¥å¤§å®¶å½åºç©çå¼å¿~\n\næ¬èçä»£ç å¯ä»¥å¨githubä¸­ä¸è½½æºç ï¼https://github.com/lexburner/spring-security-ipLogin',normalizedContent:'æè¦: åååºå¤ https://www.cnkirito.moe/spring-security-5/ ãèå¾ãæ¬¢è¿è½¬è½½ï¼ä¿çæè¦ï¼è°¢è°¢ï¼\n\n * 5 å¨æå®ç°ä¸ä¸ªip_login\n\n----------------------------------------\n\n----------------------------------------\n\nå¨å¼å§è¿ç¯æç« ä¹åï¼æä»¬ä¼¼ä¹åºè¯¥æèä¸ä¸ºä»ä¹éè¦ææ¸æ¥spring securityçåé¨å·¥ä½åçï¼æç§ç¬¬äºç¯æç« ä¸­çéç½®ï¼ä¸ä¸ªç®åçè¡¨åè®¤è¯ä¸å°±è¾¾æäºåï¼æ´æçèï¼ä¸ºä»ä¹æä»¬ä¸èªå·±åä¸ä¸ªè¡¨åè®¤è¯ï¼ç¨è¿æ»¤å¨å³å¯å®æï¼å¤§è´¹å¨ç« å¼å¥spring securityï¼çèµ·æ¥ä¹å¹¶æ²¡ææ¹ä¾¿å¤å°ãå¯¹çï¼å¨å¼å¥spring securityä¹åï¼æä»¬å¾é¦åæ³å°ï¼æ¯ä»ä¹éæ±è®©æä»¬å¼å¥äºspring securityï¼ä»¥åä¸ºä»ä¹æ¯spring securityï¼èä¸æ¯shiroç­ç­å¶ä»å®å¨æ¡æ¶ãæççè§£æ¯æå¦ä¸å ç¹ï¼\n\n1 å¨åæçä»ç»ä¸­ï¼spring securityæ¯æé²æ­¢csrfæ»å»ï¼session-fixation protectionï¼æ¯æè¡¨åè®¤è¯ï¼basicè®¤è¯ï¼remembermeâ¦ç­ç­ä¸äºç¹æ§ï¼æå¾å¤æ¯å¼ç®±å³ç¨çåè½ï¼èå¤§å¤ç¹æ§é½å¯ä»¥éè¿éç½®çµæ´»çåæ´ï¼è¿æ¯å®çå¼ºå¤§ä¹å¤ã\n\n2 spring securityçåå¼çé¡¹ç®spring security ssoï¼oauth2ç­æ¯æäºå¤ç§åè®®ï¼èè¿äºé½æ¯åºäºspring securityçï¼æ¹ä¾¿äºé¡¹ç®çæ©å±ã\n\n3 springbootçæ¯æï¼æ´å ä¿è¯äºspring securityçå¼ç®±å³ç¨ã\n\n4 ä¸ºä»ä¹éè¦çè§£å¶åé¨å·¥ä½åç?ä¸ä¸ªæèªæè¿½æ±çç¨åºåé½ä¸ä¼æ»¡è¶³äºæµå°è¾æ­¢ï¼å¦æä¸ä¸ªå¼æºææ¯å¨æä»¬çæ¥å¸¸å·¥ä½ä¸­ååå¸¸ç¨ï¼é£ä¹æååäºéè¯»å¶æºç ï¼è¿æ ·å¯ä»¥è®©æä»¬å³ä½¿ææ¥ä¸æèè³çé®é¢ï¼ä¹æ¹ä¾¿æ¥åéæ±æ©å±ã\n\n5 springåå¶å­é¡¹ç®çå®æ¹ææ¡£æ¯æè§è¿çæè¯å¿çææ¡£ï¼ç¸æ¯è¾äºapacheçé¨åææ¡£\n\nè¿ä¸èï¼ä¸ºäºå¯¹ä¹ååæçspring securityæºç åç»ä»¶æä¸ä¸ªæ¸æ°çè®¤è¯ï¼ä»ç»ä¸ä¸ªä½¿ç¨ipå®æç»å½çç®ådemoã\n\n\n# 5 å¨æå®ç°ä¸ä¸ªip_login\n\n\n# 5.1 å®ä¹éæ±\n\nå¨è¡¨åç»å½ä¸­ï¼ä¸è¬ä½¿ç¨æ°æ®åºä¸­éç½®çç¨æ·è¡¨ï¼æéè¡¨ï¼è§è²è¡¨ï¼æéç»è¡¨â¦è¿åå³äºä½ çæéç²åº¦ï¼ä½æ¬è´¨é½æ¯åå©äºä¸ä¸ªæä¹åå­å¨ï¼ç»´æ¤äºç¨æ·çè§è²æéï¼èåç»åºä¸ä¸ª/loginä½ä¸ºç»å½ç«¯ç¹ï¼ä½¿ç¨è¡¨åæäº¤ç¨æ·ååå¯ç ï¼èåå®æç»å½åå¯èªç±è®¿é®åéé¡µé¢ã\n\nå¨æä»¬çipç»å½demoä¸­ï¼ä¹æ¯ç±»ä¼¼çï¼ä½¿ç¨ipå°åä½ä¸ºèº«ä»½ï¼åå­ä¸­çä¸ä¸ªconcurrenthashmapç»´æ¤ipå°ååæéçæ å°ï¼å¦æå¨è®¤è¯æ¶æ¾ä¸å°ç¸åºçæéï¼åè®¤ä¸ºè®¤è¯å¤±è´¥ã\n\nå®éä¸ï¼å¨è¡¨åç»å½ä¸­ï¼ç¨æ·çipå°åå·²ç»è¢«å­æ¾å¨authentication.getdetails()ä¸­äºï¼å®å¨å¯ä»¥åªéåä¸ä¸ªauthenticationproviderè®¤è¯è¿ä¸ªipå°åå³å¯ï¼ä½æ¯ï¼æ¬demoæ¯ä¸ºäºåæ¸spring securityåé¨å·¥ä½åçèè®¾ç½®ï¼ä¸ºäºè®¾è®¡å°æ´å¤çç±»ï¼æå®å¨éåäºipè¿æ»¤å¨ã\n\n\n# 5.2 è®¾è®¡æ¦è¿°\n\næä»¬çåèå®å¨æ¯è¡¨åè®¤è¯ï¼å¨ä¹åç« èä¸­ï¼å·²ç»äºè§£äºè¡¨åè®¤è¯ç¸å³çæ ¸å¿æµç¨ï¼å°æ­¤å¾åè´´ä¸éï¼\n\nhttp://kirito.iocoder.cn/2011121410543010.jpg\n\nå¨ipç»å½çdemoä¸­ï¼ä½¿ç¨ipauthenticationprocessingfilteræ¦æªipç»å½è¯·æ±ï¼åæ ·ä½¿ç¨providermanagerä½ä¸ºå¨å±authenticationmanageræ¥å£çå®ç°ç±»ï¼å°providermanageråé¨çdaoauthenticationprovideræ¿æ¢ä¸ºipauthenticationproviderï¼èuserdetailsserviceåä½¿ç¨ä¸ä¸ªconcurrenthashmapä»£æ¿ãæ´è¯¦ç»ä¸ç¹çè®¾è®¡ï¼\n\n 1. ipauthenticationprocessingfilterâ>usernamepasswordauthenticationfilter\n 2. ipauthenticationtokenâ>usernamepasswordauthenticationtoken\n 3. providermanagerâ>providermanager\n 4. ipauthenticationproviderâ>daoauthenticationprovider\n 5. concurrenthashmapâ>userdetailsservice\n\n\n# 5.3 ipauthenticationtoken\n\npublic class ipauthenticationtoken extends abstractauthenticationtoken {\n\n    private string ip;\n\n    public string getip() {\n        return ip;\n    }\n\n    public void setip(string ip) {\n        this.ip = ip;\n    }\n\n    public ipauthenticationtoken(string ip) {\n        super(null);\n        this.ip = ip;\n        super.setauthenticated(false);//æ³¨æè¿ä¸ªæé æ¹æ³æ¯è®¤è¯æ¶ä½¿ç¨ç\n    }\n\n    public ipauthenticationtoken(string ip, collection<? extends grantedauthority> authorities) {\n        super(authorities);\n        this.ip = ip;\n        super.setauthenticated(true);//æ³¨æè¿ä¸ªæé æ¹æ³æ¯è®¤è¯æååä½¿ç¨ç\n\n    }\n\n    @override\n    public object getcredentials() {\n        return null;\n    }\n\n    @override\n    public object getprincipal() {\n        return this.ip;\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n\n\nä¸¤ä¸ªæé æ¹æ³éè¦å¼èµ·æä»¬çæ³¨æï¼è¿éè®¾è®¡çç¨ææ¯æ¨¡ä»¿çusernamepasswordauthenticationtokenï¼ç¬¬ä¸ä¸ªæé å¨æ¯ç¨äºè®¤è¯ä¹åï¼ä¼ éç»è®¤è¯å¨ä½¿ç¨çï¼æä»¥åªæipå°åï¼èªç¶æ¯æªè®¤è¯ï¼ç¬¬äºä¸ªæé å¨ç¨äºè®¤è¯æåä¹åï¼å°è£è®¤è¯ç¨æ·çä¿¡æ¯ï¼æ­¤æ¶éè¦å°æéä¹è®¾ç½®å°å¶ä¸­ï¼å¹¶ä¸setauthenticated(true)ãè¿æ ·çè®¾è®¡å¨è¯¸å¤çtokenç±»è®¾è®¡ä¸­å¾å¸¸è§ã\n\n\n# 5.4 ipauthenticationprocessingfilter\n\npublic class ipauthenticationprocessingfilter extends abstractauthenticationprocessingfilter {\n    //ä½¿ç¨/ipverifyè¯¥ç«¯ç¹è¿è¡ipè®¤è¯\n    ipauthenticationprocessingfilter() {\n        super(new antpathrequestmatcher("/ipverify"));\n    }\n\n    @override\n    public authentication attemptauthentication(httpservletrequest request, httpservletresponse response) throws authenticationexception, ioexception, servletexception {\n        //è·åhostä¿¡æ¯\n        string host = request.getremotehost();\n        //äº¤ç»åé¨çauthenticationmanagerå»è®¤è¯ï¼å®ç°è§£è¦\n        return getauthenticationmanager().authenticate(new ipauthenticationtoken(host));\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n 1. abstractauthenticationprocessingfilterè¿ä¸ªè¿æ»¤å¨å¨åé¢ä¸èä»ç»è¿ï¼æ¯usernamepasswordauthenticationfilterçç¶ç±»ï¼æä»¬çipauthenticationprocessingfilterä¹ç»§æ¿äºå®\n 2. æé å¨ä¸­ä¼ å¥äº/ipverifyä½ä¸ºipç»å½çç«¯ç¹\n 3. attemptauthentication()æ¹æ³ä¸­å è½½è¯·æ±çipå°åï¼ä¹åäº¤ç»åé¨çauthenticationmanagerå»è®¤è¯\n\n\n# 5.5 ipauthenticationprovider\n\npublic class ipauthenticationprovider implements authenticationprovider {\n\tfinal static map<string, simplegrantedauthority> ipauthoritymap = new concurrenhashmap();\n    //ç»´æ¤ä¸ä¸ªipç½åååè¡¨ï¼æ¯ä¸ªipå¯¹åºä¸å®çæé\n    static {\n        ipauthoritymap.put("127.0.0.1", new simplegrantedauthority("admin"));\n        ipauthoritymap.put("10.236.69.103", new simplegrantedauthority("admin"));\n        ipauthoritymap.put("10.236.69.104", new simplegrantedauthority("friend"));\n    }\n\n    @override\n    public authentication authenticate(authentication authentication) throws authenticationexception {\n        ipauthenticationtoken ipauthenticationtoken = (ipauthenticationtoken) authentication;\n        string ip = ipauthenticationtoken.getip();\n        simplegrantedauthority simplegrantedauthority = ipauthoritymap.get(ip);\n        //ä¸å¨ç½åååè¡¨ä¸­\n        if (simplegrantedauthority == null) {\n            return null;\n        } else {\n            //å°è£æéä¿¡æ¯ï¼å¹¶ä¸æ­¤æ¶èº«ä»½å·²ç»è¢«è®¤è¯\n            return new ipauthenticationtoken(ip, arrays.aslist(simplegrantedauthority));\n        }\n    }\n\n    //åªæ¯æipauthenticationtokenè¯¥èº«ä»½\n    @override\n    public boolean supports(class<?> authentication) {\n        return (ipauthenticationtoken.class\n                .isassignablefrom(authentication));\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\nreturn new ipauthenticationtoken(ip, arrays.aslist(simplegrantedauthority));ä½¿ç¨äºipauthenticationtokençç¬¬äºä¸ªæé å¨ï¼è¿åäºä¸ä¸ªå·²ç»ç»è¿è®¤è¯çipauthenticationtokenã\n\n\n# 5.6 éç½®websecurityconfigadapter\n\n@configuration\n@enablewebsecurity\npublic class websecurityconfig extends websecurityconfigureradapter {\n\n    //ipè®¤è¯èéç½®\n    @bean\n    ipauthenticationprovider ipauthenticationprovider() {\n        return new ipauthenticationprovider();\n    }\n\n    //éç½®å°è£ipauthenticationtokençè¿æ»¤å¨\n    ipauthenticationprocessingfilter ipauthenticationprocessingfilter(authenticationmanager authenticationmanager) {\n        ipauthenticationprocessingfilter ipauthenticationprocessingfilter = new ipauthenticationprocessingfilter();\n        //ä¸ºè¿æ»¤å¨æ·»å è®¤è¯å¨\n        ipauthenticationprocessingfilter.setauthenticationmanager(authenticationmanager);\n        //éåè®¤è¯å¤±è´¥æ¶çè·³è½¬é¡µé¢\n        ipauthenticationprocessingfilter.setauthenticationfailurehandler(new simpleurlauthenticationfailurehandler("/iplogin?error"));\n        return ipauthenticationprocessingfilter;\n    }\n\n    //éç½®ç»å½ç«¯ç¹\n    @bean\n    loginurlauthenticationentrypoint loginurlauthenticationentrypoint(){\n        loginurlauthenticationentrypoint loginurlauthenticationentrypoint = new loginurlauthenticationentrypoint\n                ("/iplogin");\n        return loginurlauthenticationentrypoint;\n    }\n\n    @override\n    protected void configure(httpsecurity http) throws exception {\n        http\n            .authorizerequests()\n                .antmatchers("/", "/home").permitall()\n                .antmatchers("/iplogin").permitall()\n                .anyrequest().authenticated()\n                .and()\n            .logout()\n                .logoutsuccessurl("/")\n                .permitall()\n                .and()\n            .exceptionhandling()\n                .accessdeniedpage("/iplogin")\n                .authenticationentrypoint(loginurlauthenticationentrypoint())\n        ;\n\n        //æ³¨åipauthenticationprocessingfilter  æ³¨ææ¾ç½®çé¡ºåº è¿å¾å³é®\n        http.addfilterbefore(ipauthenticationprocessingfilter(authenticationmanager()), usernamepasswordauthenticationfilter.class);\n\n    }\n\n    @override\n    protected void configure(authenticationmanagerbuilder auth) throws exception {\n        auth.authenticationprovider(ipauthenticationprovider());\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n\n\nwebsecurityconfigadapteræä¾äºæä»¬å¾å¤§çä¾¿å©ï¼ä¸éè¦å³æ³¨authenticationmanagerä»ä¹æ¶åè¢«åå»ºï¼åªéè¦ä½¿ç¨å¶æ´é²çconfigure(authenticationmanagerbuilder auth)ä¾¿å¯ä»¥æ·»å æä»¬èªå®ä¹çipauthenticationproviderãå©ä¸çä¸äºç»èï¼æ³¨éä¸­åºæ¬é½åäºåºæ¥ã\n\n\n# 5.7 éç½®springmvc\n\n@configuration\npublic class mvcconfig extends webmvcconfigureradapter {\n\n    @override\n    public void addviewcontrollers(viewcontrollerregistry registry) {\n        registry.addviewcontroller("/home").setviewname("home");\n        registry.addviewcontroller("/").setviewname("home");\n        registry.addviewcontroller("/hello").setviewname("hello");\n        registry.addviewcontroller("/ip").setviewname("iphello");\n        registry.addviewcontroller("/iplogin").setviewname("iplogin");\n\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\né¡µé¢çå·ä½åå®¹åè¡¨åç»å½åºæ¬ä¸è´ï¼å¯ä»¥å¨ææ«çæºç ä¸­æ¥çã\n\n\n# 5.8 è¿è¡ææ\n\n\n# æåçæµç¨\n\n * http://127.0.0.1:8080/è®¿é®é¦é¡µï¼å¶ä¸­hereé¾æ¥å°çå°åä¸ºï¼http://127.0.0.1:8080/hello\n\né¦é¡µ\n\n * ç¹å»hereï¼ç±äºhttp://127.0.0.1:8080/helloæ¯åä¿æ¤èµæºï¼æä»¥è·³è½¬å°äºæ ¡éªipçé¡µé¢ãæ­¤æ¶è¥ç¹å»sign in by ipæé®ï¼å°ä¼æäº¤å°/ipverifyç«¯ç¹ï¼è¿è¡ipçè®¤è¯ã\n\nç»å½\n\n * ç»å½æ ¡éªæåä¹åï¼é¡µé¢è¢«æåéå®åå°äºååè®¿é®ç\n\nåä¿æ¤çhelloé¡µ\n\n\n# å¤±è´¥çæµç¨\n\n * æ³¨ææ­¤æ¶å·²ç»æ³¨éäºä¸æ¬¡çç»å½ï¼å¹¶ä¸ï¼ä½¿ç¨äºlocalhost(localhostå127.0.0.1æ¯ä¸¤ä¸ªä¸åçipå°åï¼æä»¬çåå­ä¸­åªæ127.0.0.1çç¨æ·,æ²¡ælocalhostçç¨æ·)\n\né¦é¡µ\n\n * ç¹å»hereåï¼ç±äºæ²¡æè®¤è¯è¿ï¼ä¾æ§è·³è½¬å°ç»å½é¡µé¢\n   \n   ç»å½\n\n * æ­¤æ¶ï¼æä»¬åç°ä½¿ç¨localhostï¼å¹¶æ²¡æè®¤è¯æåï¼ç¬¦åæä»¬çé¢æ\n\nè®¤è¯å¤±è´¥\n\n\n# 5.9 æ»ç»\n\nä¸ä¸ªç®åçä½¿ç¨spring securityæ¥è¿è¡éªè¯ipå°åçç»å½demoå°±å·²ç»å®æäºï¼è¿ä¸ªdemoä¸»è¦æ¯ä¸ºäºæ´å æ¸æ°å°ééspring securityåé¨å·¥ä½çåçè®¾ç½®çï¼å¶æ¬èº«æ²¡æå®éçé¡¹ç®æä¹ï¼è®¤è¯ipå¶å®ä¹ä¸åºè¯¥éè¿spring securityçè¿æ»¤å¨å»åï¼éä¸æ­¥ä¹åºè¯¥äº¤ç»filterå»åï¼è¿ä¸ªfilterä¸å­å¨äºspring securityçè¿æ»¤å¨é¾ä¸­ï¼ï¼èçæ­£é¡¹ç®ä¸­ï¼å¦æçæ­£è¦åé»ç½ååè¿æ ·çåè½ï¼ä¸è¬éæ©å¨ç½å³å±æènginxçæ©å±æ¨¡åä¸­åãåæ¬¡ç¹å°å¼ºè°ä¸ï¼æå¤§å®¶è¯¯è§£ã\n\næåç¥å¤§å®¶å½åºç©çå¼å¿~\n\næ¬èçä»£ç å¯ä»¥å¨githubä¸­ä¸è½½æºç ï¼https://github.com/lexburner/spring-security-iplogin',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼ä¸ï¼",frontmatter:{title:"ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼ä¸ï¼",date:"2022-02-03T00:03:27.000Z",permalink:"/pages/79202c/",categories:["åç«¯","Spring Security"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/25.Spring%20Security/06.%E3%80%90%E8%80%81%E5%BE%90%E3%80%91%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%20Spring%20Security%20OAuth2%EF%BC%88%E4%B8%80%EF%BC%89.html",relativePath:"10.æ¡æ¶/25.Spring Security/06.ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼ä¸ï¼.md",key:"v-2203d9c2",path:"/pages/79202c/",headers:[{level:2,title:"åè¨",slug:"åè¨",normalizedTitle:"åè¨",charIndex:230},{level:2,title:"æ¦è¿°",slug:"æ¦è¿°",normalizedTitle:"æ¦è¿°",charIndex:236},{level:2,title:"é¡¹ç®åå¤",slug:"é¡¹ç®åå¤",normalizedTitle:"é¡¹ç®åå¤",charIndex:242},{level:2,title:"éç½®èµæºæå¡å¨åæææå¡å¨",slug:"éç½®èµæºæå¡å¨åæææå¡å¨",normalizedTitle:"éç½®èµæºæå¡å¨åæææå¡å¨",charIndex:250},{level:2,title:"éç½®spring security",slug:"éç½®spring-security",normalizedTitle:"éç½®spring security",charIndex:267},{level:2,title:"è·åtoken",slug:"è·åtoken",normalizedTitle:"è·åtoken",charIndex:288},{level:2,title:"ç¤ºä¾ä»£ç ä¸è½½",slug:"ç¤ºä¾ä»£ç ä¸è½½",normalizedTitle:"ç¤ºä¾ä»£ç ä¸è½½",charIndex:299}],headersStr:"åè¨ æ¦è¿° é¡¹ç®åå¤ éç½®èµæºæå¡å¨åæææå¡å¨ éç½®spring security è·åtoken ç¤ºä¾ä»£ç ä¸è½½",content:'æè¦: åååºå¤ [https://www.cnkirito.moe/Re%EF%BC%9A%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Spring%20Security%20OAuth2%EF%BC%88%E4%B8%80%EF%BC%89/](https://www.cnkirito.moe/Reï¼ä»é¶å¼å§çSpring Security OAuth2ï¼ä¸ï¼/) ãèå¾ãæ¬¢è¿è½¬è½½ï¼ä¿çæè¦ï¼è°¢è°¢ï¼\n\n * åè¨\n * æ¦è¿°\n * é¡¹ç®åå¤\n * éç½®èµæºæå¡å¨åæææå¡å¨\n * éç½®spring security\n * è·åtoken\n * ç¤ºä¾ä»£ç ä¸è½½\n\n----------------------------------------\n\n----------------------------------------\n\n\n# åè¨\n\nä»å¤©æ¥èèä¸ä¸ªæ¥å£å¯¹æ¥çåºæ¯ï¼Aåå®¶æä¸å¥HTTPæ¥å£éè¦æä¾ç»Båå®¶ä½¿ç¨ï¼ç±äºæ¯å¤ç½ç¯å¢ï¼æä»¥éè¦æä¸å¥å®å¨æºå¶ä¿éï¼è¿ä¸ªæ¶åoauth2å°±å¯ä»¥ä½ä¸ºä¸ä¸ªæ¹æ¡ã\n\nå³äºoauth2ï¼å¶å®æ¯ä¸ä¸ªè§èï¼æ¬æéç¹è®²è§£springå¯¹ä»è¿è¡çå®ç°ï¼å¦æä½ è¿ä¸æ¸æ¥æææå¡å¨ï¼èµæºæå¡å¨ï¼è®¤è¯ææç­åºç¡æ¦å¿µï¼å¯ä»¥ç§»æ­¥çè§£OAuth 2.0 - é®ä¸å³°ï¼è¿æ¯ä¸ç¯å¯¹äºoauth2å¾å¥½çç§æ®æç« ã\n\néè¦å¯¹spring securityæä¸å®çéç½®ä½¿ç¨ç»éªï¼ç¨æ·è®¤è¯è¿ä¸åï¼spring security oauth2å»ºç«å¨spring securityçåºç¡ä¹ä¸ãç¬¬ä¸ç¯æç« ä¸»è¦æ¯è®²è§£ä½¿ç¨springbootæ­å»ºä¸ä¸ªç®æçææï¼èµæºæå¡å¨ï¼å¨ææ«ä¼ç»åºå·ä½ä»£ç çgithubå°åãåç»­æç« ä¼è¿è¡spring security oauth2çç¸å³æºç åæãjavaä¸­çå®å¨æ¡æ¶å¦shrioï¼å·²ç»æè·æå­¦shiro - å¼æ¶ï¼éå¸¸æä½ç³»å°ï¼æ·±å¥æµåºå°è®²è§£äºapacheçè¿ä¸ªå¼æºå®å¨æ¡æ¶ï¼ä½æ¯spring securityåæ¬oauth2ä¸ç´æ²¡ææä½ç³»çæç« ï¼å­¦ä¹ å®ä»¬å¤§å¤ä¾èµäºè¾å°çå®æ¹ææ¡£ï¼çè§£ä¸ä¸åºæ¬çä½¿ç¨éç½®ï¼éè¿é¶æ£çåå®¢ï¼äºè§£ä¸ä¸ä»äººçä½¿ç¨ç»éªï¼ææ­ç¹ï¼åæåé¨çå·¥ä½æµç¨ï¼çæºç ä¸­çæ¥å£è®¾è®¡ï¼ä»¥åæ³¨éï¼äºè§£è®¾è®¡èçç¨æãspringçåä¸ªæ¡æ¶é½è¿ç¨äºå¾å¤çè®¾è®¡æ¨¡å¼ï¼å¨å­¦ä¹ æºç çè¿ç¨ä¸­ï¼ä¹å¤§æ¦äºè§£äºä¸äºå¥è·¯ãspringä¹å¨å¿è¦çå°æ¹æ·»å äºéå½çæ³¨éï¼é¿åäºæºç éè¯»èå¯¹äºä¸äºç»èè®¾è®¡ççè§£äº§çåå·®ï¼è®©ææ´å æå¹ï¼springä¸ä»ä»æ¯ä¸ä¸ªå·¥å·æ¡æ¶ï¼æ´åæ¯ä¸ä¸ªèºæ¯åã\n\n\n# æ¦è¿°\n\nä½¿ç¨oauth2ä¿æ¤ä½ çåºç¨ï¼å¯ä»¥åä¸ºç®æçåä¸ºä¸ä¸ªæ­¥éª¤\n\n * éç½®èµæºæå¡å¨\n * éç½®è®¤è¯æå¡å¨\n * éç½®spring security\n\nåä¸¤ç¹æ¯oauth2çä¸»ä½åå®¹ï¼ä½åé¢æå·²ç»æè¿°è¿äºï¼spring security oauth2æ¯å»ºç«å¨spring securityåºç¡ä¹ä¸çï¼æä»¥æä¸äºä½ç³»æ¯å¬ç¨çã\n\noauth2æ ¹æ®ä½¿ç¨åºæ¯ä¸åï¼åæäº4ç§æ¨¡å¼\n\n * ææç æ¨¡å¼ï¼authorization codeï¼\n * ç®åæ¨¡å¼ï¼implicitï¼\n * å¯ç æ¨¡å¼ï¼resource owner password credentialsï¼\n * å®¢æ·ç«¯æ¨¡å¼ï¼client credentialsï¼\n\næ¬æéç¹è®²è§£æ¥å£å¯¹æ¥ä¸­å¸¸ä½¿ç¨çå¯ç æ¨¡å¼ï¼ä»¥ä¸ç®ç§°passwordæ¨¡å¼ï¼åå®¢æ·ç«¯æ¨¡å¼ï¼ä»¥ä¸ç®ç§°clientæ¨¡å¼ï¼ãææç æ¨¡å¼ä½¿ç¨å°äºåè°å°åï¼æ¯æä¸ºå¤æçæ¹å¼ï¼éå¸¸ç½ç«ä¸­ç»å¸¸åºç°çå¾®åï¼qqç¬¬ä¸æ¹ç»å½ï¼é½ä¼éç¨è¿ä¸ªå½¢å¼ãç®åæ¨¡å¼ä¸å¸¸ç¨ã\n\n\n# é¡¹ç®åå¤\n\nä¸»è¦çmavenä¾èµå¦ä¸\n\n\x3c!-- æ³¨ææ¯starter,èªå¨éç½® --\x3e\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-security</artifactId>\n</dependency>\n\x3c!-- ä¸æ¯starter,æå¨éç½® --\x3e\n<dependency>\n    <groupId>org.springframework.security.oauth</groupId>\n    <artifactId>spring-security-oauth2</artifactId>\n</dependency>\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-web</artifactId>\n</dependency>\n\x3c!-- å°tokenå­å¨å¨redisä¸­ --\x3e\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-data-redis</artifactId>\n</dependency>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\næä»¬ç»èªå·±åå®ä¸ªç®æ ï¼è¦å¹²ä»ä¹äºï¼æ¢ç¶è¯´å°ä¿æ¤åºç¨ï¼é£å¿é¡»å¾åæä¸äºèµæºï¼æä»¬åå»ºä¸ä¸ªendpointä½ä¸ºæä¾ç»å¤é¨çæ¥å£ï¼\n\n@RestController\npublic class TestEndpoints {\n\n    @GetMapping("/product/{id}")\n    public String getProduct(@PathVariable String id) {\n        //for debug\n        Authentication authentication = SecurityContextHolder.getContext().getAuthentication();\n        return "product id : " + id;\n    }\n\n    @GetMapping("/order/{id}")\n    public String getOrder(@PathVariable String id) {\n\t    //for debug\n        Authentication authentication = SecurityContextHolder.getContext().getAuthentication();\n        return "order id : " + id;\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\næ´é²ä¸ä¸ªååæ¥è¯¢æ¥å£ï¼åç»­ä¸åå®å¨éå¶ï¼ä¸ä¸ªè®¢åæ¥è¯¢æ¥å£ï¼åç»­æ·»å è®¿é®æ§å¶ã\n\n\n# éç½®èµæºæå¡å¨åæææå¡å¨\n\nç±äºæ¯ä¸¤ä¸ªoauth2çæ ¸å¿éç½®ï¼æä»¬æ¾å°ä¸ä¸ªéç½®ç±»ä¸­ã ä¸ºäºæ¹ä¾¿ä¸è½½ä»£ç ç´æ¥è¿è¡ï¼æè¿éå°å®¢æ·ç«¯ä¿¡æ¯æ¾å°äºåå­ä¸­ï¼çäº§ä¸­å¯ä»¥éç½®å°æ°æ®åºä¸­ãtokençå­å¨ä¸è¬éæ©ä½¿ç¨redisï¼ä¸æ¯æ§è½æ¯è¾å¥½ï¼äºæ¯èªå¨è¿æçæºå¶ï¼ç¬¦åtokençç¹æ§ã\n\n@Configuration\npublic class OAuth2ServerConfig {\n\n    private static final String DEMO_RESOURCE_ID = "order";\n\n    @Configuration\n    @EnableResourceServer\n    protected static class ResourceServerConfiguration extends ResourceServerConfigurerAdapter {\n\n        @Override\n        public void configure(ResourceServerSecurityConfigurer resources) {\n            resources.resourceId(DEMO_RESOURCE_ID).stateless(true);\n        }\n\n        @Override\n        public void configure(HttpSecurity http) throws Exception {\n            // @formatter:off\n            http\n                    // Since we want the protected resources to be accessible in the UI as well we need\n                    // session creation to be allowed (it\'s disabled by default in 2.0.6)\n                    .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.IF_REQUIRED)\n                    .and()\n                    .requestMatchers().anyRequest()\n                    .and()\n                    .anonymous()\n                    .and()\n                    .authorizeRequests()\n//                    .antMatchers("/product/**").access("#oauth2.hasScope(\'select\') and hasRole(\'ROLE_USER\')")\n                    .antMatchers("/order/**").authenticated();//éç½®orderè®¿é®æ§å¶ï¼å¿é¡»è®¤è¯è¿åæå¯ä»¥è®¿é®\n            // @formatter:on\n        }\n    }\n\n    @Configuration\n    @EnableAuthorizationServer\n    protected static class AuthorizationServerConfiguration extends AuthorizationServerConfigurerAdapter {\n\n        @Autowired\n        AuthenticationManager authenticationManager;\n        @Autowired\n        RedisConnectionFactory redisConnectionFactory;\n\n        @Override\n        public void configure(ClientDetailsServiceConfigurer clients) throws Exception {\n            //éç½®ä¸¤ä¸ªå®¢æ·ç«¯,ä¸ä¸ªç¨äºpasswordè®¤è¯ä¸ä¸ªç¨äºclientè®¤è¯\n            clients.inMemory().withClient("client_1")\n                    .resourceIds(DEMO_RESOURCE_ID)\n                    .authorizedGrantTypes("client_credentials", "refresh_token")\n                    .scopes("select")\n                    .authorities("client")\n                    .secret("123456")\n                    .and().withClient("client_2")\n                    .resourceIds(DEMO_RESOURCE_ID)\n                    .authorizedGrantTypes("password", "refresh_token")\n                    .scopes("select")\n                    .authorities("client")\n                    .secret("123456");\n        }\n\n        @Override\n        public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {\n            endpoints\n                    .tokenStore(new RedisTokenStore(redisConnectionFactory))\n                    .authenticationManager(authenticationManager);\n        }\n\n        @Override\n        public void configure(AuthorizationServerSecurityConfigurer oauthServer) throws Exception {\n            //åè®¸è¡¨åè®¤è¯\n            oauthServer.allowFormAuthenticationForClients();\n        }\n\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n\n\nç®åè¯´ä¸spring security oauth2çè®¤è¯æè·¯ã\n\n * clientæ¨¡å¼ï¼æ²¡æç¨æ·çæ¦å¿µï¼ç´æ¥ä¸è®¤è¯æå¡å¨äº¤äºï¼ç¨éç½®ä¸­çå®¢æ·ç«¯ä¿¡æ¯å»ç³è¯·accessTokenï¼å®¢æ·ç«¯æèªå·±çclient_id,client_secretå¯¹åºäºç¨æ·çusername,passwordï¼èå®¢æ·ç«¯ä¹æ¥æèªå·±çauthoritiesï¼å½éåclientæ¨¡å¼è®¤è¯æ¶ï¼å¯¹åºçæéä¹å°±æ¯å®¢æ·ç«¯èªå·±çauthoritiesã\n * passwordæ¨¡å¼ï¼èªå·±æ¬èº«æä¸å¥ç¨æ·ä½ç³»ï¼å¨è®¤è¯æ¶éè¦å¸¦ä¸èªå·±çç¨æ·ååå¯ç ï¼ä»¥åå®¢æ·ç«¯çclient_id,client_secretãæ­¤æ¶ï¼accessTokenæåå«çæéæ¯ç¨æ·æ¬èº«çæéï¼èä¸æ¯å®¢æ·ç«¯çæéã\n\næå¯¹äºä¸¤ç§æ¨¡å¼ççè§£ä¾¿æ¯ï¼å¦æä½ çç³»ç»å·²ç»æäºä¸å¥ç¨æ·ä½ç³»ï¼æ¯ä¸ªç¨æ·ä¹æäºä¸å®çæéï¼å¯ä»¥éç¨passwordæ¨¡å¼ï¼å¦æä»ä»æ¯æ¥å£çå¯¹æ¥ï¼ä¸èèç¨æ·ï¼åå¯ä»¥ä½¿ç¨clientæ¨¡å¼ã\n\n\n# éç½®spring security\n\nå¨spring securityççæ¬è¿­ä»£ä¸­ï¼äº§çäºå¤ç§éç½®æ¹å¼ï¼å»ºé èæ¨¡å¼ï¼ééå¨æ¨¡å¼ç­ç­è®¾è®¡æ¨¡å¼çä½¿ç¨ï¼spring securityåé¨çè®¤è¯flowä¹æ¯éç»¼å¤æï¼å¨æä¸å¼å§å­¦ä¹ ssä¹äº§çäºä¸å°å°æï¼æ»ç»äºä¸ä¸éç½®ç»éªï¼ä½¿ç¨äºspringbootä¹åï¼spring securityå¶å®æ¯æä¸å°èªå¨éç½®çï¼æä»¬å¯ä»¥ä»ä»ä¿®æ¹èªå·±éè¦çé£ä¸é¨åï¼å¹¶ä¸éµå¾ªä¸ä¸ªååï¼ç´æ¥è¦çæéè¦çé£ä¸é¨åãè¿ä¸è¯´æ³æ¯è¾æ½è±¡ï¼ä¸¾ä¸ªä¾å­ãæ¯å¦éç½®åå­ä¸­çç¨æ·è®¤è¯å¨ãæä¸¤ç§éç½®æ¹å¼\n\nplanAï¼\n\n@Bean\nprotected UserDetailsService userDetailsService(){\n    InMemoryUserDetailsManager manager = new InMemoryUserDetailsManager();\n    manager.createUser(User.withUsername("user_1").password("123456").authorities("USER").build());\n    manager.createUser(User.withUsername("user_2").password("123456").authorities("USER").build());\n    return manager;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nplanBï¼\n\n@Configuration\n@EnableWebSecurity\npublic class SecurityConfiguration extends WebSecurityConfigurerAdapter {\n\n    @Override\n    protected void configure(AuthenticationManagerBuilder auth) throws Exception {\n        auth.inMemoryAuthentication()\n                .withUser("user_1").password("123456").authorities("USER")\n                .and()\n                .withUser("user_2").password("123456").authorities("USER");\n   }\n\n   @Bean\n   @Override\n   public AuthenticationManager authenticationManagerBean() throws Exception {\n       AuthenticationManager manager = super.authenticationManagerBean();\n        return manager;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä½ æç»é½è½å¾å°éç½®å¨åå­ä¸­çä¸¤ä¸ªç¨æ·ï¼åèæ¯ç´æ¥æ¿æ¢æäºå®¹å¨ä¸­çUserDetailsServiceï¼è¿ä¹åæ¯è¾ç´è§ï¼åèæ¯æ¿æ¢äºAuthenticationManagerï¼å½ç¶ä½ è¿ä¼å¨SecurityConfiguration å¤åå¶ä»éç½®ï¼è¿ä¹éç½®æç»ä¼ç±ä¸ä¸ªå§æèå»è®¤è¯ãå¦æä½ çæspring securityï¼ä¼ç¥éAuthenticationManageråAuthenticationProviderä»¥åUserDetailsServiceçå³ç³»ï¼ä»ä»¬é½æ¯é¡¶çº§çæ¥å£ï¼å®ç°ç±»ä¹é´éç»¼å¤æçèåå³ç³»â¦éç½®æ¹å¼åå·®ä¸å«ï¼ä½çè§£æ¸æ¥è®¤è¯æµç¨ï¼ç¥éåä¸ªå®ç°ç±»å¯¹åºçèè´£ææ¯ææ¡spring securityçå³é®ã\n\nä¸é¢ç»åºææç»çéç½®ï¼\n\n@Configuration\n@EnableWebSecurity\npublic class SecurityConfiguration extends WebSecurityConfigurerAdapter {\n\n    @Bean\n    @Override\n    protected UserDetailsService userDetailsService(){\n        InMemoryUserDetailsManager manager = new InMemoryUserDetailsManager();\n        manager.createUser(User.withUsername("user_1").password("123456").authorities("USER").build());\n        manager.createUser(User.withUsername("user_2").password("123456").authorities("USER").build());\n        return manager;\n    }\n\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        // @formatter:off\n        http\n            .requestMatchers().anyRequest()\n            .and()\n                .authorizeRequests()\n                .antMatchers("/oauth/*").permitAll();\n        // @formatter:on\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\néç¹å°±æ¯éç½®äºä¸ä¸ªUserDetailsServiceï¼åClientDetailsServiceä¸æ ·ï¼ä¸ºäºæ¹ä¾¿è¿è¡ï¼ä½¿ç¨åå­ä¸­çç¨æ·ï¼å®éé¡¹ç®ä¸­ï¼ä¸è¬ä½¿ç¨çæ¯æ°æ®åºä¿å­ç¨æ·ï¼å·ä½çå®ç°ç±»å¯ä»¥ä½¿ç¨JdbcDaoImplæèJdbcUserDetailsManagerã\n\n\n# è·åtoken\n\nè¿è¡å¦ä¸éç½®ä¹åï¼å¯å¨springbootåºç¨å°±å¯ä»¥åç°å¤äºä¸äºèªå¨åå»ºçendpointsï¼\n\n{[/oauth/authorize]}\n{[/oauth/authorize],methods=[POST]\n{[/oauth/token],methods=[GET]}\n{[/oauth/token],methods=[POST]}\n{[/oauth/check_token]}\n{[/oauth/error]}\n\n\n1\n2\n3\n4\n5\n6\n\n\néç¹å³æ³¨ä¸ä¸/oauth/tokenï¼å®æ¯è·åçtokençendpointãå¯å¨springbootåºç¨ä¹åï¼ä½¿ç¨httpå·¥å·è®¿é® passwordæ¨¡å¼ï¼\n\nhttp://localhost:8080/oauth/token?username=user_1&password=123456&grant_type=password&scope=select&client_id=client_2&client_secret=123456\n\n\n1\n\n\nååºå¦ä¸ï¼ {"access_token":"950a7cc9-5a8a-42c9-a693-40e817b1a4b0","token_type":"bearer","refresh_token":"773a0fcd-6023-45f8-8848-e141296cb3cb","expires_in":27036,"scope":"select"}\n\nclientæ¨¡å¼ï¼ http://localhost:8080/oauth/token?grant_type=client_credentials&scope=select&client_id=client_1&client_secret=123456\n\nååºå¦ä¸ï¼ {"access_token":"56465b41-429d-436c-ad8d-613d476ff322","token_type":"bearer","expires_in":25074,"scope":"select"}\n\nå¨éç½®ä¸­ï¼æä»¬å·²ç»éç½®äºå¯¹orderèµæºçä¿æ¤ï¼å¦æç´æ¥è®¿é®:http://localhost:8080/order/1ä¼å¾å°è¿æ ·çååº:{"error":"unauthorized","error_description":"Full authentication is required to access this resource"} ï¼è¿æ ·çéè¯¯ååºå¯ä»¥éè¿éåéç½®æ¥ä¿®æ¹ï¼\n\nèå¯¹äºæªåä¿æ¤çproductèµæºhttp://localhost:8080/product/1åå¯ä»¥ç´æ¥è®¿é®ï¼å¾å°ååºproduct id : 1\n\næºå¸¦accessTokenåæ°è®¿é®åä¿æ¤çèµæºï¼\n\nä½¿ç¨passwordæ¨¡å¼è·å¾çtoken:http://localhost:8080/order/1?access_token=950a7cc9-5a8a-42c9-a693-40e817b1a4b0ï¼å¾å°äºä¹åå¿åè®¿é®æ æ³è·åçèµæºï¼order id : 1\n\nä½¿ç¨clientæ¨¡å¼è·å¾çtoken:http://localhost:8080/order/1?access_token=56465b41-429d-436c-ad8d-613d476ff322ï¼åä¸çååºorder id : 1\n\næä»¬éç¹å³æ³¨ä¸ä¸debugåï¼å¯¹èµæºè®¿é®æ¶ç³»ç»è®°å½çç¨æ·è®¤è¯ä¿¡æ¯ï¼å¯ä»¥çå°å¦ä¸çdebugä¿¡æ¯\n\npasswordæ¨¡å¼ï¼ passwordæ¨¡å¼\n\nclientæ¨¡å¼ï¼ clientæ¨¡å¼\n\nåæä»¬çéç½®æ¯ä¸è´çï¼ä»ç»çå¯ä»¥åç°ä¸¤èçèº«ä»½æäºè®¸çä¸åãæ³è¦æ¥çæ´å¤çdebugä¿¡æ¯ï¼å¯ä»¥éæ©ä¸è½½demoä»£ç èªå·±æ¥çï¼ä¸ºäºæ¹ä¾¿è¯»èè°è¯åéªè¯ï¼æå»é¤äºå¾å¤å¤æçç¹æ§ï¼åºæ¬å®ç°äºä¸ä¸ªæç®éç½®ï¼æ¶åå°æ°æ®åºçå°æ¹ä¹å°½ééç½®å°äºåå­ä¸­ï¼è¿ç¹è®°ä½å¨å®éä½¿ç¨æ¶ä¸å®è¦ä¿®æ¹ã\n\nå°è¿å¿ï¼ä¸ä¸ªç®åçoauth2å¥é¨ç¤ºä¾å°±å®æäºï¼ä¸ä¸ªç®åçéç½®æç¨ãtokençå·¥ä½åçæ¯ä»ä¹ï¼å®åå«äºåªäºä¿¡æ¯ï¼springåé¨å¦ä½å¯¹èº«ä»½ä¿¡æ¯è¿è¡éªè¯ï¼ä»¥åä¸è¿°çéç½®å°åºå½±åäºä»ä¹ï¼è¿äºåå®¹ä¼æ¾å°åé¢çæç« ä¸­å»åæã\n\n\n# ç¤ºä¾ä»£ç ä¸è½½\n\nå¨é¨çä»£ç å¯ä»¥å¨æçgithubä¸è¿è¡ä¸è½½ï¼é¡¹ç®ä½¿ç¨springboot+mavenæå»ºï¼ <https://github.com/lexburner/oauth2-demo',normalizedContent:'æè¦: åååºå¤ [https://www.cnkirito.moe/re%ef%bc%9a%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e7%9a%84spring%20security%20oauth2%ef%bc%88%e4%b8%80%ef%bc%89/](https://www.cnkirito.moe/reï¼ä»é¶å¼å§çspring security oauth2ï¼ä¸ï¼/) ãèå¾ãæ¬¢è¿è½¬è½½ï¼ä¿çæè¦ï¼è°¢è°¢ï¼\n\n * åè¨\n * æ¦è¿°\n * é¡¹ç®åå¤\n * éç½®èµæºæå¡å¨åæææå¡å¨\n * éç½®spring security\n * è·åtoken\n * ç¤ºä¾ä»£ç ä¸è½½\n\n----------------------------------------\n\n----------------------------------------\n\n\n# åè¨\n\nä»å¤©æ¥èèä¸ä¸ªæ¥å£å¯¹æ¥çåºæ¯ï¼aåå®¶æä¸å¥httpæ¥å£éè¦æä¾ç»båå®¶ä½¿ç¨ï¼ç±äºæ¯å¤ç½ç¯å¢ï¼æä»¥éè¦æä¸å¥å®å¨æºå¶ä¿éï¼è¿ä¸ªæ¶åoauth2å°±å¯ä»¥ä½ä¸ºä¸ä¸ªæ¹æ¡ã\n\nå³äºoauth2ï¼å¶å®æ¯ä¸ä¸ªè§èï¼æ¬æéç¹è®²è§£springå¯¹ä»è¿è¡çå®ç°ï¼å¦æä½ è¿ä¸æ¸æ¥æææå¡å¨ï¼èµæºæå¡å¨ï¼è®¤è¯ææç­åºç¡æ¦å¿µï¼å¯ä»¥ç§»æ­¥çè§£oauth 2.0 - é®ä¸å³°ï¼è¿æ¯ä¸ç¯å¯¹äºoauth2å¾å¥½çç§æ®æç« ã\n\néè¦å¯¹spring securityæä¸å®çéç½®ä½¿ç¨ç»éªï¼ç¨æ·è®¤è¯è¿ä¸åï¼spring security oauth2å»ºç«å¨spring securityçåºç¡ä¹ä¸ãç¬¬ä¸ç¯æç« ä¸»è¦æ¯è®²è§£ä½¿ç¨springbootæ­å»ºä¸ä¸ªç®æçææï¼èµæºæå¡å¨ï¼å¨ææ«ä¼ç»åºå·ä½ä»£ç çgithubå°åãåç»­æç« ä¼è¿è¡spring security oauth2çç¸å³æºç åæãjavaä¸­çå®å¨æ¡æ¶å¦shrioï¼å·²ç»æè·æå­¦shiro - å¼æ¶ï¼éå¸¸æä½ç³»å°ï¼æ·±å¥æµåºå°è®²è§£äºapacheçè¿ä¸ªå¼æºå®å¨æ¡æ¶ï¼ä½æ¯spring securityåæ¬oauth2ä¸ç´æ²¡ææä½ç³»çæç« ï¼å­¦ä¹ å®ä»¬å¤§å¤ä¾èµäºè¾å°çå®æ¹ææ¡£ï¼çè§£ä¸ä¸åºæ¬çä½¿ç¨éç½®ï¼éè¿é¶æ£çåå®¢ï¼äºè§£ä¸ä¸ä»äººçä½¿ç¨ç»éªï¼ææ­ç¹ï¼åæåé¨çå·¥ä½æµç¨ï¼çæºç ä¸­çæ¥å£è®¾è®¡ï¼ä»¥åæ³¨éï¼äºè§£è®¾è®¡èçç¨æãspringçåä¸ªæ¡æ¶é½è¿ç¨äºå¾å¤çè®¾è®¡æ¨¡å¼ï¼å¨å­¦ä¹ æºç çè¿ç¨ä¸­ï¼ä¹å¤§æ¦äºè§£äºä¸äºå¥è·¯ãspringä¹å¨å¿è¦çå°æ¹æ·»å äºéå½çæ³¨éï¼é¿åäºæºç éè¯»èå¯¹äºä¸äºç»èè®¾è®¡ççè§£äº§çåå·®ï¼è®©ææ´å æå¹ï¼springä¸ä»ä»æ¯ä¸ä¸ªå·¥å·æ¡æ¶ï¼æ´åæ¯ä¸ä¸ªèºæ¯åã\n\n\n# æ¦è¿°\n\nä½¿ç¨oauth2ä¿æ¤ä½ çåºç¨ï¼å¯ä»¥åä¸ºç®æçåä¸ºä¸ä¸ªæ­¥éª¤\n\n * éç½®èµæºæå¡å¨\n * éç½®è®¤è¯æå¡å¨\n * éç½®spring security\n\nåä¸¤ç¹æ¯oauth2çä¸»ä½åå®¹ï¼ä½åé¢æå·²ç»æè¿°è¿äºï¼spring security oauth2æ¯å»ºç«å¨spring securityåºç¡ä¹ä¸çï¼æä»¥æä¸äºä½ç³»æ¯å¬ç¨çã\n\noauth2æ ¹æ®ä½¿ç¨åºæ¯ä¸åï¼åæäº4ç§æ¨¡å¼\n\n * ææç æ¨¡å¼ï¼authorization codeï¼\n * ç®åæ¨¡å¼ï¼implicitï¼\n * å¯ç æ¨¡å¼ï¼resource owner password credentialsï¼\n * å®¢æ·ç«¯æ¨¡å¼ï¼client credentialsï¼\n\næ¬æéç¹è®²è§£æ¥å£å¯¹æ¥ä¸­å¸¸ä½¿ç¨çå¯ç æ¨¡å¼ï¼ä»¥ä¸ç®ç§°passwordæ¨¡å¼ï¼åå®¢æ·ç«¯æ¨¡å¼ï¼ä»¥ä¸ç®ç§°clientæ¨¡å¼ï¼ãææç æ¨¡å¼ä½¿ç¨å°äºåè°å°åï¼æ¯æä¸ºå¤æçæ¹å¼ï¼éå¸¸ç½ç«ä¸­ç»å¸¸åºç°çå¾®åï¼qqç¬¬ä¸æ¹ç»å½ï¼é½ä¼éç¨è¿ä¸ªå½¢å¼ãç®åæ¨¡å¼ä¸å¸¸ç¨ã\n\n\n# é¡¹ç®åå¤\n\nä¸»è¦çmavenä¾èµå¦ä¸\n\n\x3c!-- æ³¨ææ¯starter,èªå¨éç½® --\x3e\n<dependency>\n    <groupid>org.springframework.boot</groupid>\n    <artifactid>spring-boot-starter-security</artifactid>\n</dependency>\n\x3c!-- ä¸æ¯starter,æå¨éç½® --\x3e\n<dependency>\n    <groupid>org.springframework.security.oauth</groupid>\n    <artifactid>spring-security-oauth2</artifactid>\n</dependency>\n<dependency>\n    <groupid>org.springframework.boot</groupid>\n    <artifactid>spring-boot-starter-web</artifactid>\n</dependency>\n\x3c!-- å°tokenå­å¨å¨redisä¸­ --\x3e\n<dependency>\n    <groupid>org.springframework.boot</groupid>\n    <artifactid>spring-boot-starter-data-redis</artifactid>\n</dependency>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\næä»¬ç»èªå·±åå®ä¸ªç®æ ï¼è¦å¹²ä»ä¹äºï¼æ¢ç¶è¯´å°ä¿æ¤åºç¨ï¼é£å¿é¡»å¾åæä¸äºèµæºï¼æä»¬åå»ºä¸ä¸ªendpointä½ä¸ºæä¾ç»å¤é¨çæ¥å£ï¼\n\n@restcontroller\npublic class testendpoints {\n\n    @getmapping("/product/{id}")\n    public string getproduct(@pathvariable string id) {\n        //for debug\n        authentication authentication = securitycontextholder.getcontext().getauthentication();\n        return "product id : " + id;\n    }\n\n    @getmapping("/order/{id}")\n    public string getorder(@pathvariable string id) {\n\t    //for debug\n        authentication authentication = securitycontextholder.getcontext().getauthentication();\n        return "order id : " + id;\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\næ´é²ä¸ä¸ªååæ¥è¯¢æ¥å£ï¼åç»­ä¸åå®å¨éå¶ï¼ä¸ä¸ªè®¢åæ¥è¯¢æ¥å£ï¼åç»­æ·»å è®¿é®æ§å¶ã\n\n\n# éç½®èµæºæå¡å¨åæææå¡å¨\n\nç±äºæ¯ä¸¤ä¸ªoauth2çæ ¸å¿éç½®ï¼æä»¬æ¾å°ä¸ä¸ªéç½®ç±»ä¸­ã ä¸ºäºæ¹ä¾¿ä¸è½½ä»£ç ç´æ¥è¿è¡ï¼æè¿éå°å®¢æ·ç«¯ä¿¡æ¯æ¾å°äºåå­ä¸­ï¼çäº§ä¸­å¯ä»¥éç½®å°æ°æ®åºä¸­ãtokençå­å¨ä¸è¬éæ©ä½¿ç¨redisï¼ä¸æ¯æ§è½æ¯è¾å¥½ï¼äºæ¯èªå¨è¿æçæºå¶ï¼ç¬¦åtokençç¹æ§ã\n\n@configuration\npublic class oauth2serverconfig {\n\n    private static final string demo_resource_id = "order";\n\n    @configuration\n    @enableresourceserver\n    protected static class resourceserverconfiguration extends resourceserverconfigureradapter {\n\n        @override\n        public void configure(resourceserversecurityconfigurer resources) {\n            resources.resourceid(demo_resource_id).stateless(true);\n        }\n\n        @override\n        public void configure(httpsecurity http) throws exception {\n            // @formatter:off\n            http\n                    // since we want the protected resources to be accessible in the ui as well we need\n                    // session creation to be allowed (it\'s disabled by default in 2.0.6)\n                    .sessionmanagement().sessioncreationpolicy(sessioncreationpolicy.if_required)\n                    .and()\n                    .requestmatchers().anyrequest()\n                    .and()\n                    .anonymous()\n                    .and()\n                    .authorizerequests()\n//                    .antmatchers("/product/**").access("#oauth2.hasscope(\'select\') and hasrole(\'role_user\')")\n                    .antmatchers("/order/**").authenticated();//éç½®orderè®¿é®æ§å¶ï¼å¿é¡»è®¤è¯è¿åæå¯ä»¥è®¿é®\n            // @formatter:on\n        }\n    }\n\n    @configuration\n    @enableauthorizationserver\n    protected static class authorizationserverconfiguration extends authorizationserverconfigureradapter {\n\n        @autowired\n        authenticationmanager authenticationmanager;\n        @autowired\n        redisconnectionfactory redisconnectionfactory;\n\n        @override\n        public void configure(clientdetailsserviceconfigurer clients) throws exception {\n            //éç½®ä¸¤ä¸ªå®¢æ·ç«¯,ä¸ä¸ªç¨äºpasswordè®¤è¯ä¸ä¸ªç¨äºclientè®¤è¯\n            clients.inmemory().withclient("client_1")\n                    .resourceids(demo_resource_id)\n                    .authorizedgranttypes("client_credentials", "refresh_token")\n                    .scopes("select")\n                    .authorities("client")\n                    .secret("123456")\n                    .and().withclient("client_2")\n                    .resourceids(demo_resource_id)\n                    .authorizedgranttypes("password", "refresh_token")\n                    .scopes("select")\n                    .authorities("client")\n                    .secret("123456");\n        }\n\n        @override\n        public void configure(authorizationserverendpointsconfigurer endpoints) throws exception {\n            endpoints\n                    .tokenstore(new redistokenstore(redisconnectionfactory))\n                    .authenticationmanager(authenticationmanager);\n        }\n\n        @override\n        public void configure(authorizationserversecurityconfigurer oauthserver) throws exception {\n            //åè®¸è¡¨åè®¤è¯\n            oauthserver.allowformauthenticationforclients();\n        }\n\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n\n\nç®åè¯´ä¸spring security oauth2çè®¤è¯æè·¯ã\n\n * clientæ¨¡å¼ï¼æ²¡æç¨æ·çæ¦å¿µï¼ç´æ¥ä¸è®¤è¯æå¡å¨äº¤äºï¼ç¨éç½®ä¸­çå®¢æ·ç«¯ä¿¡æ¯å»ç³è¯·accesstokenï¼å®¢æ·ç«¯æèªå·±çclient_id,client_secretå¯¹åºäºç¨æ·çusername,passwordï¼èå®¢æ·ç«¯ä¹æ¥æèªå·±çauthoritiesï¼å½éåclientæ¨¡å¼è®¤è¯æ¶ï¼å¯¹åºçæéä¹å°±æ¯å®¢æ·ç«¯èªå·±çauthoritiesã\n * passwordæ¨¡å¼ï¼èªå·±æ¬èº«æä¸å¥ç¨æ·ä½ç³»ï¼å¨è®¤è¯æ¶éè¦å¸¦ä¸èªå·±çç¨æ·ååå¯ç ï¼ä»¥åå®¢æ·ç«¯çclient_id,client_secretãæ­¤æ¶ï¼accesstokenæåå«çæéæ¯ç¨æ·æ¬èº«çæéï¼èä¸æ¯å®¢æ·ç«¯çæéã\n\næå¯¹äºä¸¤ç§æ¨¡å¼ççè§£ä¾¿æ¯ï¼å¦æä½ çç³»ç»å·²ç»æäºä¸å¥ç¨æ·ä½ç³»ï¼æ¯ä¸ªç¨æ·ä¹æäºä¸å®çæéï¼å¯ä»¥éç¨passwordæ¨¡å¼ï¼å¦æä»ä»æ¯æ¥å£çå¯¹æ¥ï¼ä¸èèç¨æ·ï¼åå¯ä»¥ä½¿ç¨clientæ¨¡å¼ã\n\n\n# éç½®spring security\n\nå¨spring securityççæ¬è¿­ä»£ä¸­ï¼äº§çäºå¤ç§éç½®æ¹å¼ï¼å»ºé èæ¨¡å¼ï¼ééå¨æ¨¡å¼ç­ç­è®¾è®¡æ¨¡å¼çä½¿ç¨ï¼spring securityåé¨çè®¤è¯flowä¹æ¯éç»¼å¤æï¼å¨æä¸å¼å§å­¦ä¹ ssä¹äº§çäºä¸å°å°æï¼æ»ç»äºä¸ä¸éç½®ç»éªï¼ä½¿ç¨äºspringbootä¹åï¼spring securityå¶å®æ¯æä¸å°èªå¨éç½®çï¼æä»¬å¯ä»¥ä»ä»ä¿®æ¹èªå·±éè¦çé£ä¸é¨åï¼å¹¶ä¸éµå¾ªä¸ä¸ªååï¼ç´æ¥è¦çæéè¦çé£ä¸é¨åãè¿ä¸è¯´æ³æ¯è¾æ½è±¡ï¼ä¸¾ä¸ªä¾å­ãæ¯å¦éç½®åå­ä¸­çç¨æ·è®¤è¯å¨ãæä¸¤ç§éç½®æ¹å¼\n\nplanaï¼\n\n@bean\nprotected userdetailsservice userdetailsservice(){\n    inmemoryuserdetailsmanager manager = new inmemoryuserdetailsmanager();\n    manager.createuser(user.withusername("user_1").password("123456").authorities("user").build());\n    manager.createuser(user.withusername("user_2").password("123456").authorities("user").build());\n    return manager;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nplanbï¼\n\n@configuration\n@enablewebsecurity\npublic class securityconfiguration extends websecurityconfigureradapter {\n\n    @override\n    protected void configure(authenticationmanagerbuilder auth) throws exception {\n        auth.inmemoryauthentication()\n                .withuser("user_1").password("123456").authorities("user")\n                .and()\n                .withuser("user_2").password("123456").authorities("user");\n   }\n\n   @bean\n   @override\n   public authenticationmanager authenticationmanagerbean() throws exception {\n       authenticationmanager manager = super.authenticationmanagerbean();\n        return manager;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä½ æç»é½è½å¾å°éç½®å¨åå­ä¸­çä¸¤ä¸ªç¨æ·ï¼åèæ¯ç´æ¥æ¿æ¢æäºå®¹å¨ä¸­çuserdetailsserviceï¼è¿ä¹åæ¯è¾ç´è§ï¼åèæ¯æ¿æ¢äºauthenticationmanagerï¼å½ç¶ä½ è¿ä¼å¨securityconfiguration å¤åå¶ä»éç½®ï¼è¿ä¹éç½®æç»ä¼ç±ä¸ä¸ªå§æèå»è®¤è¯ãå¦æä½ çæspring securityï¼ä¼ç¥éauthenticationmanageråauthenticationproviderä»¥åuserdetailsserviceçå³ç³»ï¼ä»ä»¬é½æ¯é¡¶çº§çæ¥å£ï¼å®ç°ç±»ä¹é´éç»¼å¤æçèåå³ç³»â¦éç½®æ¹å¼åå·®ä¸å«ï¼ä½çè§£æ¸æ¥è®¤è¯æµç¨ï¼ç¥éåä¸ªå®ç°ç±»å¯¹åºçèè´£ææ¯ææ¡spring securityçå³é®ã\n\nä¸é¢ç»åºææç»çéç½®ï¼\n\n@configuration\n@enablewebsecurity\npublic class securityconfiguration extends websecurityconfigureradapter {\n\n    @bean\n    @override\n    protected userdetailsservice userdetailsservice(){\n        inmemoryuserdetailsmanager manager = new inmemoryuserdetailsmanager();\n        manager.createuser(user.withusername("user_1").password("123456").authorities("user").build());\n        manager.createuser(user.withusername("user_2").password("123456").authorities("user").build());\n        return manager;\n    }\n\n    @override\n    protected void configure(httpsecurity http) throws exception {\n        // @formatter:off\n        http\n            .requestmatchers().anyrequest()\n            .and()\n                .authorizerequests()\n                .antmatchers("/oauth/*").permitall();\n        // @formatter:on\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\néç¹å°±æ¯éç½®äºä¸ä¸ªuserdetailsserviceï¼åclientdetailsserviceä¸æ ·ï¼ä¸ºäºæ¹ä¾¿è¿è¡ï¼ä½¿ç¨åå­ä¸­çç¨æ·ï¼å®éé¡¹ç®ä¸­ï¼ä¸è¬ä½¿ç¨çæ¯æ°æ®åºä¿å­ç¨æ·ï¼å·ä½çå®ç°ç±»å¯ä»¥ä½¿ç¨jdbcdaoimplæèjdbcuserdetailsmanagerã\n\n\n# è·åtoken\n\nè¿è¡å¦ä¸éç½®ä¹åï¼å¯å¨springbootåºç¨å°±å¯ä»¥åç°å¤äºä¸äºèªå¨åå»ºçendpointsï¼\n\n{[/oauth/authorize]}\n{[/oauth/authorize],methods=[post]\n{[/oauth/token],methods=[get]}\n{[/oauth/token],methods=[post]}\n{[/oauth/check_token]}\n{[/oauth/error]}\n\n\n1\n2\n3\n4\n5\n6\n\n\néç¹å³æ³¨ä¸ä¸/oauth/tokenï¼å®æ¯è·åçtokençendpointãå¯å¨springbootåºç¨ä¹åï¼ä½¿ç¨httpå·¥å·è®¿é® passwordæ¨¡å¼ï¼\n\nhttp://localhost:8080/oauth/token?username=user_1&password=123456&grant_type=password&scope=select&client_id=client_2&client_secret=123456\n\n\n1\n\n\nååºå¦ä¸ï¼ {"access_token":"950a7cc9-5a8a-42c9-a693-40e817b1a4b0","token_type":"bearer","refresh_token":"773a0fcd-6023-45f8-8848-e141296cb3cb","expires_in":27036,"scope":"select"}\n\nclientæ¨¡å¼ï¼ http://localhost:8080/oauth/token?grant_type=client_credentials&scope=select&client_id=client_1&client_secret=123456\n\nååºå¦ä¸ï¼ {"access_token":"56465b41-429d-436c-ad8d-613d476ff322","token_type":"bearer","expires_in":25074,"scope":"select"}\n\nå¨éç½®ä¸­ï¼æä»¬å·²ç»éç½®äºå¯¹orderèµæºçä¿æ¤ï¼å¦æç´æ¥è®¿é®:http://localhost:8080/order/1ä¼å¾å°è¿æ ·çååº:{"error":"unauthorized","error_description":"full authentication is required to access this resource"} ï¼è¿æ ·çéè¯¯ååºå¯ä»¥éè¿éåéç½®æ¥ä¿®æ¹ï¼\n\nèå¯¹äºæªåä¿æ¤çproductèµæºhttp://localhost:8080/product/1åå¯ä»¥ç´æ¥è®¿é®ï¼å¾å°ååºproduct id : 1\n\næºå¸¦accesstokenåæ°è®¿é®åä¿æ¤çèµæºï¼\n\nä½¿ç¨passwordæ¨¡å¼è·å¾çtoken:http://localhost:8080/order/1?access_token=950a7cc9-5a8a-42c9-a693-40e817b1a4b0ï¼å¾å°äºä¹åå¿åè®¿é®æ æ³è·åçèµæºï¼order id : 1\n\nä½¿ç¨clientæ¨¡å¼è·å¾çtoken:http://localhost:8080/order/1?access_token=56465b41-429d-436c-ad8d-613d476ff322ï¼åä¸çååºorder id : 1\n\næä»¬éç¹å³æ³¨ä¸ä¸debugåï¼å¯¹èµæºè®¿é®æ¶ç³»ç»è®°å½çç¨æ·è®¤è¯ä¿¡æ¯ï¼å¯ä»¥çå°å¦ä¸çdebugä¿¡æ¯\n\npasswordæ¨¡å¼ï¼ passwordæ¨¡å¼\n\nclientæ¨¡å¼ï¼ clientæ¨¡å¼\n\nåæä»¬çéç½®æ¯ä¸è´çï¼ä»ç»çå¯ä»¥åç°ä¸¤èçèº«ä»½æäºè®¸çä¸åãæ³è¦æ¥çæ´å¤çdebugä¿¡æ¯ï¼å¯ä»¥éæ©ä¸è½½demoä»£ç èªå·±æ¥çï¼ä¸ºäºæ¹ä¾¿è¯»èè°è¯åéªè¯ï¼æå»é¤äºå¾å¤å¤æçç¹æ§ï¼åºæ¬å®ç°äºä¸ä¸ªæç®éç½®ï¼æ¶åå°æ°æ®åºçå°æ¹ä¹å°½ééç½®å°äºåå­ä¸­ï¼è¿ç¹è®°ä½å¨å®éä½¿ç¨æ¶ä¸å®è¦ä¿®æ¹ã\n\nå°è¿å¿ï¼ä¸ä¸ªç®åçoauth2å¥é¨ç¤ºä¾å°±å®æäºï¼ä¸ä¸ªç®åçéç½®æç¨ãtokençå·¥ä½åçæ¯ä»ä¹ï¼å®åå«äºåªäºä¿¡æ¯ï¼springåé¨å¦ä½å¯¹èº«ä»½ä¿¡æ¯è¿è¡éªè¯ï¼ä»¥åä¸è¿°çéç½®å°åºå½±åäºä»ä¹ï¼è¿äºåå®¹ä¼æ¾å°åé¢çæç« ä¸­å»åæã\n\n\n# ç¤ºä¾ä»£ç ä¸è½½\n\nå¨é¨çä»£ç å¯ä»¥å¨æçgithubä¸è¿è¡ä¸è½½ï¼é¡¹ç®ä½¿ç¨springboot+mavenæå»ºï¼ <https://github.com/lexburner/oauth2-demo',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼äºï¼",frontmatter:{title:"ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼äºï¼",date:"2022-02-03T00:03:27.000Z",permalink:"/pages/3e6453/",categories:["åç«¯","Spring Security"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/25.Spring%20Security/07.%E3%80%90%E8%80%81%E5%BE%90%E3%80%91%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%20Spring%20Security%20OAuth2%EF%BC%88%E4%BA%8C%EF%BC%89.html",relativePath:"10.æ¡æ¶/25.Spring Security/07.ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼äºï¼.md",key:"v-2bdfec00",path:"/pages/3e6453/",headers:[{level:2,title:"åå¤å·¥ä½",slug:"åå¤å·¥ä½",normalizedTitle:"åå¤å·¥ä½",charIndex:3},{level:2,title:"@EnableAuthorizationServer",slug:"enableauthorizationserver",normalizedTitle:"@enableauthorizationserver",charIndex:11},{level:2,title:"å®¢æ·ç«¯èº«ä»½è®¤è¯æ ¸å¿è¿æ»¤å¨ClientCredentialsTokenEndpointFilterï¼ææ¡ï¼",slug:"å®¢æ·ç«¯èº«ä»½è®¤è¯æ ¸å¿è¿æ»¤å¨clientcredentialstokenendpointfilter-ææ¡",normalizedTitle:"å®¢æ·ç«¯èº«ä»½è®¤è¯æ ¸å¿è¿æ»¤å¨clientcredentialstokenendpointfilterï¼ææ¡ï¼",charIndex:41},{level:2,title:"é¡¶çº§èº«ä»½ç®¡çèAuthenticationManagerï¼ææ¡ï¼",slug:"é¡¶çº§èº«ä»½ç®¡çèauthenticationmanager-ææ¡",normalizedTitle:"é¡¶çº§èº«ä»½ç®¡çèauthenticationmanagerï¼ææ¡ï¼",charIndex:97},{level:2,title:"Tokenå¤çç«¯ç¹TokenEndpointï¼ææ¡ï¼",slug:"tokenå¤çç«¯ç¹tokenendpoint-ææ¡",normalizedTitle:"tokenå¤çç«¯ç¹tokenendpointï¼ææ¡ï¼",charIndex:3423},{level:2,title:"TokenGranterï¼ææ¡ï¼",slug:"tokengranter-ææ¡",normalizedTitle:"tokengranterï¼ææ¡ï¼",charIndex:6192},{level:2,title:"AuthorizationServerTokenServicesï¼äºè§£ï¼",slug:"authorizationservertokenservices-äºè§£",normalizedTitle:"authorizationservertokenservicesï¼äºè§£ï¼",charIndex:133},{level:2,title:"æ»ç»",slug:"æ»ç»",normalizedTitle:"æ»ç»",charIndex:173}],headersStr:"åå¤å·¥ä½ @EnableAuthorizationServer å®¢æ·ç«¯èº«ä»½è®¤è¯æ ¸å¿è¿æ»¤å¨ClientCredentialsTokenEndpointFilterï¼ææ¡ï¼ é¡¶çº§èº«ä»½ç®¡çèAuthenticationManagerï¼ææ¡ï¼ Tokenå¤çç«¯ç¹TokenEndpointï¼ææ¡ï¼ TokenGranterï¼ææ¡ï¼ AuthorizationServerTokenServicesï¼äºè§£ï¼ æ»ç»",content:' * åå¤å·¥ä½\n * @EnableAuthorizationServer\n * å®¢æ·ç«¯èº«ä»½è®¤è¯æ ¸å¿è¿æ»¤å¨ClientCredentialsTokenEndpointFilterï¼ææ¡ï¼\n * é¡¶çº§èº«ä»½ç®¡çèAuthenticationManagerï¼ææ¡ï¼\n * AuthorizationServerTokenServicesï¼äºè§£ï¼\n * æ»ç»\n\n----------------------------------------\n\n----------------------------------------\n\næ¬æå¼å§ä»æºç çå±é¢ï¼è®²è§£ä¸äºSpring Security Oauth2çè®¤è¯æµç¨ãæ¬æè¾é¿ï¼éåå¨ç©ºä½æ¶é´æ®µè§çãä¸æ¶åäºè¾å¤çæºç ï¼éå³é®æ§ä»£ç ä»¥â¦ä»£æ¿ã\n\n\n# åå¤å·¥ä½\n\né¦åå¼å¯debugä¿¡æ¯ï¼\n\nlogging:\n  level:\n    org.springframework: DEBUG\n\n\n1\n2\n3\n\n\nå¯ä»¥å®æ´ççå°åé¨çè¿è½¬æµç¨ã\n\nclientæ¨¡å¼ç¨å¾®ç®åä¸äºï¼ä½¿ç¨clientæ¨¡å¼è·åtoken http://localhost:8080/oauth/token?client_id=client_1&client_secret=123456&scope=select&grant_type=client_credentials\n\nç±äºdebugä¿¡æ¯å¤ªå¤äºï¼æç®åæç§é¡ºåºåäºä¸ä¸å³é®çå ä¸ªç±»ï¼\n\nClientCredentialsTokenEndpointFilter\nDaoAuthenticationProvider\nTokenEndpoint\nTokenGranter\n\n\n1\n2\n3\n4\n\n\n\n# @EnableAuthorizationServer\n\nä¸ä¸ç¯åå®¢ä¸­æä»¬å°è¯ä½¿ç¨äºpasswordæ¨¡å¼åclientæ¨¡å¼ï¼æä¸ä¸ªæ¯è¾å³é®çendpointï¼/oauth/tokenãä»è¿ä¸ªå¥å£å¼å§åæï¼spring security oauth2åé¨æ¯å¦ä½çætokençãè·åtokenï¼ä¸ç¬¬ä¸ç¯æç« ä¸­çä¸¤ä¸ªéè¦æ¦å¿µä¹ä¸æå³ï¼ä¹å°±æ¯AuthorizationServerä¸ResourceServerä¸­çAuthorizationServerã\n\nå¨ä¹åçéç½®ä¸­\n\n@Configuration\n@EnableAuthorizationServer\nprotected static class AuthorizationServerConfiguration extends AuthorizationServerConfigurerAdapter {}\n\n\n1\n2\n3\n\n\nåºç°äºAuthorizationServerConfigurerAdapter å³é®ç±»ï¼ä»å³èäºä¸ä¸ªéè¦çéç½®ç±»ï¼åå«æ¯\n\npublic class AuthorizationServerConfigurerAdapter implements AuthorizationServerConfigurer {\n\t@Override\n\tpublic void configure(AuthorizationServerSecurityConfigurer security <1>) throws Exception{\n\t}\n\n\t@Override\n\tpublic void configure(ClientDetailsServiceConfigurer clients <2>) throws Exception {\n\t}\n\n\t@Override\n\tpublic void configure(AuthorizationServerEndpointsConfigurer endpoints <3>) throws Exception {\n\t}\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n<1> éç½®AuthorizationServerå®å¨è®¤è¯çç¸å³ä¿¡æ¯ï¼åå»ºClientCredentialsTokenEndpointFilteræ ¸å¿è¿æ»¤å¨\n\n<2> éç½®OAuth2çå®¢æ·ç«¯ç¸å³ä¿¡æ¯\n\n<3> éç½®AuthorizationServerEndpointsConfigurerä¼å¤ç¸å³ç±»ï¼åæ¬éç½®èº«ä»½è®¤è¯å¨ï¼éç½®è®¤è¯æ¹å¼ï¼TokenStoreï¼TokenGranterï¼OAuth2RequestFactory\n\næä»¬éæ­¥åæå¶ä¸­å³é®çç±»\n\n\n# å®¢æ·ç«¯èº«ä»½è®¤è¯æ ¸å¿è¿æ»¤å¨ClientCredentialsTokenEndpointFilterï¼ææ¡ï¼\n\næªåå³é®çä»£ç ï¼å¯ä»¥åæåºå¤§æ¦çæµç¨ å¨è¯·æ±å°è¾¾/oauth/tokenä¹åç»è¿äºClientCredentialsTokenEndpointFilterè¿ä¸ªè¿æ»¤å¨ï¼å³é®æ¹æ³å¦ä¸\n\npublic Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response)\n\t\tthrows AuthenticationException, IOException, ServletException {\n\t...\n\tString clientId = request.getParameter("client_id");\n\tString clientSecret = request.getParameter("client_secret");\n\n\t...\n\tclientId = clientId.trim();\n\tUsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(clientId,\n\t\t\tclientSecret);\n\n\treturn this.getAuthenticationManager().authenticate(authRequest);\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# é¡¶çº§èº«ä»½ç®¡çèAuthenticationManagerï¼ææ¡ï¼\n\nç¨æ¥ä»è¯·æ±ä¸­è·åclient_id,client_secretï¼ç»è£æä¸ä¸ªUsernamePasswordAuthenticationTokenä½ä¸ºèº«ä»½æ è¯ï¼ä½¿ç¨å®¹å¨ä¸­çé¡¶çº§èº«ä»½ç®¡çå¨AuthenticationManagerå»è¿è¡èº«ä»½è®¤è¯ï¼AuthenticationManagerçå®ç°ç±»ä¸è¬æ¯ProviderManagerãèProviderManageråé¨ç»´æ¤äºä¸ä¸ªList,çæ­£çèº«ä»½è®¤è¯æ¯ç±ä¸ç³»åAuthenticationProviderå»å®æãèAuthenticationProviderçå¸¸ç¨å®ç°ç±»åæ¯DaoAuthenticationProviderï¼DaoAuthenticationProvideråé¨åèåäºä¸ä¸ªUserDetailsServiceæ¥å£ï¼UserDetailsServiceææ¯è·åç¨æ·è¯¦ç»ä¿¡æ¯çæç»æ¥å£ï¼èæä»¬ä¸ä¸ç¯æç« ä¸­å¨åå­ä¸­éç½®ç¨æ·ï¼å°±æ¯ä½¿ç¨äºUserDetailsServiceçä¸ä¸ªå®ç°ç±»InMemoryUserDetailsManagerï¼ãUMLç±»å¾å¯ä»¥å¤§æ¦çè§£ä¸è¿äºç±»çå³ç³»ï¼çç¥äºææé¨åã è®¤è¯ç¸å³\n\nå¾1 è®¤è¯ç¸å³UMLç±»å¾\n\nå¯è½æºæºçè¯»èä¼åç°ä¸ä¸ªé®é¢ï¼æåé¢ä¸ç¯æç« å·²ç»æå°äºclientæ¨¡å¼æ¯ä¸å­å¨âç¨æ·âçæ¦å¿µçï¼é£ä¹è¿éçèº«ä»½è®¤è¯æ¯å¨è®¤è¯ä»ä¹å¢ï¼debugå¯ä»¥åç°UserDetailsServiceçå®ç°è¢«ééæäºClientDetailsUserDetailsServiceï¼è¿ä¸ªè®¾è®¡æ¯å°clientå®¢æ·ç«¯çä¿¡æ¯ï¼client_id,client_secretï¼ééæç¨æ·çä¿¡æ¯(username,password)ï¼è¿æ ·æä»¬çè®¤è¯æµç¨å°±ä¸éè¦ä¿®æ¹äºã\n\nç»è¿ClientCredentialsTokenEndpointFilterä¹åï¼èº«ä»½ä¿¡æ¯å·²ç»å¾å°äºAuthenticationManagerçéªè¯ãæ¥çä¾¿å°è¾¾äº\n\nTokenEndpointã\n\n\n# Tokenå¤çç«¯ç¹TokenEndpointï¼ææ¡ï¼\n\nåé¢çä¸¤ä¸ªClientCredentialsTokenEndpointFilteråAuthenticationManagerå¯ä»¥çè§£ä¸ºä¸äºåç½®æ ¡éªï¼åèº«ä»½å°è£ï¼èè¿ä¸ªç±»ä¸çåå­å°±ç¥éåæä»¬çtokenæ¯å¯åç¸å³çã\n\n@FrameworkEndpoint\npublic class TokenEndpoint extends AbstractEndpoint {\n\n\t@RequestMapping(value = "/oauth/token", method=RequestMethod.POST)\n\tpublic ResponseEntity<OAuth2AccessToken> postAccessToken(Principal principal, @RequestParam\n\tMap<String, String> parameters) throws HttpRequestMethodNotSupportedException {\n\t\t ...\n\t\tString clientId = getClientId(principal);\n\t\tClientDetails authenticatedClient = getClientDetailsService().loadClientByClientId(clientId);//<1>\n\t\t...\n\t\tTokenRequest tokenRequest = getOAuth2RequestFactory().createTokenRequest(parameters, authenticatedClient);//<2>\n\t\t...\n\t\tOAuth2AccessToken token = getTokenGranter().grant(tokenRequest.getGrantType(), tokenRequest);//<3>\n\t\t...\n\t\treturn getResponse(token);\n\n\t}\n\n\tprivate TokenGranter tokenGranter;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n<1> å è½½å®¢æ·ç«¯ä¿¡æ¯\n\n<2> ç»åè¯·æ±ä¿¡æ¯ï¼åå»ºTokenRequest\n\n<3> å°TokenRequestä¼ éç»TokenGranteré¢åtoken\n\nçç¥äºä¸äºæ ¡éªä»£ç ä¹åï¼çæ­£ç/oauth/tokenç«¯ç¹æ´é²å¨äºæä»¬ç¼åï¼å¶ä¸­æ¹æ³åæ°ä¸­çPrincipalç»è¿ä¹åçè¿æ»¤å¨ï¼å·²ç»è¢«å¡«åäºç¸å³çä¿¡æ¯ï¼èæ¹æ³çåé¨åæ¯ä¾èµäºä¸ä¸ªTokenGranter æ¥é¢åtokenãå¶ä¸­OAuth2AccessTokençå®ç°ç±»DefaultOAuth2AccessTokenå°±æ¯æç»å¨æ§å¶å°å¾å°çtokenåºååä¹åçåå§ç±»:\n\npublic class DefaultOAuth2AccessToken implements Serializable, OAuth2AccessToken {\n  private static final long serialVersionUID = 914967629530462926L;\n  private String value;\n  private Date expiration;\n  private String tokenType = BEARER_TYPE.toLowerCase();\n  private OAuth2RefreshToken refreshToken;\n  private Set<String> scope;\n  private Map<String, Object> additionalInformation = Collections.emptyMap();\n  //getter,setter\n}\n@org.codehaus.jackson.map.annotate.JsonSerialize(using = OAuth2AccessTokenJackson1Serializer.class)\n@org.codehaus.jackson.map.annotate.JsonDeserialize(using = OAuth2AccessTokenJackson1Deserializer.class)\n@com.fasterxml.jackson.databind.annotation.JsonSerialize(using = OAuth2AccessTokenJackson2Serializer.class)\n@com.fasterxml.jackson.databind.annotation.JsonDeserialize(using = OAuth2AccessTokenJackson2Deserializer.class)\npublic interface OAuth2AccessToken {\n\tpublic static String BEARER_TYPE = "Bearer";\n\tpublic static String OAUTH2_TYPE = "OAuth2";\n\tpublic static String ACCESS_TOKEN = "access_token";\n\tpublic static String TOKEN_TYPE = "token_type";\n\tpublic static String EXPIRES_IN = "expires_in";\n\tpublic static String REFRESH_TOKEN = "refresh_token";\n\tpublic static String SCOPE = "scope";\n\t...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nä¸ä¸ªå¸åçæ ·ä¾tokenååº,å¦ä¸æç¤ºï¼å°±æ¯ä¸è¿°ç±»åºåååçç»æï¼\n\n{\n\t"access_token":"950a7cc9-5a8a-42c9-a693-40e817b1a4b0",\n\t"token_type":"bearer",\n\t"refresh_token":"773a0fcd-6023-45f8-8848-e141296cb3cb",\n\t"expires_in":27036,\n\t"scope":"select"\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# TokenGranterï¼ææ¡ï¼\n\nåä»UMLç±»å¾å¯¹TokenGranteræ¥å£çè®¾è®¡æä¸ä¸ªå®è§çè®¤è¯\n\n\n\nå¾2 TokenGranterç¸å³UMLç±»å¾\n\nTokenGranterçè®¾è®¡æè·¯æ¯ä½¿ç¨CompositeTokenGranterç®¡çä¸ä¸ªListåè¡¨ï¼æ¯ä¸ç§grantTypeå¯¹åºä¸ä¸ªå·ä½ççæ­£ææèï¼å¨debugè¿ç¨ä¸­å¯ä»¥åç°CompositeTokenGranter åé¨å°±æ¯å¨å¾ªç¯è°ç¨äºç§TokenGranterå®ç°ç±»çgrantæ¹æ³ï¼ègranteråé¨åæ¯éè¿grantTypeæ¥åºåæ¯å¦æ¯åèªçææç±»åã\n\npublic class CompositeTokenGranter implements TokenGranter {\n\n\tprivate final List<TokenGranter> tokenGranters;\n\n\tpublic CompositeTokenGranter(List<TokenGranter> tokenGranters) {\n\t\tthis.tokenGranters = new ArrayList<TokenGranter>(tokenGranters);\n\t}\n\n\tpublic OAuth2AccessToken grant(String grantType, TokenRequest tokenRequest) {\n\t\tfor (TokenGranter granter : tokenGranters) {\n\t\t\tOAuth2AccessToken grant = granter.grant(grantType, tokenRequest);\n\t\t\tif (grant!=null) {\n\t\t\t\treturn grant;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\näºç§ç±»ååå«æ¯ï¼\n\n * ResourceOwnerPasswordTokenGranter ==> passwordå¯ç æ¨¡å¼\n * AuthorizationCodeTokenGranter ==> authorization_codeææç æ¨¡å¼\n * ClientCredentialsTokenGranter ==> client_credentialså®¢æ·ç«¯æ¨¡å¼\n * ImplicitTokenGranter ==> implicitç®åæ¨¡å¼\n * RefreshTokenGranter ==>refresh_token å·æ°tokenä¸ç¨\n\nä»¥å®¢æ·ç«¯æ¨¡å¼ä¸ºä¾ï¼æèå¦ä½äº§çtokençï¼åéè¦ç»§ç»­ç ç©¶5ç§ææèçæ½è±¡ç±»ï¼AbstractTokenGranter\n\npublic abstract class AbstractTokenGranter implements TokenGranter {\n\tprotected final Log logger = LogFactory.getLog(getClass());\n\t//ä¸tokenç¸å³çserviceï¼éç¹\n\tprivate final AuthorizationServerTokenServices tokenServices;\n\t//ä¸clientDetailsç¸å³çserviceï¼éç¹\n\tprivate final ClientDetailsService clientDetailsService;\n\t//åå»ºoauth2Requestçå·¥åï¼éç¹\n\tprivate final OAuth2RequestFactory requestFactory;\n\n\tprivate final String grantType;\n\t...\n\n\tpublic OAuth2AccessToken grant(String grantType, TokenRequest tokenRequest) {\n\n\t\t...\n\t\tString clientId = tokenRequest.getClientId();\n\t\tClientDetails client = clientDetailsService.loadClientByClientId(clientId);\n\t\tvalidateGrantType(grantType, client);\n\n\t\tlogger.debug("Getting access token for: " + clientId);\n\n\t\treturn getAccessToken(client, tokenRequest);\n\n\t}\n\n\tprotected OAuth2AccessToken getAccessToken(ClientDetails client, TokenRequest tokenRequest) {\n\t\treturn tokenServices.createAccessToken(getOAuth2Authentication(client, tokenRequest));\n\t}\n\n\tprotected OAuth2Authentication getOAuth2Authentication(ClientDetails client, TokenRequest tokenRequest) {\n\t\tOAuth2Request storedOAuth2Request = requestFactory.createOAuth2Request(client, tokenRequest);\n\t\treturn new OAuth2Authentication(storedOAuth2Request, null);\n\t}\n\n\t...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n\n\nåè¿å¤´å»çTokenEndpointä¸­ï¼æ­£æ¯è°ç¨äºè¿éçä¸ä¸ªéè¦çç±»åéçç¸å³æ¹æ³ãç±äºç¯å¹éå¶ï¼ä¸è½å»¶å±å¤ªå¤ï¼ä¸ç¶æ²¡å®æ²¡äºï¼æä»¥éç¹åæä¸AuthorizationServerTokenServicesæ¯ä½æ¹ç¥å£ã\n\n\n# AuthorizationServerTokenServicesï¼äºè§£ï¼\n\nAuthorizationServerç«¯çtokenæä½serviceï¼æ¥å£è®¾è®¡å¦ä¸ï¼\n\npublic interface AuthorizationServerTokenServices {\n\t//åå»ºtoken\n\tOAuth2AccessToken createAccessToken(OAuth2Authentication authentication) throws AuthenticationException;\n\t//å·æ°token\n\tOAuth2AccessToken refreshAccessToken(String refreshToken, TokenRequest tokenRequest)\n\t\t\tthrows AuthenticationException;\n\t//è·åtoken\n\tOAuth2AccessToken getAccessToken(OAuth2Authentication authentication);\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¨é»è®¤çå®ç°ç±»DefaultTokenServicesä¸­ï¼å¯ä»¥çå°tokenæ¯å¦ä½äº§ççï¼å¹¶ä¸äºè§£äºæ¡æ¶å¯¹tokenè¿è¡åªäºä¿¡æ¯çå³èã\n\n@Transactional\npublic OAuth2AccessToken createAccessToken(OAuth2Authentication authentication) throws AuthenticationException {\n\n\tOAuth2AccessToken existingAccessToken = tokenStore.getAccessToken(authentication);\n\tOAuth2RefreshToken refreshToken = null;\n\tif (existingAccessToken != null) {\n\t\tif (existingAccessToken.isExpired()) {\n\t\t\tif (existingAccessToken.getRefreshToken() != null) {\n\t\t\t\trefreshToken = existingAccessToken.getRefreshToken();\n\t\t\t\t// The token store could remove the refresh token when the\n\t\t\t\t// access token is removed, but we want to\n\t\t\t\t// be sure...\n\t\t\t\ttokenStore.removeRefreshToken(refreshToken);\n\t\t\t}\n\t\t\ttokenStore.removeAccessToken(existingAccessToken);\n\t\t}\n\t\telse {\n\t\t\t// Re-store the access token in case the authentication has changed\n\t\t\ttokenStore.storeAccessToken(existingAccessToken, authentication);\n\t\t\treturn existingAccessToken;\n\t\t}\n\t}\n\n\t// Only create a new refresh token if there wasn\'t an existing one\n\t// associated with an expired access token.\n\t// Clients might be holding existing refresh tokens, so we re-use it in\n\t// the case that the old access token\n\t// expired.\n\tif (refreshToken == null) {\n\t\trefreshToken = createRefreshToken(authentication);\n\t}\n\t// But the refresh token itself might need to be re-issued if it has\n\t// expired.\n\telse if (refreshToken instanceof ExpiringOAuth2RefreshToken) {\n\t\tExpiringOAuth2RefreshToken expiring = (ExpiringOAuth2RefreshToken) refreshToken;\n\t\tif (System.currentTimeMillis() > expiring.getExpiration().getTime()) {\n\t\t\trefreshToken = createRefreshToken(authentication);\n\t\t}\n\t}\n\n\tOAuth2AccessToken accessToken = createAccessToken(authentication, refreshToken);\n\ttokenStore.storeAccessToken(accessToken, authentication);\n\t// In case it was modified\n\trefreshToken = accessToken.getRefreshToken();\n\tif (refreshToken != null) {\n\t\ttokenStore.storeRefreshToken(refreshToken, authentication);\n\t}\n\treturn accessToken;\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n\n\nç®åæ»ç»ä¸ä¸AuthorizationServerTokenServicesçä½ç¨ï¼ä»æä¾äºåå»ºtokenï¼å·æ°tokenï¼è·åtokençå®ç°ãå¨åå»ºtokenæ¶ï¼ä»ä¼è°ç¨tokenStoreå¯¹äº§ççtokenåç¸å³ä¿¡æ¯å­å¨å°å¯¹åºçå®ç°ç±»ä¸­ï¼å¯ä»¥æ¯redisï¼æ°æ®åºï¼åå­ï¼jwtã\n\n\n# æ»ç»\n\næ¬ç¯æ»ç»äºä½¿ç¨å®¢æ·ç«¯æ¨¡å¼è·åTokenæ¶ï¼spring security oauth2åé¨çè¿ä½æµç¨ï¼éç¹æ¯å¨åæAuthenticationServerç¸å³çç±»ãå¶ä»æ¨¡å¼æä¸å®çä¸åï¼ä½æ½è±¡åè½æ¯åºå®çï¼åªæ¯å·ä½çå®ç°ç±»ä¼è¢«ç¸åºå°æ¿æ¢ãéè¯»springçæºç ï¼ä¼åç°å®çè®¾è®¡ä¸­åºç°äºéå¸¸å¤çæ½è±¡æ¥å£ï¼è¿å¯¹æä»¬çæ¸æ¥åé¨å·¥ä½æµç¨äº§çäºä¸å°çå°æ°ï¼æçæ¹å¼æ¯å¯ä»¥åå©UMLç±»å¾ï¼åä»å®è§çæ¸æ¥ä½èçè®¾è®¡æè·¯ï¼è¿ä¼è®©æä»¬çåæäºåååã\n\nä¸ä¸ç¯æç« éç¹åæç¨æ·æºå¸¦tokenè®¿é®åéèµæºæ¶ï¼spring security oauth2åé¨çå·¥ä½æµç¨ãå³ResourceServerç¸å³çç±»ã',normalizedContent:' * åå¤å·¥ä½\n * @enableauthorizationserver\n * å®¢æ·ç«¯èº«ä»½è®¤è¯æ ¸å¿è¿æ»¤å¨clientcredentialstokenendpointfilterï¼ææ¡ï¼\n * é¡¶çº§èº«ä»½ç®¡çèauthenticationmanagerï¼ææ¡ï¼\n * authorizationservertokenservicesï¼äºè§£ï¼\n * æ»ç»\n\n----------------------------------------\n\n----------------------------------------\n\næ¬æå¼å§ä»æºç çå±é¢ï¼è®²è§£ä¸äºspring security oauth2çè®¤è¯æµç¨ãæ¬æè¾é¿ï¼éåå¨ç©ºä½æ¶é´æ®µè§çãä¸æ¶åäºè¾å¤çæºç ï¼éå³é®æ§ä»£ç ä»¥â¦ä»£æ¿ã\n\n\n# åå¤å·¥ä½\n\né¦åå¼å¯debugä¿¡æ¯ï¼\n\nlogging:\n  level:\n    org.springframework: debug\n\n\n1\n2\n3\n\n\nå¯ä»¥å®æ´ççå°åé¨çè¿è½¬æµç¨ã\n\nclientæ¨¡å¼ç¨å¾®ç®åä¸äºï¼ä½¿ç¨clientæ¨¡å¼è·åtoken http://localhost:8080/oauth/token?client_id=client_1&client_secret=123456&scope=select&grant_type=client_credentials\n\nç±äºdebugä¿¡æ¯å¤ªå¤äºï¼æç®åæç§é¡ºåºåäºä¸ä¸å³é®çå ä¸ªç±»ï¼\n\nclientcredentialstokenendpointfilter\ndaoauthenticationprovider\ntokenendpoint\ntokengranter\n\n\n1\n2\n3\n4\n\n\n\n# @enableauthorizationserver\n\nä¸ä¸ç¯åå®¢ä¸­æä»¬å°è¯ä½¿ç¨äºpasswordæ¨¡å¼åclientæ¨¡å¼ï¼æä¸ä¸ªæ¯è¾å³é®çendpointï¼/oauth/tokenãä»è¿ä¸ªå¥å£å¼å§åæï¼spring security oauth2åé¨æ¯å¦ä½çætokençãè·åtokenï¼ä¸ç¬¬ä¸ç¯æç« ä¸­çä¸¤ä¸ªéè¦æ¦å¿µä¹ä¸æå³ï¼ä¹å°±æ¯authorizationserverä¸resourceserverä¸­çauthorizationserverã\n\nå¨ä¹åçéç½®ä¸­\n\n@configuration\n@enableauthorizationserver\nprotected static class authorizationserverconfiguration extends authorizationserverconfigureradapter {}\n\n\n1\n2\n3\n\n\nåºç°äºauthorizationserverconfigureradapter å³é®ç±»ï¼ä»å³èäºä¸ä¸ªéè¦çéç½®ç±»ï¼åå«æ¯\n\npublic class authorizationserverconfigureradapter implements authorizationserverconfigurer {\n\t@override\n\tpublic void configure(authorizationserversecurityconfigurer security <1>) throws exception{\n\t}\n\n\t@override\n\tpublic void configure(clientdetailsserviceconfigurer clients <2>) throws exception {\n\t}\n\n\t@override\n\tpublic void configure(authorizationserverendpointsconfigurer endpoints <3>) throws exception {\n\t}\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n<1> éç½®authorizationserverå®å¨è®¤è¯çç¸å³ä¿¡æ¯ï¼åå»ºclientcredentialstokenendpointfilteræ ¸å¿è¿æ»¤å¨\n\n<2> éç½®oauth2çå®¢æ·ç«¯ç¸å³ä¿¡æ¯\n\n<3> éç½®authorizationserverendpointsconfigurerä¼å¤ç¸å³ç±»ï¼åæ¬éç½®èº«ä»½è®¤è¯å¨ï¼éç½®è®¤è¯æ¹å¼ï¼tokenstoreï¼tokengranterï¼oauth2requestfactory\n\næä»¬éæ­¥åæå¶ä¸­å³é®çç±»\n\n\n# å®¢æ·ç«¯èº«ä»½è®¤è¯æ ¸å¿è¿æ»¤å¨clientcredentialstokenendpointfilterï¼ææ¡ï¼\n\næªåå³é®çä»£ç ï¼å¯ä»¥åæåºå¤§æ¦çæµç¨ å¨è¯·æ±å°è¾¾/oauth/tokenä¹åç»è¿äºclientcredentialstokenendpointfilterè¿ä¸ªè¿æ»¤å¨ï¼å³é®æ¹æ³å¦ä¸\n\npublic authentication attemptauthentication(httpservletrequest request, httpservletresponse response)\n\t\tthrows authenticationexception, ioexception, servletexception {\n\t...\n\tstring clientid = request.getparameter("client_id");\n\tstring clientsecret = request.getparameter("client_secret");\n\n\t...\n\tclientid = clientid.trim();\n\tusernamepasswordauthenticationtoken authrequest = new usernamepasswordauthenticationtoken(clientid,\n\t\t\tclientsecret);\n\n\treturn this.getauthenticationmanager().authenticate(authrequest);\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# é¡¶çº§èº«ä»½ç®¡çèauthenticationmanagerï¼ææ¡ï¼\n\nç¨æ¥ä»è¯·æ±ä¸­è·åclient_id,client_secretï¼ç»è£æä¸ä¸ªusernamepasswordauthenticationtokenä½ä¸ºèº«ä»½æ è¯ï¼ä½¿ç¨å®¹å¨ä¸­çé¡¶çº§èº«ä»½ç®¡çå¨authenticationmanagerå»è¿è¡èº«ä»½è®¤è¯ï¼authenticationmanagerçå®ç°ç±»ä¸è¬æ¯providermanagerãèprovidermanageråé¨ç»´æ¤äºä¸ä¸ªlist,çæ­£çèº«ä»½è®¤è¯æ¯ç±ä¸ç³»åauthenticationproviderå»å®æãèauthenticationproviderçå¸¸ç¨å®ç°ç±»åæ¯daoauthenticationproviderï¼daoauthenticationprovideråé¨åèåäºä¸ä¸ªuserdetailsserviceæ¥å£ï¼userdetailsserviceææ¯è·åç¨æ·è¯¦ç»ä¿¡æ¯çæç»æ¥å£ï¼èæä»¬ä¸ä¸ç¯æç« ä¸­å¨åå­ä¸­éç½®ç¨æ·ï¼å°±æ¯ä½¿ç¨äºuserdetailsserviceçä¸ä¸ªå®ç°ç±»inmemoryuserdetailsmanagerï¼ãumlç±»å¾å¯ä»¥å¤§æ¦çè§£ä¸è¿äºç±»çå³ç³»ï¼çç¥äºææé¨åã è®¤è¯ç¸å³\n\nå¾1 è®¤è¯ç¸å³umlç±»å¾\n\nå¯è½æºæºçè¯»èä¼åç°ä¸ä¸ªé®é¢ï¼æåé¢ä¸ç¯æç« å·²ç»æå°äºclientæ¨¡å¼æ¯ä¸å­å¨âç¨æ·âçæ¦å¿µçï¼é£ä¹è¿éçèº«ä»½è®¤è¯æ¯å¨è®¤è¯ä»ä¹å¢ï¼debugå¯ä»¥åç°userdetailsserviceçå®ç°è¢«ééæäºclientdetailsuserdetailsserviceï¼è¿ä¸ªè®¾è®¡æ¯å°clientå®¢æ·ç«¯çä¿¡æ¯ï¼client_id,client_secretï¼ééæç¨æ·çä¿¡æ¯(username,password)ï¼è¿æ ·æä»¬çè®¤è¯æµç¨å°±ä¸éè¦ä¿®æ¹äºã\n\nç»è¿clientcredentialstokenendpointfilterä¹åï¼èº«ä»½ä¿¡æ¯å·²ç»å¾å°äºauthenticationmanagerçéªè¯ãæ¥çä¾¿å°è¾¾äº\n\ntokenendpointã\n\n\n# tokenå¤çç«¯ç¹tokenendpointï¼ææ¡ï¼\n\nåé¢çä¸¤ä¸ªclientcredentialstokenendpointfilteråauthenticationmanagerå¯ä»¥çè§£ä¸ºä¸äºåç½®æ ¡éªï¼åèº«ä»½å°è£ï¼èè¿ä¸ªç±»ä¸çåå­å°±ç¥éåæä»¬çtokenæ¯å¯åç¸å³çã\n\n@frameworkendpoint\npublic class tokenendpoint extends abstractendpoint {\n\n\t@requestmapping(value = "/oauth/token", method=requestmethod.post)\n\tpublic responseentity<oauth2accesstoken> postaccesstoken(principal principal, @requestparam\n\tmap<string, string> parameters) throws httprequestmethodnotsupportedexception {\n\t\t ...\n\t\tstring clientid = getclientid(principal);\n\t\tclientdetails authenticatedclient = getclientdetailsservice().loadclientbyclientid(clientid);//<1>\n\t\t...\n\t\ttokenrequest tokenrequest = getoauth2requestfactory().createtokenrequest(parameters, authenticatedclient);//<2>\n\t\t...\n\t\toauth2accesstoken token = gettokengranter().grant(tokenrequest.getgranttype(), tokenrequest);//<3>\n\t\t...\n\t\treturn getresponse(token);\n\n\t}\n\n\tprivate tokengranter tokengranter;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n<1> å è½½å®¢æ·ç«¯ä¿¡æ¯\n\n<2> ç»åè¯·æ±ä¿¡æ¯ï¼åå»ºtokenrequest\n\n<3> å°tokenrequestä¼ éç»tokengranteré¢åtoken\n\nçç¥äºä¸äºæ ¡éªä»£ç ä¹åï¼çæ­£ç/oauth/tokenç«¯ç¹æ´é²å¨äºæä»¬ç¼åï¼å¶ä¸­æ¹æ³åæ°ä¸­çprincipalç»è¿ä¹åçè¿æ»¤å¨ï¼å·²ç»è¢«å¡«åäºç¸å³çä¿¡æ¯ï¼èæ¹æ³çåé¨åæ¯ä¾èµäºä¸ä¸ªtokengranter æ¥é¢åtokenãå¶ä¸­oauth2accesstokençå®ç°ç±»defaultoauth2accesstokenå°±æ¯æç»å¨æ§å¶å°å¾å°çtokenåºååä¹åçåå§ç±»:\n\npublic class defaultoauth2accesstoken implements serializable, oauth2accesstoken {\n  private static final long serialversionuid = 914967629530462926l;\n  private string value;\n  private date expiration;\n  private string tokentype = bearer_type.tolowercase();\n  private oauth2refreshtoken refreshtoken;\n  private set<string> scope;\n  private map<string, object> additionalinformation = collections.emptymap();\n  //getter,setter\n}\n@org.codehaus.jackson.map.annotate.jsonserialize(using = oauth2accesstokenjackson1serializer.class)\n@org.codehaus.jackson.map.annotate.jsondeserialize(using = oauth2accesstokenjackson1deserializer.class)\n@com.fasterxml.jackson.databind.annotation.jsonserialize(using = oauth2accesstokenjackson2serializer.class)\n@com.fasterxml.jackson.databind.annotation.jsondeserialize(using = oauth2accesstokenjackson2deserializer.class)\npublic interface oauth2accesstoken {\n\tpublic static string bearer_type = "bearer";\n\tpublic static string oauth2_type = "oauth2";\n\tpublic static string access_token = "access_token";\n\tpublic static string token_type = "token_type";\n\tpublic static string expires_in = "expires_in";\n\tpublic static string refresh_token = "refresh_token";\n\tpublic static string scope = "scope";\n\t...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nä¸ä¸ªå¸åçæ ·ä¾tokenååº,å¦ä¸æç¤ºï¼å°±æ¯ä¸è¿°ç±»åºåååçç»æï¼\n\n{\n\t"access_token":"950a7cc9-5a8a-42c9-a693-40e817b1a4b0",\n\t"token_type":"bearer",\n\t"refresh_token":"773a0fcd-6023-45f8-8848-e141296cb3cb",\n\t"expires_in":27036,\n\t"scope":"select"\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# tokengranterï¼ææ¡ï¼\n\nåä»umlç±»å¾å¯¹tokengranteræ¥å£çè®¾è®¡æä¸ä¸ªå®è§çè®¤è¯\n\n\n\nå¾2 tokengranterç¸å³umlç±»å¾\n\ntokengranterçè®¾è®¡æè·¯æ¯ä½¿ç¨compositetokengranterç®¡çä¸ä¸ªliståè¡¨ï¼æ¯ä¸ç§granttypeå¯¹åºä¸ä¸ªå·ä½ççæ­£ææèï¼å¨debugè¿ç¨ä¸­å¯ä»¥åç°compositetokengranter åé¨å°±æ¯å¨å¾ªç¯è°ç¨äºç§tokengranterå®ç°ç±»çgrantæ¹æ³ï¼ègranteråé¨åæ¯éè¿granttypeæ¥åºåæ¯å¦æ¯åèªçææç±»åã\n\npublic class compositetokengranter implements tokengranter {\n\n\tprivate final list<tokengranter> tokengranters;\n\n\tpublic compositetokengranter(list<tokengranter> tokengranters) {\n\t\tthis.tokengranters = new arraylist<tokengranter>(tokengranters);\n\t}\n\n\tpublic oauth2accesstoken grant(string granttype, tokenrequest tokenrequest) {\n\t\tfor (tokengranter granter : tokengranters) {\n\t\t\toauth2accesstoken grant = granter.grant(granttype, tokenrequest);\n\t\t\tif (grant!=null) {\n\t\t\t\treturn grant;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\näºç§ç±»ååå«æ¯ï¼\n\n * resourceownerpasswordtokengranter ==> passwordå¯ç æ¨¡å¼\n * authorizationcodetokengranter ==> authorization_codeææç æ¨¡å¼\n * clientcredentialstokengranter ==> client_credentialså®¢æ·ç«¯æ¨¡å¼\n * implicittokengranter ==> implicitç®åæ¨¡å¼\n * refreshtokengranter ==>refresh_token å·æ°tokenä¸ç¨\n\nä»¥å®¢æ·ç«¯æ¨¡å¼ä¸ºä¾ï¼æèå¦ä½äº§çtokençï¼åéè¦ç»§ç»­ç ç©¶5ç§ææèçæ½è±¡ç±»ï¼abstracttokengranter\n\npublic abstract class abstracttokengranter implements tokengranter {\n\tprotected final log logger = logfactory.getlog(getclass());\n\t//ä¸tokenç¸å³çserviceï¼éç¹\n\tprivate final authorizationservertokenservices tokenservices;\n\t//ä¸clientdetailsç¸å³çserviceï¼éç¹\n\tprivate final clientdetailsservice clientdetailsservice;\n\t//åå»ºoauth2requestçå·¥åï¼éç¹\n\tprivate final oauth2requestfactory requestfactory;\n\n\tprivate final string granttype;\n\t...\n\n\tpublic oauth2accesstoken grant(string granttype, tokenrequest tokenrequest) {\n\n\t\t...\n\t\tstring clientid = tokenrequest.getclientid();\n\t\tclientdetails client = clientdetailsservice.loadclientbyclientid(clientid);\n\t\tvalidategranttype(granttype, client);\n\n\t\tlogger.debug("getting access token for: " + clientid);\n\n\t\treturn getaccesstoken(client, tokenrequest);\n\n\t}\n\n\tprotected oauth2accesstoken getaccesstoken(clientdetails client, tokenrequest tokenrequest) {\n\t\treturn tokenservices.createaccesstoken(getoauth2authentication(client, tokenrequest));\n\t}\n\n\tprotected oauth2authentication getoauth2authentication(clientdetails client, tokenrequest tokenrequest) {\n\t\toauth2request storedoauth2request = requestfactory.createoauth2request(client, tokenrequest);\n\t\treturn new oauth2authentication(storedoauth2request, null);\n\t}\n\n\t...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n\n\nåè¿å¤´å»çtokenendpointä¸­ï¼æ­£æ¯è°ç¨äºè¿éçä¸ä¸ªéè¦çç±»åéçç¸å³æ¹æ³ãç±äºç¯å¹éå¶ï¼ä¸è½å»¶å±å¤ªå¤ï¼ä¸ç¶æ²¡å®æ²¡äºï¼æä»¥éç¹åæä¸authorizationservertokenservicesæ¯ä½æ¹ç¥å£ã\n\n\n# authorizationservertokenservicesï¼äºè§£ï¼\n\nauthorizationserverç«¯çtokenæä½serviceï¼æ¥å£è®¾è®¡å¦ä¸ï¼\n\npublic interface authorizationservertokenservices {\n\t//åå»ºtoken\n\toauth2accesstoken createaccesstoken(oauth2authentication authentication) throws authenticationexception;\n\t//å·æ°token\n\toauth2accesstoken refreshaccesstoken(string refreshtoken, tokenrequest tokenrequest)\n\t\t\tthrows authenticationexception;\n\t//è·åtoken\n\toauth2accesstoken getaccesstoken(oauth2authentication authentication);\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¨é»è®¤çå®ç°ç±»defaulttokenservicesä¸­ï¼å¯ä»¥çå°tokenæ¯å¦ä½äº§ççï¼å¹¶ä¸äºè§£äºæ¡æ¶å¯¹tokenè¿è¡åªäºä¿¡æ¯çå³èã\n\n@transactional\npublic oauth2accesstoken createaccesstoken(oauth2authentication authentication) throws authenticationexception {\n\n\toauth2accesstoken existingaccesstoken = tokenstore.getaccesstoken(authentication);\n\toauth2refreshtoken refreshtoken = null;\n\tif (existingaccesstoken != null) {\n\t\tif (existingaccesstoken.isexpired()) {\n\t\t\tif (existingaccesstoken.getrefreshtoken() != null) {\n\t\t\t\trefreshtoken = existingaccesstoken.getrefreshtoken();\n\t\t\t\t// the token store could remove the refresh token when the\n\t\t\t\t// access token is removed, but we want to\n\t\t\t\t// be sure...\n\t\t\t\ttokenstore.removerefreshtoken(refreshtoken);\n\t\t\t}\n\t\t\ttokenstore.removeaccesstoken(existingaccesstoken);\n\t\t}\n\t\telse {\n\t\t\t// re-store the access token in case the authentication has changed\n\t\t\ttokenstore.storeaccesstoken(existingaccesstoken, authentication);\n\t\t\treturn existingaccesstoken;\n\t\t}\n\t}\n\n\t// only create a new refresh token if there wasn\'t an existing one\n\t// associated with an expired access token.\n\t// clients might be holding existing refresh tokens, so we re-use it in\n\t// the case that the old access token\n\t// expired.\n\tif (refreshtoken == null) {\n\t\trefreshtoken = createrefreshtoken(authentication);\n\t}\n\t// but the refresh token itself might need to be re-issued if it has\n\t// expired.\n\telse if (refreshtoken instanceof expiringoauth2refreshtoken) {\n\t\texpiringoauth2refreshtoken expiring = (expiringoauth2refreshtoken) refreshtoken;\n\t\tif (system.currenttimemillis() > expiring.getexpiration().gettime()) {\n\t\t\trefreshtoken = createrefreshtoken(authentication);\n\t\t}\n\t}\n\n\toauth2accesstoken accesstoken = createaccesstoken(authentication, refreshtoken);\n\ttokenstore.storeaccesstoken(accesstoken, authentication);\n\t// in case it was modified\n\trefreshtoken = accesstoken.getrefreshtoken();\n\tif (refreshtoken != null) {\n\t\ttokenstore.storerefreshtoken(refreshtoken, authentication);\n\t}\n\treturn accesstoken;\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n\n\nç®åæ»ç»ä¸ä¸authorizationservertokenservicesçä½ç¨ï¼ä»æä¾äºåå»ºtokenï¼å·æ°tokenï¼è·åtokençå®ç°ãå¨åå»ºtokenæ¶ï¼ä»ä¼è°ç¨tokenstoreå¯¹äº§ççtokenåç¸å³ä¿¡æ¯å­å¨å°å¯¹åºçå®ç°ç±»ä¸­ï¼å¯ä»¥æ¯redisï¼æ°æ®åºï¼åå­ï¼jwtã\n\n\n# æ»ç»\n\næ¬ç¯æ»ç»äºä½¿ç¨å®¢æ·ç«¯æ¨¡å¼è·åtokenæ¶ï¼spring security oauth2åé¨çè¿ä½æµç¨ï¼éç¹æ¯å¨åæauthenticationserverç¸å³çç±»ãå¶ä»æ¨¡å¼æä¸å®çä¸åï¼ä½æ½è±¡åè½æ¯åºå®çï¼åªæ¯å·ä½çå®ç°ç±»ä¼è¢«ç¸åºå°æ¿æ¢ãéè¯»springçæºç ï¼ä¼åç°å®çè®¾è®¡ä¸­åºç°äºéå¸¸å¤çæ½è±¡æ¥å£ï¼è¿å¯¹æä»¬çæ¸æ¥åé¨å·¥ä½æµç¨äº§çäºä¸å°çå°æ°ï¼æçæ¹å¼æ¯å¯ä»¥åå©umlç±»å¾ï¼åä»å®è§çæ¸æ¥ä½èçè®¾è®¡æè·¯ï¼è¿ä¼è®©æä»¬çåæäºåååã\n\nä¸ä¸ç¯æç« éç¹åæç¨æ·æºå¸¦tokenè®¿é®åéèµæºæ¶ï¼spring security oauth2åé¨çå·¥ä½æµç¨ãå³resourceserverç¸å³çç±»ã',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼ä¸ï¼",frontmatter:{title:"ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼ä¸ï¼",date:"2022-02-03T00:03:27.000Z",permalink:"/pages/202614/",categories:["åç«¯","Spring Security"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/25.Spring%20Security/08.%E3%80%90%E8%80%81%E5%BE%90%E3%80%91%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%20Spring%20Security%20OAuth2%EF%BC%88%E4%B8%89%EF%BC%89.html",relativePath:"10.æ¡æ¶/25.Spring Security/08.ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼ä¸ï¼.md",key:"v-f7677c3c",path:"/pages/202614/",headers:[{level:2,title:"@EnableResourceServerä¸@EnableAuthorizationServer",slug:"enableresourceserverä¸-enableauthorizationserver",normalizedTitle:"@enableresourceserverä¸@enableauthorizationserver",charIndex:3},{level:2,title:"ResourceServerSecurityConfigurerï¼äºè§£ï¼",slug:"resourceserversecurityconfigurer-äºè§£",normalizedTitle:"resourceserversecurityconfigurerï¼äºè§£ï¼",charIndex:55},{level:2,title:"æ ¸å¿è¿æ»¤å¨ OAuth2AuthenticationProcessingFilterï¼ææ¡ï¼",slug:"æ ¸å¿è¿æ»¤å¨-oauth2authenticationprocessingfilter-ææ¡",normalizedTitle:"æ ¸å¿è¿æ»¤å¨ oauth2authenticationprocessingfilterï¼ææ¡ï¼",charIndex:95},{level:2,title:"OAuth2çèº«ä»½ç®¡çå¨âOAuth2AuthenticationManagerï¼ææ¡ï¼",slug:"oauth2çèº«ä»½ç®¡çå¨-oauth2authenticationmanager-ææ¡",normalizedTitle:"oauth2çèº«ä»½ç®¡çå¨âoauth2authenticationmanagerï¼ææ¡ï¼",charIndex:145},{level:2,title:"TokenExtractorï¼äºè§£ï¼",slug:"tokenextractor-äºè§£",normalizedTitle:"tokenextractorï¼äºè§£ï¼",charIndex:193},{level:2,title:"å¼å¸¸å¤ç",slug:"å¼å¸¸å¤ç",normalizedTitle:"å¼å¸¸å¤ç",charIndex:215},{level:2,title:"æ»ç»",slug:"æ»ç»",normalizedTitle:"æ»ç»",charIndex:223}],headersStr:"@EnableResourceServerä¸@EnableAuthorizationServer ResourceServerSecurityConfigurerï¼äºè§£ï¼ æ ¸å¿è¿æ»¤å¨ OAuth2AuthenticationProcessingFilterï¼ææ¡ï¼ OAuth2çèº«ä»½ç®¡çå¨âOAuth2AuthenticationManagerï¼ææ¡ï¼ TokenExtractorï¼äºè§£ï¼ å¼å¸¸å¤ç æ»ç»",content:' * @EnableResourceServerä¸@EnableAuthorizationServer\n * ResourceServerSecurityConfigurerï¼äºè§£ï¼\n * æ ¸å¿è¿æ»¤å¨ OAuth2AuthenticationProcessingFilterï¼ææ¡ï¼\n * OAuth2çèº«ä»½ç®¡çå¨âOAuth2AuthenticationManagerï¼ææ¡ï¼\n * TokenExtractorï¼äºè§£ï¼\n * å¼å¸¸å¤ç\n * æ»ç»\n\n----------------------------------------\n\n----------------------------------------\n\nä¸ä¸ç¯æç« ä¸­æä»¬ä»ç»äºè·åtokençæµç¨ï¼è¿ä¸ç¯éç¹åæä¸ä¸ï¼æºå¸¦tokenè®¿é®åéèµæºæ¶ï¼åé¨çå·¥ä½æµç¨ã\n\n\n# @EnableResourceServerä¸@EnableAuthorizationServer\n\nè¿è®°å¾æä»¬å¨ç¬¬ä¸èä¸­å°±ä»ç»è¿äºOAuth2çä¸¤ä¸ªæ ¸å¿æ¦å¿µï¼èµæºæå¡å¨ä¸èº«ä»½è®¤è¯æå¡å¨ãæä»¬å¯¹ä¸¤ä¸ªæ³¨è§£è¿è¡éç½®çåæ¶ï¼å°åºè§¦åäºåé¨çä»ä¹ç¸å³éç½®å¢ï¼\n\nä¸ä¸ç¯æç« éç¹ä»ç»çå¶å®æ¯ä¸èº«ä»½è®¤è¯ç¸å³çæµç¨ï¼å³å¦æè·åtokenï¼èæ¬èè¦åæçæºå¸¦tokenè®¿é®åéèµæºï¼èªç¶ä¾¿æ¯ä¸@EnableResourceServerç¸å³çèµæºæå¡å¨éç½®äºã\n\næä»¬æ³¨æå°å¶ç¸å³éç½®ç±»æ¯ResourceServerConfigurerï¼åé¨å³èäºResourceServerSecurityConfigureråHttpSecurityãåèä¸èµæºå®å¨éç½®ç¸å³ï¼åèä¸httpå®å¨éç½®ç¸å³ãï¼ç±»åæ¯è¾ç±»ä¼¼ï¼æ³¨æåºåï¼ä»¥Adapterç»å°¾çæ¯ééå¨ï¼ä»¥Configurerç»å°¾çæ¯éç½®å¨ï¼ä»¥Builderç»å°¾çæ¯å»ºé å¨ï¼ä»ä»¬åå«ä»£è¡¨ä¸åçè®¾è®¡æ¨¡å¼ï¼å¯¹è®¾è®¡æ¨¡å¼ææäºè§£å¯ä»¥æ´å æ¹ä¾¿çè§£å¶è®¾è®¡æè·¯ï¼\n\npublic class ResourceServerConfigurerAdapter implements ResourceServerConfigurer {\n\t@Override\n\tpublic void configure(ResourceServerSecurityConfigurer resources <1> ) throws Exception {\n\t}\n\n\t@Override\n\tpublic void configure(HttpSecurity http) throws Exception {\n\t\thttp.authorizeRequests().anyRequest().authenticated();\n\t}\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n<1> ResourceServerSecurityConfigureræ¾ç¶ä¾¿æ¯æä»¬åæçéç¹äºã\n\n\n# ResourceServerSecurityConfigurerï¼äºè§£ï¼\n\nå¶æ ¸å¿éç½®å¦ä¸æç¤ºï¼\n\npublic void configure(HttpSecurity http) throws Exception {\n\tAuthenticationManager oauthAuthenticationManager = oauthAuthenticationManager(http);\n\tresourcesServerFilter = new OAuth2AuthenticationProcessingFilter();//<1>\n\tresourcesServerFilter.setAuthenticationEntryPoint(authenticationEntryPoint);\n\tresourcesServerFilter.setAuthenticationManager(oauthAuthenticationManager);//<2>\n\tif (eventPublisher != null) {\n\t\tresourcesServerFilter.setAuthenticationEventPublisher(eventPublisher);\n\t}\n\tif (tokenExtractor != null) {\n\t\tresourcesServerFilter.setTokenExtractor(tokenExtractor);//<3>\n\t}\n\tresourcesServerFilter = postProcess(resourcesServerFilter);\n\tresourcesServerFilter.setStateless(stateless);\n\n\t// @formatter:off\n\thttp\n\t\t.authorizeRequests().expressionHandler(expressionHandler)\n\t.and()\n\t\t.addFilterBefore(resourcesServerFilter, AbstractPreAuthenticatedProcessingFilter.class)\n\t\t.exceptionHandling()\n\t\t\t.accessDeniedHandler(accessDeniedHandler)//<4>\n\t\t\t.authenticationEntryPoint(authenticationEntryPoint);\n\t// @formatter:on\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nè¿æ®µæ¯æ´ä¸ªoauth2ä¸HttpSecurityç¸å³çæ ¸å¿éç½®ï¼å¶ä¸­æéå¸¸å¤çæ³¨æç¹ï¼é¡ºå¸¦çé½å¼ºè°ä¸ä¸ï¼\n\n<1> åå»ºOAuth2AuthenticationProcessingFilterï¼å³ä¸ä¸èæè¦ä»ç»çOAuth2æ ¸å¿è¿æ»¤å¨ã\n\n<2> ä¸ºOAuth2AuthenticationProcessingFilteræä¾åºå®çAuthenticationManagerå³OAuth2AuthenticationManagerï¼å®å¹¶æ²¡æå°OAuth2AuthenticationManageræ·»å å°springçå®¹å¨ä¸­ï¼ä¸ç¶å¯è½ä¼å½±åspring securityçæ®éè®¤è¯æµç¨ï¼éoauth2è¯·æ±ï¼ï¼åªæè¢«OAuth2AuthenticationProcessingFilteræ¦æªå°çoauth2ç¸å³è¯·æ±æè¢«ç¹æ®çèº«ä»½è®¤è¯å¨å¤çã\n\n<3> è®¾ç½®äºTokenExtractoré»è®¤çå®ç°â-BearerTokenExtractorï¼è¿ä¸ªç±»å¨ä¸ä¸èä»ç»ã\n\n<4> ç¸å³çå¼å¸¸å¤çå¨ï¼å¯ä»¥éåç¸å³å®ç°ï¼è¾¾å°èªå®ä¹å¼å¸¸çç®çã\n\nè¿è®°å¾æä»¬å¨ä¸å¼å§çéç½®ä¸­éç½®äºèµæºæå¡å¨ï¼æ¯å®è§¦åäºç¸å³çéç½®ã\n\n@Configuration\n@EnableResourceServer\nprotected static class ResourceServerConfiguration extends ResourceServerConfigurerAdapter {}\n\n\n1\n2\n3\n\n\n\n# æ ¸å¿è¿æ»¤å¨ OAuth2AuthenticationProcessingFilterï¼ææ¡ï¼\n\nåé¡¾ä¸ä¸æä»¬ä¹åæ¯å¦ä½æºå¸¦tokenè®¿é®åéèµæºçï¼ http://localhost:8080/order/1?access_token=950a7cc9-5a8a-42c9-a693-40e817b1a4b0 å¯ä¸çèº«ä»½å­è¯ï¼ä¾¿æ¯è¿ä¸ªaccess_tokenï¼æºå¸¦å®è¿è¡è®¿é®ï¼ä¼è¿å¥OAuth2AuthenticationProcessingFilterä¹ä¸­ï¼å¶æ ¸å¿ä»£ç å¦ä¸ï¼\n\npublic void doFilter(ServletRequest req, ServletResponse res, FilterChain chain){\n\tfinal HttpServletRequest request = (HttpServletRequest) req;\n\tfinal HttpServletResponse response = (HttpServletResponse) res;\n\n\ttry {\n\t\t//ä»è¯·æ±ä¸­ååºèº«ä»½ä¿¡æ¯ï¼å³access_token\n\t\tAuthentication authentication = tokenExtractor.extract(request);\n\n\t\tif (authentication == null) {\n\t\t\t...\n\t\t}\n\t\telse {\n\t\t\trequest.setAttribute(OAuth2AuthenticationDetails.ACCESS_TOKEN_VALUE, authentication.getPrincipal());\n\t\t\tif (authentication instanceof AbstractAuthenticationToken) {\n\t\t\t\tAbstractAuthenticationToken needsDetails = (AbstractAuthenticationToken) authentication;\n\t\t\t\tneedsDetails.setDetails(authenticationDetailsSource.buildDetails(request));\n\t\t\t}\n\t\t\t//è®¤è¯èº«ä»½\n\t\t\tAuthentication authResult = authenticationManager.authenticate(authentication);\n\t\t\t...\n\t\t\teventPublisher.publishAuthenticationSuccess(authResult);\n\t\t\t//å°èº«ä»½ä¿¡æ¯ç»å®å°SecurityContextHolderä¸­\n\t\t\tSecurityContextHolder.getContext().setAuthentication(authResult);\n\t\t}\n\t}\n\tcatch (OAuth2Exception failed) {\n\t\t...\n\t\treturn;\n\t}\n\n\tchain.doFilter(request, response);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n\n\næ´ä¸ªè¿æ»¤å¨ä¾¿æ¯oauth2èº«ä»½é´å®çå³é®ï¼å¨æºç ä¸­ï¼å¯¹è¿ä¸ªç±»æä¸æ®µå¦ä¸çæè¿°\n\n> A pre-authentication filter for OAuth2 protected resources. Extracts an OAuth2 token from the incoming request and uses it to populate the Spring Security context with an {@link OAuth2Authentication} (if used in conjunction with an {@link OAuth2AuthenticationManager}). OAuth2ä¿æ¤èµæºçé¢åè®¤è¯è¿æ»¤å¨ãå¦æä¸OAuth2AuthenticationManagerç»åä½¿ç¨ï¼åä¼ä»å°æ¥çè¯·æ±ä¹ä¸­æåä¸ä¸ªOAuth2 tokenï¼ä¹åä½¿ç¨OAuth2Authenticationæ¥å¡«åSpring Securityä¸ä¸æã\n\nå¶ä¸­æ¶åå°äºä¸¤ä¸ªå³é®çç±»TokenExtractorï¼AuthenticationManagerãç¸ä¿¡åèè¿ä¸ªæ¥å£å¤§å®¶å·²ç»ä¸éçï¼ä½åé¢è¿ä¸ªç±»ä¹åè¿æªåºç°å¨æä»¬çè§éä¸­ã\n\n\n# OAuth2çèº«ä»½ç®¡çå¨âOAuth2AuthenticationManagerï¼ææ¡ï¼\n\nå¨ä¹åçOAuth2æ ¸å¿è¿æ»¤å¨ä¸­åºç°çAuthenticationManagerå¶å®å¨æä»¬ææä¹ä¸­ï¼æºå¸¦access_tokenå¿å®å¾ç»è¿èº«ä»½è®¤è¯ï¼ä½æ¯å¨æä»¬debugè¿å¥å¶ä¸­åï¼åç°äºä¸ä¸ªåºä¹ææçäºï¼AuthenticationManagerçå®ç°ç±»å¹¶ä¸æ¯æä»¬å¨åé¢æç« ä¸­èå°çå¸¸ç¨å®ç°ç±»ProviderManagerï¼èæ¯OAuth2AuthenticationManagerã\n\nOAuth2AuthenticationManager\n\nå¾1 æ°çAuthenticationManagerå®ç°ç±»OAuth2AuthenticationManager\n\nåé¡¾æä»¬ç¬¬ä¸ç¯æç« çéç½®ï¼åæ ¹æ²¡æåºç°è¿è¿ä¸ªOAuth2AuthenticationManagerï¼å¹¶ä¸å®è±ç¦»äºæä»¬çæçè®¤è¯æµç¨ï¼ç¬¬äºç¯æç« ä¸­çè®¤è¯ç®¡çå¨UMLå¾æ¯ä¸å¼ ç»å¸çspring securityç»æç±»å¾ï¼ï¼å®ç´æ¥éåäºå®¹å¨çé¡¶çº§èº«ä»½è®¤è¯æ¥å£ï¼åé¨ç»´æ¤äºä¸ä¸ªClientDetailServiceåResourceServerTokenServicesï¼è¿ä¸¤ä¸ªæ ¸å¿ç±»å¨ Reï¼ä»é¶å¼å§çSpring Security Oauth2ï¼äºï¼æåæè¿ãå¨ResourceServerSecurityConfigurerçå°èä¸­æä»¬å·²ç»ç¥æäºå®æ¯å¦ä½è¢«æ¡æ¶èªå¨éç½®çï¼è¿éè¦å¼ºè°çæ¯OAuth2AuthenticationManageræ¯å¯åä¸tokenè®¤è¯ç¸å³çï¼èä¸æ¯ä¸è·åtokenå¯åç¸å³çã\n\nå¶å¤å«èº«ä»½çå³é®ä»£ç å¦ä¸ï¼\n\npublic Authentication authenticate(Authentication authentication) throws AuthenticationException {\n\t...\n\tString token = (String) authentication.getPrincipal();\n\t//æç»è¿æ¯åå©tokenServicesæ ¹æ®tokenå è½½èº«ä»½ä¿¡æ¯\n\tOAuth2Authentication auth = tokenServices.loadAuthentication(token);\n\t...\n\n\tcheckClientDetails(auth);\n\n\tif (authentication.getDetails() instanceof OAuth2AuthenticationDetails) {\n\t\tOAuth2AuthenticationDetails details = (OAuth2AuthenticationDetails) authentication.getDetails();\n\t\t...\n\t}\n\tauth.setDetails(authentication.getDetails());\n\tauth.setAuthenticated(true);\n\treturn auth;\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nè¯´å°tokenServicesè¿ä¸ªå¯åä¸tokenç¸å³çæ¥å£ï¼è¿éè¦å¼ºè°ä¸ï¼é¿åäº§çè¯¯è§£ãtokenServicesåä¸ºä¸¤ç±»ï¼ä¸ä¸ªæ¯ç¨å¨AuthenticationServerç«¯ï¼ç¬¬äºç¯æç« ä¸­ä»ç»ç\n\npublic interface AuthorizationServerTokenServices {\n    //åå»ºtoken\n    OAuth2AccessToken createAccessToken(OAuth2Authentication authentication) throws AuthenticationException;\n    //å·æ°token\n    OAuth2AccessToken refreshAccessToken(String refreshToken, TokenRequest tokenRequest)\n            throws AuthenticationException;\n    //è·åtoken\n    OAuth2AccessToken getAccessToken(OAuth2Authentication authentication);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nèå¨ResourceServerç«¯æèªå·±çtokenServicesæ¥å£ï¼\n\npublic interface ResourceServerTokenServices {\n\t//æ ¹æ®accessTokenå è½½å®¢æ·ç«¯ä¿¡æ¯\n\tOAuth2Authentication loadAuthentication(String accessToken) throws AuthenticationException, InvalidTokenException;\n\n\t//æ ¹æ®accessTokenè·åå®æ´çè®¿é®ä»¤çè¯¦ç»ä¿¡æ¯ã\n\tOAuth2AccessToken readAccessToken(String accessToken);\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå·ä½åé¨å¦ä½å è½½ï¼åAuthorizationServerå¤§åå°å¼ï¼åªæ¯ä»tokenStoreä¸­ååºç¸åºèº«ä»½çæµç¨æç¹åºå«ï¼ä¸åè¯¦ç»çå®ç°ç±»äºã\n\n\n# TokenExtractorï¼äºè§£ï¼\n\nè¿ä¸ªæ¥å£åªæä¸ä¸ªå®ç°ç±»ï¼èä¸ä»£ç éå¸¸ç®å\n\npublic class BearerTokenExtractor implements TokenExtractor {\n\tprivate final static Log logger = LogFactory.getLog(BearerTokenExtractor.class);\n\t@Override\n\tpublic Authentication extract(HttpServletRequest request) {\n\t\tString tokenValue = extractToken(request);\n\t\tif (tokenValue != null) {\n\t\t\tPreAuthenticatedAuthenticationToken authentication = new PreAuthenticatedAuthenticationToken(tokenValue, "");\n\t\t\treturn authentication;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected String extractToken(HttpServletRequest request) {\n\t\t// first check the header...\n\t\tString token = extractHeaderToken(request);\n\n\t\t// bearer type allows a request parameter as well\n\t\tif (token == null) {\n\t\t\t...\n\t\t\t//ä»requestParameterä¸­è·åtoken\n\t\t}\n\n\t\treturn token;\n\t}\n\n    /**\n\t * Extract the OAuth bearer token from a header.\n\t */\n\tprotected String extractHeaderToken(HttpServletRequest request) {\n\t\tEnumeration<String> headers = request.getHeaders("Authorization");\n\t\twhile (headers.hasMoreElements()) { // typically there is only one (most servers enforce that)\n\t\t\t...\n\t\t\t//ä»Headerä¸­è·åtoken\n\t\t}\n\t\treturn null;\n\t}\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n\n\nå®çä½ç¨å¨äºåç¦»åºè¯·æ±ä¸­åå«çtokenãä¹å¯ç¤ºäºæä»¬å¯ä»¥ä½¿ç¨å¤ç§æ¹å¼æºå¸¦tokenã 1 å¨Headerä¸­æºå¸¦\n\nhttp://localhost:8080/order/1\nHeaderï¼\nAuthenticationï¼Bearer f732723d-af7f-41bb-bd06-2636ab2be135\n\n\n1\n2\n3\n\n\n2 æ¼æ¥å¨urlä¸­ä½ä¸ºrequestParam\n\nhttp://localhost:8080/order/1?access_token=f732723d-af7f-41bb-bd06-2636ab2be135\n\n\n1\n\n\n3 å¨formè¡¨åä¸­æºå¸¦\n\nhttp://localhost:8080/order/1\nform paramï¼\naccess_token=f732723d-af7f-41bb-bd06-2636ab2be135\n\n\n1\n2\n3\n\n\n\n# å¼å¸¸å¤ç\n\nOAuth2å¨èµæºæå¡å¨ç«¯çå¼å¸¸å¤çä¸ç®ç¹å«å®åï¼ä½åºæ¬å¤ç¨ï¼å¦ææ³è¦éåå¼å¸¸æºå¶ï¼å¯ä»¥ç´æ¥æ¿æ¢æç¸å³çHandlerï¼å¦æéç¸å³çAccessDeniedHandlerãå·ä½çéç½®åºè¯¥å¨@EnableResourceServerä¸­è¢«è¦çï¼è¿æ¯ééå¨+éç½®å¨çå¥½å¤ã\n\n\n# æ»ç»\n\nå°è¿å¿ï¼Spring Security OAuth2çæ´ä¸ªåé¨æµç¨å°±ç®æ¯åæç»æäºãæ¬ç³»åçæç« åªè½ç®æ¯æ­ç¤ºä¸ä¸ªå¤§æ¦çæµç¨ï¼éç¹è¿æ¯ä»ç»ç¸å³è®¾è®¡+æ¥å£ï¼æ³è¦äºè§£æ´å¤çç»èï¼éè¦èªå·±å»ç¿»çæºç ï¼ç ç©¶åä¸ªå®ç°ç±»ãå¨åææºç è¿ç¨ä¸­æ»ç»åºçä¸ç¹ç»éªï¼ä¸åå±åï¼\n\n 1. åææ¡å®è§ï¼å¦ç ç©¶UMLç±»å¾ï¼ææ¸æ¥å³è\n 2. åæé¡¶çº§æ¥å£ï¼è®¾è®¡æ¯é¢åæ¥å£çï¼ä¸éè¦çé¨åï¼å·ä½å®ç°ç±»çè³é½å¯ä»¥å¿½ç¥\n 3. å­¦ä¼å¯¹æ¯ï¼å¦ResourceServeråAuthenticationServeræ¯ä¸ç§å¯¹ç§°çè®¾è®¡ï¼æ´ä¸ªæ¡æ¶åé¨çç±»éå¸¸å¤ï¼ä½åé¨å«ç±»çè®°å¿ï¼ä¼å æ·±è®°å¿ãå¦ResourceServerTokenServices ï¼AuthenticationServerTokenServiceså°±ä¸å®æ¯ä½ç¨ç¸å³ï¼ä½æå±é¢åä¸åçä¸¤ä¸ªæ¥å£\n 4. çæè®¾è®¡æ¨¡å¼ï¼springä¸­æ¶åäºå¤§éçè®¾è®¡æ¨¡å¼ï¼å¨æ¡æ¶çè®¾è®¡ä¸­ä¹æ¯éµå¾ªçè®¾è®¡æ¨¡å¼çè§èï¼å¦ä»¥Adapterç»å°¾ï¼ä¾¿æ¯è¿ç¨äºééå¨æ¨¡å¼ï¼ä»¥Factoryç»å°¾ï¼ä¾¿æ¯è¿ç¨äºå·¥åæ¨¡å¼ï¼Templateç»å°¾ï¼ä¾¿æ¯è¿ç¨äºæ¨¡æ¿æ¹æ³æ¨¡å¼ï¼Builderç»å°¾ï¼ä¾¿æ¯è¿ç¨äºå»ºé èæ¨¡å¼â¦\n 5. ä¸ç¹èªå·±ççè§£ï¼å¯¹æºç ççè§£åçµæï¼è¿ä¸åé½å»ºç«èªèº«çç¼ç ç»éªä¹ä¸ï¼èªå·±éµå¾ªè§èä¾¿è½æ´å¥½ççè§£å«äººåæ ·éµå®è§èçä»£ç ãç¸å¯¹çï¼éè¯»å¥½çæºç ï¼ä¹è½å¸®å©æä»¬èªèº«æåç¼ç è§èã',normalizedContent:' * @enableresourceserverä¸@enableauthorizationserver\n * resourceserversecurityconfigurerï¼äºè§£ï¼\n * æ ¸å¿è¿æ»¤å¨ oauth2authenticationprocessingfilterï¼ææ¡ï¼\n * oauth2çèº«ä»½ç®¡çå¨âoauth2authenticationmanagerï¼ææ¡ï¼\n * tokenextractorï¼äºè§£ï¼\n * å¼å¸¸å¤ç\n * æ»ç»\n\n----------------------------------------\n\n----------------------------------------\n\nä¸ä¸ç¯æç« ä¸­æä»¬ä»ç»äºè·åtokençæµç¨ï¼è¿ä¸ç¯éç¹åæä¸ä¸ï¼æºå¸¦tokenè®¿é®åéèµæºæ¶ï¼åé¨çå·¥ä½æµç¨ã\n\n\n# @enableresourceserverä¸@enableauthorizationserver\n\nè¿è®°å¾æä»¬å¨ç¬¬ä¸èä¸­å°±ä»ç»è¿äºoauth2çä¸¤ä¸ªæ ¸å¿æ¦å¿µï¼èµæºæå¡å¨ä¸èº«ä»½è®¤è¯æå¡å¨ãæä»¬å¯¹ä¸¤ä¸ªæ³¨è§£è¿è¡éç½®çåæ¶ï¼å°åºè§¦åäºåé¨çä»ä¹ç¸å³éç½®å¢ï¼\n\nä¸ä¸ç¯æç« éç¹ä»ç»çå¶å®æ¯ä¸èº«ä»½è®¤è¯ç¸å³çæµç¨ï¼å³å¦æè·åtokenï¼èæ¬èè¦åæçæºå¸¦tokenè®¿é®åéèµæºï¼èªç¶ä¾¿æ¯ä¸@enableresourceserverç¸å³çèµæºæå¡å¨éç½®äºã\n\næä»¬æ³¨æå°å¶ç¸å³éç½®ç±»æ¯resourceserverconfigurerï¼åé¨å³èäºresourceserversecurityconfigureråhttpsecurityãåèä¸èµæºå®å¨éç½®ç¸å³ï¼åèä¸httpå®å¨éç½®ç¸å³ãï¼ç±»åæ¯è¾ç±»ä¼¼ï¼æ³¨æåºåï¼ä»¥adapterç»å°¾çæ¯ééå¨ï¼ä»¥configurerç»å°¾çæ¯éç½®å¨ï¼ä»¥builderç»å°¾çæ¯å»ºé å¨ï¼ä»ä»¬åå«ä»£è¡¨ä¸åçè®¾è®¡æ¨¡å¼ï¼å¯¹è®¾è®¡æ¨¡å¼ææäºè§£å¯ä»¥æ´å æ¹ä¾¿çè§£å¶è®¾è®¡æè·¯ï¼\n\npublic class resourceserverconfigureradapter implements resourceserverconfigurer {\n\t@override\n\tpublic void configure(resourceserversecurityconfigurer resources <1> ) throws exception {\n\t}\n\n\t@override\n\tpublic void configure(httpsecurity http) throws exception {\n\t\thttp.authorizerequests().anyrequest().authenticated();\n\t}\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n<1> resourceserversecurityconfigureræ¾ç¶ä¾¿æ¯æä»¬åæçéç¹äºã\n\n\n# resourceserversecurityconfigurerï¼äºè§£ï¼\n\nå¶æ ¸å¿éç½®å¦ä¸æç¤ºï¼\n\npublic void configure(httpsecurity http) throws exception {\n\tauthenticationmanager oauthauthenticationmanager = oauthauthenticationmanager(http);\n\tresourcesserverfilter = new oauth2authenticationprocessingfilter();//<1>\n\tresourcesserverfilter.setauthenticationentrypoint(authenticationentrypoint);\n\tresourcesserverfilter.setauthenticationmanager(oauthauthenticationmanager);//<2>\n\tif (eventpublisher != null) {\n\t\tresourcesserverfilter.setauthenticationeventpublisher(eventpublisher);\n\t}\n\tif (tokenextractor != null) {\n\t\tresourcesserverfilter.settokenextractor(tokenextractor);//<3>\n\t}\n\tresourcesserverfilter = postprocess(resourcesserverfilter);\n\tresourcesserverfilter.setstateless(stateless);\n\n\t// @formatter:off\n\thttp\n\t\t.authorizerequests().expressionhandler(expressionhandler)\n\t.and()\n\t\t.addfilterbefore(resourcesserverfilter, abstractpreauthenticatedprocessingfilter.class)\n\t\t.exceptionhandling()\n\t\t\t.accessdeniedhandler(accessdeniedhandler)//<4>\n\t\t\t.authenticationentrypoint(authenticationentrypoint);\n\t// @formatter:on\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nè¿æ®µæ¯æ´ä¸ªoauth2ä¸httpsecurityç¸å³çæ ¸å¿éç½®ï¼å¶ä¸­æéå¸¸å¤çæ³¨æç¹ï¼é¡ºå¸¦çé½å¼ºè°ä¸ä¸ï¼\n\n<1> åå»ºoauth2authenticationprocessingfilterï¼å³ä¸ä¸èæè¦ä»ç»çoauth2æ ¸å¿è¿æ»¤å¨ã\n\n<2> ä¸ºoauth2authenticationprocessingfilteræä¾åºå®çauthenticationmanagerå³oauth2authenticationmanagerï¼å®å¹¶æ²¡æå°oauth2authenticationmanageræ·»å å°springçå®¹å¨ä¸­ï¼ä¸ç¶å¯è½ä¼å½±åspring securityçæ®éè®¤è¯æµç¨ï¼éoauth2è¯·æ±ï¼ï¼åªæè¢«oauth2authenticationprocessingfilteræ¦æªå°çoauth2ç¸å³è¯·æ±æè¢«ç¹æ®çèº«ä»½è®¤è¯å¨å¤çã\n\n<3> è®¾ç½®äºtokenextractoré»è®¤çå®ç°â-bearertokenextractorï¼è¿ä¸ªç±»å¨ä¸ä¸èä»ç»ã\n\n<4> ç¸å³çå¼å¸¸å¤çå¨ï¼å¯ä»¥éåç¸å³å®ç°ï¼è¾¾å°èªå®ä¹å¼å¸¸çç®çã\n\nè¿è®°å¾æä»¬å¨ä¸å¼å§çéç½®ä¸­éç½®äºèµæºæå¡å¨ï¼æ¯å®è§¦åäºç¸å³çéç½®ã\n\n@configuration\n@enableresourceserver\nprotected static class resourceserverconfiguration extends resourceserverconfigureradapter {}\n\n\n1\n2\n3\n\n\n\n# æ ¸å¿è¿æ»¤å¨ oauth2authenticationprocessingfilterï¼ææ¡ï¼\n\nåé¡¾ä¸ä¸æä»¬ä¹åæ¯å¦ä½æºå¸¦tokenè®¿é®åéèµæºçï¼ http://localhost:8080/order/1?access_token=950a7cc9-5a8a-42c9-a693-40e817b1a4b0 å¯ä¸çèº«ä»½å­è¯ï¼ä¾¿æ¯è¿ä¸ªaccess_tokenï¼æºå¸¦å®è¿è¡è®¿é®ï¼ä¼è¿å¥oauth2authenticationprocessingfilterä¹ä¸­ï¼å¶æ ¸å¿ä»£ç å¦ä¸ï¼\n\npublic void dofilter(servletrequest req, servletresponse res, filterchain chain){\n\tfinal httpservletrequest request = (httpservletrequest) req;\n\tfinal httpservletresponse response = (httpservletresponse) res;\n\n\ttry {\n\t\t//ä»è¯·æ±ä¸­ååºèº«ä»½ä¿¡æ¯ï¼å³access_token\n\t\tauthentication authentication = tokenextractor.extract(request);\n\n\t\tif (authentication == null) {\n\t\t\t...\n\t\t}\n\t\telse {\n\t\t\trequest.setattribute(oauth2authenticationdetails.access_token_value, authentication.getprincipal());\n\t\t\tif (authentication instanceof abstractauthenticationtoken) {\n\t\t\t\tabstractauthenticationtoken needsdetails = (abstractauthenticationtoken) authentication;\n\t\t\t\tneedsdetails.setdetails(authenticationdetailssource.builddetails(request));\n\t\t\t}\n\t\t\t//è®¤è¯èº«ä»½\n\t\t\tauthentication authresult = authenticationmanager.authenticate(authentication);\n\t\t\t...\n\t\t\teventpublisher.publishauthenticationsuccess(authresult);\n\t\t\t//å°èº«ä»½ä¿¡æ¯ç»å®å°securitycontextholderä¸­\n\t\t\tsecuritycontextholder.getcontext().setauthentication(authresult);\n\t\t}\n\t}\n\tcatch (oauth2exception failed) {\n\t\t...\n\t\treturn;\n\t}\n\n\tchain.dofilter(request, response);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n\n\næ´ä¸ªè¿æ»¤å¨ä¾¿æ¯oauth2èº«ä»½é´å®çå³é®ï¼å¨æºç ä¸­ï¼å¯¹è¿ä¸ªç±»æä¸æ®µå¦ä¸çæè¿°\n\n> a pre-authentication filter for oauth2 protected resources. extracts an oauth2 token from the incoming request and uses it to populate the spring security context with an {@link oauth2authentication} (if used in conjunction with an {@link oauth2authenticationmanager}). oauth2ä¿æ¤èµæºçé¢åè®¤è¯è¿æ»¤å¨ãå¦æä¸oauth2authenticationmanagerç»åä½¿ç¨ï¼åä¼ä»å°æ¥çè¯·æ±ä¹ä¸­æåä¸ä¸ªoauth2 tokenï¼ä¹åä½¿ç¨oauth2authenticationæ¥å¡«åspring securityä¸ä¸æã\n\nå¶ä¸­æ¶åå°äºä¸¤ä¸ªå³é®çç±»tokenextractorï¼authenticationmanagerãç¸ä¿¡åèè¿ä¸ªæ¥å£å¤§å®¶å·²ç»ä¸éçï¼ä½åé¢è¿ä¸ªç±»ä¹åè¿æªåºç°å¨æä»¬çè§éä¸­ã\n\n\n# oauth2çèº«ä»½ç®¡çå¨âoauth2authenticationmanagerï¼ææ¡ï¼\n\nå¨ä¹åçoauth2æ ¸å¿è¿æ»¤å¨ä¸­åºç°çauthenticationmanagerå¶å®å¨æä»¬ææä¹ä¸­ï¼æºå¸¦access_tokenå¿å®å¾ç»è¿èº«ä»½è®¤è¯ï¼ä½æ¯å¨æä»¬debugè¿å¥å¶ä¸­åï¼åç°äºä¸ä¸ªåºä¹ææçäºï¼authenticationmanagerçå®ç°ç±»å¹¶ä¸æ¯æä»¬å¨åé¢æç« ä¸­èå°çå¸¸ç¨å®ç°ç±»providermanagerï¼èæ¯oauth2authenticationmanagerã\n\noauth2authenticationmanager\n\nå¾1 æ°çauthenticationmanagerå®ç°ç±»oauth2authenticationmanager\n\nåé¡¾æä»¬ç¬¬ä¸ç¯æç« çéç½®ï¼åæ ¹æ²¡æåºç°è¿è¿ä¸ªoauth2authenticationmanagerï¼å¹¶ä¸å®è±ç¦»äºæä»¬çæçè®¤è¯æµç¨ï¼ç¬¬äºç¯æç« ä¸­çè®¤è¯ç®¡çå¨umlå¾æ¯ä¸å¼ ç»å¸çspring securityç»æç±»å¾ï¼ï¼å®ç´æ¥éåäºå®¹å¨çé¡¶çº§èº«ä»½è®¤è¯æ¥å£ï¼åé¨ç»´æ¤äºä¸ä¸ªclientdetailserviceåresourceservertokenservicesï¼è¿ä¸¤ä¸ªæ ¸å¿ç±»å¨ reï¼ä»é¶å¼å§çspring security oauth2ï¼äºï¼æåæè¿ãå¨resourceserversecurityconfigurerçå°èä¸­æä»¬å·²ç»ç¥æäºå®æ¯å¦ä½è¢«æ¡æ¶èªå¨éç½®çï¼è¿éè¦å¼ºè°çæ¯oauth2authenticationmanageræ¯å¯åä¸tokenè®¤è¯ç¸å³çï¼èä¸æ¯ä¸è·åtokenå¯åç¸å³çã\n\nå¶å¤å«èº«ä»½çå³é®ä»£ç å¦ä¸ï¼\n\npublic authentication authenticate(authentication authentication) throws authenticationexception {\n\t...\n\tstring token = (string) authentication.getprincipal();\n\t//æç»è¿æ¯åå©tokenservicesæ ¹æ®tokenå è½½èº«ä»½ä¿¡æ¯\n\toauth2authentication auth = tokenservices.loadauthentication(token);\n\t...\n\n\tcheckclientdetails(auth);\n\n\tif (authentication.getdetails() instanceof oauth2authenticationdetails) {\n\t\toauth2authenticationdetails details = (oauth2authenticationdetails) authentication.getdetails();\n\t\t...\n\t}\n\tauth.setdetails(authentication.getdetails());\n\tauth.setauthenticated(true);\n\treturn auth;\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nè¯´å°tokenservicesè¿ä¸ªå¯åä¸tokenç¸å³çæ¥å£ï¼è¿éè¦å¼ºè°ä¸ï¼é¿åäº§çè¯¯è§£ãtokenservicesåä¸ºä¸¤ç±»ï¼ä¸ä¸ªæ¯ç¨å¨authenticationserverç«¯ï¼ç¬¬äºç¯æç« ä¸­ä»ç»ç\n\npublic interface authorizationservertokenservices {\n    //åå»ºtoken\n    oauth2accesstoken createaccesstoken(oauth2authentication authentication) throws authenticationexception;\n    //å·æ°token\n    oauth2accesstoken refreshaccesstoken(string refreshtoken, tokenrequest tokenrequest)\n            throws authenticationexception;\n    //è·åtoken\n    oauth2accesstoken getaccesstoken(oauth2authentication authentication);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nèå¨resourceserverç«¯æèªå·±çtokenservicesæ¥å£ï¼\n\npublic interface resourceservertokenservices {\n\t//æ ¹æ®accesstokenå è½½å®¢æ·ç«¯ä¿¡æ¯\n\toauth2authentication loadauthentication(string accesstoken) throws authenticationexception, invalidtokenexception;\n\n\t//æ ¹æ®accesstokenè·åå®æ´çè®¿é®ä»¤çè¯¦ç»ä¿¡æ¯ã\n\toauth2accesstoken readaccesstoken(string accesstoken);\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå·ä½åé¨å¦ä½å è½½ï¼åauthorizationserverå¤§åå°å¼ï¼åªæ¯ä»tokenstoreä¸­ååºç¸åºèº«ä»½çæµç¨æç¹åºå«ï¼ä¸åè¯¦ç»çå®ç°ç±»äºã\n\n\n# tokenextractorï¼äºè§£ï¼\n\nè¿ä¸ªæ¥å£åªæä¸ä¸ªå®ç°ç±»ï¼èä¸ä»£ç éå¸¸ç®å\n\npublic class bearertokenextractor implements tokenextractor {\n\tprivate final static log logger = logfactory.getlog(bearertokenextractor.class);\n\t@override\n\tpublic authentication extract(httpservletrequest request) {\n\t\tstring tokenvalue = extracttoken(request);\n\t\tif (tokenvalue != null) {\n\t\t\tpreauthenticatedauthenticationtoken authentication = new preauthenticatedauthenticationtoken(tokenvalue, "");\n\t\t\treturn authentication;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected string extracttoken(httpservletrequest request) {\n\t\t// first check the header...\n\t\tstring token = extractheadertoken(request);\n\n\t\t// bearer type allows a request parameter as well\n\t\tif (token == null) {\n\t\t\t...\n\t\t\t//ä»requestparameterä¸­è·åtoken\n\t\t}\n\n\t\treturn token;\n\t}\n\n    /**\n\t * extract the oauth bearer token from a header.\n\t */\n\tprotected string extractheadertoken(httpservletrequest request) {\n\t\tenumeration<string> headers = request.getheaders("authorization");\n\t\twhile (headers.hasmoreelements()) { // typically there is only one (most servers enforce that)\n\t\t\t...\n\t\t\t//ä»headerä¸­è·åtoken\n\t\t}\n\t\treturn null;\n\t}\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n\n\nå®çä½ç¨å¨äºåç¦»åºè¯·æ±ä¸­åå«çtokenãä¹å¯ç¤ºäºæä»¬å¯ä»¥ä½¿ç¨å¤ç§æ¹å¼æºå¸¦tokenã 1 å¨headerä¸­æºå¸¦\n\nhttp://localhost:8080/order/1\nheaderï¼\nauthenticationï¼bearer f732723d-af7f-41bb-bd06-2636ab2be135\n\n\n1\n2\n3\n\n\n2 æ¼æ¥å¨urlä¸­ä½ä¸ºrequestparam\n\nhttp://localhost:8080/order/1?access_token=f732723d-af7f-41bb-bd06-2636ab2be135\n\n\n1\n\n\n3 å¨formè¡¨åä¸­æºå¸¦\n\nhttp://localhost:8080/order/1\nform paramï¼\naccess_token=f732723d-af7f-41bb-bd06-2636ab2be135\n\n\n1\n2\n3\n\n\n\n# å¼å¸¸å¤ç\n\noauth2å¨èµæºæå¡å¨ç«¯çå¼å¸¸å¤çä¸ç®ç¹å«å®åï¼ä½åºæ¬å¤ç¨ï¼å¦ææ³è¦éåå¼å¸¸æºå¶ï¼å¯ä»¥ç´æ¥æ¿æ¢æç¸å³çhandlerï¼å¦æéç¸å³çaccessdeniedhandlerãå·ä½çéç½®åºè¯¥å¨@enableresourceserverä¸­è¢«è¦çï¼è¿æ¯ééå¨+éç½®å¨çå¥½å¤ã\n\n\n# æ»ç»\n\nå°è¿å¿ï¼spring security oauth2çæ´ä¸ªåé¨æµç¨å°±ç®æ¯åæç»æäºãæ¬ç³»åçæç« åªè½ç®æ¯æ­ç¤ºä¸ä¸ªå¤§æ¦çæµç¨ï¼éç¹è¿æ¯ä»ç»ç¸å³è®¾è®¡+æ¥å£ï¼æ³è¦äºè§£æ´å¤çç»èï¼éè¦èªå·±å»ç¿»çæºç ï¼ç ç©¶åä¸ªå®ç°ç±»ãå¨åææºç è¿ç¨ä¸­æ»ç»åºçä¸ç¹ç»éªï¼ä¸åå±åï¼\n\n 1. åææ¡å®è§ï¼å¦ç ç©¶umlç±»å¾ï¼ææ¸æ¥å³è\n 2. åæé¡¶çº§æ¥å£ï¼è®¾è®¡æ¯é¢åæ¥å£çï¼ä¸éè¦çé¨åï¼å·ä½å®ç°ç±»çè³é½å¯ä»¥å¿½ç¥\n 3. å­¦ä¼å¯¹æ¯ï¼å¦resourceserveråauthenticationserveræ¯ä¸ç§å¯¹ç§°çè®¾è®¡ï¼æ´ä¸ªæ¡æ¶åé¨çç±»éå¸¸å¤ï¼ä½åé¨å«ç±»çè®°å¿ï¼ä¼å æ·±è®°å¿ãå¦resourceservertokenservices ï¼authenticationservertokenserviceså°±ä¸å®æ¯ä½ç¨ç¸å³ï¼ä½æå±é¢åä¸åçä¸¤ä¸ªæ¥å£\n 4. çæè®¾è®¡æ¨¡å¼ï¼springä¸­æ¶åäºå¤§éçè®¾è®¡æ¨¡å¼ï¼å¨æ¡æ¶çè®¾è®¡ä¸­ä¹æ¯éµå¾ªçè®¾è®¡æ¨¡å¼çè§èï¼å¦ä»¥adapterç»å°¾ï¼ä¾¿æ¯è¿ç¨äºééå¨æ¨¡å¼ï¼ä»¥factoryç»å°¾ï¼ä¾¿æ¯è¿ç¨äºå·¥åæ¨¡å¼ï¼templateç»å°¾ï¼ä¾¿æ¯è¿ç¨äºæ¨¡æ¿æ¹æ³æ¨¡å¼ï¼builderç»å°¾ï¼ä¾¿æ¯è¿ç¨äºå»ºé èæ¨¡å¼â¦\n 5. ä¸ç¹èªå·±ççè§£ï¼å¯¹æºç ççè§£åçµæï¼è¿ä¸åé½å»ºç«èªèº«çç¼ç ç»éªä¹ä¸ï¼èªå·±éµå¾ªè§èä¾¿è½æ´å¥½ççè§£å«äººåæ ·éµå®è§èçä»£ç ãç¸å¯¹çï¼éè¯»å¥½çæºç ï¼ä¹è½å¸®å©æä»¬èªèº«æåç¼ç è§èã',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Spring Security å¥é¨ç¯",frontmatter:{title:"Spring Security å¥é¨ç¯",date:"2022-02-03T00:03:27.000Z",permalink:"/pages/605664/",categories:["åç«¯","Spring Security"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/25.Spring%20Security/10.Spring%20Security%20%E5%85%A5%E9%97%A8%E7%AF%87.html",relativePath:"10.æ¡æ¶/25.Spring Security/10.Spring Security å¥é¨ç¯.md",key:"v-83400752",path:"/pages/605664/",headers:[{level:2,title:"å­¦ä¹ ç®æ ",slug:"å­¦ä¹ ç®æ ",normalizedTitle:"å­¦ä¹ ç®æ ",charIndex:53},{level:2,title:"SpringSecurity",slug:"springsecurity",normalizedTitle:"springsecurity",charIndex:64},{level:3,title:"SpringSecurityç®ä»",slug:"springsecurityç®ä»",normalizedTitle:"springsecurityç®ä»",charIndex:83},{level:3,title:"å¿«éå¥é¨",slug:"å¿«éå¥é¨",normalizedTitle:"å¿«éå¥é¨",charIndex:1481},{level:3,title:"UserDetailsServiceè¯¦è§£",slug:"userdetailsserviceè¯¦è§£",normalizedTitle:"userdetailsserviceè¯¦è§£",charIndex:4235},{level:3,title:"PasswordEncoder å¯ç è§£æå¨è¯¦è§£",slug:"passwordencoder-å¯ç è§£æå¨è¯¦è§£",normalizedTitle:"passwordencoder å¯ç è§£æå¨è¯¦è§£",charIndex:5263},{level:3,title:"èªå®ä¹ç»å½é»è¾",slug:"èªå®ä¹ç»å½é»è¾",normalizedTitle:"èªå®ä¹ç»å½é»è¾",charIndex:5333},{level:3,title:"èªå®ä¹ç»å½é¡µé¢",slug:"èªå®ä¹ç»å½é¡µé¢",normalizedTitle:"èªå®ä¹ç»å½é¡µé¢",charIndex:8786},{level:3,title:"è®¤è¯è¿ç¨å¶ä»å¸¸ç¨éç½®",slug:"è®¤è¯è¿ç¨å¶ä»å¸¸ç¨éç½®",normalizedTitle:"è®¤è¯è¿ç¨å¶ä»å¸¸ç¨éç½®",charIndex:11639},{level:3,title:"è®¿é®æ§å¶urlå¹é",slug:"è®¿é®æ§å¶urlå¹é",normalizedTitle:"è®¿é®æ§å¶urlå¹é",charIndex:17602},{level:3,title:"åç½®è®¿é®æ§å¶æ¹æ³",slug:"åç½®è®¿é®æ§å¶æ¹æ³",normalizedTitle:"åç½®è®¿é®æ§å¶æ¹æ³",charIndex:19233},{level:3,title:"è§è²æéå¤æ­",slug:"è§è²æéå¤æ­",normalizedTitle:"è§è²æéå¤æ­",charIndex:19679},{level:3,title:"èªå®ä¹403å¤çæ¹æ¡",slug:"èªå®ä¹403å¤çæ¹æ¡",normalizedTitle:"èªå®ä¹403å¤çæ¹æ¡",charIndex:20783},{level:3,title:"åºäºè¡¨è¾¾å¼çè®¿é®æ§å¶",slug:"åºäºè¡¨è¾¾å¼çè®¿é®æ§å¶",normalizedTitle:"åºäºè¡¨è¾¾å¼çè®¿é®æ§å¶",charIndex:22220},{level:3,title:"åºäºæ³¨è§£çè®¿é®æ§å¶",slug:"åºäºæ³¨è§£çè®¿é®æ§å¶",normalizedTitle:"åºäºæ³¨è§£çè®¿é®æ§å¶",charIndex:24351},{level:3,title:"RememberMeåè½å®ç°",slug:"remembermeåè½å®ç°",normalizedTitle:"remembermeåè½å®ç°",charIndex:26538},{level:3,title:"Thymeleafä¸­SpringSecurityçä½¿ç¨ï¼äºè§£ï¼",slug:"thymeleafä¸­springsecurityçä½¿ç¨-äºè§£",normalizedTitle:"thymeleafä¸­springsecurityçä½¿ç¨ï¼äºè§£ï¼",charIndex:29448},{level:3,title:"éåºç»å½",slug:"éåºç»å½",normalizedTitle:"éåºç»å½",charIndex:32176},{level:3,title:"SpringSecurityä¸­çCSRF",slug:"springsecurityä¸­çcsrf",normalizedTitle:"springsecurityä¸­çcsrf",charIndex:32829},{level:2,title:"Oauth2è®¤è¯",slug:"oauth2è®¤è¯",normalizedTitle:"oauth2è®¤è¯",charIndex:34218},{level:3,title:"Oauth2ç®ä»",slug:"oauth2ç®ä»",normalizedTitle:"oauth2ç®ä»",charIndex:34231},{level:3,title:"æææ¨¡å¼",slug:"æææ¨¡å¼",normalizedTitle:"æææ¨¡å¼",charIndex:36184},{level:2,title:"Spring Security Oauth2",slug:"spring-security-oauth2",normalizedTitle:"spring security oauth2",charIndex:36333},{level:3,title:"æææå¡å¨ï¼çæï¼",slug:"æææå¡å¨-çæ",normalizedTitle:"æææå¡å¨ï¼çæï¼",charIndex:36360},{level:3,title:"Spring Security Oauth2æ¶æï¼çæï¼",slug:"spring-security-oauth2æ¶æ-çæ",normalizedTitle:"spring security oauth2æ¶æï¼çæï¼",charIndex:36526},{level:3,title:"Spring Security Oauth2ææç æ¨¡å¼",slug:"spring-security-oauth2ææç æ¨¡å¼",normalizedTitle:"spring security oauth2ææç æ¨¡å¼",charIndex:36926},{level:3,title:"Spring Security Oauth2 å¯ç æ¨¡å¼",slug:"spring-security-oauth2-å¯ç æ¨¡å¼",normalizedTitle:"spring security oauth2 å¯ç æ¨¡å¼",charIndex:46840},{level:3,title:"å¨Redisä¸­å­å¨token",slug:"å¨redisä¸­å­å¨token",normalizedTitle:"å¨redisä¸­å­å¨token",charIndex:50904},{level:2,title:"JWT",slug:"jwt",normalizedTitle:"jwt",charIndex:54889},{level:3,title:"å¸¸è§çè®¤è¯æºå¶",slug:"å¸¸è§çè®¤è¯æºå¶",normalizedTitle:"å¸¸è§çè®¤è¯æºå¶",charIndex:54897},{level:3,title:"JWTç®ä»",slug:"jwtç®ä»",normalizedTitle:"jwtç®ä»",charIndex:56795},{level:3,title:"JJWTç®ä»",slug:"jjwtç®ä»",normalizedTitle:"jjwtç®ä»",charIndex:59093},{level:2,title:"Spring Security Oauth2 æ´åJWT",slug:"spring-security-oauth2-æ´åjwt",normalizedTitle:"spring security oauth2 æ´åjwt",charIndex:66907},{level:3,title:"æ´åJWT",slug:"æ´åjwt",normalizedTitle:"æ´åjwt",charIndex:66930},{level:3,title:"æ©å±JWTä¸­å­å¨çåå®¹",slug:"æ©å±jwtä¸­å­å¨çåå®¹",normalizedTitle:"æ©å±jwtä¸­å­å¨çåå®¹",charIndex:71004},{level:3,title:"Javaä¸­è§£æJWTä¸­çåå®¹",slug:"javaä¸­è§£æjwtä¸­çåå®¹",normalizedTitle:"javaä¸­è§£æjwtä¸­çåå®¹",charIndex:76802},{level:3,title:"å·æ°ä»¤ç",slug:"å·æ°ä»¤ç-2",normalizedTitle:"å·æ°ä»¤ç",charIndex:35790},{level:2,title:"Spring Security Oauth2 æ´ååç¹ç»å½ï¼SSOï¼",slug:"spring-security-oauth2-æ´ååç¹ç»å½-sso",normalizedTitle:"spring security oauth2 æ´ååç¹ç»å½ï¼ssoï¼",charIndex:79064},{level:3,title:"åå»ºå®¢æ·ç«¯",slug:"åå»ºå®¢æ·ç«¯",normalizedTitle:"åå»ºå®¢æ·ç«¯",charIndex:79103},{level:3,title:"æ·»å ä¾èµ",slug:"æ·»å ä¾èµ-2",normalizedTitle:"æ·»å ä¾èµ",charIndex:26676},{level:3,title:"ä¿®æ¹éç½®æä»¶",slug:"ä¿®æ¹éç½®æä»¶",normalizedTitle:"ä¿®æ¹éç½®æä»¶",charIndex:81650},{level:3,title:"å¨å¯å¨ç±»ä¸æ·»å @EnableOAuth2Ssoæ³¨è§£æ¥å¯ç¨åç¹ç»å½åè½",slug:"å¨å¯å¨ç±»ä¸æ·»å -enableoauth2ssoæ³¨è§£æ¥å¯ç¨åç¹ç»å½åè½",normalizedTitle:"å¨å¯å¨ç±»ä¸æ·»å @enableoauth2ssoæ³¨è§£æ¥å¯ç¨åç¹ç»å½åè½",charIndex:82191},{level:3,title:"æ·»å æ¥å£ç¨äºè·åå½åç»å½ç¨æ·ä¿¡æ¯",slug:"æ·»å æ¥å£ç¨äºè·åå½åç»å½ç¨æ·ä¿¡æ¯",normalizedTitle:"æ·»å æ¥å£ç¨äºè·åå½åç»å½ç¨æ·ä¿¡æ¯",charIndex:82726},{level:3,title:"ä¿®æ¹è®¤è¯æå¡å¨éç½®",slug:"ä¿®æ¹è®¤è¯æå¡å¨éç½®",normalizedTitle:"ä¿®æ¹è®¤è¯æå¡å¨éç½®",charIndex:83303},{level:3,title:"æµè¯",slug:"æµè¯",normalizedTitle:"æµè¯",charIndex:5844}],headersStr:"å­¦ä¹ ç®æ  SpringSecurity SpringSecurityç®ä» å¿«éå¥é¨ UserDetailsServiceè¯¦è§£ PasswordEncoder å¯ç è§£æå¨è¯¦è§£ èªå®ä¹ç»å½é»è¾ èªå®ä¹ç»å½é¡µé¢ è®¤è¯è¿ç¨å¶ä»å¸¸ç¨éç½® è®¿é®æ§å¶urlå¹é åç½®è®¿é®æ§å¶æ¹æ³ è§è²æéå¤æ­ èªå®ä¹403å¤çæ¹æ¡ åºäºè¡¨è¾¾å¼çè®¿é®æ§å¶ åºäºæ³¨è§£çè®¿é®æ§å¶ RememberMeåè½å®ç° Thymeleafä¸­SpringSecurityçä½¿ç¨ï¼äºè§£ï¼ éåºç»å½ SpringSecurityä¸­çCSRF Oauth2è®¤è¯ Oauth2ç®ä» æææ¨¡å¼ Spring Security Oauth2 æææå¡å¨ï¼çæï¼ Spring Security Oauth2æ¶æï¼çæï¼ Spring Security Oauth2ææç æ¨¡å¼ Spring Security Oauth2 å¯ç æ¨¡å¼ å¨Redisä¸­å­å¨token JWT å¸¸è§çè®¤è¯æºå¶ JWTç®ä» JJWTç®ä» Spring Security Oauth2 æ´åJWT æ´åJWT æ©å±JWTä¸­å­å¨çåå®¹ Javaä¸­è§£æJWTä¸­çåå®¹ å·æ°ä»¤ç Spring Security Oauth2 æ´ååç¹ç»å½ï¼SSOï¼ åå»ºå®¢æ·ç«¯ æ·»å ä¾èµ ä¿®æ¹éç½®æä»¶ å¨å¯å¨ç±»ä¸æ·»å @EnableOAuth2Ssoæ³¨è§£æ¥å¯ç¨åç¹ç»å½åè½ æ·»å æ¥å£ç¨äºè·åå½åç»å½ç¨æ·ä¿¡æ¯ ä¿®æ¹è®¤è¯æå¡å¨éç½® æµè¯",content:'è§é¢å°åï¼https://www.bilibili.com/video/BV1gb4y1b7XE\n\n\n# å­¦ä¹ ç®æ \n\n\n\n\n# SpringSecurity\n\n\n# SpringSecurityç®ä»\n\n# å®å¨æ¡æ¶æ¦è¿°\n\nä»ä¹æ¯å®å¨æ¡æ¶ï¼ è§£å³ç³»ç»å®å¨é®é¢çæ¡æ¶ãå¦ææ²¡æå®å¨æ¡æ¶ï¼æä»¬éè¦æå¨å¤çæ¯ä¸ªèµæºçè®¿é®æ§å¶ï¼éå¸¸éº»ç¦ãä½¿ç¨å®å¨æ¡æ¶ï¼æä»¬å¯ä»¥éè¿éç½®çæ¹å¼å®ç°å¯¹èµæºçè®¿é®éå¶ã\n\n# å¸¸ç¨å®å¨æ¡æ¶\n\n * Spring Securityï¼Springå®¶æä¸åãæ¯ä¸ä¸ªè½å¤ä¸ºåºäºSpringçä¼ä¸åºç¨ç³»ç»æä¾å£°æå¼çå®å¨è®¿é®æ§å¶è§£å³æ¹æ¡çå®å¨æ¡æ¶ãå®æä¾äºä¸ç»å¯ä»¥å¨Springåºç¨ä¸ä¸æä¸­éç½®çBeanï¼ååå©ç¨äºSpring IoCï¼DIï¼æ§å¶åè½¬Inversion of Control,DI:Dependency Injection ä¾èµæ³¨å¥ï¼åAOPï¼é¢ååé¢ç¼ç¨ï¼åè½ï¼ä¸ºåºç¨ç³»ç»æä¾å£°æå¼çå®å¨è®¿é®æ§å¶åè½ï¼åå°äºä¸ºä¼ä¸ç³»ç»å®å¨æ§å¶ç¼åå¤§ééå¤ä»£ç çå·¥ä½ã\n * Apache Shiroï¼ä¸ä¸ªåè½å¼ºå¤§ä¸æäºä½¿ç¨çJavaå®å¨æ¡æ¶,æä¾äºè®¤è¯,ææ,å å¯,åä¼è¯ç®¡çã\n\n# Spring Securityç®ä»\n\n# æ¦è¿°ï¼çæï¼\n\n> Spring Securityæ¯ä¸ä¸ªé«åº¦èªå®ä¹çå®å¨æ¡æ¶ãå©ç¨ Spring IoC/DIåAOPåè½ï¼ä¸ºç³»ç»æä¾äºå£°æå¼å®å¨è®¿é®æ§å¶åè½ï¼åå°äºä¸ºç³»ç»å®å¨èç¼åå¤§ééå¤ä»£ç çå·¥ä½ãä½¿ç¨ Spring Secruity çåå æå¾å¤ï¼ä½å¤§é¨åé½æ¯åç°äº javaEEç Servlet è§èæ EJB è§èä¸­çå®å¨åè½ç¼ºä¹å¸åä¼ä¸åºç¨åºæ¯ãåæ¶è®¤è¯å°ä»ä»¬å¨ WAR æ EAR çº§å«æ æ³ç§»æ¤ãå æ­¤å¦æä½ æ´æ¢æå¡å¨ç¯å¢ï¼è¿éè¦å¤§éå·¥ä½å»éæ°éç½®ä½ çåºç¨ç¨åºãä½¿ç¨ Spring Securityè§£å³äºè¿äºé®é¢ï¼ä¹ä¸ºä½ æä¾è®¸å¤å¶ä»æç¨çãå¯å®å¶çå®å¨åè½ãæ­£å¦ä½ å¯è½ç¥éçä¸¤ä¸ªåºç¨ç¨åºçä¸¤ä¸ªä¸»è¦åºåæ¯âè®¤è¯âåâææâï¼æèè®¿é®æ§å¶ï¼ãè¿ä¸¤ç¹ä¹æ¯ Spring Security éè¦æ ¸å¿åè½ãâè®¤è¯âï¼æ¯å»ºç«ä¸ä¸ªä»å£°æçä¸»ä½çè¿ç¨ï¼ä¸ä¸ªâä¸»ä½âä¸è¬æ¯æç¨æ·ï¼è®¾å¤æä¸äºå¯ä»¥å¨ä½ çåºç¨ç¨åºä¸­æ§è¡å¨ä½çå¶ä»ç³»ç»ï¼ï¼éä¿ç¹è¯´å°±æ¯ç³»ç»è®¤ä¸ºç¨æ·æ¯å¦è½ç»å½ãâææâæç¡®å®ä¸ä¸ªä¸»ä½æ¯å¦åè®¸å¨ä½ çåºç¨ç¨åºæ§è¡ä¸ä¸ªå¨ä½çè¿ç¨ãéä¿ç¹è®²å°±æ¯ç³»ç»å¤æ­ç¨æ·æ¯å¦ææéå»åæäºäºæã\n\n# åå²ï¼äºè§£ï¼\n\n> Spring Security ä»¥âThe Acegi Secutity System for Springâçåå­å§äº2003å¹´å¹´åºãå¶åèº«ä¸º acegi é¡¹ç®ãèµ·å æ¯ Spring å¼åèé®ä»¶åè¡¨ä¸­ä¸ä¸ªé®é¢ï¼æäººæé®æ¯å¦èèæä¾ä¸ä¸ªåºäº Spring çå®å¨å®ç°ãéå¶äºæ¶é´é®é¢ï¼å¼ååºäºä¸ä¸ªç®åçå®å¨å®ç°ï¼ä½æ¯å¹¶æ²¡ææ·±å¥ç ç©¶ãå å¨åï¼Spring ç¤¾åºä¸­å¶ä»æååæ ·è¯¢é®äºå®å¨é®é¢ï¼ä»£ç æä¾ç»äºè¿äºäººã2004 å¹´ 1 æä»½å·²ç»æ 20 äººå·¦å³ä½¿ç¨è¿ä¸ªé¡¹ç®ãéçæ´å¤äººçå å¥ï¼å¨ 2004 å¹´ 3 æå·¦å³å¨ sourceforge ä¸­å»ºç«äºä¸ä¸ªé¡¹ç®ãå¨æå¼å§å¹¶æ²¡æè®¤è¯æ¨¡åï¼ææçè®¤è¯åè½é½æ¯ä¾èµå®¹å¨å®æçï¼è acegi åæ³¨éææãä½æ¯éçæ´å¤äººçä½¿ç¨ï¼åºäºå®¹å¨çè®¤è¯å°±æ¾ç°åºäºä¸è¶³ãacegi ä¸­ä¹å å¥äºè®¤è¯åè½ãå¤§çº¦ 1 å¹´å acegi æä¸º Springå­é¡¹ç®ãå¨ 2006 å¹´ 5 æåå¸äº acegi 1.0.0 çæ¬ã2007 å¹´åº acegi æ´åä¸ºSpring Securityã\n\n\n# å¿«éå¥é¨\n\n# å¯¼å¥ä¾èµ\n\n<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">\n   <modelVersion>4.0.0</modelVersion>\n   <parent>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-starter-parent</artifactId>\n      <version>2.2.2.RELEASE</version>\n      <relativePath/> \x3c!-- lookup parent from repository --\x3e\n   </parent>\n  \n   <groupId>com.yjxxt</groupId>\n   <artifactId>springsecurity-demo</artifactId>\n   <version>0.0.1-SNAPSHOT</version>\n   <name>springsecurity-demo</name>\n   <description>Demo project for Spring Boot</description>\n\n   <properties>\n      <java.version>1.8</java.version>\n   </properties>\n\n   <dependencies>\n      \x3c!--spring security ç»ä»¶--\x3e\n      <dependency>\n         <groupId>org.springframework.boot</groupId>\n         <artifactId>spring-boot-starter-security</artifactId>\n      </dependency>\n      \x3c!--web ç»ä»¶--\x3e\n      <dependency>\n         <groupId>org.springframework.boot</groupId>\n         <artifactId>spring-boot-starter-web</artifactId>\n      </dependency>\n      \x3c!-- test ç»ä»¶--\x3e\n      <dependency>\n         <groupId>org.springframework.boot</groupId>\n         <artifactId>spring-boot-starter-test</artifactId>\n         <scope>test</scope>\n         <exclusions>\n            <exclusion>\n               <groupId>org.junit.vintage</groupId>\n               <artifactId>junit-vintage-engine</artifactId>\n            </exclusion>\n         </exclusions>\n      </dependency>\n      <dependency>\n         <groupId>org.springframework.security</groupId>\n         <artifactId>spring-security-test</artifactId>\n         <scope>test</scope>\n      </dependency>\n   </dependencies>\n\n   <build>\n      <plugins>\n         <plugin>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-maven-plugin</artifactId>\n         </plugin>\n      </plugins>\n   </build>\n</project>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n\n\n# åç«¯é¡µé¢\n\nlogin.html\n\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <title>Title</title>\n</head>\n<body>\n<form action="/login" method="post">\n    ç¨æ·åï¼<input type="text" name="username" /><br/>\n    å¯ç ï¼<input type="password" name="password" /><br/>\n    <input type="submit" value="ç»å½" />\n</form>\n</body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n# è®¿é®é¡µé¢\n\nå¯¼å¥spring-boot-starter-security å¯å¨å¨åï¼Spring Security å·²ç»çæï¼é»è®¤æ¦æªå¨é¨è¯·æ±ï¼å¦æç¨æ·æ²¡æç»å½ï¼è·³è½¬å°åç½®ç»å½é¡µé¢ã\n\n\n\né»è®¤ç username ä¸º userï¼password æå°å¨æ§å¶å°ä¸­ã\n\n\n\nå¨æµè§å¨ä¸­è¾å¥è´¦å·åå¯ç åä¼æ¾ç¤º login.html é¡µé¢åå®¹ã\n\n\n# UserDetailsServiceè¯¦è§£\n\nå½ä»ä¹ä¹æ²¡æéç½®çæ¶åï¼è´¦å·åå¯ç æ¯ç± Spring Security å®ä¹çæçãèå¨å®éé¡¹ç®ä¸­è´¦å·åå¯ç é½æ¯ä»æ°æ®åºä¸­æ¥è¯¢åºæ¥çãæä»¥æä»¬è¦éè¿èªå®ä¹é»è¾æ§å¶è®¤è¯é»è¾ãå¦æéè¦èªå®ä¹é»è¾æ¶ï¼åªéè¦å®ç° UserDetailsService æ¥å£å³å¯ãæ¥å£å®ä¹å¦ä¸ï¼\n\n\n\n# è¿åå¼\n\nè¿åå¼ UserDetails æ¯ä¸ä¸ªæ¥å£ï¼å®ä¹å¦ä¸\n\n\n\nè¦æ³è¿å UserDetailsçå®ä¾å°±åªè½è¿åæ¥å£çå®ç°ç±»ãSpringSecurity ä¸­æä¾äºå¦ä¸çå®ä¾ãå¯¹äºæä»¬åªéè¦ä½¿ç¨éé¢ç Userç±»å³å¯ãæ³¨æ User çå¨éå®è·¯å¾æ¯ï¼\n\norg.springframework.security.core.userdetails.Useræ­¤å¤ç»å¸¸åç³»ç»ä¸­èªå·±å¼åç User ç±»å¼æ··ã\n\n\n\nå¨ User ç±»ä¸­æä¾äºå¾å¤æ¹æ³åå±æ§ã\n\n\n\nå¶ä¸­æé æ¹æ³æä¸¤ä¸ªï¼è°ç¨å¶ä¸­ä»»ä½ä¸ä¸ªé½å¯ä»¥å®ä¾åUserDetailså®ç°ç±» Userç±»çå®ä¾ãèä¸ä¸ªåæ°çæé æ¹æ³å®éä¸ä¹æ¯è°ç¨ 7 ä¸ªåæ°çæé æ¹æ³ã\n\n * username:ç¨æ·å\n\n * password:å¯ç \n\n * authoritiesï¼ç¨æ·å·æçæéãæ­¤å¤ä¸åè®¸ä¸º null\n\n\n\nSpring Security ä¼æ ¹æ® User ä¸­ç passwordåå®¢æ·ç«¯ä¼ éè¿æ¥ç passwordè¿è¡æ¯è¾ãå¦æç¸ååè¡¨ç¤ºè®¤è¯éè¿ï¼å¦æä¸ç¸åè¡¨ç¤ºè®¤è¯å¤±è´¥ã\n\nauthoritieséé¢çæéå¯¹äºåé¢å­¦ä¹ æææ¯å¾æå¿è¦çï¼åå«çææåå®¹ä¸ºæ­¤ç¨æ·å·æçæéï¼å¦æéé¢æ²¡æåå«æä¸ªæéï¼èå¨åæä¸ªäºææ¶å¿é¡»åå«æä¸ªæéåä¼åºç° 403ã\n\néå¸¸é½æ¯éè¿AuthorityUtils.commaSeparatedStringToAuthorityList(ââ) æ¥åå»ºauthorities éåå¯¹è±¡çãåæ°æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼å¤ä¸ªæéä½¿ç¨éå·åéã\n\n# æ¹æ³åæ°\n\næ¹æ³åæ°è¡¨ç¤ºç¨æ·åãæ­¤å¼æ¯å®¢æ·ç«¯è¡¨åä¼ éè¿æ¥çæ°æ®ãé»è®¤æåµä¸å¿é¡»å« usernameï¼å¦åæ æ³æ¥æ¶ã\n\n# å¼å¸¸\n\nUsernameNotFoundExceptionç¨æ·åæ²¡æåç°å¼å¸¸ãå¨loadUserByUsernameä¸­æ¯éè¦éè¿èªå·±çé»è¾ä»æ°æ®åºä¸­åå¼çãå¦æéè¿ç¨æ·åæ²¡ææ¥è¯¢å°å¯¹åºçæ°æ®ï¼åºè¯¥æåºUsernameNotFoundExceptionï¼ç³»ç»å°±ç¥éç¨æ·åæ²¡ææ¥è¯¢å°ã\n\n\n# PasswordEncoder å¯ç è§£æå¨è¯¦è§£\n\nSpring Security è¦æ±å®¹å¨ä¸­å¿é¡»æPasswordEncoderå®ä¾ãæä»¥å½èªå®ä¹ç»å½é»è¾æ¶è¦æ±å¿é¡»ç»å®¹å¨æ³¨å¥PaswordEncoderçbeanå¯¹è±¡ã\n\n# æ¥å£ä»ç»\n\n * encode()ï¼æåæ°æç§ç¹å®çè§£æè§åè¿è¡è§£æã\n\n * matches() ï¼éªè¯ä»å­å¨ä¸­è·åçå¯ç ï¼ç¼ç è¿çï¼ä¸è¡¨åæäº¤çåå§å¯ç ï¼æªç¼ç ï¼æ¯å¦å¹éãå¦æå¯ç å¹éï¼åè¿å trueï¼å¦æä¸å¹éï¼åè¿å falseãç¬¬ä¸ä¸ªåæ°è¡¨ç¤ºéè¦è¡¨åä¼ è¿æ¥çåå§å¯ç ãç¬¬äºä¸ªåæ°è¡¨ç¤ºå­å¨çç¼ç å¯ç ã\n\n * upgradeEncoding()ï¼å¦æè§£æçå¯ç è½å¤åæ¬¡è¿è¡è§£æä¸è¾¾å°æ´å®å¨çç»æåè¿å trueï¼å¦åè¿å falseãé»è®¤è¿å falseã\n\n\n\n# åç½®è§£æå¨ä»ç»\n\nå¨ Spring Security ä¸­åç½®äºå¾å¤è§£æå¨ã\n\n\n\n# BCryptPasswordEncoder ç®ä»\n\nBCryptPasswordEncoder æ¯ Spring Security å®æ¹æ¨èçå¯ç è§£æå¨ï¼å¹³æ¶å¤ä½¿ç¨è¿ä¸ªè§£æå¨ã\n\nBCryptPasswordEncoder æ¯å¯¹ bcryptå¼ºæ£åæ¹æ³çå·ä½å®ç°ãæ¯åºäºHashç®æ³å®ç°çååå å¯ãå¯ä»¥éè¿strengthæ§å¶å å¯å¼ºåº¦ï¼é»è®¤ 10.\n\n# ä»£ç æ¼ç¤º\n\næ°å»ºæµè¯æ¹æ³BCryptPasswordEncoder ç¨æ³ã\n\npackage com.yjxxt.springsecuritydemo;\n\nimport org.junit.jupiter.api.Test;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\nimport org.springframework.security.crypto.password.PasswordEncoder;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@SpringBootTest\npublic class MyTest {\n\n   @Test\n   public void test(){\n      //åå»ºè§£æå¨\n      PasswordEncoder pw = new BCryptPasswordEncoder();\n      //å¯¹å¯ç å å¯\n      String encode = pw.encode("123");\n      System.out.println(encode);\n\n      //å¤æ­åå­ç¬¦åå å¯ååå®¹æ¯å¦å¹é\n      boolean matches = pw.matches("1234", encode);\n      System.out.println("==================="+matches);\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n\n\n# èªå®ä¹ç»å½é»è¾\n\nå½ è¿ è¡ èª å® ä¹ ç» å½ é» è¾ æ¶ é è¦ ç¨ å° ä¹ å è®² è§£ çUserDetailsServiceå PasswordEncoderãä½æ¯ Spring Security è¦æ±ï¼å½è¿è¡èªå®ä¹ç»å½é»è¾æ¶å®¹å¨åå¿é¡»æ PasswordEncoderå®ä¾ãæä»¥ä¸è½ç´æ¥ new å¯¹è±¡ã\n\n# ç¼åéç½®ç±»\n\npackage com.yjxxt.springsecuritydemo.config;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\nimport org.springframework.security.crypto.password.PasswordEncoder;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@Configuration\npublic class SecurityConfig {\n\n   @Bean\n   public PasswordEncoder getPw(){\n      return new BCryptPasswordEncoder();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n# èªå®ä¹é»è¾\n\nå¨ Spring Security ä¸­å®ç° UserDetailService å°±è¡¨ç¤ºä¸ºç¨æ·è¯¦ææå¡ãå¨è¿ä¸ªç±»ä¸­ç¼åç¨æ·è®¤è¯é»è¾ã\n\npackage com.yjxxt.springsecuritydemo.service;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.security.core.authority.AuthorityUtils;\nimport org.springframework.security.core.userdetails.User;\nimport org.springframework.security.core.userdetails.UserDetails;\nimport org.springframework.security.core.userdetails.UserDetailsService;\nimport org.springframework.security.core.userdetails.UsernameNotFoundException;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.stereotype.Service;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@Service\npublic class UserServiceImpl implements UserDetailsService {\n   @Autowired\n   private PasswordEncoder pw;\n\n   @Override\n   public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n      //1.æ¥è¯¢æ°æ®åºå¤æ­ç¨æ·åæ¯å¦å­å¨ï¼å¦æä¸å­å¨æåºUsernameNotFoundExceptionå¼å¸¸\n      if (!"admin".equals(username)){\n         throw new UsernameNotFoundException("ç¨æ·åä¸å­å¨");\n      }\n      //2.ææ¥è¯¢åºæ¥çå¯ç ï¼æ³¨åæ¶å·²ç»å å¯è¿ï¼è¿è¡è§£æï¼æç´æ¥æå¯ç æ¾å¥æé æ¹æ³ä¸­\n      String password = pw.encode("123");\n      return new User(username,password, AuthorityUtils.commaSeparatedStringToAuthorityList("admin,normal"));\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n\n\n# æ¥çææ\n\néå¯é¡¹ç®åï¼å¨æµè§å¨ä¸­è¾å¥è´¦å·ï¼adminï¼å¯ç ï¼123ãåå¯ä»¥æ­£ç¡®è¿å¥å° login.html é¡µé¢ã\n\n\n# èªå®ä¹ç»å½é¡µé¢\n\nè½ç¶ Spring Security ç»æä»¬æä¾äºç»å½é¡µé¢ï¼ä½æ¯å¯¹äºå®éé¡¹ç®ä¸­ï¼å¤§å¤åæ¬¢ä½¿ç¨èªå·±çç»å½é¡µé¢ãæä»¥ Spring Security ä¸­ä¸ä»ä»æä¾äºç»å½é¡µé¢ï¼è¿æ¯æç¨æ·èªå®ä¹ç»å½é¡µé¢ãå®ç°è¿ç¨ä¹æ¯è¾ç®åï¼åªéè¦ä¿®æ¹éç½®ç±»å³å¯ã\n\n# ç¼åç»å½é¡µé¢\n\nlogin.html\n\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <title>Title</title>\n</head>\n<body>\n<form action="/login1" method="post">\n    ç¨æ·åï¼<input type="text" name="username" /><br/>\n    å¯ç ï¼<input type="password" name="password" /><br/>\n    <input type="submit" value="ç»å½" />\n</form>\n</body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n# ä¿®æ¹éç½®ç±»\n\nä¿®æ¹éç½®ç±»ä¸­ä¸»è¦æ¯è®¾ç½®åªä¸ªé¡µé¢æ¯ç»å½é¡µé¢ãéç½®ç±»éè¦ç»§æ¿WebSecurityConfigurerAdapter,å¹¶éå configure æ¹æ³ã\n\n * successForwardUrl()ï¼ç»å½æååè½¬åå°å\n\n * loginPage() ï¼æå®ç»å½é¡µé¢\n\n * loginProcessingUrlï¼æå®åç«¯å¤çç»å½è¯·æ±ççæ¹æ³ï¼å¿é¡»åè¡¨åç»éé¡µé¢ä¸­çactionå±æ§ä¿æä¸è´\n\n * antMatchers()ï¼å¹éåå®¹\n\n * permitAll()ï¼åè®¸\n\npackage com.yjxxt.springsecuritydemo.config;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\nimport org.springframework.security.crypto.password.PasswordEncoder;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@Configuration\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n\n   @Override\n   protected void configure(HttpSecurity http) throws Exception {\n      //è¡¨åæäº¤\n      http.formLogin()\n            //èªå®ä¹ç»å½é¡µé¢\n            .loginPage("/login.html")\n            //å½åç°/loginæ¶è®¤ä¸ºæ¯ç»å½ï¼å¿é¡»åè¡¨åæäº¤çå°åä¸æ ·ãå»æ§è¡UserServiceImpl\n            .loginProcessingUrl("/login1")\n            //ç»å½æååè·³è½¬é¡µé¢ï¼POSTè¯·æ±\n            .successForwardUrl("/toMain");\n\n\n      http.authorizeRequests()\n            //login.htmlä¸éè¦è¢«è®¤è¯\n            .antMatchers("/login.html").permitAll()\n            //ææè¯·æ±é½å¿é¡»è¢«è®¤è¯ï¼å¿é¡»ç»å½åè¢«è®¿é®\n            .anyRequest().authenticated();\n\n      //å³é­csrfé²æ¤\n      http.csrf().disable();\n   }\n\n   @Bean\n   public PasswordEncoder getPw(){\n      return new BCryptPasswordEncoder();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n\n\n# ç¼åæ§å¶å¨\n\npackage com.yjxxt.springsecuritydemo.controller;\n\nimport org.springframework.stereotype.Controller;\nimport org.springframework.web.bind.annotation.RequestMapping;\n\n/**\n * ç»å½\n *\n * @author zhoubin\n * @since 1.0.0\n */\n@Controller\npublic class LoginController {\n   // è¯¥æ¹æ³ä¸æ§è¡ï¼å ä¸ºç»å½è¯·æ±é½æ¯è¢«åç§è¿æ»¤å¨æåæ§è¡çï¼å°ä¸äºè¿é\n   // @RequestMapping("/login")\n   // public String login(){\n   //     System.out.println("ç»å½æ¹æ³");\n   //     return "main.html";\n   // }\n\n   /**\n    * æååè·³è½¬é¡µé¢\n    * @return\n    */\n   @RequestMapping("/toMain")\n   public String toMain(){\n      return "redirect:/main.html";\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\n\n# è®¤è¯è¿ç¨å¶ä»å¸¸ç¨éç½®\n\n# å¤±è´¥è·³è½¬\n\nè¡¨åå¤çä¸­æåä¼è·³è½¬å°ä¸ä¸ªå°åï¼å¤±è´¥ä¹å¯ä»¥è·³è½¬å°ä¸ä¸ªå°åã\n\nç¼åé¡µé¢error.html\n\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <title>Title</title>\n</head>\n<body>\næä½å¤±è´¥ï¼è¯·éæ°ç»å½ <a href= "/login.html">è·³è½¬</a>\n</body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¿®æ¹è¡¨åéç½®\n\nå¨éç½®æ¹æ³ä¸­è¡¨åè®¤è¯é¨åæ·»å failureForwardUrl()æ¹æ³ï¼è¡¨ç¤ºç»å½å¤±è´¥è·³è½¬ç urlãæ­¤å¤ä¾ç¶æ¯ POST è¯·æ±ï¼æä»¥è·³è½¬å°å¯ä»¥æ¥æ¶ POSTè¯·æ±çæ§å¶å¨ä¸­ã\n\n//è¡¨åæäº¤\nhttp.formLogin()\n      //èªå®ä¹ç»å½é¡µé¢\n      .loginPage("/login.html")\n      //å½åç°/loginæ¶è®¤ä¸ºæ¯ç»å½ï¼å¿é¡»åè¡¨åæäº¤çå°åä¸æ ·ãå»æ§è¡UserServiceImpl\n      .loginProcessingUrl("/login1")\n      //ç»å½æååè·³è½¬é¡µé¢ï¼POSTè¯·æ±\n      .successForwardUrl("/toMain")\n      //ç»å½å¤±è´¥åè·³è½¬é¡µé¢ï¼POSTè¯·æ±\n      .failureForwardUrl("/toError");\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\næ·»å æ§å¶å¨çæ¹æ³\n\nå¨æ§å¶å¨ç±»ä¸­æ·»å æ§å¶å¨æ¹æ³ï¼æ¹æ³æ å°è·¯å¾/toErrorãæ­¤å¤è¦æ³¨æï¼ç±äºæ¯ POST è¯·æ±è®¿é®/toErrorãæä»¥å¦æè¿åå¼ç´æ¥è½¬åå° error.html ä¸­ï¼æ§å¶å°ä¼æ¥è­¦åï¼æç¤º error.html ä¸æ¯æ POST è®¿é®æ¹å¼ãæä»¥å¿é¡»ç¨éå®åã\n\n/**\n * å¤±è´¥åè·³è½¬é¡µé¢\n * @return\n */\n@RequestMapping("/toError")\npublic String toError(){\n   return "redirect:/error.html";\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nè®¾ç½®error.htmlä¸éè¦è®¤è¯\n\nhttp.authorizeRequests()\n      //login.htmlä¸éè¦è¢«è®¤è¯\n      .antMatchers("/login.html").permitAll()\n      //error.htmlä¸éè¦è¢«è®¤è¯\n      .antMatchers("/error.html").permitAll()\n      //ææè¯·æ±é½å¿é¡»è¢«è®¤è¯ï¼å¿é¡»ç»å½åè¢«è®¿é®\n      .anyRequest().authenticated();\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n# è®¾ç½®è¯·æ±è´¦æ·åå¯ç çåæ°å\n\næºç ç®ä»\n\nå½è¿è¡ç»å½æ¶ä¼æ§è¡ UsernamePasswordAuthenticationFilter è¿æ»¤å¨ã\n\n * usernamePasrameterï¼è´¦æ·åæ°å\n\n * passwordParameterï¼å¯ç åæ°å\n\n * postOnly=trueï¼é»è®¤æåµä¸åªåè®¸POSTè¯·æ±ã\n\n\n\nä¿®æ¹éç½®\n\n//è¡¨åæäº¤\nhttp.formLogin()\n      //èªå®ä¹ç»å½é¡µé¢\n      .loginPage("/login.html")\n      //å½åç°/loginæ¶è®¤ä¸ºæ¯ç»å½ï¼å¿é¡»åè¡¨åæäº¤çå°åä¸æ ·ãå»æ§è¡UserServiceImpl\n      .loginProcessingUrl("/login1")\n      //ç»å½æååè·³è½¬é¡µé¢ï¼POSTè¯·æ±\n      .successForwardUrl("/toMain")\n      //ç»å½å¤±è´¥åè·³è½¬é¡µé¢ï¼POSTè¯·æ±\n      .failureForwardUrl("/toError")\n      .usernameParameter("myusername")\n      .passwordParameter("mypassword");\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¿®æ¹login.html\n\n<form action="/login1" method="post">\n    ç¨æ·åï¼<input type="text" name="myusername" /><br/>\n    å¯ç ï¼<input type="password" name="mypassword" /><br/>\n    <input type="submit" value="ç»å½" />\n</form>\n\n\n1\n2\n3\n4\n5\n\n\n# èªå®ä¹ç»å½æåå¤çå¨\n\næºç åæ\n\nä½¿ç¨successForwardUrl()æ¶è¡¨ç¤ºæååè½¬åè¯·æ±å°å°åãåé¨æ¯éè¿ successHandler()æ¹æ³è¿è¡æ§å¶æååäº¤ç»åªä¸ªç±»è¿è¡å¤ç\n\n\n\nForwardAuthenticationSuccessHandleråé¨å°±æ¯æç®åçè¯·æ±è½¬åãç±äºæ¯è¯·æ±è½¬åï¼å½éå°éè¦è·³è½¬å°ç«å¤æå¨ååç«¯åç¦»çé¡¹ç®ä¸­å°±æ æ³ä½¿ç¨äºã\n\n\n\nå½éè¦æ§å¶ç»å½æååå»åä¸äºäºææ¶ï¼å¯ä»¥è¿è¡èªå®ä¹è®¤è¯æåæ§å¶å¨ã\n\nä»£ç å®ç°\n\næ°å»ºç±» com.yjxxt.handler.MyAuthenticationSuccessHandler ç¼åå¦ä¸ï¼\n\npackage com.yjxxt.springsecuritydemo.handler;\n\nimport org.springframework.security.core.Authentication;\nimport org.springframework.security.core.userdetails.User;\nimport org.springframework.security.web.authentication.AuthenticationSuccessHandler;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\npublic class MyAuthenticationSuccessHandler implements AuthenticationSuccessHandler {\n\n   private String url;\n\n   public MyAuthenticationSuccessHandler(String url) {\n      this.url = url;\n   }\n\n   @Override\n   public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication) throws IOException, ServletException {\n      //Principal ä¸»ä½ï¼å­æ¾äºç»å½ç¨æ·çä¿¡æ¯\n      User user = (User) authentication.getPrincipal();\n      System.out.println(user.getUsername());\n      //è¾åºnull\n      System.out.println(user.getPassword());\n      System.out.println(user.getAuthorities());\n      response.sendRedirect(url);\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n\n\nä¿®æ¹éç½®é¡¹\n\nä½¿ç¨ successHandler()æ¹æ³è®¾ç½®æååäº¤ç»åªä¸ªå¯¹è±¡è¿è¡å¤ç\n\n//è¡¨åæäº¤\nhttp.formLogin()\n      //èªå®ä¹ç»å½é¡µé¢\n      .loginPage("/login.html")\n      //å½åç°/login1æ¶è®¤ä¸ºæ¯ç»å½ï¼å¿é¡»åè¡¨åæäº¤çå°åä¸æ ·ãå»æ§è¡UserServiceImpl\n      .loginProcessingUrl("/login1")\n      //ç»å½æååè·³è½¬é¡µé¢ï¼POSTè¯·æ±\n      // .successForwardUrl("/toMain")\n      //åsuccessForwardUrlä¸è½å±å­\n      .successHandler(new MyAuthenticationSuccessHandler("http://www.baidu.com"))\n      //ç»å½å¤±è´¥åè·³è½¬é¡µé¢ï¼POSTè¯·æ±\n      .failureForwardUrl("/toError")\n      .usernameParameter("myusername")\n      .passwordParameter("mypassword");\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n# èªå®ä¹ç»å½å¤±è´¥å¤çå¨\n\næºç åæ\n\nfailureForwardUrl()åé¨è°ç¨çæ¯failureHandler()æ¹æ³\n\n\n\nForwardAuthenticationFailureHandler ä¸­ä¹æ¯ä¸ä¸ªè¯·æ±è½¬åï¼å¹¶å¨request ä½ç¨åä¸­è®¾ç½® SPRING_SECURITY_LAST_EXCEPTIONç keyï¼åå®¹ä¸ºå¼å¸¸å¯¹è±¡ã\n\n\n\nä»£ç å®ç°\n\næ°å»ºæ§å¶å¨\n\næ°å»º com.yjxxt.handler.MyForwardAuthenticationFailureHandler å®ç°AuthenticationFailureHandlerãå¨æ¹æ³ä¸­æ·»å éå®åè¯­å¥\n\npackage com.yjxxt.springsecuritydemo.handler;\n\nimport org.springframework.security.core.AuthenticationException;\nimport org.springframework.security.web.authentication.AuthenticationFailureHandler;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\npublic class MyForwardAuthenticationFailureHandler implements AuthenticationFailureHandler {\n\n   private String url;\n\n   public MyForwardAuthenticationFailureHandler(String url) {\n      this.url = url;\n   }\n\n   @Override\n   public void onAuthenticationFailure(HttpServletRequest request, HttpServletResponse response, AuthenticationException exception) throws IOException, ServletException {\n      response.sendRedirect(url);\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n\n\nä¿®æ¹éç½®ç±»\n\nä¿®æ¹éç½®ç±»ä¸­è¡¨åç»å½é¨åãè®¾ç½®å¤±è´¥æ¶äº¤ç»å¤±è´¥å¤çå¨è¿è¡æä½ãfailureForwardUrlå failureHandlerä¸å¯å±å­\n\n//è¡¨åæäº¤\nhttp.formLogin()\n      //èªå®ä¹ç»å½é¡µé¢\n      .loginPage("/login.html")\n      //å½åç°/loginæ¶è®¤ä¸ºæ¯ç»å½ï¼å¿é¡»åè¡¨åæäº¤çå°åä¸æ ·ãå»æ§è¡UserServiceImpl\n      .loginProcessingUrl("/login")\t\n      //ç»å½æååè·³è½¬é¡µé¢ï¼POSTè¯·æ±\n      // .successForwardUrl("/toMain")\n      //åsuccessForwardUrlä¸è½å±å­\n      .successHandler(new MyAuthenticationSuccessHandler("http://www.baidu.com"))\n      //ç»å½å¤±è´¥åè·³è½¬é¡µé¢ï¼POSTè¯·æ±\n      // .failureForwardUrl("/toError")\n      .failureHandler(new MyForwardAuthenticationFailureHandler("/error.html"))\n      .usernameParameter("myusername")\n      .passwordParameter("mypassword");\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# è®¿é®æ§å¶urlå¹é\n\nå¨åé¢è®²è§£äºè®¤è¯ä¸­ææå¸¸ç¨éç½®ï¼ä¸»è¦æ¯å¯¹http.formLogin()è¿è¡æä½ãèå¨éç½®ç±»ä¸­ http.authorizeRequests()ä¸»è¦æ¯å¯¹urlè¿è¡æ§å¶ï¼ä¹å°±æ¯æä»¬æè¯´çææï¼è®¿é®æ§å¶ï¼ãhttp.authorizeRequests()ä¹æ¯æè¿ç¼åæ³ï¼æ»ä½å¬å¼ä¸ºï¼\n\nãURLå¹éè§åã.ãæéæ§å¶æ¹æ³ã\n\néè¿ä¸é¢çå¬å¼å¯ä»¥æå¾å¤ url å¹éè§ååå¾å¤æéæ§å¶æ¹æ³ãè¿äºåå®¹è¿è¡åç§ç»åå°±å½¢æäºSpring Securityä¸­çææã\n\nå¨ææå¹éè§åä¸­åææè§åçäº¤éãéç½®é¡ºåºå½±åäºä¹åææææï¼è¶æ¯å·ä½çåºè¯¥æ¾å¨åé¢ï¼è¶æ¯ç¬¼ç»çåºè¯¥æ¾å°åé¢ã\n\n# anyRequest()\n\nå¨ä¹åè®¤è¯è¿ç¨ä¸­æä»¬å°±å·²ç»ä½¿ç¨è¿ anyRequest()ï¼è¡¨ç¤ºå¹éææçè¯·æ±ãä¸è¬æåµä¸æ­¤æ¹æ³é½ä¼ä½¿ç¨ï¼è®¾ç½®å¨é¨åå®¹é½éè¦è¿è¡è®¤è¯ã\n\n.anyRequest().authenticated();\n\n\n1\n\n\n# antMatcher()\n\næ¹æ³å®ä¹å¦ä¸\n\npublic C antMatchers(String... antPatterns)\n\n\n1\n\n\nåæ°æ¯ä¸å®ååæ°ï¼æ¯ä¸ªåæ°æ¯ä¸ä¸ª ant è¡¨è¾¾å¼ï¼ç¨äºå¹é URLè§åã\n\nè§åå¦ä¸ï¼\n\n * ?ï¼ å¹éä¸ä¸ªå­ç¬¦\n\n * *ï¼å¹é 0 ä¸ªæå¤ä¸ªå­ç¬¦\n\n * ** ï¼å¹é 0 ä¸ªæå¤ä¸ªç®å½\n\nå¨å®éé¡¹ç®ä¸­ç»å¸¸éè¦æ¾è¡ææéæèµæºï¼ä¸é¢æ¼ç¤ºæ¾è¡ js æä»¶å¤¹ä¸ææèæ¬æä»¶ã\n\n.antMatchers("/js/**","/css/**").permitAll()\n\n\n1\n\n\nè¿æä¸ç§éç½®æ¹å¼æ¯åªè¦æ¯.js æä»¶é½æ¾è¡\n\n.antMatchers("/**/*.js").permitAll()\n\n\n1\n\n\n# regexMatchers()\n\n# ä»ç»\n\nä½¿ç¨æ­£åè¡¨è¾¾å¼è¿è¡å¹éãå antMatchers()ä¸»è¦çåºå«å°±æ¯åæ°ï¼antMatchers()åæ°æ¯ ant è¡¨è¾¾å¼ï¼regexMatchers()åæ°æ¯æ­£åè¡¨è¾¾å¼ã\n\næ¼ç¤ºææä»¥.js ç»å°¾çæä»¶é½è¢«æ¾è¡ã\n\n.regexMatchers( ".+[.]js").permitAll()\n\n\n1\n\n\n# ä¸¤ä¸ªåæ°æ¶ä½¿ç¨æ¹å¼\n\næ è®ºæ¯antMatchers()è¿æ¯regexMatchers()é½å·æä¸¤ä¸ªåæ°çæ¹æ³ï¼å¶ä¸­ç¬¬ä¸ä¸ªåæ°é½æ¯ HttpMethodï¼è¡¨ç¤ºè¯·æ±æ¹å¼ï¼å½è®¾ç½®äºHttpMethodåè¡¨ç¤ºåªæè®¾å®çç¹å®çè¯·æ±æ¹å¼ææ§è¡å¯¹åºçæéè®¾ç½®ã\n\næä¸¾ç±»å HttpMethodåç½®å±æ§å¦ä¸ï¼\n\n\n\n# mvcMatchers()\n\nmvcMatchers()éç¨äºéç½®äº servletPath çæåµã\n\nservletPath å°±æ¯ææç URL çç»ä¸åç¼ãå¨ SpringBoot æ´åSpringMVC çé¡¹ç®ä¸­å¯ä»¥å¨ application.properties ä¸­æ·»å ä¸é¢åå®¹è®¾ç½® ServletPath\n\nspring.mvc.servlet.path=/yjxxt\n\n\n1\n\n\nå¨ Spring Security çéç½®ç±»ä¸­éç½®servletPath()æ¯ mvcMatchers()è¿åå¼ç¹æçæ¹æ³ï¼antMatchers()å regexMatchers()æ²¡æè¿ä¸ªæ¹æ³ãå¨servletPath()ä¸­éç½®äºservletPathåï¼mvcMatchers()ç´æ¥å SpringMVC ä¸­@RequestMapping()ä¸­è®¾ç½®çè·¯å¾å³å¯ã\n\n.mvcMatchers("/demo").servletPath("/yjxxt").permitAll()\n\n\n1\n\n\nå¦æä¸ä¹ æ¯ä½¿ç¨ mvcMatchers()ä¹å¯ä»¥ä½¿ç¨ antMatchers()ï¼ä¸é¢ä»£ç åä¸é¢ä»£ç æ¯ç­æ\n\n.antMatchers("/yjxxt/demo").permitAll()\n\n\n1\n\n\n\n# åç½®è®¿é®æ§å¶æ¹æ³\n\nSpring Security å¹éäº URL åè°ç¨äºpermitAll()è¡¨ç¤ºä¸éè¦è®¤è¯ï¼éæè®¿é®ãå¨ Spring Security ä¸­æä¾äºå¤ç§åç½®æ§å¶ã\n\n# permitAll()\n\npermitAll()è¡¨ç¤ºæå¹éç URL ä»»ä½äººé½åè®¸è®¿é®ã\n\n\n\n# authenticated()\n\nauthenticated()è¡¨ç¤ºæå¹éç URL é½éè¦è¢«è®¤è¯æè½è®¿é®ã\n\n\n\n# anonymous()\n\nanonymous()è¡¨ç¤ºå¯ä»¥å¿åè®¿é®å¹éçURLãåpermitAll()ææç±»ä¼¼ï¼åªæ¯è®¾ç½®ä¸º anonymous()ç url ä¼æ§è¡ filter é¾ä¸­\n\n\n\n# denyAll()\n\ndenyAll()è¡¨ç¤ºæå¹éç URL é½ä¸åè®¸è¢«è®¿é®ã\n\n\n\n# rememberMe()\n\nè¢«âremember meâçç¨æ·åè®¸è®¿é®\n\n\n\n# fullyAuthenticated()\n\nå¦æç¨æ·ä¸æ¯è¢« remember me çï¼æå¯ä»¥è®¿é®ã\n\n\n\n\n# è§è²æéå¤æ­\n\né¤äºä¹åè®²è§£çåç½®æéæ§å¶ãSpring Security ä¸­è¿æ¯æå¾å¤å¶ä»æéæ§å¶ãè¿äºæ¹æ³ä¸è¬é½ç¨äºç¨æ·å·²ç»è¢«è®¤è¯åï¼å¤æ­ç¨æ·æ¯å¦å·æç¹å®çè¦æ±ã\n\n# hasAuthority(String)\n\nå¤æ­ç¨æ·æ¯å¦å·æç¹å®çæéï¼ç¨æ·çæéæ¯å¨èªå®ä¹ç»å½é»è¾ä¸­åå»º User å¯¹è±¡æ¶æå®çãä¸å¾ä¸­ adminånormal å°±æ¯ç¨æ·çæéãadminånormal ä¸¥æ ¼åºåå¤§å°åã\n\n\n\nå¨éç½®ç±»ä¸­éè¿ hasAuthority(âadminâ)è®¾ç½®å·æ admin æéæ¶æè½è®¿é®ã\n\n.antMatchers("/main1.html").hasAuthority("admin")\n\n\n1\n\n\n# hasAnyAuthority(String ...)\n\nå¦æç¨æ·å·å¤ç»å®æéä¸­æä¸ä¸ªï¼å°±åè®¸è®¿é®ã\n\nä¸é¢ä»£ç ä¸­ç±äºå¤§å°ååç¨æ·çæéä¸ç¸åï¼æä»¥ç¨æ·æ æè®¿é®\n\n.antMatchers("/main1.html").hasAnyAuthority("adMin","admiN")\n\n\n1\n\n\n# hasRole(String)\n\nå¦æç¨æ·å·å¤ç»å®è§è²å°±åè®¸è®¿é®ãå¦ååºç° 403ã\n\nåæ°åå¼æ¥æºäºèªå®ä¹ç»å½é»è¾ UserDetailsServiceå®ç°ç±»ä¸­åå»º User å¯¹è±¡æ¶ç» User èµäºçææã\n\nå¨ç»ç¨æ·èµäºè§è²æ¶è§è²éè¦ä»¥ï¼ROLE_å¼å¤´ï¼åé¢æ·»å è§è²åç§°ãä¾å¦ï¼ROLE_abc å¶ä¸­ abc æ¯è§è²åï¼ROLE_æ¯åºå®çå­ç¬¦å¼å¤´ã\n\nä½¿ç¨ hasRole()æ¶åæ°ä¹åªå abc å³å¯ãå¦åå¯å¨æ¥éã\n\nç»ç¨æ·èµäºè§è²ï¼\n\n\n\nå¨éç½®ç±»ä¸­ç´æ¥å abc å³å¯ã\n\n.antMatchers("/main1.html").hasRole("abc")\n\n\n1\n\n\n# hasAnyRole(String ...)\n\nå¦æç¨æ·å·å¤ç»å®è§è²çä»»æä¸ä¸ªï¼å°±åè®¸è¢«è®¿é®\n\n# hasIpAddress(String)\n\nå¦æè¯·æ±æ¯æå®ç IP å°±è¿è¡è®¿é®ã\n\nå¯ä»¥éè¿ request.getRemoteAddr()è·å ip å°åã\n\néè¦æ³¨æçæ¯å¨æ¬æºè¿è¡æµè¯æ¶ localhost å 127.0.0.1 è¾åºç ipå°åæ¯ä¸ä¸æ ·çã\n\nå½æµè§å¨ä¸­éè¿ localhost è¿è¡è®¿é®æ¶æ§å¶å°æå°çåå®¹ï¼\n\n\n\nå½æµè§å¨ä¸­éè¿ 127.0.0.1 è®¿é®æ¶æ§å¶å°æå°çåå®¹ï¼\n\n\n\nå½æµè§å¨ä¸­éè¿å·ä½ ip è¿è¡è®¿é®æ¶æ§å¶å°æå°åå®¹ï¼\n\n\n\n.antMatchers("/main1.html").hasIpAddress("127.0.0.1")\n\n\n1\n\n\n\n# èªå®ä¹403å¤çæ¹æ¡\n\nä½¿ç¨ Spring Security æ¶ç»å¸¸ä¼çè§ 403ï¼æ æéï¼ï¼é»è®¤æåµä¸æ¾ç¤ºçææå¦ä¸ï¼\n\n\n\nèå¨å®éé¡¹ç®ä¸­å¯è½é½æ¯ä¸ä¸ªå¼æ­¥è¯·æ±ï¼æ¾ç¤ºä¸è¿°ææå¯¹äºç¨æ·å°±ä¸æ¯ç¹å«åå¥½äºãSpring Security æ¯æèªå®ä¹æéåéã\n\n# æ°å»ºç±»\n\næ°å»ºç±»å®ç° AccessDeniedHandler\n\npackage com.yjxxt.springsecuritydemo.handler;\n\nimport org.springframework.security.access.AccessDeniedException;\nimport org.springframework.security.web.access.AccessDeniedHandler;\nimport org.springframework.stereotype.Component;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\nimport java.io.PrintWriter;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@Component\npublic class MyAccessDeniedHandler implements AccessDeniedHandler {\n\n   @Override\n   public void handle(HttpServletRequest request, HttpServletResponse response, AccessDeniedException accessDeniedException) throws IOException, ServletException {\n      response.setStatus(HttpServletResponse.SC_FORBIDDEN);\n      response.setHeader("Content-Type", "application/json;charset=utf-8");\n      PrintWriter out = response.getWriter();\n      out.write("{\\"status\\":\\"error\\",\\"msg\\":\\"æéä¸è¶³ï¼è¯·èç³»ç®¡çåï¼\\"}");\n      out.flush();\n      out.close();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\n# ä¿®æ¹éç½®ç±»\n\néç½®ç±»ä¸­éç¹æ·»å å¼å¸¸å¤çå¨ãè®¾ç½®è®¿é®åéåäº¤ç»åªä¸ªå¯¹è±¡è¿è¡å¤çã\n\nmyAccessDeniedHandler æ¯å¨éç½®ç±»ä¸­è¿è¡èªå¨æ³¨å¥çã\n\n//å¼å¸¸å¤ç\nhttp.exceptionHandling()\n      .accessDeniedHandler(myAccessDeniedHandler);\n\n\n1\n2\n3\n\n\n\n# åºäºè¡¨è¾¾å¼çè®¿é®æ§å¶\n\n# access()æ¹æ³ä½¿ç¨\n\nä¹åå­¦ä¹ çç»å½ç¨æ·æéå¤æ­å®éä¸åºå±å®ç°é½æ¯è°ç¨access(è¡¨è¾¾å¼)\n\n\n\nå¯ä»¥éè¿access()å®ç°åä¹åå­¦ä¹ çæéæ§å¶å®æç¸åçåè½ã\n\nä»¥ hasRole å å permitAll ä¸¾ä¾\n\n\n\n# ä½¿ç¨èªå®ä¹æ¹æ³\n\nè½ç¶è¿éé¢å·²ç»åå«äºå¾å¤çè¡¨è¾¾å¼(æ¹æ³)ä½æ¯å¨å®éé¡¹ç®ä¸­å¾æå¯è½åºç°éè¦èªå·±èªå®ä¹é»è¾çæåµã\n\nå¤æ­ç»å½ç¨æ·æ¯å¦å·æè®¿é®å½å URL æéã\n\n# æ°å»ºæ¥å£åå®ç°ç±»\n\nMyService.java\n\npackage com.yjxxt.springsecuritydemo.service;\n\nimport org.springframework.security.core.Authentication;\n\nimport javax.servlet.http.HttpServletRequest;\n\npublic interface MyService {\n   boolean hasPermission(HttpServletRequest request, Authentication authentication);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nMyServiceImpl.java\n\npackage com.yjxxt.springsecuritydemo.service.impl;\n\nimport com.yjxxt.springsecuritydemo.service.MyService;\nimport org.springframework.security.core.Authentication;\nimport org.springframework.security.core.GrantedAuthority;\nimport org.springframework.security.core.authority.SimpleGrantedAuthority;\nimport org.springframework.security.core.userdetails.UserDetails;\nimport org.springframework.stereotype.Component;\n\nimport javax.servlet.http.HttpServletRequest;\nimport java.util.Collection;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@Component\npublic class MyServiceImpl implements MyService {\n\n   @Override\n   public boolean hasPermission(HttpServletRequest request, Authentication authentication) {\n      Object obj = authentication.getPrincipal();\n      if (obj instanceof UserDetails){\n         UserDetails userDetails = (UserDetails) obj;\n         Collection<? extends GrantedAuthority> authorities = userDetails.getAuthorities();\n         return authorities.contains(new SimpleGrantedAuthority(request.getRequestURI()));\n      }\n      return false;\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\n# ä¿®æ¹éç½®ç±»\n\nå¨ access ä¸­éè¿@beançidå.æ¹æ³(åæ°)çå½¢å¼è¿è¡è°ç¨éç½®ç±»ä¸­ä¿®æ¹å¦ä¸ï¼\n\n//urlæ¦æª\nhttp.authorizeRequests()\n      //login.htmlä¸éè¦è¢«è®¤è¯\n      // .antMatchers("/login.html").permitAll()\n      .antMatchers("/login.html").access("permitAll")\n      // .antMatchers("/main.html").hasRole("abc")\n      .antMatchers("/main.html").access("hasRole(\'abc\')")\n      .anyRequest().access("@myServiceImpl.hasPermission(request,authentication)")\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# åºäºæ³¨è§£çè®¿é®æ§å¶\n\nå¨ Spring Security ä¸­æä¾äºä¸äºè®¿é®æ§å¶çæ³¨è§£ãè¿äºæ³¨è§£é½æ¯é»è®¤æ¯é½ä¸å¯ç¨çï¼éè¦éè¿@EnableGlobalMethodSecurityè¿è¡å¼å¯åä½¿ç¨ã\n\nå¦æè®¾ç½®çæ¡ä»¶åè®¸ï¼ç¨åºæ­£å¸¸æ§è¡ãå¦æä¸åè®¸ä¼æ¥ 500\n\n\n\nè¿äºæ³¨è§£å¯ä»¥åå° Service æ¥å£ææ¹æ³ä¸ï¼ä¹å¯ä»¥åå° Controlleræ Controller çæ¹æ³ä¸ãéå¸¸æåµä¸é½æ¯åå¨æ§å¶å¨æ¹æ³ä¸çï¼æ§å¶æ¥å£URLæ¯å¦åè®¸è¢«è®¿é®ã\n\n# @Secured\n\n@Secured æ¯ä¸é¨ç¨äºå¤æ­æ¯å¦å·æè§è²çãè½åå¨æ¹æ³æç±»ä¸ãåæ°è¦ä»¥ ROLE_å¼å¤´ã\n\n\n\n# å¼å¯æ³¨è§£\n\nå¨ å¯ å¨ ç±» ( ä¹ å¯ ä»¥ å¨ é ç½® ç±» ç­ è½ å¤ æ« æ ç ç±» ä¸ ) ä¸ æ·» å @EnableGlobalMethodSecurity(securedEnabled = true)\n\n@SpringBootApplication\n@EnableGlobalMethodSecurity(securedEnabled = true)\npublic class SpringsecurityDemoApplication {\n\n   public static void main(String[] args) {\n      SpringApplication.run(SpringsecurityDemoApplication.class, args);\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n# å¨æ§å¶å¨æ¹æ³ä¸æ·»å  @Secured æ³¨è§£\n\n/**\n * æååè·³è½¬é¡µé¢\n * @return\n */\n@Secured("ROLE_abc")\n@RequestMapping("/toMain")\npublic String toMain(){\n   return "redirect:/main.html";\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n# éç½®ç±»\n\n@Override\nprotected void configure(HttpSecurity http) throws Exception {\n   //è¡¨åæäº¤\n   http.formLogin()\n         //èªå®ä¹ç»å½é¡µé¢\n         .loginPage("/login.html")\n         //å½åç°/loginæ¶è®¤ä¸ºæ¯ç»å½ï¼å¿é¡»åè¡¨åæäº¤çå°åä¸æ ·ãå»æ§è¡UserServiceImpl\n         .loginProcessingUrl("/login")\n         //ç»å½æååè·³è½¬é¡µé¢ï¼POSTè¯·æ±\n         .successForwardUrl("/toMain")\n         \n   //urlæ¦æª\n   http.authorizeRequests()\n         //login.htmlä¸éè¦è¢«è®¤è¯\n         .antMatchers("/login.html").permitAll()\n         //ææè¯·æ±é½å¿é¡»è¢«è®¤è¯ï¼å¿é¡»ç»å½åè¢«è®¿é®\n         .anyRequest().authenticated();\n   //å³é­csrfé²æ¤\n   http.csrf().disable();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n# @PreAuthorize/@PostAuthorize\n\n@PreAuthorize å@PostAuthorize é½æ¯æ¹æ³æç±»çº§å«æ³¨è§£ã\n\n\n\n * @PreAuthorizeè¡¨ç¤ºè®¿é®æ¹æ³æç±»å¨æ§è¡ä¹ååå¤æ­æéï¼å¤§å¤æåµä¸é½æ¯ä½¿ç¨è¿ä¸ªæ³¨è§£ï¼æ³¨è§£çåæ°åaccess()æ¹æ³åæ°åå¼ç¸åï¼é½æ¯æéè¡¨è¾¾å¼ã\n * @PostAuthorize è¡¨ç¤ºæ¹æ³æç±»æ§è¡ç»æåå¤æ­æéï¼æ­¤æ³¨è§£å¾å°è¢«ä½¿ç¨å°ã\n\n# å¼å¯æ³¨è§£\n\n@SpringBootApplication\n@EnableGlobalMethodSecurity(prePostEnabled = true)\npublic class SpringsecurityDemoApplication {\n\n   public static void main(String[] args) {\n      SpringApplication.run(SpringsecurityDemoApplication.class, args);\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n# æ·»å @PreAuthorize\n\nå¨æ§å¶å¨æ¹æ³ä¸æ·»å @PreAuthorizeï¼åæ°å¯ä»¥æ¯ä»»ä½ access()æ¯æçè¡¨è¾¾å¼\n\n/**\n * æååè·³è½¬é¡µé¢\n * @return\n */\n@PreAuthorize("hasRole(\'ROLE_abc\')")\n@RequestMapping("/toMain")\npublic String toMain(){\n   return "redirect:/main.html";\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# RememberMeåè½å®ç°\n\nSpring Security ä¸­ Remember Me ä¸ºâè®°ä½æâåè½ï¼ç¨æ·åªéè¦å¨ç»å½æ¶æ·»å  remember-meå¤éæ¡ï¼åå¼ä¸ºtrueãSpring Security ä¼èªå¨æç¨æ·ä¿¡æ¯å­å¨å°æ°æ®æºä¸­ï¼ä»¥åå°±å¯ä»¥ä¸ç»å½è¿è¡è®¿é®\n\n# æ·»å ä¾èµ\n\nSpring Security å® ç° Remember Me å è½ æ¶ åº å± å® ç° ä¾ èµSpring-JDBCï¼æä»¥éè¦å¯¼å¥ Spring-JDBCãä»¥åå¤ä½¿ç¨ MyBatis æ¡æ¶èå¾å°ç´æ¥å¯¼å¥ spring-jdbcï¼æä»¥æ­¤å¤å¯¼å¥ mybatis å¯å¨å¨åæ¶è¿éè¦æ·»å  MySQL é©±å¨\n\n\x3c!-- mybatis ä¾èµ --\x3e\n<dependency>\n   <groupId>org.mybatis.spring.boot</groupId>\n   <artifactId>mybatis-spring-boot-starter</artifactId>\n   <version>2.1.1</version>\n</dependency>\n\x3c!-- mysql æ°æ®åºä¾èµ --\x3e\n<dependency>\n   <groupId>mysql</groupId>\n   <artifactId>mysql-connector-java</artifactId>\n   <version>8.0.18</version>\n</dependency>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n# éç½®æ°æ®æº\n\nå¨ application.properties ä¸­éç½®æ°æ®æºãè¯·ç¡®ä¿æ°æ®åºä¸­å·²ç»å­å¨shopæ°æ®åº\n\nspring.datasource.driver-class-name= com.mysql.cj.jdbc.Driver\nspring.datasource.url= jdbc:mysql://localhost:3306/security?useUnicode=true&characterEncoding=UTF-8&serverTimezone=Asia/Shanghai\nspring.datasource.username= root\nspring.datasource.password= root\n\n\n1\n2\n3\n4\n\n\n# ç¼åéç½®\n\nRememberMeConfig.java\n\npackage com.yjxxt.springsecuritydemo.config;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.web.authentication.rememberme.JdbcTokenRepositoryImpl;\nimport org.springframework.security.web.authentication.rememberme.PersistentTokenRepository;\n\nimport javax.sql.DataSource;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@Configuration\npublic class RememberMeConfig {\n\n   @Autowired\n   private DataSource dataSource;\n\n   @Bean\n   public PersistentTokenRepository getPersistentTokenRepository(){\n      JdbcTokenRepositoryImpl jdbcTokenRepository = new JdbcTokenRepositoryImpl();\n      jdbcTokenRepository.setDataSource(dataSource);\n      //èªå¨å»ºè¡¨ï¼ç¬¬ä¸æ¬¡å¯å¨æ¶éè¦ï¼ç¬¬äºæ¬¡å¯å¨æ¶æ³¨éæ\n      jdbcTokenRepository.setCreateTableOnStartup(true);\n      return jdbcTokenRepository;\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\n# ä¿®æ¹SecurityConfig.java\n\nå¨SecurityConfigä¸­æ·»å RememberMeConfigåUserDetailsServiceå®ç°ç±»å¯¹è±¡ï¼å¹¶èªå¨æ³¨å¥ã\n\nå¨ configure ä¸­æ·»å ä¸é¢éç½®åå®¹ã\n\nhttp.rememberMe()\n      //ç»å½é»è¾äº¤ç»åªä¸ªå¯¹è±¡\n      .userDetailsService(userService)\n      // æä¹å±å¯¹è±¡\n      .tokenRepository(persistentTokenRepository);\n\n\n1\n2\n3\n4\n5\n\n\n# å¨å®¢æ·ç«¯é¡µé¢æ·»å å¤éæ¡\n\nå¨å®¢æ·ç«¯ç»å½é¡µé¢ä¸­æ·»å  remember-me çå¤éæ¡ï¼åªè¦ç¨æ·å¾éäºå¤éæ¡ä¸æ¬¡å°±ä¸éè¦è¿è¡ç»å½äºã\n\n<form action="/login" method="post">\n    ç¨æ·åï¼<input type="text" name="username" /><br/>\n    å¯ç ï¼<input type="password" name="password" /><br/>\n    <input type="checkbox" name="remember-me" value="true"/><br/>\n    <input type="submit" value="ç»å½" />\n</form>\n\n\n1\n2\n3\n4\n5\n6\n\n\n# æææ¶é´\n\né»è®¤æåµä¸éå¯é¡¹ç®åç»å½ç¶æå¤±æäºãä½æ¯å¯ä»¥éè¿è®¾ç½®ç¶ææææ¶é´ï¼å³ä½¿é¡¹ç®éæ°å¯å¨ä¸æ¬¡ä¹å¯ä»¥æ­£å¸¸ç»å½ã\n\nhttp.rememberMe()\n      //å¤±ææ¶é´ï¼åä½ç§\n      .tokenValiditySeconds(120)\n      //ç»å½é»è¾äº¤ç»åªä¸ªå¯¹è±¡\n      .userDetailsService(userService)\n      // æä¹å±å¯¹è±¡\n      .tokenRepository(persistentTokenRepository);\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# Thymeleafä¸­SpringSecurityçä½¿ç¨ï¼äºè§£ï¼\n\nSpring Security å¯ä»¥å¨ä¸äºè§å¾ææ¯ä¸­è¿è¡æ§å¶æ¾ç¤ºææãä¾å¦ï¼JSPæ Thymeleafãå¨éååç«¯åç¦»ä¸ä½¿ç¨ Spring Boot çé¡¹ç®ä¸­å¤ä½¿ç¨ Thymeleafä½ä¸ºè§å¾å±ç¤ºææ¯ã\n\nThymeleaf å¯¹ Spring Security ç æ¯ æ é½ æ¾ å¨thymeleaf-extras-springsecurityXä¸­ï¼ç®åææ°çæ¬ä¸º 5ãæä»¥éè¦å¨é¡¹ç®ä¸­æ·»å æ­¤ jar åçä¾èµå thymeleaf çä¾èµãã\n\n\x3c!--thymeleaf springsecurity5 ä¾èµ--\x3e\n<dependency>\n   <groupId>org.thymeleaf.extras</groupId>\n   <artifactId>thymeleaf-extras-springsecurity5</artifactId>\n</dependency>\n\x3c!--thymeleafä¾èµ--\x3e\n<dependency>\n   <groupId>org.springframework.boot</groupId>\n   <artifactId>spring-boot-starter-thymeleaf</artifactId>\n</dependency>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¨ html é¡µé¢ä¸­å¼å¥ thymeleaf å½åç©ºé´å security å½åç©ºé´\n\n<html xmlns="http://www.w3.org/1999/xhtml"\n      xmlns:th="http://www.thymeleaf.org"\n      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">\n\n\n1\n2\n3\n\n\n# è·åå±æ§\n\nå¯ä»¥å¨htmlé¡µé¢ä¸­éè¿sec:authentication=""è·å\n\nUsernamePasswordAuthenticationTokenä¸­ææ getXXXçåå®¹ï¼åå«ç¶ç±»ä¸­ç getXXXçåå®¹ã\n\næ ¹æ®æºç å¾åºä¸é¢å±æ§ï¼\n\n * nameï¼ç»å½è´¦å·åç§°\n\n * principalï¼ç»å½ä¸»ä½ï¼å¨èªå®ä¹ç»å½é»è¾ä¸­æ¯ UserDetails\n\n * credentialsï¼å­è¯\n\n * authoritiesï¼æéåè§è²\n\n * detailsï¼å®éä¸æ¯ WebAuthenticationDetailsçå®ä¾ãå¯ä»¥è·åremoteAddress(å®¢æ·ç«¯ ip)å sessionId(å½å sessionId)\n\n# æ°å»ºdemo.html\n\nå¨é¡¹ç® resources ä¸­æ°å»º templates æä»¶å¤¹ï¼å¨ templates ä¸­æ°å»ºdemo.html é¡µé¢\n\n<!DOCTYPE html>\n<html xmlns="http://www.w3.org/1999/xhtml"\n      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">\n<head>\n    <meta charset="UTF-8">\n    <title>Title</title>\n</head>\n<body>\n    ç»å½è´¦å·:<span sec:authentication="name"></span><br/>\n    ç»å½è´¦å·:<span sec:authentication="principal.username"></span><br/>\n    å­è¯ï¼<span sec:authentication="credentials"></span><br/>\n    æéåè§è²ï¼<span sec:authentication="authorities"></span><br/>\n    å®¢æ·ç«¯å°åï¼<span sec:authentication="details.remoteAddress"></span><br/>\n    sessionIdï¼<span sec:authentication="details.sessionId"></span><br/>\n</body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n# ç¼åController\n\nthymeleaf é¡µé¢éè¦æ§å¶è½¬åï¼å¨æ§å¶å¨ç±»ä¸­ç¼åä¸é¢æ¹æ³\n\n@RequestMapping("/demo")\npublic String demo(){\n   return "demo";\n}\n\n\n1\n2\n3\n4\n\n\n# æéå¤æ­\n\n# è®¾ç½®ç¨æ·è§è²åæé\n\nè®¾å®ç¨æ·å·æ adminï¼/insertï¼/delete æé ROLE_abc è§è²ã\n\nreturn new User(username,password, AuthorityUtils.commaSeparatedStringToAuthorityList("admin,ROLE_abc,/insert,/delete"));\n\n\n1\n\n\n# æ§å¶é¡µé¢æ¾ç¤ºææ\n\nå¨é¡µé¢ä¸­æ ¹æ®ç¨æ·æéåè§è²å¤æ­é¡µé¢ä¸­æ¾ç¤ºçåå®¹\n\néè¿æéå¤æ­ï¼\n<button sec:authorize="hasAuthority(\'/insert\')">æ°å¢</button>\n<button sec:authorize="hasAuthority(\'/delete\')">å é¤</button>\n<button sec:authorize="hasAuthority(\'/update\')">ä¿®æ¹</button>\n<button sec:authorize="hasAuthority(\'/select\')">æ¥ç</button>\n<br/>\néè¿è§è²å¤æ­ï¼\n<button sec:authorize="hasRole(\'abc\')">æ°å¢</button>\n<button sec:authorize="hasRole(\'abc\')">å é¤</button>\n<button sec:authorize="hasRole(\'abc\')">ä¿®æ¹</button>\n<button sec:authorize="hasRole(\'abc\')">æ¥ç</button>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# éåºç»å½\n\nç¨æ·åªéè¦å Spring Security é¡¹ç®ä¸­åé/logoutéåºè¯·æ±å³å¯ã\n\n# éåºç»å½\n\nå®ç°éåºéå¸¸ç®åï¼åªè¦å¨é¡µé¢ä¸­æ·»å /logout çè¶é¾æ¥å³å¯ã\n\n<a href="/logout">éåºç»å½</a>\n\n\n1\n\n\nä¸ºäºå®ç°æ´å¥½çææï¼éå¸¸æ·»å éåºçéç½®ãé»è®¤çéåº url ä¸º/logoutï¼éåºæååè·³è½¬å°/login?logout\n\n\n\nå¦æä¸å¸æä½¿ç¨é»è®¤å¼ï¼å¯ä»¥éè¿ä¸é¢çæ¹æ³è¿è¡ä¿®æ¹ã\n\nhttp.logout()\n      .logoutUrl("/logout")\n      .logoutSuccessUrl("/login.html");\n\n\n1\n2\n3\n\n\n# logoutå¶ä»å¸¸ç¨éç½®æºç è§£è¯»\n\n# addLogoutHandler(LogoutHandler)\n\né»è®¤æ¯ contextLogoutHandler\n\n\n\né»è®¤å®ä¾åå®¹\n\n\n\n# clearAuthentication(boolean)\n\næ¯å¦æ¸é¤è®¤è¯ç¶æï¼é»è®¤ä¸º true\n\n\n\n# invalidateHttpSession(boolean)\n\næ¯å¦éæ¯ HttpSession å¯¹è±¡ï¼é»è®¤ä¸º true\n\n\n\n# logoutSuccessHandler(LogoutSuccessHandler)\n\néåºæåå¤çå¨\n\n\n\nä¹å¯ä»¥èªå·±è¿è¡å®ä¹éåºæåå¤çå¨ãåªè¦å®ç°äºLogoutSuccessHandleræ¥å£ãä¸ä¹åè®²è§£çç»å½æåå¤çå¨åç»å½å¤±è´¥å¤çå¨æå¶ç±»ä¼¼ã\n\n\n# SpringSecurityä¸­çCSRF\n\nä»åå¼å§å­¦ä¹ Spring Securityæ¶ï¼å¨éç½®ç±»ä¸­ä¸ç´å­å¨è¿æ ·ä¸è¡ä»£ç ï¼http.csrf().disable();å¦ææ²¡æè¿è¡ä»£ç å¯¼è´ç¨æ·æ æ³è¢«è®¤è¯ãè¿è¡ä»£ç çå«ä¹æ¯ï¼å³é­ csrf é²æ¤ã\n\n# 1. ä»ä¹æ¯CSRF\n\nCSRFï¼Cross-site request forgeryï¼è·¨ç«è¯·æ±ä¼ªé ï¼ä¹è¢«ç§°ä¸ºâOneClick Attackâ æè Session Ridingãéè¿ä¼ªé ç¨æ·è¯·æ±è®¿é®åä¿¡ä»»ç«ç¹çéæ³è¯·æ±è®¿é®ã\n\nè·¨åï¼åªè¦ç½ç»åè®®ï¼ip å°åï¼ç«¯å£ä¸­ä»»ä½ä¸ä¸ªä¸ç¸åå°±æ¯è·¨åè¯·æ±ã\n\nå®¢æ·ç«¯ä¸æå¡è¿è¡äº¤äºæ¶ï¼ç±äº http åè®®æ¬èº«æ¯æ ç¶æåè®®ï¼æä»¥å¼å¥äºcookieè¿è¡è®°å½å®¢æ·ç«¯èº«ä»½ãå¨cookieä¸­ä¼å­æ¾session idç¨æ¥è¯å«å®¢æ·ç«¯èº«ä»½çãå¨è·¨åçæåµä¸ï¼session id å¯è½è¢«ç¬¬ä¸æ¹æ¶æå«æï¼éè¿è¿ä¸ª session id åæå¡ç«¯åèµ·è¯·æ±æ¶ï¼æå¡ç«¯ä¼è®¤ä¸ºè¿ä¸ªè¯·æ±æ¯åæ³çï¼å¯è½åçå¾å¤ææ³ä¸å°çäºæã\n\n# 2. Spring Securityä¸­çCSRF\n\nä» Spring Security4å¼å§CSRFé²æ¤é»è®¤å¼å¯ãé»è®¤ä¼æ¦æªè¯·æ±ï¼è¿è¡CSRFå¤çãCSRFä¸ºäºä¿è¯ä¸æ¯å¶ä»ç¬¬ä¸æ¹ç½ç«è®¿é®ï¼è¦æ±è®¿é®æ¶æºå¸¦åæ°åä¸º_csrfå¼ä¸ºtoken(token å¨æå¡ç«¯äº§ç)çåå®¹ï¼å¦ætokenåæå¡ç«¯çtokenå¹éæåï¼åæ­£å¸¸è®¿é®ã\n\n# 2.1ãç¼åæ§å¶å¨æ¹æ³\n\nç¼åæ§å¶å¨æ¹æ³ï¼è·³è½¬å° templates ä¸­ login.html é¡µé¢ã\n\n@RequestMapping("/showLogin")\npublic String showLogin(){\n   return "login";\n}\n\n\n1\n2\n3\n4\n\n\n# 2.2ãæ°å»ºlogin.html\n\nçº¢è²é¨åæ¯å¿é¡»å­å¨çå¦åæ æ³æ­£å¸¸ç»å½ã\n\n<!DOCTYPE html>\n<html xmlns="http://www.w3.org/1999/xhtml"\n      xmlns:th="http://www.thymeleaf.org"\n>\n<head>\n    <meta charset="UTF-8">\n    <title>Title</title>\n</head>\n<body>\n<form action="/login" method="post">\n    <input type="hidden" th:value="${_csrf.token}" name="_csrf" th:if="${_csrf}"/>\n    ç¨æ·åï¼<input type="text" name="username" /><br/>\n    å¯ç ï¼<input type="password" name="password" /><br/>\n    <input type="submit" value="ç»å½" />\n</form>\n</body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n# ä¿®æ¹éç½®ç±»\n\nå¨éç½®ç±»ä¸­æ³¨éæ CSRF é²æ¤å¤±æ\n\n// å³é­csrfé²æ¤\n// http.csrf().disable();\n\n\n1\n2\n\n\n\n# Oauth2è®¤è¯\n\n\n# Oauth2ç®ä»\n\n# ç®ä»\n\nç¬¬ä¸æ¹è®¤è¯ææ¯æ¹æ¡æä¸»è¦æ¯è§£å³è®¤è¯åè®®çéç¨æ åé®é¢ï¼å ä¸ºè¦å®ç°è·¨ç³»ç»è®¤è¯ï¼åç³»ç»ä¹é´è¦éµå¾ªä¸å®çæ¥å£åè®®ã\n\nOAUTHåè®®ä¸ºç¨æ·èµæºçæææä¾äºä¸ä¸ªå®å¨çãå¼æ¾èåç®æçæ åãåæ¶ï¼ä»»ä½ç¬¬ä¸æ¹é½å¯ä»¥ä½¿ç¨OAUTHè®¤è¯æå¡ï¼ä»»ä½æå¡æä¾åé½å¯ä»¥å®ç°èªèº«çOAUTHè®¤è¯æå¡ï¼å èOAUTHæ¯å¼æ¾çãä¸çæä¾äºOAUTHçå¤ç§å®ç°å¦PHPãJavaScriptï¼Javaï¼Rubyç­åç§è¯­è¨å¼ååï¼å¤§å¤§èçº¦äºç¨åºåçæ¶é´ï¼å èOAUTHæ¯ç®æçãäºèç½å¾å¤æå¡å¦Open APIï¼å¾å¤å¤§å¬å¸å¦Googleï¼Yahooï¼Microsoftç­é½æä¾äºOAUTHè®¤è¯æå¡ï¼è¿äºé½è¶³ä»¥è¯´æOAUTHæ åéæ¸æä¸ºå¼æ¾èµæºææçæ åã\n\nOauthåè®®ç®ååå±å°2.0çæ¬ï¼1.0çæ¬è¿äºå¤æï¼2.0çæ¬å·²å¾å°å¹¿æ³åºç¨ã\n\nä¸è¾¹åæä¸ä¸ªOauth2è®¤è¯çä¾å­ï¼ç½ç«ä½¿ç¨å¾®ä¿¡è®¤è¯çè¿ç¨ï¼\n\n\n\n 1. ç¨æ·è¿å¥ç½ç«çç»å½é¡µé¢ï¼ç¹å»å¾®ä¿¡çå¾æ ä»¥å¾®ä¿¡è´¦å·ç»å½ç³»ç»ï¼ç¨æ·æ¯èªå·±å¨å¾®ä¿¡éä¿¡æ¯çèµæºæ¥æèã\n\n\n\nç¹å»âå¾®ä¿¡âåºç°ä¸ä¸ªäºç»´ç ï¼æ­¤æ¶ç¨æ·æ«æäºç»´ç ï¼å¼å§ç»ç½ç«ææã\n\n\n\n * èµæºæ¥æèåæç»å®¢æ·ç«¯ææ\n   \n   > èµæºæ¥æèæ«æäºç»´ç è¡¨ç¤ºèµæºæ¥æèåæç»å®¢æ·ç«¯ææï¼å¾®ä¿¡ä¼å¯¹èµæºæ¥æèçèº«ä»½è¿è¡éªè¯ï¼éªè¯éè¿åï¼å¾®ä¿¡ä¼è¯¢é®ç¨æ·æ¯å¦ç»ææç½ç«è®¿é®èªå·±çå¾®ä¿¡æ°æ®ï¼ç¨æ·ç¹å»âç¡®è®¤ç»å½âè¡¨ç¤ºåæææï¼å¾®ä¿¡è®¤è¯æå¡å¨ä¼é¢åä¸ä¸ªææç ï¼å¹¶éå®åå°ç½ç«ã\n\n * å®¢æ·ç«¯è·åå°ææç ï¼è¯·æ±è®¤è¯æå¡å¨ç³è¯·ä»¤ç\n   \n   > æ­¤è¿ç¨ç¨æ·çä¸å°ï¼å®¢æ·ç«¯åºç¨ç¨åºè¯·æ±è®¤è¯æå¡å¨ï¼è¯·æ±æºå¸¦ææç ã\n\n * è®¤è¯æå¡å¨åå®¢æ·ç«¯ååºä»¤ç\n   \n   > è®¤è¯æå¡å¨éªè¯äºå®¢æ·ç«¯è¯·æ±çææç ï¼å¦æåæ³åç»å®¢æ·ç«¯é¢åä»¤çï¼ä»¤çæ¯å®¢æ·ç«¯è®¿é®èµæºçéè¡è¯ãæ­¤äº¤äºè¿ç¨ç¨æ·çä¸å°ï¼å½å®¢æ·ç«¯æ¿å°ä»¤çåï¼ç¨æ·å¨ç½ç«çå°å·²ç»ç»å½æåã\n\n * å®¢æ·ç«¯è¯·æ±èµæºæå¡å¨çèµæº\n   \n   > å®¢æ·ç«¯æºå¸¦ä»¤çè®¿é®èµæºæå¡å¨çèµæºãç½ç«æºå¸¦ä»¤çè¯·æ±è®¿é®å¾®ä¿¡æå¡å¨è·åç¨æ·çåºæ¬ä¿¡æ¯ã\n\n * èµæºæå¡å¨è¿ååä¿æ¤èµæº\n   \n   > èµæºæå¡å¨æ ¡éªä»¤ççåæ³æ§ï¼å¦æåæ³ååç¨æ·ååºèµæºä¿¡æ¯åå®¹ã\n\næ³¨æï¼èµæºæå¡å¨åè®¤è¯æå¡å¨å¯ä»¥æ¯ä¸ä¸ªæå¡ä¹å¯ä»¥åå¼çæå¡ï¼å¦ææ¯åå¼çæå¡èµæºæå¡å¨éå¸¸è¦è¯·æ±è®¤è¯æå¡å¨æ¥æ ¡éªä»¤ççåæ³æ§ã\n\nOauth2.0è®¤è¯æµç¨å¦ä¸ï¼\n\nå¼èªOauth2.0åè®®rfc6749 https://tools.ietf.org/html/rfc6749\n\n\n\n# è§è²\n\nå®¢æ·ç«¯\n\næ¬èº«ä¸å­å¨èµæºï¼éè¦éè¿èµæºæ¥æèçææå»è¯·æ±èµæºæå¡å¨çèµæºï¼æ¯å¦ï¼Androidå®¢æ·ç«¯ãWebå®¢æ·ç«¯ï¼æµè§å¨ç«¯ï¼ãå¾®ä¿¡å®¢æ·ç«¯ç­ã\n\nèµæºæ¥æè\n\néå¸¸ä¸ºç¨æ·ï¼ä¹å¯ä»¥æ¯åºç¨ç¨åºï¼å³è¯¥èµæºçæ¥æèã\n\næææå¡å¨ï¼ä¹ç§°è®¤è¯æå¡å¨ï¼\n\nç¨æ¥å¯¹èµæºæ¥æèçèº«ä»½è¿è¡è®¤è¯ãå¯¹è®¿é®èµæºè¿è¡ææãå®¢æ·ç«¯è¦æ³è®¿é®èµæºéè¦éè¿è®¤è¯æå¡å¨ç±èµæºæ¥æèææåæ¹å¯è®¿é®ã\n\nèµæºæå¡å¨\n\nå­å¨èµæºçæå¡å¨ï¼æ¯å¦ï¼ç½ç«ç¨æ·ç®¡çæå¡å¨å­å¨äºç½ç«ç¨æ·ä¿¡æ¯ï¼ç½ç«ç¸åæå¡å¨å­å¨äºç¨æ·çç¸åä¿¡æ¯ï¼å¾®ä¿¡çèµæºæå¡å­å¨äºå¾®ä¿¡çç¨æ·ä¿¡æ¯ç­ãå®¢æ·ç«¯æç»è®¿é®èµæºæå¡å¨è·åèµæºä¿¡æ¯ã\n\n# å¸¸ç¨æ¯è¯­\n\n * å®¢æ·å­è¯(client Credentials)ï¼å®¢æ·ç«¯çclientIdåå¯ç ç¨äºè®¤è¯å®¢æ·\n\n * ä»¤ç(tokens)ï¼æææå¡å¨å¨æ¥æ¶å°å®¢æ·è¯·æ±åï¼é¢åçè®¿é®ä»¤ç\n\n * ä½ç¨å(scopes)ï¼å®¢æ·è¯·æ±è®¿é®ä»¤çæ¶ï¼ç±èµæºæ¥æèé¢å¤æå®çç»åæé(permission)\n\n# ä»¤çç±»å\n\n * ææç ï¼ä»ç¨äºææç ææç±»åï¼ç¨äºäº¤æ¢è·åè®¿é®ä»¤çåå·æ°ä»¤ç\n\n * è®¿é®ä»¤çï¼ç¨äºä»£è¡¨ä¸ä¸ªç¨æ·ææå¡ç´æ¥å»è®¿é®åä¿æ¤çèµæº\n\n * å·æ°ä»¤çï¼ç¨äºå»æææå¡å¨è·åä¸ä¸ªå·æ°è®¿é®ä»¤ç\n\n * BearerTokenï¼ä¸ç®¡è°æ¿å°Tokené½å¯ä»¥è®¿é®èµæºï¼ç±»ä¼¼ç°é\n\n * Proof of Possession(PoP) Tokenï¼å¯ä»¥æ ¡éªclientæ¯å¦å¯¹Tokenææç¡®çæ¥ææ\n\n# ç¹ç¹\n\nä¼ç¹ï¼\n\n * æ´å®å¨ï¼å®¢æ·ç«¯ä¸æ¥è§¦ç¨æ·å¯ç ï¼æå¡å¨ç«¯æ´æéä¸­ä¿æ¤\n * å¹¿æ³ä¼ æ­å¹¶è¢«æç»­éç¨\n * ç­å¯¿å½åå°è£çtoken\n * èµæºæå¡å¨åæææå¡å¨è§£è¦\n * éä¸­å¼ææï¼ç®åå®¢æ·ç«¯\n * HTTP/JSONåå¥½ï¼æäºè¯·æ±åä¼ étoken\n * èèå¤ç§å®¢æ·ç«¯æ¶æåºæ¯\n * å®¢æ·å¯ä»¥å·æä¸åçä¿¡ä»»çº§å«\n\nç¼ºç¹ï¼\n\n * åè®®æ¡æ¶å¤ªå®½æ³ï¼é æåç§å®ç°çå¼å®¹æ§åäºæä½æ§å·®\n * ä¸æ¯ä¸ä¸ªè®¤è¯åè®®ï¼æ¬èº«å¹¶ä¸è½åè¯ä½ ä»»ä½ç¨æ·ä¿¡æ¯ã\n\n\n# æææ¨¡å¼\n\n# ææç æ¨¡å¼ï¼Authorization Codeï¼\n\n\n\n# ç®åæææ¨¡å¼ï¼Implicitï¼\n\n\n\n# å¯ç æ¨¡å¼ï¼Resource Owner PasswordCredentialsï¼\n\n\n\n# å®¢æ·ç«¯æ¨¡å¼ï¼Client Credentialsï¼\n\n\n\n# å·æ°ä»¤ç\n\n\n\n\n# Spring Security Oauth2\n\n\n# æææå¡å¨ï¼çæï¼\n\n\n\n * Authorize Endpointï¼ææç«¯ç¹ï¼è¿è¡ææ\n\n * Token Endpointï¼ä»¤çç«¯ç¹ï¼ç»è¿æææ¿å°å¯¹åºçToken\n\n * Introspection Endpointï¼æ ¡éªç«¯ç¹ï¼æ ¡éªTokençåæ³æ§\n\n * Revocation Endpointï¼æ¤éç«¯ç¹ï¼æ¤éææ\n\n\n# Spring Security Oauth2æ¶æï¼çæï¼\n\n\n\næµç¨ï¼\n\n 1. ç¨æ·è®¿é®ï¼æ­¤æ¶æ²¡æTokenãOauth2RestTemplateä¼æ¥éï¼è¿ä¸ªæ¥éä¿¡æ¯ä¼è¢«Oauth2ClientContextFilteræè·å¹¶éå®åå°è®¤è¯æå¡å¨\n 2. è®¤è¯æå¡å¨éè¿Authorization Endpointè¿è¡ææï¼å¹¶éè¿AuthorizationServerTokenServicesçæææç å¹¶è¿åç»å®¢æ·ç«¯\n 3. å®¢æ·ç«¯æ¿å°ææç å»è®¤è¯æå¡å¨éè¿Token Endpointè°ç¨AuthorizationServerTokenServicesçæTokenå¹¶è¿åç»å®¢æ·ç«¯\n 4. å®¢æ·ç«¯æ¿å°Tokenå»èµæºæå¡å¨è®¿é®èµæºï¼ä¸è¬ä¼éè¿Oauth2AuthenticationManagerè°ç¨ResourceServerTokenServicesè¿è¡æ ¡éªãæ ¡éªéè¿å¯ä»¥è·åèµæºã\n\n\n# Spring Security Oauth2ææç æ¨¡å¼\n\n# 1. åå»ºé¡¹ç®\n\n\n\n\n\n\n\n\n\n# 2ãæ·»å ä¾èµ\n\n<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">\n   <modelVersion>4.0.0</modelVersion>\n   <parent>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-starter-parent</artifactId>\n      <version>2.2.2.RELEASE</version>\n      <relativePath/> \x3c!-- lookup parent from repository --\x3e\n   </parent>\n  \n   <groupId>com.yjxxt</groupId>\n   <artifactId>springsecurityoauth2demo</artifactId>\n   <version>0.0.1-SNAPSHOT</version>\n  \n   <name>springsecurityoauth2demo</name>\n   <description>Demo project for Spring Boot</description>\n\n   <properties>\n      <java.version>1.8</java.version>\n      <spring-cloud.version>Greenwich.SR2</spring-cloud.version>\n   </properties>\n\n   <dependencies>\n      <dependency>\n         <groupId>org.springframework.cloud</groupId>\n         <artifactId>spring-cloud-starter-oauth2</artifactId>\n      </dependency>\n      <dependency>\n         <groupId>org.springframework.cloud</groupId>\n         <artifactId>spring-cloud-starter-security</artifactId>\n      </dependency>\n      <dependency>\n         <groupId>org.springframework.boot</groupId>\n         <artifactId>spring-boot-starter-web</artifactId>\n      </dependency>\n      <dependency>\n         <groupId>org.springframework.boot</groupId>\n         <artifactId>spring-boot-starter-test</artifactId>\n         <scope>test</scope>\n      </dependency>\n   </dependencies>\n\n   <dependencyManagement>\n      <dependencies>\n         <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-dependencies</artifactId>\n            <version>${spring-cloud.version}</version>\n            <type>pom</type>\n            <scope>import</scope>\n         </dependency>\n      </dependencies>\n   </dependencyManagement>\n\n   <build>\n      <plugins>\n         <plugin>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-maven-plugin</artifactId>\n         </plugin>\n      </plugins>\n   </build>\n\n</project>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n\n\n# 3ãç¼åå®ä½ç±»\n\nUser.java\n\npackage com.yjxxt.springsecurityoauth2demo.pojo;\n\nimport org.springframework.security.core.GrantedAuthority;\nimport org.springframework.security.core.userdetails.UserDetails;\n\nimport java.util.Collection;\nimport java.util.List;\n\n/**\n * ç¨æ·ç±»\n */\npublic class User implements UserDetails {\n\n    private String username;\n    private String password;\n    private List<GrantedAuthority> authorities;\n\n    public User(String username, String password, List<GrantedAuthority> authorities) {\n        this.username = username;\n        this.password = password;\n        this.authorities = authorities;\n    }\n\n    @Override\n    public Collection<? extends GrantedAuthority> getAuthorities() {\n        return authorities;\n    }\n\n    @Override\n    public String getPassword() {\n        return password;\n    }\n\n    @Override\n    public String getUsername() {\n        return username;\n    }\n\n    @Override\n    public boolean isAccountNonExpired() {\n        return true;\n    }\n\n    @Override\n    public boolean isAccountNonLocked() {\n        return true;\n    }\n\n    @Override\n    public boolean isCredentialsNonExpired() {\n        return true;\n    }\n\n    @Override\n    public boolean isEnabled() {\n        return true;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n\n\n# 4ãç¼åService\n\nUserService.java\n\npackage com.yjxxt.springsecurityoauth2demo.service;\n\nimport com.yjxxt.springsecurityoauth2demo.pojo.User;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.security.core.authority.AuthorityUtils;\nimport org.springframework.security.core.userdetails.UserDetails;\nimport org.springframework.security.core.userdetails.UserDetailsService;\nimport org.springframework.security.core.userdetails.UsernameNotFoundException;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.stereotype.Service;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@Service\npublic class UserService implements UserDetailsService {\n\n   @Autowired\n   private PasswordEncoder passwordEncoder;\n\n   @Override\n   public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n      String password = passwordEncoder.encode("123456");\n      return new User("admin",password, AuthorityUtils.commaSeparatedStringToAuthorityList("admin"));\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n\n\n# 5ãç¼åController\n\nUserController.java\n\npackage com.yjxxt.springsecurityoauth2demo.controller;\n\nimport org.springframework.security.core.Authentication;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@RestController\n@RequestMapping("/user")\npublic class UserController {\n\n   @GetMapping("/getCurrentUser")\n   public Object getCurrentUser(Authentication authentication) {\n      return authentication.getPrincipal();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n# 6ãç¼åéç½®ç±»\n\nSecurityConfig.java\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\nimport org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\nimport org.springframework.security.crypto.password.PasswordEncoder;\n\n/**\n * Spring Security éç½®ç±»\n *\n * @author zhoubin\n */\n@Configuration\n@EnableWebSecurity\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n\n   @Bean\n   public PasswordEncoder passwordEncoder() {\n      return new BCryptPasswordEncoder();\n   }\n\n\n   @Override\n   public void configure(HttpSecurity http) throws Exception {\n      http.csrf()\n            .disable()\n            .authorizeRequests()\n            .antMatchers("/oauth/**", "/login/**", "/logout/**")\n            .permitAll()\n            .anyRequest()\n            .authenticated()\n            .and()\n            .formLogin()\n            .permitAll();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n\n\nAuthorizationServerConfig.java\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.security.oauth2.config.annotation.configurers.ClientDetailsServiceConfigurer;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.AuthorizationServerConfigurerAdapter;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.EnableAuthorizationServer;\n\n/**\n * æææå¡å¨éç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@Configuration\n@EnableAuthorizationServer\npublic class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter {\n\n    @Autowired\n    private PasswordEncoder passwordEncoder;\n\n\n    @Override\n    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {\n        clients.inMemory()\n                //éç½®client_id\n                .withClient("admin")\n                //éç½®client-secret\n                .secret(passwordEncoder.encode("112233"))\n                //éç½®redirect_uriï¼ç¨äºæææååè·³è½¬\n                .redirectUris("http://www.baidu.com")\n                //éç½®ç³è¯·çæéèå´\n                .scopes("all")\n                //éç½®grant_typeï¼è¡¨ç¤ºææç±»å\n                .authorizedGrantTypes("authorization_code");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n\n\nResourceServerConfig.java\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfigurerAdapter;\n\n/**\n * èµæºæå¡å¨éç½®\n *\n * @author zhoubin\n * @since 1.0.0\n */\n@Configuration\n@EnableResourceServer\npublic class ResourceServerConfig extends ResourceServerConfigurerAdapter {\n\n    @Override\n    public void configure(HttpSecurity http) throws Exception {\n        http.authorizeRequests()\n                .anyRequest()\n                .authenticated()\n                .and()\n                .requestMatchers()\n                .antMatchers("/user/**");//éç½®éè¦ä¿æ¤çèµæºè·¯å¾\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n\n\n# 7ãæµè¯\n\n# è·åææç \n\nhttp://localhost:8080/oauth/authorize?response_type=code&client_id=admin&redirect_uri=http://www.baidu.com&scope=all\n\n\n\nè¾å¥è´¦æ·å¯ç \n\n\n\nç¹å»ææè·åææç \n\n\n\n# æ ¹æ®ææç è·åä»¤çï¼POSTè¯·æ±ï¼\n\n\n\n\n\n * grant_typeï¼ææç±»åï¼å¡«åauthorization_codeï¼è¡¨ç¤ºææç æ¨¡å¼\n\n * codeï¼ææç ï¼å°±æ¯ååè·åçææç ï¼æ³¨æï¼ææç åªä½¿ç¨ä¸æ¬¡å°±æ æäºï¼éè¦éæ°ç³è¯·ã\n\n * client_id:å®¢æ·ç«¯æ è¯\n\n * redirect_uriï¼ç³è¯·ææç æ¶çè·³è½¬urlï¼ä¸å®åç³è¯·ææç æ¶ç¨çredirect_uriä¸è´ã\n\n * scope:ææèå´ã\n\nè®¤è¯å¤±è´¥æå¡ç«¯è¿å 401 Unauthorized\n\næ³¨æï¼æ­¤æ¶æ æ³è¯·æ±å°ä»¤çï¼è®¿é®æå¡å¨ä¼æ¥é\n\n\n\n# æ ¹æ®tokenå»èµæºæå¡å¨æ¿èµæº\n\n\n\nå¦æä¿®æ¹tokenå°±ä¼æ¥é\n\n\n\n\n# Spring Security Oauth2 å¯ç æ¨¡å¼\n\nå¨ä¸é¢çä»£ç ä¸­è¿è¡éå½çä¿®æ¹å³å¯\n\nSecurityConfig.java\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.authentication.AuthenticationManager;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\nimport org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\nimport org.springframework.security.crypto.password.PasswordEncoder;\n\n/**\n * Spring Security éç½®ç±»\n *\n * @author zhoubin\n */\n@Configuration\n@EnableWebSecurity\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n\n   @Bean\n   public PasswordEncoder passwordEncoder() {\n      return new BCryptPasswordEncoder();\n   }\n\n   /**\n     * ä½¿ç¨å¯ç æ¨¡å¼éè¦éç½®\n     */\n   @Bean\n   @Override\n   public AuthenticationManager authenticationManagerBean() throws Exception {\n      return super.authenticationManagerBean();\n   }\n\n   @Override\n   public void configure(HttpSecurity http) throws Exception {\n      http.csrf()\n            .disable()\n            .authorizeRequests()\n            .antMatchers("/oauth/**", "/login/**", "/logout/**")\n            .permitAll()\n            .anyRequest()\n            .authenticated()\n            .and()\n            .formLogin()\n            .permitAll();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n\n\nAuthorizationServerConfig.java\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport com.yjxxt.springsecurityoauth2demo.service.UserService;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.authentication.AuthenticationManager;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.security.oauth2.config.annotation.configurers.ClientDetailsServiceConfigurer;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.AuthorizationServerConfigurerAdapter;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.EnableAuthorizationServer;\nimport org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerEndpointsConfigurer;\n\n/**\n * æææå¡å¨éç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@Configuration\n@EnableAuthorizationServer\npublic class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter {\n\n    @Autowired\n    private PasswordEncoder passwordEncoder;\n\n    @Autowired\n    private AuthenticationManager authenticationManager;\n\n    @Autowired\n    private UserService userService;\n\n    /**\n     * ä½¿ç¨å¯ç æ¨¡å¼éè¦éç½®\n     */\n    @Override\n    public void configure(AuthorizationServerEndpointsConfigurer endpoints) {\n        endpoints.authenticationManager(authenticationManager)\n                .userDetailsService(userService);\n    }\n\n    @Override\n    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {\n        clients.inMemory()\n                //éç½®client_id\n                .withClient("admin")\n                //éç½®client-secret\n                .secret(passwordEncoder.encode("112233"))\n                //éç½®è®¿é®tokençæææ\n                .accessTokenValiditySeconds(3600)\n                //éç½®å·æ°tokençæææ\n                .refreshTokenValiditySeconds(864000)\n                //éç½®redirect_uriï¼ç¨äºæææååè·³è½¬\n                .redirectUris("http://www.baidu.com")\n                //éç½®ç³è¯·çæéèå´\n                .scopes("all")\n                //éç½®grant_typeï¼è¡¨ç¤ºææç±»å\n                .authorizedGrantTypes("authorization_code","password");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n\n\næµè¯ï¼\n\n\n\n\n\n\n# å¨Redisä¸­å­å¨token\n\nä¹åçä»£ç æä»¬å°tokenç´æ¥å­å¨åå­ä¸­ï¼è¿å¨çäº§ç¯å¢ä¸­æ¯ä¸åççï¼ä¸é¢æä»¬å°å¶æ¹é æå­å¨å¨Redisä¸­\n\n# æ·»å ä¾èµåéç½®\n\npom.xml\n\n\x3c!--redis ä¾èµ--\x3e\n<dependency>\n   <groupId>org.springframework.boot</groupId>\n   <artifactId>spring-boot-starter-data-redis</artifactId>\n</dependency>\n\x3c!-- commons-pool2 å¯¹è±¡æ± ä¾èµ --\x3e\n<dependency>\n   <groupId>org.apache.commons</groupId>\n   <artifactId>commons-pool2</artifactId>\n</dependency>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\napplication.properties\n\n# Rediséç½®\nspring.redis.host=192.168.10.100\n\n\n1\n2\n\n\n# ç¼åRediséç½®ç±»\n\nRedisConfig.java\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.data.redis.connection.RedisConnectionFactory;\nimport org.springframework.security.oauth2.provider.token.TokenStore;\nimport org.springframework.security.oauth2.provider.token.store.redis.RedisTokenStore;\n\n/**\n * ä½¿ç¨rediså­å¨tokençéç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@Configuration\npublic class RedisConfig {\n   @Autowired\n   private RedisConnectionFactory redisConnectionFactory;\n\n   @Bean\n   public TokenStore redisTokenStore(){\n      return new RedisTokenStore(redisConnectionFactory);\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\n# å¨è®¤è¯æå¡å¨éç½®ä¸­æå®ä»¤ççå­å¨ç­ç¥ä¸ºRedis\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport com.yjxxt.springsecurityoauth2demo.service.UserService;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.authentication.AuthenticationManager;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.security.oauth2.config.annotation.configurers.ClientDetailsServiceConfigurer;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.AuthorizationServerConfigurerAdapter;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.EnableAuthorizationServer;\nimport org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerEndpointsConfigurer;\nimport org.springframework.security.oauth2.provider.token.TokenStore;\n\n/**\n * æææå¡å¨éç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@Configuration\n@EnableAuthorizationServer\npublic class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter {\n\n    @Autowired\n    private PasswordEncoder passwordEncoder;\n\n    @Autowired\n    private AuthenticationManager authenticationManager;\n\n    @Autowired\n    private UserService userService;\n\n    @Autowired\n    @Qualifier("redisTokenStore")\n    private TokenStore tokenStore;\n\n    /**\n     * ä½¿ç¨å¯ç æ¨¡å¼éè¦éç½®\n     */\n    @Override\n    public void configure(AuthorizationServerEndpointsConfigurer endpoints) {\n        endpoints.authenticationManager(authenticationManager)\n                .userDetailsService(userService)\n                .tokenStore(tokenStore);\n    }\n\n    @Override\n    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {\n        clients.inMemory()\n                //éç½®client_id\n                .withClient("admin")\n                //éç½®client-secret\n                .secret(passwordEncoder.encode("112233"))\n                //éç½®è®¿é®tokençæææ\n                .accessTokenValiditySeconds(3600)\n                //éç½®å·æ°tokençæææ\n                .refreshTokenValiditySeconds(864000)\n                //éç½®redirect_uriï¼ç¨äºæææååè·³è½¬\n                .redirectUris("http://www.baidu.com")\n                //éç½®ç³è¯·çæéèå´\n                .scopes("all")\n                //éç½®grant_typeï¼è¡¨ç¤ºææç±»å\n                .authorizedGrantTypes("password");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n\n\næµè¯ï¼\n\nä½¿ç¨å¯ç æ¨¡å¼è¯·æ±token\n\n\n\n\n\n\n# JWT\n\n\n# å¸¸è§çè®¤è¯æºå¶\n\n# HTTP Basic Auth\n\nHTTP Basic Authç®åç¹è¯´æå°±æ¯æ¯æ¬¡è¯·æ±APIæ¶é½æä¾ç¨æ·çusernameåpasswordï¼ç®è¨ä¹ï¼Basic Authæ¯éåRESTful API ä½¿ç¨çæç®åçè®¤è¯æ¹å¼ï¼åªéæä¾ç¨æ·åå¯ç å³å¯ï¼ä½ç±äºææç¨æ·åå¯ç æ´é²ç»ç¬¬ä¸æ¹å®¢æ·ç«¯çé£é©ï¼å¨çäº§ç¯å¢ä¸è¢«ä½¿ç¨çè¶æ¥è¶å°ãå æ­¤ï¼å¨å¼åå¯¹å¤å¼æ¾çRESTful APIæ¶ï¼å°½éé¿åéç¨HTTP Basic Authã\n\n# Cookie Auth\n\nCookieè®¤è¯æºå¶å°±æ¯ä¸ºä¸æ¬¡è¯·æ±è®¤è¯å¨æå¡ç«¯åå»ºä¸ä¸ªSessionå¯¹è±¡ï¼åæ¶å¨å®¢æ·ç«¯çæµè§å¨ç«¯åå»ºäºä¸ä¸ªCookieå¯¹è±¡ï¼éè¿å®¢æ·ç«¯å¸¦ä¸æ¥Cookieå¯¹è±¡æ¥ä¸æå¡å¨ç«¯çsessionå¯¹è±¡å¹éæ¥å®ç°ç¶æç®¡ççãé»è®¤çï¼å½æä»¬å³é­æµè§å¨çæ¶åï¼cookieä¼è¢«å é¤ãä½å¯ä»¥éè¿ä¿®æ¹cookie çexpire timeä½¿cookieå¨ä¸å®æ¶é´åææã\n\n\n\n# OAuth\n\nOAuthï¼å¼æ¾ææ,Open Authorizationï¼æ¯ä¸ä¸ªå¼æ¾çæææ åï¼åè®¸ç¨æ·è®©ç¬¬ä¸æ¹åºç¨è®¿é®è¯¥ç¨æ·å¨æä¸webæå¡ä¸å­å¨çç§å¯çèµæºï¼å¦ç§çï¼è§é¢ï¼èç³»äººåè¡¨ï¼ï¼èæ éå°ç¨æ·ååå¯ç æä¾ç»ç¬¬ä¸æ¹åºç¨ãå¦ç½ç«éè¿å¾®ä¿¡ãå¾®åç»å½ç­ï¼ä¸»è¦ç¨äºç¬¬ä¸æ¹ç»å½ã\n\nOAuthåè®¸ç¨æ·æä¾ä¸ä¸ªä»¤çï¼èä¸æ¯ç¨æ·ååå¯ç æ¥è®¿é®ä»ä»¬å­æ¾å¨ç¹å®æå¡æä¾èçæ°æ®ãæ¯ä¸ä¸ªä»¤çææä¸ä¸ªç¹å®çç¬¬ä¸æ¹ç³»ç»ï¼ä¾å¦ï¼è§é¢ç¼è¾ç½ç«)å¨ç¹å®çæ¶æ®µï¼ä¾å¦ï¼æ¥ä¸æ¥ç2å°æ¶åï¼åè®¿é®ç¹å®çèµæºï¼ä¾å¦ä»ä»æ¯æä¸ç¸åä¸­çè§é¢ï¼ãè¿æ ·ï¼OAuthè®©ç¨æ·å¯ä»¥ææç¬¬ä¸æ¹ç½ç«è®¿é®ä»ä»¬å­å¨å¨å¦å¤æå¡æä¾èçæäºç¹å®ä¿¡æ¯ï¼èéææåå®¹ã\n\nä¸é¢æ¯OAuth2.0çæµç¨ï¼\n\n\n\nè¿ç§åºäºOAuthçè®¤è¯æºå¶éç¨äºä¸ªäººæ¶è´¹èç±»çäºèç½äº§åï¼å¦ç¤¾äº¤ç±»APPç­åºç¨ï¼ä½æ¯ä¸å¤ªéåæ¥æèªæè®¤è¯æéç®¡ççä¼ä¸åºç¨ã\n\nç¼ºç¹ï¼è¿éã\n\n# Token Auth\n\nä½¿ç¨åºäº Token çèº«ä»½éªè¯æ¹æ³ï¼å¨æå¡ç«¯ä¸éè¦å­å¨ç¨æ·çç»å½è®°å½ãå¤§æ¦çæµç¨æ¯è¿æ ·çï¼\n\n 1. å®¢æ·ç«¯ä½¿ç¨ç¨æ·åè·å¯ç è¯·æ±ç»å½\n 2. æå¡ç«¯æ¶å°è¯·æ±ï¼å»éªè¯ç¨æ·åä¸å¯ç \n 3. éªè¯æååï¼æå¡ç«¯ä¼ç­¾åä¸ä¸ª Tokenï¼åæè¿ä¸ª Token åéç»å®¢æ·ç«¯\n 4. å®¢æ·ç«¯æ¶å° Token ä»¥åå¯ä»¥æå®å­å¨èµ·æ¥ï¼æ¯å¦æ¾å¨ Cookie é\n 5. å®¢æ·ç«¯æ¯æ¬¡åæå¡ç«¯è¯·æ±èµæºçæ¶åéè¦å¸¦çæå¡ç«¯ç­¾åç Token\n 6. æå¡ç«¯æ¶å°è¯·æ±ï¼ç¶åå»éªè¯å®¢æ·ç«¯è¯·æ±éé¢å¸¦çç Tokenï¼å¦æéªè¯æåï¼å°±åå®¢æ·ç«¯è¿åè¯·æ±çæ°æ®\n\n\n\næ¯ç¬¬ä¸ç§æ¹å¼æ´å®å¨ï¼æ¯ç¬¬äºç§æ¹å¼æ´èçº¦æå¡å¨èµæºï¼æ¯ç¬¬ä¸ç§æ¹å¼æ´å è½»éã\n\nå·ä½ï¼Token Authçä¼ç¹ï¼Tokenæºå¶ç¸å¯¹äºCookieæºå¶åæä»ä¹å¥½å¤å¢ï¼ï¼ï¼\n\n * æ¯æè·¨åè®¿é®ï¼Cookieæ¯ä¸åè®¸å®åè®¿é®çï¼è¿ä¸ç¹å¯¹Tokenæºå¶æ¯ä¸å­å¨çï¼åææ¯ä¼ è¾çç¨æ·è®¤è¯ä¿¡æ¯éè¿HTTPå¤´ä¼ è¾.\n * æ ç¶æ(ä¹ç§°ï¼æå¡ç«¯å¯æ©å±è¡)ï¼Tokenæºå¶å¨æå¡ç«¯ä¸éè¦å­å¨sessionä¿¡æ¯ï¼å ä¸ºToken èªèº«åå«äºææç»å½ç¨æ·çä¿¡æ¯ï¼åªéè¦å¨å®¢æ·ç«¯çcookieææ¬å°ä»è´¨å­å¨ç¶æä¿¡æ¯.\n * æ´éç¨CDNï¼å¯ä»¥éè¿åå®¹ååç½ç»è¯·æ±ä½ æå¡ç«¯çææèµæï¼å¦ï¼javascriptï¼HTML,å¾çç­ï¼ï¼èä½ çæå¡ç«¯åªè¦æä¾APIå³å¯.\n * å»è¦ï¼ä¸éè¦ç»å®å°ä¸ä¸ªç¹å®çèº«ä»½éªè¯æ¹æ¡ãTokenå¯ä»¥å¨ä»»ä½å°æ¹çæï¼åªè¦å¨ä½ çAPIè¢«è°ç¨çæ¶åï¼ä½ å¯ä»¥è¿è¡Tokençæè°ç¨å³å¯.\n * æ´éç¨äºç§»å¨åºç¨ï¼å½ä½ çå®¢æ·ç«¯æ¯ä¸ä¸ªåçå¹³å°ï¼iOS, Androidï¼Windows 10ç­ï¼æ¶ï¼Cookieæ¯ä¸è¢«æ¯æçï¼ä½ éè¦éè¿Cookieå®¹å¨è¿è¡å¤çï¼ï¼è¿æ¶éç¨Tokenè®¤è¯æºå¶å°±ä¼ç®åå¾å¤ã\n * CSRFï¼å ä¸ºä¸åä¾èµäºCookieï¼æä»¥ä½ å°±ä¸éè¦èèå¯¹CSRFï¼è·¨ç«è¯·æ±ä¼ªé ï¼çé²èã\n * æ§è½ï¼ä¸æ¬¡ç½ç»å¾è¿æ¶é´ï¼éè¿æ°æ®åºæ¥è¯¢sessionä¿¡æ¯ï¼æ»æ¯åä¸æ¬¡HMACSHA256è®¡ç®çTokenéªè¯åè§£æè¦è´¹æ¶å¾å¤.\n * ä¸éè¦ä¸ºç»å½é¡µé¢åç¹æ®å¤çï¼å¦æä½ ä½¿ç¨Protractor ååè½æµè¯çæ¶åï¼ä¸åéè¦ä¸ºç»å½é¡µé¢åç¹æ®å¤ç.\n * åºäºæ ååï¼ä½ çAPIå¯ä»¥éç¨æ ååç JSON Web Token (JWT). è¿ä¸ªæ åå·²ç»å­å¨å¤ä¸ªåç«¯åºï¼.NET, Ruby, Java,Python, PHPï¼åå¤å®¶å¬å¸çæ¯æï¼å¦ï¼Firebase,Google, Microsoftï¼.\n\n\n# JWTç®ä»\n\n# ä»ä¹æ¯JWT\n\nJSON Web Tokenï¼JWTï¼æ¯ä¸ä¸ªå¼æ¾çè¡ä¸æ åï¼RFC 7519ï¼ï¼å®å®ä¹äºä¸ç§ç®ä»çãèªåå«çåè®®æ ¼å¼ï¼ç¨äºå¨éä¿¡åæ¹ä¼ éjsonå¯¹è±¡ï¼ä¼ éçä¿¡æ¯ç»è¿æ°å­ç­¾åå¯ä»¥è¢«éªè¯åä¿¡ä»»ãJWTå¯ä»¥ä½¿ç¨HMACç®æ³æä½¿ç¨RSAçå¬é¥/ç§é¥å¯¹æ¥ç­¾åï¼é²æ­¢è¢«ç¯¡æ¹ã\n\nå®ç½ï¼ https://jwt.io/\n\næ åï¼ https://tools.ietf.org/html/rfc7519\n\nJWTä»¤ççä¼ç¹ï¼\n\n * jwtåºäºjsonï¼éå¸¸æ¹ä¾¿è§£æã\n * å¯ä»¥å¨ä»¤çä¸­èªå®ä¹ä¸°å¯çåå®¹ï¼ææ©å±ã\n * éè¿éå¯¹ç§°å å¯ç®æ³åæ°å­ç­¾åææ¯ï¼JWTé²æ­¢ç¯¡æ¹ï¼å®å¨æ§é«ã\n * èµæºæå¡ä½¿ç¨JWTå¯ä¸ä¾èµè®¤è¯æå¡å³å¯å®æææã\n\nç¼ºç¹ï¼\n\n 1. JWTä»¤çè¾é¿ï¼å å­å¨ç©ºé´æ¯è¾å¤§ã\n\n# JWTç»æ\n\nä¸ä¸ªJWTå®éä¸å°±æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼å®ç±ä¸é¨åç»æï¼å¤´é¨ãè½½è·ä¸ç­¾åã\n\n# å¤´é¨(Header)\n\nå¤´é¨ç¨äºæè¿°å³äºè¯¥JWTçæåºæ¬çä¿¡æ¯ï¼ä¾å¦å¶ç±»åï¼å³JWTï¼ä»¥åç­¾åæç¨çç®æ³ï¼å¦HMAC SHA256æRSAï¼ç­ãè¿ä¹å¯ä»¥è¢«è¡¨ç¤ºæä¸ä¸ªJSONå¯¹è±¡ã\n\n{\n  "alg": "HS256",\n  "typ": "JWT"\n}\n\n\n1\n2\n3\n4\n\n * typï¼æ¯ç±»åã\n * algï¼ç­¾åçç®æ³ï¼è¿éä½¿ç¨çç®æ³æ¯HS256ç®æ³\n\næä»¬å¯¹å¤´é¨çjsonå­ç¬¦ä¸²è¿è¡BASE64ç¼ç ï¼ç½ä¸æå¾å¤å¨çº¿ç¼ç çç½ç«ï¼ï¼ç¼ç åçå­ç¬¦ä¸²å¦ä¸ï¼\n\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\n\n\n1\n\n\nBase64æ¯ä¸ç§åºäº64ä¸ªå¯æå°å­ç¬¦æ¥è¡¨ç¤ºäºè¿å¶æ°æ®çè¡¨ç¤ºæ¹æ³ãç±äº2ç6æ¬¡æ¹ç­äº64ï¼æä»¥æ¯6ä¸ªæ¯ç¹ä¸ºä¸ä¸ªååï¼å¯¹åºæä¸ªå¯æå°å­ç¬¦ãä¸ä¸ªå­èæ24ä¸ªæ¯ç¹ï¼å¯¹åºäº4ä¸ªBase64ååï¼å³3ä¸ªå­èéè¦ç¨4ä¸ªå¯æå°å­ç¬¦æ¥è¡¨ç¤ºãJDK ä¸­æä¾äºéå¸¸æ¹ä¾¿ç BASE64Encoderå BASE64Decoderï¼ç¨å®ä»¬å¯ä»¥éå¸¸æ¹ä¾¿çå®æåºäº BASE64 çç¼ç åè§£ç ã\n\n# è´è½½(Payload)\n\nç¬¬äºé¨åæ¯è´è½½ï¼å°±æ¯å­æ¾ææä¿¡æ¯çå°æ¹ãè¿ä¸ªåå­åæ¯ç¹æé£æºä¸æ¿è½½çè´§åï¼è¿äºææä¿¡æ¯åå«ä¸ä¸ªé¨åï¼\n\n * æ åä¸­æ³¨åçå£°æï¼å»ºè®®ä½ä¸å¼ºå¶ä½¿ç¨ï¼\n\niss: jwtç­¾åè\nsub: jwtæé¢åçç¨æ·\naud: æ¥æ¶jwtçä¸æ¹\nexp: jwtçè¿ææ¶é´ï¼è¿ä¸ªè¿ææ¶é´å¿é¡»è¦å¤§äºç­¾åæ¶é´\nnbf: å®ä¹å¨ä»ä¹æ¶é´ä¹åï¼è¯¥jwté½æ¯ä¸å¯ç¨ç.\niat: jwtçç­¾åæ¶é´\njti: jwtçå¯ä¸èº«ä»½æ è¯ï¼ä¸»è¦ç¨æ¥ä½ä¸ºä¸æ¬¡æ§token,ä»èåé¿éæ¾æ»å»ã\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n * å¬å±çå£°æ\n   \n   å¬å±çå£°æå¯ä»¥æ·»å ä»»ä½çä¿¡æ¯ï¼ä¸è¬æ·»å ç¨æ·çç¸å³ä¿¡æ¯æå¶ä»ä¸å¡éè¦çå¿è¦ä¿¡æ¯.ä½ä¸å»ºè®®æ·»å ææä¿¡æ¯ï¼å ä¸ºè¯¥é¨åå¨å®¢æ·ç«¯å¯è§£å¯.\n\n * ç§æçå£°æ\n   \n   ç§æå£°ææ¯æä¾èåæ¶è´¹èæå±åå®ä¹çå£°æï¼ä¸è¬ä¸å»ºè®®å­æ¾ææä¿¡æ¯ï¼å ä¸ºbase64æ¯å¯¹ç§°è§£å¯çï¼æå³çè¯¥é¨åä¿¡æ¯å¯ä»¥å½ç±»ä¸ºææä¿¡æ¯ã\n\nè¿ä¸ªæçå°±æ¯èªå®ä¹çclaimãæ¯å¦ä¸é¢é£ä¸ªä¸¾ä¾ä¸­çnameé½å±äºèªå®çclaimãè¿äºclaimè·JWTæ åè§å®çclaimåºå«å¨äºï¼JWTè§å®çclaimï¼JWTçæ¥æ¶æ¹å¨æ¿å°JWTä¹åï¼é½ç¥éæä¹å¯¹è¿äºæ åçclaimè¿è¡éªè¯(è¿ä¸ç¥éæ¯å¦è½å¤éªè¯)ï¼èprivate claimsä¸ä¼éªè¯ï¼é¤éæç¡®åè¯æ¥æ¶æ¹è¦å¯¹è¿äºclaimè¿è¡éªè¯ä»¥åè§åæè¡ã\n\n{\n  "sub": "1234567890",\n  "name": "John Doe",\n  "iat": 1516239022\n}\n\n\n1\n2\n3\n4\n5\n\n\nå¶ä¸­subæ¯æ åçå£°æï¼nameæ¯èªå®ä¹çå£°æï¼å¬å±çæç§æçï¼\n\nç¶åå°å¶è¿è¡base64ç¼ç ï¼å¾å°Jwtçç¬¬äºé¨åï¼\n\n eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkphbWVzIiwiYWRtaW4iOnRydWV9\n\n\n1\n\n\næç¤ºï¼å£°æä¸­ä¸è¦æ¾ä¸äºææä¿¡æ¯ã\n\n# ç­¾è¯ãç­¾åï¼signatureï¼\n\njwtçç¬¬ä¸é¨åæ¯ä¸ä¸ªç­¾è¯ä¿¡æ¯ï¼è¿ä¸ªç­¾è¯ä¿¡æ¯ç±ä¸é¨åç»æï¼\n\n * header (base64åç)\n\n * payload (base64åç)\n\n * secretï¼çï¼ä¸å®è¦ä¿å¯ï¼\n\nè¿ä¸ªé¨åéè¦base64å å¯åçheaderåbase64å å¯åçpayloadä½¿ç¨.è¿æ¥ç»æçå­ç¬¦ä¸²ï¼ç¶åéè¿headerä¸­å£°æçå å¯æ¹å¼è¿è¡å çsecretç»åå å¯ï¼ç¶åå°±ææäºjwtçç¬¬ä¸é¨åï¼\n\n8HI-Lod0ncfVDnbKIPJJqLH998duF9DSDGkx3gRPNVI\n\n\n1\n\n\nå°è¿ä¸é¨åç¨.è¿æ¥æä¸ä¸ªå®æ´çå­ç¬¦ä¸²,ææäºæç»çjwt:\n\neyJhbGciOiJIUzI1NiIsInR9cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.8HI-Lod0ncfVDnbKIPJJqLH998duF9DSDGkx3gRPNVI\n\n\n1\n\n\næ³¨æï¼secretæ¯ä¿å­å¨æå¡å¨ç«¯çï¼jwtçç­¾åçæä¹æ¯å¨æå¡å¨ç«¯çï¼secretå°±æ¯ç¨æ¥è¿è¡jwtçç­¾ååjwtçéªè¯ï¼æä»¥ï¼å®å°±æ¯ä½ æå¡ç«¯çç§é¥ï¼å¨ä»»ä½åºæ¯é½ä¸åºè¯¥æµé²åºå»ãä¸æ¦å®¢æ·ç«¯å¾ç¥è¿ä¸ªsecret, é£å°±æå³çå®¢æ·ç«¯æ¯å¯ä»¥èªæç­¾åjwtäºã\n\n\n# JJWTç®ä»\n\n# ä»ä¹æ¯JJWT\n\nJJWTæ¯ä¸ä¸ªæä¾ç«¯å°ç«¯çJWTåå»ºåéªè¯çJavaåºãæ°¸è¿åè´¹åå¼æº(Apache Licenseï¼çæ¬2.0)ï¼JJWå¾å®¹æä½¿ç¨åçè§£ãå®è¢«è®¾è®¡æä¸ä¸ªä»¥å»ºç­ä¸ºä¸­å¿çæµççé¢ï¼éèäºå®çå¤§é¨åå¤ææ§ã\n\nè§èå®ç½ï¼https://jwt.io/\n\n# å¿«éå¥é¨\n\n# tokençåå»º\n\nåå»ºSpringBootå·¥ç¨ï¼å¼å¥ä¾èµ\n\n<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">\n   <modelVersion>4.0.0</modelVersion>\n   <parent>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-starter-parent</artifactId>\n      <version>2.2.2.RELEASE</version>\n      <relativePath/> \x3c!-- lookup parent from repository --\x3e\n   </parent>\n  \n   <groupId>com.yjxxt</groupId>\n   <artifactId>jwtdemo</artifactId>\n   <version>0.0.1-SNAPSHOT</version>\n  \n   <name>jwtdemo</name>\n   <description>Demo project for Spring Boot</description>\n\n   <properties>\n      <java.version>1.8</java.version>\n   </properties>\n\n   <dependencies>\n      <dependency>\n         <groupId>org.springframework.boot</groupId>\n         <artifactId>spring-boot-starter-web</artifactId>\n      </dependency>\n      \x3c!--JWTä¾èµ--\x3e\n      <dependency>\n         <groupId>io.jsonwebtoken</groupId>\n         <artifactId>jjwt</artifactId>\n         <version>0.9.0</version>\n      </dependency>\n\n      <dependency>\n         <groupId>org.springframework.boot</groupId>\n         <artifactId>spring-boot-starter-test</artifactId>\n         <scope>test</scope>\n         <exclusions>\n            <exclusion>\n               <groupId>org.junit.vintage</groupId>\n               <artifactId>junit-vintage-engine</artifactId>\n            </exclusion>\n         </exclusions>\n      </dependency>\n   </dependencies>\n</project>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n\n\nåå»ºæµè¯ç±»JwtTestï¼ç¨äºçætokenï¼\n\npackage com.yjxxt.jwtdemo;\n\nimport io.jsonwebtoken.JwtBuilder;\nimport io.jsonwebtoken.Jwts;\nimport io.jsonwebtoken.SignatureAlgorithm;\nimport io.jsonwebtoken.impl.Base64Codec;\nimport org.junit.jupiter.api.Test;\nimport org.springframework.boot.test.context.SpringBootTest;\n\nimport java.util.Date;\n\n@SpringBootTest\npublic class JwtdemoApplicationTests {\n\n   /**\n    * åå»ºtoken\n    */\n   @Test\n   public void testCreatToken() {\n      //åå»ºä¸ä¸ªJwtBuilderå¯¹è±¡\n      JwtBuilder jwtBuilder = Jwts.builder()\n            //å£°æçæ è¯{"jti":"888"}\n            .setId("888")\n            //ä¸»ä½ï¼ç¨æ·{"sub":"Rose"}\n            .setSubject("Rose")\n            //åå»ºæ¥æ{"ita":"yjxxtxx"}\n            .setIssuedAt(new Date())\n            //ç­¾åææ®µï¼åæ°1ï¼ç®æ³ï¼åæ°2ï¼ç\n            .signWith(SignatureAlgorithm.HS256,"yjxxt");\n       \n      //è·åjwtçtoken\n      String token = jwtBuilder.compact();\n      System.out.println(token);\n\n      //ä¸é¨åçbase64è§£å¯\n      System.out.println("--------------------");\n      String[] split = token.split("\\\\.");\n      System.out.println(Base64Codec.BASE64.decodeToString(split[0]));\n      System.out.println(Base64Codec.BASE64.decodeToString(split[1]));\n      //æ æ³è§£å¯\n      System.out.println(Base64Codec.BASE64.decodeToString(split[2]));\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n\n\nè¿è¡ç»æå¦ä¸\n\n\n\nåæ¬¡è¿è¡ï¼ä¼åç°æ¯æ¬¡è¿è¡çç»ææ¯ä¸ä¸æ ·çï¼å ä¸ºæä»¬çè½½è·ä¸­åå«äºæ¶é´\n\n# tokençéªè¯è§£æ\n\næä»¬åæå·²ç»åå»ºäºtoken ï¼å¨webåºç¨ä¸­è¿ä¸ªæä½æ¯ç±æå¡ç«¯è¿è¡ç¶ååç»å®¢æ·ç«¯ï¼å®¢æ·ç«¯å¨ä¸æ¬¡åæå¡ç«¯åéè¯·æ±æ¶éè¦æºå¸¦è¿ä¸ªtokenï¼è¿å°±å¥½åæ¯æ¿çä¸å¼ é¨ç¥¨ä¸æ ·ï¼ï¼é£æå¡ç«¯æ¥å°è¿ä¸ªtoken åºè¯¥è§£æåºtokenä¸­çä¿¡æ¯ï¼ä¾å¦ç¨æ·idï¼,æ ¹æ®è¿äºä¿¡æ¯æ¥è¯¢æ°æ®åºè¿åç¸åºçç»æã\n\n@Test\npublic void testParseToken(){\n   //token\n   String token = "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI4ODgiLCJzdWIiOiJSb3NlIiwiaWF0IjoxNTc4ODE0MjUyfQ" +\n         ".-FYFMHyfTcGzq900f_Drfdsges0ge2UjaWvPW9gCDto";\n   //è§£ætokenè·åè´è½½ä¸­çå£°æå¯¹è±¡\n   Claims claims = Jwts.parser()\n         .setSigningKey("yjxxt")\n         .parseClaimsJws(token)\n         .getBody();\n   //æå°å£°æçå±æ§\n   System.out.println("id:"+claims.getId());\n   System.out.println("subject:"+claims.getSubject());\n   System.out.println("issuedAt:"+claims.getIssuedAt());\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nè¯çå°tokenæç­¾åç§é¥ç¯¡æ¹ä¸ä¸ï¼ä¼åç°è¿è¡æ¶å°±ä¼æ¥éï¼æä»¥è§£ætokenä¹å°±æ¯éªè¯token\n\n# tokenè¿ææ ¡éª\n\næå¾å¤æ¶åï¼æä»¬å¹¶ä¸å¸æç­¾åçtokenæ¯æ°¸ä¹çæçï¼ä¸èçtokenæ¯æ°¸ä¹çï¼ï¼æä»¥æä»¬å¯ä»¥ä¸ºtokenæ·»å ä¸ä¸ªè¿ææ¶é´ãåå ï¼ä»æå¡å¨ååºçtokenï¼æå¡å¨èªå·±å¹¶ä¸åè®°å½ï¼å°±å­å¨ä¸ä¸ªå¼ç«¯å°±æ¯ï¼æå¡ç«¯æ æ³ä¸»å¨æ§å¶ætokençç«å»å¤±æã\n\næµè¯ç¨ä¾ï¼\n\n@Test\npublic void testCreatTokenHasExp() {\n   //å½åç³»ç»æ¶é´çé¿æ´å\n   long now = System.currentTimeMillis();\n   //è¿ææ¶é´ï¼è¿éæ¯1åéåçæ¶é´é¿æ´å\n   long exp = now + 60 * 1000;\n   //åå»ºä¸ä¸ªJwtBuilderå¯¹è±¡\n   JwtBuilder jwtBuilder = Jwts.builder()\n         //å£°æçæ è¯{"jti":"888"}\n         .setId("888")\n         //ä¸»ä½ï¼ç¨æ·{"sub":"Rose"}\n         .setSubject("Rose")\n         //åå»ºæ¥æ{"ita":"yjxxtxx"}\n         .setIssuedAt(new Date())\n         //ç­¾åææ®µï¼åæ°1ï¼ç®æ³ï¼åæ°2ï¼ç\n         .signWith(SignatureAlgorithm.HS256, "yjxxt")\n         //è®¾ç½®è¿ææ¶é´\n         .setExpiration(new Date(exp));\n   //è·åjwtçtoken\n   String token = jwtBuilder.compact();\n   System.out.println(token);\n}\n\n\n@Test\npublic void testParseTokenHasExp() {\n   //token\n   String token = "eyJhbGciOiJIUzI1NiJ9" +\n         ".eyJqdGkiOiI4ODgiLCJzdWIiOiJSb3NlIiwiaWF0IjoxNTc4ODE1MDYyLCJleHAiOjE1Nzg4MTUxMjIsInJvbGVzIjoiYWRtaW4iLCJsb2dvIjoic2hzeHQuanBnIn0.hKog0RsZ9_6II_R8kUCp0HLAouUAYXAJVbz3xtLTUh4";\n   //è§£ætokenè·åè´è½½ä¸­çå£°æå¯¹è±¡\n   Claims claims = Jwts.parser()\n         .setSigningKey("yjxxt")\n         .parseClaimsJws(token)\n         .getBody();\n   //æå°å£°æçå±æ§\n   System.out.println("id:" + claims.getId());\n   System.out.println("subject:" + claims.getSubject());\n   System.out.println("issuedAt:" + claims.getIssuedAt());\n   DateFormat sf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");\n   System.out.println("ç­¾åæ¶é´:"+sf.format(claims.getIssuedAt()));\n   System.out.println("è¿ææ¶é´:"+sf.format(claims.getExpiration()));\n   System.out.println("å½åæ¶é´:"+sf.format(new Date()));\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n\n\næµè¯ï¼å½æªè¿ææ¶å¯ä»¥æ­£å¸¸è¯»åï¼å½è¿ææ¶ä¼å¼åio.jsonwebtoken.ExpiredJwtExceptionå¼å¸¸ã\n\n\n\n# èªå®ä¹claims\n\næä»¬åæçä¾å­åªæ¯å­å¨äºidåsubjectä¸¤ä¸ªä¿¡æ¯ï¼å¦æä½ æ³å­å¨æ´å¤çä¿¡æ¯ï¼ä¾å¦è§è²ï¼å¯ä»¥å®ä¹èªå®ä¹claims\n\næµè¯ç¨ä¾ï¼\n\n@Test\npublic void testCreatTokenByClaims() {\n   //å½åç³»ç»æ¶é´çé¿æ´å\n   long now = System.currentTimeMillis();\n   //è¿ææ¶é´ï¼è¿éæ¯1åéåçæ¶é´é¿æ´å\n   long exp = now + 60 * 1000;\n   //åå»ºä¸ä¸ªJwtBuilderå¯¹è±¡\n   JwtBuilder jwtBuilder = Jwts.builder()\n         //å£°æçæ è¯{"jti":"888"}\n         .setId("888")\n         //ä¸»ä½ï¼ç¨æ·{"sub":"Rose"}\n         .setSubject("Rose")\n         //åå»ºæ¥æ{"ita":"yjxxtxx"}\n         .setIssuedAt(new Date())\n         //ç­¾åææ®µï¼åæ°1ï¼ç®æ³ï¼åæ°2ï¼ç\n         .signWith(SignatureAlgorithm.HS256, "yjxxt")\n         //è®¾ç½®è¿ææ¶é´\n         .setExpiration(new Date(exp))\n         //ç´æ¥ä¼ å¥map\n         // .addClaims(map)\n         .claim("roles","admin")\n         .claim("logo","yjxxt.jpg");\n   //è·åjwtçtoken\n   String token = jwtBuilder.compact();\n   System.out.println(token);\n}\n\n\n@Test\npublic void testParseTokenByClaims() {\n   //token\n   String token = "eyJhbGciOiJIUzI1NiJ9" +\n         ".eyJqdGkiOiI4ODgiLCJzdWIiOiJSb3NlIiwiaWF0IjoxNTc4ODE1MDYyLCJleHAiOjE1Nzg4MTUxMjIsInJvbGVzIjoiYWRtaW4iLCJsb2dvIjoic2hzeHQuanBnIn0.hKog0RsZ9_6II_R8kUCp0HLAouUAYXAJVbz3xtLTUh4";\n   //è§£ætokenè·åè´è½½ä¸­çå£°æå¯¹è±¡\n   Claims claims = Jwts.parser()\n         .setSigningKey("yjxxt")\n         .parseClaimsJws(token)\n         .getBody();\n   //æå°å£°æçå±æ§\n   System.out.println("id:" + claims.getId());\n   System.out.println("subject:" + claims.getSubject());\n   System.out.println("issuedAt:" + claims.getIssuedAt());\n   DateFormat sf =new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");\n   System.out.println("ç­¾åæ¶é´:"+sf.format(claims.getIssuedAt()));\n   System.out.println("è¿ææ¶é´:"+sf.format(claims.getExpiration()));\n   System.out.println("å½åæ¶é´:"+sf.format(new Date()));\n\n   System.out.println("roles:"+claims.get("roles"));\n   System.out.println("logo:"+claims.get("logo"));\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n\n\n\n# Spring Security Oauth2 æ´åJWT\n\n\n# æ´åJWT\n\næä»¬æ¿ä¹åSpring Security Oauth2çå®æ´ä»£ç è¿è¡ä¿®æ¹\n\næ·»å éç½®æä»¶JwtTokenStoreConfig.java\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.oauth2.provider.token.TokenStore;\nimport org.springframework.security.oauth2.provider.token.store.JwtAccessTokenConverter;\nimport org.springframework.security.oauth2.provider.token.store.JwtTokenStore;\n\n/**\n * ä½¿ç¨Jwtå­å¨tokençéç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@Configuration\npublic class JwtTokenStoreConfig {\n\n   @Bean\n   public TokenStore jwtTokenStore(){\n      return new JwtTokenStore(jwtAccessTokenConverter());\n   }\n\n   @Bean\n   public JwtAccessTokenConverter jwtAccessTokenConverter(){\n      JwtAccessTokenConverter accessTokenConverter = new JwtAccessTokenConverter();\n      //éç½®JWTä½¿ç¨çç§é¥\n      accessTokenConverter.setSigningKey("test_key");\n      return accessTokenConverter;\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nå¨è®¤è¯æå¡å¨éç½®ä¸­æå®ä»¤ççå­å¨ç­ç¥ä¸ºJWT\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport com.yjxxt.springsecurityoauth2demo.service.UserService;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.authentication.AuthenticationManager;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.security.oauth2.config.annotation.configurers.ClientDetailsServiceConfigurer;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.AuthorizationServerConfigurerAdapter;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.EnableAuthorizationServer;\nimport org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerEndpointsConfigurer;\nimport org.springframework.security.oauth2.provider.token.TokenStore;\nimport org.springframework.security.oauth2.provider.token.store.JwtAccessTokenConverter;\n\n/**\n * æææå¡å¨éç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@Configuration\n@EnableAuthorizationServer\npublic class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter {\n\n    @Autowired\n    private PasswordEncoder passwordEncoder;\n\n    @Autowired\n    private AuthenticationManager authenticationManager;\n\n    @Autowired\n    private UserService userService;\n    \n    @Autowired\n    @Qualifier("jwtTokenStore")\n    private TokenStore tokenStore;\n\n    @Autowired\n    private JwtAccessTokenConverter jwtAccessTokenConverter;\n\n\n    /**\n     * ä½¿ç¨å¯ç æ¨¡å¼éè¦éç½®\n     */\n    @Override\n    public void configure(AuthorizationServerEndpointsConfigurer endpoints) {\n        endpoints.authenticationManager(authenticationManager)\n                .userDetailsService(userService)\n                //éç½®å­å¨ä»¤çç­ç¥\n                .tokenStore(tokenStore)\n                .accessTokenConverter(jwtAccessTokenConverter);\n    }\n\n    @Override\n    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {\n        clients.inMemory()\n                //éç½®client_id\n                .withClient("admin")\n                //éç½®client-secret\n                .secret(passwordEncoder.encode("112233"))\n                //éç½®è®¿é®tokençæææ\n                .accessTokenValiditySeconds(3600)\n                //éç½®å·æ°tokençæææ\n                .refreshTokenValiditySeconds(864000)\n                //éç½®redirect_uriï¼ç¨äºæææååè·³è½¬\n                .redirectUris("http://www.baidu.com")\n                //éç½®ç³è¯·çæéèå´\n                .scopes("all")\n                //éç½®grant_typeï¼è¡¨ç¤ºææç±»å\n                .authorizedGrantTypes("authorization_code","password");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n\n\nç¨å¯ç æ¨¡å¼æµè¯ï¼\n\n\n\nåç°è·åå°çä»¤çå·²ç»åæäºJWTä»¤çï¼å°access_tokenæ¿å°https://jwt.io/ ç½ç«ä¸å»è§£æä¸å¯ä»¥è·å¾å¶ä¸­åå®¹ã\n\n\n\n\n# æ©å±JWTä¸­å­å¨çåå®¹\n\nææ¶åæä»¬éè¦æ©å±JWTä¸­å­å¨çåå®¹ï¼è¿éæä»¬å¨JWTä¸­æ©å±ä¸ä¸ªkeyä¸ºenhanceï¼valueä¸ºenhance infoçæ°æ®ã\n\nç»§æ¿TokenEnhancerå®ç°ä¸ä¸ªJWTåå®¹å¢å¼ºå¨\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.security.oauth2.common.DefaultOAuth2AccessToken;\nimport org.springframework.security.oauth2.common.OAuth2AccessToken;\nimport org.springframework.security.oauth2.provider.OAuth2Authentication;\nimport org.springframework.security.oauth2.provider.token.TokenEnhancer;\n\nimport java.util.HashMap;\nimport java.util.Map;\n\n/**\n * JWTåå®¹å¢å¼ºå¨\n * @author zhoubin\n * @since 1.0.0\n */\npublic class JwtTokenEnhancer implements TokenEnhancer {\n\n   @Override\n   public OAuth2AccessToken enhance(OAuth2AccessToken accessToken, OAuth2Authentication authentication) {\n      Map<String,Object> info = new HashMap<>();\n      info.put("enhance","enhance info");\n      ((DefaultOAuth2AccessToken)accessToken).setAdditionalInformation(info);\n      return accessToken;\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nåå»ºä¸ä¸ªJwtTokenEnhancerå®ä¾\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.oauth2.provider.token.TokenStore;\nimport org.springframework.security.oauth2.provider.token.store.JwtAccessTokenConverter;\nimport org.springframework.security.oauth2.provider.token.store.JwtTokenStore;\n\n/**\n * ä½¿ç¨Jwtå­å¨tokençéç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@Configuration\npublic class JwtTokenStoreConfig {\n\n   @Bean\n   public TokenStore jwtTokenStore(){\n      return new JwtTokenStore(jwtAccessTokenConverter());\n   }\n\n   @Bean\n   public JwtAccessTokenConverter jwtAccessTokenConverter(){\n      JwtAccessTokenConverter accessTokenConverter = new JwtAccessTokenConverter();\n      //éç½®JWTä½¿ç¨çç§é¥\n      accessTokenConverter.setSigningKey("test_key");\n      return accessTokenConverter;\n   }\n\n   @Bean\n   public JwtTokenEnhancer jwtTokenEnhancer() {\n      return new JwtTokenEnhancer();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n\n\nå¨è®¤è¯æå¡å¨éç½®ä¸­éç½®JWTçåå®¹å¢å¼ºå¨\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport com.yjxxt.springsecurityoauth2demo.component.JwtTokenEnhancer;\nimport com.yjxxt.springsecurityoauth2demo.service.UserService;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.authentication.AuthenticationManager;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.security.oauth2.config.annotation.configurers.ClientDetailsServiceConfigurer;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.AuthorizationServerConfigurerAdapter;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.EnableAuthorizationServer;\nimport org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerEndpointsConfigurer;\nimport org.springframework.security.oauth2.provider.token.TokenEnhancer;\nimport org.springframework.security.oauth2.provider.token.TokenEnhancerChain;\nimport org.springframework.security.oauth2.provider.token.TokenStore;\nimport org.springframework.security.oauth2.provider.token.store.JwtAccessTokenConverter;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\n/**\n * æææå¡å¨éç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@Configuration\n@EnableAuthorizationServer\npublic class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter {\n\n    @Autowired\n    private PasswordEncoder passwordEncoder;\n\n    @Autowired\n    private AuthenticationManager authenticationManager;\n\n    @Autowired\n    private UserService userService;\n\n    @Autowired\n    @Qualifier("jwtTokenStore")\n    private TokenStore tokenStore;\n    @Autowired\n    private JwtAccessTokenConverter jwtAccessTokenConverter;\n    @Autowired\n    private JwtTokenEnhancer jwtTokenEnhancer;\n\n    /**\n     * ä½¿ç¨å¯ç æ¨¡å¼éè¦éç½®\n     */\n    @Override\n    public void configure(AuthorizationServerEndpointsConfigurer endpoints) {\n        TokenEnhancerChain enhancerChain = new TokenEnhancerChain();\n        List<TokenEnhancer> delegates = new ArrayList<>();\n        //éç½®JWTçåå®¹å¢å¼ºå¨\n        delegates.add(jwtTokenEnhancer);\n        delegates.add(jwtAccessTokenConverter);\n        enhancerChain.setTokenEnhancers(delegates);\n        endpoints.authenticationManager(authenticationManager)\n                .userDetailsService(userService)\n                //éç½®å­å¨ä»¤çç­ç¥\n                .tokenStore(tokenStore)\n                .accessTokenConverter(jwtAccessTokenConverter)\n                .tokenEnhancer(enhancerChain);\n    }\n\n    @Override\n    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {\n        clients.inMemory()\n                //éç½®client_id\n                .withClient("admin")\n                //éç½®client-secret\n                .secret(passwordEncoder.encode("112233"))\n                //éç½®è®¿é®tokençæææ\n                .accessTokenValiditySeconds(3600)\n                //éç½®å·æ°tokençæææ\n                .refreshTokenValiditySeconds(864000)\n                //éç½®redirect_uriï¼ç¨äºæææååè·³è½¬\n                .redirectUris("http://www.baidu.com")\n                //éç½®ç³è¯·çæéèå´\n                .scopes("all")\n                //éç½®grant_typeï¼è¡¨ç¤ºææç±»å\n                .authorizedGrantTypes("authorization_code","password");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n\n\nè¿è¡é¡¹ç®åä½¿ç¨å¯ç æ¨¡å¼æ¥è·åä»¤çï¼ä¹åå¯¹ä»¤çè¿è¡è§£æï¼åç°å·²ç»åå«æ©å±çåå®¹ã\n\n\n\n\n# Javaä¸­è§£æJWTä¸­çåå®¹\n\næ·»å ä¾èµ\n\n\x3c!--jwt ä¾èµ--\x3e\n<dependency>\n   <groupId>io.jsonwebtoken</groupId>\n   <artifactId>jjwt</artifactId>\n   <version>0.9.0</version>\n</dependency>\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¿®æ¹UserControllerç±»ï¼ä½¿ç¨jjwtå·¥å·ç±»æ¥è§£æAuthorizationå¤´ä¸­å­å¨çJWTåå®¹\n\npackage com.yjxxt.springsecurityoauth2demo.controller;\n\nimport io.jsonwebtoken.Jwts;\nimport org.springframework.security.core.Authentication;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\nimport javax.servlet.http.HttpServletRequest;\nimport java.nio.charset.StandardCharsets;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@RestController\n@RequestMapping("/user")\npublic class UserController {\n\n   @GetMapping("/getCurrentUser")\n   public Object getCurrentUser(Authentication authentication, HttpServletRequest request) {\n      String header = request.getHeader("Authorization");\n      String token = header.substring(header.indexOf("bearer") + 7);\n      return Jwts.parser()\n            .setSigningKey("test_key".getBytes(StandardCharsets.UTF_8))\n            .parseClaimsJws(token)\n            .getBody();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nå°ä»¤çæ¾å¥Authorizationå¤´ä¸­ï¼è®¿é®å¦ä¸å°åè·åä¿¡æ¯ï¼\n\nhttp://localhost:8080/user/getCurrentUser\n\n\n\n\n# å·æ°ä»¤ç\n\nå¨Spring Cloud Security ä¸­ä½¿ç¨oauth2æ¶ï¼å¦æä»¤çå¤±æäºï¼å¯ä»¥ä½¿ç¨å·æ°ä»¤çéè¿refresh_tokençæææ¨¡å¼åæ¬¡è·åaccess_tokenã\n\nåªéä¿®æ¹è®¤è¯æå¡å¨çéç½®ï¼æ·»å refresh_tokençæææ¨¡å¼å³å¯ã\n\n@Override\npublic void configure(ClientDetailsServiceConfigurer clients) throws Exception {\n    clients.inMemory()\n            //éç½®client_id\n            .withClient("admin")\n            //éç½®client-secret\n            .secret(passwordEncoder.encode("112233"))\n            //éç½®è®¿é®tokençæææ\n            .accessTokenValiditySeconds(3600)\n            //éç½®å·æ°tokençæææ\n            .refreshTokenValiditySeconds(86400)\n            //éç½®redirect_uriï¼ç¨äºæææååè·³è½¬\n            .redirectUris("http://www.baidu.com")\n            //éç½®ç³è¯·çæéèå´\n            .scopes("all")\n            //éç½®grant_typeï¼è¡¨ç¤ºææç±»å\n            .authorizedGrantTypes("authorization_code","password","refresh_token");\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä½¿ç¨å·æ°ä»¤çæ¨¡å¼æ¥è·åæ°çä»¤çï¼è®¿é®å¦ä¸å°åï¼\n\nhttp://localhost:8080/oauth/token\n\n\n\n\n# Spring Security Oauth2 æ´ååç¹ç»å½ï¼SSOï¼\n\n\n# åå»ºå®¢æ·ç«¯\n\n\n\n\n\n\n# æ·»å ä¾èµ\n\n<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">\n   <modelVersion>4.0.0</modelVersion>\n   <parent>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-starter-parent</artifactId>\n      <version>2.2.2.RELEASE</version>\n      <relativePath/> \x3c!-- lookup parent from repository --\x3e\n   </parent>\n  \n   <groupId>com.yjxxt</groupId>\n   <artifactId>oauth2client01demo</artifactId>\n   <version>0.0.1-SNAPSHOT</version>\n  \n   <name>oauth2client01demo</name>\n   <description>Demo project for Spring Boot</description>\n\n   <properties>\n      <java.version>1.8</java.version>\n      <spring-cloud.version>Greenwich.SR2</spring-cloud.version>\n   </properties>\n\n   <dependencies>\n      <dependency>\n         <groupId>org.springframework.cloud</groupId>\n         <artifactId>spring-cloud-starter-oauth2</artifactId>\n      </dependency>\n      <dependency>\n         <groupId>org.springframework.cloud</groupId>\n         <artifactId>spring-cloud-starter-security</artifactId>\n      </dependency>\n      <dependency>\n         <groupId>org.springframework.boot</groupId>\n         <artifactId>spring-boot-starter-web</artifactId>\n      </dependency>\n      <dependency>\n         <groupId>io.jsonwebtoken</groupId>\n         <artifactId>jjwt</artifactId>\n         <version>0.9.0</version>\n      </dependency>\n\n      <dependency>\n         <groupId>org.springframework.boot</groupId>\n         <artifactId>spring-boot-starter-test</artifactId>\n         <scope>test</scope>\n      </dependency>\n   </dependencies>\n\n   <dependencyManagement>\n      <dependencies>\n         <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-dependencies</artifactId>\n            <version>${spring-cloud.version}</version>\n            <type>pom</type>\n            <scope>import</scope>\n         </dependency>\n      </dependencies>\n   </dependencyManagement>\n\n   <build>\n      <plugins>\n         <plugin>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-maven-plugin</artifactId>\n         </plugin>\n      </plugins>\n   </build>\n</project>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n\n\n\n# ä¿®æ¹éç½®æä»¶\n\napplication.properties\n\nserver.port=8081\n#é²æ­¢Cookieå²çªï¼å²çªä¼å¯¼è´ç»å½éªè¯ä¸éè¿\nserver.servlet.session.cookie.name=OAUTH2-CLIENT-SESSIONID01\n#æææå¡å¨å°å\noauth2-server-url=http://localhost:8080\n#ä¸æææå¡å¨å¯¹åºçéç½®\nsecurity.oauth2.client.client-id=admin\nsecurity.oauth2.client.client-secret=112233\nsecurity.oauth2.client.user-authorization-uri=${oauth2-server-url}/oauth/authorize\nsecurity.oauth2.client.access-token-uri=${oauth2-server-url}/oauth/token\nsecurity.oauth2.resource.jwt.key-uri=${oauth2-server-url}/oauth/token_key\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# å¨å¯å¨ç±»ä¸æ·»å @EnableOAuth2Ssoæ³¨è§£æ¥å¯ç¨åç¹ç»å½åè½\n\npackage com.yjxxt.oauth2client01demo;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.boot.autoconfigure.security.oauth2.client.EnableOAuth2Sso;\n\n@SpringBootApplication\n@EnableOAuth2Sso\npublic class Oauth2client01demoApplication {\n\n   public static void main(String[] args) {\n      SpringApplication.run(Oauth2client01demoApplication.class, args);\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# æ·»å æ¥å£ç¨äºè·åå½åç»å½ç¨æ·ä¿¡æ¯\n\npackage com.yjxxt.oauth2client01demo.controller;\n\nimport org.springframework.security.core.Authentication;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\n@RequestMapping("/user")\npublic class UserController {\n    \n    @GetMapping("/getCurrentUser")\n    public Object getCurrentUser(Authentication authentication) {\n        return authentication;\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n# ä¿®æ¹è®¤è¯æå¡å¨éç½®\n\nä¿®æ¹æææå¡å¨ä¸­çAuthorizationServerConfigç±»ï¼å°ç»å®çè·³è½¬è·¯å¾ä¸º\n\nhttp://localhost:8081/loginï¼å¹¶æ·»å è·åç§é¥æ¶çèº«ä»½è®¤è¯\n\n@Override\npublic void configure(ClientDetailsServiceConfigurer clients) throws Exception {\n    clients.inMemory()\n            //éç½®client_id\n            .withClient("admin")\n            //éç½®client-secret\n            .secret(passwordEncoder.encode("112233"))\n            //éç½®è®¿é®tokençæææ\n            .accessTokenValiditySeconds(3600)\n            //éç½®å·æ°tokençæææ\n            .refreshTokenValiditySeconds(864000)\n            //éç½®redirect_uriï¼ç¨äºæææååè·³è½¬\n            // .redirectUris("http://www.baidu.com")\n            //åç¹ç»å½æ¶éç½®\n            .redirectUris("http://localhost:8081/login")\n            //éç½®ç³è¯·çæéèå´\n            .scopes("all")\n            //èªå¨ææéç½®\n            .autoApprove(true) \n            //éç½®grant_typeï¼è¡¨ç¤ºææç±»å\n            .authorizedGrantTypes("authorization_code","password","refresh_token");\n}\n\n@Override\npublic void configure(AuthorizationServerSecurityConfigurer security) {\n    // è·åå¯é¥éè¦èº«ä»½è®¤è¯ï¼ä½¿ç¨åç¹ç»å½æ¶å¿é¡»éç½®\n    security.tokenKeyAccess("isAuthenticated()");\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n\n\n# æµè¯\n\nå¯å¨æææå¡åå®¢æ·ç«¯æå¡ï¼\n\nè®¿é®å®¢æ·ç«¯éè¦ææçæ¥å£http://localhost:8081/user/getCurrentUser\n\nä¼è·³è½¬å°æææå¡çç»å½çé¢ï¼\n\n\n\nææåä¼è·³è½¬å°åæ¥éè¦æéçæ¥å£å°åï¼å±ç¤ºç»å½ç¨æ·ä¿¡æ¯ï¼\n\n',normalizedContent:'è§é¢å°åï¼https://www.bilibili.com/video/bv1gb4y1b7xe\n\n\n# å­¦ä¹ ç®æ \n\n\n\n\n# springsecurity\n\n\n# springsecurityç®ä»\n\n# å®å¨æ¡æ¶æ¦è¿°\n\nä»ä¹æ¯å®å¨æ¡æ¶ï¼ è§£å³ç³»ç»å®å¨é®é¢çæ¡æ¶ãå¦ææ²¡æå®å¨æ¡æ¶ï¼æä»¬éè¦æå¨å¤çæ¯ä¸ªèµæºçè®¿é®æ§å¶ï¼éå¸¸éº»ç¦ãä½¿ç¨å®å¨æ¡æ¶ï¼æä»¬å¯ä»¥éè¿éç½®çæ¹å¼å®ç°å¯¹èµæºçè®¿é®éå¶ã\n\n# å¸¸ç¨å®å¨æ¡æ¶\n\n * spring securityï¼springå®¶æä¸åãæ¯ä¸ä¸ªè½å¤ä¸ºåºäºspringçä¼ä¸åºç¨ç³»ç»æä¾å£°æå¼çå®å¨è®¿é®æ§å¶è§£å³æ¹æ¡çå®å¨æ¡æ¶ãå®æä¾äºä¸ç»å¯ä»¥å¨springåºç¨ä¸ä¸æä¸­éç½®çbeanï¼ååå©ç¨äºspring iocï¼diï¼æ§å¶åè½¬inversion of control,di:dependency injection ä¾èµæ³¨å¥ï¼åaopï¼é¢ååé¢ç¼ç¨ï¼åè½ï¼ä¸ºåºç¨ç³»ç»æä¾å£°æå¼çå®å¨è®¿é®æ§å¶åè½ï¼åå°äºä¸ºä¼ä¸ç³»ç»å®å¨æ§å¶ç¼åå¤§ééå¤ä»£ç çå·¥ä½ã\n * apache shiroï¼ä¸ä¸ªåè½å¼ºå¤§ä¸æäºä½¿ç¨çjavaå®å¨æ¡æ¶,æä¾äºè®¤è¯,ææ,å å¯,åä¼è¯ç®¡çã\n\n# spring securityç®ä»\n\n# æ¦è¿°ï¼çæï¼\n\n> spring securityæ¯ä¸ä¸ªé«åº¦èªå®ä¹çå®å¨æ¡æ¶ãå©ç¨ spring ioc/diåaopåè½ï¼ä¸ºç³»ç»æä¾äºå£°æå¼å®å¨è®¿é®æ§å¶åè½ï¼åå°äºä¸ºç³»ç»å®å¨èç¼åå¤§ééå¤ä»£ç çå·¥ä½ãä½¿ç¨ spring secruity çåå æå¾å¤ï¼ä½å¤§é¨åé½æ¯åç°äº javaeeç servlet è§èæ ejb è§èä¸­çå®å¨åè½ç¼ºä¹å¸åä¼ä¸åºç¨åºæ¯ãåæ¶è®¤è¯å°ä»ä»¬å¨ war æ ear çº§å«æ æ³ç§»æ¤ãå æ­¤å¦æä½ æ´æ¢æå¡å¨ç¯å¢ï¼è¿éè¦å¤§éå·¥ä½å»éæ°éç½®ä½ çåºç¨ç¨åºãä½¿ç¨ spring securityè§£å³äºè¿äºé®é¢ï¼ä¹ä¸ºä½ æä¾è®¸å¤å¶ä»æç¨çãå¯å®å¶çå®å¨åè½ãæ­£å¦ä½ å¯è½ç¥éçä¸¤ä¸ªåºç¨ç¨åºçä¸¤ä¸ªä¸»è¦åºåæ¯âè®¤è¯âåâææâï¼æèè®¿é®æ§å¶ï¼ãè¿ä¸¤ç¹ä¹æ¯ spring security éè¦æ ¸å¿åè½ãâè®¤è¯âï¼æ¯å»ºç«ä¸ä¸ªä»å£°æçä¸»ä½çè¿ç¨ï¼ä¸ä¸ªâä¸»ä½âä¸è¬æ¯æç¨æ·ï¼è®¾å¤æä¸äºå¯ä»¥å¨ä½ çåºç¨ç¨åºä¸­æ§è¡å¨ä½çå¶ä»ç³»ç»ï¼ï¼éä¿ç¹è¯´å°±æ¯ç³»ç»è®¤ä¸ºç¨æ·æ¯å¦è½ç»å½ãâææâæç¡®å®ä¸ä¸ªä¸»ä½æ¯å¦åè®¸å¨ä½ çåºç¨ç¨åºæ§è¡ä¸ä¸ªå¨ä½çè¿ç¨ãéä¿ç¹è®²å°±æ¯ç³»ç»å¤æ­ç¨æ·æ¯å¦ææéå»åæäºäºæã\n\n# åå²ï¼äºè§£ï¼\n\n> spring security ä»¥âthe acegi secutity system for springâçåå­å§äº2003å¹´å¹´åºãå¶åèº«ä¸º acegi é¡¹ç®ãèµ·å æ¯ spring å¼åèé®ä»¶åè¡¨ä¸­ä¸ä¸ªé®é¢ï¼æäººæé®æ¯å¦èèæä¾ä¸ä¸ªåºäº spring çå®å¨å®ç°ãéå¶äºæ¶é´é®é¢ï¼å¼ååºäºä¸ä¸ªç®åçå®å¨å®ç°ï¼ä½æ¯å¹¶æ²¡ææ·±å¥ç ç©¶ãå å¨åï¼spring ç¤¾åºä¸­å¶ä»æååæ ·è¯¢é®äºå®å¨é®é¢ï¼ä»£ç æä¾ç»äºè¿äºäººã2004 å¹´ 1 æä»½å·²ç»æ 20 äººå·¦å³ä½¿ç¨è¿ä¸ªé¡¹ç®ãéçæ´å¤äººçå å¥ï¼å¨ 2004 å¹´ 3 æå·¦å³å¨ sourceforge ä¸­å»ºç«äºä¸ä¸ªé¡¹ç®ãå¨æå¼å§å¹¶æ²¡æè®¤è¯æ¨¡åï¼ææçè®¤è¯åè½é½æ¯ä¾èµå®¹å¨å®æçï¼è acegi åæ³¨éææãä½æ¯éçæ´å¤äººçä½¿ç¨ï¼åºäºå®¹å¨çè®¤è¯å°±æ¾ç°åºäºä¸è¶³ãacegi ä¸­ä¹å å¥äºè®¤è¯åè½ãå¤§çº¦ 1 å¹´å acegi æä¸º springå­é¡¹ç®ãå¨ 2006 å¹´ 5 æåå¸äº acegi 1.0.0 çæ¬ã2007 å¹´åº acegi æ´åä¸ºspring securityã\n\n\n# å¿«éå¥é¨\n\n# å¯¼å¥ä¾èµ\n\n<?xml version="1.0" encoding="utf-8"?>\n<project xmlns="http://maven.apache.org/pom/4.0.0" xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n         xsi:schemalocation="http://maven.apache.org/pom/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">\n   <modelversion>4.0.0</modelversion>\n   <parent>\n      <groupid>org.springframework.boot</groupid>\n      <artifactid>spring-boot-starter-parent</artifactid>\n      <version>2.2.2.release</version>\n      <relativepath/> \x3c!-- lookup parent from repository --\x3e\n   </parent>\n  \n   <groupid>com.yjxxt</groupid>\n   <artifactid>springsecurity-demo</artifactid>\n   <version>0.0.1-snapshot</version>\n   <name>springsecurity-demo</name>\n   <description>demo project for spring boot</description>\n\n   <properties>\n      <java.version>1.8</java.version>\n   </properties>\n\n   <dependencies>\n      \x3c!--spring security ç»ä»¶--\x3e\n      <dependency>\n         <groupid>org.springframework.boot</groupid>\n         <artifactid>spring-boot-starter-security</artifactid>\n      </dependency>\n      \x3c!--web ç»ä»¶--\x3e\n      <dependency>\n         <groupid>org.springframework.boot</groupid>\n         <artifactid>spring-boot-starter-web</artifactid>\n      </dependency>\n      \x3c!-- test ç»ä»¶--\x3e\n      <dependency>\n         <groupid>org.springframework.boot</groupid>\n         <artifactid>spring-boot-starter-test</artifactid>\n         <scope>test</scope>\n         <exclusions>\n            <exclusion>\n               <groupid>org.junit.vintage</groupid>\n               <artifactid>junit-vintage-engine</artifactid>\n            </exclusion>\n         </exclusions>\n      </dependency>\n      <dependency>\n         <groupid>org.springframework.security</groupid>\n         <artifactid>spring-security-test</artifactid>\n         <scope>test</scope>\n      </dependency>\n   </dependencies>\n\n   <build>\n      <plugins>\n         <plugin>\n            <groupid>org.springframework.boot</groupid>\n            <artifactid>spring-boot-maven-plugin</artifactid>\n         </plugin>\n      </plugins>\n   </build>\n</project>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n\n\n# åç«¯é¡µé¢\n\nlogin.html\n\n<!doctype html>\n<html lang="en">\n<head>\n    <meta charset="utf-8">\n    <title>title</title>\n</head>\n<body>\n<form action="/login" method="post">\n    ç¨æ·åï¼<input type="text" name="username" /><br/>\n    å¯ç ï¼<input type="password" name="password" /><br/>\n    <input type="submit" value="ç»å½" />\n</form>\n</body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n# è®¿é®é¡µé¢\n\nå¯¼å¥spring-boot-starter-security å¯å¨å¨åï¼spring security å·²ç»çæï¼é»è®¤æ¦æªå¨é¨è¯·æ±ï¼å¦æç¨æ·æ²¡æç»å½ï¼è·³è½¬å°åç½®ç»å½é¡µé¢ã\n\n\n\né»è®¤ç username ä¸º userï¼password æå°å¨æ§å¶å°ä¸­ã\n\n\n\nå¨æµè§å¨ä¸­è¾å¥è´¦å·åå¯ç åä¼æ¾ç¤º login.html é¡µé¢åå®¹ã\n\n\n# userdetailsserviceè¯¦è§£\n\nå½ä»ä¹ä¹æ²¡æéç½®çæ¶åï¼è´¦å·åå¯ç æ¯ç± spring security å®ä¹çæçãèå¨å®éé¡¹ç®ä¸­è´¦å·åå¯ç é½æ¯ä»æ°æ®åºä¸­æ¥è¯¢åºæ¥çãæä»¥æä»¬è¦éè¿èªå®ä¹é»è¾æ§å¶è®¤è¯é»è¾ãå¦æéè¦èªå®ä¹é»è¾æ¶ï¼åªéè¦å®ç° userdetailsservice æ¥å£å³å¯ãæ¥å£å®ä¹å¦ä¸ï¼\n\n\n\n# è¿åå¼\n\nè¿åå¼ userdetails æ¯ä¸ä¸ªæ¥å£ï¼å®ä¹å¦ä¸\n\n\n\nè¦æ³è¿å userdetailsçå®ä¾å°±åªè½è¿åæ¥å£çå®ç°ç±»ãspringsecurity ä¸­æä¾äºå¦ä¸çå®ä¾ãå¯¹äºæä»¬åªéè¦ä½¿ç¨éé¢ç userç±»å³å¯ãæ³¨æ user çå¨éå®è·¯å¾æ¯ï¼\n\norg.springframework.security.core.userdetails.useræ­¤å¤ç»å¸¸åç³»ç»ä¸­èªå·±å¼åç user ç±»å¼æ··ã\n\n\n\nå¨ user ç±»ä¸­æä¾äºå¾å¤æ¹æ³åå±æ§ã\n\n\n\nå¶ä¸­æé æ¹æ³æä¸¤ä¸ªï¼è°ç¨å¶ä¸­ä»»ä½ä¸ä¸ªé½å¯ä»¥å®ä¾åuserdetailså®ç°ç±» userç±»çå®ä¾ãèä¸ä¸ªåæ°çæé æ¹æ³å®éä¸ä¹æ¯è°ç¨ 7 ä¸ªåæ°çæé æ¹æ³ã\n\n * username:ç¨æ·å\n\n * password:å¯ç \n\n * authoritiesï¼ç¨æ·å·æçæéãæ­¤å¤ä¸åè®¸ä¸º null\n\n\n\nspring security ä¼æ ¹æ® user ä¸­ç passwordåå®¢æ·ç«¯ä¼ éè¿æ¥ç passwordè¿è¡æ¯è¾ãå¦æç¸ååè¡¨ç¤ºè®¤è¯éè¿ï¼å¦æä¸ç¸åè¡¨ç¤ºè®¤è¯å¤±è´¥ã\n\nauthoritieséé¢çæéå¯¹äºåé¢å­¦ä¹ æææ¯å¾æå¿è¦çï¼åå«çææåå®¹ä¸ºæ­¤ç¨æ·å·æçæéï¼å¦æéé¢æ²¡æåå«æä¸ªæéï¼èå¨åæä¸ªäºææ¶å¿é¡»åå«æä¸ªæéåä¼åºç° 403ã\n\néå¸¸é½æ¯éè¿authorityutils.commaseparatedstringtoauthoritylist(ââ) æ¥åå»ºauthorities éåå¯¹è±¡çãåæ°æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼å¤ä¸ªæéä½¿ç¨éå·åéã\n\n# æ¹æ³åæ°\n\næ¹æ³åæ°è¡¨ç¤ºç¨æ·åãæ­¤å¼æ¯å®¢æ·ç«¯è¡¨åä¼ éè¿æ¥çæ°æ®ãé»è®¤æåµä¸å¿é¡»å« usernameï¼å¦åæ æ³æ¥æ¶ã\n\n# å¼å¸¸\n\nusernamenotfoundexceptionç¨æ·åæ²¡æåç°å¼å¸¸ãå¨loaduserbyusernameä¸­æ¯éè¦éè¿èªå·±çé»è¾ä»æ°æ®åºä¸­åå¼çãå¦æéè¿ç¨æ·åæ²¡ææ¥è¯¢å°å¯¹åºçæ°æ®ï¼åºè¯¥æåºusernamenotfoundexceptionï¼ç³»ç»å°±ç¥éç¨æ·åæ²¡ææ¥è¯¢å°ã\n\n\n# passwordencoder å¯ç è§£æå¨è¯¦è§£\n\nspring security è¦æ±å®¹å¨ä¸­å¿é¡»æpasswordencoderå®ä¾ãæä»¥å½èªå®ä¹ç»å½é»è¾æ¶è¦æ±å¿é¡»ç»å®¹å¨æ³¨å¥paswordencoderçbeanå¯¹è±¡ã\n\n# æ¥å£ä»ç»\n\n * encode()ï¼æåæ°æç§ç¹å®çè§£æè§åè¿è¡è§£æã\n\n * matches() ï¼éªè¯ä»å­å¨ä¸­è·åçå¯ç ï¼ç¼ç è¿çï¼ä¸è¡¨åæäº¤çåå§å¯ç ï¼æªç¼ç ï¼æ¯å¦å¹éãå¦æå¯ç å¹éï¼åè¿å trueï¼å¦æä¸å¹éï¼åè¿å falseãç¬¬ä¸ä¸ªåæ°è¡¨ç¤ºéè¦è¡¨åä¼ è¿æ¥çåå§å¯ç ãç¬¬äºä¸ªåæ°è¡¨ç¤ºå­å¨çç¼ç å¯ç ã\n\n * upgradeencoding()ï¼å¦æè§£æçå¯ç è½å¤åæ¬¡è¿è¡è§£æä¸è¾¾å°æ´å®å¨çç»æåè¿å trueï¼å¦åè¿å falseãé»è®¤è¿å falseã\n\n\n\n# åç½®è§£æå¨ä»ç»\n\nå¨ spring security ä¸­åç½®äºå¾å¤è§£æå¨ã\n\n\n\n# bcryptpasswordencoder ç®ä»\n\nbcryptpasswordencoder æ¯ spring security å®æ¹æ¨èçå¯ç è§£æå¨ï¼å¹³æ¶å¤ä½¿ç¨è¿ä¸ªè§£æå¨ã\n\nbcryptpasswordencoder æ¯å¯¹ bcryptå¼ºæ£åæ¹æ³çå·ä½å®ç°ãæ¯åºäºhashç®æ³å®ç°çååå å¯ãå¯ä»¥éè¿strengthæ§å¶å å¯å¼ºåº¦ï¼é»è®¤ 10.\n\n# ä»£ç æ¼ç¤º\n\næ°å»ºæµè¯æ¹æ³bcryptpasswordencoder ç¨æ³ã\n\npackage com.yjxxt.springsecuritydemo;\n\nimport org.junit.jupiter.api.test;\nimport org.springframework.boot.test.context.springboottest;\nimport org.springframework.security.crypto.bcrypt.bcryptpasswordencoder;\nimport org.springframework.security.crypto.password.passwordencoder;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@springboottest\npublic class mytest {\n\n   @test\n   public void test(){\n      //åå»ºè§£æå¨\n      passwordencoder pw = new bcryptpasswordencoder();\n      //å¯¹å¯ç å å¯\n      string encode = pw.encode("123");\n      system.out.println(encode);\n\n      //å¤æ­åå­ç¬¦åå å¯ååå®¹æ¯å¦å¹é\n      boolean matches = pw.matches("1234", encode);\n      system.out.println("==================="+matches);\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n\n\n# èªå®ä¹ç»å½é»è¾\n\nå½ è¿ è¡ èª å® ä¹ ç» å½ é» è¾ æ¶ é è¦ ç¨ å° ä¹ å è®² è§£ çuserdetailsserviceå passwordencoderãä½æ¯ spring security è¦æ±ï¼å½è¿è¡èªå®ä¹ç»å½é»è¾æ¶å®¹å¨åå¿é¡»æ passwordencoderå®ä¾ãæä»¥ä¸è½ç´æ¥ new å¯¹è±¡ã\n\n# ç¼åéç½®ç±»\n\npackage com.yjxxt.springsecuritydemo.config;\n\nimport org.springframework.context.annotation.bean;\nimport org.springframework.context.annotation.configuration;\nimport org.springframework.security.crypto.bcrypt.bcryptpasswordencoder;\nimport org.springframework.security.crypto.password.passwordencoder;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@configuration\npublic class securityconfig {\n\n   @bean\n   public passwordencoder getpw(){\n      return new bcryptpasswordencoder();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n# èªå®ä¹é»è¾\n\nå¨ spring security ä¸­å®ç° userdetailservice å°±è¡¨ç¤ºä¸ºç¨æ·è¯¦ææå¡ãå¨è¿ä¸ªç±»ä¸­ç¼åç¨æ·è®¤è¯é»è¾ã\n\npackage com.yjxxt.springsecuritydemo.service;\n\nimport org.springframework.beans.factory.annotation.autowired;\nimport org.springframework.security.core.authority.authorityutils;\nimport org.springframework.security.core.userdetails.user;\nimport org.springframework.security.core.userdetails.userdetails;\nimport org.springframework.security.core.userdetails.userdetailsservice;\nimport org.springframework.security.core.userdetails.usernamenotfoundexception;\nimport org.springframework.security.crypto.password.passwordencoder;\nimport org.springframework.stereotype.service;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@service\npublic class userserviceimpl implements userdetailsservice {\n   @autowired\n   private passwordencoder pw;\n\n   @override\n   public userdetails loaduserbyusername(string username) throws usernamenotfoundexception {\n      //1.æ¥è¯¢æ°æ®åºå¤æ­ç¨æ·åæ¯å¦å­å¨ï¼å¦æä¸å­å¨æåºusernamenotfoundexceptionå¼å¸¸\n      if (!"admin".equals(username)){\n         throw new usernamenotfoundexception("ç¨æ·åä¸å­å¨");\n      }\n      //2.ææ¥è¯¢åºæ¥çå¯ç ï¼æ³¨åæ¶å·²ç»å å¯è¿ï¼è¿è¡è§£æï¼æç´æ¥æå¯ç æ¾å¥æé æ¹æ³ä¸­\n      string password = pw.encode("123");\n      return new user(username,password, authorityutils.commaseparatedstringtoauthoritylist("admin,normal"));\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n\n\n# æ¥çææ\n\néå¯é¡¹ç®åï¼å¨æµè§å¨ä¸­è¾å¥è´¦å·ï¼adminï¼å¯ç ï¼123ãåå¯ä»¥æ­£ç¡®è¿å¥å° login.html é¡µé¢ã\n\n\n# èªå®ä¹ç»å½é¡µé¢\n\nè½ç¶ spring security ç»æä»¬æä¾äºç»å½é¡µé¢ï¼ä½æ¯å¯¹äºå®éé¡¹ç®ä¸­ï¼å¤§å¤åæ¬¢ä½¿ç¨èªå·±çç»å½é¡µé¢ãæä»¥ spring security ä¸­ä¸ä»ä»æä¾äºç»å½é¡µé¢ï¼è¿æ¯æç¨æ·èªå®ä¹ç»å½é¡µé¢ãå®ç°è¿ç¨ä¹æ¯è¾ç®åï¼åªéè¦ä¿®æ¹éç½®ç±»å³å¯ã\n\n# ç¼åç»å½é¡µé¢\n\nlogin.html\n\n<!doctype html>\n<html lang="en">\n<head>\n    <meta charset="utf-8">\n    <title>title</title>\n</head>\n<body>\n<form action="/login1" method="post">\n    ç¨æ·åï¼<input type="text" name="username" /><br/>\n    å¯ç ï¼<input type="password" name="password" /><br/>\n    <input type="submit" value="ç»å½" />\n</form>\n</body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n# ä¿®æ¹éç½®ç±»\n\nä¿®æ¹éç½®ç±»ä¸­ä¸»è¦æ¯è®¾ç½®åªä¸ªé¡µé¢æ¯ç»å½é¡µé¢ãéç½®ç±»éè¦ç»§æ¿websecurityconfigureradapter,å¹¶éå configure æ¹æ³ã\n\n * successforwardurl()ï¼ç»å½æååè½¬åå°å\n\n * loginpage() ï¼æå®ç»å½é¡µé¢\n\n * loginprocessingurlï¼æå®åç«¯å¤çç»å½è¯·æ±ççæ¹æ³ï¼å¿é¡»åè¡¨åç»éé¡µé¢ä¸­çactionå±æ§ä¿æä¸è´\n\n * antmatchers()ï¼å¹éåå®¹\n\n * permitall()ï¼åè®¸\n\npackage com.yjxxt.springsecuritydemo.config;\n\nimport org.springframework.context.annotation.bean;\nimport org.springframework.context.annotation.configuration;\nimport org.springframework.security.config.annotation.web.builders.httpsecurity;\nimport org.springframework.security.config.annotation.web.configuration.websecurityconfigureradapter;\nimport org.springframework.security.crypto.bcrypt.bcryptpasswordencoder;\nimport org.springframework.security.crypto.password.passwordencoder;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@configuration\npublic class securityconfig extends websecurityconfigureradapter {\n\n   @override\n   protected void configure(httpsecurity http) throws exception {\n      //è¡¨åæäº¤\n      http.formlogin()\n            //èªå®ä¹ç»å½é¡µé¢\n            .loginpage("/login.html")\n            //å½åç°/loginæ¶è®¤ä¸ºæ¯ç»å½ï¼å¿é¡»åè¡¨åæäº¤çå°åä¸æ ·ãå»æ§è¡userserviceimpl\n            .loginprocessingurl("/login1")\n            //ç»å½æååè·³è½¬é¡µé¢ï¼postè¯·æ±\n            .successforwardurl("/tomain");\n\n\n      http.authorizerequests()\n            //login.htmlä¸éè¦è¢«è®¤è¯\n            .antmatchers("/login.html").permitall()\n            //ææè¯·æ±é½å¿é¡»è¢«è®¤è¯ï¼å¿é¡»ç»å½åè¢«è®¿é®\n            .anyrequest().authenticated();\n\n      //å³é­csrfé²æ¤\n      http.csrf().disable();\n   }\n\n   @bean\n   public passwordencoder getpw(){\n      return new bcryptpasswordencoder();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n\n\n# ç¼åæ§å¶å¨\n\npackage com.yjxxt.springsecuritydemo.controller;\n\nimport org.springframework.stereotype.controller;\nimport org.springframework.web.bind.annotation.requestmapping;\n\n/**\n * ç»å½\n *\n * @author zhoubin\n * @since 1.0.0\n */\n@controller\npublic class logincontroller {\n   // è¯¥æ¹æ³ä¸æ§è¡ï¼å ä¸ºç»å½è¯·æ±é½æ¯è¢«åç§è¿æ»¤å¨æåæ§è¡çï¼å°ä¸äºè¿é\n   // @requestmapping("/login")\n   // public string login(){\n   //     system.out.println("ç»å½æ¹æ³");\n   //     return "main.html";\n   // }\n\n   /**\n    * æååè·³è½¬é¡µé¢\n    * @return\n    */\n   @requestmapping("/tomain")\n   public string tomain(){\n      return "redirect:/main.html";\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\n\n# è®¤è¯è¿ç¨å¶ä»å¸¸ç¨éç½®\n\n# å¤±è´¥è·³è½¬\n\nè¡¨åå¤çä¸­æåä¼è·³è½¬å°ä¸ä¸ªå°åï¼å¤±è´¥ä¹å¯ä»¥è·³è½¬å°ä¸ä¸ªå°åã\n\nç¼åé¡µé¢error.html\n\n<!doctype html>\n<html lang="en">\n<head>\n    <meta charset="utf-8">\n    <title>title</title>\n</head>\n<body>\næä½å¤±è´¥ï¼è¯·éæ°ç»å½ <a href= "/login.html">è·³è½¬</a>\n</body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¿®æ¹è¡¨åéç½®\n\nå¨éç½®æ¹æ³ä¸­è¡¨åè®¤è¯é¨åæ·»å failureforwardurl()æ¹æ³ï¼è¡¨ç¤ºç»å½å¤±è´¥è·³è½¬ç urlãæ­¤å¤ä¾ç¶æ¯ post è¯·æ±ï¼æä»¥è·³è½¬å°å¯ä»¥æ¥æ¶ postè¯·æ±çæ§å¶å¨ä¸­ã\n\n//è¡¨åæäº¤\nhttp.formlogin()\n      //èªå®ä¹ç»å½é¡µé¢\n      .loginpage("/login.html")\n      //å½åç°/loginæ¶è®¤ä¸ºæ¯ç»å½ï¼å¿é¡»åè¡¨åæäº¤çå°åä¸æ ·ãå»æ§è¡userserviceimpl\n      .loginprocessingurl("/login1")\n      //ç»å½æååè·³è½¬é¡µé¢ï¼postè¯·æ±\n      .successforwardurl("/tomain")\n      //ç»å½å¤±è´¥åè·³è½¬é¡µé¢ï¼postè¯·æ±\n      .failureforwardurl("/toerror");\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\næ·»å æ§å¶å¨çæ¹æ³\n\nå¨æ§å¶å¨ç±»ä¸­æ·»å æ§å¶å¨æ¹æ³ï¼æ¹æ³æ å°è·¯å¾/toerrorãæ­¤å¤è¦æ³¨æï¼ç±äºæ¯ post è¯·æ±è®¿é®/toerrorãæä»¥å¦æè¿åå¼ç´æ¥è½¬åå° error.html ä¸­ï¼æ§å¶å°ä¼æ¥è­¦åï¼æç¤º error.html ä¸æ¯æ post è®¿é®æ¹å¼ãæä»¥å¿é¡»ç¨éå®åã\n\n/**\n * å¤±è´¥åè·³è½¬é¡µé¢\n * @return\n */\n@requestmapping("/toerror")\npublic string toerror(){\n   return "redirect:/error.html";\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nè®¾ç½®error.htmlä¸éè¦è®¤è¯\n\nhttp.authorizerequests()\n      //login.htmlä¸éè¦è¢«è®¤è¯\n      .antmatchers("/login.html").permitall()\n      //error.htmlä¸éè¦è¢«è®¤è¯\n      .antmatchers("/error.html").permitall()\n      //ææè¯·æ±é½å¿é¡»è¢«è®¤è¯ï¼å¿é¡»ç»å½åè¢«è®¿é®\n      .anyrequest().authenticated();\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n# è®¾ç½®è¯·æ±è´¦æ·åå¯ç çåæ°å\n\næºç ç®ä»\n\nå½è¿è¡ç»å½æ¶ä¼æ§è¡ usernamepasswordauthenticationfilter è¿æ»¤å¨ã\n\n * usernamepasrameterï¼è´¦æ·åæ°å\n\n * passwordparameterï¼å¯ç åæ°å\n\n * postonly=trueï¼é»è®¤æåµä¸åªåè®¸postè¯·æ±ã\n\n\n\nä¿®æ¹éç½®\n\n//è¡¨åæäº¤\nhttp.formlogin()\n      //èªå®ä¹ç»å½é¡µé¢\n      .loginpage("/login.html")\n      //å½åç°/loginæ¶è®¤ä¸ºæ¯ç»å½ï¼å¿é¡»åè¡¨åæäº¤çå°åä¸æ ·ãå»æ§è¡userserviceimpl\n      .loginprocessingurl("/login1")\n      //ç»å½æååè·³è½¬é¡µé¢ï¼postè¯·æ±\n      .successforwardurl("/tomain")\n      //ç»å½å¤±è´¥åè·³è½¬é¡µé¢ï¼postè¯·æ±\n      .failureforwardurl("/toerror")\n      .usernameparameter("myusername")\n      .passwordparameter("mypassword");\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¿®æ¹login.html\n\n<form action="/login1" method="post">\n    ç¨æ·åï¼<input type="text" name="myusername" /><br/>\n    å¯ç ï¼<input type="password" name="mypassword" /><br/>\n    <input type="submit" value="ç»å½" />\n</form>\n\n\n1\n2\n3\n4\n5\n\n\n# èªå®ä¹ç»å½æåå¤çå¨\n\næºç åæ\n\nä½¿ç¨successforwardurl()æ¶è¡¨ç¤ºæååè½¬åè¯·æ±å°å°åãåé¨æ¯éè¿ successhandler()æ¹æ³è¿è¡æ§å¶æååäº¤ç»åªä¸ªç±»è¿è¡å¤ç\n\n\n\nforwardauthenticationsuccesshandleråé¨å°±æ¯æç®åçè¯·æ±è½¬åãç±äºæ¯è¯·æ±è½¬åï¼å½éå°éè¦è·³è½¬å°ç«å¤æå¨ååç«¯åç¦»çé¡¹ç®ä¸­å°±æ æ³ä½¿ç¨äºã\n\n\n\nå½éè¦æ§å¶ç»å½æååå»åä¸äºäºææ¶ï¼å¯ä»¥è¿è¡èªå®ä¹è®¤è¯æåæ§å¶å¨ã\n\nä»£ç å®ç°\n\næ°å»ºç±» com.yjxxt.handler.myauthenticationsuccesshandler ç¼åå¦ä¸ï¼\n\npackage com.yjxxt.springsecuritydemo.handler;\n\nimport org.springframework.security.core.authentication;\nimport org.springframework.security.core.userdetails.user;\nimport org.springframework.security.web.authentication.authenticationsuccesshandler;\n\nimport javax.servlet.servletexception;\nimport javax.servlet.http.httpservletrequest;\nimport javax.servlet.http.httpservletresponse;\nimport java.io.ioexception;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\npublic class myauthenticationsuccesshandler implements authenticationsuccesshandler {\n\n   private string url;\n\n   public myauthenticationsuccesshandler(string url) {\n      this.url = url;\n   }\n\n   @override\n   public void onauthenticationsuccess(httpservletrequest request, httpservletresponse response, authentication authentication) throws ioexception, servletexception {\n      //principal ä¸»ä½ï¼å­æ¾äºç»å½ç¨æ·çä¿¡æ¯\n      user user = (user) authentication.getprincipal();\n      system.out.println(user.getusername());\n      //è¾åºnull\n      system.out.println(user.getpassword());\n      system.out.println(user.getauthorities());\n      response.sendredirect(url);\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n\n\nä¿®æ¹éç½®é¡¹\n\nä½¿ç¨ successhandler()æ¹æ³è®¾ç½®æååäº¤ç»åªä¸ªå¯¹è±¡è¿è¡å¤ç\n\n//è¡¨åæäº¤\nhttp.formlogin()\n      //èªå®ä¹ç»å½é¡µé¢\n      .loginpage("/login.html")\n      //å½åç°/login1æ¶è®¤ä¸ºæ¯ç»å½ï¼å¿é¡»åè¡¨åæäº¤çå°åä¸æ ·ãå»æ§è¡userserviceimpl\n      .loginprocessingurl("/login1")\n      //ç»å½æååè·³è½¬é¡µé¢ï¼postè¯·æ±\n      // .successforwardurl("/tomain")\n      //åsuccessforwardurlä¸è½å±å­\n      .successhandler(new myauthenticationsuccesshandler("http://www.baidu.com"))\n      //ç»å½å¤±è´¥åè·³è½¬é¡µé¢ï¼postè¯·æ±\n      .failureforwardurl("/toerror")\n      .usernameparameter("myusername")\n      .passwordparameter("mypassword");\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n# èªå®ä¹ç»å½å¤±è´¥å¤çå¨\n\næºç åæ\n\nfailureforwardurl()åé¨è°ç¨çæ¯failurehandler()æ¹æ³\n\n\n\nforwardauthenticationfailurehandler ä¸­ä¹æ¯ä¸ä¸ªè¯·æ±è½¬åï¼å¹¶å¨request ä½ç¨åä¸­è®¾ç½® spring_security_last_exceptionç keyï¼åå®¹ä¸ºå¼å¸¸å¯¹è±¡ã\n\n\n\nä»£ç å®ç°\n\næ°å»ºæ§å¶å¨\n\næ°å»º com.yjxxt.handler.myforwardauthenticationfailurehandler å®ç°authenticationfailurehandlerãå¨æ¹æ³ä¸­æ·»å éå®åè¯­å¥\n\npackage com.yjxxt.springsecuritydemo.handler;\n\nimport org.springframework.security.core.authenticationexception;\nimport org.springframework.security.web.authentication.authenticationfailurehandler;\n\nimport javax.servlet.servletexception;\nimport javax.servlet.http.httpservletrequest;\nimport javax.servlet.http.httpservletresponse;\nimport java.io.ioexception;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\npublic class myforwardauthenticationfailurehandler implements authenticationfailurehandler {\n\n   private string url;\n\n   public myforwardauthenticationfailurehandler(string url) {\n      this.url = url;\n   }\n\n   @override\n   public void onauthenticationfailure(httpservletrequest request, httpservletresponse response, authenticationexception exception) throws ioexception, servletexception {\n      response.sendredirect(url);\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n\n\nä¿®æ¹éç½®ç±»\n\nä¿®æ¹éç½®ç±»ä¸­è¡¨åç»å½é¨åãè®¾ç½®å¤±è´¥æ¶äº¤ç»å¤±è´¥å¤çå¨è¿è¡æä½ãfailureforwardurlå failurehandlerä¸å¯å±å­\n\n//è¡¨åæäº¤\nhttp.formlogin()\n      //èªå®ä¹ç»å½é¡µé¢\n      .loginpage("/login.html")\n      //å½åç°/loginæ¶è®¤ä¸ºæ¯ç»å½ï¼å¿é¡»åè¡¨åæäº¤çå°åä¸æ ·ãå»æ§è¡userserviceimpl\n      .loginprocessingurl("/login")\t\n      //ç»å½æååè·³è½¬é¡µé¢ï¼postè¯·æ±\n      // .successforwardurl("/tomain")\n      //åsuccessforwardurlä¸è½å±å­\n      .successhandler(new myauthenticationsuccesshandler("http://www.baidu.com"))\n      //ç»å½å¤±è´¥åè·³è½¬é¡µé¢ï¼postè¯·æ±\n      // .failureforwardurl("/toerror")\n      .failurehandler(new myforwardauthenticationfailurehandler("/error.html"))\n      .usernameparameter("myusername")\n      .passwordparameter("mypassword");\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# è®¿é®æ§å¶urlå¹é\n\nå¨åé¢è®²è§£äºè®¤è¯ä¸­ææå¸¸ç¨éç½®ï¼ä¸»è¦æ¯å¯¹http.formlogin()è¿è¡æä½ãèå¨éç½®ç±»ä¸­ http.authorizerequests()ä¸»è¦æ¯å¯¹urlè¿è¡æ§å¶ï¼ä¹å°±æ¯æä»¬æè¯´çææï¼è®¿é®æ§å¶ï¼ãhttp.authorizerequests()ä¹æ¯æè¿ç¼åæ³ï¼æ»ä½å¬å¼ä¸ºï¼\n\nãurlå¹éè§åã.ãæéæ§å¶æ¹æ³ã\n\néè¿ä¸é¢çå¬å¼å¯ä»¥æå¾å¤ url å¹éè§ååå¾å¤æéæ§å¶æ¹æ³ãè¿äºåå®¹è¿è¡åç§ç»åå°±å½¢æäºspring securityä¸­çææã\n\nå¨ææå¹éè§åä¸­åææè§åçäº¤éãéç½®é¡ºåºå½±åäºä¹åææææï¼è¶æ¯å·ä½çåºè¯¥æ¾å¨åé¢ï¼è¶æ¯ç¬¼ç»çåºè¯¥æ¾å°åé¢ã\n\n# anyrequest()\n\nå¨ä¹åè®¤è¯è¿ç¨ä¸­æä»¬å°±å·²ç»ä½¿ç¨è¿ anyrequest()ï¼è¡¨ç¤ºå¹éææçè¯·æ±ãä¸è¬æåµä¸æ­¤æ¹æ³é½ä¼ä½¿ç¨ï¼è®¾ç½®å¨é¨åå®¹é½éè¦è¿è¡è®¤è¯ã\n\n.anyrequest().authenticated();\n\n\n1\n\n\n# antmatcher()\n\næ¹æ³å®ä¹å¦ä¸\n\npublic c antmatchers(string... antpatterns)\n\n\n1\n\n\nåæ°æ¯ä¸å®ååæ°ï¼æ¯ä¸ªåæ°æ¯ä¸ä¸ª ant è¡¨è¾¾å¼ï¼ç¨äºå¹é urlè§åã\n\nè§åå¦ä¸ï¼\n\n * ?ï¼ å¹éä¸ä¸ªå­ç¬¦\n\n * *ï¼å¹é 0 ä¸ªæå¤ä¸ªå­ç¬¦\n\n * ** ï¼å¹é 0 ä¸ªæå¤ä¸ªç®å½\n\nå¨å®éé¡¹ç®ä¸­ç»å¸¸éè¦æ¾è¡ææéæèµæºï¼ä¸é¢æ¼ç¤ºæ¾è¡ js æä»¶å¤¹ä¸ææèæ¬æä»¶ã\n\n.antmatchers("/js/**","/css/**").permitall()\n\n\n1\n\n\nè¿æä¸ç§éç½®æ¹å¼æ¯åªè¦æ¯.js æä»¶é½æ¾è¡\n\n.antmatchers("/**/*.js").permitall()\n\n\n1\n\n\n# regexmatchers()\n\n# ä»ç»\n\nä½¿ç¨æ­£åè¡¨è¾¾å¼è¿è¡å¹éãå antmatchers()ä¸»è¦çåºå«å°±æ¯åæ°ï¼antmatchers()åæ°æ¯ ant è¡¨è¾¾å¼ï¼regexmatchers()åæ°æ¯æ­£åè¡¨è¾¾å¼ã\n\næ¼ç¤ºææä»¥.js ç»å°¾çæä»¶é½è¢«æ¾è¡ã\n\n.regexmatchers( ".+[.]js").permitall()\n\n\n1\n\n\n# ä¸¤ä¸ªåæ°æ¶ä½¿ç¨æ¹å¼\n\næ è®ºæ¯antmatchers()è¿æ¯regexmatchers()é½å·æä¸¤ä¸ªåæ°çæ¹æ³ï¼å¶ä¸­ç¬¬ä¸ä¸ªåæ°é½æ¯ httpmethodï¼è¡¨ç¤ºè¯·æ±æ¹å¼ï¼å½è®¾ç½®äºhttpmethodåè¡¨ç¤ºåªæè®¾å®çç¹å®çè¯·æ±æ¹å¼ææ§è¡å¯¹åºçæéè®¾ç½®ã\n\næä¸¾ç±»å httpmethodåç½®å±æ§å¦ä¸ï¼\n\n\n\n# mvcmatchers()\n\nmvcmatchers()éç¨äºéç½®äº servletpath çæåµã\n\nservletpath å°±æ¯ææç url çç»ä¸åç¼ãå¨ springboot æ´åspringmvc çé¡¹ç®ä¸­å¯ä»¥å¨ application.properties ä¸­æ·»å ä¸é¢åå®¹è®¾ç½® servletpath\n\nspring.mvc.servlet.path=/yjxxt\n\n\n1\n\n\nå¨ spring security çéç½®ç±»ä¸­éç½®servletpath()æ¯ mvcmatchers()è¿åå¼ç¹æçæ¹æ³ï¼antmatchers()å regexmatchers()æ²¡æè¿ä¸ªæ¹æ³ãå¨servletpath()ä¸­éç½®äºservletpathåï¼mvcmatchers()ç´æ¥å springmvc ä¸­@requestmapping()ä¸­è®¾ç½®çè·¯å¾å³å¯ã\n\n.mvcmatchers("/demo").servletpath("/yjxxt").permitall()\n\n\n1\n\n\nå¦æä¸ä¹ æ¯ä½¿ç¨ mvcmatchers()ä¹å¯ä»¥ä½¿ç¨ antmatchers()ï¼ä¸é¢ä»£ç åä¸é¢ä»£ç æ¯ç­æ\n\n.antmatchers("/yjxxt/demo").permitall()\n\n\n1\n\n\n\n# åç½®è®¿é®æ§å¶æ¹æ³\n\nspring security å¹éäº url åè°ç¨äºpermitall()è¡¨ç¤ºä¸éè¦è®¤è¯ï¼éæè®¿é®ãå¨ spring security ä¸­æä¾äºå¤ç§åç½®æ§å¶ã\n\n# permitall()\n\npermitall()è¡¨ç¤ºæå¹éç url ä»»ä½äººé½åè®¸è®¿é®ã\n\n\n\n# authenticated()\n\nauthenticated()è¡¨ç¤ºæå¹éç url é½éè¦è¢«è®¤è¯æè½è®¿é®ã\n\n\n\n# anonymous()\n\nanonymous()è¡¨ç¤ºå¯ä»¥å¿åè®¿é®å¹éçurlãåpermitall()ææç±»ä¼¼ï¼åªæ¯è®¾ç½®ä¸º anonymous()ç url ä¼æ§è¡ filter é¾ä¸­\n\n\n\n# denyall()\n\ndenyall()è¡¨ç¤ºæå¹éç url é½ä¸åè®¸è¢«è®¿é®ã\n\n\n\n# rememberme()\n\nè¢«âremember meâçç¨æ·åè®¸è®¿é®\n\n\n\n# fullyauthenticated()\n\nå¦æç¨æ·ä¸æ¯è¢« remember me çï¼æå¯ä»¥è®¿é®ã\n\n\n\n\n# è§è²æéå¤æ­\n\né¤äºä¹åè®²è§£çåç½®æéæ§å¶ãspring security ä¸­è¿æ¯æå¾å¤å¶ä»æéæ§å¶ãè¿äºæ¹æ³ä¸è¬é½ç¨äºç¨æ·å·²ç»è¢«è®¤è¯åï¼å¤æ­ç¨æ·æ¯å¦å·æç¹å®çè¦æ±ã\n\n# hasauthority(string)\n\nå¤æ­ç¨æ·æ¯å¦å·æç¹å®çæéï¼ç¨æ·çæéæ¯å¨èªå®ä¹ç»å½é»è¾ä¸­åå»º user å¯¹è±¡æ¶æå®çãä¸å¾ä¸­ adminånormal å°±æ¯ç¨æ·çæéãadminånormal ä¸¥æ ¼åºåå¤§å°åã\n\n\n\nå¨éç½®ç±»ä¸­éè¿ hasauthority(âadminâ)è®¾ç½®å·æ admin æéæ¶æè½è®¿é®ã\n\n.antmatchers("/main1.html").hasauthority("admin")\n\n\n1\n\n\n# hasanyauthority(string ...)\n\nå¦æç¨æ·å·å¤ç»å®æéä¸­æä¸ä¸ªï¼å°±åè®¸è®¿é®ã\n\nä¸é¢ä»£ç ä¸­ç±äºå¤§å°ååç¨æ·çæéä¸ç¸åï¼æä»¥ç¨æ·æ æè®¿é®\n\n.antmatchers("/main1.html").hasanyauthority("admin","admin")\n\n\n1\n\n\n# hasrole(string)\n\nå¦æç¨æ·å·å¤ç»å®è§è²å°±åè®¸è®¿é®ãå¦ååºç° 403ã\n\nåæ°åå¼æ¥æºäºèªå®ä¹ç»å½é»è¾ userdetailsserviceå®ç°ç±»ä¸­åå»º user å¯¹è±¡æ¶ç» user èµäºçææã\n\nå¨ç»ç¨æ·èµäºè§è²æ¶è§è²éè¦ä»¥ï¼role_å¼å¤´ï¼åé¢æ·»å è§è²åç§°ãä¾å¦ï¼role_abc å¶ä¸­ abc æ¯è§è²åï¼role_æ¯åºå®çå­ç¬¦å¼å¤´ã\n\nä½¿ç¨ hasrole()æ¶åæ°ä¹åªå abc å³å¯ãå¦åå¯å¨æ¥éã\n\nç»ç¨æ·èµäºè§è²ï¼\n\n\n\nå¨éç½®ç±»ä¸­ç´æ¥å abc å³å¯ã\n\n.antmatchers("/main1.html").hasrole("abc")\n\n\n1\n\n\n# hasanyrole(string ...)\n\nå¦æç¨æ·å·å¤ç»å®è§è²çä»»æä¸ä¸ªï¼å°±åè®¸è¢«è®¿é®\n\n# hasipaddress(string)\n\nå¦æè¯·æ±æ¯æå®ç ip å°±è¿è¡è®¿é®ã\n\nå¯ä»¥éè¿ request.getremoteaddr()è·å ip å°åã\n\néè¦æ³¨æçæ¯å¨æ¬æºè¿è¡æµè¯æ¶ localhost å 127.0.0.1 è¾åºç ipå°åæ¯ä¸ä¸æ ·çã\n\nå½æµè§å¨ä¸­éè¿ localhost è¿è¡è®¿é®æ¶æ§å¶å°æå°çåå®¹ï¼\n\n\n\nå½æµè§å¨ä¸­éè¿ 127.0.0.1 è®¿é®æ¶æ§å¶å°æå°çåå®¹ï¼\n\n\n\nå½æµè§å¨ä¸­éè¿å·ä½ ip è¿è¡è®¿é®æ¶æ§å¶å°æå°åå®¹ï¼\n\n\n\n.antmatchers("/main1.html").hasipaddress("127.0.0.1")\n\n\n1\n\n\n\n# èªå®ä¹403å¤çæ¹æ¡\n\nä½¿ç¨ spring security æ¶ç»å¸¸ä¼çè§ 403ï¼æ æéï¼ï¼é»è®¤æåµä¸æ¾ç¤ºçææå¦ä¸ï¼\n\n\n\nèå¨å®éé¡¹ç®ä¸­å¯è½é½æ¯ä¸ä¸ªå¼æ­¥è¯·æ±ï¼æ¾ç¤ºä¸è¿°ææå¯¹äºç¨æ·å°±ä¸æ¯ç¹å«åå¥½äºãspring security æ¯æèªå®ä¹æéåéã\n\n# æ°å»ºç±»\n\næ°å»ºç±»å®ç° accessdeniedhandler\n\npackage com.yjxxt.springsecuritydemo.handler;\n\nimport org.springframework.security.access.accessdeniedexception;\nimport org.springframework.security.web.access.accessdeniedhandler;\nimport org.springframework.stereotype.component;\n\nimport javax.servlet.servletexception;\nimport javax.servlet.http.httpservletrequest;\nimport javax.servlet.http.httpservletresponse;\nimport java.io.ioexception;\nimport java.io.printwriter;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@component\npublic class myaccessdeniedhandler implements accessdeniedhandler {\n\n   @override\n   public void handle(httpservletrequest request, httpservletresponse response, accessdeniedexception accessdeniedexception) throws ioexception, servletexception {\n      response.setstatus(httpservletresponse.sc_forbidden);\n      response.setheader("content-type", "application/json;charset=utf-8");\n      printwriter out = response.getwriter();\n      out.write("{\\"status\\":\\"error\\",\\"msg\\":\\"æéä¸è¶³ï¼è¯·èç³»ç®¡çåï¼\\"}");\n      out.flush();\n      out.close();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\n# ä¿®æ¹éç½®ç±»\n\néç½®ç±»ä¸­éç¹æ·»å å¼å¸¸å¤çå¨ãè®¾ç½®è®¿é®åéåäº¤ç»åªä¸ªå¯¹è±¡è¿è¡å¤çã\n\nmyaccessdeniedhandler æ¯å¨éç½®ç±»ä¸­è¿è¡èªå¨æ³¨å¥çã\n\n//å¼å¸¸å¤ç\nhttp.exceptionhandling()\n      .accessdeniedhandler(myaccessdeniedhandler);\n\n\n1\n2\n3\n\n\n\n# åºäºè¡¨è¾¾å¼çè®¿é®æ§å¶\n\n# access()æ¹æ³ä½¿ç¨\n\nä¹åå­¦ä¹ çç»å½ç¨æ·æéå¤æ­å®éä¸åºå±å®ç°é½æ¯è°ç¨access(è¡¨è¾¾å¼)\n\n\n\nå¯ä»¥éè¿access()å®ç°åä¹åå­¦ä¹ çæéæ§å¶å®æç¸åçåè½ã\n\nä»¥ hasrole å å permitall ä¸¾ä¾\n\n\n\n# ä½¿ç¨èªå®ä¹æ¹æ³\n\nè½ç¶è¿éé¢å·²ç»åå«äºå¾å¤çè¡¨è¾¾å¼(æ¹æ³)ä½æ¯å¨å®éé¡¹ç®ä¸­å¾æå¯è½åºç°éè¦èªå·±èªå®ä¹é»è¾çæåµã\n\nå¤æ­ç»å½ç¨æ·æ¯å¦å·æè®¿é®å½å url æéã\n\n# æ°å»ºæ¥å£åå®ç°ç±»\n\nmyservice.java\n\npackage com.yjxxt.springsecuritydemo.service;\n\nimport org.springframework.security.core.authentication;\n\nimport javax.servlet.http.httpservletrequest;\n\npublic interface myservice {\n   boolean haspermission(httpservletrequest request, authentication authentication);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nmyserviceimpl.java\n\npackage com.yjxxt.springsecuritydemo.service.impl;\n\nimport com.yjxxt.springsecuritydemo.service.myservice;\nimport org.springframework.security.core.authentication;\nimport org.springframework.security.core.grantedauthority;\nimport org.springframework.security.core.authority.simplegrantedauthority;\nimport org.springframework.security.core.userdetails.userdetails;\nimport org.springframework.stereotype.component;\n\nimport javax.servlet.http.httpservletrequest;\nimport java.util.collection;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@component\npublic class myserviceimpl implements myservice {\n\n   @override\n   public boolean haspermission(httpservletrequest request, authentication authentication) {\n      object obj = authentication.getprincipal();\n      if (obj instanceof userdetails){\n         userdetails userdetails = (userdetails) obj;\n         collection<? extends grantedauthority> authorities = userdetails.getauthorities();\n         return authorities.contains(new simplegrantedauthority(request.getrequesturi()));\n      }\n      return false;\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\n# ä¿®æ¹éç½®ç±»\n\nå¨ access ä¸­éè¿@beançidå.æ¹æ³(åæ°)çå½¢å¼è¿è¡è°ç¨éç½®ç±»ä¸­ä¿®æ¹å¦ä¸ï¼\n\n//urlæ¦æª\nhttp.authorizerequests()\n      //login.htmlä¸éè¦è¢«è®¤è¯\n      // .antmatchers("/login.html").permitall()\n      .antmatchers("/login.html").access("permitall")\n      // .antmatchers("/main.html").hasrole("abc")\n      .antmatchers("/main.html").access("hasrole(\'abc\')")\n      .anyrequest().access("@myserviceimpl.haspermission(request,authentication)")\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# åºäºæ³¨è§£çè®¿é®æ§å¶\n\nå¨ spring security ä¸­æä¾äºä¸äºè®¿é®æ§å¶çæ³¨è§£ãè¿äºæ³¨è§£é½æ¯é»è®¤æ¯é½ä¸å¯ç¨çï¼éè¦éè¿@enableglobalmethodsecurityè¿è¡å¼å¯åä½¿ç¨ã\n\nå¦æè®¾ç½®çæ¡ä»¶åè®¸ï¼ç¨åºæ­£å¸¸æ§è¡ãå¦æä¸åè®¸ä¼æ¥ 500\n\n\n\nè¿äºæ³¨è§£å¯ä»¥åå° service æ¥å£ææ¹æ³ä¸ï¼ä¹å¯ä»¥åå° controlleræ controller çæ¹æ³ä¸ãéå¸¸æåµä¸é½æ¯åå¨æ§å¶å¨æ¹æ³ä¸çï¼æ§å¶æ¥å£urlæ¯å¦åè®¸è¢«è®¿é®ã\n\n# @secured\n\n@secured æ¯ä¸é¨ç¨äºå¤æ­æ¯å¦å·æè§è²çãè½åå¨æ¹æ³æç±»ä¸ãåæ°è¦ä»¥ role_å¼å¤´ã\n\n\n\n# å¼å¯æ³¨è§£\n\nå¨ å¯ å¨ ç±» ( ä¹ å¯ ä»¥ å¨ é ç½® ç±» ç­ è½ å¤ æ« æ ç ç±» ä¸ ) ä¸ æ·» å @enableglobalmethodsecurity(securedenabled = true)\n\n@springbootapplication\n@enableglobalmethodsecurity(securedenabled = true)\npublic class springsecuritydemoapplication {\n\n   public static void main(string[] args) {\n      springapplication.run(springsecuritydemoapplication.class, args);\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n# å¨æ§å¶å¨æ¹æ³ä¸æ·»å  @secured æ³¨è§£\n\n/**\n * æååè·³è½¬é¡µé¢\n * @return\n */\n@secured("role_abc")\n@requestmapping("/tomain")\npublic string tomain(){\n   return "redirect:/main.html";\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n# éç½®ç±»\n\n@override\nprotected void configure(httpsecurity http) throws exception {\n   //è¡¨åæäº¤\n   http.formlogin()\n         //èªå®ä¹ç»å½é¡µé¢\n         .loginpage("/login.html")\n         //å½åç°/loginæ¶è®¤ä¸ºæ¯ç»å½ï¼å¿é¡»åè¡¨åæäº¤çå°åä¸æ ·ãå»æ§è¡userserviceimpl\n         .loginprocessingurl("/login")\n         //ç»å½æååè·³è½¬é¡µé¢ï¼postè¯·æ±\n         .successforwardurl("/tomain")\n         \n   //urlæ¦æª\n   http.authorizerequests()\n         //login.htmlä¸éè¦è¢«è®¤è¯\n         .antmatchers("/login.html").permitall()\n         //ææè¯·æ±é½å¿é¡»è¢«è®¤è¯ï¼å¿é¡»ç»å½åè¢«è®¿é®\n         .anyrequest().authenticated();\n   //å³é­csrfé²æ¤\n   http.csrf().disable();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n# @preauthorize/@postauthorize\n\n@preauthorize å@postauthorize é½æ¯æ¹æ³æç±»çº§å«æ³¨è§£ã\n\n\n\n * @preauthorizeè¡¨ç¤ºè®¿é®æ¹æ³æç±»å¨æ§è¡ä¹ååå¤æ­æéï¼å¤§å¤æåµä¸é½æ¯ä½¿ç¨è¿ä¸ªæ³¨è§£ï¼æ³¨è§£çåæ°åaccess()æ¹æ³åæ°åå¼ç¸åï¼é½æ¯æéè¡¨è¾¾å¼ã\n * @postauthorize è¡¨ç¤ºæ¹æ³æç±»æ§è¡ç»æåå¤æ­æéï¼æ­¤æ³¨è§£å¾å°è¢«ä½¿ç¨å°ã\n\n# å¼å¯æ³¨è§£\n\n@springbootapplication\n@enableglobalmethodsecurity(prepostenabled = true)\npublic class springsecuritydemoapplication {\n\n   public static void main(string[] args) {\n      springapplication.run(springsecuritydemoapplication.class, args);\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n# æ·»å @preauthorize\n\nå¨æ§å¶å¨æ¹æ³ä¸æ·»å @preauthorizeï¼åæ°å¯ä»¥æ¯ä»»ä½ access()æ¯æçè¡¨è¾¾å¼\n\n/**\n * æååè·³è½¬é¡µé¢\n * @return\n */\n@preauthorize("hasrole(\'role_abc\')")\n@requestmapping("/tomain")\npublic string tomain(){\n   return "redirect:/main.html";\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# remembermeåè½å®ç°\n\nspring security ä¸­ remember me ä¸ºâè®°ä½æâåè½ï¼ç¨æ·åªéè¦å¨ç»å½æ¶æ·»å  remember-meå¤éæ¡ï¼åå¼ä¸ºtrueãspring security ä¼èªå¨æç¨æ·ä¿¡æ¯å­å¨å°æ°æ®æºä¸­ï¼ä»¥åå°±å¯ä»¥ä¸ç»å½è¿è¡è®¿é®\n\n# æ·»å ä¾èµ\n\nspring security å® ç° remember me å è½ æ¶ åº å± å® ç° ä¾ èµspring-jdbcï¼æä»¥éè¦å¯¼å¥ spring-jdbcãä»¥åå¤ä½¿ç¨ mybatis æ¡æ¶èå¾å°ç´æ¥å¯¼å¥ spring-jdbcï¼æä»¥æ­¤å¤å¯¼å¥ mybatis å¯å¨å¨åæ¶è¿éè¦æ·»å  mysql é©±å¨\n\n\x3c!-- mybatis ä¾èµ --\x3e\n<dependency>\n   <groupid>org.mybatis.spring.boot</groupid>\n   <artifactid>mybatis-spring-boot-starter</artifactid>\n   <version>2.1.1</version>\n</dependency>\n\x3c!-- mysql æ°æ®åºä¾èµ --\x3e\n<dependency>\n   <groupid>mysql</groupid>\n   <artifactid>mysql-connector-java</artifactid>\n   <version>8.0.18</version>\n</dependency>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n# éç½®æ°æ®æº\n\nå¨ application.properties ä¸­éç½®æ°æ®æºãè¯·ç¡®ä¿æ°æ®åºä¸­å·²ç»å­å¨shopæ°æ®åº\n\nspring.datasource.driver-class-name= com.mysql.cj.jdbc.driver\nspring.datasource.url= jdbc:mysql://localhost:3306/security?useunicode=true&characterencoding=utf-8&servertimezone=asia/shanghai\nspring.datasource.username= root\nspring.datasource.password= root\n\n\n1\n2\n3\n4\n\n\n# ç¼åéç½®\n\nremembermeconfig.java\n\npackage com.yjxxt.springsecuritydemo.config;\n\nimport org.springframework.beans.factory.annotation.autowired;\nimport org.springframework.context.annotation.bean;\nimport org.springframework.context.annotation.configuration;\nimport org.springframework.security.web.authentication.rememberme.jdbctokenrepositoryimpl;\nimport org.springframework.security.web.authentication.rememberme.persistenttokenrepository;\n\nimport javax.sql.datasource;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@configuration\npublic class remembermeconfig {\n\n   @autowired\n   private datasource datasource;\n\n   @bean\n   public persistenttokenrepository getpersistenttokenrepository(){\n      jdbctokenrepositoryimpl jdbctokenrepository = new jdbctokenrepositoryimpl();\n      jdbctokenrepository.setdatasource(datasource);\n      //èªå¨å»ºè¡¨ï¼ç¬¬ä¸æ¬¡å¯å¨æ¶éè¦ï¼ç¬¬äºæ¬¡å¯å¨æ¶æ³¨éæ\n      jdbctokenrepository.setcreatetableonstartup(true);\n      return jdbctokenrepository;\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\n# ä¿®æ¹securityconfig.java\n\nå¨securityconfigä¸­æ·»å remembermeconfigåuserdetailsserviceå®ç°ç±»å¯¹è±¡ï¼å¹¶èªå¨æ³¨å¥ã\n\nå¨ configure ä¸­æ·»å ä¸é¢éç½®åå®¹ã\n\nhttp.rememberme()\n      //ç»å½é»è¾äº¤ç»åªä¸ªå¯¹è±¡\n      .userdetailsservice(userservice)\n      // æä¹å±å¯¹è±¡\n      .tokenrepository(persistenttokenrepository);\n\n\n1\n2\n3\n4\n5\n\n\n# å¨å®¢æ·ç«¯é¡µé¢æ·»å å¤éæ¡\n\nå¨å®¢æ·ç«¯ç»å½é¡µé¢ä¸­æ·»å  remember-me çå¤éæ¡ï¼åªè¦ç¨æ·å¾éäºå¤éæ¡ä¸æ¬¡å°±ä¸éè¦è¿è¡ç»å½äºã\n\n<form action="/login" method="post">\n    ç¨æ·åï¼<input type="text" name="username" /><br/>\n    å¯ç ï¼<input type="password" name="password" /><br/>\n    <input type="checkbox" name="remember-me" value="true"/><br/>\n    <input type="submit" value="ç»å½" />\n</form>\n\n\n1\n2\n3\n4\n5\n6\n\n\n# æææ¶é´\n\né»è®¤æåµä¸éå¯é¡¹ç®åç»å½ç¶æå¤±æäºãä½æ¯å¯ä»¥éè¿è®¾ç½®ç¶ææææ¶é´ï¼å³ä½¿é¡¹ç®éæ°å¯å¨ä¸æ¬¡ä¹å¯ä»¥æ­£å¸¸ç»å½ã\n\nhttp.rememberme()\n      //å¤±ææ¶é´ï¼åä½ç§\n      .tokenvalidityseconds(120)\n      //ç»å½é»è¾äº¤ç»åªä¸ªå¯¹è±¡\n      .userdetailsservice(userservice)\n      // æä¹å±å¯¹è±¡\n      .tokenrepository(persistenttokenrepository);\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# thymeleafä¸­springsecurityçä½¿ç¨ï¼äºè§£ï¼\n\nspring security å¯ä»¥å¨ä¸äºè§å¾ææ¯ä¸­è¿è¡æ§å¶æ¾ç¤ºææãä¾å¦ï¼jspæ thymeleafãå¨éååç«¯åç¦»ä¸ä½¿ç¨ spring boot çé¡¹ç®ä¸­å¤ä½¿ç¨ thymeleafä½ä¸ºè§å¾å±ç¤ºææ¯ã\n\nthymeleaf å¯¹ spring security ç æ¯ æ é½ æ¾ å¨thymeleaf-extras-springsecurityxä¸­ï¼ç®åææ°çæ¬ä¸º 5ãæä»¥éè¦å¨é¡¹ç®ä¸­æ·»å æ­¤ jar åçä¾èµå thymeleaf çä¾èµãã\n\n\x3c!--thymeleaf springsecurity5 ä¾èµ--\x3e\n<dependency>\n   <groupid>org.thymeleaf.extras</groupid>\n   <artifactid>thymeleaf-extras-springsecurity5</artifactid>\n</dependency>\n\x3c!--thymeleafä¾èµ--\x3e\n<dependency>\n   <groupid>org.springframework.boot</groupid>\n   <artifactid>spring-boot-starter-thymeleaf</artifactid>\n</dependency>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¨ html é¡µé¢ä¸­å¼å¥ thymeleaf å½åç©ºé´å security å½åç©ºé´\n\n<html xmlns="http://www.w3.org/1999/xhtml"\n      xmlns:th="http://www.thymeleaf.org"\n      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">\n\n\n1\n2\n3\n\n\n# è·åå±æ§\n\nå¯ä»¥å¨htmlé¡µé¢ä¸­éè¿sec:authentication=""è·å\n\nusernamepasswordauthenticationtokenä¸­ææ getxxxçåå®¹ï¼åå«ç¶ç±»ä¸­ç getxxxçåå®¹ã\n\næ ¹æ®æºç å¾åºä¸é¢å±æ§ï¼\n\n * nameï¼ç»å½è´¦å·åç§°\n\n * principalï¼ç»å½ä¸»ä½ï¼å¨èªå®ä¹ç»å½é»è¾ä¸­æ¯ userdetails\n\n * credentialsï¼å­è¯\n\n * authoritiesï¼æéåè§è²\n\n * detailsï¼å®éä¸æ¯ webauthenticationdetailsçå®ä¾ãå¯ä»¥è·åremoteaddress(å®¢æ·ç«¯ ip)å sessionid(å½å sessionid)\n\n# æ°å»ºdemo.html\n\nå¨é¡¹ç® resources ä¸­æ°å»º templates æä»¶å¤¹ï¼å¨ templates ä¸­æ°å»ºdemo.html é¡µé¢\n\n<!doctype html>\n<html xmlns="http://www.w3.org/1999/xhtml"\n      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">\n<head>\n    <meta charset="utf-8">\n    <title>title</title>\n</head>\n<body>\n    ç»å½è´¦å·:<span sec:authentication="name"></span><br/>\n    ç»å½è´¦å·:<span sec:authentication="principal.username"></span><br/>\n    å­è¯ï¼<span sec:authentication="credentials"></span><br/>\n    æéåè§è²ï¼<span sec:authentication="authorities"></span><br/>\n    å®¢æ·ç«¯å°åï¼<span sec:authentication="details.remoteaddress"></span><br/>\n    sessionidï¼<span sec:authentication="details.sessionid"></span><br/>\n</body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n# ç¼åcontroller\n\nthymeleaf é¡µé¢éè¦æ§å¶è½¬åï¼å¨æ§å¶å¨ç±»ä¸­ç¼åä¸é¢æ¹æ³\n\n@requestmapping("/demo")\npublic string demo(){\n   return "demo";\n}\n\n\n1\n2\n3\n4\n\n\n# æéå¤æ­\n\n# è®¾ç½®ç¨æ·è§è²åæé\n\nè®¾å®ç¨æ·å·æ adminï¼/insertï¼/delete æé role_abc è§è²ã\n\nreturn new user(username,password, authorityutils.commaseparatedstringtoauthoritylist("admin,role_abc,/insert,/delete"));\n\n\n1\n\n\n# æ§å¶é¡µé¢æ¾ç¤ºææ\n\nå¨é¡µé¢ä¸­æ ¹æ®ç¨æ·æéåè§è²å¤æ­é¡µé¢ä¸­æ¾ç¤ºçåå®¹\n\néè¿æéå¤æ­ï¼\n<button sec:authorize="hasauthority(\'/insert\')">æ°å¢</button>\n<button sec:authorize="hasauthority(\'/delete\')">å é¤</button>\n<button sec:authorize="hasauthority(\'/update\')">ä¿®æ¹</button>\n<button sec:authorize="hasauthority(\'/select\')">æ¥ç</button>\n<br/>\néè¿è§è²å¤æ­ï¼\n<button sec:authorize="hasrole(\'abc\')">æ°å¢</button>\n<button sec:authorize="hasrole(\'abc\')">å é¤</button>\n<button sec:authorize="hasrole(\'abc\')">ä¿®æ¹</button>\n<button sec:authorize="hasrole(\'abc\')">æ¥ç</button>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# éåºç»å½\n\nç¨æ·åªéè¦å spring security é¡¹ç®ä¸­åé/logoutéåºè¯·æ±å³å¯ã\n\n# éåºç»å½\n\nå®ç°éåºéå¸¸ç®åï¼åªè¦å¨é¡µé¢ä¸­æ·»å /logout çè¶é¾æ¥å³å¯ã\n\n<a href="/logout">éåºç»å½</a>\n\n\n1\n\n\nä¸ºäºå®ç°æ´å¥½çææï¼éå¸¸æ·»å éåºçéç½®ãé»è®¤çéåº url ä¸º/logoutï¼éåºæååè·³è½¬å°/login?logout\n\n\n\nå¦æä¸å¸æä½¿ç¨é»è®¤å¼ï¼å¯ä»¥éè¿ä¸é¢çæ¹æ³è¿è¡ä¿®æ¹ã\n\nhttp.logout()\n      .logouturl("/logout")\n      .logoutsuccessurl("/login.html");\n\n\n1\n2\n3\n\n\n# logoutå¶ä»å¸¸ç¨éç½®æºç è§£è¯»\n\n# addlogouthandler(logouthandler)\n\né»è®¤æ¯ contextlogouthandler\n\n\n\né»è®¤å®ä¾åå®¹\n\n\n\n# clearauthentication(boolean)\n\næ¯å¦æ¸é¤è®¤è¯ç¶æï¼é»è®¤ä¸º true\n\n\n\n# invalidatehttpsession(boolean)\n\næ¯å¦éæ¯ httpsession å¯¹è±¡ï¼é»è®¤ä¸º true\n\n\n\n# logoutsuccesshandler(logoutsuccesshandler)\n\néåºæåå¤çå¨\n\n\n\nä¹å¯ä»¥èªå·±è¿è¡å®ä¹éåºæåå¤çå¨ãåªè¦å®ç°äºlogoutsuccesshandleræ¥å£ãä¸ä¹åè®²è§£çç»å½æåå¤çå¨åç»å½å¤±è´¥å¤çå¨æå¶ç±»ä¼¼ã\n\n\n# springsecurityä¸­çcsrf\n\nä»åå¼å§å­¦ä¹ spring securityæ¶ï¼å¨éç½®ç±»ä¸­ä¸ç´å­å¨è¿æ ·ä¸è¡ä»£ç ï¼http.csrf().disable();å¦ææ²¡æè¿è¡ä»£ç å¯¼è´ç¨æ·æ æ³è¢«è®¤è¯ãè¿è¡ä»£ç çå«ä¹æ¯ï¼å³é­ csrf é²æ¤ã\n\n# 1. ä»ä¹æ¯csrf\n\ncsrfï¼cross-site request forgeryï¼è·¨ç«è¯·æ±ä¼ªé ï¼ä¹è¢«ç§°ä¸ºâoneclick attackâ æè session ridingãéè¿ä¼ªé ç¨æ·è¯·æ±è®¿é®åä¿¡ä»»ç«ç¹çéæ³è¯·æ±è®¿é®ã\n\nè·¨åï¼åªè¦ç½ç»åè®®ï¼ip å°åï¼ç«¯å£ä¸­ä»»ä½ä¸ä¸ªä¸ç¸åå°±æ¯è·¨åè¯·æ±ã\n\nå®¢æ·ç«¯ä¸æå¡è¿è¡äº¤äºæ¶ï¼ç±äº http åè®®æ¬èº«æ¯æ ç¶æåè®®ï¼æä»¥å¼å¥äºcookieè¿è¡è®°å½å®¢æ·ç«¯èº«ä»½ãå¨cookieä¸­ä¼å­æ¾session idç¨æ¥è¯å«å®¢æ·ç«¯èº«ä»½çãå¨è·¨åçæåµä¸ï¼session id å¯è½è¢«ç¬¬ä¸æ¹æ¶æå«æï¼éè¿è¿ä¸ª session id åæå¡ç«¯åèµ·è¯·æ±æ¶ï¼æå¡ç«¯ä¼è®¤ä¸ºè¿ä¸ªè¯·æ±æ¯åæ³çï¼å¯è½åçå¾å¤ææ³ä¸å°çäºæã\n\n# 2. spring securityä¸­çcsrf\n\nä» spring security4å¼å§csrfé²æ¤é»è®¤å¼å¯ãé»è®¤ä¼æ¦æªè¯·æ±ï¼è¿è¡csrfå¤çãcsrfä¸ºäºä¿è¯ä¸æ¯å¶ä»ç¬¬ä¸æ¹ç½ç«è®¿é®ï¼è¦æ±è®¿é®æ¶æºå¸¦åæ°åä¸º_csrfå¼ä¸ºtoken(token å¨æå¡ç«¯äº§ç)çåå®¹ï¼å¦ætokenåæå¡ç«¯çtokenå¹éæåï¼åæ­£å¸¸è®¿é®ã\n\n# 2.1ãç¼åæ§å¶å¨æ¹æ³\n\nç¼åæ§å¶å¨æ¹æ³ï¼è·³è½¬å° templates ä¸­ login.html é¡µé¢ã\n\n@requestmapping("/showlogin")\npublic string showlogin(){\n   return "login";\n}\n\n\n1\n2\n3\n4\n\n\n# 2.2ãæ°å»ºlogin.html\n\nçº¢è²é¨åæ¯å¿é¡»å­å¨çå¦åæ æ³æ­£å¸¸ç»å½ã\n\n<!doctype html>\n<html xmlns="http://www.w3.org/1999/xhtml"\n      xmlns:th="http://www.thymeleaf.org"\n>\n<head>\n    <meta charset="utf-8">\n    <title>title</title>\n</head>\n<body>\n<form action="/login" method="post">\n    <input type="hidden" th:value="${_csrf.token}" name="_csrf" th:if="${_csrf}"/>\n    ç¨æ·åï¼<input type="text" name="username" /><br/>\n    å¯ç ï¼<input type="password" name="password" /><br/>\n    <input type="submit" value="ç»å½" />\n</form>\n</body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n# ä¿®æ¹éç½®ç±»\n\nå¨éç½®ç±»ä¸­æ³¨éæ csrf é²æ¤å¤±æ\n\n// å³é­csrfé²æ¤\n// http.csrf().disable();\n\n\n1\n2\n\n\n\n# oauth2è®¤è¯\n\n\n# oauth2ç®ä»\n\n# ç®ä»\n\nç¬¬ä¸æ¹è®¤è¯ææ¯æ¹æ¡æä¸»è¦æ¯è§£å³è®¤è¯åè®®çéç¨æ åé®é¢ï¼å ä¸ºè¦å®ç°è·¨ç³»ç»è®¤è¯ï¼åç³»ç»ä¹é´è¦éµå¾ªä¸å®çæ¥å£åè®®ã\n\noauthåè®®ä¸ºç¨æ·èµæºçæææä¾äºä¸ä¸ªå®å¨çãå¼æ¾èåç®æçæ åãåæ¶ï¼ä»»ä½ç¬¬ä¸æ¹é½å¯ä»¥ä½¿ç¨oauthè®¤è¯æå¡ï¼ä»»ä½æå¡æä¾åé½å¯ä»¥å®ç°èªèº«çoauthè®¤è¯æå¡ï¼å èoauthæ¯å¼æ¾çãä¸çæä¾äºoauthçå¤ç§å®ç°å¦phpãjavascriptï¼javaï¼rubyç­åç§è¯­è¨å¼ååï¼å¤§å¤§èçº¦äºç¨åºåçæ¶é´ï¼å èoauthæ¯ç®æçãäºèç½å¾å¤æå¡å¦open apiï¼å¾å¤å¤§å¬å¸å¦googleï¼yahooï¼microsoftç­é½æä¾äºoauthè®¤è¯æå¡ï¼è¿äºé½è¶³ä»¥è¯´æoauthæ åéæ¸æä¸ºå¼æ¾èµæºææçæ åã\n\noauthåè®®ç®ååå±å°2.0çæ¬ï¼1.0çæ¬è¿äºå¤æï¼2.0çæ¬å·²å¾å°å¹¿æ³åºç¨ã\n\nä¸è¾¹åæä¸ä¸ªoauth2è®¤è¯çä¾å­ï¼ç½ç«ä½¿ç¨å¾®ä¿¡è®¤è¯çè¿ç¨ï¼\n\n\n\n 1. ç¨æ·è¿å¥ç½ç«çç»å½é¡µé¢ï¼ç¹å»å¾®ä¿¡çå¾æ ä»¥å¾®ä¿¡è´¦å·ç»å½ç³»ç»ï¼ç¨æ·æ¯èªå·±å¨å¾®ä¿¡éä¿¡æ¯çèµæºæ¥æèã\n\n\n\nç¹å»âå¾®ä¿¡âåºç°ä¸ä¸ªäºç»´ç ï¼æ­¤æ¶ç¨æ·æ«æäºç»´ç ï¼å¼å§ç»ç½ç«ææã\n\n\n\n * èµæºæ¥æèåæç»å®¢æ·ç«¯ææ\n   \n   > èµæºæ¥æèæ«æäºç»´ç è¡¨ç¤ºèµæºæ¥æèåæç»å®¢æ·ç«¯ææï¼å¾®ä¿¡ä¼å¯¹èµæºæ¥æèçèº«ä»½è¿è¡éªè¯ï¼éªè¯éè¿åï¼å¾®ä¿¡ä¼è¯¢é®ç¨æ·æ¯å¦ç»ææç½ç«è®¿é®èªå·±çå¾®ä¿¡æ°æ®ï¼ç¨æ·ç¹å»âç¡®è®¤ç»å½âè¡¨ç¤ºåæææï¼å¾®ä¿¡è®¤è¯æå¡å¨ä¼é¢åä¸ä¸ªææç ï¼å¹¶éå®åå°ç½ç«ã\n\n * å®¢æ·ç«¯è·åå°ææç ï¼è¯·æ±è®¤è¯æå¡å¨ç³è¯·ä»¤ç\n   \n   > æ­¤è¿ç¨ç¨æ·çä¸å°ï¼å®¢æ·ç«¯åºç¨ç¨åºè¯·æ±è®¤è¯æå¡å¨ï¼è¯·æ±æºå¸¦ææç ã\n\n * è®¤è¯æå¡å¨åå®¢æ·ç«¯ååºä»¤ç\n   \n   > è®¤è¯æå¡å¨éªè¯äºå®¢æ·ç«¯è¯·æ±çææç ï¼å¦æåæ³åç»å®¢æ·ç«¯é¢åä»¤çï¼ä»¤çæ¯å®¢æ·ç«¯è®¿é®èµæºçéè¡è¯ãæ­¤äº¤äºè¿ç¨ç¨æ·çä¸å°ï¼å½å®¢æ·ç«¯æ¿å°ä»¤çåï¼ç¨æ·å¨ç½ç«çå°å·²ç»ç»å½æåã\n\n * å®¢æ·ç«¯è¯·æ±èµæºæå¡å¨çèµæº\n   \n   > å®¢æ·ç«¯æºå¸¦ä»¤çè®¿é®èµæºæå¡å¨çèµæºãç½ç«æºå¸¦ä»¤çè¯·æ±è®¿é®å¾®ä¿¡æå¡å¨è·åç¨æ·çåºæ¬ä¿¡æ¯ã\n\n * èµæºæå¡å¨è¿ååä¿æ¤èµæº\n   \n   > èµæºæå¡å¨æ ¡éªä»¤ççåæ³æ§ï¼å¦æåæ³ååç¨æ·ååºèµæºä¿¡æ¯åå®¹ã\n\næ³¨æï¼èµæºæå¡å¨åè®¤è¯æå¡å¨å¯ä»¥æ¯ä¸ä¸ªæå¡ä¹å¯ä»¥åå¼çæå¡ï¼å¦ææ¯åå¼çæå¡èµæºæå¡å¨éå¸¸è¦è¯·æ±è®¤è¯æå¡å¨æ¥æ ¡éªä»¤ççåæ³æ§ã\n\noauth2.0è®¤è¯æµç¨å¦ä¸ï¼\n\nå¼èªoauth2.0åè®®rfc6749 https://tools.ietf.org/html/rfc6749\n\n\n\n# è§è²\n\nå®¢æ·ç«¯\n\næ¬èº«ä¸å­å¨èµæºï¼éè¦éè¿èµæºæ¥æèçææå»è¯·æ±èµæºæå¡å¨çèµæºï¼æ¯å¦ï¼androidå®¢æ·ç«¯ãwebå®¢æ·ç«¯ï¼æµè§å¨ç«¯ï¼ãå¾®ä¿¡å®¢æ·ç«¯ç­ã\n\nèµæºæ¥æè\n\néå¸¸ä¸ºç¨æ·ï¼ä¹å¯ä»¥æ¯åºç¨ç¨åºï¼å³è¯¥èµæºçæ¥æèã\n\næææå¡å¨ï¼ä¹ç§°è®¤è¯æå¡å¨ï¼\n\nç¨æ¥å¯¹èµæºæ¥æèçèº«ä»½è¿è¡è®¤è¯ãå¯¹è®¿é®èµæºè¿è¡ææãå®¢æ·ç«¯è¦æ³è®¿é®èµæºéè¦éè¿è®¤è¯æå¡å¨ç±èµæºæ¥æèææåæ¹å¯è®¿é®ã\n\nèµæºæå¡å¨\n\nå­å¨èµæºçæå¡å¨ï¼æ¯å¦ï¼ç½ç«ç¨æ·ç®¡çæå¡å¨å­å¨äºç½ç«ç¨æ·ä¿¡æ¯ï¼ç½ç«ç¸åæå¡å¨å­å¨äºç¨æ·çç¸åä¿¡æ¯ï¼å¾®ä¿¡çèµæºæå¡å­å¨äºå¾®ä¿¡çç¨æ·ä¿¡æ¯ç­ãå®¢æ·ç«¯æç»è®¿é®èµæºæå¡å¨è·åèµæºä¿¡æ¯ã\n\n# å¸¸ç¨æ¯è¯­\n\n * å®¢æ·å­è¯(client credentials)ï¼å®¢æ·ç«¯çclientidåå¯ç ç¨äºè®¤è¯å®¢æ·\n\n * ä»¤ç(tokens)ï¼æææå¡å¨å¨æ¥æ¶å°å®¢æ·è¯·æ±åï¼é¢åçè®¿é®ä»¤ç\n\n * ä½ç¨å(scopes)ï¼å®¢æ·è¯·æ±è®¿é®ä»¤çæ¶ï¼ç±èµæºæ¥æèé¢å¤æå®çç»åæé(permission)\n\n# ä»¤çç±»å\n\n * ææç ï¼ä»ç¨äºææç ææç±»åï¼ç¨äºäº¤æ¢è·åè®¿é®ä»¤çåå·æ°ä»¤ç\n\n * è®¿é®ä»¤çï¼ç¨äºä»£è¡¨ä¸ä¸ªç¨æ·ææå¡ç´æ¥å»è®¿é®åä¿æ¤çèµæº\n\n * å·æ°ä»¤çï¼ç¨äºå»æææå¡å¨è·åä¸ä¸ªå·æ°è®¿é®ä»¤ç\n\n * bearertokenï¼ä¸ç®¡è°æ¿å°tokené½å¯ä»¥è®¿é®èµæºï¼ç±»ä¼¼ç°é\n\n * proof of possession(pop) tokenï¼å¯ä»¥æ ¡éªclientæ¯å¦å¯¹tokenææç¡®çæ¥ææ\n\n# ç¹ç¹\n\nä¼ç¹ï¼\n\n * æ´å®å¨ï¼å®¢æ·ç«¯ä¸æ¥è§¦ç¨æ·å¯ç ï¼æå¡å¨ç«¯æ´æéä¸­ä¿æ¤\n * å¹¿æ³ä¼ æ­å¹¶è¢«æç»­éç¨\n * ç­å¯¿å½åå°è£çtoken\n * èµæºæå¡å¨åæææå¡å¨è§£è¦\n * éä¸­å¼ææï¼ç®åå®¢æ·ç«¯\n * http/jsonåå¥½ï¼æäºè¯·æ±åä¼ étoken\n * èèå¤ç§å®¢æ·ç«¯æ¶æåºæ¯\n * å®¢æ·å¯ä»¥å·æä¸åçä¿¡ä»»çº§å«\n\nç¼ºç¹ï¼\n\n * åè®®æ¡æ¶å¤ªå®½æ³ï¼é æåç§å®ç°çå¼å®¹æ§åäºæä½æ§å·®\n * ä¸æ¯ä¸ä¸ªè®¤è¯åè®®ï¼æ¬èº«å¹¶ä¸è½åè¯ä½ ä»»ä½ç¨æ·ä¿¡æ¯ã\n\n\n# æææ¨¡å¼\n\n# ææç æ¨¡å¼ï¼authorization codeï¼\n\n\n\n# ç®åæææ¨¡å¼ï¼implicitï¼\n\n\n\n# å¯ç æ¨¡å¼ï¼resource owner passwordcredentialsï¼\n\n\n\n# å®¢æ·ç«¯æ¨¡å¼ï¼client credentialsï¼\n\n\n\n# å·æ°ä»¤ç\n\n\n\n\n# spring security oauth2\n\n\n# æææå¡å¨ï¼çæï¼\n\n\n\n * authorize endpointï¼ææç«¯ç¹ï¼è¿è¡ææ\n\n * token endpointï¼ä»¤çç«¯ç¹ï¼ç»è¿æææ¿å°å¯¹åºçtoken\n\n * introspection endpointï¼æ ¡éªç«¯ç¹ï¼æ ¡éªtokençåæ³æ§\n\n * revocation endpointï¼æ¤éç«¯ç¹ï¼æ¤éææ\n\n\n# spring security oauth2æ¶æï¼çæï¼\n\n\n\næµç¨ï¼\n\n 1. ç¨æ·è®¿é®ï¼æ­¤æ¶æ²¡ætokenãoauth2resttemplateä¼æ¥éï¼è¿ä¸ªæ¥éä¿¡æ¯ä¼è¢«oauth2clientcontextfilteræè·å¹¶éå®åå°è®¤è¯æå¡å¨\n 2. è®¤è¯æå¡å¨éè¿authorization endpointè¿è¡ææï¼å¹¶éè¿authorizationservertokenservicesçæææç å¹¶è¿åç»å®¢æ·ç«¯\n 3. å®¢æ·ç«¯æ¿å°ææç å»è®¤è¯æå¡å¨éè¿token endpointè°ç¨authorizationservertokenservicesçætokenå¹¶è¿åç»å®¢æ·ç«¯\n 4. å®¢æ·ç«¯æ¿å°tokenå»èµæºæå¡å¨è®¿é®èµæºï¼ä¸è¬ä¼éè¿oauth2authenticationmanagerè°ç¨resourceservertokenservicesè¿è¡æ ¡éªãæ ¡éªéè¿å¯ä»¥è·åèµæºã\n\n\n# spring security oauth2ææç æ¨¡å¼\n\n# 1. åå»ºé¡¹ç®\n\n\n\n\n\n\n\n\n\n# 2ãæ·»å ä¾èµ\n\n<?xml version="1.0" encoding="utf-8"?>\n<project xmlns="http://maven.apache.org/pom/4.0.0" xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n         xsi:schemalocation="http://maven.apache.org/pom/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">\n   <modelversion>4.0.0</modelversion>\n   <parent>\n      <groupid>org.springframework.boot</groupid>\n      <artifactid>spring-boot-starter-parent</artifactid>\n      <version>2.2.2.release</version>\n      <relativepath/> \x3c!-- lookup parent from repository --\x3e\n   </parent>\n  \n   <groupid>com.yjxxt</groupid>\n   <artifactid>springsecurityoauth2demo</artifactid>\n   <version>0.0.1-snapshot</version>\n  \n   <name>springsecurityoauth2demo</name>\n   <description>demo project for spring boot</description>\n\n   <properties>\n      <java.version>1.8</java.version>\n      <spring-cloud.version>greenwich.sr2</spring-cloud.version>\n   </properties>\n\n   <dependencies>\n      <dependency>\n         <groupid>org.springframework.cloud</groupid>\n         <artifactid>spring-cloud-starter-oauth2</artifactid>\n      </dependency>\n      <dependency>\n         <groupid>org.springframework.cloud</groupid>\n         <artifactid>spring-cloud-starter-security</artifactid>\n      </dependency>\n      <dependency>\n         <groupid>org.springframework.boot</groupid>\n         <artifactid>spring-boot-starter-web</artifactid>\n      </dependency>\n      <dependency>\n         <groupid>org.springframework.boot</groupid>\n         <artifactid>spring-boot-starter-test</artifactid>\n         <scope>test</scope>\n      </dependency>\n   </dependencies>\n\n   <dependencymanagement>\n      <dependencies>\n         <dependency>\n            <groupid>org.springframework.cloud</groupid>\n            <artifactid>spring-cloud-dependencies</artifactid>\n            <version>${spring-cloud.version}</version>\n            <type>pom</type>\n            <scope>import</scope>\n         </dependency>\n      </dependencies>\n   </dependencymanagement>\n\n   <build>\n      <plugins>\n         <plugin>\n            <groupid>org.springframework.boot</groupid>\n            <artifactid>spring-boot-maven-plugin</artifactid>\n         </plugin>\n      </plugins>\n   </build>\n\n</project>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n\n\n# 3ãç¼åå®ä½ç±»\n\nuser.java\n\npackage com.yjxxt.springsecurityoauth2demo.pojo;\n\nimport org.springframework.security.core.grantedauthority;\nimport org.springframework.security.core.userdetails.userdetails;\n\nimport java.util.collection;\nimport java.util.list;\n\n/**\n * ç¨æ·ç±»\n */\npublic class user implements userdetails {\n\n    private string username;\n    private string password;\n    private list<grantedauthority> authorities;\n\n    public user(string username, string password, list<grantedauthority> authorities) {\n        this.username = username;\n        this.password = password;\n        this.authorities = authorities;\n    }\n\n    @override\n    public collection<? extends grantedauthority> getauthorities() {\n        return authorities;\n    }\n\n    @override\n    public string getpassword() {\n        return password;\n    }\n\n    @override\n    public string getusername() {\n        return username;\n    }\n\n    @override\n    public boolean isaccountnonexpired() {\n        return true;\n    }\n\n    @override\n    public boolean isaccountnonlocked() {\n        return true;\n    }\n\n    @override\n    public boolean iscredentialsnonexpired() {\n        return true;\n    }\n\n    @override\n    public boolean isenabled() {\n        return true;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n\n\n# 4ãç¼åservice\n\nuserservice.java\n\npackage com.yjxxt.springsecurityoauth2demo.service;\n\nimport com.yjxxt.springsecurityoauth2demo.pojo.user;\nimport org.springframework.beans.factory.annotation.autowired;\nimport org.springframework.security.core.authority.authorityutils;\nimport org.springframework.security.core.userdetails.userdetails;\nimport org.springframework.security.core.userdetails.userdetailsservice;\nimport org.springframework.security.core.userdetails.usernamenotfoundexception;\nimport org.springframework.security.crypto.password.passwordencoder;\nimport org.springframework.stereotype.service;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@service\npublic class userservice implements userdetailsservice {\n\n   @autowired\n   private passwordencoder passwordencoder;\n\n   @override\n   public userdetails loaduserbyusername(string username) throws usernamenotfoundexception {\n      string password = passwordencoder.encode("123456");\n      return new user("admin",password, authorityutils.commaseparatedstringtoauthoritylist("admin"));\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n\n\n# 5ãç¼åcontroller\n\nusercontroller.java\n\npackage com.yjxxt.springsecurityoauth2demo.controller;\n\nimport org.springframework.security.core.authentication;\nimport org.springframework.web.bind.annotation.getmapping;\nimport org.springframework.web.bind.annotation.requestmapping;\nimport org.springframework.web.bind.annotation.restcontroller;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@restcontroller\n@requestmapping("/user")\npublic class usercontroller {\n\n   @getmapping("/getcurrentuser")\n   public object getcurrentuser(authentication authentication) {\n      return authentication.getprincipal();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n# 6ãç¼åéç½®ç±»\n\nsecurityconfig.java\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.context.annotation.bean;\nimport org.springframework.context.annotation.configuration;\nimport org.springframework.security.config.annotation.web.builders.httpsecurity;\nimport org.springframework.security.config.annotation.web.configuration.enablewebsecurity;\nimport org.springframework.security.config.annotation.web.configuration.websecurityconfigureradapter;\nimport org.springframework.security.crypto.bcrypt.bcryptpasswordencoder;\nimport org.springframework.security.crypto.password.passwordencoder;\n\n/**\n * spring security éç½®ç±»\n *\n * @author zhoubin\n */\n@configuration\n@enablewebsecurity\npublic class securityconfig extends websecurityconfigureradapter {\n\n   @bean\n   public passwordencoder passwordencoder() {\n      return new bcryptpasswordencoder();\n   }\n\n\n   @override\n   public void configure(httpsecurity http) throws exception {\n      http.csrf()\n            .disable()\n            .authorizerequests()\n            .antmatchers("/oauth/**", "/login/**", "/logout/**")\n            .permitall()\n            .anyrequest()\n            .authenticated()\n            .and()\n            .formlogin()\n            .permitall();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n\n\nauthorizationserverconfig.java\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.beans.factory.annotation.autowired;\nimport org.springframework.context.annotation.configuration;\nimport org.springframework.security.crypto.password.passwordencoder;\nimport org.springframework.security.oauth2.config.annotation.configurers.clientdetailsserviceconfigurer;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.authorizationserverconfigureradapter;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.enableauthorizationserver;\n\n/**\n * æææå¡å¨éç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@configuration\n@enableauthorizationserver\npublic class authorizationserverconfig extends authorizationserverconfigureradapter {\n\n    @autowired\n    private passwordencoder passwordencoder;\n\n\n    @override\n    public void configure(clientdetailsserviceconfigurer clients) throws exception {\n        clients.inmemory()\n                //éç½®client_id\n                .withclient("admin")\n                //éç½®client-secret\n                .secret(passwordencoder.encode("112233"))\n                //éç½®redirect_uriï¼ç¨äºæææååè·³è½¬\n                .redirecturis("http://www.baidu.com")\n                //éç½®ç³è¯·çæéèå´\n                .scopes("all")\n                //éç½®grant_typeï¼è¡¨ç¤ºææç±»å\n                .authorizedgranttypes("authorization_code");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n\n\nresourceserverconfig.java\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.context.annotation.configuration;\nimport org.springframework.security.config.annotation.web.builders.httpsecurity;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.enableresourceserver;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.resourceserverconfigureradapter;\n\n/**\n * èµæºæå¡å¨éç½®\n *\n * @author zhoubin\n * @since 1.0.0\n */\n@configuration\n@enableresourceserver\npublic class resourceserverconfig extends resourceserverconfigureradapter {\n\n    @override\n    public void configure(httpsecurity http) throws exception {\n        http.authorizerequests()\n                .anyrequest()\n                .authenticated()\n                .and()\n                .requestmatchers()\n                .antmatchers("/user/**");//éç½®éè¦ä¿æ¤çèµæºè·¯å¾\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n\n\n# 7ãæµè¯\n\n# è·åææç \n\nhttp://localhost:8080/oauth/authorize?response_type=code&client_id=admin&redirect_uri=http://www.baidu.com&scope=all\n\n\n\nè¾å¥è´¦æ·å¯ç \n\n\n\nç¹å»ææè·åææç \n\n\n\n# æ ¹æ®ææç è·åä»¤çï¼postè¯·æ±ï¼\n\n\n\n\n\n * grant_typeï¼ææç±»åï¼å¡«åauthorization_codeï¼è¡¨ç¤ºææç æ¨¡å¼\n\n * codeï¼ææç ï¼å°±æ¯ååè·åçææç ï¼æ³¨æï¼ææç åªä½¿ç¨ä¸æ¬¡å°±æ æäºï¼éè¦éæ°ç³è¯·ã\n\n * client_id:å®¢æ·ç«¯æ è¯\n\n * redirect_uriï¼ç³è¯·ææç æ¶çè·³è½¬urlï¼ä¸å®åç³è¯·ææç æ¶ç¨çredirect_uriä¸è´ã\n\n * scope:ææèå´ã\n\nè®¤è¯å¤±è´¥æå¡ç«¯è¿å 401 unauthorized\n\næ³¨æï¼æ­¤æ¶æ æ³è¯·æ±å°ä»¤çï¼è®¿é®æå¡å¨ä¼æ¥é\n\n\n\n# æ ¹æ®tokenå»èµæºæå¡å¨æ¿èµæº\n\n\n\nå¦æä¿®æ¹tokenå°±ä¼æ¥é\n\n\n\n\n# spring security oauth2 å¯ç æ¨¡å¼\n\nå¨ä¸é¢çä»£ç ä¸­è¿è¡éå½çä¿®æ¹å³å¯\n\nsecurityconfig.java\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.context.annotation.bean;\nimport org.springframework.context.annotation.configuration;\nimport org.springframework.security.authentication.authenticationmanager;\nimport org.springframework.security.config.annotation.web.builders.httpsecurity;\nimport org.springframework.security.config.annotation.web.configuration.enablewebsecurity;\nimport org.springframework.security.config.annotation.web.configuration.websecurityconfigureradapter;\nimport org.springframework.security.crypto.bcrypt.bcryptpasswordencoder;\nimport org.springframework.security.crypto.password.passwordencoder;\n\n/**\n * spring security éç½®ç±»\n *\n * @author zhoubin\n */\n@configuration\n@enablewebsecurity\npublic class securityconfig extends websecurityconfigureradapter {\n\n   @bean\n   public passwordencoder passwordencoder() {\n      return new bcryptpasswordencoder();\n   }\n\n   /**\n     * ä½¿ç¨å¯ç æ¨¡å¼éè¦éç½®\n     */\n   @bean\n   @override\n   public authenticationmanager authenticationmanagerbean() throws exception {\n      return super.authenticationmanagerbean();\n   }\n\n   @override\n   public void configure(httpsecurity http) throws exception {\n      http.csrf()\n            .disable()\n            .authorizerequests()\n            .antmatchers("/oauth/**", "/login/**", "/logout/**")\n            .permitall()\n            .anyrequest()\n            .authenticated()\n            .and()\n            .formlogin()\n            .permitall();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n\n\nauthorizationserverconfig.java\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport com.yjxxt.springsecurityoauth2demo.service.userservice;\nimport org.springframework.beans.factory.annotation.autowired;\nimport org.springframework.context.annotation.configuration;\nimport org.springframework.security.authentication.authenticationmanager;\nimport org.springframework.security.crypto.password.passwordencoder;\nimport org.springframework.security.oauth2.config.annotation.configurers.clientdetailsserviceconfigurer;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.authorizationserverconfigureradapter;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.enableauthorizationserver;\nimport org.springframework.security.oauth2.config.annotation.web.configurers.authorizationserverendpointsconfigurer;\n\n/**\n * æææå¡å¨éç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@configuration\n@enableauthorizationserver\npublic class authorizationserverconfig extends authorizationserverconfigureradapter {\n\n    @autowired\n    private passwordencoder passwordencoder;\n\n    @autowired\n    private authenticationmanager authenticationmanager;\n\n    @autowired\n    private userservice userservice;\n\n    /**\n     * ä½¿ç¨å¯ç æ¨¡å¼éè¦éç½®\n     */\n    @override\n    public void configure(authorizationserverendpointsconfigurer endpoints) {\n        endpoints.authenticationmanager(authenticationmanager)\n                .userdetailsservice(userservice);\n    }\n\n    @override\n    public void configure(clientdetailsserviceconfigurer clients) throws exception {\n        clients.inmemory()\n                //éç½®client_id\n                .withclient("admin")\n                //éç½®client-secret\n                .secret(passwordencoder.encode("112233"))\n                //éç½®è®¿é®tokençæææ\n                .accesstokenvalidityseconds(3600)\n                //éç½®å·æ°tokençæææ\n                .refreshtokenvalidityseconds(864000)\n                //éç½®redirect_uriï¼ç¨äºæææååè·³è½¬\n                .redirecturis("http://www.baidu.com")\n                //éç½®ç³è¯·çæéèå´\n                .scopes("all")\n                //éç½®grant_typeï¼è¡¨ç¤ºææç±»å\n                .authorizedgranttypes("authorization_code","password");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n\n\næµè¯ï¼\n\n\n\n\n\n\n# å¨redisä¸­å­å¨token\n\nä¹åçä»£ç æä»¬å°tokenç´æ¥å­å¨åå­ä¸­ï¼è¿å¨çäº§ç¯å¢ä¸­æ¯ä¸åççï¼ä¸é¢æä»¬å°å¶æ¹é æå­å¨å¨redisä¸­\n\n# æ·»å ä¾èµåéç½®\n\npom.xml\n\n\x3c!--redis ä¾èµ--\x3e\n<dependency>\n   <groupid>org.springframework.boot</groupid>\n   <artifactid>spring-boot-starter-data-redis</artifactid>\n</dependency>\n\x3c!-- commons-pool2 å¯¹è±¡æ± ä¾èµ --\x3e\n<dependency>\n   <groupid>org.apache.commons</groupid>\n   <artifactid>commons-pool2</artifactid>\n</dependency>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\napplication.properties\n\n# rediséç½®\nspring.redis.host=192.168.10.100\n\n\n1\n2\n\n\n# ç¼årediséç½®ç±»\n\nredisconfig.java\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.beans.factory.annotation.autowired;\nimport org.springframework.context.annotation.bean;\nimport org.springframework.context.annotation.configuration;\nimport org.springframework.data.redis.connection.redisconnectionfactory;\nimport org.springframework.security.oauth2.provider.token.tokenstore;\nimport org.springframework.security.oauth2.provider.token.store.redis.redistokenstore;\n\n/**\n * ä½¿ç¨rediså­å¨tokençéç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@configuration\npublic class redisconfig {\n   @autowired\n   private redisconnectionfactory redisconnectionfactory;\n\n   @bean\n   public tokenstore redistokenstore(){\n      return new redistokenstore(redisconnectionfactory);\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\n# å¨è®¤è¯æå¡å¨éç½®ä¸­æå®ä»¤ççå­å¨ç­ç¥ä¸ºredis\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport com.yjxxt.springsecurityoauth2demo.service.userservice;\nimport org.springframework.beans.factory.annotation.autowired;\nimport org.springframework.beans.factory.annotation.qualifier;\nimport org.springframework.context.annotation.configuration;\nimport org.springframework.security.authentication.authenticationmanager;\nimport org.springframework.security.crypto.password.passwordencoder;\nimport org.springframework.security.oauth2.config.annotation.configurers.clientdetailsserviceconfigurer;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.authorizationserverconfigureradapter;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.enableauthorizationserver;\nimport org.springframework.security.oauth2.config.annotation.web.configurers.authorizationserverendpointsconfigurer;\nimport org.springframework.security.oauth2.provider.token.tokenstore;\n\n/**\n * æææå¡å¨éç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@configuration\n@enableauthorizationserver\npublic class authorizationserverconfig extends authorizationserverconfigureradapter {\n\n    @autowired\n    private passwordencoder passwordencoder;\n\n    @autowired\n    private authenticationmanager authenticationmanager;\n\n    @autowired\n    private userservice userservice;\n\n    @autowired\n    @qualifier("redistokenstore")\n    private tokenstore tokenstore;\n\n    /**\n     * ä½¿ç¨å¯ç æ¨¡å¼éè¦éç½®\n     */\n    @override\n    public void configure(authorizationserverendpointsconfigurer endpoints) {\n        endpoints.authenticationmanager(authenticationmanager)\n                .userdetailsservice(userservice)\n                .tokenstore(tokenstore);\n    }\n\n    @override\n    public void configure(clientdetailsserviceconfigurer clients) throws exception {\n        clients.inmemory()\n                //éç½®client_id\n                .withclient("admin")\n                //éç½®client-secret\n                .secret(passwordencoder.encode("112233"))\n                //éç½®è®¿é®tokençæææ\n                .accesstokenvalidityseconds(3600)\n                //éç½®å·æ°tokençæææ\n                .refreshtokenvalidityseconds(864000)\n                //éç½®redirect_uriï¼ç¨äºæææååè·³è½¬\n                .redirecturis("http://www.baidu.com")\n                //éç½®ç³è¯·çæéèå´\n                .scopes("all")\n                //éç½®grant_typeï¼è¡¨ç¤ºææç±»å\n                .authorizedgranttypes("password");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n\n\næµè¯ï¼\n\nä½¿ç¨å¯ç æ¨¡å¼è¯·æ±token\n\n\n\n\n\n\n# jwt\n\n\n# å¸¸è§çè®¤è¯æºå¶\n\n# http basic auth\n\nhttp basic authç®åç¹è¯´æå°±æ¯æ¯æ¬¡è¯·æ±apiæ¶é½æä¾ç¨æ·çusernameåpasswordï¼ç®è¨ä¹ï¼basic authæ¯éårestful api ä½¿ç¨çæç®åçè®¤è¯æ¹å¼ï¼åªéæä¾ç¨æ·åå¯ç å³å¯ï¼ä½ç±äºææç¨æ·åå¯ç æ´é²ç»ç¬¬ä¸æ¹å®¢æ·ç«¯çé£é©ï¼å¨çäº§ç¯å¢ä¸è¢«ä½¿ç¨çè¶æ¥è¶å°ãå æ­¤ï¼å¨å¼åå¯¹å¤å¼æ¾çrestful apiæ¶ï¼å°½éé¿åéç¨http basic authã\n\n# cookie auth\n\ncookieè®¤è¯æºå¶å°±æ¯ä¸ºä¸æ¬¡è¯·æ±è®¤è¯å¨æå¡ç«¯åå»ºä¸ä¸ªsessionå¯¹è±¡ï¼åæ¶å¨å®¢æ·ç«¯çæµè§å¨ç«¯åå»ºäºä¸ä¸ªcookieå¯¹è±¡ï¼éè¿å®¢æ·ç«¯å¸¦ä¸æ¥cookieå¯¹è±¡æ¥ä¸æå¡å¨ç«¯çsessionå¯¹è±¡å¹éæ¥å®ç°ç¶æç®¡ççãé»è®¤çï¼å½æä»¬å³é­æµè§å¨çæ¶åï¼cookieä¼è¢«å é¤ãä½å¯ä»¥éè¿ä¿®æ¹cookie çexpire timeä½¿cookieå¨ä¸å®æ¶é´åææã\n\n\n\n# oauth\n\noauthï¼å¼æ¾ææ,open authorizationï¼æ¯ä¸ä¸ªå¼æ¾çæææ åï¼åè®¸ç¨æ·è®©ç¬¬ä¸æ¹åºç¨è®¿é®è¯¥ç¨æ·å¨æä¸webæå¡ä¸å­å¨çç§å¯çèµæºï¼å¦ç§çï¼è§é¢ï¼èç³»äººåè¡¨ï¼ï¼èæ éå°ç¨æ·ååå¯ç æä¾ç»ç¬¬ä¸æ¹åºç¨ãå¦ç½ç«éè¿å¾®ä¿¡ãå¾®åç»å½ç­ï¼ä¸»è¦ç¨äºç¬¬ä¸æ¹ç»å½ã\n\noauthåè®¸ç¨æ·æä¾ä¸ä¸ªä»¤çï¼èä¸æ¯ç¨æ·ååå¯ç æ¥è®¿é®ä»ä»¬å­æ¾å¨ç¹å®æå¡æä¾èçæ°æ®ãæ¯ä¸ä¸ªä»¤çææä¸ä¸ªç¹å®çç¬¬ä¸æ¹ç³»ç»ï¼ä¾å¦ï¼è§é¢ç¼è¾ç½ç«)å¨ç¹å®çæ¶æ®µï¼ä¾å¦ï¼æ¥ä¸æ¥ç2å°æ¶åï¼åè®¿é®ç¹å®çèµæºï¼ä¾å¦ä»ä»æ¯æä¸ç¸åä¸­çè§é¢ï¼ãè¿æ ·ï¼oauthè®©ç¨æ·å¯ä»¥ææç¬¬ä¸æ¹ç½ç«è®¿é®ä»ä»¬å­å¨å¨å¦å¤æå¡æä¾èçæäºç¹å®ä¿¡æ¯ï¼èéææåå®¹ã\n\nä¸é¢æ¯oauth2.0çæµç¨ï¼\n\n\n\nè¿ç§åºäºoauthçè®¤è¯æºå¶éç¨äºä¸ªäººæ¶è´¹èç±»çäºèç½äº§åï¼å¦ç¤¾äº¤ç±»appç­åºç¨ï¼ä½æ¯ä¸å¤ªéåæ¥æèªæè®¤è¯æéç®¡ççä¼ä¸åºç¨ã\n\nç¼ºç¹ï¼è¿éã\n\n# token auth\n\nä½¿ç¨åºäº token çèº«ä»½éªè¯æ¹æ³ï¼å¨æå¡ç«¯ä¸éè¦å­å¨ç¨æ·çç»å½è®°å½ãå¤§æ¦çæµç¨æ¯è¿æ ·çï¼\n\n 1. å®¢æ·ç«¯ä½¿ç¨ç¨æ·åè·å¯ç è¯·æ±ç»å½\n 2. æå¡ç«¯æ¶å°è¯·æ±ï¼å»éªè¯ç¨æ·åä¸å¯ç \n 3. éªè¯æååï¼æå¡ç«¯ä¼ç­¾åä¸ä¸ª tokenï¼åæè¿ä¸ª token åéç»å®¢æ·ç«¯\n 4. å®¢æ·ç«¯æ¶å° token ä»¥åå¯ä»¥æå®å­å¨èµ·æ¥ï¼æ¯å¦æ¾å¨ cookie é\n 5. å®¢æ·ç«¯æ¯æ¬¡åæå¡ç«¯è¯·æ±èµæºçæ¶åéè¦å¸¦çæå¡ç«¯ç­¾åç token\n 6. æå¡ç«¯æ¶å°è¯·æ±ï¼ç¶åå»éªè¯å®¢æ·ç«¯è¯·æ±éé¢å¸¦çç tokenï¼å¦æéªè¯æåï¼å°±åå®¢æ·ç«¯è¿åè¯·æ±çæ°æ®\n\n\n\næ¯ç¬¬ä¸ç§æ¹å¼æ´å®å¨ï¼æ¯ç¬¬äºç§æ¹å¼æ´èçº¦æå¡å¨èµæºï¼æ¯ç¬¬ä¸ç§æ¹å¼æ´å è½»éã\n\nå·ä½ï¼token authçä¼ç¹ï¼tokenæºå¶ç¸å¯¹äºcookieæºå¶åæä»ä¹å¥½å¤å¢ï¼ï¼ï¼\n\n * æ¯æè·¨åè®¿é®ï¼cookieæ¯ä¸åè®¸å®åè®¿é®çï¼è¿ä¸ç¹å¯¹tokenæºå¶æ¯ä¸å­å¨çï¼åææ¯ä¼ è¾çç¨æ·è®¤è¯ä¿¡æ¯éè¿httpå¤´ä¼ è¾.\n * æ ç¶æ(ä¹ç§°ï¼æå¡ç«¯å¯æ©å±è¡)ï¼tokenæºå¶å¨æå¡ç«¯ä¸éè¦å­å¨sessionä¿¡æ¯ï¼å ä¸ºtoken èªèº«åå«äºææç»å½ç¨æ·çä¿¡æ¯ï¼åªéè¦å¨å®¢æ·ç«¯çcookieææ¬å°ä»è´¨å­å¨ç¶æä¿¡æ¯.\n * æ´éç¨cdnï¼å¯ä»¥éè¿åå®¹ååç½ç»è¯·æ±ä½ æå¡ç«¯çææèµæï¼å¦ï¼javascriptï¼html,å¾çç­ï¼ï¼èä½ çæå¡ç«¯åªè¦æä¾apiå³å¯.\n * å»è¦ï¼ä¸éè¦ç»å®å°ä¸ä¸ªç¹å®çèº«ä»½éªè¯æ¹æ¡ãtokenå¯ä»¥å¨ä»»ä½å°æ¹çæï¼åªè¦å¨ä½ çapiè¢«è°ç¨çæ¶åï¼ä½ å¯ä»¥è¿è¡tokençæè°ç¨å³å¯.\n * æ´éç¨äºç§»å¨åºç¨ï¼å½ä½ çå®¢æ·ç«¯æ¯ä¸ä¸ªåçå¹³å°ï¼ios, androidï¼windows 10ç­ï¼æ¶ï¼cookieæ¯ä¸è¢«æ¯æçï¼ä½ éè¦éè¿cookieå®¹å¨è¿è¡å¤çï¼ï¼è¿æ¶éç¨tokenè®¤è¯æºå¶å°±ä¼ç®åå¾å¤ã\n * csrfï¼å ä¸ºä¸åä¾èµäºcookieï¼æä»¥ä½ å°±ä¸éè¦èèå¯¹csrfï¼è·¨ç«è¯·æ±ä¼ªé ï¼çé²èã\n * æ§è½ï¼ä¸æ¬¡ç½ç»å¾è¿æ¶é´ï¼éè¿æ°æ®åºæ¥è¯¢sessionä¿¡æ¯ï¼æ»æ¯åä¸æ¬¡hmacsha256è®¡ç®çtokenéªè¯åè§£æè¦è´¹æ¶å¾å¤.\n * ä¸éè¦ä¸ºç»å½é¡µé¢åç¹æ®å¤çï¼å¦æä½ ä½¿ç¨protractor ååè½æµè¯çæ¶åï¼ä¸åéè¦ä¸ºç»å½é¡µé¢åç¹æ®å¤ç.\n * åºäºæ ååï¼ä½ çapiå¯ä»¥éç¨æ ååç json web token (jwt). è¿ä¸ªæ åå·²ç»å­å¨å¤ä¸ªåç«¯åºï¼.net, ruby, java,python, phpï¼åå¤å®¶å¬å¸çæ¯æï¼å¦ï¼firebase,google, microsoftï¼.\n\n\n# jwtç®ä»\n\n# ä»ä¹æ¯jwt\n\njson web tokenï¼jwtï¼æ¯ä¸ä¸ªå¼æ¾çè¡ä¸æ åï¼rfc 7519ï¼ï¼å®å®ä¹äºä¸ç§ç®ä»çãèªåå«çåè®®æ ¼å¼ï¼ç¨äºå¨éä¿¡åæ¹ä¼ éjsonå¯¹è±¡ï¼ä¼ éçä¿¡æ¯ç»è¿æ°å­ç­¾åå¯ä»¥è¢«éªè¯åä¿¡ä»»ãjwtå¯ä»¥ä½¿ç¨hmacç®æ³æä½¿ç¨rsaçå¬é¥/ç§é¥å¯¹æ¥ç­¾åï¼é²æ­¢è¢«ç¯¡æ¹ã\n\nå®ç½ï¼ https://jwt.io/\n\næ åï¼ https://tools.ietf.org/html/rfc7519\n\njwtä»¤ççä¼ç¹ï¼\n\n * jwtåºäºjsonï¼éå¸¸æ¹ä¾¿è§£æã\n * å¯ä»¥å¨ä»¤çä¸­èªå®ä¹ä¸°å¯çåå®¹ï¼ææ©å±ã\n * éè¿éå¯¹ç§°å å¯ç®æ³åæ°å­ç­¾åææ¯ï¼jwté²æ­¢ç¯¡æ¹ï¼å®å¨æ§é«ã\n * èµæºæå¡ä½¿ç¨jwtå¯ä¸ä¾èµè®¤è¯æå¡å³å¯å®æææã\n\nç¼ºç¹ï¼\n\n 1. jwtä»¤çè¾é¿ï¼å å­å¨ç©ºé´æ¯è¾å¤§ã\n\n# jwtç»æ\n\nä¸ä¸ªjwtå®éä¸å°±æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼å®ç±ä¸é¨åç»æï¼å¤´é¨ãè½½è·ä¸ç­¾åã\n\n# å¤´é¨(header)\n\nå¤´é¨ç¨äºæè¿°å³äºè¯¥jwtçæåºæ¬çä¿¡æ¯ï¼ä¾å¦å¶ç±»åï¼å³jwtï¼ä»¥åç­¾åæç¨çç®æ³ï¼å¦hmac sha256ærsaï¼ç­ãè¿ä¹å¯ä»¥è¢«è¡¨ç¤ºæä¸ä¸ªjsonå¯¹è±¡ã\n\n{\n  "alg": "hs256",\n  "typ": "jwt"\n}\n\n\n1\n2\n3\n4\n\n * typï¼æ¯ç±»åã\n * algï¼ç­¾åçç®æ³ï¼è¿éä½¿ç¨çç®æ³æ¯hs256ç®æ³\n\næä»¬å¯¹å¤´é¨çjsonå­ç¬¦ä¸²è¿è¡base64ç¼ç ï¼ç½ä¸æå¾å¤å¨çº¿ç¼ç çç½ç«ï¼ï¼ç¼ç åçå­ç¬¦ä¸²å¦ä¸ï¼\n\neyjhbgcioijiuzi1niisinr5cci6ikpxvcj9\n\n\n1\n\n\nbase64æ¯ä¸ç§åºäº64ä¸ªå¯æå°å­ç¬¦æ¥è¡¨ç¤ºäºè¿å¶æ°æ®çè¡¨ç¤ºæ¹æ³ãç±äº2ç6æ¬¡æ¹ç­äº64ï¼æä»¥æ¯6ä¸ªæ¯ç¹ä¸ºä¸ä¸ªååï¼å¯¹åºæä¸ªå¯æå°å­ç¬¦ãä¸ä¸ªå­èæ24ä¸ªæ¯ç¹ï¼å¯¹åºäº4ä¸ªbase64ååï¼å³3ä¸ªå­èéè¦ç¨4ä¸ªå¯æå°å­ç¬¦æ¥è¡¨ç¤ºãjdk ä¸­æä¾äºéå¸¸æ¹ä¾¿ç base64encoderå base64decoderï¼ç¨å®ä»¬å¯ä»¥éå¸¸æ¹ä¾¿çå®æåºäº base64 çç¼ç åè§£ç ã\n\n# è´è½½(payload)\n\nç¬¬äºé¨åæ¯è´è½½ï¼å°±æ¯å­æ¾ææä¿¡æ¯çå°æ¹ãè¿ä¸ªåå­åæ¯ç¹æé£æºä¸æ¿è½½çè´§åï¼è¿äºææä¿¡æ¯åå«ä¸ä¸ªé¨åï¼\n\n * æ åä¸­æ³¨åçå£°æï¼å»ºè®®ä½ä¸å¼ºå¶ä½¿ç¨ï¼\n\niss: jwtç­¾åè\nsub: jwtæé¢åçç¨æ·\naud: æ¥æ¶jwtçä¸æ¹\nexp: jwtçè¿ææ¶é´ï¼è¿ä¸ªè¿ææ¶é´å¿é¡»è¦å¤§äºç­¾åæ¶é´\nnbf: å®ä¹å¨ä»ä¹æ¶é´ä¹åï¼è¯¥jwté½æ¯ä¸å¯ç¨ç.\niat: jwtçç­¾åæ¶é´\njti: jwtçå¯ä¸èº«ä»½æ è¯ï¼ä¸»è¦ç¨æ¥ä½ä¸ºä¸æ¬¡æ§token,ä»èåé¿éæ¾æ»å»ã\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n * å¬å±çå£°æ\n   \n   å¬å±çå£°æå¯ä»¥æ·»å ä»»ä½çä¿¡æ¯ï¼ä¸è¬æ·»å ç¨æ·çç¸å³ä¿¡æ¯æå¶ä»ä¸å¡éè¦çå¿è¦ä¿¡æ¯.ä½ä¸å»ºè®®æ·»å ææä¿¡æ¯ï¼å ä¸ºè¯¥é¨åå¨å®¢æ·ç«¯å¯è§£å¯.\n\n * ç§æçå£°æ\n   \n   ç§æå£°ææ¯æä¾èåæ¶è´¹èæå±åå®ä¹çå£°æï¼ä¸è¬ä¸å»ºè®®å­æ¾ææä¿¡æ¯ï¼å ä¸ºbase64æ¯å¯¹ç§°è§£å¯çï¼æå³çè¯¥é¨åä¿¡æ¯å¯ä»¥å½ç±»ä¸ºææä¿¡æ¯ã\n\nè¿ä¸ªæçå°±æ¯èªå®ä¹çclaimãæ¯å¦ä¸é¢é£ä¸ªä¸¾ä¾ä¸­çnameé½å±äºèªå®çclaimãè¿äºclaimè·jwtæ åè§å®çclaimåºå«å¨äºï¼jwtè§å®çclaimï¼jwtçæ¥æ¶æ¹å¨æ¿å°jwtä¹åï¼é½ç¥éæä¹å¯¹è¿äºæ åçclaimè¿è¡éªè¯(è¿ä¸ç¥éæ¯å¦è½å¤éªè¯)ï¼èprivate claimsä¸ä¼éªè¯ï¼é¤éæç¡®åè¯æ¥æ¶æ¹è¦å¯¹è¿äºclaimè¿è¡éªè¯ä»¥åè§åæè¡ã\n\n{\n  "sub": "1234567890",\n  "name": "john doe",\n  "iat": 1516239022\n}\n\n\n1\n2\n3\n4\n5\n\n\nå¶ä¸­subæ¯æ åçå£°æï¼nameæ¯èªå®ä¹çå£°æï¼å¬å±çæç§æçï¼\n\nç¶åå°å¶è¿è¡base64ç¼ç ï¼å¾å°jwtçç¬¬äºé¨åï¼\n\n eyjzdwiioiixmjm0nty3odkwiiwibmftzsi6ikphbwvziiwiywrtaw4ionrydwv9\n\n\n1\n\n\næç¤ºï¼å£°æä¸­ä¸è¦æ¾ä¸äºææä¿¡æ¯ã\n\n# ç­¾è¯ãç­¾åï¼signatureï¼\n\njwtçç¬¬ä¸é¨åæ¯ä¸ä¸ªç­¾è¯ä¿¡æ¯ï¼è¿ä¸ªç­¾è¯ä¿¡æ¯ç±ä¸é¨åç»æï¼\n\n * header (base64åç)\n\n * payload (base64åç)\n\n * secretï¼çï¼ä¸å®è¦ä¿å¯ï¼\n\nè¿ä¸ªé¨åéè¦base64å å¯åçheaderåbase64å å¯åçpayloadä½¿ç¨.è¿æ¥ç»æçå­ç¬¦ä¸²ï¼ç¶åéè¿headerä¸­å£°æçå å¯æ¹å¼è¿è¡å çsecretç»åå å¯ï¼ç¶åå°±ææäºjwtçç¬¬ä¸é¨åï¼\n\n8hi-lod0ncfvdnbkipjjqlh998duf9dsdgkx3grpnvi\n\n\n1\n\n\nå°è¿ä¸é¨åç¨.è¿æ¥æä¸ä¸ªå®æ´çå­ç¬¦ä¸²,ææäºæç»çjwt:\n\neyjhbgcioijiuzi1niisinr9cci6ikpxvcj9.eyjzdwiioiixmjm0nty3odkwiiwibmftzsi6ikpvag4grg9liiwiawf0ijoxnte2mjm5mdiyfq.8hi-lod0ncfvdnbkipjjqlh998duf9dsdgkx3grpnvi\n\n\n1\n\n\næ³¨æï¼secretæ¯ä¿å­å¨æå¡å¨ç«¯çï¼jwtçç­¾åçæä¹æ¯å¨æå¡å¨ç«¯çï¼secretå°±æ¯ç¨æ¥è¿è¡jwtçç­¾ååjwtçéªè¯ï¼æä»¥ï¼å®å°±æ¯ä½ æå¡ç«¯çç§é¥ï¼å¨ä»»ä½åºæ¯é½ä¸åºè¯¥æµé²åºå»ãä¸æ¦å®¢æ·ç«¯å¾ç¥è¿ä¸ªsecret, é£å°±æå³çå®¢æ·ç«¯æ¯å¯ä»¥èªæç­¾åjwtäºã\n\n\n# jjwtç®ä»\n\n# ä»ä¹æ¯jjwt\n\njjwtæ¯ä¸ä¸ªæä¾ç«¯å°ç«¯çjwtåå»ºåéªè¯çjavaåºãæ°¸è¿åè´¹åå¼æº(apache licenseï¼çæ¬2.0)ï¼jjwå¾å®¹æä½¿ç¨åçè§£ãå®è¢«è®¾è®¡æä¸ä¸ªä»¥å»ºç­ä¸ºä¸­å¿çæµççé¢ï¼éèäºå®çå¤§é¨åå¤ææ§ã\n\nè§èå®ç½ï¼https://jwt.io/\n\n# å¿«éå¥é¨\n\n# tokençåå»º\n\nåå»ºspringbootå·¥ç¨ï¼å¼å¥ä¾èµ\n\n<?xml version="1.0" encoding="utf-8"?>\n<project xmlns="http://maven.apache.org/pom/4.0.0" xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n         xsi:schemalocation="http://maven.apache.org/pom/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">\n   <modelversion>4.0.0</modelversion>\n   <parent>\n      <groupid>org.springframework.boot</groupid>\n      <artifactid>spring-boot-starter-parent</artifactid>\n      <version>2.2.2.release</version>\n      <relativepath/> \x3c!-- lookup parent from repository --\x3e\n   </parent>\n  \n   <groupid>com.yjxxt</groupid>\n   <artifactid>jwtdemo</artifactid>\n   <version>0.0.1-snapshot</version>\n  \n   <name>jwtdemo</name>\n   <description>demo project for spring boot</description>\n\n   <properties>\n      <java.version>1.8</java.version>\n   </properties>\n\n   <dependencies>\n      <dependency>\n         <groupid>org.springframework.boot</groupid>\n         <artifactid>spring-boot-starter-web</artifactid>\n      </dependency>\n      \x3c!--jwtä¾èµ--\x3e\n      <dependency>\n         <groupid>io.jsonwebtoken</groupid>\n         <artifactid>jjwt</artifactid>\n         <version>0.9.0</version>\n      </dependency>\n\n      <dependency>\n         <groupid>org.springframework.boot</groupid>\n         <artifactid>spring-boot-starter-test</artifactid>\n         <scope>test</scope>\n         <exclusions>\n            <exclusion>\n               <groupid>org.junit.vintage</groupid>\n               <artifactid>junit-vintage-engine</artifactid>\n            </exclusion>\n         </exclusions>\n      </dependency>\n   </dependencies>\n</project>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n\n\nåå»ºæµè¯ç±»jwttestï¼ç¨äºçætokenï¼\n\npackage com.yjxxt.jwtdemo;\n\nimport io.jsonwebtoken.jwtbuilder;\nimport io.jsonwebtoken.jwts;\nimport io.jsonwebtoken.signaturealgorithm;\nimport io.jsonwebtoken.impl.base64codec;\nimport org.junit.jupiter.api.test;\nimport org.springframework.boot.test.context.springboottest;\n\nimport java.util.date;\n\n@springboottest\npublic class jwtdemoapplicationtests {\n\n   /**\n    * åå»ºtoken\n    */\n   @test\n   public void testcreattoken() {\n      //åå»ºä¸ä¸ªjwtbuilderå¯¹è±¡\n      jwtbuilder jwtbuilder = jwts.builder()\n            //å£°æçæ è¯{"jti":"888"}\n            .setid("888")\n            //ä¸»ä½ï¼ç¨æ·{"sub":"rose"}\n            .setsubject("rose")\n            //åå»ºæ¥æ{"ita":"yjxxtxx"}\n            .setissuedat(new date())\n            //ç­¾åææ®µï¼åæ°1ï¼ç®æ³ï¼åæ°2ï¼ç\n            .signwith(signaturealgorithm.hs256,"yjxxt");\n       \n      //è·åjwtçtoken\n      string token = jwtbuilder.compact();\n      system.out.println(token);\n\n      //ä¸é¨åçbase64è§£å¯\n      system.out.println("--------------------");\n      string[] split = token.split("\\\\.");\n      system.out.println(base64codec.base64.decodetostring(split[0]));\n      system.out.println(base64codec.base64.decodetostring(split[1]));\n      //æ æ³è§£å¯\n      system.out.println(base64codec.base64.decodetostring(split[2]));\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n\n\nè¿è¡ç»æå¦ä¸\n\n\n\nåæ¬¡è¿è¡ï¼ä¼åç°æ¯æ¬¡è¿è¡çç»ææ¯ä¸ä¸æ ·çï¼å ä¸ºæä»¬çè½½è·ä¸­åå«äºæ¶é´\n\n# tokençéªè¯è§£æ\n\næä»¬åæå·²ç»åå»ºäºtoken ï¼å¨webåºç¨ä¸­è¿ä¸ªæä½æ¯ç±æå¡ç«¯è¿è¡ç¶ååç»å®¢æ·ç«¯ï¼å®¢æ·ç«¯å¨ä¸æ¬¡åæå¡ç«¯åéè¯·æ±æ¶éè¦æºå¸¦è¿ä¸ªtokenï¼è¿å°±å¥½åæ¯æ¿çä¸å¼ é¨ç¥¨ä¸æ ·ï¼ï¼é£æå¡ç«¯æ¥å°è¿ä¸ªtoken åºè¯¥è§£æåºtokenä¸­çä¿¡æ¯ï¼ä¾å¦ç¨æ·idï¼,æ ¹æ®è¿äºä¿¡æ¯æ¥è¯¢æ°æ®åºè¿åç¸åºçç»æã\n\n@test\npublic void testparsetoken(){\n   //token\n   string token = "eyjhbgcioijiuzi1nij9.eyjqdgkioii4odgilcjzdwiioijsb3nliiwiawf0ijoxntc4ode0mjuyfq" +\n         ".-fyfmhyftcgzq900f_drfdsges0ge2ujawvpw9gcdto";\n   //è§£ætokenè·åè´è½½ä¸­çå£°æå¯¹è±¡\n   claims claims = jwts.parser()\n         .setsigningkey("yjxxt")\n         .parseclaimsjws(token)\n         .getbody();\n   //æå°å£°æçå±æ§\n   system.out.println("id:"+claims.getid());\n   system.out.println("subject:"+claims.getsubject());\n   system.out.println("issuedat:"+claims.getissuedat());\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nè¯çå°tokenæç­¾åç§é¥ç¯¡æ¹ä¸ä¸ï¼ä¼åç°è¿è¡æ¶å°±ä¼æ¥éï¼æä»¥è§£ætokenä¹å°±æ¯éªè¯token\n\n# tokenè¿ææ ¡éª\n\næå¾å¤æ¶åï¼æä»¬å¹¶ä¸å¸æç­¾åçtokenæ¯æ°¸ä¹çæçï¼ä¸èçtokenæ¯æ°¸ä¹çï¼ï¼æä»¥æä»¬å¯ä»¥ä¸ºtokenæ·»å ä¸ä¸ªè¿ææ¶é´ãåå ï¼ä»æå¡å¨ååºçtokenï¼æå¡å¨èªå·±å¹¶ä¸åè®°å½ï¼å°±å­å¨ä¸ä¸ªå¼ç«¯å°±æ¯ï¼æå¡ç«¯æ æ³ä¸»å¨æ§å¶ætokençç«å»å¤±æã\n\næµè¯ç¨ä¾ï¼\n\n@test\npublic void testcreattokenhasexp() {\n   //å½åç³»ç»æ¶é´çé¿æ´å\n   long now = system.currenttimemillis();\n   //è¿ææ¶é´ï¼è¿éæ¯1åéåçæ¶é´é¿æ´å\n   long exp = now + 60 * 1000;\n   //åå»ºä¸ä¸ªjwtbuilderå¯¹è±¡\n   jwtbuilder jwtbuilder = jwts.builder()\n         //å£°æçæ è¯{"jti":"888"}\n         .setid("888")\n         //ä¸»ä½ï¼ç¨æ·{"sub":"rose"}\n         .setsubject("rose")\n         //åå»ºæ¥æ{"ita":"yjxxtxx"}\n         .setissuedat(new date())\n         //ç­¾åææ®µï¼åæ°1ï¼ç®æ³ï¼åæ°2ï¼ç\n         .signwith(signaturealgorithm.hs256, "yjxxt")\n         //è®¾ç½®è¿ææ¶é´\n         .setexpiration(new date(exp));\n   //è·åjwtçtoken\n   string token = jwtbuilder.compact();\n   system.out.println(token);\n}\n\n\n@test\npublic void testparsetokenhasexp() {\n   //token\n   string token = "eyjhbgcioijiuzi1nij9" +\n         ".eyjqdgkioii4odgilcjzdwiioijsb3nliiwiawf0ijoxntc4ode1mdyylcjlehaioje1nzg4mtuxmjisinjvbgvzijoiywrtaw4ilcjsb2dvijoic2hzehquanbnin0.hkog0rsz9_6ii_r8kucp0hlaouuayxajvbz3xtltuh4";\n   //è§£ætokenè·åè´è½½ä¸­çå£°æå¯¹è±¡\n   claims claims = jwts.parser()\n         .setsigningkey("yjxxt")\n         .parseclaimsjws(token)\n         .getbody();\n   //æå°å£°æçå±æ§\n   system.out.println("id:" + claims.getid());\n   system.out.println("subject:" + claims.getsubject());\n   system.out.println("issuedat:" + claims.getissuedat());\n   dateformat sf = new simpledateformat("yyyy-mm-dd hh:mm:ss");\n   system.out.println("ç­¾åæ¶é´:"+sf.format(claims.getissuedat()));\n   system.out.println("è¿ææ¶é´:"+sf.format(claims.getexpiration()));\n   system.out.println("å½åæ¶é´:"+sf.format(new date()));\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n\n\næµè¯ï¼å½æªè¿ææ¶å¯ä»¥æ­£å¸¸è¯»åï¼å½è¿ææ¶ä¼å¼åio.jsonwebtoken.expiredjwtexceptionå¼å¸¸ã\n\n\n\n# èªå®ä¹claims\n\næä»¬åæçä¾å­åªæ¯å­å¨äºidåsubjectä¸¤ä¸ªä¿¡æ¯ï¼å¦æä½ æ³å­å¨æ´å¤çä¿¡æ¯ï¼ä¾å¦è§è²ï¼å¯ä»¥å®ä¹èªå®ä¹claims\n\næµè¯ç¨ä¾ï¼\n\n@test\npublic void testcreattokenbyclaims() {\n   //å½åç³»ç»æ¶é´çé¿æ´å\n   long now = system.currenttimemillis();\n   //è¿ææ¶é´ï¼è¿éæ¯1åéåçæ¶é´é¿æ´å\n   long exp = now + 60 * 1000;\n   //åå»ºä¸ä¸ªjwtbuilderå¯¹è±¡\n   jwtbuilder jwtbuilder = jwts.builder()\n         //å£°æçæ è¯{"jti":"888"}\n         .setid("888")\n         //ä¸»ä½ï¼ç¨æ·{"sub":"rose"}\n         .setsubject("rose")\n         //åå»ºæ¥æ{"ita":"yjxxtxx"}\n         .setissuedat(new date())\n         //ç­¾åææ®µï¼åæ°1ï¼ç®æ³ï¼åæ°2ï¼ç\n         .signwith(signaturealgorithm.hs256, "yjxxt")\n         //è®¾ç½®è¿ææ¶é´\n         .setexpiration(new date(exp))\n         //ç´æ¥ä¼ å¥map\n         // .addclaims(map)\n         .claim("roles","admin")\n         .claim("logo","yjxxt.jpg");\n   //è·åjwtçtoken\n   string token = jwtbuilder.compact();\n   system.out.println(token);\n}\n\n\n@test\npublic void testparsetokenbyclaims() {\n   //token\n   string token = "eyjhbgcioijiuzi1nij9" +\n         ".eyjqdgkioii4odgilcjzdwiioijsb3nliiwiawf0ijoxntc4ode1mdyylcjlehaioje1nzg4mtuxmjisinjvbgvzijoiywrtaw4ilcjsb2dvijoic2hzehquanbnin0.hkog0rsz9_6ii_r8kucp0hlaouuayxajvbz3xtltuh4";\n   //è§£ætokenè·åè´è½½ä¸­çå£°æå¯¹è±¡\n   claims claims = jwts.parser()\n         .setsigningkey("yjxxt")\n         .parseclaimsjws(token)\n         .getbody();\n   //æå°å£°æçå±æ§\n   system.out.println("id:" + claims.getid());\n   system.out.println("subject:" + claims.getsubject());\n   system.out.println("issuedat:" + claims.getissuedat());\n   dateformat sf =new simpledateformat("yyyy-mm-dd hh:mm:ss");\n   system.out.println("ç­¾åæ¶é´:"+sf.format(claims.getissuedat()));\n   system.out.println("è¿ææ¶é´:"+sf.format(claims.getexpiration()));\n   system.out.println("å½åæ¶é´:"+sf.format(new date()));\n\n   system.out.println("roles:"+claims.get("roles"));\n   system.out.println("logo:"+claims.get("logo"));\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n\n\n\n# spring security oauth2 æ´åjwt\n\n\n# æ´åjwt\n\næä»¬æ¿ä¹åspring security oauth2çå®æ´ä»£ç è¿è¡ä¿®æ¹\n\næ·»å éç½®æä»¶jwttokenstoreconfig.java\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.context.annotation.bean;\nimport org.springframework.context.annotation.configuration;\nimport org.springframework.security.oauth2.provider.token.tokenstore;\nimport org.springframework.security.oauth2.provider.token.store.jwtaccesstokenconverter;\nimport org.springframework.security.oauth2.provider.token.store.jwttokenstore;\n\n/**\n * ä½¿ç¨jwtå­å¨tokençéç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@configuration\npublic class jwttokenstoreconfig {\n\n   @bean\n   public tokenstore jwttokenstore(){\n      return new jwttokenstore(jwtaccesstokenconverter());\n   }\n\n   @bean\n   public jwtaccesstokenconverter jwtaccesstokenconverter(){\n      jwtaccesstokenconverter accesstokenconverter = new jwtaccesstokenconverter();\n      //éç½®jwtä½¿ç¨çç§é¥\n      accesstokenconverter.setsigningkey("test_key");\n      return accesstokenconverter;\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nå¨è®¤è¯æå¡å¨éç½®ä¸­æå®ä»¤ççå­å¨ç­ç¥ä¸ºjwt\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport com.yjxxt.springsecurityoauth2demo.service.userservice;\nimport org.springframework.beans.factory.annotation.autowired;\nimport org.springframework.beans.factory.annotation.qualifier;\nimport org.springframework.context.annotation.configuration;\nimport org.springframework.security.authentication.authenticationmanager;\nimport org.springframework.security.crypto.password.passwordencoder;\nimport org.springframework.security.oauth2.config.annotation.configurers.clientdetailsserviceconfigurer;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.authorizationserverconfigureradapter;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.enableauthorizationserver;\nimport org.springframework.security.oauth2.config.annotation.web.configurers.authorizationserverendpointsconfigurer;\nimport org.springframework.security.oauth2.provider.token.tokenstore;\nimport org.springframework.security.oauth2.provider.token.store.jwtaccesstokenconverter;\n\n/**\n * æææå¡å¨éç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@configuration\n@enableauthorizationserver\npublic class authorizationserverconfig extends authorizationserverconfigureradapter {\n\n    @autowired\n    private passwordencoder passwordencoder;\n\n    @autowired\n    private authenticationmanager authenticationmanager;\n\n    @autowired\n    private userservice userservice;\n    \n    @autowired\n    @qualifier("jwttokenstore")\n    private tokenstore tokenstore;\n\n    @autowired\n    private jwtaccesstokenconverter jwtaccesstokenconverter;\n\n\n    /**\n     * ä½¿ç¨å¯ç æ¨¡å¼éè¦éç½®\n     */\n    @override\n    public void configure(authorizationserverendpointsconfigurer endpoints) {\n        endpoints.authenticationmanager(authenticationmanager)\n                .userdetailsservice(userservice)\n                //éç½®å­å¨ä»¤çç­ç¥\n                .tokenstore(tokenstore)\n                .accesstokenconverter(jwtaccesstokenconverter);\n    }\n\n    @override\n    public void configure(clientdetailsserviceconfigurer clients) throws exception {\n        clients.inmemory()\n                //éç½®client_id\n                .withclient("admin")\n                //éç½®client-secret\n                .secret(passwordencoder.encode("112233"))\n                //éç½®è®¿é®tokençæææ\n                .accesstokenvalidityseconds(3600)\n                //éç½®å·æ°tokençæææ\n                .refreshtokenvalidityseconds(864000)\n                //éç½®redirect_uriï¼ç¨äºæææååè·³è½¬\n                .redirecturis("http://www.baidu.com")\n                //éç½®ç³è¯·çæéèå´\n                .scopes("all")\n                //éç½®grant_typeï¼è¡¨ç¤ºææç±»å\n                .authorizedgranttypes("authorization_code","password");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n\n\nç¨å¯ç æ¨¡å¼æµè¯ï¼\n\n\n\nåç°è·åå°çä»¤çå·²ç»åæäºjwtä»¤çï¼å°access_tokenæ¿å°https://jwt.io/ ç½ç«ä¸å»è§£æä¸å¯ä»¥è·å¾å¶ä¸­åå®¹ã\n\n\n\n\n# æ©å±jwtä¸­å­å¨çåå®¹\n\nææ¶åæä»¬éè¦æ©å±jwtä¸­å­å¨çåå®¹ï¼è¿éæä»¬å¨jwtä¸­æ©å±ä¸ä¸ªkeyä¸ºenhanceï¼valueä¸ºenhance infoçæ°æ®ã\n\nç»§æ¿tokenenhancerå®ç°ä¸ä¸ªjwtåå®¹å¢å¼ºå¨\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.security.oauth2.common.defaultoauth2accesstoken;\nimport org.springframework.security.oauth2.common.oauth2accesstoken;\nimport org.springframework.security.oauth2.provider.oauth2authentication;\nimport org.springframework.security.oauth2.provider.token.tokenenhancer;\n\nimport java.util.hashmap;\nimport java.util.map;\n\n/**\n * jwtåå®¹å¢å¼ºå¨\n * @author zhoubin\n * @since 1.0.0\n */\npublic class jwttokenenhancer implements tokenenhancer {\n\n   @override\n   public oauth2accesstoken enhance(oauth2accesstoken accesstoken, oauth2authentication authentication) {\n      map<string,object> info = new hashmap<>();\n      info.put("enhance","enhance info");\n      ((defaultoauth2accesstoken)accesstoken).setadditionalinformation(info);\n      return accesstoken;\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nåå»ºä¸ä¸ªjwttokenenhancerå®ä¾\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport org.springframework.context.annotation.bean;\nimport org.springframework.context.annotation.configuration;\nimport org.springframework.security.oauth2.provider.token.tokenstore;\nimport org.springframework.security.oauth2.provider.token.store.jwtaccesstokenconverter;\nimport org.springframework.security.oauth2.provider.token.store.jwttokenstore;\n\n/**\n * ä½¿ç¨jwtå­å¨tokençéç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@configuration\npublic class jwttokenstoreconfig {\n\n   @bean\n   public tokenstore jwttokenstore(){\n      return new jwttokenstore(jwtaccesstokenconverter());\n   }\n\n   @bean\n   public jwtaccesstokenconverter jwtaccesstokenconverter(){\n      jwtaccesstokenconverter accesstokenconverter = new jwtaccesstokenconverter();\n      //éç½®jwtä½¿ç¨çç§é¥\n      accesstokenconverter.setsigningkey("test_key");\n      return accesstokenconverter;\n   }\n\n   @bean\n   public jwttokenenhancer jwttokenenhancer() {\n      return new jwttokenenhancer();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n\n\nå¨è®¤è¯æå¡å¨éç½®ä¸­éç½®jwtçåå®¹å¢å¼ºå¨\n\npackage com.yjxxt.springsecurityoauth2demo.config;\n\nimport com.yjxxt.springsecurityoauth2demo.component.jwttokenenhancer;\nimport com.yjxxt.springsecurityoauth2demo.service.userservice;\nimport org.springframework.beans.factory.annotation.autowired;\nimport org.springframework.beans.factory.annotation.qualifier;\nimport org.springframework.context.annotation.configuration;\nimport org.springframework.security.authentication.authenticationmanager;\nimport org.springframework.security.crypto.password.passwordencoder;\nimport org.springframework.security.oauth2.config.annotation.configurers.clientdetailsserviceconfigurer;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.authorizationserverconfigureradapter;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.enableauthorizationserver;\nimport org.springframework.security.oauth2.config.annotation.web.configurers.authorizationserverendpointsconfigurer;\nimport org.springframework.security.oauth2.provider.token.tokenenhancer;\nimport org.springframework.security.oauth2.provider.token.tokenenhancerchain;\nimport org.springframework.security.oauth2.provider.token.tokenstore;\nimport org.springframework.security.oauth2.provider.token.store.jwtaccesstokenconverter;\n\nimport java.util.arraylist;\nimport java.util.list;\n\n/**\n * æææå¡å¨éç½®\n * @author zhoubin\n * @since 1.0.0\n */\n@configuration\n@enableauthorizationserver\npublic class authorizationserverconfig extends authorizationserverconfigureradapter {\n\n    @autowired\n    private passwordencoder passwordencoder;\n\n    @autowired\n    private authenticationmanager authenticationmanager;\n\n    @autowired\n    private userservice userservice;\n\n    @autowired\n    @qualifier("jwttokenstore")\n    private tokenstore tokenstore;\n    @autowired\n    private jwtaccesstokenconverter jwtaccesstokenconverter;\n    @autowired\n    private jwttokenenhancer jwttokenenhancer;\n\n    /**\n     * ä½¿ç¨å¯ç æ¨¡å¼éè¦éç½®\n     */\n    @override\n    public void configure(authorizationserverendpointsconfigurer endpoints) {\n        tokenenhancerchain enhancerchain = new tokenenhancerchain();\n        list<tokenenhancer> delegates = new arraylist<>();\n        //éç½®jwtçåå®¹å¢å¼ºå¨\n        delegates.add(jwttokenenhancer);\n        delegates.add(jwtaccesstokenconverter);\n        enhancerchain.settokenenhancers(delegates);\n        endpoints.authenticationmanager(authenticationmanager)\n                .userdetailsservice(userservice)\n                //éç½®å­å¨ä»¤çç­ç¥\n                .tokenstore(tokenstore)\n                .accesstokenconverter(jwtaccesstokenconverter)\n                .tokenenhancer(enhancerchain);\n    }\n\n    @override\n    public void configure(clientdetailsserviceconfigurer clients) throws exception {\n        clients.inmemory()\n                //éç½®client_id\n                .withclient("admin")\n                //éç½®client-secret\n                .secret(passwordencoder.encode("112233"))\n                //éç½®è®¿é®tokençæææ\n                .accesstokenvalidityseconds(3600)\n                //éç½®å·æ°tokençæææ\n                .refreshtokenvalidityseconds(864000)\n                //éç½®redirect_uriï¼ç¨äºæææååè·³è½¬\n                .redirecturis("http://www.baidu.com")\n                //éç½®ç³è¯·çæéèå´\n                .scopes("all")\n                //éç½®grant_typeï¼è¡¨ç¤ºææç±»å\n                .authorizedgranttypes("authorization_code","password");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n\n\nè¿è¡é¡¹ç®åä½¿ç¨å¯ç æ¨¡å¼æ¥è·åä»¤çï¼ä¹åå¯¹ä»¤çè¿è¡è§£æï¼åç°å·²ç»åå«æ©å±çåå®¹ã\n\n\n\n\n# javaä¸­è§£æjwtä¸­çåå®¹\n\næ·»å ä¾èµ\n\n\x3c!--jwt ä¾èµ--\x3e\n<dependency>\n   <groupid>io.jsonwebtoken</groupid>\n   <artifactid>jjwt</artifactid>\n   <version>0.9.0</version>\n</dependency>\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¿®æ¹usercontrollerç±»ï¼ä½¿ç¨jjwtå·¥å·ç±»æ¥è§£æauthorizationå¤´ä¸­å­å¨çjwtåå®¹\n\npackage com.yjxxt.springsecurityoauth2demo.controller;\n\nimport io.jsonwebtoken.jwts;\nimport org.springframework.security.core.authentication;\nimport org.springframework.web.bind.annotation.getmapping;\nimport org.springframework.web.bind.annotation.requestmapping;\nimport org.springframework.web.bind.annotation.restcontroller;\n\nimport javax.servlet.http.httpservletrequest;\nimport java.nio.charset.standardcharsets;\n\n/**\n * @author zhoubin\n * @since 1.0.0\n */\n@restcontroller\n@requestmapping("/user")\npublic class usercontroller {\n\n   @getmapping("/getcurrentuser")\n   public object getcurrentuser(authentication authentication, httpservletrequest request) {\n      string header = request.getheader("authorization");\n      string token = header.substring(header.indexof("bearer") + 7);\n      return jwts.parser()\n            .setsigningkey("test_key".getbytes(standardcharsets.utf_8))\n            .parseclaimsjws(token)\n            .getbody();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nå°ä»¤çæ¾å¥authorizationå¤´ä¸­ï¼è®¿é®å¦ä¸å°åè·åä¿¡æ¯ï¼\n\nhttp://localhost:8080/user/getcurrentuser\n\n\n\n\n# å·æ°ä»¤ç\n\nå¨spring cloud security ä¸­ä½¿ç¨oauth2æ¶ï¼å¦æä»¤çå¤±æäºï¼å¯ä»¥ä½¿ç¨å·æ°ä»¤çéè¿refresh_tokençæææ¨¡å¼åæ¬¡è·åaccess_tokenã\n\nåªéä¿®æ¹è®¤è¯æå¡å¨çéç½®ï¼æ·»å refresh_tokençæææ¨¡å¼å³å¯ã\n\n@override\npublic void configure(clientdetailsserviceconfigurer clients) throws exception {\n    clients.inmemory()\n            //éç½®client_id\n            .withclient("admin")\n            //éç½®client-secret\n            .secret(passwordencoder.encode("112233"))\n            //éç½®è®¿é®tokençæææ\n            .accesstokenvalidityseconds(3600)\n            //éç½®å·æ°tokençæææ\n            .refreshtokenvalidityseconds(86400)\n            //éç½®redirect_uriï¼ç¨äºæææååè·³è½¬\n            .redirecturis("http://www.baidu.com")\n            //éç½®ç³è¯·çæéèå´\n            .scopes("all")\n            //éç½®grant_typeï¼è¡¨ç¤ºææç±»å\n            .authorizedgranttypes("authorization_code","password","refresh_token");\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä½¿ç¨å·æ°ä»¤çæ¨¡å¼æ¥è·åæ°çä»¤çï¼è®¿é®å¦ä¸å°åï¼\n\nhttp://localhost:8080/oauth/token\n\n\n\n\n# spring security oauth2 æ´ååç¹ç»å½ï¼ssoï¼\n\n\n# åå»ºå®¢æ·ç«¯\n\n\n\n\n\n\n# æ·»å ä¾èµ\n\n<?xml version="1.0" encoding="utf-8"?>\n<project xmlns="http://maven.apache.org/pom/4.0.0" xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n         xsi:schemalocation="http://maven.apache.org/pom/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">\n   <modelversion>4.0.0</modelversion>\n   <parent>\n      <groupid>org.springframework.boot</groupid>\n      <artifactid>spring-boot-starter-parent</artifactid>\n      <version>2.2.2.release</version>\n      <relativepath/> \x3c!-- lookup parent from repository --\x3e\n   </parent>\n  \n   <groupid>com.yjxxt</groupid>\n   <artifactid>oauth2client01demo</artifactid>\n   <version>0.0.1-snapshot</version>\n  \n   <name>oauth2client01demo</name>\n   <description>demo project for spring boot</description>\n\n   <properties>\n      <java.version>1.8</java.version>\n      <spring-cloud.version>greenwich.sr2</spring-cloud.version>\n   </properties>\n\n   <dependencies>\n      <dependency>\n         <groupid>org.springframework.cloud</groupid>\n         <artifactid>spring-cloud-starter-oauth2</artifactid>\n      </dependency>\n      <dependency>\n         <groupid>org.springframework.cloud</groupid>\n         <artifactid>spring-cloud-starter-security</artifactid>\n      </dependency>\n      <dependency>\n         <groupid>org.springframework.boot</groupid>\n         <artifactid>spring-boot-starter-web</artifactid>\n      </dependency>\n      <dependency>\n         <groupid>io.jsonwebtoken</groupid>\n         <artifactid>jjwt</artifactid>\n         <version>0.9.0</version>\n      </dependency>\n\n      <dependency>\n         <groupid>org.springframework.boot</groupid>\n         <artifactid>spring-boot-starter-test</artifactid>\n         <scope>test</scope>\n      </dependency>\n   </dependencies>\n\n   <dependencymanagement>\n      <dependencies>\n         <dependency>\n            <groupid>org.springframework.cloud</groupid>\n            <artifactid>spring-cloud-dependencies</artifactid>\n            <version>${spring-cloud.version}</version>\n            <type>pom</type>\n            <scope>import</scope>\n         </dependency>\n      </dependencies>\n   </dependencymanagement>\n\n   <build>\n      <plugins>\n         <plugin>\n            <groupid>org.springframework.boot</groupid>\n            <artifactid>spring-boot-maven-plugin</artifactid>\n         </plugin>\n      </plugins>\n   </build>\n</project>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n\n\n\n# ä¿®æ¹éç½®æä»¶\n\napplication.properties\n\nserver.port=8081\n#é²æ­¢cookieå²çªï¼å²çªä¼å¯¼è´ç»å½éªè¯ä¸éè¿\nserver.servlet.session.cookie.name=oauth2-client-sessionid01\n#æææå¡å¨å°å\noauth2-server-url=http://localhost:8080\n#ä¸æææå¡å¨å¯¹åºçéç½®\nsecurity.oauth2.client.client-id=admin\nsecurity.oauth2.client.client-secret=112233\nsecurity.oauth2.client.user-authorization-uri=${oauth2-server-url}/oauth/authorize\nsecurity.oauth2.client.access-token-uri=${oauth2-server-url}/oauth/token\nsecurity.oauth2.resource.jwt.key-uri=${oauth2-server-url}/oauth/token_key\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# å¨å¯å¨ç±»ä¸æ·»å @enableoauth2ssoæ³¨è§£æ¥å¯ç¨åç¹ç»å½åè½\n\npackage com.yjxxt.oauth2client01demo;\n\nimport org.springframework.boot.springapplication;\nimport org.springframework.boot.autoconfigure.springbootapplication;\nimport org.springframework.boot.autoconfigure.security.oauth2.client.enableoauth2sso;\n\n@springbootapplication\n@enableoauth2sso\npublic class oauth2client01demoapplication {\n\n   public static void main(string[] args) {\n      springapplication.run(oauth2client01demoapplication.class, args);\n   }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# æ·»å æ¥å£ç¨äºè·åå½åç»å½ç¨æ·ä¿¡æ¯\n\npackage com.yjxxt.oauth2client01demo.controller;\n\nimport org.springframework.security.core.authentication;\nimport org.springframework.web.bind.annotation.getmapping;\nimport org.springframework.web.bind.annotation.requestmapping;\nimport org.springframework.web.bind.annotation.restcontroller;\n\n@restcontroller\n@requestmapping("/user")\npublic class usercontroller {\n    \n    @getmapping("/getcurrentuser")\n    public object getcurrentuser(authentication authentication) {\n        return authentication;\n    }\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n# ä¿®æ¹è®¤è¯æå¡å¨éç½®\n\nä¿®æ¹æææå¡å¨ä¸­çauthorizationserverconfigç±»ï¼å°ç»å®çè·³è½¬è·¯å¾ä¸º\n\nhttp://localhost:8081/loginï¼å¹¶æ·»å è·åç§é¥æ¶çèº«ä»½è®¤è¯\n\n@override\npublic void configure(clientdetailsserviceconfigurer clients) throws exception {\n    clients.inmemory()\n            //éç½®client_id\n            .withclient("admin")\n            //éç½®client-secret\n            .secret(passwordencoder.encode("112233"))\n            //éç½®è®¿é®tokençæææ\n            .accesstokenvalidityseconds(3600)\n            //éç½®å·æ°tokençæææ\n            .refreshtokenvalidityseconds(864000)\n            //éç½®redirect_uriï¼ç¨äºæææååè·³è½¬\n            // .redirecturis("http://www.baidu.com")\n            //åç¹ç»å½æ¶éç½®\n            .redirecturis("http://localhost:8081/login")\n            //éç½®ç³è¯·çæéèå´\n            .scopes("all")\n            //èªå¨ææéç½®\n            .autoapprove(true) \n            //éç½®grant_typeï¼è¡¨ç¤ºææç±»å\n            .authorizedgranttypes("authorization_code","password","refresh_token");\n}\n\n@override\npublic void configure(authorizationserversecurityconfigurer security) {\n    // è·åå¯é¥éè¦èº«ä»½è®¤è¯ï¼ä½¿ç¨åç¹ç»å½æ¶å¿é¡»éç½®\n    security.tokenkeyaccess("isauthenticated()");\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n\n\n# æµè¯\n\nå¯å¨æææå¡åå®¢æ·ç«¯æå¡ï¼\n\nè®¿é®å®¢æ·ç«¯éè¦ææçæ¥å£http://localhost:8081/user/getcurrentuser\n\nä¼è·³è½¬å°æææå¡çç»å½çé¢ï¼\n\n\n\nææåä¼è·³è½¬å°åæ¥éè¦æéçæ¥å£å°åï¼å±ç¤ºç»å½ç¨æ·ä¿¡æ¯ï¼\n\n',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ãèå¾ãè¯¥å¦ä½è®¾è®¡ä½ ç PasswordEncoder",frontmatter:{title:"ãèå¾ãè¯¥å¦ä½è®¾è®¡ä½ ç PasswordEncoder",date:"2022-02-03T00:03:27.000Z",permalink:"/pages/9be0a1/",categories:["åç«¯","Spring Security"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/25.Spring%20Security/09.%E3%80%90%E8%80%81%E5%BE%90%E3%80%91%E8%AF%A5%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E4%BD%A0%E7%9A%84%20PasswordEncoder.html",relativePath:"10.æ¡æ¶/25.Spring Security/09.ãèå¾ãè¯¥å¦ä½è®¾è®¡ä½ ç PasswordEncoder.md",key:"v-6c08538d",path:"/pages/9be0a1/",headers:[{level:3,title:"ç¼èµ·",slug:"ç¼èµ·",normalizedTitle:"ç¼èµ·",charIndex:117},{level:3,title:"å¯ç å­å¨æ¼è¿å²",slug:"å¯ç å­å¨æ¼è¿å²",normalizedTitle:"å¯ç å­å¨æ¼è¿å²",charIndex:1321},{level:3,title:"æ¢ hash ç®æ³ççå®å¨åï¼",slug:"æ¢-hash-ç®æ³ççå®å¨å",normalizedTitle:"æ¢ hash ç®æ³ççå®å¨åï¼",charIndex:2910},{level:3,title:"spring security åºå¼çæ¥å£",slug:"spring-security-åºå¼çæ¥å£",normalizedTitle:"spring security åºå¼çæ¥å£",charIndex:3795},{level:3,title:"æ´æ·±å±çæè",slug:"æ´æ·±å±çæè",normalizedTitle:"æ´æ·±å±çæè",charIndex:4307},{level:3,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:6669},{level:3,title:"show me the code",slug:"show-me-the-code",normalizedTitle:"show me the code",charIndex:6751}],headersStr:"ç¼èµ· å¯ç å­å¨æ¼è¿å² æ¢ hash ç®æ³ççå®å¨åï¼ spring security åºå¼çæ¥å£ æ´æ·±å±çæè åè show me the code",content:'æè¦: åååºå¤ https://www.cnkirito.moe/spring-security-6/ ãèå¾ãæ¬¢è¿è½¬è½½ï¼ä¿çæè¦ï¼è°¢è°¢ï¼\n\n----------------------------------------\n\n\n# ç¼èµ·\n\nåç«¯æ¶é´å°ä¸ä¸ªéæäº spring-security-oauth2 çæ§é¡¹ç®æ¹é äºä¸çªï¼å° springboot åçº§æäº springboot 2.0ï¼ä¼æå¨ç¥ springboot 2.0 ä¾èµçæ¯ spring5ï¼å¹¶ä¸è®¸å¤ç¸å³çä¾èµé½åçäºè¾å¤§çæ¹å¨ï¼ä¸æ¬æç¸å³çæ¹å¨ç½åå¦ä¸ï¼æå´è¶£çåå­¦å¯ä»¥ççï¼Spring Security 5.0 New Features ï¼å¢å¼ºäº oauth2 éæçåè½ä»¥ååä¸ä¸ªæ¯è¾æææçæ¹å¨âéæäºå¯ç ç¼ç å¨çå®ç°ï¼Password Encodingï¼ç±äºå¤§å¤æ° PasswordEncoder ç¸å³çç®æ³æ¯ hash ç®æ³ï¼æä»¥æ¬æå° PasswordEncoder ç¿»è¯æâå¯ç ç¼ç å¨âåå¹¶éâå¯ç å å¯å¨âï¼å®æ¹ç§°ä¹ä¸º\n\nModernized Password Encoding â ç°ä»£åçå¯ç ç¼ç æ¹å¼ å¦å¤ï¼springboot2.0 çèªå¨éç½®ä¹åäºä¸äºè°æ´ï¼å¶ä¸­ä¹æå ç¹å spring-security ç¸å³ï¼æ³è¿éçææç»è springboot2.0 è¿ç§»æå\n\nä¸å¼å§ï¼æä»ä»ä¿®æ¹äºä¾èµï¼å°\n\n<parent>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-parent</artifactId>\n    <version>1.5.4.RELEASE</version>\n</parent>\n\n\n1\n2\n3\n4\n5\n\n\nåçº§æäº\n\n<parent>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-parent</artifactId>\n    <version>2.0.1.RELEASE</version>\n</parent>\n\n\n1\n2\n3\n4\n5\n\n\nä¸åºææåºç°äºå¼å®¹æ§çé®é¢ï¼æå¨å°è¯ç»å½æ¶ï¼åºç°äºå¦ä¸çæ¥é\n\njava.lang.IllegalArgumentException: There is no PasswordEncoder mapped for the id "null"\n\n\n1\n\n\nåå ä¹å¾ææ¾ï¼æ­£å¦ spring security çæ´æ°ææ¡£ä¸­æè¿°çé£æ ·ï¼spring security 5 å¯¹ PasswordEncoder åäºç¸å³çéæï¼ååé»è®¤éç½®ç PlainTextPasswordEncoderï¼ææå¯ç ï¼è¢«ç§»é¤äºãè¿å¼èµ·äºæçå´è¶£ï¼spring security å¨æ°çæ¬ä¸­å¯¹äº passwordEncoder è¿è¡äºåªäºæ¹é ï¼è¿äºæ¹é èååæ¯åºäºä»ä¹æ ·çç®çå¢ï¼åä¸ªå³å­ï¼åä»è¿å¤æ¶æçæ¡ä¾æ¥ä¸æ­¥æ­¥æ¼ååºæè°çâç°ä»£åå¯ç ç¼ç æ¹å¼âã\n\n\n# å¯ç å­å¨æ¼è¿å²\n\nèªä»äºèç½æäºç¨æ·çé£ä¸å»èµ·ï¼å­å¨ç¨æ·å¯ç è¿ä»¶äºä¾¿æä¸ºäºä¸ä¸ªå¥å¨çç³»ç»ä¸å¾ä¸é¢å¯¹çä¸ä»¶äºãè¿å¤æ¶æï¼ææå­å¨å¯ç å¯è½è¿ä¸è¢«è®¤ä¸ºæ¯ä¸ä¸ªå¾å¤§çç³»ç»ç¼ºé·ï¼äºå®ä¸è¿æ¯ä¸ä»¶å¾ææçäºï¼ãæåææå­å¨å¯ç ï¼æç«å»èæ³å°çæ¯ CSDN ç¤¾åºå¨ 2011 å¹´æ«åçç 600 ä¸ç¨æ·å¯ç æ³é²çäºä»¶ï¼è°ä¹ä¸ä¼æ³å°è¿ä¸ªåç¨åºåå¯åç¸å³çç½ç«ä¼ç¯å¦æ­¤ä½çº§çéè¯¯ãææå­å¨å¯ç ä½¿å¾æ¶æç¨æ·å¯ä»¥éè¿ sql æ³¨å¥ç­æ»å»æ¹å¼æ¥è·åç¨æ·ååå¯ç ï¼è½ç¶å®å¨æ¡æ¶åè¯å¥½çç¼ç è§èå¯ä»¥è§é¿å¾å¤ç±»ä¼¼çæ»å»ï¼ä½ä¾æ§é¿åä¸äºç³»ç»ç®¡çåï¼DBA æéå¾è·åç¨æ·å¯ç è¿ä¸äºå®ãäºå®ä¸ï¼ä¸ç¨ææå­å¨å­å¨å¯ç ï¼ç¨åºåä»¬æ©å¨ n å¤å¹´åå°±å·²ç»è¾¾æäºå±è¯ã\n\nä¸è½ææå­å¨ï¼ä¸äº hash ç®æ³ä¾¿è¢«å¹¿æ³ç¨åå¯ç çç¼ç å¨ï¼å¯¹å¯ç è¿è¡åå hash å¤çåå­å¨æ°æ®åºï¼å½ç¨æ·ç»å½æ¶ï¼è®¡ç®ç¨æ·è¾å¥çå¯ç ç hash å¼ï¼å°ä¸¤èè¿è¡æ¯å¯¹ãåå hash ç®æ³ï¼é¡¾åæä¹ï¼å®æ æ³ï¼æèç¨ä¸è½è½»ææ´ä¸ºåéï¼è¢«ååè§£æè¿ååºåå¯ç ãè¿æç»äºç®¡çåç´æ¥è·åå¯ç çéå¾ï¼å¯ä»ä»ä¾èµäºæ®éç hash ç®æ³ï¼å¦ md5ï¼sha256ï¼æ¯ä¸åéçï¼ä»ä¸»è¦æ 3 ä¸ªç¹ç¹ï¼\n\n 1. åä¸å¯ç çæç hash å¼ä¸å®ç¸å\n 2. ä¸åå¯ç ççæç hash å¼å¯è½ç¸åï¼md5 çç¢°æé®é¢ç¸æ¯ sha256 è¿è¦ä¸¥éï¼\n 3. è®¡ç®éåº¦å¿«ã\n\nä»¥ä¸ä¸ç¹ç»åå¨ä¸èµ·ï¼ç ´è§£æ­¤ç±»ç®æ³æäºä¸æ¯é£ä¹å°é¾çä¸ä»¶äºï¼å°¤å¶æ¯ç¬¬ä¸ç¹ï¼ä¼å¨ä¸æä¸­åæ¬¡æå°ï¼å¤å¿«æç®éå¸¸å¿«ï¼æç§ç¸å³èµæçè¯´æ³ï¼\n\n> modern hardware perform billions of hash calculations a second.\n\nèèå°å¤§å¤æ°ç¨æ·ä½¿ç¨çå¯ç å¤ä¸ºæ°å­+å­æ¯+ç¹æ®ç¬¦å·çç»åï¼æ»å»èå°å¸¸ç¨çå¯ç è¿è¡æä¸¾ï¼çè³éè¿æåç»åæ¥æ´åç ´è§£ï¼è¿è¢«ç§°ä¸º rainbow tableãç®æ³ç±å¥½èè½å¤ç«å»çæå°ä¸è¿°çæ¹æ¡ï¼è¿è¢«äº²åå°ç§°ä¹ä¸ºâæè¡¨ï¼ä¸ç§æ´åç¾å­¦ï¼è¿å¼ è¡¨æ¯å¯ä»¥è¢«å¤ç¨çã\n\nè½ç¶ä»ä»ä¾èµäºä¼ ç» hash ç®æ³çæè·¯è¢«å¦å³äºï¼ä½è¿ç§ hash åæ¯å¯¹çæè·¯ï¼å ä¹è¢«åç»­ææçä¼åæ¹æ¡ç»§æ¿ã\n\nhash æ¹æ¡è¿æ¥çç¬¬ä¸ä¸ªæ¹é æ¯å¯¹å¼å¥ä¸ä¸ªâéæºçå å­âæ¥æºæè¿ææä¸­è¿è¡ hash è®¡ç®ï¼è¿æ ·çéæºå å­éå¸¸è¢«ç§°ä¹ä¸ºç ï¼saltï¼ãsalt ä¸è¬æ¯ç¨æ·ç¸å³çï¼æ¯ä¸ªç¨æ·ææåèªç saltãæ­¤æ¶çèåäºä¸«çå¯ç å³ä½¿ç¸åï¼ç±äº salt çå½±åï¼å­å¨å¨æ°æ®åºä¸­çå¯ç ä¹æ¯ä¸åçï¼é¤éâ¦ä¸ºæ¯ä¸ªç¨æ·åç¬å»ºè®®ä¸å¼  rainbow tableãå¾ææ¾ salted hash ç¸æ¯æ®éçåå hash æ¹æ¡å å¤§äº hacker æ»å»çé¾åº¦ãä½äºè§£è¿ GPU å¹¶è¡è®¡ç®è½åä¹å¼ºå¤§çç«¥éï¼é½è½å¤æè¯å°ï¼è½ç¶ç ´è§£ salted hash æ¯è¾éº»ç¦ï¼å´å¹¶éä¸å¯è¡ï¼å¤å³åæ¢çå®å¨ä¸å®¶ä¼¼ä¹ä¹å¯¹è¿ä¸ªæ¹æ¡ä¸å¤æ»¡æã\n\nä¸ºè§£å³ä¸è¿° salted hash ä»ç¶å­å¨çé®é¢ï¼ä¸äºæ°åçåå hash ç®æ³è¢«ç ç©¶äºåºæ¥ãå¶ä¸­å°±åæ¬ï¼Bcryptï¼PBKDF2ï¼Scryptï¼Argon2ãä¸ºä»ä¹è¿äº hash ç®æ³è½ä¿è¯å¯ç å­å¨çå®å¨æ§ï¼å ä¸ºä»ä»¬è¶³å¤æ¢ï¼æ°å°å¥½å¤çæ¢ãè¿ä¹è¯´ä¸ä¸¥è°¨ï¼åªæ¯ä¸ºäºç»å¤§å®¶çä¸ªæ·±å»çæ åï¼æ¢ãè¿ç±»ç®æ³æä¸ä¸ªç¹ç¹ï¼å­å¨ä¸ä¸ªå½±åå å­ï¼å¯ä»¥ç¨æ¥æ§å¶è®¡ç®å¼ºåº¦ï¼è¿ç´æ¥å³å®äºç ´è§£å¯ç æéè¦çèµæºåæ¶é´ï¼ç´è§çä½ä¼å¯ä»¥è§ä¸å¾ï¼å¨ä¸å¹´åç ´è§£å¦ä¸ç®æ³æéè¦çç¡¬ä»¶èµæºè±è´¹ï¼æç®æç¾åï¼\n\nä¸å¹´åç ´è§£å¦ä¸ç®æ³æéè¦çç¡¬ä»¶èµæºè±è´¹\n\nè¿ä½¿å¾ç ´è§£æäºä¸ä»¶æå¶å°é¾çäºï¼å¹¶ä¸ï¼å¶ä¸­çè®¡ç®å¼ºåº¦å å­æ¯å¯æ§çï¼è¿æ ·ï¼å³ä½¿æªæ¥éå­è®¡ç®æºçè®¡ç®è½åçè¡¨ï¼ä¹å¯ä»¥éè¿å¶æ§å¶è®¡ç®å¼ºåº¦ä»¥é²ç ´è§£ãæ³¨æï¼æ®éçéªè¯è¿ç¨åªéè¦è®¡ç®ä¸æ¬¡ hash è®¡ç®ï¼ä½¿ç¨æ­¤ç±» hash ç®æ³å¹¶ä¸ä¼å½±åå°ç¨æ·ä½éªã\n\n\n# æ¢ hash ç®æ³ççå®å¨åï¼\n\nBcryptï¼Scryptï¼PBKDF2 è¿äºæ¢ hash ç®æ³æ¯ç®åæä¸ºæ¨å´ç password encoding æ¹å¼ï¼å¥½å¥å¿é©±ä½¿ææèäºè¿æ ·ä¸ä¸ªé®é¢ï¼æ¢ hash ç®æ³ççå®å¨åï¼\n\næææ¶è¿æ²¡æç²¾åä»ç»å»ç ç©¶ä»ä»¬ä¸­æ¯ä¸ä¸ªç®æ³çå·ä½å®ç°ï¼åªè½éè¿ä¸äºæç« æ¥æ¾äººçæ§ï¼ç®åççè¿å ä¸ªç®æ³çåçåå®å¨æ§ã\n\nPBKDF2 è¢«è®¾è®¡çå¾ç®åï¼å®çåºæ¬åçæ¯éè¿ä¸ä¸ªä¼ªéæºå½æ°ï¼ä¾å¦ HMAC å½æ°ï¼ï¼æææåä¸ä¸ªçå¼ä½ä¸ºè¾å¥åæ°ï¼ç¶åæç§è®¾ç½®çè®¡ç®å¼ºåº¦å å­éå¤è¿è¡è¿ç®ï¼å¹¶æç»äº§çå¯é¥ãè¿æ ·çéå¤ hash å·²ç»è¢«è®¤ä¸ºè¶³å¤å®å¨ï¼ä½ä¹æäººæåºäºä¸åæè§ï¼æ­¤ç±»ç®æ³å¯¹äºä¼ ç»ç CPU æ¥è¯´çç¡®æ¯è¶³å¤å®å¨ï¼ä½ GPU è¢«æ¬äºåºæ¥ï¼åææå°è¿ GPU çå¹¶è¡è®¡ç®è½åéå¸¸å¼ºå¤§ã\n\nBcrypt å¼ºå¤§çä¸ç¹å¨äºï¼å¶ä¸ä»ä»æ¯ CPU å¯éåï¼è¿æ¯ RAM å¯éåï¼åéçéå¶å ç´ ï¼å¯¼è´ GPUï¼ASICï¼ä¸ç¨éæçµè·¯ï¼æ æ³åºå¯¹ Bcrypt å¸¦æ¥çç ´è§£å°å¢ã\n\nç¶åâ¦çäº Scrypt çç¸å³èµæä¹åæææè¯å°è¿ä¸ªåæå¤æ·±ãä¸ä¸ªçæåéççè¯åºç°å¨äºæé¢åï¼FPGAï¼ç°åºå¯ç¼ç¨é»è¾é¨éµåï¼ï¼è¿è´§å°±æ¯è¾åå®³äºãç°æçè¯çæä»¤ç»æå¦ä¼ ç»ç CPUï¼GPUï¼ASIC é½æ æ³ç ´è§£ Bcryptï¼ä½æ¯ FPGA æ¯æç§å½é»è¾é¨ï¼å¦ANDãORãXORãNOTï¼ï¼éè¿ç¼ç¨çæ¹å¼ç§å½æä»¤éçè¿ä¸ç¹æ§ä½¿å¾å¯ä»¥å®å¶ç¡¬ä»¶æ¥ç ´è§£ Bcryptãå°½ç®¡æä¸è®¤ä¸ºæè¿ä¸ªææ¯çäººä¼å»æ³åæ³ç ´è§£çæ­£çç³»ç»ï¼ä½ï¼åªè¦è¿æ¯ä¸ä¸ªå¯è½æ§ï¼å°±æ»ææ¹æ³ä¼è¢«åæåºæ¥ä¸ä¹å¯¹æãScrypt æ¯ Bcrypt é¢å¤èèå°çå°±æ¯å¤§è§æ¨¡çèªå®ä¹ç¡¬ä»¶æ»å» ï¼ä»èå»æè®¾è®¡éè¦å¤§éåå­è¿ç®ã\n\nçè®ºç»å½æ¯çè®ºï¼å®éä¸ Bcrypt ç®æ³è¢«åæè³ä» 18 å¹´ï¼ä½¿ç¨èå´å¹¿ï¼ä¸ä»æªå ä¸ºå®å¨é®é¢èè¢«ä¿®æ¹ï¼å¶æéæ§æ¯å·²ç»è¢«éªè¯è¿çï¼ç¸æ¯ä¹ä¸ Scrypt æ®æçå°çæç« æ¾ç¤ºæ¯ 9 å¹´çåå²ï¼æ²¡æ Bcrypt ä½¿ç¨çå¹¿æ³ãä»ç ´è§£ææ¬åæå¨æ§çè§åº¦æ¥çï¼Bcrypt ç¨ä½å¯ç ç¼ç å¨æ¯ä¸éçéæ©ã\n\n\n# spring security åºå¼çæ¥å£\n\nåå°ææ¡£ä¸­ï¼spring security 5 å¯¹ PasswordEncoder åäºç¸å³çéæï¼ååé»è®¤éç½®ç PlainTextPasswordEncoderï¼ææå¯ç ï¼è¢«ç§»é¤äºï¼æ³è¦åå°ææå­å¨å¯ç ï¼åªè½ä½¿ç¨ä¸ä¸ªè¿æçç±»æ¥è¿æ¸¡\n\n@Bean\nPasswordEncoder passwordEncoder(){\n    return NoOpPasswordEncoder.getInstance();\n}\n\n\n1\n2\n3\n4\n\n\nå®éä¸ï¼spring security æä¾äº BCryptPasswordEncoder æ¥è¿è¡å¯ç ç¼ç ï¼å¹¶ä½ä¸ºäºç¸å³éç½®çé»è®¤éç½®ï¼åªä¸è¿æ²¡ææ´é²ä¸ºå¨å±ç Beanãä½¿ç¨ææå­å¨çé£é©å¨æç« ä¸å¼å§å°±å·²ç»å¼ºè°è¿ï¼NoOpPasswordEncoder åªè½å­å¨äº demo ä¸­ã\n\n@Bean\nPasswordEncoder passwordEncoder(){\n    return new BCryptPasswordEncoder();\n}\n\n\n1\n2\n3\n4\n\n\nå«å¿äºå¯¹ä½ æ°æ®åºä¸­çå¯ç è¿è¡åæ ·çç¼ç ï¼å¦åæ æ³å¯¹åºã\n\n\n# æ´æ·±å±çæè\n\nå®éä¸ï¼spring security 5 çå¦ä¸ä¸ªè®¾è®¡æ¯ä¿ä½¿æåææ¬æçåè¡·ã\n\nä¸ç¥éææ²¡æè¯»èäº§çè·æç¸åçå°æ°ï¼\n\n 1. å¦ææè¦è®¾è®¡ä¸ä¸ª QPS å¾é«çç»å½ç³»ç»ï¼ä½¿ç¨ spring security æ¨èç BCrypt ä¼ä¸ä¼å­å¨æ§è½é®é¢ï¼\n 2. spring security æä¹è¿ä¹åï¼åæ¥çå¯ç ç¼ç å¨é½ç»æ¹äºï¼æéè¦æä¹è¿ç§»æ§å¯ç ç¼ç çåºç¨ç¨åºï¼\n 3. ä¸ä¸ä»¥ååºäºæ´é«æçå å¯ç®æ³ï¼è¿ç§ç¬¨éçç¡¬ç¼ç æ¹å¼éç½®å¯ç ç¼ç å¨æ¯ä¸æ¯ä¸å¤çµæ´»ï¼\n\nå¨ spring security 5 æä¾äºè¿æ ·ä¸ä¸ªæè·¯ï¼åºè¯¥å°å¯ç ç¼ç ä¹åç hash å¼åå å¯æ¹å¼ä¸èµ·å­å¨ï¼å¹¶æä¾äºä¸ä¸ª DelegatingPasswordEncoder æ¥ä½ä¸ºä¼å¤å¯ç å¯ç ç¼ç æ¹å¼çéåã\n\n@Bean\nPasswordEncoder passwordEncoder(){\n    return PasswordEncoderFactories.createDelegatingPasswordEncoder();\n}\n\n\n1\n2\n3\n4\n\n\nè´è´£çäº§ DelegatingPasswordEncoder çå·¥åæ¹æ³ï¼\n\npublic class PasswordEncoderFactories {\n\n   public static PasswordEncoder createDelegatingPasswordEncoder() {\n      String encodingId = "bcrypt";\n      Map<String, PasswordEncoder> encoders = new HashMap<>();\n      encoders.put(encodingId, new BCryptPasswordEncoder());\n      encoders.put("ldap", new LdapShaPasswordEncoder());\n      encoders.put("MD4", new Md4PasswordEncoder());\n      encoders.put("MD5", new MessageDigestPasswordEncoder("MD5"));\n      encoders.put("noop", NoOpPasswordEncoder.getInstance());\n      encoders.put("pbkdf2", new Pbkdf2PasswordEncoder());\n      encoders.put("scrypt", new SCryptPasswordEncoder());\n      encoders.put("SHA-1", new MessageDigestPasswordEncoder("SHA-1"));\n      encoders.put("SHA-256", new MessageDigestPasswordEncoder("SHA-256"));\n      encoders.put("sha256", new StandardPasswordEncoder());\n\n      return new DelegatingPasswordEncoder(encodingId, encoders);\n   }\n\n   private PasswordEncoderFactories() {}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nå¦æ­¤æ³¨å¥ PasswordEncoder ä¹åï¼æä»¬å¨æ°æ®åºä¸­éè¦è¿ä¹å­å¨æ°æ®ï¼\n\n{bcrypt}$2a$10$dXJ3SW6G7P50lGmMkkmwe.20cQQubK3.HZWzG3YB1tlRy.fqvM/BG\n{noop}password\n{pbkdf2}5d923b44a6d129f3ddf3e3c8d29412723dcbde72445e8ef6bf3b508fbf17fa4ed4d6b99ca763d8dc\n{scrypt}$e0801$8bWJaSu2IKSn9Z9kM+TPXfOc/9bdYSrN1oD9qfVThWEwdRTnO7re7Ei+fUZRJ68k9lTyuTeUp4of4g24hHnazw==$OAOec05+bXxvuu/1qZ6NUR+xQYvYv7BeL1QxwRpY5Pc=\n{sha256}97cde38028ad898ebc02e690819fa220e88c62e0699403e94fff291cfffaf8410849f27605abcbc0\n\n\n1\n2\n3\n4\n5\n\n\nè¿è®°å¾æç« å¼å§çæ¥éåï¼\n\njava.lang.IllegalArgumentException: There is no PasswordEncoder mapped for the id "null"\n\n\n1\n\n\nè¿ä¸ª id å°±æ¯å ä¸ºæä»¬æ²¡æä¸ºæ°æ®åºä¸­çå¯ç æ·»å  {bcrypt} æ­¤ç±»çåç¼å¯¼è´çã\n\n> ä½ ä¼ä¸ä¼æå¿å¯ç æ³é²åï¼{bcrypt}ï¼{pbkdf2}ï¼{scrypt}ï¼{sha256} æ­¤ç±»åç¼ä¼ç´æ¥æ´é²å¯ç çç¼ç æ¹å¼ï¼å¶å®è¿ä¸ªèèæ¯å¤ä½çï¼å ä¸ºå¯ç å­å¨çä¾èµç®æ³å¹¶ä¸æ¯ä¸ä¸ªç§å¯ãå¤§å¤æ°è½æå°ä½ å¯ç ç hacker é½å¯ä»¥è½»æ¾çç¥éä½ ç¨çæ¯ä»ä¹ç®æ³ï¼ä¾å¦ï¼bcrypt ç®æ³éå¸¸ä»¥ $2a$ å¼å¤´\n\nç¨å¾®æèä¸ï¼åé¢çä¸ä¸ªçé®å°±å¯ä»¥è¿åèè§£ï¼è¿å°±æ¯ææ¡£ä¸­æè°çï¼è½å¤èªéåºæå¡å¨æ§è½çç°ä»£åå¯ç ç¼ç æ¹æ¡ã\n\n\n# åè\n\nPassword Hashing: PBKDF2, Scrypt, Bcrypt\n\ncore-services-password-encoding\n\n\n# show me the code\n\nspring security oauth2 ç github ä»£ç ç¤ºä¾ï¼ä½ä¼ä¸ spring security 4 -> spring security 5 çç¸å³ååã\n\nhttps://github.com/lexburner/oauth2-demo',normalizedContent:'æè¦: åååºå¤ https://www.cnkirito.moe/spring-security-6/ ãèå¾ãæ¬¢è¿è½¬è½½ï¼ä¿çæè¦ï¼è°¢è°¢ï¼\n\n----------------------------------------\n\n\n# ç¼èµ·\n\nåç«¯æ¶é´å°ä¸ä¸ªéæäº spring-security-oauth2 çæ§é¡¹ç®æ¹é äºä¸çªï¼å° springboot åçº§æäº springboot 2.0ï¼ä¼æå¨ç¥ springboot 2.0 ä¾èµçæ¯ spring5ï¼å¹¶ä¸è®¸å¤ç¸å³çä¾èµé½åçäºè¾å¤§çæ¹å¨ï¼ä¸æ¬æç¸å³çæ¹å¨ç½åå¦ä¸ï¼æå´è¶£çåå­¦å¯ä»¥ççï¼spring security 5.0 new features ï¼å¢å¼ºäº oauth2 éæçåè½ä»¥ååä¸ä¸ªæ¯è¾æææçæ¹å¨âéæäºå¯ç ç¼ç å¨çå®ç°ï¼password encodingï¼ç±äºå¤§å¤æ° passwordencoder ç¸å³çç®æ³æ¯ hash ç®æ³ï¼æä»¥æ¬æå° passwordencoder ç¿»è¯æâå¯ç ç¼ç å¨âåå¹¶éâå¯ç å å¯å¨âï¼å®æ¹ç§°ä¹ä¸º\n\nmodernized password encoding â ç°ä»£åçå¯ç ç¼ç æ¹å¼ å¦å¤ï¼springboot2.0 çèªå¨éç½®ä¹åäºä¸äºè°æ´ï¼å¶ä¸­ä¹æå ç¹å spring-security ç¸å³ï¼æ³è¿éçææç»è springboot2.0 è¿ç§»æå\n\nä¸å¼å§ï¼æä»ä»ä¿®æ¹äºä¾èµï¼å°\n\n<parent>\n    <groupid>org.springframework.boot</groupid>\n    <artifactid>spring-boot-starter-parent</artifactid>\n    <version>1.5.4.release</version>\n</parent>\n\n\n1\n2\n3\n4\n5\n\n\nåçº§æäº\n\n<parent>\n    <groupid>org.springframework.boot</groupid>\n    <artifactid>spring-boot-starter-parent</artifactid>\n    <version>2.0.1.release</version>\n</parent>\n\n\n1\n2\n3\n4\n5\n\n\nä¸åºææåºç°äºå¼å®¹æ§çé®é¢ï¼æå¨å°è¯ç»å½æ¶ï¼åºç°äºå¦ä¸çæ¥é\n\njava.lang.illegalargumentexception: there is no passwordencoder mapped for the id "null"\n\n\n1\n\n\nåå ä¹å¾ææ¾ï¼æ­£å¦ spring security çæ´æ°ææ¡£ä¸­æè¿°çé£æ ·ï¼spring security 5 å¯¹ passwordencoder åäºç¸å³çéæï¼ååé»è®¤éç½®ç plaintextpasswordencoderï¼ææå¯ç ï¼è¢«ç§»é¤äºãè¿å¼èµ·äºæçå´è¶£ï¼spring security å¨æ°çæ¬ä¸­å¯¹äº passwordencoder è¿è¡äºåªäºæ¹é ï¼è¿äºæ¹é èååæ¯åºäºä»ä¹æ ·çç®çå¢ï¼åä¸ªå³å­ï¼åä»è¿å¤æ¶æçæ¡ä¾æ¥ä¸æ­¥æ­¥æ¼ååºæè°çâç°ä»£åå¯ç ç¼ç æ¹å¼âã\n\n\n# å¯ç å­å¨æ¼è¿å²\n\nèªä»äºèç½æäºç¨æ·çé£ä¸å»èµ·ï¼å­å¨ç¨æ·å¯ç è¿ä»¶äºä¾¿æä¸ºäºä¸ä¸ªå¥å¨çç³»ç»ä¸å¾ä¸é¢å¯¹çä¸ä»¶äºãè¿å¤æ¶æï¼ææå­å¨å¯ç å¯è½è¿ä¸è¢«è®¤ä¸ºæ¯ä¸ä¸ªå¾å¤§çç³»ç»ç¼ºé·ï¼äºå®ä¸è¿æ¯ä¸ä»¶å¾ææçäºï¼ãæåææå­å¨å¯ç ï¼æç«å»èæ³å°çæ¯ csdn ç¤¾åºå¨ 2011 å¹´æ«åçç 600 ä¸ç¨æ·å¯ç æ³é²çäºä»¶ï¼è°ä¹ä¸ä¼æ³å°è¿ä¸ªåç¨åºåå¯åç¸å³çç½ç«ä¼ç¯å¦æ­¤ä½çº§çéè¯¯ãææå­å¨å¯ç ä½¿å¾æ¶æç¨æ·å¯ä»¥éè¿ sql æ³¨å¥ç­æ»å»æ¹å¼æ¥è·åç¨æ·ååå¯ç ï¼è½ç¶å®å¨æ¡æ¶åè¯å¥½çç¼ç è§èå¯ä»¥è§é¿å¾å¤ç±»ä¼¼çæ»å»ï¼ä½ä¾æ§é¿åä¸äºç³»ç»ç®¡çåï¼dba æéå¾è·åç¨æ·å¯ç è¿ä¸äºå®ãäºå®ä¸ï¼ä¸ç¨ææå­å¨å­å¨å¯ç ï¼ç¨åºåä»¬æ©å¨ n å¤å¹´åå°±å·²ç»è¾¾æäºå±è¯ã\n\nä¸è½ææå­å¨ï¼ä¸äº hash ç®æ³ä¾¿è¢«å¹¿æ³ç¨åå¯ç çç¼ç å¨ï¼å¯¹å¯ç è¿è¡åå hash å¤çåå­å¨æ°æ®åºï¼å½ç¨æ·ç»å½æ¶ï¼è®¡ç®ç¨æ·è¾å¥çå¯ç ç hash å¼ï¼å°ä¸¤èè¿è¡æ¯å¯¹ãåå hash ç®æ³ï¼é¡¾åæä¹ï¼å®æ æ³ï¼æèç¨ä¸è½è½»ææ´ä¸ºåéï¼è¢«ååè§£æè¿ååºåå¯ç ãè¿æç»äºç®¡çåç´æ¥è·åå¯ç çéå¾ï¼å¯ä»ä»ä¾èµäºæ®éç hash ç®æ³ï¼å¦ md5ï¼sha256ï¼æ¯ä¸åéçï¼ä»ä¸»è¦æ 3 ä¸ªç¹ç¹ï¼\n\n 1. åä¸å¯ç çæç hash å¼ä¸å®ç¸å\n 2. ä¸åå¯ç ççæç hash å¼å¯è½ç¸åï¼md5 çç¢°æé®é¢ç¸æ¯ sha256 è¿è¦ä¸¥éï¼\n 3. è®¡ç®éåº¦å¿«ã\n\nä»¥ä¸ä¸ç¹ç»åå¨ä¸èµ·ï¼ç ´è§£æ­¤ç±»ç®æ³æäºä¸æ¯é£ä¹å°é¾çä¸ä»¶äºï¼å°¤å¶æ¯ç¬¬ä¸ç¹ï¼ä¼å¨ä¸æä¸­åæ¬¡æå°ï¼å¤å¿«æç®éå¸¸å¿«ï¼æç§ç¸å³èµæçè¯´æ³ï¼\n\n> modern hardware perform billions of hash calculations a second.\n\nèèå°å¤§å¤æ°ç¨æ·ä½¿ç¨çå¯ç å¤ä¸ºæ°å­+å­æ¯+ç¹æ®ç¬¦å·çç»åï¼æ»å»èå°å¸¸ç¨çå¯ç è¿è¡æä¸¾ï¼çè³éè¿æåç»åæ¥æ´åç ´è§£ï¼è¿è¢«ç§°ä¸º rainbow tableãç®æ³ç±å¥½èè½å¤ç«å»çæå°ä¸è¿°çæ¹æ¡ï¼è¿è¢«äº²åå°ç§°ä¹ä¸ºâæè¡¨ï¼ä¸ç§æ´åç¾å­¦ï¼è¿å¼ è¡¨æ¯å¯ä»¥è¢«å¤ç¨çã\n\nè½ç¶ä»ä»ä¾èµäºä¼ ç» hash ç®æ³çæè·¯è¢«å¦å³äºï¼ä½è¿ç§ hash åæ¯å¯¹çæè·¯ï¼å ä¹è¢«åç»­ææçä¼åæ¹æ¡ç»§æ¿ã\n\nhash æ¹æ¡è¿æ¥çç¬¬ä¸ä¸ªæ¹é æ¯å¯¹å¼å¥ä¸ä¸ªâéæºçå å­âæ¥æºæè¿ææä¸­è¿è¡ hash è®¡ç®ï¼è¿æ ·çéæºå å­éå¸¸è¢«ç§°ä¹ä¸ºç ï¼saltï¼ãsalt ä¸è¬æ¯ç¨æ·ç¸å³çï¼æ¯ä¸ªç¨æ·ææåèªç saltãæ­¤æ¶çèåäºä¸«çå¯ç å³ä½¿ç¸åï¼ç±äº salt çå½±åï¼å­å¨å¨æ°æ®åºä¸­çå¯ç ä¹æ¯ä¸åçï¼é¤éâ¦ä¸ºæ¯ä¸ªç¨æ·åç¬å»ºè®®ä¸å¼  rainbow tableãå¾ææ¾ salted hash ç¸æ¯æ®éçåå hash æ¹æ¡å å¤§äº hacker æ»å»çé¾åº¦ãä½äºè§£è¿ gpu å¹¶è¡è®¡ç®è½åä¹å¼ºå¤§çç«¥éï¼é½è½å¤æè¯å°ï¼è½ç¶ç ´è§£ salted hash æ¯è¾éº»ç¦ï¼å´å¹¶éä¸å¯è¡ï¼å¤å³åæ¢çå®å¨ä¸å®¶ä¼¼ä¹ä¹å¯¹è¿ä¸ªæ¹æ¡ä¸å¤æ»¡æã\n\nä¸ºè§£å³ä¸è¿° salted hash ä»ç¶å­å¨çé®é¢ï¼ä¸äºæ°åçåå hash ç®æ³è¢«ç ç©¶äºåºæ¥ãå¶ä¸­å°±åæ¬ï¼bcryptï¼pbkdf2ï¼scryptï¼argon2ãä¸ºä»ä¹è¿äº hash ç®æ³è½ä¿è¯å¯ç å­å¨çå®å¨æ§ï¼å ä¸ºä»ä»¬è¶³å¤æ¢ï¼æ°å°å¥½å¤çæ¢ãè¿ä¹è¯´ä¸ä¸¥è°¨ï¼åªæ¯ä¸ºäºç»å¤§å®¶çä¸ªæ·±å»çæ åï¼æ¢ãè¿ç±»ç®æ³æä¸ä¸ªç¹ç¹ï¼å­å¨ä¸ä¸ªå½±åå å­ï¼å¯ä»¥ç¨æ¥æ§å¶è®¡ç®å¼ºåº¦ï¼è¿ç´æ¥å³å®äºç ´è§£å¯ç æéè¦çèµæºåæ¶é´ï¼ç´è§çä½ä¼å¯ä»¥è§ä¸å¾ï¼å¨ä¸å¹´åç ´è§£å¦ä¸ç®æ³æéè¦çç¡¬ä»¶èµæºè±è´¹ï¼æç®æç¾åï¼\n\nä¸å¹´åç ´è§£å¦ä¸ç®æ³æéè¦çç¡¬ä»¶èµæºè±è´¹\n\nè¿ä½¿å¾ç ´è§£æäºä¸ä»¶æå¶å°é¾çäºï¼å¹¶ä¸ï¼å¶ä¸­çè®¡ç®å¼ºåº¦å å­æ¯å¯æ§çï¼è¿æ ·ï¼å³ä½¿æªæ¥éå­è®¡ç®æºçè®¡ç®è½åçè¡¨ï¼ä¹å¯ä»¥éè¿å¶æ§å¶è®¡ç®å¼ºåº¦ä»¥é²ç ´è§£ãæ³¨æï¼æ®éçéªè¯è¿ç¨åªéè¦è®¡ç®ä¸æ¬¡ hash è®¡ç®ï¼ä½¿ç¨æ­¤ç±» hash ç®æ³å¹¶ä¸ä¼å½±åå°ç¨æ·ä½éªã\n\n\n# æ¢ hash ç®æ³ççå®å¨åï¼\n\nbcryptï¼scryptï¼pbkdf2 è¿äºæ¢ hash ç®æ³æ¯ç®åæä¸ºæ¨å´ç password encoding æ¹å¼ï¼å¥½å¥å¿é©±ä½¿ææèäºè¿æ ·ä¸ä¸ªé®é¢ï¼æ¢ hash ç®æ³ççå®å¨åï¼\n\næææ¶è¿æ²¡æç²¾åä»ç»å»ç ç©¶ä»ä»¬ä¸­æ¯ä¸ä¸ªç®æ³çå·ä½å®ç°ï¼åªè½éè¿ä¸äºæç« æ¥æ¾äººçæ§ï¼ç®åççè¿å ä¸ªç®æ³çåçåå®å¨æ§ã\n\npbkdf2 è¢«è®¾è®¡çå¾ç®åï¼å®çåºæ¬åçæ¯éè¿ä¸ä¸ªä¼ªéæºå½æ°ï¼ä¾å¦ hmac å½æ°ï¼ï¼æææåä¸ä¸ªçå¼ä½ä¸ºè¾å¥åæ°ï¼ç¶åæç§è®¾ç½®çè®¡ç®å¼ºåº¦å å­éå¤è¿è¡è¿ç®ï¼å¹¶æç»äº§çå¯é¥ãè¿æ ·çéå¤ hash å·²ç»è¢«è®¤ä¸ºè¶³å¤å®å¨ï¼ä½ä¹æäººæåºäºä¸åæè§ï¼æ­¤ç±»ç®æ³å¯¹äºä¼ ç»ç cpu æ¥è¯´çç¡®æ¯è¶³å¤å®å¨ï¼ä½ gpu è¢«æ¬äºåºæ¥ï¼åææå°è¿ gpu çå¹¶è¡è®¡ç®è½åéå¸¸å¼ºå¤§ã\n\nbcrypt å¼ºå¤§çä¸ç¹å¨äºï¼å¶ä¸ä»ä»æ¯ cpu å¯éåï¼è¿æ¯ ram å¯éåï¼åéçéå¶å ç´ ï¼å¯¼è´ gpuï¼asicï¼ä¸ç¨éæçµè·¯ï¼æ æ³åºå¯¹ bcrypt å¸¦æ¥çç ´è§£å°å¢ã\n\nç¶åâ¦çäº scrypt çç¸å³èµæä¹åæææè¯å°è¿ä¸ªåæå¤æ·±ãä¸ä¸ªçæåéççè¯åºç°å¨äºæé¢åï¼fpgaï¼ç°åºå¯ç¼ç¨é»è¾é¨éµåï¼ï¼è¿è´§å°±æ¯è¾åå®³äºãç°æçè¯çæä»¤ç»æå¦ä¼ ç»ç cpuï¼gpuï¼asic é½æ æ³ç ´è§£ bcryptï¼ä½æ¯ fpga æ¯æç§å½é»è¾é¨ï¼å¦andãorãxorãnotï¼ï¼éè¿ç¼ç¨çæ¹å¼ç§å½æä»¤éçè¿ä¸ç¹æ§ä½¿å¾å¯ä»¥å®å¶ç¡¬ä»¶æ¥ç ´è§£ bcryptãå°½ç®¡æä¸è®¤ä¸ºæè¿ä¸ªææ¯çäººä¼å»æ³åæ³ç ´è§£çæ­£çç³»ç»ï¼ä½ï¼åªè¦è¿æ¯ä¸ä¸ªå¯è½æ§ï¼å°±æ»ææ¹æ³ä¼è¢«åæåºæ¥ä¸ä¹å¯¹æãscrypt æ¯ bcrypt é¢å¤èèå°çå°±æ¯å¤§è§æ¨¡çèªå®ä¹ç¡¬ä»¶æ»å» ï¼ä»èå»æè®¾è®¡éè¦å¤§éåå­è¿ç®ã\n\nçè®ºç»å½æ¯çè®ºï¼å®éä¸ bcrypt ç®æ³è¢«åæè³ä» 18 å¹´ï¼ä½¿ç¨èå´å¹¿ï¼ä¸ä»æªå ä¸ºå®å¨é®é¢èè¢«ä¿®æ¹ï¼å¶æéæ§æ¯å·²ç»è¢«éªè¯è¿çï¼ç¸æ¯ä¹ä¸ scrypt æ®æçå°çæç« æ¾ç¤ºæ¯ 9 å¹´çåå²ï¼æ²¡æ bcrypt ä½¿ç¨çå¹¿æ³ãä»ç ´è§£ææ¬åæå¨æ§çè§åº¦æ¥çï¼bcrypt ç¨ä½å¯ç ç¼ç å¨æ¯ä¸éçéæ©ã\n\n\n# spring security åºå¼çæ¥å£\n\nåå°ææ¡£ä¸­ï¼spring security 5 å¯¹ passwordencoder åäºç¸å³çéæï¼ååé»è®¤éç½®ç plaintextpasswordencoderï¼ææå¯ç ï¼è¢«ç§»é¤äºï¼æ³è¦åå°ææå­å¨å¯ç ï¼åªè½ä½¿ç¨ä¸ä¸ªè¿æçç±»æ¥è¿æ¸¡\n\n@bean\npasswordencoder passwordencoder(){\n    return nooppasswordencoder.getinstance();\n}\n\n\n1\n2\n3\n4\n\n\nå®éä¸ï¼spring security æä¾äº bcryptpasswordencoder æ¥è¿è¡å¯ç ç¼ç ï¼å¹¶ä½ä¸ºäºç¸å³éç½®çé»è®¤éç½®ï¼åªä¸è¿æ²¡ææ´é²ä¸ºå¨å±ç beanãä½¿ç¨ææå­å¨çé£é©å¨æç« ä¸å¼å§å°±å·²ç»å¼ºè°è¿ï¼nooppasswordencoder åªè½å­å¨äº demo ä¸­ã\n\n@bean\npasswordencoder passwordencoder(){\n    return new bcryptpasswordencoder();\n}\n\n\n1\n2\n3\n4\n\n\nå«å¿äºå¯¹ä½ æ°æ®åºä¸­çå¯ç è¿è¡åæ ·çç¼ç ï¼å¦åæ æ³å¯¹åºã\n\n\n# æ´æ·±å±çæè\n\nå®éä¸ï¼spring security 5 çå¦ä¸ä¸ªè®¾è®¡æ¯ä¿ä½¿æåææ¬æçåè¡·ã\n\nä¸ç¥éææ²¡æè¯»èäº§çè·æç¸åçå°æ°ï¼\n\n 1. å¦ææè¦è®¾è®¡ä¸ä¸ª qps å¾é«çç»å½ç³»ç»ï¼ä½¿ç¨ spring security æ¨èç bcrypt ä¼ä¸ä¼å­å¨æ§è½é®é¢ï¼\n 2. spring security æä¹è¿ä¹åï¼åæ¥çå¯ç ç¼ç å¨é½ç»æ¹äºï¼æéè¦æä¹è¿ç§»æ§å¯ç ç¼ç çåºç¨ç¨åºï¼\n 3. ä¸ä¸ä»¥ååºäºæ´é«æçå å¯ç®æ³ï¼è¿ç§ç¬¨éçç¡¬ç¼ç æ¹å¼éç½®å¯ç ç¼ç å¨æ¯ä¸æ¯ä¸å¤çµæ´»ï¼\n\nå¨ spring security 5 æä¾äºè¿æ ·ä¸ä¸ªæè·¯ï¼åºè¯¥å°å¯ç ç¼ç ä¹åç hash å¼åå å¯æ¹å¼ä¸èµ·å­å¨ï¼å¹¶æä¾äºä¸ä¸ª delegatingpasswordencoder æ¥ä½ä¸ºä¼å¤å¯ç å¯ç ç¼ç æ¹å¼çéåã\n\n@bean\npasswordencoder passwordencoder(){\n    return passwordencoderfactories.createdelegatingpasswordencoder();\n}\n\n\n1\n2\n3\n4\n\n\nè´è´£çäº§ delegatingpasswordencoder çå·¥åæ¹æ³ï¼\n\npublic class passwordencoderfactories {\n\n   public static passwordencoder createdelegatingpasswordencoder() {\n      string encodingid = "bcrypt";\n      map<string, passwordencoder> encoders = new hashmap<>();\n      encoders.put(encodingid, new bcryptpasswordencoder());\n      encoders.put("ldap", new ldapshapasswordencoder());\n      encoders.put("md4", new md4passwordencoder());\n      encoders.put("md5", new messagedigestpasswordencoder("md5"));\n      encoders.put("noop", nooppasswordencoder.getinstance());\n      encoders.put("pbkdf2", new pbkdf2passwordencoder());\n      encoders.put("scrypt", new scryptpasswordencoder());\n      encoders.put("sha-1", new messagedigestpasswordencoder("sha-1"));\n      encoders.put("sha-256", new messagedigestpasswordencoder("sha-256"));\n      encoders.put("sha256", new standardpasswordencoder());\n\n      return new delegatingpasswordencoder(encodingid, encoders);\n   }\n\n   private passwordencoderfactories() {}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nå¦æ­¤æ³¨å¥ passwordencoder ä¹åï¼æä»¬å¨æ°æ®åºä¸­éè¦è¿ä¹å­å¨æ°æ®ï¼\n\n{bcrypt}$2a$10$dxj3sw6g7p50lgmmkkmwe.20cqqubk3.hzwzg3yb1tlry.fqvm/bg\n{noop}password\n{pbkdf2}5d923b44a6d129f3ddf3e3c8d29412723dcbde72445e8ef6bf3b508fbf17fa4ed4d6b99ca763d8dc\n{scrypt}$e0801$8bwjasu2iksn9z9km+tpxfoc/9bdysrn1od9qfvthwewdrtno7re7ei+fuzrj68k9ltyuteup4of4g24hhnazw==$oaoec05+bxxvuu/1qz6nur+xqyvyv7bel1qxwrpy5pc=\n{sha256}97cde38028ad898ebc02e690819fa220e88c62e0699403e94fff291cfffaf8410849f27605abcbc0\n\n\n1\n2\n3\n4\n5\n\n\nè¿è®°å¾æç« å¼å§çæ¥éåï¼\n\njava.lang.illegalargumentexception: there is no passwordencoder mapped for the id "null"\n\n\n1\n\n\nè¿ä¸ª id å°±æ¯å ä¸ºæä»¬æ²¡æä¸ºæ°æ®åºä¸­çå¯ç æ·»å  {bcrypt} æ­¤ç±»çåç¼å¯¼è´çã\n\n> ä½ ä¼ä¸ä¼æå¿å¯ç æ³é²åï¼{bcrypt}ï¼{pbkdf2}ï¼{scrypt}ï¼{sha256} æ­¤ç±»åç¼ä¼ç´æ¥æ´é²å¯ç çç¼ç æ¹å¼ï¼å¶å®è¿ä¸ªèèæ¯å¤ä½çï¼å ä¸ºå¯ç å­å¨çä¾èµç®æ³å¹¶ä¸æ¯ä¸ä¸ªç§å¯ãå¤§å¤æ°è½æå°ä½ å¯ç ç hacker é½å¯ä»¥è½»æ¾çç¥éä½ ç¨çæ¯ä»ä¹ç®æ³ï¼ä¾å¦ï¼bcrypt ç®æ³éå¸¸ä»¥ $2a$ å¼å¤´\n\nç¨å¾®æèä¸ï¼åé¢çä¸ä¸ªçé®å°±å¯ä»¥è¿åèè§£ï¼è¿å°±æ¯ææ¡£ä¸­æè°çï¼è½å¤èªéåºæå¡å¨æ§è½çç°ä»£åå¯ç ç¼ç æ¹æ¡ã\n\n\n# åè\n\npassword hashing: pbkdf2, scrypt, bcrypt\n\ncore-services-password-encoding\n\n\n# show me the code\n\nspring security oauth2 ç github ä»£ç ç¤ºä¾ï¼ä½ä¼ä¸ spring security 4 -> spring security 5 çç¸å³ååã\n\nhttps://github.com/lexburner/oauth2-demo',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/d07b16/"},regularPath:"/10.%E6%A1%86%E6%9E%B6/30.Mybatis/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"10.æ¡æ¶/30.Mybatis/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-4c61c5bc",path:"/pages/d07b16/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/d35a9e/"},regularPath:"/10.%E6%A1%86%E6%9E%B6/35.Mybatis%20Plus/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"10.æ¡æ¶/35.Mybatis Plus/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-3f5b59cf",path:"/pages/d35a9e/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/b8166d/"},regularPath:"/10.%E6%A1%86%E6%9E%B6/40.Redis/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"10.æ¡æ¶/40.Redis/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-a5a12a48",path:"/pages/b8166d/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"EXISTSï¼NOT EXISTS ï¼ è¯­å¥",frontmatter:{title:"EXISTSï¼NOT EXISTS ï¼ è¯­å¥",date:"2022-02-03T22:57:00.000Z",permalink:"/pages/ee8f7b/",categories:["æ¡æ¶","Mysql","SQL"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/45.Mysql/05.SQL/05.EXISTS%EF%BC%88NOT%20EXISTS%20%EF%BC%89%20%E8%AF%AD%E5%8F%A5.html",relativePath:"10.æ¡æ¶/45.Mysql/05.SQL/05.EXISTSï¼NOT EXISTS ï¼ è¯­å¥.md",key:"v-58f14e65",path:"/pages/ee8f7b/",headersStr:null,content:"EXISTSç¨äºæ£æ¥å­æ¥è¯¢æ¯å¦è³å°ä¼è¿åä¸è¡æ°æ®ï¼è¯¥å­æ¥è¯¢å®éä¸å¹¶ä¸è¿åä»»ä½æ°æ®ï¼èæ¯è¿åå¼TrueæFalse\n\nEXISTS æå®ä¸ä¸ªå­æ¥è¯¢ï¼æ£æµ è¡ çå­å¨ã\n\nEXISTS(åæ¬ NOT EXISTS )å­å¥çè¿åå¼æ¯ä¸ä¸ªBOOLå¼ã EXISTSåé¨æä¸ä¸ªå­æ¥è¯¢è¯­å¥(SELECT ... FROM...)ï¼ æå°å¶ç§°ä¸ºEXISTçåæ¥è¯¢è¯­å¥ãå¶åæ¥è¯¢è¯­å¥è¿åä¸ä¸ªç»æéã EXISTSå­å¥æ ¹æ®å¶åæ¥è¯¢è¯­å¥çç»æéç©ºæèéç©ºï¼è¿åä¸ä¸ªå¸å°å¼ã\n\nä¸ç§éä¿çå¯ä»¥çè§£ä¸ºï¼å°å¤æ¥è¯¢è¡¨çæ¯ä¸è¡ï¼ä»£å¥åæ¥è¯¢ä½ä¸ºæ£éªï¼å¦æåæ¥è¯¢è¿åçç»æåéç©ºå¼ï¼åEXISTSå­å¥è¿åTRUEï¼è¿ä¸è¡è¡å¯ä½ä¸ºå¤æ¥è¯¢çç»æè¡ï¼å¦åä¸è½ä½ä¸ºç»æã\n\nhttps://www.cnblogs.com/xuanhai/p/5810918.html\n\n\n\n\n\n\n\n\n\n",normalizedContent:"existsç¨äºæ£æ¥å­æ¥è¯¢æ¯å¦è³å°ä¼è¿åä¸è¡æ°æ®ï¼è¯¥å­æ¥è¯¢å®éä¸å¹¶ä¸è¿åä»»ä½æ°æ®ï¼èæ¯è¿åå¼trueæfalse\n\nexists æå®ä¸ä¸ªå­æ¥è¯¢ï¼æ£æµ è¡ çå­å¨ã\n\nexists(åæ¬ not exists )å­å¥çè¿åå¼æ¯ä¸ä¸ªboolå¼ã existsåé¨æä¸ä¸ªå­æ¥è¯¢è¯­å¥(select ... from...)ï¼ æå°å¶ç§°ä¸ºexistçåæ¥è¯¢è¯­å¥ãå¶åæ¥è¯¢è¯­å¥è¿åä¸ä¸ªç»æéã existså­å¥æ ¹æ®å¶åæ¥è¯¢è¯­å¥çç»æéç©ºæèéç©ºï¼è¿åä¸ä¸ªå¸å°å¼ã\n\nä¸ç§éä¿çå¯ä»¥çè§£ä¸ºï¼å°å¤æ¥è¯¢è¡¨çæ¯ä¸è¡ï¼ä»£å¥åæ¥è¯¢ä½ä¸ºæ£éªï¼å¦æåæ¥è¯¢è¿åçç»æåéç©ºå¼ï¼åexistså­å¥è¿åtrueï¼è¿ä¸è¡è¡å¯ä½ä¸ºå¤æ¥è¯¢çç»æè¡ï¼å¦åä¸è½ä½ä¸ºç»æã\n\nhttps://www.cnblogs.com/xuanhai/p/5810918.html\n\n\n\n\n\n\n\n\n\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"å®ä¾è¯¦è§£ZooKeeper ZABåè®®ãåå¸å¼éä¸é¢å¯¼éä¸¾",frontmatter:{title:"å®ä¾è¯¦è§£ZooKeeper ZABåè®®ãåå¸å¼éä¸é¢å¯¼éä¸¾",date:"2022-02-03T00:03:41.000Z",permalink:"/pages/bc1a45/",categories:["åç«¯","Zookeeper"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/50.Zookeeper/10.%E5%AE%9E%E4%BE%8B%E8%AF%A6%E8%A7%A3ZooKeeper%20ZAB%E5%8D%8F%E8%AE%AE%E3%80%81%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E4%B8%8E%E9%A2%86%E5%AF%BC%E9%80%89%E4%B8%BE.html",relativePath:"10.æ¡æ¶/50.Zookeeper/10.å®ä¾è¯¦è§£ZooKeeper ZABåè®®ãåå¸å¼éä¸é¢å¯¼éä¸¾.md",key:"v-35bfa9e0",path:"/pages/bc1a45/",headers:[{level:2,title:"ZooKeeperæ¯ä»ä¹",slug:"zookeeperæ¯ä»ä¹",normalizedTitle:"zookeeperæ¯ä»ä¹",charIndex:254},{level:2,title:"ZooKeeperæå¡å¨è§è²",slug:"zookeeperæå¡å¨è§è²",normalizedTitle:"zookeeperæå¡å¨è§è²",charIndex:516},{level:2,title:"åå­å¹¿æ­ï¼ZABï¼",slug:"åå­å¹¿æ­-zab",normalizedTitle:"åå­å¹¿æ­ï¼zabï¼",charIndex:857},{level:3,title:"1ãåLeader",slug:"_1ãåleader",normalizedTitle:"1ãåleader",charIndex:1136},{level:3,title:"2ãåFollower/Observer",slug:"_2ãåfollower-observer",normalizedTitle:"2ãåfollower/observer",charIndex:1612},{level:3,title:"3ãè¯»æä½",slug:"_3ãè¯»æä½",normalizedTitle:"3ãè¯»æä½",charIndex:1771},{level:2,title:"æ¯æçé¢å¯¼éä¸¾ç®æ³",slug:"æ¯æçé¢å¯¼éä¸¾ç®æ³",normalizedTitle:"æ¯æçé¢å¯¼éä¸¾ç®æ³",charIndex:1901},{level:2,title:"FastLeaderElectionåç",slug:"fastleaderelectionåç",normalizedTitle:"fastleaderelectionåç",charIndex:2177},{level:3,title:"1ãmyid",slug:"_1ãmyid",normalizedTitle:"1ãmyid",charIndex:2202},{level:3,title:"2ãzxid",slug:"_2ãzxid",normalizedTitle:"2ãzxid",charIndex:2490},{level:3,title:"3ãæå¡å¨ç¶æ",slug:"_3ãæå¡å¨ç¶æ",normalizedTitle:"3ãæå¡å¨ç¶æ",charIndex:2683},{level:3,title:"4ãéç¥¨æ°æ®ç»æ",slug:"_4ãéç¥¨æ°æ®ç»æ",normalizedTitle:"4ãéç¥¨æ°æ®ç»æ",charIndex:2936},{level:3,title:"5ãæç¥¨æµç¨",slug:"_5ãæç¥¨æµç¨",normalizedTitle:"5ãæç¥¨æµç¨",charIndex:3170},{level:2,title:"éç¾¤å¯å¨é¢å¯¼éä¸¾",slug:"éç¾¤å¯å¨é¢å¯¼éä¸¾",normalizedTitle:"éç¾¤å¯å¨é¢å¯¼éä¸¾",charIndex:4441},{level:3,title:"1ãåå§æç¥¨ç»èªå·±",slug:"_1ãåå§æç¥¨ç»èªå·±",normalizedTitle:"1ãåå§æç¥¨ç»èªå·±",charIndex:4454},{level:3,title:"2ãæ´æ°éç¥¨",slug:"_2ãæ´æ°éç¥¨",normalizedTitle:"2ãæ´æ°éç¥¨",charIndex:4701},{level:3,title:"3ãæ ¹æ®éç¥¨ç¡®å®è§è²",slug:"_3ãæ ¹æ®éç¥¨ç¡®å®è§è²",normalizedTitle:"3ãæ ¹æ®éç¥¨ç¡®å®è§è²",charIndex:5133},{level:2,title:"Followeréå¯éä¸¾",slug:"followeréå¯éä¸¾",normalizedTitle:"followeréå¯éä¸¾",charIndex:5249},{level:3,title:"1ãFolloweréå¯æç¥¨ç»èªå·±",slug:"_1ãfolloweréå¯æç¥¨ç»èªå·±",normalizedTitle:"1ãfolloweréå¯æç¥¨ç»èªå·±",charIndex:5266},{level:3,title:"2ãåç°å·²æLeaderåæä¸ºFollower",slug:"_2ãåç°å·²æleaderåæä¸ºfollower",normalizedTitle:"2ãåç°å·²æleaderåæä¸ºfollower",charIndex:5342},{level:2,title:"Leaderéå¯éä¸¾",slug:"leaderéå¯éä¸¾",normalizedTitle:"leaderéå¯éä¸¾",charIndex:5530},{level:3,title:"1ãFolloweråèµ·æ°æç¥¨",slug:"_1ãfolloweråèµ·æ°æç¥¨",normalizedTitle:"1ãfolloweråèµ·æ°æç¥¨",charIndex:5545},{level:3,title:"2ãå¹¿æ­æ´æ°éç¥¨",slug:"_2ãå¹¿æ­æ´æ°éç¥¨",normalizedTitle:"2ãå¹¿æ­æ´æ°éç¥¨",charIndex:5645},{level:3,title:"3ãéåºæ°Leader",slug:"_3ãéåºæ°leader",normalizedTitle:"3ãéåºæ°leader",charIndex:5955},{level:3,title:"4ãæ§Leaderæ¢å¤ååèµ·éä¸¾",slug:"_4ãæ§leaderæ¢å¤ååèµ·éä¸¾",normalizedTitle:"4ãæ§leaderæ¢å¤ååèµ·éä¸¾",charIndex:6048},{level:3,title:"5ãæ§Leaderæä¸ºFollower",slug:"_5ãæ§leaderæä¸ºfollower",normalizedTitle:"5ãæ§leaderæä¸ºfollower",charIndex:6202},{level:2,title:"Commitè¿çæ°æ®ä¸ä¸¢å¤±",slug:"commitè¿çæ°æ®ä¸ä¸¢å¤±",normalizedTitle:"commitè¿çæ°æ®ä¸ä¸¢å¤±",charIndex:6290},{level:3,title:"1ãFailoveråç¶æ",slug:"_1ãfailoveråç¶æ",normalizedTitle:"1ãfailoveråç¶æ",charIndex:6308},{level:3,title:"2ãéåºæ°Leader",slug:"_2ãéåºæ°leader",normalizedTitle:"2ãéåºæ°leader",charIndex:6690},{level:3,title:"3ãéç¥Followerå¯å¯¹å¤æå¡",slug:"_3ãéç¥followerå¯å¯¹å¤æå¡",normalizedTitle:"3ãéç¥followerå¯å¯¹å¤æå¡",charIndex:6989},{level:2,title:"æªCommitè¿çæ¶æ¯å¯¹å®¢æ·ç«¯ä¸å¯è§",slug:"æªcommitè¿çæ¶æ¯å¯¹å®¢æ·ç«¯ä¸å¯è§",normalizedTitle:"æªcommitè¿çæ¶æ¯å¯¹å®¢æ·ç«¯ä¸å¯è§",charIndex:7125},{level:2,title:"æ¬èæ»ç»",slug:"æ¬èæ»ç»",normalizedTitle:"æ¬èæ»ç»",charIndex:7880},{level:2,title:"åºäºZooKeeperçåå¸å¼éä¸é¢å¯¼éä¸¾",slug:"åºäºzookeeperçåå¸å¼éä¸é¢å¯¼éä¸¾",normalizedTitle:"åºäºzookeeperçåå¸å¼éä¸é¢å¯¼éä¸¾",charIndex:8095},{level:3,title:"ZooKeeperèç¹ç±»å",slug:"zookeeperèç¹ç±»å",normalizedTitle:"zookeeperèç¹ç±»å",charIndex:8166},{level:3,title:"ZooKeeperè¯­ä¹ä¿è¯",slug:"zookeeperè¯­ä¹ä¿è¯",normalizedTitle:"zookeeperè¯­ä¹ä¿è¯",charIndex:8639},{level:3,title:"ZooKeeper Watchæºå¶",slug:"zookeeper-watchæºå¶",normalizedTitle:"zookeeper watchæºå¶",charIndex:9065},{level:3,title:"åå¸å¼éä¸é¢å¯¼éä¸¾å³é®ç¹",slug:"åå¸å¼éä¸é¢å¯¼éä¸¾å³é®ç¹",normalizedTitle:"åå¸å¼éä¸é¢å¯¼éä¸¾å³é®ç¹",charIndex:9433},{level:3,title:"éå¬å¹³é¢å¯¼éä¸¾",slug:"éå¬å¹³é¢å¯¼éä¸¾",normalizedTitle:"éå¬å¹³é¢å¯¼éä¸¾",charIndex:9942},{level:3,title:"å¬å¹³é¢å¯¼éä¸¾",slug:"å¬å¹³é¢å¯¼éä¸¾",normalizedTitle:"å¬å¹³é¢å¯¼éä¸¾",charIndex:9943},{level:3,title:"éæ°éä¸¾",slug:"éæ°éä¸¾",normalizedTitle:"éæ°éä¸¾",charIndex:10616}],headersStr:"ZooKeeperæ¯ä»ä¹ ZooKeeperæå¡å¨è§è² åå­å¹¿æ­ï¼ZABï¼ 1ãåLeader 2ãåFollower/Observer 3ãè¯»æä½ æ¯æçé¢å¯¼éä¸¾ç®æ³ FastLeaderElectionåç 1ãmyid 2ãzxid 3ãæå¡å¨ç¶æ 4ãéç¥¨æ°æ®ç»æ 5ãæç¥¨æµç¨ éç¾¤å¯å¨é¢å¯¼éä¸¾ 1ãåå§æç¥¨ç»èªå·± 2ãæ´æ°éç¥¨ 3ãæ ¹æ®éç¥¨ç¡®å®è§è² Followeréå¯éä¸¾ 1ãFolloweréå¯æç¥¨ç»èªå·± 2ãåç°å·²æLeaderåæä¸ºFollower Leaderéå¯éä¸¾ 1ãFolloweråèµ·æ°æç¥¨ 2ãå¹¿æ­æ´æ°éç¥¨ 3ãéåºæ°Leader 4ãæ§Leaderæ¢å¤ååèµ·éä¸¾ 5ãæ§Leaderæä¸ºFollower Commitè¿çæ°æ®ä¸ä¸¢å¤± 1ãFailoveråç¶æ 2ãéåºæ°Leader 3ãéç¥Followerå¯å¯¹å¤æå¡ æªCommitè¿çæ¶æ¯å¯¹å®¢æ·ç«¯ä¸å¯è§ æ¬èæ»ç» åºäºZooKeeperçåå¸å¼éä¸é¢å¯¼éä¸¾ ZooKeeperèç¹ç±»å ZooKeeperè¯­ä¹ä¿è¯ ZooKeeper Watchæºå¶ åå¸å¼éä¸é¢å¯¼éä¸¾å³é®ç¹ éå¬å¹³é¢å¯¼éä¸¾ å¬å¹³é¢å¯¼éä¸¾ éæ°éä¸¾",content:"ä½èä»ç»\n\n**é­ä¿ï¼**ä¸æ³¨äºå¤§æ°æ®æ¶æï¼çæKafkaåFlumeæºç ï¼çæHadoopåSparkåçï¼ç²¾éæ°æ®ï¼ä»ï¼åºæ¨¡åè®¾è®¡åSQLè°ä¼ãå¬ä¼å·ï¼å¤§æ°æ®æ¶æï¼åå®¢ï¼http://www.jasongj.com/ï¼\n\næ¬æç»ä½èææè½¬è½½ï¼ç¦æ­¢äºæ¬¡è½¬è½½ã\n\næ¬èå°ä»ç»ZooKeeperçæ¶æï¼å¹¶ç»åå®ä¾åæåå­å¹¿æ­(ZAB)åè®®çåçï¼åæ¬ä½ä¸éäºZooKeeperçè¯»åæµç¨ï¼FastLeaderElectionç®æ³çåçï¼ZABå¦ä½ä¿è¯Leader Failoverè¿ç¨ä¸­çæ°æ®ä¸è´æ§ã\n\n\n# ZooKeeperæ¯ä»ä¹\n\nZooKeeperæ¯ä¸ä¸ªåå¸å¼åè°æå¡ï¼å¯ç¨äºæå¡åç°ãåå¸å¼éãåå¸å¼é¢å¯¼éä¸¾ãéç½®ç®¡çç­ã\n\nè¿ä¸åçåºç¡ï¼é½æ¯ZooKeeperæä¾äºä¸ä¸ªç±»ä¼¼äºLinuxæä»¶ç³»ç»çæ å½¢ç»æï¼å¯è®¤ä¸ºæ¯è½»éçº§çåå­æä»¶ç³»ç»ï¼ä½åªéåå­å°éä¿¡æ¯ï¼å®å¨ä¸éåå­å¨å¤§éæä»¶æèå¤§æä»¶ï¼ï¼åæ¶æä¾äºå¯¹äºæ¯ä¸ªèç¹ççæ§ä¸éç¥æºå¶ã\n\næ¢ç¶æ¯ä¸ä¸ªæä»¶ç³»ç»ï¼å°±ä¸å¾ä¸æZooKeeperæ¯å¦ä½ä¿è¯æ°æ®çä¸è´æ§çãæ¬èå°å°ä»ç»ZooKeeperå¦ä½ä¿è¯æ°æ®ä¸è´æ§ï¼å¦ä½è¿è¡é¢å¯¼éä¸¾ï¼ä»¥åæ°æ®çæ§/éç¥æºå¶çè¯­ä¹ä¿è¯ã\n\n\n# ZooKeeperæå¡å¨è§è²\n\nZooKeeperéç¾¤æ¯ä¸ä¸ªåºäºä¸»ä»å¤å¶çé«å¯ç¨éç¾¤ï¼æ¯ä¸ªæå¡å¨æ¿æå¦ä¸ä¸ç§è§è²ä¸­çä¸ç§ï¼\n\n * Leader ä¸ä¸ªZooKeeperéç¾¤åä¸æ¶é´åªä¼æä¸ä¸ªå®éå·¥ä½çLeaderï¼å®ä¼åèµ·å¹¶ç»´æ¤ä¸åFollweråObserveré´çå¿è·³ãææçåæä½å¿é¡»è¦éè¿Leaderå®æåç±Leaderå°åæä½å¹¿æ­ç»å¶å®æå¡å¨ã\n * Follower ä¸ä¸ªZooKeeperéç¾¤å¯è½åæ¶å­å¨å¤ä¸ªFollowerï¼å®ä¼ååºLeaderçå¿è·³ãFollowerå¯ç´æ¥å¤çå¹¶è¿åå®¢æ·ç«¯çè¯»è¯·æ±ï¼åæ¶ä¼å°åè¯·æ±è½¬åç»Leaderå¤çï¼å¹¶ä¸è´è´£å¨Leaderå¤çåè¯·æ±æ¶å¯¹è¯·æ±è¿è¡æç¥¨ã\n * Observer è§è²ä¸Followerç±»ä¼¼ï¼ä½æ¯æ æç¥¨æã\n\n\n# åå­å¹¿æ­ï¼ZABï¼\n\nä¸ºäºä¿è¯åæä½çä¸è´æ§ä¸å¯ç¨æ§ï¼ZooKeeperä¸é¨è®¾è®¡äºä¸ç§åä¸ºåå­å¹¿æ­ï¼ZABï¼çæ¯æå´©æºæ¢å¤çä¸è´æ§åè®®ãåºäºè¯¥åè®®ï¼ZooKeeperå®ç°äºä¸ç§ä¸»ä»æ¨¡å¼çç³»ç»æ¶ææ¥ä¿æéç¾¤ä¸­åä¸ªå¯æ¬ä¹é´çæ°æ®ä¸è´æ§ã\n\næ ¹æ®ZABåè®®ï¼ææçåæä½é½å¿é¡»éè¿Leaderå®æï¼Leaderåå¥æ¬å°æ¥å¿ååå¤å¶å°ææçFollowerèç¹ã\n\nä¸æ¦Leaderèç¹æ æ³å·¥ä½ï¼ZABåè®®è½å¤èªå¨ä»Followerèç¹ä¸­éæ°éåºä¸ä¸ªåéçæ¿ä»£èï¼å³æ°çLeaderï¼è¯¥è¿ç¨å³ä¸ºé¢å¯¼éä¸¾ãè¯¥é¢å¯¼éä¸¾è¿ç¨ï¼æ¯ZABåè®®ä¸­æä¸ºéè¦åå¤æçè¿ç¨ã\n\n\n# 1ãåLeader\n\néè¿Leaderè¿è¡åæä½æµç¨å¦ä¸å¾æç¤ºï¼\n\nç±ä¸å¾å¯è§ï¼éè¿Leaderè¿è¡åæä½ï¼ä¸»è¦åä¸ºäºæ­¥ï¼\n\n 1. å®¢æ·ç«¯åLeaderåèµ·åè¯·æ±\n 2. Leaderå°åè¯·æ±ä»¥Proposalçå½¢å¼åç»ææFollowerå¹¶ç­å¾ACK\n 3. Followeræ¶å°LeaderçProposalåè¿åACK\n 4. Leaderå¾å°è¿åæ°çACKï¼Leaderå¯¹èªå·±é»è®¤æä¸ä¸ªACKï¼ååææçFolloweråObserveråéCommit\n 5. Leaderå°å¤çç»æè¿åç»å®¢æ·ç«¯\n\nè¿éè¦æ³¨æï¼\n\n * Leaderå¹¶ä¸éè¦å¾å°ObserverçACKï¼å³Observeræ æç¥¨æ\n * Leaderä¸éè¦å¾å°ææFollowerçACKï¼åªè¦æ¶å°è¿åçACKå³å¯ï¼åæ¶Leaderæ¬èº«å¯¹èªå·±æä¸ä¸ªACKãä¸å¾ä¸­æ4ä¸ªFollowerï¼åªéå¶ä¸­ä¸¤ä¸ªè¿åACKå³å¯ï¼å ä¸º(2+1) / (4+1) > 1/2\n * Observerè½ç¶æ æç¥¨æï¼ä½ä»é¡»åæ­¥Leaderçæ°æ®ä»èå¨å¤çè¯»è¯·æ±æ¶å¯ä»¥è¿åå°½å¯è½æ°çæ°æ®\n\n\n# 2ãåFollower/Observer\n\néè¿Follower/Observerè¿è¡åæä½æµç¨å¦ä¸å¾æç¤ºï¼\n\n\n\nä»ä¸å¾å¯è§ï¼\n\n * Follower/Observeråå¯æ¥ååè¯·æ±ï¼ä½ä¸è½ç´æ¥å¤çï¼èéè¦å°åè¯·æ±è½¬åç»Leaderå¤ç\n * é¤äºå¤äºä¸æ­¥è¯·æ±è½¬åï¼å¶å®æµç¨ä¸ç´æ¥åLeaderæ ä»»ä½åºå«\n\n\n# 3ãè¯»æä½\n\nLeader/Follower/Observeré½å¯ç´æ¥å¤çè¯»è¯·æ±ï¼ä»æ¬å°åå­ä¸­è¯»åæ°æ®å¹¶è¿åç»å®¢æ·ç«¯å³å¯ã\n\n\n\nç±äºå¤çè¯»è¯·æ±ä¸éè¦æå¡å¨ä¹é´çäº¤äºï¼Follower/Observerè¶å¤ï¼æ´ä½å¯å¤ççè¯»è¯·æ±éè¶å¤§ï¼ä¹å³è¯»æ§è½è¶å¥½ã\n\n\n# æ¯æçé¢å¯¼éä¸¾ç®æ³\n\nå¯éè¿electionAlgéç½®é¡¹è®¾ç½®ZooKeeperç¨äºé¢å¯¼éä¸¾çç®æ³ã\n\nå°3.4.10çæ¬ä¸ºæ­¢ï¼å¯éé¡¹æï¼\n\n * 0 åºäºUDPçLeaderElection\n * 1 åºäºUDPçFastLeaderElection\n * 2 åºäºUDPåè®¤è¯çFastLeaderElection\n * 3 åºäºTCPçFastLeaderElection\n\nå¨3.4.10çæ¬ä¸­ï¼é»è®¤å¼ä¸º3ï¼ä¹å³åºäºTCPçFastLeaderElectionãå¦å¤ä¸ç§ç®æ³å·²ç»è¢«å¼ç¨ï¼å¹¶ä¸æè®¡åå¨ä¹åççæ¬ä¸­å°å®ä»¬å½»åºå é¤èä¸åæ¯æã\n\n\n# FastLeaderElectionåç\n\n\n# 1ãmyid\n\næ¯ä¸ªZooKeeperæå¡å¨ï¼é½éè¦å¨æ°æ®æä»¶å¤¹ä¸åå»ºä¸ä¸ªåä¸ºmyidçæä»¶ï¼è¯¥æä»¶åå«æ´ä¸ªZooKeeperéç¾¤å¯ä¸çIDï¼æ´æ°ï¼ãä¾å¦ï¼æZooKeeperéç¾¤åå«ä¸å°æå¡å¨ï¼hostnameåå«ä¸ºzoo1ãzoo2åzoo3ï¼å¶myidåå«ä¸º1ã2å3ï¼åå¨éç½®æä»¶ä¸­å¶IDä¸hostnameå¿é¡»ä¸ä¸å¯¹åºï¼å¦ä¸æç¤ºãå¨è¯¥éç½®æä»¶ä¸­ï¼server.åé¢çæ°æ®å³ä¸ºmyid\n\nserver.1=zoo1:2888:3888\n\nserver.2=zoo2:2888:3888\n\nserver.3=zoo3:2888:3888\n\n\n1\n2\n3\n4\n5\n\n\n\n# 2ãzxid\n\nç±»ä¼¼äºRDBMSä¸­çäºå¡IDï¼ç¨äºæ è¯ä¸æ¬¡æ´æ°æä½çProposal IDãä¸ºäºä¿è¯é¡ºåºæ§ï¼è¯¥zkidå¿é¡»åè°éå¢ãå æ­¤ZooKeeperä½¿ç¨ä¸ä¸ª64ä½çæ°æ¥è¡¨ç¤ºï¼é«32ä½æ¯Leaderçepochï¼ä»1å¼å§ï¼æ¯æ¬¡éåºæ°çLeaderï¼epochå ä¸ãä½32ä½ä¸ºè¯¥epochåçåºå·ï¼æ¯æ¬¡epochååï¼é½å°ä½32ä½çåºå·éç½®ãè¿æ ·ä¿è¯äºzkidçå¨å±éå¢æ§ã\n\n\n# 3ãæå¡å¨ç¶æ\n\n * LOOKING ä¸ç¡®å®Leaderç¶æãè¯¥ç¶æä¸çæå¡å¨è®¤ä¸ºå½åéç¾¤ä¸­æ²¡æLeaderï¼ä¼åèµ·Leaderéä¸¾ã\n * FOLLOWING è·éèç¶æãè¡¨æå½åæå¡å¨è§è²æ¯Followerï¼å¹¶ä¸å®ç¥éLeaderæ¯è°ã\n * LEADING é¢å¯¼èç¶æãè¡¨æå½åæå¡å¨è§è²æ¯Leaderï¼å®ä¼ç»´æ¤ä¸Followeré´çå¿è·³ã\n * OBSERVING è§å¯èç¶æãè¡¨æå½åæå¡å¨è§è²æ¯Observerï¼ä¸Folowerå¯ä¸çä¸åå¨äºä¸åä¸éä¸¾ï¼ä¹ä¸åä¸éç¾¤åæä½æ¶çæç¥¨ã\n\n\n# 4ãéç¥¨æ°æ®ç»æ\n\næ¯ä¸ªæå¡å¨å¨è¿è¡é¢å¯¼éä¸¾æ¶ï¼ä¼åéå¦ä¸å³é®ä¿¡æ¯ï¼\n\n * logicClock æ¯ä¸ªæå¡å¨ä¼ç»´æ¤ä¸ä¸ªèªå¢çæ´æ°ï¼åä¸ºlogicClockï¼å®è¡¨ç¤ºè¿æ¯è¯¥æå¡å¨åèµ·çç¬¬å¤å°è½®æç¥¨\n * state å½åæå¡å¨çç¶æ\n * self_id å½åæå¡å¨çmyid\n * self_zxid å½åæå¡å¨ä¸æä¿å­çæ°æ®çæå¤§zxid\n * vote_id è¢«æ¨ä¸¾çæå¡å¨çmyid\n * vote_zxid è¢«æ¨ä¸¾çæå¡å¨ä¸æä¿å­çæ°æ®çæå¤§zxid\n\n\n# 5ãæç¥¨æµç¨\n\nèªå¢éä¸¾è½®æ¬¡\n\nZooKeeperè§å®ææææçæç¥¨é½å¿é¡»å¨åä¸è½®æ¬¡ä¸­ãæ¯ä¸ªæå¡å¨å¨å¼å§æ°ä¸è½®æç¥¨æ¶ï¼ä¼åå¯¹èªå·±ç»´æ¤çlogicClockè¿è¡èªå¢æä½ã\n\nåå§åéç¥¨\n\næ¯ä¸ªæå¡å¨å¨å¹¿æ­èªå·±çéç¥¨åï¼ä¼å°èªå·±çæç¥¨ç®±æ¸ç©ºãè¯¥æç¥¨ç®±è®°å½äºææ¶å°çéç¥¨ãä¾ï¼æå¡å¨2æç¥¨ç»æå¡å¨3ï¼æå¡å¨3æç¥¨ç»æå¡å¨1ï¼åæå¡å¨1çæç¥¨ç®±ä¸º(2, 3), (3, 1), (1, 1)ãç¥¨ç®±ä¸­åªä¼è®°å½æ¯ä¸æç¥¨èçæåä¸ç¥¨ï¼å¦æç¥¨èæ´æ°èªå·±çéç¥¨ï¼åå¶å®æå¡å¨æ¶å°è¯¥æ°éç¥¨åä¼å¨èªå·±ç¥¨ç®±ä¸­æ´æ°è¯¥æå¡å¨çéç¥¨ã\n\nåéåå§åéç¥¨\n\næ¯ä¸ªæå¡å¨æå¼å§é½æ¯éè¿å¹¿æ­æç¥¨æç»èªå·±ã\n\næ¥æ¶å¤é¨æç¥¨\n\næå¡å¨ä¼å°è¯ä»å¶å®æå¡å¨è·åæç¥¨ï¼å¹¶è®°å¥èªå·±çæç¥¨ç®±åãå¦ææ æ³è·åä»»ä½å¤é¨æç¥¨ï¼åä¼ç¡®è®¤èªå·±æ¯å¦ä¸éç¾¤ä¸­å¶å®æå¡å¨ä¿æçææè¿æ¥ãå¦ææ¯ï¼ååæ¬¡åéèªå·±çæç¥¨ï¼å¦æå¦ï¼åé©¬ä¸ä¸ä¹å»ºç«è¿æ¥ã\n\nå¤æ­éä¸¾è½®æ¬¡\n\næ¶å°å¤é¨æç¥¨åï¼é¦åä¼æ ¹æ®æç¥¨ä¿¡æ¯ä¸­æåå«çlogicClockæ¥è¿è¡ä¸åå¤çï¼\n\n * å¤é¨æç¥¨çlogicClockå¤§äºèªå·±çlogicClockãè¯´æè¯¥æå¡å¨çéä¸¾è½®æ¬¡è½åäºå¶å®æå¡å¨çéä¸¾è½®æ¬¡ï¼ç«å³æ¸ç©ºèªå·±çæç¥¨ç®±å¹¶å°èªå·±çlogicClockæ´æ°ä¸ºæ¶å°çlogicClockï¼ç¶ååå¯¹æ¯èªå·±ä¹åçæç¥¨ä¸æ¶å°çæç¥¨ä»¥ç¡®å®æ¯å¦éè¦åæ´èªå·±çæç¥¨ï¼æç»åæ¬¡å°èªå·±çæç¥¨å¹¿æ­åºå»ã\n * å¤é¨æç¥¨çlogicClockå°äºèªå·±çlogicClockãå½åæå¡å¨ç´æ¥å¿½ç¥è¯¥æç¥¨ï¼ç»§ç»­å¤çä¸ä¸ä¸ªæç¥¨ã\n * å¤é¨æç¥¨çlogickClockä¸èªå·±çç¸ç­ãå½æ¶è¿è¡éç¥¨PKã\n\néç¥¨PK\n\néç¥¨PKæ¯åºäº(self_id, self_zxid)ä¸(vote_id, vote_zxid)çå¯¹æ¯ï¼\n\n * å¤é¨æç¥¨çlogicClockå¤§äºèªå·±çlogicClockï¼åå°èªå·±çlogicClockåèªå·±çéç¥¨çlogicClockåæ´ä¸ºæ¶å°çlogicClock\n * è¥logicClockä¸è´ï¼åå¯¹æ¯äºèçvote_zxidï¼è¥å¤é¨æç¥¨çvote_zxidæ¯è¾å¤§ï¼åå°èªå·±çç¥¨ä¸­çvote_zxidä¸vote_myidæ´æ°ä¸ºæ¶å°çç¥¨ä¸­çvote_zxidä¸vote_myidå¹¶å¹¿æ­åºå»ï¼å¦å¤å°æ¶å°çç¥¨åèªå·±æ´æ°åçç¥¨æ¾å¥èªå·±çç¥¨ç®±ãå¦æç¥¨ç®±åå·²å­å¨(self_myid, self_zxid)ç¸åçéç¥¨ï¼åç´æ¥è¦ç\n * è¥äºèvote_zxidä¸è´ï¼åæ¯è¾äºèçvote_myidï¼è¥å¤é¨æç¥¨çvote_myidæ¯è¾å¤§ï¼åå°èªå·±çç¥¨ä¸­çvote_myidæ´æ°ä¸ºæ¶å°çç¥¨ä¸­çvote_myidå¹¶å¹¿æ­åºå»ï¼å¦å¤å°æ¶å°çç¥¨åèªå·±æ´æ°åçç¥¨æ¾å¥èªå·±çç¥¨ç®±\n\nç»è®¡éç¥¨\n\nå¦æå·²ç»ç¡®å®æè¿åæå¡å¨è®¤å¯äºèªå·±çæç¥¨ï¼å¯è½æ¯æ´æ°åçæç¥¨ï¼ï¼åç»æ­¢æç¥¨ãå¦åç»§ç»­æ¥æ¶å¶å®æå¡å¨çæç¥¨ã\n\næ´æ°æå¡å¨ç¶æ\n\næç¥¨ç»æ­¢åï¼æå¡å¨å¼å§æ´æ°èªèº«ç¶æãè¥è¿åçç¥¨æç»äºèªå·±ï¼åå°èªå·±çæå¡å¨ç¶ææ´æ°ä¸ºLEADINGï¼å¦åå°èªå·±çç¶ææ´æ°ä¸ºFOLLOWINGã\n\n\n# éç¾¤å¯å¨é¢å¯¼éä¸¾\n\n\n# 1ãåå§æç¥¨ç»èªå·±\n\néç¾¤åå¯å¨æ¶ï¼æææå¡å¨çlogicClocké½ä¸º1ï¼zxidé½ä¸º0ãåæå¡å¨åå§ååï¼é½æç¥¨ç»èªå·±ï¼å¹¶å°èªå·±çä¸ç¥¨å­å¥èªå·±çç¥¨ç®±ï¼å¦ä¸å¾æç¤ºã\n\nå¨ä¸å¾ä¸­ï¼(1, 1, 0)ç¬¬ä¸ä½æ°ä»£è¡¨æåºè¯¥éç¥¨çæå¡å¨çlogicClockï¼ç¬¬äºä½æ°ä»£è¡¨è¢«æ¨èçæå¡å¨çmyidï¼ç¬¬ä¸ä½ä»£è¡¨è¢«æ¨èçæå¡å¨çæå¤§çzxidãç±äºè¯¥æ­¥éª¤ä¸­ææéç¥¨é½æç»èªå·±ï¼æä»¥ç¬¬äºä½çmyidå³æ¯èªå·±çmyidï¼ç¬¬ä¸ä½çzxidå³æ¯èªå·±çzxidã\n\næ­¤æ¶åèªçç¥¨ç®±ä¸­åªæèªå·±æç»èªå·±çä¸ç¥¨ã\n\n\n# 2ãæ´æ°éç¥¨\n\næå¡å¨æ¶å°å¤é¨æç¥¨åï¼è¿è¡éç¥¨PKï¼ç¸åºæ´æ°èªå·±çéç¥¨å¹¶å¹¿æ­åºå»ï¼å¹¶å°åéçéç¥¨å­å¥èªå·±çç¥¨ç®±ï¼å¦ä¸å¾æç¤ºã\n\næå¡å¨1æ¶å°æå¡å¨2çéç¥¨ï¼1, 2, 0ï¼åæå¡å¨3çéç¥¨ï¼1, 3, 0ï¼åï¼ç±äºææçlogicClocké½ç¸ç­ï¼ææçzxidé½ç¸ç­ï¼å æ­¤æ ¹æ®myidå¤æ­åºè¯¥å°èªå·±çéç¥¨æç§æå¡å¨3çéç¥¨æ´æ°ä¸ºï¼1, 3, 0ï¼ï¼å¹¶å°èªå·±çç¥¨ç®±å¨é¨æ¸ç©ºï¼åå°æå¡å¨3çéç¥¨ä¸èªå·±çéç¥¨å­å¥èªå·±çç¥¨ç®±ï¼æ¥çå°èªå·±æ´æ°åçéç¥¨å¹¿æ­åºå»ãæ­¤æ¶æå¡å¨1ç¥¨ç®±åçéç¥¨ä¸º(1, 3)ï¼(3, 3)ã\n\nåçï¼æå¡å¨2æ¶å°æå¡å¨3çéç¥¨åä¹å°èªå·±çéç¥¨æ´æ°ä¸ºï¼1, 3, 0ï¼å¹¶å­å¥ç¥¨ç®±ç¶åå¹¿æ­ãæ­¤æ¶æå¡å¨2ç¥¨ç®±åçéç¥¨ä¸º(2, 3)ï¼(3, ,3)ã\n\næå¡å¨3æ ¹æ®ä¸è¿°è§åï¼æ é¡»æ´æ°éç¥¨ï¼èªèº«çç¥¨ç®±åéç¥¨ä»ä¸ºï¼3, 3ï¼ã\n\næå¡å¨1ä¸æå¡å¨2æ´æ°åçéç¥¨å¹¿æ­åºå»åï¼ç±äºä¸ä¸ªæå¡å¨ææ°éç¥¨é½ç¸åï¼æåä¸èçç¥¨ç®±åé½åå«ä¸å¼ æç»æå¡å¨3çéç¥¨ã\n\n\n# 3ãæ ¹æ®éç¥¨ç¡®å®è§è²\n\næ ¹æ®ä¸è¿°éç¥¨ï¼ä¸ä¸ªæå¡å¨ä¸è´è®¤ä¸ºæ­¤æ¶æå¡å¨3åºè¯¥æ¯Leaderãå æ­¤æå¡å¨1å2é½è¿å¥FOLLOWINGç¶æï¼èæå¡å¨3è¿å¥LEADINGç¶æãä¹åLeaderåèµ·å¹¶ç»´æ¤ä¸Followeré´çå¿è·³ã\n\n\n# Followeréå¯éä¸¾\n\n\n# 1ãFolloweréå¯æç¥¨ç»èªå·±\n\nFolloweréå¯ï¼æèåçç½ç»ååºåæ¾ä¸å°Leaderï¼ä¼è¿å¥LOOKINGç¶æå¹¶åèµ·æ°çä¸è½®æç¥¨ã\n\n\n# 2ãåç°å·²æLeaderåæä¸ºFollower\n\næå¡å¨3æ¶å°æå¡å¨1çæç¥¨åï¼å°èªå·±çç¶æLEADINGä»¥åéç¥¨è¿åç»æå¡å¨1ãæå¡å¨2æ¶å°æå¡å¨1çæç¥¨åï¼å°èªå·±çç¶æFOLLOWINGåéç¥¨è¿åç»æå¡å¨1ãæ­¤æ¶æå¡å¨1ç¥éæå¡å¨3æ¯Leaderï¼å¹¶ä¸éè¿æå¡å¨2ä¸æå¡å¨3çéç¥¨å¯ä»¥ç¡®å®æå¡å¨3ç¡®å®å¾å°äºè¶è¿åæ°çéç¥¨ãå æ­¤æå¡å¨1è¿å¥FOLLOWINGç¶æã\n\n\n# Leaderéå¯éä¸¾\n\n\n# 1ãFolloweråèµ·æ°æç¥¨\n\nLeaderï¼æå¡å¨3ï¼å®æºåï¼Followerï¼æå¡å¨1å2ï¼åç°Leaderä¸å·¥ä½äºï¼å æ­¤è¿å¥LOOKINGç¶æå¹¶åèµ·æ°çä¸è½®æç¥¨ï¼å¹¶ä¸é½å°ç¥¨æç»èªå·±ã\n\n\n# 2ãå¹¿æ­æ´æ°éç¥¨\n\næå¡å¨1å2æ ¹æ®å¤é¨æç¥¨ç¡®å®æ¯å¦è¦æ´æ°èªèº«çéç¥¨ãè¿éæä¸¤ç§æåµï¼\n\n * æå¡å¨1å2çzxidç¸åãä¾å¦å¨æå¡å¨3å®æºåæå¡å¨1ä¸2å®å¨ä¸ä¹åæ­¥ãæ­¤æ¶éç¥¨çæ´æ°ä¸»è¦åå³äºmyidçå¤§å°\n * æå¡å¨1å2çzxidä¸åãå¨æ§Leaderå®æºä¹åï¼å¶æä¸»å¯¼çåæä½ï¼åªéè¿åæå¡å¨ç¡®è®¤å³å¯ï¼èä¸éæææå¡å¨ç¡®è®¤ãæ¢å¥è¯è¯´ï¼æå¡å¨1å2å¯è½ä¸ä¸ªä¸æ§Leaderåæ­¥ï¼å³zxidä¸ä¹ç¸åï¼å¦ä¸ä¸ªä¸åæ­¥ï¼å³zxidæ¯ä¹å°ï¼ãæ­¤æ¶éç¥¨çæ´æ°ä¸»è¦åå³äºè°çzxidè¾å¤§\n\nå¨ä¸å¾ä¸­ï¼æå¡å¨1çzxidä¸º11ï¼èæå¡å¨2çzxidä¸º10ï¼å æ­¤æå¡å¨2å°èªèº«éç¥¨æ´æ°ä¸ºï¼3, 1, 11ï¼ï¼å¦ä¸å¾æç¤ºã\n\n\n# 3ãéåºæ°Leader\n\nç»è¿ä¸ä¸æ­¥éç¥¨æ´æ°åï¼æå¡å¨1ä¸æå¡å¨2åå°éç¥¨æç»æå¡å¨1ï¼å æ­¤æå¡å¨2æä¸ºFollowerï¼èæå¡å¨1æä¸ºæ°çLeaderå¹¶ç»´æ¤ä¸æå¡å¨2çå¿è·³ã\n\n\n# 4ãæ§Leaderæ¢å¤ååèµ·éä¸¾\n\næ§çLeaderæ¢å¤åï¼è¿å¥LOOKINGç¶æå¹¶åèµ·æ°ä¸è½®é¢å¯¼éä¸¾ï¼å¹¶å°éç¥¨æç»èªå·±ãæ­¤æ¶æå¡å¨1ä¼å°èªå·±çLEADINGç¶æåéç¥¨ï¼3, 1, 11ï¼è¿åç»æå¡å¨3ï¼èæå¡å¨2å°èªå·±çFOLLOWINGç¶æåéç¥¨ï¼3, 1, 11ï¼è¿åç»æå¡å¨3ãå¦ä¸å¾æç¤ºã\n\n\n# 5ãæ§Leaderæä¸ºFollower\n\næå¡å¨3äºè§£å°Leaderä¸ºæå¡å¨1ï¼ä¸æ ¹æ®éç¥¨äºè§£å°æå¡å¨1ç¡®å®å¾å°è¿åæå¡å¨çéç¥¨ï¼å æ­¤èªå·±è¿å¥FOLLOWINGç¶æã\n\n\n# Commitè¿çæ°æ®ä¸ä¸¢å¤±\n\n\n# 1ãFailoveråç¶æ\n\nä¸ºæ´å¥½æ¼ç¤ºLeader Failoverè¿ç¨ï¼æ¬ä¾ä¸­å±ä½¿ç¨5ä¸ªZooKeeperæå¡å¨ãAä½ä¸ºLeaderï¼å±æ¶å°P1ãP2ãP3ä¸æ¡æ¶æ¯ï¼å¹¶ä¸Commitäº1å2ï¼ä¸æ»ä½é¡ºåºä¸ºP1ãP2ãC1ãP3ãC2ãæ ¹æ®é¡ºåºæ§ååï¼å¶å®Followeræ¶å°çæ¶æ¯çé¡ºåºè¯å®ä¸ä¹ç¸åãå¶ä¸­Bä¸Aå®å¨åæ­¥ï¼Cæ¶å°P1ãP2ãC1ï¼Dæ¶å°P1ãP2ï¼Eæ¶å°P1ï¼å¦ä¸å¾æç¤ºã\n\nè¿éè¦æ³¨æï¼\n\n * ç±äºAæ²¡æC3ï¼æå³çæ¶å°P3çæå¡å¨çæ»ä¸ªæ°ä¸ä¼è¶è¿ä¸åï¼ä¹å³åå«Aå¨åæå¤åªæä¸¤å°æå¡å¨æ¶å°P3ãå¨è¿éAåBæ¶å°P3ï¼å¶å®æå¡å¨åæªæ¶å°P3\n * ç±äºAå·²åå¥C1ãC2ï¼è¯´æå®å·²ç»CommitäºP1ãP2ï¼å æ­¤æ´ä¸ªéç¾¤æè¶è¿ä¸åçæå¡å¨ï¼å³æå°ä¸ä¸ªæå¡å¨æ¶å°P1ãP2ãå¨è¿éæææå¡å¨é½æ¶å°äºP1ï¼é¤Eå¤å¶å®æå¡å¨ä¹é½æ¶å°äºP2\n\n\n# 2ãéåºæ°Leader\n\næ§Leaderä¹å³Aå®æºåï¼å¶å®æå¡å¨æ ¹æ®ä¸è¿°FastLeaderElectionç®æ³éåºBä½ä¸ºæ°çLeaderãCãDåEæä¸ºFollowerä¸ä»¥Bä¸ºLeaderåï¼ä¼ä¸»å¨å°èªå·±æå¤§çzxidåéç»Bï¼Bä¼å°Followerçzxidä¸èªèº«zxidé´çææè¢«Commitè¿çæ¶æ¯åæ­¥ç»Followerï¼å¦ä¸å¾æç¤ºã\n\nå¨ä¸å¾ä¸­ï¼\n\n * P1åP2é½è¢«A Commitï¼å æ­¤Bä¼éè¿åæ­¥ä¿è¯P1ãP2ãC1ä¸C2é½å­å¨äºCãDåEä¸­\n * P3ç±äºæªè¢«A Commitï¼åæ¶å¹¸å­çæææå¡å¨ä¸­P3æªå­å¨äºå¤§å¤æ°æ®æå¡å¨ä¸­ï¼å æ­¤å®ä¸ä¼è¢«åæ­¥å°å¶å®Follower\n\n\n# 3ãéç¥Followerå¯å¯¹å¤æå¡\n\nåæ­¥å®æ°æ®åï¼Bä¼åDãCåEåéNEWLEADERå½ä»¤å¹¶ç­å¾å¤§å¤æ°æå¡å¨çACKï¼ä¸å¾ä¸­DåEå·²è¿åACKï¼å ä¸Bèªèº«ï¼å·²ç»å éç¾¤çå¤§å¤æ°ï¼ï¼ç¶ååæææå¡å¨å¹¿æ­UPTODATEå½ä»¤ãæ¶å°è¯¥å½ä»¤åçæå¡å¨å³å¯å¯¹å¤æä¾æå¡ã\n\n\n# æªCommitè¿çæ¶æ¯å¯¹å®¢æ·ç«¯ä¸å¯è§\n\nå¨ä¸ä¾ä¸­ï¼P3æªè¢«A Commitè¿ï¼åæ¶å ä¸ºæ²¡æè¿åçæå¡å¨æ¶å°P3ï¼å æ­¤Bä¹æªCommit P3ï¼å¦ææè¿åæå¡å¨æ¶å°P3ï¼å³ä½¿AæªCommit P3ï¼Bä¼ä¸»å¨Commit P3ï¼å³C3ï¼ï¼æä»¥å®ä¸ä¼å°P3å¹¿æ­åºå»ã\n\nå·ä½åæ³æ¯ï¼Bå¨æä¸ºLeaderåï¼åå¤æ­èªèº«æªCommitçæ¶æ¯ï¼æ¬ä¾ä¸­å³P3ï¼æ¯å¦å­å¨äºå¤§å¤æ°æå¡å¨ä¸­ä»èå³å®æ¯å¦è¦å°å¶Commitãç¶åBå¯å¾åºèªèº«æåå«çè¢«Commitè¿çæ¶æ¯ä¸­çæå°zxidï¼è®°ä¸ºmin_zxidï¼ä¸æå¤§zxidï¼è®°ä¸ºmax_zxidï¼ãCãDåEåBåéèªèº«Commitè¿çæå¤§æ¶æ¯zxidï¼è®°ä¸ºmax_zxidï¼ä»¥åæªè¢«Commitè¿çæææ¶æ¯ï¼è®°ä¸ºzxid_setï¼ãBæ ¹æ®è¿äºä¿¡æ¯ä½åºå¦ä¸æä½ï¼\n\n * å¦æFollowerçmax_zxidä¸Leaderçmax_zxidç¸ç­ï¼è¯´æè¯¥Followerä¸Leaderå®å¨åæ­¥ï¼æ é¡»åæ­¥ä»»ä½æ°æ®\n * å¦æFollowerçmax_zxidå¨Leaderç(min_zxidï¼max_zxid)èå´åï¼Leaderä¼éè¿TRUNCå½ä»¤éç¥Followerå°å¶zxid_setä¸­å¤§äºFollowerçmax_zxidï¼å¦ææï¼çæææ¶æ¯å¨é¨å é¤\n\nä¸è¿°æä½ä¿è¯äºæªè¢«Commitè¿çæ¶æ¯ä¸ä¼è¢«Commitä»èå¯¹å¤ä¸å¯è§ã\n\nä¸è¿°ä¾å­ä¸­Followerä¸å¹¶ä¸å­å¨æªè¢«Commitçæ¶æ¯ãä½å¯èèè¿ç§æåµï¼å¦æå°ä¸è¿°ä¾å­ä¸­çæå¡å¨æ°éä»äºå¢å å°ä¸ï¼æå¡å¨Fåå«P1ãP2ãC1ãP3ï¼æå¡å¨Gåå«P1ãP2ãæ­¤æ¶æå¡å¨FãAåBé½åå«P3ï¼ä½æ¯å ä¸ºç¥¨æ°æªè¿åï¼å æ­¤Bä½ä¸ºLeaderä¸ä¼Commit P3ï¼èä¼éè¿TRUNCå½ä»¤éç¥Få é¤P3ãå¦ä¸å¾æç¤ºã\n\n\n\n\n# æ¬èæ»ç»\n\n * ç±äºä½¿ç¨ä¸»ä»å¤å¶æ¨¡å¼ï¼ææçåæä½é½è¦ç±Leaderä¸»å¯¼å®æï¼èè¯»æä½å¯éè¿ä»»æèç¹å®æï¼å æ­¤ZooKeeperè¯»æ§è½è¿å¥½äºåæ§è½ï¼æ´éåè¯»å¤åå°çåºæ¯\n * è½ç¶ä½¿ç¨ä¸»ä»å¤å¶æ¨¡å¼ï¼åä¸æ¶é´åªæä¸ä¸ªLeaderï¼ä½æ¯Failoveræºå¶ä¿è¯äºéç¾¤ä¸å­å¨åç¹å¤±è´¥ï¼SPOFï¼çé®é¢\n * ZABåè®®ä¿è¯äºFailoverè¿ç¨ä¸­çæ°æ®ä¸è´æ§\n * æå¡å¨æ¶å°æ°æ®åååæ¬å°æä»¶åè¿è¡å¤çï¼ä¿è¯äºæ°æ®çæä¹æ§\n\n\n# åºäºZooKeeperçåå¸å¼éä¸é¢å¯¼éä¸¾\n\næ¬èå°ç»åå®ä¾æ¼ç¤ºäºä½¿ç¨ZooKeeperå®ç°åå¸å¼éä¸é¢å¯¼éä¸¾çåçä¸å·ä½å®ç°æ¹æ³ã\n\n\n# ZooKeeperèç¹ç±»å\n\nZooKeeper æä¾äºä¸ä¸ªç±»ä¼¼äº Linux æä»¶ç³»ç»çæ å½¢ç»æãè¯¥æ å½¢ç»æä¸­æ¯ä¸ªèç¹è¢«ç§°ä¸º znode ï¼å¯æå¦ä¸ä¸¤ä¸ªç»´åº¦åç±»ï¼\n\n1ãPersist vs. Ephemeral\n\n * Persistèç¹ï¼ä¸æ¦è¢«åå»ºï¼ä¾¿ä¸ä¼æå¤ä¸¢å¤±ï¼å³ä½¿æå¡å¨å¨é¨éå¯ä¹ä¾ç¶å­å¨ãæ¯ä¸ª Persist èç¹å³å¯åå«æ°æ®ï¼ä¹å¯åå«å­èç¹\n * Ephemeralèç¹ï¼å¨åå»ºå®çå®¢æ·ç«¯ä¸æå¡å¨é´ç Session ç»ææ¶èªå¨è¢«å é¤ãæå¡å¨éå¯ä¼å¯¼è´ Session ç»æï¼å æ­¤ Ephemeral ç±»åç znode æ­¤æ¶ä¹ä¼èªå¨å é¤\n\n2ãSequence vs. Non-sequence\n\n * Non-sequenceèç¹ï¼å¤ä¸ªå®¢æ·ç«¯åæ¶åå»ºåä¸ Non-sequence èç¹æ¶ï¼åªæä¸ä¸ªå¯åå»ºæåï¼å¶å®åå¤±è´¥ãå¹¶ä¸åå»ºåºçèç¹åç§°ä¸åå»ºæ¶æå®çèç¹åå®å¨ä¸æ ·\n * Sequenceèç¹ï¼åå»ºåºçèç¹åå¨æå®çåç§°ä¹åå¸¦æ10ä½10è¿å¶æ°çåºå·ãå¤ä¸ªå®¢æ·ç«¯åå»ºåä¸åç§°çèç¹æ¶ï¼é½è½åå»ºæåï¼åªæ¯åºå·ä¸å\n\n\n# ZooKeeperè¯­ä¹ä¿è¯\n\nZooKeeperç®åé«æï¼åæ¶æä¾å¦ä¸è¯­ä¹ä¿è¯ï¼ä»èä½¿å¾æä»¬å¯ä»¥å©ç¨è¿äºç¹æ§æä¾å¤æçæå¡ã\n\n * é¡ºåºæ§ï¼å®¢æ·ç«¯åèµ·çæ´æ°ä¼æåéé¡ºåºè¢«åºç¨å° ZooKeeper ä¸\n * åå­æ§ï¼æ´æ°æä½è¦ä¹æåè¦ä¹å¤±è´¥ï¼ä¸ä¼åºç°ä¸­é´ç¶æ\n * åä¸ç³»ç»éåï¼ä¸ä¸ªå®¢æ·ç«¯æ è®ºè¿æ¥å°åªä¸ä¸ªæå¡å¨é½è½çå°å®å¨ä¸æ ·çç³»ç»éåï¼å³å®å¨ä¸æ ·çæ å½¢ç»æï¼ãæ³¨ï¼æ ¹æ®ä¸æãZooKeeperæ¶æåFastLeaderElectionæºå¶ãä»ç»ç ZAB åè®®ï¼åæä½å¹¶ä¸ä¿è¯æ´æ°è¢«ææç Follower ç«å³ç¡®è®¤ï¼å æ­¤éè¿é¨å Follower è¯»åæ°æ®å¹¶ä¸è½ä¿è¯è¯»å°ææ°çæ°æ®ï¼èé¨å Follwer å Leader å¯è¯»å°ææ°æ°æ®ãå¦æä¸å®è¦ä¿è¯åä¸ç³»ç»éåï¼å¯å¨è¯»æä½åä½¿ç¨ sync æ¹æ³ã\n * å¯é æ§ï¼ä¸ä¸ªæ´æ°æä½ä¸æ¦è¢«æ¥åå³ä¸ä¼æå¤ä¸¢å¤±ï¼é¤éè¢«å¶å®æ´æ°æä½è¦ç\n * æç»ä¸è´æ§ï¼åæä½æç»ï¼èéç«å³ï¼ä¼å¯¹å®¢æ·ç«¯å¯è§\n\n\n# ZooKeeper Watchæºå¶\n\nææå¯¹ ZooKeeper çè¯»æä½ï¼é½å¯éå¸¦ä¸ä¸ª Watch ãä¸æ¦ç¸åºçæ°æ®æååï¼è¯¥ Watch å³è¢«è§¦åã\n\nWatch æå¦ä¸ç¹ç¹ï¼\n\n * ä¸»å¨æ¨éï¼Watchè¢«è§¦åæ¶ï¼ç± ZooKeeper æå¡å¨ä¸»å¨å°æ´æ°æ¨éç»å®¢æ·ç«¯ï¼èä¸éè¦å®¢æ·ç«¯è½®è¯¢ã\n * ä¸æ¬¡æ§ï¼æ°æ®ååæ¶ï¼Watch åªä¼è¢«è§¦åä¸æ¬¡ãå¦æå®¢æ·ç«¯æ³å¾å°åç»­æ´æ°çéç¥ï¼å¿é¡»è¦å¨ Watch è¢«è§¦ååéæ°æ³¨åä¸ä¸ª Watchã\n * å¯è§æ§ï¼å¦æä¸ä¸ªå®¢æ·ç«¯å¨è¯»è¯·æ±ä¸­éå¸¦ Watchï¼Watch è¢«è§¦åçåæ¶åæ¬¡è¯»åæ°æ®ï¼å®¢æ·ç«¯å¨å¾å° Watch æ¶æ¯ä¹åè¯å®ä¸å¯è½çå°æ´æ°åçæ°æ®ãæ¢å¥è¯è¯´ï¼æ´æ°éç¥åäºæ´æ°ç»æã\n * é¡ºåºæ§ï¼å¦æå¤ä¸ªæ´æ°è§¦åäºå¤ä¸ª Watch ï¼é£ Watch è¢«è§¦åçé¡ºåºä¸æ´æ°é¡ºåºä¸è´ã\n\n\n# åå¸å¼éä¸é¢å¯¼éä¸¾å³é®ç¹\n\n1ãæå¤ä¸ä¸ªè·åé / æä¸ºLeader\n\nå¯¹äºåå¸å¼éï¼è¿éç¹ææå®éï¼èè¨ï¼ä»»ææ¶å»ï¼æå¤åªæä¸ä¸ªè¿ç¨ï¼å¯¹äºåè¿ç¨åçéèè¨æ¯åçº¿ç¨ï¼å¯ä»¥è·å¾éã\n\nå¯¹äºé¢å¯¼éä¸¾èè¨ï¼ä»»ææ¶é´ï¼æå¤åªæä¸ä¸ªæåå½éä¸ºLeaderãå¦åå³åºç°èè£ï¼Split brainï¼\n\n2ãééå¥ / ç¡®è®¤èªå·±æ¯Leader\n\nå¯¹äºåå¸å¼éï¼éè¦ä¿è¯è·å¾éçè¿ç¨å¨éæ¾éä¹åå¯åæ¬¡è·å¾éï¼å³éçå¯éå¥æ§ã\n\nå¯¹äºé¢å¯¼éä¸¾ï¼Leaderéè¦è½å¤ç¡®è®¤èªå·±å·²ç»è·å¾é¢å¯¼æï¼å³ç¡®è®¤èªå·±æ¯Leaderã\n\n3ãéæ¾é / æ¾å¼é¢å¯¼æ\n\néçè·å¾èåºè¯¥è½å¤æ­£ç¡®éæ¾å·²ç»è·å¾çéï¼å¹¶ä¸å½è·å¾éçè¿ç¨å®æºæ¶ï¼éåºè¯¥èªå¨éæ¾ï¼ä»èä½¿å¾å¶å®ç«äºæ¹å¯ä»¥è·å¾è¯¥éï¼ä»èé¿ååºç°æ­»éçç¶æã\n\né¢å¯¼åºè¯¥å¯ä»¥ä¸»å¨æ¾å¼é¢å¯¼æï¼å¹¶ä¸å½é¢å¯¼æå¨è¿ç¨å®æºæ¶ï¼é¢å¯¼æåºè¯¥èªå¨éæ¾ï¼ä»èä½¿å¾å¶å®åä¸èå¯éæ°ç«äºé¢å¯¼èé¿åè¿å¥æ ä¸»ç¶æã\n\n4ãæç¥ééæ¾ / é¢å¯¼æçæ¾å¼\n\nå½è·å¾éçä¸æ¹éæ¾éæ¶ï¼å¶å®å¯¹äºéçç«äºæ¹éè¦è½å¤æç¥å°éçéæ¾ï¼å¹¶åæ¬¡å°è¯è·åéã\n\nåæ¥çLeaderæ¾å¼é¢å¯¼ææ¶ï¼å¶å®åä¸æ¹åºè¯¥è½å¤æç¥è¯¥äºä»¶ï¼å¹¶éæ°åèµ·éä¸¾æµç¨ã\n\n\n# éå¬å¹³é¢å¯¼éä¸¾\n\nä»ä¸é¢å ä¸ªæ¹é¢å¯è§ï¼åå¸å¼éä¸é¢å¯¼éä¸¾çææ¯è¦ç¹éå¸¸ç¸ä¼¼ï¼å®éä¸å¶å®ç°æºå¶ä¹ç¸è¿ãè¿éä»¥é¢å¯¼éä¸¾ä¸ºä¾æ¥è¯´æäºèçå®ç°åçï¼åå¸å¼éçå®ç°åçä¹å ä¹ä¸è´ã\n\n1ãéä¸»è¿ç¨\n\nåè®¾æä¸ä¸ªZooKeeperçå®¢æ·ç«¯ï¼å¦ä¸å¾æç¤ºï¼åæ¶ç«äºLeaderãè¿ä¸ä¸ªå®¢æ·ç«¯åæ¶åZooKeeperéç¾¤æ³¨åEphemeralä¸Non-sequenceç±»åçèç¹ï¼è·¯å¾é½ä¸º /zkroot/leaderï¼å·¥ç¨å®è·µä¸­ï¼è·¯å¾åå¯èªå®ä¹ï¼ã\n\nå¦ä¸å¾æç¤ºï¼ç±äºæ¯Non-sequenceèç¹ï¼è¿ä¸ä¸ªå®¢æ·ç«¯åªä¼æä¸ä¸ªåå»ºæåï¼å¶å®èç¹ååå»ºå¤±è´¥ãæ­¤æ¶ï¼åå»ºæåçå®¢æ·ç«¯ï¼å³ä¸å¾ä¸­çClient 1ï¼å³æåç«éä¸º Leader ãå¶å®å®¢æ·ç«¯ï¼å³ä¸å¾ä¸­çClient 2åClient 3ï¼æ­¤æ¶åä¸º Followerã\n\n2ãæ¾å¼é¢å¯¼æ\n\nå¦æ Leader æç®ä¸»å¨æ¾å¼é¢å¯¼æï¼ç´æ¥å é¤ /zkroot/leader èç¹å³å¯ã\n\nå¦æ Leader è¿ç¨æå¤å®æºï¼å¶ä¸ ZooKeeper é´ç Session ä¹ç»æï¼è¯¥èç¹ç±äºæ¯Ephemeralç±»åçèç¹ï¼å æ­¤ä¹ä¼èªå¨è¢«å é¤ã\n\næ­¤æ¶ /zkroot/leader èç¹ä¸å¤å­å¨ï¼å¯¹äºå¶å®åä¸ç«éçå®¢æ·ç«¯èè¨ï¼ä¹åç Leader å·²ç»æ¾å¼äºé¢å¯¼æã\n\n3ãæç¥é¢å¯¼æçæ¾å¼\n\nç±ä¸å¾å¯è§ï¼åå»ºèç¹å¤±è´¥çèç¹ï¼é¤äºæä¸º Follower ä»¥å¤ï¼è¿ä¼å /zkroot/leader æ³¨åä¸ä¸ª Watch ï¼ä¸æ¦ Leader æ¾å¼é¢å¯¼æï¼ä¹å³è¯¥èç¹è¢«å é¤ï¼ææç Follower ä¼æ¶å°éç¥ã\n\n4ãéæ°éä¸¾\n\næç¥å°æ§ Leader æ¾å¼é¢å¯¼æåï¼ææç Follower å¯ä»¥åæ¬¡åèµ·æ°ä¸è½®çé¢å¯¼éä¸¾ï¼å¦ä¸å¾æç¤ºã\n\nä»ä¸å¾ä¸­å¯è§ï¼\n\n * æ°ä¸è½®çé¢å¯¼éä¸¾æ¹æ³ä¸æåçé¢å¯¼éä¸¾æ¹æ³å®å¨ä¸æ ·ï¼é½æ¯åèµ·èç¹åå»ºè¯·æ±ï¼åå»ºæåå³ä¸º Leaderï¼å¦åä¸º Follower ï¼ä¸ Follower ä¼ Watch è¯¥èç¹\n * æ°ä¸è½®çéä¸¾ç»æï¼æ æ³é¢æµï¼ä¸å®ä»¬å¨ç¬¬ä¸è½®éä¸¾ä¸­çé¡ºåºæ å³ãè¿ä¹æ¯è¯¥æ¹æ¡è¢«ç§°ä¸ºéå¬å¹³æ¨¡å¼çåå \n\nå°ç»\n\n 1. éå¬å¹³æ¨¡å¼å®ç°ç®åï¼æ¯ä¸è½®éä¸¾æ¹æ³é½å®å¨ä¸æ ·\n 2. ç«äºåä¸æ¹ä¸å¤çæåµä¸ï¼æçé«ãæ¯ä¸ª Follower éè¿ Watch æç¥å°èç¹è¢«å é¤çæ¶é´ä¸å®å¨ä¸æ ·ï¼åªè¦æä¸ä¸ª Follower å¾å°éç¥å³åèµ·ç«éï¼å³å¯ä¿è¯å½æ¶ææ°ç Leader è¢«éåº\n 3. ç»ZooKeeper éç¾¤é æçè´è½½å¤§ï¼å æ­¤æ©å±æ§å·®ãå¦ææä¸ä¸ä¸ªå®¢æ·ç«¯é½åä¸ç«éï¼æå³çåæ¶ä¼æä¸ä¸ä¸ªåè¯·æ±åéç» Zookeperãå¦ãZooKeeperæ¶æãä¸ææè¿°ï¼ZooKeeper å­å¨åç¹åçé®é¢ï¼åæ§è½ä¸é«ãåæ¶ä¸æ¦ Leader æ¾å¼é¢å¯¼æï¼ZooKeeper éè¦åæ¶éç¥ä¸ä¸ä¸ª Followerï¼è´è½½è¾å¤§ã\n\n\n# å¬å¹³é¢å¯¼éä¸¾\n\n1ãéä¸»è¿ç¨\n\nå¦ä¸å¾æç¤ºï¼å¬å¹³é¢å¯¼éä¸¾ä¸­ï¼åå®¢æ·ç«¯ååå»º /zkroot/leader èç¹ï¼ä¸å¶ç±»åä¸ºEphemeralä¸Sequenceã\n\nç±äºæ¯Sequenceç±»åèç¹ï¼æä¸å¾ä¸­ä¸ä¸ªå®¢æ·ç«¯ååå»ºæåï¼åªæ¯åºå·ä¸ä¸æ ·ãæ­¤æ¶ï¼æ¯ä¸ªå®¢æ·ç«¯é½ä¼å¤æ­èªå·±åå»ºæåçèç¹çåºå·æ¯ä¸æ¯å½åæå°çãå¦ææ¯ï¼åè¯¥å®¢æ·ç«¯ä¸º Leaderï¼å¦åå³ä¸º Followerã\n\nå¨ä¸å¾ä¸­ï¼Client 1åå»ºçèç¹åºå·ä¸º 1 ï¼Client 2åå»ºçèç¹åºå·ä¸º 2ï¼Client 3åå»ºçèç¹åºå·ä¸º3ãç±äºæå°åºå·ä¸º 1 ï¼ä¸è¯¥èç¹ç±Client 1åå»ºï¼æClient 1ä¸º Leader ã\n\n2ãæ¾å¼é¢å¯¼æ\n\nLeader å¦æä¸»å¨æ¾å¼é¢å¯¼æï¼ç´æ¥å é¤å¶åå»ºçèç¹å³å¯ã\n\nå¦æ Leader æå¨è¿ç¨æå¤å®æºï¼å¶ä¸ ZooKeeper é´ç Session ç»æï¼ç±äºå¶åå»ºçèç¹ä¸ºEphemeralç±»åï¼æè¯¥èç¹èªå¨è¢«å é¤ã\n\n3ãæç¥é¢å¯¼æçæ¾å¼\n\nä¸éå¬å¹³æ¨¡å¼ä¸åï¼æ¯ä¸ª Follower å¹¶éé½ Watch ç± Leader åå»ºåºæ¥çèç¹ï¼èæ¯ Watch åºå·åå¥½æ¯èªå·±åºå·å°çèç¹ã\n\nå¨ä¸å¾ä¸­ï¼æ»å±æ 1ã2ã3 å±ä¸ä¸ªèç¹ï¼å æ­¤Client 2 Watch /zkroot/leader1ï¼Client 3 Watch /zkroot/leader2ãï¼æ³¨ï¼åºå·åºè¯¥æ¯10ä½æ°å­ï¼èéä¸ä½æ°å­ï¼è¿éä¸ºäºæ¹ä¾¿ï¼ä»¥ä¸ä½æ°å­ä»£æ¿ï¼\n\nä¸æ¦ Leader å®æºï¼/zkroot/leader1 è¢«å é¤ï¼Client 2å¯å¾å°éç¥ãæ­¤æ¶Client 3ç±äº Watch çæ¯ /zkroot/leader2 ï¼æä¸ä¼å¾å°éç¥ã\n\n\n# éæ°éä¸¾\n\néæ°éä¸¾Client 2å¾å° /zkroot/leader1 è¢«å é¤çéç¥åï¼ä¸ä¼ç«å³æä¸ºæ°ç Leader ãèæ¯åå¤æ­èªå·±çåºå· 2 æ¯ä¸æ¯å½åæå°çåºå·ãå¨è¯¥åºæ¯ä¸ï¼å¶åºå·ç¡®ä¸ºæå°ãå æ­¤Client 2æä¸ºæ°ç Leader ã\n\nè¿éè¦æ³¨æï¼å¦æå¨Client 1æ¾å¼é¢å¯¼æä¹åï¼Client 2å°±å®æºäºï¼Client 3ä¼æ¶å°éç¥ãæ­¤æ¶Client 3ä¸ä¼ç«å³æä¸ºLeaderï¼èæ¯è¦åå¤æ­èªå·±çåºå· 3 æ¯å¦ä¸ºå½åæå°åºå·ãå¾æ¾ç¶ï¼ç±äºClient 1åå»ºç /zkroot/leader1 è¿å¨ï¼å æ­¤Client 3ä¸ä¼æä¸ºæ°ç Leader ï¼å¹¶åClient 2åºå· 2 åé¢çåºå·ï¼ä¹å³ 1 åå»º Watchãè¯¥è¿ç¨å¦ä¸å¾æç¤ºã\n\nå°ç»\n\n 1. å®ç°ç¸å¯¹å¤æï¼\n 2. æ©å±æ§å¥½ï¼æ¯ä¸ªå®¢æ·ç«¯é½åª Watch ä¸ä¸ªèç¹ä¸æ¯æ¬¡èç¹è¢«å é¤åªé¡»éç¥ä¸ä¸ªå®¢æ·ç«¯ï¼\n 3. æ§ Leader æ¾å¼é¢å¯¼ææ¶ï¼å¶å®å®¢æ·ç«¯æ ¹æ®ç«éçååé¡ºåºï¼ä¹å³èç¹åºå·ï¼æä¸ºæ° Leaderï¼è¿ä¹æ¯å¬å¹³æ¨¡å¼çç±æ¥ï¼\n 4. å»¶è¿ç¸å¯¹éå¬å¹³æ¨¡å¼è¦é«ï¼å ä¸ºå®å¿é¡»ç­å¾ç¹å®èç¹å¾å°éç¥æè½éåºæ°ç Leaderã\n\n[]: https://mp.weixin.qq.com/s?__biz=MzkwOTIxNDQ3OA==&mid=2247533392&idx=1&sn=8999e64a05cd06dfa63c0c3ecd3a806f&source=41#wechat_redirect",normalizedContent:"ä½èä»ç»\n\n**é­ä¿ï¼**ä¸æ³¨äºå¤§æ°æ®æ¶æï¼çækafkaåflumeæºç ï¼çæhadoopåsparkåçï¼ç²¾éæ°æ®ï¼ä»ï¼åºæ¨¡åè®¾è®¡åsqlè°ä¼ãå¬ä¼å·ï¼å¤§æ°æ®æ¶æï¼åå®¢ï¼http://www.jasongj.com/ï¼\n\næ¬æç»ä½èææè½¬è½½ï¼ç¦æ­¢äºæ¬¡è½¬è½½ã\n\næ¬èå°ä»ç»zookeeperçæ¶æï¼å¹¶ç»åå®ä¾åæåå­å¹¿æ­(zab)åè®®çåçï¼åæ¬ä½ä¸éäºzookeeperçè¯»åæµç¨ï¼fastleaderelectionç®æ³çåçï¼zabå¦ä½ä¿è¯leader failoverè¿ç¨ä¸­çæ°æ®ä¸è´æ§ã\n\n\n# zookeeperæ¯ä»ä¹\n\nzookeeperæ¯ä¸ä¸ªåå¸å¼åè°æå¡ï¼å¯ç¨äºæå¡åç°ãåå¸å¼éãåå¸å¼é¢å¯¼éä¸¾ãéç½®ç®¡çç­ã\n\nè¿ä¸åçåºç¡ï¼é½æ¯zookeeperæä¾äºä¸ä¸ªç±»ä¼¼äºlinuxæä»¶ç³»ç»çæ å½¢ç»æï¼å¯è®¤ä¸ºæ¯è½»éçº§çåå­æä»¶ç³»ç»ï¼ä½åªéåå­å°éä¿¡æ¯ï¼å®å¨ä¸éåå­å¨å¤§éæä»¶æèå¤§æä»¶ï¼ï¼åæ¶æä¾äºå¯¹äºæ¯ä¸ªèç¹ççæ§ä¸éç¥æºå¶ã\n\næ¢ç¶æ¯ä¸ä¸ªæä»¶ç³»ç»ï¼å°±ä¸å¾ä¸æzookeeperæ¯å¦ä½ä¿è¯æ°æ®çä¸è´æ§çãæ¬èå°å°ä»ç»zookeeperå¦ä½ä¿è¯æ°æ®ä¸è´æ§ï¼å¦ä½è¿è¡é¢å¯¼éä¸¾ï¼ä»¥åæ°æ®çæ§/éç¥æºå¶çè¯­ä¹ä¿è¯ã\n\n\n# zookeeperæå¡å¨è§è²\n\nzookeeperéç¾¤æ¯ä¸ä¸ªåºäºä¸»ä»å¤å¶çé«å¯ç¨éç¾¤ï¼æ¯ä¸ªæå¡å¨æ¿æå¦ä¸ä¸ç§è§è²ä¸­çä¸ç§ï¼\n\n * leader ä¸ä¸ªzookeeperéç¾¤åä¸æ¶é´åªä¼æä¸ä¸ªå®éå·¥ä½çleaderï¼å®ä¼åèµ·å¹¶ç»´æ¤ä¸åfollweråobserveré´çå¿è·³ãææçåæä½å¿é¡»è¦éè¿leaderå®æåç±leaderå°åæä½å¹¿æ­ç»å¶å®æå¡å¨ã\n * follower ä¸ä¸ªzookeeperéç¾¤å¯è½åæ¶å­å¨å¤ä¸ªfollowerï¼å®ä¼ååºleaderçå¿è·³ãfollowerå¯ç´æ¥å¤çå¹¶è¿åå®¢æ·ç«¯çè¯»è¯·æ±ï¼åæ¶ä¼å°åè¯·æ±è½¬åç»leaderå¤çï¼å¹¶ä¸è´è´£å¨leaderå¤çåè¯·æ±æ¶å¯¹è¯·æ±è¿è¡æç¥¨ã\n * observer è§è²ä¸followerç±»ä¼¼ï¼ä½æ¯æ æç¥¨æã\n\n\n# åå­å¹¿æ­ï¼zabï¼\n\nä¸ºäºä¿è¯åæä½çä¸è´æ§ä¸å¯ç¨æ§ï¼zookeeperä¸é¨è®¾è®¡äºä¸ç§åä¸ºåå­å¹¿æ­ï¼zabï¼çæ¯æå´©æºæ¢å¤çä¸è´æ§åè®®ãåºäºè¯¥åè®®ï¼zookeeperå®ç°äºä¸ç§ä¸»ä»æ¨¡å¼çç³»ç»æ¶ææ¥ä¿æéç¾¤ä¸­åä¸ªå¯æ¬ä¹é´çæ°æ®ä¸è´æ§ã\n\næ ¹æ®zabåè®®ï¼ææçåæä½é½å¿é¡»éè¿leaderå®æï¼leaderåå¥æ¬å°æ¥å¿ååå¤å¶å°ææçfollowerèç¹ã\n\nä¸æ¦leaderèç¹æ æ³å·¥ä½ï¼zabåè®®è½å¤èªå¨ä»followerèç¹ä¸­éæ°éåºä¸ä¸ªåéçæ¿ä»£èï¼å³æ°çleaderï¼è¯¥è¿ç¨å³ä¸ºé¢å¯¼éä¸¾ãè¯¥é¢å¯¼éä¸¾è¿ç¨ï¼æ¯zabåè®®ä¸­æä¸ºéè¦åå¤æçè¿ç¨ã\n\n\n# 1ãåleader\n\néè¿leaderè¿è¡åæä½æµç¨å¦ä¸å¾æç¤ºï¼\n\nç±ä¸å¾å¯è§ï¼éè¿leaderè¿è¡åæä½ï¼ä¸»è¦åä¸ºäºæ­¥ï¼\n\n 1. å®¢æ·ç«¯åleaderåèµ·åè¯·æ±\n 2. leaderå°åè¯·æ±ä»¥proposalçå½¢å¼åç»ææfollowerå¹¶ç­å¾ack\n 3. followeræ¶å°leaderçproposalåè¿åack\n 4. leaderå¾å°è¿åæ°çackï¼leaderå¯¹èªå·±é»è®¤æä¸ä¸ªackï¼ååææçfolloweråobserveråécommit\n 5. leaderå°å¤çç»æè¿åç»å®¢æ·ç«¯\n\nè¿éè¦æ³¨æï¼\n\n * leaderå¹¶ä¸éè¦å¾å°observerçackï¼å³observeræ æç¥¨æ\n * leaderä¸éè¦å¾å°ææfollowerçackï¼åªè¦æ¶å°è¿åçackå³å¯ï¼åæ¶leaderæ¬èº«å¯¹èªå·±æä¸ä¸ªackãä¸å¾ä¸­æ4ä¸ªfollowerï¼åªéå¶ä¸­ä¸¤ä¸ªè¿åackå³å¯ï¼å ä¸º(2+1) / (4+1) > 1/2\n * observerè½ç¶æ æç¥¨æï¼ä½ä»é¡»åæ­¥leaderçæ°æ®ä»èå¨å¤çè¯»è¯·æ±æ¶å¯ä»¥è¿åå°½å¯è½æ°çæ°æ®\n\n\n# 2ãåfollower/observer\n\néè¿follower/observerè¿è¡åæä½æµç¨å¦ä¸å¾æç¤ºï¼\n\n\n\nä»ä¸å¾å¯è§ï¼\n\n * follower/observeråå¯æ¥ååè¯·æ±ï¼ä½ä¸è½ç´æ¥å¤çï¼èéè¦å°åè¯·æ±è½¬åç»leaderå¤ç\n * é¤äºå¤äºä¸æ­¥è¯·æ±è½¬åï¼å¶å®æµç¨ä¸ç´æ¥åleaderæ ä»»ä½åºå«\n\n\n# 3ãè¯»æä½\n\nleader/follower/observeré½å¯ç´æ¥å¤çè¯»è¯·æ±ï¼ä»æ¬å°åå­ä¸­è¯»åæ°æ®å¹¶è¿åç»å®¢æ·ç«¯å³å¯ã\n\n\n\nç±äºå¤çè¯»è¯·æ±ä¸éè¦æå¡å¨ä¹é´çäº¤äºï¼follower/observerè¶å¤ï¼æ´ä½å¯å¤ççè¯»è¯·æ±éè¶å¤§ï¼ä¹å³è¯»æ§è½è¶å¥½ã\n\n\n# æ¯æçé¢å¯¼éä¸¾ç®æ³\n\nå¯éè¿electionalgéç½®é¡¹è®¾ç½®zookeeperç¨äºé¢å¯¼éä¸¾çç®æ³ã\n\nå°3.4.10çæ¬ä¸ºæ­¢ï¼å¯éé¡¹æï¼\n\n * 0 åºäºudpçleaderelection\n * 1 åºäºudpçfastleaderelection\n * 2 åºäºudpåè®¤è¯çfastleaderelection\n * 3 åºäºtcpçfastleaderelection\n\nå¨3.4.10çæ¬ä¸­ï¼é»è®¤å¼ä¸º3ï¼ä¹å³åºäºtcpçfastleaderelectionãå¦å¤ä¸ç§ç®æ³å·²ç»è¢«å¼ç¨ï¼å¹¶ä¸æè®¡åå¨ä¹åççæ¬ä¸­å°å®ä»¬å½»åºå é¤èä¸åæ¯æã\n\n\n# fastleaderelectionåç\n\n\n# 1ãmyid\n\næ¯ä¸ªzookeeperæå¡å¨ï¼é½éè¦å¨æ°æ®æä»¶å¤¹ä¸åå»ºä¸ä¸ªåä¸ºmyidçæä»¶ï¼è¯¥æä»¶åå«æ´ä¸ªzookeeperéç¾¤å¯ä¸çidï¼æ´æ°ï¼ãä¾å¦ï¼æzookeeperéç¾¤åå«ä¸å°æå¡å¨ï¼hostnameåå«ä¸ºzoo1ãzoo2åzoo3ï¼å¶myidåå«ä¸º1ã2å3ï¼åå¨éç½®æä»¶ä¸­å¶idä¸hostnameå¿é¡»ä¸ä¸å¯¹åºï¼å¦ä¸æç¤ºãå¨è¯¥éç½®æä»¶ä¸­ï¼server.åé¢çæ°æ®å³ä¸ºmyid\n\nserver.1=zoo1:2888:3888\n\nserver.2=zoo2:2888:3888\n\nserver.3=zoo3:2888:3888\n\n\n1\n2\n3\n4\n5\n\n\n\n# 2ãzxid\n\nç±»ä¼¼äºrdbmsä¸­çäºå¡idï¼ç¨äºæ è¯ä¸æ¬¡æ´æ°æä½çproposal idãä¸ºäºä¿è¯é¡ºåºæ§ï¼è¯¥zkidå¿é¡»åè°éå¢ãå æ­¤zookeeperä½¿ç¨ä¸ä¸ª64ä½çæ°æ¥è¡¨ç¤ºï¼é«32ä½æ¯leaderçepochï¼ä»1å¼å§ï¼æ¯æ¬¡éåºæ°çleaderï¼epochå ä¸ãä½32ä½ä¸ºè¯¥epochåçåºå·ï¼æ¯æ¬¡epochååï¼é½å°ä½32ä½çåºå·éç½®ãè¿æ ·ä¿è¯äºzkidçå¨å±éå¢æ§ã\n\n\n# 3ãæå¡å¨ç¶æ\n\n * looking ä¸ç¡®å®leaderç¶æãè¯¥ç¶æä¸çæå¡å¨è®¤ä¸ºå½åéç¾¤ä¸­æ²¡æleaderï¼ä¼åèµ·leaderéä¸¾ã\n * following è·éèç¶æãè¡¨æå½åæå¡å¨è§è²æ¯followerï¼å¹¶ä¸å®ç¥éleaderæ¯è°ã\n * leading é¢å¯¼èç¶æãè¡¨æå½åæå¡å¨è§è²æ¯leaderï¼å®ä¼ç»´æ¤ä¸followeré´çå¿è·³ã\n * observing è§å¯èç¶æãè¡¨æå½åæå¡å¨è§è²æ¯observerï¼ä¸folowerå¯ä¸çä¸åå¨äºä¸åä¸éä¸¾ï¼ä¹ä¸åä¸éç¾¤åæä½æ¶çæç¥¨ã\n\n\n# 4ãéç¥¨æ°æ®ç»æ\n\næ¯ä¸ªæå¡å¨å¨è¿è¡é¢å¯¼éä¸¾æ¶ï¼ä¼åéå¦ä¸å³é®ä¿¡æ¯ï¼\n\n * logicclock æ¯ä¸ªæå¡å¨ä¼ç»´æ¤ä¸ä¸ªèªå¢çæ´æ°ï¼åä¸ºlogicclockï¼å®è¡¨ç¤ºè¿æ¯è¯¥æå¡å¨åèµ·çç¬¬å¤å°è½®æç¥¨\n * state å½åæå¡å¨çç¶æ\n * self_id å½åæå¡å¨çmyid\n * self_zxid å½åæå¡å¨ä¸æä¿å­çæ°æ®çæå¤§zxid\n * vote_id è¢«æ¨ä¸¾çæå¡å¨çmyid\n * vote_zxid è¢«æ¨ä¸¾çæå¡å¨ä¸æä¿å­çæ°æ®çæå¤§zxid\n\n\n# 5ãæç¥¨æµç¨\n\nèªå¢éä¸¾è½®æ¬¡\n\nzookeeperè§å®ææææçæç¥¨é½å¿é¡»å¨åä¸è½®æ¬¡ä¸­ãæ¯ä¸ªæå¡å¨å¨å¼å§æ°ä¸è½®æç¥¨æ¶ï¼ä¼åå¯¹èªå·±ç»´æ¤çlogicclockè¿è¡èªå¢æä½ã\n\nåå§åéç¥¨\n\næ¯ä¸ªæå¡å¨å¨å¹¿æ­èªå·±çéç¥¨åï¼ä¼å°èªå·±çæç¥¨ç®±æ¸ç©ºãè¯¥æç¥¨ç®±è®°å½äºææ¶å°çéç¥¨ãä¾ï¼æå¡å¨2æç¥¨ç»æå¡å¨3ï¼æå¡å¨3æç¥¨ç»æå¡å¨1ï¼åæå¡å¨1çæç¥¨ç®±ä¸º(2, 3), (3, 1), (1, 1)ãç¥¨ç®±ä¸­åªä¼è®°å½æ¯ä¸æç¥¨èçæåä¸ç¥¨ï¼å¦æç¥¨èæ´æ°èªå·±çéç¥¨ï¼åå¶å®æå¡å¨æ¶å°è¯¥æ°éç¥¨åä¼å¨èªå·±ç¥¨ç®±ä¸­æ´æ°è¯¥æå¡å¨çéç¥¨ã\n\nåéåå§åéç¥¨\n\næ¯ä¸ªæå¡å¨æå¼å§é½æ¯éè¿å¹¿æ­æç¥¨æç»èªå·±ã\n\næ¥æ¶å¤é¨æç¥¨\n\næå¡å¨ä¼å°è¯ä»å¶å®æå¡å¨è·åæç¥¨ï¼å¹¶è®°å¥èªå·±çæç¥¨ç®±åãå¦ææ æ³è·åä»»ä½å¤é¨æç¥¨ï¼åä¼ç¡®è®¤èªå·±æ¯å¦ä¸éç¾¤ä¸­å¶å®æå¡å¨ä¿æçææè¿æ¥ãå¦ææ¯ï¼ååæ¬¡åéèªå·±çæç¥¨ï¼å¦æå¦ï¼åé©¬ä¸ä¸ä¹å»ºç«è¿æ¥ã\n\nå¤æ­éä¸¾è½®æ¬¡\n\næ¶å°å¤é¨æç¥¨åï¼é¦åä¼æ ¹æ®æç¥¨ä¿¡æ¯ä¸­æåå«çlogicclockæ¥è¿è¡ä¸åå¤çï¼\n\n * å¤é¨æç¥¨çlogicclockå¤§äºèªå·±çlogicclockãè¯´æè¯¥æå¡å¨çéä¸¾è½®æ¬¡è½åäºå¶å®æå¡å¨çéä¸¾è½®æ¬¡ï¼ç«å³æ¸ç©ºèªå·±çæç¥¨ç®±å¹¶å°èªå·±çlogicclockæ´æ°ä¸ºæ¶å°çlogicclockï¼ç¶ååå¯¹æ¯èªå·±ä¹åçæç¥¨ä¸æ¶å°çæç¥¨ä»¥ç¡®å®æ¯å¦éè¦åæ´èªå·±çæç¥¨ï¼æç»åæ¬¡å°èªå·±çæç¥¨å¹¿æ­åºå»ã\n * å¤é¨æç¥¨çlogicclockå°äºèªå·±çlogicclockãå½åæå¡å¨ç´æ¥å¿½ç¥è¯¥æç¥¨ï¼ç»§ç»­å¤çä¸ä¸ä¸ªæç¥¨ã\n * å¤é¨æç¥¨çlogickclockä¸èªå·±çç¸ç­ãå½æ¶è¿è¡éç¥¨pkã\n\néç¥¨pk\n\néç¥¨pkæ¯åºäº(self_id, self_zxid)ä¸(vote_id, vote_zxid)çå¯¹æ¯ï¼\n\n * å¤é¨æç¥¨çlogicclockå¤§äºèªå·±çlogicclockï¼åå°èªå·±çlogicclockåèªå·±çéç¥¨çlogicclockåæ´ä¸ºæ¶å°çlogicclock\n * è¥logicclockä¸è´ï¼åå¯¹æ¯äºèçvote_zxidï¼è¥å¤é¨æç¥¨çvote_zxidæ¯è¾å¤§ï¼åå°èªå·±çç¥¨ä¸­çvote_zxidä¸vote_myidæ´æ°ä¸ºæ¶å°çç¥¨ä¸­çvote_zxidä¸vote_myidå¹¶å¹¿æ­åºå»ï¼å¦å¤å°æ¶å°çç¥¨åèªå·±æ´æ°åçç¥¨æ¾å¥èªå·±çç¥¨ç®±ãå¦æç¥¨ç®±åå·²å­å¨(self_myid, self_zxid)ç¸åçéç¥¨ï¼åç´æ¥è¦ç\n * è¥äºèvote_zxidä¸è´ï¼åæ¯è¾äºèçvote_myidï¼è¥å¤é¨æç¥¨çvote_myidæ¯è¾å¤§ï¼åå°èªå·±çç¥¨ä¸­çvote_myidæ´æ°ä¸ºæ¶å°çç¥¨ä¸­çvote_myidå¹¶å¹¿æ­åºå»ï¼å¦å¤å°æ¶å°çç¥¨åèªå·±æ´æ°åçç¥¨æ¾å¥èªå·±çç¥¨ç®±\n\nç»è®¡éç¥¨\n\nå¦æå·²ç»ç¡®å®æè¿åæå¡å¨è®¤å¯äºèªå·±çæç¥¨ï¼å¯è½æ¯æ´æ°åçæç¥¨ï¼ï¼åç»æ­¢æç¥¨ãå¦åç»§ç»­æ¥æ¶å¶å®æå¡å¨çæç¥¨ã\n\næ´æ°æå¡å¨ç¶æ\n\næç¥¨ç»æ­¢åï¼æå¡å¨å¼å§æ´æ°èªèº«ç¶æãè¥è¿åçç¥¨æç»äºèªå·±ï¼åå°èªå·±çæå¡å¨ç¶ææ´æ°ä¸ºleadingï¼å¦åå°èªå·±çç¶ææ´æ°ä¸ºfollowingã\n\n\n# éç¾¤å¯å¨é¢å¯¼éä¸¾\n\n\n# 1ãåå§æç¥¨ç»èªå·±\n\néç¾¤åå¯å¨æ¶ï¼æææå¡å¨çlogicclocké½ä¸º1ï¼zxidé½ä¸º0ãåæå¡å¨åå§ååï¼é½æç¥¨ç»èªå·±ï¼å¹¶å°èªå·±çä¸ç¥¨å­å¥èªå·±çç¥¨ç®±ï¼å¦ä¸å¾æç¤ºã\n\nå¨ä¸å¾ä¸­ï¼(1, 1, 0)ç¬¬ä¸ä½æ°ä»£è¡¨æåºè¯¥éç¥¨çæå¡å¨çlogicclockï¼ç¬¬äºä½æ°ä»£è¡¨è¢«æ¨èçæå¡å¨çmyidï¼ç¬¬ä¸ä½ä»£è¡¨è¢«æ¨èçæå¡å¨çæå¤§çzxidãç±äºè¯¥æ­¥éª¤ä¸­ææéç¥¨é½æç»èªå·±ï¼æä»¥ç¬¬äºä½çmyidå³æ¯èªå·±çmyidï¼ç¬¬ä¸ä½çzxidå³æ¯èªå·±çzxidã\n\næ­¤æ¶åèªçç¥¨ç®±ä¸­åªæèªå·±æç»èªå·±çä¸ç¥¨ã\n\n\n# 2ãæ´æ°éç¥¨\n\næå¡å¨æ¶å°å¤é¨æç¥¨åï¼è¿è¡éç¥¨pkï¼ç¸åºæ´æ°èªå·±çéç¥¨å¹¶å¹¿æ­åºå»ï¼å¹¶å°åéçéç¥¨å­å¥èªå·±çç¥¨ç®±ï¼å¦ä¸å¾æç¤ºã\n\næå¡å¨1æ¶å°æå¡å¨2çéç¥¨ï¼1, 2, 0ï¼åæå¡å¨3çéç¥¨ï¼1, 3, 0ï¼åï¼ç±äºææçlogicclocké½ç¸ç­ï¼ææçzxidé½ç¸ç­ï¼å æ­¤æ ¹æ®myidå¤æ­åºè¯¥å°èªå·±çéç¥¨æç§æå¡å¨3çéç¥¨æ´æ°ä¸ºï¼1, 3, 0ï¼ï¼å¹¶å°èªå·±çç¥¨ç®±å¨é¨æ¸ç©ºï¼åå°æå¡å¨3çéç¥¨ä¸èªå·±çéç¥¨å­å¥èªå·±çç¥¨ç®±ï¼æ¥çå°èªå·±æ´æ°åçéç¥¨å¹¿æ­åºå»ãæ­¤æ¶æå¡å¨1ç¥¨ç®±åçéç¥¨ä¸º(1, 3)ï¼(3, 3)ã\n\nåçï¼æå¡å¨2æ¶å°æå¡å¨3çéç¥¨åä¹å°èªå·±çéç¥¨æ´æ°ä¸ºï¼1, 3, 0ï¼å¹¶å­å¥ç¥¨ç®±ç¶åå¹¿æ­ãæ­¤æ¶æå¡å¨2ç¥¨ç®±åçéç¥¨ä¸º(2, 3)ï¼(3, ,3)ã\n\næå¡å¨3æ ¹æ®ä¸è¿°è§åï¼æ é¡»æ´æ°éç¥¨ï¼èªèº«çç¥¨ç®±åéç¥¨ä»ä¸ºï¼3, 3ï¼ã\n\næå¡å¨1ä¸æå¡å¨2æ´æ°åçéç¥¨å¹¿æ­åºå»åï¼ç±äºä¸ä¸ªæå¡å¨ææ°éç¥¨é½ç¸åï¼æåä¸èçç¥¨ç®±åé½åå«ä¸å¼ æç»æå¡å¨3çéç¥¨ã\n\n\n# 3ãæ ¹æ®éç¥¨ç¡®å®è§è²\n\næ ¹æ®ä¸è¿°éç¥¨ï¼ä¸ä¸ªæå¡å¨ä¸è´è®¤ä¸ºæ­¤æ¶æå¡å¨3åºè¯¥æ¯leaderãå æ­¤æå¡å¨1å2é½è¿å¥followingç¶æï¼èæå¡å¨3è¿å¥leadingç¶æãä¹åleaderåèµ·å¹¶ç»´æ¤ä¸followeré´çå¿è·³ã\n\n\n# followeréå¯éä¸¾\n\n\n# 1ãfolloweréå¯æç¥¨ç»èªå·±\n\nfolloweréå¯ï¼æèåçç½ç»ååºåæ¾ä¸å°leaderï¼ä¼è¿å¥lookingç¶æå¹¶åèµ·æ°çä¸è½®æç¥¨ã\n\n\n# 2ãåç°å·²æleaderåæä¸ºfollower\n\næå¡å¨3æ¶å°æå¡å¨1çæç¥¨åï¼å°èªå·±çç¶æleadingä»¥åéç¥¨è¿åç»æå¡å¨1ãæå¡å¨2æ¶å°æå¡å¨1çæç¥¨åï¼å°èªå·±çç¶æfollowingåéç¥¨è¿åç»æå¡å¨1ãæ­¤æ¶æå¡å¨1ç¥éæå¡å¨3æ¯leaderï¼å¹¶ä¸éè¿æå¡å¨2ä¸æå¡å¨3çéç¥¨å¯ä»¥ç¡®å®æå¡å¨3ç¡®å®å¾å°äºè¶è¿åæ°çéç¥¨ãå æ­¤æå¡å¨1è¿å¥followingç¶æã\n\n\n# leaderéå¯éä¸¾\n\n\n# 1ãfolloweråèµ·æ°æç¥¨\n\nleaderï¼æå¡å¨3ï¼å®æºåï¼followerï¼æå¡å¨1å2ï¼åç°leaderä¸å·¥ä½äºï¼å æ­¤è¿å¥lookingç¶æå¹¶åèµ·æ°çä¸è½®æç¥¨ï¼å¹¶ä¸é½å°ç¥¨æç»èªå·±ã\n\n\n# 2ãå¹¿æ­æ´æ°éç¥¨\n\næå¡å¨1å2æ ¹æ®å¤é¨æç¥¨ç¡®å®æ¯å¦è¦æ´æ°èªèº«çéç¥¨ãè¿éæä¸¤ç§æåµï¼\n\n * æå¡å¨1å2çzxidç¸åãä¾å¦å¨æå¡å¨3å®æºåæå¡å¨1ä¸2å®å¨ä¸ä¹åæ­¥ãæ­¤æ¶éç¥¨çæ´æ°ä¸»è¦åå³äºmyidçå¤§å°\n * æå¡å¨1å2çzxidä¸åãå¨æ§leaderå®æºä¹åï¼å¶æä¸»å¯¼çåæä½ï¼åªéè¿åæå¡å¨ç¡®è®¤å³å¯ï¼èä¸éæææå¡å¨ç¡®è®¤ãæ¢å¥è¯è¯´ï¼æå¡å¨1å2å¯è½ä¸ä¸ªä¸æ§leaderåæ­¥ï¼å³zxidä¸ä¹ç¸åï¼å¦ä¸ä¸ªä¸åæ­¥ï¼å³zxidæ¯ä¹å°ï¼ãæ­¤æ¶éç¥¨çæ´æ°ä¸»è¦åå³äºè°çzxidè¾å¤§\n\nå¨ä¸å¾ä¸­ï¼æå¡å¨1çzxidä¸º11ï¼èæå¡å¨2çzxidä¸º10ï¼å æ­¤æå¡å¨2å°èªèº«éç¥¨æ´æ°ä¸ºï¼3, 1, 11ï¼ï¼å¦ä¸å¾æç¤ºã\n\n\n# 3ãéåºæ°leader\n\nç»è¿ä¸ä¸æ­¥éç¥¨æ´æ°åï¼æå¡å¨1ä¸æå¡å¨2åå°éç¥¨æç»æå¡å¨1ï¼å æ­¤æå¡å¨2æä¸ºfollowerï¼èæå¡å¨1æä¸ºæ°çleaderå¹¶ç»´æ¤ä¸æå¡å¨2çå¿è·³ã\n\n\n# 4ãæ§leaderæ¢å¤ååèµ·éä¸¾\n\næ§çleaderæ¢å¤åï¼è¿å¥lookingç¶æå¹¶åèµ·æ°ä¸è½®é¢å¯¼éä¸¾ï¼å¹¶å°éç¥¨æç»èªå·±ãæ­¤æ¶æå¡å¨1ä¼å°èªå·±çleadingç¶æåéç¥¨ï¼3, 1, 11ï¼è¿åç»æå¡å¨3ï¼èæå¡å¨2å°èªå·±çfollowingç¶æåéç¥¨ï¼3, 1, 11ï¼è¿åç»æå¡å¨3ãå¦ä¸å¾æç¤ºã\n\n\n# 5ãæ§leaderæä¸ºfollower\n\næå¡å¨3äºè§£å°leaderä¸ºæå¡å¨1ï¼ä¸æ ¹æ®éç¥¨äºè§£å°æå¡å¨1ç¡®å®å¾å°è¿åæå¡å¨çéç¥¨ï¼å æ­¤èªå·±è¿å¥followingç¶æã\n\n\n# commitè¿çæ°æ®ä¸ä¸¢å¤±\n\n\n# 1ãfailoveråç¶æ\n\nä¸ºæ´å¥½æ¼ç¤ºleader failoverè¿ç¨ï¼æ¬ä¾ä¸­å±ä½¿ç¨5ä¸ªzookeeperæå¡å¨ãaä½ä¸ºleaderï¼å±æ¶å°p1ãp2ãp3ä¸æ¡æ¶æ¯ï¼å¹¶ä¸commitäº1å2ï¼ä¸æ»ä½é¡ºåºä¸ºp1ãp2ãc1ãp3ãc2ãæ ¹æ®é¡ºåºæ§ååï¼å¶å®followeræ¶å°çæ¶æ¯çé¡ºåºè¯å®ä¸ä¹ç¸åãå¶ä¸­bä¸aå®å¨åæ­¥ï¼cæ¶å°p1ãp2ãc1ï¼dæ¶å°p1ãp2ï¼eæ¶å°p1ï¼å¦ä¸å¾æç¤ºã\n\nè¿éè¦æ³¨æï¼\n\n * ç±äºaæ²¡æc3ï¼æå³çæ¶å°p3çæå¡å¨çæ»ä¸ªæ°ä¸ä¼è¶è¿ä¸åï¼ä¹å³åå«aå¨åæå¤åªæä¸¤å°æå¡å¨æ¶å°p3ãå¨è¿éaåbæ¶å°p3ï¼å¶å®æå¡å¨åæªæ¶å°p3\n * ç±äºaå·²åå¥c1ãc2ï¼è¯´æå®å·²ç»commitäºp1ãp2ï¼å æ­¤æ´ä¸ªéç¾¤æè¶è¿ä¸åçæå¡å¨ï¼å³æå°ä¸ä¸ªæå¡å¨æ¶å°p1ãp2ãå¨è¿éæææå¡å¨é½æ¶å°äºp1ï¼é¤eå¤å¶å®æå¡å¨ä¹é½æ¶å°äºp2\n\n\n# 2ãéåºæ°leader\n\næ§leaderä¹å³aå®æºåï¼å¶å®æå¡å¨æ ¹æ®ä¸è¿°fastleaderelectionç®æ³éåºbä½ä¸ºæ°çleaderãcãdåeæä¸ºfollowerä¸ä»¥bä¸ºleaderåï¼ä¼ä¸»å¨å°èªå·±æå¤§çzxidåéç»bï¼bä¼å°followerçzxidä¸èªèº«zxidé´çææè¢«commitè¿çæ¶æ¯åæ­¥ç»followerï¼å¦ä¸å¾æç¤ºã\n\nå¨ä¸å¾ä¸­ï¼\n\n * p1åp2é½è¢«a commitï¼å æ­¤bä¼éè¿åæ­¥ä¿è¯p1ãp2ãc1ä¸c2é½å­å¨äºcãdåeä¸­\n * p3ç±äºæªè¢«a commitï¼åæ¶å¹¸å­çæææå¡å¨ä¸­p3æªå­å¨äºå¤§å¤æ°æ®æå¡å¨ä¸­ï¼å æ­¤å®ä¸ä¼è¢«åæ­¥å°å¶å®follower\n\n\n# 3ãéç¥followerå¯å¯¹å¤æå¡\n\nåæ­¥å®æ°æ®åï¼bä¼ådãcåeåénewleaderå½ä»¤å¹¶ç­å¾å¤§å¤æ°æå¡å¨çackï¼ä¸å¾ä¸­dåeå·²è¿åackï¼å ä¸bèªèº«ï¼å·²ç»å éç¾¤çå¤§å¤æ°ï¼ï¼ç¶ååæææå¡å¨å¹¿æ­uptodateå½ä»¤ãæ¶å°è¯¥å½ä»¤åçæå¡å¨å³å¯å¯¹å¤æä¾æå¡ã\n\n\n# æªcommitè¿çæ¶æ¯å¯¹å®¢æ·ç«¯ä¸å¯è§\n\nå¨ä¸ä¾ä¸­ï¼p3æªè¢«a commitè¿ï¼åæ¶å ä¸ºæ²¡æè¿åçæå¡å¨æ¶å°p3ï¼å æ­¤bä¹æªcommit p3ï¼å¦ææè¿åæå¡å¨æ¶å°p3ï¼å³ä½¿aæªcommit p3ï¼bä¼ä¸»å¨commit p3ï¼å³c3ï¼ï¼æä»¥å®ä¸ä¼å°p3å¹¿æ­åºå»ã\n\nå·ä½åæ³æ¯ï¼bå¨æä¸ºleaderåï¼åå¤æ­èªèº«æªcommitçæ¶æ¯ï¼æ¬ä¾ä¸­å³p3ï¼æ¯å¦å­å¨äºå¤§å¤æ°æå¡å¨ä¸­ä»èå³å®æ¯å¦è¦å°å¶commitãç¶åbå¯å¾åºèªèº«æåå«çè¢«commitè¿çæ¶æ¯ä¸­çæå°zxidï¼è®°ä¸ºmin_zxidï¼ä¸æå¤§zxidï¼è®°ä¸ºmax_zxidï¼ãcãdåeåbåéèªèº«commitè¿çæå¤§æ¶æ¯zxidï¼è®°ä¸ºmax_zxidï¼ä»¥åæªè¢«commitè¿çæææ¶æ¯ï¼è®°ä¸ºzxid_setï¼ãbæ ¹æ®è¿äºä¿¡æ¯ä½åºå¦ä¸æä½ï¼\n\n * å¦æfollowerçmax_zxidä¸leaderçmax_zxidç¸ç­ï¼è¯´æè¯¥followerä¸leaderå®å¨åæ­¥ï¼æ é¡»åæ­¥ä»»ä½æ°æ®\n * å¦æfollowerçmax_zxidå¨leaderç(min_zxidï¼max_zxid)èå´åï¼leaderä¼éè¿truncå½ä»¤éç¥followerå°å¶zxid_setä¸­å¤§äºfollowerçmax_zxidï¼å¦ææï¼çæææ¶æ¯å¨é¨å é¤\n\nä¸è¿°æä½ä¿è¯äºæªè¢«commitè¿çæ¶æ¯ä¸ä¼è¢«commitä»èå¯¹å¤ä¸å¯è§ã\n\nä¸è¿°ä¾å­ä¸­followerä¸å¹¶ä¸å­å¨æªè¢«commitçæ¶æ¯ãä½å¯èèè¿ç§æåµï¼å¦æå°ä¸è¿°ä¾å­ä¸­çæå¡å¨æ°éä»äºå¢å å°ä¸ï¼æå¡å¨fåå«p1ãp2ãc1ãp3ï¼æå¡å¨gåå«p1ãp2ãæ­¤æ¶æå¡å¨fãaåbé½åå«p3ï¼ä½æ¯å ä¸ºç¥¨æ°æªè¿åï¼å æ­¤bä½ä¸ºleaderä¸ä¼commit p3ï¼èä¼éè¿truncå½ä»¤éç¥få é¤p3ãå¦ä¸å¾æç¤ºã\n\n\n\n\n# æ¬èæ»ç»\n\n * ç±äºä½¿ç¨ä¸»ä»å¤å¶æ¨¡å¼ï¼ææçåæä½é½è¦ç±leaderä¸»å¯¼å®æï¼èè¯»æä½å¯éè¿ä»»æèç¹å®æï¼å æ­¤zookeeperè¯»æ§è½è¿å¥½äºåæ§è½ï¼æ´éåè¯»å¤åå°çåºæ¯\n * è½ç¶ä½¿ç¨ä¸»ä»å¤å¶æ¨¡å¼ï¼åä¸æ¶é´åªæä¸ä¸ªleaderï¼ä½æ¯failoveræºå¶ä¿è¯äºéç¾¤ä¸å­å¨åç¹å¤±è´¥ï¼spofï¼çé®é¢\n * zabåè®®ä¿è¯äºfailoverè¿ç¨ä¸­çæ°æ®ä¸è´æ§\n * æå¡å¨æ¶å°æ°æ®åååæ¬å°æä»¶åè¿è¡å¤çï¼ä¿è¯äºæ°æ®çæä¹æ§\n\n\n# åºäºzookeeperçåå¸å¼éä¸é¢å¯¼éä¸¾\n\næ¬èå°ç»åå®ä¾æ¼ç¤ºäºä½¿ç¨zookeeperå®ç°åå¸å¼éä¸é¢å¯¼éä¸¾çåçä¸å·ä½å®ç°æ¹æ³ã\n\n\n# zookeeperèç¹ç±»å\n\nzookeeper æä¾äºä¸ä¸ªç±»ä¼¼äº linux æä»¶ç³»ç»çæ å½¢ç»æãè¯¥æ å½¢ç»æä¸­æ¯ä¸ªèç¹è¢«ç§°ä¸º znode ï¼å¯æå¦ä¸ä¸¤ä¸ªç»´åº¦åç±»ï¼\n\n1ãpersist vs. ephemeral\n\n * persistèç¹ï¼ä¸æ¦è¢«åå»ºï¼ä¾¿ä¸ä¼æå¤ä¸¢å¤±ï¼å³ä½¿æå¡å¨å¨é¨éå¯ä¹ä¾ç¶å­å¨ãæ¯ä¸ª persist èç¹å³å¯åå«æ°æ®ï¼ä¹å¯åå«å­èç¹\n * ephemeralèç¹ï¼å¨åå»ºå®çå®¢æ·ç«¯ä¸æå¡å¨é´ç session ç»ææ¶èªå¨è¢«å é¤ãæå¡å¨éå¯ä¼å¯¼è´ session ç»æï¼å æ­¤ ephemeral ç±»åç znode æ­¤æ¶ä¹ä¼èªå¨å é¤\n\n2ãsequence vs. non-sequence\n\n * non-sequenceèç¹ï¼å¤ä¸ªå®¢æ·ç«¯åæ¶åå»ºåä¸ non-sequence èç¹æ¶ï¼åªæä¸ä¸ªå¯åå»ºæåï¼å¶å®åå¤±è´¥ãå¹¶ä¸åå»ºåºçèç¹åç§°ä¸åå»ºæ¶æå®çèç¹åå®å¨ä¸æ ·\n * sequenceèç¹ï¼åå»ºåºçèç¹åå¨æå®çåç§°ä¹åå¸¦æ10ä½10è¿å¶æ°çåºå·ãå¤ä¸ªå®¢æ·ç«¯åå»ºåä¸åç§°çèç¹æ¶ï¼é½è½åå»ºæåï¼åªæ¯åºå·ä¸å\n\n\n# zookeeperè¯­ä¹ä¿è¯\n\nzookeeperç®åé«æï¼åæ¶æä¾å¦ä¸è¯­ä¹ä¿è¯ï¼ä»èä½¿å¾æä»¬å¯ä»¥å©ç¨è¿äºç¹æ§æä¾å¤æçæå¡ã\n\n * é¡ºåºæ§ï¼å®¢æ·ç«¯åèµ·çæ´æ°ä¼æåéé¡ºåºè¢«åºç¨å° zookeeper ä¸\n * åå­æ§ï¼æ´æ°æä½è¦ä¹æåè¦ä¹å¤±è´¥ï¼ä¸ä¼åºç°ä¸­é´ç¶æ\n * åä¸ç³»ç»éåï¼ä¸ä¸ªå®¢æ·ç«¯æ è®ºè¿æ¥å°åªä¸ä¸ªæå¡å¨é½è½çå°å®å¨ä¸æ ·çç³»ç»éåï¼å³å®å¨ä¸æ ·çæ å½¢ç»æï¼ãæ³¨ï¼æ ¹æ®ä¸æãzookeeperæ¶æåfastleaderelectionæºå¶ãä»ç»ç zab åè®®ï¼åæä½å¹¶ä¸ä¿è¯æ´æ°è¢«ææç follower ç«å³ç¡®è®¤ï¼å æ­¤éè¿é¨å follower è¯»åæ°æ®å¹¶ä¸è½ä¿è¯è¯»å°ææ°çæ°æ®ï¼èé¨å follwer å leader å¯è¯»å°ææ°æ°æ®ãå¦æä¸å®è¦ä¿è¯åä¸ç³»ç»éåï¼å¯å¨è¯»æä½åä½¿ç¨ sync æ¹æ³ã\n * å¯é æ§ï¼ä¸ä¸ªæ´æ°æä½ä¸æ¦è¢«æ¥åå³ä¸ä¼æå¤ä¸¢å¤±ï¼é¤éè¢«å¶å®æ´æ°æä½è¦ç\n * æç»ä¸è´æ§ï¼åæä½æç»ï¼èéç«å³ï¼ä¼å¯¹å®¢æ·ç«¯å¯è§\n\n\n# zookeeper watchæºå¶\n\nææå¯¹ zookeeper çè¯»æä½ï¼é½å¯éå¸¦ä¸ä¸ª watch ãä¸æ¦ç¸åºçæ°æ®æååï¼è¯¥ watch å³è¢«è§¦åã\n\nwatch æå¦ä¸ç¹ç¹ï¼\n\n * ä¸»å¨æ¨éï¼watchè¢«è§¦åæ¶ï¼ç± zookeeper æå¡å¨ä¸»å¨å°æ´æ°æ¨éç»å®¢æ·ç«¯ï¼èä¸éè¦å®¢æ·ç«¯è½®è¯¢ã\n * ä¸æ¬¡æ§ï¼æ°æ®ååæ¶ï¼watch åªä¼è¢«è§¦åä¸æ¬¡ãå¦æå®¢æ·ç«¯æ³å¾å°åç»­æ´æ°çéç¥ï¼å¿é¡»è¦å¨ watch è¢«è§¦ååéæ°æ³¨åä¸ä¸ª watchã\n * å¯è§æ§ï¼å¦æä¸ä¸ªå®¢æ·ç«¯å¨è¯»è¯·æ±ä¸­éå¸¦ watchï¼watch è¢«è§¦åçåæ¶åæ¬¡è¯»åæ°æ®ï¼å®¢æ·ç«¯å¨å¾å° watch æ¶æ¯ä¹åè¯å®ä¸å¯è½çå°æ´æ°åçæ°æ®ãæ¢å¥è¯è¯´ï¼æ´æ°éç¥åäºæ´æ°ç»æã\n * é¡ºåºæ§ï¼å¦æå¤ä¸ªæ´æ°è§¦åäºå¤ä¸ª watch ï¼é£ watch è¢«è§¦åçé¡ºåºä¸æ´æ°é¡ºåºä¸è´ã\n\n\n# åå¸å¼éä¸é¢å¯¼éä¸¾å³é®ç¹\n\n1ãæå¤ä¸ä¸ªè·åé / æä¸ºleader\n\nå¯¹äºåå¸å¼éï¼è¿éç¹ææå®éï¼èè¨ï¼ä»»ææ¶å»ï¼æå¤åªæä¸ä¸ªè¿ç¨ï¼å¯¹äºåè¿ç¨åçéèè¨æ¯åçº¿ç¨ï¼å¯ä»¥è·å¾éã\n\nå¯¹äºé¢å¯¼éä¸¾èè¨ï¼ä»»ææ¶é´ï¼æå¤åªæä¸ä¸ªæåå½éä¸ºleaderãå¦åå³åºç°èè£ï¼split brainï¼\n\n2ãééå¥ / ç¡®è®¤èªå·±æ¯leader\n\nå¯¹äºåå¸å¼éï¼éè¦ä¿è¯è·å¾éçè¿ç¨å¨éæ¾éä¹åå¯åæ¬¡è·å¾éï¼å³éçå¯éå¥æ§ã\n\nå¯¹äºé¢å¯¼éä¸¾ï¼leaderéè¦è½å¤ç¡®è®¤èªå·±å·²ç»è·å¾é¢å¯¼æï¼å³ç¡®è®¤èªå·±æ¯leaderã\n\n3ãéæ¾é / æ¾å¼é¢å¯¼æ\n\néçè·å¾èåºè¯¥è½å¤æ­£ç¡®éæ¾å·²ç»è·å¾çéï¼å¹¶ä¸å½è·å¾éçè¿ç¨å®æºæ¶ï¼éåºè¯¥èªå¨éæ¾ï¼ä»èä½¿å¾å¶å®ç«äºæ¹å¯ä»¥è·å¾è¯¥éï¼ä»èé¿ååºç°æ­»éçç¶æã\n\né¢å¯¼åºè¯¥å¯ä»¥ä¸»å¨æ¾å¼é¢å¯¼æï¼å¹¶ä¸å½é¢å¯¼æå¨è¿ç¨å®æºæ¶ï¼é¢å¯¼æåºè¯¥èªå¨éæ¾ï¼ä»èä½¿å¾å¶å®åä¸èå¯éæ°ç«äºé¢å¯¼èé¿åè¿å¥æ ä¸»ç¶æã\n\n4ãæç¥ééæ¾ / é¢å¯¼æçæ¾å¼\n\nå½è·å¾éçä¸æ¹éæ¾éæ¶ï¼å¶å®å¯¹äºéçç«äºæ¹éè¦è½å¤æç¥å°éçéæ¾ï¼å¹¶åæ¬¡å°è¯è·åéã\n\nåæ¥çleaderæ¾å¼é¢å¯¼ææ¶ï¼å¶å®åä¸æ¹åºè¯¥è½å¤æç¥è¯¥äºä»¶ï¼å¹¶éæ°åèµ·éä¸¾æµç¨ã\n\n\n# éå¬å¹³é¢å¯¼éä¸¾\n\nä»ä¸é¢å ä¸ªæ¹é¢å¯è§ï¼åå¸å¼éä¸é¢å¯¼éä¸¾çææ¯è¦ç¹éå¸¸ç¸ä¼¼ï¼å®éä¸å¶å®ç°æºå¶ä¹ç¸è¿ãè¿éä»¥é¢å¯¼éä¸¾ä¸ºä¾æ¥è¯´æäºèçå®ç°åçï¼åå¸å¼éçå®ç°åçä¹å ä¹ä¸è´ã\n\n1ãéä¸»è¿ç¨\n\nåè®¾æä¸ä¸ªzookeeperçå®¢æ·ç«¯ï¼å¦ä¸å¾æç¤ºï¼åæ¶ç«äºleaderãè¿ä¸ä¸ªå®¢æ·ç«¯åæ¶åzookeeperéç¾¤æ³¨åephemeralä¸non-sequenceç±»åçèç¹ï¼è·¯å¾é½ä¸º /zkroot/leaderï¼å·¥ç¨å®è·µä¸­ï¼è·¯å¾åå¯èªå®ä¹ï¼ã\n\nå¦ä¸å¾æç¤ºï¼ç±äºæ¯non-sequenceèç¹ï¼è¿ä¸ä¸ªå®¢æ·ç«¯åªä¼æä¸ä¸ªåå»ºæåï¼å¶å®èç¹ååå»ºå¤±è´¥ãæ­¤æ¶ï¼åå»ºæåçå®¢æ·ç«¯ï¼å³ä¸å¾ä¸­çclient 1ï¼å³æåç«éä¸º leader ãå¶å®å®¢æ·ç«¯ï¼å³ä¸å¾ä¸­çclient 2åclient 3ï¼æ­¤æ¶åä¸º followerã\n\n2ãæ¾å¼é¢å¯¼æ\n\nå¦æ leader æç®ä¸»å¨æ¾å¼é¢å¯¼æï¼ç´æ¥å é¤ /zkroot/leader èç¹å³å¯ã\n\nå¦æ leader è¿ç¨æå¤å®æºï¼å¶ä¸ zookeeper é´ç session ä¹ç»æï¼è¯¥èç¹ç±äºæ¯ephemeralç±»åçèç¹ï¼å æ­¤ä¹ä¼èªå¨è¢«å é¤ã\n\næ­¤æ¶ /zkroot/leader èç¹ä¸å¤å­å¨ï¼å¯¹äºå¶å®åä¸ç«éçå®¢æ·ç«¯èè¨ï¼ä¹åç leader å·²ç»æ¾å¼äºé¢å¯¼æã\n\n3ãæç¥é¢å¯¼æçæ¾å¼\n\nç±ä¸å¾å¯è§ï¼åå»ºèç¹å¤±è´¥çèç¹ï¼é¤äºæä¸º follower ä»¥å¤ï¼è¿ä¼å /zkroot/leader æ³¨åä¸ä¸ª watch ï¼ä¸æ¦ leader æ¾å¼é¢å¯¼æï¼ä¹å³è¯¥èç¹è¢«å é¤ï¼ææç follower ä¼æ¶å°éç¥ã\n\n4ãéæ°éä¸¾\n\næç¥å°æ§ leader æ¾å¼é¢å¯¼æåï¼ææç follower å¯ä»¥åæ¬¡åèµ·æ°ä¸è½®çé¢å¯¼éä¸¾ï¼å¦ä¸å¾æç¤ºã\n\nä»ä¸å¾ä¸­å¯è§ï¼\n\n * æ°ä¸è½®çé¢å¯¼éä¸¾æ¹æ³ä¸æåçé¢å¯¼éä¸¾æ¹æ³å®å¨ä¸æ ·ï¼é½æ¯åèµ·èç¹åå»ºè¯·æ±ï¼åå»ºæåå³ä¸º leaderï¼å¦åä¸º follower ï¼ä¸ follower ä¼ watch è¯¥èç¹\n * æ°ä¸è½®çéä¸¾ç»æï¼æ æ³é¢æµï¼ä¸å®ä»¬å¨ç¬¬ä¸è½®éä¸¾ä¸­çé¡ºåºæ å³ãè¿ä¹æ¯è¯¥æ¹æ¡è¢«ç§°ä¸ºéå¬å¹³æ¨¡å¼çåå \n\nå°ç»\n\n 1. éå¬å¹³æ¨¡å¼å®ç°ç®åï¼æ¯ä¸è½®éä¸¾æ¹æ³é½å®å¨ä¸æ ·\n 2. ç«äºåä¸æ¹ä¸å¤çæåµä¸ï¼æçé«ãæ¯ä¸ª follower éè¿ watch æç¥å°èç¹è¢«å é¤çæ¶é´ä¸å®å¨ä¸æ ·ï¼åªè¦æä¸ä¸ª follower å¾å°éç¥å³åèµ·ç«éï¼å³å¯ä¿è¯å½æ¶ææ°ç leader è¢«éåº\n 3. ç»zookeeper éç¾¤é æçè´è½½å¤§ï¼å æ­¤æ©å±æ§å·®ãå¦ææä¸ä¸ä¸ªå®¢æ·ç«¯é½åä¸ç«éï¼æå³çåæ¶ä¼æä¸ä¸ä¸ªåè¯·æ±åéç» zookeperãå¦ãzookeeperæ¶æãä¸ææè¿°ï¼zookeeper å­å¨åç¹åçé®é¢ï¼åæ§è½ä¸é«ãåæ¶ä¸æ¦ leader æ¾å¼é¢å¯¼æï¼zookeeper éè¦åæ¶éç¥ä¸ä¸ä¸ª followerï¼è´è½½è¾å¤§ã\n\n\n# å¬å¹³é¢å¯¼éä¸¾\n\n1ãéä¸»è¿ç¨\n\nå¦ä¸å¾æç¤ºï¼å¬å¹³é¢å¯¼éä¸¾ä¸­ï¼åå®¢æ·ç«¯ååå»º /zkroot/leader èç¹ï¼ä¸å¶ç±»åä¸ºephemeralä¸sequenceã\n\nç±äºæ¯sequenceç±»åèç¹ï¼æä¸å¾ä¸­ä¸ä¸ªå®¢æ·ç«¯ååå»ºæåï¼åªæ¯åºå·ä¸ä¸æ ·ãæ­¤æ¶ï¼æ¯ä¸ªå®¢æ·ç«¯é½ä¼å¤æ­èªå·±åå»ºæåçèç¹çåºå·æ¯ä¸æ¯å½åæå°çãå¦ææ¯ï¼åè¯¥å®¢æ·ç«¯ä¸º leaderï¼å¦åå³ä¸º followerã\n\nå¨ä¸å¾ä¸­ï¼client 1åå»ºçèç¹åºå·ä¸º 1 ï¼client 2åå»ºçèç¹åºå·ä¸º 2ï¼client 3åå»ºçèç¹åºå·ä¸º3ãç±äºæå°åºå·ä¸º 1 ï¼ä¸è¯¥èç¹ç±client 1åå»ºï¼æclient 1ä¸º leader ã\n\n2ãæ¾å¼é¢å¯¼æ\n\nleader å¦æä¸»å¨æ¾å¼é¢å¯¼æï¼ç´æ¥å é¤å¶åå»ºçèç¹å³å¯ã\n\nå¦æ leader æå¨è¿ç¨æå¤å®æºï¼å¶ä¸ zookeeper é´ç session ç»æï¼ç±äºå¶åå»ºçèç¹ä¸ºephemeralç±»åï¼æè¯¥èç¹èªå¨è¢«å é¤ã\n\n3ãæç¥é¢å¯¼æçæ¾å¼\n\nä¸éå¬å¹³æ¨¡å¼ä¸åï¼æ¯ä¸ª follower å¹¶éé½ watch ç± leader åå»ºåºæ¥çèç¹ï¼èæ¯ watch åºå·åå¥½æ¯èªå·±åºå·å°çèç¹ã\n\nå¨ä¸å¾ä¸­ï¼æ»å±æ 1ã2ã3 å±ä¸ä¸ªèç¹ï¼å æ­¤client 2 watch /zkroot/leader1ï¼client 3 watch /zkroot/leader2ãï¼æ³¨ï¼åºå·åºè¯¥æ¯10ä½æ°å­ï¼èéä¸ä½æ°å­ï¼è¿éä¸ºäºæ¹ä¾¿ï¼ä»¥ä¸ä½æ°å­ä»£æ¿ï¼\n\nä¸æ¦ leader å®æºï¼/zkroot/leader1 è¢«å é¤ï¼client 2å¯å¾å°éç¥ãæ­¤æ¶client 3ç±äº watch çæ¯ /zkroot/leader2 ï¼æä¸ä¼å¾å°éç¥ã\n\n\n# éæ°éä¸¾\n\néæ°éä¸¾client 2å¾å° /zkroot/leader1 è¢«å é¤çéç¥åï¼ä¸ä¼ç«å³æä¸ºæ°ç leader ãèæ¯åå¤æ­èªå·±çåºå· 2 æ¯ä¸æ¯å½åæå°çåºå·ãå¨è¯¥åºæ¯ä¸ï¼å¶åºå·ç¡®ä¸ºæå°ãå æ­¤client 2æä¸ºæ°ç leader ã\n\nè¿éè¦æ³¨æï¼å¦æå¨client 1æ¾å¼é¢å¯¼æä¹åï¼client 2å°±å®æºäºï¼client 3ä¼æ¶å°éç¥ãæ­¤æ¶client 3ä¸ä¼ç«å³æä¸ºleaderï¼èæ¯è¦åå¤æ­èªå·±çåºå· 3 æ¯å¦ä¸ºå½åæå°åºå·ãå¾æ¾ç¶ï¼ç±äºclient 1åå»ºç /zkroot/leader1 è¿å¨ï¼å æ­¤client 3ä¸ä¼æä¸ºæ°ç leader ï¼å¹¶åclient 2åºå· 2 åé¢çåºå·ï¼ä¹å³ 1 åå»º watchãè¯¥è¿ç¨å¦ä¸å¾æç¤ºã\n\nå°ç»\n\n 1. å®ç°ç¸å¯¹å¤æï¼\n 2. æ©å±æ§å¥½ï¼æ¯ä¸ªå®¢æ·ç«¯é½åª watch ä¸ä¸ªèç¹ä¸æ¯æ¬¡èç¹è¢«å é¤åªé¡»éç¥ä¸ä¸ªå®¢æ·ç«¯ï¼\n 3. æ§ leader æ¾å¼é¢å¯¼ææ¶ï¼å¶å®å®¢æ·ç«¯æ ¹æ®ç«éçååé¡ºåºï¼ä¹å³èç¹åºå·ï¼æä¸ºæ° leaderï¼è¿ä¹æ¯å¬å¹³æ¨¡å¼çç±æ¥ï¼\n 4. å»¶è¿ç¸å¯¹éå¬å¹³æ¨¡å¼è¦é«ï¼å ä¸ºå®å¿é¡»ç­å¾ç¹å®èç¹å¾å°éç¥æè½éåºæ°ç leaderã\n\n[]: https://mp.weixin.qq.com/s?__biz=mzkwotixndq3oa==&mid=2247533392&idx=1&sn=8999e64a05cd06dfa63c0c3ecd3a806f&source=41#wechat_redirect",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/017da3/"},regularPath:"/10.%E6%A1%86%E6%9E%B6/55.Dubbo/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"10.æ¡æ¶/55.Dubbo/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-363cf0bc",path:"/pages/017da3/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Kafkaåæºçå®è£",frontmatter:{title:"Kafkaåæºçå®è£",date:"2022-02-03T22:43:53.000Z",permalink:"/pages/e5e3af/",categories:["æ¡æ¶","Kafka"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/60.Kafka/01.Kafka%E5%8D%95%E6%9C%BA%E7%89%88%E5%AE%89%E8%A3%85.html",relativePath:"10.æ¡æ¶/60.Kafka/01.Kafkaåæºçå®è£.md",key:"v-6756bb32",path:"/pages/e5e3af/",headers:[{level:2,title:"1. å®è£JDK",slug:"_1-å®è£jdk",normalizedTitle:"1. å®è£jdk",charIndex:2},{level:2,title:"2. å®è£Zookeeper",slug:"_2-å®è£zookeeper",normalizedTitle:"2. å®è£zookeeper",charIndex:332},{level:2,title:"3. å®è£Kafka",slug:"_3-å®è£kafka",normalizedTitle:"3. å®è£kafka",charIndex:1546}],headersStr:"1. å®è£JDK 2. å®è£Zookeeper 3. å®è£Kafka",content:"# 1. å®è£JDK\n\ncp jdk-8u172-linux-x64.tar.gz /usr/local/\ncd /usr/local/\ntar -zxf jdk-8u172-linux-x64.tar.gz\nmv jdk1.8.0_172/ java\nvi /etc/profile\n    export JAVA_HOME=/usr/local/java\n    export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar\n    export PATH=$JAVA_HOME/bin:$PATH\nsource /etc/profile\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# 2. å®è£Zookeeper\n\n[root@localhost local]# tar -zxf zookeeper-3.4.6.tar.gz \n[root@localhost local]# mv zookeeper-3.4.6 zookeeper\n[root@localhost local]# cd zookeeper\n[root@localhost zookeeper]# mkdir -p /var/lib/zookeeper\n[root@localhost zookeeper]# cat > /usr/local/zookeeper/conf/zoo.cfg << EOF\n> tickTime=2000\n> dataDir=/var/lib/zookeeper\n> clientPort=2181\n> EOF\n[root@localhost zookeeper]# /usr/local/zookeeper/bin/zkServer.sh start\nJMX enabled by default\nUsing config: /usr/local/zookeeper/bin/../conf/zoo.cfg\nStarting zookeeper ... STARTED\n[root@localhost zookeeper]# telnet localhost 2181\n-bash: telnet: æªæ¾å°å½ä»¤\n[root@localhost zookeeper]# yum -y install telnet\n[root@localhost zookeeper]# telnet localhost 2181\nTrying ::1...\nConnected to localhost.\nEscape character is '^]'.\nsrvr\nZookeeper version: 3.4.6-1569965, built on 02/20/2014 09:09 GMT\nLatency min/avg/max: 0/0/0\nReceived: 1\nSent: 0\nConnections: 1\nOutstanding: 0\nZxid: 0x0\nMode: standalone\nNode count: 4\nConnection closed by foreign host.\n\n# éç½® zookeeper å¼æºä½¿ç¨ wusc ç¨æ·å¯å¨ï¼ç¼è¾/etc/rc.local æä»¶ï¼\nsu -wusc -c '/home/wusc/zookeeper-3.4.6/bin/zkServer.sh start'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n\n\n\n# 3. å®è£Kafka\n\n[root@localhost local]# tar -zxf kafka_2.11-0.9.0.1.tgz \n[root@localhost local]# mv kafka_2.11-0.9.0.1 kafka\n[root@localhost local]# mkdir /tmp/kafka-logs\n/usr/local/kafka/bin/kafka-server-start.sh -daemon \\\n/usr/local/kafka/config/server.properties \n[root@localhost local]# jps\n13648 Kafka\n13707 Jps\n13502 QuorumPeerMain\n[root@localhost local]# /usr/local/kafka/bin/kafka-topics.sh --create --zookeeper localhost:2181 \\\n> --replication-factor 1 --partitions 1 --topic test\nCreated topic \"test\".\n[root@localhost local]# /usr/local/kafka/bin/kafka-topics.sh --describe --zookeeper localhost:2181 \\\n> --topic test\nTopic:test\tPartitionCount:1\tReplicationFactor:1\tConfigs:\n\tTopic: test\tPartition: 0\tLeader: 0\tReplicas: 0\tIsr: 0\n[root@localhost local]# /usr/local/kafka/bin/kafka-console-producer.sh --broker-list localhost:9092 --topic test\nTest message 1\nTest message 2\n[root@localhost local]# /usr/local/kafka/bin/kafka-console-consumer.sh --zookeeper localhost 2181 --topic test --from-beginning\nTest message 1\nTest message 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n",normalizedContent:"# 1. å®è£jdk\n\ncp jdk-8u172-linux-x64.tar.gz /usr/local/\ncd /usr/local/\ntar -zxf jdk-8u172-linux-x64.tar.gz\nmv jdk1.8.0_172/ java\nvi /etc/profile\n    export java_home=/usr/local/java\n    export classpath=.:$java_home/lib/dt.jar:$java_home/lib/tools.jar\n    export path=$java_home/bin:$path\nsource /etc/profile\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# 2. å®è£zookeeper\n\n[root@localhost local]# tar -zxf zookeeper-3.4.6.tar.gz \n[root@localhost local]# mv zookeeper-3.4.6 zookeeper\n[root@localhost local]# cd zookeeper\n[root@localhost zookeeper]# mkdir -p /var/lib/zookeeper\n[root@localhost zookeeper]# cat > /usr/local/zookeeper/conf/zoo.cfg << eof\n> ticktime=2000\n> datadir=/var/lib/zookeeper\n> clientport=2181\n> eof\n[root@localhost zookeeper]# /usr/local/zookeeper/bin/zkserver.sh start\njmx enabled by default\nusing config: /usr/local/zookeeper/bin/../conf/zoo.cfg\nstarting zookeeper ... started\n[root@localhost zookeeper]# telnet localhost 2181\n-bash: telnet: æªæ¾å°å½ä»¤\n[root@localhost zookeeper]# yum -y install telnet\n[root@localhost zookeeper]# telnet localhost 2181\ntrying ::1...\nconnected to localhost.\nescape character is '^]'.\nsrvr\nzookeeper version: 3.4.6-1569965, built on 02/20/2014 09:09 gmt\nlatency min/avg/max: 0/0/0\nreceived: 1\nsent: 0\nconnections: 1\noutstanding: 0\nzxid: 0x0\nmode: standalone\nnode count: 4\nconnection closed by foreign host.\n\n# éç½® zookeeper å¼æºä½¿ç¨ wusc ç¨æ·å¯å¨ï¼ç¼è¾/etc/rc.local æä»¶ï¼\nsu -wusc -c '/home/wusc/zookeeper-3.4.6/bin/zkserver.sh start'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n\n\n\n# 3. å®è£kafka\n\n[root@localhost local]# tar -zxf kafka_2.11-0.9.0.1.tgz \n[root@localhost local]# mv kafka_2.11-0.9.0.1 kafka\n[root@localhost local]# mkdir /tmp/kafka-logs\n/usr/local/kafka/bin/kafka-server-start.sh -daemon \\\n/usr/local/kafka/config/server.properties \n[root@localhost local]# jps\n13648 kafka\n13707 jps\n13502 quorumpeermain\n[root@localhost local]# /usr/local/kafka/bin/kafka-topics.sh --create --zookeeper localhost:2181 \\\n> --replication-factor 1 --partitions 1 --topic test\ncreated topic \"test\".\n[root@localhost local]# /usr/local/kafka/bin/kafka-topics.sh --describe --zookeeper localhost:2181 \\\n> --topic test\ntopic:test\tpartitioncount:1\treplicationfactor:1\tconfigs:\n\ttopic: test\tpartition: 0\tleader: 0\treplicas: 0\tisr: 0\n[root@localhost local]# /usr/local/kafka/bin/kafka-console-producer.sh --broker-list localhost:9092 --topic test\ntest message 1\ntest message 2\n[root@localhost local]# /usr/local/kafka/bin/kafka-console-consumer.sh --zookeeper localhost 2181 --topic test --from-beginning\ntest message 1\ntest message 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"kafkaå½ä»¤æ´ç",frontmatter:{title:"kafkaå½ä»¤æ´ç",date:"2022-02-03T22:34:25.000Z",permalink:"/pages/bc987c/",categories:["æ¡æ¶","Kafka"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/60.Kafka/10.kafka%E5%91%BD%E4%BB%A4%E6%95%B4%E7%90%86.html",relativePath:"10.æ¡æ¶/60.Kafka/10.kafkaå½ä»¤æ´ç.md",key:"v-6e63d81a",path:"/pages/bc987c/",headers:[{level:3,title:"0. å¯å¨ Kafka",slug:"_0-å¯å¨-kafka",normalizedTitle:"0. å¯å¨ kafka",charIndex:74},{level:3,title:"1. Topic ç¸å³æä½",slug:"_1-topic-ç¸å³æä½",normalizedTitle:"1. topic ç¸å³æä½",charIndex:177},{level:3,title:"2. çäº§æ¶è´¹æ¶æ¯",slug:"_2-çäº§æ¶è´¹æ¶æ¯",normalizedTitle:"2. çäº§æ¶è´¹æ¶æ¯",charIndex:610},{level:3,title:"3. å¶ä»å½ä»¤",slug:"_3-å¶ä»å½ä»¤",normalizedTitle:"3. å¶ä»å½ä»¤",charIndex:1219}],headersStr:"0. å¯å¨ Kafka 1. Topic ç¸å³æä½ 2. çäº§æ¶è´¹æ¶æ¯ 3. å¶ä»å½ä»¤",content:"è¯´æï¼kafkaæ§è¡å½ä»¤éå¸¸èå¼±ï¼å¤å ä¸ªç©ºæ ¼å¥çå°±ä¼æ§è¡å¤±è´¥ï¼èä¸æ¥çéçä¸åºæ¥æ¯å ä¸ºæ ¼å¼æé®é¢ï¼ææå¨è¿éä¸¥æ ¼æå½ä»¤çæ ¼å¼è®°å½åæ¬¡ï¼ï¼ï¼\n\n\n# 0. å¯å¨ Kafka\n\ncd kafka_2.11-1.1.0\nbin/kafka-server-start.sh -daemon config/server.properties\n\n\n1\n2\n\n\n\n# 1. Topic ç¸å³æä½\n\næ¥çææ Topic åè¡¨\n\nbin/kafka-topics.sh --list --zookeeper localhost:2181\n\n\n1\n\n\nå é¤æå® Topic\n\nbin/kafka-topics.sh --delete --topic test666 --zookeeper localhost:2181\n\n\n1\n\n\nåå»º Topic\n\nbin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic test\n\nbin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 3 --partitions 1 --topic my-replicated-topic\n\n\n1\n2\n3\n\n\n\n# 2. çäº§æ¶è´¹æ¶æ¯\n\nåéæ¶æ¯\n\nbin/kafka-console-producer.sh --broker-list localhost:9092 --topic test\n\n\n1\n\n\næ¶è´¹æ¶æ¯ï¼ä»å¤´æ¶è´¹ï¼ââ èçæ¬\n\nbin/kafka-console-consumer.sh --zookeeper localhost:2181 --topic test --from-beginning\n\n\n1\n\n\næ¶è´¹æ¶æ¯ï¼ä»å¤´æ¶è´¹ï¼ââ æ°çæ¬\n\nbin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic test --from-beginning [--consumer-property group.id=testGroup] [--consumer-property client.id=consumer-1]\n\n# æå®æ¶è´¹èç»ãä»¥åå®¢æ·ç«¯ç¼å·\nbin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic test --from-beginning --consumer-property group.id=testGroup --consumer-property client.id=consumer-1\n\n\n1\n2\n3\n4\n\n\n\n# 3. å¶ä»å½ä»¤\n\næ¥çæ¶è´¹èç»åè¡¨\n\nbin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --list\n\n\n1\n\n\næ¥çæä¸æ¶è´¹èç»çæ¶è´¹åç§»éï¼æ¶è´¹åç§»éæ¯åæ¶è´¹èç»ç»å®çï¼\n\nbin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --describe --group testGroup\n\n\n1\n\n\næ¥ç topic æè¿° ä¿¡æ¯\n\nbin/kafka-topics.sh --describe --zookeeper localhost:2181 --topic test\n\n\n1\n\n\næ¥çå¯å¨kafkaè¿ç¨\n\njps\njps -vm\n\n\n1\n2\n",normalizedContent:"è¯´æï¼kafkaæ§è¡å½ä»¤éå¸¸èå¼±ï¼å¤å ä¸ªç©ºæ ¼å¥çå°±ä¼æ§è¡å¤±è´¥ï¼èä¸æ¥çéçä¸åºæ¥æ¯å ä¸ºæ ¼å¼æé®é¢ï¼ææå¨è¿éä¸¥æ ¼æå½ä»¤çæ ¼å¼è®°å½åæ¬¡ï¼ï¼ï¼\n\n\n# 0. å¯å¨ kafka\n\ncd kafka_2.11-1.1.0\nbin/kafka-server-start.sh -daemon config/server.properties\n\n\n1\n2\n\n\n\n# 1. topic ç¸å³æä½\n\næ¥çææ topic åè¡¨\n\nbin/kafka-topics.sh --list --zookeeper localhost:2181\n\n\n1\n\n\nå é¤æå® topic\n\nbin/kafka-topics.sh --delete --topic test666 --zookeeper localhost:2181\n\n\n1\n\n\nåå»º topic\n\nbin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic test\n\nbin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 3 --partitions 1 --topic my-replicated-topic\n\n\n1\n2\n3\n\n\n\n# 2. çäº§æ¶è´¹æ¶æ¯\n\nåéæ¶æ¯\n\nbin/kafka-console-producer.sh --broker-list localhost:9092 --topic test\n\n\n1\n\n\næ¶è´¹æ¶æ¯ï¼ä»å¤´æ¶è´¹ï¼ââ èçæ¬\n\nbin/kafka-console-consumer.sh --zookeeper localhost:2181 --topic test --from-beginning\n\n\n1\n\n\næ¶è´¹æ¶æ¯ï¼ä»å¤´æ¶è´¹ï¼ââ æ°çæ¬\n\nbin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic test --from-beginning [--consumer-property group.id=testgroup] [--consumer-property client.id=consumer-1]\n\n# æå®æ¶è´¹èç»ãä»¥åå®¢æ·ç«¯ç¼å·\nbin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic test --from-beginning --consumer-property group.id=testgroup --consumer-property client.id=consumer-1\n\n\n1\n2\n3\n4\n\n\n\n# 3. å¶ä»å½ä»¤\n\næ¥çæ¶è´¹èç»åè¡¨\n\nbin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --list\n\n\n1\n\n\næ¥çæä¸æ¶è´¹èç»çæ¶è´¹åç§»éï¼æ¶è´¹åç§»éæ¯åæ¶è´¹èç»ç»å®çï¼\n\nbin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --describe --group testgroup\n\n\n1\n\n\næ¥ç topic æè¿° ä¿¡æ¯\n\nbin/kafka-topics.sh --describe --zookeeper localhost:2181 --topic test\n\n\n1\n\n\næ¥çå¯å¨kafkaè¿ç¨\n\njps\njps -vm\n\n\n1\n2\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"kafkaå®¢æ·ç«¯ç¤ºä¾ä»£ç ",frontmatter:{title:"kafkaå®¢æ·ç«¯ç¤ºä¾ä»£ç ",date:"2022-02-03T22:34:32.000Z",permalink:"/pages/4975ea/",categories:["æ¡æ¶","Kafka"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/60.Kafka/20.kafka%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81.html",relativePath:"10.æ¡æ¶/60.Kafka/20.kafkaå®¢æ·ç«¯ç¤ºä¾ä»£ç .md",key:"v-2fe45ff3",path:"/pages/4975ea/",headers:[{level:3,title:"åéç«¯",slug:"åéç«¯",normalizedTitle:"åéç«¯",charIndex:59},{level:3,title:"æ¶è´¹ç«¯",slug:"æ¶è´¹ç«¯",normalizedTitle:"æ¶è´¹ç«¯",charIndex:3004}],headersStr:"åéç«¯ æ¶è´¹ç«¯",content:'http://kafka.apache.org/documentation.html#producerapi\n\n\n# åéç«¯\n\nhttp://kafka.apache.org/23/javadoc/index.html?org/apache/kafka/clients/producer/KafkaProducer.html\n\npackage com.ceair.screen.flight.service.impl;\n\nimport org.apache.kafka.clients.producer.*;\n\nimport java.util.Properties;\nimport java.util.concurrent.ExecutionException;\nimport java.util.concurrent.Future;\n\n\n/**\n * ä»£ç APIåéæ¶æ¯\n */\npublic class KafkaMessageProducer {\n\n    public static void main(String[] args) throws InterruptedException, ExecutionException {\n\n        Properties props = new Properties();\n        //props.put("bootstrap.servers", "192.168.229.130:9092,192.168.229.130:9093,192.168.229.130:9094");\n        props.put("bootstrap.servers", "192.168.229.130:9092");\n        //props.put("acks", "all");\n        props.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer");\n        props.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer");\n\n        Producer<String, String> producer = new KafkaProducer<>(props);\n        for (int i = 0; i < 5; i++) {\n            // åæ­¥æ¹å¼åéæ¶æ¯\n            ProducerRecord<String, String> producerRecord = new ProducerRecord<String, String>("code-test-topic", 0, Integer.toString(i), Integer.toString(i));\n\n            // åæ­¥åéæ¶æ¯\n            sendSync(producerRecord, producer);\n            // å¼æ­¥åéæ¶æ¯\n            //sendAsync(producerRecord, producer);\n        }\n        producer.close();\n    }\n\n    /**\n     * åæ­¥åéæ¶æ¯\n     *\n     * @param producerRecord\n     */\n    private static void sendSync(ProducerRecord<String, String> producerRecord, Producer<String, String> producer) throws ExecutionException, InterruptedException {\n\n        Future<RecordMetadata> result = producer.send(producerRecord);\n        // ç­å¾æ¶æ¯åéæåçåæ­¥é»å¡æ¹æ³\n        RecordMetadata metadata = result.get();\n        System.out.println("åæ­¥æ¹å¼åéæ¶æ¯ç»æï¼" + "topic-" + metadata.topic() + "|partition-"\n                + metadata.partition() + "|offset-" + metadata.offset());\n    }\n\n    /**\n     * å¼æ­¥åéæ¶æ¯\n     *\n     * @param producerRecord\n     */\n    private static void sendAsync(ProducerRecord<String, String> producerRecord, Producer<String, String> producer) {\n\n        // å¼æ­¥æ¹å¼åéæ¶æ¯\n        producer.send(producerRecord, new Callback() {\n            @Override\n            public void onCompletion(RecordMetadata metadata, Exception exception) {\n                if (exception != null) {\n                    System.err.println("åéæ¶æ¯å¤±è´¥ï¼" + exception.getStackTrace());\n                }\n                if (metadata != null) {\n                    System.out.println("å¼æ­¥æ¹å¼åéæ¶æ¯ç»æï¼" + "topic-" + metadata.topic() + "|partition-"\n                            + metadata.partition() + "|offset-" + metadata.offset());\n                }\n            }\n        });\n    }\n}\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n\n\n\n# æ¶è´¹ç«¯\n\nhttp://kafka.apache.org/23/javadoc/index.html?org/apache/kafka/clients/consumer/KafkaConsumer.html\n\npackage com.ceair.screen.flight.service.impl;\n\nimport org.apache.kafka.clients.consumer.ConsumerRecord;\nimport org.apache.kafka.clients.consumer.ConsumerRecords;\nimport org.apache.kafka.clients.consumer.KafkaConsumer;\n\nimport java.util.Arrays;\nimport java.util.Properties;\n\npublic class KafkaMessageConsumer {\n\n    public static void main(String[] args) {\n\n        Properties props = new Properties();\n        props.put("bootstrap.servers", "192.168.229.130:9092,192.168.229.130:9093,192.168.229.130:9094");\n        // æ¶è´¹åç»å\n        props.put("group.id", "testGroup");\n\n        props.put("key.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");\n        props.put("value.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");\n\n        // é»è®¤èªå¨æäº¤offset\n        //props.put("enable.auto.commit", "false");\n        // æ¯å¦èªå¨æäº¤offset\n        //props.put("enable.auto.commit", "true");\n        // èªå¨æäº¤offsetçé´éæ¶é´\n        //props.put("auto.commit.interval.ms", "1000");\n\n        KafkaConsumer<String, String> consumer = new KafkaConsumer<>(props);\n        // æ¶è´¹ä¸»é¢\n        consumer.subscribe(Arrays.asList("code-test-topic"));\n        // æ¶è´¹æå®ååº\n        //consumer.assign(Arrays.asList(new TopicPartition("topic-replica-zhuge2", 0)));\n        while (true) {\n\t\t\t/*\n\t\t\t * poll() API æ¯æåæ¶æ¯çé¿è½®è¯¢ï¼ä¸»è¦æ¯å¤æ­consumeræ¯å¦è¿æ´»çï¼åªè¦æä»¬æç»­è°ç¨poll()ï¼æ¶è´¹èå°±ä¼å­æ´»å¨èªå·±æå¨çgroupä¸­ï¼\n\t\t\t * å¹¶ä¸æç»­çæ¶è´¹æå®partitionçæ¶æ¯ãåºå±æ¯è¿ä¹åçï¼æ¶è´¹èåserveræç»­åéå¿è·³ï¼å¦æä¸ä¸ªæ¶é´æ®µï¼session.\n\t\t\t * timeout.msï¼consumerææææ¯ä¸è½åéå¿è·³ï¼è¿ä¸ªæ¶è´¹èä¼è¢«è®¤ä¸ºæ¯ææäºï¼\n\t\t\t * è¿ä¸ªPartitionä¹ä¼è¢«éæ°åéç»å¶ä»consumer\n\t\t\t */\n            ConsumerRecords<String, String> records = consumer.poll(1000);\n            for (ConsumerRecord<String, String> record : records) {\n                System.out.printf("offset = %d, key = %s, value = %s%n", record.offset(), record.key(), record.value());\n            }\n            if (records.count() > 0) {\n                // æäº¤offset\n                consumer.commitSync();\n            }\n\n        }\n    }\n}\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n',normalizedContent:'http://kafka.apache.org/documentation.html#producerapi\n\n\n# åéç«¯\n\nhttp://kafka.apache.org/23/javadoc/index.html?org/apache/kafka/clients/producer/kafkaproducer.html\n\npackage com.ceair.screen.flight.service.impl;\n\nimport org.apache.kafka.clients.producer.*;\n\nimport java.util.properties;\nimport java.util.concurrent.executionexception;\nimport java.util.concurrent.future;\n\n\n/**\n * ä»£ç apiåéæ¶æ¯\n */\npublic class kafkamessageproducer {\n\n    public static void main(string[] args) throws interruptedexception, executionexception {\n\n        properties props = new properties();\n        //props.put("bootstrap.servers", "192.168.229.130:9092,192.168.229.130:9093,192.168.229.130:9094");\n        props.put("bootstrap.servers", "192.168.229.130:9092");\n        //props.put("acks", "all");\n        props.put("key.serializer", "org.apache.kafka.common.serialization.stringserializer");\n        props.put("value.serializer", "org.apache.kafka.common.serialization.stringserializer");\n\n        producer<string, string> producer = new kafkaproducer<>(props);\n        for (int i = 0; i < 5; i++) {\n            // åæ­¥æ¹å¼åéæ¶æ¯\n            producerrecord<string, string> producerrecord = new producerrecord<string, string>("code-test-topic", 0, integer.tostring(i), integer.tostring(i));\n\n            // åæ­¥åéæ¶æ¯\n            sendsync(producerrecord, producer);\n            // å¼æ­¥åéæ¶æ¯\n            //sendasync(producerrecord, producer);\n        }\n        producer.close();\n    }\n\n    /**\n     * åæ­¥åéæ¶æ¯\n     *\n     * @param producerrecord\n     */\n    private static void sendsync(producerrecord<string, string> producerrecord, producer<string, string> producer) throws executionexception, interruptedexception {\n\n        future<recordmetadata> result = producer.send(producerrecord);\n        // ç­å¾æ¶æ¯åéæåçåæ­¥é»å¡æ¹æ³\n        recordmetadata metadata = result.get();\n        system.out.println("åæ­¥æ¹å¼åéæ¶æ¯ç»æï¼" + "topic-" + metadata.topic() + "|partition-"\n                + metadata.partition() + "|offset-" + metadata.offset());\n    }\n\n    /**\n     * å¼æ­¥åéæ¶æ¯\n     *\n     * @param producerrecord\n     */\n    private static void sendasync(producerrecord<string, string> producerrecord, producer<string, string> producer) {\n\n        // å¼æ­¥æ¹å¼åéæ¶æ¯\n        producer.send(producerrecord, new callback() {\n            @override\n            public void oncompletion(recordmetadata metadata, exception exception) {\n                if (exception != null) {\n                    system.err.println("åéæ¶æ¯å¤±è´¥ï¼" + exception.getstacktrace());\n                }\n                if (metadata != null) {\n                    system.out.println("å¼æ­¥æ¹å¼åéæ¶æ¯ç»æï¼" + "topic-" + metadata.topic() + "|partition-"\n                            + metadata.partition() + "|offset-" + metadata.offset());\n                }\n            }\n        });\n    }\n}\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n\n\n\n# æ¶è´¹ç«¯\n\nhttp://kafka.apache.org/23/javadoc/index.html?org/apache/kafka/clients/consumer/kafkaconsumer.html\n\npackage com.ceair.screen.flight.service.impl;\n\nimport org.apache.kafka.clients.consumer.consumerrecord;\nimport org.apache.kafka.clients.consumer.consumerrecords;\nimport org.apache.kafka.clients.consumer.kafkaconsumer;\n\nimport java.util.arrays;\nimport java.util.properties;\n\npublic class kafkamessageconsumer {\n\n    public static void main(string[] args) {\n\n        properties props = new properties();\n        props.put("bootstrap.servers", "192.168.229.130:9092,192.168.229.130:9093,192.168.229.130:9094");\n        // æ¶è´¹åç»å\n        props.put("group.id", "testgroup");\n\n        props.put("key.deserializer", "org.apache.kafka.common.serialization.stringdeserializer");\n        props.put("value.deserializer", "org.apache.kafka.common.serialization.stringdeserializer");\n\n        // é»è®¤èªå¨æäº¤offset\n        //props.put("enable.auto.commit", "false");\n        // æ¯å¦èªå¨æäº¤offset\n        //props.put("enable.auto.commit", "true");\n        // èªå¨æäº¤offsetçé´éæ¶é´\n        //props.put("auto.commit.interval.ms", "1000");\n\n        kafkaconsumer<string, string> consumer = new kafkaconsumer<>(props);\n        // æ¶è´¹ä¸»é¢\n        consumer.subscribe(arrays.aslist("code-test-topic"));\n        // æ¶è´¹æå®ååº\n        //consumer.assign(arrays.aslist(new topicpartition("topic-replica-zhuge2", 0)));\n        while (true) {\n\t\t\t/*\n\t\t\t * poll() api æ¯æåæ¶æ¯çé¿è½®è¯¢ï¼ä¸»è¦æ¯å¤æ­consumeræ¯å¦è¿æ´»çï¼åªè¦æä»¬æç»­è°ç¨poll()ï¼æ¶è´¹èå°±ä¼å­æ´»å¨èªå·±æå¨çgroupä¸­ï¼\n\t\t\t * å¹¶ä¸æç»­çæ¶è´¹æå®partitionçæ¶æ¯ãåºå±æ¯è¿ä¹åçï¼æ¶è´¹èåserveræç»­åéå¿è·³ï¼å¦æä¸ä¸ªæ¶é´æ®µï¼session.\n\t\t\t * timeout.msï¼consumerææææ¯ä¸è½åéå¿è·³ï¼è¿ä¸ªæ¶è´¹èä¼è¢«è®¤ä¸ºæ¯ææäºï¼\n\t\t\t * è¿ä¸ªpartitionä¹ä¼è¢«éæ°åéç»å¶ä»consumer\n\t\t\t */\n            consumerrecords<string, string> records = consumer.poll(1000);\n            for (consumerrecord<string, string> record : records) {\n                system.out.printf("offset = %d, key = %s, value = %s%n", record.offset(), record.key(), record.value());\n            }\n            if (records.count() > 0) {\n                // æäº¤offset\n                consumer.commitsync();\n            }\n\n        }\n    }\n}\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/fb3719/"},regularPath:"/10.%E6%A1%86%E6%9E%B6/65.Apollo/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"10.æ¡æ¶/65.Apollo/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-350792bc",path:"/pages/fb3719/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/7f0c55/"},regularPath:"/10.%E6%A1%86%E6%9E%B6/70.%E5%A4%A7%E6%95%B0%E6%8D%AE/05.Hbase/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"10.æ¡æ¶/70.å¤§æ°æ®/05.Hbase/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-3913f24b",path:"/pages/7f0c55/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"å¸éè¿æ»¤å¨",frontmatter:{title:"å¸éè¿æ»¤å¨",date:"2022-02-03T23:04:42.000Z",permalink:"/pages/d09904/",categories:["æ¡æ¶","Redis"],tags:[null]},regularPath:"/10.%E6%A1%86%E6%9E%B6/40.Redis/20.%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8.html",relativePath:"10.æ¡æ¶/40.Redis/20.å¸éè¿æ»¤å¨.md",key:"v-fa3822fc",path:"/pages/d09904/",headers:[{level:3,title:"åè¨",slug:"åè¨",normalizedTitle:"åè¨",charIndex:29},{level:3,title:"BloomFilterHelper",slug:"bloomfilterhelper",normalizedTitle:"bloomfilterhelper",charIndex:377},{level:3,title:"RedisService",slug:"redisservice",normalizedTitle:"redisservice",charIndex:2299}],headersStr:"åè¨ BloomFilterHelper RedisService",content:' * åºäºRedisçBloomFilterå®ç°\n\n\n# åè¨\n\næè¿å¨ç ç©¶å¸éè¿æ»¤å¨ï¼å¦æä¸äºè§£ä»ä¹æ¯å¸éè¿æ»¤å¨çï¼æ¨èçè¿ç¯å¦ä½å¤æ­ä¸ä¸ªåç´ å¨äº¿çº§æ°æ®ä¸­æ¯å¦å­å¨ï¼äºè§£ï¼ï¼åç°Guavaæä¾äºå°è£å¥½çç±»ï¼ä½æ¯åªè½åæºä½¿ç¨ï¼ä¸è¬ç°å¨çåºç¨é½æ¯é¨ç½²å¨åå¸å¼ç³»ç»çï¼æä»¥æ³æ¾ä¸ªå¯ä»¥å¨åå¸å¼ç³»ç»ä¸ä½¿ç¨çå¸éè¿æ»¤å¨ï¼æ¾äºåå¤©åªæ¾å°ä¸ä¸ªåºäºrediså¼åçæ¨¡åé¡¹ç®ReBloomï¼ä½æ¯è¿ä¸ªæ¯éè¦é¢å¤å®è£çï¼èä¸ææ¡£éåªè¯´äºæä¹å¨dockerä¸è¿è¡ï¼æ²¡ç ç©¶è¿dockeræä»¥æ¾å¼äºãåæ¥æ¾å°ä¸ç¯åå®¢è®²æä¹å©ç¨å¸éè¿æ»¤å¨ç»è®¡æ¶æ¯æªè¯»æ°çï¼åå®¢å°åä¸è®°å¾äºï¼æ¯ä¸ä½æ·å®åå­¦åçï¼ï¼åå®¢æåæ¾äºä¸ä»½æ´åredisåbloomFilterçä»£ç demoï¼è¯¦è§BloomFilter.javaï¼çäºä¸å®ç°æ¯è¾ç®åï¼ä½æ¯ä½¿ç¨æ¹å¼ä¸æ¯ææ³è¦çï¼æä»¥åèçèªå·±æ´çäºä¸ä»½ã\n\n\n# BloomFilterHelper\n\npackage com.doodl6.springmvc.service.cache.redis;\n\nimport com.google.common.base.Preconditions;\nimport com.google.common.hash.Funnel;\nimport com.google.common.hash.Hashing;\n\npublic class BloomFilterHelper<T> {\n\n    private int numHashFunctions;\n\n    private int bitSize;\n\n    private Funnel<T> funnel;\n\n    public BloomFilterHelper(Funnel<T> funnel, int expectedInsertions, double fpp) {\n        Preconditions.checkArgument(funnel != null, "funnelä¸è½ä¸ºç©º");\n        this.funnel = funnel;\n        bitSize = optimalNumOfBits(expectedInsertions, fpp);\n        numHashFunctions = optimalNumOfHashFunctions(expectedInsertions, bitSize);\n    }\n\n    int[] murmurHashOffset(T value) {\n        int[] offset = new int[numHashFunctions];\n\n        long hash64 = Hashing.murmur3_128().hashObject(value, funnel).asLong();\n        int hash1 = (int) hash64;\n        int hash2 = (int) (hash64 >>> 32);\n        for (int i = 1; i <= numHashFunctions; i++) {\n            int nextHash = hash1 + i * hash2;\n            if (nextHash < 0) {\n                nextHash = ~nextHash;\n            }\n            offset[i - 1] = nextHash % bitSize;\n        }\n\n        return offset;\n    }\n\n    /**\n     * è®¡ç®bitæ°ç»é¿åº¦\n     */\n    private int optimalNumOfBits(long n, double p) {\n        if (p == 0) {\n            p = Double.MIN_VALUE;\n        }\n        return (int) (-n * Math.log(p) / (Math.log(2) * Math.log(2)));\n    }\n\n    /**\n     * è®¡ç®hashæ¹æ³æ§è¡æ¬¡æ°\n     */\n    private int optimalNumOfHashFunctions(long n, long m) {\n        return Math.max(1, (int) Math.round((double) m / n * Math.log(2)));\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n\n\nBloomFilterHelperæ¯å®ç°åè½çå³é®ï¼åå«äºè®¡ç®bitmapçæ ¸å¿ç®æ³ï¼å¶å®å¤§é¨åä»£ç é½æ¯æ¥æºäºGuavaåºéé¢çBloomFilterStrategiesç±»ï¼ä½æ¯å ä¸ºè¿ä¸ªç±»æ¯ä¸é¨ä¸ºGuavaçBloomFilterç±»ä½¿ç¨çï¼æä»¥æ²¡æå¯¹å¤æ´é²ä¸äºéè¦çç®æ³é»è¾ã\n\nåæ¥çæä¹ç»åredisä¸èµ·ä½¿ç¨BloomFilterHelper\n\n\n# RedisService\n\npackage com.doodl6.springmvc.service.cache.redis;\n\nimport com.google.common.base.Preconditions;\nimport org.springframework.data.redis.core.RedisTemplate;\nimport org.springframework.stereotype.Service;\n\nimport javax.annotation.Resource;\nimport java.util.Collection;\nimport java.util.Map;\nimport java.util.concurrent.TimeUnit;\n\n@Service\npublic class RedisService {\n\n    @Resource\n    private RedisTemplate<String, Object> redisTemplate;\n\n    /**\n     * æ ¹æ®ç»å®çå¸éè¿æ»¤å¨æ·»å å¼\n     */\n    public <T> void addByBloomFilter(BloomFilterHelper<T> bloomFilterHelper, String key, T value) {\n        Preconditions.checkArgument(bloomFilterHelper != null, "bloomFilterHelperä¸è½ä¸ºç©º");\n        int[] offset = bloomFilterHelper.murmurHashOffset(value);\n        for (int i : offset) {\n            redisTemplate.opsForValue().setBit(key, i, true);\n        }\n    }\n\n    /**\n     * æ ¹æ®ç»å®çå¸éè¿æ»¤å¨å¤æ­å¼æ¯å¦å­å¨\n     */\n    public <T> boolean includeByBloomFilter(BloomFilterHelper<T> bloomFilterHelper, String key, T value) {\n        Preconditions.checkArgument(bloomFilterHelper != null, "bloomFilterHelperä¸è½ä¸ºç©º");\n        int[] offset = bloomFilterHelper.murmurHashOffset(value);\n        for (int i : offset) {\n            if (!redisTemplate.opsForValue().getBit(key, i)) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n\n\nRedisServiceå¾ç®åï¼åªæä¸¤ä¸ªæ¹æ³\n\naddByBloomFilterï¼å¾rediséé¢æ·»å åç´ \n\nincludeByBloomFilterï¼æ£æ¥åç´ æ¯å¦å¨redis bloomFilteréé¢\n\nè¿éredisçå®¢æ·ç«¯ä½¿ç¨çæ¯spring-data-rediså°è£çï¼å¯ä»¥å¨æçé¡¹ç®SpringMVC-Projectä¸­æ¥çå®æ´çä½¿ç¨ä»£ç ã',normalizedContent:' * åºäºredisçbloomfilterå®ç°\n\n\n# åè¨\n\næè¿å¨ç ç©¶å¸éè¿æ»¤å¨ï¼å¦æä¸äºè§£ä»ä¹æ¯å¸éè¿æ»¤å¨çï¼æ¨èçè¿ç¯å¦ä½å¤æ­ä¸ä¸ªåç´ å¨äº¿çº§æ°æ®ä¸­æ¯å¦å­å¨ï¼äºè§£ï¼ï¼åç°guavaæä¾äºå°è£å¥½çç±»ï¼ä½æ¯åªè½åæºä½¿ç¨ï¼ä¸è¬ç°å¨çåºç¨é½æ¯é¨ç½²å¨åå¸å¼ç³»ç»çï¼æä»¥æ³æ¾ä¸ªå¯ä»¥å¨åå¸å¼ç³»ç»ä¸ä½¿ç¨çå¸éè¿æ»¤å¨ï¼æ¾äºåå¤©åªæ¾å°ä¸ä¸ªåºäºrediså¼åçæ¨¡åé¡¹ç®rebloomï¼ä½æ¯è¿ä¸ªæ¯éè¦é¢å¤å®è£çï¼èä¸ææ¡£éåªè¯´äºæä¹å¨dockerä¸è¿è¡ï¼æ²¡ç ç©¶è¿dockeræä»¥æ¾å¼äºãåæ¥æ¾å°ä¸ç¯åå®¢è®²æä¹å©ç¨å¸éè¿æ»¤å¨ç»è®¡æ¶æ¯æªè¯»æ°çï¼åå®¢å°åä¸è®°å¾äºï¼æ¯ä¸ä½æ·å®åå­¦åçï¼ï¼åå®¢æåæ¾äºä¸ä»½æ´åredisåbloomfilterçä»£ç demoï¼è¯¦è§bloomfilter.javaï¼çäºä¸å®ç°æ¯è¾ç®åï¼ä½æ¯ä½¿ç¨æ¹å¼ä¸æ¯ææ³è¦çï¼æä»¥åèçèªå·±æ´çäºä¸ä»½ã\n\n\n# bloomfilterhelper\n\npackage com.doodl6.springmvc.service.cache.redis;\n\nimport com.google.common.base.preconditions;\nimport com.google.common.hash.funnel;\nimport com.google.common.hash.hashing;\n\npublic class bloomfilterhelper<t> {\n\n    private int numhashfunctions;\n\n    private int bitsize;\n\n    private funnel<t> funnel;\n\n    public bloomfilterhelper(funnel<t> funnel, int expectedinsertions, double fpp) {\n        preconditions.checkargument(funnel != null, "funnelä¸è½ä¸ºç©º");\n        this.funnel = funnel;\n        bitsize = optimalnumofbits(expectedinsertions, fpp);\n        numhashfunctions = optimalnumofhashfunctions(expectedinsertions, bitsize);\n    }\n\n    int[] murmurhashoffset(t value) {\n        int[] offset = new int[numhashfunctions];\n\n        long hash64 = hashing.murmur3_128().hashobject(value, funnel).aslong();\n        int hash1 = (int) hash64;\n        int hash2 = (int) (hash64 >>> 32);\n        for (int i = 1; i <= numhashfunctions; i++) {\n            int nexthash = hash1 + i * hash2;\n            if (nexthash < 0) {\n                nexthash = ~nexthash;\n            }\n            offset[i - 1] = nexthash % bitsize;\n        }\n\n        return offset;\n    }\n\n    /**\n     * è®¡ç®bitæ°ç»é¿åº¦\n     */\n    private int optimalnumofbits(long n, double p) {\n        if (p == 0) {\n            p = double.min_value;\n        }\n        return (int) (-n * math.log(p) / (math.log(2) * math.log(2)));\n    }\n\n    /**\n     * è®¡ç®hashæ¹æ³æ§è¡æ¬¡æ°\n     */\n    private int optimalnumofhashfunctions(long n, long m) {\n        return math.max(1, (int) math.round((double) m / n * math.log(2)));\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n\n\nbloomfilterhelperæ¯å®ç°åè½çå³é®ï¼åå«äºè®¡ç®bitmapçæ ¸å¿ç®æ³ï¼å¶å®å¤§é¨åä»£ç é½æ¯æ¥æºäºguavaåºéé¢çbloomfilterstrategiesç±»ï¼ä½æ¯å ä¸ºè¿ä¸ªç±»æ¯ä¸é¨ä¸ºguavaçbloomfilterç±»ä½¿ç¨çï¼æä»¥æ²¡æå¯¹å¤æ´é²ä¸äºéè¦çç®æ³é»è¾ã\n\nåæ¥çæä¹ç»åredisä¸èµ·ä½¿ç¨bloomfilterhelper\n\n\n# redisservice\n\npackage com.doodl6.springmvc.service.cache.redis;\n\nimport com.google.common.base.preconditions;\nimport org.springframework.data.redis.core.redistemplate;\nimport org.springframework.stereotype.service;\n\nimport javax.annotation.resource;\nimport java.util.collection;\nimport java.util.map;\nimport java.util.concurrent.timeunit;\n\n@service\npublic class redisservice {\n\n    @resource\n    private redistemplate<string, object> redistemplate;\n\n    /**\n     * æ ¹æ®ç»å®çå¸éè¿æ»¤å¨æ·»å å¼\n     */\n    public <t> void addbybloomfilter(bloomfilterhelper<t> bloomfilterhelper, string key, t value) {\n        preconditions.checkargument(bloomfilterhelper != null, "bloomfilterhelperä¸è½ä¸ºç©º");\n        int[] offset = bloomfilterhelper.murmurhashoffset(value);\n        for (int i : offset) {\n            redistemplate.opsforvalue().setbit(key, i, true);\n        }\n    }\n\n    /**\n     * æ ¹æ®ç»å®çå¸éè¿æ»¤å¨å¤æ­å¼æ¯å¦å­å¨\n     */\n    public <t> boolean includebybloomfilter(bloomfilterhelper<t> bloomfilterhelper, string key, t value) {\n        preconditions.checkargument(bloomfilterhelper != null, "bloomfilterhelperä¸è½ä¸ºç©º");\n        int[] offset = bloomfilterhelper.murmurhashoffset(value);\n        for (int i : offset) {\n            if (!redistemplate.opsforvalue().getbit(key, i)) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n\n\nredisserviceå¾ç®åï¼åªæä¸¤ä¸ªæ¹æ³\n\naddbybloomfilterï¼å¾rediséé¢æ·»å åç´ \n\nincludebybloomfilterï¼æ£æ¥åç´ æ¯å¦å¨redis bloomfilteréé¢\n\nè¿éredisçå®¢æ·ç«¯ä½¿ç¨çæ¯spring-data-rediså°è£çï¼å¯ä»¥å¨æçé¡¹ç®springmvc-projectä¸­æ¥çå®æ´çä½¿ç¨ä»£ç ã',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/466af9/"},regularPath:"/10.%E6%A1%86%E6%9E%B6/70.%E5%A4%A7%E6%95%B0%E6%8D%AE/10.Spark/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"10.æ¡æ¶/70.å¤§æ°æ®/10.Spark/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-614b0a72",path:"/pages/466af9/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/d96f04/"},regularPath:"/10.%E6%A1%86%E6%9E%B6/70.%E5%A4%A7%E6%95%B0%E6%8D%AE/15.ClickHouse/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"10.æ¡æ¶/70.å¤§æ°æ®/15.ClickHouse/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-36fb0f35",path:"/pages/d96f04/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Gitä½¿ç¨æå",frontmatter:{title:"Gitä½¿ç¨æå",date:"2019-12-25T14:27:01.000Z",permalink:"/pages/9a7ee40fc232253e",categories:["ææ¯","ææ¯ææ¡£"],tags:[null],author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/100.%E5%85%B6%E4%BB%96/01.%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/01.Git%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C.html",relativePath:"100.å¶ä»/01.ææ¯ææ¡£/01.Gitä½¿ç¨æå.md",key:"v-47148396",path:"/pages/9a7ee40fc232253e/",headers:[{level:2,title:"å®è£",slug:"å®è£",normalizedTitle:"å®è£",charIndex:14},{level:2,title:"åå»ºçæ¬åºï¼ä»åºï¼",slug:"åå»ºçæ¬åº-ä»åº",normalizedTitle:"åå»ºçæ¬åºï¼ä»åºï¼",charIndex:296},{level:2,title:"æ·»å æä»¶å°ä»åº",slug:"æ·»å æä»¶å°ä»åº",normalizedTitle:"æ·»å æä»¶å°ä»åº",charIndex:478},{level:2,title:"çæ¬ç®¡ç",slug:"çæ¬ç®¡ç",normalizedTitle:"çæ¬ç®¡ç",charIndex:819},{level:2,title:"è¿ç¨ä»åº",slug:"è¿ç¨ä»åº",normalizedTitle:"è¿ç¨ä»åº",charIndex:1714},{level:2,title:"åæ¯ç®¡ç",slug:"åæ¯ç®¡ç",normalizedTitle:"åæ¯ç®¡ç",charIndex:2960},{level:2,title:"å¸®å©å½ä»¤",slug:"å¸®å©å½ä»¤",normalizedTitle:"å¸®å©å½ä»¤",charIndex:3360},{level:2,title:"åèææ¡£",slug:"åèææ¡£",normalizedTitle:"åèææ¡£",charIndex:7031}],excerpt:'<h1 id="gitä½¿ç¨æå"><a class="header-anchor" href="#gitä½¿ç¨æå">#</a> Gitä½¿ç¨æå</h1>\n<h2 id="å®è£"><a class="header-anchor" href="#å®è£">#</a> å®è£</h2>\n<p>å®ç½ä¸è½½ï¼<a href="https://git-scm.com/downloads" target="_blank" rel="noopener noreferrer">https://git-scm.com/downloads<OutboundLink/></a> ä¸è½½å®æåä½¿ç¨é»è®¤è¿è¡å®è£ã</p>\n<p>å®è£å®æåï¼å¨å¼å§èåéæ¾å° <code>Git</code> -&gt; <code>Git Bash</code>ï¼è¹¦åºä¸ä¸ªç±»ä¼¼å½ä»¤è¡çªå£çä¸è¥¿ï¼å°±è¯´æGitå®è£æåï¼\nè¿éè¦æåä¸æ­¥è®¾ç½®ï¼å¨å½ä»¤è¡è¾å¥ï¼</p>\n\x3c!--beforebegin--\x3e<div class="language-bash line-numbers-mode">\x3c!--afterbegin--\x3e<pre v-pre class="language-bash"><code><span class="token function">git</span> config --global user.name <span class="token string">"Your Name"</span>\n<span class="token function">git</span> config --global user.email <span class="token string">"email@example.com"</span>\n</code></pre>\n<div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div>\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<p>å ä¸ºGitæ¯åå¸å¼çæ¬æ§å¶ç³»ç»ï¼æä»¥ï¼æ¯ä¸ªæºå¨é½å¿é¡»èªæ¥å®¶é¨ï¼ä½ çåå­åEmailå°åã</p>\n',headersStr:"å®è£ åå»ºçæ¬åºï¼ä»åºï¼ æ·»å æä»¶å°ä»åº çæ¬ç®¡ç è¿ç¨ä»åº åæ¯ç®¡ç å¸®å©å½ä»¤ åèææ¡£",content:"# Gitä½¿ç¨æå\n\n\n# å®è£\n\nå®ç½ä¸è½½ï¼https://git-scm.com/downloads ä¸è½½å®æåä½¿ç¨é»è®¤è¿è¡å®è£ã\n\nå®è£å®æåï¼å¨å¼å§èåéæ¾å° Git -> Git Bashï¼è¹¦åºä¸ä¸ªç±»ä¼¼å½ä»¤è¡çªå£çä¸è¥¿ï¼å°±è¯´æGitå®è£æåï¼ è¿éè¦æåä¸æ­¥è®¾ç½®ï¼å¨å½ä»¤è¡è¾å¥ï¼\n\ngit config --global user.name \"Your Name\"\ngit config --global user.email \"email@example.com\"\n\n\n1\n2\n\n\nå ä¸ºGitæ¯åå¸å¼çæ¬æ§å¶ç³»ç»ï¼æä»¥ï¼æ¯ä¸ªæºå¨é½å¿é¡»èªæ¥å®¶é¨ï¼ä½ çåå­åEmailå°åã\n\n\n# åå»ºçæ¬åºï¼ä»åºï¼\n\n# åå»ºä»åº\nmkdir <ä»åºname> \n\n# è¿å¥ä»åº\ncd <ä»åºname>\n\n# æ­¤å½ä»¤ç¨äºæ¾ç¤ºå½åç®å½\npwd\n\n# æå½åç®å½åå§åæGitä»åº\ngit init\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n> ä¹ä¸ä¸å®å¿é¡»å¨ç©ºç®å½ä¸åå»ºGitä»åºï¼éæ©ä¸ä¸ªå·²ç»æä¸è¥¿çç®å½ç´æ¥git initä¹æ¯å¯ä»¥çã\n\n\n# æ·»å æä»¶å°ä»åº\n\nå¨ä»åºç®å½ä¸æ¾å¥æä»¶ï¼å¦æ°å»ºä¸ä¸ªtest.txtæä»¶ï¼ç¶åä½¿ç¨git add test.txtå½ä»¤åè¯Gitï¼ææä»¶æ·»å å°ç¼å­åºï¼ç¶åä½¿ç¨git commit -m \"æäº¤æè¿°\"åè¯Gitï¼ææä»¶æäº¤å°ä»åºã\n\n# æ·»å æå®æä»¶ææä»¶å¤¹å°ç¼å­åºï¼æä»¶éæ·»å åç¼\ngit add <æä»¶ææä»¶å¤¹name>                   # åä¸ªæä»¶\ngit add <æä»¶ææä»¶å¤¹name> <æä»¶ææä»¶å¤¹name>  # å¤ä¸ªæä»¶\n\n# æ å¨é¨æä»¶åæ¶æ·»å å°ç¼å­åº\ngit add .\n\n# ææä»¶ä»ç¼å­åºæäº¤è³ä»åº\ngit commit -m \"æäº¤æè¿°\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n# æäº¤æè¿°è§è\n\nå¨æäº¤ä»£ç æ¶è¾å¥æ¸æ°çè¯´ææå©äºçæ¬ç®¡çï¼å»ºè®®æ­éå¦ä¸å³é®å­ç¼åæäº¤æè¿°\n\n# æ°å»º(add)\n# å é¤(rm)\n# æ´æ°(update)\n# æ¹å¨(change)\n# å®ç°\n# åå¸\n# ä¿®å¤\n...\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# çæ¬ç®¡ç\n\n# æäº¤ä¿®æ¹\n\nå¦ä¿®æ¹test.txtçåå®¹åï¼è¿è¡git statuså½ä»¤ççè¢«ä¿®æ¹çæä»¶ï¼ç¶ååä½¿ç¨git add test.txtã git commit -m \"ä¿®æ¹æè¿°\"æä¿®æ¹åçæä»¶æäº¤å°ä»åºï¼æäº¤åå¯åæ¬¡ä½¿ç¨git statusæ¥çå½åç¶æã\n\n# æ¾ç¤º æ°å¢/å é¤/è¢«æ¹å¨ç­ çæä»¶\ngit status\n\n\n1\n2\n\n\n# æ¥ççæ¬è®°å½\n\n# æ¥ççæ¬è®°å½\ngit log   # æ¾ç¤ºçæ¬å·ãæäº¤æ¶é´ç­ä¿¡æ¯\n\n\n1\n2\n\n\n> ä¹å¯ä½¿ç¨å¯è§åå·¥å·æ¥çGitçæ¬åå²ï¼ å¨ä»åºç®å½å³é® > Git BUI Here\n\n# åéçæ¬\n\né¦åï¼Gitå¿é¡»ç¥éå½åçæ¬æ¯åªä¸ªçæ¬ï¼å¨Gitä¸­ï¼ç¨HEADè¡¨ç¤ºå½åçæ¬ï¼ä¹å°±æ¯ææ°çæäº¤1094adb...ï¼æ³¨ææçæäº¤IDåä½ çè¯å®ä¸ä¸æ ·ï¼ï¼ä¸ä¸ä¸ªçæ¬å°±æ¯HEAD^ï¼ä¸ä¸ä¸ä¸ªçæ¬å°±æ¯HEAD^^ï¼å½ç¶å¾ä¸100ä¸ªçæ¬å100ä¸ª^æ¯è¾å®¹ææ°ä¸è¿æ¥ï¼æä»¥åæHEAD~100ã\n\n# åéå°ä¸ä¸ä¸ªçæ¬\n$ git reset --hard HEAD^\n\n\n1\n2\n\n\næ­¤æ¶æ¥çgit logè®°å½åç°ï¼åæ¥ææ°ççæ¬å·²ç»æ²¡æäºï¼æ³åå°åæ¥ææ°ççæ¬æä¹åï¼è¿å°±éè¦ç¥éææ°ççæ¬ççæ¬å·\n\n# è·³è½¬å°æå®çæ¬\ngit reset --hard <çæ¬å·åå ä½>\n\n\n1\n2\n\n\nä½æ¯ä¸ç¥éçæ¬å·æä¹åï¼Gitæä¾äºä¸ä¸ªå½ä»¤git reflogç¨æ¥è®°å½ä½ çæ¯ä¸æ¬¡å½ä»¤\n\ngit reflog\n\n\n1\n\n\n# æ¤éä¿®æ¹\n\nhttps://www.liaoxuefeng.com/wiki/896043488029600/897889638509536\n\n# å é¤æä»¶\n\nhttps://www.liaoxuefeng.com/wiki/896043488029600/900002180232448\n\n\n# è¿ç¨ä»åº\n\n# SSHéªè¯\n\nä½¿æ¬æºè½å³èè¿ç¨ä»åºï¼é¦æ¬¡éè¦SSHéªè¯\n\n * ç¬¬1æ­¥ï¼åå»ºSSH Keyãå¨ç¨æ·ä¸»ï¼C:\\Users\\dellï¼ç®å½ä¸ï¼ççææ²¡æ.sshç®å½ï¼ å¦ææï¼åççè¿ä¸ªç®å½ä¸ææ²¡æid_rsaåid_rsa.pubè¿ä¸¤ä¸ªæä»¶ï¼å¦æå·²ç»æäºï¼å¯ç´æ¥è·³å°ä¸ä¸æ­¥ã å¦ææ²¡æï¼æå¼Shellï¼Windowsä¸æå¼Git Bashï¼ï¼åå»ºSSH Keyï¼\n\n# åå»ºSSH Key\nssh-keygen -t rsa -C \"é®ä»¶å°å\"\n\n\n1\n2\n\n * ç¬¬2æ­¥ï¼ç»éGitHubï¼å³ä¸è§å¤´å > settings > SSH and GPG keys >Add SSH Keyï¼å¨keyçææ¬æ¡éç²è´´id_rsa.pubæä»¶çåå®¹\n\n# å³èè¿ç¨ä»åº\n\nSSHéªè¯å®æåï¼å¨githubåå»ºä»åºï¼åå»ºä»åºæ¶è®°å¾åæ¶ Initialize this repository with a READMEçå¾éï¼ç¶åå¨æ¬å°å½ä»¤ï¼\n\n# å³èè¿ç¨ä»åºï¼ä»åºåä¸è¬ä½¿ç¨origin\ngit remote add <ä»åºå> <è¿ç¨ä»åºå°å>\n\n# ç¤ºä¾\ngit remote add origin git@github.com:xugaoyi/test.git\n\n\n1\n2\n3\n4\n5\n\n\nä¸ä¸æ­¥ï¼å°±å¯ä»¥ææ¬å°åºçææåå®¹æ¨éå°è¿ç¨åºä¸\n\n# ææä»¶æ¨éå°è¿ç¨ä»åº\ngit push -u <ä»åºå> <åæ¯å>\n\n# ç¤ºä¾\ngit push -u origin master\n\n\n1\n2\n3\n4\n5\n\n\nç±äºè¿ç¨åºæ¯ç©ºçï¼æä»¬ç¬¬ä¸æ¬¡æ¨émasteråæ¯æ¶ï¼å ä¸äº-uåæ°ï¼Gitä¸ä½ä¼ææ¬å°çmasteråæ¯åå®¹æ¨éçè¿ç¨æ°çmasteråæ¯ï¼è¿ä¼ææ¬å°çmasteråæ¯åè¿ç¨çmasteråæ¯å³èèµ·æ¥ï¼å¨ä»¥åçæ¨éæèæåæ¶å°±å¯ä»¥ç®åå½ä»¤ã\n\n> åææ¯ç®å½å·²ç»git initåå§åæä»åºï¼å¹¶ä¸git statusç¶ææ¯æ²¡ææ¹å¨çï¼å¦æææ¹å¨åågit add .æ·»å è³ç¼å­åºï¼git commit -m 'æäº¤æè¿°'æäº¤è³ä»åºï¼ç¶åæ§è¡ä¸é¢å½ä»¤ã\n> \n> å¦åå»ºä»åºæ¶å¾éäº Initialize this repository with a README åéåæåREADME.mdæä»¶å°æ¬å°ä»åºgit pull\n> \n> å¯å³èå¤ä¸ªè¿ç¨ä»åºï¼æ³¨æç»ä¸åçè¿ç¨ä»åºåä¸ä¸æ ·çåç§°ï¼æäº¤æ¯åå«æåç§°æäº¤å°ä¸ä¸æ ·çè¿ç¨ä»åºã\n\n# ç®åçæ¨éå½ä»¤\ngit push\n\n\n1\n2\n\n\n# æ¥çè¿ç¨ä»åº\n\n# æ¥çè¿ç¨ä»åº\ngit remote -v\n\n\n1\n2\n\n\n# å é¤è¿ç¨ä»åº\n\n# å é¤è¿ç¨ä»åº\ngit remote rm <ä»åºå>\n\n\n1\n2\n\n\n# ä»è¿ç¨åºåéé¡¹ç®\n\n# ä»è¿ç¨åºåéé¡¹ç®\ngit clone <ä»åºå°å>\n\n\n1\n2\n\n\n# åéæå®åæ¯\n\n# åéæå®åæ¯\ngit clone -b <åæ¯å> <ä»åºå°å>\n\n\n1\n2\n\n\n\n# åæ¯ç®¡ç\n\n# åå»ºåæ¯\n\n# åå»ºåæ¯\ngit checkout -b <åæ¯å>\n\n\n1\n2\n\n\n# æ¥çåæ¯\n\n# æ¥çåæ¯\ngit branch\n\n\n1\n2\n\n\næ¥çåæ¯æ¶ï¼å¨åæ¯åå¸¦ * å·çè¡¨ç¤ºå½åçåæ¯\n\n# åæ¢åæ¯\n\n# åæ¢åæ¯\ngit checkout <åæ¯å>\n\n\n1\n2\n\n\n# åå¹¶åæ¯\n\n# åå¹¶æ¬å°çåæ¯\ngit merge <åæ¯å>\n\n# åå¹¶è¿ç¨çåæ¯\ngit merge <è¿ç¨ä»åºå>/<åæ¯å>\n\n\n1\n2\n3\n4\n5\n\n\næ³¨æï¼æ¯å°æå®åæ¯åå¹¶å°å½ååæ¯ï¼å¹¶éå½ååæ¯åå¹¶å°æå®åæ¯ã\n\nä¸è¬æåµä¸æ¯æå½ååæ¯åæ¢å°ä¸»åæ¯ï¼ç¶åæå­åæ¯åå¹¶å°ä¸»åæ¯ã\n\n# å é¤åæ¯\n\n# å é¤åæ¯\ngit branch -d <åæ¯å>\n\n\n1\n2\n\n\n# ä¿®æ¹åæ¯å\n\n# ä¿®æ¹åæ¯å\ngit branch -m <ååæ¯å> <æ°åæ¯å>\n\n\n1\n2\n\n\n\n# å¸®å©å½ä»¤\n\nå¦å¯¹å½ä»¤ä¸æ¸æ¥æ¶ï¼å¯ä½¿ç¨git helpå½ä»¤æ¾ç¤ºåºgitå½ä»¤ä»ç»ã\n\n# å¸®å©å½ä»¤\ngit help\n\n\n1\n2\n\n\n$ git help\nusage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   reset      Reset current HEAD to the specified state\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   branch     List, create, or delete branches\n   checkout   Switch branches or restore working tree files\n   commit     Record changes to the repository\n   diff       Show changes between commits, commit and working tree, etc\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n\n\nç¿»è¯å·¥å·ç¿»è¯ä¸­æ\n\n$ git help\nä½¿ç¨ï¼git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nè¿äºæ¯å¨åç§æåµä¸ä½¿ç¨çéç¨Gitå½ä»¤ï¼\n\nstart a working area (åè§å½ä»¤: git help tutorial)\n   clone      å°å­å¨åºåéå°æ°ç®å½ä¸­\n   init       åå»ºä¸ä¸ªç©ºçGitå­å¨åºæéæ°åå§åä¸ä¸ªç°æçå­å¨åº\n\nwork on the current change (åè§å½ä»¤: git help everyday)\n   add        å°æä»¶åå®¹æ·»å å°ç´¢å¼ä¸­\n   mv         ç§»å¨æéå½åæä»¶ãç®å½æç¬¦å·é¾æ¥\n   reset      å°å½åç£å¤´éç½®ä¸ºæå®ç¶æ\n   rm         ä»å·¥ä½æ åç´¢å¼ä¸­å é¤æä»¶\n\nexamine the history and state (åè§å½ä»¤: git help revisions)\n   bisect     ä½¿ç¨äºåæ¥æ¾æ¥æ¾å¼å¥éè¯¯çæäº¤\n   grep       æå°ä¸æ¨¡å¼å¹éçè¡\n   log        æ¾ç¤ºæäº¤æ¥å¿\n   show       æ¾ç¤ºåç§ç±»åçå¯¹è±¡\n   status     æ¾ç¤ºå·¥ä½æ ç¶æ\n\ngrow, mark and tweak your common history\n   branch     ååºãåå»ºæå é¤åæ¯\n   checkout   åæ¢åæ¯æè¿åå·¥ä½æ æä»¶\n   commit     è®°å½å¯¹å­å¨åºçæ´æ¹\n   diff       æ¾ç¤ºæäº¤ãæäº¤åå·¥ä½æ ç­ä¹é´çæ´æ¹\n   merge      å°ä¸¤ä¸ªæå¤ä¸ªå¼ååå²è¿æ¥å¨ä¸èµ·\n   rebase     å¨å¦ä¸ä¸ªåºæ¬æç¤ºä¹ä¸éæ°åºç¨æäº¤\n   tag        åå»ºãåè¡¨ãå é¤æéªè¯ç¨GPGç­¾åçæ è®°å¯¹è±¡\n\ncollaborate (åè§å½ä»¤: git help workflows)\n   fetch      ä»å¦ä¸ä¸ªå­å¨åºä¸è½½å¯¹è±¡åå¼ç¨\n   pull       ä»å¦ä¸ä¸ªå­å¨åºææ¬å°åæ¯è·åå¹¶ä¸ä¹éæ\n   push       æ´æ°è¿ç¨å¼ç¨åç¸å³å¯¹è±¡\n\n'git help -a' å 'git help -g' ååºå¯ç¨çå­å½ä»¤åä¸äºæ¦å¿µæå¯¼ã\nå½ä»¤'git help <command>' æ 'git help <concept>' æ¥çç¹å®å­å½ä»¤ææ¦å¿µ.\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n\n\n\n# åèææ¡£\n\nhttps://www.liaoxuefeng.com/wiki/896043488029600",normalizedContent:"# gitä½¿ç¨æå\n\n\n# å®è£\n\nå®ç½ä¸è½½ï¼https://git-scm.com/downloads ä¸è½½å®æåä½¿ç¨é»è®¤è¿è¡å®è£ã\n\nå®è£å®æåï¼å¨å¼å§èåéæ¾å° git -> git bashï¼è¹¦åºä¸ä¸ªç±»ä¼¼å½ä»¤è¡çªå£çä¸è¥¿ï¼å°±è¯´ægitå®è£æåï¼ è¿éè¦æåä¸æ­¥è®¾ç½®ï¼å¨å½ä»¤è¡è¾å¥ï¼\n\ngit config --global user.name \"your name\"\ngit config --global user.email \"email@example.com\"\n\n\n1\n2\n\n\nå ä¸ºgitæ¯åå¸å¼çæ¬æ§å¶ç³»ç»ï¼æä»¥ï¼æ¯ä¸ªæºå¨é½å¿é¡»èªæ¥å®¶é¨ï¼ä½ çåå­åemailå°åã\n\n\n# åå»ºçæ¬åºï¼ä»åºï¼\n\n# åå»ºä»åº\nmkdir <ä»åºname> \n\n# è¿å¥ä»åº\ncd <ä»åºname>\n\n# æ­¤å½ä»¤ç¨äºæ¾ç¤ºå½åç®å½\npwd\n\n# æå½åç®å½åå§åægitä»åº\ngit init\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n> ä¹ä¸ä¸å®å¿é¡»å¨ç©ºç®å½ä¸åå»ºgitä»åºï¼éæ©ä¸ä¸ªå·²ç»æä¸è¥¿çç®å½ç´æ¥git initä¹æ¯å¯ä»¥çã\n\n\n# æ·»å æä»¶å°ä»åº\n\nå¨ä»åºç®å½ä¸æ¾å¥æä»¶ï¼å¦æ°å»ºä¸ä¸ªtest.txtæä»¶ï¼ç¶åä½¿ç¨git add test.txtå½ä»¤åè¯gitï¼ææä»¶æ·»å å°ç¼å­åºï¼ç¶åä½¿ç¨git commit -m \"æäº¤æè¿°\"åè¯gitï¼ææä»¶æäº¤å°ä»åºã\n\n# æ·»å æå®æä»¶ææä»¶å¤¹å°ç¼å­åºï¼æä»¶éæ·»å åç¼\ngit add <æä»¶ææä»¶å¤¹name>                   # åä¸ªæä»¶\ngit add <æä»¶ææä»¶å¤¹name> <æä»¶ææä»¶å¤¹name>  # å¤ä¸ªæä»¶\n\n# æ å¨é¨æä»¶åæ¶æ·»å å°ç¼å­åº\ngit add .\n\n# ææä»¶ä»ç¼å­åºæäº¤è³ä»åº\ngit commit -m \"æäº¤æè¿°\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n# æäº¤æè¿°è§è\n\nå¨æäº¤ä»£ç æ¶è¾å¥æ¸æ°çè¯´ææå©äºçæ¬ç®¡çï¼å»ºè®®æ­éå¦ä¸å³é®å­ç¼åæäº¤æè¿°\n\n# æ°å»º(add)\n# å é¤(rm)\n# æ´æ°(update)\n# æ¹å¨(change)\n# å®ç°\n# åå¸\n# ä¿®å¤\n...\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# çæ¬ç®¡ç\n\n# æäº¤ä¿®æ¹\n\nå¦ä¿®æ¹test.txtçåå®¹åï¼è¿è¡git statuså½ä»¤ççè¢«ä¿®æ¹çæä»¶ï¼ç¶ååä½¿ç¨git add test.txtã git commit -m \"ä¿®æ¹æè¿°\"æä¿®æ¹åçæä»¶æäº¤å°ä»åºï¼æäº¤åå¯åæ¬¡ä½¿ç¨git statusæ¥çå½åç¶æã\n\n# æ¾ç¤º æ°å¢/å é¤/è¢«æ¹å¨ç­ çæä»¶\ngit status\n\n\n1\n2\n\n\n# æ¥ççæ¬è®°å½\n\n# æ¥ççæ¬è®°å½\ngit log   # æ¾ç¤ºçæ¬å·ãæäº¤æ¶é´ç­ä¿¡æ¯\n\n\n1\n2\n\n\n> ä¹å¯ä½¿ç¨å¯è§åå·¥å·æ¥çgitçæ¬åå²ï¼ å¨ä»åºç®å½å³é® > git bui here\n\n# åéçæ¬\n\né¦åï¼gitå¿é¡»ç¥éå½åçæ¬æ¯åªä¸ªçæ¬ï¼å¨gitä¸­ï¼ç¨headè¡¨ç¤ºå½åçæ¬ï¼ä¹å°±æ¯ææ°çæäº¤1094adb...ï¼æ³¨ææçæäº¤idåä½ çè¯å®ä¸ä¸æ ·ï¼ï¼ä¸ä¸ä¸ªçæ¬å°±æ¯head^ï¼ä¸ä¸ä¸ä¸ªçæ¬å°±æ¯head^^ï¼å½ç¶å¾ä¸100ä¸ªçæ¬å100ä¸ª^æ¯è¾å®¹ææ°ä¸è¿æ¥ï¼æä»¥åæhead~100ã\n\n# åéå°ä¸ä¸ä¸ªçæ¬\n$ git reset --hard head^\n\n\n1\n2\n\n\næ­¤æ¶æ¥çgit logè®°å½åç°ï¼åæ¥ææ°ççæ¬å·²ç»æ²¡æäºï¼æ³åå°åæ¥ææ°ççæ¬æä¹åï¼è¿å°±éè¦ç¥éææ°ççæ¬ççæ¬å·\n\n# è·³è½¬å°æå®çæ¬\ngit reset --hard <çæ¬å·åå ä½>\n\n\n1\n2\n\n\nä½æ¯ä¸ç¥éçæ¬å·æä¹åï¼gitæä¾äºä¸ä¸ªå½ä»¤git reflogç¨æ¥è®°å½ä½ çæ¯ä¸æ¬¡å½ä»¤\n\ngit reflog\n\n\n1\n\n\n# æ¤éä¿®æ¹\n\nhttps://www.liaoxuefeng.com/wiki/896043488029600/897889638509536\n\n# å é¤æä»¶\n\nhttps://www.liaoxuefeng.com/wiki/896043488029600/900002180232448\n\n\n# è¿ç¨ä»åº\n\n# sshéªè¯\n\nä½¿æ¬æºè½å³èè¿ç¨ä»åºï¼é¦æ¬¡éè¦sshéªè¯\n\n * ç¬¬1æ­¥ï¼åå»ºssh keyãå¨ç¨æ·ä¸»ï¼c:\\users\\dellï¼ç®å½ä¸ï¼ççææ²¡æ.sshç®å½ï¼ å¦ææï¼åççè¿ä¸ªç®å½ä¸ææ²¡æid_rsaåid_rsa.pubè¿ä¸¤ä¸ªæä»¶ï¼å¦æå·²ç»æäºï¼å¯ç´æ¥è·³å°ä¸ä¸æ­¥ã å¦ææ²¡æï¼æå¼shellï¼windowsä¸æå¼git bashï¼ï¼åå»ºssh keyï¼\n\n# åå»ºssh key\nssh-keygen -t rsa -c \"é®ä»¶å°å\"\n\n\n1\n2\n\n * ç¬¬2æ­¥ï¼ç»égithubï¼å³ä¸è§å¤´å > settings > ssh and gpg keys >add ssh keyï¼å¨keyçææ¬æ¡éç²è´´id_rsa.pubæä»¶çåå®¹\n\n# å³èè¿ç¨ä»åº\n\nsshéªè¯å®æåï¼å¨githubåå»ºä»åºï¼åå»ºä»åºæ¶è®°å¾åæ¶ initialize this repository with a readmeçå¾éï¼ç¶åå¨æ¬å°å½ä»¤ï¼\n\n# å³èè¿ç¨ä»åºï¼ä»åºåä¸è¬ä½¿ç¨origin\ngit remote add <ä»åºå> <è¿ç¨ä»åºå°å>\n\n# ç¤ºä¾\ngit remote add origin git@github.com:xugaoyi/test.git\n\n\n1\n2\n3\n4\n5\n\n\nä¸ä¸æ­¥ï¼å°±å¯ä»¥ææ¬å°åºçææåå®¹æ¨éå°è¿ç¨åºä¸\n\n# ææä»¶æ¨éå°è¿ç¨ä»åº\ngit push -u <ä»åºå> <åæ¯å>\n\n# ç¤ºä¾\ngit push -u origin master\n\n\n1\n2\n3\n4\n5\n\n\nç±äºè¿ç¨åºæ¯ç©ºçï¼æä»¬ç¬¬ä¸æ¬¡æ¨émasteråæ¯æ¶ï¼å ä¸äº-uåæ°ï¼gitä¸ä½ä¼ææ¬å°çmasteråæ¯åå®¹æ¨éçè¿ç¨æ°çmasteråæ¯ï¼è¿ä¼ææ¬å°çmasteråæ¯åè¿ç¨çmasteråæ¯å³èèµ·æ¥ï¼å¨ä»¥åçæ¨éæèæåæ¶å°±å¯ä»¥ç®åå½ä»¤ã\n\n> åææ¯ç®å½å·²ç»git initåå§åæä»åºï¼å¹¶ä¸git statusç¶ææ¯æ²¡ææ¹å¨çï¼å¦æææ¹å¨åågit add .æ·»å è³ç¼å­åºï¼git commit -m 'æäº¤æè¿°'æäº¤è³ä»åºï¼ç¶åæ§è¡ä¸é¢å½ä»¤ã\n> \n> å¦åå»ºä»åºæ¶å¾éäº initialize this repository with a readme åéåæåreadme.mdæä»¶å°æ¬å°ä»åºgit pull\n> \n> å¯å³èå¤ä¸ªè¿ç¨ä»åºï¼æ³¨æç»ä¸åçè¿ç¨ä»åºåä¸ä¸æ ·çåç§°ï¼æäº¤æ¯åå«æåç§°æäº¤å°ä¸ä¸æ ·çè¿ç¨ä»åºã\n\n# ç®åçæ¨éå½ä»¤\ngit push\n\n\n1\n2\n\n\n# æ¥çè¿ç¨ä»åº\n\n# æ¥çè¿ç¨ä»åº\ngit remote -v\n\n\n1\n2\n\n\n# å é¤è¿ç¨ä»åº\n\n# å é¤è¿ç¨ä»åº\ngit remote rm <ä»åºå>\n\n\n1\n2\n\n\n# ä»è¿ç¨åºåéé¡¹ç®\n\n# ä»è¿ç¨åºåéé¡¹ç®\ngit clone <ä»åºå°å>\n\n\n1\n2\n\n\n# åéæå®åæ¯\n\n# åéæå®åæ¯\ngit clone -b <åæ¯å> <ä»åºå°å>\n\n\n1\n2\n\n\n\n# åæ¯ç®¡ç\n\n# åå»ºåæ¯\n\n# åå»ºåæ¯\ngit checkout -b <åæ¯å>\n\n\n1\n2\n\n\n# æ¥çåæ¯\n\n# æ¥çåæ¯\ngit branch\n\n\n1\n2\n\n\næ¥çåæ¯æ¶ï¼å¨åæ¯åå¸¦ * å·çè¡¨ç¤ºå½åçåæ¯\n\n# åæ¢åæ¯\n\n# åæ¢åæ¯\ngit checkout <åæ¯å>\n\n\n1\n2\n\n\n# åå¹¶åæ¯\n\n# åå¹¶æ¬å°çåæ¯\ngit merge <åæ¯å>\n\n# åå¹¶è¿ç¨çåæ¯\ngit merge <è¿ç¨ä»åºå>/<åæ¯å>\n\n\n1\n2\n3\n4\n5\n\n\næ³¨æï¼æ¯å°æå®åæ¯åå¹¶å°å½ååæ¯ï¼å¹¶éå½ååæ¯åå¹¶å°æå®åæ¯ã\n\nä¸è¬æåµä¸æ¯æå½ååæ¯åæ¢å°ä¸»åæ¯ï¼ç¶åæå­åæ¯åå¹¶å°ä¸»åæ¯ã\n\n# å é¤åæ¯\n\n# å é¤åæ¯\ngit branch -d <åæ¯å>\n\n\n1\n2\n\n\n# ä¿®æ¹åæ¯å\n\n# ä¿®æ¹åæ¯å\ngit branch -m <ååæ¯å> <æ°åæ¯å>\n\n\n1\n2\n\n\n\n# å¸®å©å½ä»¤\n\nå¦å¯¹å½ä»¤ä¸æ¸æ¥æ¶ï¼å¯ä½¿ç¨git helpå½ä»¤æ¾ç¤ºåºgitå½ä»¤ä»ç»ã\n\n# å¸®å©å½ä»¤\ngit help\n\n\n1\n2\n\n\n$ git help\nusage: git [--version] [--help] [-c <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -p | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nthese are common git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      clone a repository into a new directory\n   init       create an empty git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        add file contents to the index\n   mv         move or rename a file, a directory, or a symlink\n   reset      reset current head to the specified state\n   rm         remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     use binary search to find the commit that introduced a bug\n   grep       print lines matching a pattern\n   log        show commit logs\n   show       show various types of objects\n   status     show the working tree status\n\ngrow, mark and tweak your common history\n   branch     list, create, or delete branches\n   checkout   switch branches or restore working tree files\n   commit     record changes to the repository\n   diff       show changes between commits, commit and working tree, etc\n   merge      join two or more development histories together\n   rebase     reapply commits on top of another base tip\n   tag        create, list, delete or verify a tag object signed with gpg\n\ncollaborate (see also: git help workflows)\n   fetch      download objects and refs from another repository\n   pull       fetch from and integrate with another repository or a local branch\n   push       update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. see 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n\n\nç¿»è¯å·¥å·ç¿»è¯ä¸­æ\n\n$ git help\nä½¿ç¨ï¼git [--version] [--help] [-c <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -p | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nè¿äºæ¯å¨åç§æåµä¸ä½¿ç¨çéç¨gitå½ä»¤ï¼\n\nstart a working area (åè§å½ä»¤: git help tutorial)\n   clone      å°å­å¨åºåéå°æ°ç®å½ä¸­\n   init       åå»ºä¸ä¸ªç©ºçgitå­å¨åºæéæ°åå§åä¸ä¸ªç°æçå­å¨åº\n\nwork on the current change (åè§å½ä»¤: git help everyday)\n   add        å°æä»¶åå®¹æ·»å å°ç´¢å¼ä¸­\n   mv         ç§»å¨æéå½åæä»¶ãç®å½æç¬¦å·é¾æ¥\n   reset      å°å½åç£å¤´éç½®ä¸ºæå®ç¶æ\n   rm         ä»å·¥ä½æ åç´¢å¼ä¸­å é¤æä»¶\n\nexamine the history and state (åè§å½ä»¤: git help revisions)\n   bisect     ä½¿ç¨äºåæ¥æ¾æ¥æ¾å¼å¥éè¯¯çæäº¤\n   grep       æå°ä¸æ¨¡å¼å¹éçè¡\n   log        æ¾ç¤ºæäº¤æ¥å¿\n   show       æ¾ç¤ºåç§ç±»åçå¯¹è±¡\n   status     æ¾ç¤ºå·¥ä½æ ç¶æ\n\ngrow, mark and tweak your common history\n   branch     ååºãåå»ºæå é¤åæ¯\n   checkout   åæ¢åæ¯æè¿åå·¥ä½æ æä»¶\n   commit     è®°å½å¯¹å­å¨åºçæ´æ¹\n   diff       æ¾ç¤ºæäº¤ãæäº¤åå·¥ä½æ ç­ä¹é´çæ´æ¹\n   merge      å°ä¸¤ä¸ªæå¤ä¸ªå¼ååå²è¿æ¥å¨ä¸èµ·\n   rebase     å¨å¦ä¸ä¸ªåºæ¬æç¤ºä¹ä¸éæ°åºç¨æäº¤\n   tag        åå»ºãåè¡¨ãå é¤æéªè¯ç¨gpgç­¾åçæ è®°å¯¹è±¡\n\ncollaborate (åè§å½ä»¤: git help workflows)\n   fetch      ä»å¦ä¸ä¸ªå­å¨åºä¸è½½å¯¹è±¡åå¼ç¨\n   pull       ä»å¦ä¸ä¸ªå­å¨åºææ¬å°åæ¯è·åå¹¶ä¸ä¹éæ\n   push       æ´æ°è¿ç¨å¼ç¨åç¸å³å¯¹è±¡\n\n'git help -a' å 'git help -g' ååºå¯ç¨çå­å½ä»¤åä¸äºæ¦å¿µæå¯¼ã\nå½ä»¤'git help <command>' æ 'git help <concept>' æ¥çç¹å®å­å½ä»¤ææ¦å¿µ.\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n\n\n\n# åèææ¡£\n\nhttps://www.liaoxuefeng.com/wiki/896043488029600",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Markdownä½¿ç¨æç¨",frontmatter:{title:"Markdownä½¿ç¨æç¨",date:"2019-12-25T14:27:01.000Z",permalink:"/pages/ad247c4332211551",categories:["ææ¯","ææ¯ææ¡£"],tags:[null],author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/100.%E5%85%B6%E4%BB%96/01.%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/02.Markdown%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B.html",relativePath:"100.å¶ä»/01.ææ¯ææ¡£/02.Markdownä½¿ç¨æç¨.md",key:"v-38b5a542",path:"/pages/ad247c4332211551/",headers:[{level:2,title:"ä¸ãMarkdown",slug:"ä¸ãmarkdown",normalizedTitle:"ä¸ãmarkdown",charIndex:19},{level:3,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:34},{level:3,title:"åºç¨",slug:"åºç¨",normalizedTitle:"åºç¨",charIndex:87},{level:3,title:"ç¼è¾å¨",slug:"ç¼è¾å¨",normalizedTitle:"ç¼è¾å¨",charIndex:152},{level:2,title:"äºãå¾½ç« ",slug:"äºãå¾½ç« ",normalizedTitle:"äºãå¾½ç« ",charIndex:194},{level:2,title:"ä¸ãè®¾ç½®ç®å½",slug:"ä¸ãè®¾ç½®ç®å½",normalizedTitle:"ä¸ãè®¾ç½®ç®å½",charIndex:579},{level:2,title:"åãæ é¢",slug:"åãæ é¢",normalizedTitle:"åãæ é¢",charIndex:1197},{level:2,title:"äºçº§æ é¢",slug:"äºçº§æ é¢",normalizedTitle:"äºçº§æ é¢",charIndex:1215},{level:3,title:"ä¸çº§æ é¢",slug:"ä¸çº§æ é¢",normalizedTitle:"ä¸çº§æ é¢",charIndex:1227},{level:2,title:"äºãææ¬",slug:"äºãææ¬",normalizedTitle:"äºãææ¬",charIndex:1285},{level:3,title:"æ®µè½",slug:"æ®µè½",normalizedTitle:"æ®µè½",charIndex:1297},{level:3,title:"å­ä½",slug:"å­ä½",normalizedTitle:"å­ä½",charIndex:1307},{level:3,title:"å é¤çº¿",slug:"å é¤çº¿",normalizedTitle:"å é¤çº¿",charIndex:1317},{level:3,title:"ä¸åçº¿",slug:"ä¸åçº¿",normalizedTitle:"ä¸åçº¿",charIndex:1328},{level:3,title:"æå­é«äº®",slug:"æå­é«äº®",normalizedTitle:"æå­é«äº®",charIndex:1339},{level:3,title:"åéçº¿",slug:"åéçº¿",normalizedTitle:"åéçº¿",charIndex:1351},{level:3,title:"èæ³¨",slug:"èæ³¨",normalizedTitle:"èæ³¨",charIndex:1362},{level:2,title:"å­ãåè¡¨",slug:"å­ãåè¡¨",normalizedTitle:"å­ãåè¡¨",charIndex:1370},{level:3,title:"æ åºåè¡¨",slug:"æ åºåè¡¨",normalizedTitle:"æ åºåè¡¨",charIndex:1382},{level:3,title:"æåºåè¡¨",slug:"æåºåè¡¨",normalizedTitle:"æåºåè¡¨",charIndex:1394},{level:3,title:"æå åè¡¨",slug:"æå åè¡¨",normalizedTitle:"æå åè¡¨",charIndex:1406},{level:3,title:"å¸¦å¤éæ¡åè¡¨",slug:"å¸¦å¤éæ¡åè¡¨",normalizedTitle:"å¸¦å¤éæ¡åè¡¨",charIndex:1418},{level:3,title:"åè¡¨åµå¥",slug:"åè¡¨åµå¥",normalizedTitle:"åè¡¨åµå¥",charIndex:1432},{level:2,title:"ä¸ãåºåå¼ç¨",slug:"ä¸ãåºåå¼ç¨",normalizedTitle:"ä¸ãåºåå¼ç¨",charIndex:1442},{level:2,title:"å«ãä»£ç ",slug:"å«ãä»£ç ",normalizedTitle:"å«ãä»£ç ",charIndex:1496},{level:3,title:"ä»£ç åºå",slug:"ä»£ç åºå",normalizedTitle:"ä»£ç åºå",charIndex:1508},{level:2,title:"ä¹ãé¾æ¥",slug:"ä¹ãé¾æ¥",normalizedTitle:"ä¹ãé¾æ¥",charIndex:1518},{level:3,title:"åéé¾æ¥",slug:"åéé¾æ¥",normalizedTitle:"åéé¾æ¥",charIndex:1530},{level:3,title:"Githubä»åºä¸­ä½¿ç¨åé¨é¾æ¥",slug:"githubä»åºä¸­ä½¿ç¨åé¨é¾æ¥",normalizedTitle:"githubä»åºä¸­ä½¿ç¨åé¨é¾æ¥",charIndex:4923},{level:3,title:"éç¹é¾æ¥",slug:"éç¹é¾æ¥",normalizedTitle:"éç¹é¾æ¥",charIndex:1563},{level:2,title:"åãå¾ç",slug:"åãå¾ç",normalizedTitle:"åãå¾ç",charIndex:1573},{level:3,title:"å¾çå®½é«",slug:"å¾çå®½é«",normalizedTitle:"å¾çå®½é«",charIndex:1585},{level:3,title:"ç¸å¯¹è·¯å¾ä»¥åGithubä¸­ä½¿ç¨å¾ç",slug:"ç¸å¯¹è·¯å¾ä»¥ågithubä¸­ä½¿ç¨å¾ç",normalizedTitle:"ç¸å¯¹è·¯å¾ä»¥ågithubä¸­ä½¿ç¨å¾ç",charIndex:1597},{level:2,title:"åä¸ãè¡¨æ ¼",slug:"åä¸ãè¡¨æ ¼",normalizedTitle:"åä¸ãè¡¨æ ¼",charIndex:1620},{level:2,title:"åäºãEmojiè¡¨æå",slug:"åäºãemojiè¡¨æå",normalizedTitle:"åäºãemojiè¡¨æå",charIndex:1631},{level:2,title:"åä¸ãå¶ä»æå·§",slug:"åä¸ãå¶ä»æå·§",normalizedTitle:"åä¸ãå¶ä»æå·§",charIndex:1648},{level:3,title:"æ¯æç HTML åç´ ",slug:"æ¯æç-html-åç´ ",normalizedTitle:"æ¯æç html åç´ ",charIndex:1663},{level:3,title:"è½¬ä¹",slug:"è½¬ä¹",normalizedTitle:"è½¬ä¹",charIndex:1682},{level:3,title:"æ°å­¦å¬å¼",slug:"æ°å­¦å¬å¼",normalizedTitle:"æ°å­¦å¬å¼",charIndex:1692},{level:3,title:"å¾è¡¨",slug:"å¾è¡¨",normalizedTitle:"å¾è¡¨",charIndex:1704},{level:3,title:"æµç¨å¾",slug:"æµç¨å¾",normalizedTitle:"æµç¨å¾",charIndex:1714},{level:3,title:"æ¶åºå¾",slug:"æ¶åºå¾",normalizedTitle:"æ¶åºå¾",charIndex:1725},{level:3,title:"çç¹å¾",slug:"çç¹å¾",normalizedTitle:"çç¹å¾",charIndex:1736}],excerpt:'<h1 id="markdownä½¿ç¨æç¨"><a class="header-anchor" href="#markdownä½¿ç¨æç¨">#</a> Markdownä½¿ç¨æç¨</h1>\n<h2 id="ä¸ãmarkdown"><a class="header-anchor" href="#ä¸ãmarkdown">#</a> ä¸ãMarkdown</h2>\n<h3 id="ç®ä»"><a class="header-anchor" href="#ç®ä»">#</a> ç®ä»</h3>\n<p><img src="https://raw.githubusercontent.com/xugaoyi/image_store/master/blog/md_logo.png" alt="logo"></p>\n<p><code>Markdown</code> æ¯ä¸ç§è½»éçº§æ è®°è¯­è¨ï¼å®åè®¸äººä»¬ä½¿ç¨æè¯»æåççº¯ææ¬æ ¼å¼ç¼åææ¡£ã</p>\n',headersStr:"ä¸ãMarkdown ç®ä» åºç¨ ç¼è¾å¨ äºãå¾½ç«  ä¸ãè®¾ç½®ç®å½ åãæ é¢ äºçº§æ é¢ ä¸çº§æ é¢ äºãææ¬ æ®µè½ å­ä½ å é¤çº¿ ä¸åçº¿ æå­é«äº® åéçº¿ èæ³¨ å­ãåè¡¨ æ åºåè¡¨ æåºåè¡¨ æå åè¡¨ å¸¦å¤éæ¡åè¡¨ åè¡¨åµå¥ ä¸ãåºåå¼ç¨ å«ãä»£ç  ä»£ç åºå ä¹ãé¾æ¥ åéé¾æ¥ Githubä»åºä¸­ä½¿ç¨åé¨é¾æ¥ éç¹é¾æ¥ åãå¾ç å¾çå®½é« ç¸å¯¹è·¯å¾ä»¥åGithubä¸­ä½¿ç¨å¾ç åä¸ãè¡¨æ ¼ åäºãEmojiè¡¨æå åä¸ãå¶ä»æå·§ æ¯æç HTML åç´  è½¬ä¹ æ°å­¦å¬å¼ å¾è¡¨ æµç¨å¾ æ¶åºå¾ çç¹å¾",content:"# Markdownä½¿ç¨æç¨\n\n\n# ä¸ãMarkdown\n\n\n# ç®ä»\n\n\n\nMarkdown æ¯ä¸ç§è½»éçº§æ è®°è¯­è¨ï¼å®åè®¸äººä»¬ä½¿ç¨æè¯»æåççº¯ææ¬æ ¼å¼ç¼åææ¡£ã\n\n\n# åºç¨\n\nå½åè®¸å¤ç½ç«é½å¹¿æ³ä½¿ç¨ Markdown æ¥æ°åå¸®å©ææ¡£ææ¯ç¨äºè®ºåä¸åè¡¨æ¶æ¯ãä¾å¦ï¼GitHubãç®ä¹¦ãç¥ä¹ç­\n\n\n# ç¼è¾å¨\n\næ¨èä½¿ç¨Typoraï¼å®ç½ï¼https://typora.io/\n\n\n# äºãå¾½ç« \n\n# ä»ä¹æ¯å¾½ç« \n\nå¾½ç« æ¯ä¸ç§å°å·§ç²¾ç¾çå°å¾æ ï¼ä¸è¬éæç¸å³æå­è¿è¡è¾å©è¯´æï¼å¯å¯¹æ°æ®è¿è¡çæ§ï¼é¾æ¥è·³è½¬ç­ï¼å¯æè¡¨ç°åã\n\nå¸¸è§äºgithubé¡¹ç®ä¸»é¡µï¼ä½å¶ä¸ä»åºç°äº github é¡¹ç®ä¸»é¡µï¼å¡æ¯è½å¤è¡¨ç°å¾ççå°æ¹é½å¯ä»¥åºç°å¾½ç« ã\n\n# å¾½ç« çä½¿ç¨\n\n * å¨markdownä¸­ä½¿ç¨\n\næ ¼å¼:\n[![å¾çæå­è¯´æ](å¾çæºå°å)](è¶é¾æ¥å°å)  # å³è¶é¾æ¥åé¨åµå¥å¾ç\n\nè¯­æ³ï¼\n[![github](https://img.shields.io/badge/github-xugaoyi-brightgreen.svg)](https://github.com/xugaoyi)\n\n\n1\n2\n3\n4\n5\n\n\n\n\nå¾½ç« çæç½ç«ï¼https://shields.io/\n\næ¬ææ¡£ä¸»è¦ä»ç»markdownï¼ä¸å¯¹å¾½ç« åè¿å¤ä»ç»ï¼è¯¦ç»ä»ç»è¯· æ³æ äºè§£ã\n\n\n# ä¸ãè®¾ç½®ç®å½\n\nè®¾ç½®ä¹åä¼æ ¹æ®åçº§æ é¢æ¥èªå¨çæç®å½ã\n\n[TOC]\n\n\n1\n\n\n> æ³¨ï¼githubææªæ¯æã\n\n[TOC]\n\nå¨githubçæTOCçæ¹æ³ï¼https://github.com/ekalinin/github-markdown-toc\n\nwindowsç³»ç»éè¦åºäºgolangå®ç°çå·¥å·ï¼https://github.com/ekalinin/github-markdown-toc.go\n\n> å¦æä½ æGOè¯­è¨çç¼è¯ç¯å¢ï¼å¯ä»¥å°è¯èªå·±ç¼è¯ï¼å¦ææ²¡æï¼å¯ä»¥ç´æ¥ä¸è½½ç¼è¯å¥½çäºè¿å¶æä»¶ã\n> \n> å¦windowsç³»ç»64ä½ ä¸è½½ï¼gh-md-toc.windows.amd64.tgz ï¼386 æ¯32ä½ï¼amd64æ¯64ä½ï¼\n> \n> ä¸è½½è§£ååï¼åç°æ²¡æåç¼åæ æ³è¯å«ï¼å®éä¸è¿æ¯ä¸ªexeæä»¶ï¼æä»¥åªéè¦æ´åå°å¨åé¢å ä¸.exeå°±å¯ä»¥å¼å§æå¿«ä½¿ç¨äºã\n> \n> ä½¿ç¨æ¹æ³ï¼\n> \n>  1. é¦åå°.mdææ¡£å¤å¶å°gh-md-toc.exeçæ ¹ç®å½ä¸\n>  2. å¨è¯¥ç®å½ä¸æå¼ç³»ç»å½ä»¤è¡ï¼è¾å¥å½ä»¤ï¼gh-md-toc.exe README.MD çæç®å½\n>  3. æçæçç®å½å¤å¶å°.mdæä»¶å³å¯ã\n\nè¿æ¯gh-md-tocçæçç®å½ï¼\n\n * ä¸ãMarkdown\n   * ç®ä»\n   * åºç¨\n   * ç¼è¾å¨\n * äºãå¾½ç« \n   * ä»ä¹æ¯å¾½ç« \n   * å¾½ç« çä½¿ç¨\n * ä¸ãè®¾ç½®ç®å½\n * åãæ é¢\n * ä¸çº§æ é¢\n   * äºçº§æ é¢\n     * ä¸çº§æ é¢\n       * åçº§æ é¢\n         * äºçº§æ é¢\n           * å­çº§æ é¢\n   * äºãææ¬\n     * æ®µè½\n     * å­ä½\n     * å é¤çº¿\n     * ä¸åçº¿\n     * æå­é«äº®\n     * åéçº¿\n     * èæ³¨\n   * å­ãåè¡¨\n     * æ åºåè¡¨\n     * æåºåè¡¨\n     * æå åè¡¨\n     * å¸¦å¤éæ¡åè¡¨\n     * åè¡¨åµå¥\n   * ä¸ãåºåå¼ç¨\n     * åºååµå¥\n     * åºåä¸­ä½¿ç¨åè¡¨\n     * åè¡¨ä¸­ä½¿ç¨åºå\n   * å«ãä»£ç \n     * ä»£ç åºå\n   * ä¹ãé¾æ¥\n     * åéé¾æ¥\n     * Githubä¸­ä½¿ç¨åé¨é¾æ¥\n     * éç¹é¾æ¥\n   * åãå¾ç\n     * å¾çå®½é«\n     * ç¸å¯¹è·¯å¾ä»¥åGithubä¸­ä½¿ç¨å¾ç\n   * åä¸ãè¡¨æ ¼\n   * åäºãEmojiè¡¨æå\n   * åä¸ãå¶ä»æå·§\n     * æ¯æç HTML åç´ \n     * è½¬ä¹\n     * æ°å­¦å¬å¼\n     * å¾è¡¨\n     * æµç¨å¾\n     * æ¶åºå¾\n     * çç¹å¾\n\n\n# åãæ é¢\n\n# ä¸çº§æ é¢\n## äºçº§æ é¢\n### ä¸çº§æ é¢\n#### åçº§æ é¢\n##### äºçº§æ é¢\n###### å­çº§æ é¢\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# ä¸çº§æ é¢\n\n\n# äºçº§æ é¢\n\n\n# ä¸çº§æ é¢\n\n# åçº§æ é¢\n\n# äºçº§æ é¢\n\n# å­çº§æ é¢\n\n\n# äºãææ¬\n\n\n# æ®µè½\n\nMarkdown æ®µè½æ²¡æç¹æ®çæ ¼å¼ï¼ç´æ¥ç¼åæå­ï¼éè¦æ®µè½ç¼©è¿æ¶ä½¿ç¨2ä¸ªTab\n\n\n# å­ä½\n\n*æä½ææ¬*\næ _æä½ææ¬_\n**ç²ä½ææ¬**\næ  __ç²ä½ææ¬__\n***ç²æä½ææ¬***\næ ___ç²æä½ææ¬___\n\n\n1\n2\n3\n4\n5\n6\n\n\næä½ææ¬\n\næä½ææ¬\n\nç²ä½ææ¬\n\nç²ä½ææ¬\n\nç²æä½ææ¬\n\nç²æä½ææ¬\n\n\n# å é¤çº¿\n\nå¦ææ®µè½ä¸çæå­è¦æ·»å å é¤çº¿ï¼åªéè¦å¨æå­çä¸¤ç«¯å ä¸ä¸¤ä¸ªæ³¢æµªçº¿ ~~ å³å¯ï¼å®ä¾å¦ä¸ï¼\n\n~~BAIDU.COM~~\n\n\n1\n\n\nBAIDU.COM\n\n\n# ä¸åçº¿\n\nä¸åçº¿å¯ä»¥éè¿ HTML ç<u> æ ç­¾æ¥å®ç°ï¼\n\n<u>å¸¦ä¸åçº¿çææ¬</u>\n\n\n1\n\n\nå¸¦ä¸åçº¿çææ¬\n\n\n# æå­é«äº®\n\næå­é«äº®è½ä½¿è¡åé¨åæå­é«äº®ï¼ä½¿ç¨ä¸å¯¹åå¼å·ã\n\n`html` `css` `javascript`\n\n\n1\n\n\nhtml css javascript\n\n\n# åéçº¿\n\nä½ å¯ä»¥å¨ä¸è¡ä¸­ç¨ä¸ä¸ªä»¥ä¸çæå·ãåå·ãåºçº¿æ¥å»ºç«ä¸ä¸ªåéçº¿ï¼è¡åä¸è½æå¶ä»ä¸è¥¿ãä½ ä¹å¯ä»¥å¨æå·ææ¯åå·ä¸­é´æå¥ç©ºæ ¼ãä¸é¢æ¯ç§åæ³é½å¯ä»¥å»ºç«åéçº¿ï¼\n\n***\n\n*****\n\n- - -\n\n----------\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n----------------------------------------\n\n\n# èæ³¨\n\nèæ³¨æ¯å¯¹ææ¬çè¡¥åè¯´æã\n\n[^åé]\nå¨ææ¡£ç»å°¾æå¶ä»ä½ç½®çµ¦åéèµå¼ï¼\n[^åé]: æ³¨ææ¡åæ¾ç¤ºçåå®¹\n\né¼ æ ç§»å°è¿é> [^åå½]\n[^åå½]: æ³¨ææ¡åæ¾ç¤ºçåå®¹\n\n\n1\n2\n3\n4\n5\n6\n\n\n> æ³¨ï¼å¨é¨åçº¿ä¸é¢è§æªæ¯æ\n\né¼ æ ç§»å°è¿é> ^åå½\n\n\n# å­ãåè¡¨\n\n\n# æ åºåè¡¨\n\nä½¿ç¨æå·*ãå å·+ææ¯åå·-ä½ä¸ºåè¡¨æ è®°ï¼\n\n* ç¬¬ä¸é¡¹\n* ç¬¬äºé¡¹\n\n+ ç¬¬ä¸é¡¹\n+ ç¬¬äºé¡¹\n\n- ç¬¬ä¸é¡¹\n- ç¬¬äºé¡¹\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n * ç¬¬ä¸é¡¹\n * ç¬¬äºé¡¹\n\n\n# æåºåè¡¨\n\nä½¿ç¨æ°å­å¹¶å ä¸. å·æ¥è¡¨ç¤º\n\n1. ç¬¬ä¸é¡¹\n2. ç¬¬äºé¡¹\n\n\n1\n2\n\n 1. ç¬¬ä¸é¡¹\n 2. ç¬¬äºé¡¹\n\n\n# æå åè¡¨\n\n<details>\n<summary>ç¹ææå¼å³é­æå </summary>\n æå åå®¹\n <ul>\n     <li>1</li>\n     <li>2</li>\n     <li>3</li>\n </ul>\n</details>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n> æ³¨æï¼<details> æ ç­¾ååmarkdownä»£ç æ æï¼å¯åhtmlä»£ç ï¼å¦ul>liãtableç­\n\nç¹ææå¼å³é­æå  æå åå®¹\n * 1\n * 2\n * 3\n\nåå«tableçæå \n\nåç±»        ä¾è¯\näººç§°ä»£è¯-ä¸»æ ¼   Iæï¼youä½ ï¼heä»ï¼sheå¥¹ï¼theyä»ä»¬ï¼ weæä»¬\näººç§°ä»£è¯-å®¾æ ¼   meæï¼ youä½ ï¼ himä»ï¼ herå¥¹ï¼ themä»ä»¬ï¼ usæä»¬\nç©ä¸»ä»£è¯      myæçï¼ hisä»çï¼ yourä½ çï¼yourä½ ä»¬çï¼ï¼ theirä»ä»¬çï¼ herså¥¹ç\næç¤ºä»£è¯      thisè¿ï¼ thaté£ï¼ theseè¿äºï¼ those é£äº\nåèº«ä»£è¯      myselfæèªå·±ï¼ himselfä»èªå·±ï¼ themselvesä»ä»¬èªå·±ï¼\n          yourselfä½ (ä»¬)èªå·±ï¼herselfå¥¹èªå·±\nçé®ä»£è¯      whoè°ï¼ whatä»ä¹ï¼ whichåªä¸ª\nä¸å®ä»£è¯      someä¸äºï¼ manyè®¸å¤ï¼ bothä¸¤ä¸ªãä¸¤ä¸ªé½ï¼ anyè®¸å¤\nå³ç³»ä»£è¯      whichâ¦â¦çç©ï¼ whoâ¦â¦çäººï¼ thatâ¦â¦çäººæç©ï¼ whoè°ï¼ thatå¼å¯¼å®è¯­ä»å¥\nç¸äºä»£è¯      each other äºç¸ï¼ one anotheräºç¸\nè¿æ¥ä»£è¯      who,whom,whose,what,which,whatever,whichever,whoever,whomever\næ¿ä»£è¯       oneï¼åæ°ï¼ï¼onesï¼å¤æ°ï¼\n\n\n# å¸¦å¤éæ¡åè¡¨\n\n* [x] ç¬¬ä¸é¡¹\n* [ ] ç¬¬äºé¡¹\n* [ ] ç¬¬ä¸é¡¹\n\n\n1\n2\n3\n\n\n> æ³¨ï¼å¨é¨åçº¿ä¸é¢è§æªæ¯æ\n\n * [x] ç¬¬ä¸é¡¹\n\n * [ ] ç¬¬äºé¡¹\n\n * [ ] ç¬¬ä¸é¡¹\n\n\n# åè¡¨åµå¥\n\n1. ç¬¬ä¸é¡¹ï¼\n    - ç¬¬ä¸é¡¹åµå¥çç¬¬ä¸ä¸ªåç´ \n    - ç¬¬ä¸é¡¹åµå¥çç¬¬äºä¸ªåç´ \n2. ç¬¬äºé¡¹ï¼\n    - ç¬¬äºé¡¹åµå¥çç¬¬ä¸ä¸ªåç´ \n       - ç¬¬ä¸å±åµå¥\n\n\n1\n2\n3\n4\n5\n6\n\n 1. ç¬¬ä¸é¡¹\n    * åµå¥1\n    * åµå¥2\n 2. ç¬¬äºé¡¹\n    * åµå¥1\n      * åµå¥2\n\n\n# ä¸ãåºåå¼ç¨\n\nåºåå¼ç¨æ¯å¨æ®µè½å¼å¤´ä½¿ç¨ >ç¬¦å· ï¼ç¶ååé¢ç´§è·ä¸ä¸ªç©ºæ ¼ç¬¦å·ï¼\n\n> åºåå¼ç¨\n\n\n1\n\n\n> åºåå¼ç¨\n> \n> Typoraä¸­åè½¦é®èªå¨å»¶ä¼¸åºå\n\n# åºååµå¥\n\n> ç¬¬ä¸å±\n> > ç¬¬äºå±\n> > > ç¬¬ä¸å±\n\n\n1\n2\n3\n\n\n> ç¬¬ä¸å±\n> \n> > ç¬¬äºå±\n> > \n> > > ç¬¬ä¸å±\n\n# åºåä¸­ä½¿ç¨åè¡¨\n\n> åºåä¸­ä½¿ç¨åè¡¨\n> 1. ç¬¬ä¸é¡¹\n> 2. ç¬¬äºé¡¹\n> * 111\n> * 222\n\n\n1\n2\n3\n4\n5\n\n\n> åºåä¸­ä½¿ç¨åè¡¨\n> \n>  1. ç¬¬ä¸é¡¹\n>  2. ç¬¬äºé¡¹\n>     * 111\n>     * 222\n\n# åè¡¨ä¸­ä½¿ç¨åºå\n\n* ç¬¬ä¸é¡¹\n    > åºå\n* ç¬¬äºé¡¹\n\n\n1\n2\n3\n\n\n * ç¬¬ä¸é¡¹\n   \n   > åºå\n   > \n   > åºå\n\n * ç¬¬äºé¡¹\n\n\n# å«ãä»£ç \n\nå¦ææ¯æ®µè½ä¸çä¸ä¸ªä»£ç çæ®µå¯ä»¥ç¨åå¼å·æå®åèµ·æ¥ï¼`ï¼ï¼ç¤ºä¾ï¼\n\n`alert()`\n\n\n1\n\n\nalert()\n\n\n# ä»£ç åºå\n\nç¨ä¸ä¸ªåå¼å· ``` åè£¹ä¸æ®µä»£ç ï¼å¹¶æå®ä¸ç§è¯­è¨ï¼ä¹å¯ä»¥ä¸æå®ï¼ï¼æå®ä»£ç è¯­è¨åä¼æä»£ç çé¢è²é«äº®\n\næ¬ä»£ç åºåä¸ºç¤ºä¾è¯´æï¼\n\nâ```javascript\nfunction test() {\n\talert('test')\n}\nâ```\n\n\n1\n2\n3\n4\n5\n\n\nææï¼\n\nfunction test() {\n\talert('test')\n}\n\n\n1\n2\n3\n\n\n\n# ä¹ãé¾æ¥\n\næ ¼å¼ï¼\n\n[é¾æ¥åç§°](é¾æ¥å°å)\n\n[é¾æ¥åç§°](é¾æ¥å°å,å¯éçalt)\n\næ\n\n<é¾æ¥å°å>\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nç¤ºä¾ï¼\n\n[ç¾åº¦](http://www.baidu.com,'ç¾åº¦')\n\n\n1\n\n\nç¾åº¦\n\nç´æ¥æ¾ç¤ºé¾æ¥å°åï¼\n\n<http://www.baidu.com>\n\n\n1\n\n\nhttp://www.baidu.com\n\n\n# åéé¾æ¥\n\né¾æ¥å¯ä»¥ç¨åéæ¥ä»£æ¿ï¼ææ¡£æ«å°¾æå¶ä»ä½ç½®éå¸¦åéå°åï¼\n\nè¿ä¸ªé¾æ¥ç¨ 1 ä½ä¸ºç½ååé [Google][1]\nè¿ä¸ªé¾æ¥ç¨ baidu ä½ä¸ºç½ååé [Baidu][baidu]\n\nç¶åå¨ææ¡£çç»å°¾æå¶ä»ä½ç½®ç»åéèµå¼ï¼ç½åï¼\n  [1]: http://www.google.com/\n  [baidu]: http://www.baidu.com/\n\n\n1\n2\n3\n4\n5\n6\n\n\nè¿ä¸ªé¾æ¥ç¨ 1 ä½ä¸ºç½ååé Google\n\nè¿ä¸ªé¾æ¥ç¨ baidu ä½ä¸ºç½ååé Baidu\n\n\n# Githubä»åºä¸­ä½¿ç¨åé¨é¾æ¥\n\nå¯ä½¿ç¨ç¸å¯¹è·¯å¾ï¼åææ¯æè¯¥è·¯å¾ä¸çæä»¶ï¼\n[test](test.md)\n\n\n1\n2\n\n\ntest\n\n\n# éç¹é¾æ¥\n\næ¬æä»¶ä¸­æ¯ä¸ä¸ªæ é¢é½æ¯ä¸ä¸ªéç¹ï¼åHTMLçéç¹ï¼#ï¼ç±»ä¼¼\n\n[Markdown](#Markdown)\n\n\n1\n\n\n> æ³¨ï¼ githubå¯¹å«ææ ç¹ç¬¦å·çæ é¢è¿è¡éç¹æ¶ä¼å¿½ç¥ææ ç¹ç¬¦å·ï¼ æ¬é¡µä¸­ï¼å¦æè¿æ ·ååæ æ³è·³è½¬ï¼[é¾æ¥](#ä¹ãé¾æ¥) æ­£ç¡®åæ³ï¼[é¾æ¥](#ä¹é¾æ¥)\n\nMarkdown\n\né¾æ¥\n\næµç¨å¾\n\n\n# åãå¾ç\n\nåé¾æ¥çåºå«æ¯åé¢å¤ä¸ä¸ªæå¹å·!\n\n![å¾çå](å¾çé¾æ¥)\n\n\n1\n\n\nå½ç¶ï¼ä½ ä¹å¯ä»¥åé¾æ¥é£æ ·å¯¹å¾çå°åä½¿ç¨åé:\n\nè¿éé¾æ¥ç¨ img ä½ä¸ºå¾çå°ååé\nç¶åå¨ææ¡£çç»å°¾æå¶ä»ä½ç½®ç»åéèµå¼ï¼å¾çå°åï¼\n![RUNOOB][img]\n[img]: https://raw.githubusercontent.com/xugaoyi/image_store/master/blog/md_logo.png\n\n\n1\n2\n3\n4\n\n\n\n\n\n# å¾çå®½é«\n\nå¦ä¸æ³è®¾ç½®å¾çå®½é«ï¼å¯ä»¥ä½¿ç¨ <img> æ ç­¾ã\n\n<img src=\"https://raw.githubusercontent.com/xugaoyi/image_store/master/blog/md_logo.png\" width=\"50px\" height=\"30px\">\n\n\n1\n\n\n\n# ç¸å¯¹è·¯å¾ä»¥åGithubä¸­ä½¿ç¨å¾ç\n\nä¸ç®¡æ¯å¨æ¬å°è¿æ¯å¨githubåä¸ä¸ªä»åºä¸­ï¼å¦æå¾çå­å¨ï¼å¯ä»¥ä½¿ç¨ç¸å¯¹è·¯å¾ã\n\nç¸å¯¹è·¯å¾å¾çï¼\n\n![å¤´åå¾ç](./md-img/test.jpg)\n\n\n1\n\n\ngithubä¸å¦æå¼ç¨å¶ä»githubä»åºä¸­çå¾çåè¦æ³¨æå°åæ ¼å¼ï¼ä»åºå°å/raw/åæ¯å/å¾çè·¯å¾ æ https://raw.githubusercontent.com/ç¨æ·å/ä»åºå/åæ¯å/å¾çè·¯å¾\n\n![å¶ä»ä»åºçå¾ç1](https://github.com/xugaoyi/vue-music/raw/master/src/common/image/default.png)\næ\n![å¶ä»ä»åºçå¾ç2](https://raw.githubusercontent.com/xugaoyi/image_store/master/blog/md_logo.png)\n\n\n\n1\n2\n3\n4\n\n\n\n\n\n\n\n# åä¸ãè¡¨æ ¼\n\nå¶ä½è¡¨æ ¼ä½¿ç¨ |æ¥åéä¸åçååæ ¼ï¼ä½¿ç¨-æ¥åéè¡¨å¤´åå¶ä»è¡ã\n\n|  è¡¨å¤´   | è¡¨å¤´  |\n|  ----  | ----  |\n| ååæ ¼  | ååæ ¼ |\n| ååæ ¼  | ååæ ¼ |\n\n\n1\n2\n3\n4\n\n\nè¡¨å¤´    è¡¨å¤´\nååæ ¼   ååæ ¼\nååæ ¼   ååæ ¼\n\nå¯¹é½æ¹å¼\n\n * -: è®¾ç½®åå®¹åæ é¢æ å±å³å¯¹é½\n * :- è®¾ç½®åå®¹åæ é¢æ å±å·¦å¯¹é½\n * :-: è®¾ç½®åå®¹åæ é¢æ å±ä¸­å¯¹é½\n\n| å·¦å¯¹é½ | å³å¯¹é½ | å±ä¸­å¯¹é½ |\n| :-----| ----: | :----: |\n| ååæ ¼ | ååæ ¼ | ååæ ¼ |\n| ååæ ¼ | ååæ ¼ | ååæ ¼ |\n\n\n1\n2\n3\n4\n\n\nå·¦å¯¹é½   å³å¯¹é½   å±ä¸­å¯¹é½\nååæ ¼   ååæ ¼   ååæ ¼\nååæ ¼   ååæ ¼   ååæ ¼\n\n\n# åäºãEmojiè¡¨æå\n\nEmojiè¡¨æè±æåçååå åå·ï¼Typoreä¸åè¾å¥åå·åè¾å¥é¦å­æ¯æè¡¨ææç¤º\n\n:smirk:\n\n\n1\n\n\nð ð¸ðð´ ðððð âï¸\n\næ´å¤è¡¨æåç§°è¯·æ¥çï¼è¡¨æåæ¸å\n\n\n# åä¸ãå¶ä»æå·§\n\n\n# æ¯æç HTML åç´ \n\nä¸å¨ Markdown è¯­æ³æ¶µçèå´ä¹åçæ ç­¾ï¼é½å¯ä»¥ç´æ¥å¨ææ¡£éé¢ç¨ HTML æ°åã\n\nç®åæ¯æç HTML åç´ æï¼<kbd> <b> <i> <em> <sup> <sub> <br>ç­ç­ ï¼å¦ï¼\n\nä½¿ç¨ <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Del</kbd> éå¯çµè\n\n\n1\n\n\nä½¿ç¨ Ctrl+Alt+Del éå¯çµè\n\nææ¯ä½¿ç¨bæ ç­¾çå ç²å­ä½\n\n\n# è½¬ä¹\n\nMarkdown ä½¿ç¨äºå¾å¤ç¹æ®ç¬¦å·æ¥è¡¨ç¤ºç¹å®çæä¹ï¼å¦æéè¦æ¾ç¤ºç¹å®çç¬¦å·åéè¦ä½¿ç¨åææ è½¬ä¹å­ç¬¦ï¼\n\n**æªè½¬ä¹æå·æ¾ç¤ºå ç²**\n\\*\\* è½¬ä¹æ¾ç¤ºæå· \\*\\*\n\n\n1\n2\n\n\næªè½¬ä¹æå·æ¾ç¤ºå ç² ** è½¬ä¹æ¾ç¤ºæå· **\n\nMarkdown æ¯æä»¥ä¸è¿äºç¬¦å·åé¢å ä¸åææ æ¥å¸®å©æå¥æ®éçç¬¦å·ï¼\n\n\\   åæçº¿\n`   åå¼å·\n*   æå·\n_   ä¸åçº¿\n{}  è±æ¬å·\n[]  æ¹æ¬å·\n()  å°æ¬å·\n#   äºå­å·\n+   å å·\n-   åå·\n.   è±æå¥ç¹\n!   æå¹å·\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n----------------------------------------\n\n*** ä»¥ä¸é¨åå¨Githubæå¶ä»å¨çº¿é¢è§ä¸­ææªæ¯æ ***\n\n----------------------------------------\n\n\n# æ°å­¦å¬å¼\n\nå½ä½ éè¦å¨ç¼è¾å¨ä¸­æå¥æ°å­¦å¬å¼æ¶ï¼å¯ä»¥ä½¿ç¨ä¸¤ä¸ªç¾åç¬¦ $$ åè£¹ TeX æ LaTeX æ ¼å¼çæ°å­¦å¬å¼æ¥å®ç°ãæäº¤åï¼é®ç­åæç« é¡µä¼æ ¹æ®éè¦å è½½ Mathjax å¯¹æ°å­¦å¬å¼è¿è¡æ¸²æãå¦ï¼\n\n$$\n\\mathbf{V}_1 \\times \\mathbf{V}_2 =  \\begin{vmatrix}\n\\mathbf{i} & \\mathbf{j} & \\mathbf{k} \\\\\n\\frac{\\partial X}{\\partial u} &  \\frac{\\partial Y}{\\partial u} & 0 \\\\\n\\frac{\\partial X}{\\partial v} &  \\frac{\\partial Y}{\\partial v} & 0 \\\\\n\\end{vmatrix}\n$$tep1}{\\style{visibility:hidden}{(x+1)(x+1)}}\n$$\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n$$ \\mathbf{V}_1 \\times \\mathbf{V}_2 = \\begin{vmatrix} \\mathbf{i} & \\mathbf{j} & \\mathbf{k} \\ \\frac{\\partial X}{\\partial u} & \\frac{\\partial Y}{\\partial u} & 0 \\ \\frac{\\partial X}{\\partial v} & \\frac{\\partial Y}{\\partial v} & 0 \\ \\end{vmatrix} $$\n\n\n# å¾è¡¨\n\nâ```chart\n,Budget,Income,Expenses,Debt\nJune,5000,8000,4000,6000\nJuly,3000,1000,4000,3000\nAug,5000,7000,6000,3000\nSep,7000,2000,3000,1000\nOct,6000,5000,4000,2000\nNov,4000,3000,5000,\n\ntype: pie\ntitle: Monthly Revenue\nx.title: Amount\ny.title: Month\ny.suffix: $\nâ```\nâ```mermaid\nsequenceDiagram\nA->>B: æ¯å¦å·²æ¶å°æ¶æ¯ï¼\nB--\x3e>A: å·²æ¶å°æ¶æ¯\nâ```\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n> æ³¨ï¼å¨Typoraä¸­æªæ¯æ\n\n\n# æµç¨å¾\n\nè¯­æ³ï¼\nâ```mermaid\ngraph TD\nA[æ¨¡åA] --\x3e|A1| B(æ¨¡åB)\nB --\x3e C{å¤æ­æ¡ä»¶C}\nC --\x3e|æ¡ä»¶C1| D[æ¨¡åD]\nC --\x3e|æ¡ä»¶C2| E[æ¨¡åE]\nC --\x3e|æ¡ä»¶C3| F[æ¨¡åF]\nâ```\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\næµç¨å¾ç¸å³æç« ï¼\n\nhttps://www.jianshu.com/p/b421cc723da5\n\nhttp://www.imooc.com/article/292708\n\n\n# æ¶åºå¾\n\nâ```mermaid\nsequenceDiagram\nA->>B: æ¯å¦å·²æ¶å°æ¶æ¯ï¼\nB--\x3e>A: å·²æ¶å°æ¶æ¯\nâ```\n\n\n1\n2\n3\n4\n5\n\n\n\n# çç¹å¾\n\nâ```mermaid\ngantt\ntitle çç¹å¾\ndateFormat  YYYY-MM-DD\nsection é¡¹ç®A\nä»»å¡1           :a1, 2018-06-06, 30d\nä»»å¡2     :after a1  , 20d\nsection é¡¹ç®B\nä»»å¡3      :2018-06-12  , 12d\nä»»å¡4      : 24d\nâ```\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nåå°é¡¶é¨",normalizedContent:"# markdownä½¿ç¨æç¨\n\n\n# ä¸ãmarkdown\n\n\n# ç®ä»\n\n\n\nmarkdown æ¯ä¸ç§è½»éçº§æ è®°è¯­è¨ï¼å®åè®¸äººä»¬ä½¿ç¨æè¯»æåççº¯ææ¬æ ¼å¼ç¼åææ¡£ã\n\n\n# åºç¨\n\nå½åè®¸å¤ç½ç«é½å¹¿æ³ä½¿ç¨ markdown æ¥æ°åå¸®å©ææ¡£ææ¯ç¨äºè®ºåä¸åè¡¨æ¶æ¯ãä¾å¦ï¼githubãç®ä¹¦ãç¥ä¹ç­\n\n\n# ç¼è¾å¨\n\næ¨èä½¿ç¨typoraï¼å®ç½ï¼https://typora.io/\n\n\n# äºãå¾½ç« \n\n# ä»ä¹æ¯å¾½ç« \n\nå¾½ç« æ¯ä¸ç§å°å·§ç²¾ç¾çå°å¾æ ï¼ä¸è¬éæç¸å³æå­è¿è¡è¾å©è¯´æï¼å¯å¯¹æ°æ®è¿è¡çæ§ï¼é¾æ¥è·³è½¬ç­ï¼å¯æè¡¨ç°åã\n\nå¸¸è§äºgithubé¡¹ç®ä¸»é¡µï¼ä½å¶ä¸ä»åºç°äº github é¡¹ç®ä¸»é¡µï¼å¡æ¯è½å¤è¡¨ç°å¾ççå°æ¹é½å¯ä»¥åºç°å¾½ç« ã\n\n# å¾½ç« çä½¿ç¨\n\n * å¨markdownä¸­ä½¿ç¨\n\næ ¼å¼:\n[![å¾çæå­è¯´æ](å¾çæºå°å)](è¶é¾æ¥å°å)  # å³è¶é¾æ¥åé¨åµå¥å¾ç\n\nè¯­æ³ï¼\n[![github](https://img.shields.io/badge/github-xugaoyi-brightgreen.svg)](https://github.com/xugaoyi)\n\n\n1\n2\n3\n4\n5\n\n\n\n\nå¾½ç« çæç½ç«ï¼https://shields.io/\n\næ¬ææ¡£ä¸»è¦ä»ç»markdownï¼ä¸å¯¹å¾½ç« åè¿å¤ä»ç»ï¼è¯¦ç»ä»ç»è¯· æ³æ äºè§£ã\n\n\n# ä¸ãè®¾ç½®ç®å½\n\nè®¾ç½®ä¹åä¼æ ¹æ®åçº§æ é¢æ¥èªå¨çæç®å½ã\n\n[toc]\n\n\n1\n\n\n> æ³¨ï¼githubææªæ¯æã\n\n[toc]\n\nå¨githubçætocçæ¹æ³ï¼https://github.com/ekalinin/github-markdown-toc\n\nwindowsç³»ç»éè¦åºäºgolangå®ç°çå·¥å·ï¼https://github.com/ekalinin/github-markdown-toc.go\n\n> å¦æä½ ægoè¯­è¨çç¼è¯ç¯å¢ï¼å¯ä»¥å°è¯èªå·±ç¼è¯ï¼å¦ææ²¡æï¼å¯ä»¥ç´æ¥ä¸è½½ç¼è¯å¥½çäºè¿å¶æä»¶ã\n> \n> å¦windowsç³»ç»64ä½ ä¸è½½ï¼gh-md-toc.windows.amd64.tgz ï¼386 æ¯32ä½ï¼amd64æ¯64ä½ï¼\n> \n> ä¸è½½è§£ååï¼åç°æ²¡æåç¼åæ æ³è¯å«ï¼å®éä¸è¿æ¯ä¸ªexeæä»¶ï¼æä»¥åªéè¦æ´åå°å¨åé¢å ä¸.exeå°±å¯ä»¥å¼å§æå¿«ä½¿ç¨äºã\n> \n> ä½¿ç¨æ¹æ³ï¼\n> \n>  1. é¦åå°.mdææ¡£å¤å¶å°gh-md-toc.exeçæ ¹ç®å½ä¸\n>  2. å¨è¯¥ç®å½ä¸æå¼ç³»ç»å½ä»¤è¡ï¼è¾å¥å½ä»¤ï¼gh-md-toc.exe readme.md çæç®å½\n>  3. æçæçç®å½å¤å¶å°.mdæä»¶å³å¯ã\n\nè¿æ¯gh-md-tocçæçç®å½ï¼\n\n * ä¸ãmarkdown\n   * ç®ä»\n   * åºç¨\n   * ç¼è¾å¨\n * äºãå¾½ç« \n   * ä»ä¹æ¯å¾½ç« \n   * å¾½ç« çä½¿ç¨\n * ä¸ãè®¾ç½®ç®å½\n * åãæ é¢\n * ä¸çº§æ é¢\n   * äºçº§æ é¢\n     * ä¸çº§æ é¢\n       * åçº§æ é¢\n         * äºçº§æ é¢\n           * å­çº§æ é¢\n   * äºãææ¬\n     * æ®µè½\n     * å­ä½\n     * å é¤çº¿\n     * ä¸åçº¿\n     * æå­é«äº®\n     * åéçº¿\n     * èæ³¨\n   * å­ãåè¡¨\n     * æ åºåè¡¨\n     * æåºåè¡¨\n     * æå åè¡¨\n     * å¸¦å¤éæ¡åè¡¨\n     * åè¡¨åµå¥\n   * ä¸ãåºåå¼ç¨\n     * åºååµå¥\n     * åºåä¸­ä½¿ç¨åè¡¨\n     * åè¡¨ä¸­ä½¿ç¨åºå\n   * å«ãä»£ç \n     * ä»£ç åºå\n   * ä¹ãé¾æ¥\n     * åéé¾æ¥\n     * githubä¸­ä½¿ç¨åé¨é¾æ¥\n     * éç¹é¾æ¥\n   * åãå¾ç\n     * å¾çå®½é«\n     * ç¸å¯¹è·¯å¾ä»¥ågithubä¸­ä½¿ç¨å¾ç\n   * åä¸ãè¡¨æ ¼\n   * åäºãemojiè¡¨æå\n   * åä¸ãå¶ä»æå·§\n     * æ¯æç html åç´ \n     * è½¬ä¹\n     * æ°å­¦å¬å¼\n     * å¾è¡¨\n     * æµç¨å¾\n     * æ¶åºå¾\n     * çç¹å¾\n\n\n# åãæ é¢\n\n# ä¸çº§æ é¢\n## äºçº§æ é¢\n### ä¸çº§æ é¢\n#### åçº§æ é¢\n##### äºçº§æ é¢\n###### å­çº§æ é¢\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# ä¸çº§æ é¢\n\n\n# äºçº§æ é¢\n\n\n# ä¸çº§æ é¢\n\n# åçº§æ é¢\n\n# äºçº§æ é¢\n\n# å­çº§æ é¢\n\n\n# äºãææ¬\n\n\n# æ®µè½\n\nmarkdown æ®µè½æ²¡æç¹æ®çæ ¼å¼ï¼ç´æ¥ç¼åæå­ï¼éè¦æ®µè½ç¼©è¿æ¶ä½¿ç¨2ä¸ªtab\n\n\n# å­ä½\n\n*æä½ææ¬*\næ _æä½ææ¬_\n**ç²ä½ææ¬**\næ  __ç²ä½ææ¬__\n***ç²æä½ææ¬***\næ ___ç²æä½ææ¬___\n\n\n1\n2\n3\n4\n5\n6\n\n\næä½ææ¬\n\næä½ææ¬\n\nç²ä½ææ¬\n\nç²ä½ææ¬\n\nç²æä½ææ¬\n\nç²æä½ææ¬\n\n\n# å é¤çº¿\n\nå¦ææ®µè½ä¸çæå­è¦æ·»å å é¤çº¿ï¼åªéè¦å¨æå­çä¸¤ç«¯å ä¸ä¸¤ä¸ªæ³¢æµªçº¿ ~~ å³å¯ï¼å®ä¾å¦ä¸ï¼\n\n~~baidu.com~~\n\n\n1\n\n\nbaidu.com\n\n\n# ä¸åçº¿\n\nä¸åçº¿å¯ä»¥éè¿ html ç<u> æ ç­¾æ¥å®ç°ï¼\n\n<u>å¸¦ä¸åçº¿çææ¬</u>\n\n\n1\n\n\nå¸¦ä¸åçº¿çææ¬\n\n\n# æå­é«äº®\n\næå­é«äº®è½ä½¿è¡åé¨åæå­é«äº®ï¼ä½¿ç¨ä¸å¯¹åå¼å·ã\n\n`html` `css` `javascript`\n\n\n1\n\n\nhtml css javascript\n\n\n# åéçº¿\n\nä½ å¯ä»¥å¨ä¸è¡ä¸­ç¨ä¸ä¸ªä»¥ä¸çæå·ãåå·ãåºçº¿æ¥å»ºç«ä¸ä¸ªåéçº¿ï¼è¡åä¸è½æå¶ä»ä¸è¥¿ãä½ ä¹å¯ä»¥å¨æå·ææ¯åå·ä¸­é´æå¥ç©ºæ ¼ãä¸é¢æ¯ç§åæ³é½å¯ä»¥å»ºç«åéçº¿ï¼\n\n***\n\n*****\n\n- - -\n\n----------\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n----------------------------------------\n\n\n# èæ³¨\n\nèæ³¨æ¯å¯¹ææ¬çè¡¥åè¯´æã\n\n[^åé]\nå¨ææ¡£ç»å°¾æå¶ä»ä½ç½®çµ¦åéèµå¼ï¼\n[^åé]: æ³¨ææ¡åæ¾ç¤ºçåå®¹\n\né¼ æ ç§»å°è¿é> [^åå½]\n[^åå½]: æ³¨ææ¡åæ¾ç¤ºçåå®¹\n\n\n1\n2\n3\n4\n5\n6\n\n\n> æ³¨ï¼å¨é¨åçº¿ä¸é¢è§æªæ¯æ\n\né¼ æ ç§»å°è¿é> ^åå½\n\n\n# å­ãåè¡¨\n\n\n# æ åºåè¡¨\n\nä½¿ç¨æå·*ãå å·+ææ¯åå·-ä½ä¸ºåè¡¨æ è®°ï¼\n\n* ç¬¬ä¸é¡¹\n* ç¬¬äºé¡¹\n\n+ ç¬¬ä¸é¡¹\n+ ç¬¬äºé¡¹\n\n- ç¬¬ä¸é¡¹\n- ç¬¬äºé¡¹\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n * ç¬¬ä¸é¡¹\n * ç¬¬äºé¡¹\n\n\n# æåºåè¡¨\n\nä½¿ç¨æ°å­å¹¶å ä¸. å·æ¥è¡¨ç¤º\n\n1. ç¬¬ä¸é¡¹\n2. ç¬¬äºé¡¹\n\n\n1\n2\n\n 1. ç¬¬ä¸é¡¹\n 2. ç¬¬äºé¡¹\n\n\n# æå åè¡¨\n\n<details>\n<summary>ç¹ææå¼å³é­æå </summary>\n æå åå®¹\n <ul>\n     <li>1</li>\n     <li>2</li>\n     <li>3</li>\n </ul>\n</details>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n> æ³¨æï¼<details> æ ç­¾ååmarkdownä»£ç æ æï¼å¯åhtmlä»£ç ï¼å¦ul>liãtableç­\n\nç¹ææå¼å³é­æå  æå åå®¹\n * 1\n * 2\n * 3\n\nåå«tableçæå \n\nåç±»        ä¾è¯\näººç§°ä»£è¯-ä¸»æ ¼   iæï¼youä½ ï¼heä»ï¼sheå¥¹ï¼theyä»ä»¬ï¼ weæä»¬\näººç§°ä»£è¯-å®¾æ ¼   meæï¼ youä½ ï¼ himä»ï¼ herå¥¹ï¼ themä»ä»¬ï¼ usæä»¬\nç©ä¸»ä»£è¯      myæçï¼ hisä»çï¼ yourä½ çï¼yourä½ ä»¬çï¼ï¼ theirä»ä»¬çï¼ herså¥¹ç\næç¤ºä»£è¯      thisè¿ï¼ thaté£ï¼ theseè¿äºï¼ those é£äº\nåèº«ä»£è¯      myselfæèªå·±ï¼ himselfä»èªå·±ï¼ themselvesä»ä»¬èªå·±ï¼\n          yourselfä½ (ä»¬)èªå·±ï¼herselfå¥¹èªå·±\nçé®ä»£è¯      whoè°ï¼ whatä»ä¹ï¼ whichåªä¸ª\nä¸å®ä»£è¯      someä¸äºï¼ manyè®¸å¤ï¼ bothä¸¤ä¸ªãä¸¤ä¸ªé½ï¼ anyè®¸å¤\nå³ç³»ä»£è¯      whichâ¦â¦çç©ï¼ whoâ¦â¦çäººï¼ thatâ¦â¦çäººæç©ï¼ whoè°ï¼ thatå¼å¯¼å®è¯­ä»å¥\nç¸äºä»£è¯      each other äºç¸ï¼ one anotheräºç¸\nè¿æ¥ä»£è¯      who,whom,whose,what,which,whatever,whichever,whoever,whomever\næ¿ä»£è¯       oneï¼åæ°ï¼ï¼onesï¼å¤æ°ï¼\n\n\n# å¸¦å¤éæ¡åè¡¨\n\n* [x] ç¬¬ä¸é¡¹\n* [ ] ç¬¬äºé¡¹\n* [ ] ç¬¬ä¸é¡¹\n\n\n1\n2\n3\n\n\n> æ³¨ï¼å¨é¨åçº¿ä¸é¢è§æªæ¯æ\n\n * [x] ç¬¬ä¸é¡¹\n\n * [ ] ç¬¬äºé¡¹\n\n * [ ] ç¬¬ä¸é¡¹\n\n\n# åè¡¨åµå¥\n\n1. ç¬¬ä¸é¡¹ï¼\n    - ç¬¬ä¸é¡¹åµå¥çç¬¬ä¸ä¸ªåç´ \n    - ç¬¬ä¸é¡¹åµå¥çç¬¬äºä¸ªåç´ \n2. ç¬¬äºé¡¹ï¼\n    - ç¬¬äºé¡¹åµå¥çç¬¬ä¸ä¸ªåç´ \n       - ç¬¬ä¸å±åµå¥\n\n\n1\n2\n3\n4\n5\n6\n\n 1. ç¬¬ä¸é¡¹\n    * åµå¥1\n    * åµå¥2\n 2. ç¬¬äºé¡¹\n    * åµå¥1\n      * åµå¥2\n\n\n# ä¸ãåºåå¼ç¨\n\nåºåå¼ç¨æ¯å¨æ®µè½å¼å¤´ä½¿ç¨ >ç¬¦å· ï¼ç¶ååé¢ç´§è·ä¸ä¸ªç©ºæ ¼ç¬¦å·ï¼\n\n> åºåå¼ç¨\n\n\n1\n\n\n> åºåå¼ç¨\n> \n> typoraä¸­åè½¦é®èªå¨å»¶ä¼¸åºå\n\n# åºååµå¥\n\n> ç¬¬ä¸å±\n> > ç¬¬äºå±\n> > > ç¬¬ä¸å±\n\n\n1\n2\n3\n\n\n> ç¬¬ä¸å±\n> \n> > ç¬¬äºå±\n> > \n> > > ç¬¬ä¸å±\n\n# åºåä¸­ä½¿ç¨åè¡¨\n\n> åºåä¸­ä½¿ç¨åè¡¨\n> 1. ç¬¬ä¸é¡¹\n> 2. ç¬¬äºé¡¹\n> * 111\n> * 222\n\n\n1\n2\n3\n4\n5\n\n\n> åºåä¸­ä½¿ç¨åè¡¨\n> \n>  1. ç¬¬ä¸é¡¹\n>  2. ç¬¬äºé¡¹\n>     * 111\n>     * 222\n\n# åè¡¨ä¸­ä½¿ç¨åºå\n\n* ç¬¬ä¸é¡¹\n    > åºå\n* ç¬¬äºé¡¹\n\n\n1\n2\n3\n\n\n * ç¬¬ä¸é¡¹\n   \n   > åºå\n   > \n   > åºå\n\n * ç¬¬äºé¡¹\n\n\n# å«ãä»£ç \n\nå¦ææ¯æ®µè½ä¸çä¸ä¸ªä»£ç çæ®µå¯ä»¥ç¨åå¼å·æå®åèµ·æ¥ï¼`ï¼ï¼ç¤ºä¾ï¼\n\n`alert()`\n\n\n1\n\n\nalert()\n\n\n# ä»£ç åºå\n\nç¨ä¸ä¸ªåå¼å· ``` åè£¹ä¸æ®µä»£ç ï¼å¹¶æå®ä¸ç§è¯­è¨ï¼ä¹å¯ä»¥ä¸æå®ï¼ï¼æå®ä»£ç è¯­è¨åä¼æä»£ç çé¢è²é«äº®\n\næ¬ä»£ç åºåä¸ºç¤ºä¾è¯´æï¼\n\nâ```javascript\nfunction test() {\n\talert('test')\n}\nâ```\n\n\n1\n2\n3\n4\n5\n\n\nææï¼\n\nfunction test() {\n\talert('test')\n}\n\n\n1\n2\n3\n\n\n\n# ä¹ãé¾æ¥\n\næ ¼å¼ï¼\n\n[é¾æ¥åç§°](é¾æ¥å°å)\n\n[é¾æ¥åç§°](é¾æ¥å°å,å¯éçalt)\n\næ\n\n<é¾æ¥å°å>\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nç¤ºä¾ï¼\n\n[ç¾åº¦](http://www.baidu.com,'ç¾åº¦')\n\n\n1\n\n\nç¾åº¦\n\nç´æ¥æ¾ç¤ºé¾æ¥å°åï¼\n\n<http://www.baidu.com>\n\n\n1\n\n\nhttp://www.baidu.com\n\n\n# åéé¾æ¥\n\né¾æ¥å¯ä»¥ç¨åéæ¥ä»£æ¿ï¼ææ¡£æ«å°¾æå¶ä»ä½ç½®éå¸¦åéå°åï¼\n\nè¿ä¸ªé¾æ¥ç¨ 1 ä½ä¸ºç½ååé [google][1]\nè¿ä¸ªé¾æ¥ç¨ baidu ä½ä¸ºç½ååé [baidu][baidu]\n\nç¶åå¨ææ¡£çç»å°¾æå¶ä»ä½ç½®ç»åéèµå¼ï¼ç½åï¼\n  [1]: http://www.google.com/\n  [baidu]: http://www.baidu.com/\n\n\n1\n2\n3\n4\n5\n6\n\n\nè¿ä¸ªé¾æ¥ç¨ 1 ä½ä¸ºç½ååé google\n\nè¿ä¸ªé¾æ¥ç¨ baidu ä½ä¸ºç½ååé baidu\n\n\n# githubä»åºä¸­ä½¿ç¨åé¨é¾æ¥\n\nå¯ä½¿ç¨ç¸å¯¹è·¯å¾ï¼åææ¯æè¯¥è·¯å¾ä¸çæä»¶ï¼\n[test](test.md)\n\n\n1\n2\n\n\ntest\n\n\n# éç¹é¾æ¥\n\næ¬æä»¶ä¸­æ¯ä¸ä¸ªæ é¢é½æ¯ä¸ä¸ªéç¹ï¼åhtmlçéç¹ï¼#ï¼ç±»ä¼¼\n\n[markdown](#markdown)\n\n\n1\n\n\n> æ³¨ï¼ githubå¯¹å«ææ ç¹ç¬¦å·çæ é¢è¿è¡éç¹æ¶ä¼å¿½ç¥ææ ç¹ç¬¦å·ï¼ æ¬é¡µä¸­ï¼å¦æè¿æ ·ååæ æ³è·³è½¬ï¼[é¾æ¥](#ä¹ãé¾æ¥) æ­£ç¡®åæ³ï¼[é¾æ¥](#ä¹é¾æ¥)\n\nmarkdown\n\né¾æ¥\n\næµç¨å¾\n\n\n# åãå¾ç\n\nåé¾æ¥çåºå«æ¯åé¢å¤ä¸ä¸ªæå¹å·!\n\n![å¾çå](å¾çé¾æ¥)\n\n\n1\n\n\nå½ç¶ï¼ä½ ä¹å¯ä»¥åé¾æ¥é£æ ·å¯¹å¾çå°åä½¿ç¨åé:\n\nè¿éé¾æ¥ç¨ img ä½ä¸ºå¾çå°ååé\nç¶åå¨ææ¡£çç»å°¾æå¶ä»ä½ç½®ç»åéèµå¼ï¼å¾çå°åï¼\n![runoob][img]\n[img]: https://raw.githubusercontent.com/xugaoyi/image_store/master/blog/md_logo.png\n\n\n1\n2\n3\n4\n\n\n\n\n\n# å¾çå®½é«\n\nå¦ä¸æ³è®¾ç½®å¾çå®½é«ï¼å¯ä»¥ä½¿ç¨ <img> æ ç­¾ã\n\n<img src=\"https://raw.githubusercontent.com/xugaoyi/image_store/master/blog/md_logo.png\" width=\"50px\" height=\"30px\">\n\n\n1\n\n\n\n# ç¸å¯¹è·¯å¾ä»¥ågithubä¸­ä½¿ç¨å¾ç\n\nä¸ç®¡æ¯å¨æ¬å°è¿æ¯å¨githubåä¸ä¸ªä»åºä¸­ï¼å¦æå¾çå­å¨ï¼å¯ä»¥ä½¿ç¨ç¸å¯¹è·¯å¾ã\n\nç¸å¯¹è·¯å¾å¾çï¼\n\n![å¤´åå¾ç](./md-img/test.jpg)\n\n\n1\n\n\ngithubä¸å¦æå¼ç¨å¶ä»githubä»åºä¸­çå¾çåè¦æ³¨æå°åæ ¼å¼ï¼ä»åºå°å/raw/åæ¯å/å¾çè·¯å¾ æ https://raw.githubusercontent.com/ç¨æ·å/ä»åºå/åæ¯å/å¾çè·¯å¾\n\n![å¶ä»ä»åºçå¾ç1](https://github.com/xugaoyi/vue-music/raw/master/src/common/image/default.png)\næ\n![å¶ä»ä»åºçå¾ç2](https://raw.githubusercontent.com/xugaoyi/image_store/master/blog/md_logo.png)\n\n\n\n1\n2\n3\n4\n\n\n\n\n\n\n\n# åä¸ãè¡¨æ ¼\n\nå¶ä½è¡¨æ ¼ä½¿ç¨ |æ¥åéä¸åçååæ ¼ï¼ä½¿ç¨-æ¥åéè¡¨å¤´åå¶ä»è¡ã\n\n|  è¡¨å¤´   | è¡¨å¤´  |\n|  ----  | ----  |\n| ååæ ¼  | ååæ ¼ |\n| ååæ ¼  | ååæ ¼ |\n\n\n1\n2\n3\n4\n\n\nè¡¨å¤´    è¡¨å¤´\nååæ ¼   ååæ ¼\nååæ ¼   ååæ ¼\n\nå¯¹é½æ¹å¼\n\n * -: è®¾ç½®åå®¹åæ é¢æ å±å³å¯¹é½\n * :- è®¾ç½®åå®¹åæ é¢æ å±å·¦å¯¹é½\n * :-: è®¾ç½®åå®¹åæ é¢æ å±ä¸­å¯¹é½\n\n| å·¦å¯¹é½ | å³å¯¹é½ | å±ä¸­å¯¹é½ |\n| :-----| ----: | :----: |\n| ååæ ¼ | ååæ ¼ | ååæ ¼ |\n| ååæ ¼ | ååæ ¼ | ååæ ¼ |\n\n\n1\n2\n3\n4\n\n\nå·¦å¯¹é½   å³å¯¹é½   å±ä¸­å¯¹é½\nååæ ¼   ååæ ¼   ååæ ¼\nååæ ¼   ååæ ¼   ååæ ¼\n\n\n# åäºãemojiè¡¨æå\n\nemojiè¡¨æè±æåçååå åå·ï¼typoreä¸åè¾å¥åå·åè¾å¥é¦å­æ¯æè¡¨ææç¤º\n\n:smirk:\n\n\n1\n\n\nð ð¸ðð´ ðððð âï¸\n\næ´å¤è¡¨æåç§°è¯·æ¥çï¼è¡¨æåæ¸å\n\n\n# åä¸ãå¶ä»æå·§\n\n\n# æ¯æç html åç´ \n\nä¸å¨ markdown è¯­æ³æ¶µçèå´ä¹åçæ ç­¾ï¼é½å¯ä»¥ç´æ¥å¨ææ¡£éé¢ç¨ html æ°åã\n\nç®åæ¯æç html åç´ æï¼<kbd> <b> <i> <em> <sup> <sub> <br>ç­ç­ ï¼å¦ï¼\n\nä½¿ç¨ <kbd>ctrl</kbd>+<kbd>alt</kbd>+<kbd>del</kbd> éå¯çµè\n\n\n1\n\n\nä½¿ç¨ ctrl+alt+del éå¯çµè\n\nææ¯ä½¿ç¨bæ ç­¾çå ç²å­ä½\n\n\n# è½¬ä¹\n\nmarkdown ä½¿ç¨äºå¾å¤ç¹æ®ç¬¦å·æ¥è¡¨ç¤ºç¹å®çæä¹ï¼å¦æéè¦æ¾ç¤ºç¹å®çç¬¦å·åéè¦ä½¿ç¨åææ è½¬ä¹å­ç¬¦ï¼\n\n**æªè½¬ä¹æå·æ¾ç¤ºå ç²**\n\\*\\* è½¬ä¹æ¾ç¤ºæå· \\*\\*\n\n\n1\n2\n\n\næªè½¬ä¹æå·æ¾ç¤ºå ç² ** è½¬ä¹æ¾ç¤ºæå· **\n\nmarkdown æ¯æä»¥ä¸è¿äºç¬¦å·åé¢å ä¸åææ æ¥å¸®å©æå¥æ®éçç¬¦å·ï¼\n\n\\   åæçº¿\n`   åå¼å·\n*   æå·\n_   ä¸åçº¿\n{}  è±æ¬å·\n[]  æ¹æ¬å·\n()  å°æ¬å·\n#   äºå­å·\n+   å å·\n-   åå·\n.   è±æå¥ç¹\n!   æå¹å·\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n----------------------------------------\n\n*** ä»¥ä¸é¨åå¨githubæå¶ä»å¨çº¿é¢è§ä¸­ææªæ¯æ ***\n\n----------------------------------------\n\n\n# æ°å­¦å¬å¼\n\nå½ä½ éè¦å¨ç¼è¾å¨ä¸­æå¥æ°å­¦å¬å¼æ¶ï¼å¯ä»¥ä½¿ç¨ä¸¤ä¸ªç¾åç¬¦ $$ åè£¹ tex æ latex æ ¼å¼çæ°å­¦å¬å¼æ¥å®ç°ãæäº¤åï¼é®ç­åæç« é¡µä¼æ ¹æ®éè¦å è½½ mathjax å¯¹æ°å­¦å¬å¼è¿è¡æ¸²æãå¦ï¼\n\n$$\n\\mathbf{v}_1 \\times \\mathbf{v}_2 =  \\begin{vmatrix}\n\\mathbf{i} & \\mathbf{j} & \\mathbf{k} \\\\\n\\frac{\\partial x}{\\partial u} &  \\frac{\\partial y}{\\partial u} & 0 \\\\\n\\frac{\\partial x}{\\partial v} &  \\frac{\\partial y}{\\partial v} & 0 \\\\\n\\end{vmatrix}\n$$tep1}{\\style{visibility:hidden}{(x+1)(x+1)}}\n$$\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n$$ \\mathbf{v}_1 \\times \\mathbf{v}_2 = \\begin{vmatrix} \\mathbf{i} & \\mathbf{j} & \\mathbf{k} \\ \\frac{\\partial x}{\\partial u} & \\frac{\\partial y}{\\partial u} & 0 \\ \\frac{\\partial x}{\\partial v} & \\frac{\\partial y}{\\partial v} & 0 \\ \\end{vmatrix} $$\n\n\n# å¾è¡¨\n\nâ```chart\n,budget,income,expenses,debt\njune,5000,8000,4000,6000\njuly,3000,1000,4000,3000\naug,5000,7000,6000,3000\nsep,7000,2000,3000,1000\noct,6000,5000,4000,2000\nnov,4000,3000,5000,\n\ntype: pie\ntitle: monthly revenue\nx.title: amount\ny.title: month\ny.suffix: $\nâ```\nâ```mermaid\nsequencediagram\na->>b: æ¯å¦å·²æ¶å°æ¶æ¯ï¼\nb--\x3e>a: å·²æ¶å°æ¶æ¯\nâ```\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n> æ³¨ï¼å¨typoraä¸­æªæ¯æ\n\n\n# æµç¨å¾\n\nè¯­æ³ï¼\nâ```mermaid\ngraph td\na[æ¨¡åa] --\x3e|a1| b(æ¨¡åb)\nb --\x3e c{å¤æ­æ¡ä»¶c}\nc --\x3e|æ¡ä»¶c1| d[æ¨¡åd]\nc --\x3e|æ¡ä»¶c2| e[æ¨¡åe]\nc --\x3e|æ¡ä»¶c3| f[æ¨¡åf]\nâ```\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\næµç¨å¾ç¸å³æç« ï¼\n\nhttps://www.jianshu.com/p/b421cc723da5\n\nhttp://www.imooc.com/article/292708\n\n\n# æ¶åºå¾\n\nâ```mermaid\nsequencediagram\na->>b: æ¯å¦å·²æ¶å°æ¶æ¯ï¼\nb--\x3e>a: å·²æ¶å°æ¶æ¯\nâ```\n\n\n1\n2\n3\n4\n5\n\n\n\n# çç¹å¾\n\nâ```mermaid\ngantt\ntitle çç¹å¾\ndateformat  yyyy-mm-dd\nsection é¡¹ç®a\nä»»å¡1           :a1, 2018-06-06, 30d\nä»»å¡2     :after a1  , 20d\nsection é¡¹ç®b\nä»»å¡3      :2018-06-12  , 12d\nä»»å¡4      : 24d\nâ```\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nåå°é¡¶é¨",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"npmå¸¸ç¨å½ä»¤",frontmatter:{title:"npmå¸¸ç¨å½ä»¤",date:"2019-12-25T14:27:01.000Z",permalink:"/pages/61f2f95fd7da14fd",categories:["ææ¯","ææ¯ææ¡£"],tags:[null],author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/100.%E5%85%B6%E4%BB%96/01.%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/03.npm%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.html",relativePath:"100.å¶ä»/01.ææ¯ææ¡£/03.npmå¸¸ç¨å½ä»¤.md",key:"v-a5b0f788",path:"/pages/61f2f95fd7da14fd/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:14},{level:2,title:"å¸¸ç¨å½ä»¤",slug:"å¸¸ç¨å½ä»¤",normalizedTitle:"å¸¸ç¨å½ä»¤",charIndex:5},{level:2,title:"ä½¿ç¨æå·§",slug:"ä½¿ç¨æå·§",normalizedTitle:"ä½¿ç¨æå·§",charIndex:1761},{level:2,title:"npmåå¸åæç¨",slug:"npmåå¸åæç¨",normalizedTitle:"npmåå¸åæç¨",charIndex:1912},{level:2,title:"nrmçä½ç¨ä¸ä½¿ç¨",slug:"nrmçä½ç¨ä¸ä½¿ç¨",normalizedTitle:"nrmçä½ç¨ä¸ä½¿ç¨",charIndex:1935}],excerpt:'<h1 id="npmå¸¸ç¨å½ä»¤"><a class="header-anchor" href="#npmå¸¸ç¨å½ä»¤">#</a> npmå¸¸ç¨å½ä»¤</h1>\n<h2 id="ç®ä»"><a class="header-anchor" href="#ç®ä»">#</a> ç®ä»</h2>\n<p>npmæ¯è·énodeä¸èµ·å®è£çåï¼æ¨¡åï¼ç®¡çå¨ãå¸¸è§çä½¿ç¨åºæ¯æä»¥ä¸å ç§ï¼</p>\n<ul>\n<li>åè®¸ç¨æ·ä»npmæå¡å¨ä¸è½½å«äººç¼åçç¬¬ä¸æ¹åå°æ¬å°ä½¿ç¨ã</li>\n<li>åè®¸ç¨æ·ä»npmæå¡å¨ä¸è½½å¹¶å®è£å«äººç¼åçå½ä»¤è¡ç¨åºå°æ¬å°ä½¿ç¨ã</li>\n<li>åè®¸ç¨æ·å°èªå·±ç¼åçåæå½ä»¤è¡ç¨åºä¸ä¼ å°npmæå¡å¨ä¾å«äººä½¿ç¨ã</li>\n</ul>\n',headersStr:"ç®ä» å¸¸ç¨å½ä»¤ ä½¿ç¨æå·§ npmåå¸åæç¨ nrmçä½ç¨ä¸ä½¿ç¨",content:'# npmå¸¸ç¨å½ä»¤\n\n\n# ç®ä»\n\nnpmæ¯è·énodeä¸èµ·å®è£çåï¼æ¨¡åï¼ç®¡çå¨ãå¸¸è§çä½¿ç¨åºæ¯æä»¥ä¸å ç§ï¼\n\n * åè®¸ç¨æ·ä»npmæå¡å¨ä¸è½½å«äººç¼åçç¬¬ä¸æ¹åå°æ¬å°ä½¿ç¨ã\n * åè®¸ç¨æ·ä»npmæå¡å¨ä¸è½½å¹¶å®è£å«äººç¼åçå½ä»¤è¡ç¨åºå°æ¬å°ä½¿ç¨ã\n * åè®¸ç¨æ·å°èªå·±ç¼åçåæå½ä»¤è¡ç¨åºä¸ä¼ å°npmæå¡å¨ä¾å«äººä½¿ç¨ã\n\n\n# å¸¸ç¨å½ä»¤\n\n# æ£æµæ¯å¦å®è£åçæ¬\n\nnpm -v # æ¾ç¤ºçæ¬å·è¯´æå·²ç»å®è£ç¸åºççæ¬\n\n\n1\n\n\n# çæpackage.jsonæä»¶\n\nnpm init\n\n\n1\n\n\n> package.jsonç¨æ¥æè¿°é¡¹ç®ä¸­ç¨å°çæ¨¡ååå¶ä»ä¿¡æ¯\n\n# å®è£æ¨¡å\n\nnpm install # å®è£package.jsonå®ä¹å¥½çæ¨¡åï¼ç®å npm i\n\n# å®è£åæå®æ¨¡å\nnpm i <ModuleName>\n\n# å¨å±å®è£\nnpm i <ModuleName> -g \n\n# å®è£åçåæ¶ï¼å°ä¿¡æ¯åå¥å°package.jsonä¸­ç dependencies éç½®ä¸­\nnpm i <ModuleName> --save\n\n# å®è£åçåæ¶ï¼å°ä¿¡æ¯åå¥å°package.jsonä¸­ç devDependencies éç½®ä¸­\nnpm i <ModuleName> --save-dev\n\n# å®è£å¤æ¨¡å\nnpm i <ModuleName1> <ModuleName2>\n\n# å®è£æ¹å¼åæ°ï¼\n-save # ç®å-Sï¼å å¥å°çäº§ä¾èµä¸­\n-save-dev # ç®å-Dï¼å å¥å°å¼åä¾èµä¸­\n-g # å¨å±å®è£ å°å®è£åæ¾å¨ /usr/local ä¸æèä½  node çå®è£ç®å½\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n# æ¥ç\n\n# æ¥çææå¨å±å®è£çå\nnpm ls -g\n\n# æ¥çæ¬å°é¡¹ç®ä¸­å®è£çå\nnpm ls\n\n# æ¥çåç package.jsonæä»¶\nnpm view <ModuleName>\n\n# æ¥çåçä¾èµå³ç³»\nnpm view <ModuleName> dependencies\n\n# æ¥çåçæºæä»¶å°å\nnpm view <ModuleName> repository.url\n\n# æ¥çåæä¾èµçnodeçæ¬\nnpm view <ModuleName> engines\n\n# æ¥çå¸®å©\nnpm help\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n# æ´æ°æ¨¡å\n\n# æ´æ°æ¬å°æ¨¡å\nnpm update <ModuleName>\n\n# æ´æ°å¨å±æ¨¡å\nnpm update -g <ModuleName> # æ´æ°å¨å±è½¯ä»¶åã\nnpm update -g # æ´æ°ææçå¨å±è½¯ä»¶åã\nnpm outdated -g --depth=0 # æ¾åºéè¦æ´æ°çåã\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n# å¸è½½æ¨¡å\n\n# å¸è½½æ¬å°æ¨¡å\nnpm uninstall <ModuleName>\n\n# å¸è½½å¨å±æ¨¡å\nnpm uninstall -g <ModuleName> # å¸è½½å¨å±è½¯ä»¶åã\n\n\n1\n2\n3\n4\n5\n\n\n# æ¸ç©ºç¼å­\n\n# æ¸ç©ºnpmç¼å­\nnpm cache clear\n\n\n1\n2\n\n\n# ä½¿ç¨æ·å®éå\n\n# ä½¿ç¨æ·å®éå\nnpm install -g cnpm --registry=https://registry.npm.taobao.org\n\n\n1\n2\n\n\n# å¶ä»\n\n# æ´æ¹ååå®¹åè¿è¡éå»º\nnpm rebuild <ModuleName>\n\n# æ£æ¥åæ¯å¦å·²ç»è¿æ¶ï¼æ­¤å½ä»¤ä¼ååºææå·²ç»è¿æ¶çåï¼å¯ä»¥åæ¶è¿è¡åçæ´æ°\nnpm outdated\n\n# è®¿é®npmçjsonæä»¶ï¼æ­¤å½ä»¤å°ä¼æå¼ä¸ä¸ªç½é¡µ\nnpm help json\n\n# åå¸ä¸ä¸ªåçæ¶åï¼éè¦æ£éªæä¸ªååæ¯å¦å­å¨\nnpm search <ModuleName>\n\n# æ¤éèªå·±åå¸è¿çæä¸ªçæ¬ä»£ç \nnpm unpublish <package> <version>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# ä½¿ç¨æå·§\n\n# å¤æ¬¡å®è£ä¸æåå°è¯åæ¸é¤ç¼å­\n\nnpm cache clean -f\n\n\n1\n\n\n# æ¥çå·²å®è£çä¾èµåçæ¬å·\n\nnpm ls <ModuleName>\n\n\n1\n\n\n> æ³¨æï¼ç¨æ­¤æ¹æ³æè½åç¡®çç¥éé¡¹ç®ä½¿ç¨ççæ¬å·ï¼æ¥çpackage.jsonæ¶ï¼æâ^" ç¬¦å·è¡¨ç¤ºå¤§äºæ­¤çæ¬\n\n\n# npmåå¸åæç¨\n\nnpmåå¸åæç¨\n\n\n# nrmçä½ç¨ä¸ä½¿ç¨\n\n# nrmæ¯ä»ä¹ï¼\n\nnrm(npm registry manager )æ¯npmçéåæºç®¡çå·¥å·ï¼ææ¶åå½å¤èµæºå¤ªæ¢ï¼ä½¿ç¨è¿ä¸ªå°±å¯ä»¥å¿«éå°å¨ npm æºé´åæ¢\n\n# nrmçå®è£\n\nnpm install -g nrm\n\n\n1\n\n\n# nrmå½ä»¤\n\nnrm lsã#æ¥çå¯ç¨çæºï¼æ*å·çè¡¨ç¤ºå½åæä½¿ç¨çæº,ä»¥ä¸<registry>è¡¨ç¤ºæºçåç§°ï¼\nnrm use <registry> # å°npmä¸è½½æºåæ¢ææå®çæº\nnrm add <registry> <url> # æ·»å æºï¼urlä¸ºæºçè·¯å¾\nnrm del <registry> # å é¤æº\nnrm test <registry> # æµè¯æºçååºæ¶é´ï¼å¯ä»¥ä½ä¸ºä½¿ç¨åªä¸ªæºçåè\n\nnrm helpã# æ¥çnrmå¸®å©\nnrm home <registry>ã# è·³è½¬å°æå®æºçå®ç½\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n# nrmä½¿ç¨\n\nå¦æå¨ä½ çç½ç»ä¸å¤ªçæ³æèåå°å¶ä»ç½ç»éå¶å¯¼è´ä¸è½ä½¿ç¨npmåæ¬çæºè¿è¡ä¸è½½æ¶ï¼nrmå°±éå¸¸æç¨äºï¼ä½ åªéè¦ï¼\n\nnrm ls # æ¥çå¯ç¨çæº\nnrm use <registry>ã# åæ¢å°æå®æº\n\n\n1\n2\n',normalizedContent:'# npmå¸¸ç¨å½ä»¤\n\n\n# ç®ä»\n\nnpmæ¯è·énodeä¸èµ·å®è£çåï¼æ¨¡åï¼ç®¡çå¨ãå¸¸è§çä½¿ç¨åºæ¯æä»¥ä¸å ç§ï¼\n\n * åè®¸ç¨æ·ä»npmæå¡å¨ä¸è½½å«äººç¼åçç¬¬ä¸æ¹åå°æ¬å°ä½¿ç¨ã\n * åè®¸ç¨æ·ä»npmæå¡å¨ä¸è½½å¹¶å®è£å«äººç¼åçå½ä»¤è¡ç¨åºå°æ¬å°ä½¿ç¨ã\n * åè®¸ç¨æ·å°èªå·±ç¼åçåæå½ä»¤è¡ç¨åºä¸ä¼ å°npmæå¡å¨ä¾å«äººä½¿ç¨ã\n\n\n# å¸¸ç¨å½ä»¤\n\n# æ£æµæ¯å¦å®è£åçæ¬\n\nnpm -v # æ¾ç¤ºçæ¬å·è¯´æå·²ç»å®è£ç¸åºççæ¬\n\n\n1\n\n\n# çæpackage.jsonæä»¶\n\nnpm init\n\n\n1\n\n\n> package.jsonç¨æ¥æè¿°é¡¹ç®ä¸­ç¨å°çæ¨¡ååå¶ä»ä¿¡æ¯\n\n# å®è£æ¨¡å\n\nnpm install # å®è£package.jsonå®ä¹å¥½çæ¨¡åï¼ç®å npm i\n\n# å®è£åæå®æ¨¡å\nnpm i <modulename>\n\n# å¨å±å®è£\nnpm i <modulename> -g \n\n# å®è£åçåæ¶ï¼å°ä¿¡æ¯åå¥å°package.jsonä¸­ç dependencies éç½®ä¸­\nnpm i <modulename> --save\n\n# å®è£åçåæ¶ï¼å°ä¿¡æ¯åå¥å°package.jsonä¸­ç devdependencies éç½®ä¸­\nnpm i <modulename> --save-dev\n\n# å®è£å¤æ¨¡å\nnpm i <modulename1> <modulename2>\n\n# å®è£æ¹å¼åæ°ï¼\n-save # ç®å-sï¼å å¥å°çäº§ä¾èµä¸­\n-save-dev # ç®å-dï¼å å¥å°å¼åä¾èµä¸­\n-g # å¨å±å®è£ å°å®è£åæ¾å¨ /usr/local ä¸æèä½  node çå®è£ç®å½\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n# æ¥ç\n\n# æ¥çææå¨å±å®è£çå\nnpm ls -g\n\n# æ¥çæ¬å°é¡¹ç®ä¸­å®è£çå\nnpm ls\n\n# æ¥çåç package.jsonæä»¶\nnpm view <modulename>\n\n# æ¥çåçä¾èµå³ç³»\nnpm view <modulename> dependencies\n\n# æ¥çåçæºæä»¶å°å\nnpm view <modulename> repository.url\n\n# æ¥çåæä¾èµçnodeçæ¬\nnpm view <modulename> engines\n\n# æ¥çå¸®å©\nnpm help\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n# æ´æ°æ¨¡å\n\n# æ´æ°æ¬å°æ¨¡å\nnpm update <modulename>\n\n# æ´æ°å¨å±æ¨¡å\nnpm update -g <modulename> # æ´æ°å¨å±è½¯ä»¶åã\nnpm update -g # æ´æ°ææçå¨å±è½¯ä»¶åã\nnpm outdated -g --depth=0 # æ¾åºéè¦æ´æ°çåã\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n# å¸è½½æ¨¡å\n\n# å¸è½½æ¬å°æ¨¡å\nnpm uninstall <modulename>\n\n# å¸è½½å¨å±æ¨¡å\nnpm uninstall -g <modulename> # å¸è½½å¨å±è½¯ä»¶åã\n\n\n1\n2\n3\n4\n5\n\n\n# æ¸ç©ºç¼å­\n\n# æ¸ç©ºnpmç¼å­\nnpm cache clear\n\n\n1\n2\n\n\n# ä½¿ç¨æ·å®éå\n\n# ä½¿ç¨æ·å®éå\nnpm install -g cnpm --registry=https://registry.npm.taobao.org\n\n\n1\n2\n\n\n# å¶ä»\n\n# æ´æ¹ååå®¹åè¿è¡éå»º\nnpm rebuild <modulename>\n\n# æ£æ¥åæ¯å¦å·²ç»è¿æ¶ï¼æ­¤å½ä»¤ä¼ååºææå·²ç»è¿æ¶çåï¼å¯ä»¥åæ¶è¿è¡åçæ´æ°\nnpm outdated\n\n# è®¿é®npmçjsonæä»¶ï¼æ­¤å½ä»¤å°ä¼æå¼ä¸ä¸ªç½é¡µ\nnpm help json\n\n# åå¸ä¸ä¸ªåçæ¶åï¼éè¦æ£éªæä¸ªååæ¯å¦å­å¨\nnpm search <modulename>\n\n# æ¤éèªå·±åå¸è¿çæä¸ªçæ¬ä»£ç \nnpm unpublish <package> <version>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# ä½¿ç¨æå·§\n\n# å¤æ¬¡å®è£ä¸æåå°è¯åæ¸é¤ç¼å­\n\nnpm cache clean -f\n\n\n1\n\n\n# æ¥çå·²å®è£çä¾èµåçæ¬å·\n\nnpm ls <modulename>\n\n\n1\n\n\n> æ³¨æï¼ç¨æ­¤æ¹æ³æè½åç¡®çç¥éé¡¹ç®ä½¿ç¨ççæ¬å·ï¼æ¥çpackage.jsonæ¶ï¼æâ^" ç¬¦å·è¡¨ç¤ºå¤§äºæ­¤çæ¬\n\n\n# npmåå¸åæç¨\n\nnpmåå¸åæç¨\n\n\n# nrmçä½ç¨ä¸ä½¿ç¨\n\n# nrmæ¯ä»ä¹ï¼\n\nnrm(npm registry manager )æ¯npmçéåæºç®¡çå·¥å·ï¼ææ¶åå½å¤èµæºå¤ªæ¢ï¼ä½¿ç¨è¿ä¸ªå°±å¯ä»¥å¿«éå°å¨ npm æºé´åæ¢\n\n# nrmçå®è£\n\nnpm install -g nrm\n\n\n1\n\n\n# nrmå½ä»¤\n\nnrm lsã#æ¥çå¯ç¨çæºï¼æ*å·çè¡¨ç¤ºå½åæä½¿ç¨çæº,ä»¥ä¸<registry>è¡¨ç¤ºæºçåç§°ï¼\nnrm use <registry> # å°npmä¸è½½æºåæ¢ææå®çæº\nnrm add <registry> <url> # æ·»å æºï¼urlä¸ºæºçè·¯å¾\nnrm del <registry> # å é¤æº\nnrm test <registry> # æµè¯æºçååºæ¶é´ï¼å¯ä»¥ä½ä¸ºä½¿ç¨åªä¸ªæºçåè\n\nnrm helpã# æ¥çnrmå¸®å©\nnrm home <registry>ã# è·³è½¬å°æå®æºçå®ç½\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n# nrmä½¿ç¨\n\nå¦æå¨ä½ çç½ç»ä¸å¤ªçæ³æèåå°å¶ä»ç½ç»éå¶å¯¼è´ä¸è½ä½¿ç¨npmåæ¬çæºè¿è¡ä¸è½½æ¶ï¼nrmå°±éå¸¸æç¨äºï¼ä½ åªéè¦ï¼\n\nnrm ls # æ¥çå¯ç¨çæº\nnrm use <registry>ã# åæ¢å°æå®æº\n\n\n1\n2\n',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"npm packageJsonå±æ§è¯¦è§£",frontmatter:{author:{name:"xugaoyi",link:"https://github.com/xugaoyi"},title:"npm packageJsonå±æ§è¯¦è§£",date:"2020-04-08T17:16:38.000Z",permalink:"/pages/dec4f3f00e71a312",categories:["ææ¯","ææ¯ææ¡£"],tags:[null]},regularPath:"/100.%E5%85%B6%E4%BB%96/01.%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/10.npm%20packageJson%E5%B1%9E%E6%80%A7%E8%AF%A6%E8%A7%A3.html",relativePath:"100.å¶ä»/01.ææ¯ææ¡£/10.npm packageJsonå±æ§è¯¦è§£.md",key:"v-5746bea6",path:"/pages/dec4f3f00e71a312/",headers:[{level:2,title:"æ¦è¿°",slug:"æ¦è¿°",normalizedTitle:"æ¦è¿°",charIndex:86},{level:2,title:"name",slug:"name",normalizedTitle:"name",charIndex:160},{level:2,title:"version",slug:"version",normalizedTitle:"version",charIndex:191},{level:2,title:"description",slug:"description",normalizedTitle:"description",charIndex:1036},{level:2,title:"keywords",slug:"keywords",normalizedTitle:"keywords",charIndex:1081},{level:2,title:"homepage",slug:"homepage",normalizedTitle:"homepage",charIndex:1114},{level:2,title:"bugs",slug:"bugs",normalizedTitle:"bugs",charIndex:1266},{level:2,title:"license",slug:"license",normalizedTitle:"license",charIndex:1496},{level:2,title:"åç¨æ·ç¸å³çå±æ§: author, contributors",slug:"åç¨æ·ç¸å³çå±æ§-author-contributors",normalizedTitle:"åç¨æ·ç¸å³çå±æ§: author, contributors",charIndex:1666},{level:2,title:"files",slug:"files",normalizedTitle:"files",charIndex:2037},{level:2,title:"main",slug:"main",normalizedTitle:"main",charIndex:2013},{level:2,title:"bin",slug:"bin",normalizedTitle:"bin",charIndex:2444},{level:2,title:"man",slug:"man",normalizedTitle:"man",charIndex:3180},{level:2,title:"directories",slug:"directories",normalizedTitle:"directories",charIndex:4055},{level:3,title:"directories.lib",slug:"directories-lib",normalizedTitle:"directories.lib",charIndex:4211},{level:3,title:"directories.bin",slug:"directories-bin",normalizedTitle:"directories.bin",charIndex:4282},{level:3,title:"directories.man",slug:"directories-man",normalizedTitle:"directories.man",charIndex:4383},{level:3,title:"directories.doc",slug:"directories-doc",normalizedTitle:"directories.doc",charIndex:4440},{level:3,title:"directories.example",slug:"directories-example",normalizedTitle:"directories.example",charIndex:4514},{level:2,title:"repository",slug:"repository",normalizedTitle:"repository",charIndex:4561},{level:2,title:"scripts",slug:"scripts",normalizedTitle:"scripts",charIndex:5066},{level:2,title:"config",slug:"config",normalizedTitle:"config",charIndex:146},{level:2,title:"dependencies",slug:"dependencies",normalizedTitle:"dependencies",charIndex:1017},{level:2,title:"URLs as Dependencies",slug:"urls-as-dependencies",normalizedTitle:"urls as dependencies",charIndex:6629},{level:2,title:"Git URLs as Dependencies",slug:"git-urls-as-dependencies",normalizedTitle:"git urls as dependencies",charIndex:6706},{level:2,title:"GitHub URLs",slug:"github-urls",normalizedTitle:"github urls",charIndex:7059},{level:2,title:"Local Paths",slug:"local-paths",normalizedTitle:"local paths",charIndex:7300},{level:2,title:"devDependencies",slug:"devdependencies",normalizedTitle:"devdependencies",charIndex:7631},{level:2,title:"peerDependencies",slug:"peerdependencies",normalizedTitle:"peerdependencies",charIndex:8354},{level:2,title:"bundledDependencies",slug:"bundleddependencies",normalizedTitle:"bundleddependencies",charIndex:8793},{level:2,title:"optionalDependencies",slug:"optionaldependencies",normalizedTitle:"optionaldependencies",charIndex:8870},{level:2,title:"engines",slug:"engines",normalizedTitle:"engines",charIndex:594},{level:2,title:"engineStrict",slug:"enginestrict",normalizedTitle:"enginestrict",charIndex:9646},{level:2,title:"os",slug:"os",normalizedTitle:"os",charIndex:1394},{level:2,title:"cpu",slug:"cpu",normalizedTitle:"cpu",charIndex:9846},{level:2,title:"preferGlobal",slug:"preferglobal",normalizedTitle:"preferglobal",charIndex:9962},{level:2,title:"private",slug:"private",normalizedTitle:"private",charIndex:10079},{level:2,title:"publishConfig",slug:"publishconfig",normalizedTitle:"publishconfig",charIndex:10172},{level:2,title:"DEFAULT VALUES",slug:"default-values",normalizedTitle:"default values",charIndex:10286},{level:2,title:"åèææ¡£åè¡¨(https://docs.npmjs.com/)",slug:"åèææ¡£åè¡¨-https-docs-npmjs-com",normalizedTitle:"åèææ¡£åè¡¨(https://docs.npmjs.com/)",charIndex:10599}],excerpt:'<h1 id="npm-package-jsonå±æ§è¯¦è§£"><a class="header-anchor" href="#npm-package-jsonå±æ§è¯¦è§£">#</a> npm package.jsonå±æ§è¯¦è§£</h1>\n<blockquote>\n<p>æ¬æè½¬èª<a href="https://www.cnblogs.com/tzyy/p/5193811.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/tzyy/p/5193811.html<OutboundLink/></a>ï¼ä½èï¼TZYY</p>\n</blockquote>\n<h2 id="æ¦è¿°"><a class="header-anchor" href="#æ¦è¿°">#</a> æ¦è¿°</h2>\n<p><code>package.json</code>å¿é¡»æ¯ä¸ä¸ªä¸¥æ ¼çjsonæä»¶ï¼èä¸ä»ä»æ¯jséè¾¹çä¸ä¸ªå¯¹è±¡ãå¶ä¸­å¾å¤å±æ§å¯ä»¥éè¿<code>npm-config</code>æ¥çæ</p>\n',headersStr:"æ¦è¿° name version description keywords homepage bugs license åç¨æ·ç¸å³çå±æ§: author, contributors files main bin man directories directories.lib directories.bin directories.man directories.doc directories.example repository scripts config dependencies URLs as Dependencies Git URLs as Dependencies GitHub URLs Local Paths devDependencies peerDependencies bundledDependencies optionalDependencies engines engineStrict os cpu preferGlobal private publishConfig DEFAULT VALUES åèææ¡£åè¡¨(https://docs.npmjs.com/)",content:'# npm package.jsonå±æ§è¯¦è§£\n\n> æ¬æè½¬èªhttps://www.cnblogs.com/tzyy/p/5193811.htmlï¼ä½èï¼TZYY\n\n\n# æ¦è¿°\n\npackage.jsonå¿é¡»æ¯ä¸ä¸ªä¸¥æ ¼çjsonæä»¶ï¼èä¸ä»ä»æ¯jséè¾¹çä¸ä¸ªå¯¹è±¡ãå¶ä¸­å¾å¤å±æ§å¯ä»¥éè¿npm-configæ¥çæ\n\n\n# name\n\npackage.jsonä¸­æéè¦çå±æ§æ¯nameåversionä¸¤ä¸ªå±æ§ï¼è¿ä¸¤ä¸ªå±æ§æ¯å¿é¡»è¦æçï¼å¦åæ¨¡åå°±æ æ³è¢«å®è£ï¼è¿ä¸¤ä¸ªå±æ§ä¸èµ·å½¢æäºä¸ä¸ªnpmæ¨¡åçå¯ä¸æ è¯ç¬¦ãæ¨¡åä¸­åå®¹åæ´çåæ¶ï¼æ¨¡åçæ¬ä¹åºè¯¥ä¸èµ·ååã nameå±æ§å°±æ¯ä½ çæ¨¡ååç§°ï¼ä¸é¢æ¯ä¸äºå½åè§å:\n\n * nameå¿é¡»å°äºç­äº214ä¸ªå­èï¼åæ¬åç¼åç§°å¨åï¼å¦ xxx/xxxmoduleï¼ã\n\n * nameä¸è½ä»¥"_"æ"."å¼å¤´\n\n * ä¸è½å«æå¤§åå­æ¯\n\n * nameä¼æä¸ºurlçä¸é¨åï¼ä¸è½å«æurléæ³å­ç¬¦\n   \n   ä¸é¢æ¯å®ç½ææ¡£çä¸äºå»ºè®®ï¼\n\n * ä¸è¦ä½¿ç¨ånodeæ ¸å¿æ¨¡åä¸æ ·çåç§°\n\n * nameä¸­ä¸è¦å«æ"js"å"node"ã It\'s assumed that it\'s js, since you\'re writing a package.json file, and you can specify the engine using the "engines" field. (See below.)\n\n * nameå±æ§ä¼æä¸ºæ¨¡åurlãå½ä»¤è¡ä¸­çä¸ä¸ªåæ°æèä¸ä¸ªæä»¶å¤¹åç§°ï¼ä»»ä½éurlå®å¨çå­ç¬¦å¨nameä¸­é½ä¸è½ä½¿ç¨ï¼ä¹ä¸è½ä»¥"_"æ"."å¼å¤´\n\n * nameå±æ§ä¹è®¸ä¼è¢«åå¨require()çåæ°ä¸­ï¼æä»¥æå¥½åä¸ªç®ç­èè¯­ä¹åçå¼ã\n\n * åå»ºä¸ä¸ªæ¨¡ååå¯ä»¥åå°åè¾¹çç½åæ¥æ¥nameæ¯å¦å·²ç»è¢«å ç¨. https://www.npmjs.com/\n   \n   * # åå¸ä¸ä¸ªåçæ¶åï¼éè¦æ£éªæä¸ªååæ¯å¦å­å¨\n     npm search <ModuleName>\n     \n     \n     1\n     2\n     \n\nnameå±æ§å¯ä»¥æä¸äºåç¼å¦ e.g. @myorg/mypackage.å¨npm-scope(7)çææ¡£ä¸­å¯ä»¥çå°è¯¦ç»è¯´æ\n\n\n# version\n\nversionå¿é¡»å¯ä»¥è¢«npmä¾èµçä¸ä¸ªnode-semveræ¨¡åè§£æãå·ä½è§åè§ä¸é¢çdependenciesæ¨¡å\n\n\n# description\n\nä¸ä¸ªæè¿°ï¼æ¹ä¾¿å«äººäºè§£ä½ çæ¨¡åä½ç¨ï¼æç´¢çæ¶åä¹æç¨ã\n\n\n# keywords\n\nä¸ä¸ªå­ç¬¦ä¸²æ°ç»ï¼æ¹ä¾¿å«äººæç´¢å°æ¬æ¨¡å\n\n\n# homepage\n\né¡¹ç®ä¸»é¡µurl æ³¨æ: è¿ä¸ªé¡¹ç®ä¸»é¡µurlåurlå±æ§ä¸åï¼å¦æä½ å¡«åäºurlå±æ§ï¼npmæ³¨åå·¥å·ä¼è®¤ä¸ºä½ æé¡¹ç®åå¸å°å¶ä»å°æ¹äºï¼è·åæ¨¡åçæ¶åä¸ä¼ä»npmå®æ¹ä»åºè·åï¼èæ¯ä¼éå®åå°urlå±æ§éç½®çå°åã ï¼åææ¡£ä¸­ç¨äº spit(å)è¿ä¸ªåè¯ï¼ä½èè¡¨ç¤ºä»ä¸æ¯å¨å¼ç©ç¬:ï¼\n\n\n# bugs\n\nå¡«åä¸ä¸ªbugæäº¤å°åæèä¸ä¸ªé®ç®±ï¼è¢«ä½ çæ¨¡ååå°çäººå¯ä»¥éè¿è¿éåæ§½ï¼ä¾å¦ï¼\n\n{\n    "url" : "https://github.com/owner/project/issues",\n    "email" : "project@hostname.com"\n}\n\n\n1\n2\n3\n4\n\n\nurlåemailå¯ä»¥ä»»æå¡«æä¸å¡«ï¼å¦æåªå¡«ä¸ä¸ªï¼å¯ä»¥ç´æ¥åæä¸ä¸ªå­ç¬¦ä¸²èä¸æ¯å¯¹è±¡ãå¦æå¡«åäºurlï¼npm bugså½ä»¤ä¼ä½¿ç¨è¿ä¸ªurlã\n\n\n# license\n\nä½ åºè¯¥ä¸ºä½ çæ¨¡åå¶å®ä¸ä¸ªåè®®ï¼è®©ç¨æ·ç¥éä»ä»¬æä½æéæ¥ä½¿ç¨ä½ çæ¨¡åï¼ä»¥åä½¿ç¨è¯¥æ¨¡åæåªäºéå¶ãæç®åçï¼ä¾å¦ä½ ç¨BSD-3-Clause æ MITä¹ç±»çåè®®ï¼å¦ä¸ï¼\n\n{ "license" : "MIT" }\n\n\n1\n\n\nä½ å¯ä»¥å¨https://spdx.org/licenses/ è¿ä¸ªå°åæ¥éåè®®åè¡¨ ã\n\n\n# åç¨æ·ç¸å³çå±æ§: author, contributors\n\nauthoræ¯ä¸ä¸ªç åï¼ contributorsæ¯ä¸ä¸ªç åæ°ç»ã personæ¯ä¸ä¸ªæä¸äºæè¿°å±æ§çå¯¹è±¡ï¼å¦ä¸ like this:\n\n{\n    "name" : "Barney Rubble",\n    "email" : "b@rubble.com",\n    "url" : "http://barnyrubble.tumblr.com/"\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¹å¯ä»¥æå¦ä¸æ ¼å¼ç¼©åï¼npmä¼å¸®çè½¬æ¢:\n\n"Barney Rubble b@rubble.com (http://barnyrubble.tumblr.com/)"\n\n\n1\n\n\nemailåurlå±æ§å®éä¸é½æ¯å¯ä»¥çç¥çãæè¿°ç¨æ·ä¿¡æ¯çè¿æä¸ä¸ªmaintainersï¼ç»´æ¤èï¼å±æ§ã\n\n\n# files\n\nfileså±æ§çå¼æ¯ä¸ä¸ªæ°ç»ï¼åå®¹æ¯æ¨¡åä¸æä»¶åæèæä»¶å¤¹åï¼å¦ææ¯æä»¶å¤¹åï¼åæä»¶å¤¹ä¸ææçæä»¶ä¹ä¼è¢«åå«è¿æ¥ï¼é¤éæä»¶è¢«å¦ä¸äºéç½®æé¤äºï¼ ä½ ä¹å¯ä»¥å¨æ¨¡åæ ¹ç®å½ä¸åå»ºä¸ä¸ª.npmignoreæä»¶ï¼windowsä¸æ æ³ç´æ¥åå»ºä»¥"."å¼å¤´çæä»¶ï¼ä½¿ç¨linuxå½ä»¤è¡å·¥å·åå»ºå¦git bashï¼ï¼åå¨è¿ä¸ªæä»¶éè¾¹çæä»¶å³ä¾¿è¢«åå¨fileså±æ§éè¾¹ä¹ä¼è¢«æé¤å¨å¤ï¼è¿ä¸ªæä»¶çåæ³".gitignore"ç±»ä¼¼ã\n\n\n# main\n\nmainå±æ§æå®äºç¨åºçä¸»å¥å£æä»¶ãæææ¯ï¼å¦æä½ çæ¨¡åè¢«å½åä¸ºfooï¼ç¨æ·å®è£äºè¿ä¸ªæ¨¡åå¹¶éè¿require("foo")æ¥ä½¿ç¨è¿ä¸ªæ¨¡åï¼é£ä¹requireè¿åçåå®¹å°±æ¯mainå±æ§æå®çæä»¶ä¸­ module.exportsæåçå¯¹è±¡ã å®åºè¯¥æåæ¨¡åæ ¹ç®å½ä¸çä¸ä¸ªæä»¶ãå¯¹å¤§å¯¹æ°æ¨¡åèè¨ï¼è¿ä¸ªå±æ§æ´å¤çæ¯è®©æ¨¡åæä¸ä¸ªä¸»å¥å£æä»¶ï¼ç¶èå¾å¤æ¨¡åå¹¶ä¸åè¿ä¸ªå±æ§ã\n\n\n# bin\n\nå¾å¤æ¨¡åæä¸ä¸ªæå¤ä¸ªéè¦éç½®å°PATHè·¯å¾ä¸çå¯æ§è¡æ¨¡åï¼npmè®©è¿ä¸ªå·¥ä½åå¾ååç®åï¼å®éä¸npmæ¬èº«ä¹æ¯éè¿binå±æ§å®è£ä¸ºä¸ä¸ªå¯æ§è¡å½ä»¤çï¼ å¦æè¦ç¨npmçè¿ä¸ªåè½ï¼å¨package.jsonéè¾¹éç½®ä¸ä¸ªbinå±æ§ãbinå±æ§æ¯ä¸ä¸ªå·²å½ä»¤åç§°ä¸ºkeyï¼æ¬å°æä»¶åç§°ä¸ºvalueçmapå¦ä¸ï¼\n\n{\n    "bin" : { "myapp" : "./cli.js" }\n}\n\n\n1\n2\n3\n\n\næ¨¡åå®è£çæ¶åï¼è¥æ¯å¨å±å®è£ï¼ånpmä¼ä¸ºbinä¸­éç½®çæä»¶å¨binç®å½ä¸åå»ºä¸ä¸ªè½¯è¿æ¥ï¼å¯¹äºwindowsç³»ç»ï¼é»è®¤ä¼å¨C:\\Users\\username\\AppData\\Roaming\\npmç®å½ä¸ï¼ï¼è¥æ¯å±é¨å®è£ï¼åä¼å¨é¡¹ç®åç./node_modules/.bin/ç®å½ä¸åå»ºä¸ä¸ªè½¯é¾æ¥ã å æ­¤ï¼æä¸é¢çä¾å­ï¼å½ä½ å®è£myappçæ¶åï¼npmå°±ä¼ä¸ºcli.jså¨/usr/local/bin/myappè·¯å¾åå»ºä¸ä¸ªè½¯é¾æ¥ã å¦æä½ çæ¨¡ååªæä¸ä¸ªå¯æ§è¡æä»¶ï¼å¹¶ä¸å®çå½ä»¤åç§°åæ¨¡ååç§°ä¸æ ·ï¼ä½ å¯ä»¥åªåä¸ä¸ªå­ç¬¦ä¸²æ¥ä»£æ¿ä¸é¢é£ç§éç½®ï¼ä¾å¦ï¼\n\n{ \n    "name": "my-program",\n    "version": "1.2.5", \n    "bin": "./path/to/program"\n}\n\n\n1\n2\n3\n4\n5\n\n\nä½ç¨åå¦ä¸åæ³ç¸å:\n\n{ \n    "name": "my-program", \n    "version": "1.2.5", \n    "bin" : { \n        "my-program" : "./path/to/program" \n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# man\n\nå¶å®ä¸ä¸ªæéè¿æ°ç»å¶å®ä¸äºæä»¶æ¥è®©linuxä¸çmanå½ä»¤æ¥æ¾ææ¡£å°åã å¦æåªæä¸ä¸ªæä»¶è¢«æå®çè¯ï¼å®è£åç´æ¥ä½¿ç¨man+æ¨¡ååç§°ï¼èä¸ç®¡manæå®çæä»¶çå®éåç§°ãä¾å¦:\n\n{\n    "name" : "foo",\n    "version" : "1.2.3", \n    "description" : "A packaged foo fooer for fooing foos", \n    "main" : "foo.js", \n    "man" : "./man/doc.1"\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\néè¿man fooå½ä»¤ä¼å¾å° ./man/doc.1 æä»¶çåå®¹ã å¦æmanæä»¶åç§°ä¸æ¯ä»¥æ¨¡ååç§°å¼å¤´çï¼å®è£çæ¶åä¼ç»å ä¸æ¨¡ååç§°åç¼ãå æ­¤ï¼ä¸é¢è¿æ®µéç½®ï¼\n\n{ \n    "name" : "foo", \n    "version" : "1.2.3", \n    "description" : "A packaged foo fooer for fooing foos", \n    "main" : "foo.js", \n    "man" : [ "./man/foo.1", "./man/bar.1" ]\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¼åå»ºä¸äºæä»¶æ¥ä½ä¸ºman fooåman foo-barå½ä»¤çç»æã manæä»¶å¿é¡»ä»¥æ°å­ç»å°¾ï¼æèå¦æè¢«åç¼©äºï¼ä»¥.gzç»å°¾ãæ°å­è¡¨ç¤ºæä»¶å°è¢«å®è£å°mançåªä¸ªé¨åã\n\n{ \n    "name" : "foo", \n    "version" : "1.2.3",\n    "description" : "A packaged foo fooer for fooing foos", \n    "main" : "foo.js", \n    "man" : [ "./man/foo.1", "./man/foo.2" ]\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¼åå»º man foo å man 2 foo ä¸¤æ¡å½ä»¤ã\n\n\n# directories\n\nCommonJséè¿directoriesæ¥å¶å®ä¸äºæ¹æ³æ¥æè¿°æ¨¡åçç»æï¼ççnpmçpackage.jsonæä»¶https://registry.npmjs.org/npm/latest ï¼å¯ä»¥åç°éè¾¹æè¿ä¸ªå­æ®µçåå®¹ã ç®åè¿ä¸ªéç½®æ²¡æä»»ä½ä½ç¨ï¼å°æ¥å¯è½ä¼æ´åºä¸äºè±æ ·æ¥ã\n\n\n# directories.lib\n\nåè¯ç¨æ·æ¨¡åä¸­libç®å½å¨åªï¼è¿ä¸ªéç½®ç®åæ²¡æä»»ä½ä½ç¨ï¼ä½æ¯å¯¹ä½¿ç¨æ¨¡åçäººæ¥è¯´æ¯ä¸ä¸ªå¾æç¨çä¿¡æ¯ã\n\n\n# directories.bin\n\nå¦æä½ å¨è¿éæå®äºbinç®å½ï¼è¿ä¸ªéç½®ä¸é¢çæä»¶ä¼è¢«å å¥å°binè·¯å¾ä¸ï¼å¦æä½ å·²ç»å¨package.jsonä¸­éç½®äºbinç®å½ï¼é£ä¹è¿éçéç½®å°ä¸èµ·ä»»ä½ä½ç¨ã\n\n\n# directories.man\n\næå®ä¸ä¸ªç®å½ï¼ç®å½éè¾¹é½æ¯manæä»¶ï¼è¿æ¯ä¸ç§éç½®manæä»¶çè¯­æ³ç³ã\n\n\n# directories.doc\n\nå¨è¿ä¸ªç®å½éè¾¹æ¾ä¸äºmarkdownæä»¶ï¼å¯è½æç»æä¸å¤©å®ä»¬ä¼è¢«åå¥½çå±ç°åºæ¥ï¼åºè¯¥æ¯å¨npmçç½ç«ä¸ï¼\n\n\n# directories.example\n\næ¾ä¸äºç¤ºä¾èæ¬ï¼æè®¸æä¸å¤©ä¼æç¨ - -ï¼\n\n\n# repository\n\næå®ä¸ä¸ªä»£ç å­æ¾å°åï¼å¯¹æ³è¦ä¸ºä½ çé¡¹ç®è´¡ç®ä»£ç çäººæå¸®å©ãåè¿æ ·ï¼\n\n"repository" :\n  {\n      "type" : "git",\n      "url" : "https://github.com/npm/npm.git"\n  }\n\n"repository" :\n  { \n      "type" : "svn", \n      "url" : "https://v8.googlecode.com/svn/trunk/"\n  }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nè¥ä½ çæ¨¡åæ¾å¨GitHub, GitHub gist, Bitbucket, or GitLabçä»åºéï¼npm installçæ¶åå¯ä»¥ä½¿ç¨ç¼©åæ è®°æ¥å®æï¼\n\n"repository": "npm/npm"\n\n"repository": "gist:11081aaa281"\n\n"repository": "bitbucket:example/repo"\n\n"repository": "gitlab:another/repo"\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# scripts\n\nscriptså±æ§æ¯ä¸ä¸ªå¯¹è±¡ï¼éè¾¹æå®äºé¡¹ç®ççå½å¨æä¸ªåä¸ªç¯èéè¦æ§è¡çå½ä»¤ãkeyæ¯çå½å¨æä¸­çäºä»¶ï¼valueæ¯è¦æ§è¡çå½ä»¤ã å·ä½çåå®¹æ install start stop ç­ï¼è¯¦è§ https://docs.npmjs.com/misc/scripts\n\n\n# config\n\nç¨æ¥è®¾ç½®ä¸äºé¡¹ç®ä¸æä¹ååçé¡¹ç®éç½®ï¼ä¾å¦portç­ã ç¨æ·ç¨çæ¶åå¯ä»¥ä½¿ç¨å¦ä¸ç¨æ³ï¼\n\nhttp.createServer(...).listen(process.env.npm_package_config_port)\n\n\n1\n\n\nå¯ä»¥éè¿npm config set foo:port 80æ¥ä¿®æ¹configãè¯¦è§https://docs.npmjs.com/misc/config\n\n{ \n    "name" : "foo", \n    "config" : { "port" : "8080" }\n}\n\n\n1\n2\n3\n4\n\n\n\n# dependencies\n\ndependencieså±æ§æ¯ä¸ä¸ªå¯¹è±¡ï¼éç½®æ¨¡åä¾èµçæ¨¡ååè¡¨ï¼keyæ¯æ¨¡ååç§°ï¼valueæ¯çæ¬èå´ï¼çæ¬èå´æ¯ä¸ä¸ªå­ç¬¦ï¼å¯ä»¥è¢«ä¸ä¸ªæå¤ä¸ªç©ºæ ¼åå²ã dependenciesä¹å¯ä»¥è¢«æå®ä¸ºä¸ä¸ªgitå°åæèä¸ä¸ªåç¼©åå°åã ä¸è¦ææµè¯å·¥å·ætranspilersåå°dependenciesä¸­ã ä¸é¢æ¯ä¸äºåæ³ï¼è¯¦è§https://docs.npmjs.com/misc/semver\n\n * version ç²¾ç¡®å¹éçæ¬\n * >version å¿é¡»å¤§äºæä¸ªçæ¬\n * >=version å¤§äºç­äº\n * <version å°äº\n * <=versionversion å°äº\n * ~version "çº¦ç­äº"ï¼å·ä½è§åè¯¦è§semverææ¡£\n * ^version "å¼å®¹çæ¬"å·ä½è§åè¯¦è§semverææ¡£\n * 1.2.x ä»ä¸ç¹äºç¹å ççæ¬\n * http://... è§ä¸é¢urlä½ä¸ºdenpendenciesçè¯´æ\n * * ä»»ä½çæ¬\n * "" ç©ºå­ç¬¦ï¼å*ç¸å\n * version1 - version2 ç¸å½äº >=version1 <=version2.\n * range1 || range2 èå´1åèå´2æ»¡è¶³ä»»æä¸ä¸ªé½è¡\n * git... è§ä¸é¢git urlä½ä¸ºdenpendenciesçè¯´æ\n * user/repo See è§ä¸é¢GitHubä»åºçè¯´æ\n * tag åå¸çä¸ä¸ªç¹æ®çæ ç­¾ï¼è§npm-tagçææ¡£ https://docs.npmjs.com/getting-started/using-tags\n * path/path/path è§ä¸é¢æ¬å°æ¨¡åçè¯´æ ä¸é¢çåæ³é½æ¯å¯ä»¥ç:\n\n{ "dependencies" :\n  { "foo" : "1.0.0 - 2.9999.9999"\n  , "bar" : ">=1.0.2 <2.1.2"\n  , "baz" : ">1.0.2 <=2.3.4"\n  , "boo" : "2.0.1"\n  , "qux" : "<1.0.0 || >=2.3.1 <2.4.5 || >=2.5.2 <3.0.0"\n  , "asd" : "http://asdf.com/asdf.tar.gz"\n  , "til" : "~1.2"\n  , "elf" : "~1.2.3"\n  , "two" : "2.x"\n  , "thr" : "3.3.x"\n  , "lat" : "latest"\n  , "dyl" : "file:../dyl"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# URLs as Dependencies\n\nå¨çæ¬èå´çå°æ¹å¯ä»¥åä¸ä¸ªurlæåä¸ä¸ªåç¼©åï¼æ¨¡åå®è£çæ¶åä¼æè¿ä¸ªåç¼©åä¸è½½ä¸æ¥å®è£å°æ¨¡åæ¬å°ã\n\n\n# Git URLs as Dependencies\n\nGit urlå¯ä»¥åä¸é¢ä¸æ ·:\n\ngit://github.com/user/project.git#commit-ish\ngit+ssh://user@hostname:project.git#commit-ish\ngit+ssh://user@hostname/project.git#commit-ish\ngit+http://user@hostname/project/blah.git#commit-ish\ngit+https://user@hostname/project/blah.git#commit-ish\n\n\n1\n2\n3\n4\n5\n\n\ncommit-ish å¯ä»¥æ¯ä»»ææ ç­¾ï¼åå¸å¼ï¼æèå¯ä»¥æ£åºçåæ¯ï¼é»è®¤æ¯masteråæ¯ã\n\n\n# GitHub URLs\n\næ¯ægithubç username/modulename çåæ³ï¼#åè¾¹å¯ä»¥å åç¼åæåæ¯hashææ ç­¾ï¼\n\n{\n  "name": "foo",\n  "version": "0.0.0",\n  "dependencies": {\n    "express": "visionmedia/express",\n    "mocha": "visionmedia/mocha#4727d357ea"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# Local Paths\n\nnpm2.0.0çæ¬ä»¥ä¸å¯ä»¥æä¾ä¸ä¸ªæ¬å°è·¯å¾æ¥å®è£ä¸ä¸ªæ¬å°çæ¨¡åï¼éè¿npm install xxx --save æ¥å®è£ï¼æ ¼å¼å¦ä¸ï¼\n\n../foo/bar\n~/foo/bar\n./foo/bar\n/foo/bar\n\n\n1\n2\n3\n4\n\n\npackage.json çæçç¸å¯¹è·¯å¾å¦ä¸:\n\n{\n  "name": "baz",\n  "dependencies": {\n    "bar": "file:../foo/bar"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nè¿ç§å±æ§å¨ç¦»çº¿å¼åæèæµè¯éè¦ç¨npm installçæåµï¼åä¸æ³èªå·±æä¸ä¸ªnpm serverçæ¶åæç¨ï¼ä½æ¯åå¸æ¨¡åå°å¬å±ä»åºæ¶ä¸åºè¯¥ä½¿ç¨è¿ç§å±æ§ã\n\n\n# devDependencies\n\nå¦ææäººæ³è¦ä¸è½½å¹¶ä½¿ç¨ä½ çæ¨¡åï¼ä¹è®¸ä»ä»¬å¹¶ä¸å¸ææéè¦ä¸è½½ä¸äºä½ å¨å¼åè¿ç¨ä¸­ä½¿ç¨çé¢å¤çæµè¯æèææ¡£æ¡æ¶ã å¨è¿ç§æåµä¸ï¼æå¥½çæ¹æ³æ¯æè¿äºä¾èµæ·»å å°devDependencieså±æ§çå¯¹è±¡ä¸­ã è¿äºæ¨¡åä¼å¨npm linkæènpm installçæ¶åè¢«å®è£ï¼ä¹å¯ä»¥åå¶ä»npméç½®ä¸æ ·è¢«ç®¡çï¼è¯¦è§npmçconfigææ¡£ã å¯¹äºä¸äºè·¨å¹³å°çæå»ºä»»å¡ï¼ä¾å¦æCoffeeScriptç¼è¯æJavaScriptï¼å°±å¯ä»¥éè¿å¨package.jsonçscriptå±æ§éè¾¹éç½®prepublishèæ¬æ¥å®æè¿ä¸ªä»»å¡ï¼ç¶åéè¦ä¾èµçcoffee-scriptæ¨¡åå°±åå¨devDependencieså±æ§ç§ã ä¾å¦:\n\n{ "name": "ethopia-waza",\n  "description": "a delightfully fruity coffee varietal",\n  "version": "1.2.3",\n  "devDependencies": {\n    "coffee-script": "~1.6.3"\n  },\n  "scripts": {\n    "prepublish": "coffee -o lib/ -c src/waza.coffee"\n  },\n  "main": "lib/waza.js"\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nprepublishèæ¬ä¼å¨åå¸ä¹åè¿è¡ï¼å æ­¤ç¨æ·å¨ä½¿ç¨ä¹åå°±ä¸ç¨åèªå·±å»å®æç¼è¯çè¿ç¨äºãå¨å¼åæ¨¡å¼ä¸ï¼è¿è¡npm installä¹ä¼æ§è¡è¿ä¸ªèæ¬ï¼è§npm scriptææ¡£ï¼ï¼å æ­¤å¯ä»¥å¾æ¹ä¾¿çè°è¯ã\n\n\n# peerDependencies\n\nææ¶ååä¸äºæä»¶å¼åï¼æ¯å¦gruntç­å·¥å·çæä»¶ï¼å®ä»¬å¾å¾æ¯å¨gruntçæä¸ªçæ¬çåºç¡ä¸å¼åçï¼èå¨ä»ä»¬çä»£ç ä¸­å¹¶ä¸ä¼åºç°require("grunt")è¿æ ·çä¾èµï¼dependencieséç½®éè¾¹ä¹ä¸ä¼åä¸gruntçä¾èµï¼ä¸ºäºè¯´ææ­¤æ¨¡ååªè½ä½ä¸ºæä»¶è·å¨å®¿ä¸»çæä¸ªçæ¬èå´ä¸ï¼å¯ä»¥éç½®peerDependenciesï¼\n\n{\n  "name": "tea-latte",\n  "version": "1.3.5",\n  "peerDependencies": {\n    "tea": "2.x"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢è¿ä¸ªéç½®ç¡®ä¿ånpm installçæ¶åtea-latteä¼å2.xçæ¬çteaä¸èµ·å®è£ï¼èä¸å®ä»¬ä¸¤ä¸ªçä¾èµå³ç³»æ¯åçº§çï¼ âââ tea-latte@1.3.5 âââ tea@2.2.0 è¿ä¸ªéç½®çç®çæ¯è®©npmç¥éï¼å¦æè¦ä½¿ç¨æ­¤æä»¶æ¨¡åï¼è¯·ç¡®ä¿å®è£äºå¼å®¹çæ¬çå®¿ä¸»æ¨¡åã\n\n\n# bundledDependencies\n\nä¸é¢çåè¯å°ä¸ªdï¼åæbundleDependenciesä¹å¯ä»¥ã æå®åå¸çæ¶åä¼è¢«ä¸èµ·æåçæ¨¡åã\n\n\n# optionalDependencies\n\nå¦æä¸ä¸ªä¾èµæ¨¡åå¯ä»¥è¢«ä½¿ç¨ï¼ åæ¶ä½ ä¹å¸æå¨è¯¥æ¨¡åæ¾ä¸å°ææ æ³è·åæ¶npmç»§ç»­è¿è¡ï¼ä½ å¯ä»¥æè¿ä¸ªæ¨¡åä¾èµæ¾å°optionalDependencieséç½®ä¸­ãè¿ä¸ªéç½®çåæ³ådependenciesçåæ³ä¸æ ·ï¼ä¸åçæ¯è¿éè¾¹åçæ¨¡åå®è£å¤±è´¥ä¸ä¼å¯¼è´npm installå¤±è´¥ã å½ç¶ï¼è¿ç§æ¨¡åå°±éè¦ä½ èªå·±å¨ä»£ç ä¸­å¤çæ¨¡åç¡®å®çæåµäºï¼ä¾å¦ï¼\n\ntry {\n  var foo = require(\'foo\')\n  var fooVersion = require(\'foo/package.json\').version\n} catch (er) {\n  foo = null\n}\nif ( notGoodFooVersion(fooVersion) ) {\n  foo = null\n}\n\n// .. then later in your program ..\n\nif (foo) {\n  foo.doFooThings()\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\noptionalDependencies ä¸­çéç½®ä¼è¦çdependenciesä¸­çéç½®ï¼æå¥½åªå¨ä¸ä¸ªå°æ¹åã\n\n\n# engines\n\nä½ å¯ä»¥æå®é¡¹ç®è¿è¡çnodeçæ¬èå´ï¼å¦ä¸ï¼ { "engines" : { "node" : ">=0.10.3 <0.12" } } ådependenciesä¸æ ·ï¼å¦æä½ ä¸æå®çæ¬èå´æèæå®ä¸º*ï¼ä»»ä½çæ¬çnodeé½å¯ä»¥ã ä¹å¯ä»¥æå®ä¸äºnpmçæ¬å¯ä»¥æ­£ç¡®çå®è£ä½ çæ¨¡åï¼ä¾å¦ï¼ { "engines" : { "npm" : "~1.0.20" } } è¦æ³¨æçæ¯ï¼é¤éä½ è®¾ç½®äºengine-strictå±æ§ï¼engineså±æ§æ¯ä»ä¾åèçã\n\n\n# engineStrict\n\næ³¨æï¼è¿ä¸ªå±æ§å·²ç»å¼ç¨ï¼å°å¨npm 3.0.0 çæ¬å¹²æã\n\n\n# os\n\nå¯ä»¥æå®ä½ çæ¨¡ååªè½å¨åªä¸ªæä½ç³»ç»ä¸è·ï¼ "os" : [ "darwin", "linux" ] ä¹å¯ä»¥æå®é»ååèä¸æ¯ç½ååï¼ "os" : [ "!win32" ] æå¡çæä½ç³»ç»æ¯ç±process.platformæ¥å¤æ­çï¼è¿ä¸ªå±æ§åè®¸é»ç½åååæ¶å­å¨ï¼è½ç¶æ²¡å¥å¿è¦è¿æ ·æ...\n\n\n# cpu\n\néå¶æ¨¡ååªè½å¨ææcpuæ¶æä¸è¿è¡ "cpu" : [ "x64", "ia32" ] åæ ·å¯ä»¥è®¾ç½®é»åå: "cpu" : [ "!arm", "!mips" ] cpuæ¶æéè¿ process.arch å¤æ­\n\n\n# preferGlobal\n\nå¦ææ¨çè½¯ä»¶åä¸»è¦ç¨äºå®è£å°å¨å±çå½ä»¤è¡åºç¨ç¨åºï¼é£ä¹è¯¥å¼è®¾ç½®ä¸ºtrue ï¼å¦æå®è¢«å®è£å¨æ¬å°ï¼åæä¾ä¸ä¸ªè­¦åãå®éä¸è¯¥éç½®å¹¶æ²¡æé»æ­¢ç¨æ·ææ¨¡åå®è£å°æ¬å°ï¼åªæ¯é²æ­¢è¯¥æ¨¡åè¢«éè¯¯çä½¿ç¨å¼èµ·ä¸äºé®é¢ã\n\n\n# private\n\nå¦æè¿ä¸ªå±æ§è¢«è®¾ç½®ä¸ºtrueï¼npmå°æç»åå¸å®ï¼è¿æ¯ä¸ºäºé²æ­¢ä¸ä¸ªç§ææ¨¡åè¢«æ æé´åå¸åºå»ãå¦æä½ åªæ³è®©æ¨¡åè¢«åå¸å°ä¸ä¸ªç¹å®çnpmä»åºï¼å¦ä¸ä¸ªåé¨çä»åºï¼å¯ä¸å¨ä¸é¢çpublishConfigä¸­éç½®ä»åºåæ°ã\n\n\n# publishConfig\n\nè¿ä¸ªéç½®æ¯ä¼å¨æ¨¡ååå¸æ¶ç¨å°çä¸äºå¼çéåãå¦æä½ ä¸æ³æ¨¡åè¢«é»è®¤è¢«æ è®°ä¸ºææ°çï¼æèé»è®¤åå¸å°å¬å±ä»åºï¼å¯ä»¥å¨è¿ééç½®tagæä»åºå°åã\n\n\n# DEFAULT VALUES\n\nnpmè®¾ç½®äºä¸äºé»è®¤åæ°ï¼å¦ï¼ "scripts": {"start": "node server.js"} å¦ææ¨¡åæ ¹ç®å½ä¸æä¸ä¸ªserver.jsæä»¶ï¼é£ä¹npm startä¼é»è®¤è¿è¡è¿ä¸ªæä»¶ã "scripts":{"preinstall": "node-gyp rebuild"} å¦ææ¨¡åæ ¹ç®å½ä¸æbinding.gyp, npmå°é»è®¤ç¨node-gypæ¥ç¼è¯preinstallçèæ¬ "contributors": [...] è¥æ¨¡åæ ¹ç®å½ä¸æAUTHORS æä»¶ï¼ånpmä¼æName (url)æ ¼å¼è§£ææ¯ä¸è¡çæ°æ®æ·»å å°contributorsä¸­ï¼å¯ä»¥ç¨#æ·»å è¡æ³¨é\n\n\n# åèææ¡£åè¡¨(https://docs.npmjs.com/)\n\nsemver(7) npm-init(1) npm-version(1) npm-config(1) npm-config(7) npm-help(1) npm-faq(7) npm-install(1) npm-publish(1) npm-rm(1)',normalizedContent:'# npm package.jsonå±æ§è¯¦è§£\n\n> æ¬æè½¬èªhttps://www.cnblogs.com/tzyy/p/5193811.htmlï¼ä½èï¼tzyy\n\n\n# æ¦è¿°\n\npackage.jsonå¿é¡»æ¯ä¸ä¸ªä¸¥æ ¼çjsonæä»¶ï¼èä¸ä»ä»æ¯jséè¾¹çä¸ä¸ªå¯¹è±¡ãå¶ä¸­å¾å¤å±æ§å¯ä»¥éè¿npm-configæ¥çæ\n\n\n# name\n\npackage.jsonä¸­æéè¦çå±æ§æ¯nameåversionä¸¤ä¸ªå±æ§ï¼è¿ä¸¤ä¸ªå±æ§æ¯å¿é¡»è¦æçï¼å¦åæ¨¡åå°±æ æ³è¢«å®è£ï¼è¿ä¸¤ä¸ªå±æ§ä¸èµ·å½¢æäºä¸ä¸ªnpmæ¨¡åçå¯ä¸æ è¯ç¬¦ãæ¨¡åä¸­åå®¹åæ´çåæ¶ï¼æ¨¡åçæ¬ä¹åºè¯¥ä¸èµ·ååã nameå±æ§å°±æ¯ä½ çæ¨¡ååç§°ï¼ä¸é¢æ¯ä¸äºå½åè§å:\n\n * nameå¿é¡»å°äºç­äº214ä¸ªå­èï¼åæ¬åç¼åç§°å¨åï¼å¦ xxx/xxxmoduleï¼ã\n\n * nameä¸è½ä»¥"_"æ"."å¼å¤´\n\n * ä¸è½å«æå¤§åå­æ¯\n\n * nameä¼æä¸ºurlçä¸é¨åï¼ä¸è½å«æurléæ³å­ç¬¦\n   \n   ä¸é¢æ¯å®ç½ææ¡£çä¸äºå»ºè®®ï¼\n\n * ä¸è¦ä½¿ç¨ånodeæ ¸å¿æ¨¡åä¸æ ·çåç§°\n\n * nameä¸­ä¸è¦å«æ"js"å"node"ã it\'s assumed that it\'s js, since you\'re writing a package.json file, and you can specify the engine using the "engines" field. (see below.)\n\n * nameå±æ§ä¼æä¸ºæ¨¡åurlãå½ä»¤è¡ä¸­çä¸ä¸ªåæ°æèä¸ä¸ªæä»¶å¤¹åç§°ï¼ä»»ä½éurlå®å¨çå­ç¬¦å¨nameä¸­é½ä¸è½ä½¿ç¨ï¼ä¹ä¸è½ä»¥"_"æ"."å¼å¤´\n\n * nameå±æ§ä¹è®¸ä¼è¢«åå¨require()çåæ°ä¸­ï¼æä»¥æå¥½åä¸ªç®ç­èè¯­ä¹åçå¼ã\n\n * åå»ºä¸ä¸ªæ¨¡ååå¯ä»¥åå°åè¾¹çç½åæ¥æ¥nameæ¯å¦å·²ç»è¢«å ç¨. https://www.npmjs.com/\n   \n   * # åå¸ä¸ä¸ªåçæ¶åï¼éè¦æ£éªæä¸ªååæ¯å¦å­å¨\n     npm search <modulename>\n     \n     \n     1\n     2\n     \n\nnameå±æ§å¯ä»¥æä¸äºåç¼å¦ e.g. @myorg/mypackage.å¨npm-scope(7)çææ¡£ä¸­å¯ä»¥çå°è¯¦ç»è¯´æ\n\n\n# version\n\nversionå¿é¡»å¯ä»¥è¢«npmä¾èµçä¸ä¸ªnode-semveræ¨¡åè§£æãå·ä½è§åè§ä¸é¢çdependenciesæ¨¡å\n\n\n# description\n\nä¸ä¸ªæè¿°ï¼æ¹ä¾¿å«äººäºè§£ä½ çæ¨¡åä½ç¨ï¼æç´¢çæ¶åä¹æç¨ã\n\n\n# keywords\n\nä¸ä¸ªå­ç¬¦ä¸²æ°ç»ï¼æ¹ä¾¿å«äººæç´¢å°æ¬æ¨¡å\n\n\n# homepage\n\né¡¹ç®ä¸»é¡µurl æ³¨æ: è¿ä¸ªé¡¹ç®ä¸»é¡µurlåurlå±æ§ä¸åï¼å¦æä½ å¡«åäºurlå±æ§ï¼npmæ³¨åå·¥å·ä¼è®¤ä¸ºä½ æé¡¹ç®åå¸å°å¶ä»å°æ¹äºï¼è·åæ¨¡åçæ¶åä¸ä¼ä»npmå®æ¹ä»åºè·åï¼èæ¯ä¼éå®åå°urlå±æ§éç½®çå°åã ï¼åææ¡£ä¸­ç¨äº spit(å)è¿ä¸ªåè¯ï¼ä½èè¡¨ç¤ºä»ä¸æ¯å¨å¼ç©ç¬:ï¼\n\n\n# bugs\n\nå¡«åä¸ä¸ªbugæäº¤å°åæèä¸ä¸ªé®ç®±ï¼è¢«ä½ çæ¨¡ååå°çäººå¯ä»¥éè¿è¿éåæ§½ï¼ä¾å¦ï¼\n\n{\n    "url" : "https://github.com/owner/project/issues",\n    "email" : "project@hostname.com"\n}\n\n\n1\n2\n3\n4\n\n\nurlåemailå¯ä»¥ä»»æå¡«æä¸å¡«ï¼å¦æåªå¡«ä¸ä¸ªï¼å¯ä»¥ç´æ¥åæä¸ä¸ªå­ç¬¦ä¸²èä¸æ¯å¯¹è±¡ãå¦æå¡«åäºurlï¼npm bugså½ä»¤ä¼ä½¿ç¨è¿ä¸ªurlã\n\n\n# license\n\nä½ åºè¯¥ä¸ºä½ çæ¨¡åå¶å®ä¸ä¸ªåè®®ï¼è®©ç¨æ·ç¥éä»ä»¬æä½æéæ¥ä½¿ç¨ä½ çæ¨¡åï¼ä»¥åä½¿ç¨è¯¥æ¨¡åæåªäºéå¶ãæç®åçï¼ä¾å¦ä½ ç¨bsd-3-clause æ mitä¹ç±»çåè®®ï¼å¦ä¸ï¼\n\n{ "license" : "mit" }\n\n\n1\n\n\nä½ å¯ä»¥å¨https://spdx.org/licenses/ è¿ä¸ªå°åæ¥éåè®®åè¡¨ ã\n\n\n# åç¨æ·ç¸å³çå±æ§: author, contributors\n\nauthoræ¯ä¸ä¸ªç åï¼ contributorsæ¯ä¸ä¸ªç åæ°ç»ã personæ¯ä¸ä¸ªæä¸äºæè¿°å±æ§çå¯¹è±¡ï¼å¦ä¸ like this:\n\n{\n    "name" : "barney rubble",\n    "email" : "b@rubble.com",\n    "url" : "http://barnyrubble.tumblr.com/"\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¹å¯ä»¥æå¦ä¸æ ¼å¼ç¼©åï¼npmä¼å¸®çè½¬æ¢:\n\n"barney rubble b@rubble.com (http://barnyrubble.tumblr.com/)"\n\n\n1\n\n\nemailåurlå±æ§å®éä¸é½æ¯å¯ä»¥çç¥çãæè¿°ç¨æ·ä¿¡æ¯çè¿æä¸ä¸ªmaintainersï¼ç»´æ¤èï¼å±æ§ã\n\n\n# files\n\nfileså±æ§çå¼æ¯ä¸ä¸ªæ°ç»ï¼åå®¹æ¯æ¨¡åä¸æä»¶åæèæä»¶å¤¹åï¼å¦ææ¯æä»¶å¤¹åï¼åæä»¶å¤¹ä¸ææçæä»¶ä¹ä¼è¢«åå«è¿æ¥ï¼é¤éæä»¶è¢«å¦ä¸äºéç½®æé¤äºï¼ ä½ ä¹å¯ä»¥å¨æ¨¡åæ ¹ç®å½ä¸åå»ºä¸ä¸ª.npmignoreæä»¶ï¼windowsä¸æ æ³ç´æ¥åå»ºä»¥"."å¼å¤´çæä»¶ï¼ä½¿ç¨linuxå½ä»¤è¡å·¥å·åå»ºå¦git bashï¼ï¼åå¨è¿ä¸ªæä»¶éè¾¹çæä»¶å³ä¾¿è¢«åå¨fileså±æ§éè¾¹ä¹ä¼è¢«æé¤å¨å¤ï¼è¿ä¸ªæä»¶çåæ³".gitignore"ç±»ä¼¼ã\n\n\n# main\n\nmainå±æ§æå®äºç¨åºçä¸»å¥å£æä»¶ãæææ¯ï¼å¦æä½ çæ¨¡åè¢«å½åä¸ºfooï¼ç¨æ·å®è£äºè¿ä¸ªæ¨¡åå¹¶éè¿require("foo")æ¥ä½¿ç¨è¿ä¸ªæ¨¡åï¼é£ä¹requireè¿åçåå®¹å°±æ¯mainå±æ§æå®çæä»¶ä¸­ module.exportsæåçå¯¹è±¡ã å®åºè¯¥æåæ¨¡åæ ¹ç®å½ä¸çä¸ä¸ªæä»¶ãå¯¹å¤§å¯¹æ°æ¨¡åèè¨ï¼è¿ä¸ªå±æ§æ´å¤çæ¯è®©æ¨¡åæä¸ä¸ªä¸»å¥å£æä»¶ï¼ç¶èå¾å¤æ¨¡åå¹¶ä¸åè¿ä¸ªå±æ§ã\n\n\n# bin\n\nå¾å¤æ¨¡åæä¸ä¸ªæå¤ä¸ªéè¦éç½®å°pathè·¯å¾ä¸çå¯æ§è¡æ¨¡åï¼npmè®©è¿ä¸ªå·¥ä½åå¾ååç®åï¼å®éä¸npmæ¬èº«ä¹æ¯éè¿binå±æ§å®è£ä¸ºä¸ä¸ªå¯æ§è¡å½ä»¤çï¼ å¦æè¦ç¨npmçè¿ä¸ªåè½ï¼å¨package.jsonéè¾¹éç½®ä¸ä¸ªbinå±æ§ãbinå±æ§æ¯ä¸ä¸ªå·²å½ä»¤åç§°ä¸ºkeyï¼æ¬å°æä»¶åç§°ä¸ºvalueçmapå¦ä¸ï¼\n\n{\n    "bin" : { "myapp" : "./cli.js" }\n}\n\n\n1\n2\n3\n\n\næ¨¡åå®è£çæ¶åï¼è¥æ¯å¨å±å®è£ï¼ånpmä¼ä¸ºbinä¸­éç½®çæä»¶å¨binç®å½ä¸åå»ºä¸ä¸ªè½¯è¿æ¥ï¼å¯¹äºwindowsç³»ç»ï¼é»è®¤ä¼å¨c:\\users\\username\\appdata\\roaming\\npmç®å½ä¸ï¼ï¼è¥æ¯å±é¨å®è£ï¼åä¼å¨é¡¹ç®åç./node_modules/.bin/ç®å½ä¸åå»ºä¸ä¸ªè½¯é¾æ¥ã å æ­¤ï¼æä¸é¢çä¾å­ï¼å½ä½ å®è£myappçæ¶åï¼npmå°±ä¼ä¸ºcli.jså¨/usr/local/bin/myappè·¯å¾åå»ºä¸ä¸ªè½¯é¾æ¥ã å¦æä½ çæ¨¡ååªæä¸ä¸ªå¯æ§è¡æä»¶ï¼å¹¶ä¸å®çå½ä»¤åç§°åæ¨¡ååç§°ä¸æ ·ï¼ä½ å¯ä»¥åªåä¸ä¸ªå­ç¬¦ä¸²æ¥ä»£æ¿ä¸é¢é£ç§éç½®ï¼ä¾å¦ï¼\n\n{ \n    "name": "my-program",\n    "version": "1.2.5", \n    "bin": "./path/to/program"\n}\n\n\n1\n2\n3\n4\n5\n\n\nä½ç¨åå¦ä¸åæ³ç¸å:\n\n{ \n    "name": "my-program", \n    "version": "1.2.5", \n    "bin" : { \n        "my-program" : "./path/to/program" \n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# man\n\nå¶å®ä¸ä¸ªæéè¿æ°ç»å¶å®ä¸äºæä»¶æ¥è®©linuxä¸çmanå½ä»¤æ¥æ¾ææ¡£å°åã å¦æåªæä¸ä¸ªæä»¶è¢«æå®çè¯ï¼å®è£åç´æ¥ä½¿ç¨man+æ¨¡ååç§°ï¼èä¸ç®¡manæå®çæä»¶çå®éåç§°ãä¾å¦:\n\n{\n    "name" : "foo",\n    "version" : "1.2.3", \n    "description" : "a packaged foo fooer for fooing foos", \n    "main" : "foo.js", \n    "man" : "./man/doc.1"\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\néè¿man fooå½ä»¤ä¼å¾å° ./man/doc.1 æä»¶çåå®¹ã å¦æmanæä»¶åç§°ä¸æ¯ä»¥æ¨¡ååç§°å¼å¤´çï¼å®è£çæ¶åä¼ç»å ä¸æ¨¡ååç§°åç¼ãå æ­¤ï¼ä¸é¢è¿æ®µéç½®ï¼\n\n{ \n    "name" : "foo", \n    "version" : "1.2.3", \n    "description" : "a packaged foo fooer for fooing foos", \n    "main" : "foo.js", \n    "man" : [ "./man/foo.1", "./man/bar.1" ]\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¼åå»ºä¸äºæä»¶æ¥ä½ä¸ºman fooåman foo-barå½ä»¤çç»æã manæä»¶å¿é¡»ä»¥æ°å­ç»å°¾ï¼æèå¦æè¢«åç¼©äºï¼ä»¥.gzç»å°¾ãæ°å­è¡¨ç¤ºæä»¶å°è¢«å®è£å°mançåªä¸ªé¨åã\n\n{ \n    "name" : "foo", \n    "version" : "1.2.3",\n    "description" : "a packaged foo fooer for fooing foos", \n    "main" : "foo.js", \n    "man" : [ "./man/foo.1", "./man/foo.2" ]\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¼åå»º man foo å man 2 foo ä¸¤æ¡å½ä»¤ã\n\n\n# directories\n\ncommonjséè¿directoriesæ¥å¶å®ä¸äºæ¹æ³æ¥æè¿°æ¨¡åçç»æï¼ççnpmçpackage.jsonæä»¶https://registry.npmjs.org/npm/latest ï¼å¯ä»¥åç°éè¾¹æè¿ä¸ªå­æ®µçåå®¹ã ç®åè¿ä¸ªéç½®æ²¡æä»»ä½ä½ç¨ï¼å°æ¥å¯è½ä¼æ´åºä¸äºè±æ ·æ¥ã\n\n\n# directories.lib\n\nåè¯ç¨æ·æ¨¡åä¸­libç®å½å¨åªï¼è¿ä¸ªéç½®ç®åæ²¡æä»»ä½ä½ç¨ï¼ä½æ¯å¯¹ä½¿ç¨æ¨¡åçäººæ¥è¯´æ¯ä¸ä¸ªå¾æç¨çä¿¡æ¯ã\n\n\n# directories.bin\n\nå¦æä½ å¨è¿éæå®äºbinç®å½ï¼è¿ä¸ªéç½®ä¸é¢çæä»¶ä¼è¢«å å¥å°binè·¯å¾ä¸ï¼å¦æä½ å·²ç»å¨package.jsonä¸­éç½®äºbinç®å½ï¼é£ä¹è¿éçéç½®å°ä¸èµ·ä»»ä½ä½ç¨ã\n\n\n# directories.man\n\næå®ä¸ä¸ªç®å½ï¼ç®å½éè¾¹é½æ¯manæä»¶ï¼è¿æ¯ä¸ç§éç½®manæä»¶çè¯­æ³ç³ã\n\n\n# directories.doc\n\nå¨è¿ä¸ªç®å½éè¾¹æ¾ä¸äºmarkdownæä»¶ï¼å¯è½æç»æä¸å¤©å®ä»¬ä¼è¢«åå¥½çå±ç°åºæ¥ï¼åºè¯¥æ¯å¨npmçç½ç«ä¸ï¼\n\n\n# directories.example\n\næ¾ä¸äºç¤ºä¾èæ¬ï¼æè®¸æä¸å¤©ä¼æç¨ - -ï¼\n\n\n# repository\n\næå®ä¸ä¸ªä»£ç å­æ¾å°åï¼å¯¹æ³è¦ä¸ºä½ çé¡¹ç®è´¡ç®ä»£ç çäººæå¸®å©ãåè¿æ ·ï¼\n\n"repository" :\n  {\n      "type" : "git",\n      "url" : "https://github.com/npm/npm.git"\n  }\n\n"repository" :\n  { \n      "type" : "svn", \n      "url" : "https://v8.googlecode.com/svn/trunk/"\n  }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nè¥ä½ çæ¨¡åæ¾å¨github, github gist, bitbucket, or gitlabçä»åºéï¼npm installçæ¶åå¯ä»¥ä½¿ç¨ç¼©åæ è®°æ¥å®æï¼\n\n"repository": "npm/npm"\n\n"repository": "gist:11081aaa281"\n\n"repository": "bitbucket:example/repo"\n\n"repository": "gitlab:another/repo"\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# scripts\n\nscriptså±æ§æ¯ä¸ä¸ªå¯¹è±¡ï¼éè¾¹æå®äºé¡¹ç®ççå½å¨æä¸ªåä¸ªç¯èéè¦æ§è¡çå½ä»¤ãkeyæ¯çå½å¨æä¸­çäºä»¶ï¼valueæ¯è¦æ§è¡çå½ä»¤ã å·ä½çåå®¹æ install start stop ç­ï¼è¯¦è§ https://docs.npmjs.com/misc/scripts\n\n\n# config\n\nç¨æ¥è®¾ç½®ä¸äºé¡¹ç®ä¸æä¹ååçé¡¹ç®éç½®ï¼ä¾å¦portç­ã ç¨æ·ç¨çæ¶åå¯ä»¥ä½¿ç¨å¦ä¸ç¨æ³ï¼\n\nhttp.createserver(...).listen(process.env.npm_package_config_port)\n\n\n1\n\n\nå¯ä»¥éè¿npm config set foo:port 80æ¥ä¿®æ¹configãè¯¦è§https://docs.npmjs.com/misc/config\n\n{ \n    "name" : "foo", \n    "config" : { "port" : "8080" }\n}\n\n\n1\n2\n3\n4\n\n\n\n# dependencies\n\ndependencieså±æ§æ¯ä¸ä¸ªå¯¹è±¡ï¼éç½®æ¨¡åä¾èµçæ¨¡ååè¡¨ï¼keyæ¯æ¨¡ååç§°ï¼valueæ¯çæ¬èå´ï¼çæ¬èå´æ¯ä¸ä¸ªå­ç¬¦ï¼å¯ä»¥è¢«ä¸ä¸ªæå¤ä¸ªç©ºæ ¼åå²ã dependenciesä¹å¯ä»¥è¢«æå®ä¸ºä¸ä¸ªgitå°åæèä¸ä¸ªåç¼©åå°åã ä¸è¦ææµè¯å·¥å·ætranspilersåå°dependenciesä¸­ã ä¸é¢æ¯ä¸äºåæ³ï¼è¯¦è§https://docs.npmjs.com/misc/semver\n\n * version ç²¾ç¡®å¹éçæ¬\n * >version å¿é¡»å¤§äºæä¸ªçæ¬\n * >=version å¤§äºç­äº\n * <version å°äº\n * <=versionversion å°äº\n * ~version "çº¦ç­äº"ï¼å·ä½è§åè¯¦è§semverææ¡£\n * ^version "å¼å®¹çæ¬"å·ä½è§åè¯¦è§semverææ¡£\n * 1.2.x ä»ä¸ç¹äºç¹å ççæ¬\n * http://... è§ä¸é¢urlä½ä¸ºdenpendenciesçè¯´æ\n * * ä»»ä½çæ¬\n * "" ç©ºå­ç¬¦ï¼å*ç¸å\n * version1 - version2 ç¸å½äº >=version1 <=version2.\n * range1 || range2 èå´1åèå´2æ»¡è¶³ä»»æä¸ä¸ªé½è¡\n * git... è§ä¸é¢git urlä½ä¸ºdenpendenciesçè¯´æ\n * user/repo see è§ä¸é¢githubä»åºçè¯´æ\n * tag åå¸çä¸ä¸ªç¹æ®çæ ç­¾ï¼è§npm-tagçææ¡£ https://docs.npmjs.com/getting-started/using-tags\n * path/path/path è§ä¸é¢æ¬å°æ¨¡åçè¯´æ ä¸é¢çåæ³é½æ¯å¯ä»¥ç:\n\n{ "dependencies" :\n  { "foo" : "1.0.0 - 2.9999.9999"\n  , "bar" : ">=1.0.2 <2.1.2"\n  , "baz" : ">1.0.2 <=2.3.4"\n  , "boo" : "2.0.1"\n  , "qux" : "<1.0.0 || >=2.3.1 <2.4.5 || >=2.5.2 <3.0.0"\n  , "asd" : "http://asdf.com/asdf.tar.gz"\n  , "til" : "~1.2"\n  , "elf" : "~1.2.3"\n  , "two" : "2.x"\n  , "thr" : "3.3.x"\n  , "lat" : "latest"\n  , "dyl" : "file:../dyl"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# urls as dependencies\n\nå¨çæ¬èå´çå°æ¹å¯ä»¥åä¸ä¸ªurlæåä¸ä¸ªåç¼©åï¼æ¨¡åå®è£çæ¶åä¼æè¿ä¸ªåç¼©åä¸è½½ä¸æ¥å®è£å°æ¨¡åæ¬å°ã\n\n\n# git urls as dependencies\n\ngit urlå¯ä»¥åä¸é¢ä¸æ ·:\n\ngit://github.com/user/project.git#commit-ish\ngit+ssh://user@hostname:project.git#commit-ish\ngit+ssh://user@hostname/project.git#commit-ish\ngit+http://user@hostname/project/blah.git#commit-ish\ngit+https://user@hostname/project/blah.git#commit-ish\n\n\n1\n2\n3\n4\n5\n\n\ncommit-ish å¯ä»¥æ¯ä»»ææ ç­¾ï¼åå¸å¼ï¼æèå¯ä»¥æ£åºçåæ¯ï¼é»è®¤æ¯masteråæ¯ã\n\n\n# github urls\n\næ¯ægithubç username/modulename çåæ³ï¼#åè¾¹å¯ä»¥å åç¼åæåæ¯hashææ ç­¾ï¼\n\n{\n  "name": "foo",\n  "version": "0.0.0",\n  "dependencies": {\n    "express": "visionmedia/express",\n    "mocha": "visionmedia/mocha#4727d357ea"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# local paths\n\nnpm2.0.0çæ¬ä»¥ä¸å¯ä»¥æä¾ä¸ä¸ªæ¬å°è·¯å¾æ¥å®è£ä¸ä¸ªæ¬å°çæ¨¡åï¼éè¿npm install xxx --save æ¥å®è£ï¼æ ¼å¼å¦ä¸ï¼\n\n../foo/bar\n~/foo/bar\n./foo/bar\n/foo/bar\n\n\n1\n2\n3\n4\n\n\npackage.json çæçç¸å¯¹è·¯å¾å¦ä¸:\n\n{\n  "name": "baz",\n  "dependencies": {\n    "bar": "file:../foo/bar"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nè¿ç§å±æ§å¨ç¦»çº¿å¼åæèæµè¯éè¦ç¨npm installçæåµï¼åä¸æ³èªå·±æä¸ä¸ªnpm serverçæ¶åæç¨ï¼ä½æ¯åå¸æ¨¡åå°å¬å±ä»åºæ¶ä¸åºè¯¥ä½¿ç¨è¿ç§å±æ§ã\n\n\n# devdependencies\n\nå¦ææäººæ³è¦ä¸è½½å¹¶ä½¿ç¨ä½ çæ¨¡åï¼ä¹è®¸ä»ä»¬å¹¶ä¸å¸ææéè¦ä¸è½½ä¸äºä½ å¨å¼åè¿ç¨ä¸­ä½¿ç¨çé¢å¤çæµè¯æèææ¡£æ¡æ¶ã å¨è¿ç§æåµä¸ï¼æå¥½çæ¹æ³æ¯æè¿äºä¾èµæ·»å å°devdependencieså±æ§çå¯¹è±¡ä¸­ã è¿äºæ¨¡åä¼å¨npm linkæènpm installçæ¶åè¢«å®è£ï¼ä¹å¯ä»¥åå¶ä»npméç½®ä¸æ ·è¢«ç®¡çï¼è¯¦è§npmçconfigææ¡£ã å¯¹äºä¸äºè·¨å¹³å°çæå»ºä»»å¡ï¼ä¾å¦æcoffeescriptç¼è¯æjavascriptï¼å°±å¯ä»¥éè¿å¨package.jsonçscriptå±æ§éè¾¹éç½®prepublishèæ¬æ¥å®æè¿ä¸ªä»»å¡ï¼ç¶åéè¦ä¾èµçcoffee-scriptæ¨¡åå°±åå¨devdependencieså±æ§ç§ã ä¾å¦:\n\n{ "name": "ethopia-waza",\n  "description": "a delightfully fruity coffee varietal",\n  "version": "1.2.3",\n  "devdependencies": {\n    "coffee-script": "~1.6.3"\n  },\n  "scripts": {\n    "prepublish": "coffee -o lib/ -c src/waza.coffee"\n  },\n  "main": "lib/waza.js"\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nprepublishèæ¬ä¼å¨åå¸ä¹åè¿è¡ï¼å æ­¤ç¨æ·å¨ä½¿ç¨ä¹åå°±ä¸ç¨åèªå·±å»å®æç¼è¯çè¿ç¨äºãå¨å¼åæ¨¡å¼ä¸ï¼è¿è¡npm installä¹ä¼æ§è¡è¿ä¸ªèæ¬ï¼è§npm scriptææ¡£ï¼ï¼å æ­¤å¯ä»¥å¾æ¹ä¾¿çè°è¯ã\n\n\n# peerdependencies\n\nææ¶ååä¸äºæä»¶å¼åï¼æ¯å¦gruntç­å·¥å·çæä»¶ï¼å®ä»¬å¾å¾æ¯å¨gruntçæä¸ªçæ¬çåºç¡ä¸å¼åçï¼èå¨ä»ä»¬çä»£ç ä¸­å¹¶ä¸ä¼åºç°require("grunt")è¿æ ·çä¾èµï¼dependencieséç½®éè¾¹ä¹ä¸ä¼åä¸gruntçä¾èµï¼ä¸ºäºè¯´ææ­¤æ¨¡ååªè½ä½ä¸ºæä»¶è·å¨å®¿ä¸»çæä¸ªçæ¬èå´ä¸ï¼å¯ä»¥éç½®peerdependenciesï¼\n\n{\n  "name": "tea-latte",\n  "version": "1.3.5",\n  "peerdependencies": {\n    "tea": "2.x"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢è¿ä¸ªéç½®ç¡®ä¿ånpm installçæ¶åtea-latteä¼å2.xçæ¬çteaä¸èµ·å®è£ï¼èä¸å®ä»¬ä¸¤ä¸ªçä¾èµå³ç³»æ¯åçº§çï¼ âââ tea-latte@1.3.5 âââ tea@2.2.0 è¿ä¸ªéç½®çç®çæ¯è®©npmç¥éï¼å¦æè¦ä½¿ç¨æ­¤æä»¶æ¨¡åï¼è¯·ç¡®ä¿å®è£äºå¼å®¹çæ¬çå®¿ä¸»æ¨¡åã\n\n\n# bundleddependencies\n\nä¸é¢çåè¯å°ä¸ªdï¼åæbundledependenciesä¹å¯ä»¥ã æå®åå¸çæ¶åä¼è¢«ä¸èµ·æåçæ¨¡åã\n\n\n# optionaldependencies\n\nå¦æä¸ä¸ªä¾èµæ¨¡åå¯ä»¥è¢«ä½¿ç¨ï¼ åæ¶ä½ ä¹å¸æå¨è¯¥æ¨¡åæ¾ä¸å°ææ æ³è·åæ¶npmç»§ç»­è¿è¡ï¼ä½ å¯ä»¥æè¿ä¸ªæ¨¡åä¾èµæ¾å°optionaldependencieséç½®ä¸­ãè¿ä¸ªéç½®çåæ³ådependenciesçåæ³ä¸æ ·ï¼ä¸åçæ¯è¿éè¾¹åçæ¨¡åå®è£å¤±è´¥ä¸ä¼å¯¼è´npm installå¤±è´¥ã å½ç¶ï¼è¿ç§æ¨¡åå°±éè¦ä½ èªå·±å¨ä»£ç ä¸­å¤çæ¨¡åç¡®å®çæåµäºï¼ä¾å¦ï¼\n\ntry {\n  var foo = require(\'foo\')\n  var fooversion = require(\'foo/package.json\').version\n} catch (er) {\n  foo = null\n}\nif ( notgoodfooversion(fooversion) ) {\n  foo = null\n}\n\n// .. then later in your program ..\n\nif (foo) {\n  foo.dofoothings()\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\noptionaldependencies ä¸­çéç½®ä¼è¦çdependenciesä¸­çéç½®ï¼æå¥½åªå¨ä¸ä¸ªå°æ¹åã\n\n\n# engines\n\nä½ å¯ä»¥æå®é¡¹ç®è¿è¡çnodeçæ¬èå´ï¼å¦ä¸ï¼ { "engines" : { "node" : ">=0.10.3 <0.12" } } ådependenciesä¸æ ·ï¼å¦æä½ ä¸æå®çæ¬èå´æèæå®ä¸º*ï¼ä»»ä½çæ¬çnodeé½å¯ä»¥ã ä¹å¯ä»¥æå®ä¸äºnpmçæ¬å¯ä»¥æ­£ç¡®çå®è£ä½ çæ¨¡åï¼ä¾å¦ï¼ { "engines" : { "npm" : "~1.0.20" } } è¦æ³¨æçæ¯ï¼é¤éä½ è®¾ç½®äºengine-strictå±æ§ï¼engineså±æ§æ¯ä»ä¾åèçã\n\n\n# enginestrict\n\næ³¨æï¼è¿ä¸ªå±æ§å·²ç»å¼ç¨ï¼å°å¨npm 3.0.0 çæ¬å¹²æã\n\n\n# os\n\nå¯ä»¥æå®ä½ çæ¨¡ååªè½å¨åªä¸ªæä½ç³»ç»ä¸è·ï¼ "os" : [ "darwin", "linux" ] ä¹å¯ä»¥æå®é»ååèä¸æ¯ç½ååï¼ "os" : [ "!win32" ] æå¡çæä½ç³»ç»æ¯ç±process.platformæ¥å¤æ­çï¼è¿ä¸ªå±æ§åè®¸é»ç½åååæ¶å­å¨ï¼è½ç¶æ²¡å¥å¿è¦è¿æ ·æ...\n\n\n# cpu\n\néå¶æ¨¡ååªè½å¨ææcpuæ¶æä¸è¿è¡ "cpu" : [ "x64", "ia32" ] åæ ·å¯ä»¥è®¾ç½®é»åå: "cpu" : [ "!arm", "!mips" ] cpuæ¶æéè¿ process.arch å¤æ­\n\n\n# preferglobal\n\nå¦ææ¨çè½¯ä»¶åä¸»è¦ç¨äºå®è£å°å¨å±çå½ä»¤è¡åºç¨ç¨åºï¼é£ä¹è¯¥å¼è®¾ç½®ä¸ºtrue ï¼å¦æå®è¢«å®è£å¨æ¬å°ï¼åæä¾ä¸ä¸ªè­¦åãå®éä¸è¯¥éç½®å¹¶æ²¡æé»æ­¢ç¨æ·ææ¨¡åå®è£å°æ¬å°ï¼åªæ¯é²æ­¢è¯¥æ¨¡åè¢«éè¯¯çä½¿ç¨å¼èµ·ä¸äºé®é¢ã\n\n\n# private\n\nå¦æè¿ä¸ªå±æ§è¢«è®¾ç½®ä¸ºtrueï¼npmå°æç»åå¸å®ï¼è¿æ¯ä¸ºäºé²æ­¢ä¸ä¸ªç§ææ¨¡åè¢«æ æé´åå¸åºå»ãå¦æä½ åªæ³è®©æ¨¡åè¢«åå¸å°ä¸ä¸ªç¹å®çnpmä»åºï¼å¦ä¸ä¸ªåé¨çä»åºï¼å¯ä¸å¨ä¸é¢çpublishconfigä¸­éç½®ä»åºåæ°ã\n\n\n# publishconfig\n\nè¿ä¸ªéç½®æ¯ä¼å¨æ¨¡ååå¸æ¶ç¨å°çä¸äºå¼çéåãå¦æä½ ä¸æ³æ¨¡åè¢«é»è®¤è¢«æ è®°ä¸ºææ°çï¼æèé»è®¤åå¸å°å¬å±ä»åºï¼å¯ä»¥å¨è¿ééç½®tagæä»åºå°åã\n\n\n# default values\n\nnpmè®¾ç½®äºä¸äºé»è®¤åæ°ï¼å¦ï¼ "scripts": {"start": "node server.js"} å¦ææ¨¡åæ ¹ç®å½ä¸æä¸ä¸ªserver.jsæä»¶ï¼é£ä¹npm startä¼é»è®¤è¿è¡è¿ä¸ªæä»¶ã "scripts":{"preinstall": "node-gyp rebuild"} å¦ææ¨¡åæ ¹ç®å½ä¸æbinding.gyp, npmå°é»è®¤ç¨node-gypæ¥ç¼è¯preinstallçèæ¬ "contributors": [...] è¥æ¨¡åæ ¹ç®å½ä¸æauthors æä»¶ï¼ånpmä¼æname (url)æ ¼å¼è§£ææ¯ä¸è¡çæ°æ®æ·»å å°contributorsä¸­ï¼å¯ä»¥ç¨#æ·»å è¡æ³¨é\n\n\n# åèææ¡£åè¡¨(https://docs.npmjs.com/)\n\nsemver(7) npm-init(1) npm-version(1) npm-config(1) npm-config(7) npm-help(1) npm-faq(7) npm-install(1) npm-publish(1) npm-rm(1)',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"yamlè¯­è¨æç¨",frontmatter:{title:"yamlè¯­è¨æç¨",date:"2019-12-25T14:27:01.000Z",permalink:"/pages/4e8444e2d534d14f",categories:["ææ¯","ææ¯ææ¡£"],tags:[null],author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/100.%E5%85%B6%E4%BB%96/01.%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/15.yaml%E8%AF%AD%E8%A8%80%E6%95%99%E7%A8%8B.html",relativePath:"100.å¶ä»/01.ææ¯ææ¡£/15.yamlè¯­è¨æç¨.md",key:"v-0e65177a",path:"/pages/4e8444e2d534d14f/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:15},{level:2,title:"åºæ¬è¯­æ³",slug:"åºæ¬è¯­æ³",normalizedTitle:"åºæ¬è¯­æ³",charIndex:326},{level:2,title:"æ°æ®ç±»å",slug:"æ°æ®ç±»å",normalizedTitle:"æ°æ®ç±»å",charIndex:422},{level:2,title:"YAML å¯¹è±¡",slug:"yaml-å¯¹è±¡",normalizedTitle:"yaml å¯¹è±¡",charIndex:576},{level:2,title:"YAML æ°ç»",slug:"yaml-æ°ç»",normalizedTitle:"yaml æ°ç»",charIndex:1086},{level:2,title:"å¤åç»æï¼å¯¹è±¡åæ°ç»ç»åï¼",slug:"å¤åç»æ-å¯¹è±¡åæ°ç»ç»å",normalizedTitle:"å¤åç»æï¼å¯¹è±¡åæ°ç»ç»åï¼",charIndex:1594},{level:2,title:"çº¯é",slug:"çº¯é",normalizedTitle:"çº¯é",charIndex:549},{level:2,title:"è½¬æ¢æ°æ®æ ¼å¼",slug:"è½¬æ¢æ°æ®æ ¼å¼",normalizedTitle:"è½¬æ¢æ°æ®æ ¼å¼",charIndex:3050},{level:2,title:"éç¹å¼ç¨",slug:"éç¹å¼ç¨",normalizedTitle:"éç¹å¼ç¨",charIndex:3157}],excerpt:'<h1 id="yamlè¯­è¨æç¨"><a class="header-anchor" href="#yamlè¯­è¨æç¨">#</a> yamlè¯­è¨æç¨</h1>\n<h2 id="ç®ä»"><a class="header-anchor" href="#ç®ä»">#</a> ç®ä»</h2>\n<p>YAML æ¯ &quot;YAML Ain\'t a Markup Language&quot;ï¼YAML ä¸æ¯ä¸ç§æ è®°è¯­è¨ï¼çéå½ç¼©åãå¨å¼åçè¿ç§è¯­è¨æ¶ï¼YAML çææå¶å®æ¯ï¼&quot;Yet Another Markup Language&quot;ï¼ä»æ¯ä¸ç§æ è®°è¯­è¨ï¼ã</p>\n',headersStr:"ç®ä» åºæ¬è¯­æ³ æ°æ®ç±»å YAML å¯¹è±¡ YAML æ°ç» å¤åç»æï¼å¯¹è±¡åæ°ç»ç»åï¼ çº¯é è½¬æ¢æ°æ®æ ¼å¼ éç¹å¼ç¨",content:"# yamlè¯­è¨æç¨\n\n\n# ç®ä»\n\nYAML æ¯ \"YAML Ain't a Markup Language\"ï¼YAML ä¸æ¯ä¸ç§æ è®°è¯­è¨ï¼çéå½ç¼©åãå¨å¼åçè¿ç§è¯­è¨æ¶ï¼YAML çææå¶å®æ¯ï¼\"Yet Another Markup Language\"ï¼ä»æ¯ä¸ç§æ è®°è¯­è¨ï¼ã\n\nYAML çè¯­æ³åå¶ä»é«çº§è¯­è¨ç±»ä¼¼ï¼å¹¶ä¸å¯ä»¥ç®åè¡¨è¾¾æ¸åãæ£åè¡¨ï¼æ éç­æ°æ®å½¢æãå®ä½¿ç¨ç©ºç½ç¬¦å·ç¼©è¿åå¤§éä¾èµå¤è§çç¹è²ï¼ç¹å«éåç¨æ¥è¡¨è¾¾æç¼è¾æ°æ®ç»æãåç§éç½®æä»¶ãå¾å°è°è¯åå®¹ãæä»¶å¤§çº²ï¼ä¾å¦ï¼è®¸å¤çµå­é®ä»¶æ é¢æ ¼å¼åYAMLéå¸¸æ¥è¿ï¼ã\n\nYAML çéç½®æä»¶åç¼ä¸º .ymlï¼å¦ï¼runoob.yml ã\n\n> yamlå¸¸ç¨æ¥ç¨ä½éç½®æä»¶ï¼åjsonç±»ä¼¼\n\n\n# åºæ¬è¯­æ³\n\n * å¤§å°åææ\n\n * ä½¿ç¨ç¼©è¿è¡¨ç¤ºå±çº§å³ç³»\n\n * ç¼©è¿ä¸åè®¸ä½¿ç¨tabï¼åªåè®¸ç©ºæ ¼\n\n * ç¼©è¿çç©ºæ ¼æ°ä¸éè¦ï¼åªè¦ç¸åå±çº§çåç´ å·¦å¯¹é½å³å¯\n\n * '#'è¡¨ç¤ºæ³¨é\n\n\n# æ°æ®ç±»å\n\nYAML æ¯æä»¥ä¸å ç§æ°æ®ç±»åï¼\n\n * å¯¹è±¡ï¼é®å¼å¯¹çéåï¼åç§°ä¸ºæ å°ï¼mappingï¼/ åå¸ï¼hashesï¼ / å­å¸ï¼dictionaryï¼\n * æ°ç»ï¼ä¸ç»ææ¬¡åºæåçå¼ï¼åç§°ä¸ºåºåï¼sequenceï¼ / åè¡¨ï¼listï¼\n * çº¯éï¼scalarsï¼ï¼åä¸ªçãä¸å¯ååçå¼\n\n\n# YAML å¯¹è±¡\n\nå¯¹è±¡çå ç§è¡¨ç¤ºå½¢å¼ï¼\n\n1ãå¯¹è±¡é®å¼å¯¹ä½¿ç¨åå·ç»æè¡¨ç¤º key: valueï¼åå·åé¢è¦å ä¸ä¸ªç©ºæ ¼ã\n\nkey: value\n\n\n1\n\n\n2ãä¹å¯ä»¥ä½¿ç¨ key:{key1: value1, key2: value2, ...}ã\n\nkey:{child-key1:value1,child-key2:value2}\n\n\n1\n\n\n3ãè¿å¯ä»¥ä½¿ç¨ç¼©è¿è¡¨ç¤ºå±çº§å³ç³»ï¼\n\nkey: \n    child-key1: value1\n    child-key2: value2\n\n\n1\n2\n3\n\n\nå2ï¼åªæ¯è¡¨ç¤ºå½¢å¼ä¸åã\n\n4ãè¾ä¸ºå¤æçå¯¹è±¡æ ¼å¼ï¼å¯ä»¥ä½¿ç¨é®å·å ä¸ä¸ªç©ºæ ¼ä»£è¡¨ä¸ä¸ªå¤æç keyï¼éåä¸ä¸ªåå·å ä¸ä¸ªç©ºæ ¼ä»£è¡¨ä¸ä¸ª valueï¼\n\n?  \n    - complexkey1\n    - complexkey2\n:\n    - complexvalue1\n    - complexvalue2\n\n\n1\n2\n3\n4\n5\n6\n\n\nææå³å¯¹è±¡çå±æ§æ¯ä¸ä¸ªæ°ç» [complexkey1,complexkey2]ï¼å¯¹åºçå¼ä¹æ¯ä¸ä¸ªæ°ç» [complexvalue1,complexvalue2]\n\n\n# YAML æ°ç»\n\nä»¥ - å¼å¤´çè¡è¡¨ç¤ºææä¸ä¸ªæ°ç»ï¼\n\n- A\n- B\n- C\n\n\n1\n2\n3\n\n\nYAML æ¯æå¤ç»´æ°ç»ï¼å¯ä»¥ä½¿ç¨è¡åè¡¨ç¤ºï¼\n\nkey: [value1, value2, ...]\n\n\n1\n\n\næ°æ®ç»æçå­æåæ¯ä¸ä¸ªæ°ç»ï¼åå¯ä»¥å¨è¯¥é¡¹ä¸é¢ç¼©è¿ä¸ä¸ªç©ºæ ¼ã\n\n-\n - A\n - B\n - C\n\n\n1\n2\n3\n4\n\n\nä¸ä¸ªç¸å¯¹å¤æçä¾å­ï¼\n\ncompanies:\n    -\n        id: 1\n        name: company1\n        price: 200W\n    -\n        id: 2\n        name: company2\n        price: 500W\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\næææ¯ companies å±æ§æ¯ä¸ä¸ªæ°ç»ï¼æ¯ä¸ä¸ªæ°ç»åç´ åæ¯ç± idãnameãprice ä¸ä¸ªå±æ§ææã\n\næ°ç»ä¹å¯ä»¥ä½¿ç¨æµå¼(flow)çæ¹å¼è¡¨ç¤ºï¼\n\ncompanies: [{id: 1,name: company1,price: 200W},{id: 2,name: company2,price: 500W}]\n\n\n1\n\n\n\n# å¤åç»æï¼å¯¹è±¡åæ°ç»ç»åï¼\n\næ°ç»åå¯¹è±¡å¯ä»¥ææå¤åç»æï¼ä¾ï¼\n\nlanguages:\n  - Ruby\n  - Perl\n  - Python \nwebsites:\n  YAML: yaml.org \n  Ruby: ruby-lang.org \n  Python: python.org \n  Perl: use.perl.org\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nè½¬æ¢ä¸º js ä¸ºï¼\n\n{ \n  languages: [ 'Ruby', 'Perl', 'Python'],\n  websites: {\n    YAML: 'yaml.org',\n    Ruby: 'ruby-lang.org',\n    Python: 'python.org',\n    Perl: 'use.perl.org' \n  } \n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# çº¯é\n\nçº¯éæ¯æåºæ¬çï¼ä¸å¯ååçå¼ï¼åæ¬ï¼\n\n * å­ç¬¦ä¸²\n * å¸å°å¼\n * æ´æ°\n * æµ®ç¹æ°\n * Null\n * æ¶é´\n * æ¥æ\n\nä½¿ç¨ä¸ä¸ªä¾å­æ¥å¿«éäºè§£çº¯éçåºæ¬ä½¿ç¨ï¼\n\nboolean: # å¸å°å¼\n    - TRUE  #true,Trueé½å¯ä»¥\n    - FALSE  #falseï¼Falseé½å¯ä»¥\nfloat: # æµ®ç¹æ°\n    - 3.14\n    - 6.8523015e+5  #å¯ä»¥ä½¿ç¨ç§å­¦è®¡æ°æ³\nint: # æ´æ°\n    - 123\n    - 0b1010_0111_0100_1010_1110    #äºè¿å¶è¡¨ç¤º\nnull: # Null\n    nodeName: 'node'\n    parent: ~  #ä½¿ç¨~è¡¨ç¤ºnull\nstring: # å­ç¬¦ä¸²\n    - åå # å­ç¬¦ä¸²é»è®¤ä¸ä½¿ç¨å¼å·è¡¨ç¤º\n    - 'Hello world'  #å¯ä»¥ä½¿ç¨åå¼å·æèåå¼å·åè£¹ç¹æ®å­ç¬¦\n    - newline\n      newline2    #å­ç¬¦ä¸²å¯ä»¥ææå¤è¡ï¼æ¯ä¸è¡ä¼è¢«è½¬åæä¸ä¸ªç©ºæ ¼\ndate:\n    - 2018-02-17    #æ¥æå¿é¡»ä½¿ç¨ISO 8601æ ¼å¼ï¼å³yyyy-MM-dd\ndatetime: \n    -  2018-02-17T15:02:31+08:00    #æ¶é´ä½¿ç¨ISO 8601æ ¼å¼ï¼æ¶é´åæ¥æä¹é´ä½¿ç¨Tè¿æ¥ï¼æåä½¿ç¨+ä»£è¡¨æ¶åº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nå¤è¡å­ç¬¦ä¸²å¯ä»¥ä½¿ç¨|ä¿çæ¢è¡ç¬¦ï¼ä¹å¯ä»¥ä½¿ç¨>æå æ¢è¡ã\n\nthis: |\n  Foo\n  Bar\nthat: >\n  Foo\n  Bar\n\n\n1\n2\n3\n4\n5\n6\n\n\nè½¬ä¸ºjsä»£ç å¦ä¸ã\n\n{ this: 'Foo\\nBar\\n', that: 'Foo Bar\\n' }\n\n\n1\n\n\n+è¡¨ç¤ºä¿çæå­åæ«å°¾çæ¢è¡ï¼-è¡¨ç¤ºå é¤å­ç¬¦ä¸²æ«å°¾çæ¢è¡ã\n\ns1: |\n  Foo\n \ns2: |+\n  Foo\n \n \ns3: |-\n  Foo\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nè½¬ä¸ºjsonä»£ç å¦ä¸\n\n{ s1: 'Foo\\n', s2: 'Foo\\n\\n\\n', s3: 'Foo' }\n\n\n1\n\n\nå­ç¬¦ä¸²ä¹ä¸­å¯ä»¥æå¥ HTML æ è®°ã\n\nmessage: |\n  <p style=\"color: red\">\n    æ®µè½\n  </p>\n\n\n1\n2\n3\n4\n\n\n\n# è½¬æ¢æ°æ®æ ¼å¼\n\nåè®¸ä½¿ç¨ä¸¤ä¸ªæå¹å·ï¼å¼ºå¶è½¬æ¢æ°æ®ç±»åã\n\ne: !!str 123\nf: !!str true\n\n\n1\n2\n\n\nè½¬æ¢jsç»æåï¼\n\n{ e: '123', f: 'true' }\n\n\n1\n\n\n\n# éç¹å¼ç¨\n\n& éç¹å< span class=\"marked\">* å«åï¼å¯ä»¥ç¨æ¥å¼ç¨:\n\ndefaults: &defaults # æ·»å éç¹\n  adapter:  postgres\n  host:     localhost\n\ndevelopment:\n  database: myapp_development\n  <<: *defaults # <<è¡¨ç¤ºåå¹¶ï¼*å¼ç¨éç¹\n\ntest:\n  database: myapp_test\n  <<: *defaults # <<è¡¨ç¤ºåå¹¶ï¼*å¼ç¨éç¹\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nç¸å½äº:\n\ndefaults:\n  adapter:  postgres\n  host:     localhost\n\ndevelopment:\n  database: myapp_development\n  adapter:  postgres\n  host:     localhost\n\ntest:\n  database: myapp_test\n  adapter:  postgres\n  host:     localhost\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n& ç¨æ¥å»ºç«éç¹ï¼defaultsï¼ï¼<< è¡¨ç¤ºåå¹¶å°å½åæ°æ®ï¼***** ç¨æ¥å¼ç¨éç¹ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­:\n\n- &showell Steve \n- Clark \n- Brian \n- Oren \n- *showell \n\n\n1\n2\n3\n4\n5\n\n\nè½¬ä¸ºjsä»£ç å¦ä¸:\n\n[ 'Steve', 'Clark', 'Brian', 'Oren', 'Steve' ]\n\n\n1\n\n\n> åèï¼\n> \n>  * yamlå®ç½ï¼https://yaml.org/\n>  * yamlä¸jsçè½¬æ¢demoï¼http://nodeca.github.io/js-yaml/\n>  * èé¸æç¨ï¼https://www.ruanyifeng.com/blog/2016/07/yaml.html",normalizedContent:"# yamlè¯­è¨æç¨\n\n\n# ç®ä»\n\nyaml æ¯ \"yaml ain't a markup language\"ï¼yaml ä¸æ¯ä¸ç§æ è®°è¯­è¨ï¼çéå½ç¼©åãå¨å¼åçè¿ç§è¯­è¨æ¶ï¼yaml çææå¶å®æ¯ï¼\"yet another markup language\"ï¼ä»æ¯ä¸ç§æ è®°è¯­è¨ï¼ã\n\nyaml çè¯­æ³åå¶ä»é«çº§è¯­è¨ç±»ä¼¼ï¼å¹¶ä¸å¯ä»¥ç®åè¡¨è¾¾æ¸åãæ£åè¡¨ï¼æ éç­æ°æ®å½¢æãå®ä½¿ç¨ç©ºç½ç¬¦å·ç¼©è¿åå¤§éä¾èµå¤è§çç¹è²ï¼ç¹å«éåç¨æ¥è¡¨è¾¾æç¼è¾æ°æ®ç»æãåç§éç½®æä»¶ãå¾å°è°è¯åå®¹ãæä»¶å¤§çº²ï¼ä¾å¦ï¼è®¸å¤çµå­é®ä»¶æ é¢æ ¼å¼åyamléå¸¸æ¥è¿ï¼ã\n\nyaml çéç½®æä»¶åç¼ä¸º .ymlï¼å¦ï¼runoob.yml ã\n\n> yamlå¸¸ç¨æ¥ç¨ä½éç½®æä»¶ï¼åjsonç±»ä¼¼\n\n\n# åºæ¬è¯­æ³\n\n * å¤§å°åææ\n\n * ä½¿ç¨ç¼©è¿è¡¨ç¤ºå±çº§å³ç³»\n\n * ç¼©è¿ä¸åè®¸ä½¿ç¨tabï¼åªåè®¸ç©ºæ ¼\n\n * ç¼©è¿çç©ºæ ¼æ°ä¸éè¦ï¼åªè¦ç¸åå±çº§çåç´ å·¦å¯¹é½å³å¯\n\n * '#'è¡¨ç¤ºæ³¨é\n\n\n# æ°æ®ç±»å\n\nyaml æ¯æä»¥ä¸å ç§æ°æ®ç±»åï¼\n\n * å¯¹è±¡ï¼é®å¼å¯¹çéåï¼åç§°ä¸ºæ å°ï¼mappingï¼/ åå¸ï¼hashesï¼ / å­å¸ï¼dictionaryï¼\n * æ°ç»ï¼ä¸ç»ææ¬¡åºæåçå¼ï¼åç§°ä¸ºåºåï¼sequenceï¼ / åè¡¨ï¼listï¼\n * çº¯éï¼scalarsï¼ï¼åä¸ªçãä¸å¯ååçå¼\n\n\n# yaml å¯¹è±¡\n\nå¯¹è±¡çå ç§è¡¨ç¤ºå½¢å¼ï¼\n\n1ãå¯¹è±¡é®å¼å¯¹ä½¿ç¨åå·ç»æè¡¨ç¤º key: valueï¼åå·åé¢è¦å ä¸ä¸ªç©ºæ ¼ã\n\nkey: value\n\n\n1\n\n\n2ãä¹å¯ä»¥ä½¿ç¨ key:{key1: value1, key2: value2, ...}ã\n\nkey:{child-key1:value1,child-key2:value2}\n\n\n1\n\n\n3ãè¿å¯ä»¥ä½¿ç¨ç¼©è¿è¡¨ç¤ºå±çº§å³ç³»ï¼\n\nkey: \n    child-key1: value1\n    child-key2: value2\n\n\n1\n2\n3\n\n\nå2ï¼åªæ¯è¡¨ç¤ºå½¢å¼ä¸åã\n\n4ãè¾ä¸ºå¤æçå¯¹è±¡æ ¼å¼ï¼å¯ä»¥ä½¿ç¨é®å·å ä¸ä¸ªç©ºæ ¼ä»£è¡¨ä¸ä¸ªå¤æç keyï¼éåä¸ä¸ªåå·å ä¸ä¸ªç©ºæ ¼ä»£è¡¨ä¸ä¸ª valueï¼\n\n?  \n    - complexkey1\n    - complexkey2\n:\n    - complexvalue1\n    - complexvalue2\n\n\n1\n2\n3\n4\n5\n6\n\n\nææå³å¯¹è±¡çå±æ§æ¯ä¸ä¸ªæ°ç» [complexkey1,complexkey2]ï¼å¯¹åºçå¼ä¹æ¯ä¸ä¸ªæ°ç» [complexvalue1,complexvalue2]\n\n\n# yaml æ°ç»\n\nä»¥ - å¼å¤´çè¡è¡¨ç¤ºææä¸ä¸ªæ°ç»ï¼\n\n- a\n- b\n- c\n\n\n1\n2\n3\n\n\nyaml æ¯æå¤ç»´æ°ç»ï¼å¯ä»¥ä½¿ç¨è¡åè¡¨ç¤ºï¼\n\nkey: [value1, value2, ...]\n\n\n1\n\n\næ°æ®ç»æçå­æåæ¯ä¸ä¸ªæ°ç»ï¼åå¯ä»¥å¨è¯¥é¡¹ä¸é¢ç¼©è¿ä¸ä¸ªç©ºæ ¼ã\n\n-\n - a\n - b\n - c\n\n\n1\n2\n3\n4\n\n\nä¸ä¸ªç¸å¯¹å¤æçä¾å­ï¼\n\ncompanies:\n    -\n        id: 1\n        name: company1\n        price: 200w\n    -\n        id: 2\n        name: company2\n        price: 500w\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\næææ¯ companies å±æ§æ¯ä¸ä¸ªæ°ç»ï¼æ¯ä¸ä¸ªæ°ç»åç´ åæ¯ç± idãnameãprice ä¸ä¸ªå±æ§ææã\n\næ°ç»ä¹å¯ä»¥ä½¿ç¨æµå¼(flow)çæ¹å¼è¡¨ç¤ºï¼\n\ncompanies: [{id: 1,name: company1,price: 200w},{id: 2,name: company2,price: 500w}]\n\n\n1\n\n\n\n# å¤åç»æï¼å¯¹è±¡åæ°ç»ç»åï¼\n\næ°ç»åå¯¹è±¡å¯ä»¥ææå¤åç»æï¼ä¾ï¼\n\nlanguages:\n  - ruby\n  - perl\n  - python \nwebsites:\n  yaml: yaml.org \n  ruby: ruby-lang.org \n  python: python.org \n  perl: use.perl.org\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nè½¬æ¢ä¸º js ä¸ºï¼\n\n{ \n  languages: [ 'ruby', 'perl', 'python'],\n  websites: {\n    yaml: 'yaml.org',\n    ruby: 'ruby-lang.org',\n    python: 'python.org',\n    perl: 'use.perl.org' \n  } \n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# çº¯é\n\nçº¯éæ¯æåºæ¬çï¼ä¸å¯ååçå¼ï¼åæ¬ï¼\n\n * å­ç¬¦ä¸²\n * å¸å°å¼\n * æ´æ°\n * æµ®ç¹æ°\n * null\n * æ¶é´\n * æ¥æ\n\nä½¿ç¨ä¸ä¸ªä¾å­æ¥å¿«éäºè§£çº¯éçåºæ¬ä½¿ç¨ï¼\n\nboolean: # å¸å°å¼\n    - true  #true,trueé½å¯ä»¥\n    - false  #falseï¼falseé½å¯ä»¥\nfloat: # æµ®ç¹æ°\n    - 3.14\n    - 6.8523015e+5  #å¯ä»¥ä½¿ç¨ç§å­¦è®¡æ°æ³\nint: # æ´æ°\n    - 123\n    - 0b1010_0111_0100_1010_1110    #äºè¿å¶è¡¨ç¤º\nnull: # null\n    nodename: 'node'\n    parent: ~  #ä½¿ç¨~è¡¨ç¤ºnull\nstring: # å­ç¬¦ä¸²\n    - åå # å­ç¬¦ä¸²é»è®¤ä¸ä½¿ç¨å¼å·è¡¨ç¤º\n    - 'hello world'  #å¯ä»¥ä½¿ç¨åå¼å·æèåå¼å·åè£¹ç¹æ®å­ç¬¦\n    - newline\n      newline2    #å­ç¬¦ä¸²å¯ä»¥ææå¤è¡ï¼æ¯ä¸è¡ä¼è¢«è½¬åæä¸ä¸ªç©ºæ ¼\ndate:\n    - 2018-02-17    #æ¥æå¿é¡»ä½¿ç¨iso 8601æ ¼å¼ï¼å³yyyy-mm-dd\ndatetime: \n    -  2018-02-17t15:02:31+08:00    #æ¶é´ä½¿ç¨iso 8601æ ¼å¼ï¼æ¶é´åæ¥æä¹é´ä½¿ç¨tè¿æ¥ï¼æåä½¿ç¨+ä»£è¡¨æ¶åº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nå¤è¡å­ç¬¦ä¸²å¯ä»¥ä½¿ç¨|ä¿çæ¢è¡ç¬¦ï¼ä¹å¯ä»¥ä½¿ç¨>æå æ¢è¡ã\n\nthis: |\n  foo\n  bar\nthat: >\n  foo\n  bar\n\n\n1\n2\n3\n4\n5\n6\n\n\nè½¬ä¸ºjsä»£ç å¦ä¸ã\n\n{ this: 'foo\\nbar\\n', that: 'foo bar\\n' }\n\n\n1\n\n\n+è¡¨ç¤ºä¿çæå­åæ«å°¾çæ¢è¡ï¼-è¡¨ç¤ºå é¤å­ç¬¦ä¸²æ«å°¾çæ¢è¡ã\n\ns1: |\n  foo\n \ns2: |+\n  foo\n \n \ns3: |-\n  foo\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nè½¬ä¸ºjsonä»£ç å¦ä¸\n\n{ s1: 'foo\\n', s2: 'foo\\n\\n\\n', s3: 'foo' }\n\n\n1\n\n\nå­ç¬¦ä¸²ä¹ä¸­å¯ä»¥æå¥ html æ è®°ã\n\nmessage: |\n  <p style=\"color: red\">\n    æ®µè½\n  </p>\n\n\n1\n2\n3\n4\n\n\n\n# è½¬æ¢æ°æ®æ ¼å¼\n\nåè®¸ä½¿ç¨ä¸¤ä¸ªæå¹å·ï¼å¼ºå¶è½¬æ¢æ°æ®ç±»åã\n\ne: !!str 123\nf: !!str true\n\n\n1\n2\n\n\nè½¬æ¢jsç»æåï¼\n\n{ e: '123', f: 'true' }\n\n\n1\n\n\n\n# éç¹å¼ç¨\n\n& éç¹å< span class=\"marked\">* å«åï¼å¯ä»¥ç¨æ¥å¼ç¨:\n\ndefaults: &defaults # æ·»å éç¹\n  adapter:  postgres\n  host:     localhost\n\ndevelopment:\n  database: myapp_development\n  <<: *defaults # <<è¡¨ç¤ºåå¹¶ï¼*å¼ç¨éç¹\n\ntest:\n  database: myapp_test\n  <<: *defaults # <<è¡¨ç¤ºåå¹¶ï¼*å¼ç¨éç¹\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nç¸å½äº:\n\ndefaults:\n  adapter:  postgres\n  host:     localhost\n\ndevelopment:\n  database: myapp_development\n  adapter:  postgres\n  host:     localhost\n\ntest:\n  database: myapp_test\n  adapter:  postgres\n  host:     localhost\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n& ç¨æ¥å»ºç«éç¹ï¼defaultsï¼ï¼<< è¡¨ç¤ºåå¹¶å°å½åæ°æ®ï¼***** ç¨æ¥å¼ç¨éç¹ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­:\n\n- &showell steve \n- clark \n- brian \n- oren \n- *showell \n\n\n1\n2\n3\n4\n5\n\n\nè½¬ä¸ºjsä»£ç å¦ä¸:\n\n[ 'steve', 'clark', 'brian', 'oren', 'steve' ]\n\n\n1\n\n\n> åèï¼\n> \n>  * yamlå®ç½ï¼https://yaml.org/\n>  * yamlä¸jsçè½¬æ¢demoï¼http://nodeca.github.io/js-yaml/\n>  * èé¸æç¨ï¼https://www.ruanyifeng.com/blog/2016/07/yaml.html",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"GitHubé«çº§æç´¢æå·§",frontmatter:{title:"GitHubé«çº§æç´¢æå·§",date:"2019-12-25T14:27:01.000Z",permalink:"/pages/4c778760be26d8b3",categories:["ææ¯","GitHubæå·§"],tags:[null],author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/100.%E5%85%B6%E4%BB%96/02.GitHub%E6%8A%80%E5%B7%A7/01.GitHub%E9%AB%98%E7%BA%A7%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7.html",relativePath:"100.å¶ä»/02.GitHubæå·§/01.GitHubé«çº§æç´¢æå·§.md",key:"v-936eed32",path:"/pages/4c778760be26d8b3/",excerpt:'<h1 id="githubé«çº§æç´¢æå·§"><a class="header-anchor" href="#githubé«çº§æç´¢æå·§">#</a> GitHubé«çº§æç´¢æå·§</h1>\n<p><code>in:name &lt;å³é®å­&gt;</code>\nä»åºåç§°å¸¦å³é®å­æ¥è¯¢</p>\n<p><code>in:description &lt;å³é®å­&gt;</code>\nä»åºæè¿°å¸¦å³é®å­æ¥è¯¢</p>\n<p><code>in:readme &lt;å³é®å­&gt;</code>\nREADMEæä»¶å¸¦å³é®å­æ¥è¯¢</p>\n',headersStr:null,content:'# GitHubé«çº§æç´¢æå·§\n\nin:name <å³é®å­> ä»åºåç§°å¸¦å³é®å­æ¥è¯¢\n\nin:description <å³é®å­> ä»åºæè¿°å¸¦å³é®å­æ¥è¯¢\n\nin:readme <å³é®å­> READMEæä»¶å¸¦å³é®å­æ¥è¯¢\n\nstars(fork): >(=) <æ°å­> <å³é®å­> staræforkæ°å¤§äº(æç­äº)æå®æ°å­çå¸¦å³é®å­æ¥è¯¢\n\nstars(fork): 10..20 <å³é®è¯> staræforkæ°å¨10å°20ä¹é´çå¸¦å³é®å­æ¥è¯¢\n\nsize:>=5000 <å³é®è¯> éå®ä»åºå¤§äºç­äº5000Kçå¸¦å³é®å­æ¥è¯¢\n\npushed(created):>2019-11-15 <å³é®å­> æ´æ° æ åå»º æ¥æå¨2019å¹´11æ16æ¥ä¹åçå¸¦å³é®å­æ¥è¯¢\n\nlicense:apache-2.0 <å³é®å­> LICENSEä¸ºapache-2.0çå¸¦å³é®å­æ¥è¯¢\n\nlanguage:java <å³é®è¯> ä»åºè¯­è¨ä¸ºJavaçå¸¦å³é®å­æ¥è¯¢\n\nuser:<ç¨æ·å> æ¥è¯¢æä¸ªç¨æ·çé¡¹ç®\n\norg:<ç»ç»å> æ¥è¯¢æä¸ªç»ç»çé¡¹ç®\n\n*ä»¥ä¸æ¥è¯¢æ¡ä»¶å¯ç»åä½¿ç¨ï¼ç©ºæ ¼éå¼\n\n# ç¤ºä¾1ï¼æç´¢ä»åºååå«javascriptï¼å¹¶ä¸starsæ°å¤§äº1000çé¡¹ç®\nin:name javascript stars:>1000\n\n# ç¤ºä¾2ï¼æç´¢æè¿°ä¸­åå«"å°ç¨åº"ï¼å¹¶ä¸forkå¤§äº100ï¼å¹¶ä¸æè¿æ´æ°æ¶é´å¨2019-11-15ä¹åçï¼å¹¶ä¸ä½¿ç¨å¼åè¯­è¨ä¸ºvueçé¡¹ç®\nin:description å°ç¨åº fork:>100 pushed:>2019-11-15 language:vue\n\n\n1\n2\n3\n4\n5\n\n\n*æä½¿ç¨é«çº§æç´¢é¡µæç´¢ï¼\n\nhttps://github.com/search/advanced',normalizedContent:'# githubé«çº§æç´¢æå·§\n\nin:name <å³é®å­> ä»åºåç§°å¸¦å³é®å­æ¥è¯¢\n\nin:description <å³é®å­> ä»åºæè¿°å¸¦å³é®å­æ¥è¯¢\n\nin:readme <å³é®å­> readmeæä»¶å¸¦å³é®å­æ¥è¯¢\n\nstars(fork): >(=) <æ°å­> <å³é®å­> staræforkæ°å¤§äº(æç­äº)æå®æ°å­çå¸¦å³é®å­æ¥è¯¢\n\nstars(fork): 10..20 <å³é®è¯> staræforkæ°å¨10å°20ä¹é´çå¸¦å³é®å­æ¥è¯¢\n\nsize:>=5000 <å³é®è¯> éå®ä»åºå¤§äºç­äº5000kçå¸¦å³é®å­æ¥è¯¢\n\npushed(created):>2019-11-15 <å³é®å­> æ´æ° æ åå»º æ¥æå¨2019å¹´11æ16æ¥ä¹åçå¸¦å³é®å­æ¥è¯¢\n\nlicense:apache-2.0 <å³é®å­> licenseä¸ºapache-2.0çå¸¦å³é®å­æ¥è¯¢\n\nlanguage:java <å³é®è¯> ä»åºè¯­è¨ä¸ºjavaçå¸¦å³é®å­æ¥è¯¢\n\nuser:<ç¨æ·å> æ¥è¯¢æä¸ªç¨æ·çé¡¹ç®\n\norg:<ç»ç»å> æ¥è¯¢æä¸ªç»ç»çé¡¹ç®\n\n*ä»¥ä¸æ¥è¯¢æ¡ä»¶å¯ç»åä½¿ç¨ï¼ç©ºæ ¼éå¼\n\n# ç¤ºä¾1ï¼æç´¢ä»åºååå«javascriptï¼å¹¶ä¸starsæ°å¤§äº1000çé¡¹ç®\nin:name javascript stars:>1000\n\n# ç¤ºä¾2ï¼æç´¢æè¿°ä¸­åå«"å°ç¨åº"ï¼å¹¶ä¸forkå¤§äº100ï¼å¹¶ä¸æè¿æ´æ°æ¶é´å¨2019-11-15ä¹åçï¼å¹¶ä¸ä½¿ç¨å¼åè¯­è¨ä¸ºvueçé¡¹ç®\nin:description å°ç¨åº fork:>100 pushed:>2019-11-15 language:vue\n\n\n1\n2\n3\n4\n5\n\n\n*æä½¿ç¨é«çº§æç´¢é¡µæç´¢ï¼\n\nhttps://github.com/search/advanced',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"GitHub Actions å®ç°èªå¨é¨ç½²éæåå®¢",frontmatter:{title:"GitHub Actions å®ç°èªå¨é¨ç½²éæåå®¢",date:"2019-12-27T11:44:41.000Z",permalink:"/pages/6b9d359ec5aa5019",categories:["ææ¯","GitHubæå·§"],tags:[null],author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/100.%E5%85%B6%E4%BB%96/02.GitHub%E6%8A%80%E5%B7%A7/02.GitHub%20Actions%20%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2.html",relativePath:"100.å¶ä»/02.GitHubæå·§/02.GitHub Actions å®ç°èªå¨é¨ç½²éæåå®¢.md",key:"v-0944f7ee",path:"/pages/6b9d359ec5aa5019/",headers:[{level:2,title:"åè¨",slug:"åè¨",normalizedTitle:"åè¨",charIndex:32},{level:2,title:"å®ç°",slug:"å®ç°",normalizedTitle:"å®ç°",charIndex:17},{level:2,title:"ç¸å³æç« ",slug:"ç¸å³æç« ",normalizedTitle:"ç¸å³æç« ",charIndex:3449}],excerpt:'<h1 id="github-actions-å®ç°èªå¨é¨ç½²éæåå®¢"><a class="header-anchor" href="#github-actions-å®ç°èªå¨é¨ç½²éæåå®¢">#</a> GitHub Actions å®ç°èªå¨é¨ç½²éæåå®¢</h1>\n<h2 id="åè¨"><a class="header-anchor" href="#åè¨">#</a> åè¨</h2>\n<p>æä½¿ç¨vuepressæ­å»ºäºä¸ä¸ªéæåå®¢ï¼æå¨äºGithub pageså<a href="https://dev.tencent.com/" target="_blank" rel="noopener noreferrer">Coding pages<OutboundLink/></a>ä¸é¢ã</p>\n<p>coding pageså¨å½åçè®¿é®éåº¦æ¯github pagesè¦å¿«å¾å¤ï¼èä¸è¿å¯ä»¥è¢«ç¾åº¦æ¶å½ã</p>\n',headersStr:"åè¨ å®ç° ç¸å³æç« ",content:'# GitHub Actions å®ç°èªå¨é¨ç½²éæåå®¢\n\n\n# åè¨\n\næä½¿ç¨vuepressæ­å»ºäºä¸ä¸ªéæåå®¢ï¼æå¨äºGithub pagesåCoding pagesä¸é¢ã\n\ncoding pageså¨å½åçè®¿é®éåº¦æ¯github pagesè¦å¿«å¾å¤ï¼èä¸è¿å¯ä»¥è¢«ç¾åº¦æ¶å½ã\n\nä¸å¼å§çé¨ç½²æ¹å¼æ¯ä½¿ç¨shé¨ç½²èæ¬æä»£ç æäº¤å°è¿ä¸¤ä¸ªå¹³å°çä»åºåæ¯ï¼è½ç¶å·²ç»å¾æ¹ä¾¿äºï¼ä½æ¯æè¿æ³æåå®¢æªæåçæºç æäº¤å°Githubä¸»åæ¯ä¸ãè¿å°±éè¦ææä½ä¸¤æ¬¡å½ä»¤ï¼æå°±æ³è½ä¸è½åªéè¦ä¸æ¬¡æä½å°±å¯ä»¥åæ¶ææºç ãé¨ç½²ä»£ç ä¸æ¬¡æ§æäº¤å°ä¸¤ä¸ªå¹³å°å¢ï¼\n\n\n# å®ç°\n\nå¨äºè§£GitHub Actionsæè¿ï¼2019.12ï¼åæ­£å¼åå¸äºä¹åï¼å°è¯ä½¿ç¨å®åç°è½å¤æ»¡è¶³æçéæ±ãGitHub Actions å¥é¨æç¨\n\né¦åï¼éè¦è·åtokenï¼åé¢ä¼ç¨å°ãè·åæ¹æ³ï¼githubè·åtokenå®æ¹ææ¡£ãcodingè·åtokenå®æ¹ææ¡£ã\n\nç¶åï¼å°è¿ä¸¤ä¸ªtokenåæ¶å¨å­å°githubä»åºçSettings/Secretséé¢ãåéåå¯ä»¥éä¾¿åï¼ä½æ¯æ³¨æè¦ååé¢çci.ymlæä»¶åçåéåä¸è´ï¼è¿éåçæ¯ACCESS_TOKENåCODING_TOKENã\n\n\n\nGitHub Actions çéç½®æä»¶å«å workflow æä»¶ï¼å­æ¾å¨ä»£ç ä»åºç.github/workflowsç®å½ã\n\nworkflow æä»¶éç¨ YAML æ ¼å¼ï¼æä»¶åå¯ä»¥ä»»æåï¼ä½æ¯åç¼åç»ä¸ä¸º.ymlï¼æ¯å¦ci.ymlãä¸ä¸ªåºå¯ä»¥æå¤ä¸ª workflow æä»¶ãGitHub åªè¦åç°.github/workflowsç®å½éé¢æ.ymlæä»¶ï¼å°±ä¼èªå¨è¿è¡è¯¥æä»¶ã\n\næçci.ymlæä»¶ï¼\n\nname: CI\n\n# å¨masteråæ¯åçpushäºä»¶æ¶è§¦åã\non: \n  push:\n    branches:\n      - master\njobs: # å·¥ä½æµ\n  build:\n    runs-on: ubuntu-latest #è¿è¡å¨èææºç¯å¢ubuntu-latest\n\n    strategy:\n      matrix:\n        node-version: [10.x]\n\n    steps: \n      - name: Checkout # æ­¥éª¤1\n        uses: actions/checkout@v1 # ä½¿ç¨çå¨ä½ãæ ¼å¼ï¼userName/repoNameãä½ç¨ï¼æ£åºä»åºï¼è·åæºç ã å®æ¹actionsåºï¼https://github.com/actions\n      - name: Use Node.js ${{ matrix.node-version }} # æ­¥éª¤2\n        uses: actions/setup-node@v1 # ä½ç¨ï¼å®è£nodejs\n        with:\n          node-version: ${{ matrix.node-version }} # çæ¬\n      - name: run deploy.sh # æ­¥éª¤3 ï¼åæ¶é¨ç½²å°githubåcodingï¼\n        env: # è®¾ç½®ç¯å¢åé\n          GITHUB_TOKEN: ${{ secrets.ACCESS_TOKEN }} # toKenç§å¯åé\n          CODING_TOKEN: ${{ secrets.CODING_TOKEN }} # è¾è®¯äºå¼åèå¹³å°ï¼codingï¼ç§å¯token\n        run: npm install && npm run deploy # æ§è¡çå½ä»¤  \n        # package.json ä¸­æ·»å  "deploy": "bash deploy.sh"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n\nè¿ä¸ªéç½®æä»¶ä¼å¨æpushæäº¤ä»£ç å°ä¸»åæ¯æ¶è§¦åå·¥ä½ï¼è¿è¡ç¯å¢æ¯ubuntu-latestï¼å·¥ä½æ­¥éª¤ï¼\n\n * ä¸ï¼è·åä»åºæºç \n\n * äºï¼å®è£nodejsï¼æåé¡¹ç®æç¨å°nodejs\n\n * ä¸ï¼ætokenè®¾ç½®å°ç¯å¢åéï¼å®è£é¡¹ç®ä¾èµï¼å¹¶è¿è¡deploy.shæä»¶ï¼\n\n> ACCESS_TOKE å CODING_TOKEN é½æ¯ä¿å­å¨githubä»åºçSettings/Secretsä½ç½®çç§å¯åéï¼ä»åºä»£ç ä¸­å¯ä»¥éè¿<secrets.åéå>æ¥è·åï¼ä¿è¯äºtokençç§å¯æ§ã\n\nåæ¥ççå°è¦è¢«è¿è¡çdeploy.shé¨ç½²ä»£ç ï¼\n\n#!/usr/bin/env sh\n# ç¡®ä¿èæ¬æåºéå°çéè¯¯\nset -e\nnpm run build # çæéææä»¶\ncd docs/.vuepress/dist # è¿å¥çæçæä»¶å¤¹\n\n# deploy to github\necho \'blog.xugaoyi.com\' > CNAME\nif [ -z "$GITHUB_TOKEN" ]; then\n  msg=\'deploy\'\n  githubUrl=git@github.com:xugaoyi/blog.git\nelse\n  msg=\'æ¥èªgithub actionçèªå¨é¨ç½²\'\n  githubUrl=https://xugaoyi:${GITHUB_TOKEN}@github.com/xugaoyi/blog.git\n  git config --global user.name "xugaoyi"\n  git config --global user.email "894072666@qq.com"\nfi\ngit init\ngit add -A\ngit commit -m "${msg}"\ngit push -f $githubUrl master:gh-pages # æ¨éå°github\n\n# deploy to coding\necho \'www.xugaoyi.com\\nxugaoyi.com\' > CNAME  # èªå®ä¹åå\nif [ -z "$CODING_TOKEN" ]; then  # -z å­ç¬¦ä¸² é¿åº¦ä¸º0åä¸ºtrueï¼$CODING_TOKENæ¥èªäºgithubä»åº`Settings/Secrets`è®¾ç½®çç§å¯ç¯å¢åé\n  codingUrl=git@git.dev.tencent.com:xugaoyi/xugaoyi.git\nelse\n  codingUrl=https://xugaoyi:${CODING_TOKEN}@git.dev.tencent.com/xugaoyi/xugaoyi.git\nfi\ngit add -A\ngit commit -m "${msg}"\ngit push -f $codingUrl master # æ¨éå°coding\n\ncd -\nrm -rf docs/.vuepress/dist\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n\n\nè¿ä¸ªæä»¶ä½¿ç¨Shellå½ä»¤åçï¼å®ä¼åè¿è¡æåå½ä»¤ï¼è¿å¥æåå¥½çæä»¶ï¼åå»ºä¸ä¸ªèªå®ä¹ååçCNAMEæä»¶ï¼å¦æä½ æ²¡æèªå®ä¹ååå¯å»æè¿ä¸ªå½ä»¤ï¼ï¼å¤æ­æ¯å¦ætokenç¯å¢åéï¼å¦ææ²¡æè¯´ææ¯å¨æ¬å°èªå·±ççµèä¸è¿è¡çé¨ç½²ï¼ä½¿ç¨sshä»£ç ä»åºå°åï¼å¦æætokenç¯å¢åéï¼è¯´ææ¯GitHub Actionsèªå¨è§¦åçé¨ç½²ï¼æ­¤æ¶ä½¿ç¨çæ¯å¯ä»¥éè¿toKenæ¥è·åä»£ç æäº¤æéçæäº¤å°åãæåéè¿gitå½ä»¤æäº¤å°åèªçä»åºï¼å®æé¨ç½²ã\n\n> æç¤ºï¼\n> \n>  * Shell å¯ä»¥è·åå°ç¯å¢åéã\n> \n>  * ææ³ç»ä¸¤ä¸ªå¹³å°ä¸é¨ç½²çåå®¢ä¸ä¸æ ·çèªå®ä¹ååï¼å æ­¤åäºåå¼åå»ºCNAMEæä»¶ï¼åå¼æäº¤ã\n\nè³æ­¤ï¼æåé¢æå°çéæ±å°±å®ç°å¦ï¼åªéè¦ææºç pushå°githubä»åºè¿ä¸ä¸ªæ­¥éª¤ï¼åé¢çåå®¢æåãé¨ç½²å°githubåcodingç­å·¥ä½é½ç±GitHub Actionsæ¥èªå¨å®æã\n\nå¦ä¸ä½ æ³æ¥çé¨ç½²æ¥å¿ï¼ä½ å¯ä»¥å°githubä»åºçActionsè¿ä¸é¡¹æ¥çã\n\n\n\n\n# ç¸å³æç« \n\nãGitHub Actions å®æ¶è¿è¡ä»£ç ï¼æ¯å¤©å®æ¶ç¾åº¦é¾æ¥æ¨éã',normalizedContent:'# github actions å®ç°èªå¨é¨ç½²éæåå®¢\n\n\n# åè¨\n\næä½¿ç¨vuepressæ­å»ºäºä¸ä¸ªéæåå®¢ï¼æå¨äºgithub pagesåcoding pagesä¸é¢ã\n\ncoding pageså¨å½åçè®¿é®éåº¦æ¯github pagesè¦å¿«å¾å¤ï¼èä¸è¿å¯ä»¥è¢«ç¾åº¦æ¶å½ã\n\nä¸å¼å§çé¨ç½²æ¹å¼æ¯ä½¿ç¨shé¨ç½²èæ¬æä»£ç æäº¤å°è¿ä¸¤ä¸ªå¹³å°çä»åºåæ¯ï¼è½ç¶å·²ç»å¾æ¹ä¾¿äºï¼ä½æ¯æè¿æ³æåå®¢æªæåçæºç æäº¤å°githubä¸»åæ¯ä¸ãè¿å°±éè¦ææä½ä¸¤æ¬¡å½ä»¤ï¼æå°±æ³è½ä¸è½åªéè¦ä¸æ¬¡æä½å°±å¯ä»¥åæ¶ææºç ãé¨ç½²ä»£ç ä¸æ¬¡æ§æäº¤å°ä¸¤ä¸ªå¹³å°å¢ï¼\n\n\n# å®ç°\n\nå¨äºè§£github actionsæè¿ï¼2019.12ï¼åæ­£å¼åå¸äºä¹åï¼å°è¯ä½¿ç¨å®åç°è½å¤æ»¡è¶³æçéæ±ãgithub actions å¥é¨æç¨\n\né¦åï¼éè¦è·åtokenï¼åé¢ä¼ç¨å°ãè·åæ¹æ³ï¼githubè·åtokenå®æ¹ææ¡£ãcodingè·åtokenå®æ¹ææ¡£ã\n\nç¶åï¼å°è¿ä¸¤ä¸ªtokenåæ¶å¨å­å°githubä»åºçsettings/secretséé¢ãåéåå¯ä»¥éä¾¿åï¼ä½æ¯æ³¨æè¦ååé¢çci.ymlæä»¶åçåéåä¸è´ï¼è¿éåçæ¯access_tokenåcoding_tokenã\n\n\n\ngithub actions çéç½®æä»¶å«å workflow æä»¶ï¼å­æ¾å¨ä»£ç ä»åºç.github/workflowsç®å½ã\n\nworkflow æä»¶éç¨ yaml æ ¼å¼ï¼æä»¶åå¯ä»¥ä»»æåï¼ä½æ¯åç¼åç»ä¸ä¸º.ymlï¼æ¯å¦ci.ymlãä¸ä¸ªåºå¯ä»¥æå¤ä¸ª workflow æä»¶ãgithub åªè¦åç°.github/workflowsç®å½éé¢æ.ymlæä»¶ï¼å°±ä¼èªå¨è¿è¡è¯¥æä»¶ã\n\næçci.ymlæä»¶ï¼\n\nname: ci\n\n# å¨masteråæ¯åçpushäºä»¶æ¶è§¦åã\non: \n  push:\n    branches:\n      - master\njobs: # å·¥ä½æµ\n  build:\n    runs-on: ubuntu-latest #è¿è¡å¨èææºç¯å¢ubuntu-latest\n\n    strategy:\n      matrix:\n        node-version: [10.x]\n\n    steps: \n      - name: checkout # æ­¥éª¤1\n        uses: actions/checkout@v1 # ä½¿ç¨çå¨ä½ãæ ¼å¼ï¼username/reponameãä½ç¨ï¼æ£åºä»åºï¼è·åæºç ã å®æ¹actionsåºï¼https://github.com/actions\n      - name: use node.js ${{ matrix.node-version }} # æ­¥éª¤2\n        uses: actions/setup-node@v1 # ä½ç¨ï¼å®è£nodejs\n        with:\n          node-version: ${{ matrix.node-version }} # çæ¬\n      - name: run deploy.sh # æ­¥éª¤3 ï¼åæ¶é¨ç½²å°githubåcodingï¼\n        env: # è®¾ç½®ç¯å¢åé\n          github_token: ${{ secrets.access_token }} # tokenç§å¯åé\n          coding_token: ${{ secrets.coding_token }} # è¾è®¯äºå¼åèå¹³å°ï¼codingï¼ç§å¯token\n        run: npm install && npm run deploy # æ§è¡çå½ä»¤  \n        # package.json ä¸­æ·»å  "deploy": "bash deploy.sh"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n\nè¿ä¸ªéç½®æä»¶ä¼å¨æpushæäº¤ä»£ç å°ä¸»åæ¯æ¶è§¦åå·¥ä½ï¼è¿è¡ç¯å¢æ¯ubuntu-latestï¼å·¥ä½æ­¥éª¤ï¼\n\n * ä¸ï¼è·åä»åºæºç \n\n * äºï¼å®è£nodejsï¼æåé¡¹ç®æç¨å°nodejs\n\n * ä¸ï¼ætokenè®¾ç½®å°ç¯å¢åéï¼å®è£é¡¹ç®ä¾èµï¼å¹¶è¿è¡deploy.shæä»¶ï¼\n\n> access_toke å coding_token é½æ¯ä¿å­å¨githubä»åºçsettings/secretsä½ç½®çç§å¯åéï¼ä»åºä»£ç ä¸­å¯ä»¥éè¿<secrets.åéå>æ¥è·åï¼ä¿è¯äºtokençç§å¯æ§ã\n\nåæ¥ççå°è¦è¢«è¿è¡çdeploy.shé¨ç½²ä»£ç ï¼\n\n#!/usr/bin/env sh\n# ç¡®ä¿èæ¬æåºéå°çéè¯¯\nset -e\nnpm run build # çæéææä»¶\ncd docs/.vuepress/dist # è¿å¥çæçæä»¶å¤¹\n\n# deploy to github\necho \'blog.xugaoyi.com\' > cname\nif [ -z "$github_token" ]; then\n  msg=\'deploy\'\n  githuburl=git@github.com:xugaoyi/blog.git\nelse\n  msg=\'æ¥èªgithub actionçèªå¨é¨ç½²\'\n  githuburl=https://xugaoyi:${github_token}@github.com/xugaoyi/blog.git\n  git config --global user.name "xugaoyi"\n  git config --global user.email "894072666@qq.com"\nfi\ngit init\ngit add -a\ngit commit -m "${msg}"\ngit push -f $githuburl master:gh-pages # æ¨éå°github\n\n# deploy to coding\necho \'www.xugaoyi.com\\nxugaoyi.com\' > cname  # èªå®ä¹åå\nif [ -z "$coding_token" ]; then  # -z å­ç¬¦ä¸² é¿åº¦ä¸º0åä¸ºtrueï¼$coding_tokenæ¥èªäºgithubä»åº`settings/secrets`è®¾ç½®çç§å¯ç¯å¢åé\n  codingurl=git@git.dev.tencent.com:xugaoyi/xugaoyi.git\nelse\n  codingurl=https://xugaoyi:${coding_token}@git.dev.tencent.com/xugaoyi/xugaoyi.git\nfi\ngit add -a\ngit commit -m "${msg}"\ngit push -f $codingurl master # æ¨éå°coding\n\ncd -\nrm -rf docs/.vuepress/dist\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n\n\nè¿ä¸ªæä»¶ä½¿ç¨shellå½ä»¤åçï¼å®ä¼åè¿è¡æåå½ä»¤ï¼è¿å¥æåå¥½çæä»¶ï¼åå»ºä¸ä¸ªèªå®ä¹ååçcnameæä»¶ï¼å¦æä½ æ²¡æèªå®ä¹ååå¯å»æè¿ä¸ªå½ä»¤ï¼ï¼å¤æ­æ¯å¦ætokenç¯å¢åéï¼å¦ææ²¡æè¯´ææ¯å¨æ¬å°èªå·±ççµèä¸è¿è¡çé¨ç½²ï¼ä½¿ç¨sshä»£ç ä»åºå°åï¼å¦æætokenç¯å¢åéï¼è¯´ææ¯github actionsèªå¨è§¦åçé¨ç½²ï¼æ­¤æ¶ä½¿ç¨çæ¯å¯ä»¥éè¿tokenæ¥è·åä»£ç æäº¤æéçæäº¤å°åãæåéè¿gitå½ä»¤æäº¤å°åèªçä»åºï¼å®æé¨ç½²ã\n\n> æç¤ºï¼\n> \n>  * shell å¯ä»¥è·åå°ç¯å¢åéã\n> \n>  * ææ³ç»ä¸¤ä¸ªå¹³å°ä¸é¨ç½²çåå®¢ä¸ä¸æ ·çèªå®ä¹ååï¼å æ­¤åäºåå¼åå»ºcnameæä»¶ï¼åå¼æäº¤ã\n\nè³æ­¤ï¼æåé¢æå°çéæ±å°±å®ç°å¦ï¼åªéè¦ææºç pushå°githubä»åºè¿ä¸ä¸ªæ­¥éª¤ï¼åé¢çåå®¢æåãé¨ç½²å°githubåcodingç­å·¥ä½é½ç±github actionsæ¥èªå¨å®æã\n\nå¦ä¸ä½ æ³æ¥çé¨ç½²æ¥å¿ï¼ä½ å¯ä»¥å°githubä»åºçactionsè¿ä¸é¡¹æ¥çã\n\n\n\n\n# ç¸å³æç« \n\nãgithub actions å®æ¶è¿è¡ä»£ç ï¼æ¯å¤©å®æ¶ç¾åº¦é¾æ¥æ¨éã',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"GitHub Actions å®æ¶è¿è¡ä»£ç ï¼æ¯å¤©å®æ¶ç¾åº¦é¾æ¥æ¨é",frontmatter:{title:"GitHub Actions å®æ¶è¿è¡ä»£ç ï¼æ¯å¤©å®æ¶ç¾åº¦é¾æ¥æ¨é",date:"2019-12-30T21:23:00.000Z",permalink:"/pages/f44d2f9ad04ab8d3",categories:["ææ¯","GitHubæå·§"],tags:["github","åå®¢"],author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/100.%E5%85%B6%E4%BB%96/02.GitHub%E6%8A%80%E5%B7%A7/03.GitHub%20Actions%20%E5%AE%9A%E6%97%B6%E8%BF%90%E8%A1%8C%E4%BB%A3%E7%A0%81%EF%BC%9A%E6%AF%8F%E5%A4%A9%E5%AE%9A%E6%97%B6%E7%99%BE%E5%BA%A6%E9%93%BE%E6%8E%A5%E6%8E%A8%E9%80%81.html",relativePath:"100.å¶ä»/02.GitHubæå·§/03.GitHub Actions å®æ¶è¿è¡ä»£ç ï¼æ¯å¤©å®æ¶ç¾åº¦é¾æ¥æ¨é.md",key:"v-638f70fb",path:"/pages/f44d2f9ad04ab8d3/",headers:[{level:2,title:"ç¾åº¦ä¸»å¨é¾æ¥æ¨é",slug:"ç¾åº¦ä¸»å¨é¾æ¥æ¨é",normalizedTitle:"ç¾åº¦ä¸»å¨é¾æ¥æ¨é",charIndex:246},{level:2,title:"èªå¨çæurls.txt",slug:"èªå¨çæurls-txt",normalizedTitle:"èªå¨çæurls.txt",charIndex:603},{level:2,title:"GitHub Actions å®æ¶è¿è¡ä»£ç ",slug:"github-actions-å®æ¶è¿è¡ä»£ç ",normalizedTitle:"github actions å®æ¶è¿è¡ä»£ç ",charIndex:2},{level:3,title:"éç½® GitHub Actions",slug:"éç½®-github-actions",normalizedTitle:"éç½® github actions",charIndex:2071},{level:3,title:"baiduPushå½ä»¤å¨package.jsonéç½®",slug:"baidupushå½ä»¤å¨package-jsonéç½®",normalizedTitle:"baidupushå½ä»¤å¨package.jsonéç½®",charIndex:2824},{level:3,title:"baiduPush.shæ§è¡ç¾åº¦æ¨éå½ä»¤",slug:"baidupush-shæ§è¡ç¾åº¦æ¨éå½ä»¤",normalizedTitle:"baidupush.shæ§è¡ç¾åº¦æ¨éå½ä»¤",charIndex:3175},{level:2,title:"ç¸å³æç« ",slug:"ç¸å³æç« ",normalizedTitle:"ç¸å³æç« ",charIndex:3659}],excerpt:'<h1 id="github-actions-å®æ¶è¿è¡ä»£ç -æ¯å¤©å®æ¶ç¾åº¦é¾æ¥æ¨é"><a class="header-anchor" href="#github-actions-å®æ¶è¿è¡ä»£ç -æ¯å¤©å®æ¶ç¾åº¦é¾æ¥æ¨é">#</a> GitHub Actions å®æ¶è¿è¡ä»£ç ï¼æ¯å¤©å®æ¶ç¾åº¦é¾æ¥æ¨é</h1>\n<p>åå®¢ä¸çº¿å·²ç»æäºæ¥å­äºï¼å´åç°ç¾åº¦è¿è¿æ²¡ææ¶å½æçåå®¢é¡µé¢ï¼å¨ç¾åº¦æ¨éå·¥å·å½ä¸­é¤äºæèªå¨æ¨éçä»£ç åµå¥ç½ç«ä¹å¤ï¼è¿æä¸ä¸ªå®æ¶çä¸»å¨æ¨éæ´é«æã</p>\n<p>æè¿åå¥½äºè§£å°GitHub Actionsçå®æ¶è¿è¡ä»£ç åè½ï¼å¯ä»¥ç¨å®æ¥æ¯å¤©èªå¨è¿è¡å½ä»¤çæææåå®¢é¾æ¥å¹¶è¿è¡ä¸æ¬¡æ§æ¨éç»ç¾åº¦ã</p>\n<p>GitHub Actions æ¯ä¸ä¸ª CI/CDï¼æç»­éæ/æç»­é¨ç½²ï¼å·¥å·ï¼ä½ä¹å¯ç¨ä½ä»£ç è¿è¡ç¯å¢ã<strong>åè½éå¸¸å¼ºå¤§ï¼è½å¤ç©åºè®¸å¤è±æ ·ã</strong></p>\n',headersStr:"ç¾åº¦ä¸»å¨é¾æ¥æ¨é èªå¨çæurls.txt GitHub Actions å®æ¶è¿è¡ä»£ç  éç½® GitHub Actions baiduPushå½ä»¤å¨package.jsonéç½® baiduPush.shæ§è¡ç¾åº¦æ¨éå½ä»¤ ç¸å³æç« ",content:"# GitHub Actions å®æ¶è¿è¡ä»£ç ï¼æ¯å¤©å®æ¶ç¾åº¦é¾æ¥æ¨é\n\nåå®¢ä¸çº¿å·²ç»æäºæ¥å­äºï¼å´åç°ç¾åº¦è¿è¿æ²¡ææ¶å½æçåå®¢é¡µé¢ï¼å¨ç¾åº¦æ¨éå·¥å·å½ä¸­é¤äºæèªå¨æ¨éçä»£ç åµå¥ç½ç«ä¹å¤ï¼è¿æä¸ä¸ªå®æ¶çä¸»å¨æ¨éæ´é«æã\n\næè¿åå¥½äºè§£å°GitHub Actionsçå®æ¶è¿è¡ä»£ç åè½ï¼å¯ä»¥ç¨å®æ¥æ¯å¤©èªå¨è¿è¡å½ä»¤çæææåå®¢é¾æ¥å¹¶è¿è¡ä¸æ¬¡æ§æ¨éç»ç¾åº¦ã\n\nGitHub Actions æ¯ä¸ä¸ª CI/CDï¼æç»­éæ/æç»­é¨ç½²ï¼å·¥å·ï¼ä½ä¹å¯ç¨ä½ä»£ç è¿è¡ç¯å¢ãåè½éå¸¸å¼ºå¤§ï¼è½å¤ç©åºè®¸å¤è±æ ·ã\n\n\n# ç¾åº¦ä¸»å¨é¾æ¥æ¨é\n\né¾æ¥ä¸»å¨æ¨éå¨ç¾åº¦ç«é¿ä¸­æä»ç»ï¼å¦å¾ã\n\n\n\nå·ä½ä½¿ç¨æ¹æ³å°±æ¯åå»ºä¸ä¸ªæä»¶urls.txtï¼æä»¶åæ¯è¡ä¸æ¡é¾æ¥çæ ¼å¼åå¥æäº¤çå¤ä¸ªé¾æ¥ï¼å¦å¾ã\n\n\n\nè¿è¡å½ä»¤\n\ncurl -H 'Content-Type:text/plain' --data-binary @urls.txt \"http://data.zz.baidu.com/urls?site=xugaoyi.com&token=T5PEAzhG*****\"\n\n\n1\n\n\nä¸é¢å½ä»¤çå°åååæ°ç±ç¾åº¦ç«é¿æä¾ãè¿è¡å®å½ä»¤ä¼è¿åæ¨éç»æï¼ä¸åºæå¤çè¯å°±ä¼æurls.txtåçææé¾æ¥ä¸æ¬¡æ§æ¨éç»ç¾åº¦ã\n\nè¿ä¸ªæ¹æ³è½ç¶æ¯åµå¥ç½ç«å¤´é¨çèªå¨æ¨éæ´é«æï¼ä½æ¯ä¹æå®çéº»ç¦ä¹å¤ï¼å°±æ¯å¾èªå·±å¡«å¥é¾æ¥å°urls.txtæä»¶ï¼ç¶åæå¨è¿è¡å½ä»¤ã\n\n\n# èªå¨çæurls.txt\n\næ²¡å³ç³»ï¼ææ¯çæ¬è´¨å°±æ¯è®©äºº\"å·æ\"çãäºæ¯ï¼æåäºä¸ä¸ªnodejså·¥å·ï¼ç¨äºæææçåå®¢é¡µé¢é¾æ¥çæå°urls.txt\n\n// baiduPush.js\n\n/**\n * çæç¾åº¦é¾æ¥æ¨éæä»¶\n */\nconst fs = require('fs');\nconst path = require('path');\nconst logger = require('tracer').colorConsole();\nconst matter = require('gray-matter'); // FrontMatterè§£æå¨ https://github.com/jonschlinkert/gray-matter\nconst readFileList = require('./modules/readFileList');\nconst urlsRoot = path.join(__dirname, '..', 'urls.txt'); // ç¾åº¦é¾æ¥æ¨éæä»¶\nconst DOMAIN = process.argv.splice(2)[0]; // è·åå½ä»¤è¡ä¼ å¥çåæ°\n\nif (!DOMAIN) {\n  logger.error('è¯·å¨è¿è¡æ­¤æä»¶æ¶æå®ä¸ä¸ªä½ è¦è¿è¡ç¾åº¦æ¨éçåååæ°ï¼ä¾ï¼node utils/baiduPush.js https://xugaoyi.com')\n  return\n}\n\nmain();\nfunction main() {\n  fs.writeFileSync(urlsRoot, DOMAIN)\n  const files = readFileList(); // è¯»åææmdæä»¶æ°æ®\n\n  files.forEach( file => {\n    const { data } = matter(fs.readFileSync(file.filePath, 'utf8')); \n\n    if (data.permalink) {\n      const link = `\\r\\n${DOMAIN}${data.permalink}/`;\n      console.log(link)\n      fs.appendFileSync(urlsRoot, link);\n    }\n  })\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n\n\nä¸é¢ä»£ç ä»æ¯éå¯¹æä¸ªäººçåå®¢çæé¾æ¥å°urls.txtæä»¶ãæ´å¤ä»£ç å¨ è¿éã\n\nè¿è¡å¦ä¸å½ä»¤å°±å¯ä»¥çäº§ä¸ä¸ªåå«åå®¢ææé¾æ¥çurls.txtæä»¶ï¼\n\nnode utils/baiduPush.js https://xugaoyi.com\n\n\n1\n\n\nååï¼ç¬¬ä¸ä¸ªéº»ç¦è§£å³äºðï¼æ¥ä¸æ¥æ¯è§£å³ç¬¬äºä¸ªéè¦æå¨è¿è¡æ¨éå½ä»¤çé®é¢ã\n\n> å¦æä½ æ²¡åæ³èªå¨çæï¼ä½ ä¹å¯ä»¥èªå·±æå¨åå»ºä¸ä¸ªurls.txtæä»¶ï¼æ¾å°githubä»åºã\n\n\n# GitHub Actions å®æ¶è¿è¡ä»£ç \n\nä»å¤©çä¸»è§GitHub Actions è¦ç»åºäºãï¼ç¸å³ï¼GitHub Actions å¥é¨æç¨ãGitHub Actions å®ç°èªå¨é¨ç½²éæåå®¢ï¼\n\nGitHub Actions æ¯ä¸ä¸ª CI/CDï¼æç»­éæ/æç»­é¨ç½²ï¼å·¥å·ï¼ä½ä¹å¯ç¨ä½ä»£ç è¿è¡ç¯å¢ãåè½éå¸¸å¼ºå¤§ï¼è½å¤ç©åºè®¸å¤è±æ ·ã\n\n\n# éç½® GitHub Actions\n\nè§¦å GitHub Actions éè¦å¨é¡¹ç®ä»åºæ°å»ºä¸ä¸ª.github/workflowså­ç®å½ï¼éé¢æ¯ YAML æ ¼å¼éç½®æä»¶ï¼æä»¶åå¯ä»¥éä¾¿åãGitHub åªè¦åç°éç½®æä»¶ï¼å°±ä¼è¿è¡ Actionsã\n\néç½®æä»¶çç¬¬ä¸é¨åæ¯è§¦åæ¡ä»¶ã\n\n## baiduPush.yml\nname: 'baiduPush'\n \non:\n  push:\n  schedule:\n    - cron: '0 23 * * *'\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼nameå­æ®µæ¯éç½®æä»¶çæè¿°ï¼onå­æ®µæ¯è§¦åæ¡ä»¶ãæä»¬æå®ä¸¤ç§æåµä¸è§¦åï¼ç¬¬ä¸ç§æ¯ä»£ç  Push è¿ä»åºï¼ç¬¬äºç§æ¯å®æ¶ä»»å¡ï¼æ¯å¤©å¨å½éæ åæ¶é´23ç¹ï¼åäº¬æ¶é´+8ï¼å³æ©ä¸7ç¹ï¼è¿è¡ã\n\n> å®æ¶è®¾ç½®çè¿é\n\næ¥çï¼å°±æ¯è¿è¡æµç¨ã\n\njobs:\n  bot:\n    runs-on: ubuntu-latest # è¿è¡ç¯å¢ä¸ºææ°ççUbuntu\n    steps:\n      - name: 'Checkout codes' # æ­¥éª¤ä¸ï¼è·åä»åºä»£ç \n        uses: actions/checkout@v1\n      - name: 'Run baiduPush.sh' # æ­¥éª¤äºï¼æ§è¡shå½ä»¤æä»¶\n        run: npm install && npm run baiduPush # è¿è¡å½ä»¤ãï¼æ³¨æï¼è¿è¡ç®å½æ¯ä»åºæ ¹ç®å½ï¼\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼æå®è¿è¡ç¯å¢æ¯ææ°çubuntuï¼æµç¨çç¬¬ä¸æ­¥æ¯ä»ä»£ç ä»åºè·åä»£ç ï¼ç¬¬äºæ­¥è¿è¡ä¸¤ä¸ªå½ä»¤ï¼åå®è£é¡¹ç®ä¾èµï¼åè¿è¡åå¨package.jsonçbaiduPushå½ä»¤ãå®æ´ä»£ç ç è¿é\n\n\n# baiduPushå½ä»¤å¨package.jsonéç½®\n\n// package.json\n\"scripts\": {\n\t\"baiduPush\": \"node utils/baiduPush.js https://xugaoyi.com && bash baiduPush.sh\"\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢èæ¬ä¸­å¨node utils/baiduPush.jsçåé¢å å¥ä½ çåååæ°ãè¿è¡æ­¤å½ä»¤çæurls.txtæä»¶ï¼ç¶åæ§è¡baiduPush.shæä»¶ã\n\næ³¨æï¼å¨ä½¿ç¨windowç³»ç»æ¶ï¼è¯·ä½¿ç¨git bashå½ä»¤çªè¿è¡ä¸é¢çèæ¬ã\n\n> baiduPushå½ä»¤ä¹æä»¥æ²¡ææ¾å¨baiduPush.ymlç run éé¢æ¯å ä¸ºææ³å¨æ¬å°ä¹å¯ä»¥æ§è¡npm run baiduPushå½ä»¤ã\n\n\n# baiduPush.shæ§è¡ç¾åº¦æ¨éå½ä»¤\n\nbaiduPush.shæä»¶ï¼\n\n#!/usr/bin/env sh\n\nset -e\n\n# ç¾åº¦é¾æ¥æ¨é\ncurl -H 'Content-Type:text/plain' --data-binary @urls.txt \"http://data.zz.baidu.com/urls?site=https://xugaoyi.com&token=T5PEAzhGa*****\"\n\nrm -rf urls.txt # ç­è¿¹\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼æurls.txtæä»¶ä¸­çææé¾æ¥ä¸æ¬¡æ§æ¨éã\n\n> baiduPush.shåçå½ä»¤ä¹æä»¥æ²¡æåå¨package.jsonæ¯å ä¸ºæè§å¾å½ä»¤å¤ªé¿äºï¼ä¸æ¹ä¾¿éè¯»ã\n\nåå¥½éç½®ï¼æ¨éå°ä»åºï¼å°±ä¼å¨æ¯å¤©çæ©ä¸7ç¹éï¼èªå¨è¿è¡å½ä»¤çæä¸ä¸ªåå«åå®¢ææé¡µé¢é¾æ¥çurls.txtæä»¶ï¼å¹¶æææé¾æ¥ä¸æ¬¡æ§æ¨éå°ç¾åº¦ãéº»éº»åä¹ä¸ç¨æå¿æçç½ç«ä¸è¢«æ¶å½~~ð ð ð\n\nå¨è¿ä¸ªåºç¡ä¸å¯ä»¥æ©å±ï¼ä½¿ç¨GitHub Actionsæ»¡è¶³ä½ èªå·±çåç§å®æ¶éæ±ã\n\n\n# ç¸å³æç« \n\nã GitHub Actions å®ç°èªå¨é¨ç½²éæåå®¢ã\n\nãè§£å³ç¾åº¦æ æ³æ¶å½æ­å»ºå¨GitHubä¸çéæåå®¢çé®é¢ã",normalizedContent:"# github actions å®æ¶è¿è¡ä»£ç ï¼æ¯å¤©å®æ¶ç¾åº¦é¾æ¥æ¨é\n\nåå®¢ä¸çº¿å·²ç»æäºæ¥å­äºï¼å´åç°ç¾åº¦è¿è¿æ²¡ææ¶å½æçåå®¢é¡µé¢ï¼å¨ç¾åº¦æ¨éå·¥å·å½ä¸­é¤äºæèªå¨æ¨éçä»£ç åµå¥ç½ç«ä¹å¤ï¼è¿æä¸ä¸ªå®æ¶çä¸»å¨æ¨éæ´é«æã\n\næè¿åå¥½äºè§£å°github actionsçå®æ¶è¿è¡ä»£ç åè½ï¼å¯ä»¥ç¨å®æ¥æ¯å¤©èªå¨è¿è¡å½ä»¤çæææåå®¢é¾æ¥å¹¶è¿è¡ä¸æ¬¡æ§æ¨éç»ç¾åº¦ã\n\ngithub actions æ¯ä¸ä¸ª ci/cdï¼æç»­éæ/æç»­é¨ç½²ï¼å·¥å·ï¼ä½ä¹å¯ç¨ä½ä»£ç è¿è¡ç¯å¢ãåè½éå¸¸å¼ºå¤§ï¼è½å¤ç©åºè®¸å¤è±æ ·ã\n\n\n# ç¾åº¦ä¸»å¨é¾æ¥æ¨é\n\né¾æ¥ä¸»å¨æ¨éå¨ç¾åº¦ç«é¿ä¸­æä»ç»ï¼å¦å¾ã\n\n\n\nå·ä½ä½¿ç¨æ¹æ³å°±æ¯åå»ºä¸ä¸ªæä»¶urls.txtï¼æä»¶åæ¯è¡ä¸æ¡é¾æ¥çæ ¼å¼åå¥æäº¤çå¤ä¸ªé¾æ¥ï¼å¦å¾ã\n\n\n\nè¿è¡å½ä»¤\n\ncurl -h 'content-type:text/plain' --data-binary @urls.txt \"http://data.zz.baidu.com/urls?site=xugaoyi.com&token=t5peazhg*****\"\n\n\n1\n\n\nä¸é¢å½ä»¤çå°åååæ°ç±ç¾åº¦ç«é¿æä¾ãè¿è¡å®å½ä»¤ä¼è¿åæ¨éç»æï¼ä¸åºæå¤çè¯å°±ä¼æurls.txtåçææé¾æ¥ä¸æ¬¡æ§æ¨éç»ç¾åº¦ã\n\nè¿ä¸ªæ¹æ³è½ç¶æ¯åµå¥ç½ç«å¤´é¨çèªå¨æ¨éæ´é«æï¼ä½æ¯ä¹æå®çéº»ç¦ä¹å¤ï¼å°±æ¯å¾èªå·±å¡«å¥é¾æ¥å°urls.txtæä»¶ï¼ç¶åæå¨è¿è¡å½ä»¤ã\n\n\n# èªå¨çæurls.txt\n\næ²¡å³ç³»ï¼ææ¯çæ¬è´¨å°±æ¯è®©äºº\"å·æ\"çãäºæ¯ï¼æåäºä¸ä¸ªnodejså·¥å·ï¼ç¨äºæææçåå®¢é¡µé¢é¾æ¥çæå°urls.txt\n\n// baidupush.js\n\n/**\n * çæç¾åº¦é¾æ¥æ¨éæä»¶\n */\nconst fs = require('fs');\nconst path = require('path');\nconst logger = require('tracer').colorconsole();\nconst matter = require('gray-matter'); // frontmatterè§£æå¨ https://github.com/jonschlinkert/gray-matter\nconst readfilelist = require('./modules/readfilelist');\nconst urlsroot = path.join(__dirname, '..', 'urls.txt'); // ç¾åº¦é¾æ¥æ¨éæä»¶\nconst domain = process.argv.splice(2)[0]; // è·åå½ä»¤è¡ä¼ å¥çåæ°\n\nif (!domain) {\n  logger.error('è¯·å¨è¿è¡æ­¤æä»¶æ¶æå®ä¸ä¸ªä½ è¦è¿è¡ç¾åº¦æ¨éçåååæ°ï¼ä¾ï¼node utils/baidupush.js https://xugaoyi.com')\n  return\n}\n\nmain();\nfunction main() {\n  fs.writefilesync(urlsroot, domain)\n  const files = readfilelist(); // è¯»åææmdæä»¶æ°æ®\n\n  files.foreach( file => {\n    const { data } = matter(fs.readfilesync(file.filepath, 'utf8')); \n\n    if (data.permalink) {\n      const link = `\\r\\n${domain}${data.permalink}/`;\n      console.log(link)\n      fs.appendfilesync(urlsroot, link);\n    }\n  })\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n\n\nä¸é¢ä»£ç ä»æ¯éå¯¹æä¸ªäººçåå®¢çæé¾æ¥å°urls.txtæä»¶ãæ´å¤ä»£ç å¨ è¿éã\n\nè¿è¡å¦ä¸å½ä»¤å°±å¯ä»¥çäº§ä¸ä¸ªåå«åå®¢ææé¾æ¥çurls.txtæä»¶ï¼\n\nnode utils/baidupush.js https://xugaoyi.com\n\n\n1\n\n\nååï¼ç¬¬ä¸ä¸ªéº»ç¦è§£å³äºðï¼æ¥ä¸æ¥æ¯è§£å³ç¬¬äºä¸ªéè¦æå¨è¿è¡æ¨éå½ä»¤çé®é¢ã\n\n> å¦æä½ æ²¡åæ³èªå¨çæï¼ä½ ä¹å¯ä»¥èªå·±æå¨åå»ºä¸ä¸ªurls.txtæä»¶ï¼æ¾å°githubä»åºã\n\n\n# github actions å®æ¶è¿è¡ä»£ç \n\nä»å¤©çä¸»è§github actions è¦ç»åºäºãï¼ç¸å³ï¼github actions å¥é¨æç¨ãgithub actions å®ç°èªå¨é¨ç½²éæåå®¢ï¼\n\ngithub actions æ¯ä¸ä¸ª ci/cdï¼æç»­éæ/æç»­é¨ç½²ï¼å·¥å·ï¼ä½ä¹å¯ç¨ä½ä»£ç è¿è¡ç¯å¢ãåè½éå¸¸å¼ºå¤§ï¼è½å¤ç©åºè®¸å¤è±æ ·ã\n\n\n# éç½® github actions\n\nè§¦å github actions éè¦å¨é¡¹ç®ä»åºæ°å»ºä¸ä¸ª.github/workflowså­ç®å½ï¼éé¢æ¯ yaml æ ¼å¼éç½®æä»¶ï¼æä»¶åå¯ä»¥éä¾¿åãgithub åªè¦åç°éç½®æä»¶ï¼å°±ä¼è¿è¡ actionsã\n\néç½®æä»¶çç¬¬ä¸é¨åæ¯è§¦åæ¡ä»¶ã\n\n## baidupush.yml\nname: 'baidupush'\n \non:\n  push:\n  schedule:\n    - cron: '0 23 * * *'\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼nameå­æ®µæ¯éç½®æä»¶çæè¿°ï¼onå­æ®µæ¯è§¦åæ¡ä»¶ãæä»¬æå®ä¸¤ç§æåµä¸è§¦åï¼ç¬¬ä¸ç§æ¯ä»£ç  push è¿ä»åºï¼ç¬¬äºç§æ¯å®æ¶ä»»å¡ï¼æ¯å¤©å¨å½éæ åæ¶é´23ç¹ï¼åäº¬æ¶é´+8ï¼å³æ©ä¸7ç¹ï¼è¿è¡ã\n\n> å®æ¶è®¾ç½®çè¿é\n\næ¥çï¼å°±æ¯è¿è¡æµç¨ã\n\njobs:\n  bot:\n    runs-on: ubuntu-latest # è¿è¡ç¯å¢ä¸ºææ°ççubuntu\n    steps:\n      - name: 'checkout codes' # æ­¥éª¤ä¸ï¼è·åä»åºä»£ç \n        uses: actions/checkout@v1\n      - name: 'run baidupush.sh' # æ­¥éª¤äºï¼æ§è¡shå½ä»¤æä»¶\n        run: npm install && npm run baidupush # è¿è¡å½ä»¤ãï¼æ³¨æï¼è¿è¡ç®å½æ¯ä»åºæ ¹ç®å½ï¼\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼æå®è¿è¡ç¯å¢æ¯ææ°çubuntuï¼æµç¨çç¬¬ä¸æ­¥æ¯ä»ä»£ç ä»åºè·åä»£ç ï¼ç¬¬äºæ­¥è¿è¡ä¸¤ä¸ªå½ä»¤ï¼åå®è£é¡¹ç®ä¾èµï¼åè¿è¡åå¨package.jsonçbaidupushå½ä»¤ãå®æ´ä»£ç ç è¿é\n\n\n# baidupushå½ä»¤å¨package.jsonéç½®\n\n// package.json\n\"scripts\": {\n\t\"baidupush\": \"node utils/baidupush.js https://xugaoyi.com && bash baidupush.sh\"\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢èæ¬ä¸­å¨node utils/baidupush.jsçåé¢å å¥ä½ çåååæ°ãè¿è¡æ­¤å½ä»¤çæurls.txtæä»¶ï¼ç¶åæ§è¡baidupush.shæä»¶ã\n\næ³¨æï¼å¨ä½¿ç¨windowç³»ç»æ¶ï¼è¯·ä½¿ç¨git bashå½ä»¤çªè¿è¡ä¸é¢çèæ¬ã\n\n> baidupushå½ä»¤ä¹æä»¥æ²¡ææ¾å¨baidupush.ymlç run éé¢æ¯å ä¸ºææ³å¨æ¬å°ä¹å¯ä»¥æ§è¡npm run baidupushå½ä»¤ã\n\n\n# baidupush.shæ§è¡ç¾åº¦æ¨éå½ä»¤\n\nbaidupush.shæä»¶ï¼\n\n#!/usr/bin/env sh\n\nset -e\n\n# ç¾åº¦é¾æ¥æ¨é\ncurl -h 'content-type:text/plain' --data-binary @urls.txt \"http://data.zz.baidu.com/urls?site=https://xugaoyi.com&token=t5peazhga*****\"\n\nrm -rf urls.txt # ç­è¿¹\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼æurls.txtæä»¶ä¸­çææé¾æ¥ä¸æ¬¡æ§æ¨éã\n\n> baidupush.shåçå½ä»¤ä¹æä»¥æ²¡æåå¨package.jsonæ¯å ä¸ºæè§å¾å½ä»¤å¤ªé¿äºï¼ä¸æ¹ä¾¿éè¯»ã\n\nåå¥½éç½®ï¼æ¨éå°ä»åºï¼å°±ä¼å¨æ¯å¤©çæ©ä¸7ç¹éï¼èªå¨è¿è¡å½ä»¤çæä¸ä¸ªåå«åå®¢ææé¡µé¢é¾æ¥çurls.txtæä»¶ï¼å¹¶æææé¾æ¥ä¸æ¬¡æ§æ¨éå°ç¾åº¦ãéº»éº»åä¹ä¸ç¨æå¿æçç½ç«ä¸è¢«æ¶å½~~ð ð ð\n\nå¨è¿ä¸ªåºç¡ä¸å¯ä»¥æ©å±ï¼ä½¿ç¨github actionsæ»¡è¶³ä½ èªå·±çåç§å®æ¶éæ±ã\n\n\n# ç¸å³æç« \n\nã github actions å®ç°èªå¨é¨ç½²éæåå®¢ã\n\nãè§£å³ç¾åº¦æ æ³æ¶å½æ­å»ºå¨githubä¸çéæåå®¢çé®é¢ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"GitHubå éä¸è½½é¡¹ç®çæ¹æ³",frontmatter:{title:"GitHubå éä¸è½½é¡¹ç®çæ¹æ³",date:"2020-03-09T10:28:09.000Z",permalink:"/pages/95331c6a9613faf8",categories:["ææ¯","GitHubæå·§"],tags:[null],author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/100.%E5%85%B6%E4%BB%96/02.GitHub%E6%8A%80%E5%B7%A7/10.GitHub%E5%8A%A0%E9%80%9F%E4%B8%8B%E8%BD%BD%E9%A1%B9%E7%9B%AE%E7%9A%84%E6%96%B9%E6%B3%95.html",relativePath:"100.å¶ä»/02.GitHubæå·§/10.GitHubå éä¸è½½é¡¹ç®çæ¹æ³.md",key:"v-6d7302f2",path:"/pages/95331c6a9613faf8/",headers:[{level:2,title:"å©ç¨ç äºæ¥è½¬æ¥åä¸è½½å é",slug:"å©ç¨ç äºæ¥è½¬æ¥åä¸è½½å é",normalizedTitle:"å©ç¨ç äºæ¥è½¬æ¥åä¸è½½å é",charIndex:109}],excerpt:'<h1 id="githubå éä¸è½½é¡¹ç®çæ¹æ³"><a class="header-anchor" href="#githubå éä¸è½½é¡¹ç®çæ¹æ³">#</a> GitHubå éä¸è½½é¡¹ç®çæ¹æ³</h1>\n<p>å½åå¨githubä¸åéé¡¹ç®æ»æ¯å¼å¸¸çæ¢ï¼æ®æå¤æ¬¡åéè§å¯ï¼ä¸è½½éåº¦æå¿«å°±20k/så·¦å³ï¼ç¹å«æ¯å¨åéæ¯è¾å¤§çé¡¹ç®æ¶ç®ç´æ¢å¾æ æ³å¿åï¼ä¸é¢ä»ç»ä¸ç§å è½½åéé¡¹ç®çæ¹æ³ã</p>\n',headersStr:"å©ç¨ç äºæ¥è½¬æ¥åä¸è½½å é",content:'# GitHubå éä¸è½½é¡¹ç®çæ¹æ³\n\nå½åå¨githubä¸åéé¡¹ç®æ»æ¯å¼å¸¸çæ¢ï¼æ®æå¤æ¬¡åéè§å¯ï¼ä¸è½½éåº¦æå¿«å°±20k/så·¦å³ï¼ç¹å«æ¯å¨åéæ¯è¾å¤§çé¡¹ç®æ¶ç®ç´æ¢å¾æ æ³å¿åï¼ä¸é¢ä»ç»ä¸ç§å è½½åéé¡¹ç®çæ¹æ³ã\n\n\n\n\n# å©ç¨ç äºæ¥è½¬æ¥åä¸è½½å é\n\n 1. é¦åä½ å¾æä¸ä¸ª ç äº çè´¦å·\n\n 2. ç»å½ç äºä¹åå¨é¡µé¢å³ä¸è§çå å·éæ©ä»GitHub/GitLabå¯¼å¥é¡¹ç®\n    \n    \n\n 3. éæ©ä»URLå¯¼å¥ï¼ç²è´´ä»GitHubå¤å¶æ¥çä»åºå°åï¼ç¶åå¯¼å¥ï¼è¿ä¸ªå¯¼å¥è¿ç¨ä¸è¬æ¯å¾å¿«çã\n    \n    \n\n 4. ä»ç äºåéåå¯¼å¥çè¿ä¸ªé¡¹ç®ï¼åééåº¦ä¼å¿«å¾å¤ï¼ç½éå¥½çè½è¾¾å°å åæ¯ç§ï¼å·ä½éåº¦å°±çä½ çç½éäºï¼åæ§½ä¸ä¸æå®¶ç½éï¼æ»å¨å³é®æ¶å»æ¾ç¤º"è§é¢å è½½ä¸­"....ï¼\n    \n    \n\n 5. å¦å¤è¦æ³¨æçä¸ç¹ï¼åéä¸æ¥çé¡¹ç®å³èçæ¯ç äºçä»åºï¼å¦æä½ éè¦å³ègithubä»åºéè¦æ´æ¹è¿ç¨ä»åºã\n    \n    git remote -v # æ¥çå³èçè¿ç¨ä»åº\n    git remote rm <ä»åºå> # å é¤è¿ç¨ä»åº\n    git remote add <ä»åºå> <è¿ç¨ä»åºå°å> # å³èè¿ç¨ä»åºï¼ä»åºåä¸è¬ä½¿ç¨origin\n    \n    \n    1\n    2\n    3\n    \n\nè¿ä¸ªæ¹æ³éåç¨äºåéæ¯è¾å¤§çé¡¹ç®ï¼å¦æåéå°é¡¹ç®ï¼20k/sçéåº¦å¥½åè¿è½å°å°±~~',normalizedContent:'# githubå éä¸è½½é¡¹ç®çæ¹æ³\n\nå½åå¨githubä¸åéé¡¹ç®æ»æ¯å¼å¸¸çæ¢ï¼æ®æå¤æ¬¡åéè§å¯ï¼ä¸è½½éåº¦æå¿«å°±20k/så·¦å³ï¼ç¹å«æ¯å¨åéæ¯è¾å¤§çé¡¹ç®æ¶ç®ç´æ¢å¾æ æ³å¿åï¼ä¸é¢ä»ç»ä¸ç§å è½½åéé¡¹ç®çæ¹æ³ã\n\n\n\n\n# å©ç¨ç äºæ¥è½¬æ¥åä¸è½½å é\n\n 1. é¦åä½ å¾æä¸ä¸ª ç äº çè´¦å·\n\n 2. ç»å½ç äºä¹åå¨é¡µé¢å³ä¸è§çå å·éæ©ä»github/gitlabå¯¼å¥é¡¹ç®\n    \n    \n\n 3. éæ©ä»urlå¯¼å¥ï¼ç²è´´ä»githubå¤å¶æ¥çä»åºå°åï¼ç¶åå¯¼å¥ï¼è¿ä¸ªå¯¼å¥è¿ç¨ä¸è¬æ¯å¾å¿«çã\n    \n    \n\n 4. ä»ç äºåéåå¯¼å¥çè¿ä¸ªé¡¹ç®ï¼åééåº¦ä¼å¿«å¾å¤ï¼ç½éå¥½çè½è¾¾å°å åæ¯ç§ï¼å·ä½éåº¦å°±çä½ çç½éäºï¼åæ§½ä¸ä¸æå®¶ç½éï¼æ»å¨å³é®æ¶å»æ¾ç¤º"è§é¢å è½½ä¸­"....ï¼\n    \n    \n\n 5. å¦å¤è¦æ³¨æçä¸ç¹ï¼åéä¸æ¥çé¡¹ç®å³èçæ¯ç äºçä»åºï¼å¦æä½ éè¦å³ègithubä»åºéè¦æ´æ¹è¿ç¨ä»åºã\n    \n    git remote -v # æ¥çå³èçè¿ç¨ä»åº\n    git remote rm <ä»åºå> # å é¤è¿ç¨ä»åº\n    git remote add <ä»åºå> <è¿ç¨ä»åºå°å> # å³èè¿ç¨ä»åºï¼ä»åºåä¸è¬ä½¿ç¨origin\n    \n    \n    1\n    2\n    3\n    \n\nè¿ä¸ªæ¹æ³éåç¨äºåéæ¯è¾å¤§çé¡¹ç®ï¼å¦æåéå°é¡¹ç®ï¼20k/sçéåº¦å¥½åè¿è½å°å°±~~',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"è§£å³ç¾åº¦æ æ³æ¶å½æ­å»ºå¨GitHubä¸çä¸ªäººåå®¢çé®é¢",frontmatter:{title:"è§£å³ç¾åº¦æ æ³æ¶å½æ­å»ºå¨GitHubä¸çä¸ªäººåå®¢çé®é¢",date:"2019-12-25T14:27:01.000Z",permalink:"/pages/41f87d890d0a02af",categories:["ææ¯","åå®¢æ­å»º"],tags:[null],author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/100.%E5%85%B6%E4%BB%96/04.%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/01.%E8%A7%A3%E5%86%B3%E7%99%BE%E5%BA%A6%E6%97%A0%E6%B3%95%E6%94%B6%E5%BD%95%E6%90%AD%E5%BB%BA%E5%9C%A8GitHub%E4%B8%8A%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E7%9A%84%E9%97%AE%E9%A2%98.html",relativePath:"100.å¶ä»/04.åå®¢æ­å»º/01.è§£å³ç¾åº¦æ æ³æ¶å½æ­å»ºå¨GitHubä¸çä¸ªäººåå®¢çé®é¢.md",key:"v-1de1c18a",path:"/pages/41f87d890d0a02af/",headers:[{level:2,title:"èæ¯",slug:"èæ¯",normalizedTitle:"èæ¯",charIndex:74},{level:2,title:"è§£å³æ¹æ¡",slug:"è§£å³æ¹æ¡",normalizedTitle:"è§£å³æ¹æ¡",charIndex:172},{level:3,title:"å¦ä½ç¥éç¾åº¦ææ²¡ææ¶å½ï¼",slug:"å¦ä½ç¥éç¾åº¦ææ²¡ææ¶å½",normalizedTitle:"å¦ä½ç¥éç¾åº¦ææ²¡ææ¶å½ï¼",charIndex:1221},{level:2,title:"ç¸å³æç« ",slug:"ç¸å³æç« ",normalizedTitle:"ç¸å³æç« ",charIndex:1286}],excerpt:'<h1 id="è§£å³ç¾åº¦æ æ³æ¶å½æ­å»ºå¨githubä¸çéæåå®¢çé®é¢"><a class="header-anchor" href="#è§£å³ç¾åº¦æ æ³æ¶å½æ­å»ºå¨githubä¸çéæåå®¢çé®é¢">#</a> è§£å³ç¾åº¦æ æ³æ¶å½æ­å»ºå¨GitHubä¸çéæåå®¢çé®é¢</h1>\n<div class="custom-block warning"><p class="custom-block-title">æ³¨æ</p>\n<p>å¦æä½ æ­£å¨å¯»æ¾æ¬åå®¢çæ­å»ºææ¡£ï¼åä¸»å»ºè®®æ¨æ¥çè¿ä¸ªä»åºç<a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer">README<OutboundLink/></a>ã</p>\n</div>\n<h2 id="èæ¯"><a class="header-anchor" href="#èæ¯">#</a> èæ¯</h2>\n<p>ç±äºGitHubç¦æ­¢ç¾åº¦ç¬è«è®¿é®ï¼é ææç®¡å¨GitHub Pagesä¸çåå®¢æ æ³è¢«ç¾åº¦æ¶å½ãç¸å³é®é¢å¯ä»¥éè¿ç¾åº¦ç«é¿å¹³å°ç<code>æåè¯æ­</code>åç°ï¼æ¯æ¬¡é½æ¯403 Forbiddençéè¯¯ã</p>\n',headersStr:"èæ¯ è§£å³æ¹æ¡ å¦ä½ç¥éç¾åº¦ææ²¡ææ¶å½ï¼ ç¸å³æç« ",content:"# è§£å³ç¾åº¦æ æ³æ¶å½æ­å»ºå¨GitHubä¸çéæåå®¢çé®é¢\n\næ³¨æ\n\nå¦æä½ æ­£å¨å¯»æ¾æ¬åå®¢çæ­å»ºææ¡£ï¼åä¸»å»ºè®®æ¨æ¥çè¿ä¸ªä»åºçREADMEã\n\n\n# èæ¯\n\nç±äºGitHubç¦æ­¢ç¾åº¦ç¬è«è®¿é®ï¼é ææç®¡å¨GitHub Pagesä¸çåå®¢æ æ³è¢«ç¾åº¦æ¶å½ãç¸å³é®é¢å¯ä»¥éè¿ç¾åº¦ç«é¿å¹³å°çæåè¯æ­åç°ï¼æ¯æ¬¡é½æ¯403 Forbiddençéè¯¯ã\n\n\n# è§£å³æ¹æ¡\n\nåæ¶å°åå®¢åæ¶åæ­¥æç®¡å°GitHub Pagesåcoding pagesä¸ï¼è§£å³ç¾åº¦ä¸æ¶å½é®é¢ãæååç°å¨å½åä½¿ç¨coding pagesæå¼éåº¦ç¹å«å¿«ï¼èä¸è¿ä¼è¢«ç¾åº¦æ¶å½ï¼å æ­¤ææcoding pagesçç«ç¹ä½ä¸ºä¸»ç«ç¹ï¼åæ¬å¨github pagesçä½ä¸ºåç«ç¹ã\n\næ­¥éª¤ï¼\n\n1ãæ³¨åcodingè´¦å·ï¼åå»ºä»åºï¼æä»£ç æ¨éå°codingä»åºï¼å¹¶å¼å¯pagesæå¡ã\n\n> git æä½é¨ååä½¿ç¨githubçå·®ä¸å¤ï¼ä¸äºè§£gitæä½çå¯ä»¥çæçå¦ä¸ç¯æç« ï¼Gitä½¿ç¨æå\n\n2ãæçåå®¢é¡¹ç®ä½¿ç¨vuepressæ­å»ºçï¼ä½¿ç¨çæ¯å¦ä¸èªå¨é¨ç½²èæ¬ï¼åæ¶å°ä»£ç æ¨éå°githubåcondingã\n\n#!/usr/bin/env sh\n\n# ç¡®ä¿èæ¬æåºéå°çéè¯¯\nset -e\n\n# çæéææä»¶\nnpm run build\n\n# è¿å¥çæçæä»¶å¤¹\ncd docs/.vuepress/dist\n\n# github\necho 'b.xugaoyi.com' > CNAME\ngit init\ngit add -A\ngit commit -m 'deploy'\ngit push -f git@github.com:xugaoyi/blog.git master:gh-pages # åå¸å°github\n\n# coding\necho 'xugaoyi.com' > CNAME\ngit add -A\ngit commit -m 'deploy'\ngit push -f git@git.dev.tencent.com:xugaoyi/xugaoyi.git master # åå¸å°coding\n\ncd - # éåå¼å§æå¨ç®å½\nrm -rf docs/.vuepress/dist\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\n> å ä¸ºææ³ç»ä¸¤ä¸ªå¹³å°ä¸ç»å®ä¸åçèªå®ä¹ååï¼å æ­¤æåå¼åå»ºäºCNAMEæä»¶ã\n\n3ãæèªå®ä¹ååçï¼ä¹å¯ä»¥å¨coding pagesç»å®èªå®ä¹ååï¼ååDNSè§£æä¸­æ·»å CNAMEè®°å½æåcoding pagesçç«ç¹å°åå³å¯ãï¼æ²¡æèªå®ä¹ååçå¯å¿½ç¥ï¼åæ¶æèªå¨é¨ç½²èæ¬ä¸­çåå»ºCNAMEæä»¶çèæ¬å»æï¼\n\næåï¼ä½¿ç¨ç¾åº¦ç«é¿çæåè¯æ­ï¼åç°æåæåå¦ï¼åä½¿ç¨ç¾åº¦ç«é¿çé¾æ¥æäº¤åè½ï¼æé¾æ¥æäº¤ç»ç¾åº¦ï¼è¿ä¸æ®µæ¶é´å°±å¯è½å¨ç¾åº¦æç´¢ä¸­æç´¢å°å¦ã\n\n\n# å¦ä½ç¥éç¾åº¦ææ²¡ææ¶å½ï¼\n\nå¨ç¾åº¦æç´¢æ¡ä¸­ä½¿ç¨site:<é¾æ¥å°å>ï¼å¦ï¼\n\nsite:xugaoyi.com\n\n\n1\n\n\n\n# ç¸å³æç« \n\nãGitHub Actions å®æ¶è¿è¡ä»£ç ï¼æ¯å¤©å®æ¶ç¾åº¦é¾æ¥æ¨éã",normalizedContent:"# è§£å³ç¾åº¦æ æ³æ¶å½æ­å»ºå¨githubä¸çéæåå®¢çé®é¢\n\næ³¨æ\n\nå¦æä½ æ­£å¨å¯»æ¾æ¬åå®¢çæ­å»ºææ¡£ï¼åä¸»å»ºè®®æ¨æ¥çè¿ä¸ªä»åºçreadmeã\n\n\n# èæ¯\n\nç±äºgithubç¦æ­¢ç¾åº¦ç¬è«è®¿é®ï¼é ææç®¡å¨github pagesä¸çåå®¢æ æ³è¢«ç¾åº¦æ¶å½ãç¸å³é®é¢å¯ä»¥éè¿ç¾åº¦ç«é¿å¹³å°çæåè¯æ­åç°ï¼æ¯æ¬¡é½æ¯403 forbiddençéè¯¯ã\n\n\n# è§£å³æ¹æ¡\n\nåæ¶å°åå®¢åæ¶åæ­¥æç®¡å°github pagesåcoding pagesä¸ï¼è§£å³ç¾åº¦ä¸æ¶å½é®é¢ãæååç°å¨å½åä½¿ç¨coding pagesæå¼éåº¦ç¹å«å¿«ï¼èä¸è¿ä¼è¢«ç¾åº¦æ¶å½ï¼å æ­¤ææcoding pagesçç«ç¹ä½ä¸ºä¸»ç«ç¹ï¼åæ¬å¨github pagesçä½ä¸ºåç«ç¹ã\n\næ­¥éª¤ï¼\n\n1ãæ³¨åcodingè´¦å·ï¼åå»ºä»åºï¼æä»£ç æ¨éå°codingä»åºï¼å¹¶å¼å¯pagesæå¡ã\n\n> git æä½é¨ååä½¿ç¨githubçå·®ä¸å¤ï¼ä¸äºè§£gitæä½çå¯ä»¥çæçå¦ä¸ç¯æç« ï¼gitä½¿ç¨æå\n\n2ãæçåå®¢é¡¹ç®ä½¿ç¨vuepressæ­å»ºçï¼ä½¿ç¨çæ¯å¦ä¸èªå¨é¨ç½²èæ¬ï¼åæ¶å°ä»£ç æ¨éå°githubåcondingã\n\n#!/usr/bin/env sh\n\n# ç¡®ä¿èæ¬æåºéå°çéè¯¯\nset -e\n\n# çæéææä»¶\nnpm run build\n\n# è¿å¥çæçæä»¶å¤¹\ncd docs/.vuepress/dist\n\n# github\necho 'b.xugaoyi.com' > cname\ngit init\ngit add -a\ngit commit -m 'deploy'\ngit push -f git@github.com:xugaoyi/blog.git master:gh-pages # åå¸å°github\n\n# coding\necho 'xugaoyi.com' > cname\ngit add -a\ngit commit -m 'deploy'\ngit push -f git@git.dev.tencent.com:xugaoyi/xugaoyi.git master # åå¸å°coding\n\ncd - # éåå¼å§æå¨ç®å½\nrm -rf docs/.vuepress/dist\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\n> å ä¸ºææ³ç»ä¸¤ä¸ªå¹³å°ä¸ç»å®ä¸åçèªå®ä¹ååï¼å æ­¤æåå¼åå»ºäºcnameæä»¶ã\n\n3ãæèªå®ä¹ååçï¼ä¹å¯ä»¥å¨coding pagesç»å®èªå®ä¹ååï¼åådnsè§£æä¸­æ·»å cnameè®°å½æåcoding pagesçç«ç¹å°åå³å¯ãï¼æ²¡æèªå®ä¹ååçå¯å¿½ç¥ï¼åæ¶æèªå¨é¨ç½²èæ¬ä¸­çåå»ºcnameæä»¶çèæ¬å»æï¼\n\næåï¼ä½¿ç¨ç¾åº¦ç«é¿çæåè¯æ­ï¼åç°æåæåå¦ï¼åä½¿ç¨ç¾åº¦ç«é¿çé¾æ¥æäº¤åè½ï¼æé¾æ¥æäº¤ç»ç¾åº¦ï¼è¿ä¸æ®µæ¶é´å°±å¯è½å¨ç¾åº¦æç´¢ä¸­æç´¢å°å¦ã\n\n\n# å¦ä½ç¥éç¾åº¦ææ²¡ææ¶å½ï¼\n\nå¨ç¾åº¦æç´¢æ¡ä¸­ä½¿ç¨site:<é¾æ¥å°å>ï¼å¦ï¼\n\nsite:xugaoyi.com\n\n\n1\n\n\n\n# ç¸å³æç« \n\nãgithub actions å®æ¶è¿è¡ä»£ç ï¼æ¯å¤©å®æ¶ç¾åº¦é¾æ¥æ¨éã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ä½¿ç¨Gitalkå®ç°éæåå®¢æ åå°è¯è®ºç³»ç»",frontmatter:{title:"ä½¿ç¨Gitalkå®ç°éæåå®¢æ åå°è¯è®ºç³»ç»",date:"2019-12-25T14:27:01.000Z",permalink:"/pages/1da0bf9a988eafe5",categories:["ææ¯","åå®¢æ­å»º"],tags:[null],author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/100.%E5%85%B6%E4%BB%96/04.%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/02.%E4%BD%BF%E7%94%A8Gitalk%E5%AE%9E%E7%8E%B0%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2%E6%97%A0%E5%90%8E%E5%8F%B0%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F.html",relativePath:"100.å¶ä»/04.åå®¢æ­å»º/02.ä½¿ç¨Gitalkå®ç°éæåå®¢æ åå°è¯è®ºç³»ç».md",key:"v-f465e8f0",path:"/pages/1da0bf9a988eafe5/",headers:[{level:2,title:"åè¨",slug:"åè¨",normalizedTitle:"åè¨",charIndex:28},{level:2,title:"åå¤",slug:"åå¤",normalizedTitle:"åå¤",charIndex:109},{level:2,title:"å®ç°",slug:"å®ç°",normalizedTitle:"å®ç°",charIndex:10},{level:3,title:"å®è£",slug:"å®è£",normalizedTitle:"å®è£",charIndex:338},{level:3,title:"ä½¿ç¨",slug:"ä½¿ç¨",normalizedTitle:"ä½¿ç¨",charIndex:2},{level:3,title:"BUGä¿®å¤",slug:"bugä¿®å¤",normalizedTitle:"bugä¿®å¤",charIndex:1603}],excerpt:'<h1 id="ä½¿ç¨gitalkå®ç°éæåå®¢æ åå°è¯è®ºç³»ç»"><a class="header-anchor" href="#ä½¿ç¨gitalkå®ç°éæåå®¢æ åå°è¯è®ºç³»ç»">#</a> ä½¿ç¨Gitalkå®ç°éæåå®¢æ åå°è¯è®ºç³»ç»</h1>\n<h2 id="åè¨"><a class="header-anchor" href="#åè¨">#</a> åè¨</h2>\n<p>Gitalkï¼ä¸ä¸ªåºäº Github Issue å Preact å¼åçè¯è®ºæä»¶ã</p>\n<p>ä¸é¢æä»¬æ¥ç¨å®å¨vuepressæ­å»ºçåå®¢ä¸­æ­å»ºè¯è®ºåºå§</p>\n',headersStr:"åè¨ åå¤ å®ç° å®è£ ä½¿ç¨ BUGä¿®å¤",content:"# ä½¿ç¨Gitalkå®ç°éæåå®¢æ åå°è¯è®ºç³»ç»\n\n\n# åè¨\n\nGitalkï¼ä¸ä¸ªåºäº Github Issue å Preact å¼åçè¯è®ºæä»¶ã\n\nä¸é¢æä»¬æ¥ç¨å®å¨vuepressæ­å»ºçåå®¢ä¸­æ­å»ºè¯è®ºåºå§\n\n\n# åå¤\n\nä½¿ç¨ä¸ä¸ªæ°çä¸è¥¿é¦åå½ç¶æ¯è¦äºè§£å®\n\nGitalk demoï¼https://gitalk.github.io/\n\nGitalk githubï¼https://github.com/gitalk/gitalk\n\n\n# å®ç°\n\nå¦ä½å®ç°ï¼æå¥½çæ¹æ³æè®¤ä¸ºæ¯çå®æ¹ææ¡£ï¼è¿éæåªæ¯è®°å½ä¸ä¸å®ç°çæ­¥éª¤ã\n\nä½¿ç¨ä¸ä¸ªå«äººå·²ç»å¼åå¥½ç vuepress-plugin-comment æä»¶æ¥å¸®å©æä»¬æGitalkåºç¨å°vuepressæ­å»ºçéæåå®¢ã\n\n\n# å®è£\n\nnpm install --save vuepress-plugin-comment\n\n\n1\n\n\n\n# ä½¿ç¨\n\noptionsçéç½®åGitalkçéç½®ç¸å\n\nmodule.exports = {\n  plugins: [\n    [\n      'vuepress-plugin-comment',\n      {\n        choosen: 'gitalk', \n        options: {\n          clientID: 'GitHub Application Client ID',\n          clientSecret: 'GitHub Application Client Secret',\n          repo: 'GitHub repo',\n          owner: 'GitHub repo owner',\n          admin: ['GitHub repo owner and collaborators, only these guys can initialize github issues'],\n          distractionFreeMode: false \n        }\n      }\n    ]\n  ]\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\néè¦ GitHub Applicationï¼å¦ææ²¡æ ç¹å»è¿éç³è¯·ï¼Authorization callback URL å¡«åå½åä½¿ç¨æä»¶é¡µé¢çååã\n\n\n\nç³è¯·å®æå°±ä¼å¾ Client ID å Client Secretãç¶åæå¯¹åºåæ°å¡«åå°éç½®ä¸­ï¼ä¾ï¼\n\nmodule.exports = {\n  plugins: [\n    [\n      'vuepress-plugin-comment',\n      {\n        choosen: 'gitalk', \n        options: {\n          clientID: 'a6e*******4709b88b',\n          clientSecret: 'f0e***************beb8b2d54d7241',\n          repo: 'blog', // GitHub ä»åº\n          owner: 'xugaoyi', // GitHubä»åºææè\n          admin: ['xugaoyi'], // å¯¹ä»åºæåæéçäºº\n          distractionFreeMode: false \n        }\n      }\n    ]\n  ]\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\néç½®å¥½ä¹åéå¯é¡¹ç®å°±åç°é¡µé¢ä¸å¤äºä¸ä¸ªè¯è®ºåºï¼è¯´æè¯è®ºåè½å®ç°å¦ãä½è¿æ¯æä¸äºbugï¼ç»§ç»­å®åå®~\n\n\n# BUGä¿®å¤\n\nè¯è®ºåºä¸åå®¢æ ·å¼ä¸å¹é\n\nè§£å³åæ³ï¼æ°å¢å¨å±æ ·å¼æä»¶.vuepress/styles/index.stylï¼åå¥æ ·å¼\n\n#vuepress-plugin-comment\n  max-width $contentWidth\n  margin 0 auto\n  padding 2rem 2.5rem\n  @media (max-width: $MQNarrow)\n    padding 2rem\n  @media (max-width: $MQMobileNarrow)\n    padding 1.5rem\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nè¯è®ºåºåºç° Error: Validation Failed.\n\né®é¢åæï¼å½é¡µé¢ é¾æ¥è¿é¿ æ å­å¨ä¸­æé¾æ¥ï¼å¯¼è´æ´ä¸ªé¾æ¥å­ç¬¦ä¸²é¿åº¦è¶è¿50æ¶ï¼ä¼é æè¯·æ±issuesæ¥å£å¤±è´¥ï¼åºç°422ç¶æç ãï¼ä¸­æé¾æ¥ä¼èªå¨è½¬ç ï¼åå¾å¾é¿ï¼idåæ°é»è®¤åçæ¯é¾æ¥ï¼é¿åº¦ä¸è½è¶è¿50ï¼\n\nè§£å³åæ³ï¼æå¨è®¾ç½®idåå¼ï¼éå¶é¿åº¦ä¸è¶è¿50ã\n\n{\n choosen: 'gitalk', \n options: {\n   ...\n   id: \"<%- (window.location.origin + (frontmatter.to.path || window.location.pathname)).slice(-50) %>\", //  é¡µé¢çå¯ä¸æ è¯,é¿åº¦ä¸è½è¶è¿50\n   title: \"ãè¯è®ºã<%- document.title %>\", // GitHub issue çæ é¢\n   labels: [\"Gitalk\", \"Comment\"], // GitHub issue çæ ç­¾\n   body:\"<%- document.title %>ï¼<%- window.location.origin + (frontmatter.to.path || window.location.pathname) %>\" // GitHub issue çåå®¹\n }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n> è®¿é®åéæ¶ï¼å¦ $frontmatter æ windowç­ï¼è¯·ä½¿ç¨ EJS è¯­æ³ãå ä¸ºå¨éç½®ä¸­ä¸è½ä½¿ç¨åè°å½æ°ï¼ä¼è¢«vuepressè¿æ»¤ï¼å æ­¤ä½¿ç¨ EJS è¯­æ³ã ââæä»¶ä½èææ¡£è¯´æ\n\nåæ¢é¡µé¢åè¯è®ºåºåå®¹è¿æ¯ä¸ä¸ä¸ªé¡µé¢çè¯è®º\n\nè§£å³ï¼idå¨è·åpathæ¶ä½¿ç¨ frontmatter.to.pathï¼æä»¶åç½®äº ``frontmatter.fromãfrontmatter.to`ã\n\n{\n choosen: 'gitalk', \n options: {\n   ...\n   id: \"<%- (window.location.origin + (frontmatter.to.path || window.location.pathname)).slice(-50) %>\", //  é¡µé¢çå¯ä¸æ è¯,é¿åº¦ä¸è½è¶è¿50\n   title: \"ãè¯è®ºã<%- document.title %>\", // GitHub issue çæ é¢\n   labels: [\"Gitalk\", \"Comment\"], // GitHub issue çæ ç­¾\n   body:\"<%- document.title %>ï¼<%- window.location.origin + (frontmatter.to.path || window.location.pathname) %>\" // GitHub issue çåå®¹\n }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n",normalizedContent:"# ä½¿ç¨gitalkå®ç°éæåå®¢æ åå°è¯è®ºç³»ç»\n\n\n# åè¨\n\ngitalkï¼ä¸ä¸ªåºäº github issue å preact å¼åçè¯è®ºæä»¶ã\n\nä¸é¢æä»¬æ¥ç¨å®å¨vuepressæ­å»ºçåå®¢ä¸­æ­å»ºè¯è®ºåºå§\n\n\n# åå¤\n\nä½¿ç¨ä¸ä¸ªæ°çä¸è¥¿é¦åå½ç¶æ¯è¦äºè§£å®\n\ngitalk demoï¼https://gitalk.github.io/\n\ngitalk githubï¼https://github.com/gitalk/gitalk\n\n\n# å®ç°\n\nå¦ä½å®ç°ï¼æå¥½çæ¹æ³æè®¤ä¸ºæ¯çå®æ¹ææ¡£ï¼è¿éæåªæ¯è®°å½ä¸ä¸å®ç°çæ­¥éª¤ã\n\nä½¿ç¨ä¸ä¸ªå«äººå·²ç»å¼åå¥½ç vuepress-plugin-comment æä»¶æ¥å¸®å©æä»¬ægitalkåºç¨å°vuepressæ­å»ºçéæåå®¢ã\n\n\n# å®è£\n\nnpm install --save vuepress-plugin-comment\n\n\n1\n\n\n\n# ä½¿ç¨\n\noptionsçéç½®ågitalkçéç½®ç¸å\n\nmodule.exports = {\n  plugins: [\n    [\n      'vuepress-plugin-comment',\n      {\n        choosen: 'gitalk', \n        options: {\n          clientid: 'github application client id',\n          clientsecret: 'github application client secret',\n          repo: 'github repo',\n          owner: 'github repo owner',\n          admin: ['github repo owner and collaborators, only these guys can initialize github issues'],\n          distractionfreemode: false \n        }\n      }\n    ]\n  ]\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\néè¦ github applicationï¼å¦ææ²¡æ ç¹å»è¿éç³è¯·ï¼authorization callback url å¡«åå½åä½¿ç¨æä»¶é¡µé¢çååã\n\n\n\nç³è¯·å®æå°±ä¼å¾ client id å client secretãç¶åæå¯¹åºåæ°å¡«åå°éç½®ä¸­ï¼ä¾ï¼\n\nmodule.exports = {\n  plugins: [\n    [\n      'vuepress-plugin-comment',\n      {\n        choosen: 'gitalk', \n        options: {\n          clientid: 'a6e*******4709b88b',\n          clientsecret: 'f0e***************beb8b2d54d7241',\n          repo: 'blog', // github ä»åº\n          owner: 'xugaoyi', // githubä»åºææè\n          admin: ['xugaoyi'], // å¯¹ä»åºæåæéçäºº\n          distractionfreemode: false \n        }\n      }\n    ]\n  ]\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\néç½®å¥½ä¹åéå¯é¡¹ç®å°±åç°é¡µé¢ä¸å¤äºä¸ä¸ªè¯è®ºåºï¼è¯´æè¯è®ºåè½å®ç°å¦ãä½è¿æ¯æä¸äºbugï¼ç»§ç»­å®åå®~\n\n\n# bugä¿®å¤\n\nè¯è®ºåºä¸åå®¢æ ·å¼ä¸å¹é\n\nè§£å³åæ³ï¼æ°å¢å¨å±æ ·å¼æä»¶.vuepress/styles/index.stylï¼åå¥æ ·å¼\n\n#vuepress-plugin-comment\n  max-width $contentwidth\n  margin 0 auto\n  padding 2rem 2.5rem\n  @media (max-width: $mqnarrow)\n    padding 2rem\n  @media (max-width: $mqmobilenarrow)\n    padding 1.5rem\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nè¯è®ºåºåºç° error: validation failed.\n\né®é¢åæï¼å½é¡µé¢ é¾æ¥è¿é¿ æ å­å¨ä¸­æé¾æ¥ï¼å¯¼è´æ´ä¸ªé¾æ¥å­ç¬¦ä¸²é¿åº¦è¶è¿50æ¶ï¼ä¼é æè¯·æ±issuesæ¥å£å¤±è´¥ï¼åºç°422ç¶æç ãï¼ä¸­æé¾æ¥ä¼èªå¨è½¬ç ï¼åå¾å¾é¿ï¼idåæ°é»è®¤åçæ¯é¾æ¥ï¼é¿åº¦ä¸è½è¶è¿50ï¼\n\nè§£å³åæ³ï¼æå¨è®¾ç½®idåå¼ï¼éå¶é¿åº¦ä¸è¶è¿50ã\n\n{\n choosen: 'gitalk', \n options: {\n   ...\n   id: \"<%- (window.location.origin + (frontmatter.to.path || window.location.pathname)).slice(-50) %>\", //  é¡µé¢çå¯ä¸æ è¯,é¿åº¦ä¸è½è¶è¿50\n   title: \"ãè¯è®ºã<%- document.title %>\", // github issue çæ é¢\n   labels: [\"gitalk\", \"comment\"], // github issue çæ ç­¾\n   body:\"<%- document.title %>ï¼<%- window.location.origin + (frontmatter.to.path || window.location.pathname) %>\" // github issue çåå®¹\n }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n> è®¿é®åéæ¶ï¼å¦ $frontmatter æ windowç­ï¼è¯·ä½¿ç¨ ejs è¯­æ³ãå ä¸ºå¨éç½®ä¸­ä¸è½ä½¿ç¨åè°å½æ°ï¼ä¼è¢«vuepressè¿æ»¤ï¼å æ­¤ä½¿ç¨ ejs è¯­æ³ã ââæä»¶ä½èææ¡£è¯´æ\n\nåæ¢é¡µé¢åè¯è®ºåºåå®¹è¿æ¯ä¸ä¸ä¸ªé¡µé¢çè¯è®º\n\nè§£å³ï¼idå¨è·åpathæ¶ä½¿ç¨ frontmatter.to.pathï¼æä»¶åç½®äº ``frontmatter.fromãfrontmatter.to`ã\n\n{\n choosen: 'gitalk', \n options: {\n   ...\n   id: \"<%- (window.location.origin + (frontmatter.to.path || window.location.pathname)).slice(-50) %>\", //  é¡µé¢çå¯ä¸æ è¯,é¿åº¦ä¸è½è¶è¿50\n   title: \"ãè¯è®ºã<%- document.title %>\", // github issue çæ é¢\n   labels: [\"gitalk\", \"comment\"], // github issue çæ ç­¾\n   body:\"<%- document.title %>ï¼<%- window.location.origin + (frontmatter.to.path || window.location.pathname) %>\" // github issue çåå®¹\n }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"GitHub + jsDelivr + TinyPNG+ PicGo æé ç¨³å®å¿«éãé«æåè´¹å¾åº",frontmatter:{title:"GitHub + jsDelivr + TinyPNG+ PicGo æé ç¨³å®å¿«éãé«æåè´¹å¾åº",date:"2020-01-03T12:55:43.000Z",permalink:"/pages/a5f73af5185fdf0a",categories:["ææ¯","åå®¢æ­å»º"],tags:[null],author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/100.%E5%85%B6%E4%BB%96/04.%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/03.GitHub%20+%20jsDelivr%20+%20TinyPNG+%20PicGo%20%E6%89%93%E9%80%A0%E7%A8%B3%E5%AE%9A%E5%BF%AB%E9%80%9F%E3%80%81%E9%AB%98%E6%95%88%E5%85%8D%E8%B4%B9%E5%9B%BE%E5%BA%8A.html",relativePath:"100.å¶ä»/04.åå®¢æ­å»º/03.GitHub + jsDelivr + TinyPNG+ PicGo æé ç¨³å®å¿«éãé«æåè´¹å¾åº.md",key:"v-1a36efce",path:"/pages/a5f73af5185fdf0a/",headers:[{level:2,title:"åè¨",slug:"åè¨",normalizedTitle:"åè¨",charIndex:55},{level:2,title:"å¾åºæé ",slug:"å¾åºæé ",normalizedTitle:"å¾åºæé ",charIndex:590}],excerpt:'<h1 id="github-jsdelivr-tinypng-picgo-æé ç¨³å®å¿«éãé«æåè´¹å¾åº"><a class="header-anchor" href="#github-jsdelivr-tinypng-picgo-æé ç¨³å®å¿«éãé«æåè´¹å¾åº">#</a> GitHub + jsDelivr + TinyPNG+ PicGo æé ç¨³å®å¿«éãé«æåè´¹å¾åº</h1>\n<h2 id="åè¨"><a class="header-anchor" href="#åè¨">#</a> åè¨</h2>\n<p><strong>Qï¼ä¸ºä»ä¹è¦ä½¿ç¨å¾åºå¢ï¼ä»ä¹æ¯å¾åºï¼</strong></p>\n<p>Aï¼ååå®¢æç« æ¶ï¼å¾ççä¸ä¼ åå­æ¾æ¯ä¸ä¸ªé®é¢ï¼æçæåå¯è½ä¼æå¾çæ¾å°ååå®¢åä¸ä¸ªä»åºå½ä¸­ï¼ä½¿ç¨ç¸å¯¹è·¯å¾æ¥å¼ç¨ï¼è¿æ ·åæç»´æ¤èµ·æ¥ä¼æ¯è¾éº»ç¦ãè¿æçæåä¼å¨ä¸åçå¹³å°åå¸åä¸ç¯æç« ï¼è¿æ ·ä¸æ¥æ¯ä¸ªå¹³å°é½è¦ä¸ä¼ å¾çï¼ä¸ºäºè§£å³è¿äºé®é¢ï¼æ¯è¾æ¨èçåæ³æ¯æå¾çç»ä¸ä¸ä¼ å°ä¸ä¸ªå¨çº¿çç¬¬ä¸æ¹éæèµæºåºä¸­ï¼æä»¬æè¿ä¸ªèµæºåºç§°ä¸ºå¾åºï¼å¶è¿åä¸ä¸ªå¾ççURLï¼ä½¿ç¨<code>markdown+å¾çurl</code>çæ¹å¼åä½æç« ï¼ä¸æ¬¡ç¼åï¼å°å¤ä½¿ç¨~</p>\n',headersStr:"åè¨ å¾åºæé ",content:"# GitHub + jsDelivr + TinyPNG+ PicGo æé ç¨³å®å¿«éãé«æåè´¹å¾åº\n\n\n# åè¨\n\nQï¼ä¸ºä»ä¹è¦ä½¿ç¨å¾åºå¢ï¼ä»ä¹æ¯å¾åºï¼\n\nAï¼ååå®¢æç« æ¶ï¼å¾ççä¸ä¼ åå­æ¾æ¯ä¸ä¸ªé®é¢ï¼æçæåå¯è½ä¼æå¾çæ¾å°ååå®¢åä¸ä¸ªä»åºå½ä¸­ï¼ä½¿ç¨ç¸å¯¹è·¯å¾æ¥å¼ç¨ï¼è¿æ ·åæç»´æ¤èµ·æ¥ä¼æ¯è¾éº»ç¦ãè¿æçæåä¼å¨ä¸åçå¹³å°åå¸åä¸ç¯æç« ï¼è¿æ ·ä¸æ¥æ¯ä¸ªå¹³å°é½è¦ä¸ä¼ å¾çï¼ä¸ºäºè§£å³è¿äºé®é¢ï¼æ¯è¾æ¨èçåæ³æ¯æå¾çç»ä¸ä¸ä¼ å°ä¸ä¸ªå¨çº¿çç¬¬ä¸æ¹éæèµæºåºä¸­ï¼æä»¬æè¿ä¸ªèµæºåºç§°ä¸ºå¾åºï¼å¶è¿åä¸ä¸ªå¾ççURLï¼ä½¿ç¨markdown+å¾çurlçæ¹å¼åä½æç« ï¼ä¸æ¬¡ç¼åï¼å°å¤ä½¿ç¨~\n\næ´å¥½çéæ©...\n\nä»¥ä¸åå®¹æ¯æ¯è¾æ§çï¼ç°å¨æåç°ä¸ä¸ªæ´å¥½ç¨ï¼éç½®æ´æ¹ä¾¿çå¾åºå·¥å·ï¼https://picx.xpoet.cn/ ä½¿ç¨æ¹æ³çä¸ä¸ä»ç½ç«çä½¿ç¨æç¨å°±è¡ã æç±é£æ~~\n\n2021.07.04\n\nQï¼å¾åºçéæ©\n\nAï¼æ¨èä½¿ç¨GitHubä½ä¸ºå¾åºï¼ç¹ç¹æ¯åè´¹ãç¨³å®ï¼æä¸ä¸ªå°ç¼ºç¹æ¯å½åè®¿é®éåº¦æ¢ï¼ä¸è¿æ²¡å³ç³»ï¼å¯ä»¥ä½¿ç¨jsDelivråè´¹CDNå éã\n\nQï¼jsDelivræ¯ä»ä¹ï¼\n\nAï¼jsDelivræ¯å½å¤çä¸å®¶ä¼ç§çå¬å± CDN æå¡æä¾åï¼è¯¥å¹³å°æ¯é¦ä¸ªãæéä¸­å½å¤§éä¸æµ·å¤çåè´¹CDNæå¡ãï¼æ é¡»æå¿ä¸­å½é²ç«å¢é®é¢èå½±åä½¿ç¨ãå®ç½ï¼http://www.jsdelivr.com/\n\n\n# å¾åºæé \n\n 1. æ°å»ºGitHubä»åºï¼æ³¨æä»åºè¦è®¾ç½®æå¬å¼\n\n 2. åç§ å®æ¹ææ¡£ çæä¸ä¸ªtokenå¯é¥\n\n 3. å¨ è¿é ä¸è½½PicGoï¼å®è£å®æåæå¼ï¼å¾åºè®¾ç½® é GitHubå¾åºï¼å¹¶å¡«åç¸åºçä¿¡æ¯\n    \n    * ä»åºåï¼åé¢æ°å»ºçä»åºï¼æ ¼å¼ï¼<ç¨æ·å>/<ä»åºå>\n    * åæ¯åï¼å¡«åä¸»åæ¯masterå³å¯\n    * Tokenï¼åé¢çæçtokenå¯é¥\n    * å­å¨è·¯å¾ï¼æä½ èªå·±çéæ±å¡«å\n    * èªå®ä¹ååï¼å¾çä¸ä¼ åï¼PicGo ä¼æç§ èªå®ä¹åå+ä¸ä¼ çå¾çå çæ¹å¼çæè®¿é®é¾æ¥ï¼æ­¤å¤æä»¬å¡«åjsDelivrçCDNå éå°åï¼æ ¼å¼ï¼https://cdn.jsdelivr.net/gh/<ç¨æ·å>/<ä»åºå>\n\n\n\n 4. ä½¿ç¨https://tinypng.cn/åç¼©ä½ è¦ä¸ä¼ çå¾çï¼å¦å¾çå·²ç»å¾å°æä½ ææ´å¥½çåç¼©å·¥å·å¯çç¥è¿ä¸æ­¥ï¼\n 5. å¨PigGoçä¸ä¼ åºä¸ä¼ ä½ çå¾çï¼å°ç¸åä¸é®å¤å¶ååä¸ä¼ çå¾çURLï¼è³æ­¤ï¼ä½ å°±å¯ä»¥å¨ä½ çæç« å½ä¸­æå¿«çæå¥å¾çå¦~ï¼ æ´å¤åè½èªå·±å»æ¢ç´¢å§~~\n\n",normalizedContent:"# github + jsdelivr + tinypng+ picgo æé ç¨³å®å¿«éãé«æåè´¹å¾åº\n\n\n# åè¨\n\nqï¼ä¸ºä»ä¹è¦ä½¿ç¨å¾åºå¢ï¼ä»ä¹æ¯å¾åºï¼\n\naï¼ååå®¢æç« æ¶ï¼å¾ççä¸ä¼ åå­æ¾æ¯ä¸ä¸ªé®é¢ï¼æçæåå¯è½ä¼æå¾çæ¾å°ååå®¢åä¸ä¸ªä»åºå½ä¸­ï¼ä½¿ç¨ç¸å¯¹è·¯å¾æ¥å¼ç¨ï¼è¿æ ·åæç»´æ¤èµ·æ¥ä¼æ¯è¾éº»ç¦ãè¿æçæåä¼å¨ä¸åçå¹³å°åå¸åä¸ç¯æç« ï¼è¿æ ·ä¸æ¥æ¯ä¸ªå¹³å°é½è¦ä¸ä¼ å¾çï¼ä¸ºäºè§£å³è¿äºé®é¢ï¼æ¯è¾æ¨èçåæ³æ¯æå¾çç»ä¸ä¸ä¼ å°ä¸ä¸ªå¨çº¿çç¬¬ä¸æ¹éæèµæºåºä¸­ï¼æä»¬æè¿ä¸ªèµæºåºç§°ä¸ºå¾åºï¼å¶è¿åä¸ä¸ªå¾ççurlï¼ä½¿ç¨markdown+å¾çurlçæ¹å¼åä½æç« ï¼ä¸æ¬¡ç¼åï¼å°å¤ä½¿ç¨~\n\næ´å¥½çéæ©...\n\nä»¥ä¸åå®¹æ¯æ¯è¾æ§çï¼ç°å¨æåç°ä¸ä¸ªæ´å¥½ç¨ï¼éç½®æ´æ¹ä¾¿çå¾åºå·¥å·ï¼https://picx.xpoet.cn/ ä½¿ç¨æ¹æ³çä¸ä¸ä»ç½ç«çä½¿ç¨æç¨å°±è¡ã æç±é£æ~~\n\n2021.07.04\n\nqï¼å¾åºçéæ©\n\naï¼æ¨èä½¿ç¨githubä½ä¸ºå¾åºï¼ç¹ç¹æ¯åè´¹ãç¨³å®ï¼æä¸ä¸ªå°ç¼ºç¹æ¯å½åè®¿é®éåº¦æ¢ï¼ä¸è¿æ²¡å³ç³»ï¼å¯ä»¥ä½¿ç¨jsdelivråè´¹cdnå éã\n\nqï¼jsdelivræ¯ä»ä¹ï¼\n\naï¼jsdelivræ¯å½å¤çä¸å®¶ä¼ç§çå¬å± cdn æå¡æä¾åï¼è¯¥å¹³å°æ¯é¦ä¸ªãæéä¸­å½å¤§éä¸æµ·å¤çåè´¹cdnæå¡ãï¼æ é¡»æå¿ä¸­å½é²ç«å¢é®é¢èå½±åä½¿ç¨ãå®ç½ï¼http://www.jsdelivr.com/\n\n\n# å¾åºæé \n\n 1. æ°å»ºgithubä»åºï¼æ³¨æä»åºè¦è®¾ç½®æå¬å¼\n\n 2. åç§ å®æ¹ææ¡£ çæä¸ä¸ªtokenå¯é¥\n\n 3. å¨ è¿é ä¸è½½picgoï¼å®è£å®æåæå¼ï¼å¾åºè®¾ç½® é githubå¾åºï¼å¹¶å¡«åç¸åºçä¿¡æ¯\n    \n    * ä»åºåï¼åé¢æ°å»ºçä»åºï¼æ ¼å¼ï¼<ç¨æ·å>/<ä»åºå>\n    * åæ¯åï¼å¡«åä¸»åæ¯masterå³å¯\n    * tokenï¼åé¢çæçtokenå¯é¥\n    * å­å¨è·¯å¾ï¼æä½ èªå·±çéæ±å¡«å\n    * èªå®ä¹ååï¼å¾çä¸ä¼ åï¼picgo ä¼æç§ èªå®ä¹åå+ä¸ä¼ çå¾çå çæ¹å¼çæè®¿é®é¾æ¥ï¼æ­¤å¤æä»¬å¡«åjsdelivrçcdnå éå°åï¼æ ¼å¼ï¼https://cdn.jsdelivr.net/gh/<ç¨æ·å>/<ä»åºå>\n\n\n\n 4. ä½¿ç¨https://tinypng.cn/åç¼©ä½ è¦ä¸ä¼ çå¾çï¼å¦å¾çå·²ç»å¾å°æä½ ææ´å¥½çåç¼©å·¥å·å¯çç¥è¿ä¸æ­¥ï¼\n 5. å¨piggoçä¸ä¼ åºä¸ä¼ ä½ çå¾çï¼å°ç¸åä¸é®å¤å¶ååä¸ä¼ çå¾çurlï¼è³æ­¤ï¼ä½ å°±å¯ä»¥å¨ä½ çæç« å½ä¸­æå¿«çæå¥å¾çå¦~ï¼ æ´å¤åè½èªå·±å»æ¢ç´¢å§~~\n\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"vdoingä¸»é¢ææå¾",frontmatter:{title:"vdoingä¸»é¢ææå¾",date:"2020-04-08T11:27:22.000Z",permalink:"/pages/d557b9a89a215d2e",article:!1,author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/100.%E5%85%B6%E4%BB%96/04.%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/10.vdoing%E4%B8%BB%E9%A2%98%E6%95%88%E6%9E%9C%E5%9B%BE.html",relativePath:"100.å¶ä»/04.åå®¢æ­å»º/10.vdoingä¸»é¢ææå¾.md",key:"v-1426c78e",path:"/pages/d557b9a89a215d2e/",headers:[{level:2,title:"PCç«¯",slug:"pcç«¯",normalizedTitle:"pcç«¯",charIndex:18},{level:2,title:"é¦é¡µä¸ªæ§åå¤§å¾",slug:"é¦é¡µä¸ªæ§åå¤§å¾",normalizedTitle:"é¦é¡µä¸ªæ§åå¤§å¾",charIndex:53},{level:2,title:"æ·±è²æ¨¡å¼åéè¯»æ¨¡å¼",slug:"æ·±è²æ¨¡å¼åéè¯»æ¨¡å¼",normalizedTitle:"æ·±è²æ¨¡å¼åéè¯»æ¨¡å¼",charIndex:76},{level:2,title:"ç§»å¨ç«¯",slug:"ç§»å¨ç«¯",normalizedTitle:"ç§»å¨ç«¯",charIndex:105}],headersStr:"PCç«¯ é¦é¡µä¸ªæ§åå¤§å¾ æ·±è²æ¨¡å¼åéè¯»æ¨¡å¼ ç§»å¨ç«¯",content:"# vdoingä¸»é¢ææå¾\n\n\n# PCç«¯\n\n\né¦é¡µ & ç®å½é¡µâ³\n\næç« è¯¦æé¡µ & æ¶é´è½´é¡µâ³\n\n\n# é¦é¡µä¸ªæ§åå¤§å¾\n\n\né¦é¡µä¸ªæ§åå¤§å¾â³\n\n\n# æ·±è²æ¨¡å¼åéè¯»æ¨¡å¼\n\n\næ·±è²æ¨¡å¼â³\n\néè¯»æ¨¡å¼â³\n\n\n# ç§»å¨ç«¯\n\n\nç§»å¨ç«¯ææâ³",normalizedContent:"# vdoingä¸»é¢ææå¾\n\n\n# pcç«¯\n\n\né¦é¡µ & ç®å½é¡µâ³\n\næç« è¯¦æé¡µ & æ¶é´è½´é¡µâ³\n\n\n# é¦é¡µä¸ªæ§åå¤§å¾\n\n\né¦é¡µä¸ªæ§åå¤§å¾â³\n\n\n# æ·±è²æ¨¡å¼åéè¯»æ¨¡å¼\n\n\næ·±è²æ¨¡å¼â³\n\néè¯»æ¨¡å¼â³\n\n\n# ç§»å¨ç«¯\n\n\nç§»å¨ç«¯ææâ³",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/f1cf70/"},regularPath:"/15.%E5%89%8D%E7%AB%AF/05.HTML/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"15.åç«¯/05.HTML/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-8b61ee12",path:"/pages/f1cf70/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/b0cbfe/"},regularPath:"/15.%E5%89%8D%E7%AB%AF/10.JavaScript/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"15.åç«¯/10.JavaScript/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-01eb52f2",path:"/pages/b0cbfe/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/1b9d03/"},regularPath:"/15.%E5%89%8D%E7%AB%AF/15.CSS/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"15.åç«¯/15.CSS/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-0832524d",path:"/pages/1b9d03/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"nodejséå½è¯»åæææä»¶",frontmatter:{title:"nodejséå½è¯»åæææä»¶",date:"2019-12-26T15:57:32.000Z",permalink:"/pages/117708e0af7f0bd9",categories:["ææ¯","Nodejs"],tags:[null],author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/100.%E5%85%B6%E4%BB%96/03.Nodejs/01.nodejs%E9%80%92%E5%BD%92%E8%AF%BB%E5%8F%96%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6.html",relativePath:"100.å¶ä»/03.Nodejs/01.nodejséå½è¯»åæææä»¶.md",key:"v-3e241928",path:"/pages/117708e0af7f0bd9/",headersStr:null,content:"# nodejséå½è¯»åæææä»¶\n\n\nvar fs = require('fs');\nvar path = require('path');\n \nfunction readFileList(dir, filesList = []) {\n    const files = fs.readdirSync(dir);\n    console.log(files);\n    files.forEach((item, index) => {\n        var fullPath = path.join(dir, item);\n        const stat = fs.statSync(fullPath);\n        if (stat.isDirectory()) {      \n            readFileList(path.join(dir, item), filesList);  //éå½è¯»åæä»¶\n        } else {                \n            filesList.push(fullPath);                     \n        }        \n    });\n    return filesList;\n}\n \nvar filesList = [];\nreadFileList(__dirname,filesList);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n",normalizedContent:"# nodejséå½è¯»åæææä»¶\n\n\nvar fs = require('fs');\nvar path = require('path');\n \nfunction readfilelist(dir, fileslist = []) {\n    const files = fs.readdirsync(dir);\n    console.log(files);\n    files.foreach((item, index) => {\n        var fullpath = path.join(dir, item);\n        const stat = fs.statsync(fullpath);\n        if (stat.isdirectory()) {      \n            readfilelist(path.join(dir, item), fileslist);  //éå½è¯»åæä»¶\n        } else {                \n            fileslist.push(fullpath);                     \n        }        \n    });\n    return fileslist;\n}\n \nvar fileslist = [];\nreadfilelist(__dirname,fileslist);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/f94942/"},regularPath:"/15.%E5%89%8D%E7%AB%AF/20.ES6/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"15.åç«¯/20.ES6/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-85694126",path:"/pages/f94942/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/3a3093/"},regularPath:"/15.%E5%89%8D%E7%AB%AF/30.Webpack/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"15.åç«¯/30.Webpack/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-7db0be6d",path:"/pages/3a3093/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/6397c2/"},regularPath:"/15.%E5%89%8D%E7%AB%AF/25.Nodejs/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"15.åç«¯/25.Nodejs/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-0033648a",path:"/pages/6397c2/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/45f613/"},regularPath:"/15.%E5%89%8D%E7%AB%AF/35.Vue/05.Vue%20Router/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"15.åç«¯/35.Vue/05.Vue Router/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-315c4010",path:"/pages/45f613/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ãES6 æç¨ãç¬è®°",frontmatter:{pageComponent:{name:"Catalogue",data:{path:"ãES6 æç¨ãç¬è®°",imgUrl:"https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200112160453.png",description:"æ¬ç« åå®¹ä¸ºåä¸»å¨åæç¨åºç¡ä¸æ·»å å­¦ä¹ ç¬è®°ï¼æç¨çæå½åä½èææãæ¥æºï¼<a href='https://es6.ruanyifeng.com/' target='_blank'>ES6æç¨</a>"}},title:"ãES6 æç¨ãç¬è®°",date:"2020-01-12T15:49:22.000Z",permalink:"/note/es6/",article:!1,comment:!1,editLink:!1,author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/15.%E5%89%8D%E7%AB%AF/40.%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/10.%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0.html",relativePath:"15.åç«¯/40.å­¦ä¹ ç¬è®°/10.ãES6 æç¨ãç¬è®°.md",key:"v-50864176",path:"/note/es6/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/8b11e8/"},regularPath:"/15.%E5%89%8D%E7%AB%AF/35.Vue/10.Vuex/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"15.åç«¯/35.Vue/10.Vuex/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-520c0bed",path:"/pages/8b11e8/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/be47c5/"},regularPath:"/25.%E8%BF%90%E7%BB%B4/05.Linux/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"25.è¿ç»´/05.Linux/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-7284126c",path:"/pages/be47c5/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/1cbc1f/"},regularPath:"/20.%E6%9E%B6%E6%9E%84/05.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"20.æ¶æ/05.è®¾è®¡æ¨¡å¼/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-462b4ed7",path:"/pages/1cbc1f/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/48ee28/"},regularPath:"/25.%E8%BF%90%E7%BB%B4/10.Shell%E8%84%9A%E6%9C%AC/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"25.è¿ç»´/10.Shellèæ¬/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-64279124",path:"/pages/48ee28/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/c0a158/"},regularPath:"/25.%E8%BF%90%E7%BB%B4/40.Tomcat/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"25.è¿ç»´/40.Tomcat/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-10cc5422",path:"/pages/c0a158/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/22279f/"},regularPath:"/25.%E8%BF%90%E7%BB%B4/45.Nginx/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"25.è¿ç»´/45.Nginx/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-61d376a8",path:"/pages/22279f/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Docker åçº§ç¯",frontmatter:{title:"Docker åçº§ç¯",date:"2022-02-03T00:03:52.000Z",permalink:"/pages/261b24/",categories:["åç«¯","Docker"],tags:[null]},regularPath:"/25.%E8%BF%90%E7%BB%B4/50.Docker/01.Docker%20%E5%88%9D%E7%BA%A7%E7%AF%87.html",relativePath:"25.è¿ç»´/50.Docker/01.Docker åçº§ç¯.md",key:"v-529de428",path:"/pages/261b24/",headers:[{level:2,title:"Dockeråä¼ ç»èæåæ¹å¼å¯¹æ¯",slug:"dockeråä¼ ç»èæåæ¹å¼å¯¹æ¯",normalizedTitle:"dockeråä¼ ç»èæåæ¹å¼å¯¹æ¯",charIndex:236},{level:2,title:"éå",slug:"éå",normalizedTitle:"éå",charIndex:227},{level:2,title:"å®¹å¨",slug:"å®¹å¨",normalizedTitle:"å®¹å¨",charIndex:162},{level:2,title:"ä»åº",slug:"ä»åº",normalizedTitle:"ä»åº",charIndex:229},{level:3,title:"Docker Registry å¬å¼æå¡",slug:"docker-registry-å¬å¼æå¡",normalizedTitle:"docker registry å¬å¼æå¡",charIndex:2190},{level:3,title:"ç§æ Docker Registry",slug:"ç§æ-docker-registry",normalizedTitle:"ç§æ docker registry",charIndex:2526},{level:2,title:"åºå±åç",slug:"åºå±åç",normalizedTitle:"åºå±åç",charIndex:2747},{level:2,title:"åå¤å·¥ä½",slug:"åå¤å·¥ä½",normalizedTitle:"åå¤å·¥ä½",charIndex:3377},{level:3,title:"ç³»ç»è¦æ±",slug:"ç³»ç»è¦æ±",normalizedTitle:"ç³»ç»è¦æ±",charIndex:3386},{level:3,title:"å¸è½½æ§çæ¬",slug:"å¸è½½æ§çæ¬",normalizedTitle:"å¸è½½æ§çæ¬",charIndex:3513},{level:2,title:"ä½¿ç¨ yum å®è£",slug:"ä½¿ç¨-yum-å®è£",normalizedTitle:"ä½¿ç¨ yum å®è£",charIndex:3961},{level:2,title:"å®è£ Docker",slug:"å®è£-docker",normalizedTitle:"å®è£ docker",charIndex:4428},{level:2,title:"CentOS8 é¢å¤è®¾ç½®",slug:"centos8-é¢å¤è®¾ç½®",normalizedTitle:"centos8 é¢å¤è®¾ç½®",charIndex:4534},{level:2,title:"å¯å¨ Docker",slug:"å¯å¨-docker",normalizedTitle:"å¯å¨ docker",charIndex:4832},{level:2,title:"å»ºç« docker ç¨æ·ç»",slug:"å»ºç«-docker-ç¨æ·ç»",normalizedTitle:"å»ºç« docker ç¨æ·ç»",charIndex:4915},{level:2,title:"æµè¯ Docker æ¯å¦å®è£æ­£ç¡®",slug:"æµè¯-docker-æ¯å¦å®è£æ­£ç¡®",normalizedTitle:"æµè¯ docker æ¯å¦å®è£æ­£ç¡®",charIndex:5206},{level:2,title:"éåå éå¨",slug:"éåå éå¨",normalizedTitle:"éåå éå¨",charIndex:6417},{level:3,title:"CentOS 7+",slug:"centos-7",normalizedTitle:"centos 7+",charIndex:6707},{level:2,title:"æ·»å åæ ¸åæ°",slug:"æ·»å åæ ¸åæ°",normalizedTitle:"æ·»å åæ ¸åæ°",charIndex:7648},{level:2,title:"è·åéå",slug:"è·åéå",normalizedTitle:"è·åéå",charIndex:7954},{level:2,title:"ååºéå",slug:"ååºéå",normalizedTitle:"ååºéå",charIndex:9466},{level:3,title:"éåä½ç§¯",slug:"éåä½ç§¯",normalizedTitle:"éåä½ç§¯",charIndex:10281},{level:3,title:"èæ¬éå",slug:"èæ¬éå",normalizedTitle:"èæ¬éå",charIndex:11286},{level:3,title:"ä¸­é´å±éå",slug:"ä¸­é´å±éå",normalizedTitle:"ä¸­é´å±éå",charIndex:11509},{level:3,title:"ååºé¨åéå",slug:"ååºé¨åéå",normalizedTitle:"ååºé¨åéå",charIndex:11892},{level:3,title:"å¶ä»ç¨æ³",slug:"å¶ä»ç¨æ³",normalizedTitle:"å¶ä»ç¨æ³",charIndex:13078},{level:2,title:"å é¤æ¬å°éå",slug:"å é¤æ¬å°éå",normalizedTitle:"å é¤æ¬å°éå",charIndex:13578},{level:3,title:"ç¨ IDãéååãæè¦å é¤éå",slug:"ç¨-idãéååãæè¦å é¤éå",normalizedTitle:"ç¨ idãéååãæè¦å é¤éå",charIndex:13728},{level:3,title:"ç¨ docker image ls å½ä»¤æ¥éå",slug:"ç¨-docker-image-ls-å½ä»¤æ¥éå",normalizedTitle:"ç¨ docker image ls å½ä»¤æ¥éå",charIndex:13926},{level:2,title:"æäº¤æ¬å°éå",slug:"æäº¤æ¬å°éå",normalizedTitle:"æäº¤æ¬å°éå",charIndex:14126},{level:3,title:"æç¨ docker commit",slug:"æç¨-docker-commit",normalizedTitle:"æç¨ docker commit",charIndex:15448},{level:2,title:"å¯å¨ï¼docker runï¼",slug:"å¯å¨-docker-run",normalizedTitle:"å¯å¨ï¼docker runï¼",charIndex:15792},{level:2,title:"å®æ¤æè¿è¡ï¼-dï¼",slug:"å®æ¤æè¿è¡-d",normalizedTitle:"å®æ¤æè¿è¡ï¼-dï¼",charIndex:15928},{level:2,title:"ç»æ­¢ï¼docker stopï¼",slug:"ç»æ­¢-docker-stop",normalizedTitle:"ç»æ­¢ï¼docker stopï¼",charIndex:16818},{level:2,title:"è¿å¥å®¹å¨",slug:"è¿å¥å®¹å¨",normalizedTitle:"è¿å¥å®¹å¨",charIndex:17073},{level:3,title:"attach å½ä»¤",slug:"attach-å½ä»¤",normalizedTitle:"attach å½ä»¤",charIndex:17106},{level:3,title:"exec å½ä»¤",slug:"exec-å½ä»¤",normalizedTitle:"exec å½ä»¤",charIndex:17124},{level:2,title:"å¯¼åºåå¯¼å¥",slug:"å¯¼åºåå¯¼å¥",normalizedTitle:"å¯¼åºåå¯¼å¥",charIndex:18413},{level:3,title:"å¯¼åºå®¹å¨",slug:"å¯¼åºå®¹å¨",normalizedTitle:"å¯¼åºå®¹å¨",charIndex:18423},{level:3,title:"å¯¼å¥å®¹å¨å¿«ç§",slug:"å¯¼å¥å®¹å¨å¿«ç§",normalizedTitle:"å¯¼å¥å®¹å¨å¿«ç§",charIndex:18817},{level:3,title:"å é¤",slug:"å é¤",normalizedTitle:"å é¤",charIndex:984},{level:2,title:"å¸®å©å½ä»¤",slug:"å¸®å©å½ä»¤",normalizedTitle:"å¸®å©å½ä»¤",charIndex:19693},{level:2,title:"éåå½ä»¤",slug:"éåå½ä»¤",normalizedTitle:"éåå½ä»¤",charIndex:19822},{level:2,title:"å®¹å¨å½ä»¤",slug:"å®¹å¨å½ä»¤",normalizedTitle:"å®¹å¨å½ä»¤",charIndex:20762},{level:2,title:"å¸¸ç¨çå¶ä»å½ä»¤",slug:"å¸¸ç¨çå¶ä»å½ä»¤",normalizedTitle:"å¸¸ç¨çå¶ä»å½ä»¤",charIndex:22738}],headersStr:"Dockeråä¼ ç»èæåæ¹å¼å¯¹æ¯ éå å®¹å¨ ä»åº Docker Registry å¬å¼æå¡ ç§æ Docker Registry åºå±åç åå¤å·¥ä½ ç³»ç»è¦æ± å¸è½½æ§çæ¬ ä½¿ç¨ yum å®è£ å®è£ Docker CentOS8 é¢å¤è®¾ç½® å¯å¨ Docker å»ºç« docker ç¨æ·ç» æµè¯ Docker æ¯å¦å®è£æ­£ç¡® éåå éå¨ CentOS 7+ æ·»å åæ ¸åæ° è·åéå ååºéå éåä½ç§¯ èæ¬éå ä¸­é´å±éå ååºé¨åéå å¶ä»ç¨æ³ å é¤æ¬å°éå ç¨ IDãéååãæè¦å é¤éå ç¨ docker image ls å½ä»¤æ¥éå æäº¤æ¬å°éå æç¨ docker commit å¯å¨ï¼docker runï¼ å®æ¤æè¿è¡ï¼-dï¼ ç»æ­¢ï¼docker stopï¼ è¿å¥å®¹å¨ attach å½ä»¤ exec å½ä»¤ å¯¼åºåå¯¼å¥ å¯¼åºå®¹å¨ å¯¼å¥å®¹å¨å¿«ç§ å é¤ å¸®å©å½ä»¤ éåå½ä»¤ å®¹å¨å½ä»¤ å¸¸ç¨çå¶ä»å½ä»¤",content:'# Docker ç®ä»\n\nDocker ä½¿ç¨ Google å¬å¸æ¨åºç Go è¯­è¨ è¿è¡å¼åå®ç°ï¼åºäº Linux åæ ¸ç cgroupï¼namespaceï¼ä»¥å OverlayFS ç±»ç Union FS ç­ææ¯ï¼å¯¹è¿ç¨è¿è¡å°è£éç¦»ï¼å±äº æä½ç³»ç»å±é¢çèæåææ¯ãç±äºéç¦»çè¿ç¨ç¬ç«äºå®¿ä¸»åå¶å®çéç¦»çè¿ç¨ï¼å æ­¤ä¹ç§°å¶ä¸ºå®¹å¨ã\n\n\n\n * Bç«çç¥Dockerè§é¢æç¨\n\n * Dockerå®ç½\n\n * Dockerå®æ¹ææ¡£\n\n * Dockerå®æ¹éåä»åº\n\n\n# Dockeråä¼ ç»èæåæ¹å¼å¯¹æ¯\n\nä¼ ç»èææºææ¯æ¯èæåºä¸å¥ç¡¬ä»¶åï¼å¨å¶ä¸è¿è¡ä¸ä¸ªå®æ´æä½ç³»ç»ï¼å¨è¯¥ç³»ç»ä¸åè¿è¡æéåºç¨è¿ç¨ï¼èå®¹å¨åçåºç¨è¿ç¨ç´æ¥è¿è¡äºå®¿ä¸»çåæ ¸ï¼å®¹å¨åæ²¡æèªå·±çåæ ¸ï¼èä¸ä¹æ²¡æè¿è¡ç¡¬ä»¶èæãå æ­¤å®¹å¨è¦æ¯ä¼ ç»èææºæ´ä¸ºè½»ä¾¿ã\n\nä¸é¢çå¾çæ¯è¾äº Docker åä¼ ç»èæåæ¹å¼çä¸åä¹å¤ã\n\n\n\n\n\nå¯¹æ¯æ»ç»\n\nç¹æ§      å®¹å¨          èææº\nå¯å¨      ç§çº§          åéçº§\nç¡¬çä½¿ç¨    ä¸è¬ä¸º MB      ä¸è¬ä¸º GB\næ§è½      æ¥è¿åç        å¼±äº\nç³»ç»æ¯æé   åæºæ¯æä¸åä¸ªå®¹å¨   ä¸è¬å åä¸ª\n\n\n# Dockeråºæ¬æ¦å¿µ\n\nDocker åæ¬ä¸ä¸ªåºæ¬æ¦å¿µ\n\n * éåï¼Imageï¼\n * å®¹å¨ï¼Containerï¼\n * ä»åºï¼Repositoryï¼\n\n\n# éå\n\næä»¬é½ç¥éï¼æä½ç³»ç»åä¸º åæ ¸ å ç¨æ·ç©ºé´ãå¯¹äº Linux èè¨ï¼åæ ¸å¯å¨åï¼ä¼æè½½ root æä»¶ç³»ç»ä¸ºå¶æä¾ç¨æ·ç©ºé´æ¯æãè Docker éåï¼Imageï¼ï¼å°±ç¸å½äºæ¯ä¸ä¸ª root æä»¶ç³»ç»ã\n\nDocker éå æ¯ä¸ä¸ªç¹æ®çæä»¶ç³»ç»ï¼é¤äºæä¾å®¹å¨è¿è¡æ¶æéçç¨åºãåºãèµæºãéç½®ç­æä»¶å¤ï¼è¿åå«äºä¸äºä¸ºè¿è¡æ¶åå¤çä¸äºéç½®åæ°ï¼å¦å¿åå·ãç¯å¢åéãç¨æ·ç­ï¼ãéå ä¸åå« ä»»ä½å¨ææ°æ®ï¼å¶åå®¹å¨æå»ºä¹åä¹ä¸ä¼è¢«æ¹åã\n\nåå±å­å¨\n\nå ä¸ºéååå«æä½ç³»ç»å®æ´ç root æä»¶ç³»ç»ï¼å¶ä½ç§¯å¾å¾æ¯åºå¤§çï¼å æ­¤å¨ Docker è®¾è®¡æ¶ï¼å°±ååå©ç¨ Union FS çææ¯ï¼å°å¶è®¾è®¡ä¸ºåå±å­å¨çæ¶æã\n\néåæå»ºæ¶ï¼ä¼ä¸å±å±æå»ºï¼åä¸å±æ¯åä¸å±çåºç¡ãæ¯ä¸å±æå»ºå®å°±ä¸ä¼ååçæ¹åï¼åä¸å±ä¸çä»»ä½æ¹ååªåçå¨èªå·±è¿ä¸å±ãæ¯å¦ï¼å é¤åä¸å±æä»¶çæä½ï¼å®éä¸æ¯ççå é¤åä¸å±çæä»¶ï¼èæ¯ä»å¨å½åå±æ è®°ä¸ºè¯¥æä»¶å·²å é¤ãå¨æç»å®¹å¨è¿è¡çæ¶åï¼è½ç¶ä¸ä¼çå°è¿ä¸ªæä»¶ï¼ä½æ¯å®éä¸è¯¥æä»¶ä¼ä¸ç´è·ééåãå æ­¤ï¼å¨æå»ºéåçæ¶åï¼éè¦é¢å¤å°å¿ï¼æ¯ä¸å±å°½éåªåå«è¯¥å±éè¦æ·»å çä¸è¥¿ï¼ä»»ä½é¢å¤çä¸è¥¿åºè¯¥å¨è¯¥å±æå»ºç»æåæ¸çæã\n\nåå±å­å¨çç¹å¾è¿ä½¿å¾éåçå¤ç¨ãå®å¶åçæ´ä¸ºå®¹æãæ¯å¦å¯ä»¥ç¨ä¹åæå»ºå¥½çéåä½ä¸ºåºç¡å±ï¼ç¶åè¿ä¸æ­¥æ·»å æ°çå±ï¼æå»ºæ°çéåã\n\n\n# å®¹å¨\n\néåï¼Imageï¼åå®¹å¨ï¼Containerï¼çå³ç³»ï¼å°±åæ¯é¢åå¯¹è±¡ç¨åºè®¾è®¡ä¸­ç ç±» å å®ä¾ ä¸æ ·ï¼éåæ¯éæçå®ä¹ï¼å®¹å¨æ¯éåè¿è¡æ¶çå®ä½ãå®¹å¨å¯ä»¥è¢«åå»ºãå¯å¨ãåæ­¢ãå é¤ãæåç­ã\n\nå®¹å¨çå®è´¨æ¯è¿ç¨ï¼ä½ä¸ç´æ¥å¨å®¿ä¸»æ§è¡çè¿ç¨ä¸åï¼å®¹å¨è¿ç¨è¿è¡äºå±äºèªå·±çç¬ç«ç å½åç©ºé´ãå æ­¤å®¹å¨å¯ä»¥æ¥æèªå·±ç root æä»¶ç³»ç»ãèªå·±çç½ç»éç½®ãèªå·±çè¿ç¨ç©ºé´ï¼çè³èªå·±çç¨æ· ID ç©ºé´ã\n\nå®¹å¨ä¹éç¨åå±å­å¨ãæ¯ä¸ä¸ªå®¹å¨è¿è¡æ¶ï¼æ¯ä»¥éåä¸ºåºç¡å±ï¼å¨å¶ä¸åå»ºä¸ä¸ªå½åå®¹å¨çå­å¨å±ï¼æä»¬å¯ä»¥ç§°è¿ä¸ªä¸ºå®¹å¨è¿è¡æ¶è¯»åèåå¤çå­å¨å±ä¸º å®¹å¨å­å¨å±ã\n\nå®¹å¨å­å¨å±ççå­å¨æåå®¹å¨ä¸æ ·ï¼å®¹å¨æ¶äº¡æ¶ï¼å®¹å¨å­å¨å±ä¹éä¹æ¶äº¡ãå æ­¤ï¼ä»»ä½ä¿å­äºå®¹å¨å­å¨å±çä¿¡æ¯é½ä¼éå®¹å¨å é¤èä¸¢å¤±ã\n\næç§ Docker æä½³å®è·µçè¦æ±ï¼å®¹å¨ä¸åºè¯¥åå¶å­å¨å±ååå¥ä»»ä½æ°æ®ï¼å®¹å¨å­å¨å±è¦ä¿ææ ç¶æåãææçæä»¶åå¥æä½ï¼é½åºè¯¥ä½¿ç¨ æ°æ®å·ï¼Volumeï¼ãæè ç»å®å®¿ä¸»ç®å½ï¼å¨è¿äºä½ç½®çè¯»åä¼è·³è¿å®¹å¨å­å¨å±ï¼ç´æ¥å¯¹å®¿ä¸»ï¼æç½ç»å­å¨ï¼åçè¯»åï¼å¶æ§è½åç¨³å®æ§æ´é«ã\n\næ°æ®å·ççå­å¨æç¬ç«äºå®¹å¨ï¼å®¹å¨æ¶äº¡ï¼æ°æ®å·ä¸ä¼æ¶äº¡ãå æ­¤ï¼ä½¿ç¨æ°æ®å·åï¼å®¹å¨å é¤æèéæ°è¿è¡ä¹åï¼æ°æ®å´ä¸ä¼ä¸¢å¤±ã\n\n\n# ä»åº\n\nä¸ä¸ª Docker Registry ä¸­å¯ä»¥åå«å¤ä¸ª ä»åºï¼Repositoryï¼ï¼æ¯ä¸ªä»åºå¯ä»¥åå«å¤ä¸ª æ ç­¾ï¼Tagï¼ï¼æ¯ä¸ªæ ç­¾å¯¹åºä¸ä¸ªéåã\n\néå¸¸ï¼ä¸ä¸ªä»åºä¼åå«åä¸ä¸ªè½¯ä»¶ä¸åçæ¬çéåï¼èæ ç­¾å°±å¸¸ç¨äºå¯¹åºè¯¥è½¯ä»¶çåä¸ªçæ¬ãæä»¬å¯ä»¥éè¿ <ä»åºå>:<æ ç­¾> çæ ¼å¼æ¥æå®å·ä½æ¯è¿ä¸ªè½¯ä»¶åªä¸ªçæ¬çéåãå¦æä¸ç»åºæ ç­¾ï¼å°ä»¥ latest ä½ä¸ºé»è®¤æ ç­¾ã\n\nä»¥ Ubuntu éå ä¸ºä¾ï¼ubuntu æ¯ä»åºçåå­ï¼å¶ååå«æä¸åççæ¬æ ç­¾ï¼å¦ï¼16.04, 18.04ãæä»¬å¯ä»¥éè¿ ubuntu:16.04ï¼æè ubuntu:18.04 æ¥å·ä½æå®æéåªä¸ªçæ¬çéåãå¦æå¿½ç¥äºæ ç­¾ï¼æ¯å¦ ubuntuï¼é£å°è§ä¸º ubuntu:latestã\n\nä»åºåç»å¸¸ä»¥ ä¸¤æ®µå¼è·¯å¾ å½¢å¼åºç°ï¼æ¯å¦ jwilder/nginx-proxyï¼åèå¾å¾æå³ç Docker Registry å¤ç¨æ·ç¯å¢ä¸çç¨æ·åï¼åèåå¾å¾æ¯å¯¹åºçè½¯ä»¶åãä½è¿å¹¶éç»å¯¹ï¼åå³äºæä½¿ç¨çå·ä½ Docker Registry çè½¯ä»¶ææå¡ã\n\n\n# Docker Registry å¬å¼æå¡\n\næå¸¸ä½¿ç¨ç Registry å¬å¼æå¡æ¯å®æ¹ç Docker Hubï¼è¿ä¹æ¯é»è®¤ç Registryï¼å¹¶æ¥æå¤§éçé«è´¨éç å®æ¹éåã\n\nç±äºæäºåå ï¼å¨å½åè®¿é®è¿äºæå¡å¯è½ä¼æ¯è¾æ¢ãå½åçä¸äºäºæå¡åæä¾äºéå¯¹ Docker Hub çéåæå¡ï¼Registry Mirrorï¼ï¼è¿äºéåæå¡è¢«ç§°ä¸º å éå¨ãå¸¸è§çæ é¿éäºå éå¨ãDaoCloud å éå¨ ç­ãä½¿ç¨å éå¨ä¼ç´æ¥ä»å½åçå°åä¸è½½ Docker Hub çéåï¼æ¯ç´æ¥ä» Docker Hub ä¸è½½éåº¦ä¼æé«å¾å¤ã\n\nå½åä¹æä¸äºäºæå¡åæä¾ç±»ä¼¼äº Docker Hub çå¬å¼æå¡ãæ¯å¦ ç½æäºéåæå¡ãDaoCloud éåå¸åºãé¿éäºéååº ç­ã\n\n\n# ç§æ Docker Registry\n\né¤äºä½¿ç¨å¬å¼æå¡å¤ï¼ç¨æ·è¿å¯ä»¥å¨æ¬å°æ­å»ºç§æ Docker RegistryãDocker å®æ¹æä¾äº Docker Registry éåï¼å¯ä»¥ç´æ¥ä½¿ç¨åä¸ºç§æ Registry æå¡ã\n\né¤äºå®æ¹ç Docker Registry å¤ï¼è¿æç¬¬ä¸æ¹è½¯ä»¶å®ç°äº Docker Registry APIï¼çè³æä¾äºç¨æ·çé¢ä»¥åä¸äºé«çº§åè½ãæ¯å¦ï¼Harbor å Sonatype Nexusã\n\n\n# åºå±åç\n\n\n\n * HelloWorldéå\n\n\n\n * åºå±åç Docker Engineæ¯ä¸ä¸ªå®¢æ·ç«¯-æå¡å¨åºç¨ç¨åºï¼å·æä»¥ä¸ä¸»è¦ç»ä»¶:\n\n * * ä¸ä¸ªæå¡å¨ï¼å®æ¯ä¸ç§é¿æè¿è¡çç¨åºï¼ç§°ä¸ºå®æ¤è¿ç¨(dockerdå½ä»¤)\n   * ä¸ä¸ªREST APIï¼å®æå®ç¨åºå¯ä»¥ç¨æ¥ä¸å®æ¤è¿ç¨å¯¹è¯å¹¶æç¤ºå®åä»ä¹çæ¥å£ã\n\nDockeræ¯ä¸ä¸ªClient Serverç»æçç³»ç»ï¼Dockerå®æ¤è¿ç¨è¿è¡å¨ä¸»æºä¸ï¼ç¶åéè¿Socketè¿æ¥ä»å®¢æ· ç«¯è®¿é®ï¼å®æ¤è¿ç¨ä»å®¢æ·ç«¯æ¥åå½ä»¤å¹¶ç®¡çè¿è¡å¨ä¸»æºä¸çå®¹å¨ãå®¹å¨ï¼æ¯ä¸ä¸ªè¿è¡æ¶ç¯å¢å°±æ¯æä»¬æè¯´çéè£ç®±ã\n\n * ä¸ºä»ä¹Dockeræ¯Vmå¿«\n\n * * dockeræçæ¯èææºæ´å°çæ½è±¡å±ãç±äºdockerä¸éè¦Hypervisorå®ç°ç¡¬ä»¶èµæºèæå,*è¿è¡å¨dockerå®¹å¨ä¸çç¨åºç´æ¥ä½¿ç¨çé½æ¯å®éç©çæºçç¡¬ä»¶èµæº*ãå æ­¤å¨CPUãåå­å©ç¨çä¸dockerå°ä¼å¨æçä¸æææ¾ä¼å¿ã\n   * dockerå©ç¨çæ¯å®¿ä¸»æºçåæ ¸,èä¸éè¦Guest OSãå æ­¤,å½æ°å»ºä¸ä¸ª å®¹å¨æ¶,dockerä¸éè¦åèææºä¸æ ·éæ°å è½½ä¸ä¸ªæä½ç³»ç»åæ ¸ãä»èé¿åå¼å¯»ãå è½½æä½ç³»ç»åæ ¸è¿ä¸ªæ¯è¾è´¹æ¶è´¹èµæºçè¿ç¨,å½æ°å»ºä¸ä¸ªèææºæ¶,èææºè½¯ä»¶éè¦å è½½GuestOS,è¿ä¸ªæ°å»ºè¿ç¨æ¯åéçº§å«çãèdockerç±äºç´æ¥å©ç¨å®¿ä¸»æºçæä½ç³»ç»,åçç¥äºè¿ä¸ªè¿ç¨,å æ­¤æ°å»ºä¸ä¸ªdockerå®¹å¨åªéè¦å ç§éã\n\n\n\n\n# Dockerå®è£\n\n\n# åå¤å·¥ä½\n\n\n# ç³»ç»è¦æ±\n\nDocker æ¯æ 64 ä½çæ¬ CentOS 7/8ï¼å¹¶ä¸è¦æ±åæ ¸çæ¬ä¸ä½äº 3.10ã CentOS 7 æ»¡è¶³æä½åæ ¸çè¦æ±ï¼ä½ç±äºåæ ¸çæ¬æ¯è¾ä½ï¼é¨ååè½ï¼å¦ overlay2 å­å¨å±é©±å¨ï¼æ æ³ä½¿ç¨ï¼å¹¶ä¸é¨ååè½å¯è½ä¸å¤ªç¨³å®ã\n\n\n# å¸è½½æ§çæ¬\n\næ§çæ¬ç Docker ç§°ä¸º docker æè docker-engineï¼ä½¿ç¨ä»¥ä¸å½ä»¤å¸è½½æ§çæ¬ï¼\n\n$ sudo yum remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-selinux \\\n                  docker-engine-selinux \\\n                  docker-engine\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# ä½¿ç¨ yum å®è£\n\næ§è¡ä»¥ä¸å½ä»¤å®è£ä¾èµåï¼\n\n$ sudo yum install -y yum-utils\n\n\n1\n\n\né´äºå½åç½ç»é®é¢ï¼å¼ºçå»ºè®®ä½¿ç¨å½åæºã\n\næ§è¡ä¸é¢çå½ä»¤æ·»å  yum è½¯ä»¶æºï¼\n\n$ sudo yum-config-manager \\\n    --add-repo \\\n    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n\n$ sudo sed -i \'s/download.docker.com/mirrors.aliyun.com\\/docker-ce/g\' /etc/yum.repos.d/docker-ce.repo\n\n# å®æ¹æº\n# $ sudo yum-config-manager \\\n#     --add-repo \\\n#     https://download.docker.com/linux/centos/docker-ce.repo\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# å®è£ Docker\n\næ´æ° yum è½¯ä»¶æºç¼å­ï¼å¹¶å®è£ docker-ceã\n\n$ sudo yum install docker-ce docker-ce-cli containerd.io\n\n\n1\n\n\n\n# CentOS8 é¢å¤è®¾ç½®\n\nç±äº CentOS8 é²ç«å¢ä½¿ç¨äº nftablesï¼ä½ Docker å°æªæ¯æ nftablesï¼ æä»¬å¯ä»¥ä½¿ç¨å¦ä¸è®¾ç½®ä½¿ç¨ iptablesï¼\n\næ´æ¹ /etc/firewalld/firewalld.conf\n\n# FirewallBackend=nftables\nFirewallBackend=iptables\n\n\n1\n2\n\n\næèæ§è¡å¦ä¸å½ä»¤ï¼\n\n$ firewall-cmd --permanent --zone=trusted --add-interface=docker0\n\n$ firewall-cmd --reload\n\n\n1\n2\n3\n\n\n\n# å¯å¨ Docker\n\n$ sudo systemctl enable docker\n$ sudo systemctl start docker\n\n\n1\n2\n\n\n\n# å»ºç« docker ç¨æ·ç»\n\né»è®¤æåµä¸ï¼docker å½ä»¤ä¼ä½¿ç¨ Unix socket ä¸ Docker å¼æéè®¯ãèåªæ root ç¨æ·å docker ç»çç¨æ·æå¯ä»¥è®¿é® Docker å¼æç Unix socketãåºäºå®å¨èèï¼ä¸è¬ Linux ç³»ç»ä¸ä¸ä¼ç´æ¥ä½¿ç¨ root ç¨æ·ãå æ­¤ï¼æ´å¥½å°åæ³æ¯å°éè¦ä½¿ç¨ docker çç¨æ·å å¥ docker ç¨æ·ç»ã\n\nå»ºç« docker ç»ï¼\n\n$ sudo groupadd docker\n\n\n1\n\n\nå°å½åç¨æ·å å¥ docker ç»ï¼\n\n$ sudo usermod -aG docker $USER\n\n\n1\n\n\n\n# æµè¯ Docker æ¯å¦å®è£æ­£ç¡®\n\n$ docker run --rm hello-world\n\nUnable to find image \'hello-world:latest\' locally\nlatest: Pulling from library/hello-world\nb8dfde127a29: Pull complete\nDigest: sha256:308866a43596e83578c7dfa15e27a73011bdd402185a84c5cd7f32a88b501a24\nStatus: Downloaded newer image for hello-world:latest\n\nHello from Docker!\nThis message shows that your installation appears to be working correctly.\n\nTo generate this message, Docker took the following steps:\n 1. The Docker client contacted the Docker daemon.\n 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.\n    (amd64)\n 3. The Docker daemon created a new container from that image which runs the\n    executable that produces the output you are currently reading.\n 4. The Docker daemon streamed that output to the Docker client, which sent it\n    to your terminal.\n\nTo try something more ambitious, you can run an Ubuntu container with:\n $ docker run -it ubuntu bash\n\nShare images, automate workflows, and more with a free Docker ID:\n https://hub.docker.com/\n\nFor more examples and ideas, visit:\n https://docs.docker.com/get-started/\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n\nè¥è½æ­£å¸¸è¾åºä»¥ä¸ä¿¡æ¯ï¼åè¯´æå®è£æåã\n\n\n# éåå éå¨\n\nå½åä» Docker Hub æåéåææ¶ä¼éå°å°é¾ï¼æ­¤æ¶å¯ä»¥éç½®éåå éå¨ãå½åå¾å¤äºæå¡åé½æä¾äºå½åå éå¨æå¡ï¼ä¾å¦ï¼\n\n * é¿éäºå éå¨(ç¹å»ç®¡çæ§å¶å° -> ç»å½è´¦å·(æ·å®è´¦å·) -> å³ä¾§éåå·¥å· -> éåå éå¨ -> å¤å¶å éå¨å°å)\n * ç½æäºå éå¨ https://hub-mirror.c.163.com\n * ç¾åº¦äºå éå¨ https://mirror.baidubce.com\n\nç±äºéåæå¡å¯è½åºç°å®æºï¼å»ºè®®åæ¶éç½®å¤ä¸ªéåã\n\nä»¥ ç½æäº éåæå¡ https://hub-mirror.c.163.com ä¸ºä¾è¿è¡ä»ç»ã\n\n\n# CentOS 7+\n\nç®åä¸»æµ Linux åè¡çåå·²ä½¿ç¨ systemd è¿è¡æå¡ç®¡çï¼è¿éä»ç»å¦ä½å¨ä½¿ç¨ systemd ç Linux åè¡çä¸­éç½®éåå éå¨ã\n\nè¯·é¦åæ§è¡ä»¥ä¸å½ä»¤ï¼æ¥çæ¯å¦å¨ docker.service æä»¶ä¸­éç½®è¿éåå°åã\n\n$ systemctl cat docker | grep \'\\-\\-registry\\-mirror\'\n\n\n1\n\n\nå¦æè¯¥å½ä»¤æè¾åºï¼é£ä¹è¯·æ§è¡ $ systemctl cat docker æ¥ç ExecStart= åºç°çä½ç½®ï¼ä¿®æ¹å¯¹åºçæä»¶åå®¹å»æ --registry-mirror åæ°åå¶å¼ï¼å¹¶ææ¥ä¸æ¥çæ­¥éª¤è¿è¡éç½®ã\n\nå¦æä»¥ä¸å½ä»¤æ²¡æä»»ä½è¾åºï¼é£ä¹å°±å¯ä»¥å¨ /etc/docker/daemon.json ä¸­åå¥å¦ä¸åå®¹ï¼å¦ææä»¶ä¸å­å¨è¯·æ°å»ºè¯¥æä»¶ï¼ï¼\n\n{\n  "registry-mirrors": [\n    "https://hub-mirror.c.163.com",\n    "https://mirror.baidubce.com"\n  ]\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\n> æ³¨æï¼ä¸å®è¦ä¿è¯è¯¥æä»¶ç¬¦å json è§èï¼å¦å Docker å°ä¸è½å¯å¨ã\n\nä¹åéæ°å¯å¨æå¡ã\n\n$ sudo systemctl daemon-reload\n$ sudo systemctl restart docker\t\t\t\n\n\n1\n2\n\n\né¿éäºéåå ééç½®\n\nsudo mkdir -p /etc/docker\nsudo tee /etc/docker/daemon.json <<-\'EOF\'\n{\n  "registry-mirrors": ["https://hub-mirror.c.163.com/", \t\t\t\t\t\t\t        \t\t\t\t\t"https://docker.mirrors.ustc.edu.cn/", \n   \t\t\t\t\t   "https://reg-mirror.qiniu.com"]\n}\nEOF\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# æ·»å åæ ¸åæ°\n\nå¦æå¨ CentOS ä½¿ç¨ Docker çå°ä¸é¢çè¿äºè­¦åä¿¡æ¯ï¼\n\nWARNING: bridge-nf-call-iptables is disabled\nWARNING: bridge-nf-call-ip6tables is disabled\n\n\n1\n2\n\n\nè¯·æ·»å åæ ¸éç½®åæ°ä»¥å¯ç¨è¿äºåè½ã\n\n$ sudo tee -a /etc/sysctl.conf <<-EOF\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nEOF\n\n\n1\n2\n3\n4\n\n\n\n# ä½¿ç¨éå\n\n\n# è·åéå\n\nä» Docker éåä»åºè·åéåçå½ä»¤æ¯ docker pullãå¶å½ä»¤æ ¼å¼ä¸ºï¼\n\n$ docker pull [éé¡¹] [Docker Registry å°å[:ç«¯å£å·]/]ä»åºå[:æ ç­¾]\t\t\t\t\t\n\n\n1\n\n\nå·ä½çéé¡¹å¯ä»¥éè¿ docker pull --help å½ä»¤çå°ï¼è¿éæä»¬è¯´ä¸ä¸éååç§°çæ ¼å¼ã\n\n * Docker éåä»åºå°åï¼å°åçæ ¼å¼ä¸è¬æ¯ <åå/IP>[:ç«¯å£å·]ãé»è®¤å°åæ¯ Docker Hub(docker.io)ã\n * ä»åºåï¼å¦ä¹åæè¯´ï¼è¿éçä»åºåæ¯ä¸¤æ®µå¼åç§°ï¼å³ <ç¨æ·å>/<è½¯ä»¶å>ãå¯¹äº Docker Hubï¼å¦æä¸ç»åºç¨æ·åï¼åé»è®¤ä¸º libraryï¼ä¹å°±æ¯å®æ¹éåã\n\næ¯å¦ï¼\n\n$ docker pull ubuntu:18.04\n18.04: Pulling from library/ubuntu\n92dc2a97ff99: Pull complete\nbe13a9d27eb8: Pull complete\nc8299583700a: Pull complete\nDigest: sha256:4bc3ae6596938cb0d9e5ac51a1152ec9dcac2a1c50829c74abd9c4361e321b26\nStatus: Downloaded newer image for ubuntu:18.04\ndocker.io/library/ubuntu:18.04\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢çå½ä»¤ä¸­æ²¡æç»åº Docker éåä»åºå°åï¼å æ­¤å°ä¼ä» Docker Hub ï¼docker.ioï¼è·åéåãèéååç§°æ¯ ubuntu:18.04ï¼å æ­¤å°ä¼è·åå®æ¹éå library/ubuntu ä»åºä¸­æ ç­¾ä¸º 18.04 çéåãdocker pull å½ä»¤çè¾åºç»ææåä¸è¡ç»åºäºéåçå®æ´åç§°ï¼å³ï¼ docker.io/library/ubuntu:18.04ã\n\nè¿è¡\n\n$ docker run -it --rm ubuntu:18.04 bash\n\nroot@e7009c6ce357:/# cat /etc/os-release\nNAME="Ubuntu"\nVERSION="18.04.1 LTS (Bionic Beaver)"\nID=ubuntu\nID_LIKE=debian\nPRETTY_NAME="Ubuntu 18.04.1 LTS"\nVERSION_ID="18.04"\nHOME_URL="https://www.ubuntu.com/"\nSUPPORT_URL="https://help.ubuntu.com/"\nBUG_REPORT_URL="https://bugs.launchpad.net/ubuntu/"\nPRIVACY_POLICY_URL="https://www.ubuntu.com/legal/terms-and-policies/privacy-policy"\nVERSION_CODENAME=bionic\nUBUNTU_CODENAME=bionic\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n * -itï¼è¿æ¯ä¸¤ä¸ªåæ°ï¼ä¸ä¸ªæ¯ -iï¼äº¤äºå¼æä½ï¼ä¸ä¸ªæ¯ -t ç»ç«¯ãæä»¬è¿éæç®è¿å¥ bash æ§è¡ä¸äºå½ä»¤å¹¶æ¥çè¿åç»æï¼å æ­¤æä»¬éè¦äº¤äºå¼ç»ç«¯ã\n * --rmï¼è¿ä¸ªåæ°æ¯è¯´å®¹å¨éåºåéä¹å°å¶å é¤ã\n * bashï¼æ¾å¨éåååçæ¯ å½ä»¤ï¼è¿éæä»¬å¸ææä¸ªäº¤äºå¼ Shellï¼å æ­¤ç¨çæ¯ bashã\n\n\n# ååºéå\n\n$ docker image ls | docker images\nREPOSITORY           TAG                 IMAGE ID            CREATED             SIZE\nredis                latest              5f515359c7f8        5 days ago          183 MB\nnginx                latest              05a60462f8ba        5 days ago          181 MB\nmongo                3.2                 fe9198c04d62        5 days ago          342 MB\n<none>               <none>              00285df0df87        5 days ago          342 MB\nubuntu               18.04               329ed837d508        3 days ago          63.3MB\nubuntu               bionic              329ed837d508        3 days ago          63.3MB\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nåè¡¨åå«äº ä»åºåãæ ç­¾ãéå IDãåå»ºæ¶é´ ä»¥å æå ç¨çç©ºé´ã\n\néå ID åæ¯éåçå¯ä¸æ è¯ï¼ä¸ä¸ªéåå¯ä»¥å¯¹åºå¤ä¸ª æ ç­¾ãå æ­¤ï¼å¨ä¸é¢çä¾å­ä¸­ï¼æä»¬å¯ä»¥çå° ubuntu:18.04 å ubuntu:bionic æ¥æç¸åç IDï¼å ä¸ºå®ä»¬å¯¹åºçæ¯åä¸ä¸ªéåã\n\n\n# éåä½ç§¯\n\nå¦æä»ç»è§å¯ï¼ä¼æ³¨æå°ï¼è¿éæ è¯çæå ç¨ç©ºé´åå¨ Docker Hub ä¸çå°çéåå¤§å°ä¸åãæ¯å¦ï¼ubuntu:18.04 éåå¤§å°ï¼å¨è¿éæ¯ 63.3MBï¼ä½æ¯å¨ Docker Hub æ¾ç¤ºçå´æ¯ 25.47 MBãè¿æ¯å ä¸º Docker Hub ä¸­æ¾ç¤ºçä½ç§¯æ¯åç¼©åçä½ç§¯ãå¨éåä¸è½½åä¸ä¼ è¿ç¨ä¸­éåæ¯ä¿æçåç¼©ç¶æçï¼å æ­¤ Docker Hub ææ¾ç¤ºçå¤§å°æ¯ç½ç»ä¼ è¾ä¸­æ´å³å¿çæµéå¤§å°ãè docker image ls æ¾ç¤ºçæ¯éåä¸è½½å°æ¬å°åï¼å±å¼çå¤§å°ï¼åç¡®è¯´ï¼æ¯å±å¼åçåå±æå ç©ºé´çæ»åï¼å ä¸ºéåå°æ¬å°åï¼æ¥çç©ºé´çæ¶åï¼æ´å³å¿çæ¯æ¬å°ç£çç©ºé´å ç¨çå¤§å°ã\n\nå¦å¤ä¸ä¸ªéè¦æ³¨æçé®é¢æ¯ï¼docker image ls åè¡¨ä¸­çéåä½ç§¯æ»åå¹¶éæ¯ææéåå®éç¡¬çæ¶èãç±äº Docker éåæ¯å¤å±å­å¨ç»æï¼å¹¶ä¸å¯ä»¥ç»§æ¿ãå¤ç¨ï¼å æ­¤ä¸åéåå¯è½ä¼å ä¸ºä½¿ç¨ç¸åçåºç¡éåï¼ä»èæ¥æå±åçå±ãç±äº Docker ä½¿ç¨ Union FSï¼ç¸åçå±åªéè¦ä¿å­ä¸ä»½å³å¯ï¼å æ­¤å®ééåç¡¬çå ç¨ç©ºé´å¾å¯è½è¦æ¯è¿ä¸ªåè¡¨éåå¤§å°çæ»åè¦å°çå¤ã\n\nä½ å¯ä»¥éè¿ docker system df å½ä»¤æ¥ä¾¿æ·çæ¥çéåãå®¹å¨ãæ°æ®å·æå ç¨çç©ºé´ã\n\n$ docker system df\n\nTYPE                TOTAL               ACTIVE              SIZE           RECLAIMABLE\nImages              24                  0                   1.992GB        1.992GB (100%)\nContainers          1                   0                   62.82MB        62.82MB (100%)\nLocal Volumes       9                   0                   652.2MB        652.2MB (100%)\nBuild Cache                                                 0B             0B\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# èæ¬éå\n\nä¸é¢çéååè¡¨ä¸­ï¼è¿å¯ä»¥çå°ä¸ä¸ªç¹æ®çéåï¼è¿ä¸ªéåæ¢æ²¡æä»åºåï¼ä¹æ²¡ææ ç­¾ï¼åä¸º <none>ã\n\n<none>               <none>              00285df0df87        5 days ago          342 MB\n\n\n1\n\n\nä¸è¬æ¥è¯´ï¼èæ¬éåå·²ç»å¤±å»äºå­å¨çä»·å¼ï¼æ¯å¯ä»¥éæå é¤çï¼å¯ä»¥ç¨ä¸é¢çå½ä»¤å é¤ã\n\n$ docker image prune\n\n\n1\n\n\n\n# ä¸­é´å±éå\n\nä¸ºäºå ééåæå»ºãéå¤å©ç¨èµæºï¼Docker ä¼å©ç¨ ä¸­é´å±éåãæä»¥å¨ä½¿ç¨ä¸æ®µæ¶é´åï¼å¯è½ä¼çå°ä¸äºä¾èµçä¸­é´å±éåãé»è®¤ç docker image ls åè¡¨ä¸­åªä¼æ¾ç¤ºé¡¶å±éåï¼å¦æå¸ææ¾ç¤ºåæ¬ä¸­é´å±éåå¨åçææéåçè¯ï¼éè¦å  -a åæ°ã\n\n$ docker image ls -a | docker images -a\n\n\n1\n\n\nè¿æ ·ä¼çå°å¾å¤æ æ ç­¾çéåï¼ä¸ä¹åçèæ¬éåä¸åï¼è¿äºæ æ ç­¾çéåå¾å¤é½æ¯ä¸­é´å±éåï¼æ¯å¶å®éåæä¾èµçéåãè¿äºæ æ ç­¾éåä¸åºè¯¥å é¤ï¼å¦åä¼å¯¼è´ä¸å±éåå ä¸ºä¾èµä¸¢å¤±èåºéãå®éä¸ï¼è¿äºéåä¹æ²¡å¿è¦å é¤ï¼å ä¸ºä¹åè¯´è¿ï¼ç¸åçå±åªä¼å­ä¸éï¼èè¿äºéåæ¯å«çéåçä¾èµï¼å æ­¤å¹¶ä¸ä¼å ä¸ºå®ä»¬è¢«ååºæ¥èå¤å­äºä¸ä»½ï¼æ è®ºå¦ä½ä½ ä¹ä¼éè¦å®ä»¬ãåªè¦å é¤é£äºä¾èµå®ä»¬çéååï¼è¿äºä¾èµçä¸­é´å±éåä¹ä¼è¢«è¿å¸¦å é¤ã\n\n\n# ååºé¨åéå\n\nä¸å ä»»ä½åæ°çæåµä¸ï¼docker image ls ä¼ååºææé¡¶å±éåï¼ä½æ¯ææ¶åæä»¬åªå¸æååºé¨åéåãdocker image ls æå¥½å ä¸ªåæ°å¯ä»¥å¸®å©åå°è¿ä¸ªäºæã\n\næ ¹æ®ä»åºåååºéå\n\n$ docker image ls ubuntu\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nubuntu              18.04               329ed837d508        3 days ago          63.3MB\nubuntu              bionic              329ed837d508        3 days ago          63.3MB\n\n\n1\n2\n3\n4\n\n\nååºç¹å®çæä¸ªéåï¼ä¹å°±æ¯è¯´æå®ä»åºååæ ç­¾\n\n$ docker image ls ubuntu:18.04\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nubuntu              18.04               329ed837d508        3 days ago          63.3MB\n\n\n1\n2\n3\n\n\né¤æ­¤ä»¥å¤ï¼docker image ls è¿æ¯æå¼ºå¤§çè¿æ»¤å¨åæ° --filterï¼æèç®å -fãæ¯å¦ï¼æä»¬å¸æçå°å¨ mongo:3.2 ä¹åå»ºç«çéåï¼å¯ä»¥ç¨ä¸é¢çå½ä»¤ï¼\n\n$ docker image ls -f since=mongo:3.2\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nredis               latest              5f515359c7f8        5 days ago          183 MB\nnginx               latest              05a60462f8ba        5 days ago          181 MB\n\n\n1\n2\n3\n4\n\n\næ³æ¥çæä¸ªä½ç½®ä¹åçéåä¹å¯ä»¥ï¼åªéè¦æ since æ¢æ before å³å¯ã\n\næ­¤å¤ï¼å¦æéåæå»ºæ¶ï¼å®ä¹äº LABELï¼è¿å¯ä»¥éè¿ LABEL æ¥è¿æ»¤ã\n\n$ docker image ls -f label=com.example.version=0.1\n...\n\n\n1\n2\n\n\n\n# å¶ä»ç¨æ³\n\n[root@localhost ~]# docker images ls --help\n\nUsage:  docker images [OPTIONS] [REPOSITORY[:TAG]]\n\nList images\n\nOptions:\n  -a, --all             Show all images (default hides intermediate images)\n      --digests         Show digests\n  -f, --filter filter   Filter output based on conditions provided\n      --format string   Pretty-print images using a Go template\n      --no-trunc        Don\'t truncate output\n  -q, --quiet           Only show image IDs\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# å é¤æ¬å°éå\n\nå¦æè¦å é¤æ¬å°çéåï¼å¯ä»¥ä½¿ç¨ docker image rm å½ä»¤ï¼å¶æ ¼å¼ä¸ºï¼\n\n$ docker image rm [éé¡¹] <éå1> [<éå2> ...] (ç¨æ³1)\n$ docker rmi [éé¡¹] <éå1> [<éå2> ...] ï¼ç¨æ³2ï¼\n\n\n1\n2\n\n\n\n# ç¨ IDãéååãæè¦å é¤éå\n\nå¶ä¸­ï¼<éå> å¯ä»¥æ¯ éåç­ IDãéåé¿ IDãéåå æè éåæè¦ã\n\næä»¬å¯ä»¥ç¨éåçå®æ´ IDï¼ä¹ç§°ä¸º é¿ IDï¼æ¥å é¤éåãä½¿ç¨èæ¬çæ¶åå¯è½ä¼ç¨é¿ IDï¼ä½æ¯äººå·¥è¾å¥å°±å¤ªç´¯äºï¼æä»¥æ´å¤çæ¶åæ¯ç¨ ç­ ID æ¥å é¤éåãdocker image ls é»è®¤ååºçå°±å·²ç»æ¯ç­ ID äºï¼ä¸è¬åå3ä¸ªå­ç¬¦ä»¥ä¸ï¼åªè¦è¶³å¤åºåäºå«çéåå°±å¯ä»¥äºã\n\n\n# ç¨ docker image ls å½ä»¤æ¥éå\n\næ¯å¦ï¼æä»¬éè¦å é¤ææä»åºåä¸º redis çéåï¼\n\n$ docker image rm $(docker image ls -q redis)\n\n\n1\n\n\næèå é¤ææå¨ mongo:3.2 ä¹åçéåï¼\n\n$ docker image rm $(docker image ls -q -f before=mongo:3.2)\n\n\n1\n\n\n\n# æäº¤æ¬å°éå\n\nå½æä»¬è¿è¡ä¸ä¸ªå®¹å¨çæ¶åï¼å¦æä¸ä½¿ç¨å·çè¯ï¼ï¼æä»¬åçä»»ä½æä»¶ä¿®æ¹é½ä¼è¢«è®°å½äºå®¹å¨å­å¨å±éãè Docker æä¾äºä¸ä¸ª docker commit å½ä»¤ï¼å¯ä»¥å°å®¹å¨çå­å¨å±ä¿å­ä¸æ¥æä¸ºéåãæ¢å¥è¯è¯´ï¼å°±æ¯å¨åæéåçåºç¡ä¸ï¼åå å ä¸å®¹å¨å­å¨å±æææ°çéåã\n\ndocker commit çè¯­æ³æ ¼å¼ä¸ºï¼\n\ndocker commit [éé¡¹] <å®¹å¨IDæå®¹å¨å> [<ä»åºå>[:<æ ç­¾>]]\n\n\n1\n\n\nç°å¨è®©æä»¬ä»¥å®å¶ä¸ä¸ª Web æå¡å¨ä¸ºä¾å­ï¼æ¥è®²è§£éåæ¯å¦ä½æå»ºçã\n\n$ docker run --name webserver -d -p 80:80 nginx\n$ docker exec -it webserver bash\nroot@3729b97e8226:/# echo \'<h1>Hello, Docker!</h1>\' > /usr/share/nginx/html/index.html\nroot@3729b97e8226:/# exit\nexit\n\n# éè¿ docker diff å½ä»¤æ¥çå®¹å¨å­å¨å±çæä»¶æ¹å¨\n$ docker diff webserver\nC /root\nA /root/.bash_history\nC /run\nC /usr\nC /usr/share\nC /usr/share/nginx\nC /usr/share/nginx/html\nC /usr/share/nginx/html/index.html\nC /var\nC /var/cache\nC /var/cache/nginx\nA /var/cache/nginx/client_temp\nA /var/cache/nginx/fastcgi_temp\nA /var/cache/nginx/proxy_temp\nA /var/cache/nginx/scgi_temp\nA /var/cache/nginx/uwsgi_temp\n\n$ docker commit \\\n    --author "Tao Wang <twang2218@gmail.com>" \\\n    --message "ä¿®æ¹äºé»è®¤ç½é¡µ" \\\n    webserver \\\n    nginx:v2\nsha256:07e33465974800ce65751acc279adc6ed2dc5ed4e0838f8b86f0c87aa1795214\n\n# ç¨ docker history æ¥çéåæå»ºåå²\n# æ¯è¾nginx:v2ånginx:latest çéåæå»ºåå²ï¼åç°nginx:v2æ°å¢äºæä»¬ååæäº¤çè¿ä¸å±ã\n$ docker history nginx:v2\n\n# æ°çéåå®å¶å¥½åï¼æä»¬å¯ä»¥æ¥è¿è¡è¿ä¸ªéåã\n$ docker run --name web2 -d -p 81:80 nginx:v2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n\n\n\n# æç¨ docker commit\n\né¦åï¼å¦æä»ç»è§å¯ä¹åç docker diff webserver çç»æï¼ä½ ä¼åç°é¤äºçæ­£æ³è¦ä¿®æ¹ç /usr/share/nginx/html/index.html æä»¶å¤ï¼ç±äºå½ä»¤çæ§è¡ï¼è¿æå¾å¤æä»¶è¢«æ¹å¨ææ·»å äºãè¿è¿ä»ä»æ¯æç®åçæä½ï¼å¦ææ¯å®è£è½¯ä»¶åãç¼è¯æå»ºï¼é£ä¼æå¤§éçæ å³åå®¹è¢«æ·»å è¿æ¥ï¼å°ä¼å¯¼è´éåæä¸ºèè¿ã\n\næ­¤å¤ï¼ä½¿ç¨ docker commit æå³çææå¯¹éåçæä½é½æ¯é»ç®±æä½ï¼çæçéåä¹è¢«ç§°ä¸º é»ç®±éåï¼æ¢å¥è¯è¯´ï¼å°±æ¯é¤äºå¶ä½éåçäººç¥éæ§è¡è¿ä»ä¹å½ä»¤ãæä¹çæçéåï¼å«äººæ ¹æ¬æ ä»å¾ç¥ãèä¸ï¼å³ä½¿æ¯è¿ä¸ªå¶ä½éåçäººï¼è¿ä¸æ®µæ¶é´åä¹æ æ³è®°æ¸å·ä½çæä½ãè¿ç§é»ç®±éåçç»´æ¤å·¥ä½æ¯éå¸¸çè¦çã\n\n\n# æä½å®¹å¨\n\n\n# å¯å¨ï¼docker runï¼\n\n# -t éé¡¹è®©Dockeråéä¸ä¸ªä¼ªç»ç«¯ï¼pseudo-ttyï¼å¹¶ç»å®å°å®¹å¨çæ åè¾å¥ä¸\n# -i åè®©å®¹å¨çæ åè¾å¥ä¿ææå¼\n$ docker run -t -i ubuntu:18.04 /bin/bash\n\n\n1\n2\n3\n\n\n\n# å®æ¤æè¿è¡ï¼-dï¼\n\nå¦æä¸ä½¿ç¨ -d åæ°è¿è¡å®¹å¨ã\n\n$ docker run ubuntu:18.04 /bin/sh -c "while true; do echo hello world; sleep 1; done"\nhello world\nhello world\nhello world\nhello world\n\n\n1\n2\n3\n4\n5\n\n\nå®¹å¨ä¼æè¾åºçç»æ (STDOUT) æå°å°å®¿ä¸»æºä¸é¢\n\nå¦æä½¿ç¨äº -d åæ°è¿è¡å®¹å¨ã\n\n$ docker run -d ubuntu:18.04 /bin/sh -c "while true; do echo hello world; sleep 1; done"\n77b2dc01fe0f3f1265df143181e7b9af5e05279a884f4776ee75350ea9d8017a\n\n\n1\n2\n\n\næ­¤æ¶å®¹å¨ä¼å¨åå°è¿è¡å¹¶ä¸ä¼æè¾åºçç»æ (STDOUT) æå°å°å®¿ä¸»æºä¸é¢(è¾åºç»æå¯ä»¥ç¨ docker logs æ¥ç)ã\n\næ³¨ï¼ å®¹å¨æ¯å¦ä¼é¿ä¹è¿è¡ï¼æ¯å docker run æå®çå½ä»¤ï¼æèDockfileä¸­CMDæä»¤æå®çé»è®¤å¯å¨å½ä»¤ï¼æå³ï¼å -d åæ°æ å³ã\n\néè¿ docker ps å½ä»¤æ¥æ¥çå®¹å¨ä¿¡æ¯\n\n$ docker ps\nCONTAINER ID  IMAGE         COMMAND               CREATED        STATUS       PORTS NAMES\n77b2dc01fe0f  ubuntu:18.04  /bin/sh -c \'while tr  2 minutes ago  Up 1 minute        agitated_wright\n\n\n1\n2\n3\n\n\nè¦è·åå®¹å¨çè¾åºä¿¡æ¯ï¼å¯ä»¥éè¿ docker logs å½ä»¤ã\n\n$ docker logs [container ID or NAMES]\nhello world\nhello world\nhello world\n. . .\n\n\n1\n2\n3\n4\n5\n\n\n\n# ç»æ­¢ï¼docker stopï¼\n\nå¯ä»¥ä½¿ç¨ docker stop æ¥ç»æ­¢ä¸ä¸ªè¿è¡ä¸­çå®¹å¨ã\n\næ­¤å¤ï¼å½ Docker å®¹å¨ä¸­æå®çåºç¨ç»ç»æ¶ï¼å®¹å¨ä¹èªå¨ç»æ­¢ã\n\nä¾å¦å¯¹äºåªå¯å¨äºä¸ä¸ªç»ç«¯çå®¹å¨ï¼ç¨æ·éè¿ exit å½ä»¤æ Ctrl+d æ¥éåºç»ç«¯æ¶ï¼æåå»ºçå®¹å¨ç«å»ç»æ­¢ã\n\nç»æ­¢ç¶æçå®¹å¨å¯ä»¥ç¨ docker ls -a å½ä»¤çå°ã\n\nå¤äºç»æ­¢ç¶æçå®¹å¨ï¼å¯ä»¥éè¿ docker start å½ä»¤æ¥éæ°å¯å¨ã\n\næ­¤å¤ï¼docker restart å½ä»¤ä¼å°ä¸ä¸ªè¿è¡æçå®¹å¨ç»æ­¢ï¼ç¶ååéæ°å¯å¨å®ã\n\n\n# è¿å¥å®¹å¨\n\næäºæ¶åéè¦è¿å¥å®¹å¨è¿è¡æä½ï¼åæ¬ä½¿ç¨ docker attach å½ä»¤æ docker exec å½ä»¤ï¼æ¨èå¤§å®¶ä½¿ç¨ docker exec å½ä»¤ï¼åå ä¼å¨ä¸é¢è¯´æã\n\n\n# attach å½ä»¤\n\nä¸é¢ç¤ºä¾å¦ä½ä½¿ç¨ docker attach å½ä»¤ã\n\n$ docker run -dit ubuntu\n243c32535da7d142fb0e6df616a3c3ada0b8ab417937c853a9e1c251f499f550\n\n$ docker ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\n243c32535da7        ubuntu:latest       "/bin/bash"         18 seconds ago      Up 17 seconds                           nostalgic_hypatia\n\n$ docker attach 243c\nroot@243c32535da7:/#\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\næ³¨æï¼ å¦æä»è¿ä¸ª stdin ä¸­ exitï¼ä¼å¯¼è´å®¹å¨çåæ­¢ã\n\n\n# exec å½ä»¤\n\n-i -t åæ°\n\ndocker exec åè¾¹å¯ä»¥è·å¤ä¸ªåæ°ï¼è¿éä¸»è¦è¯´æ -i -t åæ°ã\n\nåªç¨ -i åæ°æ¶ï¼ç±äºæ²¡æåéä¼ªç»ç«¯ï¼çé¢æ²¡ææä»¬çæç Linux å½ä»¤æç¤ºç¬¦ï¼ä½å½ä»¤æ§è¡ç»æä»ç¶å¯ä»¥è¿åã\n\nå½ -i -t åæ°ä¸èµ·ä½¿ç¨æ¶ï¼åå¯ä»¥çå°æä»¬çæç Linux å½ä»¤æç¤ºç¬¦ã\n\n$ docker run -dit ubuntu\n69d137adef7a8a689cbcb059e94da5489d3cddd240ff675c640c8d96e84fe1f6\n\n$ docker container ls\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\n69d137adef7a        ubuntu:latest       "/bin/bash"         18 seconds ago      Up 17 seconds                           zealous_swirles\n\n$ docker exec -i 69d1 bash\nls\nbin\nboot\ndev\n...\n\n$ docker exec -it 69d1 bash\nroot@69d137adef7a:/#\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nå¦æä»è¿ä¸ª stdin ä¸­ exitï¼ä¸ä¼å¯¼è´å®¹å¨çåæ­¢ãè¿å°±æ¯ä¸ºä»ä¹æ¨èå¤§å®¶ä½¿ç¨ docker exec çåå ã\n\n\n# å¯¼åºåå¯¼å¥\n\n\n# å¯¼åºå®¹å¨\n\nå¦æè¦å¯¼åºæ¬å°æä¸ªå®¹å¨ï¼å¯ä»¥ä½¿ç¨ docker export å½ä»¤ã\n\n$ docker ps -a\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                    PORTS               NAMES\n7691a814370e        ubuntu:18.04        "/bin/bash"         36 hours ago        Exited (0) 21 hours ago                       test\n$ docker export 7691a814370e > ubuntu.tar\n\n\n1\n2\n3\n4\n\n\nè¿æ ·å°å¯¼åºå®¹å¨å¿«ç§å°æ¬å°æä»¶ã\n\n\n# å¯¼å¥å®¹å¨å¿«ç§\n\nå¯ä»¥ä½¿ç¨ docker import ä»å®¹å¨å¿«ç§æä»¶ä¸­åå¯¼å¥ä¸ºéåï¼ä¾å¦\n\n$ cat ubuntu.tar | docker import - test/ubuntu:v1.0\n$ docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED              VIRTUAL SIZE\ntest/ubuntu         v1.0                9d37a6082e97        About a minute ago   171.3 MB\n\n\n1\n2\n3\n4\n\n\næ­¤å¤ï¼ä¹å¯ä»¥éè¿æå® URL æèæä¸ªç®å½æ¥å¯¼å¥ï¼ä¾å¦\n\n$ docker import http://example.com/exampleimage.tgz example/imagerepo\n\n\n1\n\n\næ³¨ï¼ç¨æ·æ¢å¯ä»¥ä½¿ç¨ docker load æ¥å¯¼å¥éåå­å¨æä»¶å°æ¬å°éååºï¼ä¹å¯ä»¥ä½¿ç¨ docker import æ¥å¯¼å¥ä¸ä¸ªå®¹å¨å¿«ç§å°æ¬å°éååºãè¿ä¸¤èçåºå«å¨äºå®¹å¨å¿«ç§æä»¶å°ä¸¢å¼ææçåå²è®°å½ååæ°æ®ä¿¡æ¯ï¼å³ä»ä¿å­å®¹å¨å½æ¶çå¿«ç§ç¶æï¼ï¼èéåå­å¨æä»¶å°ä¿å­å®æ´è®°å½ï¼ä½ç§¯ä¹è¦å¤§ãæ­¤å¤ï¼ä»å®¹å¨å¿«ç§æä»¶å¯¼å¥æ¶å¯ä»¥éæ°æå®æ ç­¾ç­åæ°æ®ä¿¡æ¯ã\n\n\n# å é¤\n\nå¯ä»¥ä½¿ç¨ docker rm æ¥å é¤ä¸ä¸ªå¤äºç»æ­¢ç¶æçå®¹å¨ã\n\n$ docker rm trusting_newton\ntrusting_newton\n\n\n1\n2\n\n\nå¦æè¦å é¤ä¸ä¸ªè¿è¡ä¸­çå®¹å¨ï¼å¯ä»¥æ·»å  -f åæ°ãDocker ä¼åé SIGKILL ä¿¡å·ç»å®¹å¨ã\n\nç¨ docker container ls -a å½ä»¤å¯ä»¥æ¥çææå·²ç»åå»ºçåæ¬ç»æ­¢ç¶æçå®¹å¨ï¼å¦ææ°éå¤ªå¤è¦ä¸ä¸ªä¸ªå é¤å¯è½ä¼å¾éº»ç¦ï¼ç¨ä¸é¢çå½ä»¤å¯ä»¥æ¸çæææå¤äºç»æ­¢ç¶æçå®¹å¨ã\n\n$ docker container prune\n\n\n1\n\n\n\n# Dockerå¶ä»å¸¸ç¨å½ä»¤è¡¥å\n\n\n\n\n# å¸®å©å½ä»¤\n\ndocker version\t# dockerçæ¬ä¿¡æ¯\ndocker info\t\t# ç³»ç»çº§å«çä¿¡æ¯ï¼åæ¬éååå®¹å¨çæ°é\ndocker --help\ndocker å½ä»¤ --help\n\n\n1\n2\n3\n4\n\n\ndocker å½ä»¤å¸®å©ææ¡£\n\n\n# éåå½ä»¤\n\n * docker images\n\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nhello-world         latest              bf756fb1ae65        7 months ago        13.3kB\n\n# å¯éé¡¹\n--all , -a\t\t# ååºææéå\n--quiet , -q\t# åªæ¾ç¤ºéåçid\n\n\n1\n2\n3\n4\n5\n6\n7\n\n * docker search\n\n--filter=STARS=3000\t\t# æç´ åºæ¥çéåå°±æ¯STARSå¤§äº3000ç\n\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker search mysql --filter=STARS=3000\nNAME                DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED\nmysql               MySQL is a widely used, open-source relationâ¦   9822                [OK]                \nmariadb             MariaDB is a community-developed fork of MySâ¦   3586                [OK]\n\n\n1\n2\n3\n4\n5\n6\n\n * docker rmi\n\ndocker rmi -f imageId# å é¤æå®éå\ndocker rmi -f imageId1 imageId2 imageId3\t# å é¤å¤ä¸ªéå\ndocker rmi -f $(docker images -aq)\t\t\t# å é¤ææéå\n\n\n1\n2\n3\n\n\n\n# å®¹å¨å½ä»¤\n\nè¿è¡å®¹å¨\n\ndocker run [å¯éåæ°] image\n\n# åæ°è¯´æ\n--name=âNameâ\tå®¹å¨åå­\ttomcat01 tomcat02\tç¨æ¥åºåå®¹å¨\n-d\t\tåå°æ¹å¼è¿è¡\n-it\t\tä½¿ç¨äº¤äºæ¹å¼è¿è¡ï¼è¿å¥å®¹å¨æ¥çåå®¹\n-p\t\tPublish a container\'s port(s) to the host\t-p 8080:8080\n\t-p\tip:ä¸»æºç«¯å£:å®¹å¨ç«¯å£\n\t-p\tä¸»æºç«¯å£:å®¹å¨ç«¯å£ï¼å¸¸ç¨ï¼\n\t-P\tPublish all exposed ports to random ports\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nååºææçè¿è¡çå®¹å¨\n\n# docker ps å½ä»¤\n\t\t# ååºå½åæ­£å¨è¿è¡çå®¹å¨\n-a\t\t# ååºæ­£å¨è¿è¡çå®¹å¨åæ¬åå²å®¹å¨\n-n=?\t# æ¾ç¤ºæè¿åå»ºçå®¹å¨\n-q\t\t# åªæ¾ç¤ºå½åå®¹å¨çç¼å·\n\n[root@iZ2zeg4ytp0whqtmxbsqiiZ /]# docker ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\n[root@iZ2zeg4ytp0whqtmxbsqiiZ /]# docker ps -a\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                     PORTS               NAMES\n77969f5dcbf9        centos              "/bin/bash"         5 minutes ago       Exited (0) 5 minutes ago                       xenodochial_bose\n74e82b7980e7        centos              "/bin/bash"         16 minutes ago      Exited (0) 6 minutes ago                       silly_cori\na57250395804        bf756fb1ae65        "/hello"            7 hours ago         Exited (0) 7 hours ago                         elated_nash\n392d674f4f18        bf756fb1ae65        "/hello"            8 hours ago         Exited (0) 8 hours ago                         distracted_mcnulty\n571d1bc0e8e8        bf756fb1ae65        "/hello"            23 hours ago        Exited (0) 23 hours ago                        magical_burnell\n\n[root@iZ2zeg4ytp0whqtmxbsqiiZ /]# docker ps -qa\n77969f5dcbf9\n74e82b7980e7\na57250395804\n392d674f4f18\n571d1bc0e8e8\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\néåºå®¹å¨\n\nexit \t\t\t# ç´æ¥éåºå®¹å¨å¹¶å³é­\nCtrl + P + Q\t# å®¹å¨ä¸å³é­éåº\n\n\n1\n2\n\n\nå é¤å®¹å¨docker\n\ndocker rm -f å®¹å¨id                  # å é¤æå®å®¹å¨\ndocker rm -f $(docker ps -aq)\t\t# å é¤ææå®¹å¨\ndocker ps -aq | xargs docker rm -f\t# å é¤ææå®¹å¨\n\n\n1\n2\n3\n\n\nå¯å¨ååæ­¢å®¹å¨çæä½\n\ndocker start å®¹å¨id\t\t\t# å¯å¨å®¹å¨\ndocker restart å®¹å¨id\t\t\t# éå¯å®¹å¨\ndocker stop å®¹å¨id\t\t\t# åæ­¢å½åæ­£å¨è¿è¡çå®¹å¨\ndocker kill å®¹å¨id\t\t\t# å¼ºå¶åæ­¢å½åçå®¹å¨\n\n\n1\n2\n3\n4\n\n\n\n# å¸¸ç¨çå¶ä»å½ä»¤\n\næ¥çæ¥å¿\n\ndocker logs -tf --tail number å®¹å¨id\n\n[root@localhost ~]# docker logs --help\n\nUsage:  docker logs [OPTIONS] CONTAINER\n\nFetch the logs of a container\n\nOptions:\n      --details        Show extra details provided to logs\n  -f, --follow         Follow log output\n      --since string   Show logs since timestamp (e.g. 2013-01-02T13:23:37Z) or relative (e.g. 42m for 42 minutes)\n  -n, --tail string    Number of lines to show from the end of the logs (default "all")\n  -t, --timestamps     Show timestamps\n      --until string   Show logs before a timestamp (e.g. 2013-01-02T13:23:37Z) or relative (e.g. 42m for 42 minutes)\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\næ¥çå®¹å¨ä¸­è¿ç¨ä¿¡æ¯ps\n\n# å½ä»¤ docker top å®¹å¨id\n[root@iZ2zeg4ytp0whqtmxbsqiiZ /]# docker top df358bc06b17              ?\n\n\n1\n2\n\n\næ¥çéåçåæ°æ®\n\n# å½ä»¤\ndocker inspect å®¹å¨id\n\n[root@iZ2zeg4ytp0whqtmxbsqiiZ /]# docker inspect df358bc06b17\n[\n    {\n        "Id": "df358bc06b17ef44f215d35d9f46336b28981853069a3739edfc6bd400f99bf3",\n        "Created": "2020-08-11T11:38:34.935048603Z",\n        "Path": "/bin/bash",\n        "Args": [],\n        "State": {\n            "Status": "running",\n            "Running": true,\n            "Paused": false,\n            "Restarting": false,\n            "OOMKilled": false,\n            "Dead": false,\n            "Pid": 28498,\n            "ExitCode": 0,\n            "Error": "",\n            "StartedAt": "2020-08-11T11:38:35.216616071Z",\n            "FinishedAt": "0001-01-01T00:00:00Z"\n        },\n        "Image": "sha256:0d120b6ccaa8c5e149176798b3501d4dd1885f961922497cd0abef155c869566",\n        "ResolvConfPath": "/var/lib/docker/containers/df358bc06b17ef44f215d35d9f46336b28981853069a3739edfc6bd400f99bf3/resolv.conf",\n        "HostnamePath": "/var/lib/docker/containers/df358bc06b17ef44f215d35d9f46336b28981853069a3739edfc6bd400f99bf3/hostname",\n        "HostsPath": "/var/lib/docker/containers/df358bc06b17ef44f215d35d9f46336b28981853069a3739edfc6bd400f99bf3/hosts",\n        "LogPath": "/var/lib/docker/containers/df358bc06b17ef44f215d35d9f46336b28981853069a3739edfc6bd400f99bf3/df358bc06b17ef44f215d35d9f46336b28981853069a3739edfc6bd400f99bf3-json.log",\n        "Name": "/hungry_heisenberg",\n        "RestartCount": 0,\n        "Driver": "overlay2",\n        "Platform": "linux",\n        "MountLabel": "",\n        "ProcessLabel": "",\n        "AppArmorProfile": "",\n        "ExecIDs": null,\n        "HostConfig": {\n            "Binds": null,\n            "ContainerIDFile": "",\n            "LogConfig": {\n                "Type": "json-file",\n                "Config": {}\n            },\n            "NetworkMode": "default",\n            "PortBindings": {},\n            "RestartPolicy": {\n                "Name": "no",\n                "MaximumRetryCount": 0\n            },\n            "AutoRemove": false,\n            "VolumeDriver": "",\n            "VolumesFrom": null,\n            "CapAdd": null,\n            "CapDrop": null,\n            "Capabilities": null,\n            "Dns": [],\n            "DnsOptions": [],\n            "DnsSearch": [],\n            "ExtraHosts": null,\n            "GroupAdd": null,\n            "IpcMode": "private",\n            "Cgroup": "",\n            "Links": null,\n            "OomScoreAdj": 0,\n            "PidMode": "",\n            "Privileged": false,\n            "PublishAllPorts": false,\n            "ReadonlyRootfs": false,\n            "SecurityOpt": null,\n            "UTSMode": "",\n            "UsernsMode": "",\n            "ShmSize": 67108864,\n            "Runtime": "runc",\n            "ConsoleSize": [\n                0,\n                0\n            ],\n            "Isolation": "",\n            "CpuShares": 0,\n            "Memory": 0,\n            "NanoCpus": 0,\n            "CgroupParent": "",\n            "BlkioWeight": 0,\n            "BlkioWeightDevice": [],\n            "BlkioDeviceReadBps": null,\n            "BlkioDeviceWriteBps": null,\n            "BlkioDeviceReadIOps": null,\n            "BlkioDeviceWriteIOps": null,\n            "CpuPeriod": 0,\n            "CpuQuota": 0,\n            "CpuRealtimePeriod": 0,\n            "CpuRealtimeRuntime": 0,\n            "CpusetCpus": "",\n            "CpusetMems": "",\n            "Devices": [],\n            "DeviceCgroupRules": null,\n            "DeviceRequests": null,\n            "KernelMemory": 0,\n            "KernelMemoryTCP": 0,\n            "MemoryReservation": 0,\n            "MemorySwap": 0,\n            "MemorySwappiness": null,\n            "OomKillDisable": false,\n            "PidsLimit": null,\n            "Ulimits": null,\n            "CpuCount": 0,\n            "CpuPercent": 0,\n            "IOMaximumIOps": 0,\n            "IOMaximumBandwidth": 0,\n            "MaskedPaths": [\n                "/proc/asound",\n                "/proc/acpi",\n                "/proc/kcore",\n                "/proc/keys",\n                "/proc/latency_stats",\n                "/proc/timer_list",\n                "/proc/timer_stats",\n                "/proc/sched_debug",\n                "/proc/scsi",\n                "/sys/firmware"\n            ],\n            "ReadonlyPaths": [\n                "/proc/bus",\n                "/proc/fs",\n                "/proc/irq",\n                "/proc/sys",\n                "/proc/sysrq-trigger"\n            ]\n        },\n        "GraphDriver": {\n            "Data": {\n                "LowerDir": "/var/lib/docker/overlay2/5af8a2aadbdba9e1e066331ff4bce56398617710a22ef906f9ce4d58bde2d360-init/diff:/var/lib/docker/overlay2/62926d498bd9d1a6684bb2f9920fb77a2f88896098e66ef93c4b74fcb19f29b6/diff",\n                "MergedDir": "/var/lib/docker/overlay2/5af8a2aadbdba9e1e066331ff4bce56398617710a22ef906f9ce4d58bde2d360/merged",\n                "UpperDir": "/var/lib/docker/overlay2/5af8a2aadbdba9e1e066331ff4bce56398617710a22ef906f9ce4d58bde2d360/diff",\n                "WorkDir": "/var/lib/docker/overlay2/5af8a2aadbdba9e1e066331ff4bce56398617710a22ef906f9ce4d58bde2d360/work"\n            },\n            "Name": "overlay2"\n        },\n        "Mounts": [],\n        "Config": {\n            "Hostname": "df358bc06b17",\n            "Domainname": "",\n            "User": "",\n            "AttachStdin": true,\n            "AttachStdout": true,\n            "AttachStderr": true,\n            "Tty": true,\n            "OpenStdin": true,\n            "StdinOnce": true,\n            "Env": [\n                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"\n            ],\n            "Cmd": [\n                "/bin/bash"\n            ],\n            "Image": "centos",\n            "Volumes": null,\n            "WorkingDir": "",\n            "Entrypoint": null,\n            "OnBuild": null,\n            "Labels": {\n                "org.label-schema.build-date": "20200809",\n                "org.label-schema.license": "GPLv2",\n                "org.label-schema.name": "CentOS Base Image",\n                "org.label-schema.schema-version": "1.0",\n                "org.label-schema.vendor": "CentOS"\n            }\n        },\n        "NetworkSettings": {\n            "Bridge": "",\n            "SandboxID": "4822f9ac2058e8415ebefbfa73f05424fe20cc8280a5720ad3708fa6e80cdb08",\n            "HairpinMode": false,\n            "LinkLocalIPv6Address": "",\n            "LinkLocalIPv6PrefixLen": 0,\n            "Ports": {},\n            "SandboxKey": "/var/run/docker/netns/4822f9ac2058",\n            "SecondaryIPAddresses": null,\n            "SecondaryIPv6Addresses": null,\n            "EndpointID": "5fd269c0a28227241e40cd30658e3ffe8ad6cc3e6514917c867d89d36a31d605",\n            "Gateway": "172.17.0.1",\n            "GlobalIPv6Address": "",\n            "GlobalIPv6PrefixLen": 0,\n            "IPAddress": "172.17.0.2",\n            "IPPrefixLen": 16,\n            "IPv6Gateway": "",\n            "MacAddress": "02:42:ac:11:00:02",\n            "Networks": {\n                "bridge": {\n                    "IPAMConfig": null,\n                    "Links": null,\n                    "Aliases": null,\n                    "NetworkID": "30d6017888627cb565618b1639fecf8fc97e1ae4df5a9fd5ddb046d8fb02b565",\n                    "EndpointID": "5fd269c0a28227241e40cd30658e3ffe8ad6cc3e6514917c867d89d36a31d605",\n                    "Gateway": "172.17.0.1",\n                    "IPAddress": "172.17.0.2",\n                    "IPPrefixLen": 16,\n                    "IPv6Gateway": "",\n                    "GlobalIPv6Address": "",\n                    "GlobalIPv6PrefixLen": 0,\n                    "MacAddress": "02:42:ac:11:00:02",\n                    "DriverOpts": null\n                }\n            }\n        }\n    }\n]\n[root@iZ2zeg4ytp0whqtmxbsqiiZ /]#\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n99\n100\n101\n102\n103\n104\n105\n106\n107\n108\n109\n110\n111\n112\n113\n114\n115\n116\n117\n118\n119\n120\n121\n122\n123\n124\n125\n126\n127\n128\n129\n130\n131\n132\n133\n134\n135\n136\n137\n138\n139\n140\n141\n142\n143\n144\n145\n146\n147\n148\n149\n150\n151\n152\n153\n154\n155\n156\n157\n158\n159\n160\n161\n162\n163\n164\n165\n166\n167\n168\n169\n170\n171\n172\n173\n174\n175\n176\n177\n178\n179\n180\n181\n182\n183\n184\n185\n186\n187\n188\n189\n190\n191\n192\n193\n194\n195\n196\n197\n198\n199\n200\n201\n202\n203\n204\n205\n206\n207\n\n\nå¨å®¹å¨åä¸»æºé´ç¸äºæ·è´æä»¶\n\nUsage:  \ndocker cp [OPTIONS] CONTAINER:SRC_PATH DEST_PATH|-\ndocker cp [OPTIONS] SRC_PATH|- CONTAINER:DEST_PATH\n\n[root@iZ2zeg4ytp0whqtmxbsqiiZ /]# docker cp 7af535f807e0:/home/Test.java /home\n\n\n1\n2\n3\n4\n5\n',normalizedContent:'# docker ç®ä»\n\ndocker ä½¿ç¨ google å¬å¸æ¨åºç go è¯­è¨ è¿è¡å¼åå®ç°ï¼åºäº linux åæ ¸ç cgroupï¼namespaceï¼ä»¥å overlayfs ç±»ç union fs ç­ææ¯ï¼å¯¹è¿ç¨è¿è¡å°è£éç¦»ï¼å±äº æä½ç³»ç»å±é¢çèæåææ¯ãç±äºéç¦»çè¿ç¨ç¬ç«äºå®¿ä¸»åå¶å®çéç¦»çè¿ç¨ï¼å æ­¤ä¹ç§°å¶ä¸ºå®¹å¨ã\n\n\n\n * bç«çç¥dockerè§é¢æç¨\n\n * dockerå®ç½\n\n * dockerå®æ¹ææ¡£\n\n * dockerå®æ¹éåä»åº\n\n\n# dockeråä¼ ç»èæåæ¹å¼å¯¹æ¯\n\nä¼ ç»èææºææ¯æ¯èæåºä¸å¥ç¡¬ä»¶åï¼å¨å¶ä¸è¿è¡ä¸ä¸ªå®æ´æä½ç³»ç»ï¼å¨è¯¥ç³»ç»ä¸åè¿è¡æéåºç¨è¿ç¨ï¼èå®¹å¨åçåºç¨è¿ç¨ç´æ¥è¿è¡äºå®¿ä¸»çåæ ¸ï¼å®¹å¨åæ²¡æèªå·±çåæ ¸ï¼èä¸ä¹æ²¡æè¿è¡ç¡¬ä»¶èæãå æ­¤å®¹å¨è¦æ¯ä¼ ç»èææºæ´ä¸ºè½»ä¾¿ã\n\nä¸é¢çå¾çæ¯è¾äº docker åä¼ ç»èæåæ¹å¼çä¸åä¹å¤ã\n\n\n\n\n\nå¯¹æ¯æ»ç»\n\nç¹æ§      å®¹å¨          èææº\nå¯å¨      ç§çº§          åéçº§\nç¡¬çä½¿ç¨    ä¸è¬ä¸º mb      ä¸è¬ä¸º gb\næ§è½      æ¥è¿åç        å¼±äº\nç³»ç»æ¯æé   åæºæ¯æä¸åä¸ªå®¹å¨   ä¸è¬å åä¸ª\n\n\n# dockeråºæ¬æ¦å¿µ\n\ndocker åæ¬ä¸ä¸ªåºæ¬æ¦å¿µ\n\n * éåï¼imageï¼\n * å®¹å¨ï¼containerï¼\n * ä»åºï¼repositoryï¼\n\n\n# éå\n\næä»¬é½ç¥éï¼æä½ç³»ç»åä¸º åæ ¸ å ç¨æ·ç©ºé´ãå¯¹äº linux èè¨ï¼åæ ¸å¯å¨åï¼ä¼æè½½ root æä»¶ç³»ç»ä¸ºå¶æä¾ç¨æ·ç©ºé´æ¯æãè docker éåï¼imageï¼ï¼å°±ç¸å½äºæ¯ä¸ä¸ª root æä»¶ç³»ç»ã\n\ndocker éå æ¯ä¸ä¸ªç¹æ®çæä»¶ç³»ç»ï¼é¤äºæä¾å®¹å¨è¿è¡æ¶æéçç¨åºãåºãèµæºãéç½®ç­æä»¶å¤ï¼è¿åå«äºä¸äºä¸ºè¿è¡æ¶åå¤çä¸äºéç½®åæ°ï¼å¦å¿åå·ãç¯å¢åéãç¨æ·ç­ï¼ãéå ä¸åå« ä»»ä½å¨ææ°æ®ï¼å¶åå®¹å¨æå»ºä¹åä¹ä¸ä¼è¢«æ¹åã\n\nåå±å­å¨\n\nå ä¸ºéååå«æä½ç³»ç»å®æ´ç root æä»¶ç³»ç»ï¼å¶ä½ç§¯å¾å¾æ¯åºå¤§çï¼å æ­¤å¨ docker è®¾è®¡æ¶ï¼å°±ååå©ç¨ union fs çææ¯ï¼å°å¶è®¾è®¡ä¸ºåå±å­å¨çæ¶æã\n\néåæå»ºæ¶ï¼ä¼ä¸å±å±æå»ºï¼åä¸å±æ¯åä¸å±çåºç¡ãæ¯ä¸å±æå»ºå®å°±ä¸ä¼ååçæ¹åï¼åä¸å±ä¸çä»»ä½æ¹ååªåçå¨èªå·±è¿ä¸å±ãæ¯å¦ï¼å é¤åä¸å±æä»¶çæä½ï¼å®éä¸æ¯ççå é¤åä¸å±çæä»¶ï¼èæ¯ä»å¨å½åå±æ è®°ä¸ºè¯¥æä»¶å·²å é¤ãå¨æç»å®¹å¨è¿è¡çæ¶åï¼è½ç¶ä¸ä¼çå°è¿ä¸ªæä»¶ï¼ä½æ¯å®éä¸è¯¥æä»¶ä¼ä¸ç´è·ééåãå æ­¤ï¼å¨æå»ºéåçæ¶åï¼éè¦é¢å¤å°å¿ï¼æ¯ä¸å±å°½éåªåå«è¯¥å±éè¦æ·»å çä¸è¥¿ï¼ä»»ä½é¢å¤çä¸è¥¿åºè¯¥å¨è¯¥å±æå»ºç»æåæ¸çæã\n\nåå±å­å¨çç¹å¾è¿ä½¿å¾éåçå¤ç¨ãå®å¶åçæ´ä¸ºå®¹æãæ¯å¦å¯ä»¥ç¨ä¹åæå»ºå¥½çéåä½ä¸ºåºç¡å±ï¼ç¶åè¿ä¸æ­¥æ·»å æ°çå±ï¼æå»ºæ°çéåã\n\n\n# å®¹å¨\n\néåï¼imageï¼åå®¹å¨ï¼containerï¼çå³ç³»ï¼å°±åæ¯é¢åå¯¹è±¡ç¨åºè®¾è®¡ä¸­ç ç±» å å®ä¾ ä¸æ ·ï¼éåæ¯éæçå®ä¹ï¼å®¹å¨æ¯éåè¿è¡æ¶çå®ä½ãå®¹å¨å¯ä»¥è¢«åå»ºãå¯å¨ãåæ­¢ãå é¤ãæåç­ã\n\nå®¹å¨çå®è´¨æ¯è¿ç¨ï¼ä½ä¸ç´æ¥å¨å®¿ä¸»æ§è¡çè¿ç¨ä¸åï¼å®¹å¨è¿ç¨è¿è¡äºå±äºèªå·±çç¬ç«ç å½åç©ºé´ãå æ­¤å®¹å¨å¯ä»¥æ¥æèªå·±ç root æä»¶ç³»ç»ãèªå·±çç½ç»éç½®ãèªå·±çè¿ç¨ç©ºé´ï¼çè³èªå·±çç¨æ· id ç©ºé´ã\n\nå®¹å¨ä¹éç¨åå±å­å¨ãæ¯ä¸ä¸ªå®¹å¨è¿è¡æ¶ï¼æ¯ä»¥éåä¸ºåºç¡å±ï¼å¨å¶ä¸åå»ºä¸ä¸ªå½åå®¹å¨çå­å¨å±ï¼æä»¬å¯ä»¥ç§°è¿ä¸ªä¸ºå®¹å¨è¿è¡æ¶è¯»åèåå¤çå­å¨å±ä¸º å®¹å¨å­å¨å±ã\n\nå®¹å¨å­å¨å±ççå­å¨æåå®¹å¨ä¸æ ·ï¼å®¹å¨æ¶äº¡æ¶ï¼å®¹å¨å­å¨å±ä¹éä¹æ¶äº¡ãå æ­¤ï¼ä»»ä½ä¿å­äºå®¹å¨å­å¨å±çä¿¡æ¯é½ä¼éå®¹å¨å é¤èä¸¢å¤±ã\n\næç§ docker æä½³å®è·µçè¦æ±ï¼å®¹å¨ä¸åºè¯¥åå¶å­å¨å±ååå¥ä»»ä½æ°æ®ï¼å®¹å¨å­å¨å±è¦ä¿ææ ç¶æåãææçæä»¶åå¥æä½ï¼é½åºè¯¥ä½¿ç¨ æ°æ®å·ï¼volumeï¼ãæè ç»å®å®¿ä¸»ç®å½ï¼å¨è¿äºä½ç½®çè¯»åä¼è·³è¿å®¹å¨å­å¨å±ï¼ç´æ¥å¯¹å®¿ä¸»ï¼æç½ç»å­å¨ï¼åçè¯»åï¼å¶æ§è½åç¨³å®æ§æ´é«ã\n\næ°æ®å·ççå­å¨æç¬ç«äºå®¹å¨ï¼å®¹å¨æ¶äº¡ï¼æ°æ®å·ä¸ä¼æ¶äº¡ãå æ­¤ï¼ä½¿ç¨æ°æ®å·åï¼å®¹å¨å é¤æèéæ°è¿è¡ä¹åï¼æ°æ®å´ä¸ä¼ä¸¢å¤±ã\n\n\n# ä»åº\n\nä¸ä¸ª docker registry ä¸­å¯ä»¥åå«å¤ä¸ª ä»åºï¼repositoryï¼ï¼æ¯ä¸ªä»åºå¯ä»¥åå«å¤ä¸ª æ ç­¾ï¼tagï¼ï¼æ¯ä¸ªæ ç­¾å¯¹åºä¸ä¸ªéåã\n\néå¸¸ï¼ä¸ä¸ªä»åºä¼åå«åä¸ä¸ªè½¯ä»¶ä¸åçæ¬çéåï¼èæ ç­¾å°±å¸¸ç¨äºå¯¹åºè¯¥è½¯ä»¶çåä¸ªçæ¬ãæä»¬å¯ä»¥éè¿ <ä»åºå>:<æ ç­¾> çæ ¼å¼æ¥æå®å·ä½æ¯è¿ä¸ªè½¯ä»¶åªä¸ªçæ¬çéåãå¦æä¸ç»åºæ ç­¾ï¼å°ä»¥ latest ä½ä¸ºé»è®¤æ ç­¾ã\n\nä»¥ ubuntu éå ä¸ºä¾ï¼ubuntu æ¯ä»åºçåå­ï¼å¶ååå«æä¸åççæ¬æ ç­¾ï¼å¦ï¼16.04, 18.04ãæä»¬å¯ä»¥éè¿ ubuntu:16.04ï¼æè ubuntu:18.04 æ¥å·ä½æå®æéåªä¸ªçæ¬çéåãå¦æå¿½ç¥äºæ ç­¾ï¼æ¯å¦ ubuntuï¼é£å°è§ä¸º ubuntu:latestã\n\nä»åºåç»å¸¸ä»¥ ä¸¤æ®µå¼è·¯å¾ å½¢å¼åºç°ï¼æ¯å¦ jwilder/nginx-proxyï¼åèå¾å¾æå³ç docker registry å¤ç¨æ·ç¯å¢ä¸çç¨æ·åï¼åèåå¾å¾æ¯å¯¹åºçè½¯ä»¶åãä½è¿å¹¶éç»å¯¹ï¼åå³äºæä½¿ç¨çå·ä½ docker registry çè½¯ä»¶ææå¡ã\n\n\n# docker registry å¬å¼æå¡\n\næå¸¸ä½¿ç¨ç registry å¬å¼æå¡æ¯å®æ¹ç docker hubï¼è¿ä¹æ¯é»è®¤ç registryï¼å¹¶æ¥æå¤§éçé«è´¨éç å®æ¹éåã\n\nç±äºæäºåå ï¼å¨å½åè®¿é®è¿äºæå¡å¯è½ä¼æ¯è¾æ¢ãå½åçä¸äºäºæå¡åæä¾äºéå¯¹ docker hub çéåæå¡ï¼registry mirrorï¼ï¼è¿äºéåæå¡è¢«ç§°ä¸º å éå¨ãå¸¸è§çæ é¿éäºå éå¨ãdaocloud å éå¨ ç­ãä½¿ç¨å éå¨ä¼ç´æ¥ä»å½åçå°åä¸è½½ docker hub çéåï¼æ¯ç´æ¥ä» docker hub ä¸è½½éåº¦ä¼æé«å¾å¤ã\n\nå½åä¹æä¸äºäºæå¡åæä¾ç±»ä¼¼äº docker hub çå¬å¼æå¡ãæ¯å¦ ç½æäºéåæå¡ãdaocloud éåå¸åºãé¿éäºéååº ç­ã\n\n\n# ç§æ docker registry\n\né¤äºä½¿ç¨å¬å¼æå¡å¤ï¼ç¨æ·è¿å¯ä»¥å¨æ¬å°æ­å»ºç§æ docker registryãdocker å®æ¹æä¾äº docker registry éåï¼å¯ä»¥ç´æ¥ä½¿ç¨åä¸ºç§æ registry æå¡ã\n\né¤äºå®æ¹ç docker registry å¤ï¼è¿æç¬¬ä¸æ¹è½¯ä»¶å®ç°äº docker registry apiï¼çè³æä¾äºç¨æ·çé¢ä»¥åä¸äºé«çº§åè½ãæ¯å¦ï¼harbor å sonatype nexusã\n\n\n# åºå±åç\n\n\n\n * helloworldéå\n\n\n\n * åºå±åç docker engineæ¯ä¸ä¸ªå®¢æ·ç«¯-æå¡å¨åºç¨ç¨åºï¼å·æä»¥ä¸ä¸»è¦ç»ä»¶:\n\n * * ä¸ä¸ªæå¡å¨ï¼å®æ¯ä¸ç§é¿æè¿è¡çç¨åºï¼ç§°ä¸ºå®æ¤è¿ç¨(dockerdå½ä»¤)\n   * ä¸ä¸ªrest apiï¼å®æå®ç¨åºå¯ä»¥ç¨æ¥ä¸å®æ¤è¿ç¨å¯¹è¯å¹¶æç¤ºå®åä»ä¹çæ¥å£ã\n\ndockeræ¯ä¸ä¸ªclient serverç»æçç³»ç»ï¼dockerå®æ¤è¿ç¨è¿è¡å¨ä¸»æºä¸ï¼ç¶åéè¿socketè¿æ¥ä»å®¢æ· ç«¯è®¿é®ï¼å®æ¤è¿ç¨ä»å®¢æ·ç«¯æ¥åå½ä»¤å¹¶ç®¡çè¿è¡å¨ä¸»æºä¸çå®¹å¨ãå®¹å¨ï¼æ¯ä¸ä¸ªè¿è¡æ¶ç¯å¢å°±æ¯æä»¬æè¯´çéè£ç®±ã\n\n * ä¸ºä»ä¹dockeræ¯vmå¿«\n\n * * dockeræçæ¯èææºæ´å°çæ½è±¡å±ãç±äºdockerä¸éè¦hypervisorå®ç°ç¡¬ä»¶èµæºèæå,*è¿è¡å¨dockerå®¹å¨ä¸çç¨åºç´æ¥ä½¿ç¨çé½æ¯å®éç©çæºçç¡¬ä»¶èµæº*ãå æ­¤å¨cpuãåå­å©ç¨çä¸dockerå°ä¼å¨æçä¸æææ¾ä¼å¿ã\n   * dockerå©ç¨çæ¯å®¿ä¸»æºçåæ ¸,èä¸éè¦guest osãå æ­¤,å½æ°å»ºä¸ä¸ª å®¹å¨æ¶,dockerä¸éè¦åèææºä¸æ ·éæ°å è½½ä¸ä¸ªæä½ç³»ç»åæ ¸ãä»èé¿åå¼å¯»ãå è½½æä½ç³»ç»åæ ¸è¿ä¸ªæ¯è¾è´¹æ¶è´¹èµæºçè¿ç¨,å½æ°å»ºä¸ä¸ªèææºæ¶,èææºè½¯ä»¶éè¦å è½½guestos,è¿ä¸ªæ°å»ºè¿ç¨æ¯åéçº§å«çãèdockerç±äºç´æ¥å©ç¨å®¿ä¸»æºçæä½ç³»ç»,åçç¥äºè¿ä¸ªè¿ç¨,å æ­¤æ°å»ºä¸ä¸ªdockerå®¹å¨åªéè¦å ç§éã\n\n\n\n\n# dockerå®è£\n\n\n# åå¤å·¥ä½\n\n\n# ç³»ç»è¦æ±\n\ndocker æ¯æ 64 ä½çæ¬ centos 7/8ï¼å¹¶ä¸è¦æ±åæ ¸çæ¬ä¸ä½äº 3.10ã centos 7 æ»¡è¶³æä½åæ ¸çè¦æ±ï¼ä½ç±äºåæ ¸çæ¬æ¯è¾ä½ï¼é¨ååè½ï¼å¦ overlay2 å­å¨å±é©±å¨ï¼æ æ³ä½¿ç¨ï¼å¹¶ä¸é¨ååè½å¯è½ä¸å¤ªç¨³å®ã\n\n\n# å¸è½½æ§çæ¬\n\næ§çæ¬ç docker ç§°ä¸º docker æè docker-engineï¼ä½¿ç¨ä»¥ä¸å½ä»¤å¸è½½æ§çæ¬ï¼\n\n$ sudo yum remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-selinux \\\n                  docker-engine-selinux \\\n                  docker-engine\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# ä½¿ç¨ yum å®è£\n\næ§è¡ä»¥ä¸å½ä»¤å®è£ä¾èµåï¼\n\n$ sudo yum install -y yum-utils\n\n\n1\n\n\né´äºå½åç½ç»é®é¢ï¼å¼ºçå»ºè®®ä½¿ç¨å½åæºã\n\næ§è¡ä¸é¢çå½ä»¤æ·»å  yum è½¯ä»¶æºï¼\n\n$ sudo yum-config-manager \\\n    --add-repo \\\n    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n\n$ sudo sed -i \'s/download.docker.com/mirrors.aliyun.com\\/docker-ce/g\' /etc/yum.repos.d/docker-ce.repo\n\n# å®æ¹æº\n# $ sudo yum-config-manager \\\n#     --add-repo \\\n#     https://download.docker.com/linux/centos/docker-ce.repo\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# å®è£ docker\n\næ´æ° yum è½¯ä»¶æºç¼å­ï¼å¹¶å®è£ docker-ceã\n\n$ sudo yum install docker-ce docker-ce-cli containerd.io\n\n\n1\n\n\n\n# centos8 é¢å¤è®¾ç½®\n\nç±äº centos8 é²ç«å¢ä½¿ç¨äº nftablesï¼ä½ docker å°æªæ¯æ nftablesï¼ æä»¬å¯ä»¥ä½¿ç¨å¦ä¸è®¾ç½®ä½¿ç¨ iptablesï¼\n\næ´æ¹ /etc/firewalld/firewalld.conf\n\n# firewallbackend=nftables\nfirewallbackend=iptables\n\n\n1\n2\n\n\næèæ§è¡å¦ä¸å½ä»¤ï¼\n\n$ firewall-cmd --permanent --zone=trusted --add-interface=docker0\n\n$ firewall-cmd --reload\n\n\n1\n2\n3\n\n\n\n# å¯å¨ docker\n\n$ sudo systemctl enable docker\n$ sudo systemctl start docker\n\n\n1\n2\n\n\n\n# å»ºç« docker ç¨æ·ç»\n\né»è®¤æåµä¸ï¼docker å½ä»¤ä¼ä½¿ç¨ unix socket ä¸ docker å¼æéè®¯ãèåªæ root ç¨æ·å docker ç»çç¨æ·æå¯ä»¥è®¿é® docker å¼æç unix socketãåºäºå®å¨èèï¼ä¸è¬ linux ç³»ç»ä¸ä¸ä¼ç´æ¥ä½¿ç¨ root ç¨æ·ãå æ­¤ï¼æ´å¥½å°åæ³æ¯å°éè¦ä½¿ç¨ docker çç¨æ·å å¥ docker ç¨æ·ç»ã\n\nå»ºç« docker ç»ï¼\n\n$ sudo groupadd docker\n\n\n1\n\n\nå°å½åç¨æ·å å¥ docker ç»ï¼\n\n$ sudo usermod -ag docker $user\n\n\n1\n\n\n\n# æµè¯ docker æ¯å¦å®è£æ­£ç¡®\n\n$ docker run --rm hello-world\n\nunable to find image \'hello-world:latest\' locally\nlatest: pulling from library/hello-world\nb8dfde127a29: pull complete\ndigest: sha256:308866a43596e83578c7dfa15e27a73011bdd402185a84c5cd7f32a88b501a24\nstatus: downloaded newer image for hello-world:latest\n\nhello from docker!\nthis message shows that your installation appears to be working correctly.\n\nto generate this message, docker took the following steps:\n 1. the docker client contacted the docker daemon.\n 2. the docker daemon pulled the "hello-world" image from the docker hub.\n    (amd64)\n 3. the docker daemon created a new container from that image which runs the\n    executable that produces the output you are currently reading.\n 4. the docker daemon streamed that output to the docker client, which sent it\n    to your terminal.\n\nto try something more ambitious, you can run an ubuntu container with:\n $ docker run -it ubuntu bash\n\nshare images, automate workflows, and more with a free docker id:\n https://hub.docker.com/\n\nfor more examples and ideas, visit:\n https://docs.docker.com/get-started/\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n\nè¥è½æ­£å¸¸è¾åºä»¥ä¸ä¿¡æ¯ï¼åè¯´æå®è£æåã\n\n\n# éåå éå¨\n\nå½åä» docker hub æåéåææ¶ä¼éå°å°é¾ï¼æ­¤æ¶å¯ä»¥éç½®éåå éå¨ãå½åå¾å¤äºæå¡åé½æä¾äºå½åå éå¨æå¡ï¼ä¾å¦ï¼\n\n * é¿éäºå éå¨(ç¹å»ç®¡çæ§å¶å° -> ç»å½è´¦å·(æ·å®è´¦å·) -> å³ä¾§éåå·¥å· -> éåå éå¨ -> å¤å¶å éå¨å°å)\n * ç½æäºå éå¨ https://hub-mirror.c.163.com\n * ç¾åº¦äºå éå¨ https://mirror.baidubce.com\n\nç±äºéåæå¡å¯è½åºç°å®æºï¼å»ºè®®åæ¶éç½®å¤ä¸ªéåã\n\nä»¥ ç½æäº éåæå¡ https://hub-mirror.c.163.com ä¸ºä¾è¿è¡ä»ç»ã\n\n\n# centos 7+\n\nç®åä¸»æµ linux åè¡çåå·²ä½¿ç¨ systemd è¿è¡æå¡ç®¡çï¼è¿éä»ç»å¦ä½å¨ä½¿ç¨ systemd ç linux åè¡çä¸­éç½®éåå éå¨ã\n\nè¯·é¦åæ§è¡ä»¥ä¸å½ä»¤ï¼æ¥çæ¯å¦å¨ docker.service æä»¶ä¸­éç½®è¿éåå°åã\n\n$ systemctl cat docker | grep \'\\-\\-registry\\-mirror\'\n\n\n1\n\n\nå¦æè¯¥å½ä»¤æè¾åºï¼é£ä¹è¯·æ§è¡ $ systemctl cat docker æ¥ç execstart= åºç°çä½ç½®ï¼ä¿®æ¹å¯¹åºçæä»¶åå®¹å»æ --registry-mirror åæ°åå¶å¼ï¼å¹¶ææ¥ä¸æ¥çæ­¥éª¤è¿è¡éç½®ã\n\nå¦æä»¥ä¸å½ä»¤æ²¡æä»»ä½è¾åºï¼é£ä¹å°±å¯ä»¥å¨ /etc/docker/daemon.json ä¸­åå¥å¦ä¸åå®¹ï¼å¦ææä»¶ä¸å­å¨è¯·æ°å»ºè¯¥æä»¶ï¼ï¼\n\n{\n  "registry-mirrors": [\n    "https://hub-mirror.c.163.com",\n    "https://mirror.baidubce.com"\n  ]\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\n> æ³¨æï¼ä¸å®è¦ä¿è¯è¯¥æä»¶ç¬¦å json è§èï¼å¦å docker å°ä¸è½å¯å¨ã\n\nä¹åéæ°å¯å¨æå¡ã\n\n$ sudo systemctl daemon-reload\n$ sudo systemctl restart docker\t\t\t\n\n\n1\n2\n\n\né¿éäºéåå ééç½®\n\nsudo mkdir -p /etc/docker\nsudo tee /etc/docker/daemon.json <<-\'eof\'\n{\n  "registry-mirrors": ["https://hub-mirror.c.163.com/", \t\t\t\t\t\t\t        \t\t\t\t\t"https://docker.mirrors.ustc.edu.cn/", \n   \t\t\t\t\t   "https://reg-mirror.qiniu.com"]\n}\neof\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# æ·»å åæ ¸åæ°\n\nå¦æå¨ centos ä½¿ç¨ docker çå°ä¸é¢çè¿äºè­¦åä¿¡æ¯ï¼\n\nwarning: bridge-nf-call-iptables is disabled\nwarning: bridge-nf-call-ip6tables is disabled\n\n\n1\n2\n\n\nè¯·æ·»å åæ ¸éç½®åæ°ä»¥å¯ç¨è¿äºåè½ã\n\n$ sudo tee -a /etc/sysctl.conf <<-eof\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\neof\n\n\n1\n2\n3\n4\n\n\n\n# ä½¿ç¨éå\n\n\n# è·åéå\n\nä» docker éåä»åºè·åéåçå½ä»¤æ¯ docker pullãå¶å½ä»¤æ ¼å¼ä¸ºï¼\n\n$ docker pull [éé¡¹] [docker registry å°å[:ç«¯å£å·]/]ä»åºå[:æ ç­¾]\t\t\t\t\t\n\n\n1\n\n\nå·ä½çéé¡¹å¯ä»¥éè¿ docker pull --help å½ä»¤çå°ï¼è¿éæä»¬è¯´ä¸ä¸éååç§°çæ ¼å¼ã\n\n * docker éåä»åºå°åï¼å°åçæ ¼å¼ä¸è¬æ¯ <åå/ip>[:ç«¯å£å·]ãé»è®¤å°åæ¯ docker hub(docker.io)ã\n * ä»åºåï¼å¦ä¹åæè¯´ï¼è¿éçä»åºåæ¯ä¸¤æ®µå¼åç§°ï¼å³ <ç¨æ·å>/<è½¯ä»¶å>ãå¯¹äº docker hubï¼å¦æä¸ç»åºç¨æ·åï¼åé»è®¤ä¸º libraryï¼ä¹å°±æ¯å®æ¹éåã\n\næ¯å¦ï¼\n\n$ docker pull ubuntu:18.04\n18.04: pulling from library/ubuntu\n92dc2a97ff99: pull complete\nbe13a9d27eb8: pull complete\nc8299583700a: pull complete\ndigest: sha256:4bc3ae6596938cb0d9e5ac51a1152ec9dcac2a1c50829c74abd9c4361e321b26\nstatus: downloaded newer image for ubuntu:18.04\ndocker.io/library/ubuntu:18.04\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢çå½ä»¤ä¸­æ²¡æç»åº docker éåä»åºå°åï¼å æ­¤å°ä¼ä» docker hub ï¼docker.ioï¼è·åéåãèéååç§°æ¯ ubuntu:18.04ï¼å æ­¤å°ä¼è·åå®æ¹éå library/ubuntu ä»åºä¸­æ ç­¾ä¸º 18.04 çéåãdocker pull å½ä»¤çè¾åºç»ææåä¸è¡ç»åºäºéåçå®æ´åç§°ï¼å³ï¼ docker.io/library/ubuntu:18.04ã\n\nè¿è¡\n\n$ docker run -it --rm ubuntu:18.04 bash\n\nroot@e7009c6ce357:/# cat /etc/os-release\nname="ubuntu"\nversion="18.04.1 lts (bionic beaver)"\nid=ubuntu\nid_like=debian\npretty_name="ubuntu 18.04.1 lts"\nversion_id="18.04"\nhome_url="https://www.ubuntu.com/"\nsupport_url="https://help.ubuntu.com/"\nbug_report_url="https://bugs.launchpad.net/ubuntu/"\nprivacy_policy_url="https://www.ubuntu.com/legal/terms-and-policies/privacy-policy"\nversion_codename=bionic\nubuntu_codename=bionic\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n * -itï¼è¿æ¯ä¸¤ä¸ªåæ°ï¼ä¸ä¸ªæ¯ -iï¼äº¤äºå¼æä½ï¼ä¸ä¸ªæ¯ -t ç»ç«¯ãæä»¬è¿éæç®è¿å¥ bash æ§è¡ä¸äºå½ä»¤å¹¶æ¥çè¿åç»æï¼å æ­¤æä»¬éè¦äº¤äºå¼ç»ç«¯ã\n * --rmï¼è¿ä¸ªåæ°æ¯è¯´å®¹å¨éåºåéä¹å°å¶å é¤ã\n * bashï¼æ¾å¨éåååçæ¯ å½ä»¤ï¼è¿éæä»¬å¸ææä¸ªäº¤äºå¼ shellï¼å æ­¤ç¨çæ¯ bashã\n\n\n# ååºéå\n\n$ docker image ls | docker images\nrepository           tag                 image id            created             size\nredis                latest              5f515359c7f8        5 days ago          183 mb\nnginx                latest              05a60462f8ba        5 days ago          181 mb\nmongo                3.2                 fe9198c04d62        5 days ago          342 mb\n<none>               <none>              00285df0df87        5 days ago          342 mb\nubuntu               18.04               329ed837d508        3 days ago          63.3mb\nubuntu               bionic              329ed837d508        3 days ago          63.3mb\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nåè¡¨åå«äº ä»åºåãæ ç­¾ãéå idãåå»ºæ¶é´ ä»¥å æå ç¨çç©ºé´ã\n\néå id åæ¯éåçå¯ä¸æ è¯ï¼ä¸ä¸ªéåå¯ä»¥å¯¹åºå¤ä¸ª æ ç­¾ãå æ­¤ï¼å¨ä¸é¢çä¾å­ä¸­ï¼æä»¬å¯ä»¥çå° ubuntu:18.04 å ubuntu:bionic æ¥æç¸åç idï¼å ä¸ºå®ä»¬å¯¹åºçæ¯åä¸ä¸ªéåã\n\n\n# éåä½ç§¯\n\nå¦æä»ç»è§å¯ï¼ä¼æ³¨æå°ï¼è¿éæ è¯çæå ç¨ç©ºé´åå¨ docker hub ä¸çå°çéåå¤§å°ä¸åãæ¯å¦ï¼ubuntu:18.04 éåå¤§å°ï¼å¨è¿éæ¯ 63.3mbï¼ä½æ¯å¨ docker hub æ¾ç¤ºçå´æ¯ 25.47 mbãè¿æ¯å ä¸º docker hub ä¸­æ¾ç¤ºçä½ç§¯æ¯åç¼©åçä½ç§¯ãå¨éåä¸è½½åä¸ä¼ è¿ç¨ä¸­éåæ¯ä¿æçåç¼©ç¶æçï¼å æ­¤ docker hub ææ¾ç¤ºçå¤§å°æ¯ç½ç»ä¼ è¾ä¸­æ´å³å¿çæµéå¤§å°ãè docker image ls æ¾ç¤ºçæ¯éåä¸è½½å°æ¬å°åï¼å±å¼çå¤§å°ï¼åç¡®è¯´ï¼æ¯å±å¼åçåå±æå ç©ºé´çæ»åï¼å ä¸ºéåå°æ¬å°åï¼æ¥çç©ºé´çæ¶åï¼æ´å³å¿çæ¯æ¬å°ç£çç©ºé´å ç¨çå¤§å°ã\n\nå¦å¤ä¸ä¸ªéè¦æ³¨æçé®é¢æ¯ï¼docker image ls åè¡¨ä¸­çéåä½ç§¯æ»åå¹¶éæ¯ææéåå®éç¡¬çæ¶èãç±äº docker éåæ¯å¤å±å­å¨ç»æï¼å¹¶ä¸å¯ä»¥ç»§æ¿ãå¤ç¨ï¼å æ­¤ä¸åéåå¯è½ä¼å ä¸ºä½¿ç¨ç¸åçåºç¡éåï¼ä»èæ¥æå±åçå±ãç±äº docker ä½¿ç¨ union fsï¼ç¸åçå±åªéè¦ä¿å­ä¸ä»½å³å¯ï¼å æ­¤å®ééåç¡¬çå ç¨ç©ºé´å¾å¯è½è¦æ¯è¿ä¸ªåè¡¨éåå¤§å°çæ»åè¦å°çå¤ã\n\nä½ å¯ä»¥éè¿ docker system df å½ä»¤æ¥ä¾¿æ·çæ¥çéåãå®¹å¨ãæ°æ®å·æå ç¨çç©ºé´ã\n\n$ docker system df\n\ntype                total               active              size           reclaimable\nimages              24                  0                   1.992gb        1.992gb (100%)\ncontainers          1                   0                   62.82mb        62.82mb (100%)\nlocal volumes       9                   0                   652.2mb        652.2mb (100%)\nbuild cache                                                 0b             0b\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# èæ¬éå\n\nä¸é¢çéååè¡¨ä¸­ï¼è¿å¯ä»¥çå°ä¸ä¸ªç¹æ®çéåï¼è¿ä¸ªéåæ¢æ²¡æä»åºåï¼ä¹æ²¡ææ ç­¾ï¼åä¸º <none>ã\n\n<none>               <none>              00285df0df87        5 days ago          342 mb\n\n\n1\n\n\nä¸è¬æ¥è¯´ï¼èæ¬éåå·²ç»å¤±å»äºå­å¨çä»·å¼ï¼æ¯å¯ä»¥éæå é¤çï¼å¯ä»¥ç¨ä¸é¢çå½ä»¤å é¤ã\n\n$ docker image prune\n\n\n1\n\n\n\n# ä¸­é´å±éå\n\nä¸ºäºå ééåæå»ºãéå¤å©ç¨èµæºï¼docker ä¼å©ç¨ ä¸­é´å±éåãæä»¥å¨ä½¿ç¨ä¸æ®µæ¶é´åï¼å¯è½ä¼çå°ä¸äºä¾èµçä¸­é´å±éåãé»è®¤ç docker image ls åè¡¨ä¸­åªä¼æ¾ç¤ºé¡¶å±éåï¼å¦æå¸ææ¾ç¤ºåæ¬ä¸­é´å±éåå¨åçææéåçè¯ï¼éè¦å  -a åæ°ã\n\n$ docker image ls -a | docker images -a\n\n\n1\n\n\nè¿æ ·ä¼çå°å¾å¤æ æ ç­¾çéåï¼ä¸ä¹åçèæ¬éåä¸åï¼è¿äºæ æ ç­¾çéåå¾å¤é½æ¯ä¸­é´å±éåï¼æ¯å¶å®éåæä¾èµçéåãè¿äºæ æ ç­¾éåä¸åºè¯¥å é¤ï¼å¦åä¼å¯¼è´ä¸å±éåå ä¸ºä¾èµä¸¢å¤±èåºéãå®éä¸ï¼è¿äºéåä¹æ²¡å¿è¦å é¤ï¼å ä¸ºä¹åè¯´è¿ï¼ç¸åçå±åªä¼å­ä¸éï¼èè¿äºéåæ¯å«çéåçä¾èµï¼å æ­¤å¹¶ä¸ä¼å ä¸ºå®ä»¬è¢«ååºæ¥èå¤å­äºä¸ä»½ï¼æ è®ºå¦ä½ä½ ä¹ä¼éè¦å®ä»¬ãåªè¦å é¤é£äºä¾èµå®ä»¬çéååï¼è¿äºä¾èµçä¸­é´å±éåä¹ä¼è¢«è¿å¸¦å é¤ã\n\n\n# ååºé¨åéå\n\nä¸å ä»»ä½åæ°çæåµä¸ï¼docker image ls ä¼ååºææé¡¶å±éåï¼ä½æ¯ææ¶åæä»¬åªå¸æååºé¨åéåãdocker image ls æå¥½å ä¸ªåæ°å¯ä»¥å¸®å©åå°è¿ä¸ªäºæã\n\næ ¹æ®ä»åºåååºéå\n\n$ docker image ls ubuntu\nrepository          tag                 image id            created             size\nubuntu              18.04               329ed837d508        3 days ago          63.3mb\nubuntu              bionic              329ed837d508        3 days ago          63.3mb\n\n\n1\n2\n3\n4\n\n\nååºç¹å®çæä¸ªéåï¼ä¹å°±æ¯è¯´æå®ä»åºååæ ç­¾\n\n$ docker image ls ubuntu:18.04\nrepository          tag                 image id            created             size\nubuntu              18.04               329ed837d508        3 days ago          63.3mb\n\n\n1\n2\n3\n\n\né¤æ­¤ä»¥å¤ï¼docker image ls è¿æ¯æå¼ºå¤§çè¿æ»¤å¨åæ° --filterï¼æèç®å -fãæ¯å¦ï¼æä»¬å¸æçå°å¨ mongo:3.2 ä¹åå»ºç«çéåï¼å¯ä»¥ç¨ä¸é¢çå½ä»¤ï¼\n\n$ docker image ls -f since=mongo:3.2\nrepository          tag                 image id            created             size\nredis               latest              5f515359c7f8        5 days ago          183 mb\nnginx               latest              05a60462f8ba        5 days ago          181 mb\n\n\n1\n2\n3\n4\n\n\næ³æ¥çæä¸ªä½ç½®ä¹åçéåä¹å¯ä»¥ï¼åªéè¦æ since æ¢æ before å³å¯ã\n\næ­¤å¤ï¼å¦æéåæå»ºæ¶ï¼å®ä¹äº labelï¼è¿å¯ä»¥éè¿ label æ¥è¿æ»¤ã\n\n$ docker image ls -f label=com.example.version=0.1\n...\n\n\n1\n2\n\n\n\n# å¶ä»ç¨æ³\n\n[root@localhost ~]# docker images ls --help\n\nusage:  docker images [options] [repository[:tag]]\n\nlist images\n\noptions:\n  -a, --all             show all images (default hides intermediate images)\n      --digests         show digests\n  -f, --filter filter   filter output based on conditions provided\n      --format string   pretty-print images using a go template\n      --no-trunc        don\'t truncate output\n  -q, --quiet           only show image ids\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# å é¤æ¬å°éå\n\nå¦æè¦å é¤æ¬å°çéåï¼å¯ä»¥ä½¿ç¨ docker image rm å½ä»¤ï¼å¶æ ¼å¼ä¸ºï¼\n\n$ docker image rm [éé¡¹] <éå1> [<éå2> ...] (ç¨æ³1)\n$ docker rmi [éé¡¹] <éå1> [<éå2> ...] ï¼ç¨æ³2ï¼\n\n\n1\n2\n\n\n\n# ç¨ idãéååãæè¦å é¤éå\n\nå¶ä¸­ï¼<éå> å¯ä»¥æ¯ éåç­ idãéåé¿ idãéåå æè éåæè¦ã\n\næä»¬å¯ä»¥ç¨éåçå®æ´ idï¼ä¹ç§°ä¸º é¿ idï¼æ¥å é¤éåãä½¿ç¨èæ¬çæ¶åå¯è½ä¼ç¨é¿ idï¼ä½æ¯äººå·¥è¾å¥å°±å¤ªç´¯äºï¼æä»¥æ´å¤çæ¶åæ¯ç¨ ç­ id æ¥å é¤éåãdocker image ls é»è®¤ååºçå°±å·²ç»æ¯ç­ id äºï¼ä¸è¬åå3ä¸ªå­ç¬¦ä»¥ä¸ï¼åªè¦è¶³å¤åºåäºå«çéåå°±å¯ä»¥äºã\n\n\n# ç¨ docker image ls å½ä»¤æ¥éå\n\næ¯å¦ï¼æä»¬éè¦å é¤ææä»åºåä¸º redis çéåï¼\n\n$ docker image rm $(docker image ls -q redis)\n\n\n1\n\n\næèå é¤ææå¨ mongo:3.2 ä¹åçéåï¼\n\n$ docker image rm $(docker image ls -q -f before=mongo:3.2)\n\n\n1\n\n\n\n# æäº¤æ¬å°éå\n\nå½æä»¬è¿è¡ä¸ä¸ªå®¹å¨çæ¶åï¼å¦æä¸ä½¿ç¨å·çè¯ï¼ï¼æä»¬åçä»»ä½æä»¶ä¿®æ¹é½ä¼è¢«è®°å½äºå®¹å¨å­å¨å±éãè docker æä¾äºä¸ä¸ª docker commit å½ä»¤ï¼å¯ä»¥å°å®¹å¨çå­å¨å±ä¿å­ä¸æ¥æä¸ºéåãæ¢å¥è¯è¯´ï¼å°±æ¯å¨åæéåçåºç¡ä¸ï¼åå å ä¸å®¹å¨å­å¨å±æææ°çéåã\n\ndocker commit çè¯­æ³æ ¼å¼ä¸ºï¼\n\ndocker commit [éé¡¹] <å®¹å¨idæå®¹å¨å> [<ä»åºå>[:<æ ç­¾>]]\n\n\n1\n\n\nç°å¨è®©æä»¬ä»¥å®å¶ä¸ä¸ª web æå¡å¨ä¸ºä¾å­ï¼æ¥è®²è§£éåæ¯å¦ä½æå»ºçã\n\n$ docker run --name webserver -d -p 80:80 nginx\n$ docker exec -it webserver bash\nroot@3729b97e8226:/# echo \'<h1>hello, docker!</h1>\' > /usr/share/nginx/html/index.html\nroot@3729b97e8226:/# exit\nexit\n\n# éè¿ docker diff å½ä»¤æ¥çå®¹å¨å­å¨å±çæä»¶æ¹å¨\n$ docker diff webserver\nc /root\na /root/.bash_history\nc /run\nc /usr\nc /usr/share\nc /usr/share/nginx\nc /usr/share/nginx/html\nc /usr/share/nginx/html/index.html\nc /var\nc /var/cache\nc /var/cache/nginx\na /var/cache/nginx/client_temp\na /var/cache/nginx/fastcgi_temp\na /var/cache/nginx/proxy_temp\na /var/cache/nginx/scgi_temp\na /var/cache/nginx/uwsgi_temp\n\n$ docker commit \\\n    --author "tao wang <twang2218@gmail.com>" \\\n    --message "ä¿®æ¹äºé»è®¤ç½é¡µ" \\\n    webserver \\\n    nginx:v2\nsha256:07e33465974800ce65751acc279adc6ed2dc5ed4e0838f8b86f0c87aa1795214\n\n# ç¨ docker history æ¥çéåæå»ºåå²\n# æ¯è¾nginx:v2ånginx:latest çéåæå»ºåå²ï¼åç°nginx:v2æ°å¢äºæä»¬ååæäº¤çè¿ä¸å±ã\n$ docker history nginx:v2\n\n# æ°çéåå®å¶å¥½åï¼æä»¬å¯ä»¥æ¥è¿è¡è¿ä¸ªéåã\n$ docker run --name web2 -d -p 81:80 nginx:v2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n\n\n\n# æç¨ docker commit\n\né¦åï¼å¦æä»ç»è§å¯ä¹åç docker diff webserver çç»æï¼ä½ ä¼åç°é¤äºçæ­£æ³è¦ä¿®æ¹ç /usr/share/nginx/html/index.html æä»¶å¤ï¼ç±äºå½ä»¤çæ§è¡ï¼è¿æå¾å¤æä»¶è¢«æ¹å¨ææ·»å äºãè¿è¿ä»ä»æ¯æç®åçæä½ï¼å¦ææ¯å®è£è½¯ä»¶åãç¼è¯æå»ºï¼é£ä¼æå¤§éçæ å³åå®¹è¢«æ·»å è¿æ¥ï¼å°ä¼å¯¼è´éåæä¸ºèè¿ã\n\næ­¤å¤ï¼ä½¿ç¨ docker commit æå³çææå¯¹éåçæä½é½æ¯é»ç®±æä½ï¼çæçéåä¹è¢«ç§°ä¸º é»ç®±éåï¼æ¢å¥è¯è¯´ï¼å°±æ¯é¤äºå¶ä½éåçäººç¥éæ§è¡è¿ä»ä¹å½ä»¤ãæä¹çæçéåï¼å«äººæ ¹æ¬æ ä»å¾ç¥ãèä¸ï¼å³ä½¿æ¯è¿ä¸ªå¶ä½éåçäººï¼è¿ä¸æ®µæ¶é´åä¹æ æ³è®°æ¸å·ä½çæä½ãè¿ç§é»ç®±éåçç»´æ¤å·¥ä½æ¯éå¸¸çè¦çã\n\n\n# æä½å®¹å¨\n\n\n# å¯å¨ï¼docker runï¼\n\n# -t éé¡¹è®©dockeråéä¸ä¸ªä¼ªç»ç«¯ï¼pseudo-ttyï¼å¹¶ç»å®å°å®¹å¨çæ åè¾å¥ä¸\n# -i åè®©å®¹å¨çæ åè¾å¥ä¿ææå¼\n$ docker run -t -i ubuntu:18.04 /bin/bash\n\n\n1\n2\n3\n\n\n\n# å®æ¤æè¿è¡ï¼-dï¼\n\nå¦æä¸ä½¿ç¨ -d åæ°è¿è¡å®¹å¨ã\n\n$ docker run ubuntu:18.04 /bin/sh -c "while true; do echo hello world; sleep 1; done"\nhello world\nhello world\nhello world\nhello world\n\n\n1\n2\n3\n4\n5\n\n\nå®¹å¨ä¼æè¾åºçç»æ (stdout) æå°å°å®¿ä¸»æºä¸é¢\n\nå¦æä½¿ç¨äº -d åæ°è¿è¡å®¹å¨ã\n\n$ docker run -d ubuntu:18.04 /bin/sh -c "while true; do echo hello world; sleep 1; done"\n77b2dc01fe0f3f1265df143181e7b9af5e05279a884f4776ee75350ea9d8017a\n\n\n1\n2\n\n\næ­¤æ¶å®¹å¨ä¼å¨åå°è¿è¡å¹¶ä¸ä¼æè¾åºçç»æ (stdout) æå°å°å®¿ä¸»æºä¸é¢(è¾åºç»æå¯ä»¥ç¨ docker logs æ¥ç)ã\n\næ³¨ï¼ å®¹å¨æ¯å¦ä¼é¿ä¹è¿è¡ï¼æ¯å docker run æå®çå½ä»¤ï¼æèdockfileä¸­cmdæä»¤æå®çé»è®¤å¯å¨å½ä»¤ï¼æå³ï¼å -d åæ°æ å³ã\n\néè¿ docker ps å½ä»¤æ¥æ¥çå®¹å¨ä¿¡æ¯\n\n$ docker ps\ncontainer id  image         command               created        status       ports names\n77b2dc01fe0f  ubuntu:18.04  /bin/sh -c \'while tr  2 minutes ago  up 1 minute        agitated_wright\n\n\n1\n2\n3\n\n\nè¦è·åå®¹å¨çè¾åºä¿¡æ¯ï¼å¯ä»¥éè¿ docker logs å½ä»¤ã\n\n$ docker logs [container id or names]\nhello world\nhello world\nhello world\n. . .\n\n\n1\n2\n3\n4\n5\n\n\n\n# ç»æ­¢ï¼docker stopï¼\n\nå¯ä»¥ä½¿ç¨ docker stop æ¥ç»æ­¢ä¸ä¸ªè¿è¡ä¸­çå®¹å¨ã\n\næ­¤å¤ï¼å½ docker å®¹å¨ä¸­æå®çåºç¨ç»ç»æ¶ï¼å®¹å¨ä¹èªå¨ç»æ­¢ã\n\nä¾å¦å¯¹äºåªå¯å¨äºä¸ä¸ªç»ç«¯çå®¹å¨ï¼ç¨æ·éè¿ exit å½ä»¤æ ctrl+d æ¥éåºç»ç«¯æ¶ï¼æåå»ºçå®¹å¨ç«å»ç»æ­¢ã\n\nç»æ­¢ç¶æçå®¹å¨å¯ä»¥ç¨ docker ls -a å½ä»¤çå°ã\n\nå¤äºç»æ­¢ç¶æçå®¹å¨ï¼å¯ä»¥éè¿ docker start å½ä»¤æ¥éæ°å¯å¨ã\n\næ­¤å¤ï¼docker restart å½ä»¤ä¼å°ä¸ä¸ªè¿è¡æçå®¹å¨ç»æ­¢ï¼ç¶ååéæ°å¯å¨å®ã\n\n\n# è¿å¥å®¹å¨\n\næäºæ¶åéè¦è¿å¥å®¹å¨è¿è¡æä½ï¼åæ¬ä½¿ç¨ docker attach å½ä»¤æ docker exec å½ä»¤ï¼æ¨èå¤§å®¶ä½¿ç¨ docker exec å½ä»¤ï¼åå ä¼å¨ä¸é¢è¯´æã\n\n\n# attach å½ä»¤\n\nä¸é¢ç¤ºä¾å¦ä½ä½¿ç¨ docker attach å½ä»¤ã\n\n$ docker run -dit ubuntu\n243c32535da7d142fb0e6df616a3c3ada0b8ab417937c853a9e1c251f499f550\n\n$ docker ps\ncontainer id        image               command             created             status              ports               names\n243c32535da7        ubuntu:latest       "/bin/bash"         18 seconds ago      up 17 seconds                           nostalgic_hypatia\n\n$ docker attach 243c\nroot@243c32535da7:/#\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\næ³¨æï¼ å¦æä»è¿ä¸ª stdin ä¸­ exitï¼ä¼å¯¼è´å®¹å¨çåæ­¢ã\n\n\n# exec å½ä»¤\n\n-i -t åæ°\n\ndocker exec åè¾¹å¯ä»¥è·å¤ä¸ªåæ°ï¼è¿éä¸»è¦è¯´æ -i -t åæ°ã\n\nåªç¨ -i åæ°æ¶ï¼ç±äºæ²¡æåéä¼ªç»ç«¯ï¼çé¢æ²¡ææä»¬çæç linux å½ä»¤æç¤ºç¬¦ï¼ä½å½ä»¤æ§è¡ç»æä»ç¶å¯ä»¥è¿åã\n\nå½ -i -t åæ°ä¸èµ·ä½¿ç¨æ¶ï¼åå¯ä»¥çå°æä»¬çæç linux å½ä»¤æç¤ºç¬¦ã\n\n$ docker run -dit ubuntu\n69d137adef7a8a689cbcb059e94da5489d3cddd240ff675c640c8d96e84fe1f6\n\n$ docker container ls\ncontainer id        image               command             created             status              ports               names\n69d137adef7a        ubuntu:latest       "/bin/bash"         18 seconds ago      up 17 seconds                           zealous_swirles\n\n$ docker exec -i 69d1 bash\nls\nbin\nboot\ndev\n...\n\n$ docker exec -it 69d1 bash\nroot@69d137adef7a:/#\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nå¦æä»è¿ä¸ª stdin ä¸­ exitï¼ä¸ä¼å¯¼è´å®¹å¨çåæ­¢ãè¿å°±æ¯ä¸ºä»ä¹æ¨èå¤§å®¶ä½¿ç¨ docker exec çåå ã\n\n\n# å¯¼åºåå¯¼å¥\n\n\n# å¯¼åºå®¹å¨\n\nå¦æè¦å¯¼åºæ¬å°æä¸ªå®¹å¨ï¼å¯ä»¥ä½¿ç¨ docker export å½ä»¤ã\n\n$ docker ps -a\ncontainer id        image               command             created             status                    ports               names\n7691a814370e        ubuntu:18.04        "/bin/bash"         36 hours ago        exited (0) 21 hours ago                       test\n$ docker export 7691a814370e > ubuntu.tar\n\n\n1\n2\n3\n4\n\n\nè¿æ ·å°å¯¼åºå®¹å¨å¿«ç§å°æ¬å°æä»¶ã\n\n\n# å¯¼å¥å®¹å¨å¿«ç§\n\nå¯ä»¥ä½¿ç¨ docker import ä»å®¹å¨å¿«ç§æä»¶ä¸­åå¯¼å¥ä¸ºéåï¼ä¾å¦\n\n$ cat ubuntu.tar | docker import - test/ubuntu:v1.0\n$ docker images\nrepository          tag                 image id            created              virtual size\ntest/ubuntu         v1.0                9d37a6082e97        about a minute ago   171.3 mb\n\n\n1\n2\n3\n4\n\n\næ­¤å¤ï¼ä¹å¯ä»¥éè¿æå® url æèæä¸ªç®å½æ¥å¯¼å¥ï¼ä¾å¦\n\n$ docker import http://example.com/exampleimage.tgz example/imagerepo\n\n\n1\n\n\næ³¨ï¼ç¨æ·æ¢å¯ä»¥ä½¿ç¨ docker load æ¥å¯¼å¥éåå­å¨æä»¶å°æ¬å°éååºï¼ä¹å¯ä»¥ä½¿ç¨ docker import æ¥å¯¼å¥ä¸ä¸ªå®¹å¨å¿«ç§å°æ¬å°éååºãè¿ä¸¤èçåºå«å¨äºå®¹å¨å¿«ç§æä»¶å°ä¸¢å¼ææçåå²è®°å½ååæ°æ®ä¿¡æ¯ï¼å³ä»ä¿å­å®¹å¨å½æ¶çå¿«ç§ç¶æï¼ï¼èéåå­å¨æä»¶å°ä¿å­å®æ´è®°å½ï¼ä½ç§¯ä¹è¦å¤§ãæ­¤å¤ï¼ä»å®¹å¨å¿«ç§æä»¶å¯¼å¥æ¶å¯ä»¥éæ°æå®æ ç­¾ç­åæ°æ®ä¿¡æ¯ã\n\n\n# å é¤\n\nå¯ä»¥ä½¿ç¨ docker rm æ¥å é¤ä¸ä¸ªå¤äºç»æ­¢ç¶æçå®¹å¨ã\n\n$ docker rm trusting_newton\ntrusting_newton\n\n\n1\n2\n\n\nå¦æè¦å é¤ä¸ä¸ªè¿è¡ä¸­çå®¹å¨ï¼å¯ä»¥æ·»å  -f åæ°ãdocker ä¼åé sigkill ä¿¡å·ç»å®¹å¨ã\n\nç¨ docker container ls -a å½ä»¤å¯ä»¥æ¥çææå·²ç»åå»ºçåæ¬ç»æ­¢ç¶æçå®¹å¨ï¼å¦ææ°éå¤ªå¤è¦ä¸ä¸ªä¸ªå é¤å¯è½ä¼å¾éº»ç¦ï¼ç¨ä¸é¢çå½ä»¤å¯ä»¥æ¸çæææå¤äºç»æ­¢ç¶æçå®¹å¨ã\n\n$ docker container prune\n\n\n1\n\n\n\n# dockerå¶ä»å¸¸ç¨å½ä»¤è¡¥å\n\n\n\n\n# å¸®å©å½ä»¤\n\ndocker version\t# dockerçæ¬ä¿¡æ¯\ndocker info\t\t# ç³»ç»çº§å«çä¿¡æ¯ï¼åæ¬éååå®¹å¨çæ°é\ndocker --help\ndocker å½ä»¤ --help\n\n\n1\n2\n3\n4\n\n\ndocker å½ä»¤å¸®å©ææ¡£\n\n\n# éåå½ä»¤\n\n * docker images\n\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker images\nrepository          tag                 image id            created             size\nhello-world         latest              bf756fb1ae65        7 months ago        13.3kb\n\n# å¯éé¡¹\n--all , -a\t\t# ååºææéå\n--quiet , -q\t# åªæ¾ç¤ºéåçid\n\n\n1\n2\n3\n4\n5\n6\n7\n\n * docker search\n\n--filter=stars=3000\t\t# æç´ åºæ¥çéåå°±æ¯starså¤§äº3000ç\n\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker search mysql --filter=stars=3000\nname                description                                     stars               official            automated\nmysql               mysql is a widely used, open-source relationâ¦   9822                [ok]                \nmariadb             mariadb is a community-developed fork of mysâ¦   3586                [ok]\n\n\n1\n2\n3\n4\n5\n6\n\n * docker rmi\n\ndocker rmi -f imageid# å é¤æå®éå\ndocker rmi -f imageid1 imageid2 imageid3\t# å é¤å¤ä¸ªéå\ndocker rmi -f $(docker images -aq)\t\t\t# å é¤ææéå\n\n\n1\n2\n3\n\n\n\n# å®¹å¨å½ä»¤\n\nè¿è¡å®¹å¨\n\ndocker run [å¯éåæ°] image\n\n# åæ°è¯´æ\n--name=ânameâ\tå®¹å¨åå­\ttomcat01 tomcat02\tç¨æ¥åºåå®¹å¨\n-d\t\tåå°æ¹å¼è¿è¡\n-it\t\tä½¿ç¨äº¤äºæ¹å¼è¿è¡ï¼è¿å¥å®¹å¨æ¥çåå®¹\n-p\t\tpublish a container\'s port(s) to the host\t-p 8080:8080\n\t-p\tip:ä¸»æºç«¯å£:å®¹å¨ç«¯å£\n\t-p\tä¸»æºç«¯å£:å®¹å¨ç«¯å£ï¼å¸¸ç¨ï¼\n\t-p\tpublish all exposed ports to random ports\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nååºææçè¿è¡çå®¹å¨\n\n# docker ps å½ä»¤\n\t\t# ååºå½åæ­£å¨è¿è¡çå®¹å¨\n-a\t\t# ååºæ­£å¨è¿è¡çå®¹å¨åæ¬åå²å®¹å¨\n-n=?\t# æ¾ç¤ºæè¿åå»ºçå®¹å¨\n-q\t\t# åªæ¾ç¤ºå½åå®¹å¨çç¼å·\n\n[root@iz2zeg4ytp0whqtmxbsqiiz /]# docker ps\ncontainer id        image               command             created             status              ports               names\n[root@iz2zeg4ytp0whqtmxbsqiiz /]# docker ps -a\ncontainer id        image               command             created             status                     ports               names\n77969f5dcbf9        centos              "/bin/bash"         5 minutes ago       exited (0) 5 minutes ago                       xenodochial_bose\n74e82b7980e7        centos              "/bin/bash"         16 minutes ago      exited (0) 6 minutes ago                       silly_cori\na57250395804        bf756fb1ae65        "/hello"            7 hours ago         exited (0) 7 hours ago                         elated_nash\n392d674f4f18        bf756fb1ae65        "/hello"            8 hours ago         exited (0) 8 hours ago                         distracted_mcnulty\n571d1bc0e8e8        bf756fb1ae65        "/hello"            23 hours ago        exited (0) 23 hours ago                        magical_burnell\n\n[root@iz2zeg4ytp0whqtmxbsqiiz /]# docker ps -qa\n77969f5dcbf9\n74e82b7980e7\na57250395804\n392d674f4f18\n571d1bc0e8e8\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\néåºå®¹å¨\n\nexit \t\t\t# ç´æ¥éåºå®¹å¨å¹¶å³é­\nctrl + p + q\t# å®¹å¨ä¸å³é­éåº\n\n\n1\n2\n\n\nå é¤å®¹å¨docker\n\ndocker rm -f å®¹å¨id                  # å é¤æå®å®¹å¨\ndocker rm -f $(docker ps -aq)\t\t# å é¤ææå®¹å¨\ndocker ps -aq | xargs docker rm -f\t# å é¤ææå®¹å¨\n\n\n1\n2\n3\n\n\nå¯å¨ååæ­¢å®¹å¨çæä½\n\ndocker start å®¹å¨id\t\t\t# å¯å¨å®¹å¨\ndocker restart å®¹å¨id\t\t\t# éå¯å®¹å¨\ndocker stop å®¹å¨id\t\t\t# åæ­¢å½åæ­£å¨è¿è¡çå®¹å¨\ndocker kill å®¹å¨id\t\t\t# å¼ºå¶åæ­¢å½åçå®¹å¨\n\n\n1\n2\n3\n4\n\n\n\n# å¸¸ç¨çå¶ä»å½ä»¤\n\næ¥çæ¥å¿\n\ndocker logs -tf --tail number å®¹å¨id\n\n[root@localhost ~]# docker logs --help\n\nusage:  docker logs [options] container\n\nfetch the logs of a container\n\noptions:\n      --details        show extra details provided to logs\n  -f, --follow         follow log output\n      --since string   show logs since timestamp (e.g. 2013-01-02t13:23:37z) or relative (e.g. 42m for 42 minutes)\n  -n, --tail string    number of lines to show from the end of the logs (default "all")\n  -t, --timestamps     show timestamps\n      --until string   show logs before a timestamp (e.g. 2013-01-02t13:23:37z) or relative (e.g. 42m for 42 minutes)\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\næ¥çå®¹å¨ä¸­è¿ç¨ä¿¡æ¯ps\n\n# å½ä»¤ docker top å®¹å¨id\n[root@iz2zeg4ytp0whqtmxbsqiiz /]# docker top df358bc06b17              ?\n\n\n1\n2\n\n\næ¥çéåçåæ°æ®\n\n# å½ä»¤\ndocker inspect å®¹å¨id\n\n[root@iz2zeg4ytp0whqtmxbsqiiz /]# docker inspect df358bc06b17\n[\n    {\n        "id": "df358bc06b17ef44f215d35d9f46336b28981853069a3739edfc6bd400f99bf3",\n        "created": "2020-08-11t11:38:34.935048603z",\n        "path": "/bin/bash",\n        "args": [],\n        "state": {\n            "status": "running",\n            "running": true,\n            "paused": false,\n            "restarting": false,\n            "oomkilled": false,\n            "dead": false,\n            "pid": 28498,\n            "exitcode": 0,\n            "error": "",\n            "startedat": "2020-08-11t11:38:35.216616071z",\n            "finishedat": "0001-01-01t00:00:00z"\n        },\n        "image": "sha256:0d120b6ccaa8c5e149176798b3501d4dd1885f961922497cd0abef155c869566",\n        "resolvconfpath": "/var/lib/docker/containers/df358bc06b17ef44f215d35d9f46336b28981853069a3739edfc6bd400f99bf3/resolv.conf",\n        "hostnamepath": "/var/lib/docker/containers/df358bc06b17ef44f215d35d9f46336b28981853069a3739edfc6bd400f99bf3/hostname",\n        "hostspath": "/var/lib/docker/containers/df358bc06b17ef44f215d35d9f46336b28981853069a3739edfc6bd400f99bf3/hosts",\n        "logpath": "/var/lib/docker/containers/df358bc06b17ef44f215d35d9f46336b28981853069a3739edfc6bd400f99bf3/df358bc06b17ef44f215d35d9f46336b28981853069a3739edfc6bd400f99bf3-json.log",\n        "name": "/hungry_heisenberg",\n        "restartcount": 0,\n        "driver": "overlay2",\n        "platform": "linux",\n        "mountlabel": "",\n        "processlabel": "",\n        "apparmorprofile": "",\n        "execids": null,\n        "hostconfig": {\n            "binds": null,\n            "containeridfile": "",\n            "logconfig": {\n                "type": "json-file",\n                "config": {}\n            },\n            "networkmode": "default",\n            "portbindings": {},\n            "restartpolicy": {\n                "name": "no",\n                "maximumretrycount": 0\n            },\n            "autoremove": false,\n            "volumedriver": "",\n            "volumesfrom": null,\n            "capadd": null,\n            "capdrop": null,\n            "capabilities": null,\n            "dns": [],\n            "dnsoptions": [],\n            "dnssearch": [],\n            "extrahosts": null,\n            "groupadd": null,\n            "ipcmode": "private",\n            "cgroup": "",\n            "links": null,\n            "oomscoreadj": 0,\n            "pidmode": "",\n            "privileged": false,\n            "publishallports": false,\n            "readonlyrootfs": false,\n            "securityopt": null,\n            "utsmode": "",\n            "usernsmode": "",\n            "shmsize": 67108864,\n            "runtime": "runc",\n            "consolesize": [\n                0,\n                0\n            ],\n            "isolation": "",\n            "cpushares": 0,\n            "memory": 0,\n            "nanocpus": 0,\n            "cgroupparent": "",\n            "blkioweight": 0,\n            "blkioweightdevice": [],\n            "blkiodevicereadbps": null,\n            "blkiodevicewritebps": null,\n            "blkiodevicereadiops": null,\n            "blkiodevicewriteiops": null,\n            "cpuperiod": 0,\n            "cpuquota": 0,\n            "cpurealtimeperiod": 0,\n            "cpurealtimeruntime": 0,\n            "cpusetcpus": "",\n            "cpusetmems": "",\n            "devices": [],\n            "devicecgrouprules": null,\n            "devicerequests": null,\n            "kernelmemory": 0,\n            "kernelmemorytcp": 0,\n            "memoryreservation": 0,\n            "memoryswap": 0,\n            "memoryswappiness": null,\n            "oomkilldisable": false,\n            "pidslimit": null,\n            "ulimits": null,\n            "cpucount": 0,\n            "cpupercent": 0,\n            "iomaximumiops": 0,\n            "iomaximumbandwidth": 0,\n            "maskedpaths": [\n                "/proc/asound",\n                "/proc/acpi",\n                "/proc/kcore",\n                "/proc/keys",\n                "/proc/latency_stats",\n                "/proc/timer_list",\n                "/proc/timer_stats",\n                "/proc/sched_debug",\n                "/proc/scsi",\n                "/sys/firmware"\n            ],\n            "readonlypaths": [\n                "/proc/bus",\n                "/proc/fs",\n                "/proc/irq",\n                "/proc/sys",\n                "/proc/sysrq-trigger"\n            ]\n        },\n        "graphdriver": {\n            "data": {\n                "lowerdir": "/var/lib/docker/overlay2/5af8a2aadbdba9e1e066331ff4bce56398617710a22ef906f9ce4d58bde2d360-init/diff:/var/lib/docker/overlay2/62926d498bd9d1a6684bb2f9920fb77a2f88896098e66ef93c4b74fcb19f29b6/diff",\n                "mergeddir": "/var/lib/docker/overlay2/5af8a2aadbdba9e1e066331ff4bce56398617710a22ef906f9ce4d58bde2d360/merged",\n                "upperdir": "/var/lib/docker/overlay2/5af8a2aadbdba9e1e066331ff4bce56398617710a22ef906f9ce4d58bde2d360/diff",\n                "workdir": "/var/lib/docker/overlay2/5af8a2aadbdba9e1e066331ff4bce56398617710a22ef906f9ce4d58bde2d360/work"\n            },\n            "name": "overlay2"\n        },\n        "mounts": [],\n        "config": {\n            "hostname": "df358bc06b17",\n            "domainname": "",\n            "user": "",\n            "attachstdin": true,\n            "attachstdout": true,\n            "attachstderr": true,\n            "tty": true,\n            "openstdin": true,\n            "stdinonce": true,\n            "env": [\n                "path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"\n            ],\n            "cmd": [\n                "/bin/bash"\n            ],\n            "image": "centos",\n            "volumes": null,\n            "workingdir": "",\n            "entrypoint": null,\n            "onbuild": null,\n            "labels": {\n                "org.label-schema.build-date": "20200809",\n                "org.label-schema.license": "gplv2",\n                "org.label-schema.name": "centos base image",\n                "org.label-schema.schema-version": "1.0",\n                "org.label-schema.vendor": "centos"\n            }\n        },\n        "networksettings": {\n            "bridge": "",\n            "sandboxid": "4822f9ac2058e8415ebefbfa73f05424fe20cc8280a5720ad3708fa6e80cdb08",\n            "hairpinmode": false,\n            "linklocalipv6address": "",\n            "linklocalipv6prefixlen": 0,\n            "ports": {},\n            "sandboxkey": "/var/run/docker/netns/4822f9ac2058",\n            "secondaryipaddresses": null,\n            "secondaryipv6addresses": null,\n            "endpointid": "5fd269c0a28227241e40cd30658e3ffe8ad6cc3e6514917c867d89d36a31d605",\n            "gateway": "172.17.0.1",\n            "globalipv6address": "",\n            "globalipv6prefixlen": 0,\n            "ipaddress": "172.17.0.2",\n            "ipprefixlen": 16,\n            "ipv6gateway": "",\n            "macaddress": "02:42:ac:11:00:02",\n            "networks": {\n                "bridge": {\n                    "ipamconfig": null,\n                    "links": null,\n                    "aliases": null,\n                    "networkid": "30d6017888627cb565618b1639fecf8fc97e1ae4df5a9fd5ddb046d8fb02b565",\n                    "endpointid": "5fd269c0a28227241e40cd30658e3ffe8ad6cc3e6514917c867d89d36a31d605",\n                    "gateway": "172.17.0.1",\n                    "ipaddress": "172.17.0.2",\n                    "ipprefixlen": 16,\n                    "ipv6gateway": "",\n                    "globalipv6address": "",\n                    "globalipv6prefixlen": 0,\n                    "macaddress": "02:42:ac:11:00:02",\n                    "driveropts": null\n                }\n            }\n        }\n    }\n]\n[root@iz2zeg4ytp0whqtmxbsqiiz /]#\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n99\n100\n101\n102\n103\n104\n105\n106\n107\n108\n109\n110\n111\n112\n113\n114\n115\n116\n117\n118\n119\n120\n121\n122\n123\n124\n125\n126\n127\n128\n129\n130\n131\n132\n133\n134\n135\n136\n137\n138\n139\n140\n141\n142\n143\n144\n145\n146\n147\n148\n149\n150\n151\n152\n153\n154\n155\n156\n157\n158\n159\n160\n161\n162\n163\n164\n165\n166\n167\n168\n169\n170\n171\n172\n173\n174\n175\n176\n177\n178\n179\n180\n181\n182\n183\n184\n185\n186\n187\n188\n189\n190\n191\n192\n193\n194\n195\n196\n197\n198\n199\n200\n201\n202\n203\n204\n205\n206\n207\n\n\nå¨å®¹å¨åä¸»æºé´ç¸äºæ·è´æä»¶\n\nusage:  \ndocker cp [options] container:src_path dest_path|-\ndocker cp [options] src_path|- container:dest_path\n\n[root@iz2zeg4ytp0whqtmxbsqiiz /]# docker cp 7af535f807e0:/home/test.java /home\n\n\n1\n2\n3\n4\n5\n',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Docker é«çº§å®è·µç¯",frontmatter:{title:"Docker é«çº§å®è·µç¯",date:"2022-02-03T00:03:52.000Z",permalink:"/pages/a24e91/",categories:["åç«¯","Docker"],tags:[null]},regularPath:"/25.%E8%BF%90%E7%BB%B4/50.Docker/03.Docker%20%E9%AB%98%E7%BA%A7%E5%AE%9E%E8%B7%B5%E7%AF%87.html",relativePath:"25.è¿ç»´/50.Docker/03.Docker é«çº§å®è·µç¯.md",key:"v-69bafd4e",path:"/pages/a24e91/",headers:[{level:2,title:"Dockerå®è£Nginx",slug:"dockerå®è£nginx",normalizedTitle:"dockerå®è£nginx",charIndex:19},{level:2,title:"Dockerå®è£Tomcat",slug:"dockerå®è£tomcat",normalizedTitle:"dockerå®è£tomcat",charIndex:1455},{level:2,title:"Dockeré¨ç½²es + kibanaÂ·",slug:"dockeré¨ç½²es-kibanaÂ·",normalizedTitle:"dockeré¨ç½²es + kibanaÂ·",charIndex:1699},{level:2,title:"å¯è§å",slug:"å¯è§å",normalizedTitle:"å¯è§å",charIndex:3089},{level:2,title:"Dockerççè§£åé¡¾",slug:"dockerççè§£åé¡¾",normalizedTitle:"dockerççè§£åé¡¾",charIndex:3420},{level:2,title:"ä½¿ç¨æ°æ®å·",slug:"ä½¿ç¨æ°æ®å·",normalizedTitle:"ä½¿ç¨æ°æ®å·",charIndex:3620},{level:2,title:"å®æï¼å®è£MySQL",slug:"å®æ-å®è£mysql",normalizedTitle:"å®æï¼å®è£mysql",charIndex:3970},{level:2,title:"å¿ååå·åæè½½ï¼å®¹å¨å·ï¼",slug:"å¿ååå·åæè½½-å®¹å¨å·",normalizedTitle:"å¿ååå·åæè½½ï¼å®¹å¨å·ï¼",charIndex:4703},{level:2,title:"æ°æ®å·å®¹å¨",slug:"æ°æ®å·å®¹å¨",normalizedTitle:"æ°æ®å·å®¹å¨",charIndex:7045},{level:2,title:"DockerFile",slug:"dockerfile",normalizedTitle:"dockerfile",charIndex:9863},{level:2,title:"DockerFileçæå»ºè¿ç¨",slug:"dockerfileçæå»ºè¿ç¨",normalizedTitle:"dockerfileçæå»ºè¿ç¨",charIndex:9878},{level:2,title:"DockerFileæä»¤è¯´æ",slug:"dockerfileæä»¤è¯´æ",normalizedTitle:"dockerfileæä»¤è¯´æ",charIndex:10051},{level:2,title:"åå»ºä¸ä¸ªèªå·±çCentos",slug:"åå»ºä¸ä¸ªèªå·±çcentos",normalizedTitle:"åå»ºä¸ä¸ªèªå·±çcentos",charIndex:10072},{level:3,title:"CMD åENTRYPOINTåºå«",slug:"cmd-åentrypointåºå«",normalizedTitle:"cmd åentrypointåºå«",charIndex:10695},{level:2,title:"å¶ä½Tomcatéå",slug:"å¶ä½tomcatéå",normalizedTitle:"å¶ä½tomcatéå",charIndex:15472},{level:2,title:"åå¸èªå·±çéåå°Docker Hub",slug:"åå¸èªå·±çéåå°docker-hub",normalizedTitle:"åå¸èªå·±çéåå°docker hub",charIndex:17336},{level:2,title:"åå¸å°é¿éäºéåæå¡ä¸",slug:"åå¸å°é¿éäºéåæå¡ä¸",normalizedTitle:"åå¸å°é¿éäºéåæå¡ä¸",charIndex:17981},{level:2,title:"æ»ç»",slug:"æ»ç»",normalizedTitle:"æ»ç»",charIndex:3586},{level:2,title:"è¿æ¥ Docker0",slug:"è¿æ¥-docker0",normalizedTitle:"è¿æ¥ docker0",charIndex:18095},{level:2,title:"-- link",slug:"link",normalizedTitle:"-- link",charIndex:19853},{level:2,title:"èªå®ä¹ç½ç»",slug:"èªå®ä¹ç½ç»",normalizedTitle:"èªå®ä¹ç½ç»",charIndex:21881},{level:2,title:"ç½ç»è¿éï¼ä¸åç½ç»ä¹é´ï¼",slug:"ç½ç»è¿é-ä¸åç½ç»ä¹é´",normalizedTitle:"ç½ç»è¿éï¼ä¸åç½ç»ä¹é´ï¼",charIndex:26061},{level:2,title:"å®æï¼é¨ç½²redis",slug:"å®æ-é¨ç½²redis",normalizedTitle:"å®æï¼é¨ç½²redis",charIndex:26938},{level:3,title:"å®æä¸ï¼bridgeç½ç» + dockerï¼",slug:"å®æä¸-bridgeç½ç»-docker",normalizedTitle:"å®æä¸ï¼bridgeç½ç» + dockerï¼",charIndex:26955},{level:3,title:"å®æäºï¼hostç½ç» + docker-composeï¼",slug:"å®æäº-hostç½ç»-docker-compose",normalizedTitle:"å®æäºï¼hostç½ç» + docker-composeï¼",charIndex:31934},{level:2,title:"SpringBootå¾®æå¡æåDockeréå",slug:"springbootå¾®æå¡æådockeréå",normalizedTitle:"springbootå¾®æå¡æådockeréå",charIndex:31989},{level:2,title:"å®è£",slug:"å®è£",normalizedTitle:"å®è£",charIndex:25},{level:2,title:"yamlè§å",slug:"yamlè§å",normalizedTitle:"yamlè§å",charIndex:35136},{level:2,title:"å®æï¼èªå·±ç¼åå¾®æå¡ä¸çº¿",slug:"å®æ-èªå·±ç¼åå¾®æå¡ä¸çº¿",normalizedTitle:"å®æï¼èªå·±ç¼åå¾®æå¡ä¸çº¿",charIndex:35230}],headersStr:"Dockerå®è£Nginx Dockerå®è£Tomcat Dockeré¨ç½²es + kibanaÂ· å¯è§å Dockerççè§£åé¡¾ ä½¿ç¨æ°æ®å· å®æï¼å®è£MySQL å¿ååå·åæè½½ï¼å®¹å¨å·ï¼ æ°æ®å·å®¹å¨ DockerFile DockerFileçæå»ºè¿ç¨ DockerFileæä»¤è¯´æ åå»ºä¸ä¸ªèªå·±çCentos CMD åENTRYPOINTåºå« å¶ä½Tomcatéå åå¸èªå·±çéåå°Docker Hub åå¸å°é¿éäºéåæå¡ä¸ æ»ç» è¿æ¥ Docker0 -- link èªå®ä¹ç½ç» ç½ç»è¿éï¼ä¸åç½ç»ä¹é´ï¼ å®æï¼é¨ç½²redis å®æä¸ï¼bridgeç½ç» + dockerï¼ å®æäºï¼hostç½ç» + docker-composeï¼ SpringBootå¾®æå¡æåDockeréå å®è£ yamlè§å å®æï¼èªå·±ç¼åå¾®æå¡ä¸çº¿",content:'# Dockeré¨ç½²è½¯ä»¶å®æ\n\n\n# Dockerå®è£Nginx\n\n# 1. æç´¢éå docker search, å»ºè®®å»docker hubæç´¢ï¼å¯ä»¥çå°å¸®å©ææ¡£\n# 2. ä¸è½½éå docker pull\n# 3. è¿è¡æµè¯\n[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\ncentos              latest              0d120b6ccaa8        32 hours ago        215MB\nnginx               latest              08393e824c32        7 days ago          132MB\n\n# -d åå°è¿è¡\n# -name ç»å®¹å¨å½å\n# -p å®¿ä¸»æºç«¯å£ï¼å®¹å¨åé¨ç«¯å£\n[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker run -d --name nginx01 -p 3344:80 nginx\t# åå°æ¹å¼å¯å¨å¯å¨éå\nfe9dc33a83294b1b240b1ebb0db9cb16bda880737db2c8a5c0a512fc819850e0\n[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                  NAMES\nfe9dc33a8329        nginx               "/docker-entrypoint.â¦"   4 seconds ago       Up 4 seconds        0.0.0.0:3344->80/tcp   nginx01\n[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# curl localhost:3344\t# æ¬å°è®¿é®æµè¯\n# è¿å¥å®¹å¨\n[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker exec -it nginx01 /bin/bash\nroot@fe9dc33a8329:/# whereis nginx\nnginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx\nroot@fe9dc33a8329:/# cd /etc/nginx/\nroot@fe9dc33a8329:/etc/nginx# ls\nconf.d\t\tkoi-utf  mime.types  nginx.conf   uwsgi_params\nfastcgi_params\tkoi-win  modules     scgi_params  win-utf\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nç«¯å£æ´é²åçå¾\n\n\n\n\n# Dockerå®è£Tomcat\n\n# å®æ¹çä½¿ç¨\n# docker run -it --rm ä¸è¬ç¨æ¥æµè¯ï¼ç¨å®å°±å \ndocker run -it --rm tomcat:9.0\n\n# ä¸è½½åå¯å¨\ndocker pull tomcat\n# å¯å¨è¿è¡\ndocker run -d -p 3344:8080 --name tomcat01 tomcat\n# è¿å¥å®¹å¨\ndocker exec -it tomcat01 /bin/bash\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# Dockeré¨ç½²es + kibanaÂ·\n\n# es æ´é²çç«¯å£å¾å¤\n# es ååçèåå­\n# es çæ°æ®ä¸è¬éè¦æ¾ç½®å°å®å¨ç®å½ï¼ æè½½\n# --net somenetwork\tç½ç»éç½®\n\n# å¯å¨elasticsearchï¼ docker run -d --name elasticsearch --net somenetwork -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" elasticsearch:7.6.2\n\n[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" elasticsearch:7.6.2\na920894a940b354d3c867079efada13d96cf9138712c76c8dea58fabd9c7e96f\n\n# å¯å¨äºlinuxå°±å¡ä¸»äºï¼docker stats æ¥çcpuç¶æ\n\n# æµè¯ä¸ä¸esæåäº\n[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# curl localhost:9200\n{\n  "name" : "a920894a940b",\n  "cluster_name" : "docker-cluster",\n  "cluster_uuid" : "bxE1TJMEThKgwmk7Aa3fHQ",\n  "version" : {\n    "number" : "7.6.2",\n    "build_flavor" : "default",\n    "build_type" : "docker",\n    "build_hash" : "ef48eb35cf30adf4db14086e8aabd07ef6fb113f",\n    "build_date" : "2020-03-26T06:34:37.794943Z",\n    "build_snapshot" : false,\n    "lucene_version" : "8.4.0",\n    "minimum_wire_compatibility_version" : "6.8.0",\n    "minimum_index_compatibility_version" : "6.0.0-beta1"\n  },\n  "tagline" : "You Know, for Search"\n}\n\n\n# å¢å åå­éå¶ï¼ä¿®æ¹éç½®æä»¶ -e ç¯å¢éç½®ä¿®æ¹\ndocker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" -e ES_JAVA_OPTS="-Xms64m -Xmx512m" elasticsearch:7.6.2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n\n\n\n# å¯è§å\n\n * portainer\n\ndocker run -d -p 8088:9000 --restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer\n# æµè¯\n[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# curl localhost:8088\n<!DOCTYPE html><html lang="en" ng-app="portainer">\n# å¤ç½è®¿é® http://ip:8088\n\n\n1\n2\n3\n4\n5\n\n\n\n\n * Rancher(CI/CDåç¨)\n\n\n# å®¹å¨æ°æ®å·\n\n\n# Dockerççè§£åé¡¾\n\næ°æ®ï¼å¦ææ°æ®é½å¨å®¹å¨ä¸­ï¼é£ä¹æä»¬å®¹å¨å é¤ï¼æ°æ®å°±ä¼ä¸¢å¤±ï¼éæ±ï¼æ°æ®å¯ä»¥æä¹å\n\nMySQLï¼å®¹å¨å äºï¼å åºè·è·¯ï¼éæ±ï¼MySQLæ°æ®å¯ä»¥å­å¨å¨æ¬å°ï¼\n\nå®¹å¨ä¹é´å¯ä»¥æä¸ä¸ªæ°æ®å±äº«ææ¯ï¼Dockerå®¹å¨ä¸­äº§ççæ°æ®ï¼åæ­¥å°æ¬å°ï¼\n\nè¿å°±æ¯å·ææ¯ï¼ç®å½çæè½½ï¼å°æä»¬å®¹å¨åçç®å½æè½½å°Linuxç®å½ä¸é¢ï¼\n\næ»ç»ï¼ å®¹å¨çæä¹åååæ­¥æä½ï¼å®¹å¨é´æ°æ®ä¹æ¯å¯ä»¥å±äº«çï¼\n\n\n# ä½¿ç¨æ°æ®å·\n\nç´æ¥ä½¿ç¨å½ä»¤æ¥æè½½ -v\n\n# å¿åæè½½åå·åæè½½çç®å½é½é»è®¤å¨/var/lib/docker/volumnç®å½ä¸\n1. docker run -it -v å®¹å¨ç®å½   # å¿åæè½½\n2. docker run -it -v å·å:å®¹å¨ç®å½  # å¿åæè½½\n3. docker run -it -v ä¸»æºç®å½:å®¹å¨ç®å½ # æå®è·¯å¾æè½½\n\n[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker run -it -v /home/ceshi:/home centos /bin/bash\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n\næµè¯æä»¶çåæ­¥ï¼å¨ä¸»æºä¸æ¹å¨ï¼è§å¯å®¹å¨ååï¼\n\n\n\næ³¨æï¼è®¾ç½®å®¹å¨æ°æ®å·æè½½åï¼å®¹å¨ç®å½åæè½½çä¸»æºç®å½ä¿æå®æ¶åæ­¥ï¼\n\n\n# å®æï¼å®è£MySQL\n\næèï¼MySQLçæ°æ®æä¹åçé®é¢ï¼\n\n# è·åéå\n[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker pull mysql:5.7\n\n# è¿è¡å®¹å¨ï¼ éè¦åæ°æ®æè½½ï¼ \n# å®è£å¯å¨mysqlï¼éè¦éç½®å¯ç ï¼æ³¨æï¼\n# å®æ¹æµè¯ï¼ docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag\n\n# å¯å¨æä»¬ç\n-d\t\t# åå°è¿è¡\n-p\t\t# ç«¯å£æ å°\n-v\t\t# å·æè½½\n-e\t\t# ç¯å¢éç½®\n--name\t# å®¹å¨çåå­\n[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker run -d -p 3344:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7\n9552bf4eb2b69a2ccd344b5ba5965da4d97b19f2e1a78626ac1f2f8d276fc2ba\n\n# å¯å¨æåä¹åï¼æä»¬å¨æ¬å°ä½¿ç¨navicaté¾æ¥æµè¯ä¸ä¸\n# navicaté¾æ¥å°æå¡å¨ç3344 --- 3344 å å®¹å¨ç3306æ å°ï¼è¿ä¸ªæ¶åæä»¬å°±å¯ä»¥è¿æ¥ä¸mysqlå½ï¼\n\n# å¨æ¬å°æµè¯åå»ºä¸ä¸ªæ°æ®åºï¼æ¥çä¸æä»¬çè·¯å¾æ¯å¦okï¼\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n\n\n\n# å¿ååå·åæè½½ï¼å®¹å¨å·ï¼\n\n# å¿åæè½½\n-v å®¹å¨åè·¯å¾\ndocker run -d -P --name nginx01 -v /etc/nginx nginx\t\t# -P éæºæå®ç«¯å£\n\n# æ¥çæævolumeçæåµ\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker volume ls\nDRIVER              VOLUME NAME\nlocal               561b81a03506f31d45ada3f9fb7bd8d7c9b5e0f826c877221a17e45d4c80e096\nlocal               36083fb6ca083005094cbd49572a0bffeec6daadfbc5ce772909bb00be760882\n\n# è¿éåç°ï¼è¿ç§æåµå°±æ¯å¿åæè½½ï¼æä»¬å¨-v åé¢åªåäºå®¹å¨åçè·¯å¾ï¼æ²¡æåå®¹å¨å¤çè·¯å¾ï¼\n\n# å·åæè½½\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx nginx\n26da1ec7d4994c76e80134d24d82403a254a4e1d84ec65d5f286000105c3da17\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                   NAMES\n26da1ec7d499        nginx               "/docker-entrypoint.â¦"   3 seconds ago       Up 2 seconds        0.0.0.0:32769->80/tcp   nginx02\n486de1da03cb        nginx               "/docker-entrypoint.â¦"   3 minutes ago       Up 3 minutes        0.0.0.0:32768->80/tcp   nginx01\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker volume ls\nDRIVER              VOLUME NAME\nlocal               561b81a03506f31d45ada3f9fb7bd8d7c9b5e0f826c877221a17e45d4c80e096\nlocal               36083fb6ca083005094cbd49572a0bffeec6daadfbc5ce772909bb00be760882\nlocal               juming-nginx\n\n# éè¿ -v å·å:å®¹å¨åçè·¯å¾\n# æ¥çä¸ä¸è¿ä¸ªå·\n# docker volume inspect juming-nginx\n\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker volume inspect juming-nginx\n[\n  {\n      "CreatedAt": "2020-08-12T18:15:21+08:00",\n      "Driver": "local",\n      "Labels": null,\n      "Mountpoint": "/var/lib/docker/volumes/juming-nginx/_data",\n      "Name": "juming-nginx",\n      "Options": null,\n      "Scope": "local"\n  }\n]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n\n\næå±\n\n# éè¿ -v å®¹å¨åè·¯å¾[:ro|:rw] æ¹åè¯»åæé \n# ro readonly åªè¯»\t\n# rw readwrite å¯è¯»å¯å\ndocker run -d -P --name nginx02 -v juming-nginx:/etc/nginx:ro nginx\ndocker run -d -P --name nginx02 -v juming-nginx:/etc/nginx:rw nginx\n# ro åªè¦çå°roå°±è¯´æè¿ä¸ªè·¯å¾åªè½éè¿å®¿ä¸»æºæ¥æä½ï¼å®¹å¨åå®¹æ æ³æä½\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# åå§Dockerfile\n\n# åå»ºä¸ä¸ªdockerfileæä»¶ï¼ åå­å¯ä»¥éæº\n# æä»¶çåå®¹ æå®ï¼å¤§åï¼åæ°\n\nFROM centos\n\n# å¿åæè½½\nVOLUME ["volume01", "volume02"]\n\nCMD echo "----end----"\nCMD /bin/bash\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n\nå¯å¨èªå·±çå®¹å¨\n\n\n\ndocker inspect å®¹å¨id\n\n\n\nåè®¾æå»ºéåæ¶åæ²¡ææè½½å·ï¼è¦æå¨éåæè½½ -v å·å:å®¹å¨åè·¯å¾ï¼\n\n\n# æ°æ®å·å®¹å¨\n\nå¤ä¸ªmysqlåæ­¥æ°æ®ï¼\n\n\n\n# å¯å¨3ä¸ªå®¹å¨ï¼éè¿æä»¬åæèªå·±åçéåå¯å¨\n\n\n1\n\n\n\n\n\n\nå¤ä¸ªmysqlå®ç°æ°æ®å±äº«\n\n[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker run -d -p 3344:3306 -v /etc/mysql/conf.d -v /var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7\n[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker run -d -p 3344:3306 -v /etc/mysql/conf.d -v /var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql02 --volumes-from mysql01 mysql:5.7\n[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker run -d -p 3344:3306 -v /etc/mysql/conf.d -v /var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql03 --volumes-from mysql01 mysql:5.7\n\n\n1\n2\n3\n\n\n\n\ndocker inspect centos01\n[{\n\t"Type": "volume",\n\t"Name": "7895bf2c2184d440f4be4c539313055ce35f70606728aad7bb73dd46cf4dcfca",\n\t"Source": "/var/lib/docker/volumes/7895bf2c2184d440f4be4c539313055ce35f70606728aad7bb73dd46cf4dcfca/_data",\n\t"Destination": "volume02",\n\t"Driver": "local",\n\t"Mode": "",\n\t"RW": true,\n\t"Propagation": ""\n}, {\n\t"Type": "volume",\n\t"Name": "27e5f3ac52359984ddb695cb2bd1c375fb218e8ff6257044294e78bb63af36f4",\n\t"Source": "/var/lib/docker/volumes/27e5f3ac52359984ddb695cb2bd1c375fb218e8ff6257044294e78bb63af36f4/_data",\n\t"Destination": "volume01",\n\t"Driver": "local",\n\t"Mode": "",\n\t"RW": true,\n\t"Propagation": ""\n}]\n\ndocker inspect centos02 \n"Mounts": [{\n\t"Type": "volume",\n\t"Name": "27e5f3ac52359984ddb695cb2bd1c375fb218e8ff6257044294e78bb63af36f4",\n\t"Source": "/var/lib/docker/volumes/27e5f3ac52359984ddb695cb2bd1c375fb218e8ff6257044294e78bb63af36f4/_data",\n\t"Destination": "volume01",\n\t"Driver": "local",\n\t"Mode": "",\n\t"RW": true,\n\t"Propagation": ""\n}, {\n\t"Type": "volume",\n\t"Name": "7895bf2c2184d440f4be4c539313055ce35f70606728aad7bb73dd46cf4dcfca",\n\t"Source": "/var/lib/docker/volumes/7895bf2c2184d440f4be4c539313055ce35f70606728aad7bb73dd46cf4dcfca/_data",\n\t"Destination": "volume02",\n\t"Driver": "local",\n\t"Mode": "",\n\t"RW": true,\n\t"Propagation": ""\n}]\n\ndocker inspect centos03 \n"Mounts": [{\n\t"Type": "volume",\n\t"Name": "7895bf2c2184d440f4be4c539313055ce35f70606728aad7bb73dd46cf4dcfca",\n\t"Source": "/var/lib/docker/volumes/7895bf2c2184d440f4be4c539313055ce35f70606728aad7bb73dd46cf4dcfca/_data",\n\t"Destination": "volume02",\n\t"Driver": "local",\n\t"Mode": "",\n\t"RW": true,\n\t"Propagation": ""\n}, {\n\t"Type": "volume",\n\t"Name": "27e5f3ac52359984ddb695cb2bd1c375fb218e8ff6257044294e78bb63af36f4",\n\t"Source": "/var/lib/docker/volumes/27e5f3ac52359984ddb695cb2bd1c375fb218e8ff6257044294e78bb63af36f4/_data",\n\t"Destination": "volume01",\n\t"Driver": "local",\n\t"Mode": "",\n\t"RW": true,\n\t"Propagation": ""\n}]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n\n\néè¿æ¥çcentos01ã02ã03çæ°æ®å·æè½½æåµï¼å¯ä»¥åç°ï¼æ°æ®å·å®¹å¨çå®ç°åçå¶å®å°±æ¯æå¶ä»ç»§æ¿æ°æ®å·å®¹å¨çæ°æ®å·æ å°å°ç¸åçå¤é¨æè½½ç¹ï¼è¿æ ·è¿ä¸ªå¤é¨æè½½ç¹æç®å½æä»¶åæ´ï¼å°±ä¼åæ­¥å°æ°æ®å·å®¹å¨ä»¥åå¶ä»ç»§æ¿å³ç³»çå®¹å¨ä¸­\n\n\n# DockerFile\n\n\n# DockerFileçæå»ºè¿ç¨\n\nåºç¡ç¥è¯ï¼\n\n 1. æ¯ä¸ªä¿çå³é®å­ï¼æä»¤ï¼é½æ¯å¿é¡»å¤§åå­æ¯\n\n 2. æ§è¡ä»ä¸å°ä¸é¡ºåºæ§è¡\n\n 3. # è¡¨ç¤ºæ³¨é\n\n 4. æ¯ä¸ªæä»¤é½ä¼åå»ºæäº¤ä¸ä¸ªæ°çéåå±ï¼å¹¶æäº¤ï¼\n\n\n\ndockerFileæ¯é¢åå¼åçï¼ æä»¬ä»¥åè¦åå¸é¡¹ç®ï¼ åéåï¼ å°±éè¦ç¼ådockefileæä»¶ï¼ è¿ä¸ªæä»¶ååç®åï¼\n\n\n# DockerFileæä»¤è¯´æ\n\n\n\n\n# åå»ºä¸ä¸ªèªå·±çCentos\n\n# 1. ç¼åDockerfileçæä»¶\n[root@localhost dockfile]# cat mydockerfile-centos \nFROM centos\nMAINTAINER xiaofan<594042358@qq.com>\n\nENV MYPATH /usr/local\nWORKDIR $MYPATH\t\t# éåçå·¥ä½ç®å½\n\nRUN yum -y install vim \\\n\t&& yum -y install net-tools\n\nEXPOSE 80\n\nCMD echo $MYPATH\nCMD echo "---end---"\nCMD /bin/bash\n\n# 2. éè¿è¿ä¸ªæä»¶æå»ºéå\n# å½ä»¤ docker build -f <Dockerfileæä»¶è·¯å¾> -t éåå:[tag] <æå»ºä¸ä¸æè·¯å¾>\n\n[root@localhost dockfile]# docker build -f mydockerfile-centos -t mycentos:0.1 .\n\nSuccessfully built d2d9f0ea8cb2\nSuccessfully tagged mycentos:0.1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n\n\næä»¬å¯ä»¥ååºæ¬å°è¿è¡çåæ´åå²\n\n\n\n\n# CMD åENTRYPOINTåºå«\n\nCMD\n\n * æå®è¿ä¸ªå®¹å¨å¯å¨çæ¶åè¦è¿è¡çå½ä»¤\n * å½åæ¶å­å¨ENTRYPOINTæ¶ï¼ä¼è¢«å½ä½ENTRYPOINTå£°æcommandçåæ°ï¼å¯ååæ°ï¼\n * ä¼è¢«docker run åæå®çcommandè¦ç\n\nENTRYPOINT\n\n * æå®è¿ä¸ªå®¹å¨å¯å¨çæ¶åè¦è¿è¡çå½ä»¤\n * å½åæ¶å­å¨CMDæ¶ï¼ä¼æCMDå£°æcommandå½ä½åæ°ï¼å¯ååæ°ï¼\n * ä¼è¢«docker run --entrypoint åæå®çcommandè¦ç\n\n# åªåå«CMD\n\n[root@localhost dockfile]# cat dockfile\nFROM centos\nCMD ["ls", "-a"]\n\n[root@localhost dockfile]# docker build -f dockerfile -t centos:v1 .\n\n# 3. runè¿è¡ï¼ åç°æä»¬çls -a å½ä»¤çæ\n[root@localhost dockfile]# docker run ebe6a52bb125\n.\n..\n.dockerenv\nbin\ndev\netc\nhome\nlib\nlib64\n\n# æ³è¿½å ä¸ä¸ªå½ä»¤ -l åæ ls -al\n[root@localhost dockfile]# docker run ebe6a52bb125 -l\ndocker: Error response from daemon: OCI runtime create failed: container_linux.go:349: starting container process caused "exec: \\"-l\\": executable file not found in $PATH": unknown.\n[root@localhost dockfile]# docker run ebe6a52bb125 ls -l\n\n# cmdçæåµä¸ -læ¿æ¢äºCMD["ls", "-a"]å½ä»¤ï¼ -lä¸æ¯å½ä»¤ï¼æä»¥æ¥éäº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n# åªåå«ENTRYPOINT\n\n[root@localhost dockfile]# cat dockerfile \nFROM centos\nENTRYPOINT ["ls", "-a"]\n\n\n[root@localhost dockfile]# docker build -f dockerfile -t centos:v1 .\n\n# 3. runè¿è¡ åç°æä»¬çls -a å½ä»¤åæ ·çæ\n[root@localhost dockfile]# docker run centos:v1\n.\n..\n.dockerenv\nbin\ndev\netc\nhome\nlib\n\n# 4. æä»¬çè¿½å å½ä»¤ï¼ æ¯ç´æ¥æ¼æ¥å°ENTRYPOINTå½ä»¤çåé¢çï¼\n[root@localhost dockfile]# docker run centos:v1 -l\ntotal 56\ndrwxr-xr-x  1 root root 4096 Aug 13 07:52 .\ndrwxr-xr-x  1 root root 4096 Aug 13 07:52 ..\n-rwxr-xr-x  1 root root    0 Aug 13 07:52 .dockerenv\nlrwxrwxrwx  1 root root    7 May 11  2019 bin -> usr/bin\ndrwxr-xr-x  5 root root  340 Aug 13 07:52 dev\ndrwxr-xr-x  1 root root 4096 Aug 13 07:52 etc\ndrwxr-xr-x  2 root root 4096 May 11  2019 home\nlrwxrwxrwx  1 root root    7 May 11  2019 lib -> usr/lib\nlrwxrwxrwx  1 root root    9 May 11  2019 lib64 -> usr/lib64\ndrwx------  2 root root 4096 Aug  9 21:40 lost+found\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n\n\n# åæ¶åå«CMDåENTRYPOINT\n\n[root@localhost dockfile]# cat dockerfile \nFROM centos:latest\nMAINTAINER ZHAOXING<779292642@qq.com>\n\nENV MYPATH /usr/local\nWORKDIR $MYPATH\n\nCMD ["-a"]\nENTRYPOINT ["ls"]\n\n[root@localhost dockfile]# docker build -f dockerfile -t centos:v1 .\n\n# æ§è¡å½ä»¤ï¼ls -a\n# CMDå£°æçcommandä¼å½ä½ENTRYPOINTå£°æçcommandçåæ°\n[root@localhost dockfile]# docker run centos:v1\n.\n..\nbin\netc\ngames\ninclude\nlib\nlib64\nlibexec\nsbin\nshare\nsrc\n\n# è¦çCMDå£°æçcommand\n[root@localhost dockfile]# docker run centos:v1 -l\ntotal 0\ndrwxr-xr-x. 2 root root  6 Nov  3  2020 bin\ndrwxr-xr-x. 2 root root  6 Nov  3  2020 etc\ndrwxr-xr-x. 2 root root  6 Nov  3  2020 games\ndrwxr-xr-x. 2 root root  6 Nov  3  2020 include\ndrwxr-xr-x. 2 root root  6 Nov  3  2020 lib\ndrwxr-xr-x. 3 root root 16 Sep 15 14:17 lib64\ndrwxr-xr-x. 2 root root  6 Nov  3  2020 libexec\ndrwxr-xr-x. 2 root root  6 Nov  3  2020 sbin\ndrwxr-xr-x. 5 root root 46 Sep 15 14:17 share\ndrwxr-xr-x. 2 root root  6 Nov  3  2020 src\n[root@localhost dockfile]# docker run centos:v1 -al\ntotal 8\ndrwxr-xr-x. 12 root root 4096 Sep 15 14:17 .\ndrwxr-xr-x. 12 root root 4096 Sep 15 14:17 ..\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 bin\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 etc\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 games\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 include\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 lib\ndrwxr-xr-x.  3 root root   16 Sep 15 14:17 lib64\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 libexec\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 sbin\ndrwxr-xr-x.  5 root root   46 Sep 15 14:17 share\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 src\n\n\n# è¦çENTRYPOINTå£°æçcommandï¼æ­¤æ¶CMDå£°æçcommandå¤±æï¼\n[root@localhost dockfile]# docker run --entrypoint ls 3a\nbin\netc\ngames\ninclude\nlib\nlib64\nlibexec\nsbin\nshare\nsrc\n\n# åæ¶è¦çENTRYPOINTåCMDå£°æçcommand\n[root@localhost dockfile]# docker run --entrypoint ls 3a -a\n.\n..\nbin\netc\ngames\ninclude\nlib\nlib64\nlibexec\nsbin\nshare\nsrc\n[root@localhost dockfile]# docker run --entrypoint ls 3a -al\ntotal 8\ndrwxr-xr-x. 12 root root 4096 Sep 15 14:17 .\ndrwxr-xr-x. 12 root root 4096 Sep 15 14:17 ..\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 bin\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 etc\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 games\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 include\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 lib\ndrwxr-xr-x.  3 root root   16 Sep 15 14:17 lib64\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 libexec\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 sbin\ndrwxr-xr-x.  5 root root   46 Sep 15 14:17 share\ndrwxr-xr-x.  2 root root    6 Nov  3  2020 src\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n\n\n\n# Dockerfileå¶ä½Tomcatéå\n\n\n# å¶ä½Tomcatéå\n\n 1. åå¤éåæä»¶ tomcatåç¼©åï¼jdkçåç¼©åï¼\n\n\n\n 2. ç¼åDockerfileæä»¶, buildé»è®¤å¨æå»ºä¸ä¸æå¯»æ¾åç§°ä¸ºDockfileçæä»¶ï¼å°±ä¸éè¦-f æå®äºï¼\n\n[root@iZ2zeg4ytp0whqtmxbsqiiZ tomcat]# cat Dockerfile \nFROM centos\nMAINTAINER xiaofan<594042358@qq.com>\nCOPY readme.txt /usr/local/readme.txt\n# ADD ä¼èªå¨è§£å\nADD jdk-8u73-linux-x64.tar.gz /usr/local/\nADD apache-tomcat-9.0.37.tar.gz /usr/local/\nRUN yum -y install vim\nENV MYPATH /usr/local\nWORKDIR $MYPATH\nENV JAVA_HOME /usr/local/jdk1.8.0_73\nENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar\nENV CATALINA_HOME /usr/local/apache-tomcat-9.0.37\nENV CATALINA_BASH /usr/local/apache-tomcat-9.0.37\nENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin\nEXPOSE 8080\nCMD /usr/local/apache-tomcat-9.0.37/bin/startup.sh && tail -F /usr/local/apache-tomcat-9.0.37/bin/logs/catalina.out\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n 3. æå»ºéå\n\n# docker build -t diytomcat .\n\n\n1\n\n 4. å¯å¨éå\n\ndocker run -d -p 3344:8080 \\\n--name xiaofantomcat1 \\\n-v /home/xiaofan/build/tomcat/test:/usr/local/apache-tomcat-9.0.37/webapps/test \\\n-v /home/xiaofan/build/tomcat/tomcatlogs/:/usr/local/apache-tomcat-9.0.37/logs \ndiytomcat\n\n\n1\n2\n3\n4\n5\n\n 5. è®¿é®æµè¯\n\nå¨æ¬å°ç¼åweb.xmlåindex.jspè¿è¡æµè¯\n\n\n\n<?xml version="1.0" encoding="UTF-8"?>\n<web-app version="2.4" \n    xmlns="http://java.sun.com/xml/ns/j2ee" \n    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee \n        http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">\n        \n</web-app>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\n    pageEncoding="UTF-8"%>\n<!DOCTYPE html>\n<html>\n<head>\n<meta charset="utf-8">\n<title>hello. xiaofan</title>\n</head>\n<body>\nHello World!<br/>\n<%\nSystem.out.println("-----my test web logs------");\n%>\n</body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nåç°ï¼é¡¹ç®é¨ç½²æåï¼ å¯ä»¥ç´æ¥è®¿é®okï¼\n\n\n\n\n# åå¸èªå·±çéåå°Docker Hub\n\n 1. Dockker Hub æ³¨åèªå·±çè´¦å·ï¼\n 2. ç¡®å®è¿ä¸ªè´¦å·å¯ä»¥ç»å½\n\n\n\n 3. å¨æä»¬çæå¡å¨ä¸æäº¤èªå·±çéå\n\n# pushå°æä»¬çæå¡å¨ä¸\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker push diytomcat\nThe push refers to repository [docker.io/library/diytomcat]\n2eaca873a720: Preparing \n1b38cc4085a8: Preparing \n088ebb58d264: Preparing \nc06785a2723d: Preparing \n291f6e44771a: Preparing \ndenied: requested access to the resource is denied\t# æç»\n\n# pushéåçé®é¢ï¼\nThe push refers to repository [docker.io/1314520007/diytomcat]\nAn image does not exist locally with the tag: 1314520007/diytomcat\n\n# è§£å³ï¼å¢å ä¸ä¸ªtag\ndocker tag diytomcat 1314520007/tomcat:1.0\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n\n\n# åå¸å°é¿éäºéåæå¡ä¸\n\n 1. ç»å½é¿éäº\n\n 2. æ¾å°å®¹å¨éåæå¡\n\n 3. åå»ºå½åç©ºé´\n\n\n\n 4. åå»ºéåä»åº\n\n\n\n 5. ç¹å»ä»åºåç§°ï¼åèå®æ¹ææ¡£å³å¯\n\n\n\n\n# æ»ç»\n\n\n\n\n# Dockerç½ç»\n\n\n# è¿æ¥ Docker0\n\næµè¯\n\n\n\nä¸ä¸ªç½ç»\n\n# é®é¢ï¼ dockeræ¯å¦ä½å¤çå®¹å¨ç½ç»è®¿é®çï¼\n\n# [root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker run -d -P --name tomcat01 tomcat\n\n# æ¥çå®¹å¨åé¨çç½ç»å°å ip addr\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat01 ip addrï¼ åç°å®¹å¨å¯å¨çæ¶åå¾å°ä¸ä¸ªeth0@if115 ipå°åï¼dockeråéçï¼\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n114: eth0@if115: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default \n    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0\n    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n\n# æèï¼ linux è½ä¸è½pingéå®¹å¨ï¼\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# ping 172.17.0.2\nPING 172.17.0.2 (172.17.0.2) 56(84) bytes of data.\n64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.077 ms\n64 bytes from 172.17.0.2: icmp_seq=2 ttl=64 time=0.069 ms\n64 bytes from 172.17.0.2: icmp_seq=3 ttl=64 time=0.075 ms\n\n# linux å¯ä»¥ ping édockerå®¹å¨åé¨ï¼\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nåç\n\n> æä»¬æ¯å¯å¨ä¸ä¸ªdockerå®¹å¨ï¼ dockerå°±ä¼ç»dockerå®¹å¨åéä¸ä¸ªipï¼ æä»¬åªè¦å®è£äºdockerï¼å°±ä¼æä¸ä¸ªç½å¡ docker0æ¡¥æ¥æ¨¡å¼ï¼ä½¿ç¨çææ¯æ¯veth-pairææ¯ï¼\n\nåæ¬¡æµè¯ ip addr\n\n\n\nåå¯å¨ä¸ä¸ªå®¹å¨æµè¯ï¼ åç°åå¤äºä¸å¯¹ç½å¡\n\n\n\n# æä»¬åç°è¿ä¸ªå®¹å¨å¸¦æ¥ç½å¡ï¼é½æ¯ä¸å¯¹å¯¹ç\n# veth-pair å°±æ¯ä¸å¯¹çèæè®¾å¤æ¥å£ï¼ä»ä»¬é½æ¯æå¯¹åºç°çï¼ä¸ç«¯è¿çåè®®ï¼ä¸ç«¯å½¼æ­¤ç¸è¿\n# æ­£å ä¸ºæè¿ä¸ªç¹æ§ï¼veth-pairåå½ä¸ä¸ªæ¡¥æ¢ï¼ è¿æ¥åç§èæç½ç»è®¾å¤\n# OpenStacï¼ Dockerå®¹å¨ä¹é´çé¾æ¥ï¼OVSçé¾æ¥ï¼ é½æ¯ä½¿ç¨veth-pairææ¯\n\n\n1\n2\n3\n4\n\n\næä»¬æµè¯ä¸ä¸tomcat01åtomcat02ä¹é´æ¯å¦å¯ä»¥pingéï¼\n\nç»è®ºï¼å®¹å¨ä¸å®¹å¨ä¹é´æ¯å¯ä»¥ç¸äºpingéçï¼\n\nç»å¶ä¸ä¸ªç½ç»æ¨¡åå¾\n\n\n\nç»è®ºï¼tomcat01åtomcat02æ¯å±ç¨çä¸ä¸ªè·¯ç±å¨ï¼docker0\n\nææå®¹å¨ä¸æå®ç½ç»çæåµä¸ï¼é½æ¯docker0è·¯ç±çï¼dockerä¼ç»æä»¬çå®¹å¨åéä¸ä¸ªé»è®¤çå¯ç¨IP\n\nå°ç»\n\nDockerä½¿ç¨çæ¯Linuxçæ¡¥æ¥ï¼å®¿ä¸»æºä¸­æ¯ä¸ä¸ªDockerå®¹å¨çç½æ¡¥docker0.\n\n\n\nDockerä¸­çææçç½ç»æ¥å£é½æ¯èæçï¼èæçè½¬åæçé«ï¼ï¼åç½ä¼ éæä»¶ï¼ï¼\n\nåªè¦å®¹å¨å é¤ï¼å¯¹åºçç½æ¡¥ä¸å¯¹å°±æ²¡æäºï¼\n\n\n\n\n# -- link\n\nè§£å³éè¿docker0èéæ¶éè¿å®¹å¨åè®¿é®\n\næèä¸ä¸ªåºæ¯ï¼æä»¬ç¼åäºä¸ä¸ªå¾®æå¡ï¼database url =ipï¼ é¡¹ç®ä¸éå¯ï¼æ°æ®ipæ¢æäºï¼æä»¬å¸æå¯ä»¥å¤çè¿ä¸ªé®é¢ï¼å¯ä»¥æåå­æ¥è¿è¡è®¿é®å®¹å¨\n\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat02 ping tomcat01\nping: tomcat01: Name or service not known\n\n# å¦ä½å¯ä»¥è§£å³å¢ï¼\n# éè¿--linkå³å¯ä»¥è§£å³ç½ç»è¿éé®é¢\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker run -d -P  --name tomcat03 --link tomcat02 tomcat\n3a2bcaba804c5980d94d168457c436fbd139820be2ee77246888f1744e6bb473\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                     NAMES\n3a2bcaba804c        tomcat              "catalina.sh run"   4 seconds ago       Up 3 seconds        0.0.0.0:32772->8080/tcp   tomcat03\nf22ed47ed1be        tomcat              "catalina.sh run"   57 minutes ago      Up 57 minutes       0.0.0.0:32771->8080/tcp   tomcat02\n9d97f93401a0        tomcat              "catalina.sh run"   About an hour ago   Up About an hour    0.0.0.0:32770->8080/tcp   tomcat01\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat03 ping tomcat02\nPING tomcat02 (172.17.0.3) 56(84) bytes of data.\n64 bytes from tomcat02 (172.17.0.3): icmp_seq=1 ttl=64 time=0.129 ms\n64 bytes from tomcat02 (172.17.0.3): icmp_seq=2 ttl=64 time=0.100 ms\n64 bytes from tomcat02 (172.17.0.3): icmp_seq=3 ttl=64 time=0.110 ms\n64 bytes from tomcat02 (172.17.0.3): icmp_seq=4 ttl=64 time=0.107 ms\n\n# ååå¯ä»¥pingéåï¼\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat02 ping tomcat03\nping: tomcat03: Name or service not known\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\næ¢ç©¶ï¼inspectï¼\n\n\n\nå¶å®è¿ä¸ªtomcat03å°±æ¯å¨æ¬å°éç½®äºtomcat02çéç½®ï¼\n\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat03 cat /etc/hosts\n127.0.0.1\tlocalhost\n::1\tlocalhost ip6-localhost ip6-loopback\nfe00::0\tip6-localnet\nff00::0\tip6-mcastprefix\nff02::1\tip6-allnodes\nff02::2\tip6-allrouters\n172.17.0.3\ttomcat02 f22ed47ed1be\n172.17.0.4\t3a2bcaba804c\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\næ¬è´¨æ¢ç©¶ï¼--link å°±æ¯æä»¬å¨hostséç½®ä¸­å¢å äºä¸ä¸ª172.17.0.3 tomcat02 f22ed47ed1be\n\næä»¬ç°å¨ç©Dockerå·²ç»ä¸å»ºè®®ä½¿ç¨--linkäºï¼\n\nèªå®ä¹ç½ç»ï¼ä¸ä½¿ç¨Docker0ï¼\n\nDocker0çé®é¢ï¼å®ä¸æ¯æå®¹å¨åé¾æ¥è®¿é®ï¼\n\n\n# èªå®ä¹ç½ç»\n\næ¥çææçdockerç½ç»\n\n\n\nç½ç»æ¨¡å¼\n\n * bridgeï¼ æ¡¥æ¥æ¨¡å¼ï¼æ¡¥æ¥ docker é»è®¤ï¼èªå·±åå»ºçä¹æ¯ç¨brdgeæ¨¡å¼\n\n * noneï¼ ä¸éç½®ç½ç»\n\n * hostï¼ åå®¿ä¸»æºå±äº«ç½ç»\n\n * containerï¼å®¹å¨ç½ç»è¿éï¼ï¼ç¨çå°ï¼ å±éå¾å¤§ï¼\n\næµè¯\n\n# æä»¬ç´æ¥å¯å¨çå½ä»¤é»è®¤æä¸ä¸ª --net bridgeï¼èè¿ä¸ªå°±æ¯æä»¬çdocker0\ndocker run -d -P --name tomcat01 tomcat\ndocker run -d -P --name tomcat01 --net bridge tomcat\n\n# docker0ç¹ç¹ï¼é»è®¤ï¼å®¹å¨åä¸è½è®¿é®ï¼ --linkå¯ä»¥æéè¿æ¥ï¼\n# æä»¬å¯ä»¥èªå®ä¹ä¸ä¸ªç½ç»ï¼\n# --driver bridge\n# --subnet 192.168.0.0/16 å¯ä»¥æ¯æ255*255ä¸ªç½ç» 192.168.0.2 ~ 192.168.255.254\n# --gateway 192.168.0.1\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet\n26a5afdf4805d7ee0a660b82244929a4226470d99a179355558dca35a2b983ec\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker network ls\nNETWORK ID          NAME                DRIVER              SCOPE\n30d601788862        bridge              bridge              local\n226019b14d91        host                host                local\n26a5afdf4805        mynet               bridge              local\n7496c014f74b        none                null                local\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\næä»¬èªå·±åå»ºçç½ç»å°±okäºï¼\n\n\n\nå¨èªå·±åå»ºçç½ç»éé¢å¯å¨ä¸¤ä¸ªå®¹å¨\n\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker run -d -P --name tomcat-net-01 --net mynet tomcat\n0e85ebe6279fd23379d39b27b5f47c1e18f23ba7838637802973bf6449e22f5c\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker run -d -P --name tomcat-net-02 --net mynet tomcat\nc6e462809ccdcebb51a4078b1ac8fdec33f1112e9e416406b606d0c9fb6f21b5\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker network inspect mynet\n[\n    {\n        "Name": "mynet",\n        "Id": "26a5afdf4805d7ee0a660b82244929a4226470d99a179355558dca35a2b983ec",\n        "Created": "2020-08-14T11:12:40.553433163+08:00",\n        "Scope": "local",\n        "Driver": "bridge",\n        "EnableIPv6": false,\n        "IPAM": {\n            "Driver": "default",\n            "Options": {},\n            "Config": [\n                {\n                    "Subnet": "192.168.0.0/16",\n                    "Gateway": "192.168.0.1"\n                }\n            ]\n        },\n        "Internal": false,\n        "Attachable": false,\n        "Ingress": false,\n        "ConfigFrom": {\n            "Network": ""\n        },\n        "ConfigOnly": false,\n        "Containers": {\n            "0e85ebe6279fd23379d39b27b5f47c1e18f23ba7838637802973bf6449e22f5c": {\n                "Name": "tomcat-net-01",\n                "EndpointID": "576ce5c0f5860a5aab5e487a805da9d72f41a409c460f983c0bd341dd75d83ac",\n                "MacAddress": "02:42:c0:a8:00:02",\n                "IPv4Address": "192.168.0.2/16",\n                "IPv6Address": ""\n            },\n            "c6e462809ccdcebb51a4078b1ac8fdec33f1112e9e416406b606d0c9fb6f21b5": {\n                "Name": "tomcat-net-02",\n                "EndpointID": "81ecbc4fe26e49855fe374f2d7c00d517b11107cc91a174d383ff6be37d25a30",\n                "MacAddress": "02:42:c0:a8:00:03",\n                "IPv4Address": "192.168.0.3/16",\n                "IPv6Address": ""\n            }\n        },\n        "Options": {},\n        "Labels": {}\n    }\n]\n\n# åæ¬¡pingè¿æ¥\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat-net-01 ping 192.168.0.3\nPING 192.168.0.3 (192.168.0.3) 56(84) bytes of data.\n64 bytes from 192.168.0.3: icmp_seq=1 ttl=64 time=0.113 ms\n64 bytes from 192.168.0.3: icmp_seq=2 ttl=64 time=0.093 ms\n^C\n--- 192.168.0.3 ping statistics ---\n2 packets transmitted, 2 received, 0% packet loss, time 999ms\nrtt min/avg/max/mdev = 0.093/0.103/0.113/0.010 ms\n# ç°å¨ä¸ä½¿ç¨ --linkä¹å¯ä»¥pingåå­äºï¼\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat-net-01 ping tomcat-net-02\nPING tomcat-net-02 (192.168.0.3) 56(84) bytes of data.\n64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq=1 ttl=64 time=0.068 ms\n64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq=2 ttl=64 time=0.096 ms\n64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq=3 ttl=64 time=0.094 ms\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n\n\næä»¬èªå®ä¹çç½ç»dockeré½å·²ç»å¸®æä»¬ç»´æ¤å¥½äºå¯¹åºçå³ç³»ï¼æ¨èæä»¬å¹³æ¶è¿æ ·ä½¿ç¨ç½ç»\n\nå¥½å¤ï¼\n\n> redis - ä¸åçéç¾¤ä½¿ç¨ä¸åçç½ç»ï¼ä¿è¯éç¾¤æ¯å®å¨åå¥åº·ç\n> \n> mysql - ä¸åçéç¾¤ä½¿ç¨ä¸åçç½ç»ï¼ä¿è¯éç¾¤æ¯å®å¨åå¥åº·ç\n\n\n# ç½ç»è¿éï¼ä¸åç½ç»ä¹é´ï¼\n\n\n\næµè¯æétomcat01 åmynet\n\n\n\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker network connect  mynet tomcat01\n\n# è¿éä¹åå°±æ¯è®²tomcat01æ¾å°äºmynetç½ç»ä¸\n# ä¸ä¸ªå®¹å¨ä¸¤ä¸ªipå°åï¼\n# é¿éäºæå¡å¨ï¼å¬ç½ipï¼ç§ç½ip\n\n\n1\n2\n3\n4\n5\n\n\n\n\n\n\n# è¿éok\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat01 ping tomcat-net-01\nPING tomcat-net-01 (192.168.0.2) 56(84) bytes of data.\n64 bytes from tomcat-net-01.mynet (192.168.0.2): icmp_seq=1 ttl=64 time=0.100 ms\n64 bytes from tomcat-net-01.mynet (192.168.0.2): icmp_seq=2 ttl=64 time=0.085 ms\n^C\n--- tomcat-net-01 ping statistics ---\n2 packets transmitted, 2 received, 0% packet loss, time 1000ms\nrtt min/avg/max/mdev = 0.085/0.092/0.100/0.012 ms\n# ä¾æ§æ æ³è¿éï¼æ²¡æconnect\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat02 ping tomcat-net-01\nping: tomcat-net-01: Name or service not known\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nç»è®ºï¼åè®¾è¦è·¨ç½ç»æä½å«äººï¼å°±è¦ä½¿ç¨docker network connectè¿é.....!\n\n\n# å®æï¼é¨ç½²redis\n\n\n\n\n# å®æä¸ï¼bridgeç½ç» + dockerï¼\n\n> è¿ç§æ¹æ¡ spring boot é¡¹ç®è¿æ¥rediséç¾¤æ¶æé®é¢ï¼redisèç¹ä¹é´éä¿¡æé®é¢ï¼è¿æ¯ä½¿ç¨çèªå®ä¹ç½æ®µåéçå°å\n\n# åå»ºç½å¡\ndocker network create redis --subnet 172.38.0.0/16\n\n# éè¿èæ¬åå»ºå­ä¸ªrediséç½®\nfor port in $(seq 1 6); \\\ndo \\\nmkdir -p /home/software/redis/node-${port}/conf\ntouch /home/software/redis/node-${port}/conf/redis.conf\ncat << EOF >/home/software/redis/node-${port}/conf/redis.conf\nport 6379\nbind 0.0.0.0\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 5000\ncluster-announce-ip 172.38.0.1${port}\ncluster-announce-port 6379\ncluster-announce-bus-port 16379\nappendonly yes\nEOF\ndone\n# åå»ºç»ç¹1\ndocker run -p 6371:6379 -p 16371:16379 --name redis-1 \\\n-v /home/software/redis/node-1/data:/data \\\n-v /home/software/redis/node-1/conf/redis.conf:/etc/redis/redis.conf \\\n-d --net redis --ip 172.38.0.11 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf\n\n#åå»ºç»ç¹2\ndocker run -p 6372:6379 -p 16372:16379 --name redis-2 \\\n-v /home/software/redis/node-2/data:/data \\\n-v /home/software/redis/node-2/conf/redis.conf:/etc/redis/redis.conf \\\n-d --net redis --ip 172.38.0.12 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf\n#åå»ºç»ç¹3\ndocker run -p 6373:6379 -p 16373:16379 --name redis-3 \\\n-v /home/software/redis/node-3/data:/data \\\n-v /home/software/redis/node-3/conf/redis.conf:/etc/redis/redis.conf \\\n-d --net redis --ip 172.38.0.13 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf\n#åå»ºç»ç¹4\ndocker run -p 6374:6379 -p 16374:16379 --name redis-4 \\\n-v /home/software/redis/node-4/data:/data \\\n-v /home/software/redis/node-4/conf/redis.conf:/etc/redis/redis.conf \\\n-d --net redis --ip 172.38.0.14 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf\n#åå»ºç»ç¹5\ndocker run -p 6375:6379 -p 16375:16379 --name redis-5 \\\n-v /home/software/redis/node-5/data:/data \\\n-v /home/software/redis/node-5/conf/redis.conf:/etc/redis/redis.conf \\\n-d --net redis --ip 172.38.0.15 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf\n#åå»ºç»ç¹6\ndocker run -p 6376:6379 -p 16376:16379 --name redis-6 \\\n-v /home/software/redis/node-6/data:/data \\\n-v /home/software/redis/node-6/conf/redis.conf:/etc/redis/redis.conf \\\n-d --net redis --ip 172.38.0.16 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf\n\n# åå»ºéç¾¤\n[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it redis-1 /bin/sh\n/data # ls\nappendonly.aof  nodes.conf\n/data # redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379 172.38.0.13:6379 172.38.0.14:6379 172.38.0.15:6379 172.38.0.16:6379 --cluster-replicas 1\n>>> Performing hash slots allocation on 6 nodes...\nMaster[0] -> Slots 0 - 5460\nMaster[1] -> Slots 5461 - 10922\nMaster[2] -> Slots 10923 - 16383\nAdding replica 172.38.0.15:6379 to 172.38.0.11:6379\nAdding replica 172.38.0.16:6379 to 172.38.0.12:6379\nAdding replica 172.38.0.14:6379 to 172.38.0.13:6379\nM: 541b7d237b641ac2ffc94d17c6ab96b18b26a638 172.38.0.11:6379\n   slots:[0-5460] (5461 slots) master\nM: a89c1f1245b264e4a402a3cf99766bcb6138dbca 172.38.0.12:6379\n   slots:[5461-10922] (5462 slots) master\nM: 259e804d6df74e67a72e4206d7db691a300c775e 172.38.0.13:6379\n   slots:[10923-16383] (5461 slots) master\nS: 9b19170eea3ea1b92c58ad18c0b5522633a9e271 172.38.0.14:6379\n   replicates 259e804d6df74e67a72e4206d7db691a300c775e\nS: 061a9d38f22910aaf0ba1dbd21bf1d8f57bcb7d5 172.38.0.15:6379\n   replicates 541b7d237b641ac2ffc94d17c6ab96b18b26a638\nS: 7a16b9bbb0615ec95fc978fa62fc054df60536f0 172.38.0.16:6379\n   replicates a89c1f1245b264e4a402a3cf99766bcb6138dbca\nCan I set the above configuration? (type \'yes\' to accept): yes\n>>> Nodes configuration updated\n>>> Assign a different config epoch to each node\n>>> Sending CLUSTER MEET messages to join the cluster\nWaiting for the cluster to join\n...\n>>> Performing Cluster Check (using node 172.38.0.11:6379)\nM: 541b7d237b641ac2ffc94d17c6ab96b18b26a638 172.38.0.11:6379\n   slots:[0-5460] (5461 slots) master\n   1 additional replica(s)\nM: a89c1f1245b264e4a402a3cf99766bcb6138dbca 172.38.0.12:6379\n   slots:[5461-10922] (5462 slots) master\n   1 additional replica(s)\nS: 7a16b9bbb0615ec95fc978fa62fc054df60536f0 172.38.0.16:6379\n   slots: (0 slots) slave\n   replicates a89c1f1245b264e4a402a3cf99766bcb6138dbca\nS: 061a9d38f22910aaf0ba1dbd21bf1d8f57bcb7d5 172.38.0.15:6379\n   slots: (0 slots) slave\n   replicates 541b7d237b641ac2ffc94d17c6ab96b18b26a638\nM: 259e804d6df74e67a72e4206d7db691a300c775e 172.38.0.13:6379\n   slots:[10923-16383] (5461 slots) master\n   1 additional replica(s)\nS: 9b19170eea3ea1b92c58ad18c0b5522633a9e271 172.38.0.14:6379\n   slots: (0 slots) slave\n   replicates 259e804d6df74e67a72e4206d7db691a300c775e\n[OK] All nodes agree about slots configuration.\n>>> Check for open slots...\n>>> Check slots coverage...\n[OK] All 16384 slots covered.\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n99\n100\n101\n102\n103\n104\n105\n\n\n\n# å®æäºï¼hostç½ç» + docker-composeï¼\n\ndockeræ­å»ºrediséç¾¤å®æï¼\n\n\n\n\n# SpringBootå¾®æå¡æåDockeréå\n\n * æååºç¨\n * ç¼åDockerfile\n\nFROM java:8\n\nCOPY *.jar /app.jar\n\nCMD ["--server.port=8080"]\n\nEXPOSE 8080\n\nENTRYPOINT ["java", "-jar", "/app.jar"]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n * æå»ºéå\n\n# ä¸ä¼ jarååDockerfileå°Linux\n[root@iZ2zeg4ytp0whqtmxbsqiiZ idea]# ll\ntotal 16140\n-rw-r--r-- 1 root root 16519871 Aug 14 17:38 demo-0.0.1-SNAPSHOT.jar\n-rw-r--r-- 1 root root      122 Aug 14 17:38 Dockerfile\n\n# æå»ºéå\n[root@iZ2zeg4ytp0whqtmxbsqiiZ idea]# docker build -t myapp:V1 .\nSending build context to Docker daemon  16.52MB\nStep 1/5 : FROM java:8\n8: Pulling from library/java\n5040bd298390: Pull complete \nfce5728aad85: Pull complete \n76610ec20bf5: Pull complete \n60170fec2151: Pull complete \ne98f73de8f0d: Pull complete \n11f7af24ed9c: Pull complete \n49e2d6393f32: Pull complete \nbb9cdec9c7f3: Pull complete \nDigest: sha256:c1ff613e8ba25833d2e1940da0940c3824f03f802c449f3d1815a66b7f8c0e9d\nStatus: Downloaded newer image for java:8\n ---\x3e d23bdf5b1b1b\nStep 2/5 : COPY *.jar /app.jar\n ---\x3e d4de8837ebf9\nStep 3/5 : CMD ["--server.port=8080"]\n ---\x3e Running in e3abc66303f0\nRemoving intermediate container e3abc66303f0\n ---\x3e 131bb3917fea\nStep 4/5 : EXPOSE 8080\n ---\x3e Running in fa2f25977db7\nRemoving intermediate container fa2f25977db7\n ---\x3e d98147377951\nStep 5/5 : ENTRYPOINT ["java", "-jar", "/app.jar"]\n ---\x3e Running in e1885e23773b\nRemoving intermediate container e1885e23773b\n ---\x3e afb6b5f28a32\nSuccessfully built afb6b5f28a32\nSuccessfully tagged xiaofan666:latest\n\n# æ¥çéå\n[root@iZ2zeg4ytp0whqtmxbsqiiZ idea]# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nmyapp               v1                  afb6b5f28a32        14 seconds ago      660MB\ntomcat              latest              2ae23eb477aa        8 days ago          647MB\nredis               5.0.9-alpine3.11    3661c84ee9d0        3 months ago        29.8MB\njava                8                   d23bdf5b1b1b        3 years ago         643MB\n\n# è¿è¡å®¹å¨\n[root@iZ2zeg4ytp0whqtmxbsqiiZ idea]# docker run -d -P --name my-springboot-web myapp:v1\nfd9a353a80bfd61f6930c16cd92204532bfd734e003f3f9983b5128a27b0375e\n# æ¥çè¿è¡èµ·æ¥çå®¹å¨ç«¯å£ï¼å ä¸ºæä»¬å¯å¨çæ¶åæ²¡ææå®ï¼\n[root@iZ2zeg4ytp0whqtmxbsqiiZ idea]# docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                     NAMES\nfd9a353a80bf        xiaofan666          "java -jar /app.jar â¦"   9 seconds ago       Up 8 seconds        0.0.0.0:32779->8080/tcp   xiaofan-springboot-web\n# æ¬å°è®¿é®1\n[root@iZ2zeg4ytp0whqtmxbsqiiZ idea]# curl localhost:32779/hello\nhello, world\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n\n\n\n# Docker Compose\n\n\n# å®è£\n\nä¸è½½docker-composeå½ä»¤\n\n# å®ç½æä¾ ï¼æ²¡æä¸è½½æåï¼\ncurl -L "https://github.com/docker/compose/releases/download/1.26.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose\n# å½åå°å\ncurl -L https://get.daocloud.io/docker/compose/releases/download/1.25.5/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose\n\n\n1\n2\n3\n4\n\n\nåéå¯æ§è¡æé\n\nchmod +x /usr/local/bin/docker-compose\n\n\n1\n\n\n\n\n\n# yamlè§å\n\nhttps://docs.docker.com/compose/compose-file/#compose-file-structure-and-examples\n\n\n# å®æï¼èªå·±ç¼åå¾®æå¡ä¸çº¿\n\n * ç¼åé¡¹ç®å¾®æå¡\n * Dockerfileæå»ºéå\n\nFROM java:8\n\nCOPY *.jar /app.jar\n\nCMD ["--server.port=8080"]\n\nEXPOSE 8080\n\nENTRYPOINT ["java", "-jar", "/app.jar"]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n * docker-compose.ymlç¼æé¡¹ç®\n\nversion \'3.8\'\nservices:\n  myapp:\n    build: .\n    image: myapp:v1\n    depends_on:\n      - redis\n    ports:\n      - "8080:8080"\n\n  redis:\n    image: "library/redis:alpine"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n * ä¸¢å°æå¡å¨è¿è¡ docker-compose up\n\ndocker-compose down\t\t\t# å³é­å®¹å¨\ndocker-compose up --build \t# éæ°æå»º\n\n\n1\n2\n\n\n\n\n',normalizedContent:'# dockeré¨ç½²è½¯ä»¶å®æ\n\n\n# dockerå®è£nginx\n\n# 1. æç´¢éå docker search, å»ºè®®å»docker hubæç´¢ï¼å¯ä»¥çå°å¸®å©ææ¡£\n# 2. ä¸è½½éå docker pull\n# 3. è¿è¡æµè¯\n[root@iz2zeg4ytp0whqtmxbsqiiz home]# docker images\nrepository          tag                 image id            created             size\ncentos              latest              0d120b6ccaa8        32 hours ago        215mb\nnginx               latest              08393e824c32        7 days ago          132mb\n\n# -d åå°è¿è¡\n# -name ç»å®¹å¨å½å\n# -p å®¿ä¸»æºç«¯å£ï¼å®¹å¨åé¨ç«¯å£\n[root@iz2zeg4ytp0whqtmxbsqiiz home]# docker run -d --name nginx01 -p 3344:80 nginx\t# åå°æ¹å¼å¯å¨å¯å¨éå\nfe9dc33a83294b1b240b1ebb0db9cb16bda880737db2c8a5c0a512fc819850e0\n[root@iz2zeg4ytp0whqtmxbsqiiz home]# docker ps\ncontainer id        image               command                  created             status              ports                  names\nfe9dc33a8329        nginx               "/docker-entrypoint.â¦"   4 seconds ago       up 4 seconds        0.0.0.0:3344->80/tcp   nginx01\n[root@iz2zeg4ytp0whqtmxbsqiiz home]# curl localhost:3344\t# æ¬å°è®¿é®æµè¯\n# è¿å¥å®¹å¨\n[root@iz2zeg4ytp0whqtmxbsqiiz home]# docker exec -it nginx01 /bin/bash\nroot@fe9dc33a8329:/# whereis nginx\nnginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx\nroot@fe9dc33a8329:/# cd /etc/nginx/\nroot@fe9dc33a8329:/etc/nginx# ls\nconf.d\t\tkoi-utf  mime.types  nginx.conf   uwsgi_params\nfastcgi_params\tkoi-win  modules     scgi_params  win-utf\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nç«¯å£æ´é²åçå¾\n\n\n\n\n# dockerå®è£tomcat\n\n# å®æ¹çä½¿ç¨\n# docker run -it --rm ä¸è¬ç¨æ¥æµè¯ï¼ç¨å®å°±å \ndocker run -it --rm tomcat:9.0\n\n# ä¸è½½åå¯å¨\ndocker pull tomcat\n# å¯å¨è¿è¡\ndocker run -d -p 3344:8080 --name tomcat01 tomcat\n# è¿å¥å®¹å¨\ndocker exec -it tomcat01 /bin/bash\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# dockeré¨ç½²es + kibanaÂ·\n\n# es æ´é²çç«¯å£å¾å¤\n# es ååçèåå­\n# es çæ°æ®ä¸è¬éè¦æ¾ç½®å°å®å¨ç®å½ï¼ æè½½\n# --net somenetwork\tç½ç»éç½®\n\n# å¯å¨elasticsearchï¼ docker run -d --name elasticsearch --net somenetwork -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" elasticsearch:7.6.2\n\n[root@iz2zeg4ytp0whqtmxbsqiiz home]# docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" elasticsearch:7.6.2\na920894a940b354d3c867079efada13d96cf9138712c76c8dea58fabd9c7e96f\n\n# å¯å¨äºlinuxå°±å¡ä¸»äºï¼docker stats æ¥çcpuç¶æ\n\n# æµè¯ä¸ä¸esæåäº\n[root@iz2zeg4ytp0whqtmxbsqiiz home]# curl localhost:9200\n{\n  "name" : "a920894a940b",\n  "cluster_name" : "docker-cluster",\n  "cluster_uuid" : "bxe1tjmethkgwmk7aa3fhq",\n  "version" : {\n    "number" : "7.6.2",\n    "build_flavor" : "default",\n    "build_type" : "docker",\n    "build_hash" : "ef48eb35cf30adf4db14086e8aabd07ef6fb113f",\n    "build_date" : "2020-03-26t06:34:37.794943z",\n    "build_snapshot" : false,\n    "lucene_version" : "8.4.0",\n    "minimum_wire_compatibility_version" : "6.8.0",\n    "minimum_index_compatibility_version" : "6.0.0-beta1"\n  },\n  "tagline" : "you know, for search"\n}\n\n\n# å¢å åå­éå¶ï¼ä¿®æ¹éç½®æä»¶ -e ç¯å¢éç½®ä¿®æ¹\ndocker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" -e es_java_opts="-xms64m -xmx512m" elasticsearch:7.6.2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n\n\n\n# å¯è§å\n\n * portainer\n\ndocker run -d -p 8088:9000 --restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer\n# æµè¯\n[root@iz2zeg4ytp0whqtmxbsqiiz home]# curl localhost:8088\n<!doctype html><html lang="en" ng-app="portainer">\n# å¤ç½è®¿é® http://ip:8088\n\n\n1\n2\n3\n4\n5\n\n\n\n\n * rancher(ci/cdåç¨)\n\n\n# å®¹å¨æ°æ®å·\n\n\n# dockerççè§£åé¡¾\n\næ°æ®ï¼å¦ææ°æ®é½å¨å®¹å¨ä¸­ï¼é£ä¹æä»¬å®¹å¨å é¤ï¼æ°æ®å°±ä¼ä¸¢å¤±ï¼éæ±ï¼æ°æ®å¯ä»¥æä¹å\n\nmysqlï¼å®¹å¨å äºï¼å åºè·è·¯ï¼éæ±ï¼mysqlæ°æ®å¯ä»¥å­å¨å¨æ¬å°ï¼\n\nå®¹å¨ä¹é´å¯ä»¥æä¸ä¸ªæ°æ®å±äº«ææ¯ï¼dockerå®¹å¨ä¸­äº§ççæ°æ®ï¼åæ­¥å°æ¬å°ï¼\n\nè¿å°±æ¯å·ææ¯ï¼ç®å½çæè½½ï¼å°æä»¬å®¹å¨åçç®å½æè½½å°linuxç®å½ä¸é¢ï¼\n\næ»ç»ï¼ å®¹å¨çæä¹åååæ­¥æä½ï¼å®¹å¨é´æ°æ®ä¹æ¯å¯ä»¥å±äº«çï¼\n\n\n# ä½¿ç¨æ°æ®å·\n\nç´æ¥ä½¿ç¨å½ä»¤æ¥æè½½ -v\n\n# å¿åæè½½åå·åæè½½çç®å½é½é»è®¤å¨/var/lib/docker/volumnç®å½ä¸\n1. docker run -it -v å®¹å¨ç®å½   # å¿åæè½½\n2. docker run -it -v å·å:å®¹å¨ç®å½  # å¿åæè½½\n3. docker run -it -v ä¸»æºç®å½:å®¹å¨ç®å½ # æå®è·¯å¾æè½½\n\n[root@iz2zeg4ytp0whqtmxbsqiiz home]# docker run -it -v /home/ceshi:/home centos /bin/bash\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n\næµè¯æä»¶çåæ­¥ï¼å¨ä¸»æºä¸æ¹å¨ï¼è§å¯å®¹å¨ååï¼\n\n\n\næ³¨æï¼è®¾ç½®å®¹å¨æ°æ®å·æè½½åï¼å®¹å¨ç®å½åæè½½çä¸»æºç®å½ä¿æå®æ¶åæ­¥ï¼\n\n\n# å®æï¼å®è£mysql\n\næèï¼mysqlçæ°æ®æä¹åçé®é¢ï¼\n\n# è·åéå\n[root@iz2zeg4ytp0whqtmxbsqiiz home]# docker pull mysql:5.7\n\n# è¿è¡å®¹å¨ï¼ éè¦åæ°æ®æè½½ï¼ \n# å®è£å¯å¨mysqlï¼éè¦éç½®å¯ç ï¼æ³¨æï¼\n# å®æ¹æµè¯ï¼ docker run --name some-mysql -e mysql_root_password=my-secret-pw -d mysql:tag\n\n# å¯å¨æä»¬ç\n-d\t\t# åå°è¿è¡\n-p\t\t# ç«¯å£æ å°\n-v\t\t# å·æè½½\n-e\t\t# ç¯å¢éç½®\n--name\t# å®¹å¨çåå­\n[root@iz2zeg4ytp0whqtmxbsqiiz home]# docker run -d -p 3344:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e mysql_root_password=123456 --name mysql01 mysql:5.7\n9552bf4eb2b69a2ccd344b5ba5965da4d97b19f2e1a78626ac1f2f8d276fc2ba\n\n# å¯å¨æåä¹åï¼æä»¬å¨æ¬å°ä½¿ç¨navicaté¾æ¥æµè¯ä¸ä¸\n# navicaté¾æ¥å°æå¡å¨ç3344 --- 3344 å å®¹å¨ç3306æ å°ï¼è¿ä¸ªæ¶åæä»¬å°±å¯ä»¥è¿æ¥ä¸mysqlå½ï¼\n\n# å¨æ¬å°æµè¯åå»ºä¸ä¸ªæ°æ®åºï¼æ¥çä¸æä»¬çè·¯å¾æ¯å¦okï¼\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n\n\n\n# å¿ååå·åæè½½ï¼å®¹å¨å·ï¼\n\n# å¿åæè½½\n-v å®¹å¨åè·¯å¾\ndocker run -d -p --name nginx01 -v /etc/nginx nginx\t\t# -p éæºæå®ç«¯å£\n\n# æ¥çæævolumeçæåµ\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker volume ls\ndriver              volume name\nlocal               561b81a03506f31d45ada3f9fb7bd8d7c9b5e0f826c877221a17e45d4c80e096\nlocal               36083fb6ca083005094cbd49572a0bffeec6daadfbc5ce772909bb00be760882\n\n# è¿éåç°ï¼è¿ç§æåµå°±æ¯å¿åæè½½ï¼æä»¬å¨-v åé¢åªåäºå®¹å¨åçè·¯å¾ï¼æ²¡æåå®¹å¨å¤çè·¯å¾ï¼\n\n# å·åæè½½\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker run -d -p --name nginx02 -v juming-nginx:/etc/nginx nginx\n26da1ec7d4994c76e80134d24d82403a254a4e1d84ec65d5f286000105c3da17\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker ps\ncontainer id        image               command                  created             status              ports                   names\n26da1ec7d499        nginx               "/docker-entrypoint.â¦"   3 seconds ago       up 2 seconds        0.0.0.0:32769->80/tcp   nginx02\n486de1da03cb        nginx               "/docker-entrypoint.â¦"   3 minutes ago       up 3 minutes        0.0.0.0:32768->80/tcp   nginx01\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker volume ls\ndriver              volume name\nlocal               561b81a03506f31d45ada3f9fb7bd8d7c9b5e0f826c877221a17e45d4c80e096\nlocal               36083fb6ca083005094cbd49572a0bffeec6daadfbc5ce772909bb00be760882\nlocal               juming-nginx\n\n# éè¿ -v å·å:å®¹å¨åçè·¯å¾\n# æ¥çä¸ä¸è¿ä¸ªå·\n# docker volume inspect juming-nginx\n\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker volume inspect juming-nginx\n[\n  {\n      "createdat": "2020-08-12t18:15:21+08:00",\n      "driver": "local",\n      "labels": null,\n      "mountpoint": "/var/lib/docker/volumes/juming-nginx/_data",\n      "name": "juming-nginx",\n      "options": null,\n      "scope": "local"\n  }\n]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n\n\næå±\n\n# éè¿ -v å®¹å¨åè·¯å¾[:ro|:rw] æ¹åè¯»åæé \n# ro readonly åªè¯»\t\n# rw readwrite å¯è¯»å¯å\ndocker run -d -p --name nginx02 -v juming-nginx:/etc/nginx:ro nginx\ndocker run -d -p --name nginx02 -v juming-nginx:/etc/nginx:rw nginx\n# ro åªè¦çå°roå°±è¯´æè¿ä¸ªè·¯å¾åªè½éè¿å®¿ä¸»æºæ¥æä½ï¼å®¹å¨åå®¹æ æ³æä½\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# åå§dockerfile\n\n# åå»ºä¸ä¸ªdockerfileæä»¶ï¼ åå­å¯ä»¥éæº\n# æä»¶çåå®¹ æå®ï¼å¤§åï¼åæ°\n\nfrom centos\n\n# å¿åæè½½\nvolume ["volume01", "volume02"]\n\ncmd echo "----end----"\ncmd /bin/bash\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n\nå¯å¨èªå·±çå®¹å¨\n\n\n\ndocker inspect å®¹å¨id\n\n\n\nåè®¾æå»ºéåæ¶åæ²¡ææè½½å·ï¼è¦æå¨éåæè½½ -v å·å:å®¹å¨åè·¯å¾ï¼\n\n\n# æ°æ®å·å®¹å¨\n\nå¤ä¸ªmysqlåæ­¥æ°æ®ï¼\n\n\n\n# å¯å¨3ä¸ªå®¹å¨ï¼éè¿æä»¬åæèªå·±åçéåå¯å¨\n\n\n1\n\n\n\n\n\n\nå¤ä¸ªmysqlå®ç°æ°æ®å±äº«\n\n[root@iz2zeg4ytp0whqtmxbsqiiz home]# docker run -d -p 3344:3306 -v /etc/mysql/conf.d -v /var/lib/mysql -e mysql_root_password=123456 --name mysql01 mysql:5.7\n[root@iz2zeg4ytp0whqtmxbsqiiz home]# docker run -d -p 3344:3306 -v /etc/mysql/conf.d -v /var/lib/mysql -e mysql_root_password=123456 --name mysql02 --volumes-from mysql01 mysql:5.7\n[root@iz2zeg4ytp0whqtmxbsqiiz home]# docker run -d -p 3344:3306 -v /etc/mysql/conf.d -v /var/lib/mysql -e mysql_root_password=123456 --name mysql03 --volumes-from mysql01 mysql:5.7\n\n\n1\n2\n3\n\n\n\n\ndocker inspect centos01\n[{\n\t"type": "volume",\n\t"name": "7895bf2c2184d440f4be4c539313055ce35f70606728aad7bb73dd46cf4dcfca",\n\t"source": "/var/lib/docker/volumes/7895bf2c2184d440f4be4c539313055ce35f70606728aad7bb73dd46cf4dcfca/_data",\n\t"destination": "volume02",\n\t"driver": "local",\n\t"mode": "",\n\t"rw": true,\n\t"propagation": ""\n}, {\n\t"type": "volume",\n\t"name": "27e5f3ac52359984ddb695cb2bd1c375fb218e8ff6257044294e78bb63af36f4",\n\t"source": "/var/lib/docker/volumes/27e5f3ac52359984ddb695cb2bd1c375fb218e8ff6257044294e78bb63af36f4/_data",\n\t"destination": "volume01",\n\t"driver": "local",\n\t"mode": "",\n\t"rw": true,\n\t"propagation": ""\n}]\n\ndocker inspect centos02 \n"mounts": [{\n\t"type": "volume",\n\t"name": "27e5f3ac52359984ddb695cb2bd1c375fb218e8ff6257044294e78bb63af36f4",\n\t"source": "/var/lib/docker/volumes/27e5f3ac52359984ddb695cb2bd1c375fb218e8ff6257044294e78bb63af36f4/_data",\n\t"destination": "volume01",\n\t"driver": "local",\n\t"mode": "",\n\t"rw": true,\n\t"propagation": ""\n}, {\n\t"type": "volume",\n\t"name": "7895bf2c2184d440f4be4c539313055ce35f70606728aad7bb73dd46cf4dcfca",\n\t"source": "/var/lib/docker/volumes/7895bf2c2184d440f4be4c539313055ce35f70606728aad7bb73dd46cf4dcfca/_data",\n\t"destination": "volume02",\n\t"driver": "local",\n\t"mode": "",\n\t"rw": true,\n\t"propagation": ""\n}]\n\ndocker inspect centos03 \n"mounts": [{\n\t"type": "volume",\n\t"name": "7895bf2c2184d440f4be4c539313055ce35f70606728aad7bb73dd46cf4dcfca",\n\t"source": "/var/lib/docker/volumes/7895bf2c2184d440f4be4c539313055ce35f70606728aad7bb73dd46cf4dcfca/_data",\n\t"destination": "volume02",\n\t"driver": "local",\n\t"mode": "",\n\t"rw": true,\n\t"propagation": ""\n}, {\n\t"type": "volume",\n\t"name": "27e5f3ac52359984ddb695cb2bd1c375fb218e8ff6257044294e78bb63af36f4",\n\t"source": "/var/lib/docker/volumes/27e5f3ac52359984ddb695cb2bd1c375fb218e8ff6257044294e78bb63af36f4/_data",\n\t"destination": "volume01",\n\t"driver": "local",\n\t"mode": "",\n\t"rw": true,\n\t"propagation": ""\n}]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n\n\néè¿æ¥çcentos01ã02ã03çæ°æ®å·æè½½æåµï¼å¯ä»¥åç°ï¼æ°æ®å·å®¹å¨çå®ç°åçå¶å®å°±æ¯æå¶ä»ç»§æ¿æ°æ®å·å®¹å¨çæ°æ®å·æ å°å°ç¸åçå¤é¨æè½½ç¹ï¼è¿æ ·è¿ä¸ªå¤é¨æè½½ç¹æç®å½æä»¶åæ´ï¼å°±ä¼åæ­¥å°æ°æ®å·å®¹å¨ä»¥åå¶ä»ç»§æ¿å³ç³»çå®¹å¨ä¸­\n\n\n# dockerfile\n\n\n# dockerfileçæå»ºè¿ç¨\n\nåºç¡ç¥è¯ï¼\n\n 1. æ¯ä¸ªä¿çå³é®å­ï¼æä»¤ï¼é½æ¯å¿é¡»å¤§åå­æ¯\n\n 2. æ§è¡ä»ä¸å°ä¸é¡ºåºæ§è¡\n\n 3. # è¡¨ç¤ºæ³¨é\n\n 4. æ¯ä¸ªæä»¤é½ä¼åå»ºæäº¤ä¸ä¸ªæ°çéåå±ï¼å¹¶æäº¤ï¼\n\n\n\ndockerfileæ¯é¢åå¼åçï¼ æä»¬ä»¥åè¦åå¸é¡¹ç®ï¼ åéåï¼ å°±éè¦ç¼ådockefileæä»¶ï¼ è¿ä¸ªæä»¶ååç®åï¼\n\n\n# dockerfileæä»¤è¯´æ\n\n\n\n\n# åå»ºä¸ä¸ªèªå·±çcentos\n\n# 1. ç¼ådockerfileçæä»¶\n[root@localhost dockfile]# cat mydockerfile-centos \nfrom centos\nmaintainer xiaofan<594042358@qq.com>\n\nenv mypath /usr/local\nworkdir $mypath\t\t# éåçå·¥ä½ç®å½\n\nrun yum -y install vim \\\n\t&& yum -y install net-tools\n\nexpose 80\n\ncmd echo $mypath\ncmd echo "---end---"\ncmd /bin/bash\n\n# 2. éè¿è¿ä¸ªæä»¶æå»ºéå\n# å½ä»¤ docker build -f <dockerfileæä»¶è·¯å¾> -t éåå:[tag] <æå»ºä¸ä¸æè·¯å¾>\n\n[root@localhost dockfile]# docker build -f mydockerfile-centos -t mycentos:0.1 .\n\nsuccessfully built d2d9f0ea8cb2\nsuccessfully tagged mycentos:0.1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n\n\næä»¬å¯ä»¥ååºæ¬å°è¿è¡çåæ´åå²\n\n\n\n\n# cmd åentrypointåºå«\n\ncmd\n\n * æå®è¿ä¸ªå®¹å¨å¯å¨çæ¶åè¦è¿è¡çå½ä»¤\n * å½åæ¶å­å¨entrypointæ¶ï¼ä¼è¢«å½ä½entrypointå£°æcommandçåæ°ï¼å¯ååæ°ï¼\n * ä¼è¢«docker run åæå®çcommandè¦ç\n\nentrypoint\n\n * æå®è¿ä¸ªå®¹å¨å¯å¨çæ¶åè¦è¿è¡çå½ä»¤\n * å½åæ¶å­å¨cmdæ¶ï¼ä¼æcmdå£°æcommandå½ä½åæ°ï¼å¯ååæ°ï¼\n * ä¼è¢«docker run --entrypoint åæå®çcommandè¦ç\n\n# åªåå«cmd\n\n[root@localhost dockfile]# cat dockfile\nfrom centos\ncmd ["ls", "-a"]\n\n[root@localhost dockfile]# docker build -f dockerfile -t centos:v1 .\n\n# 3. runè¿è¡ï¼ åç°æä»¬çls -a å½ä»¤çæ\n[root@localhost dockfile]# docker run ebe6a52bb125\n.\n..\n.dockerenv\nbin\ndev\netc\nhome\nlib\nlib64\n\n# æ³è¿½å ä¸ä¸ªå½ä»¤ -l åæ ls -al\n[root@localhost dockfile]# docker run ebe6a52bb125 -l\ndocker: error response from daemon: oci runtime create failed: container_linux.go:349: starting container process caused "exec: \\"-l\\": executable file not found in $path": unknown.\n[root@localhost dockfile]# docker run ebe6a52bb125 ls -l\n\n# cmdçæåµä¸ -læ¿æ¢äºcmd["ls", "-a"]å½ä»¤ï¼ -lä¸æ¯å½ä»¤ï¼æä»¥æ¥éäº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n# åªåå«entrypoint\n\n[root@localhost dockfile]# cat dockerfile \nfrom centos\nentrypoint ["ls", "-a"]\n\n\n[root@localhost dockfile]# docker build -f dockerfile -t centos:v1 .\n\n# 3. runè¿è¡ åç°æä»¬çls -a å½ä»¤åæ ·çæ\n[root@localhost dockfile]# docker run centos:v1\n.\n..\n.dockerenv\nbin\ndev\netc\nhome\nlib\n\n# 4. æä»¬çè¿½å å½ä»¤ï¼ æ¯ç´æ¥æ¼æ¥å°entrypointå½ä»¤çåé¢çï¼\n[root@localhost dockfile]# docker run centos:v1 -l\ntotal 56\ndrwxr-xr-x  1 root root 4096 aug 13 07:52 .\ndrwxr-xr-x  1 root root 4096 aug 13 07:52 ..\n-rwxr-xr-x  1 root root    0 aug 13 07:52 .dockerenv\nlrwxrwxrwx  1 root root    7 may 11  2019 bin -> usr/bin\ndrwxr-xr-x  5 root root  340 aug 13 07:52 dev\ndrwxr-xr-x  1 root root 4096 aug 13 07:52 etc\ndrwxr-xr-x  2 root root 4096 may 11  2019 home\nlrwxrwxrwx  1 root root    7 may 11  2019 lib -> usr/lib\nlrwxrwxrwx  1 root root    9 may 11  2019 lib64 -> usr/lib64\ndrwx------  2 root root 4096 aug  9 21:40 lost+found\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n\n\n# åæ¶åå«cmdåentrypoint\n\n[root@localhost dockfile]# cat dockerfile \nfrom centos:latest\nmaintainer zhaoxing<779292642@qq.com>\n\nenv mypath /usr/local\nworkdir $mypath\n\ncmd ["-a"]\nentrypoint ["ls"]\n\n[root@localhost dockfile]# docker build -f dockerfile -t centos:v1 .\n\n# æ§è¡å½ä»¤ï¼ls -a\n# cmdå£°æçcommandä¼å½ä½entrypointå£°æçcommandçåæ°\n[root@localhost dockfile]# docker run centos:v1\n.\n..\nbin\netc\ngames\ninclude\nlib\nlib64\nlibexec\nsbin\nshare\nsrc\n\n# è¦çcmdå£°æçcommand\n[root@localhost dockfile]# docker run centos:v1 -l\ntotal 0\ndrwxr-xr-x. 2 root root  6 nov  3  2020 bin\ndrwxr-xr-x. 2 root root  6 nov  3  2020 etc\ndrwxr-xr-x. 2 root root  6 nov  3  2020 games\ndrwxr-xr-x. 2 root root  6 nov  3  2020 include\ndrwxr-xr-x. 2 root root  6 nov  3  2020 lib\ndrwxr-xr-x. 3 root root 16 sep 15 14:17 lib64\ndrwxr-xr-x. 2 root root  6 nov  3  2020 libexec\ndrwxr-xr-x. 2 root root  6 nov  3  2020 sbin\ndrwxr-xr-x. 5 root root 46 sep 15 14:17 share\ndrwxr-xr-x. 2 root root  6 nov  3  2020 src\n[root@localhost dockfile]# docker run centos:v1 -al\ntotal 8\ndrwxr-xr-x. 12 root root 4096 sep 15 14:17 .\ndrwxr-xr-x. 12 root root 4096 sep 15 14:17 ..\ndrwxr-xr-x.  2 root root    6 nov  3  2020 bin\ndrwxr-xr-x.  2 root root    6 nov  3  2020 etc\ndrwxr-xr-x.  2 root root    6 nov  3  2020 games\ndrwxr-xr-x.  2 root root    6 nov  3  2020 include\ndrwxr-xr-x.  2 root root    6 nov  3  2020 lib\ndrwxr-xr-x.  3 root root   16 sep 15 14:17 lib64\ndrwxr-xr-x.  2 root root    6 nov  3  2020 libexec\ndrwxr-xr-x.  2 root root    6 nov  3  2020 sbin\ndrwxr-xr-x.  5 root root   46 sep 15 14:17 share\ndrwxr-xr-x.  2 root root    6 nov  3  2020 src\n\n\n# è¦çentrypointå£°æçcommandï¼æ­¤æ¶cmdå£°æçcommandå¤±æï¼\n[root@localhost dockfile]# docker run --entrypoint ls 3a\nbin\netc\ngames\ninclude\nlib\nlib64\nlibexec\nsbin\nshare\nsrc\n\n# åæ¶è¦çentrypointåcmdå£°æçcommand\n[root@localhost dockfile]# docker run --entrypoint ls 3a -a\n.\n..\nbin\netc\ngames\ninclude\nlib\nlib64\nlibexec\nsbin\nshare\nsrc\n[root@localhost dockfile]# docker run --entrypoint ls 3a -al\ntotal 8\ndrwxr-xr-x. 12 root root 4096 sep 15 14:17 .\ndrwxr-xr-x. 12 root root 4096 sep 15 14:17 ..\ndrwxr-xr-x.  2 root root    6 nov  3  2020 bin\ndrwxr-xr-x.  2 root root    6 nov  3  2020 etc\ndrwxr-xr-x.  2 root root    6 nov  3  2020 games\ndrwxr-xr-x.  2 root root    6 nov  3  2020 include\ndrwxr-xr-x.  2 root root    6 nov  3  2020 lib\ndrwxr-xr-x.  3 root root   16 sep 15 14:17 lib64\ndrwxr-xr-x.  2 root root    6 nov  3  2020 libexec\ndrwxr-xr-x.  2 root root    6 nov  3  2020 sbin\ndrwxr-xr-x.  5 root root   46 sep 15 14:17 share\ndrwxr-xr-x.  2 root root    6 nov  3  2020 src\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n\n\n\n# dockerfileå¶ä½tomcatéå\n\n\n# å¶ä½tomcatéå\n\n 1. åå¤éåæä»¶ tomcatåç¼©åï¼jdkçåç¼©åï¼\n\n\n\n 2. ç¼ådockerfileæä»¶, buildé»è®¤å¨æå»ºä¸ä¸æå¯»æ¾åç§°ä¸ºdockfileçæä»¶ï¼å°±ä¸éè¦-f æå®äºï¼\n\n[root@iz2zeg4ytp0whqtmxbsqiiz tomcat]# cat dockerfile \nfrom centos\nmaintainer xiaofan<594042358@qq.com>\ncopy readme.txt /usr/local/readme.txt\n# add ä¼èªå¨è§£å\nadd jdk-8u73-linux-x64.tar.gz /usr/local/\nadd apache-tomcat-9.0.37.tar.gz /usr/local/\nrun yum -y install vim\nenv mypath /usr/local\nworkdir $mypath\nenv java_home /usr/local/jdk1.8.0_73\nenv classpath $java_home/lib/dt.jar:$java_home/lib/tools.jar\nenv catalina_home /usr/local/apache-tomcat-9.0.37\nenv catalina_bash /usr/local/apache-tomcat-9.0.37\nenv path $path:$java_home/bin:$catalina_home/lib:$catalina_home/bin\nexpose 8080\ncmd /usr/local/apache-tomcat-9.0.37/bin/startup.sh && tail -f /usr/local/apache-tomcat-9.0.37/bin/logs/catalina.out\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n 3. æå»ºéå\n\n# docker build -t diytomcat .\n\n\n1\n\n 4. å¯å¨éå\n\ndocker run -d -p 3344:8080 \\\n--name xiaofantomcat1 \\\n-v /home/xiaofan/build/tomcat/test:/usr/local/apache-tomcat-9.0.37/webapps/test \\\n-v /home/xiaofan/build/tomcat/tomcatlogs/:/usr/local/apache-tomcat-9.0.37/logs \ndiytomcat\n\n\n1\n2\n3\n4\n5\n\n 5. è®¿é®æµè¯\n\nå¨æ¬å°ç¼åweb.xmlåindex.jspè¿è¡æµè¯\n\n\n\n<?xml version="1.0" encoding="utf-8"?>\n<web-app version="2.4" \n    xmlns="http://java.sun.com/xml/ns/j2ee" \n    xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n    xsi:schemalocation="http://java.sun.com/xml/ns/j2ee \n        http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">\n        \n</web-app>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\n    pageencoding="utf-8"%>\n<!doctype html>\n<html>\n<head>\n<meta charset="utf-8">\n<title>hello. xiaofan</title>\n</head>\n<body>\nhello world!<br/>\n<%\nsystem.out.println("-----my test web logs------");\n%>\n</body>\n</html>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nåç°ï¼é¡¹ç®é¨ç½²æåï¼ å¯ä»¥ç´æ¥è®¿é®okï¼\n\n\n\n\n# åå¸èªå·±çéåå°docker hub\n\n 1. dockker hub æ³¨åèªå·±çè´¦å·ï¼\n 2. ç¡®å®è¿ä¸ªè´¦å·å¯ä»¥ç»å½\n\n\n\n 3. å¨æä»¬çæå¡å¨ä¸æäº¤èªå·±çéå\n\n# pushå°æä»¬çæå¡å¨ä¸\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker push diytomcat\nthe push refers to repository [docker.io/library/diytomcat]\n2eaca873a720: preparing \n1b38cc4085a8: preparing \n088ebb58d264: preparing \nc06785a2723d: preparing \n291f6e44771a: preparing \ndenied: requested access to the resource is denied\t# æç»\n\n# pushéåçé®é¢ï¼\nthe push refers to repository [docker.io/1314520007/diytomcat]\nan image does not exist locally with the tag: 1314520007/diytomcat\n\n# è§£å³ï¼å¢å ä¸ä¸ªtag\ndocker tag diytomcat 1314520007/tomcat:1.0\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n\n\n# åå¸å°é¿éäºéåæå¡ä¸\n\n 1. ç»å½é¿éäº\n\n 2. æ¾å°å®¹å¨éåæå¡\n\n 3. åå»ºå½åç©ºé´\n\n\n\n 4. åå»ºéåä»åº\n\n\n\n 5. ç¹å»ä»åºåç§°ï¼åèå®æ¹ææ¡£å³å¯\n\n\n\n\n# æ»ç»\n\n\n\n\n# dockerç½ç»\n\n\n# è¿æ¥ docker0\n\næµè¯\n\n\n\nä¸ä¸ªç½ç»\n\n# é®é¢ï¼ dockeræ¯å¦ä½å¤çå®¹å¨ç½ç»è®¿é®çï¼\n\n# [root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker run -d -p --name tomcat01 tomcat\n\n# æ¥çå®¹å¨åé¨çç½ç»å°å ip addr\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker exec -it tomcat01 ip addrï¼ åç°å®¹å¨å¯å¨çæ¶åå¾å°ä¸ä¸ªeth0@if115 ipå°åï¼dockeråéçï¼\n1: lo: <loopback,up,lower_up> mtu 65536 qdisc noqueue state unknown group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n114: eth0@if115: <broadcast,multicast,up,lower_up> mtu 1500 qdisc noqueue state up group default \n    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0\n    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n\n# æèï¼ linux è½ä¸è½pingéå®¹å¨ï¼\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# ping 172.17.0.2\nping 172.17.0.2 (172.17.0.2) 56(84) bytes of data.\n64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.077 ms\n64 bytes from 172.17.0.2: icmp_seq=2 ttl=64 time=0.069 ms\n64 bytes from 172.17.0.2: icmp_seq=3 ttl=64 time=0.075 ms\n\n# linux å¯ä»¥ ping édockerå®¹å¨åé¨ï¼\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nåç\n\n> æä»¬æ¯å¯å¨ä¸ä¸ªdockerå®¹å¨ï¼ dockerå°±ä¼ç»dockerå®¹å¨åéä¸ä¸ªipï¼ æä»¬åªè¦å®è£äºdockerï¼å°±ä¼æä¸ä¸ªç½å¡ docker0æ¡¥æ¥æ¨¡å¼ï¼ä½¿ç¨çææ¯æ¯veth-pairææ¯ï¼\n\nåæ¬¡æµè¯ ip addr\n\n\n\nåå¯å¨ä¸ä¸ªå®¹å¨æµè¯ï¼ åç°åå¤äºä¸å¯¹ç½å¡\n\n\n\n# æä»¬åç°è¿ä¸ªå®¹å¨å¸¦æ¥ç½å¡ï¼é½æ¯ä¸å¯¹å¯¹ç\n# veth-pair å°±æ¯ä¸å¯¹çèæè®¾å¤æ¥å£ï¼ä»ä»¬é½æ¯æå¯¹åºç°çï¼ä¸ç«¯è¿çåè®®ï¼ä¸ç«¯å½¼æ­¤ç¸è¿\n# æ­£å ä¸ºæè¿ä¸ªç¹æ§ï¼veth-pairåå½ä¸ä¸ªæ¡¥æ¢ï¼ è¿æ¥åç§èæç½ç»è®¾å¤\n# openstacï¼ dockerå®¹å¨ä¹é´çé¾æ¥ï¼ovsçé¾æ¥ï¼ é½æ¯ä½¿ç¨veth-pairææ¯\n\n\n1\n2\n3\n4\n\n\næä»¬æµè¯ä¸ä¸tomcat01åtomcat02ä¹é´æ¯å¦å¯ä»¥pingéï¼\n\nç»è®ºï¼å®¹å¨ä¸å®¹å¨ä¹é´æ¯å¯ä»¥ç¸äºpingéçï¼\n\nç»å¶ä¸ä¸ªç½ç»æ¨¡åå¾\n\n\n\nç»è®ºï¼tomcat01åtomcat02æ¯å±ç¨çä¸ä¸ªè·¯ç±å¨ï¼docker0\n\nææå®¹å¨ä¸æå®ç½ç»çæåµä¸ï¼é½æ¯docker0è·¯ç±çï¼dockerä¼ç»æä»¬çå®¹å¨åéä¸ä¸ªé»è®¤çå¯ç¨ip\n\nå°ç»\n\ndockerä½¿ç¨çæ¯linuxçæ¡¥æ¥ï¼å®¿ä¸»æºä¸­æ¯ä¸ä¸ªdockerå®¹å¨çç½æ¡¥docker0.\n\n\n\ndockerä¸­çææçç½ç»æ¥å£é½æ¯èæçï¼èæçè½¬åæçé«ï¼ï¼åç½ä¼ éæä»¶ï¼ï¼\n\nåªè¦å®¹å¨å é¤ï¼å¯¹åºçç½æ¡¥ä¸å¯¹å°±æ²¡æäºï¼\n\n\n\n\n# -- link\n\nè§£å³éè¿docker0èéæ¶éè¿å®¹å¨åè®¿é®\n\næèä¸ä¸ªåºæ¯ï¼æä»¬ç¼åäºä¸ä¸ªå¾®æå¡ï¼database url =ipï¼ é¡¹ç®ä¸éå¯ï¼æ°æ®ipæ¢æäºï¼æä»¬å¸æå¯ä»¥å¤çè¿ä¸ªé®é¢ï¼å¯ä»¥æåå­æ¥è¿è¡è®¿é®å®¹å¨\n\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker exec -it tomcat02 ping tomcat01\nping: tomcat01: name or service not known\n\n# å¦ä½å¯ä»¥è§£å³å¢ï¼\n# éè¿--linkå³å¯ä»¥è§£å³ç½ç»è¿éé®é¢\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker run -d -p  --name tomcat03 --link tomcat02 tomcat\n3a2bcaba804c5980d94d168457c436fbd139820be2ee77246888f1744e6bb473\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker ps\ncontainer id        image               command             created             status              ports                     names\n3a2bcaba804c        tomcat              "catalina.sh run"   4 seconds ago       up 3 seconds        0.0.0.0:32772->8080/tcp   tomcat03\nf22ed47ed1be        tomcat              "catalina.sh run"   57 minutes ago      up 57 minutes       0.0.0.0:32771->8080/tcp   tomcat02\n9d97f93401a0        tomcat              "catalina.sh run"   about an hour ago   up about an hour    0.0.0.0:32770->8080/tcp   tomcat01\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker exec -it tomcat03 ping tomcat02\nping tomcat02 (172.17.0.3) 56(84) bytes of data.\n64 bytes from tomcat02 (172.17.0.3): icmp_seq=1 ttl=64 time=0.129 ms\n64 bytes from tomcat02 (172.17.0.3): icmp_seq=2 ttl=64 time=0.100 ms\n64 bytes from tomcat02 (172.17.0.3): icmp_seq=3 ttl=64 time=0.110 ms\n64 bytes from tomcat02 (172.17.0.3): icmp_seq=4 ttl=64 time=0.107 ms\n\n# ååå¯ä»¥pingéåï¼\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker exec -it tomcat02 ping tomcat03\nping: tomcat03: name or service not known\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\næ¢ç©¶ï¼inspectï¼\n\n\n\nå¶å®è¿ä¸ªtomcat03å°±æ¯å¨æ¬å°éç½®äºtomcat02çéç½®ï¼\n\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker exec -it tomcat03 cat /etc/hosts\n127.0.0.1\tlocalhost\n::1\tlocalhost ip6-localhost ip6-loopback\nfe00::0\tip6-localnet\nff00::0\tip6-mcastprefix\nff02::1\tip6-allnodes\nff02::2\tip6-allrouters\n172.17.0.3\ttomcat02 f22ed47ed1be\n172.17.0.4\t3a2bcaba804c\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\næ¬è´¨æ¢ç©¶ï¼--link å°±æ¯æä»¬å¨hostséç½®ä¸­å¢å äºä¸ä¸ª172.17.0.3 tomcat02 f22ed47ed1be\n\næä»¬ç°å¨ç©dockerå·²ç»ä¸å»ºè®®ä½¿ç¨--linkäºï¼\n\nèªå®ä¹ç½ç»ï¼ä¸ä½¿ç¨docker0ï¼\n\ndocker0çé®é¢ï¼å®ä¸æ¯æå®¹å¨åé¾æ¥è®¿é®ï¼\n\n\n# èªå®ä¹ç½ç»\n\næ¥çææçdockerç½ç»\n\n\n\nç½ç»æ¨¡å¼\n\n * bridgeï¼ æ¡¥æ¥æ¨¡å¼ï¼æ¡¥æ¥ docker é»è®¤ï¼èªå·±åå»ºçä¹æ¯ç¨brdgeæ¨¡å¼\n\n * noneï¼ ä¸éç½®ç½ç»\n\n * hostï¼ åå®¿ä¸»æºå±äº«ç½ç»\n\n * containerï¼å®¹å¨ç½ç»è¿éï¼ï¼ç¨çå°ï¼ å±éå¾å¤§ï¼\n\næµè¯\n\n# æä»¬ç´æ¥å¯å¨çå½ä»¤é»è®¤æä¸ä¸ª --net bridgeï¼èè¿ä¸ªå°±æ¯æä»¬çdocker0\ndocker run -d -p --name tomcat01 tomcat\ndocker run -d -p --name tomcat01 --net bridge tomcat\n\n# docker0ç¹ç¹ï¼é»è®¤ï¼å®¹å¨åä¸è½è®¿é®ï¼ --linkå¯ä»¥æéè¿æ¥ï¼\n# æä»¬å¯ä»¥èªå®ä¹ä¸ä¸ªç½ç»ï¼\n# --driver bridge\n# --subnet 192.168.0.0/16 å¯ä»¥æ¯æ255*255ä¸ªç½ç» 192.168.0.2 ~ 192.168.255.254\n# --gateway 192.168.0.1\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet\n26a5afdf4805d7ee0a660b82244929a4226470d99a179355558dca35a2b983ec\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker network ls\nnetwork id          name                driver              scope\n30d601788862        bridge              bridge              local\n226019b14d91        host                host                local\n26a5afdf4805        mynet               bridge              local\n7496c014f74b        none                null                local\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\næä»¬èªå·±åå»ºçç½ç»å°±okäºï¼\n\n\n\nå¨èªå·±åå»ºçç½ç»éé¢å¯å¨ä¸¤ä¸ªå®¹å¨\n\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker run -d -p --name tomcat-net-01 --net mynet tomcat\n0e85ebe6279fd23379d39b27b5f47c1e18f23ba7838637802973bf6449e22f5c\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker run -d -p --name tomcat-net-02 --net mynet tomcat\nc6e462809ccdcebb51a4078b1ac8fdec33f1112e9e416406b606d0c9fb6f21b5\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker network inspect mynet\n[\n    {\n        "name": "mynet",\n        "id": "26a5afdf4805d7ee0a660b82244929a4226470d99a179355558dca35a2b983ec",\n        "created": "2020-08-14t11:12:40.553433163+08:00",\n        "scope": "local",\n        "driver": "bridge",\n        "enableipv6": false,\n        "ipam": {\n            "driver": "default",\n            "options": {},\n            "config": [\n                {\n                    "subnet": "192.168.0.0/16",\n                    "gateway": "192.168.0.1"\n                }\n            ]\n        },\n        "internal": false,\n        "attachable": false,\n        "ingress": false,\n        "configfrom": {\n            "network": ""\n        },\n        "configonly": false,\n        "containers": {\n            "0e85ebe6279fd23379d39b27b5f47c1e18f23ba7838637802973bf6449e22f5c": {\n                "name": "tomcat-net-01",\n                "endpointid": "576ce5c0f5860a5aab5e487a805da9d72f41a409c460f983c0bd341dd75d83ac",\n                "macaddress": "02:42:c0:a8:00:02",\n                "ipv4address": "192.168.0.2/16",\n                "ipv6address": ""\n            },\n            "c6e462809ccdcebb51a4078b1ac8fdec33f1112e9e416406b606d0c9fb6f21b5": {\n                "name": "tomcat-net-02",\n                "endpointid": "81ecbc4fe26e49855fe374f2d7c00d517b11107cc91a174d383ff6be37d25a30",\n                "macaddress": "02:42:c0:a8:00:03",\n                "ipv4address": "192.168.0.3/16",\n                "ipv6address": ""\n            }\n        },\n        "options": {},\n        "labels": {}\n    }\n]\n\n# åæ¬¡pingè¿æ¥\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker exec -it tomcat-net-01 ping 192.168.0.3\nping 192.168.0.3 (192.168.0.3) 56(84) bytes of data.\n64 bytes from 192.168.0.3: icmp_seq=1 ttl=64 time=0.113 ms\n64 bytes from 192.168.0.3: icmp_seq=2 ttl=64 time=0.093 ms\n^c\n--- 192.168.0.3 ping statistics ---\n2 packets transmitted, 2 received, 0% packet loss, time 999ms\nrtt min/avg/max/mdev = 0.093/0.103/0.113/0.010 ms\n# ç°å¨ä¸ä½¿ç¨ --linkä¹å¯ä»¥pingåå­äºï¼\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker exec -it tomcat-net-01 ping tomcat-net-02\nping tomcat-net-02 (192.168.0.3) 56(84) bytes of data.\n64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq=1 ttl=64 time=0.068 ms\n64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq=2 ttl=64 time=0.096 ms\n64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq=3 ttl=64 time=0.094 ms\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n\n\næä»¬èªå®ä¹çç½ç»dockeré½å·²ç»å¸®æä»¬ç»´æ¤å¥½äºå¯¹åºçå³ç³»ï¼æ¨èæä»¬å¹³æ¶è¿æ ·ä½¿ç¨ç½ç»\n\nå¥½å¤ï¼\n\n> redis - ä¸åçéç¾¤ä½¿ç¨ä¸åçç½ç»ï¼ä¿è¯éç¾¤æ¯å®å¨åå¥åº·ç\n> \n> mysql - ä¸åçéç¾¤ä½¿ç¨ä¸åçç½ç»ï¼ä¿è¯éç¾¤æ¯å®å¨åå¥åº·ç\n\n\n# ç½ç»è¿éï¼ä¸åç½ç»ä¹é´ï¼\n\n\n\næµè¯æétomcat01 åmynet\n\n\n\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker network connect  mynet tomcat01\n\n# è¿éä¹åå°±æ¯è®²tomcat01æ¾å°äºmynetç½ç»ä¸\n# ä¸ä¸ªå®¹å¨ä¸¤ä¸ªipå°åï¼\n# é¿éäºæå¡å¨ï¼å¬ç½ipï¼ç§ç½ip\n\n\n1\n2\n3\n4\n5\n\n\n\n\n\n\n# è¿éok\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker exec -it tomcat01 ping tomcat-net-01\nping tomcat-net-01 (192.168.0.2) 56(84) bytes of data.\n64 bytes from tomcat-net-01.mynet (192.168.0.2): icmp_seq=1 ttl=64 time=0.100 ms\n64 bytes from tomcat-net-01.mynet (192.168.0.2): icmp_seq=2 ttl=64 time=0.085 ms\n^c\n--- tomcat-net-01 ping statistics ---\n2 packets transmitted, 2 received, 0% packet loss, time 1000ms\nrtt min/avg/max/mdev = 0.085/0.092/0.100/0.012 ms\n# ä¾æ§æ æ³è¿éï¼æ²¡æconnect\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker exec -it tomcat02 ping tomcat-net-01\nping: tomcat-net-01: name or service not known\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nç»è®ºï¼åè®¾è¦è·¨ç½ç»æä½å«äººï¼å°±è¦ä½¿ç¨docker network connectè¿é.....!\n\n\n# å®æï¼é¨ç½²redis\n\n\n\n\n# å®æä¸ï¼bridgeç½ç» + dockerï¼\n\n> è¿ç§æ¹æ¡ spring boot é¡¹ç®è¿æ¥rediséç¾¤æ¶æé®é¢ï¼redisèç¹ä¹é´éä¿¡æé®é¢ï¼è¿æ¯ä½¿ç¨çèªå®ä¹ç½æ®µåéçå°å\n\n# åå»ºç½å¡\ndocker network create redis --subnet 172.38.0.0/16\n\n# éè¿èæ¬åå»ºå­ä¸ªrediséç½®\nfor port in $(seq 1 6); \\\ndo \\\nmkdir -p /home/software/redis/node-${port}/conf\ntouch /home/software/redis/node-${port}/conf/redis.conf\ncat << eof >/home/software/redis/node-${port}/conf/redis.conf\nport 6379\nbind 0.0.0.0\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 5000\ncluster-announce-ip 172.38.0.1${port}\ncluster-announce-port 6379\ncluster-announce-bus-port 16379\nappendonly yes\neof\ndone\n# åå»ºç»ç¹1\ndocker run -p 6371:6379 -p 16371:16379 --name redis-1 \\\n-v /home/software/redis/node-1/data:/data \\\n-v /home/software/redis/node-1/conf/redis.conf:/etc/redis/redis.conf \\\n-d --net redis --ip 172.38.0.11 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf\n\n#åå»ºç»ç¹2\ndocker run -p 6372:6379 -p 16372:16379 --name redis-2 \\\n-v /home/software/redis/node-2/data:/data \\\n-v /home/software/redis/node-2/conf/redis.conf:/etc/redis/redis.conf \\\n-d --net redis --ip 172.38.0.12 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf\n#åå»ºç»ç¹3\ndocker run -p 6373:6379 -p 16373:16379 --name redis-3 \\\n-v /home/software/redis/node-3/data:/data \\\n-v /home/software/redis/node-3/conf/redis.conf:/etc/redis/redis.conf \\\n-d --net redis --ip 172.38.0.13 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf\n#åå»ºç»ç¹4\ndocker run -p 6374:6379 -p 16374:16379 --name redis-4 \\\n-v /home/software/redis/node-4/data:/data \\\n-v /home/software/redis/node-4/conf/redis.conf:/etc/redis/redis.conf \\\n-d --net redis --ip 172.38.0.14 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf\n#åå»ºç»ç¹5\ndocker run -p 6375:6379 -p 16375:16379 --name redis-5 \\\n-v /home/software/redis/node-5/data:/data \\\n-v /home/software/redis/node-5/conf/redis.conf:/etc/redis/redis.conf \\\n-d --net redis --ip 172.38.0.15 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf\n#åå»ºç»ç¹6\ndocker run -p 6376:6379 -p 16376:16379 --name redis-6 \\\n-v /home/software/redis/node-6/data:/data \\\n-v /home/software/redis/node-6/conf/redis.conf:/etc/redis/redis.conf \\\n-d --net redis --ip 172.38.0.16 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf\n\n# åå»ºéç¾¤\n[root@iz2zeg4ytp0whqtmxbsqiiz ~]# docker exec -it redis-1 /bin/sh\n/data # ls\nappendonly.aof  nodes.conf\n/data # redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379 172.38.0.13:6379 172.38.0.14:6379 172.38.0.15:6379 172.38.0.16:6379 --cluster-replicas 1\n>>> performing hash slots allocation on 6 nodes...\nmaster[0] -> slots 0 - 5460\nmaster[1] -> slots 5461 - 10922\nmaster[2] -> slots 10923 - 16383\nadding replica 172.38.0.15:6379 to 172.38.0.11:6379\nadding replica 172.38.0.16:6379 to 172.38.0.12:6379\nadding replica 172.38.0.14:6379 to 172.38.0.13:6379\nm: 541b7d237b641ac2ffc94d17c6ab96b18b26a638 172.38.0.11:6379\n   slots:[0-5460] (5461 slots) master\nm: a89c1f1245b264e4a402a3cf99766bcb6138dbca 172.38.0.12:6379\n   slots:[5461-10922] (5462 slots) master\nm: 259e804d6df74e67a72e4206d7db691a300c775e 172.38.0.13:6379\n   slots:[10923-16383] (5461 slots) master\ns: 9b19170eea3ea1b92c58ad18c0b5522633a9e271 172.38.0.14:6379\n   replicates 259e804d6df74e67a72e4206d7db691a300c775e\ns: 061a9d38f22910aaf0ba1dbd21bf1d8f57bcb7d5 172.38.0.15:6379\n   replicates 541b7d237b641ac2ffc94d17c6ab96b18b26a638\ns: 7a16b9bbb0615ec95fc978fa62fc054df60536f0 172.38.0.16:6379\n   replicates a89c1f1245b264e4a402a3cf99766bcb6138dbca\ncan i set the above configuration? (type \'yes\' to accept): yes\n>>> nodes configuration updated\n>>> assign a different config epoch to each node\n>>> sending cluster meet messages to join the cluster\nwaiting for the cluster to join\n...\n>>> performing cluster check (using node 172.38.0.11:6379)\nm: 541b7d237b641ac2ffc94d17c6ab96b18b26a638 172.38.0.11:6379\n   slots:[0-5460] (5461 slots) master\n   1 additional replica(s)\nm: a89c1f1245b264e4a402a3cf99766bcb6138dbca 172.38.0.12:6379\n   slots:[5461-10922] (5462 slots) master\n   1 additional replica(s)\ns: 7a16b9bbb0615ec95fc978fa62fc054df60536f0 172.38.0.16:6379\n   slots: (0 slots) slave\n   replicates a89c1f1245b264e4a402a3cf99766bcb6138dbca\ns: 061a9d38f22910aaf0ba1dbd21bf1d8f57bcb7d5 172.38.0.15:6379\n   slots: (0 slots) slave\n   replicates 541b7d237b641ac2ffc94d17c6ab96b18b26a638\nm: 259e804d6df74e67a72e4206d7db691a300c775e 172.38.0.13:6379\n   slots:[10923-16383] (5461 slots) master\n   1 additional replica(s)\ns: 9b19170eea3ea1b92c58ad18c0b5522633a9e271 172.38.0.14:6379\n   slots: (0 slots) slave\n   replicates 259e804d6df74e67a72e4206d7db691a300c775e\n[ok] all nodes agree about slots configuration.\n>>> check for open slots...\n>>> check slots coverage...\n[ok] all 16384 slots covered.\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n99\n100\n101\n102\n103\n104\n105\n\n\n\n# å®æäºï¼hostç½ç» + docker-composeï¼\n\ndockeræ­å»ºrediséç¾¤å®æï¼\n\n\n\n\n# springbootå¾®æå¡æådockeréå\n\n * æååºç¨\n * ç¼ådockerfile\n\nfrom java:8\n\ncopy *.jar /app.jar\n\ncmd ["--server.port=8080"]\n\nexpose 8080\n\nentrypoint ["java", "-jar", "/app.jar"]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n * æå»ºéå\n\n# ä¸ä¼ jaråådockerfileå°linux\n[root@iz2zeg4ytp0whqtmxbsqiiz idea]# ll\ntotal 16140\n-rw-r--r-- 1 root root 16519871 aug 14 17:38 demo-0.0.1-snapshot.jar\n-rw-r--r-- 1 root root      122 aug 14 17:38 dockerfile\n\n# æå»ºéå\n[root@iz2zeg4ytp0whqtmxbsqiiz idea]# docker build -t myapp:v1 .\nsending build context to docker daemon  16.52mb\nstep 1/5 : from java:8\n8: pulling from library/java\n5040bd298390: pull complete \nfce5728aad85: pull complete \n76610ec20bf5: pull complete \n60170fec2151: pull complete \ne98f73de8f0d: pull complete \n11f7af24ed9c: pull complete \n49e2d6393f32: pull complete \nbb9cdec9c7f3: pull complete \ndigest: sha256:c1ff613e8ba25833d2e1940da0940c3824f03f802c449f3d1815a66b7f8c0e9d\nstatus: downloaded newer image for java:8\n ---\x3e d23bdf5b1b1b\nstep 2/5 : copy *.jar /app.jar\n ---\x3e d4de8837ebf9\nstep 3/5 : cmd ["--server.port=8080"]\n ---\x3e running in e3abc66303f0\nremoving intermediate container e3abc66303f0\n ---\x3e 131bb3917fea\nstep 4/5 : expose 8080\n ---\x3e running in fa2f25977db7\nremoving intermediate container fa2f25977db7\n ---\x3e d98147377951\nstep 5/5 : entrypoint ["java", "-jar", "/app.jar"]\n ---\x3e running in e1885e23773b\nremoving intermediate container e1885e23773b\n ---\x3e afb6b5f28a32\nsuccessfully built afb6b5f28a32\nsuccessfully tagged xiaofan666:latest\n\n# æ¥çéå\n[root@iz2zeg4ytp0whqtmxbsqiiz idea]# docker images\nrepository          tag                 image id            created             size\nmyapp               v1                  afb6b5f28a32        14 seconds ago      660mb\ntomcat              latest              2ae23eb477aa        8 days ago          647mb\nredis               5.0.9-alpine3.11    3661c84ee9d0        3 months ago        29.8mb\njava                8                   d23bdf5b1b1b        3 years ago         643mb\n\n# è¿è¡å®¹å¨\n[root@iz2zeg4ytp0whqtmxbsqiiz idea]# docker run -d -p --name my-springboot-web myapp:v1\nfd9a353a80bfd61f6930c16cd92204532bfd734e003f3f9983b5128a27b0375e\n# æ¥çè¿è¡èµ·æ¥çå®¹å¨ç«¯å£ï¼å ä¸ºæä»¬å¯å¨çæ¶åæ²¡ææå®ï¼\n[root@iz2zeg4ytp0whqtmxbsqiiz idea]# docker ps\ncontainer id        image               command                  created             status              ports                     names\nfd9a353a80bf        xiaofan666          "java -jar /app.jar â¦"   9 seconds ago       up 8 seconds        0.0.0.0:32779->8080/tcp   xiaofan-springboot-web\n# æ¬å°è®¿é®1\n[root@iz2zeg4ytp0whqtmxbsqiiz idea]# curl localhost:32779/hello\nhello, world\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n\n\n\n# docker compose\n\n\n# å®è£\n\nä¸è½½docker-composeå½ä»¤\n\n# å®ç½æä¾ ï¼æ²¡æä¸è½½æåï¼\ncurl -l "https://github.com/docker/compose/releases/download/1.26.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose\n# å½åå°å\ncurl -l https://get.daocloud.io/docker/compose/releases/download/1.25.5/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose\n\n\n1\n2\n3\n4\n\n\nåéå¯æ§è¡æé\n\nchmod +x /usr/local/bin/docker-compose\n\n\n1\n\n\n\n\n\n# yamlè§å\n\nhttps://docs.docker.com/compose/compose-file/#compose-file-structure-and-examples\n\n\n# å®æï¼èªå·±ç¼åå¾®æå¡ä¸çº¿\n\n * ç¼åé¡¹ç®å¾®æå¡\n * dockerfileæå»ºéå\n\nfrom java:8\n\ncopy *.jar /app.jar\n\ncmd ["--server.port=8080"]\n\nexpose 8080\n\nentrypoint ["java", "-jar", "/app.jar"]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n * docker-compose.ymlç¼æé¡¹ç®\n\nversion \'3.8\'\nservices:\n  myapp:\n    build: .\n    image: myapp:v1\n    depends_on:\n      - redis\n    ports:\n      - "8080:8080"\n\n  redis:\n    image: "library/redis:alpine"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n * ä¸¢å°æå¡å¨è¿è¡ docker-compose up\n\ndocker-compose down\t\t\t# å³é­å®¹å¨\ndocker-compose up --build \t# éæ°æå»º\n\n\n1\n2\n\n\n\n\n',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Docker ä¸­çº§ç¯",frontmatter:{title:"Docker ä¸­çº§ç¯",date:"2022-02-03T00:03:52.000Z",permalink:"/pages/5ca863/",categories:["åç«¯","Docker"],tags:[null]},regularPath:"/25.%E8%BF%90%E7%BB%B4/50.Docker/02.Docker%20%E4%B8%AD%E7%BA%A7%E7%AF%87.html",relativePath:"25.è¿ç»´/50.Docker/02.Docker ä¸­çº§ç¯.md",key:"v-485c8077",path:"/pages/5ca863/",headers:[{level:2,title:"FROM æå®åºç¡éå",slug:"from-æå®åºç¡éå",normalizedTitle:"from æå®åºç¡éå",charIndex:106},{level:2,title:"RUN æ§è¡å½ä»¤",slug:"run-æ§è¡å½ä»¤",normalizedTitle:"run æ§è¡å½ä»¤",charIndex:539},{level:2,title:"æå»ºéå",slug:"æå»ºéå",normalizedTitle:"æå»ºéå",charIndex:2376},{level:2,title:"éåæå»ºä¸ä¸æï¼Contextï¼",slug:"éåæå»ºä¸ä¸æ-context",normalizedTitle:"éåæå»ºä¸ä¸æï¼contextï¼",charIndex:2983},{level:2,title:"Dockerfile æä»¤è¯¦è§£",slug:"dockerfile-æä»¤è¯¦è§£",normalizedTitle:"dockerfile æä»¤è¯¦è§£",charIndex:4827},{level:3,title:"COPY å¤å¶æä»¶",slug:"copy-å¤å¶æä»¶",normalizedTitle:"copy å¤å¶æä»¶",charIndex:4847},{level:3,title:"ADD æ´é«çº§çå¤å¶æä»¶",slug:"add-æ´é«çº§çå¤å¶æä»¶",normalizedTitle:"add æ´é«çº§çå¤å¶æä»¶",charIndex:5413},{level:3,title:"CMD å®¹å¨å¯å¨å½ä»¤",slug:"cmd-å®¹å¨å¯å¨å½ä»¤",normalizedTitle:"cmd å®¹å¨å¯å¨å½ä»¤",charIndex:5792},{level:3,title:"ENTRYPOINT å¥å£ç¹",slug:"entrypoint-å¥å£ç¹",normalizedTitle:"entrypoint å¥å£ç¹",charIndex:7211},{level:3,title:"ENV è®¾ç½®ç¯å¢åé",slug:"env-è®¾ç½®ç¯å¢åé",normalizedTitle:"env è®¾ç½®ç¯å¢åé",charIndex:9829},{level:3,title:"ARG æå»ºåæ°",slug:"arg-æå»ºåæ°",normalizedTitle:"arg æå»ºåæ°",charIndex:10232},{level:3,title:"VOLUME å®ä¹å¿åå·",slug:"volume-å®ä¹å¿åå·",normalizedTitle:"volume å®ä¹å¿åå·",charIndex:10532},{level:3,title:"EXPOSE æ´é²ç«¯å£",slug:"expose-æ´é²ç«¯å£",normalizedTitle:"expose æ´é²ç«¯å£",charIndex:11006},{level:3,title:"WORKDIR æå®å·¥ä½ç®å½",slug:"workdir-æå®å·¥ä½ç®å½",normalizedTitle:"workdir æå®å·¥ä½ç®å½",charIndex:11360},{level:3,title:"USER æå®å½åç¨æ·",slug:"user-æå®å½åç¨æ·",normalizedTitle:"user æå®å½åç¨æ·",charIndex:12057},{level:3,title:"LABEL ä¸ºéåæ·»å åæ°æ®",slug:"label-ä¸ºéåæ·»å åæ°æ®",normalizedTitle:"label ä¸ºéåæ·»å åæ°æ®",charIndex:12338},{level:2,title:"æ°æ®å·",slug:"æ°æ®å·",normalizedTitle:"æ°æ®å·",charIndex:12484},{level:3,title:"åå»ºä¸ä¸ªæ°æ®å·ï¼å·åæ°æ®å·ï¼",slug:"åå»ºä¸ä¸ªæ°æ®å·-å·åæ°æ®å·",normalizedTitle:"åå»ºä¸ä¸ªæ°æ®å·ï¼å·åæ°æ®å·ï¼",charIndex:12694},{level:3,title:"å¯å¨ä¸ä¸ªæè½½æ°æ®å·çå®¹å¨",slug:"å¯å¨ä¸ä¸ªæè½½æ°æ®å·çå®¹å¨",normalizedTitle:"å¯å¨ä¸ä¸ªæè½½æ°æ®å·çå®¹å¨",charIndex:13137},{level:3,title:"æ¥çæ°æ®å·çå·ä½ä¿¡æ¯",slug:"æ¥çæ°æ®å·çå·ä½ä¿¡æ¯",normalizedTitle:"æ¥çæ°æ®å·çå·ä½ä¿¡æ¯",charIndex:13547},{level:3,title:"å é¤æ°æ®å·",slug:"å é¤æ°æ®å·",normalizedTitle:"å é¤æ°æ®å·",charIndex:13949},{level:2,title:"æè½½ä¸»æºç®å½",slug:"æè½½ä¸»æºç®å½",normalizedTitle:"æè½½ä¸»æºç®å½",charIndex:12500},{level:3,title:"æè½½ä¸ä¸ªä¸»æºç®å½ä½ä¸ºæ°æ®å·",slug:"æè½½ä¸ä¸ªä¸»æºç®å½ä½ä¸ºæ°æ®å·",normalizedTitle:"æè½½ä¸ä¸ªä¸»æºç®å½ä½ä¸ºæ°æ®å·",charIndex:14163},{level:3,title:"æ¥çæ°æ®å·çå·ä½ä¿¡æ¯",slug:"æ¥çæ°æ®å·çå·ä½ä¿¡æ¯-2",normalizedTitle:"æ¥çæ°æ®å·çå·ä½ä¿¡æ¯",charIndex:13547}],headersStr:"FROM æå®åºç¡éå RUN æ§è¡å½ä»¤ æå»ºéå éåæå»ºä¸ä¸æï¼Contextï¼ Dockerfile æä»¤è¯¦è§£ COPY å¤å¶æä»¶ ADD æ´é«çº§çå¤å¶æä»¶ CMD å®¹å¨å¯å¨å½ä»¤ ENTRYPOINT å¥å£ç¹ ENV è®¾ç½®ç¯å¢åé ARG æå»ºåæ° VOLUME å®ä¹å¿åå· EXPOSE æ´é²ç«¯å£ WORKDIR æå®å·¥ä½ç®å½ USER æå®å½åç¨æ· LABEL ä¸ºéåæ·»å åæ°æ® æ°æ®å· åå»ºä¸ä¸ªæ°æ®å·ï¼å·åæ°æ®å·ï¼ å¯å¨ä¸ä¸ªæè½½æ°æ®å·çå®¹å¨ æ¥çæ°æ®å·çå·ä½ä¿¡æ¯ å é¤æ°æ®å· æè½½ä¸»æºç®å½ æè½½ä¸ä¸ªä¸»æºç®å½ä½ä¸ºæ°æ®å· æ¥çæ°æ®å·çå·ä½ä¿¡æ¯",content:'# ä½¿ç¨ Dockerfile å®å¶éå\n\nDockerfile æ¯ä¸ä¸ªææ¬æä»¶ï¼å¶ååå«äºä¸æ¡æ¡ç æä»¤(Instruction)ï¼æ¯ä¸æ¡æä»¤æå»ºä¸å±ï¼å æ­¤æ¯ä¸æ¡æä»¤çåå®¹ï¼å°±æ¯æè¿°è¯¥å±åºå½å¦ä½æå»ºã\n\n\n# FROM æå®åºç¡éå\n\næè°å®å¶éåï¼é£ä¸å®æ¯ä»¥ä¸ä¸ªéåä¸ºåºç¡ï¼å¨å¶ä¸è¿è¡å®å¶ãå°±åæä»¬ä¹åè¿è¡äºä¸ä¸ª nginx éåçå®¹å¨ï¼åè¿è¡ä¿®æ¹ä¸æ ·ï¼åºç¡éåæ¯å¿é¡»æå®çãè FROM å°±æ¯æå® åºç¡éåï¼å æ­¤ä¸ä¸ª Dockerfile ä¸­ FROM æ¯å¿å¤çæä»¤ï¼å¹¶ä¸å¿é¡»æ¯ç¬¬ä¸æ¡æä»¤ã\n\nå¨ Docker Hub ä¸æéå¸¸å¤çé«è´¨éçå®æ¹éåï¼æå¯ä»¥ç´æ¥æ¿æ¥ä½¿ç¨çæå¡ç±»çéåï¼å¦ nginxãredisãmongoãmysqlãhttpdãphpãtomcat ç­ï¼ä¹æä¸äºæ¹ä¾¿å¼åãæå»ºãè¿è¡åç§è¯­è¨åºç¨çéåï¼å¦ nodeãopenjdkãpythonãrubyãgolang ç­ãå¯ä»¥å¨å¶ä¸­å¯»æ¾ä¸ä¸ªæç¬¦åæä»¬æç»ç®æ çéåä¸ºåºç¡éåè¿è¡å®å¶ã\n\nå¦ææ²¡ææ¾å°å¯¹åºæå¡çéåï¼å®æ¹éåä¸­è¿æä¾äºä¸äºæ´ä¸ºåºç¡çæä½ç³»ç»éåï¼å¦ ubuntuãdebianãcentosãfedoraãalpine ç­ï¼è¿äºæä½ç³»ç»çè½¯ä»¶åºä¸ºæä»¬æä¾äºæ´å¹¿éçæ©å±ç©ºé´ã\n\n\n# RUN æ§è¡å½ä»¤\n\nRUN æä»¤æ¯ç¨æ¥æ§è¡å½ä»¤è¡å½ä»¤çã\n\nå¶æ ¼å¼æä¸¤ç§ï¼\n\n * shell æ ¼å¼ï¼RUN <å½ä»¤>ï¼å°±åç´æ¥å¨å½ä»¤è¡ä¸­è¾å¥çå½ä»¤ä¸æ ·ã\n\nRUN echo \'<h1>Hello, Docker!</h1>\' > /usr/share/nginx/html/index.html\n\n\n1\n\n * exec æ ¼å¼ï¼RUN ["å¯æ§è¡æä»¶", "åæ°1", "åæ°2"]ï¼è¿æ´åæ¯å½æ°è°ç¨ä¸­çæ ¼å¼ã\n\nä¹åè¯´è¿ï¼Dockerfile ä¸­æ¯ä¸ä¸ªæä»¤é½ä¼å»ºç«ä¸å±ï¼RUN ä¹ä¸ä¾å¤ãæ¯ä¸ä¸ª RUN çè¡ä¸ºï¼å°±ååææä»¬æå·¥å»ºç«éåçè¿ç¨ä¸æ ·ï¼æ°å»ºç«ä¸å±ï¼å¨å¶ä¸æ§è¡è¿äºå½ä»¤ï¼æ§è¡ç»æåï¼commit è¿ä¸å±çä¿®æ¹ï¼æææ°çéåã\n\n * éè¯¯ç¤ºä¾\n\nFROM debian:stretch\n\nRUN apt-get update\nRUN apt-get install -y gcc libc6-dev make wget\nRUN wget -O redis.tar.gz "http://download.redis.io/releases/redis-5.0.3.tar.gz"\nRUN mkdir -p /usr/src/redis\nRUN tar -xzf redis.tar.gz -C /usr/src/redis --strip-components=1\nRUN make -C /usr/src/redis\nRUN make -C /usr/src/redis install\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢çè¿ç§åæ³ï¼åå»ºäº 7 å±éåãè¿æ¯å®å¨æ²¡ææä¹çï¼èä¸å¾å¤è¿è¡æ¶ä¸éè¦çä¸è¥¿ï¼é½è¢«è£è¿äºéåéï¼æ¯å¦ç¼è¯ç¯å¢ãæ´æ°çè½¯ä»¶åç­ç­ãç»æå°±æ¯äº§çéå¸¸èè¿ãéå¸¸å¤å±çéåï¼ä¸ä»ä»å¢å äºæå»ºé¨ç½²çæ¶é´ï¼ä¹å¾å®¹æåºéã\n\nUnion FS æ¯ææå¤§å±æ°éå¶çï¼æ¯å¦ AUFSï¼æ¾ç»æ¯æå¤§ä¸å¾è¶è¿ 42 å±ï¼ç°å¨æ¯ä¸å¾è¶è¿ 127 å±ã\n\n * æä½³å®è·µ\n\nFROM debian:stretch\n\nRUN set -x; buildDeps=\'gcc libc6-dev make wget\' \\\n    && apt-get update \\\n    && apt-get install -y $buildDeps \\\n    && wget -O redis.tar.gz "http://download.redis.io/releases/redis-5.0.3.tar.gz" \\\n    && mkdir -p /usr/src/redis \\\n    && tar -xzf redis.tar.gz -C /usr/src/redis --strip-components=1 \\\n    && make -C /usr/src/redis \\\n    && make -C /usr/src/redis install \\\n    && rm -rf /var/lib/apt/lists/* \\\n    && rm redis.tar.gz \\\n    && rm -r /usr/src/redis \\\n    && apt-get purge -y --auto-remove $buildDeps\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\né¦åï¼ä¹åææçå½ä»¤åªæä¸ä¸ªç®çï¼å°±æ¯ç¼è¯ãå®è£ redis å¯æ§è¡æä»¶ãå æ­¤æ²¡æå¿è¦å»ºç«å¾å¤å±ï¼è¿åªæ¯ä¸å±çäºæãå¨æ°å Dockerfile çæ¶åï¼è¦ç»å¸¸æéèªå·±ï¼è¿å¹¶ä¸æ¯å¨å Shell èæ¬ï¼èæ¯å¨å®ä¹æ¯ä¸å±è¯¥å¦ä½æå»ºã\n\nå¹¶ä¸ï¼è¿éä¸ºäºæ ¼å¼åè¿è¿è¡äºæ¢è¡ãDockerfile æ¯æ Shell ç±»çè¡å°¾æ·»å  \\ çå½ä»¤æ¢è¡æ¹å¼ï¼ä»¥åè¡é¦ # è¿è¡æ³¨éçæ ¼å¼ã\n\næ­¤å¤ï¼è¿å¯ä»¥çå°è¿ä¸ç»å½ä»¤çæåæ·»å äºæ¸çå·¥ä½çå½ä»¤ï¼å é¤äºä¸ºäºç¼è¯æå»ºæéè¦çè½¯ä»¶ï¼æ¸çäºææä¸è½½ãå±å¼çæä»¶ï¼å¹¶ä¸è¿æ¸çäº apt ç¼å­æä»¶ãè¿æ¯å¾éè¦çä¸æ­¥ï¼æä»¬ä¹åè¯´è¿ï¼éåæ¯å¤å±å­å¨ï¼æ¯ä¸å±çä¸è¥¿å¹¶ä¸ä¼å¨ä¸ä¸å±è¢«å é¤ï¼ä¼ä¸ç´è·éçéåãå æ­¤éåæå»ºæ¶ï¼ä¸å®è¦ç¡®ä¿æ¯ä¸å±åªæ·»å çæ­£éè¦æ·»å çä¸è¥¿ï¼ä»»ä½æ å³çä¸è¥¿é½åºè¯¥æ¸çæã\n\nå¾å¤äºº Docker åå­¦èå¶ä½åºå¾èè¿çéåçåå ä¹ä¸ï¼å°±æ¯å¿è®°äºå¨æ¯ä¸å±æå»ºçæåä¸å®è¦æ¸çææ å³æä»¶ã\n\n\n# æå»ºéå\n\nå¨ Dockerfile æä»¶æå¨ç®å½æ§è¡ï¼\n\n$ docker build -t nginx:v3 .\nSending build context to Docker daemon 2.048 kB\nStep 1 : FROM nginx\n ---\x3e e43d811ce2f4\nStep 2 : RUN echo \'<h1>Hello, Docker!</h1>\' > /usr/share/nginx/html/index.html\n ---\x3e Running in 9cdc27646c7b\n ---\x3e 44aa4490ce2c\nRemoving intermediate container 9cdc27646c7b\nSuccessfully built 44aa4490ce2c\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä»å½ä»¤çè¾åºç»æä¸­ï¼æä»¬å¯ä»¥æ¸æ°ççå°éåçæå»ºè¿ç¨ãå¨ Step 2 ä¸­ï¼RUN æä»¤å¯å¨äºä¸ä¸ªå®¹å¨ 9cdc27646c7bï¼æ§è¡äºæè¦æ±çå½ä»¤ï¼å¹¶æåæäº¤äºè¿ä¸å± 44aa4490ce2cï¼éåå é¤äºæç¨å°çè¿ä¸ªå®¹å¨ 9cdc27646c7bã\n\nè¿éæä»¬ä½¿ç¨äº docker build å½ä»¤è¿è¡éåæå»ºãå¶æ ¼å¼ä¸ºï¼\n\ndocker build [éé¡¹] <ä¸ä¸æè·¯å¾/URL/->\n\n\n1\n\n\nå¨è¿éæä»¬æå®äºæç»éåçåç§° -t nginx:v3\n\n\n# éåæå»ºä¸ä¸æï¼Contextï¼\n\nå¦ææ³¨æï¼ä¼çå° docker build å½ä»¤æåæä¸ä¸ª .ã. è¡¨ç¤ºå½åç®å½ï¼è Dockerfile å°±å¨å½åç®å½ï¼å æ­¤ä¸å°åå­¦èä»¥ä¸ºè¿ä¸ªè·¯å¾æ¯å¨æå® Dockerfile æå¨è·¯å¾ï¼è¿ä¹çè§£å¶å®æ¯ä¸åç¡®çãå¦æå¯¹åºä¸é¢çå½ä»¤æ ¼å¼ï¼ä½ å¯è½ä¼åç°ï¼è¿æ¯å¨æå® ä¸ä¸æè·¯å¾ãé£ä¹ä»ä¹æ¯ä¸ä¸æå¢ï¼\n\né¦åæä»¬è¦çè§£ docker build çå·¥ä½åçãDocker å¨è¿è¡æ¶åä¸º Docker å¼æï¼ä¹å°±æ¯æå¡ç«¯å®æ¤è¿ç¨ï¼åå®¢æ·ç«¯å·¥å·ãDocker çå¼ææä¾äºä¸ç» REST APIï¼è¢«ç§°ä¸º Docker Remote APIï¼èå¦ docker å½ä»¤è¿æ ·çå®¢æ·ç«¯å·¥å·ï¼åæ¯éè¿è¿ç» API ä¸ Docker å¼æäº¤äºï¼ä»èå®æåç§åè½ãå æ­¤ï¼è½ç¶è¡¨é¢ä¸æä»¬å¥½åæ¯å¨æ¬æºæ§è¡åç§ docker åè½ï¼ä½å®éä¸ï¼ä¸åé½æ¯ä½¿ç¨çè¿ç¨è°ç¨å½¢å¼å¨æå¡ç«¯ï¼Docker å¼æï¼å®æãä¹å ä¸ºè¿ç§ C/S è®¾è®¡ï¼è®©æä»¬æä½è¿ç¨æå¡å¨ç Docker å¼æåå¾è½»èæä¸¾ã\n\nå½æä»¬è¿è¡éåæå»ºçæ¶åï¼å¹¶éææå®å¶é½ä¼éè¿ RUN æä»¤å®æï¼ç»å¸¸ä¼éè¦å°ä¸äºæ¬å°æä»¶å¤å¶è¿éåï¼æ¯å¦éè¿ COPY æä»¤ãADD æä»¤ç­ãè docker build å½ä»¤æå»ºéåï¼å¶å®å¹¶éå¨æ¬å°æå»ºï¼èæ¯å¨æå¡ç«¯ï¼ä¹å°±æ¯ Docker å¼æä¸­æå»ºçãé£ä¹å¨è¿ç§å®¢æ·ç«¯/æå¡ç«¯çæ¶æä¸­ï¼å¦ä½æè½è®©æå¡ç«¯è·å¾æ¬å°æä»¶å¢ï¼\n\nè¿å°±å¼å¥äºä¸ä¸æçæ¦å¿µãå½æå»ºçæ¶åï¼ç¨æ·ä¼æå®æå»ºéåä¸ä¸æçè·¯å¾ï¼docker build å½ä»¤å¾ç¥è¿ä¸ªè·¯å¾åï¼ä¼å°è·¯å¾ä¸çææåå®¹æåï¼ç¶åä¸ä¼ ç» Docker å¼æãè¿æ · Docker å¼ææ¶å°è¿ä¸ªä¸ä¸æååï¼å±å¼å°±ä¼è·å¾æå»ºéåæéçä¸åæä»¶ã\n\nå¦æå¨ Dockerfile ä¸­è¿ä¹åï¼\n\nCOPY ./package.json /app/\n\n\n1\n\n\nå°±è¡¨ç¤ºå¤å¶ ä¸ä¸æï¼contextï¼ ç®å½ä¸ç package.jsonã\n\nå æ­¤ï¼COPY è¿ç±»æä»¤ä¸­çæºæä»¶çè·¯å¾é½æ¯ç¸å¯¹è·¯å¾ãè¿ä¹æ¯åå­¦èç»å¸¸ä¼é®çä¸ºä»ä¹ COPY ../package.json /app æè COPY /opt/xxxx /app æ æ³å·¥ä½çåå ï¼å ä¸ºè¿äºè·¯å¾å·²ç»è¶åºäºä¸ä¸æçèå´ï¼Docker å¼ææ æ³è·å¾è¿äºä½ç½®çæä»¶ãå¦æççéè¦é£äºæä»¶ï¼åºè¯¥å°å®ä»¬å¤å¶å°ä¸ä¸æç®å½ä¸­å»ã\n\nç°å¨å°±å¯ä»¥çè§£åæçå½ä»¤ docker build -t nginx:v3 . ä¸­çè¿ä¸ª .ï¼å®éä¸æ¯å¨æå®ä¸ä¸æçç®å½ï¼docker build å½ä»¤ä¼å°è¯¥ç®å½ä¸çåå®¹æåäº¤ç» Docker å¼æä»¥å¸®å©æå»ºéåã\n\nå¦æè§å¯ docker build è¾åºï¼æä»¬å¶å®å·²ç»çå°äºè¿ä¸ªåéä¸ä¸æçè¿ç¨ï¼\n\n$ docker build -t nginx:v3 .\nSending build context to Docker daemon 2.048 kB\n...\n\n\n1\n2\n3\n\n\nçè§£æå»ºä¸ä¸æå¯¹äºéåæå»ºæ¯å¾éè¦çï¼é¿åç¯ä¸äºä¸åºè¯¥çéè¯¯ãæ¯å¦æäºåå­¦èå¨åç° COPY /opt/xxxx /app ä¸å·¥ä½åï¼äºæ¯å¹²èå° Dockerfile æ¾å°äºç¡¬çæ ¹ç®å½å»æå»ºï¼ç»æåç° docker build æ§è¡åï¼å¨åéä¸ä¸ªå å GB çä¸è¥¿ï¼æä¸ºç¼æ¢èä¸å¾å®¹ææå»ºå¤±è´¥ãé£æ¯å ä¸ºè¿ç§åæ³æ¯å¨è®© docker build æåæ´ä¸ªç¡¬çï¼è¿æ¾ç¶æ¯ä½¿ç¨éè¯¯ã\n\nä¸è¬æ¥è¯´ï¼åºè¯¥ä¼å° Dockerfile ç½®äºä¸ä¸ªç©ºç®å½ä¸ï¼æèé¡¹ç®æ ¹ç®å½ä¸ãå¦æè¯¥ç®å½ä¸æ²¡ææéæä»¶ï¼é£ä¹åºè¯¥ææéæä»¶å¤å¶ä¸ä»½è¿æ¥ãå¦æç®å½ä¸æäºä¸è¥¿ç¡®å®ä¸å¸ææå»ºæ¶ä¼ ç» Docker å¼æï¼é£ä¹å¯ä»¥ç¨ .gitignore ä¸æ ·çè¯­æ³åä¸ä¸ª .dockerignoreï¼è¯¥æä»¶æ¯ç¨äºåé¤ä¸éè¦ä½ä¸ºä¸ä¸æä¼ éç» Docker å¼æçã\n\nå¨é»è®¤æåµä¸ï¼å¦æä¸é¢å¤æå® Dockerfile çè¯ï¼ä¼å°ä¸ä¸æç®å½ä¸çåä¸º Dockerfile çæä»¶ä½ä¸º Dockerfileãè¿åªæ¯é»è®¤è¡ä¸ºï¼å®éä¸ Dockerfile çæä»¶åå¹¶ä¸è¦æ±å¿é¡»ä¸º Dockerfileï¼èä¸å¹¶ä¸è¦æ±å¿é¡»ä½äºä¸ä¸æç®å½ä¸­ï¼æ¯å¦å¯ä»¥ç¨ -f ../Dockerfile.php åæ°æå®æä¸ªæä»¶ä½ä¸º Dockerfileã\n\nå½ç¶ï¼ä¸è¬å¤§å®¶ä¹ æ¯æ§çä¼ä½¿ç¨é»è®¤çæä»¶å Dockerfileï¼ä»¥åä¼å°å¶ç½®äºéåæå»ºä¸ä¸æç®å½ä¸­ã\n\n\n# Dockerfile æä»¤è¯¦è§£\n\n\n# COPY å¤å¶æä»¶\n\næ ¼å¼ï¼\n\n * COPY [--chown=<user>:<group>] <æºè·¯å¾>... <ç®æ è·¯å¾>\n * COPY [--chown=<user>:<group>] ["<æºè·¯å¾1>",... "<ç®æ è·¯å¾>"]\n\nå RUN æä»¤ä¸æ ·ï¼ä¹æä¸¤ç§æ ¼å¼ï¼ä¸ç§ç±»ä¼¼äºå½ä»¤è¡ï¼ä¸ç§ç±»ä¼¼äºå½æ°è°ç¨ã\n\nCOPY æä»¤å°ä»æå»ºä¸ä¸æç®å½ä¸­ <æºè·¯å¾> çæä»¶/ç®å½å¤å¶å°æ°çä¸å±çéååç <ç®æ è·¯å¾> ä½ç½®ãæ¯å¦ï¼\n\nCOPY package.json /usr/src/app/\n\n\n1\n\n\n<æºè·¯å¾> å¯ä»¥æ¯å¤ä¸ªï¼çè³å¯ä»¥æ¯ééç¬¦ï¼å¶ééç¬¦è§åè¦æ»¡è¶³ Go ç filepath.Match è§åï¼å¦ï¼\n\nCOPY hom* /mydir/\nCOPY hom?.txt /mydir/\n\n\n1\n2\n\n\n<ç®æ è·¯å¾> å¯ä»¥æ¯å®¹å¨åçç»å¯¹è·¯å¾ï¼ä¹å¯ä»¥æ¯ç¸å¯¹äºå·¥ä½ç®å½çç¸å¯¹è·¯å¾ï¼å·¥ä½ç®å½å¯ä»¥ç¨ WORKDIR æä»¤æ¥æå®ï¼ãç®æ è·¯å¾ä¸éè¦äºååå»ºï¼å¦æç®å½ä¸å­å¨ä¼å¨å¤å¶æä»¶ååè¡åå»ºç¼ºå¤±ç®å½ã\n\næ­¤å¤ï¼è¿éè¦æ³¨æä¸ç¹ï¼ä½¿ç¨ COPY æä»¤ï¼æºæä»¶çåç§åæ°æ®é½ä¼ä¿çãæ¯å¦è¯»ãåãæ§è¡æéãæä»¶åæ´æ¶é´ç­ã\n\nå¦ææºè·¯å¾ä¸ºæä»¶å¤¹ï¼å¤å¶çæ¶åä¸æ¯ç´æ¥å¤å¶è¯¥æä»¶å¤¹ï¼èæ¯å°æä»¶å¤¹ä¸­çåå®¹å¤å¶å°ç®æ è·¯å¾ã\n\n\n# ADD æ´é«çº§çå¤å¶æä»¶\n\nADD æä»¤å COPY çæ ¼å¼åæ§è´¨åºæ¬ä¸è´ã\n\nå¦æ <æºè·¯å¾> ä¸ºä¸ä¸ª tar åç¼©æä»¶çè¯ï¼åç¼©æ ¼å¼ä¸º gzip, bzip2 ä»¥å xz çæåµä¸ï¼ADD æä»¤å°ä¼èªå¨è§£åç¼©è¿ä¸ªåç¼©æä»¶å° <ç®æ è·¯å¾> å»ã\n\nå¨ Docker å®æ¹ç Dockerfile æä½³å®è·µææ¡£ ä¸­è¦æ±ï¼å°½å¯è½çä½¿ç¨ COPYï¼å ä¸º COPY çè¯­ä¹å¾æç¡®ï¼å°±æ¯å¤å¶æä»¶èå·²ï¼è ADD ååå«äºæ´å¤æçåè½ï¼å¶è¡ä¸ºä¹ä¸ä¸å®å¾æ¸æ°ãæéåä½¿ç¨ ADD çåºåï¼å°±æ¯ææåçéè¦èªå¨è§£åç¼©çåºåã\n\nå¦å¤éè¦æ³¨æçæ¯ï¼ADD æä»¤ä¼ä»¤éåæå»ºç¼å­å¤±æï¼ä»èå¯è½ä¼ä»¤éåæå»ºåå¾æ¯è¾ç¼æ¢ã\n\nå æ­¤å¨ COPY å ADD æä»¤ä¸­éæ©çæ¶åï¼å¯ä»¥éµå¾ªè¿æ ·çååï¼ææçæä»¶å¤å¶åä½¿ç¨ COPY æä»¤ï¼ä»å¨éè¦èªå¨è§£åç¼©çåºåä½¿ç¨ ADDã\n\n\n# CMD å®¹å¨å¯å¨å½ä»¤\n\nCMD æä»¤ç¨äºæå®å®¹å¨ä¸»è¿ç¨çé»è®¤å¯å¨å½ä»¤ã\n\nç±»ä¼¼äº RUN æä»¤ï¼ç¨äºè¿è¡ç¨åºï¼ä½äºèè¿è¡çæ¶é´ç¹ä¸å:\n\n * CMD å¨docker run æ¶è¿è¡ã\n * RUN æ¯å¨ docker buildã\n\nCMD æä»¤çæ ¼å¼å RUN ç¸ä¼¼ï¼ä¹æ¯ä¸¤ç§æ ¼å¼ï¼\n\n * shell æ ¼å¼ï¼CMD <å½ä»¤>\n * exec æ ¼å¼ï¼CMD ["å¯æ§è¡æä»¶", "åæ°1", "åæ°2"...]\n * åæ°åè¡¨æ ¼å¼ï¼CMD ["åæ°1", "åæ°2"...]ãå¨æå®äº ENTRYPOINT æä»¤åï¼ç¨ CMD æå®å·ä½çåæ°ã\n\næ³¨æï¼å¦æ Dockerfile ä¸­å¦æå­å¨å¤ä¸ª CMD æä»¤ï¼ä»æåä¸ä¸ªçæã\n\nCMD æä»¤æå®çç¨åºå¯è¢« docker run å½ä»¤è¡åæ°ä¸­æå®è¦è¿è¡çç¨åºæè¦çãæ¯å¦ï¼ubuntu éåé»è®¤ç CMD æ¯ /bin/bashï¼å¦ææä»¬ç´æ¥ docker run -it ubuntu çè¯ï¼ä¼ç´æ¥è¿å¥ bashãæä»¬ä¹å¯ä»¥å¨è¿è¡æ¶æå®è¿è¡å«çå½ä»¤ï¼å¦ docker run -it ubuntu cat /etc/os-releaseãè¿å°±æ¯ç¨ cat /etc/os-release å½ä»¤æ¿æ¢äºé»è®¤ç /bin/bash å½ä»¤äºï¼è¾åºäºç³»ç»çæ¬ä¿¡æ¯ã\n\nå¨æä»¤æ ¼å¼ä¸ï¼ä¸è¬æ¨èä½¿ç¨ exec æ ¼å¼ï¼è¿ç±»æ ¼å¼å¨è§£ææ¶ä¼è¢«è§£æä¸º JSON æ°ç»ï¼å æ­¤ä¸å®è¦ä½¿ç¨åå¼å· "ï¼èä¸è¦ä½¿ç¨åå¼å·ã\n\nå¦æä½¿ç¨ shell æ ¼å¼çè¯ï¼å®éçå½ä»¤ä¼è¢«åè£ä¸º sh -c çåæ°çå½¢å¼è¿è¡æ§è¡ãæ¯å¦ï¼\n\nCMD echo $HOME\n\n\n1\n\n\nå¨å®éæ§è¡ä¸­ï¼ä¼å°å¶åæ´ä¸ºï¼\n\nCMD [ "sh", "-c", "echo $HOME" ]\n\n\n1\n\n\nè¿å°±æ¯ä¸ºä»ä¹æä»¬å¯ä»¥ä½¿ç¨ç¯å¢åéçåå ï¼å ä¸ºè¿äºç¯å¢åéä¼è¢« shell è¿è¡è§£æå¤çã\n\n> æå° CMD å°±ä¸å¾ä¸æå®¹å¨ä¸­åºç¨å¨åå°æ§è¡ååå°æ§è¡çé®é¢ãè¿æ¯åå­¦èå¸¸åºç°çä¸ä¸ªæ··æ·ã\n> \n> Docker ä¸æ¯èææºï¼å®¹å¨ä¸­çåºç¨é½åºè¯¥ä»¥åå°æ§è¡ï¼èä¸æ¯åèææºãç©çæºéé¢é£æ ·ï¼ç¨ systemd å»å¯å¨åå°æå¡ï¼å®¹å¨åæ²¡æåå°æå¡çæ¦å¿µã\n> \n> ä¸äºåå­¦èå° CMD åä¸ºï¼\n> \n> CMD service nginx start\n> \n> \n> 1\n> \n> \n> ç¶ååç°å®¹å¨æ§è¡åå°±ç«å³éåºäºãçè³å¨å®¹å¨åå»ä½¿ç¨ systemctl å½ä»¤ç»æå´åç°æ ¹æ¬æ§è¡ä¸äºãè¿å°±æ¯å ä¸ºæ²¡æææç½åå°ãåå°çæ¦å¿µï¼æ²¡æåºåå®¹å¨åèææºçå·®å¼ï¼ä¾æ§å¨ä»¥ä¼ ç»èææºçè§åº¦å»çè§£å®¹å¨ã\n> \n> å¯¹äºå®¹å¨èè¨ï¼å®¹å¨å°±æ¯ä¸ºäºå®¹å¨åçåºç¨ä¸»è¿ç¨èå­å¨çï¼ä¸»è¿ç¨éåºï¼å®¹å¨å°±å¤±å»äºå­å¨çæä¹ï¼ä»èéåºï¼å¶å®è¾å©è¿ç¨ä¸æ¯å®éè¦å³å¿çä¸è¥¿ã\n> \n> ä¾å¦CMD service nginx start ä¼è¢«çè§£ä¸º CMD [ "sh", "-c", "service nginx start"]ï¼å æ­¤ä¸»è¿ç¨å®éä¸æ¯ shãé£ä¹å½ service nginx start å½ä»¤ç»æåï¼sh ä¹å°±ç»æäºï¼sh ä½ä¸ºä¸»è¿ç¨éåºäºï¼èªç¶å°±ä¼ä»¤å®¹å¨éåºã\n> \n> æ­£ç¡®çåæ³æ¯ç´æ¥æ§è¡ nginx å¯æ§è¡æä»¶ï¼å¹¶ä¸è¦æ±ä»¥åå°å½¢å¼è¿è¡ãæ¯å¦ï¼\n> \n> CMD ["nginx", "-g", "daemon off;"]\n> \n> \n> 1\n\n\n# ENTRYPOINT å¥å£ç¹\n\nENTRYPOINT çæ ¼å¼å RUN æä»¤æ ¼å¼ä¸æ ·ï¼åä¸º exec æ ¼å¼å shell æ ¼å¼ã\n\nENTRYPOINT çç®çå CMD ä¸æ ·ï¼é½æ¯å¨æå®å®¹å¨ä¸»è¿ç¨å¯å¨å½ä»¤ååæ°ãENTRYPOINT å¨è¿è¡æ¶ä¹å¯ä»¥æ¿ä»£ï¼ä¸è¿æ¯ CMD è¦ç¥æ¾ç¹çï¼éè¦éè¿ docker run çåæ° --entrypoint æ¥æå®ã\n\nå½æå®äº ENTRYPOINT åï¼CMD çå«ä¹å°±åçäºæ¹åï¼ä¸åæ¯ç´æ¥çè¿è¡å¶å½ä»¤ï¼èæ¯å° CMD çåå®¹ä½ä¸ºåæ°ä¼ ç» ENTRYPOINT æä»¤ï¼æ¢å¥è¯è¯´å®éæ§è¡æ¶ï¼å°åä¸ºï¼\n\n<ENTRYPOINT> "<CMD>"\n\n\n1\n\n\né£ä¹æäº CMD åï¼ä¸ºä»ä¹è¿è¦æ ENTRYPOINT å¢ï¼è¿ç§ <ENTRYPOINT> "<CMD>" æä»ä¹å¥½å¤ä¹ï¼è®©æä»¬æ¥çä¸é¢çåºæ¯ã\n\n# åºæ¯ï¼è®©éååæåå½ä»¤ä¸æ ·ä½¿ç¨\n\nåè®¾æä»¬éè¦ä¸ä¸ªå¾ç¥èªå·±å½åå¬ç½ IP çéåï¼é£ä¹å¯ä»¥åç¨ CMD æ¥å®ç°ï¼\n\nFROM ubuntu:18.04\nRUN apt-get update \\\n    && apt-get install -y curl \\\n    && rm -rf /var/lib/apt/lists/*\nCMD [ "curl", "-s", "http://myip.ipip.net" ]\n\n\n1\n2\n3\n4\n5\n\n\nåå¦æä»¬ä½¿ç¨ docker build -t myip . æ¥æå»ºéåçè¯ï¼å¦ææä»¬éè¦æ¥è¯¢å½åå¬ç½ IPï¼åªéè¦æ§è¡ï¼\n\n$ docker run myip\nå½å IPï¼61.148.226.66 æ¥èªï¼åäº¬å¸ èé\n\n\n1\n2\n\n\nå¯ï¼è¿ä¹çèµ·æ¥å¥½åå¯ä»¥ç´æ¥æéåå½åå½ä»¤ä½¿ç¨äºï¼ä¸è¿å½ä»¤æ»æåæ°ï¼å¦ææä»¬å¸æå åæ°å¢ï¼æ¯å¦ä»ä¸é¢ç CMD ä¸­å¯ä»¥çå°å®è´¨çå½ä»¤æ¯ curlï¼é£ä¹å¦ææä»¬å¸ææ¾ç¤º HTTP å¤´ä¿¡æ¯ï¼å°±éè¦å ä¸ -i åæ°ãé£ä¹æä»¬å¯ä»¥ç´æ¥å  -i åæ°ç» docker run myip ä¹ï¼\n\n$ docker run myip -i\ndocker: Error response from daemon: invalid header field value "oci runtime error: container_linux.go:247: starting container process caused \\"exec: \\\\\\"-i\\\\\\": executable file not found in $PATH\\"\\n".\n\n\n1\n2\n\n\næä»¬å¯ä»¥çå°å¯æ§è¡æä»¶æ¾ä¸å°çæ¥éï¼executable file not foundãä¹åæä»¬è¯´è¿ï¼è·å¨éåååé¢çæ¯ commandï¼è¿è¡æ¶ä¼æ¿æ¢ CMD çé»è®¤å¼ãå æ­¤è¿éç -i æ¿æ¢äºåæ¥ç CMDï¼èä¸æ¯æ·»å å¨åæ¥ç curl -s http://myip.ipip.net åé¢ãè -i æ ¹æ¬ä¸æ¯å½ä»¤ï¼æä»¥èªç¶æ¾ä¸å°ã\n\né£ä¹å¦ææä»¬å¸æå å¥ -i è¿åæ°ï¼æä»¬å°±å¿é¡»éæ°å®æ´çè¾å¥è¿ä¸ªå½ä»¤ï¼\n\n$ docker run myip curl -s http://myip.ipip.net -i\n\n\n1\n\n\nè¿æ¾ç¶ä¸æ¯å¾å¥½çè§£å³æ¹æ¡ï¼èä½¿ç¨ ENTRYPOINT å°±å¯ä»¥è§£å³è¿ä¸ªé®é¢ãç°å¨æä»¬éæ°ç¨ ENTRYPOINT æ¥å®ç°è¿ä¸ªéåï¼\n\nFROM ubuntu:18.04\nRUN apt-get update \\\n    && apt-get install -y curl \\\n    && rm -rf /var/lib/apt/lists/*\nENTRYPOINT [ "curl", "-s", "http://myip.ipip.net" ]\n\n\n1\n2\n3\n4\n5\n\n\nè¿æ¬¡æä»¬åæ¥å°è¯ç´æ¥ä½¿ç¨ docker run myip -iï¼\n\n$ docker run myip\nå½å IPï¼61.148.226.66 æ¥èªï¼åäº¬å¸ èé\n\n$ docker run myip -i\nHTTP/1.1 200 OK\nServer: nginx/1.8.0\nDate: Tue, 22 Nov 2016 05:12:40 GMT\nContent-Type: text/html; charset=UTF-8\nVary: Accept-Encoding\nX-Powered-By: PHP/5.6.24-1~dotdeb+7.1\nX-Cache: MISS from cache-2\nX-Cache-Lookup: MISS from cache-2:80\nX-Cache: MISS from proxy-2_6\nTransfer-Encoding: chunked\nVia: 1.1 cache-2:80, 1.1 proxy-2_6:8006\nConnection: keep-alive\n\nå½å IPï¼61.148.226.66 æ¥èªï¼åäº¬å¸ èé\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nå¯ä»¥çå°ï¼è¿æ¬¡æåäºãè¿æ¯å ä¸ºå½å­å¨ ENTRYPOINT åï¼CMD çåå®¹å°ä¼ä½ä¸ºåæ°ä¼ ç» ENTRYPOINTï¼èè¿é -i å°±æ¯æ°ç CMDï¼å æ­¤ä¼ä½ä¸ºåæ°ä¼ ç» curlï¼ä»èè¾¾å°äºæä»¬é¢æçææã\n\næ»ç»\n\n>  * Dockfileä¸­ç CMD æä»¤ å ENTRYPOINT æä»¤ ä½ç¨ä¸æ ·ï¼é½æ¯ç¨äºå®ä¹å®¹å¨ä¸»è¿ç¨çå¯å¨å½ä»¤\n>  * Dockfileä¸­å¯ä»¥å®ä¹å¤æ¡ CMD æä»¤ ï¼ä»æåä¸ä¸ªçæï¼ENTRYPOINT æä»¤ä¹ä¸æ ·\n>  * CMD æä»¤åENTRYPOINT æä»¤åæ¶å­å¨æ¶ï¼CMDæä»¤æå®çå½ä»¤ä¼è¢«å½åENTRYPOINT æä»¤æå®å½ä»¤çåæ°ï¼å³ <ENTRYPOINT> "<CMD>"\n>  * docker run å½ä»¤åè¿½å ç command å¯ä»¥è¦çCMDæä»¤æå®çå½ä»¤ï¼å¦æä¸å­å¨CMD æä»¤å°±æ¯æ°å®ä¹ä¸ä¸ªï¼\n>  * dockker run å½ä»¤åè¿½å ç command ä¹å¯ä»¥è¦ç ENTRYPOINT æä»¤æå®çå½ä»¤ï¼ä¸è¿è¦å  --entrypointéé¡¹ï¼å¦æä¸å­å¨ENTRYPOINT æä»¤å°±æ¯æ°å®ä¹ä¸ä¸ªï¼\n\n\n# ENV è®¾ç½®ç¯å¢åé\n\næ ¼å¼æä¸¤ç§ï¼\n\n * ENV <key> <value>\n * ENV <key1>=<value1> <key2>=<value2>...\n\nè¿ä¸ªæä»¤å¾ç®åï¼å°±æ¯è®¾ç½®ç¯å¢åéèå·²ï¼æ è®ºæ¯åé¢çå¶å®æä»¤ï¼å¦ RUNï¼è¿æ¯è¿è¡æ¶çåºç¨ï¼é½å¯ä»¥ç´æ¥ä½¿ç¨è¿éå®ä¹çç¯å¢åéã\n\nENV VERSION=1.0 DEBUG=on \\\n    NAME="Happy Feet"\n\n\n1\n2\n\n\nè¿ä¸ªä¾å­ä¸­æ¼ç¤ºäºå¦ä½æ¢è¡ï¼ä»¥åå¯¹å«æç©ºæ ¼çå¼ç¨åå¼å·æ¬èµ·æ¥çåæ³ï¼è¿å Shell ä¸çè¡ä¸ºæ¯ä¸è´çã\n\nä¸åæä»¤å¯ä»¥æ¯æç¯å¢åéå±å¼ï¼ ADDãCOPYãENVãEXPOSEãFROMãLABELãUSERãWORKDIRãVOLUMEãSTOPSIGNALãONBUILDãRUNã\n\néè¿ç¯å¢åéï¼æä»¬å¯ä»¥è®©ä¸ä»½ Dockerfile å¶ä½æ´å¤çéåï¼åªéä½¿ç¨ä¸åçç¯å¢åéå³å¯ã\n\n\n# ARG æå»ºåæ°\n\næ ¼å¼ï¼ARG <åæ°å>[=<é»è®¤å¼>]\n\næå»ºåæ°å ENV çææä¸æ ·ï¼é½æ¯è®¾ç½®ç¯å¢åéãæä¸åçæ¯ï¼ARG æè®¾ç½®çæå»ºç¯å¢çç¯å¢åéï¼å¨å°æ¥å®¹å¨è¿è¡æ¶æ¯ä¸ä¼å­å¨è¿äºç¯å¢åéçãä½æ¯ä¸è¦å æ­¤å°±ä½¿ç¨ ARG ä¿å­å¯ç ä¹ç±»çä¿¡æ¯ï¼å ä¸º docker history è¿æ¯å¯ä»¥çå°ææå¼çã\n\nDockerfile ä¸­ç ARG æä»¤æ¯å®ä¹åæ°åç§°ï¼ä»¥åå®ä¹å¶é»è®¤å¼ãè¯¥é»è®¤å¼å¯ä»¥å¨æå»ºå½ä»¤ docker build ä¸­ç¨ --build-arg <åæ°å>=<å¼> æ¥è¦çã\n\nçµæ´»çä½¿ç¨ ARG æä»¤ï¼è½å¤å¨ä¸ä¿®æ¹ Dockerfile çæåµä¸ï¼æå»ºåºä¸åçéåã\n\n\n# VOLUME å®ä¹å¿åå·\n\næ ¼å¼ä¸ºï¼\n\n * VOLUME ["<è·¯å¾1>", "<è·¯å¾2>"...]\n * VOLUME <è·¯å¾>\n\nä¹åæä»¬è¯´è¿ï¼å®¹å¨è¿è¡æ¶åºè¯¥å°½éä¿æå®¹å¨å­å¨å±ä¸åçåæä½ï¼å¯¹äºæ°æ®åºç±»éè¦ä¿å­å¨ææ°æ®çåºç¨ï¼å¶æ°æ®åºæä»¶åºè¯¥ä¿å­äºå·(volume)ä¸­ãä¸ºäºé²æ­¢è¿è¡æ¶ç¨æ·å¿è®°å°å¨ææä»¶æä¿å­ç®å½æè½½ä¸ºå·ï¼å¨ Dockerfile ä¸­ï¼æä»¬å¯ä»¥äºåæå®æäºç®å½æè½½ä¸ºå¿åå·ï¼è¿æ ·å¨è¿è¡æ¶å¦æç¨æ·ä¸æå®æè½½ï¼å¶åºç¨ä¹å¯ä»¥æ­£å¸¸è¿è¡ï¼ä¸ä¼åå®¹å¨å­å¨å±åå¥å¤§éæ°æ®ã\n\nVOLUME /data\n\n\n1\n\n\nè¿éç /data ç®å½å°±ä¼å¨å®¹å¨è¿è¡æ¶èªå¨æè½½ä¸ºå¿åå·ï¼ä»»ä½å /data ä¸­åå¥çä¿¡æ¯é½ä¸ä¼è®°å½è¿å®¹å¨å­å¨å±ï¼ä»èä¿è¯äºå®¹å¨å­å¨å±çæ ç¶æåãå½ç¶ï¼è¿è¡å®¹å¨æ¶å¯ä»¥è¦çè¿ä¸ªæè½½è®¾ç½®ãæ¯å¦ï¼\n\n$ docker run -d -v mydata:/data xxxx\n\n\n1\n\n\nå¨è¿è¡å½ä»¤ä¸­ï¼å°±ä½¿ç¨äº mydata è¿ä¸ªå½åå·æè½½å°äº /data è¿ä¸ªä½ç½®ï¼æ¿ä»£äº Dockerfile ä¸­å®ä¹çå¿åå·çæè½½éç½®ã\n\n\n# EXPOSE æ´é²ç«¯å£\n\næ ¼å¼ä¸º EXPOSE <ç«¯å£1> [<ç«¯å£2>...]ã\n\nEXPOSE æä»¤æ¯å£°æå®¹å¨è¿è¡æ¶æä¾æå¡çç«¯å£ï¼è¿åªæ¯ä¸ä¸ªå£°æï¼å¨å®¹å¨è¿è¡æ¶å¹¶ä¸ä¼å ä¸ºè¿ä¸ªå£°æåºç¨å°±ä¼å¼å¯è¿ä¸ªç«¯å£çæå¡ãå¨ Dockerfile ä¸­åå¥è¿æ ·çå£°ææä¸¤ä¸ªå¥½å¤ï¼ä¸ä¸ªæ¯å¸®å©éåä½¿ç¨èçè§£è¿ä¸ªéåæå¡çå®æ¤ç«¯å£ï¼ä»¥æ¹ä¾¿éç½®æ å°ï¼å¦ä¸ä¸ªç¨å¤åæ¯å¨è¿è¡æ¶ä½¿ç¨éæºç«¯å£æ å°æ¶ï¼ä¹å°±æ¯ docker run -P æ¶ï¼ä¼èªå¨éæºæ å° EXPOSE çç«¯å£ã\n\nè¦å° EXPOSE åå¨è¿è¡æ¶ä½¿ç¨ -p <å®¿ä¸»ç«¯å£>:<å®¹å¨ç«¯å£> åºåå¼æ¥ã-pï¼æ¯æ å°å®¿ä¸»ç«¯å£åå®¹å¨ç«¯å£ï¼æ¢å¥è¯è¯´ï¼å°±æ¯å°å®¹å¨çå¯¹åºç«¯å£æå¡å¬å¼ç»å¤çè®¿é®ï¼è EXPOSE ä»ä»æ¯å£°æå®¹å¨æç®ä½¿ç¨ä»ä¹ç«¯å£èå·²ï¼å¹¶ä¸ä¼èªå¨å¨å®¿ä¸»è¿è¡ç«¯å£æ å°ã\n\n\n# WORKDIR æå®å·¥ä½ç®å½\n\næ ¼å¼ä¸º WORKDIR <å·¥ä½ç®å½è·¯å¾>ã\n\nä½¿ç¨ WORKDIR æä»¤å¯ä»¥æ¥æå®å·¥ä½ç®å½ï¼æèç§°ä¸ºå½åç®å½ï¼ï¼ä»¥ååå±çå½åç®å½å°±è¢«æ¹ä¸ºæå®çç®å½ï¼å¦æè¯¥ç®å½ä¸å­å¨ï¼WORKDIR ä¼å¸®ä½ å»ºç«ç®å½ã\n\nä¹åæå°ä¸äºåå­¦èå¸¸ç¯çéè¯¯æ¯æ Dockerfile ç­åäº Shell èæ¬æ¥ä¹¦åï¼è¿ç§éè¯¯ççè§£è¿å¯è½ä¼å¯¼è´åºç°ä¸é¢è¿æ ·çéè¯¯ï¼\n\nRUN cd /app\nRUN echo "hello" > world.txt\n\n\n1\n2\n\n\nå¦æå°è¿ä¸ª Dockerfile è¿è¡æå»ºéåè¿è¡åï¼ä¼åç°æ¾ä¸å° /app/world.txt æä»¶ï¼æèå¶åå®¹ä¸æ¯ helloãåå å¶å®å¾ç®åï¼å¨ Shell ä¸­ï¼è¿ç»­ä¸¤è¡æ¯åä¸ä¸ªè¿ç¨æ§è¡ç¯å¢ï¼å æ­¤åä¸ä¸ªå½ä»¤ä¿®æ¹çåå­ç¶æï¼ä¼ç´æ¥å½±ååä¸ä¸ªå½ä»¤ï¼èå¨ Dockerfile ä¸­ï¼è¿ä¸¤è¡ RUN å½ä»¤çæ§è¡ç¯å¢æ ¹æ¬ä¸åï¼æ¯ä¸¤ä¸ªå®å¨ä¸åçå®¹å¨ãè¿å°±æ¯å¯¹ Dockerfile æå»ºåå±å­å¨çæ¦å¿µä¸äºè§£æå¯¼è´çéè¯¯ã\n\nä¹åè¯´è¿æ¯ä¸ä¸ª RUN é½æ¯å¯å¨ä¸ä¸ªå®¹å¨ãæ§è¡å½ä»¤ãç¶åæäº¤å­å¨å±æä»¶åæ´ãç¬¬ä¸å± RUN cd /app çæ§è¡ä»ä»æ¯å½åè¿ç¨çå·¥ä½ç®å½åæ´ï¼ä¸ä¸ªåå­ä¸çååèå·²ï¼å¶ç»æä¸ä¼é æä»»ä½æä»¶åæ´ãèå°ç¬¬äºå±çæ¶åï¼å¯å¨çæ¯ä¸ä¸ªå¨æ°çå®¹å¨ï¼è·ç¬¬ä¸å±çå®¹å¨æ´å®å¨æ²¡å³ç³»ï¼èªç¶ä¸å¯è½ç»§æ¿åä¸å±æå»ºè¿ç¨ä¸­çåå­ååã\n\nå æ­¤å¦æéè¦æ¹åä»¥ååå±çå·¥ä½ç®å½çä½ç½®ï¼é£ä¹åºè¯¥ä½¿ç¨ WORKDIR æä»¤ã\n\nWORKDIR /app\n\nRUN echo "hello" > world.txt\n\n\n1\n2\n3\n\n\n\n# USER æå®å½åç¨æ·\n\næ ¼å¼ï¼USER <ç¨æ·å>[:<ç¨æ·ç»>]\n\nUSER æä»¤å WORKDIR ç¸ä¼¼ï¼é½æ¯æ¹åç¯å¢ç¶æå¹¶å½±åä»¥åçå±ãWORKDIR æ¯æ¹åå·¥ä½ç®å½ï¼USER åæ¯æ¹åä¹åå±çæ§è¡ RUN, CMD ä»¥å ENTRYPOINT è¿ç±»å½ä»¤çèº«ä»½ã\n\næ³¨æï¼USER åªæ¯å¸®å©ä½ åæ¢å°æå®ç¨æ·èå·²ï¼è¿ä¸ªç¨æ·å¿é¡»æ¯äºåå»ºç«å¥½çï¼å¦åæ æ³åæ¢ã\n\nRUN groupadd -r redis && useradd -r -g redis redis\nUSER redis\nRUN [ "redis-server" ]\n\n\n1\n2\n3\n\n\n\n# LABEL ä¸ºéåæ·»å åæ°æ®\n\nLABEL æä»¤ç¨æ¥ç»éåä»¥é®å¼å¯¹çå½¢å¼æ·»å ä¸äºåæ°æ®ï¼metadataï¼ã\n\nLABEL <key>=<value> <key>=<value> <key>=<value> ...\n\n\n1\n\n\n\n# æ°æ®ç®¡ç\n\n\n\nå¨å®¹å¨ä¸­ç®¡çæ°æ®ä¸»è¦æä¸¤ç§æ¹å¼ï¼\n\n * æ°æ®å·ï¼Volumesï¼\n * æè½½ä¸»æºç®å½ (Bind mounts)\n\n\n# æ°æ®å·\n\næ°æ®å·ï¼Volumesï¼ ï¼Dockerå¨å®¿ä¸»æºæä»¶ç³»ç»é»è®¤å¼è¾çä¸çç©ºé´ï¼é»è®¤ä½äº /var/lib/docker/volumes ç®å½ä¸­ï¼\n\n\n\nç±ä¸å¾å¯ä»¥ç¥éï¼ç®åææContainerçæ°æ®é½ä¿å­å¨äºè¿ä¸ªç®å½ä¸è¾¹ï¼ç±äºæ²¡æå¨åå»ºæ¶æå®å·ï¼æä»¥Dockerå¸®æä»¬é»è®¤åå»ºè®¸å¤å¿åï¼å°±ä¸é¢è¿ä¸å å¾é¿IDçåå­ï¼å·ã\n\n\n# åå»ºä¸ä¸ªæ°æ®å·ï¼å·åæ°æ®å·ï¼\n\n$ docker volume create my-vol\n\n\n1\n\n\næ¥çææç æ°æ®å·\n\n$ docker volume ls\n\nDRIVER              VOLUME NAME\nlocal               my-vol\n\n\n1\n2\n3\n4\n\n\nå¨ä¸»æºéä½¿ç¨ä»¥ä¸å½ä»¤å¯ä»¥æ¥çæå® æ°æ®å· çä¿¡æ¯\n\n$ docker volume inspect my-vol\n[\n    {\n        "Driver": "local",\n        "Labels": {},\n        "Mountpoint": "/var/lib/docker/volumes/my-vol/_data",\n        "Name": "my-vol",\n        "Options": {},\n        "Scope": "local"\n    }\n]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# å¯å¨ä¸ä¸ªæè½½æ°æ®å·çå®¹å¨\n\nå¨ç¨ docker run å½ä»¤çæ¶åï¼ä½¿ç¨ --mount æ è®°æ¥å° æ°æ®å· æè½½å°å®¹å¨éãå¨ä¸æ¬¡ docker run ä¸­å¯ä»¥æè½½å¤ä¸ª æ°æ®å·ã\n\nä¸é¢åå»ºä¸ä¸ªåä¸º web çå®¹å¨ï¼å¹¶å è½½ä¸ä¸ª æ°æ®å· å°å®¹å¨ç /usr/share/nginx/html ç®å½ã\n\n$ docker run -d -P \\\n    --name web \\\n    # -v my-vol:/usr/share/nginx/html \\\n    --mount source=my-vol,target=/usr/share/nginx/html \\\n    nginx:alpine\n\n\n1\n2\n3\n4\n5\n\n\næ³¨æï¼å¦ææè½½æ°æ®å·æ¶ç´æ¥æå®å®¹å¨ä¸­ç®å½ï¼ä¸æå®æè½½æ°æ®å·åï¼é£ä¹å°±ä¼æå¨ä¸ä¸ªå¿åæ°æ®å·ï¼ä¸ç®¡æ¯å·åæ°æ®å·è¿æ¯å¿åæ°æ®å·ï¼é»è®¤é½ä½äº/var/lib/docker/volume/ä¸­\n\n\n# æ¥çæ°æ®å·çå·ä½ä¿¡æ¯\n\nå¨ä¸»æºéä½¿ç¨ä»¥ä¸å½ä»¤å¯ä»¥æ¥ç web å®¹å¨çä¿¡æ¯\n\n$ docker inspect web\n\n\n1\n\n\næ°æ®å· ä¿¡æ¯å¨ "Mounts" Key ä¸é¢\n\n"Mounts": [\n    {\n        "Type": "volume",\n        "Name": "my-vol",\n        "Source": "/var/lib/docker/volumes/my-vol/_data",\n        "Destination": "/usr/share/nginx/html",\n        "Driver": "local",\n        "Mode": "",\n        "RW": true,\n        "Propagation": ""\n    }\n],\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n\n# å é¤æ°æ®å·\n\n$ docker volume rm my-vol\n\n\n1\n\n\næ°æ®å· æ¯è¢«è®¾è®¡ç¨æ¥æä¹åæ°æ®çï¼å®ççå½å¨æç¬ç«äºå®¹å¨ï¼Docker ä¸ä¼å¨å®¹å¨è¢«å é¤åèªå¨å é¤ æ°æ®å·ãå¦æéè¦å¨å é¤å®¹å¨çåæ¶ç§»é¤æ°æ®å·ãå¯ä»¥å¨å é¤å®¹å¨çæ¶åä½¿ç¨ docker rm -v è¿ä¸ªå½ä»¤ã\n\næ ä¸»çæ°æ®å·å¯è½ä¼å æ®å¾å¤ç©ºé´ï¼è¦æ¸çè¯·ä½¿ç¨ä»¥ä¸å½ä»¤\n\n$ docker volume prune\n\n\n1\n\n\n\n# æè½½ä¸»æºç®å½\n\n\n# æè½½ä¸ä¸ªä¸»æºç®å½ä½ä¸ºæ°æ®å·\n\nä½¿ç¨ --mount æ è®°å¯ä»¥æå®æè½½ä¸ä¸ªæ¬å°ä¸»æºçç®å½å°å®¹å¨ä¸­å»ã\n\n$ docker run -d -P \\\n    --name web \\\n    # -v /src/webapp:/usr/share/nginx/html \\\n    --mount type=bind,source=/src/webapp,target=/usr/share/nginx/html \\\n    nginx:alpine\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çå½ä»¤æè½½ä¸»æºç /src/webapp ç®å½å°å®¹å¨ç /usr/share/nginx/htmlç®å½ãè¿ä¸ªåè½å¨è¿è¡æµè¯çæ¶åååæ¹ä¾¿ï¼æ¯å¦ç¨æ·å¯ä»¥æ¾ç½®ä¸äºç¨åºå°æ¬å°ç®å½ä¸­ï¼æ¥æ¥çå®¹å¨æ¯å¦æ­£å¸¸å·¥ä½ã\n\næ¬å°ç®å½çè·¯å¾å¿é¡»æ¯ç»å¯¹è·¯å¾ï¼ä½¿ç¨ -v åæ°æ¶å¦ææ¬å°ç®å½ä¸å­å¨ Docker ä¼èªå¨ä¸ºä½ åå»ºä¸ä¸ªæä»¶å¤¹ï¼ä½¿ç¨ --mount åæ°æ¶å¦ææ¬å°ç®å½ä¸å­å¨ï¼Docker ä¼æ¥éã\n\nDocker æè½½ä¸»æºç®å½çé»è®¤æéæ¯ è¯»åï¼ç¨æ·ä¹å¯ä»¥éè¿å¢å  readonly æå®ä¸º åªè¯»ã\n\n$ docker run -d -P \\\n    --name web \\\n    # -v /src/webapp:/usr/share/nginx/html:ro \\\n    --mount type=bind,source=/src/webapp,target=/usr/share/nginx/html,readonly \\\n    nginx:alpine\n\n\n1\n2\n3\n4\n5\n\n\nå äº readonly ä¹åï¼å°±æè½½ä¸º åªè¯» äºãå¦æä½ å¨å®¹å¨å /usr/share/nginx/html ç®å½æ°å»ºæä»¶ï¼ä¼æ¾ç¤ºå¦ä¸éè¯¯\n\n/usr/share/nginx/html # touch new.txt\ntouch: new.txt: Read-only file system\n\n\n1\n2\n\n\n\n# æ¥çæ°æ®å·çå·ä½ä¿¡æ¯\n\nå¨ä¸»æºéä½¿ç¨ä»¥ä¸å½ä»¤å¯ä»¥æ¥ç web å®¹å¨çä¿¡æ¯\n\n$ docker inspect web\n\n\n1\n\n\næè½½ä¸»æºç®å½ çéç½®ä¿¡æ¯å¨ "Mounts" Key ä¸é¢\n\n"Mounts": [\n    {\n        "Type": "bind",\n        "Source": "/src/webapp",\n        "Destination": "/usr/share/nginx/html",\n        "Mode": "",\n        "RW": true,\n        "Propagation": "rprivate"\n    }\n],\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n',normalizedContent:'# ä½¿ç¨ dockerfile å®å¶éå\n\ndockerfile æ¯ä¸ä¸ªææ¬æä»¶ï¼å¶ååå«äºä¸æ¡æ¡ç æä»¤(instruction)ï¼æ¯ä¸æ¡æä»¤æå»ºä¸å±ï¼å æ­¤æ¯ä¸æ¡æä»¤çåå®¹ï¼å°±æ¯æè¿°è¯¥å±åºå½å¦ä½æå»ºã\n\n\n# from æå®åºç¡éå\n\næè°å®å¶éåï¼é£ä¸å®æ¯ä»¥ä¸ä¸ªéåä¸ºåºç¡ï¼å¨å¶ä¸è¿è¡å®å¶ãå°±åæä»¬ä¹åè¿è¡äºä¸ä¸ª nginx éåçå®¹å¨ï¼åè¿è¡ä¿®æ¹ä¸æ ·ï¼åºç¡éåæ¯å¿é¡»æå®çãè from å°±æ¯æå® åºç¡éåï¼å æ­¤ä¸ä¸ª dockerfile ä¸­ from æ¯å¿å¤çæä»¤ï¼å¹¶ä¸å¿é¡»æ¯ç¬¬ä¸æ¡æä»¤ã\n\nå¨ docker hub ä¸æéå¸¸å¤çé«è´¨éçå®æ¹éåï¼æå¯ä»¥ç´æ¥æ¿æ¥ä½¿ç¨çæå¡ç±»çéåï¼å¦ nginxãredisãmongoãmysqlãhttpdãphpãtomcat ç­ï¼ä¹æä¸äºæ¹ä¾¿å¼åãæå»ºãè¿è¡åç§è¯­è¨åºç¨çéåï¼å¦ nodeãopenjdkãpythonãrubyãgolang ç­ãå¯ä»¥å¨å¶ä¸­å¯»æ¾ä¸ä¸ªæç¬¦åæä»¬æç»ç®æ çéåä¸ºåºç¡éåè¿è¡å®å¶ã\n\nå¦ææ²¡ææ¾å°å¯¹åºæå¡çéåï¼å®æ¹éåä¸­è¿æä¾äºä¸äºæ´ä¸ºåºç¡çæä½ç³»ç»éåï¼å¦ ubuntuãdebianãcentosãfedoraãalpine ç­ï¼è¿äºæä½ç³»ç»çè½¯ä»¶åºä¸ºæä»¬æä¾äºæ´å¹¿éçæ©å±ç©ºé´ã\n\n\n# run æ§è¡å½ä»¤\n\nrun æä»¤æ¯ç¨æ¥æ§è¡å½ä»¤è¡å½ä»¤çã\n\nå¶æ ¼å¼æä¸¤ç§ï¼\n\n * shell æ ¼å¼ï¼run <å½ä»¤>ï¼å°±åç´æ¥å¨å½ä»¤è¡ä¸­è¾å¥çå½ä»¤ä¸æ ·ã\n\nrun echo \'<h1>hello, docker!</h1>\' > /usr/share/nginx/html/index.html\n\n\n1\n\n * exec æ ¼å¼ï¼run ["å¯æ§è¡æä»¶", "åæ°1", "åæ°2"]ï¼è¿æ´åæ¯å½æ°è°ç¨ä¸­çæ ¼å¼ã\n\nä¹åè¯´è¿ï¼dockerfile ä¸­æ¯ä¸ä¸ªæä»¤é½ä¼å»ºç«ä¸å±ï¼run ä¹ä¸ä¾å¤ãæ¯ä¸ä¸ª run çè¡ä¸ºï¼å°±ååææä»¬æå·¥å»ºç«éåçè¿ç¨ä¸æ ·ï¼æ°å»ºç«ä¸å±ï¼å¨å¶ä¸æ§è¡è¿äºå½ä»¤ï¼æ§è¡ç»æåï¼commit è¿ä¸å±çä¿®æ¹ï¼æææ°çéåã\n\n * éè¯¯ç¤ºä¾\n\nfrom debian:stretch\n\nrun apt-get update\nrun apt-get install -y gcc libc6-dev make wget\nrun wget -o redis.tar.gz "http://download.redis.io/releases/redis-5.0.3.tar.gz"\nrun mkdir -p /usr/src/redis\nrun tar -xzf redis.tar.gz -c /usr/src/redis --strip-components=1\nrun make -c /usr/src/redis\nrun make -c /usr/src/redis install\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢çè¿ç§åæ³ï¼åå»ºäº 7 å±éåãè¿æ¯å®å¨æ²¡ææä¹çï¼èä¸å¾å¤è¿è¡æ¶ä¸éè¦çä¸è¥¿ï¼é½è¢«è£è¿äºéåéï¼æ¯å¦ç¼è¯ç¯å¢ãæ´æ°çè½¯ä»¶åç­ç­ãç»æå°±æ¯äº§çéå¸¸èè¿ãéå¸¸å¤å±çéåï¼ä¸ä»ä»å¢å äºæå»ºé¨ç½²çæ¶é´ï¼ä¹å¾å®¹æåºéã\n\nunion fs æ¯ææå¤§å±æ°éå¶çï¼æ¯å¦ aufsï¼æ¾ç»æ¯æå¤§ä¸å¾è¶è¿ 42 å±ï¼ç°å¨æ¯ä¸å¾è¶è¿ 127 å±ã\n\n * æä½³å®è·µ\n\nfrom debian:stretch\n\nrun set -x; builddeps=\'gcc libc6-dev make wget\' \\\n    && apt-get update \\\n    && apt-get install -y $builddeps \\\n    && wget -o redis.tar.gz "http://download.redis.io/releases/redis-5.0.3.tar.gz" \\\n    && mkdir -p /usr/src/redis \\\n    && tar -xzf redis.tar.gz -c /usr/src/redis --strip-components=1 \\\n    && make -c /usr/src/redis \\\n    && make -c /usr/src/redis install \\\n    && rm -rf /var/lib/apt/lists/* \\\n    && rm redis.tar.gz \\\n    && rm -r /usr/src/redis \\\n    && apt-get purge -y --auto-remove $builddeps\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\né¦åï¼ä¹åææçå½ä»¤åªæä¸ä¸ªç®çï¼å°±æ¯ç¼è¯ãå®è£ redis å¯æ§è¡æä»¶ãå æ­¤æ²¡æå¿è¦å»ºç«å¾å¤å±ï¼è¿åªæ¯ä¸å±çäºæãå¨æ°å dockerfile çæ¶åï¼è¦ç»å¸¸æéèªå·±ï¼è¿å¹¶ä¸æ¯å¨å shell èæ¬ï¼èæ¯å¨å®ä¹æ¯ä¸å±è¯¥å¦ä½æå»ºã\n\nå¹¶ä¸ï¼è¿éä¸ºäºæ ¼å¼åè¿è¿è¡äºæ¢è¡ãdockerfile æ¯æ shell ç±»çè¡å°¾æ·»å  \\ çå½ä»¤æ¢è¡æ¹å¼ï¼ä»¥åè¡é¦ # è¿è¡æ³¨éçæ ¼å¼ã\n\næ­¤å¤ï¼è¿å¯ä»¥çå°è¿ä¸ç»å½ä»¤çæåæ·»å äºæ¸çå·¥ä½çå½ä»¤ï¼å é¤äºä¸ºäºç¼è¯æå»ºæéè¦çè½¯ä»¶ï¼æ¸çäºææä¸è½½ãå±å¼çæä»¶ï¼å¹¶ä¸è¿æ¸çäº apt ç¼å­æä»¶ãè¿æ¯å¾éè¦çä¸æ­¥ï¼æä»¬ä¹åè¯´è¿ï¼éåæ¯å¤å±å­å¨ï¼æ¯ä¸å±çä¸è¥¿å¹¶ä¸ä¼å¨ä¸ä¸å±è¢«å é¤ï¼ä¼ä¸ç´è·éçéåãå æ­¤éåæå»ºæ¶ï¼ä¸å®è¦ç¡®ä¿æ¯ä¸å±åªæ·»å çæ­£éè¦æ·»å çä¸è¥¿ï¼ä»»ä½æ å³çä¸è¥¿é½åºè¯¥æ¸çæã\n\nå¾å¤äºº docker åå­¦èå¶ä½åºå¾èè¿çéåçåå ä¹ä¸ï¼å°±æ¯å¿è®°äºå¨æ¯ä¸å±æå»ºçæåä¸å®è¦æ¸çææ å³æä»¶ã\n\n\n# æå»ºéå\n\nå¨ dockerfile æä»¶æå¨ç®å½æ§è¡ï¼\n\n$ docker build -t nginx:v3 .\nsending build context to docker daemon 2.048 kb\nstep 1 : from nginx\n ---\x3e e43d811ce2f4\nstep 2 : run echo \'<h1>hello, docker!</h1>\' > /usr/share/nginx/html/index.html\n ---\x3e running in 9cdc27646c7b\n ---\x3e 44aa4490ce2c\nremoving intermediate container 9cdc27646c7b\nsuccessfully built 44aa4490ce2c\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä»å½ä»¤çè¾åºç»æä¸­ï¼æä»¬å¯ä»¥æ¸æ°ççå°éåçæå»ºè¿ç¨ãå¨ step 2 ä¸­ï¼run æä»¤å¯å¨äºä¸ä¸ªå®¹å¨ 9cdc27646c7bï¼æ§è¡äºæè¦æ±çå½ä»¤ï¼å¹¶æåæäº¤äºè¿ä¸å± 44aa4490ce2cï¼éåå é¤äºæç¨å°çè¿ä¸ªå®¹å¨ 9cdc27646c7bã\n\nè¿éæä»¬ä½¿ç¨äº docker build å½ä»¤è¿è¡éåæå»ºãå¶æ ¼å¼ä¸ºï¼\n\ndocker build [éé¡¹] <ä¸ä¸æè·¯å¾/url/->\n\n\n1\n\n\nå¨è¿éæä»¬æå®äºæç»éåçåç§° -t nginx:v3\n\n\n# éåæå»ºä¸ä¸æï¼contextï¼\n\nå¦ææ³¨æï¼ä¼çå° docker build å½ä»¤æåæä¸ä¸ª .ã. è¡¨ç¤ºå½åç®å½ï¼è dockerfile å°±å¨å½åç®å½ï¼å æ­¤ä¸å°åå­¦èä»¥ä¸ºè¿ä¸ªè·¯å¾æ¯å¨æå® dockerfile æå¨è·¯å¾ï¼è¿ä¹çè§£å¶å®æ¯ä¸åç¡®çãå¦æå¯¹åºä¸é¢çå½ä»¤æ ¼å¼ï¼ä½ å¯è½ä¼åç°ï¼è¿æ¯å¨æå® ä¸ä¸æè·¯å¾ãé£ä¹ä»ä¹æ¯ä¸ä¸æå¢ï¼\n\né¦åæä»¬è¦çè§£ docker build çå·¥ä½åçãdocker å¨è¿è¡æ¶åä¸º docker å¼æï¼ä¹å°±æ¯æå¡ç«¯å®æ¤è¿ç¨ï¼åå®¢æ·ç«¯å·¥å·ãdocker çå¼ææä¾äºä¸ç» rest apiï¼è¢«ç§°ä¸º docker remote apiï¼èå¦ docker å½ä»¤è¿æ ·çå®¢æ·ç«¯å·¥å·ï¼åæ¯éè¿è¿ç» api ä¸ docker å¼æäº¤äºï¼ä»èå®æåç§åè½ãå æ­¤ï¼è½ç¶è¡¨é¢ä¸æä»¬å¥½åæ¯å¨æ¬æºæ§è¡åç§ docker åè½ï¼ä½å®éä¸ï¼ä¸åé½æ¯ä½¿ç¨çè¿ç¨è°ç¨å½¢å¼å¨æå¡ç«¯ï¼docker å¼æï¼å®æãä¹å ä¸ºè¿ç§ c/s è®¾è®¡ï¼è®©æä»¬æä½è¿ç¨æå¡å¨ç docker å¼æåå¾è½»èæä¸¾ã\n\nå½æä»¬è¿è¡éåæå»ºçæ¶åï¼å¹¶éææå®å¶é½ä¼éè¿ run æä»¤å®æï¼ç»å¸¸ä¼éè¦å°ä¸äºæ¬å°æä»¶å¤å¶è¿éåï¼æ¯å¦éè¿ copy æä»¤ãadd æä»¤ç­ãè docker build å½ä»¤æå»ºéåï¼å¶å®å¹¶éå¨æ¬å°æå»ºï¼èæ¯å¨æå¡ç«¯ï¼ä¹å°±æ¯ docker å¼æä¸­æå»ºçãé£ä¹å¨è¿ç§å®¢æ·ç«¯/æå¡ç«¯çæ¶æä¸­ï¼å¦ä½æè½è®©æå¡ç«¯è·å¾æ¬å°æä»¶å¢ï¼\n\nè¿å°±å¼å¥äºä¸ä¸æçæ¦å¿µãå½æå»ºçæ¶åï¼ç¨æ·ä¼æå®æå»ºéåä¸ä¸æçè·¯å¾ï¼docker build å½ä»¤å¾ç¥è¿ä¸ªè·¯å¾åï¼ä¼å°è·¯å¾ä¸çææåå®¹æåï¼ç¶åä¸ä¼ ç» docker å¼æãè¿æ · docker å¼ææ¶å°è¿ä¸ªä¸ä¸æååï¼å±å¼å°±ä¼è·å¾æå»ºéåæéçä¸åæä»¶ã\n\nå¦æå¨ dockerfile ä¸­è¿ä¹åï¼\n\ncopy ./package.json /app/\n\n\n1\n\n\nå°±è¡¨ç¤ºå¤å¶ ä¸ä¸æï¼contextï¼ ç®å½ä¸ç package.jsonã\n\nå æ­¤ï¼copy è¿ç±»æä»¤ä¸­çæºæä»¶çè·¯å¾é½æ¯ç¸å¯¹è·¯å¾ãè¿ä¹æ¯åå­¦èç»å¸¸ä¼é®çä¸ºä»ä¹ copy ../package.json /app æè copy /opt/xxxx /app æ æ³å·¥ä½çåå ï¼å ä¸ºè¿äºè·¯å¾å·²ç»è¶åºäºä¸ä¸æçèå´ï¼docker å¼ææ æ³è·å¾è¿äºä½ç½®çæä»¶ãå¦æççéè¦é£äºæä»¶ï¼åºè¯¥å°å®ä»¬å¤å¶å°ä¸ä¸æç®å½ä¸­å»ã\n\nç°å¨å°±å¯ä»¥çè§£åæçå½ä»¤ docker build -t nginx:v3 . ä¸­çè¿ä¸ª .ï¼å®éä¸æ¯å¨æå®ä¸ä¸æçç®å½ï¼docker build å½ä»¤ä¼å°è¯¥ç®å½ä¸çåå®¹æåäº¤ç» docker å¼æä»¥å¸®å©æå»ºéåã\n\nå¦æè§å¯ docker build è¾åºï¼æä»¬å¶å®å·²ç»çå°äºè¿ä¸ªåéä¸ä¸æçè¿ç¨ï¼\n\n$ docker build -t nginx:v3 .\nsending build context to docker daemon 2.048 kb\n...\n\n\n1\n2\n3\n\n\nçè§£æå»ºä¸ä¸æå¯¹äºéåæå»ºæ¯å¾éè¦çï¼é¿åç¯ä¸äºä¸åºè¯¥çéè¯¯ãæ¯å¦æäºåå­¦èå¨åç° copy /opt/xxxx /app ä¸å·¥ä½åï¼äºæ¯å¹²èå° dockerfile æ¾å°äºç¡¬çæ ¹ç®å½å»æå»ºï¼ç»æåç° docker build æ§è¡åï¼å¨åéä¸ä¸ªå å gb çä¸è¥¿ï¼æä¸ºç¼æ¢èä¸å¾å®¹ææå»ºå¤±è´¥ãé£æ¯å ä¸ºè¿ç§åæ³æ¯å¨è®© docker build æåæ´ä¸ªç¡¬çï¼è¿æ¾ç¶æ¯ä½¿ç¨éè¯¯ã\n\nä¸è¬æ¥è¯´ï¼åºè¯¥ä¼å° dockerfile ç½®äºä¸ä¸ªç©ºç®å½ä¸ï¼æèé¡¹ç®æ ¹ç®å½ä¸ãå¦æè¯¥ç®å½ä¸æ²¡ææéæä»¶ï¼é£ä¹åºè¯¥ææéæä»¶å¤å¶ä¸ä»½è¿æ¥ãå¦æç®å½ä¸æäºä¸è¥¿ç¡®å®ä¸å¸ææå»ºæ¶ä¼ ç» docker å¼æï¼é£ä¹å¯ä»¥ç¨ .gitignore ä¸æ ·çè¯­æ³åä¸ä¸ª .dockerignoreï¼è¯¥æä»¶æ¯ç¨äºåé¤ä¸éè¦ä½ä¸ºä¸ä¸æä¼ éç» docker å¼æçã\n\nå¨é»è®¤æåµä¸ï¼å¦æä¸é¢å¤æå® dockerfile çè¯ï¼ä¼å°ä¸ä¸æç®å½ä¸çåä¸º dockerfile çæä»¶ä½ä¸º dockerfileãè¿åªæ¯é»è®¤è¡ä¸ºï¼å®éä¸ dockerfile çæä»¶åå¹¶ä¸è¦æ±å¿é¡»ä¸º dockerfileï¼èä¸å¹¶ä¸è¦æ±å¿é¡»ä½äºä¸ä¸æç®å½ä¸­ï¼æ¯å¦å¯ä»¥ç¨ -f ../dockerfile.php åæ°æå®æä¸ªæä»¶ä½ä¸º dockerfileã\n\nå½ç¶ï¼ä¸è¬å¤§å®¶ä¹ æ¯æ§çä¼ä½¿ç¨é»è®¤çæä»¶å dockerfileï¼ä»¥åä¼å°å¶ç½®äºéåæå»ºä¸ä¸æç®å½ä¸­ã\n\n\n# dockerfile æä»¤è¯¦è§£\n\n\n# copy å¤å¶æä»¶\n\næ ¼å¼ï¼\n\n * copy [--chown=<user>:<group>] <æºè·¯å¾>... <ç®æ è·¯å¾>\n * copy [--chown=<user>:<group>] ["<æºè·¯å¾1>",... "<ç®æ è·¯å¾>"]\n\nå run æä»¤ä¸æ ·ï¼ä¹æä¸¤ç§æ ¼å¼ï¼ä¸ç§ç±»ä¼¼äºå½ä»¤è¡ï¼ä¸ç§ç±»ä¼¼äºå½æ°è°ç¨ã\n\ncopy æä»¤å°ä»æå»ºä¸ä¸æç®å½ä¸­ <æºè·¯å¾> çæä»¶/ç®å½å¤å¶å°æ°çä¸å±çéååç <ç®æ è·¯å¾> ä½ç½®ãæ¯å¦ï¼\n\ncopy package.json /usr/src/app/\n\n\n1\n\n\n<æºè·¯å¾> å¯ä»¥æ¯å¤ä¸ªï¼çè³å¯ä»¥æ¯ééç¬¦ï¼å¶ééç¬¦è§åè¦æ»¡è¶³ go ç filepath.match è§åï¼å¦ï¼\n\ncopy hom* /mydir/\ncopy hom?.txt /mydir/\n\n\n1\n2\n\n\n<ç®æ è·¯å¾> å¯ä»¥æ¯å®¹å¨åçç»å¯¹è·¯å¾ï¼ä¹å¯ä»¥æ¯ç¸å¯¹äºå·¥ä½ç®å½çç¸å¯¹è·¯å¾ï¼å·¥ä½ç®å½å¯ä»¥ç¨ workdir æä»¤æ¥æå®ï¼ãç®æ è·¯å¾ä¸éè¦äºååå»ºï¼å¦æç®å½ä¸å­å¨ä¼å¨å¤å¶æä»¶ååè¡åå»ºç¼ºå¤±ç®å½ã\n\næ­¤å¤ï¼è¿éè¦æ³¨æä¸ç¹ï¼ä½¿ç¨ copy æä»¤ï¼æºæä»¶çåç§åæ°æ®é½ä¼ä¿çãæ¯å¦è¯»ãåãæ§è¡æéãæä»¶åæ´æ¶é´ç­ã\n\nå¦ææºè·¯å¾ä¸ºæä»¶å¤¹ï¼å¤å¶çæ¶åä¸æ¯ç´æ¥å¤å¶è¯¥æä»¶å¤¹ï¼èæ¯å°æä»¶å¤¹ä¸­çåå®¹å¤å¶å°ç®æ è·¯å¾ã\n\n\n# add æ´é«çº§çå¤å¶æä»¶\n\nadd æä»¤å copy çæ ¼å¼åæ§è´¨åºæ¬ä¸è´ã\n\nå¦æ <æºè·¯å¾> ä¸ºä¸ä¸ª tar åç¼©æä»¶çè¯ï¼åç¼©æ ¼å¼ä¸º gzip, bzip2 ä»¥å xz çæåµä¸ï¼add æä»¤å°ä¼èªå¨è§£åç¼©è¿ä¸ªåç¼©æä»¶å° <ç®æ è·¯å¾> å»ã\n\nå¨ docker å®æ¹ç dockerfile æä½³å®è·µææ¡£ ä¸­è¦æ±ï¼å°½å¯è½çä½¿ç¨ copyï¼å ä¸º copy çè¯­ä¹å¾æç¡®ï¼å°±æ¯å¤å¶æä»¶èå·²ï¼è add ååå«äºæ´å¤æçåè½ï¼å¶è¡ä¸ºä¹ä¸ä¸å®å¾æ¸æ°ãæéåä½¿ç¨ add çåºåï¼å°±æ¯ææåçéè¦èªå¨è§£åç¼©çåºåã\n\nå¦å¤éè¦æ³¨æçæ¯ï¼add æä»¤ä¼ä»¤éåæå»ºç¼å­å¤±æï¼ä»èå¯è½ä¼ä»¤éåæå»ºåå¾æ¯è¾ç¼æ¢ã\n\nå æ­¤å¨ copy å add æä»¤ä¸­éæ©çæ¶åï¼å¯ä»¥éµå¾ªè¿æ ·çååï¼ææçæä»¶å¤å¶åä½¿ç¨ copy æä»¤ï¼ä»å¨éè¦èªå¨è§£åç¼©çåºåä½¿ç¨ addã\n\n\n# cmd å®¹å¨å¯å¨å½ä»¤\n\ncmd æä»¤ç¨äºæå®å®¹å¨ä¸»è¿ç¨çé»è®¤å¯å¨å½ä»¤ã\n\nç±»ä¼¼äº run æä»¤ï¼ç¨äºè¿è¡ç¨åºï¼ä½äºèè¿è¡çæ¶é´ç¹ä¸å:\n\n * cmd å¨docker run æ¶è¿è¡ã\n * run æ¯å¨ docker buildã\n\ncmd æä»¤çæ ¼å¼å run ç¸ä¼¼ï¼ä¹æ¯ä¸¤ç§æ ¼å¼ï¼\n\n * shell æ ¼å¼ï¼cmd <å½ä»¤>\n * exec æ ¼å¼ï¼cmd ["å¯æ§è¡æä»¶", "åæ°1", "åæ°2"...]\n * åæ°åè¡¨æ ¼å¼ï¼cmd ["åæ°1", "åæ°2"...]ãå¨æå®äº entrypoint æä»¤åï¼ç¨ cmd æå®å·ä½çåæ°ã\n\næ³¨æï¼å¦æ dockerfile ä¸­å¦æå­å¨å¤ä¸ª cmd æä»¤ï¼ä»æåä¸ä¸ªçæã\n\ncmd æä»¤æå®çç¨åºå¯è¢« docker run å½ä»¤è¡åæ°ä¸­æå®è¦è¿è¡çç¨åºæè¦çãæ¯å¦ï¼ubuntu éåé»è®¤ç cmd æ¯ /bin/bashï¼å¦ææä»¬ç´æ¥ docker run -it ubuntu çè¯ï¼ä¼ç´æ¥è¿å¥ bashãæä»¬ä¹å¯ä»¥å¨è¿è¡æ¶æå®è¿è¡å«çå½ä»¤ï¼å¦ docker run -it ubuntu cat /etc/os-releaseãè¿å°±æ¯ç¨ cat /etc/os-release å½ä»¤æ¿æ¢äºé»è®¤ç /bin/bash å½ä»¤äºï¼è¾åºäºç³»ç»çæ¬ä¿¡æ¯ã\n\nå¨æä»¤æ ¼å¼ä¸ï¼ä¸è¬æ¨èä½¿ç¨ exec æ ¼å¼ï¼è¿ç±»æ ¼å¼å¨è§£ææ¶ä¼è¢«è§£æä¸º json æ°ç»ï¼å æ­¤ä¸å®è¦ä½¿ç¨åå¼å· "ï¼èä¸è¦ä½¿ç¨åå¼å·ã\n\nå¦æä½¿ç¨ shell æ ¼å¼çè¯ï¼å®éçå½ä»¤ä¼è¢«åè£ä¸º sh -c çåæ°çå½¢å¼è¿è¡æ§è¡ãæ¯å¦ï¼\n\ncmd echo $home\n\n\n1\n\n\nå¨å®éæ§è¡ä¸­ï¼ä¼å°å¶åæ´ä¸ºï¼\n\ncmd [ "sh", "-c", "echo $home" ]\n\n\n1\n\n\nè¿å°±æ¯ä¸ºä»ä¹æä»¬å¯ä»¥ä½¿ç¨ç¯å¢åéçåå ï¼å ä¸ºè¿äºç¯å¢åéä¼è¢« shell è¿è¡è§£æå¤çã\n\n> æå° cmd å°±ä¸å¾ä¸æå®¹å¨ä¸­åºç¨å¨åå°æ§è¡ååå°æ§è¡çé®é¢ãè¿æ¯åå­¦èå¸¸åºç°çä¸ä¸ªæ··æ·ã\n> \n> docker ä¸æ¯èææºï¼å®¹å¨ä¸­çåºç¨é½åºè¯¥ä»¥åå°æ§è¡ï¼èä¸æ¯åèææºãç©çæºéé¢é£æ ·ï¼ç¨ systemd å»å¯å¨åå°æå¡ï¼å®¹å¨åæ²¡æåå°æå¡çæ¦å¿µã\n> \n> ä¸äºåå­¦èå° cmd åä¸ºï¼\n> \n> cmd service nginx start\n> \n> \n> 1\n> \n> \n> ç¶ååç°å®¹å¨æ§è¡åå°±ç«å³éåºäºãçè³å¨å®¹å¨åå»ä½¿ç¨ systemctl å½ä»¤ç»æå´åç°æ ¹æ¬æ§è¡ä¸äºãè¿å°±æ¯å ä¸ºæ²¡æææç½åå°ãåå°çæ¦å¿µï¼æ²¡æåºåå®¹å¨åèææºçå·®å¼ï¼ä¾æ§å¨ä»¥ä¼ ç»èææºçè§åº¦å»çè§£å®¹å¨ã\n> \n> å¯¹äºå®¹å¨èè¨ï¼å®¹å¨å°±æ¯ä¸ºäºå®¹å¨åçåºç¨ä¸»è¿ç¨èå­å¨çï¼ä¸»è¿ç¨éåºï¼å®¹å¨å°±å¤±å»äºå­å¨çæä¹ï¼ä»èéåºï¼å¶å®è¾å©è¿ç¨ä¸æ¯å®éè¦å³å¿çä¸è¥¿ã\n> \n> ä¾å¦cmd service nginx start ä¼è¢«çè§£ä¸º cmd [ "sh", "-c", "service nginx start"]ï¼å æ­¤ä¸»è¿ç¨å®éä¸æ¯ shãé£ä¹å½ service nginx start å½ä»¤ç»æåï¼sh ä¹å°±ç»æäºï¼sh ä½ä¸ºä¸»è¿ç¨éåºäºï¼èªç¶å°±ä¼ä»¤å®¹å¨éåºã\n> \n> æ­£ç¡®çåæ³æ¯ç´æ¥æ§è¡ nginx å¯æ§è¡æä»¶ï¼å¹¶ä¸è¦æ±ä»¥åå°å½¢å¼è¿è¡ãæ¯å¦ï¼\n> \n> cmd ["nginx", "-g", "daemon off;"]\n> \n> \n> 1\n\n\n# entrypoint å¥å£ç¹\n\nentrypoint çæ ¼å¼å run æä»¤æ ¼å¼ä¸æ ·ï¼åä¸º exec æ ¼å¼å shell æ ¼å¼ã\n\nentrypoint çç®çå cmd ä¸æ ·ï¼é½æ¯å¨æå®å®¹å¨ä¸»è¿ç¨å¯å¨å½ä»¤ååæ°ãentrypoint å¨è¿è¡æ¶ä¹å¯ä»¥æ¿ä»£ï¼ä¸è¿æ¯ cmd è¦ç¥æ¾ç¹çï¼éè¦éè¿ docker run çåæ° --entrypoint æ¥æå®ã\n\nå½æå®äº entrypoint åï¼cmd çå«ä¹å°±åçäºæ¹åï¼ä¸åæ¯ç´æ¥çè¿è¡å¶å½ä»¤ï¼èæ¯å° cmd çåå®¹ä½ä¸ºåæ°ä¼ ç» entrypoint æä»¤ï¼æ¢å¥è¯è¯´å®éæ§è¡æ¶ï¼å°åä¸ºï¼\n\n<entrypoint> "<cmd>"\n\n\n1\n\n\né£ä¹æäº cmd åï¼ä¸ºä»ä¹è¿è¦æ entrypoint å¢ï¼è¿ç§ <entrypoint> "<cmd>" æä»ä¹å¥½å¤ä¹ï¼è®©æä»¬æ¥çä¸é¢çåºæ¯ã\n\n# åºæ¯ï¼è®©éååæåå½ä»¤ä¸æ ·ä½¿ç¨\n\nåè®¾æä»¬éè¦ä¸ä¸ªå¾ç¥èªå·±å½åå¬ç½ ip çéåï¼é£ä¹å¯ä»¥åç¨ cmd æ¥å®ç°ï¼\n\nfrom ubuntu:18.04\nrun apt-get update \\\n    && apt-get install -y curl \\\n    && rm -rf /var/lib/apt/lists/*\ncmd [ "curl", "-s", "http://myip.ipip.net" ]\n\n\n1\n2\n3\n4\n5\n\n\nåå¦æä»¬ä½¿ç¨ docker build -t myip . æ¥æå»ºéåçè¯ï¼å¦ææä»¬éè¦æ¥è¯¢å½åå¬ç½ ipï¼åªéè¦æ§è¡ï¼\n\n$ docker run myip\nå½å ipï¼61.148.226.66 æ¥èªï¼åäº¬å¸ èé\n\n\n1\n2\n\n\nå¯ï¼è¿ä¹çèµ·æ¥å¥½åå¯ä»¥ç´æ¥æéåå½åå½ä»¤ä½¿ç¨äºï¼ä¸è¿å½ä»¤æ»æåæ°ï¼å¦ææä»¬å¸æå åæ°å¢ï¼æ¯å¦ä»ä¸é¢ç cmd ä¸­å¯ä»¥çå°å®è´¨çå½ä»¤æ¯ curlï¼é£ä¹å¦ææä»¬å¸ææ¾ç¤º http å¤´ä¿¡æ¯ï¼å°±éè¦å ä¸ -i åæ°ãé£ä¹æä»¬å¯ä»¥ç´æ¥å  -i åæ°ç» docker run myip ä¹ï¼\n\n$ docker run myip -i\ndocker: error response from daemon: invalid header field value "oci runtime error: container_linux.go:247: starting container process caused \\"exec: \\\\\\"-i\\\\\\": executable file not found in $path\\"\\n".\n\n\n1\n2\n\n\næä»¬å¯ä»¥çå°å¯æ§è¡æä»¶æ¾ä¸å°çæ¥éï¼executable file not foundãä¹åæä»¬è¯´è¿ï¼è·å¨éåååé¢çæ¯ commandï¼è¿è¡æ¶ä¼æ¿æ¢ cmd çé»è®¤å¼ãå æ­¤è¿éç -i æ¿æ¢äºåæ¥ç cmdï¼èä¸æ¯æ·»å å¨åæ¥ç curl -s http://myip.ipip.net åé¢ãè -i æ ¹æ¬ä¸æ¯å½ä»¤ï¼æä»¥èªç¶æ¾ä¸å°ã\n\né£ä¹å¦ææä»¬å¸æå å¥ -i è¿åæ°ï¼æä»¬å°±å¿é¡»éæ°å®æ´çè¾å¥è¿ä¸ªå½ä»¤ï¼\n\n$ docker run myip curl -s http://myip.ipip.net -i\n\n\n1\n\n\nè¿æ¾ç¶ä¸æ¯å¾å¥½çè§£å³æ¹æ¡ï¼èä½¿ç¨ entrypoint å°±å¯ä»¥è§£å³è¿ä¸ªé®é¢ãç°å¨æä»¬éæ°ç¨ entrypoint æ¥å®ç°è¿ä¸ªéåï¼\n\nfrom ubuntu:18.04\nrun apt-get update \\\n    && apt-get install -y curl \\\n    && rm -rf /var/lib/apt/lists/*\nentrypoint [ "curl", "-s", "http://myip.ipip.net" ]\n\n\n1\n2\n3\n4\n5\n\n\nè¿æ¬¡æä»¬åæ¥å°è¯ç´æ¥ä½¿ç¨ docker run myip -iï¼\n\n$ docker run myip\nå½å ipï¼61.148.226.66 æ¥èªï¼åäº¬å¸ èé\n\n$ docker run myip -i\nhttp/1.1 200 ok\nserver: nginx/1.8.0\ndate: tue, 22 nov 2016 05:12:40 gmt\ncontent-type: text/html; charset=utf-8\nvary: accept-encoding\nx-powered-by: php/5.6.24-1~dotdeb+7.1\nx-cache: miss from cache-2\nx-cache-lookup: miss from cache-2:80\nx-cache: miss from proxy-2_6\ntransfer-encoding: chunked\nvia: 1.1 cache-2:80, 1.1 proxy-2_6:8006\nconnection: keep-alive\n\nå½å ipï¼61.148.226.66 æ¥èªï¼åäº¬å¸ èé\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nå¯ä»¥çå°ï¼è¿æ¬¡æåäºãè¿æ¯å ä¸ºå½å­å¨ entrypoint åï¼cmd çåå®¹å°ä¼ä½ä¸ºåæ°ä¼ ç» entrypointï¼èè¿é -i å°±æ¯æ°ç cmdï¼å æ­¤ä¼ä½ä¸ºåæ°ä¼ ç» curlï¼ä»èè¾¾å°äºæä»¬é¢æçææã\n\næ»ç»\n\n>  * dockfileä¸­ç cmd æä»¤ å entrypoint æä»¤ ä½ç¨ä¸æ ·ï¼é½æ¯ç¨äºå®ä¹å®¹å¨ä¸»è¿ç¨çå¯å¨å½ä»¤\n>  * dockfileä¸­å¯ä»¥å®ä¹å¤æ¡ cmd æä»¤ ï¼ä»æåä¸ä¸ªçæï¼entrypoint æä»¤ä¹ä¸æ ·\n>  * cmd æä»¤åentrypoint æä»¤åæ¶å­å¨æ¶ï¼cmdæä»¤æå®çå½ä»¤ä¼è¢«å½åentrypoint æä»¤æå®å½ä»¤çåæ°ï¼å³ <entrypoint> "<cmd>"\n>  * docker run å½ä»¤åè¿½å ç command å¯ä»¥è¦çcmdæä»¤æå®çå½ä»¤ï¼å¦æä¸å­å¨cmd æä»¤å°±æ¯æ°å®ä¹ä¸ä¸ªï¼\n>  * dockker run å½ä»¤åè¿½å ç command ä¹å¯ä»¥è¦ç entrypoint æä»¤æå®çå½ä»¤ï¼ä¸è¿è¦å  --entrypointéé¡¹ï¼å¦æä¸å­å¨entrypoint æä»¤å°±æ¯æ°å®ä¹ä¸ä¸ªï¼\n\n\n# env è®¾ç½®ç¯å¢åé\n\næ ¼å¼æä¸¤ç§ï¼\n\n * env <key> <value>\n * env <key1>=<value1> <key2>=<value2>...\n\nè¿ä¸ªæä»¤å¾ç®åï¼å°±æ¯è®¾ç½®ç¯å¢åéèå·²ï¼æ è®ºæ¯åé¢çå¶å®æä»¤ï¼å¦ runï¼è¿æ¯è¿è¡æ¶çåºç¨ï¼é½å¯ä»¥ç´æ¥ä½¿ç¨è¿éå®ä¹çç¯å¢åéã\n\nenv version=1.0 debug=on \\\n    name="happy feet"\n\n\n1\n2\n\n\nè¿ä¸ªä¾å­ä¸­æ¼ç¤ºäºå¦ä½æ¢è¡ï¼ä»¥åå¯¹å«æç©ºæ ¼çå¼ç¨åå¼å·æ¬èµ·æ¥çåæ³ï¼è¿å shell ä¸çè¡ä¸ºæ¯ä¸è´çã\n\nä¸åæä»¤å¯ä»¥æ¯æç¯å¢åéå±å¼ï¼ addãcopyãenvãexposeãfromãlabelãuserãworkdirãvolumeãstopsignalãonbuildãrunã\n\néè¿ç¯å¢åéï¼æä»¬å¯ä»¥è®©ä¸ä»½ dockerfile å¶ä½æ´å¤çéåï¼åªéä½¿ç¨ä¸åçç¯å¢åéå³å¯ã\n\n\n# arg æå»ºåæ°\n\næ ¼å¼ï¼arg <åæ°å>[=<é»è®¤å¼>]\n\næå»ºåæ°å env çææä¸æ ·ï¼é½æ¯è®¾ç½®ç¯å¢åéãæä¸åçæ¯ï¼arg æè®¾ç½®çæå»ºç¯å¢çç¯å¢åéï¼å¨å°æ¥å®¹å¨è¿è¡æ¶æ¯ä¸ä¼å­å¨è¿äºç¯å¢åéçãä½æ¯ä¸è¦å æ­¤å°±ä½¿ç¨ arg ä¿å­å¯ç ä¹ç±»çä¿¡æ¯ï¼å ä¸º docker history è¿æ¯å¯ä»¥çå°ææå¼çã\n\ndockerfile ä¸­ç arg æä»¤æ¯å®ä¹åæ°åç§°ï¼ä»¥åå®ä¹å¶é»è®¤å¼ãè¯¥é»è®¤å¼å¯ä»¥å¨æå»ºå½ä»¤ docker build ä¸­ç¨ --build-arg <åæ°å>=<å¼> æ¥è¦çã\n\nçµæ´»çä½¿ç¨ arg æä»¤ï¼è½å¤å¨ä¸ä¿®æ¹ dockerfile çæåµä¸ï¼æå»ºåºä¸åçéåã\n\n\n# volume å®ä¹å¿åå·\n\næ ¼å¼ä¸ºï¼\n\n * volume ["<è·¯å¾1>", "<è·¯å¾2>"...]\n * volume <è·¯å¾>\n\nä¹åæä»¬è¯´è¿ï¼å®¹å¨è¿è¡æ¶åºè¯¥å°½éä¿æå®¹å¨å­å¨å±ä¸åçåæä½ï¼å¯¹äºæ°æ®åºç±»éè¦ä¿å­å¨ææ°æ®çåºç¨ï¼å¶æ°æ®åºæä»¶åºè¯¥ä¿å­äºå·(volume)ä¸­ãä¸ºäºé²æ­¢è¿è¡æ¶ç¨æ·å¿è®°å°å¨ææä»¶æä¿å­ç®å½æè½½ä¸ºå·ï¼å¨ dockerfile ä¸­ï¼æä»¬å¯ä»¥äºåæå®æäºç®å½æè½½ä¸ºå¿åå·ï¼è¿æ ·å¨è¿è¡æ¶å¦æç¨æ·ä¸æå®æè½½ï¼å¶åºç¨ä¹å¯ä»¥æ­£å¸¸è¿è¡ï¼ä¸ä¼åå®¹å¨å­å¨å±åå¥å¤§éæ°æ®ã\n\nvolume /data\n\n\n1\n\n\nè¿éç /data ç®å½å°±ä¼å¨å®¹å¨è¿è¡æ¶èªå¨æè½½ä¸ºå¿åå·ï¼ä»»ä½å /data ä¸­åå¥çä¿¡æ¯é½ä¸ä¼è®°å½è¿å®¹å¨å­å¨å±ï¼ä»èä¿è¯äºå®¹å¨å­å¨å±çæ ç¶æåãå½ç¶ï¼è¿è¡å®¹å¨æ¶å¯ä»¥è¦çè¿ä¸ªæè½½è®¾ç½®ãæ¯å¦ï¼\n\n$ docker run -d -v mydata:/data xxxx\n\n\n1\n\n\nå¨è¿è¡å½ä»¤ä¸­ï¼å°±ä½¿ç¨äº mydata è¿ä¸ªå½åå·æè½½å°äº /data è¿ä¸ªä½ç½®ï¼æ¿ä»£äº dockerfile ä¸­å®ä¹çå¿åå·çæè½½éç½®ã\n\n\n# expose æ´é²ç«¯å£\n\næ ¼å¼ä¸º expose <ç«¯å£1> [<ç«¯å£2>...]ã\n\nexpose æä»¤æ¯å£°æå®¹å¨è¿è¡æ¶æä¾æå¡çç«¯å£ï¼è¿åªæ¯ä¸ä¸ªå£°æï¼å¨å®¹å¨è¿è¡æ¶å¹¶ä¸ä¼å ä¸ºè¿ä¸ªå£°æåºç¨å°±ä¼å¼å¯è¿ä¸ªç«¯å£çæå¡ãå¨ dockerfile ä¸­åå¥è¿æ ·çå£°ææä¸¤ä¸ªå¥½å¤ï¼ä¸ä¸ªæ¯å¸®å©éåä½¿ç¨èçè§£è¿ä¸ªéåæå¡çå®æ¤ç«¯å£ï¼ä»¥æ¹ä¾¿éç½®æ å°ï¼å¦ä¸ä¸ªç¨å¤åæ¯å¨è¿è¡æ¶ä½¿ç¨éæºç«¯å£æ å°æ¶ï¼ä¹å°±æ¯ docker run -p æ¶ï¼ä¼èªå¨éæºæ å° expose çç«¯å£ã\n\nè¦å° expose åå¨è¿è¡æ¶ä½¿ç¨ -p <å®¿ä¸»ç«¯å£>:<å®¹å¨ç«¯å£> åºåå¼æ¥ã-pï¼æ¯æ å°å®¿ä¸»ç«¯å£åå®¹å¨ç«¯å£ï¼æ¢å¥è¯è¯´ï¼å°±æ¯å°å®¹å¨çå¯¹åºç«¯å£æå¡å¬å¼ç»å¤çè®¿é®ï¼è expose ä»ä»æ¯å£°æå®¹å¨æç®ä½¿ç¨ä»ä¹ç«¯å£èå·²ï¼å¹¶ä¸ä¼èªå¨å¨å®¿ä¸»è¿è¡ç«¯å£æ å°ã\n\n\n# workdir æå®å·¥ä½ç®å½\n\næ ¼å¼ä¸º workdir <å·¥ä½ç®å½è·¯å¾>ã\n\nä½¿ç¨ workdir æä»¤å¯ä»¥æ¥æå®å·¥ä½ç®å½ï¼æèç§°ä¸ºå½åç®å½ï¼ï¼ä»¥ååå±çå½åç®å½å°±è¢«æ¹ä¸ºæå®çç®å½ï¼å¦æè¯¥ç®å½ä¸å­å¨ï¼workdir ä¼å¸®ä½ å»ºç«ç®å½ã\n\nä¹åæå°ä¸äºåå­¦èå¸¸ç¯çéè¯¯æ¯æ dockerfile ç­åäº shell èæ¬æ¥ä¹¦åï¼è¿ç§éè¯¯ççè§£è¿å¯è½ä¼å¯¼è´åºç°ä¸é¢è¿æ ·çéè¯¯ï¼\n\nrun cd /app\nrun echo "hello" > world.txt\n\n\n1\n2\n\n\nå¦æå°è¿ä¸ª dockerfile è¿è¡æå»ºéåè¿è¡åï¼ä¼åç°æ¾ä¸å° /app/world.txt æä»¶ï¼æèå¶åå®¹ä¸æ¯ helloãåå å¶å®å¾ç®åï¼å¨ shell ä¸­ï¼è¿ç»­ä¸¤è¡æ¯åä¸ä¸ªè¿ç¨æ§è¡ç¯å¢ï¼å æ­¤åä¸ä¸ªå½ä»¤ä¿®æ¹çåå­ç¶æï¼ä¼ç´æ¥å½±ååä¸ä¸ªå½ä»¤ï¼èå¨ dockerfile ä¸­ï¼è¿ä¸¤è¡ run å½ä»¤çæ§è¡ç¯å¢æ ¹æ¬ä¸åï¼æ¯ä¸¤ä¸ªå®å¨ä¸åçå®¹å¨ãè¿å°±æ¯å¯¹ dockerfile æå»ºåå±å­å¨çæ¦å¿µä¸äºè§£æå¯¼è´çéè¯¯ã\n\nä¹åè¯´è¿æ¯ä¸ä¸ª run é½æ¯å¯å¨ä¸ä¸ªå®¹å¨ãæ§è¡å½ä»¤ãç¶åæäº¤å­å¨å±æä»¶åæ´ãç¬¬ä¸å± run cd /app çæ§è¡ä»ä»æ¯å½åè¿ç¨çå·¥ä½ç®å½åæ´ï¼ä¸ä¸ªåå­ä¸çååèå·²ï¼å¶ç»æä¸ä¼é æä»»ä½æä»¶åæ´ãèå°ç¬¬äºå±çæ¶åï¼å¯å¨çæ¯ä¸ä¸ªå¨æ°çå®¹å¨ï¼è·ç¬¬ä¸å±çå®¹å¨æ´å®å¨æ²¡å³ç³»ï¼èªç¶ä¸å¯è½ç»§æ¿åä¸å±æå»ºè¿ç¨ä¸­çåå­ååã\n\nå æ­¤å¦æéè¦æ¹åä»¥ååå±çå·¥ä½ç®å½çä½ç½®ï¼é£ä¹åºè¯¥ä½¿ç¨ workdir æä»¤ã\n\nworkdir /app\n\nrun echo "hello" > world.txt\n\n\n1\n2\n3\n\n\n\n# user æå®å½åç¨æ·\n\næ ¼å¼ï¼user <ç¨æ·å>[:<ç¨æ·ç»>]\n\nuser æä»¤å workdir ç¸ä¼¼ï¼é½æ¯æ¹åç¯å¢ç¶æå¹¶å½±åä»¥åçå±ãworkdir æ¯æ¹åå·¥ä½ç®å½ï¼user åæ¯æ¹åä¹åå±çæ§è¡ run, cmd ä»¥å entrypoint è¿ç±»å½ä»¤çèº«ä»½ã\n\næ³¨æï¼user åªæ¯å¸®å©ä½ åæ¢å°æå®ç¨æ·èå·²ï¼è¿ä¸ªç¨æ·å¿é¡»æ¯äºåå»ºç«å¥½çï¼å¦åæ æ³åæ¢ã\n\nrun groupadd -r redis && useradd -r -g redis redis\nuser redis\nrun [ "redis-server" ]\n\n\n1\n2\n3\n\n\n\n# label ä¸ºéåæ·»å åæ°æ®\n\nlabel æä»¤ç¨æ¥ç»éåä»¥é®å¼å¯¹çå½¢å¼æ·»å ä¸äºåæ°æ®ï¼metadataï¼ã\n\nlabel <key>=<value> <key>=<value> <key>=<value> ...\n\n\n1\n\n\n\n# æ°æ®ç®¡ç\n\n\n\nå¨å®¹å¨ä¸­ç®¡çæ°æ®ä¸»è¦æä¸¤ç§æ¹å¼ï¼\n\n * æ°æ®å·ï¼volumesï¼\n * æè½½ä¸»æºç®å½ (bind mounts)\n\n\n# æ°æ®å·\n\næ°æ®å·ï¼volumesï¼ ï¼dockerå¨å®¿ä¸»æºæä»¶ç³»ç»é»è®¤å¼è¾çä¸çç©ºé´ï¼é»è®¤ä½äº /var/lib/docker/volumes ç®å½ä¸­ï¼\n\n\n\nç±ä¸å¾å¯ä»¥ç¥éï¼ç®åææcontainerçæ°æ®é½ä¿å­å¨äºè¿ä¸ªç®å½ä¸è¾¹ï¼ç±äºæ²¡æå¨åå»ºæ¶æå®å·ï¼æä»¥dockerå¸®æä»¬é»è®¤åå»ºè®¸å¤å¿åï¼å°±ä¸é¢è¿ä¸å å¾é¿idçåå­ï¼å·ã\n\n\n# åå»ºä¸ä¸ªæ°æ®å·ï¼å·åæ°æ®å·ï¼\n\n$ docker volume create my-vol\n\n\n1\n\n\næ¥çææç æ°æ®å·\n\n$ docker volume ls\n\ndriver              volume name\nlocal               my-vol\n\n\n1\n2\n3\n4\n\n\nå¨ä¸»æºéä½¿ç¨ä»¥ä¸å½ä»¤å¯ä»¥æ¥çæå® æ°æ®å· çä¿¡æ¯\n\n$ docker volume inspect my-vol\n[\n    {\n        "driver": "local",\n        "labels": {},\n        "mountpoint": "/var/lib/docker/volumes/my-vol/_data",\n        "name": "my-vol",\n        "options": {},\n        "scope": "local"\n    }\n]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# å¯å¨ä¸ä¸ªæè½½æ°æ®å·çå®¹å¨\n\nå¨ç¨ docker run å½ä»¤çæ¶åï¼ä½¿ç¨ --mount æ è®°æ¥å° æ°æ®å· æè½½å°å®¹å¨éãå¨ä¸æ¬¡ docker run ä¸­å¯ä»¥æè½½å¤ä¸ª æ°æ®å·ã\n\nä¸é¢åå»ºä¸ä¸ªåä¸º web çå®¹å¨ï¼å¹¶å è½½ä¸ä¸ª æ°æ®å· å°å®¹å¨ç /usr/share/nginx/html ç®å½ã\n\n$ docker run -d -p \\\n    --name web \\\n    # -v my-vol:/usr/share/nginx/html \\\n    --mount source=my-vol,target=/usr/share/nginx/html \\\n    nginx:alpine\n\n\n1\n2\n3\n4\n5\n\n\næ³¨æï¼å¦ææè½½æ°æ®å·æ¶ç´æ¥æå®å®¹å¨ä¸­ç®å½ï¼ä¸æå®æè½½æ°æ®å·åï¼é£ä¹å°±ä¼æå¨ä¸ä¸ªå¿åæ°æ®å·ï¼ä¸ç®¡æ¯å·åæ°æ®å·è¿æ¯å¿åæ°æ®å·ï¼é»è®¤é½ä½äº/var/lib/docker/volume/ä¸­\n\n\n# æ¥çæ°æ®å·çå·ä½ä¿¡æ¯\n\nå¨ä¸»æºéä½¿ç¨ä»¥ä¸å½ä»¤å¯ä»¥æ¥ç web å®¹å¨çä¿¡æ¯\n\n$ docker inspect web\n\n\n1\n\n\næ°æ®å· ä¿¡æ¯å¨ "mounts" key ä¸é¢\n\n"mounts": [\n    {\n        "type": "volume",\n        "name": "my-vol",\n        "source": "/var/lib/docker/volumes/my-vol/_data",\n        "destination": "/usr/share/nginx/html",\n        "driver": "local",\n        "mode": "",\n        "rw": true,\n        "propagation": ""\n    }\n],\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n\n# å é¤æ°æ®å·\n\n$ docker volume rm my-vol\n\n\n1\n\n\næ°æ®å· æ¯è¢«è®¾è®¡ç¨æ¥æä¹åæ°æ®çï¼å®ççå½å¨æç¬ç«äºå®¹å¨ï¼docker ä¸ä¼å¨å®¹å¨è¢«å é¤åèªå¨å é¤ æ°æ®å·ãå¦æéè¦å¨å é¤å®¹å¨çåæ¶ç§»é¤æ°æ®å·ãå¯ä»¥å¨å é¤å®¹å¨çæ¶åä½¿ç¨ docker rm -v è¿ä¸ªå½ä»¤ã\n\næ ä¸»çæ°æ®å·å¯è½ä¼å æ®å¾å¤ç©ºé´ï¼è¦æ¸çè¯·ä½¿ç¨ä»¥ä¸å½ä»¤\n\n$ docker volume prune\n\n\n1\n\n\n\n# æè½½ä¸»æºç®å½\n\n\n# æè½½ä¸ä¸ªä¸»æºç®å½ä½ä¸ºæ°æ®å·\n\nä½¿ç¨ --mount æ è®°å¯ä»¥æå®æè½½ä¸ä¸ªæ¬å°ä¸»æºçç®å½å°å®¹å¨ä¸­å»ã\n\n$ docker run -d -p \\\n    --name web \\\n    # -v /src/webapp:/usr/share/nginx/html \\\n    --mount type=bind,source=/src/webapp,target=/usr/share/nginx/html \\\n    nginx:alpine\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çå½ä»¤æè½½ä¸»æºç /src/webapp ç®å½å°å®¹å¨ç /usr/share/nginx/htmlç®å½ãè¿ä¸ªåè½å¨è¿è¡æµè¯çæ¶åååæ¹ä¾¿ï¼æ¯å¦ç¨æ·å¯ä»¥æ¾ç½®ä¸äºç¨åºå°æ¬å°ç®å½ä¸­ï¼æ¥æ¥çå®¹å¨æ¯å¦æ­£å¸¸å·¥ä½ã\n\næ¬å°ç®å½çè·¯å¾å¿é¡»æ¯ç»å¯¹è·¯å¾ï¼ä½¿ç¨ -v åæ°æ¶å¦ææ¬å°ç®å½ä¸å­å¨ docker ä¼èªå¨ä¸ºä½ åå»ºä¸ä¸ªæä»¶å¤¹ï¼ä½¿ç¨ --mount åæ°æ¶å¦ææ¬å°ç®å½ä¸å­å¨ï¼docker ä¼æ¥éã\n\ndocker æè½½ä¸»æºç®å½çé»è®¤æéæ¯ è¯»åï¼ç¨æ·ä¹å¯ä»¥éè¿å¢å  readonly æå®ä¸º åªè¯»ã\n\n$ docker run -d -p \\\n    --name web \\\n    # -v /src/webapp:/usr/share/nginx/html:ro \\\n    --mount type=bind,source=/src/webapp,target=/usr/share/nginx/html,readonly \\\n    nginx:alpine\n\n\n1\n2\n3\n4\n5\n\n\nå äº readonly ä¹åï¼å°±æè½½ä¸º åªè¯» äºãå¦æä½ å¨å®¹å¨å /usr/share/nginx/html ç®å½æ°å»ºæä»¶ï¼ä¼æ¾ç¤ºå¦ä¸éè¯¯\n\n/usr/share/nginx/html # touch new.txt\ntouch: new.txt: read-only file system\n\n\n1\n2\n\n\n\n# æ¥çæ°æ®å·çå·ä½ä¿¡æ¯\n\nå¨ä¸»æºéä½¿ç¨ä»¥ä¸å½ä»¤å¯ä»¥æ¥ç web å®¹å¨çä¿¡æ¯\n\n$ docker inspect web\n\n\n1\n\n\næè½½ä¸»æºç®å½ çéç½®ä¿¡æ¯å¨ "mounts" key ä¸é¢\n\n"mounts": [\n    {\n        "type": "bind",\n        "source": "/src/webapp",\n        "destination": "/usr/share/nginx/html",\n        "mode": "",\n        "rw": true,\n        "propagation": "rprivate"\n    }\n],\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Docker ç½ç»æ¨¡å¼åå®¹å¨é´éä¿¡",frontmatter:{title:"Docker ç½ç»æ¨¡å¼åå®¹å¨é´éä¿¡",date:"2022-02-03T00:03:52.000Z",permalink:"/pages/8a7664/",categories:["åç«¯","Docker"],tags:[null]},regularPath:"/25.%E8%BF%90%E7%BB%B4/50.Docker/04.Docker%20%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%BC%8F%E5%92%8C%E5%AE%B9%E5%99%A8%E9%97%B4%E9%80%9A%E4%BF%A1.html",relativePath:"25.è¿ç»´/50.Docker/04.Docker ç½ç»æ¨¡å¼åå®¹å¨é´éä¿¡.md",key:"v-25458d2a",path:"/pages/8a7664/",headers:[{level:2,title:"é»è®¤ç½ç»",slug:"é»è®¤ç½ç»",normalizedTitle:"é»è®¤ç½ç»",charIndex:191},{level:3,title:"bridge ç½ç»æ¨¡å¼",slug:"bridge-ç½ç»æ¨¡å¼",normalizedTitle:"bridge ç½ç»æ¨¡å¼",charIndex:614},{level:3,title:"host ç½ç»æ¨¡å¼",slug:"host-ç½ç»æ¨¡å¼",normalizedTitle:"host ç½ç»æ¨¡å¼",charIndex:1953},{level:3,title:"none ç½ç»æ¨¡å¼",slug:"none-ç½ç»æ¨¡å¼",normalizedTitle:"none ç½ç»æ¨¡å¼",charIndex:2425},{level:3,title:"container ç½ç»æ¨¡å¼",slug:"container-ç½ç»æ¨¡å¼",normalizedTitle:"container ç½ç»æ¨¡å¼",charIndex:2906},{level:3,title:"link",slug:"link",normalizedTitle:"link",charIndex:3511},{level:2,title:"èªå®ä¹ç½ç»",slug:"èªå®ä¹ç½ç»",normalizedTitle:"èªå®ä¹ç½ç»",charIndex:3716},{level:3,title:"åå»ºç½ç»",slug:"åå»ºç½ç»",normalizedTitle:"åå»ºç½ç»",charIndex:4015},{level:3,title:"è¿æ¥ç½ç»",slug:"è¿æ¥ç½ç»",normalizedTitle:"è¿æ¥ç½ç»",charIndex:4833},{level:3,title:"æ­å¼ç½ç»",slug:"æ­å¼ç½ç»",normalizedTitle:"æ­å¼ç½ç»",charIndex:4996},{level:3,title:"ç§»é¤ç½ç»",slug:"ç§»é¤ç½ç»",normalizedTitle:"ç§»é¤ç½ç»",charIndex:5167},{level:2,title:"å®¹å¨é´ç½ç»éä¿¡",slug:"å®¹å¨é´ç½ç»éä¿¡",normalizedTitle:"å®¹å¨é´ç½ç»éä¿¡",charIndex:5310}],headersStr:"é»è®¤ç½ç» bridge ç½ç»æ¨¡å¼ host ç½ç»æ¨¡å¼ none ç½ç»æ¨¡å¼ container ç½ç»æ¨¡å¼ link èªå®ä¹ç½ç» åå»ºç½ç» è¿æ¥ç½ç» æ­å¼ç½ç» ç§»é¤ç½ç» å®¹å¨é´ç½ç»éä¿¡",content:"å½é¡¹ç®å¤§è§æ¨¡ä½¿ç¨ Docker æ¶ï¼å®¹å¨éä¿¡çé®é¢ä¹å°±äº§çäºãè¦è§£å³å®¹å¨éä¿¡é®é¢ï¼å¿é¡»åäºè§£å¾å¤å³äºç½ç»çç¥è¯ãDocker ä½ä¸ºç®åæç«çè½»éçº§å®¹å¨ææ¯ï¼æå¾å¤ä»¤äººç§°éçåè½ï¼å¦ Docker çéåç®¡çãç¶èï¼Docker åæ ·æçå¾å¤ä¸å®åçå°æ¹ï¼ç½ç»æ¹é¢å°±æ¯ Docker æ¯è¾èå¼±çé¨åãå æ­¤ï¼æä»¬æå¿è¦æ·±å¥äºè§£ Docker çç½ç»ç¥è¯ï¼ä»¥æ»¡è¶³æ´é«çç½ç»éæ±ã\n\n\n# é»è®¤ç½ç»\n\nå®è£ Docker ä»¥åï¼ä¼é»è®¤åå»ºä¸ç§ç½ç»ï¼å¯ä»¥éè¿ docker network ls æ¥çã\n\n[root@localhost ~]# docker network ls\nNETWORK ID          NAME                DRIVER              SCOPE\n688d1970f72e        bridge              bridge              local\n885da101da7d        host                host                local\nf4f1b3cf1b7f        none                null                local\n\n\n1\n2\n3\n4\n5\n\n\nå¨å­¦ä¹  Docker ç½ç»ä¹åï¼æä»¬æå¿è¦åæ¥äºè§£ä¸ä¸è¿å ç§ç½ç»æ¨¡å¼é½æ¯ä»ä¹ææã\n\n\n\n\n\n\n# bridge ç½ç»æ¨¡å¼\n\nå¨è¯¥æ¨¡å¼ä¸­ï¼Docker å®æ¤è¿ç¨åå»ºäºä¸ä¸ªèæä»¥å¤ªç½æ¡¥ docker0ï¼æ°å»ºçå®¹å¨ä¼èªå¨æ¡¥æ¥å°è¿ä¸ªæ¥å£ï¼éå å¨å¶ä¸çä»»ä½ç½å¡ä¹é´é½è½èªå¨è½¬åæ°æ®åã\n\né»è®¤æåµä¸ï¼å®æ¤è¿ç¨ä¼åå»ºä¸å¯¹å¯¹ç­èæè®¾å¤æ¥å£ veth pairï¼å°å¶ä¸­ä¸ä¸ªæ¥å£è®¾ç½®ä¸ºå®¹å¨ç eth0 æ¥å£ï¼å®¹å¨çç½å¡ï¼ï¼å¦ä¸ä¸ªæ¥å£æ¾ç½®å¨å®¿ä¸»æºçå½åç©ºé´ä¸­ï¼ä»¥ç±»ä¼¼ vethxxx è¿æ ·çåå­å½åï¼ä»èå°å®¿ä¸»æºä¸çææå®¹å¨é½è¿æ¥å°è¿ä¸ªåé¨ç½ç»ä¸ã\n\næ¯å¦æè¿è¡ä¸ä¸ªåºäº busybox éåæå»ºçå®¹å¨ bbox01ï¼æ¥ç ip addrï¼\n\n> busybox è¢«ç§°ä¸ºåµå¥å¼ Linux ççå£«ååï¼æ´åäºå¾å¤å°ç unix ä¸çéç¨åè½å°ä¸ä¸ªå°çå¯æ§è¡æä»¶ä¸­ã\n\n\n\nç¶åå®¿ä¸»æºéè¿ ip addr æ¥çä¿¡æ¯å¦ä¸ï¼\n\n\n\néè¿ä»¥ä¸çæ¯è¾å¯ä»¥åç°ï¼è¯å®äºä¹åæè¯´çï¼å®æ¤è¿ç¨ä¼åå»ºä¸å¯¹å¯¹ç­èæè®¾å¤æ¥å£ veth pairï¼å°å¶ä¸­ä¸ä¸ªæ¥å£è®¾ç½®ä¸ºå®¹å¨ç eth0 æ¥å£ï¼å®¹å¨çç½å¡ï¼ï¼å¦ä¸ä¸ªæ¥å£æ¾ç½®å¨å®¿ä¸»æºçå½åç©ºé´ä¸­ï¼ä»¥ç±»ä¼¼ vethxxx è¿æ ·çåå­å½åã\n\nåæ¶ï¼å®æ¤è¿ç¨è¿ä¼ä»ç½æ¡¥ docker0 çç§æå°åç©ºé´ä¸­åéä¸ä¸ª IP å°ååå­ç½ç»è¯¥å®¹å¨ï¼å¹¶è®¾ç½® docker0 ç IP å°åä¸ºå®¹å¨çé»è®¤ç½å³ãä¹å¯ä»¥å®è£ yum install -y bridge-utils ä»¥åï¼éè¿ brctl show å½ä»¤æ¥çç½æ¡¥ä¿¡æ¯ã\n\n\n\nå¯¹äºæ¯ä¸ªå®¹å¨ç IP å°åå Gateway ä¿¡æ¯ï¼æä»¬å¯ä»¥éè¿ docker inspect å®¹å¨åç§° | ID è¿è¡æ¥çï¼å¨ NetworkSettings èç¹ä¸­å¯ä»¥çå°è¯¦ç»ä¿¡æ¯ã\n\n\n\næä»¬å¯ä»¥éè¿ docker network inspect bridge æ¥çææ bridge ç½ç»æ¨¡å¼ä¸çå®¹å¨ï¼å¨ Containers èç¹ä¸­å¯ä»¥çå°å®¹å¨åç§°ã\n\n\n\n> å³äº bridge ç½ç»æ¨¡å¼çä½¿ç¨ï¼åªéè¦å¨åå»ºå®¹å¨æ¶éè¿åæ° --net bridge æè --network bridge æå®å³å¯ï¼å½ç¶è¿ä¹æ¯åå»ºå®¹å¨é»è®¤ä½¿ç¨çç½ç»æ¨¡å¼ï¼ä¹å°±æ¯è¯´è¿ä¸ªåæ°æ¯å¯ä»¥çç¥çã\n\nBridge æ¡¥æ¥æ¨¡å¼çå®ç°æ­¥éª¤ä¸»è¦å¦ä¸ï¼\n\n * Docker Daemon å©ç¨ veth pair ææ¯ï¼å¨å®¿ä¸»æºä¸åå»ºä¸å¯¹å¯¹ç­èæç½ç»æ¥å£è®¾å¤ï¼åè®¾ä¸º veth0 å veth1ãè\n\nveth pair ææ¯çç¹æ§å¯ä»¥ä¿è¯æ è®ºåªä¸ä¸ª veth æ¥æ¶å°ç½ç»æ¥æï¼é½ä¼å°æ¥æä¼ è¾ç»å¦ä¸æ¹ã\n\n * Docker Daemon å° veth0 éå å° Docker Daemon åå»ºç docker0 ç½æ¡¥ä¸ãä¿è¯å®¿ä¸»æºçç½ç»æ¥æå¯ä»¥åå¾ veth0ï¼\n\n * Docker Daemon å° veth1 æ·»å å° Docker Container æå±ç namespace ä¸ï¼å¹¶è¢«æ¹åä¸º eth0ãå¦æ­¤ä¸æ¥ï¼å®¿ä¸»æºçç½ç»æ¥æè¥åå¾ veth0ï¼åç«å³ä¼è¢« Container ç eth0 æ¥æ¶ï¼å®ç°å®¿ä¸»æºå° Docker Container ç½ç»çèéæ§ï¼åæ¶ï¼ä¹ä¿è¯ Docker Container åç¬ä½¿ç¨ eth0ï¼å®ç°å®¹å¨ç½ç»ç¯å¢çéç¦»æ§ã\n\n\n# host ç½ç»æ¨¡å¼\n\n * host ç½ç»æ¨¡å¼éè¦å¨åå»ºå®¹å¨æ¶éè¿åæ° --net host æè --network host æå®ï¼\n\n * éç¨ host ç½ç»æ¨¡å¼ç Docker Containerï¼å¯ä»¥ç´æ¥ä½¿ç¨å®¿ä¸»æºç IP å°åä¸å¤çè¿è¡éä¿¡ï¼è¥å®¿ä¸»æºç eth0 æ¯ä¸ä¸ªå¬æ IPï¼é£ä¹å®¹å¨ä¹æ¥æè¿ä¸ªå¬æ IPãåæ¶å®¹å¨åæå¡çç«¯å£ä¹å¯ä»¥ä½¿ç¨å®¿ä¸»æºçç«¯å£ï¼æ éé¢å¤è¿è¡ NAT è½¬æ¢ï¼\n\n * host ç½ç»æ¨¡å¼å¯ä»¥è®©å®¹å¨å±äº«å®¿ä¸»æºç½ç»æ ï¼è¿æ ·çå¥½å¤æ¯å¤é¨ä¸»æºä¸å®¹å¨ç´æ¥éä¿¡ï¼ä½æ¯å®¹å¨çç½ç»ç¼ºå°éç¦»æ§ã\n\næ¯å¦æåºäº host ç½ç»æ¨¡å¼åå»ºäºä¸ä¸ªåºäº busybox éåæå»ºçå®¹å¨ bbox02ï¼æ¥ç ip addrï¼\n\n\n\nç¶åå®¿ä¸»æºéè¿ ip addr æ¥çä¿¡æ¯å¦ä¸ï¼\n\n\n\nå¯¹ï¼ä½ æ²¡æçéï¼è¿åä¿¡æ¯ä¸æ¨¡ä¸æ ·ï¼æä¹å¯ä»¥è¯å®ææ²¡ææªéå¾ï¼ä¸ä¿¡æ¥çå¾ä¸çãæä»¬å¯ä»¥éè¿ docker network inspect host æ¥çææ host ç½ç»æ¨¡å¼ä¸çå®¹å¨ï¼å¨ Containers èç¹ä¸­å¯ä»¥çå°å®¹å¨åç§°ã\n\n\n\n\n# none ç½ç»æ¨¡å¼\n\n * none ç½ç»æ¨¡å¼æ¯æç¦ç¨ç½ç»åè½ï¼åªæ lo æ¥å£ local çç®åï¼ä»£è¡¨ 127.0.0.1ï¼å³ localhost æ¬å°ç¯åæ¥å£ãå¨åå»ºå®¹å¨æ¶éè¿åæ° --net none æè --network none æå®ï¼\n\n * none ç½ç»æ¨¡å¼å³ä¸ä¸º Docker Container åå»ºä»»ä½çç½ç»ç¯å¢ï¼å®¹å¨åé¨å°±åªè½ä½¿ç¨ loopback ç½ç»è®¾å¤ï¼ä¸ä¼åæå¶ä»çç½ç»èµæºãå¯ä»¥è¯´ none æ¨¡å¼ä¸º Docke Container åäºæå°çç½ç»è®¾å®ï¼ä½æ¯ä¿è¯è¯´å¾å¥½ âå°å³æ¯å¤âï¼å¨æ²¡æç½ç»éç½®çæåµä¸ï¼ä½ä¸º Docker å¼åèï¼æè½å¨è¿åºç¡åå¶ä»æ éå¤å¯è½çç½ç»å®å¶å¼åãè¿ä¹æ°å·§ä½ç°äº Docker è®¾è®¡çå¿µçå¼æ¾ã\n\næ¯å¦æåºäº none ç½ç»æ¨¡å¼åå»ºäºä¸ä¸ªåºäº busybox éåæå»ºçå®¹å¨ bbox03ï¼æ¥ç ip addrï¼\n\n\n\næä»¬å¯ä»¥éè¿ docker network inspect none æ¥çææ none ç½ç»æ¨¡å¼ä¸çå®¹å¨ï¼å¨ Containers èç¹ä¸­å¯ä»¥çå°å®¹å¨åç§°ã\n\n\n\n\n# container ç½ç»æ¨¡å¼\n\n * Container ç½ç»æ¨¡å¼æ¯ Docker ä¸­ä¸ç§è¾ä¸ºç¹å«çç½ç»çæ¨¡å¼ãå¨åå»ºå®¹å¨æ¶éè¿åæ° --net container: å·²è¿è¡çå®¹å¨åç§° | ID æè --network container: å·²è¿è¡çå®¹å¨åç§° | ID æå®ï¼\n\n * å¤äºè¿ä¸ªæ¨¡å¼ä¸ç Docker å®¹å¨ä¼å±äº«ä¸ä¸ªç½ç»æ ï¼è¿æ ·ä¸¤ä¸ªå®¹å¨ä¹é´å¯ä»¥ä½¿ç¨ localhost é«æå¿«ééä¿¡ã\n\nContainer ç½ç»æ¨¡å¼å³æ°åå»ºçå®¹å¨ä¸ä¼åå»ºèªå·±çç½å¡ï¼éç½®èªå·±ç IPï¼èæ¯åä¸ä¸ªæå®çå®¹å¨å±äº« IPãç«¯å£èå´ç­ãåæ ·ä¸¤ä¸ªå®¹å¨é¤äºç½ç»æ¹é¢ç¸åä¹å¤ï¼å¶ä»çå¦æä»¶ç³»ç»ãè¿ç¨åè¡¨ç­è¿æ¯éç¦»çã\n\næ¯å¦æåºäºå®¹å¨ bbox01 åå»ºäº container ç½ç»æ¨¡å¼çå®¹å¨ bbox04ï¼æ¥ç ip addrï¼\n\n\n\nå®¹å¨ bbox01 ç ip addr ä¿¡æ¯å¦ä¸ï¼\n\n\n\nå®¿ä¸»æºç ip addr ä¿¡æ¯å¦ä¸ï¼\n\n\n\néè¿ä»¥ä¸æµè¯å¯ä»¥åç°ï¼Docker å®æ¤è¿ç¨åªåå»ºäºä¸å¯¹å¯¹ç­èæè®¾å¤æ¥å£ç¨äºè¿æ¥ bbox01 å®¹å¨åå®¿ä¸»æºï¼è bbox04 å®¹å¨åç´æ¥ä½¿ç¨äº bbox01 å®¹å¨çç½å¡ä¿¡æ¯ã\n\nè¿ä¸ªæ¶åå¦æå° bbox01 å®¹å¨åæ­¢ï¼ä¼åç° bbox04 å®¹å¨å°±åªå©ä¸ lo æ¥å£äºã\n\n\n\nç¶å bbox01 å®¹å¨éå¯ä»¥åï¼bbox04 å®¹å¨ä¹éå¯ä¸ä¸ï¼å°±åå¯ä»¥è·åå°ç½å¡ä¿¡æ¯äºã\n\n\n\n\n# link\n\ndocker run --link å¯ä»¥ç¨æ¥é¾æ¥ä¸¤ä¸ªå®¹å¨ï¼ä½¿å¾æºå®¹å¨ï¼è¢«é¾æ¥çå®¹å¨ï¼åæ¥æ¶å®¹å¨ï¼ä¸»å¨å»é¾æ¥çå®¹å¨ï¼ä¹é´å¯ä»¥äºç¸éä¿¡ï¼å¹¶ä¸æ¥æ¶å®¹å¨å¯ä»¥è·åæºå®¹å¨çä¸äºæ°æ®ï¼å¦æºå®¹å¨çç¯å¢åéã\n\nè¿ç§æ¹å¼å®æ¹å·²ä¸æ¨èä½¿ç¨ï¼å¹¶ä¸å¨æªæ¥çæ¬å¯è½ä¼è¢«ç§»é¤ï¼æä»¥è¿éä¸ä½ä¸ºéç¹è®²è§£ï¼æå´è¶£å¯èªè¡äºè§£ã\n\nå®ç½è­¦åä¿¡æ¯ï¼https://docs.docker.com/network/links/\n\n\n\n\n# èªå®ä¹ç½ç»\n\nè½ç¶ Docker æä¾çé»è®¤ç½ç»ä½¿ç¨æ¯è¾ç®åï¼ä½æ¯ä¸ºäºä¿è¯åå®¹å¨ä¸­åºç¨çå®å¨æ§ï¼å¨å®éå¼åä¸­æ´æ¨èä½¿ç¨èªå®ä¹çç½ç»è¿è¡å®¹å¨ç®¡çï¼ä»¥åå¯ç¨å®¹å¨åç§°å° IP å°åçèªå¨ DNS è§£æã\n\n> ä» Docker 1.10 çæ¬å¼å§ï¼docker daemon å®ç°äºä¸ä¸ªååµç DNS serverï¼ä½¿å®¹å¨å¯ä»¥ç´æ¥éè¿å®¹å¨åç§°éä¿¡ãæ¹æ³å¾ç®åï¼åªè¦å¨åå»ºå®¹å¨æ¶ä½¿ç¨ --name ä¸ºå®¹å¨å½åå³å¯ã\n\n> ä½æ¯ä½¿ç¨ Docker DNS æä¸ªéå¶ï¼åªè½å¨ user-defined ç½ç»ä¸­ä½¿ç¨ãä¹å°±æ¯è¯´ï¼é»è®¤ç bridge ç½ç»æ¯æ æ³ä½¿ç¨ DNS çï¼æä»¥æä»¬å°±éè¦èªå®ä¹ç½ç»ã\n\n\n# åå»ºç½ç»\n\néè¿ docker network create å½ä»¤å¯ä»¥åå»ºèªå®ä¹ç½ç»æ¨¡å¼ï¼å½ä»¤æç¤ºå¦ä¸ï¼\n\n\n\nè¿ä¸æ­¥æ¥ç docker network create å½ä»¤ä½¿ç¨è¯¦æï¼åç°å¯ä»¥éè¿ --driver æå®ç½ç»æ¨¡å¼ä¸é»è®¤æ¯ bridge ç½ç»æ¨¡å¼ï¼æç¤ºå¦ä¸ï¼\n\n\n\nåå»ºä¸ä¸ªåºäº bridge ç½ç»æ¨¡å¼çèªå®ä¹ç½ç»æ¨¡å¼ custom_networkï¼å®æ´å½ä»¤å¦ä¸ï¼\n\ndocker network create custom_network\n\n\n1\n\n\néè¿ docker network ls æ¥çç½ç»æ¨¡å¼ï¼\n\n[root@localhost ~]# docker network ls\nNETWORK ID          NAME                DRIVER              SCOPE\nb3634bbd8943        bridge              bridge              local\n062082493d3a        custom_network      bridge              local\n885da101da7d        host                host                local\nf4f1b3cf1b7f        none                null                local\n\n\n1\n2\n3\n4\n5\n6\n\n\néè¿èªå®ä¹ç½ç»æ¨¡å¼ custom_network åå»ºå®¹å¨ï¼\n\ndocker run -di --name bbox05 --net custom_network busybox\n\n\n1\n\n\néè¿ docker inspect å®¹å¨åç§° | ID æ¥çå®¹å¨çç½ç»ä¿¡æ¯ï¼å¨ NetworkSettings èç¹ä¸­å¯ä»¥çå°è¯¦ç»ä¿¡æ¯ã\n\n\n\n\n# è¿æ¥ç½ç»\n\néè¿ docker network connect ç½ç»åç§° å®¹å¨åç§° ä¸ºå®¹å¨è¿æ¥æ°çç½ç»æ¨¡å¼ã\n\n\n\ndocker network connect bridge bbox05\n\n\n1\n\n\néè¿ docker inspect å®¹å¨åç§° | ID åæ¬¡æ¥çå®¹å¨çç½ç»ä¿¡æ¯ï¼å¤å¢å äºé»è®¤ç bridgeã\n\n\n\n\n# æ­å¼ç½ç»\n\néè¿ docker network disconnect ç½ç»åç§° å®¹å¨åç§° å½ä»¤æ­å¼ç½ç»ã\n\ndocker network disconnect custom_network bbox05\n\n\n1\n\n\néè¿ docker inspect å®¹å¨åç§° | ID åæ¬¡æ¥çå®¹å¨çç½ç»ä¿¡æ¯ï¼åç°åªå©ä¸é»è®¤ç bridgeã\n\n\n\n\n# ç§»é¤ç½ç»\n\nå¯ä»¥éè¿ docker network rm ç½ç»åç§° å½ä»¤ç§»é¤èªå®ä¹ç½ç»æ¨¡å¼ï¼ç½ç»æ¨¡å¼ç§»é¤æåä¼è¿åç½ç»æ¨¡å¼åç§°ã\n\ndocker network rm custom_network\n\n\n1\n\n\næ³¨æï¼å¦æéè¿æä¸ªèªå®ä¹ç½ç»æ¨¡å¼åå»ºäºå®¹å¨ï¼åè¯¥ç½ç»æ¨¡å¼æ æ³å é¤ã\n\n\n# å®¹å¨é´ç½ç»éä¿¡\n\næ¥ä¸æ¥æä»¬éè¿æå­¦çç¥è¯å®ç°å®¹å¨é´çç½ç»éä¿¡ãé¦åæç¡®ä¸ç¹ï¼å®¹å¨ä¹é´è¦äºç¸éä¿¡ï¼å¿é¡»è¦æå±äºåä¸ä¸ªç½ç»çç½å¡ã\n\næä»¬ååå»ºä¸¤ä¸ªåºäºé»è®¤ç bridge ç½ç»æ¨¡å¼çå®¹å¨ã\n\ndocker run -di --name default_bbox01 busybox\n\n\n1\n\n\néè¿ docker network inspect bridge æ¥çä¸¤å®¹å¨çå·ä½ IP ä¿¡æ¯ã\n\n\n\nç¶åæµè¯ä¸¤å®¹å¨é´æ¯å¦å¯ä»¥è¿è¡ç½ç»éä¿¡ã\n\n\n\nç»è¿æµè¯ï¼ä»ç»æå¾ç¥ä¸¤ä¸ªå±äºåä¸ä¸ªç½ç»çå®¹å¨æ¯å¯ä»¥è¿è¡ç½ç»éä¿¡çï¼ä½æ¯ IP å°åå¯è½æ¯ä¸åºå®çï¼æè¢«æ´æ¹çæåµåçï¼é£å®¹å¨åææéä¿¡ç IP å°åä¹éè¦è¿è¡æ´æ¹ï¼è½å¦ä½¿ç¨å®¹å¨åç§°è¿è¡ç½ç»éä¿¡ï¼ç»§ç»­æµè¯ã\n\n\n\nç»è¿æµè¯ï¼ä»ç»æå¾ç¥ä½¿ç¨å®¹å¨è¿è¡ç½ç»éä¿¡æ¯ä¸è¡çï¼é£æä¹å®ç°è¿ä¸ªåè½å¢ï¼\n\nä» Docker 1.10 çæ¬å¼å§ï¼docker daemon å®ç°äºä¸ä¸ªååµç DNS serverï¼ä½¿å®¹å¨å¯ä»¥ç´æ¥éè¿å®¹å¨åç§°éä¿¡ãæ¹æ³å¾ç®åï¼åªè¦å¨åå»ºå®¹å¨æ¶ä½¿ç¨ --name ä¸ºå®¹å¨å½åå³å¯ã\n\nä½æ¯ä½¿ç¨ Docker DNS æä¸ªéå¶ï¼åªè½å¨ user-defined ç½ç»ä¸­ä½¿ç¨ãä¹å°±æ¯è¯´ï¼é»è®¤ç bridge ç½ç»æ¯æ æ³ä½¿ç¨ DNS çï¼æä»¥æä»¬å°±éè¦èªå®ä¹ç½ç»ã\n\næä»¬ååºäº bridge ç½ç»æ¨¡å¼åå»ºèªå®ä¹ç½ç» custom_networkï¼ç¶ååå»ºä¸¤ä¸ªåºäºèªå®ä¹ç½ç»æ¨¡å¼çå®¹å¨ã\n\ndocker run -di --name custom_bbox01 --net custom_network busybox\n\n\n1\n\n\néè¿ docker network inspect custom_network æ¥çä¸¤å®¹å¨çå·ä½ IP ä¿¡æ¯ã\n\n\n\nç¶åæµè¯ä¸¤å®¹å¨é´æ¯å¦å¯ä»¥è¿è¡ç½ç»éä¿¡ï¼åå«ä½¿ç¨å·ä½ IP åå®¹å¨åç§°è¿è¡ç½ç»éä¿¡ã\n\n\n\nç»è¿æµè¯ï¼ä»ç»æå¾ç¥ä¸¤ä¸ªå±äºåä¸ä¸ªèªå®ä¹ç½ç»çå®¹å¨æ¯å¯ä»¥è¿è¡ç½ç»éä¿¡çï¼å¹¶ä¸å¯ä»¥ä½¿ç¨å®¹å¨åç§°è¿è¡ç½ç»éä¿¡ã\n\né£å¦ææ­¤æ¶æå¸æ bridge ç½ç»ä¸çå®¹å¨å¯ä»¥å custom_network ç½ç»ä¸çå®¹å¨è¿è¡ç½ç»åè¯¥å¦ä½æä½ï¼å¶å®ç­æ¡ä¹éå¸¸ç®åï¼è®© bridge ç½ç»ä¸çå®¹å¨è¿æ¥è³æ°ç custom_network ç½ç»å³å¯ã\n\ndocker network connect custom_network default_bbox01\n\n\n1\n\n\n\n\nå­¦å®å®¹å¨ç½ç»éä¿¡ï¼å¤§å®¶å°±å¯ä»¥ç»ä¹ ä½¿ç¨å¤ä¸ªå®¹å¨å®æå¸¸è§åºç¨éç¾¤çé¨ç½²äºãåé¢å°±è¯¥å­¦ä¹  Docker è¿é¶é¨åçåå®¹ Docker Compose å Docker Swarmã\n\nåèï¼",normalizedContent:"å½é¡¹ç®å¤§è§æ¨¡ä½¿ç¨ docker æ¶ï¼å®¹å¨éä¿¡çé®é¢ä¹å°±äº§çäºãè¦è§£å³å®¹å¨éä¿¡é®é¢ï¼å¿é¡»åäºè§£å¾å¤å³äºç½ç»çç¥è¯ãdocker ä½ä¸ºç®åæç«çè½»éçº§å®¹å¨ææ¯ï¼æå¾å¤ä»¤äººç§°éçåè½ï¼å¦ docker çéåç®¡çãç¶èï¼docker åæ ·æçå¾å¤ä¸å®åçå°æ¹ï¼ç½ç»æ¹é¢å°±æ¯ docker æ¯è¾èå¼±çé¨åãå æ­¤ï¼æä»¬æå¿è¦æ·±å¥äºè§£ docker çç½ç»ç¥è¯ï¼ä»¥æ»¡è¶³æ´é«çç½ç»éæ±ã\n\n\n# é»è®¤ç½ç»\n\nå®è£ docker ä»¥åï¼ä¼é»è®¤åå»ºä¸ç§ç½ç»ï¼å¯ä»¥éè¿ docker network ls æ¥çã\n\n[root@localhost ~]# docker network ls\nnetwork id          name                driver              scope\n688d1970f72e        bridge              bridge              local\n885da101da7d        host                host                local\nf4f1b3cf1b7f        none                null                local\n\n\n1\n2\n3\n4\n5\n\n\nå¨å­¦ä¹  docker ç½ç»ä¹åï¼æä»¬æå¿è¦åæ¥äºè§£ä¸ä¸è¿å ç§ç½ç»æ¨¡å¼é½æ¯ä»ä¹ææã\n\n\n\n\n\n\n# bridge ç½ç»æ¨¡å¼\n\nå¨è¯¥æ¨¡å¼ä¸­ï¼docker å®æ¤è¿ç¨åå»ºäºä¸ä¸ªèæä»¥å¤ªç½æ¡¥ docker0ï¼æ°å»ºçå®¹å¨ä¼èªå¨æ¡¥æ¥å°è¿ä¸ªæ¥å£ï¼éå å¨å¶ä¸çä»»ä½ç½å¡ä¹é´é½è½èªå¨è½¬åæ°æ®åã\n\né»è®¤æåµä¸ï¼å®æ¤è¿ç¨ä¼åå»ºä¸å¯¹å¯¹ç­èæè®¾å¤æ¥å£ veth pairï¼å°å¶ä¸­ä¸ä¸ªæ¥å£è®¾ç½®ä¸ºå®¹å¨ç eth0 æ¥å£ï¼å®¹å¨çç½å¡ï¼ï¼å¦ä¸ä¸ªæ¥å£æ¾ç½®å¨å®¿ä¸»æºçå½åç©ºé´ä¸­ï¼ä»¥ç±»ä¼¼ vethxxx è¿æ ·çåå­å½åï¼ä»èå°å®¿ä¸»æºä¸çææå®¹å¨é½è¿æ¥å°è¿ä¸ªåé¨ç½ç»ä¸ã\n\næ¯å¦æè¿è¡ä¸ä¸ªåºäº busybox éåæå»ºçå®¹å¨ bbox01ï¼æ¥ç ip addrï¼\n\n> busybox è¢«ç§°ä¸ºåµå¥å¼ linux ççå£«ååï¼æ´åäºå¾å¤å°ç unix ä¸çéç¨åè½å°ä¸ä¸ªå°çå¯æ§è¡æä»¶ä¸­ã\n\n\n\nç¶åå®¿ä¸»æºéè¿ ip addr æ¥çä¿¡æ¯å¦ä¸ï¼\n\n\n\néè¿ä»¥ä¸çæ¯è¾å¯ä»¥åç°ï¼è¯å®äºä¹åæè¯´çï¼å®æ¤è¿ç¨ä¼åå»ºä¸å¯¹å¯¹ç­èæè®¾å¤æ¥å£ veth pairï¼å°å¶ä¸­ä¸ä¸ªæ¥å£è®¾ç½®ä¸ºå®¹å¨ç eth0 æ¥å£ï¼å®¹å¨çç½å¡ï¼ï¼å¦ä¸ä¸ªæ¥å£æ¾ç½®å¨å®¿ä¸»æºçå½åç©ºé´ä¸­ï¼ä»¥ç±»ä¼¼ vethxxx è¿æ ·çåå­å½åã\n\nåæ¶ï¼å®æ¤è¿ç¨è¿ä¼ä»ç½æ¡¥ docker0 çç§æå°åç©ºé´ä¸­åéä¸ä¸ª ip å°ååå­ç½ç»è¯¥å®¹å¨ï¼å¹¶è®¾ç½® docker0 ç ip å°åä¸ºå®¹å¨çé»è®¤ç½å³ãä¹å¯ä»¥å®è£ yum install -y bridge-utils ä»¥åï¼éè¿ brctl show å½ä»¤æ¥çç½æ¡¥ä¿¡æ¯ã\n\n\n\nå¯¹äºæ¯ä¸ªå®¹å¨ç ip å°åå gateway ä¿¡æ¯ï¼æä»¬å¯ä»¥éè¿ docker inspect å®¹å¨åç§° | id è¿è¡æ¥çï¼å¨ networksettings èç¹ä¸­å¯ä»¥çå°è¯¦ç»ä¿¡æ¯ã\n\n\n\næä»¬å¯ä»¥éè¿ docker network inspect bridge æ¥çææ bridge ç½ç»æ¨¡å¼ä¸çå®¹å¨ï¼å¨ containers èç¹ä¸­å¯ä»¥çå°å®¹å¨åç§°ã\n\n\n\n> å³äº bridge ç½ç»æ¨¡å¼çä½¿ç¨ï¼åªéè¦å¨åå»ºå®¹å¨æ¶éè¿åæ° --net bridge æè --network bridge æå®å³å¯ï¼å½ç¶è¿ä¹æ¯åå»ºå®¹å¨é»è®¤ä½¿ç¨çç½ç»æ¨¡å¼ï¼ä¹å°±æ¯è¯´è¿ä¸ªåæ°æ¯å¯ä»¥çç¥çã\n\nbridge æ¡¥æ¥æ¨¡å¼çå®ç°æ­¥éª¤ä¸»è¦å¦ä¸ï¼\n\n * docker daemon å©ç¨ veth pair ææ¯ï¼å¨å®¿ä¸»æºä¸åå»ºä¸å¯¹å¯¹ç­èæç½ç»æ¥å£è®¾å¤ï¼åè®¾ä¸º veth0 å veth1ãè\n\nveth pair ææ¯çç¹æ§å¯ä»¥ä¿è¯æ è®ºåªä¸ä¸ª veth æ¥æ¶å°ç½ç»æ¥æï¼é½ä¼å°æ¥æä¼ è¾ç»å¦ä¸æ¹ã\n\n * docker daemon å° veth0 éå å° docker daemon åå»ºç docker0 ç½æ¡¥ä¸ãä¿è¯å®¿ä¸»æºçç½ç»æ¥æå¯ä»¥åå¾ veth0ï¼\n\n * docker daemon å° veth1 æ·»å å° docker container æå±ç namespace ä¸ï¼å¹¶è¢«æ¹åä¸º eth0ãå¦æ­¤ä¸æ¥ï¼å®¿ä¸»æºçç½ç»æ¥æè¥åå¾ veth0ï¼åç«å³ä¼è¢« container ç eth0 æ¥æ¶ï¼å®ç°å®¿ä¸»æºå° docker container ç½ç»çèéæ§ï¼åæ¶ï¼ä¹ä¿è¯ docker container åç¬ä½¿ç¨ eth0ï¼å®ç°å®¹å¨ç½ç»ç¯å¢çéç¦»æ§ã\n\n\n# host ç½ç»æ¨¡å¼\n\n * host ç½ç»æ¨¡å¼éè¦å¨åå»ºå®¹å¨æ¶éè¿åæ° --net host æè --network host æå®ï¼\n\n * éç¨ host ç½ç»æ¨¡å¼ç docker containerï¼å¯ä»¥ç´æ¥ä½¿ç¨å®¿ä¸»æºç ip å°åä¸å¤çè¿è¡éä¿¡ï¼è¥å®¿ä¸»æºç eth0 æ¯ä¸ä¸ªå¬æ ipï¼é£ä¹å®¹å¨ä¹æ¥æè¿ä¸ªå¬æ ipãåæ¶å®¹å¨åæå¡çç«¯å£ä¹å¯ä»¥ä½¿ç¨å®¿ä¸»æºçç«¯å£ï¼æ éé¢å¤è¿è¡ nat è½¬æ¢ï¼\n\n * host ç½ç»æ¨¡å¼å¯ä»¥è®©å®¹å¨å±äº«å®¿ä¸»æºç½ç»æ ï¼è¿æ ·çå¥½å¤æ¯å¤é¨ä¸»æºä¸å®¹å¨ç´æ¥éä¿¡ï¼ä½æ¯å®¹å¨çç½ç»ç¼ºå°éç¦»æ§ã\n\næ¯å¦æåºäº host ç½ç»æ¨¡å¼åå»ºäºä¸ä¸ªåºäº busybox éåæå»ºçå®¹å¨ bbox02ï¼æ¥ç ip addrï¼\n\n\n\nç¶åå®¿ä¸»æºéè¿ ip addr æ¥çä¿¡æ¯å¦ä¸ï¼\n\n\n\nå¯¹ï¼ä½ æ²¡æçéï¼è¿åä¿¡æ¯ä¸æ¨¡ä¸æ ·ï¼æä¹å¯ä»¥è¯å®ææ²¡ææªéå¾ï¼ä¸ä¿¡æ¥çå¾ä¸çãæä»¬å¯ä»¥éè¿ docker network inspect host æ¥çææ host ç½ç»æ¨¡å¼ä¸çå®¹å¨ï¼å¨ containers èç¹ä¸­å¯ä»¥çå°å®¹å¨åç§°ã\n\n\n\n\n# none ç½ç»æ¨¡å¼\n\n * none ç½ç»æ¨¡å¼æ¯æç¦ç¨ç½ç»åè½ï¼åªæ lo æ¥å£ local çç®åï¼ä»£è¡¨ 127.0.0.1ï¼å³ localhost æ¬å°ç¯åæ¥å£ãå¨åå»ºå®¹å¨æ¶éè¿åæ° --net none æè --network none æå®ï¼\n\n * none ç½ç»æ¨¡å¼å³ä¸ä¸º docker container åå»ºä»»ä½çç½ç»ç¯å¢ï¼å®¹å¨åé¨å°±åªè½ä½¿ç¨ loopback ç½ç»è®¾å¤ï¼ä¸ä¼åæå¶ä»çç½ç»èµæºãå¯ä»¥è¯´ none æ¨¡å¼ä¸º docke container åäºæå°çç½ç»è®¾å®ï¼ä½æ¯ä¿è¯è¯´å¾å¥½ âå°å³æ¯å¤âï¼å¨æ²¡æç½ç»éç½®çæåµä¸ï¼ä½ä¸º docker å¼åèï¼æè½å¨è¿åºç¡åå¶ä»æ éå¤å¯è½çç½ç»å®å¶å¼åãè¿ä¹æ°å·§ä½ç°äº docker è®¾è®¡çå¿µçå¼æ¾ã\n\næ¯å¦æåºäº none ç½ç»æ¨¡å¼åå»ºäºä¸ä¸ªåºäº busybox éåæå»ºçå®¹å¨ bbox03ï¼æ¥ç ip addrï¼\n\n\n\næä»¬å¯ä»¥éè¿ docker network inspect none æ¥çææ none ç½ç»æ¨¡å¼ä¸çå®¹å¨ï¼å¨ containers èç¹ä¸­å¯ä»¥çå°å®¹å¨åç§°ã\n\n\n\n\n# container ç½ç»æ¨¡å¼\n\n * container ç½ç»æ¨¡å¼æ¯ docker ä¸­ä¸ç§è¾ä¸ºç¹å«çç½ç»çæ¨¡å¼ãå¨åå»ºå®¹å¨æ¶éè¿åæ° --net container: å·²è¿è¡çå®¹å¨åç§° | id æè --network container: å·²è¿è¡çå®¹å¨åç§° | id æå®ï¼\n\n * å¤äºè¿ä¸ªæ¨¡å¼ä¸ç docker å®¹å¨ä¼å±äº«ä¸ä¸ªç½ç»æ ï¼è¿æ ·ä¸¤ä¸ªå®¹å¨ä¹é´å¯ä»¥ä½¿ç¨ localhost é«æå¿«ééä¿¡ã\n\ncontainer ç½ç»æ¨¡å¼å³æ°åå»ºçå®¹å¨ä¸ä¼åå»ºèªå·±çç½å¡ï¼éç½®èªå·±ç ipï¼èæ¯åä¸ä¸ªæå®çå®¹å¨å±äº« ipãç«¯å£èå´ç­ãåæ ·ä¸¤ä¸ªå®¹å¨é¤äºç½ç»æ¹é¢ç¸åä¹å¤ï¼å¶ä»çå¦æä»¶ç³»ç»ãè¿ç¨åè¡¨ç­è¿æ¯éç¦»çã\n\næ¯å¦æåºäºå®¹å¨ bbox01 åå»ºäº container ç½ç»æ¨¡å¼çå®¹å¨ bbox04ï¼æ¥ç ip addrï¼\n\n\n\nå®¹å¨ bbox01 ç ip addr ä¿¡æ¯å¦ä¸ï¼\n\n\n\nå®¿ä¸»æºç ip addr ä¿¡æ¯å¦ä¸ï¼\n\n\n\néè¿ä»¥ä¸æµè¯å¯ä»¥åç°ï¼docker å®æ¤è¿ç¨åªåå»ºäºä¸å¯¹å¯¹ç­èæè®¾å¤æ¥å£ç¨äºè¿æ¥ bbox01 å®¹å¨åå®¿ä¸»æºï¼è bbox04 å®¹å¨åç´æ¥ä½¿ç¨äº bbox01 å®¹å¨çç½å¡ä¿¡æ¯ã\n\nè¿ä¸ªæ¶åå¦æå° bbox01 å®¹å¨åæ­¢ï¼ä¼åç° bbox04 å®¹å¨å°±åªå©ä¸ lo æ¥å£äºã\n\n\n\nç¶å bbox01 å®¹å¨éå¯ä»¥åï¼bbox04 å®¹å¨ä¹éå¯ä¸ä¸ï¼å°±åå¯ä»¥è·åå°ç½å¡ä¿¡æ¯äºã\n\n\n\n\n# link\n\ndocker run --link å¯ä»¥ç¨æ¥é¾æ¥ä¸¤ä¸ªå®¹å¨ï¼ä½¿å¾æºå®¹å¨ï¼è¢«é¾æ¥çå®¹å¨ï¼åæ¥æ¶å®¹å¨ï¼ä¸»å¨å»é¾æ¥çå®¹å¨ï¼ä¹é´å¯ä»¥äºç¸éä¿¡ï¼å¹¶ä¸æ¥æ¶å®¹å¨å¯ä»¥è·åæºå®¹å¨çä¸äºæ°æ®ï¼å¦æºå®¹å¨çç¯å¢åéã\n\nè¿ç§æ¹å¼å®æ¹å·²ä¸æ¨èä½¿ç¨ï¼å¹¶ä¸å¨æªæ¥çæ¬å¯è½ä¼è¢«ç§»é¤ï¼æä»¥è¿éä¸ä½ä¸ºéç¹è®²è§£ï¼æå´è¶£å¯èªè¡äºè§£ã\n\nå®ç½è­¦åä¿¡æ¯ï¼https://docs.docker.com/network/links/\n\n\n\n\n# èªå®ä¹ç½ç»\n\nè½ç¶ docker æä¾çé»è®¤ç½ç»ä½¿ç¨æ¯è¾ç®åï¼ä½æ¯ä¸ºäºä¿è¯åå®¹å¨ä¸­åºç¨çå®å¨æ§ï¼å¨å®éå¼åä¸­æ´æ¨èä½¿ç¨èªå®ä¹çç½ç»è¿è¡å®¹å¨ç®¡çï¼ä»¥åå¯ç¨å®¹å¨åç§°å° ip å°åçèªå¨ dns è§£æã\n\n> ä» docker 1.10 çæ¬å¼å§ï¼docker daemon å®ç°äºä¸ä¸ªååµç dns serverï¼ä½¿å®¹å¨å¯ä»¥ç´æ¥éè¿å®¹å¨åç§°éä¿¡ãæ¹æ³å¾ç®åï¼åªè¦å¨åå»ºå®¹å¨æ¶ä½¿ç¨ --name ä¸ºå®¹å¨å½åå³å¯ã\n\n> ä½æ¯ä½¿ç¨ docker dns æä¸ªéå¶ï¼åªè½å¨ user-defined ç½ç»ä¸­ä½¿ç¨ãä¹å°±æ¯è¯´ï¼é»è®¤ç bridge ç½ç»æ¯æ æ³ä½¿ç¨ dns çï¼æä»¥æä»¬å°±éè¦èªå®ä¹ç½ç»ã\n\n\n# åå»ºç½ç»\n\néè¿ docker network create å½ä»¤å¯ä»¥åå»ºèªå®ä¹ç½ç»æ¨¡å¼ï¼å½ä»¤æç¤ºå¦ä¸ï¼\n\n\n\nè¿ä¸æ­¥æ¥ç docker network create å½ä»¤ä½¿ç¨è¯¦æï¼åç°å¯ä»¥éè¿ --driver æå®ç½ç»æ¨¡å¼ä¸é»è®¤æ¯ bridge ç½ç»æ¨¡å¼ï¼æç¤ºå¦ä¸ï¼\n\n\n\nåå»ºä¸ä¸ªåºäº bridge ç½ç»æ¨¡å¼çèªå®ä¹ç½ç»æ¨¡å¼ custom_networkï¼å®æ´å½ä»¤å¦ä¸ï¼\n\ndocker network create custom_network\n\n\n1\n\n\néè¿ docker network ls æ¥çç½ç»æ¨¡å¼ï¼\n\n[root@localhost ~]# docker network ls\nnetwork id          name                driver              scope\nb3634bbd8943        bridge              bridge              local\n062082493d3a        custom_network      bridge              local\n885da101da7d        host                host                local\nf4f1b3cf1b7f        none                null                local\n\n\n1\n2\n3\n4\n5\n6\n\n\néè¿èªå®ä¹ç½ç»æ¨¡å¼ custom_network åå»ºå®¹å¨ï¼\n\ndocker run -di --name bbox05 --net custom_network busybox\n\n\n1\n\n\néè¿ docker inspect å®¹å¨åç§° | id æ¥çå®¹å¨çç½ç»ä¿¡æ¯ï¼å¨ networksettings èç¹ä¸­å¯ä»¥çå°è¯¦ç»ä¿¡æ¯ã\n\n\n\n\n# è¿æ¥ç½ç»\n\néè¿ docker network connect ç½ç»åç§° å®¹å¨åç§° ä¸ºå®¹å¨è¿æ¥æ°çç½ç»æ¨¡å¼ã\n\n\n\ndocker network connect bridge bbox05\n\n\n1\n\n\néè¿ docker inspect å®¹å¨åç§° | id åæ¬¡æ¥çå®¹å¨çç½ç»ä¿¡æ¯ï¼å¤å¢å äºé»è®¤ç bridgeã\n\n\n\n\n# æ­å¼ç½ç»\n\néè¿ docker network disconnect ç½ç»åç§° å®¹å¨åç§° å½ä»¤æ­å¼ç½ç»ã\n\ndocker network disconnect custom_network bbox05\n\n\n1\n\n\néè¿ docker inspect å®¹å¨åç§° | id åæ¬¡æ¥çå®¹å¨çç½ç»ä¿¡æ¯ï¼åç°åªå©ä¸é»è®¤ç bridgeã\n\n\n\n\n# ç§»é¤ç½ç»\n\nå¯ä»¥éè¿ docker network rm ç½ç»åç§° å½ä»¤ç§»é¤èªå®ä¹ç½ç»æ¨¡å¼ï¼ç½ç»æ¨¡å¼ç§»é¤æåä¼è¿åç½ç»æ¨¡å¼åç§°ã\n\ndocker network rm custom_network\n\n\n1\n\n\næ³¨æï¼å¦æéè¿æä¸ªèªå®ä¹ç½ç»æ¨¡å¼åå»ºäºå®¹å¨ï¼åè¯¥ç½ç»æ¨¡å¼æ æ³å é¤ã\n\n\n# å®¹å¨é´ç½ç»éä¿¡\n\næ¥ä¸æ¥æä»¬éè¿æå­¦çç¥è¯å®ç°å®¹å¨é´çç½ç»éä¿¡ãé¦åæç¡®ä¸ç¹ï¼å®¹å¨ä¹é´è¦äºç¸éä¿¡ï¼å¿é¡»è¦æå±äºåä¸ä¸ªç½ç»çç½å¡ã\n\næä»¬ååå»ºä¸¤ä¸ªåºäºé»è®¤ç bridge ç½ç»æ¨¡å¼çå®¹å¨ã\n\ndocker run -di --name default_bbox01 busybox\n\n\n1\n\n\néè¿ docker network inspect bridge æ¥çä¸¤å®¹å¨çå·ä½ ip ä¿¡æ¯ã\n\n\n\nç¶åæµè¯ä¸¤å®¹å¨é´æ¯å¦å¯ä»¥è¿è¡ç½ç»éä¿¡ã\n\n\n\nç»è¿æµè¯ï¼ä»ç»æå¾ç¥ä¸¤ä¸ªå±äºåä¸ä¸ªç½ç»çå®¹å¨æ¯å¯ä»¥è¿è¡ç½ç»éä¿¡çï¼ä½æ¯ ip å°åå¯è½æ¯ä¸åºå®çï¼æè¢«æ´æ¹çæåµåçï¼é£å®¹å¨åææéä¿¡ç ip å°åä¹éè¦è¿è¡æ´æ¹ï¼è½å¦ä½¿ç¨å®¹å¨åç§°è¿è¡ç½ç»éä¿¡ï¼ç»§ç»­æµè¯ã\n\n\n\nç»è¿æµè¯ï¼ä»ç»æå¾ç¥ä½¿ç¨å®¹å¨è¿è¡ç½ç»éä¿¡æ¯ä¸è¡çï¼é£æä¹å®ç°è¿ä¸ªåè½å¢ï¼\n\nä» docker 1.10 çæ¬å¼å§ï¼docker daemon å®ç°äºä¸ä¸ªååµç dns serverï¼ä½¿å®¹å¨å¯ä»¥ç´æ¥éè¿å®¹å¨åç§°éä¿¡ãæ¹æ³å¾ç®åï¼åªè¦å¨åå»ºå®¹å¨æ¶ä½¿ç¨ --name ä¸ºå®¹å¨å½åå³å¯ã\n\nä½æ¯ä½¿ç¨ docker dns æä¸ªéå¶ï¼åªè½å¨ user-defined ç½ç»ä¸­ä½¿ç¨ãä¹å°±æ¯è¯´ï¼é»è®¤ç bridge ç½ç»æ¯æ æ³ä½¿ç¨ dns çï¼æä»¥æä»¬å°±éè¦èªå®ä¹ç½ç»ã\n\næä»¬ååºäº bridge ç½ç»æ¨¡å¼åå»ºèªå®ä¹ç½ç» custom_networkï¼ç¶ååå»ºä¸¤ä¸ªåºäºèªå®ä¹ç½ç»æ¨¡å¼çå®¹å¨ã\n\ndocker run -di --name custom_bbox01 --net custom_network busybox\n\n\n1\n\n\néè¿ docker network inspect custom_network æ¥çä¸¤å®¹å¨çå·ä½ ip ä¿¡æ¯ã\n\n\n\nç¶åæµè¯ä¸¤å®¹å¨é´æ¯å¦å¯ä»¥è¿è¡ç½ç»éä¿¡ï¼åå«ä½¿ç¨å·ä½ ip åå®¹å¨åç§°è¿è¡ç½ç»éä¿¡ã\n\n\n\nç»è¿æµè¯ï¼ä»ç»æå¾ç¥ä¸¤ä¸ªå±äºåä¸ä¸ªèªå®ä¹ç½ç»çå®¹å¨æ¯å¯ä»¥è¿è¡ç½ç»éä¿¡çï¼å¹¶ä¸å¯ä»¥ä½¿ç¨å®¹å¨åç§°è¿è¡ç½ç»éä¿¡ã\n\né£å¦ææ­¤æ¶æå¸æ bridge ç½ç»ä¸çå®¹å¨å¯ä»¥å custom_network ç½ç»ä¸çå®¹å¨è¿è¡ç½ç»åè¯¥å¦ä½æä½ï¼å¶å®ç­æ¡ä¹éå¸¸ç®åï¼è®© bridge ç½ç»ä¸çå®¹å¨è¿æ¥è³æ°ç custom_network ç½ç»å³å¯ã\n\ndocker network connect custom_network default_bbox01\n\n\n1\n\n\n\n\nå­¦å®å®¹å¨ç½ç»éä¿¡ï¼å¤§å®¶å°±å¯ä»¥ç»ä¹ ä½¿ç¨å¤ä¸ªå®¹å¨å®æå¸¸è§åºç¨éç¾¤çé¨ç½²äºãåé¢å°±è¯¥å­¦ä¹  docker è¿é¶é¨åçåå®¹ docker compose å docker swarmã\n\nåèï¼",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Docker æ­å»º Redis Cluster éç¾¤",frontmatter:{title:"Docker æ­å»º Redis Cluster éç¾¤",date:"2022-02-03T00:03:52.000Z",permalink:"/pages/457953/",categories:["åç«¯","Docker"],tags:[null]},regularPath:"/25.%E8%BF%90%E7%BB%B4/50.Docker/05.Docker%20%E6%90%AD%E5%BB%BA%20Redis%20Cluster%20%E9%9B%86%E7%BE%A4.html",relativePath:"25.è¿ç»´/50.Docker/05.Docker æ­å»º Redis Cluster éç¾¤.md",key:"v-dc7c1222",path:"/pages/457953/",headers:[{level:2,title:"ç¯å¢",slug:"ç¯å¢",normalizedTitle:"ç¯å¢",charIndex:120},{level:2,title:"æ­å»º",slug:"æ­å»º",normalizedTitle:"æ­å»º",charIndex:10},{level:3,title:"ç¼å Redis éç½®æä»¶",slug:"ç¼å-redis-éç½®æä»¶",normalizedTitle:"ç¼å redis éç½®æä»¶",charIndex:698},{level:3,title:"åå»º Redis å®¹å¨",slug:"åå»º-redis-å®¹å¨",normalizedTitle:"åå»º redis å®¹å¨",charIndex:717},{level:3,title:"åå»º Redis Cluster éç¾¤",slug:"åå»º-redis-cluster-éç¾¤",normalizedTitle:"åå»º redis cluster éç¾¤",charIndex:734},{level:2,title:"æ¥çéç¾¤ç¶æ",slug:"æ¥çéç¾¤ç¶æ",normalizedTitle:"æ¥çéç¾¤ç¶æ",charIndex:9546},{level:3,title:"æ£æ¥éç¾¤ç¶æ",slug:"æ£æ¥éç¾¤ç¶æ",normalizedTitle:"æ£æ¥éç¾¤ç¶æ",charIndex:9670},{level:3,title:"æ¥çéç¾¤ä¿¡æ¯åèç¹ä¿¡æ¯",slug:"æ¥çéç¾¤ä¿¡æ¯åèç¹ä¿¡æ¯",normalizedTitle:"æ¥çéç¾¤ä¿¡æ¯åèç¹ä¿¡æ¯",charIndex:9742},{level:3,title:"SET/GET",slug:"set-get",normalizedTitle:"set/get",charIndex:9881},{level:2,title:"å®¢æ·ç«¯è¿æ¥",slug:"å®¢æ·ç«¯è¿æ¥",normalizedTitle:"å®¢æ·ç«¯è¿æ¥",charIndex:10847}],headersStr:"ç¯å¢ æ­å»º ç¼å Redis éç½®æä»¶ åå»º Redis å®¹å¨ åå»º Redis Cluster éç¾¤ æ¥çéç¾¤ç¶æ æ£æ¥éç¾¤ç¶æ æ¥çéç¾¤ä¿¡æ¯åèç¹ä¿¡æ¯ SET/GET å®¢æ·ç«¯è¿æ¥",content:"ä½¿ç¨ Docker æ­å»º Redis Clusterï¼æéè¦çç¯èå°±æ¯å®¹å¨éä¿¡çé®é¢ï¼è¿ä¸åæä»¬å¨ä¹åçæç« ä¸­å·²ç»ç»å¤§å®¶è§£å³äºãDocker ç½ç»æ¨¡å¼è¯¦è§£åå®¹å¨é´ç½ç»éä¿¡ãï¼æ¬ç¯æç« ä¸»è¦ç»ä¹ ä½¿ç¨å¤ä¸ªå®¹å¨å®æ Redis Cluster éç¾¤ç¯å¢çæ­å»ºï¼é¡ºä¾¿ä¸ºå­¦ä¹  Docker Compose éºéºè·¯ãä¿è¯è¯´æ²¡æå¯¹æ¯å°±æ²¡æä¼¤å®³ï¼éè¿å¯¹æ¯æè½æåå° Docker Compose çå¥½å¤ ðã\n\nå³äº Redis Cluster éç¾¤æ´å¤çåå®¹è¯·éè¯»ãæéä¿ææç Redis æ¶ææ¨¡å¼è¯¦è§£ãã\n\næç§ Redis å®ç½ï¼https://redis.io/topics/cluster-tutorial çæç¤ºï¼ä¸ºäºä½¿ Docker ä¸ Redis Cluster å¼å®¹ï¼æ¨éè¦ä½¿ç¨ Docker ç host ç½ç»æ¨¡å¼ã\n\nhost ç½ç»æ¨¡å¼éè¦å¨åå»ºå®¹å¨æ¶éè¿åæ° --net host æè --network host æå®ï¼host ç½ç»æ¨¡å¼å¯ä»¥è®©å®¹å¨å±äº«å®¿ä¸»æºç½ç»æ ï¼å®¹å¨å°ä¸ä¼èæåºèªå·±çç½å¡ï¼éç½®èªå·±ç IP ç­ï¼èæ¯ä½¿ç¨å®¿ä¸»æºç IP åç«¯å£ã\n\n\n\n\n# ç¯å¢\n\nä¸ºäºè®©ç¯å¢æ´å çå®ï¼æ¬æä½¿ç¨å¤æºç¯å¢ï¼\n\n * 192.168.10.10\n\n * 192.168.10.11\n\næ¯å°æºå¨æä½¿ç¨çåºç¡è®¾æ½ç¯å¢å¦ä¸ï¼\n\n * CentOS 7.8.2003\n\n * Docker version 19.03.12\n\n\n\n\n# æ­å»º\n\næ´ä½æ­å»ºæ­¥éª¤ä¸»è¦åä¸ºä»¥ä¸å æ­¥ï¼\n\n * ä¸è½½ Redis éåï¼å¶å®è¿æ­¥å¯ä»¥çç¥ï¼å ä¸ºåå»ºå®¹å¨æ¶ï¼å¦ææ¬å°éåä¸å­å¨ï¼å°±ä¼å»è¿ç¨æåï¼ï¼\n\n * ç¼å Redis éç½®æä»¶ï¼\n\n * åå»º Redis å®¹å¨ï¼\n\n * åå»º Redis Cluster éç¾¤ã\n\n\n# ç¼å Redis éç½®æä»¶\n\n# åå»ºç®å½åæä»¶\n\nåå«å¨ 192.168.10.10 å 192.168.10.11 ä¸¤å°æºå¨ä¸æ§è¡ä»¥ä¸æä½ã\n\n# åå»ºç®å½\nmkdir -p /usr/local/docker-redis/redis-cluster\n# åæ¢è³æå®ç®å½\ncd /usr/local/docker-redis/redis-cluster/\n# ç¼å redis-cluster.tmpl æä»¶\nvi redis-cluster.tmpl\n\n\n1\n2\n3\n4\n5\n6\n\n\n# ç¼åéç½®æä»¶\n\n192.168.10.10 æºå¨ç redis-cluster.tmpl æä»¶åå®¹å¦ä¸ï¼\n\nport ${PORT}\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.10\ncluster-announce-port ${PORT}\ncluster-announce-bus-port 1${PORT}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n192.168.10.11 æºå¨ç redis-cluster.tmpl æä»¶åå®¹å¦ä¸ï¼\n\nport ${PORT}\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.10\ncluster-announce-port ${PORT}\ncluster-announce-bus-port 1${PORT}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n * portï¼èç¹ç«¯å£ï¼\n\n * requirepassï¼æ·»å è®¿é®è®¤è¯ï¼\n\n * masterauthï¼å¦æä¸»èç¹å¼å¯äºè®¿é®è®¤è¯ï¼ä»èç¹è®¿é®ä¸»èç¹éè¦è®¤è¯ï¼\n\n * protected-modeï¼ä¿æ¤æ¨¡å¼ï¼é»è®¤å¼ yesï¼å³å¼å¯ãå¼å¯ä¿æ¤æ¨¡å¼ä»¥åï¼ééç½® bind ip æèè®¾ç½®è®¿é®å¯ç ï¼å³é­ä¿æ¤æ¨¡å¼ï¼å¤é¨ç½ç»å¯ä»¥ç´æ¥è®¿é®ï¼\n\n * daemonizeï¼æ¯å¦ä»¥å®æ¤çº¿ç¨çæ¹å¼å¯å¨ï¼åå°å¯å¨ï¼ï¼é»è®¤ noï¼\n\n * appendonlyï¼æ¯å¦å¼å¯ AOF æä¹åæ¨¡å¼ï¼é»è®¤ noï¼\n\n * cluster-enabledï¼æ¯å¦å¼å¯éç¾¤æ¨¡å¼ï¼é»è®¤ noï¼\n\n * cluster-config-fileï¼éç¾¤èç¹ä¿¡æ¯æä»¶ï¼\n\n * cluster-node-timeoutï¼éç¾¤èç¹è¿æ¥è¶æ¶æ¶é´ï¼\n\n * cluster-announce-ipï¼éç¾¤èç¹ IPï¼å¡«åå®¿ä¸»æºç IPï¼\n\n * cluster-announce-portï¼éç¾¤èç¹æ å°ç«¯å£ï¼\n\n * cluster-announce-bus-portï¼éç¾¤èç¹æ»çº¿ç«¯å£ã\n\n> æ¯ä¸ª Redis éç¾¤èç¹é½éè¦æå¼ä¸¤ä¸ª TCP è¿æ¥ãä¸ä¸ªç¨äºä¸ºå®¢æ·ç«¯æä¾æå¡çæ­£å¸¸ Redis TCP ç«¯å£ï¼ä¾å¦ 6379ãè¿æä¸ä¸ªåºäº 6379 ç«¯å£å  10000 çç«¯å£ï¼æ¯å¦ 16379ã\n\n> ç¬¬äºä¸ªç«¯å£ç¨äºéç¾¤æ»çº¿ï¼è¿æ¯ä¸ä¸ªä½¿ç¨äºè¿å¶åè®®çèç¹å°èç¹éä¿¡ééãèç¹ä½¿ç¨éç¾¤æ»çº¿è¿è¡æéæ£æµãéç½®æ´æ°ãæéè½¬ç§»ææç­ç­ãå®¢æ·ç«¯æ°¸è¿ä¸è¦å°è¯ä¸éç¾¤æ»çº¿ç«¯å£éä¿¡ï¼ä¸æ­£å¸¸ç Redis å½ä»¤ç«¯å£éä¿¡å³å¯ï¼ä½æ¯è¯·ç¡®ä¿é²ç«å¢ä¸­çè¿ä¸¤ä¸ªç«¯å£é½å·²ç»æå¼ï¼å¦å Redis éç¾¤èç¹å°æ æ³éä¿¡ã\n\nå¨ 192.168.10.10 æºå¨ç redis-cluster ç®å½ä¸æ§è¡ä»¥ä¸å½ä»¤ï¼\n\nfor port in `seq 6371 6373`; do \\\n  mkdir -p ${port}/conf \\\n  && PORT=${port} envsubst < redis-cluster.tmpl > ${port}/conf/redis.conf \\\n  && mkdir -p ${port}/data;\\\ndone\n\n\n1\n2\n3\n4\n5\n\n\nå¨ 192.168.10.11 æºå¨ç redis-cluster ç®å½ä¸æ§è¡ä»¥ä¸å½ä»¤ï¼\n\nfor port in `seq 6374 6376`; do \\\n  mkdir -p ${port}/conf \\\n  && PORT=${port} envsubst < redis-cluster.tmpl > ${port}/conf/redis.conf \\\n  && mkdir -p ${port}/data;\\\ndone\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä¸¤æ®µ shell for è¯­å¥ï¼ææå°±æ¯å¾ªç¯åå»º 6371 ~ 6376 ç¸å³çç®å½åæä»¶ã\n\nå¨ 192.168.10.10 æºå¨æ§è¡æ¥çå½ä»¤ç»æå¦ä¸ï¼å¦ææ²¡æ tree å½ä»¤åå®è£ yum install -y treeã\n\n\n\nå¨ 192.168.10.11 æºå¨æ§è¡æ¥çå½ä»¤ç»æå¦ä¸ã\n\n\n\nä»¥ä¸åå®¹ä¸ºæ¯ä¸ªèç¹çéç½®æä»¶è¯¦ç»ä¿¡æ¯ã\n\n============================== 192.168.10.10 ==============================\n[root@localhost redis-cluster]# cat /usr/local/docker-redis/redis-cluster/637{1..3}/conf/redis.conf\nport 6371\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.10\ncluster-announce-port 6371\ncluster-announce-bus-port 16371\n\nport 6372\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.10\ncluster-announce-port 6372\ncluster-announce-bus-port 16372\n\nport 6373\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.10\ncluster-announce-port 6373\ncluster-announce-bus-port 16373\n============================== 192.168.10.10 ==============================\n\n============================== 192.168.10.11 ==============================\n[root@localhost redis-cluster]# cat /usr/local/docker-redis/redis-cluster/637{4..6}/conf/redis.conf\nport 6374\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.11\ncluster-announce-port 6374\ncluster-announce-bus-port 16374\n\nport 6375\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.11\ncluster-announce-port 6375\ncluster-announce-bus-port 16375\n\nport 6376\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.11\ncluster-announce-port 6376\ncluster-announce-bus-port 16376\n============================== 192.168.10.11 ==============================\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n\n\n\n# åå»º Redis å®¹å¨\n\n# åå»ºå®¹å¨\n\nå°å®¿ä¸»æºç 6371 ~ 6376 ä¹é´çç«¯å£ä¸ 6 ä¸ª Redis å®¹å¨æ å°ï¼å¹¶å°å®¿ä¸»æºçç®å½ä¸å®¹å¨åçç®å½è¿è¡æ å°ï¼ç®å½æè½½ï¼ãè®°å¾æå®ç½ç»æ¨¡å¼ï¼ä½¿ç¨ host ç½ç»æ¨¡å¼ã\n\nå¨ 192.168.10.10 æºå¨æ§è¡ä»¥ä¸å½ä»¤ï¼\n\nfor port in $(seq 6371 6373); do \\\n  docker run -di --restart always --name redis-${port} --net host \\\n  -v /usr/local/docker-redis/redis-cluster/${port}/conf/redis.conf:/usr/local/etc/redis/redis.conf \\\n  -v /usr/local/docker-redis/redis-cluster/${port}/data:/data \\\n  redis redis-server /usr/local/etc/redis/redis.conf; \\\ndone\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¨ 192.168.10.11 æºå¨æ§è¡ä»¥ä¸å½ä»¤ï¼\n\nfor port in $(seq 6374 6376); do \\\n  docker run -di --restart always --name redis-${port} --net host \\\n  -v /usr/local/docker-redis/redis-cluster/${port}/conf/redis.conf:/usr/local/etc/redis/redis.conf \\\n  -v /usr/local/docker-redis/redis-cluster/${port}/data:/data \\\n  redis redis-server /usr/local/etc/redis/redis.conf; \\\ndone\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¨ 192.168.10.10 æºå¨æ§è¡ docker ps -n 3 æ¥çå®¹å¨æ¯å¦åå»ºæåã\n\n\n\nå¨ 192.168.10.11 æºå¨æ§è¡ docker ps -n 3 æ¥çå®¹å¨æ¯å¦åå»ºæåã\n\n\n\n\n# åå»º Redis Cluster éç¾¤\n\néä¾¿è¿å¥ä¸ä¸ªå®¹å¨èç¹ï¼å¹¶è¿å¥ /usr/local/bin/ ç®å½ï¼\n\n# è¿å¥å®¹å¨\ndocker exec -it redis-6371 bash\n# åæ¢è³æå®ç®å½\ncd /usr/local/bin/\n\n\n1\n2\n3\n4\n\n\næ¥ä¸æ¥æä»¬å°±å¯ä»¥éè¿ä»¥ä¸å½ä»¤å®ç° Redis Cluster éç¾¤çåå»ºã\n\nredis-cli -a 1234 --cluster create 192.168.10.10:6371 192.168.10.10:6372 192.168.10.10:6373 192.168.10.11:6374 192.168.10.11:6375 192.168.10.11:6376 --cluster-replicas 1\n\n\n1\n\n\nåºç°éæ©æç¤ºä¿¡æ¯ï¼è¾å¥ yesï¼ç»æå¦ä¸æç¤ºï¼\n\n\n\néç¾¤åå»ºæåå¦ä¸ï¼\n\n\n\nä»¥ä¸åå®¹æ¯åå»ºéç¾¤æ¶è¿åçè¯¦ç»ä¿¡æ¯ï¼ä¹å°±æ¯ä¸ä¸¤å¹å¾ä¸­çææåå®¹ã\n\nroot@localhost:/usr/local/bin# redis-cli -a 1234 --cluster create 192.168.10.10:6371 192.168.10.10:6372 192.168.10.10:6373 192.168.10.11:6374 192.168.10.11:6375 192.168.10.11:6376 --cluster-replicas 1\nWarning: Using a password with '-a' or '-u' option on the command line interface may not be safe.\n>>> Performing hash slots allocation on 6 nodes...\nMaster[0] -> Slots 0 - 5460\nMaster[1] -> Slots 5461 - 10922\nMaster[2] -> Slots 10923 - 16383\nAdding replica 192.168.10.11:6376 to 192.168.10.10:6371\nAdding replica 192.168.10.10:6373 to 192.168.10.11:6374\nAdding replica 192.168.10.11:6375 to 192.168.10.10:6372\nM: 299cf79ddafc83dced27f628f1f82dac483fbc4e 192.168.10.10:6371\n   slots:[0-5460] (5461 slots) master\nM: ac805b90b6e20e26dc4268454bb2855beea6cc19 192.168.10.10:6372\n   slots:[10923-16383] (5461 slots) master\nS: db35494fcc5db0c88d27da7885c817e6cdcc9373 192.168.10.10:6373\n   replicates 7013270480d37eeab79b9cd0272e934d4548136a\nM: 7013270480d37eeab79b9cd0272e934d4548136a 192.168.10.11:6374\n   slots:[5461-10922] (5462 slots) master\nS: 8435e1b0d51f2690c5f94f9a5682a4ac34e94326 192.168.10.11:6375\n   replicates ac805b90b6e20e26dc4268454bb2855beea6cc19\nS: 7b13c16fa6fe8e13cdc0b4846b87edffed55c62e 192.168.10.11:6376\n   replicates 299cf79ddafc83dced27f628f1f82dac483fbc4e\nCan I set the above configuration? (type 'yes' to accept): yes\n>>> Nodes configuration updated\n>>> Assign a different config epoch to each node\n>>> Sending CLUSTER MEET messages to join the cluster\nWaiting for the cluster to join\n.\n>>> Performing Cluster Check (using node 192.168.10.10:6371)\nM: 299cf79ddafc83dced27f628f1f82dac483fbc4e 192.168.10.10:6371\n   slots:[0-5460] (5461 slots) master\n   1 additional replica(s)\nS: 8435e1b0d51f2690c5f94f9a5682a4ac34e94326 192.168.10.11:6375\n   slots: (0 slots) slave\n   replicates ac805b90b6e20e26dc4268454bb2855beea6cc19\nS: db35494fcc5db0c88d27da7885c817e6cdcc9373 192.168.10.10:6373\n   slots: (0 slots) slave\n   replicates 7013270480d37eeab79b9cd0272e934d4548136a\nS: 7b13c16fa6fe8e13cdc0b4846b87edffed55c62e 192.168.10.11:6376\n   slots: (0 slots) slave\n   replicates 299cf79ddafc83dced27f628f1f82dac483fbc4e\nM: 7013270480d37eeab79b9cd0272e934d4548136a 192.168.10.11:6374\n   slots:[5461-10922] (5462 slots) master\n   1 additional replica(s)\nM: ac805b90b6e20e26dc4268454bb2855beea6cc19 192.168.10.10:6372\n   slots:[10923-16383] (5461 slots) master\n   1 additional replica(s)\n[OK] All nodes agree about slots configuration.\n>>> Check for open slots...\n>>> Check slots coverage...\n[OK] All 16384 slots covered.\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n\n\nè³æ­¤ä¸ä¸ªé«å¯ç¨ç Redis Cluster éç¾¤æ­å»ºå®æï¼å¦ä¸å¾æç¤ºï¼è¯¥éç¾¤ä¸­åå« 6 ä¸ª Redis èç¹ï¼3 ä¸» 3 ä»ãä¸ä¸ªä¸»èç¹ä¼åéæ§½ï¼å¤çå®¢æ·ç«¯çå½ä»¤è¯·æ±ï¼èä»èç¹å¯ç¨å¨ä¸»èç¹æéåï¼é¡¶æ¿ä¸»èç¹ã\n\n\n\n\n# æ¥çéç¾¤ç¶æ\n\næä»¬åè¿å¥å®¹å¨ï¼ç¶åéè¿ä¸äºéç¾¤å¸¸ç¨çå½ä»¤æ¥çä¸ä¸éç¾¤çç¶æã\n\n# è¿å¥å®¹å¨\ndocker exec -it redis-6371 bash\n# åæ¢è³æå®ç®å½\ncd /usr/local/bin/\n\n\n1\n2\n3\n4\n\n\n\n# æ£æ¥éç¾¤ç¶æ\n\nredis-cli -a 1234 --cluster check 192.168.10.11:6375\n\n\n1\n\n\n\n\n\n# æ¥çéç¾¤ä¿¡æ¯åèç¹ä¿¡æ¯\n\n# è¿æ¥è³éç¾¤æä¸ªèç¹\nredis-cli -c -a 1234 -h 192.168.10.11 -p 6376\n# æ¥çéç¾¤ä¿¡æ¯\ncluster info\n# æ¥çéç¾¤ç»ç¹ä¿¡æ¯\ncluster nodes\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n\n\n# SET/GET\n\nå¨ 6371 èç¹ä¸­æ§è¡åå¥åè¯»åï¼å½ä»¤å¦ä¸ï¼\n\n# è¿å¥å®¹å¨å¹¶è¿æ¥è³éç¾¤æä¸ªèç¹\ndocker exec -it redis-6371 /usr/local/bin/redis-cli -c -a 1234 -h 192.168.10.10 -p 6371\n# åå¥æ°æ®\nset name mrhelloworld\nset aaa 111\nset bbb 222\n# è¯»åæ°æ®\nget name\nget aaa\nget bbb\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n\nå«çæ¥ï¼è®©ææ¥è§£éä¸ä¸ä¸å¾ä¸­çæä½è¿ç¨ï¼\n\n * é¦åè¿å¥å®¹å¨å¹¶è¿æ¥è³éç¾¤æä¸ªèç¹ï¼\n\n * ç¶åæ§è¡ç¬¬ä¸ä¸ª set å½ä»¤ set name mrhelloworldï¼name é®æ ¹æ®åå¸å½æ°è¿ç®ä»¥åå¾å°çå¼ä¸º [5798]ãå½åéç¾¤ç¯å¢çæ§½åéæåµä¸ºï¼[0-5460] 6371 èç¹ï¼[5461-10922] 6374 èç¹ï¼[10923-16383] 6372 èç¹ï¼æä»¥è¯¥é®çå­å¨å°±è¢«åéå°äº 6374 èç¹ä¸ï¼\n\n * åæ¥çç¬¬äºä¸ª set å½ä»¤ set aaaï¼è¿éå¤§å®¶å¯è½ä¼æä¸äºçé®ï¼ä¸ºä»ä¹çä¸å° aaa é®æ ¹æ®åå¸å½æ°è¿ç®ä»¥åå¾å°çå¼ï¼å ä¸ºåæéå®åè³ 6374 èç¹æå¥äºæ°æ®ï¼æ­¤æ¶å¦æè¿ææ°æ®æå¥ï¼æ­£å¥½é®æ ¹æ®åå¸å½æ°è¿ç®ä»¥åå¾å°çå¼ä¹è¿å¨è¯¥èç¹çèå´åï¼é£ä¹ç´æ¥æå¥æ°æ®å³å¯ï¼\n\n * æ¥çæ¯ç¬¬ä¸ä¸ª set å½ä»¤ set bbbï¼bbb é®æ ¹æ®åå¸å½æ°è¿ç®ä»¥åå¾å°çå¼ä¸º [5287]ï¼æä»¥è¯¥é®çå­å¨å°±è¢«åéå°äº 6371 èç¹ä¸ï¼\n\n * ç¶åæ¯è¯»åæä½ï¼ç¬¬åä¸ªå½ä»¤ get nameï¼name é®æ ¹æ®åå¸å½æ°è¿ç®ä»¥åå¾å°çå¼ä¸º [5798]ï¼è¢«éå®åè³ 6374 èç¹è¯»åï¼\n\n * ç¬¬äºä¸ªå½ä»¤ get aaaï¼aaa é®æ ¹æ®åå¸å½æ°è¿ç®ä»¥åå¾å°çå¼ä¹å¨ 6374 èç¹ï¼ç´æ¥è¯»åï¼\n\n * ç¬¬å­ä¸ªå½ä»¤ get bbbï¼bbb é®æ ¹æ®åå¸å½æ°è¿ç®ä»¥åå¾å°çå¼ä¸º [5287]ï¼è¢«éå®åè³ 6371 èç¹è¯»åã\n\néè¿ä»¥ä¸æä½æä»¬å¾ç¥ name é®çå­å¨è¢«åéå°äº 6374 èç¹ï¼å¦æç´æ¥è¿æ¥ 6374 èç¹å¹¶è·åè¯¥å¼ä¼æä¹æ ·ï¼æ²¡éï¼ä¸éè¦éå®åèç¹ï¼å ä¸ºæ°æ®å°±å¨è¯¥èç¹ï¼æä»¥ç´æ¥è¯»åè¿åã\n\n\n\n\n# å®¢æ·ç«¯è¿æ¥\n\næåæ¥ä¸æ³¢å®¢æ·ç«¯è¿æ¥æä½ï¼éä¾¿åªä¸ªèç¹ï¼ççå¯å¦éè¿å¤é¨è®¿é® Redis Cluster éç¾¤ã\n\n\n\n\n\nè³æ­¤ä½¿ç¨å¤æºç¯å¢å¤ä¸ªå®¹å¨æ­å»º Redis Cluster éç¾¤ç¯å¢å°±å°è¿éï¼å¶å®æ´ä½æ­å»ºè¿ç¨ä¸ç®ç¹å«éº»ç¦ï¼å ä¸ºï¼\n\n * åå»º Redis éç¾¤éè¦ç¨å° Rubyï¼å¦åå°±å¾èªå·±å³èèç¹æå»ºéç¾¤ï¼èªå·±åéæ§½ï¼\n\n * å¦æä½¿ç¨ Ruby æå»º Redis éç¾¤ï¼å°±éè¦å®è£ Ruby ç¯å¢ï¼\n\n * è Redis ä» 5 çæ¬å¼å§å¯ä»¥ç´æ¥ä½¿ç¨ redis-cli å½ä»¤åå»ºéç¾¤äºï¼å°±çå»äºå¾å¤éº»ç¦äºï¼\n\n * æä»¬è¿ä½¿ç¨äº shell for å¾ªç¯è¯­å¥ç®åäºæå»ºè¿ç¨ï¼å¦åé£äºè¯­å¥ä¸æ¡æ¡æ§è¡ä¹å¤ä½ é¹å¿çã\n\nç»¼ä¸æè¿°ï¼ææ²¡ææ´ç®åçåæ³å¢ï¼å½ç¶æäºï¼ä¸ç¶æå¨è¿è·ä½ åä»ä¹å³å­ã\n\n\n\nDocker Compose å°±å¯ä»¥è§£å³è¿ä¸ªé®é¢ãåé¢æä»¬åå­¦ä¹ ä¸ä¸ä»ä¹æ¯ Docker Composeï¼ç¶åä½¿ç¨ Docker Compose åæ¥æ­å»ºä¸é Redis Cluster éç¾¤ç¯å¢ï¼æåæåè¿ååçåºå«ã\n\n[]: https://xie.infoq.cn/article/a5536b928edd12beb32fcabf9",normalizedContent:"ä½¿ç¨ docker æ­å»º redis clusterï¼æéè¦çç¯èå°±æ¯å®¹å¨éä¿¡çé®é¢ï¼è¿ä¸åæä»¬å¨ä¹åçæç« ä¸­å·²ç»ç»å¤§å®¶è§£å³äºãdocker ç½ç»æ¨¡å¼è¯¦è§£åå®¹å¨é´ç½ç»éä¿¡ãï¼æ¬ç¯æç« ä¸»è¦ç»ä¹ ä½¿ç¨å¤ä¸ªå®¹å¨å®æ redis cluster éç¾¤ç¯å¢çæ­å»ºï¼é¡ºä¾¿ä¸ºå­¦ä¹  docker compose éºéºè·¯ãä¿è¯è¯´æ²¡æå¯¹æ¯å°±æ²¡æä¼¤å®³ï¼éè¿å¯¹æ¯æè½æåå° docker compose çå¥½å¤ ðã\n\nå³äº redis cluster éç¾¤æ´å¤çåå®¹è¯·éè¯»ãæéä¿ææç redis æ¶ææ¨¡å¼è¯¦è§£ãã\n\næç§ redis å®ç½ï¼https://redis.io/topics/cluster-tutorial çæç¤ºï¼ä¸ºäºä½¿ docker ä¸ redis cluster å¼å®¹ï¼æ¨éè¦ä½¿ç¨ docker ç host ç½ç»æ¨¡å¼ã\n\nhost ç½ç»æ¨¡å¼éè¦å¨åå»ºå®¹å¨æ¶éè¿åæ° --net host æè --network host æå®ï¼host ç½ç»æ¨¡å¼å¯ä»¥è®©å®¹å¨å±äº«å®¿ä¸»æºç½ç»æ ï¼å®¹å¨å°ä¸ä¼èæåºèªå·±çç½å¡ï¼éç½®èªå·±ç ip ç­ï¼èæ¯ä½¿ç¨å®¿ä¸»æºç ip åç«¯å£ã\n\n\n\n\n# ç¯å¢\n\nä¸ºäºè®©ç¯å¢æ´å çå®ï¼æ¬æä½¿ç¨å¤æºç¯å¢ï¼\n\n * 192.168.10.10\n\n * 192.168.10.11\n\næ¯å°æºå¨æä½¿ç¨çåºç¡è®¾æ½ç¯å¢å¦ä¸ï¼\n\n * centos 7.8.2003\n\n * docker version 19.03.12\n\n\n\n\n# æ­å»º\n\næ´ä½æ­å»ºæ­¥éª¤ä¸»è¦åä¸ºä»¥ä¸å æ­¥ï¼\n\n * ä¸è½½ redis éåï¼å¶å®è¿æ­¥å¯ä»¥çç¥ï¼å ä¸ºåå»ºå®¹å¨æ¶ï¼å¦ææ¬å°éåä¸å­å¨ï¼å°±ä¼å»è¿ç¨æåï¼ï¼\n\n * ç¼å redis éç½®æä»¶ï¼\n\n * åå»º redis å®¹å¨ï¼\n\n * åå»º redis cluster éç¾¤ã\n\n\n# ç¼å redis éç½®æä»¶\n\n# åå»ºç®å½åæä»¶\n\nåå«å¨ 192.168.10.10 å 192.168.10.11 ä¸¤å°æºå¨ä¸æ§è¡ä»¥ä¸æä½ã\n\n# åå»ºç®å½\nmkdir -p /usr/local/docker-redis/redis-cluster\n# åæ¢è³æå®ç®å½\ncd /usr/local/docker-redis/redis-cluster/\n# ç¼å redis-cluster.tmpl æä»¶\nvi redis-cluster.tmpl\n\n\n1\n2\n3\n4\n5\n6\n\n\n# ç¼åéç½®æä»¶\n\n192.168.10.10 æºå¨ç redis-cluster.tmpl æä»¶åå®¹å¦ä¸ï¼\n\nport ${port}\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.10\ncluster-announce-port ${port}\ncluster-announce-bus-port 1${port}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n192.168.10.11 æºå¨ç redis-cluster.tmpl æä»¶åå®¹å¦ä¸ï¼\n\nport ${port}\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.10\ncluster-announce-port ${port}\ncluster-announce-bus-port 1${port}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n * portï¼èç¹ç«¯å£ï¼\n\n * requirepassï¼æ·»å è®¿é®è®¤è¯ï¼\n\n * masterauthï¼å¦æä¸»èç¹å¼å¯äºè®¿é®è®¤è¯ï¼ä»èç¹è®¿é®ä¸»èç¹éè¦è®¤è¯ï¼\n\n * protected-modeï¼ä¿æ¤æ¨¡å¼ï¼é»è®¤å¼ yesï¼å³å¼å¯ãå¼å¯ä¿æ¤æ¨¡å¼ä»¥åï¼ééç½® bind ip æèè®¾ç½®è®¿é®å¯ç ï¼å³é­ä¿æ¤æ¨¡å¼ï¼å¤é¨ç½ç»å¯ä»¥ç´æ¥è®¿é®ï¼\n\n * daemonizeï¼æ¯å¦ä»¥å®æ¤çº¿ç¨çæ¹å¼å¯å¨ï¼åå°å¯å¨ï¼ï¼é»è®¤ noï¼\n\n * appendonlyï¼æ¯å¦å¼å¯ aof æä¹åæ¨¡å¼ï¼é»è®¤ noï¼\n\n * cluster-enabledï¼æ¯å¦å¼å¯éç¾¤æ¨¡å¼ï¼é»è®¤ noï¼\n\n * cluster-config-fileï¼éç¾¤èç¹ä¿¡æ¯æä»¶ï¼\n\n * cluster-node-timeoutï¼éç¾¤èç¹è¿æ¥è¶æ¶æ¶é´ï¼\n\n * cluster-announce-ipï¼éç¾¤èç¹ ipï¼å¡«åå®¿ä¸»æºç ipï¼\n\n * cluster-announce-portï¼éç¾¤èç¹æ å°ç«¯å£ï¼\n\n * cluster-announce-bus-portï¼éç¾¤èç¹æ»çº¿ç«¯å£ã\n\n> æ¯ä¸ª redis éç¾¤èç¹é½éè¦æå¼ä¸¤ä¸ª tcp è¿æ¥ãä¸ä¸ªç¨äºä¸ºå®¢æ·ç«¯æä¾æå¡çæ­£å¸¸ redis tcp ç«¯å£ï¼ä¾å¦ 6379ãè¿æä¸ä¸ªåºäº 6379 ç«¯å£å  10000 çç«¯å£ï¼æ¯å¦ 16379ã\n\n> ç¬¬äºä¸ªç«¯å£ç¨äºéç¾¤æ»çº¿ï¼è¿æ¯ä¸ä¸ªä½¿ç¨äºè¿å¶åè®®çèç¹å°èç¹éä¿¡ééãèç¹ä½¿ç¨éç¾¤æ»çº¿è¿è¡æéæ£æµãéç½®æ´æ°ãæéè½¬ç§»ææç­ç­ãå®¢æ·ç«¯æ°¸è¿ä¸è¦å°è¯ä¸éç¾¤æ»çº¿ç«¯å£éä¿¡ï¼ä¸æ­£å¸¸ç redis å½ä»¤ç«¯å£éä¿¡å³å¯ï¼ä½æ¯è¯·ç¡®ä¿é²ç«å¢ä¸­çè¿ä¸¤ä¸ªç«¯å£é½å·²ç»æå¼ï¼å¦å redis éç¾¤èç¹å°æ æ³éä¿¡ã\n\nå¨ 192.168.10.10 æºå¨ç redis-cluster ç®å½ä¸æ§è¡ä»¥ä¸å½ä»¤ï¼\n\nfor port in `seq 6371 6373`; do \\\n  mkdir -p ${port}/conf \\\n  && port=${port} envsubst < redis-cluster.tmpl > ${port}/conf/redis.conf \\\n  && mkdir -p ${port}/data;\\\ndone\n\n\n1\n2\n3\n4\n5\n\n\nå¨ 192.168.10.11 æºå¨ç redis-cluster ç®å½ä¸æ§è¡ä»¥ä¸å½ä»¤ï¼\n\nfor port in `seq 6374 6376`; do \\\n  mkdir -p ${port}/conf \\\n  && port=${port} envsubst < redis-cluster.tmpl > ${port}/conf/redis.conf \\\n  && mkdir -p ${port}/data;\\\ndone\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä¸¤æ®µ shell for è¯­å¥ï¼ææå°±æ¯å¾ªç¯åå»º 6371 ~ 6376 ç¸å³çç®å½åæä»¶ã\n\nå¨ 192.168.10.10 æºå¨æ§è¡æ¥çå½ä»¤ç»æå¦ä¸ï¼å¦ææ²¡æ tree å½ä»¤åå®è£ yum install -y treeã\n\n\n\nå¨ 192.168.10.11 æºå¨æ§è¡æ¥çå½ä»¤ç»æå¦ä¸ã\n\n\n\nä»¥ä¸åå®¹ä¸ºæ¯ä¸ªèç¹çéç½®æä»¶è¯¦ç»ä¿¡æ¯ã\n\n============================== 192.168.10.10 ==============================\n[root@localhost redis-cluster]# cat /usr/local/docker-redis/redis-cluster/637{1..3}/conf/redis.conf\nport 6371\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.10\ncluster-announce-port 6371\ncluster-announce-bus-port 16371\n\nport 6372\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.10\ncluster-announce-port 6372\ncluster-announce-bus-port 16372\n\nport 6373\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.10\ncluster-announce-port 6373\ncluster-announce-bus-port 16373\n============================== 192.168.10.10 ==============================\n\n============================== 192.168.10.11 ==============================\n[root@localhost redis-cluster]# cat /usr/local/docker-redis/redis-cluster/637{4..6}/conf/redis.conf\nport 6374\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.11\ncluster-announce-port 6374\ncluster-announce-bus-port 16374\n\nport 6375\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.11\ncluster-announce-port 6375\ncluster-announce-bus-port 16375\n\nport 6376\nrequirepass 1234\nmasterauth 1234\nprotected-mode no\ndaemonize no\nappendonly yes\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 15000\ncluster-announce-ip 192.168.10.11\ncluster-announce-port 6376\ncluster-announce-bus-port 16376\n============================== 192.168.10.11 ==============================\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n\n\n\n# åå»º redis å®¹å¨\n\n# åå»ºå®¹å¨\n\nå°å®¿ä¸»æºç 6371 ~ 6376 ä¹é´çç«¯å£ä¸ 6 ä¸ª redis å®¹å¨æ å°ï¼å¹¶å°å®¿ä¸»æºçç®å½ä¸å®¹å¨åçç®å½è¿è¡æ å°ï¼ç®å½æè½½ï¼ãè®°å¾æå®ç½ç»æ¨¡å¼ï¼ä½¿ç¨ host ç½ç»æ¨¡å¼ã\n\nå¨ 192.168.10.10 æºå¨æ§è¡ä»¥ä¸å½ä»¤ï¼\n\nfor port in $(seq 6371 6373); do \\\n  docker run -di --restart always --name redis-${port} --net host \\\n  -v /usr/local/docker-redis/redis-cluster/${port}/conf/redis.conf:/usr/local/etc/redis/redis.conf \\\n  -v /usr/local/docker-redis/redis-cluster/${port}/data:/data \\\n  redis redis-server /usr/local/etc/redis/redis.conf; \\\ndone\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¨ 192.168.10.11 æºå¨æ§è¡ä»¥ä¸å½ä»¤ï¼\n\nfor port in $(seq 6374 6376); do \\\n  docker run -di --restart always --name redis-${port} --net host \\\n  -v /usr/local/docker-redis/redis-cluster/${port}/conf/redis.conf:/usr/local/etc/redis/redis.conf \\\n  -v /usr/local/docker-redis/redis-cluster/${port}/data:/data \\\n  redis redis-server /usr/local/etc/redis/redis.conf; \\\ndone\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¨ 192.168.10.10 æºå¨æ§è¡ docker ps -n 3 æ¥çå®¹å¨æ¯å¦åå»ºæåã\n\n\n\nå¨ 192.168.10.11 æºå¨æ§è¡ docker ps -n 3 æ¥çå®¹å¨æ¯å¦åå»ºæåã\n\n\n\n\n# åå»º redis cluster éç¾¤\n\néä¾¿è¿å¥ä¸ä¸ªå®¹å¨èç¹ï¼å¹¶è¿å¥ /usr/local/bin/ ç®å½ï¼\n\n# è¿å¥å®¹å¨\ndocker exec -it redis-6371 bash\n# åæ¢è³æå®ç®å½\ncd /usr/local/bin/\n\n\n1\n2\n3\n4\n\n\næ¥ä¸æ¥æä»¬å°±å¯ä»¥éè¿ä»¥ä¸å½ä»¤å®ç° redis cluster éç¾¤çåå»ºã\n\nredis-cli -a 1234 --cluster create 192.168.10.10:6371 192.168.10.10:6372 192.168.10.10:6373 192.168.10.11:6374 192.168.10.11:6375 192.168.10.11:6376 --cluster-replicas 1\n\n\n1\n\n\nåºç°éæ©æç¤ºä¿¡æ¯ï¼è¾å¥ yesï¼ç»æå¦ä¸æç¤ºï¼\n\n\n\néç¾¤åå»ºæåå¦ä¸ï¼\n\n\n\nä»¥ä¸åå®¹æ¯åå»ºéç¾¤æ¶è¿åçè¯¦ç»ä¿¡æ¯ï¼ä¹å°±æ¯ä¸ä¸¤å¹å¾ä¸­çææåå®¹ã\n\nroot@localhost:/usr/local/bin# redis-cli -a 1234 --cluster create 192.168.10.10:6371 192.168.10.10:6372 192.168.10.10:6373 192.168.10.11:6374 192.168.10.11:6375 192.168.10.11:6376 --cluster-replicas 1\nwarning: using a password with '-a' or '-u' option on the command line interface may not be safe.\n>>> performing hash slots allocation on 6 nodes...\nmaster[0] -> slots 0 - 5460\nmaster[1] -> slots 5461 - 10922\nmaster[2] -> slots 10923 - 16383\nadding replica 192.168.10.11:6376 to 192.168.10.10:6371\nadding replica 192.168.10.10:6373 to 192.168.10.11:6374\nadding replica 192.168.10.11:6375 to 192.168.10.10:6372\nm: 299cf79ddafc83dced27f628f1f82dac483fbc4e 192.168.10.10:6371\n   slots:[0-5460] (5461 slots) master\nm: ac805b90b6e20e26dc4268454bb2855beea6cc19 192.168.10.10:6372\n   slots:[10923-16383] (5461 slots) master\ns: db35494fcc5db0c88d27da7885c817e6cdcc9373 192.168.10.10:6373\n   replicates 7013270480d37eeab79b9cd0272e934d4548136a\nm: 7013270480d37eeab79b9cd0272e934d4548136a 192.168.10.11:6374\n   slots:[5461-10922] (5462 slots) master\ns: 8435e1b0d51f2690c5f94f9a5682a4ac34e94326 192.168.10.11:6375\n   replicates ac805b90b6e20e26dc4268454bb2855beea6cc19\ns: 7b13c16fa6fe8e13cdc0b4846b87edffed55c62e 192.168.10.11:6376\n   replicates 299cf79ddafc83dced27f628f1f82dac483fbc4e\ncan i set the above configuration? (type 'yes' to accept): yes\n>>> nodes configuration updated\n>>> assign a different config epoch to each node\n>>> sending cluster meet messages to join the cluster\nwaiting for the cluster to join\n.\n>>> performing cluster check (using node 192.168.10.10:6371)\nm: 299cf79ddafc83dced27f628f1f82dac483fbc4e 192.168.10.10:6371\n   slots:[0-5460] (5461 slots) master\n   1 additional replica(s)\ns: 8435e1b0d51f2690c5f94f9a5682a4ac34e94326 192.168.10.11:6375\n   slots: (0 slots) slave\n   replicates ac805b90b6e20e26dc4268454bb2855beea6cc19\ns: db35494fcc5db0c88d27da7885c817e6cdcc9373 192.168.10.10:6373\n   slots: (0 slots) slave\n   replicates 7013270480d37eeab79b9cd0272e934d4548136a\ns: 7b13c16fa6fe8e13cdc0b4846b87edffed55c62e 192.168.10.11:6376\n   slots: (0 slots) slave\n   replicates 299cf79ddafc83dced27f628f1f82dac483fbc4e\nm: 7013270480d37eeab79b9cd0272e934d4548136a 192.168.10.11:6374\n   slots:[5461-10922] (5462 slots) master\n   1 additional replica(s)\nm: ac805b90b6e20e26dc4268454bb2855beea6cc19 192.168.10.10:6372\n   slots:[10923-16383] (5461 slots) master\n   1 additional replica(s)\n[ok] all nodes agree about slots configuration.\n>>> check for open slots...\n>>> check slots coverage...\n[ok] all 16384 slots covered.\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n\n\nè³æ­¤ä¸ä¸ªé«å¯ç¨ç redis cluster éç¾¤æ­å»ºå®æï¼å¦ä¸å¾æç¤ºï¼è¯¥éç¾¤ä¸­åå« 6 ä¸ª redis èç¹ï¼3 ä¸» 3 ä»ãä¸ä¸ªä¸»èç¹ä¼åéæ§½ï¼å¤çå®¢æ·ç«¯çå½ä»¤è¯·æ±ï¼èä»èç¹å¯ç¨å¨ä¸»èç¹æéåï¼é¡¶æ¿ä¸»èç¹ã\n\n\n\n\n# æ¥çéç¾¤ç¶æ\n\næä»¬åè¿å¥å®¹å¨ï¼ç¶åéè¿ä¸äºéç¾¤å¸¸ç¨çå½ä»¤æ¥çä¸ä¸éç¾¤çç¶æã\n\n# è¿å¥å®¹å¨\ndocker exec -it redis-6371 bash\n# åæ¢è³æå®ç®å½\ncd /usr/local/bin/\n\n\n1\n2\n3\n4\n\n\n\n# æ£æ¥éç¾¤ç¶æ\n\nredis-cli -a 1234 --cluster check 192.168.10.11:6375\n\n\n1\n\n\n\n\n\n# æ¥çéç¾¤ä¿¡æ¯åèç¹ä¿¡æ¯\n\n# è¿æ¥è³éç¾¤æä¸ªèç¹\nredis-cli -c -a 1234 -h 192.168.10.11 -p 6376\n# æ¥çéç¾¤ä¿¡æ¯\ncluster info\n# æ¥çéç¾¤ç»ç¹ä¿¡æ¯\ncluster nodes\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n\n\n# set/get\n\nå¨ 6371 èç¹ä¸­æ§è¡åå¥åè¯»åï¼å½ä»¤å¦ä¸ï¼\n\n# è¿å¥å®¹å¨å¹¶è¿æ¥è³éç¾¤æä¸ªèç¹\ndocker exec -it redis-6371 /usr/local/bin/redis-cli -c -a 1234 -h 192.168.10.10 -p 6371\n# åå¥æ°æ®\nset name mrhelloworld\nset aaa 111\nset bbb 222\n# è¯»åæ°æ®\nget name\nget aaa\nget bbb\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n\nå«çæ¥ï¼è®©ææ¥è§£éä¸ä¸ä¸å¾ä¸­çæä½è¿ç¨ï¼\n\n * é¦åè¿å¥å®¹å¨å¹¶è¿æ¥è³éç¾¤æä¸ªèç¹ï¼\n\n * ç¶åæ§è¡ç¬¬ä¸ä¸ª set å½ä»¤ set name mrhelloworldï¼name é®æ ¹æ®åå¸å½æ°è¿ç®ä»¥åå¾å°çå¼ä¸º [5798]ãå½åéç¾¤ç¯å¢çæ§½åéæåµä¸ºï¼[0-5460] 6371 èç¹ï¼[5461-10922] 6374 èç¹ï¼[10923-16383] 6372 èç¹ï¼æä»¥è¯¥é®çå­å¨å°±è¢«åéå°äº 6374 èç¹ä¸ï¼\n\n * åæ¥çç¬¬äºä¸ª set å½ä»¤ set aaaï¼è¿éå¤§å®¶å¯è½ä¼æä¸äºçé®ï¼ä¸ºä»ä¹çä¸å° aaa é®æ ¹æ®åå¸å½æ°è¿ç®ä»¥åå¾å°çå¼ï¼å ä¸ºåæéå®åè³ 6374 èç¹æå¥äºæ°æ®ï¼æ­¤æ¶å¦æè¿ææ°æ®æå¥ï¼æ­£å¥½é®æ ¹æ®åå¸å½æ°è¿ç®ä»¥åå¾å°çå¼ä¹è¿å¨è¯¥èç¹çèå´åï¼é£ä¹ç´æ¥æå¥æ°æ®å³å¯ï¼\n\n * æ¥çæ¯ç¬¬ä¸ä¸ª set å½ä»¤ set bbbï¼bbb é®æ ¹æ®åå¸å½æ°è¿ç®ä»¥åå¾å°çå¼ä¸º [5287]ï¼æä»¥è¯¥é®çå­å¨å°±è¢«åéå°äº 6371 èç¹ä¸ï¼\n\n * ç¶åæ¯è¯»åæä½ï¼ç¬¬åä¸ªå½ä»¤ get nameï¼name é®æ ¹æ®åå¸å½æ°è¿ç®ä»¥åå¾å°çå¼ä¸º [5798]ï¼è¢«éå®åè³ 6374 èç¹è¯»åï¼\n\n * ç¬¬äºä¸ªå½ä»¤ get aaaï¼aaa é®æ ¹æ®åå¸å½æ°è¿ç®ä»¥åå¾å°çå¼ä¹å¨ 6374 èç¹ï¼ç´æ¥è¯»åï¼\n\n * ç¬¬å­ä¸ªå½ä»¤ get bbbï¼bbb é®æ ¹æ®åå¸å½æ°è¿ç®ä»¥åå¾å°çå¼ä¸º [5287]ï¼è¢«éå®åè³ 6371 èç¹è¯»åã\n\néè¿ä»¥ä¸æä½æä»¬å¾ç¥ name é®çå­å¨è¢«åéå°äº 6374 èç¹ï¼å¦æç´æ¥è¿æ¥ 6374 èç¹å¹¶è·åè¯¥å¼ä¼æä¹æ ·ï¼æ²¡éï¼ä¸éè¦éå®åèç¹ï¼å ä¸ºæ°æ®å°±å¨è¯¥èç¹ï¼æä»¥ç´æ¥è¯»åè¿åã\n\n\n\n\n# å®¢æ·ç«¯è¿æ¥\n\næåæ¥ä¸æ³¢å®¢æ·ç«¯è¿æ¥æä½ï¼éä¾¿åªä¸ªèç¹ï¼ççå¯å¦éè¿å¤é¨è®¿é® redis cluster éç¾¤ã\n\n\n\n\n\nè³æ­¤ä½¿ç¨å¤æºç¯å¢å¤ä¸ªå®¹å¨æ­å»º redis cluster éç¾¤ç¯å¢å°±å°è¿éï¼å¶å®æ´ä½æ­å»ºè¿ç¨ä¸ç®ç¹å«éº»ç¦ï¼å ä¸ºï¼\n\n * åå»º redis éç¾¤éè¦ç¨å° rubyï¼å¦åå°±å¾èªå·±å³èèç¹æå»ºéç¾¤ï¼èªå·±åéæ§½ï¼\n\n * å¦æä½¿ç¨ ruby æå»º redis éç¾¤ï¼å°±éè¦å®è£ ruby ç¯å¢ï¼\n\n * è redis ä» 5 çæ¬å¼å§å¯ä»¥ç´æ¥ä½¿ç¨ redis-cli å½ä»¤åå»ºéç¾¤äºï¼å°±çå»äºå¾å¤éº»ç¦äºï¼\n\n * æä»¬è¿ä½¿ç¨äº shell for å¾ªç¯è¯­å¥ç®åäºæå»ºè¿ç¨ï¼å¦åé£äºè¯­å¥ä¸æ¡æ¡æ§è¡ä¹å¤ä½ é¹å¿çã\n\nç»¼ä¸æè¿°ï¼ææ²¡ææ´ç®åçåæ³å¢ï¼å½ç¶æäºï¼ä¸ç¶æå¨è¿è·ä½ åä»ä¹å³å­ã\n\n\n\ndocker compose å°±å¯ä»¥è§£å³è¿ä¸ªé®é¢ãåé¢æä»¬åå­¦ä¹ ä¸ä¸ä»ä¹æ¯ docker composeï¼ç¶åä½¿ç¨ docker compose åæ¥æ­å»ºä¸é redis cluster éç¾¤ç¯å¢ï¼æåæåè¿ååçåºå«ã\n\n[]: https://xie.infoq.cn/article/a5536b928edd12beb32fcabf9",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/1b1528/"},regularPath:"/25.%E8%BF%90%E7%BB%B4/60.kubernetes/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"25.è¿ç»´/60.kubernetes/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-69d48d6a",path:"/pages/1b1528/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/2c13c2/"},regularPath:"/30.%E5%B7%A5%E5%85%B7/05.maven/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"30.å·¥å·/05.maven/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-252683df",path:"/pages/2c13c2/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/2ec465/"},regularPath:"/30.%E5%B7%A5%E5%85%B7/10.svn/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"30.å·¥å·/10.svn/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-e8a298c2",path:"/pages/2ec465/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/891624/"},regularPath:"/30.%E5%B7%A5%E5%85%B7/20.idea/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"30.å·¥å·/20.idea/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-dbcc7c0e",path:"/pages/891624/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/df2d8d/"},regularPath:"/30.%E5%B7%A5%E5%85%B7/25.windows/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"30.å·¥å·/25.windows/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-2dd7091f",path:"/pages/df2d8d/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Java åºç¡",frontmatter:{title:"Java åºç¡",date:"2022-02-03T19:02:33.000Z",permalink:"/pages/bbda94/",categories:["é¢è¯","Java","Javaåºç¡"],tags:[null]},regularPath:"/35.%E9%9D%A2%E8%AF%95/05.Java/05.Java%E5%9F%BA%E7%A1%80/05.Java%20%E5%9F%BA%E7%A1%80.html",relativePath:"35.é¢è¯/05.Java/05.Javaåºç¡/05.Java åºç¡.md",key:"v-67e77451",path:"/pages/bbda94/",headers:[{level:2,title:"ä¸ãæ°æ®ç±»å",slug:"ä¸ãæ°æ®ç±»å",normalizedTitle:"ä¸ãæ°æ®ç±»å",charIndex:2},{level:3,title:"åºæ¬ç±»å",slug:"åºæ¬ç±»å",normalizedTitle:"åºæ¬ç±»å",charIndex:13},{level:3,title:"åè£ç±»å",slug:"åè£ç±»å",normalizedTitle:"åè£ç±»å",charIndex:370},{level:3,title:"ç¼å­æ± ",slug:"ç¼å­æ± ",normalizedTitle:"ç¼å­æ± ",charIndex:568},{level:2,title:"äºãString",slug:"äºãstring",normalizedTitle:"äºãstring",charIndex:2958},{level:3,title:"æ¦è§",slug:"æ¦è§",normalizedTitle:"æ¦è§",charIndex:2971},{level:3,title:"ä¸å¯åçå¥½å¤",slug:"ä¸å¯åçå¥½å¤",normalizedTitle:"ä¸å¯åçå¥½å¤",charIndex:3742},{level:3,title:"String, StringBuffer and StringBuilder",slug:"string-stringbuffer-and-stringbuilder",normalizedTitle:"string, stringbuffer and stringbuilder",charIndex:4208},{level:3,title:"String Pool",slug:"string-pool",normalizedTitle:"string pool",charIndex:3856},{level:3,title:'new String("abc")',slug:"new-string-abc",normalizedTitle:"new string(&quot;abc&quot;)",charIndex:null},{level:2,title:"ä¸ãè¿ç®",slug:"ä¸ãè¿ç®",normalizedTitle:"ä¸ãè¿ç®",charIndex:7021},{level:3,title:"åæ°ä¼ é",slug:"åæ°ä¼ é",normalizedTitle:"åæ°ä¼ é",charIndex:7030},{level:3,title:"float ä¸ double",slug:"float-ä¸-double",normalizedTitle:"float ä¸ double",charIndex:8615},{level:3,title:"éå¼ç±»åè½¬æ¢",slug:"éå¼ç±»åè½¬æ¢",normalizedTitle:"éå¼ç±»åè½¬æ¢",charIndex:8787},{level:3,title:"switch",slug:"switch",normalizedTitle:"switch",charIndex:9128},{level:2,title:"åãå³é®å­",slug:"åãå³é®å­",normalizedTitle:"åãå³é®å­",charIndex:9875},{level:3,title:"final",slug:"final",normalizedTitle:"final",charIndex:1227},{level:3,title:"static",slug:"static",normalizedTitle:"static",charIndex:988},{level:2,title:"äºãObject éç¨æ¹æ³",slug:"äºãobject-éç¨æ¹æ³",normalizedTitle:"äºãobject éç¨æ¹æ³",charIndex:12709},{level:3,title:"æ¦è§",slug:"æ¦è§-2",normalizedTitle:"æ¦è§",charIndex:2971},{level:3,title:"equals()",slug:"equals",normalizedTitle:"equals()",charIndex:4682},{level:3,title:"hashCode()",slug:"hashcode",normalizedTitle:"hashcode()",charIndex:12749},{level:3,title:"toString()",slug:"tostring",normalizedTitle:"tostring()",charIndex:7410},{level:3,title:"clone()",slug:"clone",normalizedTitle:"clone()",charIndex:12820},{level:2,title:"å­ãç»§æ¿",slug:"å­ãç»§æ¿",normalizedTitle:"å­ãç»§æ¿",charIndex:20214},{level:3,title:"è®¿é®æé",slug:"è®¿é®æé",normalizedTitle:"è®¿é®æé",charIndex:20223},{level:3,title:"æ½è±¡ç±»ä¸æ¥å£",slug:"æ½è±¡ç±»ä¸æ¥å£",normalizedTitle:"æ½è±¡ç±»ä¸æ¥å£",charIndex:21495},{level:3,title:"super",slug:"super",normalizedTitle:"super",charIndex:7404},{level:3,title:"éåä¸éè½½",slug:"éåä¸éè½½",normalizedTitle:"éåä¸éè½½",charIndex:25188},{level:2,title:"ä¸ãåå°",slug:"ä¸ãåå°",normalizedTitle:"ä¸ãåå°",charIndex:27671},{level:2,title:"å«ãå¼å¸¸",slug:"å«ãå¼å¸¸",normalizedTitle:"å«ãå¼å¸¸",charIndex:28851},{level:2,title:"ä¹ãæ³å",slug:"ä¹ãæ³å",normalizedTitle:"ä¹ãæ³å",charIndex:29182},{level:2,title:"åãæ³¨è§£",slug:"åãæ³¨è§£",normalizedTitle:"åãæ³¨è§£",charIndex:29417},{level:2,title:"åä¸ãç¹æ§",slug:"åä¸ãç¹æ§",normalizedTitle:"åä¸ãç¹æ§",charIndex:29555},{level:3,title:"Java åçæ¬çæ°ç¹æ§",slug:"java-åçæ¬çæ°ç¹æ§",normalizedTitle:"java åçæ¬çæ°ç¹æ§",charIndex:29565},{level:3,title:"Java ä¸ C++ çåºå«",slug:"java-ä¸-c-çåºå«",normalizedTitle:"java ä¸ c++ çåºå«",charIndex:30212},{level:3,title:"JRE or JDK",slug:"jre-or-jdk",normalizedTitle:"jre or jdk",charIndex:30656},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:30896}],headersStr:'ä¸ãæ°æ®ç±»å åºæ¬ç±»å åè£ç±»å ç¼å­æ±  äºãString æ¦è§ ä¸å¯åçå¥½å¤ String, StringBuffer and StringBuilder String Pool new String("abc") ä¸ãè¿ç® åæ°ä¼ é float ä¸ double éå¼ç±»åè½¬æ¢ switch åãå³é®å­ final static äºãObject éç¨æ¹æ³ æ¦è§ equals() hashCode() toString() clone() å­ãç»§æ¿ è®¿é®æé æ½è±¡ç±»ä¸æ¥å£ super éåä¸éè½½ ä¸ãåå° å«ãå¼å¸¸ ä¹ãæ³å åãæ³¨è§£ åä¸ãç¹æ§ Java åçæ¬çæ°ç¹æ§ Java ä¸ C++ çåºå« JRE or JDK åèèµæ',content:'# ä¸ãæ°æ®ç±»å\n\n\n# åºæ¬ç±»å\n\n * byte/8\n * char/16\n * short/16\n * int/32\n * float/32\n * long/64\n * double/64\n * boolean/~\n\nboolean åªæä¸¤ä¸ªå¼ï¼trueãfalseï¼å¯ä»¥ä½¿ç¨ 1 bit æ¥å­å¨ï¼ä½æ¯å·ä½å¤§å°æ²¡ææç¡®è§å®ãJVM ä¼å¨ç¼è¯æ¶æå° boolean ç±»åçæ°æ®è½¬æ¢ä¸º intï¼ä½¿ç¨ 1 æ¥è¡¨ç¤º trueï¼0 è¡¨ç¤º falseãJVM æ¯æ boolean æ°ç»ï¼ä½æ¯æ¯éè¿è¯»å byte æ°ç»æ¥å®ç°çã\n\n * Primitive Data Types(opens new window)\n * The JavaÂ® Virtual Machine Specification(opens new window)\n\n\n# åè£ç±»å\n\nåºæ¬ç±»åé½æå¯¹åºçåè£ç±»åï¼åºæ¬ç±»åä¸å¶å¯¹åºçåè£ç±»åä¹é´çèµå¼ä½¿ç¨èªå¨è£ç®±ä¸æç®±å®æã\n\nInteger x = 2;     // è£ç®± è°ç¨äº Integer.valueOf(2)\nint y = x;         // æç®± è°ç¨äº X.intValue()\n\n\n1\n2\n\n * Autoboxing and Unboxing(opens new window)\n\n\n# ç¼å­æ± \n\nnew Integer(123) ä¸ Integer.valueOf(123) çåºå«å¨äºï¼\n\n * new Integer(123) æ¯æ¬¡é½ä¼æ°å»ºä¸ä¸ªå¯¹è±¡ï¼\n * Integer.valueOf(123) ä¼ä½¿ç¨ç¼å­æ± ä¸­çå¯¹è±¡ï¼å¤æ¬¡è°ç¨ä¼åå¾åä¸ä¸ªå¯¹è±¡çå¼ç¨ã\n\nInteger x = new Integer(123);\nInteger y = new Integer(123);\nSystem.out.println(x == y);    // false\nInteger z = Integer.valueOf(123);\nInteger k = Integer.valueOf(123);\nSystem.out.println(z == k);   // true\n\n\n1\n2\n3\n4\n5\n6\n\n\nvalueOf() æ¹æ³çå®ç°æ¯è¾ç®åï¼å°±æ¯åå¤æ­å¼æ¯å¦å¨ç¼å­æ± ä¸­ï¼å¦æå¨çè¯å°±ç´æ¥è¿åç¼å­æ± çåå®¹ã\n\npublic static Integer valueOf(int i) {\n    if (i >= IntegerCache.low && i <= IntegerCache.high)\n        return IntegerCache.cache[i + (-IntegerCache.low)];\n    return new Integer(i);\n}\n\n\n1\n2\n3\n4\n5\n\n\nå¨ Java 8 ä¸­ï¼Integer ç¼å­æ± çå¤§å°é»è®¤ä¸º -128~127ã\n\nstatic final int low = -128;\nstatic final int high;\nstatic final Integer cache[];\n\nstatic {\n    // high value may be configured by property\n    int h = 127;\n    String integerCacheHighPropValue =\n        sun.misc.VM.getSavedProperty("java.lang.Integer.IntegerCache.high");\n    if (integerCacheHighPropValue != null) {\n        try {\n            int i = parseInt(integerCacheHighPropValue);\n            i = Math.max(i, 127);\n            // Maximum array size is Integer.MAX_VALUE\n            h = Math.min(i, Integer.MAX_VALUE - (-low) -1);\n        } catch( NumberFormatException nfe) {\n            // If the property cannot be parsed into an int, ignore it.\n        }\n    }\n    high = h;\n\n    cache = new Integer[(high - low) + 1];\n    int j = low;\n    for(int k = 0; k < cache.length; k++)\n        cache[k] = new Integer(j++);\n\n    // range [-128, 127] must be interned (JLS7 5.1.7)\n    assert IntegerCache.high >= 127;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nç¼è¯å¨ä¼å¨èªå¨è£ç®±è¿ç¨è°ç¨ valueOf() æ¹æ³ï¼å æ­¤å¤ä¸ªå¼ç¸åä¸å¼å¨ç¼å­æ± èå´åç Integer å®ä¾ä½¿ç¨èªå¨è£ç®±æ¥åå»ºï¼é£ä¹å°±ä¼å¼ç¨ç¸åçå¯¹è±¡ã\n\nInteger m = 123;\nInteger n = 123;\nSystem.out.println(m == n); // true\n\n\n1\n2\n3\n\n\nåºæ¬ç±»åå¯¹åºçç¼å²æ± å¦ä¸ï¼\n\n * boolean values true and false\n * all byte values\n * short values between -128 and 127\n * int values between -128 and 127\n * char in the range \\u0000 to \\u007F\n\nå¨ä½¿ç¨è¿äºåºæ¬ç±»åå¯¹åºçåè£ç±»åæ¶ï¼å¦æè¯¥æ°å¼èå´å¨ç¼å²æ± èå´åï¼å°±å¯ä»¥ç´æ¥ä½¿ç¨ç¼å²æ± ä¸­çå¯¹è±¡ã\n\nå¨ jdk 1.8 ææçæ°å¼ç±»ç¼å²æ± ä¸­ï¼Integer çç¼å²æ±  IntegerCache å¾ç¹æ®ï¼è¿ä¸ªç¼å²æ± çä¸çæ¯ - 128ï¼ä¸çé»è®¤æ¯ 127ï¼ä½æ¯è¿ä¸ªä¸çæ¯å¯è°çï¼å¨å¯å¨ jvm çæ¶åï¼éè¿ -XX:AutoBoxCacheMax=<size> æ¥æå®è¿ä¸ªç¼å²æ± çå¤§å°ï¼è¯¥éé¡¹å¨ JVM åå§åçæ¶åä¼è®¾å®ä¸ä¸ªåä¸º java.lang.IntegerCache.high ç³»ç»å±æ§ï¼ç¶å IntegerCache åå§åçæ¶åå°±ä¼è¯»åè¯¥ç³»ç»å±æ§æ¥å³å®ä¸çã\n\nStackOverflow : Differences between new Integer(123), Integer.valueOf(123) and just 123 (opens new window)\n\n\n# äºãString\n\n\n# æ¦è§\n\nString è¢«å£°æä¸º finalï¼å æ­¤å®ä¸å¯è¢«ç»§æ¿ã(Integer ç­åè£ç±»ä¹ä¸è½è¢«ç»§æ¿ï¼\n\nå¨ Java 8 ä¸­ï¼String åé¨ä½¿ç¨ char æ°ç»å­å¨æ°æ®ã\n\npublic final class String\n    implements java.io.Serializable, Comparable<String>, CharSequence {\n    /** The value is used for character storage. */\n    private final char value[];\n}\n\n\n1\n2\n3\n4\n5\n\n\nå¨ Java 9 ä¹åï¼String ç±»çå®ç°æ¹ç¨ byte æ°ç»å­å¨å­ç¬¦ä¸²ï¼åæ¶ä½¿ç¨ coder æ¥æ è¯ä½¿ç¨äºåªç§ç¼ç ã\n\npublic final class String\n    implements java.io.Serializable, Comparable<String>, CharSequence {\n    /** The value is used for character storage. */\n    private final byte[] value;\n\n    /** The identifier of the encoding used to encode the bytes in {@code value}. */\n    private final byte coder;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nvalue æ°ç»è¢«å£°æä¸º finalï¼è¿æå³ç value æ°ç»åå§åä¹åå°±ä¸è½åå¼ç¨å¶å®æ°ç»ãå¹¶ä¸ String åé¨æ²¡ææ¹å value æ°ç»çæ¹æ³ï¼å æ­¤å¯ä»¥ä¿è¯ String ä¸å¯åã\n\n\n# ä¸å¯åçå¥½å¤\n\n1. å¯ä»¥ç¼å­ hash å¼\n\nå ä¸º String ç hash å¼ç»å¸¸è¢«ä½¿ç¨ï¼ä¾å¦ String ç¨å HashMap ç keyãä¸å¯åçç¹æ§å¯ä»¥ä½¿å¾ hash å¼ä¹ä¸å¯åï¼å æ­¤åªéè¦è¿è¡ä¸æ¬¡è®¡ç®ã\n\n2. String Pool çéè¦\n\nå¦æä¸ä¸ª String å¯¹è±¡å·²ç»è¢«åå»ºè¿äºï¼é£ä¹å°±ä¼ä» String Pool ä¸­åå¾å¼ç¨ãåªæ String æ¯ä¸å¯åçï¼æå¯è½ä½¿ç¨ String Poolã\n\n\n\n3. å®å¨æ§\n\nString ç»å¸¸ä½ä¸ºåæ°ï¼String ä¸å¯åæ§å¯ä»¥ä¿è¯åæ°ä¸å¯åãä¾å¦å¨ä½ä¸ºç½ç»è¿æ¥åæ°çæåµä¸å¦æ String æ¯å¯åçï¼é£ä¹å¨ç½ç»è¿æ¥è¿ç¨ä¸­ï¼String è¢«æ¹åï¼æ¹å String çé£ä¸æ¹ä»¥ä¸ºç°å¨è¿æ¥çæ¯å¶å®ä¸»æºï¼èå®éæåµå´ä¸ä¸å®æ¯ã\n\n4. çº¿ç¨å®å¨\n\nString ä¸å¯åæ§å¤©çå·å¤çº¿ç¨å®å¨ï¼å¯ä»¥å¨å¤ä¸ªçº¿ç¨ä¸­å®å¨å°ä½¿ç¨ã\n\nProgram Creek : Why String is immutable in Java?(opens new window)\n\n\n# String, StringBuffer and StringBuilder\n\n1. å¯åæ§\n\n * String ä¸å¯å\n * StringBuffer å StringBuilder å¯å\n\n2. çº¿ç¨å®å¨\n\n * String ä¸å¯åï¼å æ­¤æ¯çº¿ç¨å®å¨ç\n * StringBuilder ä¸æ¯çº¿ç¨å®å¨ç\n * StringBuffer æ¯çº¿ç¨å®å¨çï¼åé¨ä½¿ç¨ synchronized è¿è¡åæ­¥\n\nStackOverflow : String, StringBuffer, and StringBuilder(opens new window)\n\n\n# String Pool\n\nå­ç¬¦ä¸²å¸¸éæ± ï¼String Poolï¼ä¿å­çææå­ç¬¦ä¸²å­é¢éï¼literal stringsï¼ï¼è¿äºå­é¢éå¨ç¼è¯æ¶æå°±ç¡®å®ãä¸ä»å¦æ­¤ï¼è¿å¯ä»¥ä½¿ç¨ String ç intern() æ¹æ³å¨è¿è¡è¿ç¨å°å­ç¬¦ä¸²æ·»å å° String Pool ä¸­ã\n\nå½ä¸ä¸ªå­ç¬¦ä¸²è°ç¨ intern() æ¹æ³æ¶ï¼å¦æ String Pool ä¸­å·²ç»å­å¨ä¸ä¸ªå­ç¬¦ä¸²åè¯¥å­ç¬¦ä¸²å¼ç¸ç­ï¼ä½¿ç¨ equals() æ¹æ³è¿è¡ç¡®å®ï¼ï¼é£ä¹å°±ä¼è¿å String Pool ä¸­å­ç¬¦ä¸²çå¼ç¨ï¼å¦åï¼å°±ä¼å¨ String Pool ä¸­æ·»å ä¸ä¸ªæ°çå­ç¬¦ä¸²ï¼å¹¶è¿åè¿ä¸ªæ°å­ç¬¦ä¸²çå¼ç¨ã\n\nä¸é¢ç¤ºä¾ä¸­ï¼s1 å s2 éç¨ new String() çæ¹å¼æ°å»ºäºä¸¤ä¸ªä¸åå­ç¬¦ä¸²ï¼è s3 å s4 æ¯éè¿ s1.intern() å s2.intern() æ¹æ³åå¾åä¸ä¸ªå­ç¬¦ä¸²å¼ç¨ãintern() é¦åæ "aaa" æ¾å° String Pool ä¸­ï¼ç¶åè¿åè¿ä¸ªå­ç¬¦ä¸²å¼ç¨ï¼å æ­¤ s3 å s4 å¼ç¨çæ¯åä¸ä¸ªå­ç¬¦ä¸²ã\n\nString s1 = new String("aaa");\nString s2 = new String("aaa");\nSystem.out.println(s1 == s2);           // false\nString s3 = s1.intern();\nString s4 = s2.intern();\nSystem.out.println(s3 == s4);           // true\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¦ææ¯éç¨ "bbb" è¿ç§å­é¢éçå½¢å¼åå»ºå­ç¬¦ä¸²ï¼ä¼èªå¨å°å°å­ç¬¦ä¸²æ¾å¥ String Pool ä¸­ã\n\nString s5 = "bbb";\nString s6 = "bbb";\nSystem.out.println(s5 == s6);  // true\n\n\n1\n2\n3\n\n\nå¨ Java 7 ä¹åï¼String Pool è¢«æ¾å¨è¿è¡æ¶å¸¸éæ± ä¸­ï¼å®å±äºæ°¸ä¹ä»£ãèå¨ Java 7ï¼String Pool è¢«ç§»å°å ä¸­ãè¿æ¯å ä¸ºæ°¸ä¹ä»£çç©ºé´æéï¼å¨å¤§éä½¿ç¨å­ç¬¦ä¸²çåºæ¯ä¸ä¼å¯¼è´ OutOfMemoryError éè¯¯ã\n\n * StackOverflow : What is String interning?(opens new window)\n * æ·±å¥è§£æ String#intern(opens new window)\n\n\n# new String("abc")\n\nä½¿ç¨è¿ç§æ¹å¼ä¸å±ä¼åå»ºä¸¤ä¸ªå­ç¬¦ä¸²å¯¹è±¡ï¼åææ¯ String Pool ä¸­è¿æ²¡æ "abc" å­ç¬¦ä¸²å¯¹è±¡ï¼ã\n\n * "abc" å±äºå­ç¬¦ä¸²å­é¢éï¼å æ­¤ç¼è¯æ¶æä¼å¨ String Pool ä¸­åå»ºä¸ä¸ªå­ç¬¦ä¸²å¯¹è±¡ï¼æåè¿ä¸ª "abc" å­ç¬¦ä¸²å­é¢éï¼\n * èä½¿ç¨ new çæ¹å¼ä¼å¨å ä¸­åå»ºä¸ä¸ªå­ç¬¦ä¸²å¯¹è±¡ã\n\nåå»ºä¸ä¸ªæµè¯ç±»ï¼å¶ main æ¹æ³ä¸­ä½¿ç¨è¿ç§æ¹å¼æ¥åå»ºå­ç¬¦ä¸²å¯¹è±¡ã\n\npublic class NewStringTest {\n    public static void main(String[] args) {\n        String s = new String("abc");\n    }\n}\n\n\n1\n2\n3\n4\n5\n\n\nä½¿ç¨ javap -verbose è¿è¡åç¼è¯ï¼å¾å°ä»¥ä¸åå®¹ï¼\n\n// ...\nConstant pool:\n// ...\n   #2 = Class              #18            // java/lang/String\n   #3 = String             #19            // abc\n// ...\n  #18 = Utf8               java/lang/String\n  #19 = Utf8               abc\n// ...\n\n  public static void main(java.lang.String[]);\n    descriptor: ([Ljava/lang/String;)V\n    flags: ACC_PUBLIC, ACC_STATIC\n    Code:\n      stack=3, locals=2, args_size=1\n         0: new           #2                  // class java/lang/String\n         3: dup\n         4: ldc           #3                  // String abc\n         6: invokespecial #4                  // Method java/lang/String."<init>":(Ljava/lang/String;)V\n         9: astore_1\n// ...\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nå¨ Constant Pool ä¸­ï¼#19 å­å¨è¿å­ç¬¦ä¸²å­é¢é "abc"ï¼#3 æ¯ String Pool çå­ç¬¦ä¸²å¯¹è±¡ï¼å®æå #19 è¿ä¸ªå­ç¬¦ä¸²å­é¢éãå¨ main æ¹æ³ä¸­ï¼0: è¡ä½¿ç¨ new #2 å¨å ä¸­åå»ºä¸ä¸ªå­ç¬¦ä¸²å¯¹è±¡ï¼å¹¶ä¸ä½¿ç¨ ldc #3 å° String Pool ä¸­çå­ç¬¦ä¸²å¯¹è±¡ä½ä¸º String æé å½æ°çåæ°ã\n\nä»¥ä¸æ¯ String æé å½æ°çæºç ï¼å¯ä»¥çå°ï¼å¨å°ä¸ä¸ªå­ç¬¦ä¸²å¯¹è±¡ä½ä¸ºå¦ä¸ä¸ªå­ç¬¦ä¸²å¯¹è±¡çæé å½æ°åæ°æ¶ï¼å¹¶ä¸ä¼å®å¨å¤å¶ value æ°ç»åå®¹ï¼èæ¯é½ä¼æååä¸ä¸ª value æ°ç»ã\n\npublic String(String original) {\n    this.value = original.value;\n    this.hash = original.hash;\n}\n\n\n1\n2\n3\n4\n\n\n\n\n\n# ä¸ãè¿ç®\n\n\n# åæ°ä¼ é\n\nJava çåæ°æ¯ä»¥å¼ä¼ éçå½¢å¼ä¼ å¥æ¹æ³ä¸­ï¼èä¸æ¯å¼ç¨ä¼ éã\n\nä»¥ä¸ä»£ç ä¸­ Dog dog ç dog æ¯ä¸ä¸ªæéï¼å­å¨çæ¯å¯¹è±¡çå°åãå¨å°ä¸ä¸ªåæ°ä¼ å¥ä¸ä¸ªæ¹æ³æ¶ï¼æ¬è´¨ä¸æ¯å°å¯¹è±¡çå°åä»¥å¼çæ¹å¼ä¼ éå°å½¢åä¸­ã\n\npublic class Dog {\n\n    String name;\n\n    Dog(String name) {\n        this.name = name;\n    }\n\n    String getName() {\n        return this.name;\n    }\n\n    void setName(String name) {\n        this.name = name;\n    }\n\n    String getObjectAddress() {\n        return super.toString();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nå¨æ¹æ³ä¸­æ¹åå¯¹è±¡çå­æ®µå¼ä¼æ¹ååå¯¹è±¡è¯¥å­æ®µå¼ï¼å ä¸ºå¼ç¨çæ¯åä¸ä¸ªå¯¹è±¡ã\n\nclass PassByValueExample {\n    public static void main(String[] args) {\n        Dog dog = new Dog("A");\n        func(dog);\n        System.out.println(dog.getName());          // B\n    }\n\n    private static void func(Dog dog) {\n        dog.setName("B");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä½æ¯å¨æ¹æ³ä¸­å°æéå¼ç¨äºå¶å®å¯¹è±¡ï¼é£ä¹æ­¤æ¶æ¹æ³éåæ¹æ³å¤çä¸¤ä¸ªæéæåäºä¸åçå¯¹è±¡ï¼å¨ä¸ä¸ªæéæ¹åå¶ææåå¯¹è±¡çåå®¹å¯¹å¦ä¸ä¸ªæéææåçå¯¹è±¡æ²¡æå½±åã\n\npublic class PassByValueExample {\n    public static void main(String[] args) {\n        Dog dog = new Dog("A");\n        System.out.println(dog.getObjectAddress()); // Dog@4554617c\n        func(dog);\n        System.out.println(dog.getObjectAddress()); // Dog@4554617c\n        System.out.println(dog.getName());          // A\n    }\n\n    private static void func(Dog dog) {\n        System.out.println(dog.getObjectAddress()); // Dog@4554617c\n        dog = new Dog("B");\n        System.out.println(dog.getObjectAddress()); // Dog@74a14482\n        System.out.println(dog.getName());          // B\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nStackOverflow: Is Java âpass-by-referenceâ or âpass-by-valueâ?(opens new window)\n\n\n# float ä¸ double\n\nJava ä¸è½éå¼æ§è¡åä¸è½¬åï¼å ä¸ºè¿ä¼ä½¿å¾ç²¾åº¦éä½ã\n\n1.1 å­é¢éå±äº double ç±»åï¼ä¸è½ç´æ¥å° 1.1 ç´æ¥èµå¼ç» float åéï¼å ä¸ºè¿æ¯åä¸è½¬åã\n\n// float f = 1.1;\n\n\n1\n\n\n1.1f å­é¢éææ¯ float ç±»åã\n\nfloat f = 1.1f;\n\n\n1\n\n\n\n# éå¼ç±»åè½¬æ¢\n\nå ä¸ºå­é¢é 1 æ¯ int ç±»åï¼å®æ¯ short ç±»åç²¾åº¦è¦é«ï¼å æ­¤ä¸è½éå¼å°å° int ç±»ååä¸è½¬åä¸º short ç±»åã\n\nshort s1 = 1;\n// s1 = s1 + 1;\n\n\n1\n2\n\n\nä½æ¯ä½¿ç¨ += æè ++ è¿ç®ç¬¦ä¼æ§è¡éå¼ç±»åè½¬æ¢ã\n\ns1 += 1;\ns1++;\n\n\n1\n2\n\n\nä¸é¢çè¯­å¥ç¸å½äºå° s1 + 1 çè®¡ç®ç»æè¿è¡äºåä¸è½¬åï¼\n\ns1 = (short) (s1 + 1);\n\n\n1\n\n\nStackOverflow : Why don\'t Java\'s +=, -=, *=, /= compound assignment operators require casting?(opens new window)\n\n\n# switch\n\nä» Java 7 å¼å§ï¼å¯ä»¥å¨ switch æ¡ä»¶å¤æ­è¯­å¥ä¸­ä½¿ç¨ String å¯¹è±¡ã\n\nString s = "a";\nswitch (s) {\n    case "a":\n        System.out.println("aaa");\n        break;\n    case "b":\n        System.out.println("bbb");\n        break;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nswitch ä¸æ¯æ longãfloatãdoubleï¼æ¯å ä¸º switch çè®¾è®¡åè¡·æ¯å¯¹é£äºåªæå°æ°å ä¸ªå¼çç±»åè¿è¡ç­å¼å¤æ­ï¼å¦æå¼è¿äºå¤æï¼é£ä¹è¿æ¯ç¨ if æ¯è¾åéã\n\n// long x = 111;\n// switch (x) { // Incompatible types. Found: \'long\', required: \'char, byte, short, int, Character, Byte, Short, Integer, String, or an enum\'\n//     case 111:\n//         System.out.println(111);\n//         break;\n//     case 222:\n//         System.out.println(222);\n//         break;\n// }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nStackOverflow : Why can\'t your switch statement data type be long, Java?(opens new window)\n\n\n# åãå³é®å­\n\n\n# final\n\n1. æ°æ®\n\nå£°ææ°æ®ä¸ºå¸¸éï¼å¯ä»¥æ¯ç¼è¯æ¶å¸¸éï¼ä¹å¯ä»¥æ¯å¨è¿è¡æ¶è¢«åå§ååä¸è½è¢«æ¹åçå¸¸éã\n\n * å¯¹äºåºæ¬ç±»åï¼final ä½¿æ°å¼ä¸åï¼\n * å¯¹äºå¼ç¨ç±»åï¼final ä½¿å¼ç¨ä¸åï¼ä¹å°±ä¸è½å¼ç¨å¶å®å¯¹è±¡ï¼ä½æ¯è¢«å¼ç¨çå¯¹è±¡æ¬èº«æ¯å¯ä»¥ä¿®æ¹çã\n\nfinal int x = 1;\n// x = 2;  // cannot assign value to final variable \'x\'\nfinal A y = new A();\ny.a = 1;\n\n\n1\n2\n3\n4\n\n\n2. æ¹æ³\n\nå£°ææ¹æ³ä¸è½è¢«å­ç±»éåã\n\nprivate æ¹æ³éå¼å°è¢«æå®ä¸º finalï¼å¦æå¨å­ç±»ä¸­å®ä¹çæ¹æ³ååºç±»ä¸­çä¸ä¸ª private æ¹æ³ç­¾åç¸åï¼æ­¤æ¶å­ç±»çæ¹æ³ä¸æ¯éååºç±»æ¹æ³ï¼èæ¯å¨å­ç±»ä¸­å®ä¹äºä¸ä¸ªæ°çæ¹æ³ã\n\n3. ç±»\n\nå£°æç±»ä¸åè®¸è¢«ç»§æ¿ã\n\n\n# static\n\n1. éæåé\n\n * éæåéï¼åç§°ä¸ºç±»åéï¼ä¹å°±æ¯è¯´è¿ä¸ªåéå±äºç±»çï¼ç±»ææçå®ä¾é½å±äº«éæåéï¼å¯ä»¥ç´æ¥éè¿ç±»åæ¥è®¿é®å®ãéæåéå¨åå­ä¸­åªå­å¨ä¸ä»½ã\n * å®ä¾åéï¼æ¯åå»ºä¸ä¸ªå®ä¾å°±ä¼äº§çä¸ä¸ªå®ä¾åéï¼å®ä¸è¯¥å®ä¾åçå±æ­»ã\n\npublic class A {\n\n    private int x;         // å®ä¾åé\n    private static int y;  // éæåé\n\n    public static void main(String[] args) {\n        // int x = A.x;  // Non-static field \'x\' cannot be referenced from a static context\n        A a = new A();\n        int x = a.x;\n        int y = A.y;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n2. éææ¹æ³\n\néææ¹æ³å¨ç±»å è½½çæ¶åå°±å­å¨äºï¼å®ä¸ä¾èµäºä»»ä½å®ä¾ãæä»¥éææ¹æ³å¿é¡»æå®ç°ï¼ä¹å°±æ¯è¯´å®ä¸è½æ¯æ½è±¡æ¹æ³ã\n\npublic abstract class A {\n    public static void func1(){\n    }\n    // public abstract static void func2();  // Illegal combination of modifiers: \'abstract\' and \'static\'\n}\n\n\n1\n2\n3\n4\n5\n\n\nåªè½è®¿é®æå±ç±»çéæå­æ®µåéææ¹æ³ï¼æ¹æ³ä¸­ä¸è½æ this å super å³é®å­ï¼å ä¸ºè¿ä¸¤ä¸ªå³é®å­ä¸å·ä½å¯¹è±¡å³èã\n\npublic class A {\n\n    private static int x;\n    private int y;\n\n    public static void func1(){\n        int a = x;\n        // int b = y;  // Non-static field \'y\' cannot be referenced from a static context\n        // int b = this.y;     // \'A.this\' cannot be referenced from a static context\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n3. éæè¯­å¥å\n\néæè¯­å¥åå¨ç±»åå§åæ¶è¿è¡ä¸æ¬¡ã\n\npublic class A {\n    static {\n        System.out.println("123");\n    }\n\n    public static void main(String[] args) {\n        A a1 = new A();\n        A a2 = new A();\n    }\n}\n123\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n4. éæåé¨ç±»\n\nééæåé¨ç±»ä¾èµäºå¤é¨ç±»çå®ä¾ï¼ä¹å°±æ¯è¯´éè¦ååå»ºå¤é¨ç±»å®ä¾ï¼æè½ç¨è¿ä¸ªå®ä¾å»åå»ºééæåé¨ç±»ãèéæåé¨ç±»ä¸éè¦ã\n\npublic class OuterClass {\n\n    class InnerClass {\n    }\n\n    static class StaticInnerClass {\n    }\n\n    public static void main(String[] args) {\n        // InnerClass innerClass = new InnerClass(); // \'OuterClass.this\' cannot be referenced from a static context\n        OuterClass outerClass = new OuterClass();\n        InnerClass innerClass = outerClass.new InnerClass();\n        StaticInnerClass staticInnerClass = new StaticInnerClass();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\néæåé¨ç±»ä¸è½è®¿é®å¤é¨ç±»çééæçåéåæ¹æ³ã\n\n5. éæå¯¼å\n\nå¨ä½¿ç¨éæåéåæ¹æ³æ¶ä¸ç¨åææ ClassNameï¼ä»èç®åä»£ç ï¼ä½å¯è¯»æ§å¤§å¤§éä½ã\n\nimport static com.xxx.ClassName.*\n\n\n1\n\n\n6. åå§åé¡ºåº\n\néæåéåéæè¯­å¥åä¼åäºå®ä¾åéåæ®éè¯­å¥åï¼éæåéåéæè¯­å¥åçåå§åé¡ºåºåå³äºå®ä»¬å¨ä»£ç ä¸­çé¡ºåºã\n\npublic static String staticField = "éæåé";\nstatic {\n    System.out.println("éæè¯­å¥å");\n}\npublic String field = "å®ä¾åé";\n{\n    System.out.println("æ®éè¯­å¥å");\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næåææ¯æé å½æ°çåå§åã\n\npublic InitialOrderTest() {\n    System.out.println("æé å½æ°");\n}\n\n\n1\n2\n3\n\n\nå­å¨ç»§æ¿çæåµä¸ï¼åå§åé¡ºåºä¸ºï¼\n\n * ç¶ç±»ï¼éæåéãéæè¯­å¥åï¼\n * å­ç±»ï¼éæåéãéæè¯­å¥åï¼\n * ç¶ç±»ï¼å®ä¾åéãæ®éè¯­å¥åï¼\n * ç¶ç±»ï¼æé å½æ°ï¼\n * å­ç±»ï¼å®ä¾åéãæ®éè¯­å¥åï¼\n * å­ç±»ï¼æé å½æ°ï¼\n\n\n# äºãObject éç¨æ¹æ³\n\n\n# æ¦è§\n\npublic native int hashCode()\n\npublic boolean equals(Object obj)\n\nprotected native Object clone() throws CloneNotSupportedException\n\npublic String toString()\n\npublic final native Class<?> getClass()\n\nprotected void finalize() throws Throwable {}\n\npublic final native void notify()\n\npublic final native void notifyAll()\n\npublic final native void wait(long timeout) throws InterruptedException\n\npublic final void wait(long timeout, int nanos) throws InterruptedException\n\npublic final void wait() throws InterruptedException\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n\n# equals()\n\n1. ç­ä»·å³ç³»\n\nä¸¤ä¸ªå¯¹è±¡å·æç­ä»·å³ç³»ï¼éè¦æ»¡è¶³ä»¥ä¸äºä¸ªæ¡ä»¶ï¼\n\nâ  èªåæ§\n\nx.equals(x); // true\n\n\n1\n\n\nâ¡ å¯¹ç§°æ§\n\nx.equals(y) == y.equals(x); // true\n\n\n1\n\n\nâ¢ ä¼ éæ§\n\nif (x.equals(y) && y.equals(z))\n    x.equals(z); // true;\n\n\n1\n2\n\n\nâ£ ä¸è´æ§\n\nå¤æ¬¡è°ç¨ equals() æ¹æ³ç»æä¸å\n\nx.equals(y) == x.equals(y); // true\n\n\n1\n\n\nâ¤ ä¸ null çæ¯è¾\n\nå¯¹ä»»ä½ä¸æ¯ null çå¯¹è±¡ x è°ç¨ x.equals(null) ç»æé½ä¸º false\n\nx.equals(null); // false;\n\n\n1\n\n\n2. ç­ä»·ä¸ç¸ç­\n\n * å¯¹äºåºæ¬ç±»åï¼== å¤æ­ä¸¤ä¸ªå¼æ¯å¦ç¸ç­ï¼åºæ¬ç±»åæ²¡æ equals() æ¹æ³ã\n * å¯¹äºå¼ç¨ç±»åï¼== å¤æ­ä¸¤ä¸ªåéæ¯å¦å¼ç¨åä¸ä¸ªå¯¹è±¡ï¼è equals() å¤æ­å¼ç¨çå¯¹è±¡æ¯å¦ç­ä»·ã\n\nInteger x = new Integer(1);\nInteger y = new Integer(1);\nSystem.out.println(x.equals(y)); // true\nSystem.out.println(x == y);      // false\n\n\n1\n2\n3\n4\n\n\n3. å®ç°\n\n * æ£æ¥æ¯å¦ä¸ºåä¸ä¸ªå¯¹è±¡çå¼ç¨ï¼å¦ææ¯ç´æ¥è¿å trueï¼\n * æ£æ¥æ¯å¦æ¯åä¸ä¸ªç±»åï¼å¦æä¸æ¯ï¼ç´æ¥è¿å falseï¼\n * å° Object å¯¹è±¡è¿è¡è½¬åï¼\n * å¤æ­æ¯ä¸ªå³é®åæ¯å¦ç¸ç­ã\n\npublic class EqualExample {\n\n    private int x;\n    private int y;\n    private int z;\n\n    public EqualExample(int x, int y, int z) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n    }\n\n    @Override\n    public boolean equals(Object o) {\n        if (this == o) return true;\n        if (o == null || getClass() != o.getClass()) return false;\n\n        EqualExample that = (EqualExample) o;\n\n        if (x != that.x) return false;\n        if (y != that.y) return false;\n        return z == that.z;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n\n# hashCode()\n\nhashCode() è¿ååå¸å¼ï¼è equals() æ¯ç¨æ¥å¤æ­ä¸¤ä¸ªå¯¹è±¡æ¯å¦ç­ä»·ãç­ä»·çä¸¤ä¸ªå¯¹è±¡æ£åå¼ä¸å®ç¸åï¼ä½æ¯æ£åå¼ç¸åçä¸¤ä¸ªå¯¹è±¡ä¸ä¸å®ç­ä»·ï¼è¿æ¯å ä¸ºè®¡ç®åå¸å¼å·æéæºæ§ï¼ä¸¤ä¸ªå¼ä¸åçå¯¹è±¡å¯è½è®¡ç®åºç¸åçåå¸å¼ã\n\nå¨è¦ç equals() æ¹æ³æ¶åºå½æ»æ¯è¦ç hashCode() æ¹æ³ï¼ä¿è¯ç­ä»·çä¸¤ä¸ªå¯¹è±¡åå¸å¼ä¹ç¸ç­ã\n\nHashSet å HashMap ç­éåç±»ä½¿ç¨äº hashCode() æ¹æ³æ¥è®¡ç®å¯¹è±¡åºè¯¥å­å¨çä½ç½®ï¼å æ­¤è¦å°å¯¹è±¡æ·»å å°è¿äºéåç±»ä¸­ï¼éè¦è®©å¯¹åºçç±»å®ç° hashCode() æ¹æ³ã\n\nä¸é¢çä»£ç ä¸­ï¼æ°å»ºäºä¸¤ä¸ªç­ä»·çå¯¹è±¡ï¼å¹¶å°å®ä»¬æ·»å å° HashSet ä¸­ãæä»¬å¸æå°è¿ä¸¤ä¸ªå¯¹è±¡å½æä¸æ ·çï¼åªå¨éåä¸­æ·»å ä¸ä¸ªå¯¹è±¡ãä½æ¯ EqualExample æ²¡æå®ç° hashCode() æ¹æ³ï¼å æ­¤è¿ä¸¤ä¸ªå¯¹è±¡çåå¸å¼æ¯ä¸åçï¼æç»å¯¼è´éåæ·»å äºä¸¤ä¸ªç­ä»·çå¯¹è±¡ã\n\nEqualExample e1 = new EqualExample(1, 1, 1);\nEqualExample e2 = new EqualExample(1, 1, 1);\nSystem.out.println(e1.equals(e2)); // true\nHashSet<EqualExample> set = new HashSet<>();\nset.add(e1);\nset.add(e2);\nSystem.out.println(set.size());   // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nçæ³çåå¸å½æ°åºå½å·æååæ§ï¼å³ä¸ç¸ç­çå¯¹è±¡åºå½åååå¸å°ææå¯è½çåå¸å¼ä¸ãè¿å°±è¦æ±äºåå¸å½æ°è¦æææåçå¼é½èèè¿æ¥ãå¯ä»¥å°æ¯ä¸ªåé½å½æ R è¿å¶çæä¸ä½ï¼ç¶åç»æä¸ä¸ª R è¿å¶çæ´æ°ã\n\nR ä¸è¬å 31ï¼å ä¸ºå®æ¯ä¸ä¸ªå¥ç´ æ°ï¼å¦ææ¯å¶æ°çè¯ï¼å½åºç°ä¹æ³æº¢åºï¼ä¿¡æ¯å°±ä¼ä¸¢å¤±ï¼å ä¸ºä¸ 2 ç¸ä¹ç¸å½äºåå·¦ç§»ä¸ä½ï¼æå·¦è¾¹çä½ä¸¢å¤±ãå¹¶ä¸ä¸ä¸ªæ°ä¸ 31 ç¸ä¹å¯ä»¥è½¬æ¢æç§»ä½ååæ³ï¼31*x == (x<<5)-xï¼ç¼è¯å¨ä¼èªå¨è¿è¡è¿ä¸ªä¼åã\n\n@Override\npublic int hashCode() {\n    int result = 17;\n    result = 31 * result + x;\n    result = 31 * result + y;\n    result = 31 * result + z;\n    return result;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# toString()\n\né»è®¤è¿å ToStringExample@4554617c è¿ç§å½¢å¼ï¼å¶ä¸­ @ åé¢çæ°å¼ä¸ºæ£åç çæ ç¬¦å·åå­è¿å¶è¡¨ç¤ºã\n\npublic class ToStringExample {\n\n    private int number;\n\n    public ToStringExample(int number) {\n        this.number = number;\n    }\n}\nToStringExample example = new ToStringExample(123);\nSystem.out.println(example.toString());\nToStringExample@4554617c\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# clone()\n\n1. cloneable\n\nclone() æ¯ Object ç protected æ¹æ³ï¼å®ä¸æ¯ publicï¼ä¸ä¸ªç±»ä¸æ¾å¼å»éå clone()ï¼å¶å®ç±»å°±ä¸è½ç´æ¥å»è°ç¨è¯¥ç±»å®ä¾ç clone() æ¹æ³ã\n\npublic class CloneExample {\n    private int a;\n    private int b;\n}\nCloneExample e1 = new CloneExample();\n// CloneExample e2 = e1.clone(); // \'clone()\' has protected access in \'java.lang.Object\'\n\n\n1\n2\n3\n4\n5\n6\n\n\néå clone() å¾å°ä»¥ä¸å®ç°ï¼\n\npublic class CloneExample {\n    private int a;\n    private int b;\n\n    @Override\n    public CloneExample clone() throws CloneNotSupportedException {\n        return (CloneExample)super.clone();\n    }\n}\nCloneExample e1 = new CloneExample();\ntry {\n    CloneExample e2 = e1.clone();\n} catch (CloneNotSupportedException e) {\n    e.printStackTrace();\n}\njava.lang.CloneNotSupportedException: CloneExample\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä»¥ä¸æåºäº CloneNotSupportedExceptionï¼è¿æ¯å ä¸º CloneExample æ²¡æå®ç° Cloneable æ¥å£ã\n\nåºè¯¥æ³¨æçæ¯ï¼clone() æ¹æ³å¹¶ä¸æ¯ Cloneable æ¥å£çæ¹æ³ï¼èæ¯ Object çä¸ä¸ª protected æ¹æ³ãCloneable æ¥å£åªæ¯è§å®ï¼å¦æä¸ä¸ªç±»æ²¡æå®ç° Cloneable æ¥å£åè°ç¨äº clone() æ¹æ³ï¼å°±ä¼æåº CloneNotSupportedExceptionã\n\npublic class CloneExample implements Cloneable {\n    private int a;\n    private int b;\n\n    @Override\n    public Object clone() throws CloneNotSupportedException {\n        return super.clone();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n2. æµæ·è´\n\næ·è´å¯¹è±¡ååå§å¯¹è±¡çå¼ç¨ç±»åå¼ç¨åä¸ä¸ªå¯¹è±¡ã\n\npublic class ShallowCloneExample implements Cloneable {\n\n    private int[] arr;\n\n    public ShallowCloneExample() {\n        arr = new int[10];\n        for (int i = 0; i < arr.length; i++) {\n            arr[i] = i;\n        }\n    }\n\n    public void set(int index, int value) {\n        arr[index] = value;\n    }\n\n    public int get(int index) {\n        return arr[index];\n    }\n\n    @Override\n    protected ShallowCloneExample clone() throws CloneNotSupportedException {\n        return (ShallowCloneExample) super.clone();\n    }\n}\nShallowCloneExample e1 = new ShallowCloneExample();\nShallowCloneExample e2 = null;\ntry {\n    e2 = e1.clone();\n} catch (CloneNotSupportedException e) {\n    e.printStackTrace();\n}\ne1.set(2, 222);\nSystem.out.println(e2.get(2)); // 222\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n\n\n3. æ·±æ·è´\n\næ·è´å¯¹è±¡ååå§å¯¹è±¡çå¼ç¨ç±»åå¼ç¨ä¸åå¯¹è±¡ã\n\npublic class DeepCloneExample implements Cloneable {\n\n    private int[] arr;\n\n    public DeepCloneExample() {\n        arr = new int[10];\n        for (int i = 0; i < arr.length; i++) {\n            arr[i] = i;\n        }\n    }\n\n    public void set(int index, int value) {\n        arr[index] = value;\n    }\n\n    public int get(int index) {\n        return arr[index];\n    }\n\n    @Override\n    protected DeepCloneExample clone() throws CloneNotSupportedException {\n        DeepCloneExample result = (DeepCloneExample) super.clone();\n        result.arr = new int[arr.length];\n        for (int i = 0; i < arr.length; i++) {\n            result.arr[i] = arr[i];\n        }\n        return result;\n    }\n}\nDeepCloneExample e1 = new DeepCloneExample();\nDeepCloneExample e2 = null;\ntry {\n    e2 = e1.clone();\n} catch (CloneNotSupportedException e) {\n    e.printStackTrace();\n}\ne1.set(2, 222);\nSystem.out.println(e2.get(2)); // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n\n\n4. clone() çæ¿ä»£æ¹æ¡\n\nä½¿ç¨ clone() æ¹æ³æ¥æ·è´ä¸ä¸ªå¯¹è±¡å³å¤æåæé£é©ï¼å®ä¼æåºå¼å¸¸ï¼å¹¶ä¸è¿éè¦ç±»åè½¬æ¢ãEffective Java ä¹¦ä¸è®²å°ï¼æå¥½ä¸è¦å»ä½¿ç¨ clone()ï¼å¯ä»¥ä½¿ç¨æ·è´æé å½æ°æèæ·è´å·¥åæ¥æ·è´ä¸ä¸ªå¯¹è±¡ã\n\npublic class CloneConstructorExample {\n\n    private int[] arr;\n\n    public CloneConstructorExample() {\n        arr = new int[10];\n        for (int i = 0; i < arr.length; i++) {\n            arr[i] = i;\n        }\n    }\n\n    public CloneConstructorExample(CloneConstructorExample original) {\n        arr = new int[original.arr.length];\n        for (int i = 0; i < original.arr.length; i++) {\n            arr[i] = original.arr[i];\n        }\n    }\n\n    public void set(int index, int value) {\n        arr[index] = value;\n    }\n\n    public int get(int index) {\n        return arr[index];\n    }\n}\nCloneConstructorExample e1 = new CloneConstructorExample();\nCloneConstructorExample e2 = new CloneConstructorExample(e1);\ne1.set(2, 222);\nSystem.out.println(e2.get(2)); // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\n\n# å­ãç»§æ¿\n\n\n# è®¿é®æé\n\nJava ä¸­æä¸ä¸ªè®¿é®æéä¿®é¥°ç¬¦ï¼privateãprotected ä»¥å publicï¼å¦æä¸å è®¿é®ä¿®é¥°ç¬¦ï¼è¡¨ç¤ºåçº§å¯è§ã\n\nå¯ä»¥å¯¹ç±»æç±»ä¸­çæåï¼å­æ®µåæ¹æ³ï¼å ä¸è®¿é®ä¿®é¥°ç¬¦ã\n\n * ç±»å¯è§è¡¨ç¤ºå¶å®ç±»å¯ä»¥ç¨è¿ä¸ªç±»åå»ºå®ä¾å¯¹è±¡ã\n * æåå¯è§è¡¨ç¤ºå¶å®ç±»å¯ä»¥ç¨è¿ä¸ªç±»çå®ä¾å¯¹è±¡è®¿é®å°è¯¥æåï¼\n\nprotected ç¨äºä¿®é¥°æåï¼è¡¨ç¤ºå¨ç»§æ¿ä½ç³»ä¸­æåå¯¹äºå­ç±»å¯è§ï¼ä½æ¯è¿ä¸ªè®¿é®ä¿®é¥°ç¬¦å¯¹äºç±»æ²¡ææä¹ã\n\nè®¾è®¡è¯å¥½çæ¨¡åä¼éèææçå®ç°ç»èï¼æå®ç API ä¸å®çå®ç°æ¸æ°å°éç¦»å¼æ¥ãæ¨¡åä¹é´åªéè¿å®ä»¬ç API è¿è¡éä¿¡ï¼ä¸ä¸ªæ¨¡åä¸éè¦ç¥éå¶ä»æ¨¡åçåé¨å·¥ä½æåµï¼è¿ä¸ªæ¦å¿µè¢«ç§°ä¸ºä¿¡æ¯éèæå°è£ãå æ­¤è®¿é®æéåºå½å°½å¯è½å°ä½¿æ¯ä¸ªç±»æèæåä¸è¢«å¤çè®¿é®ã\n\nå¦æå­ç±»çæ¹æ³éåäºç¶ç±»çæ¹æ³ï¼é£ä¹å­ç±»ä¸­è¯¥æ¹æ³çè®¿é®çº§å«ä¸åè®¸ä½äºç¶ç±»çè®¿é®çº§å«ãè¿æ¯ä¸ºäºç¡®ä¿å¯ä»¥ä½¿ç¨ç¶ç±»å®ä¾çå°æ¹é½å¯ä»¥ä½¿ç¨å­ç±»å®ä¾å»ä»£æ¿ï¼ä¹å°±æ¯ç¡®ä¿æ»¡è¶³éæ°æ¿æ¢ååã\n\nå­æ®µå³ä¸è½æ¯å¬æçï¼å ä¸ºè¿ä¹åçè¯å°±å¤±å»äºå¯¹è¿ä¸ªå­æ®µä¿®æ¹è¡ä¸ºçæ§å¶ï¼å®¢æ·ç«¯å¯ä»¥å¯¹å¶éæä¿®æ¹ãä¾å¦ä¸é¢çä¾å­ä¸­ï¼AccessExample æ¥æ id å¬æå­æ®µï¼å¦æå¨æä¸ªæ¶å»ï¼æä»¬æ³è¦ä½¿ç¨ int å­å¨ id å­æ®µï¼é£ä¹å°±éè¦ä¿®æ¹ææçå®¢æ·ç«¯ä»£ç ã\n\npublic class AccessExample {\n    public String id;\n}\n\n\n1\n2\n3\n\n\nå¯ä»¥ä½¿ç¨å¬æç getter å setter æ¹æ³æ¥æ¿æ¢å¬æå­æ®µï¼è¿æ ·çè¯å°±å¯ä»¥æ§å¶å¯¹å­æ®µçä¿®æ¹è¡ä¸ºã\n\npublic class AccessExample {\n\n    private int id;\n\n    public String getId() {\n        return id + "";\n    }\n\n    public void setId(String id) {\n        this.id = Integer.valueOf(id);\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä½æ¯ä¹æä¾å¤ï¼å¦ææ¯åçº§ç§æçç±»æèç§æçåµå¥ç±»ï¼é£ä¹ç´æ¥æ´é²æåä¸ä¼æç¹å«å¤§çå½±åã\n\npublic class AccessWithInnerClassExample {\n\n    private class InnerClass {\n        int x;\n    }\n\n    private InnerClass innerClass;\n\n    public AccessWithInnerClassExample() {\n        innerClass = new InnerClass();\n    }\n\n    public int getValue() {\n        return innerClass.x;  // ç´æ¥è®¿é®\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n# æ½è±¡ç±»ä¸æ¥å£\n\n1. æ½è±¡ç±»\n\næ½è±¡ç±»åæ½è±¡æ¹æ³é½ä½¿ç¨ abstract å³é®å­è¿è¡å£°æãå¦æä¸ä¸ªç±»ä¸­åå«æ½è±¡æ¹æ³ï¼é£ä¹è¿ä¸ªç±»å¿é¡»å£°æä¸ºæ½è±¡ç±»ã\n\næ½è±¡ç±»åæ®éç±»æå¤§çåºå«æ¯ï¼æ½è±¡ç±»ä¸è½è¢«å®ä¾åï¼åªè½è¢«ç»§æ¿ã\n\npublic abstract class AbstractClassExample {\n\n    protected int x;\n    private int y;\n\n    public abstract void func1();\n\n    public void func2() {\n        System.out.println("func2");\n    }\n}\npublic class AbstractExtendClassExample extends AbstractClassExample {\n    @Override\n    public void func1() {\n        System.out.println("func1");\n    }\n}\n// AbstractClassExample ac1 = new AbstractClassExample(); // \'AbstractClassExample\' is abstract; cannot be instantiated\nAbstractClassExample ac2 = new AbstractExtendClassExample();\nac2.func1();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n2. æ¥å£\n\næ¥å£æ¯æ½è±¡ç±»çå»¶ä¼¸ï¼å¨ Java 8 ä¹åï¼å®å¯ä»¥çææ¯ä¸ä¸ªå®å¨æ½è±¡çç±»ï¼ä¹å°±æ¯è¯´å®ä¸è½æä»»ä½çæ¹æ³å®ç°ã\n\nä» Java 8 å¼å§ï¼æ¥å£ä¹å¯ä»¥æ¥æé»è®¤çæ¹æ³å®ç°ï¼è¿æ¯å ä¸ºä¸æ¯æé»è®¤æ¹æ³çæ¥å£çç»´æ¤ææ¬å¤ªé«äºãå¨ Java 8 ä¹åï¼å¦æä¸ä¸ªæ¥å£æ³è¦æ·»å æ°çæ¹æ³ï¼é£ä¹è¦ä¿®æ¹ææå®ç°äºè¯¥æ¥å£çç±»ï¼è®©å®ä»¬é½å®ç°æ°å¢çæ¹æ³ã\n\næ¥å£çæåï¼å­æ®µ + æ¹æ³ï¼é»è®¤é½æ¯ public çï¼å¹¶ä¸ä¸åè®¸å®ä¹ä¸º private æè protectedãä» Java 9 å¼å§ï¼åè®¸å°æ¹æ³å®ä¹ä¸º privateï¼è¿æ ·å°±è½å®ä¹æäºå¤ç¨çä»£ç åä¸ä¼ææ¹æ³æ´é²åºå»ã\n\næ¥å£çå­æ®µé»è®¤é½æ¯ static å final çã\n\npublic interface InterfaceExample {\n\n    void func1();\n\n    default void func2(){\n        System.out.println("func2");\n    }\n\n    int x = 123;\n    // int y;               // Variable \'y\' might not have been initialized\n    public int z = 0;       // Modifier \'public\' is redundant for interface fields\n    // private int k = 0;   // Modifier \'private\' not allowed here\n    // protected int l = 0; // Modifier \'protected\' not allowed here\n    // private void fun3(); // Modifier \'private\' not allowed here\n}\npublic class InterfaceImplementExample implements InterfaceExample {\n    @Override\n    public void func1() {\n        System.out.println("func1");\n    }\n}\n// InterfaceExample ie1 = new InterfaceExample(); // \'InterfaceExample\' is abstract; cannot be instantiated\nInterfaceExample ie2 = new InterfaceImplementExample();\nie2.func1();\nSystem.out.println(InterfaceExample.x);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\n3. æ¯è¾\n\n * ä»è®¾è®¡å±é¢ä¸çï¼æ½è±¡ç±»æä¾äºä¸ç§ IS-A å³ç³»ï¼éè¦æ»¡è¶³éå¼æ¿æ¢ååï¼å³å­ç±»å¯¹è±¡å¿é¡»è½å¤æ¿æ¢æææç¶ç±»å¯¹è±¡ãèæ¥å£æ´åæ¯ä¸ç§ LIKE-A å³ç³»ï¼å®åªæ¯æä¾ä¸ç§æ¹æ³å®ç°å¥çº¦ï¼å¹¶ä¸è¦æ±æ¥å£åå®ç°æ¥å£çç±»å·æ IS-A å³ç³»ã\n * ä»ä½¿ç¨ä¸æ¥çï¼ä¸ä¸ªç±»å¯ä»¥å®ç°å¤ä¸ªæ¥å£ï¼ä½æ¯ä¸è½ç»§æ¿å¤ä¸ªæ½è±¡ç±»ã\n * æ¥å£çå­æ®µåªè½æ¯ static å final ç±»åçï¼èæ½è±¡ç±»çå­æ®µæ²¡æè¿ç§éå¶ã\n * æ¥å£çæååªè½æ¯ public çï¼èæ½è±¡ç±»çæåå¯ä»¥æå¤ç§è®¿é®æéã\n\n4. ä½¿ç¨éæ©\n\nä½¿ç¨æ¥å£ï¼\n\n * éè¦è®©ä¸ç¸å³çç±»é½å®ç°ä¸ä¸ªæ¹æ³ï¼ä¾å¦ä¸ç¸å³çç±»é½å¯ä»¥å®ç° Comparable æ¥å£ä¸­ç compareTo() æ¹æ³ï¼\n * éè¦ä½¿ç¨å¤éç»§æ¿ã\n\nä½¿ç¨æ½è±¡ç±»ï¼\n\n * éè¦å¨å ä¸ªç¸å³çç±»ä¸­å±äº«ä»£ç ã\n * éè¦è½æ§å¶ç»§æ¿æ¥çæåçè®¿é®æéï¼èä¸æ¯é½ä¸º publicã\n * éè¦ç»§æ¿ééæåéå¸¸éå­æ®µã\n\nå¨å¾å¤æåµä¸ï¼æ¥å£ä¼åäºæ½è±¡ç±»ãå ä¸ºæ¥å£æ²¡ææ½è±¡ç±»ä¸¥æ ¼çç±»å±æ¬¡ç»æè¦æ±ï¼å¯ä»¥çµæ´»å°ä¸ºä¸ä¸ªç±»æ·»å è¡ä¸ºãå¹¶ä¸ä» Java 8 å¼å§ï¼æ¥å£ä¹å¯ä»¥æé»è®¤çæ¹æ³å®ç°ï¼ä½¿å¾ä¿®æ¹æ¥å£çææ¬ä¹åçå¾ä½ã\n\n * Abstract Methods and Classes(opens new window)\n * æ·±å¥çè§£ abstract class å interface(opens new window)\n * When to Use Abstract Class and Interface(opens new window)\n * Java 9 Private Methods in Interfaces(opens new window)\n\n\n# super\n\n * è®¿é®ç¶ç±»çæé å½æ°ï¼å¯ä»¥ä½¿ç¨ super() å½æ°è®¿é®ç¶ç±»çæé å½æ°ï¼ä»èå§æç¶ç±»å®æä¸äºåå§åçå·¥ä½ãåºè¯¥æ³¨æå°ï¼å­ç±»ä¸å®ä¼è°ç¨ç¶ç±»çæé å½æ°æ¥å®æåå§åå·¥ä½ï¼ä¸è¬æ¯è°ç¨ç¶ç±»çé»è®¤æé å½æ°ï¼å¦æå­ç±»éè¦è°ç¨ç¶ç±»å¶å®æé å½æ°ï¼é£ä¹å°±å¯ä»¥ä½¿ç¨ super() å½æ°ã\n * è®¿é®ç¶ç±»çæåï¼å¦æå­ç±»éåäºç¶ç±»çæä¸ªæ¹æ³ï¼å¯ä»¥éè¿ä½¿ç¨ super å³é®å­æ¥å¼ç¨ç¶ç±»çæ¹æ³å®ç°ã\n\npublic class SuperExample {\n\n    protected int x;\n    protected int y;\n\n    public SuperExample(int x, int y) {\n        this.x = x;\n        this.y = y;\n    }\n\n    public void func() {\n        System.out.println("SuperExample.func()");\n    }\n}\npublic class SuperExtendExample extends SuperExample {\n\n    private int z;\n\n    public SuperExtendExample(int x, int y, int z) {\n        super(x, y);\n        this.z = z;\n    }\n\n    @Override\n    public void func() {\n        super.func();\n        System.out.println("SuperExtendExample.func()");\n    }\n}\nSuperExample e = new SuperExtendExample(1, 2, 3);\ne.func();\nSuperExample.func()\nSuperExtendExample.func()\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n\n\nUsing the Keyword super(opens new window)\n\n\n# éåä¸éè½½\n\n1. éåï¼Overrideï¼\n\nå­å¨äºç»§æ¿ä½ç³»ä¸­ï¼æå­ç±»å®ç°äºä¸ä¸ªä¸ç¶ç±»å¨æ¹æ³å£°æä¸å®å¨ç¸åçä¸ä¸ªæ¹æ³ã\n\nä¸ºäºæ»¡è¶³éå¼æ¿æ¢ååï¼éåæä»¥ä¸ä¸ä¸ªéå¶ï¼\n\n * å­ç±»æ¹æ³çè®¿é®æéå¿é¡»å¤§äºç­äºç¶ç±»æ¹æ³ï¼\n * å­ç±»æ¹æ³çè¿åç±»åå¿é¡»æ¯ç¶ç±»æ¹æ³è¿åç±»åæä¸ºå¶å­ç±»åã\n * å­ç±»æ¹æ³æåºçå¼å¸¸ç±»åå¿é¡»æ¯ç¶ç±»æåºå¼å¸¸ç±»åæä¸ºå¶å­ç±»åã\n\nä½¿ç¨ @Override æ³¨è§£ï¼å¯ä»¥è®©ç¼è¯å¨å¸®å¿æ£æ¥æ¯å¦æ»¡è¶³ä¸é¢çä¸ä¸ªéå¶æ¡ä»¶ã\n\nä¸é¢çç¤ºä¾ä¸­ï¼SubClass ä¸º SuperClass çå­ç±»ï¼SubClass éåäº SuperClass ç func() æ¹æ³ãå¶ä¸­ï¼\n\n * å­ç±»æ¹æ³è®¿é®æéä¸º publicï¼å¤§äºç¶ç±»ç protectedã\n * å­ç±»çè¿åç±»åä¸º ArrayList<Integer>ï¼æ¯ç¶ç±»è¿åç±»å List<Integer> çå­ç±»ã\n * å­ç±»æåºçå¼å¸¸ç±»åä¸º Exceptionï¼æ¯ç¶ç±»æåºå¼å¸¸ Throwable çå­ç±»ã\n * å­ç±»éåæ¹æ³ä½¿ç¨ @Override æ³¨è§£ï¼ä»èè®©ç¼è¯å¨èªå¨æ£æ¥æ¯å¦æ»¡è¶³éå¶æ¡ä»¶ã\n\nclass SuperClass {\n    protected List<Integer> func() throws Throwable {\n        return new ArrayList<>();\n    }\n}\n\nclass SubClass extends SuperClass {\n    @Override\n    public ArrayList<Integer> func() throws Exception {\n        return new ArrayList<>();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå¨è°ç¨ä¸ä¸ªæ¹æ³æ¶ï¼åä»æ¬ç±»ä¸­æ¥æ¾çæ¯å¦æå¯¹åºçæ¹æ³ï¼å¦ææ²¡æåå°ç¶ç±»ä¸­æ¥çï¼çæ¯å¦ä»ç¶ç±»ç»§æ¿æ¥ãå¦åå°±è¦å¯¹åæ°è¿è¡è½¬åï¼è½¬æç¶ç±»ä¹åçæ¯å¦æå¯¹åºçæ¹æ³ãæ»çæ¥è¯´ï¼æ¹æ³è°ç¨çä¼åçº§ä¸ºï¼\n\n * this.func(this)\n * super.func(this)\n * this.func(super)\n * super.func(super)\n\n/*\n    A\n    |\n    B\n    |\n    C\n    |\n    D\n */\n\n\nclass A {\n\n    public void show(A obj) {\n        System.out.println("A.show(A)");\n    }\n\n    public void show(C obj) {\n        System.out.println("A.show(C)");\n    }\n}\n\nclass B extends A {\n\n    @Override\n    public void show(A obj) {\n        System.out.println("B.show(A)");\n    }\n}\n\nclass C extends B {\n}\n\nclass D extends C {\n}\npublic static void main(String[] args) {\n\n    A a = new A();\n    B b = new B();\n    C c = new C();\n    D d = new D();\n\n    // å¨ A ä¸­å­å¨ show(A obj)ï¼ç´æ¥è°ç¨\n    a.show(a); // A.show(A)\n    // å¨ A ä¸­ä¸å­å¨ show(B obj)ï¼å° B è½¬åæå¶ç¶ç±» A\n    a.show(b); // A.show(A)\n    // å¨ B ä¸­å­å¨ä» A ç»§æ¿æ¥ç show(C obj)ï¼ç´æ¥è°ç¨\n    b.show(c); // A.show(C)\n    // å¨ B ä¸­ä¸å­å¨ show(D obj)ï¼ä½æ¯å­å¨ä» A ç»§æ¿æ¥ç show(C obj)ï¼å° D è½¬åæå¶ç¶ç±» C\n    b.show(d); // A.show(C)\n\n    // å¼ç¨çè¿æ¯ B å¯¹è±¡ï¼æä»¥ ba å b çè°ç¨ç»æä¸æ ·\n    A ba = new B();\n    ba.show(c); // A.show(C)\n    ba.show(d); // A.show(C)\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n\n\n2. éè½½ï¼Overloadï¼\n\nå­å¨äºåä¸ä¸ªç±»ä¸­ï¼æä¸ä¸ªæ¹æ³ä¸å·²ç»å­å¨çæ¹æ³åç§°ä¸ç¸åï¼ä½æ¯åæ°ç±»åãä¸ªæ°ãé¡ºåºè³å°æä¸ä¸ªä¸åã\n\nåºè¯¥æ³¨æçæ¯ï¼è¿åå¼ä¸åï¼å¶å®é½ç¸åä¸ç®æ¯éè½½ã\n\nclass OverloadingExample {\n    public void show(int x) {\n        System.out.println(x);\n    }\n\n    public void show(int x, String y) {\n        System.out.println(x + " " + y);\n    }\n}\npublic static void main(String[] args) {\n    OverloadingExample example = new OverloadingExample();\n    example.show(1);\n    example.show(1, "2");\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# ä¸ãåå°\n\næ¯ä¸ªç±»é½æä¸ä¸ª Class å¯¹è±¡ï¼åå«äºä¸ç±»æå³çä¿¡æ¯ãå½ç¼è¯ä¸ä¸ªæ°ç±»æ¶ï¼ä¼äº§çä¸ä¸ªååç .class æä»¶ï¼è¯¥æä»¶åå®¹ä¿å­ç Class å¯¹è±¡ã\n\nç±»å è½½ç¸å½äº Class å¯¹è±¡çå è½½ï¼ç±»å¨ç¬¬ä¸æ¬¡ä½¿ç¨æ¶æå¨æå è½½å° JVM ä¸­ãä¹å¯ä»¥ä½¿ç¨ Class.forName("com.mysql.jdbc.Driver") è¿ç§æ¹å¼æ¥æ§å¶ç±»çå è½½ï¼è¯¥æ¹æ³ä¼è¿åä¸ä¸ª Class å¯¹è±¡ã\n\nåå°å¯ä»¥æä¾è¿è¡æ¶çç±»ä¿¡æ¯ï¼å¹¶ä¸è¿ä¸ªç±»å¯ä»¥å¨è¿è¡æ¶æå è½½è¿æ¥ï¼çè³å¨ç¼è¯æ¶æè¯¥ç±»ç .class ä¸å­å¨ä¹å¯ä»¥å è½½è¿æ¥ã\n\nClass å java.lang.reflect ä¸èµ·å¯¹åå°æä¾äºæ¯æï¼java.lang.reflect ç±»åºä¸»è¦åå«äºä»¥ä¸ä¸ä¸ªç±»ï¼\n\n * Field ï¼å¯ä»¥ä½¿ç¨ get() å set() æ¹æ³è¯»ååä¿®æ¹ Field å¯¹è±¡å³èçå­æ®µï¼\n * Method ï¼å¯ä»¥ä½¿ç¨ invoke() æ¹æ³è°ç¨ä¸ Method å¯¹è±¡å³èçæ¹æ³ï¼\n * Constructor ï¼å¯ä»¥ç¨ Constructor ç newInstance() åå»ºæ°çå¯¹è±¡ã\n\nåå°çä¼ç¹ï¼\n\n * å¯æ©å±æ§ ï¼åºç¨ç¨åºå¯ä»¥å©ç¨å¨éå®ååå»ºå¯æ©å±å¯¹è±¡çå®ä¾ï¼æ¥ä½¿ç¨æ¥èªå¤é¨çç¨æ·èªå®ä¹ç±»ã\n * ç±»æµè§å¨åå¯è§åå¼åç¯å¢ ï¼ä¸ä¸ªç±»æµè§å¨éè¦å¯ä»¥æä¸¾ç±»çæåãå¯è§åå¼åç¯å¢ï¼å¦ IDEï¼å¯ä»¥ä»å©ç¨åå°ä¸­å¯ç¨çç±»åä¿¡æ¯ä¸­åçï¼ä»¥å¸®å©ç¨åºåç¼åæ­£ç¡®çä»£ç ã\n * è°è¯å¨åæµè¯å·¥å· ï¼ è°è¯å¨éè¦è½å¤æ£æ¥ä¸ä¸ªç±»éçç§ææåãæµè¯å·¥å·å¯ä»¥å©ç¨åå°æ¥èªå¨å°è°ç¨ç±»éå®ä¹çå¯è¢«åç°ç API å®ä¹ï¼ä»¥ç¡®ä¿ä¸ç»æµè¯ä¸­æè¾é«çä»£ç è¦ççã\n\nåå°çç¼ºç¹ï¼\n\nå°½ç®¡åå°éå¸¸å¼ºå¤§ï¼ä½ä¹ä¸è½æ»¥ç¨ãå¦æä¸ä¸ªåè½å¯ä»¥ä¸ç¨åå°å®æï¼é£ä¹æå¥½å°±ä¸ç¨ãå¨æä»¬ä½¿ç¨åå°ææ¯æ¶ï¼ä¸é¢å æ¡åå®¹åºè¯¥ç¢è®°äºå¿ã\n\n * æ§è½å¼é ï¼åå°æ¶åäºå¨æç±»åçè§£æï¼æä»¥ JVM æ æ³å¯¹è¿äºä»£ç è¿è¡ä¼åãå æ­¤ï¼åå°æä½çæçè¦æ¯é£äºéåå°æä½ä½å¾å¤ãæä»¬åºè¯¥é¿åå¨ç»å¸¸è¢«æ§è¡çä»£ç æå¯¹æ§è½è¦æ±å¾é«çç¨åºä¸­ä½¿ç¨åå°ã\n * å®å¨éå¶ ï¼ä½¿ç¨åå°ææ¯è¦æ±ç¨åºå¿é¡»å¨ä¸ä¸ªæ²¡æå®å¨éå¶çç¯å¢ä¸­è¿è¡ãå¦æä¸ä¸ªç¨åºå¿é¡»å¨æå®å¨éå¶çç¯å¢ä¸­è¿è¡ï¼å¦ Appletï¼é£ä¹è¿å°±æ¯ä¸ªé®é¢äºã\n * åé¨æ´é² ï¼ç±äºåå°åè®¸ä»£ç æ§è¡ä¸äºå¨æ­£å¸¸æåµä¸ä¸è¢«åè®¸çæä½ï¼æ¯å¦è®¿é®ç§æçå±æ§åæ¹æ³ï¼ï¼æä»¥ä½¿ç¨åå°å¯è½ä¼å¯¼è´ææä¹å¤çå¯ä½ç¨ï¼è¿å¯è½å¯¼è´ä»£ç åè½å¤±è°å¹¶ç ´åå¯ç§»æ¤æ§ãåå°ä»£ç ç ´åäºæ½è±¡æ§ï¼å æ­¤å½å¹³å°åçæ¹åçæ¶åï¼ä»£ç çè¡ä¸ºå°±æå¯è½ä¹éçååã\n * Trail: The Reflection API(opens new window)\n * æ·±å¥è§£æ Java åå°ï¼1ï¼- åºç¡(opens new window)\n\n\n# å«ãå¼å¸¸\n\nThrowable å¯ä»¥ç¨æ¥è¡¨ç¤ºä»»ä½å¯ä»¥ä½ä¸ºå¼å¸¸æåºçç±»ï¼åä¸ºä¸¤ç§ï¼ Error å Exceptionãå¶ä¸­ Error ç¨æ¥è¡¨ç¤º JVM æ æ³å¤ççéè¯¯ï¼Exception åä¸ºä¸¤ç§ï¼\n\n * åæ£å¼å¸¸ ï¼éè¦ç¨ try...catch... è¯­å¥æè·å¹¶è¿è¡å¤çï¼å¹¶ä¸å¯ä»¥ä»å¼å¸¸ä¸­æ¢å¤ï¼\n * éåæ£å¼å¸¸ ï¼æ¯ç¨åºè¿è¡æ¶éè¯¯ï¼ä¾å¦é¤ 0 ä¼å¼å Arithmetic Exceptionï¼æ­¤æ¶ç¨åºå´©æºå¹¶ä¸æ æ³æ¢å¤ã\n\n\n\n * Java Exception Interview Questions and Answers(opens new window)\n * Javaæé«ç¯ââJava å¼å¸¸å¤ç(opens new window)\n\n\n# ä¹ãæ³å\n\npublic class Box<T> {\n    // T stands for "Type"\n    private T t;\n    public void set(T t) { this.t = t; }\n    public T get() { return t; }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n * Java æ³åè¯¦è§£(opens new window)\n * 10 é Java æ³åé¢è¯é¢(opens new window)\n\n\n# åãæ³¨è§£\n\nJava æ³¨è§£æ¯éå å¨ä»£ç ä¸­çä¸äºåä¿¡æ¯ï¼ç¨äºä¸äºå·¥å·å¨ç¼è¯ãè¿è¡æ¶è¿è¡è§£æåä½¿ç¨ï¼èµ·å°è¯´æãéç½®çåè½ãæ³¨è§£ä¸ä¼ä¹ä¸è½å½±åä»£ç çå®éé»è¾ï¼ä»ä»èµ·å°è¾å©æ§çä½ç¨ã\n\næ³¨è§£ Annotation å®ç°åçä¸èªå®ä¹æ³¨è§£ä¾å­(opens new window)\n\n\n# åä¸ãç¹æ§\n\n\n# Java åçæ¬çæ°ç¹æ§\n\nNew highlights in Java SE 8\n\n 1. Lambda Expressions\n 2. Pipelines and Streams\n 3. Date and Time API\n 4. Default Methods\n 5. Type Annotations\n 6. Nashhorn JavaScript Engine\n 7. Concurrent Accumulators\n 8. Parallel operations\n 9. PermGen Error Removed\n\nNew highlights in Java SE 7\n\n 1. Strings in Switch Statement\n 2. Type Inference for Generic Instance Creation\n 3. Multiple Exception Handling\n 4. Support for Dynamic Languages\n 5. Try with Resources\n 6. Java nio Package\n 7. Binary Literals, Underscore in literals\n 8. Diamond Syntax\n\n * Difference between Java 1.8 and Java 1.7?(opens new window)\n * Java 8 ç¹æ§(opens new window)\n\n\n# Java ä¸ C++ çåºå«\n\n * Java æ¯çº¯ç²¹çé¢åå¯¹è±¡è¯­è¨ï¼ææçå¯¹è±¡é½ç»§æ¿èª java.lang.Objectï¼C++ ä¸ºäºå¼å®¹ C å³æ¯æé¢åå¯¹è±¡ä¹æ¯æé¢åè¿ç¨ã\n * Java éè¿èææºä»èå®ç°è·¨å¹³å°ç¹æ§ï¼ä½æ¯ C++ ä¾èµäºç¹å®çå¹³å°ã\n * Java æ²¡ææéï¼å®çå¼ç¨å¯ä»¥çè§£ä¸ºå®å¨æéï¼è C++ å·æå C ä¸æ ·çæéã\n * Java æ¯æèªå¨åå¾åæ¶ï¼è C++ éè¦æå¨åæ¶ã\n * Java ä¸æ¯æå¤éç»§æ¿ï¼åªè½éè¿å®ç°å¤ä¸ªæ¥å£æ¥è¾¾å°ç¸åç®çï¼è C++ æ¯æå¤éç»§æ¿ã\n * Java ä¸æ¯ææä½ç¬¦éè½½ï¼è½ç¶å¯ä»¥å¯¹ä¸¤ä¸ª String å¯¹è±¡æ§è¡å æ³è¿ç®ï¼ä½æ¯è¿æ¯è¯­è¨åç½®æ¯æçæä½ï¼ä¸å±äºæä½ç¬¦éè½½ï¼è C++ å¯ä»¥ã\n * Java ç goto æ¯ä¿çå­ï¼ä½æ¯ä¸å¯ç¨ï¼C++ å¯ä»¥ä½¿ç¨ gotoã\n\nWhat are the main differences between Java and C++?(opens new window)\n\n\n# JRE or JDK\n\n * JREï¼Java Runtime Environmentï¼Java è¿è¡ç¯å¢çç®ç§°ï¼ä¸º Java çè¿è¡æä¾äºæéçç¯å¢ãå®æ¯ä¸ä¸ª JVM ç¨åºï¼ä¸»è¦åæ¬äº JVM çæ åå®ç°åä¸äº Java åºæ¬ç±»åºã\n * JDKï¼Java Development Kitï¼Java å¼åå·¥å·åï¼æä¾äº Java çå¼ååè¿è¡ç¯å¢ãJDK æ¯ Java å¼åçæ ¸å¿ï¼éæäº JRE ä»¥åä¸äºå¶å®çå·¥å·ï¼æ¯å¦ç¼è¯ Java æºç çç¼è¯å¨ javac ç­ã\n\n\n# åèèµæ\n\n * Eckel B. Java ç¼ç¨ææ³[M]. æºæ¢°å·¥ä¸åºçç¤¾, 2002.\n * Bloch J. Effective java[M]. Addison-Wesley Professional, 2017.\n\n',normalizedContent:'# ä¸ãæ°æ®ç±»å\n\n\n# åºæ¬ç±»å\n\n * byte/8\n * char/16\n * short/16\n * int/32\n * float/32\n * long/64\n * double/64\n * boolean/~\n\nboolean åªæä¸¤ä¸ªå¼ï¼trueãfalseï¼å¯ä»¥ä½¿ç¨ 1 bit æ¥å­å¨ï¼ä½æ¯å·ä½å¤§å°æ²¡ææç¡®è§å®ãjvm ä¼å¨ç¼è¯æ¶æå° boolean ç±»åçæ°æ®è½¬æ¢ä¸º intï¼ä½¿ç¨ 1 æ¥è¡¨ç¤º trueï¼0 è¡¨ç¤º falseãjvm æ¯æ boolean æ°ç»ï¼ä½æ¯æ¯éè¿è¯»å byte æ°ç»æ¥å®ç°çã\n\n * primitive data types(opens new window)\n * the javaÂ® virtual machine specification(opens new window)\n\n\n# åè£ç±»å\n\nåºæ¬ç±»åé½æå¯¹åºçåè£ç±»åï¼åºæ¬ç±»åä¸å¶å¯¹åºçåè£ç±»åä¹é´çèµå¼ä½¿ç¨èªå¨è£ç®±ä¸æç®±å®æã\n\ninteger x = 2;     // è£ç®± è°ç¨äº integer.valueof(2)\nint y = x;         // æç®± è°ç¨äº x.intvalue()\n\n\n1\n2\n\n * autoboxing and unboxing(opens new window)\n\n\n# ç¼å­æ± \n\nnew integer(123) ä¸ integer.valueof(123) çåºå«å¨äºï¼\n\n * new integer(123) æ¯æ¬¡é½ä¼æ°å»ºä¸ä¸ªå¯¹è±¡ï¼\n * integer.valueof(123) ä¼ä½¿ç¨ç¼å­æ± ä¸­çå¯¹è±¡ï¼å¤æ¬¡è°ç¨ä¼åå¾åä¸ä¸ªå¯¹è±¡çå¼ç¨ã\n\ninteger x = new integer(123);\ninteger y = new integer(123);\nsystem.out.println(x == y);    // false\ninteger z = integer.valueof(123);\ninteger k = integer.valueof(123);\nsystem.out.println(z == k);   // true\n\n\n1\n2\n3\n4\n5\n6\n\n\nvalueof() æ¹æ³çå®ç°æ¯è¾ç®åï¼å°±æ¯åå¤æ­å¼æ¯å¦å¨ç¼å­æ± ä¸­ï¼å¦æå¨çè¯å°±ç´æ¥è¿åç¼å­æ± çåå®¹ã\n\npublic static integer valueof(int i) {\n    if (i >= integercache.low && i <= integercache.high)\n        return integercache.cache[i + (-integercache.low)];\n    return new integer(i);\n}\n\n\n1\n2\n3\n4\n5\n\n\nå¨ java 8 ä¸­ï¼integer ç¼å­æ± çå¤§å°é»è®¤ä¸º -128~127ã\n\nstatic final int low = -128;\nstatic final int high;\nstatic final integer cache[];\n\nstatic {\n    // high value may be configured by property\n    int h = 127;\n    string integercachehighpropvalue =\n        sun.misc.vm.getsavedproperty("java.lang.integer.integercache.high");\n    if (integercachehighpropvalue != null) {\n        try {\n            int i = parseint(integercachehighpropvalue);\n            i = math.max(i, 127);\n            // maximum array size is integer.max_value\n            h = math.min(i, integer.max_value - (-low) -1);\n        } catch( numberformatexception nfe) {\n            // if the property cannot be parsed into an int, ignore it.\n        }\n    }\n    high = h;\n\n    cache = new integer[(high - low) + 1];\n    int j = low;\n    for(int k = 0; k < cache.length; k++)\n        cache[k] = new integer(j++);\n\n    // range [-128, 127] must be interned (jls7 5.1.7)\n    assert integercache.high >= 127;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nç¼è¯å¨ä¼å¨èªå¨è£ç®±è¿ç¨è°ç¨ valueof() æ¹æ³ï¼å æ­¤å¤ä¸ªå¼ç¸åä¸å¼å¨ç¼å­æ± èå´åç integer å®ä¾ä½¿ç¨èªå¨è£ç®±æ¥åå»ºï¼é£ä¹å°±ä¼å¼ç¨ç¸åçå¯¹è±¡ã\n\ninteger m = 123;\ninteger n = 123;\nsystem.out.println(m == n); // true\n\n\n1\n2\n3\n\n\nåºæ¬ç±»åå¯¹åºçç¼å²æ± å¦ä¸ï¼\n\n * boolean values true and false\n * all byte values\n * short values between -128 and 127\n * int values between -128 and 127\n * char in the range \\u0000 to \\u007f\n\nå¨ä½¿ç¨è¿äºåºæ¬ç±»åå¯¹åºçåè£ç±»åæ¶ï¼å¦æè¯¥æ°å¼èå´å¨ç¼å²æ± èå´åï¼å°±å¯ä»¥ç´æ¥ä½¿ç¨ç¼å²æ± ä¸­çå¯¹è±¡ã\n\nå¨ jdk 1.8 ææçæ°å¼ç±»ç¼å²æ± ä¸­ï¼integer çç¼å²æ±  integercache å¾ç¹æ®ï¼è¿ä¸ªç¼å²æ± çä¸çæ¯ - 128ï¼ä¸çé»è®¤æ¯ 127ï¼ä½æ¯è¿ä¸ªä¸çæ¯å¯è°çï¼å¨å¯å¨ jvm çæ¶åï¼éè¿ -xx:autoboxcachemax=<size> æ¥æå®è¿ä¸ªç¼å²æ± çå¤§å°ï¼è¯¥éé¡¹å¨ jvm åå§åçæ¶åä¼è®¾å®ä¸ä¸ªåä¸º java.lang.integercache.high ç³»ç»å±æ§ï¼ç¶å integercache åå§åçæ¶åå°±ä¼è¯»åè¯¥ç³»ç»å±æ§æ¥å³å®ä¸çã\n\nstackoverflow : differences between new integer(123), integer.valueof(123) and just 123 (opens new window)\n\n\n# äºãstring\n\n\n# æ¦è§\n\nstring è¢«å£°æä¸º finalï¼å æ­¤å®ä¸å¯è¢«ç»§æ¿ã(integer ç­åè£ç±»ä¹ä¸è½è¢«ç»§æ¿ï¼\n\nå¨ java 8 ä¸­ï¼string åé¨ä½¿ç¨ char æ°ç»å­å¨æ°æ®ã\n\npublic final class string\n    implements java.io.serializable, comparable<string>, charsequence {\n    /** the value is used for character storage. */\n    private final char value[];\n}\n\n\n1\n2\n3\n4\n5\n\n\nå¨ java 9 ä¹åï¼string ç±»çå®ç°æ¹ç¨ byte æ°ç»å­å¨å­ç¬¦ä¸²ï¼åæ¶ä½¿ç¨ coder æ¥æ è¯ä½¿ç¨äºåªç§ç¼ç ã\n\npublic final class string\n    implements java.io.serializable, comparable<string>, charsequence {\n    /** the value is used for character storage. */\n    private final byte[] value;\n\n    /** the identifier of the encoding used to encode the bytes in {@code value}. */\n    private final byte coder;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nvalue æ°ç»è¢«å£°æä¸º finalï¼è¿æå³ç value æ°ç»åå§åä¹åå°±ä¸è½åå¼ç¨å¶å®æ°ç»ãå¹¶ä¸ string åé¨æ²¡ææ¹å value æ°ç»çæ¹æ³ï¼å æ­¤å¯ä»¥ä¿è¯ string ä¸å¯åã\n\n\n# ä¸å¯åçå¥½å¤\n\n1. å¯ä»¥ç¼å­ hash å¼\n\nå ä¸º string ç hash å¼ç»å¸¸è¢«ä½¿ç¨ï¼ä¾å¦ string ç¨å hashmap ç keyãä¸å¯åçç¹æ§å¯ä»¥ä½¿å¾ hash å¼ä¹ä¸å¯åï¼å æ­¤åªéè¦è¿è¡ä¸æ¬¡è®¡ç®ã\n\n2. string pool çéè¦\n\nå¦æä¸ä¸ª string å¯¹è±¡å·²ç»è¢«åå»ºè¿äºï¼é£ä¹å°±ä¼ä» string pool ä¸­åå¾å¼ç¨ãåªæ string æ¯ä¸å¯åçï¼æå¯è½ä½¿ç¨ string poolã\n\n\n\n3. å®å¨æ§\n\nstring ç»å¸¸ä½ä¸ºåæ°ï¼string ä¸å¯åæ§å¯ä»¥ä¿è¯åæ°ä¸å¯åãä¾å¦å¨ä½ä¸ºç½ç»è¿æ¥åæ°çæåµä¸å¦æ string æ¯å¯åçï¼é£ä¹å¨ç½ç»è¿æ¥è¿ç¨ä¸­ï¼string è¢«æ¹åï¼æ¹å string çé£ä¸æ¹ä»¥ä¸ºç°å¨è¿æ¥çæ¯å¶å®ä¸»æºï¼èå®éæåµå´ä¸ä¸å®æ¯ã\n\n4. çº¿ç¨å®å¨\n\nstring ä¸å¯åæ§å¤©çå·å¤çº¿ç¨å®å¨ï¼å¯ä»¥å¨å¤ä¸ªçº¿ç¨ä¸­å®å¨å°ä½¿ç¨ã\n\nprogram creek : why string is immutable in java?(opens new window)\n\n\n# string, stringbuffer and stringbuilder\n\n1. å¯åæ§\n\n * string ä¸å¯å\n * stringbuffer å stringbuilder å¯å\n\n2. çº¿ç¨å®å¨\n\n * string ä¸å¯åï¼å æ­¤æ¯çº¿ç¨å®å¨ç\n * stringbuilder ä¸æ¯çº¿ç¨å®å¨ç\n * stringbuffer æ¯çº¿ç¨å®å¨çï¼åé¨ä½¿ç¨ synchronized è¿è¡åæ­¥\n\nstackoverflow : string, stringbuffer, and stringbuilder(opens new window)\n\n\n# string pool\n\nå­ç¬¦ä¸²å¸¸éæ± ï¼string poolï¼ä¿å­çææå­ç¬¦ä¸²å­é¢éï¼literal stringsï¼ï¼è¿äºå­é¢éå¨ç¼è¯æ¶æå°±ç¡®å®ãä¸ä»å¦æ­¤ï¼è¿å¯ä»¥ä½¿ç¨ string ç intern() æ¹æ³å¨è¿è¡è¿ç¨å°å­ç¬¦ä¸²æ·»å å° string pool ä¸­ã\n\nå½ä¸ä¸ªå­ç¬¦ä¸²è°ç¨ intern() æ¹æ³æ¶ï¼å¦æ string pool ä¸­å·²ç»å­å¨ä¸ä¸ªå­ç¬¦ä¸²åè¯¥å­ç¬¦ä¸²å¼ç¸ç­ï¼ä½¿ç¨ equals() æ¹æ³è¿è¡ç¡®å®ï¼ï¼é£ä¹å°±ä¼è¿å string pool ä¸­å­ç¬¦ä¸²çå¼ç¨ï¼å¦åï¼å°±ä¼å¨ string pool ä¸­æ·»å ä¸ä¸ªæ°çå­ç¬¦ä¸²ï¼å¹¶è¿åè¿ä¸ªæ°å­ç¬¦ä¸²çå¼ç¨ã\n\nä¸é¢ç¤ºä¾ä¸­ï¼s1 å s2 éç¨ new string() çæ¹å¼æ°å»ºäºä¸¤ä¸ªä¸åå­ç¬¦ä¸²ï¼è s3 å s4 æ¯éè¿ s1.intern() å s2.intern() æ¹æ³åå¾åä¸ä¸ªå­ç¬¦ä¸²å¼ç¨ãintern() é¦åæ "aaa" æ¾å° string pool ä¸­ï¼ç¶åè¿åè¿ä¸ªå­ç¬¦ä¸²å¼ç¨ï¼å æ­¤ s3 å s4 å¼ç¨çæ¯åä¸ä¸ªå­ç¬¦ä¸²ã\n\nstring s1 = new string("aaa");\nstring s2 = new string("aaa");\nsystem.out.println(s1 == s2);           // false\nstring s3 = s1.intern();\nstring s4 = s2.intern();\nsystem.out.println(s3 == s4);           // true\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¦ææ¯éç¨ "bbb" è¿ç§å­é¢éçå½¢å¼åå»ºå­ç¬¦ä¸²ï¼ä¼èªå¨å°å°å­ç¬¦ä¸²æ¾å¥ string pool ä¸­ã\n\nstring s5 = "bbb";\nstring s6 = "bbb";\nsystem.out.println(s5 == s6);  // true\n\n\n1\n2\n3\n\n\nå¨ java 7 ä¹åï¼string pool è¢«æ¾å¨è¿è¡æ¶å¸¸éæ± ä¸­ï¼å®å±äºæ°¸ä¹ä»£ãèå¨ java 7ï¼string pool è¢«ç§»å°å ä¸­ãè¿æ¯å ä¸ºæ°¸ä¹ä»£çç©ºé´æéï¼å¨å¤§éä½¿ç¨å­ç¬¦ä¸²çåºæ¯ä¸ä¼å¯¼è´ outofmemoryerror éè¯¯ã\n\n * stackoverflow : what is string interning?(opens new window)\n * æ·±å¥è§£æ string#intern(opens new window)\n\n\n# new string("abc")\n\nä½¿ç¨è¿ç§æ¹å¼ä¸å±ä¼åå»ºä¸¤ä¸ªå­ç¬¦ä¸²å¯¹è±¡ï¼åææ¯ string pool ä¸­è¿æ²¡æ "abc" å­ç¬¦ä¸²å¯¹è±¡ï¼ã\n\n * "abc" å±äºå­ç¬¦ä¸²å­é¢éï¼å æ­¤ç¼è¯æ¶æä¼å¨ string pool ä¸­åå»ºä¸ä¸ªå­ç¬¦ä¸²å¯¹è±¡ï¼æåè¿ä¸ª "abc" å­ç¬¦ä¸²å­é¢éï¼\n * èä½¿ç¨ new çæ¹å¼ä¼å¨å ä¸­åå»ºä¸ä¸ªå­ç¬¦ä¸²å¯¹è±¡ã\n\nåå»ºä¸ä¸ªæµè¯ç±»ï¼å¶ main æ¹æ³ä¸­ä½¿ç¨è¿ç§æ¹å¼æ¥åå»ºå­ç¬¦ä¸²å¯¹è±¡ã\n\npublic class newstringtest {\n    public static void main(string[] args) {\n        string s = new string("abc");\n    }\n}\n\n\n1\n2\n3\n4\n5\n\n\nä½¿ç¨ javap -verbose è¿è¡åç¼è¯ï¼å¾å°ä»¥ä¸åå®¹ï¼\n\n// ...\nconstant pool:\n// ...\n   #2 = class              #18            // java/lang/string\n   #3 = string             #19            // abc\n// ...\n  #18 = utf8               java/lang/string\n  #19 = utf8               abc\n// ...\n\n  public static void main(java.lang.string[]);\n    descriptor: ([ljava/lang/string;)v\n    flags: acc_public, acc_static\n    code:\n      stack=3, locals=2, args_size=1\n         0: new           #2                  // class java/lang/string\n         3: dup\n         4: ldc           #3                  // string abc\n         6: invokespecial #4                  // method java/lang/string."<init>":(ljava/lang/string;)v\n         9: astore_1\n// ...\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nå¨ constant pool ä¸­ï¼#19 å­å¨è¿å­ç¬¦ä¸²å­é¢é "abc"ï¼#3 æ¯ string pool çå­ç¬¦ä¸²å¯¹è±¡ï¼å®æå #19 è¿ä¸ªå­ç¬¦ä¸²å­é¢éãå¨ main æ¹æ³ä¸­ï¼0: è¡ä½¿ç¨ new #2 å¨å ä¸­åå»ºä¸ä¸ªå­ç¬¦ä¸²å¯¹è±¡ï¼å¹¶ä¸ä½¿ç¨ ldc #3 å° string pool ä¸­çå­ç¬¦ä¸²å¯¹è±¡ä½ä¸º string æé å½æ°çåæ°ã\n\nä»¥ä¸æ¯ string æé å½æ°çæºç ï¼å¯ä»¥çå°ï¼å¨å°ä¸ä¸ªå­ç¬¦ä¸²å¯¹è±¡ä½ä¸ºå¦ä¸ä¸ªå­ç¬¦ä¸²å¯¹è±¡çæé å½æ°åæ°æ¶ï¼å¹¶ä¸ä¼å®å¨å¤å¶ value æ°ç»åå®¹ï¼èæ¯é½ä¼æååä¸ä¸ª value æ°ç»ã\n\npublic string(string original) {\n    this.value = original.value;\n    this.hash = original.hash;\n}\n\n\n1\n2\n3\n4\n\n\n\n\n\n# ä¸ãè¿ç®\n\n\n# åæ°ä¼ é\n\njava çåæ°æ¯ä»¥å¼ä¼ éçå½¢å¼ä¼ å¥æ¹æ³ä¸­ï¼èä¸æ¯å¼ç¨ä¼ éã\n\nä»¥ä¸ä»£ç ä¸­ dog dog ç dog æ¯ä¸ä¸ªæéï¼å­å¨çæ¯å¯¹è±¡çå°åãå¨å°ä¸ä¸ªåæ°ä¼ å¥ä¸ä¸ªæ¹æ³æ¶ï¼æ¬è´¨ä¸æ¯å°å¯¹è±¡çå°åä»¥å¼çæ¹å¼ä¼ éå°å½¢åä¸­ã\n\npublic class dog {\n\n    string name;\n\n    dog(string name) {\n        this.name = name;\n    }\n\n    string getname() {\n        return this.name;\n    }\n\n    void setname(string name) {\n        this.name = name;\n    }\n\n    string getobjectaddress() {\n        return super.tostring();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nå¨æ¹æ³ä¸­æ¹åå¯¹è±¡çå­æ®µå¼ä¼æ¹ååå¯¹è±¡è¯¥å­æ®µå¼ï¼å ä¸ºå¼ç¨çæ¯åä¸ä¸ªå¯¹è±¡ã\n\nclass passbyvalueexample {\n    public static void main(string[] args) {\n        dog dog = new dog("a");\n        func(dog);\n        system.out.println(dog.getname());          // b\n    }\n\n    private static void func(dog dog) {\n        dog.setname("b");\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä½æ¯å¨æ¹æ³ä¸­å°æéå¼ç¨äºå¶å®å¯¹è±¡ï¼é£ä¹æ­¤æ¶æ¹æ³éåæ¹æ³å¤çä¸¤ä¸ªæéæåäºä¸åçå¯¹è±¡ï¼å¨ä¸ä¸ªæéæ¹åå¶ææåå¯¹è±¡çåå®¹å¯¹å¦ä¸ä¸ªæéææåçå¯¹è±¡æ²¡æå½±åã\n\npublic class passbyvalueexample {\n    public static void main(string[] args) {\n        dog dog = new dog("a");\n        system.out.println(dog.getobjectaddress()); // dog@4554617c\n        func(dog);\n        system.out.println(dog.getobjectaddress()); // dog@4554617c\n        system.out.println(dog.getname());          // a\n    }\n\n    private static void func(dog dog) {\n        system.out.println(dog.getobjectaddress()); // dog@4554617c\n        dog = new dog("b");\n        system.out.println(dog.getobjectaddress()); // dog@74a14482\n        system.out.println(dog.getname());          // b\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nstackoverflow: is java âpass-by-referenceâ or âpass-by-valueâ?(opens new window)\n\n\n# float ä¸ double\n\njava ä¸è½éå¼æ§è¡åä¸è½¬åï¼å ä¸ºè¿ä¼ä½¿å¾ç²¾åº¦éä½ã\n\n1.1 å­é¢éå±äº double ç±»åï¼ä¸è½ç´æ¥å° 1.1 ç´æ¥èµå¼ç» float åéï¼å ä¸ºè¿æ¯åä¸è½¬åã\n\n// float f = 1.1;\n\n\n1\n\n\n1.1f å­é¢éææ¯ float ç±»åã\n\nfloat f = 1.1f;\n\n\n1\n\n\n\n# éå¼ç±»åè½¬æ¢\n\nå ä¸ºå­é¢é 1 æ¯ int ç±»åï¼å®æ¯ short ç±»åç²¾åº¦è¦é«ï¼å æ­¤ä¸è½éå¼å°å° int ç±»ååä¸è½¬åä¸º short ç±»åã\n\nshort s1 = 1;\n// s1 = s1 + 1;\n\n\n1\n2\n\n\nä½æ¯ä½¿ç¨ += æè ++ è¿ç®ç¬¦ä¼æ§è¡éå¼ç±»åè½¬æ¢ã\n\ns1 += 1;\ns1++;\n\n\n1\n2\n\n\nä¸é¢çè¯­å¥ç¸å½äºå° s1 + 1 çè®¡ç®ç»æè¿è¡äºåä¸è½¬åï¼\n\ns1 = (short) (s1 + 1);\n\n\n1\n\n\nstackoverflow : why don\'t java\'s +=, -=, *=, /= compound assignment operators require casting?(opens new window)\n\n\n# switch\n\nä» java 7 å¼å§ï¼å¯ä»¥å¨ switch æ¡ä»¶å¤æ­è¯­å¥ä¸­ä½¿ç¨ string å¯¹è±¡ã\n\nstring s = "a";\nswitch (s) {\n    case "a":\n        system.out.println("aaa");\n        break;\n    case "b":\n        system.out.println("bbb");\n        break;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nswitch ä¸æ¯æ longãfloatãdoubleï¼æ¯å ä¸º switch çè®¾è®¡åè¡·æ¯å¯¹é£äºåªæå°æ°å ä¸ªå¼çç±»åè¿è¡ç­å¼å¤æ­ï¼å¦æå¼è¿äºå¤æï¼é£ä¹è¿æ¯ç¨ if æ¯è¾åéã\n\n// long x = 111;\n// switch (x) { // incompatible types. found: \'long\', required: \'char, byte, short, int, character, byte, short, integer, string, or an enum\'\n//     case 111:\n//         system.out.println(111);\n//         break;\n//     case 222:\n//         system.out.println(222);\n//         break;\n// }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nstackoverflow : why can\'t your switch statement data type be long, java?(opens new window)\n\n\n# åãå³é®å­\n\n\n# final\n\n1. æ°æ®\n\nå£°ææ°æ®ä¸ºå¸¸éï¼å¯ä»¥æ¯ç¼è¯æ¶å¸¸éï¼ä¹å¯ä»¥æ¯å¨è¿è¡æ¶è¢«åå§ååä¸è½è¢«æ¹åçå¸¸éã\n\n * å¯¹äºåºæ¬ç±»åï¼final ä½¿æ°å¼ä¸åï¼\n * å¯¹äºå¼ç¨ç±»åï¼final ä½¿å¼ç¨ä¸åï¼ä¹å°±ä¸è½å¼ç¨å¶å®å¯¹è±¡ï¼ä½æ¯è¢«å¼ç¨çå¯¹è±¡æ¬èº«æ¯å¯ä»¥ä¿®æ¹çã\n\nfinal int x = 1;\n// x = 2;  // cannot assign value to final variable \'x\'\nfinal a y = new a();\ny.a = 1;\n\n\n1\n2\n3\n4\n\n\n2. æ¹æ³\n\nå£°ææ¹æ³ä¸è½è¢«å­ç±»éåã\n\nprivate æ¹æ³éå¼å°è¢«æå®ä¸º finalï¼å¦æå¨å­ç±»ä¸­å®ä¹çæ¹æ³ååºç±»ä¸­çä¸ä¸ª private æ¹æ³ç­¾åç¸åï¼æ­¤æ¶å­ç±»çæ¹æ³ä¸æ¯éååºç±»æ¹æ³ï¼èæ¯å¨å­ç±»ä¸­å®ä¹äºä¸ä¸ªæ°çæ¹æ³ã\n\n3. ç±»\n\nå£°æç±»ä¸åè®¸è¢«ç»§æ¿ã\n\n\n# static\n\n1. éæåé\n\n * éæåéï¼åç§°ä¸ºç±»åéï¼ä¹å°±æ¯è¯´è¿ä¸ªåéå±äºç±»çï¼ç±»ææçå®ä¾é½å±äº«éæåéï¼å¯ä»¥ç´æ¥éè¿ç±»åæ¥è®¿é®å®ãéæåéå¨åå­ä¸­åªå­å¨ä¸ä»½ã\n * å®ä¾åéï¼æ¯åå»ºä¸ä¸ªå®ä¾å°±ä¼äº§çä¸ä¸ªå®ä¾åéï¼å®ä¸è¯¥å®ä¾åçå±æ­»ã\n\npublic class a {\n\n    private int x;         // å®ä¾åé\n    private static int y;  // éæåé\n\n    public static void main(string[] args) {\n        // int x = a.x;  // non-static field \'x\' cannot be referenced from a static context\n        a a = new a();\n        int x = a.x;\n        int y = a.y;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n2. éææ¹æ³\n\néææ¹æ³å¨ç±»å è½½çæ¶åå°±å­å¨äºï¼å®ä¸ä¾èµäºä»»ä½å®ä¾ãæä»¥éææ¹æ³å¿é¡»æå®ç°ï¼ä¹å°±æ¯è¯´å®ä¸è½æ¯æ½è±¡æ¹æ³ã\n\npublic abstract class a {\n    public static void func1(){\n    }\n    // public abstract static void func2();  // illegal combination of modifiers: \'abstract\' and \'static\'\n}\n\n\n1\n2\n3\n4\n5\n\n\nåªè½è®¿é®æå±ç±»çéæå­æ®µåéææ¹æ³ï¼æ¹æ³ä¸­ä¸è½æ this å super å³é®å­ï¼å ä¸ºè¿ä¸¤ä¸ªå³é®å­ä¸å·ä½å¯¹è±¡å³èã\n\npublic class a {\n\n    private static int x;\n    private int y;\n\n    public static void func1(){\n        int a = x;\n        // int b = y;  // non-static field \'y\' cannot be referenced from a static context\n        // int b = this.y;     // \'a.this\' cannot be referenced from a static context\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n3. éæè¯­å¥å\n\néæè¯­å¥åå¨ç±»åå§åæ¶è¿è¡ä¸æ¬¡ã\n\npublic class a {\n    static {\n        system.out.println("123");\n    }\n\n    public static void main(string[] args) {\n        a a1 = new a();\n        a a2 = new a();\n    }\n}\n123\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n4. éæåé¨ç±»\n\nééæåé¨ç±»ä¾èµäºå¤é¨ç±»çå®ä¾ï¼ä¹å°±æ¯è¯´éè¦ååå»ºå¤é¨ç±»å®ä¾ï¼æè½ç¨è¿ä¸ªå®ä¾å»åå»ºééæåé¨ç±»ãèéæåé¨ç±»ä¸éè¦ã\n\npublic class outerclass {\n\n    class innerclass {\n    }\n\n    static class staticinnerclass {\n    }\n\n    public static void main(string[] args) {\n        // innerclass innerclass = new innerclass(); // \'outerclass.this\' cannot be referenced from a static context\n        outerclass outerclass = new outerclass();\n        innerclass innerclass = outerclass.new innerclass();\n        staticinnerclass staticinnerclass = new staticinnerclass();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\néæåé¨ç±»ä¸è½è®¿é®å¤é¨ç±»çééæçåéåæ¹æ³ã\n\n5. éæå¯¼å\n\nå¨ä½¿ç¨éæåéåæ¹æ³æ¶ä¸ç¨åææ classnameï¼ä»èç®åä»£ç ï¼ä½å¯è¯»æ§å¤§å¤§éä½ã\n\nimport static com.xxx.classname.*\n\n\n1\n\n\n6. åå§åé¡ºåº\n\néæåéåéæè¯­å¥åä¼åäºå®ä¾åéåæ®éè¯­å¥åï¼éæåéåéæè¯­å¥åçåå§åé¡ºåºåå³äºå®ä»¬å¨ä»£ç ä¸­çé¡ºåºã\n\npublic static string staticfield = "éæåé";\nstatic {\n    system.out.println("éæè¯­å¥å");\n}\npublic string field = "å®ä¾åé";\n{\n    system.out.println("æ®éè¯­å¥å");\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næåææ¯æé å½æ°çåå§åã\n\npublic initialordertest() {\n    system.out.println("æé å½æ°");\n}\n\n\n1\n2\n3\n\n\nå­å¨ç»§æ¿çæåµä¸ï¼åå§åé¡ºåºä¸ºï¼\n\n * ç¶ç±»ï¼éæåéãéæè¯­å¥åï¼\n * å­ç±»ï¼éæåéãéæè¯­å¥åï¼\n * ç¶ç±»ï¼å®ä¾åéãæ®éè¯­å¥åï¼\n * ç¶ç±»ï¼æé å½æ°ï¼\n * å­ç±»ï¼å®ä¾åéãæ®éè¯­å¥åï¼\n * å­ç±»ï¼æé å½æ°ï¼\n\n\n# äºãobject éç¨æ¹æ³\n\n\n# æ¦è§\n\npublic native int hashcode()\n\npublic boolean equals(object obj)\n\nprotected native object clone() throws clonenotsupportedexception\n\npublic string tostring()\n\npublic final native class<?> getclass()\n\nprotected void finalize() throws throwable {}\n\npublic final native void notify()\n\npublic final native void notifyall()\n\npublic final native void wait(long timeout) throws interruptedexception\n\npublic final void wait(long timeout, int nanos) throws interruptedexception\n\npublic final void wait() throws interruptedexception\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n\n# equals()\n\n1. ç­ä»·å³ç³»\n\nä¸¤ä¸ªå¯¹è±¡å·æç­ä»·å³ç³»ï¼éè¦æ»¡è¶³ä»¥ä¸äºä¸ªæ¡ä»¶ï¼\n\nâ° èªåæ§\n\nx.equals(x); // true\n\n\n1\n\n\nâ± å¯¹ç§°æ§\n\nx.equals(y) == y.equals(x); // true\n\n\n1\n\n\nâ² ä¼ éæ§\n\nif (x.equals(y) && y.equals(z))\n    x.equals(z); // true;\n\n\n1\n2\n\n\nâ³ ä¸è´æ§\n\nå¤æ¬¡è°ç¨ equals() æ¹æ³ç»æä¸å\n\nx.equals(y) == x.equals(y); // true\n\n\n1\n\n\nâ´ ä¸ null çæ¯è¾\n\nå¯¹ä»»ä½ä¸æ¯ null çå¯¹è±¡ x è°ç¨ x.equals(null) ç»æé½ä¸º false\n\nx.equals(null); // false;\n\n\n1\n\n\n2. ç­ä»·ä¸ç¸ç­\n\n * å¯¹äºåºæ¬ç±»åï¼== å¤æ­ä¸¤ä¸ªå¼æ¯å¦ç¸ç­ï¼åºæ¬ç±»åæ²¡æ equals() æ¹æ³ã\n * å¯¹äºå¼ç¨ç±»åï¼== å¤æ­ä¸¤ä¸ªåéæ¯å¦å¼ç¨åä¸ä¸ªå¯¹è±¡ï¼è equals() å¤æ­å¼ç¨çå¯¹è±¡æ¯å¦ç­ä»·ã\n\ninteger x = new integer(1);\ninteger y = new integer(1);\nsystem.out.println(x.equals(y)); // true\nsystem.out.println(x == y);      // false\n\n\n1\n2\n3\n4\n\n\n3. å®ç°\n\n * æ£æ¥æ¯å¦ä¸ºåä¸ä¸ªå¯¹è±¡çå¼ç¨ï¼å¦ææ¯ç´æ¥è¿å trueï¼\n * æ£æ¥æ¯å¦æ¯åä¸ä¸ªç±»åï¼å¦æä¸æ¯ï¼ç´æ¥è¿å falseï¼\n * å° object å¯¹è±¡è¿è¡è½¬åï¼\n * å¤æ­æ¯ä¸ªå³é®åæ¯å¦ç¸ç­ã\n\npublic class equalexample {\n\n    private int x;\n    private int y;\n    private int z;\n\n    public equalexample(int x, int y, int z) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n    }\n\n    @override\n    public boolean equals(object o) {\n        if (this == o) return true;\n        if (o == null || getclass() != o.getclass()) return false;\n\n        equalexample that = (equalexample) o;\n\n        if (x != that.x) return false;\n        if (y != that.y) return false;\n        return z == that.z;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n\n# hashcode()\n\nhashcode() è¿ååå¸å¼ï¼è equals() æ¯ç¨æ¥å¤æ­ä¸¤ä¸ªå¯¹è±¡æ¯å¦ç­ä»·ãç­ä»·çä¸¤ä¸ªå¯¹è±¡æ£åå¼ä¸å®ç¸åï¼ä½æ¯æ£åå¼ç¸åçä¸¤ä¸ªå¯¹è±¡ä¸ä¸å®ç­ä»·ï¼è¿æ¯å ä¸ºè®¡ç®åå¸å¼å·æéæºæ§ï¼ä¸¤ä¸ªå¼ä¸åçå¯¹è±¡å¯è½è®¡ç®åºç¸åçåå¸å¼ã\n\nå¨è¦ç equals() æ¹æ³æ¶åºå½æ»æ¯è¦ç hashcode() æ¹æ³ï¼ä¿è¯ç­ä»·çä¸¤ä¸ªå¯¹è±¡åå¸å¼ä¹ç¸ç­ã\n\nhashset å hashmap ç­éåç±»ä½¿ç¨äº hashcode() æ¹æ³æ¥è®¡ç®å¯¹è±¡åºè¯¥å­å¨çä½ç½®ï¼å æ­¤è¦å°å¯¹è±¡æ·»å å°è¿äºéåç±»ä¸­ï¼éè¦è®©å¯¹åºçç±»å®ç° hashcode() æ¹æ³ã\n\nä¸é¢çä»£ç ä¸­ï¼æ°å»ºäºä¸¤ä¸ªç­ä»·çå¯¹è±¡ï¼å¹¶å°å®ä»¬æ·»å å° hashset ä¸­ãæä»¬å¸æå°è¿ä¸¤ä¸ªå¯¹è±¡å½æä¸æ ·çï¼åªå¨éåä¸­æ·»å ä¸ä¸ªå¯¹è±¡ãä½æ¯ equalexample æ²¡æå®ç° hashcode() æ¹æ³ï¼å æ­¤è¿ä¸¤ä¸ªå¯¹è±¡çåå¸å¼æ¯ä¸åçï¼æç»å¯¼è´éåæ·»å äºä¸¤ä¸ªç­ä»·çå¯¹è±¡ã\n\nequalexample e1 = new equalexample(1, 1, 1);\nequalexample e2 = new equalexample(1, 1, 1);\nsystem.out.println(e1.equals(e2)); // true\nhashset<equalexample> set = new hashset<>();\nset.add(e1);\nset.add(e2);\nsystem.out.println(set.size());   // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nçæ³çåå¸å½æ°åºå½å·æååæ§ï¼å³ä¸ç¸ç­çå¯¹è±¡åºå½åååå¸å°ææå¯è½çåå¸å¼ä¸ãè¿å°±è¦æ±äºåå¸å½æ°è¦æææåçå¼é½èèè¿æ¥ãå¯ä»¥å°æ¯ä¸ªåé½å½æ r è¿å¶çæä¸ä½ï¼ç¶åç»æä¸ä¸ª r è¿å¶çæ´æ°ã\n\nr ä¸è¬å 31ï¼å ä¸ºå®æ¯ä¸ä¸ªå¥ç´ æ°ï¼å¦ææ¯å¶æ°çè¯ï¼å½åºç°ä¹æ³æº¢åºï¼ä¿¡æ¯å°±ä¼ä¸¢å¤±ï¼å ä¸ºä¸ 2 ç¸ä¹ç¸å½äºåå·¦ç§»ä¸ä½ï¼æå·¦è¾¹çä½ä¸¢å¤±ãå¹¶ä¸ä¸ä¸ªæ°ä¸ 31 ç¸ä¹å¯ä»¥è½¬æ¢æç§»ä½ååæ³ï¼31*x == (x<<5)-xï¼ç¼è¯å¨ä¼èªå¨è¿è¡è¿ä¸ªä¼åã\n\n@override\npublic int hashcode() {\n    int result = 17;\n    result = 31 * result + x;\n    result = 31 * result + y;\n    result = 31 * result + z;\n    return result;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# tostring()\n\né»è®¤è¿å tostringexample@4554617c è¿ç§å½¢å¼ï¼å¶ä¸­ @ åé¢çæ°å¼ä¸ºæ£åç çæ ç¬¦å·åå­è¿å¶è¡¨ç¤ºã\n\npublic class tostringexample {\n\n    private int number;\n\n    public tostringexample(int number) {\n        this.number = number;\n    }\n}\ntostringexample example = new tostringexample(123);\nsystem.out.println(example.tostring());\ntostringexample@4554617c\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# clone()\n\n1. cloneable\n\nclone() æ¯ object ç protected æ¹æ³ï¼å®ä¸æ¯ publicï¼ä¸ä¸ªç±»ä¸æ¾å¼å»éå clone()ï¼å¶å®ç±»å°±ä¸è½ç´æ¥å»è°ç¨è¯¥ç±»å®ä¾ç clone() æ¹æ³ã\n\npublic class cloneexample {\n    private int a;\n    private int b;\n}\ncloneexample e1 = new cloneexample();\n// cloneexample e2 = e1.clone(); // \'clone()\' has protected access in \'java.lang.object\'\n\n\n1\n2\n3\n4\n5\n6\n\n\néå clone() å¾å°ä»¥ä¸å®ç°ï¼\n\npublic class cloneexample {\n    private int a;\n    private int b;\n\n    @override\n    public cloneexample clone() throws clonenotsupportedexception {\n        return (cloneexample)super.clone();\n    }\n}\ncloneexample e1 = new cloneexample();\ntry {\n    cloneexample e2 = e1.clone();\n} catch (clonenotsupportedexception e) {\n    e.printstacktrace();\n}\njava.lang.clonenotsupportedexception: cloneexample\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä»¥ä¸æåºäº clonenotsupportedexceptionï¼è¿æ¯å ä¸º cloneexample æ²¡æå®ç° cloneable æ¥å£ã\n\nåºè¯¥æ³¨æçæ¯ï¼clone() æ¹æ³å¹¶ä¸æ¯ cloneable æ¥å£çæ¹æ³ï¼èæ¯ object çä¸ä¸ª protected æ¹æ³ãcloneable æ¥å£åªæ¯è§å®ï¼å¦æä¸ä¸ªç±»æ²¡æå®ç° cloneable æ¥å£åè°ç¨äº clone() æ¹æ³ï¼å°±ä¼æåº clonenotsupportedexceptionã\n\npublic class cloneexample implements cloneable {\n    private int a;\n    private int b;\n\n    @override\n    public object clone() throws clonenotsupportedexception {\n        return super.clone();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n2. æµæ·è´\n\næ·è´å¯¹è±¡ååå§å¯¹è±¡çå¼ç¨ç±»åå¼ç¨åä¸ä¸ªå¯¹è±¡ã\n\npublic class shallowcloneexample implements cloneable {\n\n    private int[] arr;\n\n    public shallowcloneexample() {\n        arr = new int[10];\n        for (int i = 0; i < arr.length; i++) {\n            arr[i] = i;\n        }\n    }\n\n    public void set(int index, int value) {\n        arr[index] = value;\n    }\n\n    public int get(int index) {\n        return arr[index];\n    }\n\n    @override\n    protected shallowcloneexample clone() throws clonenotsupportedexception {\n        return (shallowcloneexample) super.clone();\n    }\n}\nshallowcloneexample e1 = new shallowcloneexample();\nshallowcloneexample e2 = null;\ntry {\n    e2 = e1.clone();\n} catch (clonenotsupportedexception e) {\n    e.printstacktrace();\n}\ne1.set(2, 222);\nsystem.out.println(e2.get(2)); // 222\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n\n\n3. æ·±æ·è´\n\næ·è´å¯¹è±¡ååå§å¯¹è±¡çå¼ç¨ç±»åå¼ç¨ä¸åå¯¹è±¡ã\n\npublic class deepcloneexample implements cloneable {\n\n    private int[] arr;\n\n    public deepcloneexample() {\n        arr = new int[10];\n        for (int i = 0; i < arr.length; i++) {\n            arr[i] = i;\n        }\n    }\n\n    public void set(int index, int value) {\n        arr[index] = value;\n    }\n\n    public int get(int index) {\n        return arr[index];\n    }\n\n    @override\n    protected deepcloneexample clone() throws clonenotsupportedexception {\n        deepcloneexample result = (deepcloneexample) super.clone();\n        result.arr = new int[arr.length];\n        for (int i = 0; i < arr.length; i++) {\n            result.arr[i] = arr[i];\n        }\n        return result;\n    }\n}\ndeepcloneexample e1 = new deepcloneexample();\ndeepcloneexample e2 = null;\ntry {\n    e2 = e1.clone();\n} catch (clonenotsupportedexception e) {\n    e.printstacktrace();\n}\ne1.set(2, 222);\nsystem.out.println(e2.get(2)); // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n\n\n4. clone() çæ¿ä»£æ¹æ¡\n\nä½¿ç¨ clone() æ¹æ³æ¥æ·è´ä¸ä¸ªå¯¹è±¡å³å¤æåæé£é©ï¼å®ä¼æåºå¼å¸¸ï¼å¹¶ä¸è¿éè¦ç±»åè½¬æ¢ãeffective java ä¹¦ä¸è®²å°ï¼æå¥½ä¸è¦å»ä½¿ç¨ clone()ï¼å¯ä»¥ä½¿ç¨æ·è´æé å½æ°æèæ·è´å·¥åæ¥æ·è´ä¸ä¸ªå¯¹è±¡ã\n\npublic class cloneconstructorexample {\n\n    private int[] arr;\n\n    public cloneconstructorexample() {\n        arr = new int[10];\n        for (int i = 0; i < arr.length; i++) {\n            arr[i] = i;\n        }\n    }\n\n    public cloneconstructorexample(cloneconstructorexample original) {\n        arr = new int[original.arr.length];\n        for (int i = 0; i < original.arr.length; i++) {\n            arr[i] = original.arr[i];\n        }\n    }\n\n    public void set(int index, int value) {\n        arr[index] = value;\n    }\n\n    public int get(int index) {\n        return arr[index];\n    }\n}\ncloneconstructorexample e1 = new cloneconstructorexample();\ncloneconstructorexample e2 = new cloneconstructorexample(e1);\ne1.set(2, 222);\nsystem.out.println(e2.get(2)); // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\n\n# å­ãç»§æ¿\n\n\n# è®¿é®æé\n\njava ä¸­æä¸ä¸ªè®¿é®æéä¿®é¥°ç¬¦ï¼privateãprotected ä»¥å publicï¼å¦æä¸å è®¿é®ä¿®é¥°ç¬¦ï¼è¡¨ç¤ºåçº§å¯è§ã\n\nå¯ä»¥å¯¹ç±»æç±»ä¸­çæåï¼å­æ®µåæ¹æ³ï¼å ä¸è®¿é®ä¿®é¥°ç¬¦ã\n\n * ç±»å¯è§è¡¨ç¤ºå¶å®ç±»å¯ä»¥ç¨è¿ä¸ªç±»åå»ºå®ä¾å¯¹è±¡ã\n * æåå¯è§è¡¨ç¤ºå¶å®ç±»å¯ä»¥ç¨è¿ä¸ªç±»çå®ä¾å¯¹è±¡è®¿é®å°è¯¥æåï¼\n\nprotected ç¨äºä¿®é¥°æåï¼è¡¨ç¤ºå¨ç»§æ¿ä½ç³»ä¸­æåå¯¹äºå­ç±»å¯è§ï¼ä½æ¯è¿ä¸ªè®¿é®ä¿®é¥°ç¬¦å¯¹äºç±»æ²¡ææä¹ã\n\nè®¾è®¡è¯å¥½çæ¨¡åä¼éèææçå®ç°ç»èï¼æå®ç api ä¸å®çå®ç°æ¸æ°å°éç¦»å¼æ¥ãæ¨¡åä¹é´åªéè¿å®ä»¬ç api è¿è¡éä¿¡ï¼ä¸ä¸ªæ¨¡åä¸éè¦ç¥éå¶ä»æ¨¡åçåé¨å·¥ä½æåµï¼è¿ä¸ªæ¦å¿µè¢«ç§°ä¸ºä¿¡æ¯éèæå°è£ãå æ­¤è®¿é®æéåºå½å°½å¯è½å°ä½¿æ¯ä¸ªç±»æèæåä¸è¢«å¤çè®¿é®ã\n\nå¦æå­ç±»çæ¹æ³éåäºç¶ç±»çæ¹æ³ï¼é£ä¹å­ç±»ä¸­è¯¥æ¹æ³çè®¿é®çº§å«ä¸åè®¸ä½äºç¶ç±»çè®¿é®çº§å«ãè¿æ¯ä¸ºäºç¡®ä¿å¯ä»¥ä½¿ç¨ç¶ç±»å®ä¾çå°æ¹é½å¯ä»¥ä½¿ç¨å­ç±»å®ä¾å»ä»£æ¿ï¼ä¹å°±æ¯ç¡®ä¿æ»¡è¶³éæ°æ¿æ¢ååã\n\nå­æ®µå³ä¸è½æ¯å¬æçï¼å ä¸ºè¿ä¹åçè¯å°±å¤±å»äºå¯¹è¿ä¸ªå­æ®µä¿®æ¹è¡ä¸ºçæ§å¶ï¼å®¢æ·ç«¯å¯ä»¥å¯¹å¶éæä¿®æ¹ãä¾å¦ä¸é¢çä¾å­ä¸­ï¼accessexample æ¥æ id å¬æå­æ®µï¼å¦æå¨æä¸ªæ¶å»ï¼æä»¬æ³è¦ä½¿ç¨ int å­å¨ id å­æ®µï¼é£ä¹å°±éè¦ä¿®æ¹ææçå®¢æ·ç«¯ä»£ç ã\n\npublic class accessexample {\n    public string id;\n}\n\n\n1\n2\n3\n\n\nå¯ä»¥ä½¿ç¨å¬æç getter å setter æ¹æ³æ¥æ¿æ¢å¬æå­æ®µï¼è¿æ ·çè¯å°±å¯ä»¥æ§å¶å¯¹å­æ®µçä¿®æ¹è¡ä¸ºã\n\npublic class accessexample {\n\n    private int id;\n\n    public string getid() {\n        return id + "";\n    }\n\n    public void setid(string id) {\n        this.id = integer.valueof(id);\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä½æ¯ä¹æä¾å¤ï¼å¦ææ¯åçº§ç§æçç±»æèç§æçåµå¥ç±»ï¼é£ä¹ç´æ¥æ´é²æåä¸ä¼æç¹å«å¤§çå½±åã\n\npublic class accesswithinnerclassexample {\n\n    private class innerclass {\n        int x;\n    }\n\n    private innerclass innerclass;\n\n    public accesswithinnerclassexample() {\n        innerclass = new innerclass();\n    }\n\n    public int getvalue() {\n        return innerclass.x;  // ç´æ¥è®¿é®\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n# æ½è±¡ç±»ä¸æ¥å£\n\n1. æ½è±¡ç±»\n\næ½è±¡ç±»åæ½è±¡æ¹æ³é½ä½¿ç¨ abstract å³é®å­è¿è¡å£°æãå¦æä¸ä¸ªç±»ä¸­åå«æ½è±¡æ¹æ³ï¼é£ä¹è¿ä¸ªç±»å¿é¡»å£°æä¸ºæ½è±¡ç±»ã\n\næ½è±¡ç±»åæ®éç±»æå¤§çåºå«æ¯ï¼æ½è±¡ç±»ä¸è½è¢«å®ä¾åï¼åªè½è¢«ç»§æ¿ã\n\npublic abstract class abstractclassexample {\n\n    protected int x;\n    private int y;\n\n    public abstract void func1();\n\n    public void func2() {\n        system.out.println("func2");\n    }\n}\npublic class abstractextendclassexample extends abstractclassexample {\n    @override\n    public void func1() {\n        system.out.println("func1");\n    }\n}\n// abstractclassexample ac1 = new abstractclassexample(); // \'abstractclassexample\' is abstract; cannot be instantiated\nabstractclassexample ac2 = new abstractextendclassexample();\nac2.func1();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n2. æ¥å£\n\næ¥å£æ¯æ½è±¡ç±»çå»¶ä¼¸ï¼å¨ java 8 ä¹åï¼å®å¯ä»¥çææ¯ä¸ä¸ªå®å¨æ½è±¡çç±»ï¼ä¹å°±æ¯è¯´å®ä¸è½æä»»ä½çæ¹æ³å®ç°ã\n\nä» java 8 å¼å§ï¼æ¥å£ä¹å¯ä»¥æ¥æé»è®¤çæ¹æ³å®ç°ï¼è¿æ¯å ä¸ºä¸æ¯æé»è®¤æ¹æ³çæ¥å£çç»´æ¤ææ¬å¤ªé«äºãå¨ java 8 ä¹åï¼å¦æä¸ä¸ªæ¥å£æ³è¦æ·»å æ°çæ¹æ³ï¼é£ä¹è¦ä¿®æ¹ææå®ç°äºè¯¥æ¥å£çç±»ï¼è®©å®ä»¬é½å®ç°æ°å¢çæ¹æ³ã\n\næ¥å£çæåï¼å­æ®µ + æ¹æ³ï¼é»è®¤é½æ¯ public çï¼å¹¶ä¸ä¸åè®¸å®ä¹ä¸º private æè protectedãä» java 9 å¼å§ï¼åè®¸å°æ¹æ³å®ä¹ä¸º privateï¼è¿æ ·å°±è½å®ä¹æäºå¤ç¨çä»£ç åä¸ä¼ææ¹æ³æ´é²åºå»ã\n\næ¥å£çå­æ®µé»è®¤é½æ¯ static å final çã\n\npublic interface interfaceexample {\n\n    void func1();\n\n    default void func2(){\n        system.out.println("func2");\n    }\n\n    int x = 123;\n    // int y;               // variable \'y\' might not have been initialized\n    public int z = 0;       // modifier \'public\' is redundant for interface fields\n    // private int k = 0;   // modifier \'private\' not allowed here\n    // protected int l = 0; // modifier \'protected\' not allowed here\n    // private void fun3(); // modifier \'private\' not allowed here\n}\npublic class interfaceimplementexample implements interfaceexample {\n    @override\n    public void func1() {\n        system.out.println("func1");\n    }\n}\n// interfaceexample ie1 = new interfaceexample(); // \'interfaceexample\' is abstract; cannot be instantiated\ninterfaceexample ie2 = new interfaceimplementexample();\nie2.func1();\nsystem.out.println(interfaceexample.x);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\n3. æ¯è¾\n\n * ä»è®¾è®¡å±é¢ä¸çï¼æ½è±¡ç±»æä¾äºä¸ç§ is-a å³ç³»ï¼éè¦æ»¡è¶³éå¼æ¿æ¢ååï¼å³å­ç±»å¯¹è±¡å¿é¡»è½å¤æ¿æ¢æææç¶ç±»å¯¹è±¡ãèæ¥å£æ´åæ¯ä¸ç§ like-a å³ç³»ï¼å®åªæ¯æä¾ä¸ç§æ¹æ³å®ç°å¥çº¦ï¼å¹¶ä¸è¦æ±æ¥å£åå®ç°æ¥å£çç±»å·æ is-a å³ç³»ã\n * ä»ä½¿ç¨ä¸æ¥çï¼ä¸ä¸ªç±»å¯ä»¥å®ç°å¤ä¸ªæ¥å£ï¼ä½æ¯ä¸è½ç»§æ¿å¤ä¸ªæ½è±¡ç±»ã\n * æ¥å£çå­æ®µåªè½æ¯ static å final ç±»åçï¼èæ½è±¡ç±»çå­æ®µæ²¡æè¿ç§éå¶ã\n * æ¥å£çæååªè½æ¯ public çï¼èæ½è±¡ç±»çæåå¯ä»¥æå¤ç§è®¿é®æéã\n\n4. ä½¿ç¨éæ©\n\nä½¿ç¨æ¥å£ï¼\n\n * éè¦è®©ä¸ç¸å³çç±»é½å®ç°ä¸ä¸ªæ¹æ³ï¼ä¾å¦ä¸ç¸å³çç±»é½å¯ä»¥å®ç° comparable æ¥å£ä¸­ç compareto() æ¹æ³ï¼\n * éè¦ä½¿ç¨å¤éç»§æ¿ã\n\nä½¿ç¨æ½è±¡ç±»ï¼\n\n * éè¦å¨å ä¸ªç¸å³çç±»ä¸­å±äº«ä»£ç ã\n * éè¦è½æ§å¶ç»§æ¿æ¥çæåçè®¿é®æéï¼èä¸æ¯é½ä¸º publicã\n * éè¦ç»§æ¿ééæåéå¸¸éå­æ®µã\n\nå¨å¾å¤æåµä¸ï¼æ¥å£ä¼åäºæ½è±¡ç±»ãå ä¸ºæ¥å£æ²¡ææ½è±¡ç±»ä¸¥æ ¼çç±»å±æ¬¡ç»æè¦æ±ï¼å¯ä»¥çµæ´»å°ä¸ºä¸ä¸ªç±»æ·»å è¡ä¸ºãå¹¶ä¸ä» java 8 å¼å§ï¼æ¥å£ä¹å¯ä»¥æé»è®¤çæ¹æ³å®ç°ï¼ä½¿å¾ä¿®æ¹æ¥å£çææ¬ä¹åçå¾ä½ã\n\n * abstract methods and classes(opens new window)\n * æ·±å¥çè§£ abstract class å interface(opens new window)\n * when to use abstract class and interface(opens new window)\n * java 9 private methods in interfaces(opens new window)\n\n\n# super\n\n * è®¿é®ç¶ç±»çæé å½æ°ï¼å¯ä»¥ä½¿ç¨ super() å½æ°è®¿é®ç¶ç±»çæé å½æ°ï¼ä»èå§æç¶ç±»å®æä¸äºåå§åçå·¥ä½ãåºè¯¥æ³¨æå°ï¼å­ç±»ä¸å®ä¼è°ç¨ç¶ç±»çæé å½æ°æ¥å®æåå§åå·¥ä½ï¼ä¸è¬æ¯è°ç¨ç¶ç±»çé»è®¤æé å½æ°ï¼å¦æå­ç±»éè¦è°ç¨ç¶ç±»å¶å®æé å½æ°ï¼é£ä¹å°±å¯ä»¥ä½¿ç¨ super() å½æ°ã\n * è®¿é®ç¶ç±»çæåï¼å¦æå­ç±»éåäºç¶ç±»çæä¸ªæ¹æ³ï¼å¯ä»¥éè¿ä½¿ç¨ super å³é®å­æ¥å¼ç¨ç¶ç±»çæ¹æ³å®ç°ã\n\npublic class superexample {\n\n    protected int x;\n    protected int y;\n\n    public superexample(int x, int y) {\n        this.x = x;\n        this.y = y;\n    }\n\n    public void func() {\n        system.out.println("superexample.func()");\n    }\n}\npublic class superextendexample extends superexample {\n\n    private int z;\n\n    public superextendexample(int x, int y, int z) {\n        super(x, y);\n        this.z = z;\n    }\n\n    @override\n    public void func() {\n        super.func();\n        system.out.println("superextendexample.func()");\n    }\n}\nsuperexample e = new superextendexample(1, 2, 3);\ne.func();\nsuperexample.func()\nsuperextendexample.func()\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n\n\nusing the keyword super(opens new window)\n\n\n# éåä¸éè½½\n\n1. éåï¼overrideï¼\n\nå­å¨äºç»§æ¿ä½ç³»ä¸­ï¼æå­ç±»å®ç°äºä¸ä¸ªä¸ç¶ç±»å¨æ¹æ³å£°æä¸å®å¨ç¸åçä¸ä¸ªæ¹æ³ã\n\nä¸ºäºæ»¡è¶³éå¼æ¿æ¢ååï¼éåæä»¥ä¸ä¸ä¸ªéå¶ï¼\n\n * å­ç±»æ¹æ³çè®¿é®æéå¿é¡»å¤§äºç­äºç¶ç±»æ¹æ³ï¼\n * å­ç±»æ¹æ³çè¿åç±»åå¿é¡»æ¯ç¶ç±»æ¹æ³è¿åç±»åæä¸ºå¶å­ç±»åã\n * å­ç±»æ¹æ³æåºçå¼å¸¸ç±»åå¿é¡»æ¯ç¶ç±»æåºå¼å¸¸ç±»åæä¸ºå¶å­ç±»åã\n\nä½¿ç¨ @override æ³¨è§£ï¼å¯ä»¥è®©ç¼è¯å¨å¸®å¿æ£æ¥æ¯å¦æ»¡è¶³ä¸é¢çä¸ä¸ªéå¶æ¡ä»¶ã\n\nä¸é¢çç¤ºä¾ä¸­ï¼subclass ä¸º superclass çå­ç±»ï¼subclass éåäº superclass ç func() æ¹æ³ãå¶ä¸­ï¼\n\n * å­ç±»æ¹æ³è®¿é®æéä¸º publicï¼å¤§äºç¶ç±»ç protectedã\n * å­ç±»çè¿åç±»åä¸º arraylist<integer>ï¼æ¯ç¶ç±»è¿åç±»å list<integer> çå­ç±»ã\n * å­ç±»æåºçå¼å¸¸ç±»åä¸º exceptionï¼æ¯ç¶ç±»æåºå¼å¸¸ throwable çå­ç±»ã\n * å­ç±»éåæ¹æ³ä½¿ç¨ @override æ³¨è§£ï¼ä»èè®©ç¼è¯å¨èªå¨æ£æ¥æ¯å¦æ»¡è¶³éå¶æ¡ä»¶ã\n\nclass superclass {\n    protected list<integer> func() throws throwable {\n        return new arraylist<>();\n    }\n}\n\nclass subclass extends superclass {\n    @override\n    public arraylist<integer> func() throws exception {\n        return new arraylist<>();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå¨è°ç¨ä¸ä¸ªæ¹æ³æ¶ï¼åä»æ¬ç±»ä¸­æ¥æ¾çæ¯å¦æå¯¹åºçæ¹æ³ï¼å¦ææ²¡æåå°ç¶ç±»ä¸­æ¥çï¼çæ¯å¦ä»ç¶ç±»ç»§æ¿æ¥ãå¦åå°±è¦å¯¹åæ°è¿è¡è½¬åï¼è½¬æç¶ç±»ä¹åçæ¯å¦æå¯¹åºçæ¹æ³ãæ»çæ¥è¯´ï¼æ¹æ³è°ç¨çä¼åçº§ä¸ºï¼\n\n * this.func(this)\n * super.func(this)\n * this.func(super)\n * super.func(super)\n\n/*\n    a\n    |\n    b\n    |\n    c\n    |\n    d\n */\n\n\nclass a {\n\n    public void show(a obj) {\n        system.out.println("a.show(a)");\n    }\n\n    public void show(c obj) {\n        system.out.println("a.show(c)");\n    }\n}\n\nclass b extends a {\n\n    @override\n    public void show(a obj) {\n        system.out.println("b.show(a)");\n    }\n}\n\nclass c extends b {\n}\n\nclass d extends c {\n}\npublic static void main(string[] args) {\n\n    a a = new a();\n    b b = new b();\n    c c = new c();\n    d d = new d();\n\n    // å¨ a ä¸­å­å¨ show(a obj)ï¼ç´æ¥è°ç¨\n    a.show(a); // a.show(a)\n    // å¨ a ä¸­ä¸å­å¨ show(b obj)ï¼å° b è½¬åæå¶ç¶ç±» a\n    a.show(b); // a.show(a)\n    // å¨ b ä¸­å­å¨ä» a ç»§æ¿æ¥ç show(c obj)ï¼ç´æ¥è°ç¨\n    b.show(c); // a.show(c)\n    // å¨ b ä¸­ä¸å­å¨ show(d obj)ï¼ä½æ¯å­å¨ä» a ç»§æ¿æ¥ç show(c obj)ï¼å° d è½¬åæå¶ç¶ç±» c\n    b.show(d); // a.show(c)\n\n    // å¼ç¨çè¿æ¯ b å¯¹è±¡ï¼æä»¥ ba å b çè°ç¨ç»æä¸æ ·\n    a ba = new b();\n    ba.show(c); // a.show(c)\n    ba.show(d); // a.show(c)\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n\n\n2. éè½½ï¼overloadï¼\n\nå­å¨äºåä¸ä¸ªç±»ä¸­ï¼æä¸ä¸ªæ¹æ³ä¸å·²ç»å­å¨çæ¹æ³åç§°ä¸ç¸åï¼ä½æ¯åæ°ç±»åãä¸ªæ°ãé¡ºåºè³å°æä¸ä¸ªä¸åã\n\nåºè¯¥æ³¨æçæ¯ï¼è¿åå¼ä¸åï¼å¶å®é½ç¸åä¸ç®æ¯éè½½ã\n\nclass overloadingexample {\n    public void show(int x) {\n        system.out.println(x);\n    }\n\n    public void show(int x, string y) {\n        system.out.println(x + " " + y);\n    }\n}\npublic static void main(string[] args) {\n    overloadingexample example = new overloadingexample();\n    example.show(1);\n    example.show(1, "2");\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# ä¸ãåå°\n\næ¯ä¸ªç±»é½æä¸ä¸ª class å¯¹è±¡ï¼åå«äºä¸ç±»æå³çä¿¡æ¯ãå½ç¼è¯ä¸ä¸ªæ°ç±»æ¶ï¼ä¼äº§çä¸ä¸ªååç .class æä»¶ï¼è¯¥æä»¶åå®¹ä¿å­ç class å¯¹è±¡ã\n\nç±»å è½½ç¸å½äº class å¯¹è±¡çå è½½ï¼ç±»å¨ç¬¬ä¸æ¬¡ä½¿ç¨æ¶æå¨æå è½½å° jvm ä¸­ãä¹å¯ä»¥ä½¿ç¨ class.forname("com.mysql.jdbc.driver") è¿ç§æ¹å¼æ¥æ§å¶ç±»çå è½½ï¼è¯¥æ¹æ³ä¼è¿åä¸ä¸ª class å¯¹è±¡ã\n\nåå°å¯ä»¥æä¾è¿è¡æ¶çç±»ä¿¡æ¯ï¼å¹¶ä¸è¿ä¸ªç±»å¯ä»¥å¨è¿è¡æ¶æå è½½è¿æ¥ï¼çè³å¨ç¼è¯æ¶æè¯¥ç±»ç .class ä¸å­å¨ä¹å¯ä»¥å è½½è¿æ¥ã\n\nclass å java.lang.reflect ä¸èµ·å¯¹åå°æä¾äºæ¯æï¼java.lang.reflect ç±»åºä¸»è¦åå«äºä»¥ä¸ä¸ä¸ªç±»ï¼\n\n * field ï¼å¯ä»¥ä½¿ç¨ get() å set() æ¹æ³è¯»ååä¿®æ¹ field å¯¹è±¡å³èçå­æ®µï¼\n * method ï¼å¯ä»¥ä½¿ç¨ invoke() æ¹æ³è°ç¨ä¸ method å¯¹è±¡å³èçæ¹æ³ï¼\n * constructor ï¼å¯ä»¥ç¨ constructor ç newinstance() åå»ºæ°çå¯¹è±¡ã\n\nåå°çä¼ç¹ï¼\n\n * å¯æ©å±æ§ ï¼åºç¨ç¨åºå¯ä»¥å©ç¨å¨éå®ååå»ºå¯æ©å±å¯¹è±¡çå®ä¾ï¼æ¥ä½¿ç¨æ¥èªå¤é¨çç¨æ·èªå®ä¹ç±»ã\n * ç±»æµè§å¨åå¯è§åå¼åç¯å¢ ï¼ä¸ä¸ªç±»æµè§å¨éè¦å¯ä»¥æä¸¾ç±»çæåãå¯è§åå¼åç¯å¢ï¼å¦ ideï¼å¯ä»¥ä»å©ç¨åå°ä¸­å¯ç¨çç±»åä¿¡æ¯ä¸­åçï¼ä»¥å¸®å©ç¨åºåç¼åæ­£ç¡®çä»£ç ã\n * è°è¯å¨åæµè¯å·¥å· ï¼ è°è¯å¨éè¦è½å¤æ£æ¥ä¸ä¸ªç±»éçç§ææåãæµè¯å·¥å·å¯ä»¥å©ç¨åå°æ¥èªå¨å°è°ç¨ç±»éå®ä¹çå¯è¢«åç°ç api å®ä¹ï¼ä»¥ç¡®ä¿ä¸ç»æµè¯ä¸­æè¾é«çä»£ç è¦ççã\n\nåå°çç¼ºç¹ï¼\n\nå°½ç®¡åå°éå¸¸å¼ºå¤§ï¼ä½ä¹ä¸è½æ»¥ç¨ãå¦æä¸ä¸ªåè½å¯ä»¥ä¸ç¨åå°å®æï¼é£ä¹æå¥½å°±ä¸ç¨ãå¨æä»¬ä½¿ç¨åå°ææ¯æ¶ï¼ä¸é¢å æ¡åå®¹åºè¯¥ç¢è®°äºå¿ã\n\n * æ§è½å¼é ï¼åå°æ¶åäºå¨æç±»åçè§£æï¼æä»¥ jvm æ æ³å¯¹è¿äºä»£ç è¿è¡ä¼åãå æ­¤ï¼åå°æä½çæçè¦æ¯é£äºéåå°æä½ä½å¾å¤ãæä»¬åºè¯¥é¿åå¨ç»å¸¸è¢«æ§è¡çä»£ç æå¯¹æ§è½è¦æ±å¾é«çç¨åºä¸­ä½¿ç¨åå°ã\n * å®å¨éå¶ ï¼ä½¿ç¨åå°ææ¯è¦æ±ç¨åºå¿é¡»å¨ä¸ä¸ªæ²¡æå®å¨éå¶çç¯å¢ä¸­è¿è¡ãå¦æä¸ä¸ªç¨åºå¿é¡»å¨æå®å¨éå¶çç¯å¢ä¸­è¿è¡ï¼å¦ appletï¼é£ä¹è¿å°±æ¯ä¸ªé®é¢äºã\n * åé¨æ´é² ï¼ç±äºåå°åè®¸ä»£ç æ§è¡ä¸äºå¨æ­£å¸¸æåµä¸ä¸è¢«åè®¸çæä½ï¼æ¯å¦è®¿é®ç§æçå±æ§åæ¹æ³ï¼ï¼æä»¥ä½¿ç¨åå°å¯è½ä¼å¯¼è´ææä¹å¤çå¯ä½ç¨ï¼è¿å¯è½å¯¼è´ä»£ç åè½å¤±è°å¹¶ç ´åå¯ç§»æ¤æ§ãåå°ä»£ç ç ´åäºæ½è±¡æ§ï¼å æ­¤å½å¹³å°åçæ¹åçæ¶åï¼ä»£ç çè¡ä¸ºå°±æå¯è½ä¹éçååã\n * trail: the reflection api(opens new window)\n * æ·±å¥è§£æ java åå°ï¼1ï¼- åºç¡(opens new window)\n\n\n# å«ãå¼å¸¸\n\nthrowable å¯ä»¥ç¨æ¥è¡¨ç¤ºä»»ä½å¯ä»¥ä½ä¸ºå¼å¸¸æåºçç±»ï¼åä¸ºä¸¤ç§ï¼ error å exceptionãå¶ä¸­ error ç¨æ¥è¡¨ç¤º jvm æ æ³å¤ççéè¯¯ï¼exception åä¸ºä¸¤ç§ï¼\n\n * åæ£å¼å¸¸ ï¼éè¦ç¨ try...catch... è¯­å¥æè·å¹¶è¿è¡å¤çï¼å¹¶ä¸å¯ä»¥ä»å¼å¸¸ä¸­æ¢å¤ï¼\n * éåæ£å¼å¸¸ ï¼æ¯ç¨åºè¿è¡æ¶éè¯¯ï¼ä¾å¦é¤ 0 ä¼å¼å arithmetic exceptionï¼æ­¤æ¶ç¨åºå´©æºå¹¶ä¸æ æ³æ¢å¤ã\n\n\n\n * java exception interview questions and answers(opens new window)\n * javaæé«ç¯ââjava å¼å¸¸å¤ç(opens new window)\n\n\n# ä¹ãæ³å\n\npublic class box<t> {\n    // t stands for "type"\n    private t t;\n    public void set(t t) { this.t = t; }\n    public t get() { return t; }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n * java æ³åè¯¦è§£(opens new window)\n * 10 é java æ³åé¢è¯é¢(opens new window)\n\n\n# åãæ³¨è§£\n\njava æ³¨è§£æ¯éå å¨ä»£ç ä¸­çä¸äºåä¿¡æ¯ï¼ç¨äºä¸äºå·¥å·å¨ç¼è¯ãè¿è¡æ¶è¿è¡è§£æåä½¿ç¨ï¼èµ·å°è¯´æãéç½®çåè½ãæ³¨è§£ä¸ä¼ä¹ä¸è½å½±åä»£ç çå®éé»è¾ï¼ä»ä»èµ·å°è¾å©æ§çä½ç¨ã\n\næ³¨è§£ annotation å®ç°åçä¸èªå®ä¹æ³¨è§£ä¾å­(opens new window)\n\n\n# åä¸ãç¹æ§\n\n\n# java åçæ¬çæ°ç¹æ§\n\nnew highlights in java se 8\n\n 1. lambda expressions\n 2. pipelines and streams\n 3. date and time api\n 4. default methods\n 5. type annotations\n 6. nashhorn javascript engine\n 7. concurrent accumulators\n 8. parallel operations\n 9. permgen error removed\n\nnew highlights in java se 7\n\n 1. strings in switch statement\n 2. type inference for generic instance creation\n 3. multiple exception handling\n 4. support for dynamic languages\n 5. try with resources\n 6. java nio package\n 7. binary literals, underscore in literals\n 8. diamond syntax\n\n * difference between java 1.8 and java 1.7?(opens new window)\n * java 8 ç¹æ§(opens new window)\n\n\n# java ä¸ c++ çåºå«\n\n * java æ¯çº¯ç²¹çé¢åå¯¹è±¡è¯­è¨ï¼ææçå¯¹è±¡é½ç»§æ¿èª java.lang.objectï¼c++ ä¸ºäºå¼å®¹ c å³æ¯æé¢åå¯¹è±¡ä¹æ¯æé¢åè¿ç¨ã\n * java éè¿èææºä»èå®ç°è·¨å¹³å°ç¹æ§ï¼ä½æ¯ c++ ä¾èµäºç¹å®çå¹³å°ã\n * java æ²¡ææéï¼å®çå¼ç¨å¯ä»¥çè§£ä¸ºå®å¨æéï¼è c++ å·æå c ä¸æ ·çæéã\n * java æ¯æèªå¨åå¾åæ¶ï¼è c++ éè¦æå¨åæ¶ã\n * java ä¸æ¯æå¤éç»§æ¿ï¼åªè½éè¿å®ç°å¤ä¸ªæ¥å£æ¥è¾¾å°ç¸åç®çï¼è c++ æ¯æå¤éç»§æ¿ã\n * java ä¸æ¯ææä½ç¬¦éè½½ï¼è½ç¶å¯ä»¥å¯¹ä¸¤ä¸ª string å¯¹è±¡æ§è¡å æ³è¿ç®ï¼ä½æ¯è¿æ¯è¯­è¨åç½®æ¯æçæä½ï¼ä¸å±äºæä½ç¬¦éè½½ï¼è c++ å¯ä»¥ã\n * java ç goto æ¯ä¿çå­ï¼ä½æ¯ä¸å¯ç¨ï¼c++ å¯ä»¥ä½¿ç¨ gotoã\n\nwhat are the main differences between java and c++?(opens new window)\n\n\n# jre or jdk\n\n * jreï¼java runtime environmentï¼java è¿è¡ç¯å¢çç®ç§°ï¼ä¸º java çè¿è¡æä¾äºæéçç¯å¢ãå®æ¯ä¸ä¸ª jvm ç¨åºï¼ä¸»è¦åæ¬äº jvm çæ åå®ç°åä¸äº java åºæ¬ç±»åºã\n * jdkï¼java development kitï¼java å¼åå·¥å·åï¼æä¾äº java çå¼ååè¿è¡ç¯å¢ãjdk æ¯ java å¼åçæ ¸å¿ï¼éæäº jre ä»¥åä¸äºå¶å®çå·¥å·ï¼æ¯å¦ç¼è¯ java æºç çç¼è¯å¨ javac ç­ã\n\n\n# åèèµæ\n\n * eckel b. java ç¼ç¨ææ³[m]. æºæ¢°å·¥ä¸åºçç¤¾, 2002.\n * bloch j. effective java[m]. addison-wesley professional, 2017.\n\n',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Java å®¹å¨",frontmatter:{title:"Java å®¹å¨",date:"2022-02-03T19:02:23.000Z",permalink:"/pages/17acab/",categories:["é¢è¯","Java","Javaåºç¡"],tags:[null]},regularPath:"/35.%E9%9D%A2%E8%AF%95/05.Java/05.Java%E5%9F%BA%E7%A1%80/10.Java%20%E5%AE%B9%E5%99%A8.html",relativePath:"35.é¢è¯/05.Java/05.Javaåºç¡/10.Java å®¹å¨.md",key:"v-18cea7e8",path:"/pages/17acab/",headers:[{level:2,title:"Collection",slug:"collection",normalizedTitle:"collection",charIndex:15},{level:2,title:"1. Set",slug:"_1-set",normalizedTitle:"1. set",charIndex:100},{level:2,title:"2. List",slug:"_2-list",normalizedTitle:"2. list",charIndex:352},{level:2,title:"3. Queue",slug:"_3-queue",normalizedTitle:"3. queue",charIndex:505},{level:2,title:"Map",slug:"map",normalizedTitle:"map",charIndex:28},{level:2,title:"è¿­ä»£å¨æ¨¡å¼",slug:"è¿­ä»£å¨æ¨¡å¼",normalizedTitle:"è¿­ä»£å¨æ¨¡å¼",charIndex:884},{level:2,title:"ééå¨æ¨¡å¼",slug:"ééå¨æ¨¡å¼",normalizedTitle:"ééå¨æ¨¡å¼",charIndex:1188},{level:2,title:"ArrayList",slug:"arraylist",normalizedTitle:"arraylist",charIndex:361},{level:3,title:"1. æ¦è§",slug:"_1-æ¦è§",normalizedTitle:"1. æ¦è§",charIndex:1615},{level:3,title:"2. æ©å®¹",slug:"_2-æ©å®¹",normalizedTitle:"2. æ©å®¹",charIndex:1891},{level:3,title:"3. å é¤åç´ ",slug:"_3-å é¤åç´ ",normalizedTitle:"3. å é¤åç´ ",charIndex:3323},{level:3,title:"4. Fail-Fast",slug:"_4-fail-fast",normalizedTitle:"4. fail-fast",charIndex:3788},{level:3,title:"5. åºåå",slug:"_5-åºåå",normalizedTitle:"5. åºåå",charIndex:4664},{level:2,title:"Vector",slug:"vector",normalizedTitle:"vector",charIndex:389},{level:3,title:"1. åæ­¥",slug:"_1-åæ­¥",normalizedTitle:"1. åæ­¥",charIndex:6446},{level:3,title:"2. ä¸ ArrayList çæ¯è¾",slug:"_2-ä¸-arraylist-çæ¯è¾",normalizedTitle:"2. ä¸ arraylist çæ¯è¾",charIndex:6852},{level:3,title:"3. æ¿ä»£æ¹æ¡",slug:"_3-æ¿ä»£æ¹æ¡",normalizedTitle:"3. æ¿ä»£æ¹æ¡",charIndex:7007},{level:2,title:"CopyOnWriteArrayList",slug:"copyonwritearraylist",normalizedTitle:"copyonwritearraylist",charIndex:7201},{level:3,title:"è¯»ååç¦»",slug:"è¯»ååç¦»",normalizedTitle:"è¯»ååç¦»",charIndex:7310},{level:3,title:"éç¨åºæ¯",slug:"éç¨åºæ¯",normalizedTitle:"éç¨åºæ¯",charIndex:8083},{level:2,title:"LinkedList",slug:"linkedlist",normalizedTitle:"linkedlist",charIndex:422},{level:3,title:"1. æ¦è§",slug:"_1-æ¦è§-2",normalizedTitle:"1. æ¦è§",charIndex:1615},{level:3,title:"2. ä¸ ArrayList çæ¯è¾",slug:"_2-ä¸-arraylist-çæ¯è¾-2",normalizedTitle:"2. ä¸ arraylist çæ¯è¾",charIndex:6852},{level:2,title:"HashMap",slug:"hashmap",normalizedTitle:"hashmap",charIndex:610},{level:3,title:"1. å­å¨ç»æ",slug:"_1-å­å¨ç»æ",normalizedTitle:"1. å­å¨ç»æ",charIndex:8707},{level:3,title:"2. æé¾æ³çå·¥ä½åç",slug:"_2-æé¾æ³çå·¥ä½åç",normalizedTitle:"2. æé¾æ³çå·¥ä½åç",charIndex:10208},{level:3,title:"3. put æä½",slug:"_3-put-æä½",normalizedTitle:"3. put æä½",charIndex:10711},{level:3,title:"4. ç¡®å®æ¡¶ä¸æ ",slug:"_4-ç¡®å®æ¡¶ä¸æ ",normalizedTitle:"4. ç¡®å®æ¡¶ä¸æ ",charIndex:12654},{level:3,title:"5. æ©å®¹-åºæ¬åç",slug:"_5-æ©å®¹-åºæ¬åç",normalizedTitle:"5. æ©å®¹-åºæ¬åç",charIndex:13852},{level:3,title:"6. æ©å®¹-éæ°è®¡ç®æ¡¶ä¸æ ",slug:"_6-æ©å®¹-éæ°è®¡ç®æ¡¶ä¸æ ",normalizedTitle:"6. æ©å®¹-éæ°è®¡ç®æ¡¶ä¸æ ",charIndex:16052},{level:3,title:"7. è®¡ç®æ°ç»å®¹é",slug:"_7-è®¡ç®æ°ç»å®¹é",normalizedTitle:"7. è®¡ç®æ°ç»å®¹é",charIndex:16306},{level:3,title:"8. é¾è¡¨è½¬çº¢é»æ ",slug:"_8-é¾è¡¨è½¬çº¢é»æ ",normalizedTitle:"8. é¾è¡¨è½¬çº¢é»æ ",charIndex:16880},{level:3,title:"9. ä¸ HashTable çæ¯è¾",slug:"_9-ä¸-hashtable-çæ¯è¾",normalizedTitle:"9. ä¸ hashtable çæ¯è¾",charIndex:16936},{level:2,title:"ConcurrentHashMap",slug:"concurrenthashmap",normalizedTitle:"concurrenthashmap",charIndex:725},{level:3,title:"1. å­å¨ç»æ",slug:"_1-å­å¨ç»æ-2",normalizedTitle:"1. å­å¨ç»æ",charIndex:8707},{level:3,title:"2. size æä½",slug:"_2-size-æä½",normalizedTitle:"2. size æä½",charIndex:18055},{level:3,title:"3. JDK 1.8 çæ¹å¨",slug:"_3-jdk-1-8-çæ¹å¨",normalizedTitle:"3. jdk 1.8 çæ¹å¨",charIndex:20576},{level:2,title:"LinkedHashMap",slug:"linkedhashmap",normalizedTitle:"linkedhashmap",charIndex:812},{level:3,title:"å­å¨ç»æ",slug:"å­å¨ç»æ",normalizedTitle:"å­å¨ç»æ",charIndex:8710},{level:3,title:"afterNodeAccess()",slug:"afternodeaccess",normalizedTitle:"afternodeaccess()",charIndex:21377},{level:3,title:"afterNodeInsertion()",slug:"afternodeinsertion",normalizedTitle:"afternodeinsertion()",charIndex:22226},{level:3,title:"LRU ç¼å­",slug:"lru-ç¼å­",normalizedTitle:"lru ç¼å­",charIndex:22923},{level:2,title:"WeakHashMap",slug:"weakhashmap",normalizedTitle:"weakhashmap",charIndex:23698},{level:3,title:"å­å¨ç»æ",slug:"å­å¨ç»æ-2",normalizedTitle:"å­å¨ç»æ",charIndex:8710},{level:3,title:"ConcurrentCache",slug:"concurrentcache",normalizedTitle:"concurrentcache",charIndex:23957},{level:3,title:"åæ¨¡è¿ç®å¯ä»¥è½¬æ¢æä½äºè¿ç®åé¨åçåæ:",slug:"åæ¨¡è¿ç®å¯ä»¥è½¬æ¢æä½äºè¿ç®åé¨åçåæ",normalizedTitle:"åæ¨¡è¿ç®å¯ä»¥è½¬æ¢æä½äºè¿ç®åé¨åçåæ:",charIndex:25411}],headersStr:"Collection 1. Set 2. List 3. Queue Map è¿­ä»£å¨æ¨¡å¼ ééå¨æ¨¡å¼ ArrayList 1. æ¦è§ 2. æ©å®¹ 3. å é¤åç´  4. Fail-Fast 5. åºåå Vector 1. åæ­¥ 2. ä¸ ArrayList çæ¯è¾ 3. æ¿ä»£æ¹æ¡ CopyOnWriteArrayList è¯»ååç¦» éç¨åºæ¯ LinkedList 1. æ¦è§ 2. ä¸ ArrayList çæ¯è¾ HashMap 1. å­å¨ç»æ 2. æé¾æ³çå·¥ä½åç 3. put æä½ 4. ç¡®å®æ¡¶ä¸æ  5. æ©å®¹-åºæ¬åç 6. æ©å®¹-éæ°è®¡ç®æ¡¶ä¸æ  7. è®¡ç®æ°ç»å®¹é 8. é¾è¡¨è½¬çº¢é»æ  9. ä¸ HashTable çæ¯è¾ ConcurrentHashMap 1. å­å¨ç»æ 2. size æä½ 3. JDK 1.8 çæ¹å¨ LinkedHashMap å­å¨ç»æ afterNodeAccess() afterNodeInsertion() LRU ç¼å­ WeakHashMap å­å¨ç»æ ConcurrentCache åæ¨¡è¿ç®å¯ä»¥è½¬æ¢æä½äºè¿ç®åé¨åçåæ:",content:'# ä¸ãæ¦è§\n\nå®¹å¨ä¸»è¦åæ¬ Collection å Map ä¸¤ç§ï¼Collection å­å¨çå¯¹è±¡çéåï¼è Map å­å¨çé®å¼å¯¹ï¼ä¸¤ä¸ªå¯¹è±¡ï¼çæ å°è¡¨ã\n\n\n# Collection\n\n\n\n\n# 1. Set\n\nTreeSetï¼åºäºçº¢é»æ å®ç°ï¼æ¯ææåºæ§æä½ï¼ä¾å¦æ ¹æ®ä¸ä¸ªèå´æ¥æ¾åç´ çæä½ãä½æ¯æ¥æ¾æçä¸å¦ HashSetï¼HashSet æ¥æ¾çæ¶é´å¤æåº¦ä¸º O(1)ï¼TreeSet åä¸º O(logN)ã\n\nHashSetï¼åºäºåå¸è¡¨å®ç°ï¼æ¯æå¿«éæ¥æ¾ï¼ä½ä¸æ¯ææåºæ§æä½ãå¹¶ä¸å¤±å»äºåç´ çæå¥é¡ºåºä¿¡æ¯ï¼ä¹å°±æ¯è¯´ä½¿ç¨ Iterator éå HashSet å¾å°çç»ææ¯ä¸ç¡®å®çã\n\nLinkedHashSetï¼å·æ HashSet çæ¥æ¾æçï¼ä¸åé¨ä½¿ç¨ååé¾è¡¨ç»´æ¤åç´ çæå¥é¡ºåºã\n\n\n# 2. List\n\nArrayListï¼åºäºå¨ææ°ç»å®ç°ï¼æ¯æéæºè®¿é®ã\n\nVectorï¼å ArrayList ç±»ä¼¼ï¼ä½å®æ¯çº¿ç¨å®å¨çã\n\nLinkedListï¼åºäºååé¾è¡¨å®ç°ï¼åªè½é¡ºåºè®¿é®ï¼ä½æ¯å¯ä»¥å¿«éå°å¨é¾è¡¨ä¸­é´æå¥åå é¤åç´ ãä¸ä»å¦æ­¤ï¼LinkedList è¿å¯ä»¥ç¨ä½æ ãéååååéåã\n\n\n# 3. Queue\n\nLinkedListï¼å¯ä»¥ç¨å®æ¥å®ç°ååéåã\n\nPriorityQueueï¼åºäºå ç»æå®ç°ï¼å¯ä»¥ç¨å®æ¥å®ç°ä¼åéåã\n\n\n# Map\n\n\n\n * TreeMapï¼åºäºçº¢é»æ å®ç°ã\n\n * HashMapï¼åºäºåå¸è¡¨å®ç°ã\n\n * HashTableï¼å HashMap ç±»ä¼¼ï¼ä½å®æ¯çº¿ç¨å®å¨çï¼è¿æå³çåä¸æ¶å»å¤ä¸ªçº¿ç¨å¯ä»¥åæ¶åå¥ HashTable å¹¶ä¸ä¸ä¼å¯¼è´æ°æ®ä¸ä¸è´ãå®æ¯éçç±»ï¼ä¸åºè¯¥å»ä½¿ç¨å®ãç°å¨å¯ä»¥ä½¿ç¨ ConcurrentHashMap æ¥æ¯æçº¿ç¨å®å¨ï¼å¹¶ä¸ ConcurrentHashMap çæçä¼æ´é«ï¼å ä¸º ConcurrentHashMap å¼å¥äºåæ®µéã\n\n * LinkedHashMapï¼ä½¿ç¨ååé¾è¡¨æ¥ç»´æ¤åç´ çé¡ºåºï¼é¡ºåºä¸ºæå¥é¡ºåºæèæè¿æå°ä½¿ç¨ï¼LRUï¼é¡ºåºã\n\n\n# äºãå®¹å¨ä¸­çè®¾è®¡æ¨¡å¼\n\n\n# è¿­ä»£å¨æ¨¡å¼\n\n\n\nCollection ç»§æ¿äº Iterable æ¥å£ï¼å¶ä¸­ç iterator() æ¹æ³è½å¤äº§çä¸ä¸ª Iterator å¯¹è±¡ï¼éè¿è¿ä¸ªå¯¹è±¡å°±å¯ä»¥è¿­ä»£éå Collection ä¸­çåç´ ã\n\nä» JDK 1.5 ä¹åå¯ä»¥ä½¿ç¨ foreach æ¹æ³æ¥éåå®ç°äº Iterable æ¥å£çèåå¯¹è±¡ã\n\nList<String> list = new ArrayList<>();\nlist.add("a");\nlist.add("b");\nfor (String item : list) {\n    System.out.println(item);\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# ééå¨æ¨¡å¼\n\njava.util.Arrays#asList() å¯ä»¥ææ°ç»ç±»åè½¬æ¢ä¸º List ç±»åã\n\n@SafeVarargs\npublic static <T> List<T> asList(T... a)\n\n\n1\n2\n\n\nåºè¯¥æ³¨æçæ¯ asList() çåæ°ä¸ºæ³åçåé¿åæ°ï¼ä¸è½ä½¿ç¨åºæ¬ç±»åæ°ç»ä½ä¸ºåæ°ï¼åªè½ä½¿ç¨ç¸åºçåè£ç±»åæ°ç»ã\n\nInteger[] arr = {1, 2, 3};\nList list = Arrays.asList(arr);\n\n\n1\n2\n\n\nä¹å¯ä»¥ä½¿ç¨ä»¥ä¸æ¹å¼è°ç¨ asList()ï¼\n\nList list = Arrays.asList(1, 2, 3);\n\n\n1\n\n\n\n# ä¸ãæºç åæ\n\nå¦ææ²¡æç¹å«è¯´æï¼ä»¥ä¸æºç åæåºäº JDK 1.8ã\n\nå¨ IDEA ä¸­ double shift è°åº Search EveryWhereï¼æ¥æ¾æºç æä»¶ï¼æ¾å°ä¹åå°±å¯ä»¥éè¯»æºç ã\n\n\n# ArrayList\n\n\n# 1. æ¦è§\n\nå ä¸º ArrayList æ¯åºäºæ°ç»å®ç°çï¼æä»¥æ¯æå¿«ééæºè®¿é®ãRandomAccess æ¥å£æ è¯çè¯¥ç±»æ¯æå¿«ééæºè®¿é®ã\n\npublic class ArrayList<E> extends AbstractList<E>\n        implements List<E>, RandomAccess, Cloneable, java.io.Serializable\n\n\n1\n2\n\n\næ°ç»çé»è®¤å¤§å°ä¸º 10ã\n\nprivate static final int DEFAULT_CAPACITY = 10;\n\n\n1\n\n\n\n\n\n# 2. æ©å®¹\n\næ·»å åç´ æ¶ä½¿ç¨ ensureCapacityInternal() æ¹æ³æ¥ä¿è¯å®¹éè¶³å¤ï¼å¦æä¸å¤æ¶ï¼éè¦ä½¿ç¨ grow() æ¹æ³è¿è¡æ©å®¹ï¼æ°å®¹éçå¤§å°ä¸º oldCapacity + (oldCapacity >> 1)ï¼ä¹å°±æ¯æ§å®¹éç 1.5 åã\n\næ©å®¹æä½éè¦è°ç¨ Arrays.copyOf() æåæ°ç»æ´ä¸ªå¤å¶å°æ°æ°ç»ä¸­ï¼è¿ä¸ªæä½ä»£ä»·å¾é«ï¼å æ­¤æå¥½å¨åå»º ArrayList å¯¹è±¡æ¶å°±æå®å¤§æ¦çå®¹éå¤§å°ï¼åå°æ©å®¹æä½çæ¬¡æ°ã\n\npublic boolean add(E e) {\n    // size ä¸ºæ°ç»ä¸­å½ååç´ æ°é\n    ensureCapacityInternal(size + 1); \n    elementData[size++] = e;\n    return true;\n}\nprivate void ensureCapacityInternal(int minCapacity) {\n    if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {\n        minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);\n    }\n    ensureExplicitCapacity(minCapacity);\n}\nprivate void ensureExplicitCapacity(int minCapacity) {\n    modCount++; // Increments modCount!!\n    // overflow-conscious code ï¼éå¯¹æº¢åºè¿è¡èèçä»£ç ï¼\n    // å¦ææ¬æ¬¡æ·»å åç´ éè¦çæå°æ°ç»å®¹éæ¯å½åæ°ç»å®¹éå¤§ï¼åéè¦è¿è¡æ©å®¹æä½ã\n    if (minCapacity - elementData.length > 0)\n        grow(minCapacity);\n}\nprivate void grow(int minCapacity) {\n    // overflow-conscious codeï¼éå¯¹æº¢åºè¿è¡èèçä»£ç ï¼\n    int oldCapacity = elementData.length;\n    int newCapacity = oldCapacity + (oldCapacity >> 1);\n    if (newCapacity - minCapacity < 0)\n        newCapacity = minCapacity;\n    if (newCapacity - MAX_ARRAY_SIZE > 0)\n        newCapacity = hugeCapacity(minCapacity);\n    // minCapacity is usually close to size, so this is a win:\n    // æå½åæ°ç»åç´ å¤å¶å°æ©å®¹åçæ°æ°ç»ä¸­\n    elementData = Arrays.copyOf(elementData, newCapacity);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n\n\n\n# 3. å é¤åç´ \n\néè¦è°ç¨ System.arraycopy() å° index+1 åé¢çåç´ é½å¤å¶å° index ä½ç½®ä¸ï¼è¯¥æä½çæ¶é´å¤æåº¦ä¸º O(N)ï¼å¯ä»¥çåº ArrayList å é¤åç´ çä»£ä»·æ¯éå¸¸é«çã\n\npublic E remove(int index) {\n    rangeCheck(index);\n    modCount++;\n    E oldValue = elementData(index);\n    int numMoved = size - index - 1;\n    if (numMoved > 0)\n        System.arraycopy(elementData, index+1, elementData, index, numMoved);\n    elementData[--size] = null; // clear to let GC do its work\n    return oldValue;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# 4. Fail-Fast\n\nmodCount ç¨æ¥è®°å½ ArrayList ç»æåçååçæ¬¡æ°ãç»æåçååæ¯ææ·»å æèå é¤è³å°ä¸ä¸ªåç´ çæææä½ï¼æèæ¯è°æ´åé¨æ°ç»çå¤§å°ï¼ä»ä»åªæ¯è®¾ç½®åç´ çå¼ä¸ç®ç»æåçååã\n\nå¨è¿è¡åºååæèè¿­ä»£ç­æä½æ¶ï¼éè¦æ¯è¾æä½åå modCount æ¯å¦æ¹åï¼å¦ææ¹åäºéè¦æåº ConcurrentModificationExceptionã\n\nprivate void writeObject(java.io.ObjectOutputStream s)\n    throws java.io.IOException{\n    // æä½å¼å§ä¹ååä¿å­åå§modCountï¼æä½ç»æåå¤æ­modCountæ¯å¦æ¹å\n    int expectedModCount = modCount;\n    // Write out element count, and any hidden stuff\n    s.defaultWriteObject();\n\n    // Write out size as capacity for behavioural compatibility with clone()\n    // åå¥æ°ç»åç´ æ°éä½ä¸ºæ°ç»å®¹é\n    s.writeInt(size);\n\n    // Write out all elements in the proper order.\n    // åªåºååæå¼çæ°ç»åç´ \n    for (int i=0; i<size; i++) {\n        s.writeObject(elementData[i]);\n    }\n\n    if (modCount != expectedModCount) {\n        throw new ConcurrentModificationException();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n\n# 5. åºåå\n\nArrayList åºäºæ°ç»å®ç°ï¼å¹¶ä¸å·æå¨ææ©å®¹ç¹æ§ï¼å æ­¤ä¿å­åç´ çæ°ç»ä¸ä¸å®é½ä¼è¢«ä½¿ç¨ï¼é£ä¹å°±æ²¡å¿è¦å¨é¨è¿è¡åºååã\n\nä¿å­åç´ çæ°ç» elementData ä½¿ç¨ transient ä¿®é¥°ï¼è¯¥å³é®å­å£°ææ°ç»é»è®¤ä¸ä¼è¢«åºååã\n\ntransient Object[] elementData; // non-private to simplify nested class access\n\n\n1\n\n\nArrayList å®ç°äº writeObject() å readObject() æ¥æ§å¶åªåºååæ°ç»ä¸­æåç´ å¡«åé£é¨ååå®¹ã\n\nprivate void readObject(java.io.ObjectInputStream s)\n    throws java.io.IOException, ClassNotFoundException {\n    elementData = EMPTY_ELEMENTDATA;\n\n    // Read in size, and any hidden stuff\n    s.defaultReadObject();\n\n    // Read in capacity\n    s.readInt(); // ignored\n\n    if (size > 0) {\n        // be like clone(), allocate array based upon size not capacity\n        ensureCapacityInternal(size);\n\n        Object[] a = elementData;\n        // Read in all elements in the proper order.\n        for (int i=0; i<size; i++) {\n            a[i] = s.readObject();\n        }\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nprivate void writeObject(java.io.ObjectOutputStream s)    throws java.io.IOException{    // Write out element count, and any hidden stuff    int expectedModCount = modCount;    s.defaultWriteObject();    // Write out size as capacity for behavioural compatibility with clone()    s.writeInt(size);    // Write out all elements in the proper order.    for (int i=0; i<size; i++) {        s.writeObject(elementData[i]);    }    if (modCount != expectedModCount) {        throw new ConcurrentModificationException();    }}\n\n\n1\n\n\nåºååæ¶éè¦ä½¿ç¨ ObjectOutputStream ç writeObject() å°å¯¹è±¡è½¬æ¢ä¸ºå­èæµå¹¶è¾åºãè writeObject() æ¹æ³å¨ä¼ å¥çå¯¹è±¡å­å¨ writeObject() çæ¶åä¼å»åå°è°ç¨è¯¥å¯¹è±¡ç writeObject() æ¥å®ç°åºååãååºååä½¿ç¨çæ¯ ObjectInputStream ç readObject() æ¹æ³ï¼åçç±»ä¼¼ã\n\nArrayList list = new ArrayList();\nObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(file));\noos.writeObject(list);\n\n\n1\n2\n3\n\n\n\n# Vector\n\n\n# 1. åæ­¥\n\nå®çå®ç°ä¸ ArrayList ç±»ä¼¼ï¼ä½æ¯ä½¿ç¨äº synchronized è¿è¡åæ­¥ã\n\npublic synchronized boolean add(E e) {\n    modCount++;\n    ensureCapacityHelper(elementCount + 1);\n    elementData[elementCount++] = e;\n    return true;\n}\n\npublic synchronized E get(int index) {\n    if (index >= elementCount)\n        throw new ArrayIndexOutOfBoundsException(index);\n\n    return elementData(index);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# 2. ä¸ ArrayList çæ¯è¾\n\nVector æ¯åæ­¥çï¼å æ­¤å¼éå°±æ¯ ArrayList è¦å¤§ï¼è®¿é®éåº¦æ´æ¢ãæå¥½ä½¿ç¨ ArrayList èä¸æ¯ Vectorï¼å ä¸ºåæ­¥æä½å®å¨å¯ä»¥ç±ç¨åºåèªå·±æ¥æ§å¶ï¼ Vector æ¯æ¬¡æ©å®¹è¯·æ±å¶å¤§å°ç 2 åç©ºé´ï¼è ArrayList æ¯ 1.5 åã\n\n\n# 3. æ¿ä»£æ¹æ¡\n\nå¯ä»¥ä½¿ç¨ Collections.synchronizedList(); å¾å°ä¸ä¸ªçº¿ç¨å®å¨ç ArrayListã\n\nList<String> list = new ArrayList<>();List<String> synList = Collections.synchronizedList(list);\n\n\n1\n\n\nä¹å¯ä»¥ä½¿ç¨ concurrent å¹¶ååä¸ç CopyOnWriteArrayList ç±»ã\n\nList<String> list = new CopyOnWriteArrayList<>();\n\n\n1\n\n\n\n# CopyOnWriteArrayList\n\n\n# è¯»ååç¦»\n\nåæä½å¨ä¸ä¸ªå¤å¶çæ°ç»ä¸è¿è¡ï¼è¯»æä½è¿æ¯å¨åå§æ°ç»ä¸­è¿è¡ï¼è¯»ååç¦»ï¼äºä¸å½±åã\n\nåæä½éè¦å éï¼é²æ­¢å¹¶ååå¥æ¶å¯¼è´åå¥æ°æ®ä¸¢å¤±ã\n\nåæä½ç»æä¹åéè¦æåå§æ°ç»æåæ°çå¤å¶æ°ç»ã\n\npublic boolean add(E e) {\n    final ReentrantLock lock = this.lock;\n    lock.lock();\n    try {\n        // å¾å°åæ°ç»\n        Object[] elements = getArray();\n        // å¾å°åæ°ç»é¿åº¦\n        int len = elements.length;\n        // æåæ°ç»åç´ å¤å¶å°ä¸ä¸ªæ°æ°ç»ä¸­ï¼é¿åº¦å ä¸\n        Object[] newElements = Arrays.copyOf(elements, len + 1);\n        newElements[len] = e;\n        setArray(newElements);\n        return true;\n    } finally {\n        lock.unlock();\n    }\n}\n\nfinal void setArray(Object[] a) {\n    // æ°æ°ç»èµå¼ç»æ°ç»åé\n    array = a;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\n@SuppressWarnings("unchecked")\nprivate E get(Object[] a, int index) {\n    return (E) a[index];\n}\n\n\n1\n2\n3\n4\n\n\n\n# éç¨åºæ¯\n\nCopyOnWriteArrayList å¨åæä½çåæ¶åè®¸è¯»æä½ï¼å¤§å¤§æé«äºè¯»æä½çæ§è½ï¼å æ­¤å¾éåè¯»å¤åå°çåºç¨åºæ¯ã\n\nä½æ¯ CopyOnWriteArrayList æå¶ç¼ºé·ï¼\n\n * åå­å ç¨ï¼å¨åæä½æ¶éè¦å¤å¶ä¸ä¸ªæ°çæ°ç»ï¼ä½¿å¾åå­å ç¨ä¸ºåæ¥çä¸¤åå·¦å³ï¼\n * æ°æ®ä¸ä¸è´ï¼è¯»æä½ä¸è½è¯»åå®æ¶æ§çæ°æ®ï¼å ä¸ºé¨ååæä½çæ°æ®è¿æªåæ­¥å°è¯»æ°ç»ä¸­ã æä»¥ CopyOnWriteArrayList ä¸éååå­ææä»¥åå¯¹å®æ¶æ§è¦æ±å¾é«çåºæ¯ã\n\n\n# LinkedList\n\n\n# 1. æ¦è§\n\nåºäºååé¾è¡¨å®ç°ï¼ä½¿ç¨ Node å­å¨é¾è¡¨èç¹ä¿¡æ¯ã\n\nprivate static class Node<E> {    E item;    Node<E> next;    Node<E> prev;}\n\n\n1\n\n\næ¯ä¸ªé¾è¡¨å­å¨äº first å last æéï¼\n\ntransient Node<E> first;transient Node<E> last;\n\n\n1\n\n\n\n\n\n# 2. ä¸ ArrayList çæ¯è¾\n\n * ArrayList åºäºå¨ææ°ç»å®ç°ï¼LinkedList åºäºååé¾è¡¨å®ç°ï¼\n * ArrayList æ¯æéæºè®¿é®ï¼LinkedList ä¸æ¯æï¼\n * LinkedList å¨ä»»æä½ç½®æ·»å å é¤åç´ æ´å¿«ã\n\n\n# HashMap\n\nä¸ºäºä¾¿äºçè§£ï¼ä»¥ä¸æºç åæä»¥ JDK 1.7 ä¸ºä¸»ã\n\n\n# 1. å­å¨ç»æ\n\nåé¨åå«äºä¸ä¸ª Entry ç±»åçæ°ç» tableã\n\ntransient Entry[] table;\n\n\n1\n\n\nEntry å­å¨çé®å¼å¯¹ãå®åå«äºåä¸ªå­æ®µï¼ä» next å­æ®µæä»¬å¯ä»¥çåº Entry æ¯ä¸ä¸ªé¾è¡¨ãå³æ°ç»ä¸­çæ¯ä¸ªä½ç½®è¢«å½æä¸ä¸ªæ¡¶ï¼ä¸ä¸ªæ¡¶å­æ¾ä¸ä¸ªé¾è¡¨ãHashMap ä½¿ç¨æé¾æ³æ¥è§£å³å²çªï¼åä¸ä¸ªé¾è¡¨ä¸­å­æ¾åå¸å¼åæ£åæ¡¶åæ¨¡è¿ç®ç»æç¸åç Entryã\n\n\n\nstatic class Entry<K,V> implements Map.Entry<K,V> {\n    final K key;\n    V value;\n    Entry<K,V> next;\n    int hash;\n\n    Entry(int h, K k, V v, Entry<K,V> n) {\n        value = v;\n        next = n;\n        key = k;\n        hash = h;\n    }\n\n    public final K getKey() {\n        return key;\n    }\n\n    public final V getValue() {\n        return value;\n    }\n\n    public final V setValue(V newValue) {\n        V oldValue = value;\n        value = newValue;\n        return oldValue;\n    }\n\n    public final boolean equals(Object o) {\n        if (!(o instanceof Map.Entry))\n            return false;\n        Map.Entry e = (Map.Entry)o;\n        Object k1 = getKey();\n        Object k2 = e.getKey();\n        if (k1 == k2 || (k1 != null && k1.equals(k2))) {\n            Object v1 = getValue();\n            Object v2 = e.getValue();\n            if (v1 == v2 || (v1 != null && v1.equals(v2)))\n                return true;\n        }\n        return false;\n    }\n\n    public final int hashCode() {\n        return Objects.hashCode(getKey()) ^ Objects.hashCode(getValue());\n    }\n\n    public final String toString() {\n        return getKey() + "=" + getValue();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n\n\n\n# 2. æé¾æ³çå·¥ä½åç\n\nHashMap<String, String> map = new HashMap<>();\nmap.put("K1", "V1");\nmap.put("K2", "V2");\nmap.put("K3", "V3");\n\n\n1\n2\n3\n4\n\n\næ°å»ºä¸ä¸ª HashMapï¼é»è®¤å¤§å°ä¸º 16ï¼\n\n * æå¥ <K1,V1> é®å¼å¯¹ï¼åè®¡ç® K1 ç hashCode ä¸º 115ï¼ä½¿ç¨é¤çä½æ°æ³å¾å°æå¨çæ¡¶ä¸æ  115%16=3ã\n * æå¥ <K2,V2> é®å¼å¯¹ï¼åè®¡ç® K2 ç hashCode ä¸º 118ï¼ä½¿ç¨é¤çä½æ°æ³å¾å°æå¨çæ¡¶ä¸æ  118%16=6ã\n * æå¥ <K3,V3> é®å¼å¯¹ï¼åè®¡ç® K3 ç hashCode ä¸º 118ï¼ä½¿ç¨é¤çä½æ°æ³å¾å°æå¨çæ¡¶ä¸æ  118%16=6ï¼æå¨ <K2,V2> åé¢ã åºè¯¥æ³¨æå°é¾è¡¨çæå¥æ¯ä»¥å¤´ææ³æ¹å¼è¿è¡çï¼ä¾å¦ä¸é¢ç <K3,V3> ä¸æ¯æå¨ <K2,V2> åé¢ï¼èæ¯æå¥å¨é¾è¡¨å¤´é¨ã\n\næ¥æ¾éè¦åæä¸¤æ­¥è¿è¡ï¼\n\n * è®¡ç®é®å¼å¯¹æå¨çæ¡¶ï¼\n * å¨é¾è¡¨ä¸é¡ºåºæ¥æ¾ï¼æ¶é´å¤æåº¦æ¾ç¶åé¾è¡¨çé¿åº¦ææ­£æ¯ã\n\n\n\n\n# 3. put æä½\n\npublic V put(K key, V value) {\n    if (table == EMPTY_TABLE) {\n        inflateTable(threshold);\n    }\n    // é®ä¸º null åç¬å¤ç\n    if (key == null)\n        return putForNullKey(value);\n    int hash = hash(key);\n    // ç¡®å®æ¡¶ä¸æ \n    int i = indexFor(hash, table.length);\n    // åæ¾åºæ¯å¦å·²ç»å­å¨é®ä¸º key çé®å¼å¯¹ï¼å¦æå­å¨çè¯å°±æ´æ°è¿ä¸ªé®å¼å¯¹çå¼ä¸º value\n    for (Entry<K,V> e = table[i]; e != null; e = e.next) {\n        Object k;\n        if (e.hash == hash && ((k = e.key) == key || key.equals(k))) {\n            V oldValue = e.value;\n            e.value = value;\n            e.recordAccess(this);\n            return oldValue;\n        }\n    }\n\n    modCount++;\n    // æå¥æ°é®å¼å¯¹\n    addEntry(hash, key, value, i);\n    return null;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nHashMap åè®¸æå¥é®ä¸º null çé®å¼å¯¹ãä½æ¯å ä¸ºæ æ³è°ç¨ null ç hashCode() æ¹æ³ï¼ä¹å°±æ æ³ç¡®å®è¯¥é®å¼å¯¹çæ¡¶ä¸æ ï¼åªè½éè¿å¼ºå¶æå®ä¸ä¸ªæ¡¶ä¸æ æ¥å­æ¾ãHashMap ä½¿ç¨ç¬¬ 0 ä¸ªæ¡¶å­æ¾é®ä¸º null çé®å¼å¯¹ã\n\nprivate V putForNullKey(V value) {    for (Entry<K,V> e = table[0]; e != null; e = e.next) {        if (e.key == null) {            V oldValue = e.value;            e.value = value;            e.recordAccess(this);            return oldValue;        }    }    modCount++;    addEntry(0, null, value, 0);    return null;}\n\n\n1\n\n\nä½¿ç¨é¾è¡¨çå¤´ææ³ï¼ä¹å°±æ¯æ°çé®å¼å¯¹æå¨é¾è¡¨çå¤´é¨ï¼èä¸æ¯é¾è¡¨çå°¾é¨ã\n\nvoid addEntry(int hash, K key, V value, int bucketIndex) {    // é®å¼å¯¹æ°éè¶è¿ä¸´çå¼å¹¶ä¸hashå°çæ¡¶ä½ç½®å·²ç»æåç´ å­æ¾æ¶ï¼è¿è¡æ©å®¹æä½ã    if ((size >= threshold) && (null != table[bucketIndex])) {        resize(2 * table.length);        // è®¡ç®hashå¼        hash = (null != key) ? hash(key) : 0;        // è®¡ç®æ¡¶ä½ç½®        bucketIndex = indexFor(hash, table.length);    }    createEntry(hash, key, value, bucketIndex);}void createEntry(int hash, K key, V value, int bucketIndex) {    // å¾å°ç®æ æ¡¶ä½ç½®é¾è¡¨å¤´åç´     Entry<K,V> e = table[bucketIndex];    // å¤´ææ³ä½ç°    table[bucketIndex] = new Entry<>(hash, key, value, e);    size++;}\n\n\n1\n\n\nEntry(int h, K k, V v, Entry<K,V> n) {    value = v;    next = n;    key = k;    hash = h;}\n\n\n1\n\n\n\n# 4. ç¡®å®æ¡¶ä¸æ \n\nå¾å¤æä½é½éè¦åç¡®å®ä¸ä¸ªé®å¼å¯¹æå¨çæ¡¶ä¸æ ã\n\nint hash = hash(key);\nint i = indexFor(hash, table.length);\n\n\n1\n2\n\n\n# 4.1 è®¡ç® hash å¼\n\nfinal int hash(Object k) {\n    int h = hashSeed;\n    if (0 != h && k instanceof String) {\n        return sun.misc.Hashing.stringHash32((String) k);\n    }\n\n    h ^= k.hashCode();\n\n    // This function ensures that hashCodes that differ only by\n    // constant multiples at each bit position have a bounded\n    // number of collisions (approximately 8 at default load factor).\n    h ^= (h >>> 20) ^ (h >>> 12);\n    return h ^ (h >>> 7) ^ (h >>> 4);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\npublic final int hashCode() {\n    return Objects.hashCode(key) ^ Objects.hashCode(value);\n}\n\n\n1\n2\n3\n\n\n# 4.2 åæ¨¡\n\nä»¤ x = 1<<4ï¼å³ x ä¸º 2 ç 4 æ¬¡æ¹ï¼å®å·æä»¥ä¸æ§è´¨ï¼\n\nx   : 00010000\nx-1 : 00001111\n\n\n1\n2\n\n\nä»¤ä¸ä¸ªæ° y ä¸ x-1 åä¸è¿ç®ï¼å¯ä»¥å»é¤ y ä½çº§è¡¨ç¤ºçç¬¬ 4 ä½ä»¥ä¸æ°ï¼\n\ny       : 10110010\nx-1     : 00001111\ny&(x-1) : 00000010\n\n\n1\n2\n3\n\n\nè¿ä¸ªæ§è´¨å y å¯¹ x åæ¨¡æææ¯ä¸æ ·çï¼\n\ny   : 10110010\nx   : 00010000\ny%x : 00000010\n\n\n1\n2\n3\n\n\næä»¬ç¥éï¼ä½è¿ç®çä»£ä»·æ¯æ±æ¨¡è¿ç®å°çå¤ï¼å æ­¤å¨è¿è¡è¿ç§è®¡ç®æ¶ç¨ä½è¿ç®çè¯è½å¸¦æ¥æ´é«çæ§è½ã\n\nç¡®å®æ¡¶ä¸æ çæåä¸æ­¥æ¯å° key ç hash å¼å¯¹æ¡¶ä¸ªæ°åæ¨¡ï¼hash%capacityï¼å¦æè½ä¿è¯ capacity ä¸º 2 ç n æ¬¡æ¹ï¼é£ä¹å°±å¯ä»¥å°è¿ä¸ªæä½è½¬æ¢ä¸ºä½è¿ç®ã\n\nstatic int indexFor(int h, int length) {\n    return h & (length-1);\n}\n\n\n1\n2\n3\n\n\n\n# 5. æ©å®¹-åºæ¬åç\n\nè®¾ HashMap ç table é¿åº¦ä¸º Mï¼éè¦å­å¨çé®å¼å¯¹æ°éä¸º Nï¼å¦æåå¸å½æ°æ»¡è¶³ååæ§çè¦æ±ï¼é£ä¹æ¯æ¡é¾è¡¨çé¿åº¦å¤§çº¦ä¸º N/Mï¼å æ­¤å¹³åæ¥æ¾æ¬¡æ°çå¤æåº¦ä¸º O(N/M)ã\n\nä¸ºäºè®©æ¥æ¾çææ¬éä½ï¼åºè¯¥å°½å¯è½ä½¿å¾ N/M å°½å¯è½å°ï¼å æ­¤éè¦ä¿è¯ M å°½å¯è½å¤§ï¼ä¹å°±æ¯è¯´ table è¦å°½å¯è½å¤§ãHashMap éç¨å¨ææ©å®¹æ¥æ ¹æ®å½åç N å¼æ¥è°æ´ M å¼ï¼ä½¿å¾ç©ºé´æçåæ¶é´æçé½è½å¾å°ä¿è¯ã\n\nåæ©å®¹ç¸å³çåæ°ä¸»è¦æï¼capacityãsizeãthreshold å load_factorã\n\nåæ°           å«ä¹\ncapacity     table çå®¹éå¤§å°ï¼é»è®¤ä¸º 16ãéè¦æ³¨æçæ¯ capacity å¿é¡»ä¿è¯ä¸º 2 ç n æ¬¡æ¹ã\nsize         é®å¼å¯¹æ°éã\nthreshold    size çä¸´çå¼ï¼å½ size å¤§äºç­äº threshold å°±å¿é¡»è¿è¡æ©å®¹æä½ã\nloadFactor   è£è½½å å­ï¼table è½å¤ä½¿ç¨çæ¯ä¾ï¼threshold = capacity * loadFactorã\n\nstatic final int DEFAULT_INITIAL_CAPACITY = 16;static final int MAXIMUM_CAPACITY = 1 << 30;static final float DEFAULT_LOAD_FACTOR = 0.75f;transient Entry[] table;transient int size;int threshold;final float loadFactor;transient int modCount;\n\n\n1\n\n\nä»ä¸é¢çæ·»å åç´ ä»£ç ä¸­å¯ä»¥çåºï¼å½éè¦æ©å®¹æ¶ï¼ä»¤ capacity ä¸ºåæ¥çä¸¤åã\n\nvoid addEntry(int hash, K key, V value, int bucketIndex) {    Entry<K,V> e = table[bucketIndex];    table[bucketIndex] = new Entry<>(hash, key, value, e);    if (size++ >= threshold)        resize(2 * table.length);}\n\n\n1\n\n\næ©å®¹ä½¿ç¨ resize() å®ç°ï¼éè¦æ³¨æçæ¯ï¼æ©å®¹æä½åæ ·éè¦æ oldTable çææé®å¼å¯¹éæ°æå¥ newTable ä¸­ï¼å æ­¤è¿ä¸æ­¥æ¯å¾è´¹æ¶çã\n\nvoid resize(int newCapacity) {    Entry[] oldTable = table;    int oldCapacity = oldTable.length;    if (oldCapacity == MAXIMUM_CAPACITY) {        threshold = Integer.MAX_VALUE;        return;    }    // æé æ°çEntryæ°ç»ï¼å®¹éä¸ºnewCapacityï¼2åäºåå®¹éï¼    Entry[] newTable = new Entry[newCapacity];    // ææ§Entryæ°ç»éçåç´ ç§»å¨å°æ°Entryæ°ç»é    transfer(newTable);    // æ°ç»åéæåæ°Entryæ°ç»    table = newTable;    threshold = (int)(newCapacity * loadFactor);}void transfer(Entry[] newTable) {    // å¾å°å Entry æ°ç»    Entry[] src = table;    int newCapacity = newTable.length;    // ä¸¤å±å¾ªç¯åå«éååæ°ç»ä»¥ååæ°ç»åç´ ä¸­çEntryé¾è¡¨    for (int j = 0; j < src.length; j++) {        Entry<K,V> e = src[j];        if (e != null) {            // clear to let GC do its work            src[j] = null;            do {                Entry<K,V> next = e.next;                // æ ¹æ®hashå¼åæ°æ°ç»å®¹éè®¡ç®åºæ£åå°æ°æ°ç»ä¸­çæ¡¶çä½ç½®                int i = indexFor(e.hash, newCapacity);                // ä¸é¢ä¸¤æ­¥æ¯å¤´ææ³                e.next = newTable[i];                newTable[i] = e;                // æåé¾è¡¨ä¸­ä¸ä¸åç´ ï¼è¿è¡ä¸ä¸æ¬¡å¾ªç¯å¤ç                e = next;            } while (e != null);        }    }}\n\n\n1\n\n\n\n# 6. æ©å®¹-éæ°è®¡ç®æ¡¶ä¸æ \n\nå¨è¿è¡æ©å®¹æ¶ï¼éè¦æé®å¼å¯¹éæ°æ¾å°å¯¹åºçæ¡¶ä¸ãHashMap ä½¿ç¨äºä¸ä¸ªç¹æ®çæºå¶ï¼å¯ä»¥éä½éæ°è®¡ç®æ¡¶ä¸æ çæä½ã\n\nåè®¾åæ°ç»é¿åº¦ capacity ä¸º 16ï¼æ©å®¹ä¹å new capacity ä¸º 32ï¼\n\ncapacity     : 00010000new capacity : 00100000\n\n\n1\n\n\nå¯¹äºä¸ä¸ª Keyï¼\n\n * å®çåå¸å¼å¦æå¨ç¬¬ 5 ä½ä¸ä¸º 0ï¼é£ä¹åæ¨¡å¾å°çç»æåä¹åä¸æ ·ï¼\n * å¦æä¸º 1ï¼é£ä¹å¾å°çç»æä¸ºåæ¥çç»æ +16ã\n\n\n# 7. è®¡ç®æ°ç»å®¹é\n\nHashMap æé å½æ°åè®¸ç¨æ·ä¼ å¥çå®¹éä¸æ¯ 2 ç n æ¬¡æ¹ï¼å ä¸ºå®å¯ä»¥èªå¨å°å°ä¼ å¥çå®¹éè½¬æ¢ä¸º 2 ç n æ¬¡æ¹ã\n\nåèèå¦ä½æ±ä¸ä¸ªæ°çæ©ç ï¼å¯¹äº 10010000ï¼å®çæ©ç ä¸º 11111111ï¼å¯ä»¥ä½¿ç¨ä»¥ä¸æ¹æ³å¾å°ï¼\n\nmask |= mask >> 1    11011000mask |= mask >> 2    11111110mask |= mask >> 4    11111111\n\n\n1\n\n\nmask+1 æ¯å¤§äºåå§æ°å­çæå°ç 2 ç n æ¬¡æ¹ã\n\nnum     10010000\nmask+1 100000000\n\n\n1\n2\n\n\nä»¥ä¸æ¯ HashMap ä¸­è®¡ç®æ°ç»å®¹éçä»£ç ï¼\n\nstatic final int tableSizeFor(int cap) {\n    int n = cap - 1;\n    n |= n >>> 1;\n    n |= n >>> 2;\n    n |= n >>> 4;\n    n |= n >>> 8;\n    n |= n >>> 16;\n    return (n < 0) ? 1 : (n >= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# 8. é¾è¡¨è½¬çº¢é»æ \n\nä» JDK 1.8 å¼å§ï¼ä¸ä¸ªæ¡¶å­å¨çé¾è¡¨é¿åº¦å¤§äº 8 æ¶ä¼å°é¾è¡¨è½¬æ¢ä¸ºçº¢é»æ ã\n\n\n# 9. ä¸ HashTable çæ¯è¾\n\n * HashTable ä½¿ç¨ synchronized æ¥è¿è¡åæ­¥ã\n * HashMap å¯ä»¥æå¥é®ä¸º null ç Entryã\n * HashMap çè¿­ä»£å¨æ¯ fail-fast è¿­ä»£å¨ã\n * HashMap ä¸è½ä¿è¯éçæ¶é´çæ¨ç§» Map ä¸­çåç´ æ¬¡åºæ¯ä¸åçã\n\n\n# ConcurrentHashMap\n\n\n# 1. å­å¨ç»æ\n\nstatic final class HashEntry<K,V> {\n    final int hash;\n    final K key;\n    volatile V value;\n    volatile HashEntry<K,V> next;\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nConcurrentHashMap å HashMap å®ç°ä¸ç±»ä¼¼ï¼æä¸»è¦çå·®å«æ¯ ConcurrentHashMap éç¨äºåæ®µéï¼Segmentï¼ï¼æ¯ä¸ªåæ®µéç»´æ¤çå ä¸ªæ¡¶ï¼HashEntryï¼ï¼å¤ä¸ªçº¿ç¨å¯ä»¥åæ¶è®¿é®ä¸ååæ®µéä¸çæ¡¶ï¼ä»èä½¿å¶å¹¶ååº¦æ´é«ï¼å¹¶ååº¦å°±æ¯ Segment çä¸ªæ°ï¼ã\n\nSegment ç»§æ¿èª ReentrantLockã\n\nstatic final class Segment<K,V> extends ReentrantLock implements Serializable {\n\n    private static final long serialVersionUID = 2249069246763182397L;\n\n    static final int MAX_SCAN_RETRIES =\n        Runtime.getRuntime().availableProcessors() > 1 ? 64 : 1;\n\n    transient volatile HashEntry<K,V>[] table;\n\n    transient int count;\n\n    transient int modCount;\n\n    transient int threshold;\n\n    final float loadFactor;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nfinal Segment<K,V>[] segments;\n\n\n1\n\n\né»è®¤çå¹¶åçº§å«ä¸º 16ï¼ä¹å°±æ¯è¯´é»è®¤åå»º 16 ä¸ª Segmentã\n\nstatic final int DEFAULT_CONCURRENCY_LEVEL = 16;\n\n\n1\n\n\n\n\n\n# 2. size æä½\n\næ¯ä¸ª Segment ç»´æ¤äºä¸ä¸ª count åéæ¥ç»è®¡è¯¥ Segment ä¸­çé®å¼å¯¹ä¸ªæ°ã\n\n/**\n * The number of elements. Accessed only either within locks\n * or among other volatile reads that maintain visibility.\n */\ntransient int count;\n\n\n1\n2\n3\n4\n5\n\n\nå¨æ§è¡ size æä½æ¶ï¼éè¦éåææ Segment ç¶åæ count ç´¯è®¡èµ·æ¥ã\n\nConcurrentHashMap å¨æ§è¡ size æä½æ¶åå°è¯ä¸å éï¼å¦æè¿ç»­ä¸¤æ¬¡ä¸å éæä½å¾å°çç»æä¸è´ï¼é£ä¹å¯ä»¥è®¤ä¸ºè¿ä¸ªç»ææ¯æ­£ç¡®çã\n\nå°è¯æ¬¡æ°ä½¿ç¨ RETRIES_BEFORE_LOCK å®ä¹ï¼è¯¥å¼ä¸º 2ï¼retries åå§å¼ä¸º -1ï¼å æ­¤å°è¯æ¬¡æ°ä¸º 3ã\n\nå¦æå°è¯çæ¬¡æ°è¶è¿ 3 æ¬¡ï¼å°±éè¦å¯¹æ¯ä¸ª Segment å éã\n\n/**\n * Number of unsynchronized retries in size and containsValue\n * methods before resorting to locking. This is used to avoid\n * unbounded retries if tables undergo continuous modification\n * which would make it impossible to obtain an accurate result.\n * è¯ï¼å¨éå®ä¹åï¼sizeæ¹æ³åcontainsValueæ¹æ³ä¸­ä¸åæ­¥éè¯çæ¬¡æ°ã\n * è¿æ ·åæ¯ä¸ºäºé¿åå¨è¡¨ä¸æ­ä¿®æ¹çæåµä¸è¿è¡æ çéè¯ï¼å ä¸ºä¿®æ¹ä¼å¯¼è´æ æ³è·å¾åç¡®çç»æã\n */\nstatic final int RETRIES_BEFORE_LOCK = 2;\n\npublic int size() {\n    // Try a few times to get accurate count. On failure due to\n    // continuous async changes in table, resort to locking.\n    // è¯å æ¬¡ï¼ä»¥è·å¾åç¡®çè®¡æ°ãç±äºè¡¨ä¸­çè¿ç»­å¼æ­¥æ´æ¹èå¯¼è´å¤±è´¥æ¶ï¼è¯·ä½¿ç¨éå®ã\n    final Segment<K,V>[] segments = this.segments;\n    int size;\n    boolean overflow; // true if size overflows 32 bits\n    long sum;         // sum of modCounts\n    long last = 0L;   // previous sum(å³ä¸ä¸æ¬¡å¾å°çcountç»æå¼)\n    int retries = -1; // first iteration isn\'t retry\n    try {\n        for (;;) {\n            // è¶è¿å°è¯æ¬¡æ°ï¼åå¯¹æ¯ä¸ª Segment å é\n            if (retries++ == RETRIES_BEFORE_LOCK) {\n                for (int j = 0; j < segments.length; ++j)\n                    ensureSegment(j).lock(); // force creation\n            }\n            sum = 0L;\n            size = 0;\n            overflow = false;\n            for (int j = 0; j < segments.length; ++j) {\n                Segment<K,V> seg = segmentAt(segments, j);\n                if (seg != null) {\n                    sum += seg.modCount;\n                    // ä¸é¢ä¸¤æ­¥æ¯ä½æº¢åºå¤æ­æä½\n                    int c = seg.count;\n                    if (c < 0 || (size += c) < 0)\n                        overflow = true;\n                }\n            }\n            // è¿ç»­ä¸¤æ¬¡å¾å°çç»æä¸è´ï¼åè®¤ä¸ºè¿ä¸ªç»ææ¯æ­£ç¡®ç\n            if (sum == last)\n                break;\n            last = sum;\n        }\n    } finally {\n        if (retries > RETRIES_BEFORE_LOCK) {\n            for (int j = 0; j < segments.length; ++j)\n                segmentAt(segments, j).unlock();\n        }\n    }\n    return overflow ? Integer.MAX_VALUE : size;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n\n\n\n# 3. JDK 1.8 çæ¹å¨\n\nJDK 1.7 ä½¿ç¨åæ®µéæºå¶æ¥å®ç°å¹¶åæ´æ°æä½ï¼æ ¸å¿ç±»ä¸º Segmentï¼å®ç»§æ¿èªéå¥é ReentrantLockï¼ å¹¶ååº¦ä¸ Segmentæ°éç¸ç­ã\n\nJDK 1.8 ä½¿ç¨äº CAS æä½æ¥æ¯ææ´é«çå¹¶ååº¦ï¼å¨ CAS æä½å¤±è´¥æ¶ä½¿ç¨åç½®é synchronizedã\n\nå¹¶ä¸ JDK 1.8 çå®ç°ä¹å¨é¾è¡¨è¿é¿æ¶ä¼è½¬æ¢ä¸ºçº¢é»æ ã\n\n\n# LinkedHashMap\n\n\n# å­å¨ç»æ\n\nç»§æ¿èª HashMapï¼å æ­¤å·æå HashMap ä¸æ ·çå¿«éæ¥æ¾ç¹æ§ã\n\npublic class LinkedHashMap<K,V> extends HashMap<K,V> implements Map<K,V>\n\n\n1\n\n\nåé¨ç»´æ¤äºä¸ä¸ªååé¾è¡¨ï¼ç¨æ¥ç»´æ¤æå¥é¡ºåºæè LRU é¡ºåºã\n\n/**\n * The head (eldest) of the doubly linked list.\n */\ntransient LinkedHashMap.Entry<K,V> head;\n\n/**\n * The tail (youngest) of the doubly linked list.\n */\ntransient LinkedHashMap.Entry<K,V> tail;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\naccessOrder å³å®äºé¡ºåºï¼é»è®¤ä¸º falseï¼æ­¤æ¶ç»´æ¤çæ¯æå¥é¡ºåºã\n\nfinal boolean accessOrder;\n\n\n1\n\n\nLinkedHashMap æéè¦çæ¯ä»¥ä¸ç¨äºç»´æ¤é¡ºåºçå½æ°ï¼å®ä»¬ä¼å¨ putãget ç­æ¹æ³ä¸­è°ç¨ã\n\nvoid afterNodeAccess(Node<K,V> p) { }\nvoid afterNodeInsertion(boolean evict) { }\n\n\n1\n2\n\n\n\n# afterNodeAccess()\n\nå½ä¸ä¸ªèç¹è¢«è®¿é®æ¶ï¼å¦æ accessOrder ä¸º trueï¼åä¼å°è¯¥èç¹ç§»å°é¾è¡¨å°¾é¨ãä¹å°±æ¯è¯´æå®ä¸º LRU é¡ºåºä¹åï¼å¨æ¯æ¬¡è®¿é®ä¸ä¸ªèç¹æ¶ï¼ä¼å°è¿ä¸ªèç¹ç§»å°é¾è¡¨å°¾é¨ï¼ä¿è¯é¾è¡¨å°¾é¨æ¯æè¿è®¿é®çèç¹ï¼é£ä¹é¾è¡¨é¦é¨å°±æ¯æè¿æä¹æªä½¿ç¨çèç¹ã\n\nvoid afterNodeAccess(Node<K,V> e) { // move node to last\n    LinkedHashMap.Entry<K,V> last;\n    // LRU && è®¿é®çåç´ éå°¾åç´ \n    if (accessOrder && (last = tail) != e) {\n        LinkedHashMap.Entry<K,V> p =\n            (LinkedHashMap.Entry<K,V>)e, b = p.before, a = p.after;\n        p.after = null;\n        if (b == null)\n            head = a;\n        else\n            b.after = a;\n        if (a != null)\n            a.before = b;\n        else\n            last = b;\n        if (last == null)\n            head = p;\n        else {\n            p.before = last;\n            last.after = p;\n        }\n        tail = p;\n        ++modCount;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\n\n\n\n# afterNodeInsertion()\n\nå¨ put ç­æä½ä¹åæ§è¡ï¼å½ removeEldestEntry() æ¹æ³è¿å true æ¶ä¼ç§»é¤ææçèç¹ï¼ä¹å°±æ¯é¾è¡¨é¦é¨èç¹ firstã\n\nevict åªæå¨æå»º Map çæ¶åæä¸º falseï¼å¨è¿éä¸º trueã\n\nvoid afterNodeInsertion(boolean evict) { // possibly remove eldest\n    LinkedHashMap.Entry<K,V> first;\n    // å¤´é¨èç¹ != null && removeEldestEntryæ¹æ³è¿åtrue\n    if (evict && (first = head) != null && removeEldestEntry(first)) {\n        K key = first.key;\n        removeNode(hash(key), key, null, false, true);\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nremoveEldestEntry() é»è®¤ä¸º falseï¼å¦æéè¦è®©å®ä¸º trueï¼éè¦ç»§æ¿ LinkedHashMap å¹¶ä¸è¦çè¿ä¸ªæ¹æ³çå®ç°ï¼è¿å¨å®ç° LRU çç¼å­ä¸­ç¹å«æç¨ï¼éè¿ç§»é¤æè¿æä¹æªä½¿ç¨çèç¹ï¼ä»èä¿è¯ç¼å­ç©ºé´è¶³å¤ï¼å¹¶ä¸ç¼å­çæ°æ®é½æ¯ç­ç¹æ°æ®ã\n\nprotected boolean removeEldestEntry(Map.Entry<K,V> eldest) {\n    return false;\n}\n\n\n1\n2\n3\n\n\n\n# LRU ç¼å­\n\nä»¥ä¸æ¯ä½¿ç¨ LinkedHashMap å®ç°çä¸ä¸ª LRU ç¼å­ï¼\n\nè®¾å®æå¤§ç¼å­ç©ºé´ MAX_ENTRIES ä¸º 3ï¼ ä½¿ç¨ LinkedHashMap çæé å½æ°å° accessOrder è®¾ç½®ä¸º trueï¼å¼å¯ LRU é¡ºåºï¼ è¦ç removeEldestEntry() æ¹æ³å®ç°ï¼å¨èç¹å¤äº MAX_ENTRIES å°±ä¼å°æè¿æä¹æªä½¿ç¨çæ°æ®ç§»é¤ã\n\nclass LRUCache<K, V> extends LinkedHashMap<K, V> {\n    private static final int MAX_ENTRIES = 3;\n\n    protected boolean removeEldestEntry(Map.Entry eldest) {\n        return size() > MAX_ENTRIES;\n    }\n\n    LRUCache() {\n        super(MAX_ENTRIES, 0.75f, true);\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\npublic static void main(String[] args) {\n    LRUCache<Integer, String> cache = new LRUCache<>();\n    cache.put(1, "a");\n    cache.put(2, "b");\n    cache.put(3, "c");\n    cache.get(1);\n    cache.put(4, "d");\n    System.out.println(cache.keySet());\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n[3, 1, 4]\n\n\n1\n\n\n\n# WeakHashMap\n\n\n# å­å¨ç»æ\n\nWeakHashMap ç Entry ç»§æ¿èª WeakReferenceï¼è¢« WeakReference å³èçå¯¹è±¡å¨ä¸ä¸æ¬¡åå¾åæ¶æ¶ä¼è¢«åæ¶ã\n\nWeakHashMap ä¸»è¦ç¨æ¥å®ç°ç¼å­ï¼éè¿ä½¿ç¨ WeakHashMap æ¥å¼ç¨ç¼å­å¯¹è±¡ï¼ç± JVM å¯¹è¿é¨åç¼å­è¿è¡åæ¶ã\n\nprivate static class Entry<K,V> extends WeakReference<Object> implements Map.Entry<K,V>\n\n\n1\n\n\n\n# ConcurrentCache\n\nTomcat ä¸­ç ConcurrentCache ä½¿ç¨äº WeakHashMap æ¥å®ç°ç¼å­åè½ã\n\nConcurrentCache éåçæ¯åä»£ç¼å­ï¼\n\n * ç»å¸¸ä½¿ç¨çå¯¹è±¡æ¾å¥ eden ä¸­ï¼eden ä½¿ç¨ ConcurrentHashMap å®ç°ï¼ä¸ç¨æå¿ä¼è¢«åæ¶ï¼ä¼ç¸å­ï¼ï¼\n * ä¸å¸¸ç¨çå¯¹è±¡æ¾å¥ longtermï¼longterm ä½¿ç¨ WeakHashMap å®ç°ï¼è¿äºèå¯¹è±¡ä¼è¢«åå¾æ¶éå¨åæ¶ã\n * å½è°ç¨ get() æ¹æ³æ¶ï¼ä¼åä» eden åºè·åï¼å¦ææ²¡ææ¾å°çè¯åå° longterm è·åï¼å½ä» longterm è·åå°å°±æå¯¹è±¡æ¾å¥ eden ä¸­ï¼ä»èä¿è¯ç»å¸¸è¢«è®¿é®çèç¹ä¸å®¹æè¢«åæ¶ã\n * å½è°ç¨ put() æ¹æ³æ¶ï¼å¦æ eden çå¤§å°è¶è¿äº sizeï¼é£ä¹å°±å° eden ä¸­çææå¯¹è±¡é½æ¾å¥ longterm ä¸­ï¼å©ç¨èææºåæ¶æä¸é¨åä¸ç»å¸¸ä½¿ç¨çå¯¹è±¡ã\n\npublic final class ConcurrentCache<K, V> {\n\n    private final int size;\n\n    private final Map<K, V> eden;\n\n    private final Map<K, V> longterm;\n\n    public ConcurrentCache(int size) {\n        this.size = size;\n        this.eden = new ConcurrentHashMap<>(size);\n        this.longterm = new WeakHashMap<>(size);\n    }\n\n    public V get(K k) {\n        V v = this.eden.get(k);\n        if (v == null) {\n            v = this.longterm.get(k);\n            if (v != null)\n                this.eden.put(k, v);\n        }\n        return v;\n    }\n\n    public void put(K k, V v) {\n        if (this.eden.size() >= size) {\n            this.longterm.putAll(this.eden);\n            this.eden.clear();\n        }\n        this.eden.put(k, v);\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n\n\n----------------------------------------\n\nåèï¼\n\n * æ¼«ç»ï¼ä»ä¹æ¯HashMapï¼\n\nå³é®ç¹\n\n * ä¸ºä»ä¹éç¨å¤´ææ³ï¼\n\n> HashMapçåæèè®¤ä¸ºï¼åæå¥çEntryè¢«æ¥æ¾çå¯è½æ§æ´å¤§ã\n\n * HashMapçé»è®¤åå§é¿åº¦æ¯16ï¼å¹¶ä¸æ¯æ¬¡èªå¨æ©å±ææå¨åå§åæ¶ï¼é¿åº¦å¿é¡»æ¯2çå¹ï¼ä¸ºä»ä¹ï¼\n\n> ä¹æä»¥éæ©16ï¼æ¯ä¸ºäºå¯ä»¥å°æ±æ¨¡è¿ç®è½¬æ¢æä½äºè¿ç®ï¼æé«hashæç\n\n\n# åæ¨¡è¿ç®å¯ä»¥è½¬æ¢æä½äºè¿ç®åé¨åçåæ:\n\nåè®¾ä¸ä¸ªkeyçhashcodeä¸º56ï¼tableå®¹éä¸º16ï¼æ­£å¸¸åæ¨¡åä½æ°ä¸º8ï¼å³æ¾å°ç´¢å¼ä¸º8çæ¡¶ä¸­ã\n\nå¦æéç¨ä½äºè¿ç®ï¼hashcode & ( length - 1 )\n\n56 äºè¿å¶ä¸ºï¼111000\n\n16 - 1 äºè¿å¶ä¸ºï¼1111\n\n  111000\n& 001111\n--------\n  001000\n\n\n1\n2\n3\n4\n\n\nç»æä¹æ¯8\n\nä½äºè¿ç®å¯ä»¥ä¿è¯åååå¸çåå æ¯ï¼ä¸ä¸ªkeyçhashcode å 16 -1 = 15 è¿è¡ä½ä¸è¿ç®ï¼å ä¸º15çååä½é½æ¯1ï¼1åè°ä¸ç»æå°±æ¯è°ï¼åé¢ä½æ°å¨æ¯0ï¼0åè°ä¸ç»æé½æ¯0ï¼æä»¥è®¡ç®åçç»æå°±æ¯hashcodeçååä½ä¸å°äºç­äº15ï¼èæækeyçhashcodeé½æ¯éæºçï¼ååä½ä¹æ¯éæºçï¼æ´ä½éæºï¼å±é¨ä¹éæºï¼ï¼å¯ä»¥ä¿è¯ç»æä¸ºéæºåååå¸ã',normalizedContent:'# ä¸ãæ¦è§\n\nå®¹å¨ä¸»è¦åæ¬ collection å map ä¸¤ç§ï¼collection å­å¨çå¯¹è±¡çéåï¼è map å­å¨çé®å¼å¯¹ï¼ä¸¤ä¸ªå¯¹è±¡ï¼çæ å°è¡¨ã\n\n\n# collection\n\n\n\n\n# 1. set\n\ntreesetï¼åºäºçº¢é»æ å®ç°ï¼æ¯ææåºæ§æä½ï¼ä¾å¦æ ¹æ®ä¸ä¸ªèå´æ¥æ¾åç´ çæä½ãä½æ¯æ¥æ¾æçä¸å¦ hashsetï¼hashset æ¥æ¾çæ¶é´å¤æåº¦ä¸º o(1)ï¼treeset åä¸º o(logn)ã\n\nhashsetï¼åºäºåå¸è¡¨å®ç°ï¼æ¯æå¿«éæ¥æ¾ï¼ä½ä¸æ¯ææåºæ§æä½ãå¹¶ä¸å¤±å»äºåç´ çæå¥é¡ºåºä¿¡æ¯ï¼ä¹å°±æ¯è¯´ä½¿ç¨ iterator éå hashset å¾å°çç»ææ¯ä¸ç¡®å®çã\n\nlinkedhashsetï¼å·æ hashset çæ¥æ¾æçï¼ä¸åé¨ä½¿ç¨ååé¾è¡¨ç»´æ¤åç´ çæå¥é¡ºåºã\n\n\n# 2. list\n\narraylistï¼åºäºå¨ææ°ç»å®ç°ï¼æ¯æéæºè®¿é®ã\n\nvectorï¼å arraylist ç±»ä¼¼ï¼ä½å®æ¯çº¿ç¨å®å¨çã\n\nlinkedlistï¼åºäºååé¾è¡¨å®ç°ï¼åªè½é¡ºåºè®¿é®ï¼ä½æ¯å¯ä»¥å¿«éå°å¨é¾è¡¨ä¸­é´æå¥åå é¤åç´ ãä¸ä»å¦æ­¤ï¼linkedlist è¿å¯ä»¥ç¨ä½æ ãéååååéåã\n\n\n# 3. queue\n\nlinkedlistï¼å¯ä»¥ç¨å®æ¥å®ç°ååéåã\n\npriorityqueueï¼åºäºå ç»æå®ç°ï¼å¯ä»¥ç¨å®æ¥å®ç°ä¼åéåã\n\n\n# map\n\n\n\n * treemapï¼åºäºçº¢é»æ å®ç°ã\n\n * hashmapï¼åºäºåå¸è¡¨å®ç°ã\n\n * hashtableï¼å hashmap ç±»ä¼¼ï¼ä½å®æ¯çº¿ç¨å®å¨çï¼è¿æå³çåä¸æ¶å»å¤ä¸ªçº¿ç¨å¯ä»¥åæ¶åå¥ hashtable å¹¶ä¸ä¸ä¼å¯¼è´æ°æ®ä¸ä¸è´ãå®æ¯éçç±»ï¼ä¸åºè¯¥å»ä½¿ç¨å®ãç°å¨å¯ä»¥ä½¿ç¨ concurrenthashmap æ¥æ¯æçº¿ç¨å®å¨ï¼å¹¶ä¸ concurrenthashmap çæçä¼æ´é«ï¼å ä¸º concurrenthashmap å¼å¥äºåæ®µéã\n\n * linkedhashmapï¼ä½¿ç¨ååé¾è¡¨æ¥ç»´æ¤åç´ çé¡ºåºï¼é¡ºåºä¸ºæå¥é¡ºåºæèæè¿æå°ä½¿ç¨ï¼lruï¼é¡ºåºã\n\n\n# äºãå®¹å¨ä¸­çè®¾è®¡æ¨¡å¼\n\n\n# è¿­ä»£å¨æ¨¡å¼\n\n\n\ncollection ç»§æ¿äº iterable æ¥å£ï¼å¶ä¸­ç iterator() æ¹æ³è½å¤äº§çä¸ä¸ª iterator å¯¹è±¡ï¼éè¿è¿ä¸ªå¯¹è±¡å°±å¯ä»¥è¿­ä»£éå collection ä¸­çåç´ ã\n\nä» jdk 1.5 ä¹åå¯ä»¥ä½¿ç¨ foreach æ¹æ³æ¥éåå®ç°äº iterable æ¥å£çèåå¯¹è±¡ã\n\nlist<string> list = new arraylist<>();\nlist.add("a");\nlist.add("b");\nfor (string item : list) {\n    system.out.println(item);\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# ééå¨æ¨¡å¼\n\njava.util.arrays#aslist() å¯ä»¥ææ°ç»ç±»åè½¬æ¢ä¸º list ç±»åã\n\n@safevarargs\npublic static <t> list<t> aslist(t... a)\n\n\n1\n2\n\n\nåºè¯¥æ³¨æçæ¯ aslist() çåæ°ä¸ºæ³åçåé¿åæ°ï¼ä¸è½ä½¿ç¨åºæ¬ç±»åæ°ç»ä½ä¸ºåæ°ï¼åªè½ä½¿ç¨ç¸åºçåè£ç±»åæ°ç»ã\n\ninteger[] arr = {1, 2, 3};\nlist list = arrays.aslist(arr);\n\n\n1\n2\n\n\nä¹å¯ä»¥ä½¿ç¨ä»¥ä¸æ¹å¼è°ç¨ aslist()ï¼\n\nlist list = arrays.aslist(1, 2, 3);\n\n\n1\n\n\n\n# ä¸ãæºç åæ\n\nå¦ææ²¡æç¹å«è¯´æï¼ä»¥ä¸æºç åæåºäº jdk 1.8ã\n\nå¨ idea ä¸­ double shift è°åº search everywhereï¼æ¥æ¾æºç æä»¶ï¼æ¾å°ä¹åå°±å¯ä»¥éè¯»æºç ã\n\n\n# arraylist\n\n\n# 1. æ¦è§\n\nå ä¸º arraylist æ¯åºäºæ°ç»å®ç°çï¼æä»¥æ¯æå¿«ééæºè®¿é®ãrandomaccess æ¥å£æ è¯çè¯¥ç±»æ¯æå¿«ééæºè®¿é®ã\n\npublic class arraylist<e> extends abstractlist<e>\n        implements list<e>, randomaccess, cloneable, java.io.serializable\n\n\n1\n2\n\n\næ°ç»çé»è®¤å¤§å°ä¸º 10ã\n\nprivate static final int default_capacity = 10;\n\n\n1\n\n\n\n\n\n# 2. æ©å®¹\n\næ·»å åç´ æ¶ä½¿ç¨ ensurecapacityinternal() æ¹æ³æ¥ä¿è¯å®¹éè¶³å¤ï¼å¦æä¸å¤æ¶ï¼éè¦ä½¿ç¨ grow() æ¹æ³è¿è¡æ©å®¹ï¼æ°å®¹éçå¤§å°ä¸º oldcapacity + (oldcapacity >> 1)ï¼ä¹å°±æ¯æ§å®¹éç 1.5 åã\n\næ©å®¹æä½éè¦è°ç¨ arrays.copyof() æåæ°ç»æ´ä¸ªå¤å¶å°æ°æ°ç»ä¸­ï¼è¿ä¸ªæä½ä»£ä»·å¾é«ï¼å æ­¤æå¥½å¨åå»º arraylist å¯¹è±¡æ¶å°±æå®å¤§æ¦çå®¹éå¤§å°ï¼åå°æ©å®¹æä½çæ¬¡æ°ã\n\npublic boolean add(e e) {\n    // size ä¸ºæ°ç»ä¸­å½ååç´ æ°é\n    ensurecapacityinternal(size + 1); \n    elementdata[size++] = e;\n    return true;\n}\nprivate void ensurecapacityinternal(int mincapacity) {\n    if (elementdata == defaultcapacity_empty_elementdata) {\n        mincapacity = math.max(default_capacity, mincapacity);\n    }\n    ensureexplicitcapacity(mincapacity);\n}\nprivate void ensureexplicitcapacity(int mincapacity) {\n    modcount++; // increments modcount!!\n    // overflow-conscious code ï¼éå¯¹æº¢åºè¿è¡èèçä»£ç ï¼\n    // å¦ææ¬æ¬¡æ·»å åç´ éè¦çæå°æ°ç»å®¹éæ¯å½åæ°ç»å®¹éå¤§ï¼åéè¦è¿è¡æ©å®¹æä½ã\n    if (mincapacity - elementdata.length > 0)\n        grow(mincapacity);\n}\nprivate void grow(int mincapacity) {\n    // overflow-conscious codeï¼éå¯¹æº¢åºè¿è¡èèçä»£ç ï¼\n    int oldcapacity = elementdata.length;\n    int newcapacity = oldcapacity + (oldcapacity >> 1);\n    if (newcapacity - mincapacity < 0)\n        newcapacity = mincapacity;\n    if (newcapacity - max_array_size > 0)\n        newcapacity = hugecapacity(mincapacity);\n    // mincapacity is usually close to size, so this is a win:\n    // æå½åæ°ç»åç´ å¤å¶å°æ©å®¹åçæ°æ°ç»ä¸­\n    elementdata = arrays.copyof(elementdata, newcapacity);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n\n\n\n# 3. å é¤åç´ \n\néè¦è°ç¨ system.arraycopy() å° index+1 åé¢çåç´ é½å¤å¶å° index ä½ç½®ä¸ï¼è¯¥æä½çæ¶é´å¤æåº¦ä¸º o(n)ï¼å¯ä»¥çåº arraylist å é¤åç´ çä»£ä»·æ¯éå¸¸é«çã\n\npublic e remove(int index) {\n    rangecheck(index);\n    modcount++;\n    e oldvalue = elementdata(index);\n    int nummoved = size - index - 1;\n    if (nummoved > 0)\n        system.arraycopy(elementdata, index+1, elementdata, index, nummoved);\n    elementdata[--size] = null; // clear to let gc do its work\n    return oldvalue;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# 4. fail-fast\n\nmodcount ç¨æ¥è®°å½ arraylist ç»æåçååçæ¬¡æ°ãç»æåçååæ¯ææ·»å æèå é¤è³å°ä¸ä¸ªåç´ çæææä½ï¼æèæ¯è°æ´åé¨æ°ç»çå¤§å°ï¼ä»ä»åªæ¯è®¾ç½®åç´ çå¼ä¸ç®ç»æåçååã\n\nå¨è¿è¡åºååæèè¿­ä»£ç­æä½æ¶ï¼éè¦æ¯è¾æä½åå modcount æ¯å¦æ¹åï¼å¦ææ¹åäºéè¦æåº concurrentmodificationexceptionã\n\nprivate void writeobject(java.io.objectoutputstream s)\n    throws java.io.ioexception{\n    // æä½å¼å§ä¹ååä¿å­åå§modcountï¼æä½ç»æåå¤æ­modcountæ¯å¦æ¹å\n    int expectedmodcount = modcount;\n    // write out element count, and any hidden stuff\n    s.defaultwriteobject();\n\n    // write out size as capacity for behavioural compatibility with clone()\n    // åå¥æ°ç»åç´ æ°éä½ä¸ºæ°ç»å®¹é\n    s.writeint(size);\n\n    // write out all elements in the proper order.\n    // åªåºååæå¼çæ°ç»åç´ \n    for (int i=0; i<size; i++) {\n        s.writeobject(elementdata[i]);\n    }\n\n    if (modcount != expectedmodcount) {\n        throw new concurrentmodificationexception();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n\n# 5. åºåå\n\narraylist åºäºæ°ç»å®ç°ï¼å¹¶ä¸å·æå¨ææ©å®¹ç¹æ§ï¼å æ­¤ä¿å­åç´ çæ°ç»ä¸ä¸å®é½ä¼è¢«ä½¿ç¨ï¼é£ä¹å°±æ²¡å¿è¦å¨é¨è¿è¡åºååã\n\nä¿å­åç´ çæ°ç» elementdata ä½¿ç¨ transient ä¿®é¥°ï¼è¯¥å³é®å­å£°ææ°ç»é»è®¤ä¸ä¼è¢«åºååã\n\ntransient object[] elementdata; // non-private to simplify nested class access\n\n\n1\n\n\narraylist å®ç°äº writeobject() å readobject() æ¥æ§å¶åªåºååæ°ç»ä¸­æåç´ å¡«åé£é¨ååå®¹ã\n\nprivate void readobject(java.io.objectinputstream s)\n    throws java.io.ioexception, classnotfoundexception {\n    elementdata = empty_elementdata;\n\n    // read in size, and any hidden stuff\n    s.defaultreadobject();\n\n    // read in capacity\n    s.readint(); // ignored\n\n    if (size > 0) {\n        // be like clone(), allocate array based upon size not capacity\n        ensurecapacityinternal(size);\n\n        object[] a = elementdata;\n        // read in all elements in the proper order.\n        for (int i=0; i<size; i++) {\n            a[i] = s.readobject();\n        }\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nprivate void writeobject(java.io.objectoutputstream s)    throws java.io.ioexception{    // write out element count, and any hidden stuff    int expectedmodcount = modcount;    s.defaultwriteobject();    // write out size as capacity for behavioural compatibility with clone()    s.writeint(size);    // write out all elements in the proper order.    for (int i=0; i<size; i++) {        s.writeobject(elementdata[i]);    }    if (modcount != expectedmodcount) {        throw new concurrentmodificationexception();    }}\n\n\n1\n\n\nåºååæ¶éè¦ä½¿ç¨ objectoutputstream ç writeobject() å°å¯¹è±¡è½¬æ¢ä¸ºå­èæµå¹¶è¾åºãè writeobject() æ¹æ³å¨ä¼ å¥çå¯¹è±¡å­å¨ writeobject() çæ¶åä¼å»åå°è°ç¨è¯¥å¯¹è±¡ç writeobject() æ¥å®ç°åºååãååºååä½¿ç¨çæ¯ objectinputstream ç readobject() æ¹æ³ï¼åçç±»ä¼¼ã\n\narraylist list = new arraylist();\nobjectoutputstream oos = new objectoutputstream(new fileoutputstream(file));\noos.writeobject(list);\n\n\n1\n2\n3\n\n\n\n# vector\n\n\n# 1. åæ­¥\n\nå®çå®ç°ä¸ arraylist ç±»ä¼¼ï¼ä½æ¯ä½¿ç¨äº synchronized è¿è¡åæ­¥ã\n\npublic synchronized boolean add(e e) {\n    modcount++;\n    ensurecapacityhelper(elementcount + 1);\n    elementdata[elementcount++] = e;\n    return true;\n}\n\npublic synchronized e get(int index) {\n    if (index >= elementcount)\n        throw new arrayindexoutofboundsexception(index);\n\n    return elementdata(index);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# 2. ä¸ arraylist çæ¯è¾\n\nvector æ¯åæ­¥çï¼å æ­¤å¼éå°±æ¯ arraylist è¦å¤§ï¼è®¿é®éåº¦æ´æ¢ãæå¥½ä½¿ç¨ arraylist èä¸æ¯ vectorï¼å ä¸ºåæ­¥æä½å®å¨å¯ä»¥ç±ç¨åºåèªå·±æ¥æ§å¶ï¼ vector æ¯æ¬¡æ©å®¹è¯·æ±å¶å¤§å°ç 2 åç©ºé´ï¼è arraylist æ¯ 1.5 åã\n\n\n# 3. æ¿ä»£æ¹æ¡\n\nå¯ä»¥ä½¿ç¨ collections.synchronizedlist(); å¾å°ä¸ä¸ªçº¿ç¨å®å¨ç arraylistã\n\nlist<string> list = new arraylist<>();list<string> synlist = collections.synchronizedlist(list);\n\n\n1\n\n\nä¹å¯ä»¥ä½¿ç¨ concurrent å¹¶ååä¸ç copyonwritearraylist ç±»ã\n\nlist<string> list = new copyonwritearraylist<>();\n\n\n1\n\n\n\n# copyonwritearraylist\n\n\n# è¯»ååç¦»\n\nåæä½å¨ä¸ä¸ªå¤å¶çæ°ç»ä¸è¿è¡ï¼è¯»æä½è¿æ¯å¨åå§æ°ç»ä¸­è¿è¡ï¼è¯»ååç¦»ï¼äºä¸å½±åã\n\nåæä½éè¦å éï¼é²æ­¢å¹¶ååå¥æ¶å¯¼è´åå¥æ°æ®ä¸¢å¤±ã\n\nåæä½ç»æä¹åéè¦æåå§æ°ç»æåæ°çå¤å¶æ°ç»ã\n\npublic boolean add(e e) {\n    final reentrantlock lock = this.lock;\n    lock.lock();\n    try {\n        // å¾å°åæ°ç»\n        object[] elements = getarray();\n        // å¾å°åæ°ç»é¿åº¦\n        int len = elements.length;\n        // æåæ°ç»åç´ å¤å¶å°ä¸ä¸ªæ°æ°ç»ä¸­ï¼é¿åº¦å ä¸\n        object[] newelements = arrays.copyof(elements, len + 1);\n        newelements[len] = e;\n        setarray(newelements);\n        return true;\n    } finally {\n        lock.unlock();\n    }\n}\n\nfinal void setarray(object[] a) {\n    // æ°æ°ç»èµå¼ç»æ°ç»åé\n    array = a;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\n@suppresswarnings("unchecked")\nprivate e get(object[] a, int index) {\n    return (e) a[index];\n}\n\n\n1\n2\n3\n4\n\n\n\n# éç¨åºæ¯\n\ncopyonwritearraylist å¨åæä½çåæ¶åè®¸è¯»æä½ï¼å¤§å¤§æé«äºè¯»æä½çæ§è½ï¼å æ­¤å¾éåè¯»å¤åå°çåºç¨åºæ¯ã\n\nä½æ¯ copyonwritearraylist æå¶ç¼ºé·ï¼\n\n * åå­å ç¨ï¼å¨åæä½æ¶éè¦å¤å¶ä¸ä¸ªæ°çæ°ç»ï¼ä½¿å¾åå­å ç¨ä¸ºåæ¥çä¸¤åå·¦å³ï¼\n * æ°æ®ä¸ä¸è´ï¼è¯»æä½ä¸è½è¯»åå®æ¶æ§çæ°æ®ï¼å ä¸ºé¨ååæä½çæ°æ®è¿æªåæ­¥å°è¯»æ°ç»ä¸­ã æä»¥ copyonwritearraylist ä¸éååå­ææä»¥åå¯¹å®æ¶æ§è¦æ±å¾é«çåºæ¯ã\n\n\n# linkedlist\n\n\n# 1. æ¦è§\n\nåºäºååé¾è¡¨å®ç°ï¼ä½¿ç¨ node å­å¨é¾è¡¨èç¹ä¿¡æ¯ã\n\nprivate static class node<e> {    e item;    node<e> next;    node<e> prev;}\n\n\n1\n\n\næ¯ä¸ªé¾è¡¨å­å¨äº first å last æéï¼\n\ntransient node<e> first;transient node<e> last;\n\n\n1\n\n\n\n\n\n# 2. ä¸ arraylist çæ¯è¾\n\n * arraylist åºäºå¨ææ°ç»å®ç°ï¼linkedlist åºäºååé¾è¡¨å®ç°ï¼\n * arraylist æ¯æéæºè®¿é®ï¼linkedlist ä¸æ¯æï¼\n * linkedlist å¨ä»»æä½ç½®æ·»å å é¤åç´ æ´å¿«ã\n\n\n# hashmap\n\nä¸ºäºä¾¿äºçè§£ï¼ä»¥ä¸æºç åæä»¥ jdk 1.7 ä¸ºä¸»ã\n\n\n# 1. å­å¨ç»æ\n\nåé¨åå«äºä¸ä¸ª entry ç±»åçæ°ç» tableã\n\ntransient entry[] table;\n\n\n1\n\n\nentry å­å¨çé®å¼å¯¹ãå®åå«äºåä¸ªå­æ®µï¼ä» next å­æ®µæä»¬å¯ä»¥çåº entry æ¯ä¸ä¸ªé¾è¡¨ãå³æ°ç»ä¸­çæ¯ä¸ªä½ç½®è¢«å½æä¸ä¸ªæ¡¶ï¼ä¸ä¸ªæ¡¶å­æ¾ä¸ä¸ªé¾è¡¨ãhashmap ä½¿ç¨æé¾æ³æ¥è§£å³å²çªï¼åä¸ä¸ªé¾è¡¨ä¸­å­æ¾åå¸å¼åæ£åæ¡¶åæ¨¡è¿ç®ç»æç¸åç entryã\n\n\n\nstatic class entry<k,v> implements map.entry<k,v> {\n    final k key;\n    v value;\n    entry<k,v> next;\n    int hash;\n\n    entry(int h, k k, v v, entry<k,v> n) {\n        value = v;\n        next = n;\n        key = k;\n        hash = h;\n    }\n\n    public final k getkey() {\n        return key;\n    }\n\n    public final v getvalue() {\n        return value;\n    }\n\n    public final v setvalue(v newvalue) {\n        v oldvalue = value;\n        value = newvalue;\n        return oldvalue;\n    }\n\n    public final boolean equals(object o) {\n        if (!(o instanceof map.entry))\n            return false;\n        map.entry e = (map.entry)o;\n        object k1 = getkey();\n        object k2 = e.getkey();\n        if (k1 == k2 || (k1 != null && k1.equals(k2))) {\n            object v1 = getvalue();\n            object v2 = e.getvalue();\n            if (v1 == v2 || (v1 != null && v1.equals(v2)))\n                return true;\n        }\n        return false;\n    }\n\n    public final int hashcode() {\n        return objects.hashcode(getkey()) ^ objects.hashcode(getvalue());\n    }\n\n    public final string tostring() {\n        return getkey() + "=" + getvalue();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n\n\n\n# 2. æé¾æ³çå·¥ä½åç\n\nhashmap<string, string> map = new hashmap<>();\nmap.put("k1", "v1");\nmap.put("k2", "v2");\nmap.put("k3", "v3");\n\n\n1\n2\n3\n4\n\n\næ°å»ºä¸ä¸ª hashmapï¼é»è®¤å¤§å°ä¸º 16ï¼\n\n * æå¥ <k1,v1> é®å¼å¯¹ï¼åè®¡ç® k1 ç hashcode ä¸º 115ï¼ä½¿ç¨é¤çä½æ°æ³å¾å°æå¨çæ¡¶ä¸æ  115%16=3ã\n * æå¥ <k2,v2> é®å¼å¯¹ï¼åè®¡ç® k2 ç hashcode ä¸º 118ï¼ä½¿ç¨é¤çä½æ°æ³å¾å°æå¨çæ¡¶ä¸æ  118%16=6ã\n * æå¥ <k3,v3> é®å¼å¯¹ï¼åè®¡ç® k3 ç hashcode ä¸º 118ï¼ä½¿ç¨é¤çä½æ°æ³å¾å°æå¨çæ¡¶ä¸æ  118%16=6ï¼æå¨ <k2,v2> åé¢ã åºè¯¥æ³¨æå°é¾è¡¨çæå¥æ¯ä»¥å¤´ææ³æ¹å¼è¿è¡çï¼ä¾å¦ä¸é¢ç <k3,v3> ä¸æ¯æå¨ <k2,v2> åé¢ï¼èæ¯æå¥å¨é¾è¡¨å¤´é¨ã\n\næ¥æ¾éè¦åæä¸¤æ­¥è¿è¡ï¼\n\n * è®¡ç®é®å¼å¯¹æå¨çæ¡¶ï¼\n * å¨é¾è¡¨ä¸é¡ºåºæ¥æ¾ï¼æ¶é´å¤æåº¦æ¾ç¶åé¾è¡¨çé¿åº¦ææ­£æ¯ã\n\n\n\n\n# 3. put æä½\n\npublic v put(k key, v value) {\n    if (table == empty_table) {\n        inflatetable(threshold);\n    }\n    // é®ä¸º null åç¬å¤ç\n    if (key == null)\n        return putfornullkey(value);\n    int hash = hash(key);\n    // ç¡®å®æ¡¶ä¸æ \n    int i = indexfor(hash, table.length);\n    // åæ¾åºæ¯å¦å·²ç»å­å¨é®ä¸º key çé®å¼å¯¹ï¼å¦æå­å¨çè¯å°±æ´æ°è¿ä¸ªé®å¼å¯¹çå¼ä¸º value\n    for (entry<k,v> e = table[i]; e != null; e = e.next) {\n        object k;\n        if (e.hash == hash && ((k = e.key) == key || key.equals(k))) {\n            v oldvalue = e.value;\n            e.value = value;\n            e.recordaccess(this);\n            return oldvalue;\n        }\n    }\n\n    modcount++;\n    // æå¥æ°é®å¼å¯¹\n    addentry(hash, key, value, i);\n    return null;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nhashmap åè®¸æå¥é®ä¸º null çé®å¼å¯¹ãä½æ¯å ä¸ºæ æ³è°ç¨ null ç hashcode() æ¹æ³ï¼ä¹å°±æ æ³ç¡®å®è¯¥é®å¼å¯¹çæ¡¶ä¸æ ï¼åªè½éè¿å¼ºå¶æå®ä¸ä¸ªæ¡¶ä¸æ æ¥å­æ¾ãhashmap ä½¿ç¨ç¬¬ 0 ä¸ªæ¡¶å­æ¾é®ä¸º null çé®å¼å¯¹ã\n\nprivate v putfornullkey(v value) {    for (entry<k,v> e = table[0]; e != null; e = e.next) {        if (e.key == null) {            v oldvalue = e.value;            e.value = value;            e.recordaccess(this);            return oldvalue;        }    }    modcount++;    addentry(0, null, value, 0);    return null;}\n\n\n1\n\n\nä½¿ç¨é¾è¡¨çå¤´ææ³ï¼ä¹å°±æ¯æ°çé®å¼å¯¹æå¨é¾è¡¨çå¤´é¨ï¼èä¸æ¯é¾è¡¨çå°¾é¨ã\n\nvoid addentry(int hash, k key, v value, int bucketindex) {    // é®å¼å¯¹æ°éè¶è¿ä¸´çå¼å¹¶ä¸hashå°çæ¡¶ä½ç½®å·²ç»æåç´ å­æ¾æ¶ï¼è¿è¡æ©å®¹æä½ã    if ((size >= threshold) && (null != table[bucketindex])) {        resize(2 * table.length);        // è®¡ç®hashå¼        hash = (null != key) ? hash(key) : 0;        // è®¡ç®æ¡¶ä½ç½®        bucketindex = indexfor(hash, table.length);    }    createentry(hash, key, value, bucketindex);}void createentry(int hash, k key, v value, int bucketindex) {    // å¾å°ç®æ æ¡¶ä½ç½®é¾è¡¨å¤´åç´     entry<k,v> e = table[bucketindex];    // å¤´ææ³ä½ç°    table[bucketindex] = new entry<>(hash, key, value, e);    size++;}\n\n\n1\n\n\nentry(int h, k k, v v, entry<k,v> n) {    value = v;    next = n;    key = k;    hash = h;}\n\n\n1\n\n\n\n# 4. ç¡®å®æ¡¶ä¸æ \n\nå¾å¤æä½é½éè¦åç¡®å®ä¸ä¸ªé®å¼å¯¹æå¨çæ¡¶ä¸æ ã\n\nint hash = hash(key);\nint i = indexfor(hash, table.length);\n\n\n1\n2\n\n\n# 4.1 è®¡ç® hash å¼\n\nfinal int hash(object k) {\n    int h = hashseed;\n    if (0 != h && k instanceof string) {\n        return sun.misc.hashing.stringhash32((string) k);\n    }\n\n    h ^= k.hashcode();\n\n    // this function ensures that hashcodes that differ only by\n    // constant multiples at each bit position have a bounded\n    // number of collisions (approximately 8 at default load factor).\n    h ^= (h >>> 20) ^ (h >>> 12);\n    return h ^ (h >>> 7) ^ (h >>> 4);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\npublic final int hashcode() {\n    return objects.hashcode(key) ^ objects.hashcode(value);\n}\n\n\n1\n2\n3\n\n\n# 4.2 åæ¨¡\n\nä»¤ x = 1<<4ï¼å³ x ä¸º 2 ç 4 æ¬¡æ¹ï¼å®å·æä»¥ä¸æ§è´¨ï¼\n\nx   : 00010000\nx-1 : 00001111\n\n\n1\n2\n\n\nä»¤ä¸ä¸ªæ° y ä¸ x-1 åä¸è¿ç®ï¼å¯ä»¥å»é¤ y ä½çº§è¡¨ç¤ºçç¬¬ 4 ä½ä»¥ä¸æ°ï¼\n\ny       : 10110010\nx-1     : 00001111\ny&(x-1) : 00000010\n\n\n1\n2\n3\n\n\nè¿ä¸ªæ§è´¨å y å¯¹ x åæ¨¡æææ¯ä¸æ ·çï¼\n\ny   : 10110010\nx   : 00010000\ny%x : 00000010\n\n\n1\n2\n3\n\n\næä»¬ç¥éï¼ä½è¿ç®çä»£ä»·æ¯æ±æ¨¡è¿ç®å°çå¤ï¼å æ­¤å¨è¿è¡è¿ç§è®¡ç®æ¶ç¨ä½è¿ç®çè¯è½å¸¦æ¥æ´é«çæ§è½ã\n\nç¡®å®æ¡¶ä¸æ çæåä¸æ­¥æ¯å° key ç hash å¼å¯¹æ¡¶ä¸ªæ°åæ¨¡ï¼hash%capacityï¼å¦æè½ä¿è¯ capacity ä¸º 2 ç n æ¬¡æ¹ï¼é£ä¹å°±å¯ä»¥å°è¿ä¸ªæä½è½¬æ¢ä¸ºä½è¿ç®ã\n\nstatic int indexfor(int h, int length) {\n    return h & (length-1);\n}\n\n\n1\n2\n3\n\n\n\n# 5. æ©å®¹-åºæ¬åç\n\nè®¾ hashmap ç table é¿åº¦ä¸º mï¼éè¦å­å¨çé®å¼å¯¹æ°éä¸º nï¼å¦æåå¸å½æ°æ»¡è¶³ååæ§çè¦æ±ï¼é£ä¹æ¯æ¡é¾è¡¨çé¿åº¦å¤§çº¦ä¸º n/mï¼å æ­¤å¹³åæ¥æ¾æ¬¡æ°çå¤æåº¦ä¸º o(n/m)ã\n\nä¸ºäºè®©æ¥æ¾çææ¬éä½ï¼åºè¯¥å°½å¯è½ä½¿å¾ n/m å°½å¯è½å°ï¼å æ­¤éè¦ä¿è¯ m å°½å¯è½å¤§ï¼ä¹å°±æ¯è¯´ table è¦å°½å¯è½å¤§ãhashmap éç¨å¨ææ©å®¹æ¥æ ¹æ®å½åç n å¼æ¥è°æ´ m å¼ï¼ä½¿å¾ç©ºé´æçåæ¶é´æçé½è½å¾å°ä¿è¯ã\n\nåæ©å®¹ç¸å³çåæ°ä¸»è¦æï¼capacityãsizeãthreshold å load_factorã\n\nåæ°           å«ä¹\ncapacity     table çå®¹éå¤§å°ï¼é»è®¤ä¸º 16ãéè¦æ³¨æçæ¯ capacity å¿é¡»ä¿è¯ä¸º 2 ç n æ¬¡æ¹ã\nsize         é®å¼å¯¹æ°éã\nthreshold    size çä¸´çå¼ï¼å½ size å¤§äºç­äº threshold å°±å¿é¡»è¿è¡æ©å®¹æä½ã\nloadfactor   è£è½½å å­ï¼table è½å¤ä½¿ç¨çæ¯ä¾ï¼threshold = capacity * loadfactorã\n\nstatic final int default_initial_capacity = 16;static final int maximum_capacity = 1 << 30;static final float default_load_factor = 0.75f;transient entry[] table;transient int size;int threshold;final float loadfactor;transient int modcount;\n\n\n1\n\n\nä»ä¸é¢çæ·»å åç´ ä»£ç ä¸­å¯ä»¥çåºï¼å½éè¦æ©å®¹æ¶ï¼ä»¤ capacity ä¸ºåæ¥çä¸¤åã\n\nvoid addentry(int hash, k key, v value, int bucketindex) {    entry<k,v> e = table[bucketindex];    table[bucketindex] = new entry<>(hash, key, value, e);    if (size++ >= threshold)        resize(2 * table.length);}\n\n\n1\n\n\næ©å®¹ä½¿ç¨ resize() å®ç°ï¼éè¦æ³¨æçæ¯ï¼æ©å®¹æä½åæ ·éè¦æ oldtable çææé®å¼å¯¹éæ°æå¥ newtable ä¸­ï¼å æ­¤è¿ä¸æ­¥æ¯å¾è´¹æ¶çã\n\nvoid resize(int newcapacity) {    entry[] oldtable = table;    int oldcapacity = oldtable.length;    if (oldcapacity == maximum_capacity) {        threshold = integer.max_value;        return;    }    // æé æ°çentryæ°ç»ï¼å®¹éä¸ºnewcapacityï¼2åäºåå®¹éï¼    entry[] newtable = new entry[newcapacity];    // ææ§entryæ°ç»éçåç´ ç§»å¨å°æ°entryæ°ç»é    transfer(newtable);    // æ°ç»åéæåæ°entryæ°ç»    table = newtable;    threshold = (int)(newcapacity * loadfactor);}void transfer(entry[] newtable) {    // å¾å°å entry æ°ç»    entry[] src = table;    int newcapacity = newtable.length;    // ä¸¤å±å¾ªç¯åå«éååæ°ç»ä»¥ååæ°ç»åç´ ä¸­çentryé¾è¡¨    for (int j = 0; j < src.length; j++) {        entry<k,v> e = src[j];        if (e != null) {            // clear to let gc do its work            src[j] = null;            do {                entry<k,v> next = e.next;                // æ ¹æ®hashå¼åæ°æ°ç»å®¹éè®¡ç®åºæ£åå°æ°æ°ç»ä¸­çæ¡¶çä½ç½®                int i = indexfor(e.hash, newcapacity);                // ä¸é¢ä¸¤æ­¥æ¯å¤´ææ³                e.next = newtable[i];                newtable[i] = e;                // æåé¾è¡¨ä¸­ä¸ä¸åç´ ï¼è¿è¡ä¸ä¸æ¬¡å¾ªç¯å¤ç                e = next;            } while (e != null);        }    }}\n\n\n1\n\n\n\n# 6. æ©å®¹-éæ°è®¡ç®æ¡¶ä¸æ \n\nå¨è¿è¡æ©å®¹æ¶ï¼éè¦æé®å¼å¯¹éæ°æ¾å°å¯¹åºçæ¡¶ä¸ãhashmap ä½¿ç¨äºä¸ä¸ªç¹æ®çæºå¶ï¼å¯ä»¥éä½éæ°è®¡ç®æ¡¶ä¸æ çæä½ã\n\nåè®¾åæ°ç»é¿åº¦ capacity ä¸º 16ï¼æ©å®¹ä¹å new capacity ä¸º 32ï¼\n\ncapacity     : 00010000new capacity : 00100000\n\n\n1\n\n\nå¯¹äºä¸ä¸ª keyï¼\n\n * å®çåå¸å¼å¦æå¨ç¬¬ 5 ä½ä¸ä¸º 0ï¼é£ä¹åæ¨¡å¾å°çç»æåä¹åä¸æ ·ï¼\n * å¦æä¸º 1ï¼é£ä¹å¾å°çç»æä¸ºåæ¥çç»æ +16ã\n\n\n# 7. è®¡ç®æ°ç»å®¹é\n\nhashmap æé å½æ°åè®¸ç¨æ·ä¼ å¥çå®¹éä¸æ¯ 2 ç n æ¬¡æ¹ï¼å ä¸ºå®å¯ä»¥èªå¨å°å°ä¼ å¥çå®¹éè½¬æ¢ä¸º 2 ç n æ¬¡æ¹ã\n\nåèèå¦ä½æ±ä¸ä¸ªæ°çæ©ç ï¼å¯¹äº 10010000ï¼å®çæ©ç ä¸º 11111111ï¼å¯ä»¥ä½¿ç¨ä»¥ä¸æ¹æ³å¾å°ï¼\n\nmask |= mask >> 1    11011000mask |= mask >> 2    11111110mask |= mask >> 4    11111111\n\n\n1\n\n\nmask+1 æ¯å¤§äºåå§æ°å­çæå°ç 2 ç n æ¬¡æ¹ã\n\nnum     10010000\nmask+1 100000000\n\n\n1\n2\n\n\nä»¥ä¸æ¯ hashmap ä¸­è®¡ç®æ°ç»å®¹éçä»£ç ï¼\n\nstatic final int tablesizefor(int cap) {\n    int n = cap - 1;\n    n |= n >>> 1;\n    n |= n >>> 2;\n    n |= n >>> 4;\n    n |= n >>> 8;\n    n |= n >>> 16;\n    return (n < 0) ? 1 : (n >= maximum_capacity) ? maximum_capacity : n + 1;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# 8. é¾è¡¨è½¬çº¢é»æ \n\nä» jdk 1.8 å¼å§ï¼ä¸ä¸ªæ¡¶å­å¨çé¾è¡¨é¿åº¦å¤§äº 8 æ¶ä¼å°é¾è¡¨è½¬æ¢ä¸ºçº¢é»æ ã\n\n\n# 9. ä¸ hashtable çæ¯è¾\n\n * hashtable ä½¿ç¨ synchronized æ¥è¿è¡åæ­¥ã\n * hashmap å¯ä»¥æå¥é®ä¸º null ç entryã\n * hashmap çè¿­ä»£å¨æ¯ fail-fast è¿­ä»£å¨ã\n * hashmap ä¸è½ä¿è¯éçæ¶é´çæ¨ç§» map ä¸­çåç´ æ¬¡åºæ¯ä¸åçã\n\n\n# concurrenthashmap\n\n\n# 1. å­å¨ç»æ\n\nstatic final class hashentry<k,v> {\n    final int hash;\n    final k key;\n    volatile v value;\n    volatile hashentry<k,v> next;\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nconcurrenthashmap å hashmap å®ç°ä¸ç±»ä¼¼ï¼æä¸»è¦çå·®å«æ¯ concurrenthashmap éç¨äºåæ®µéï¼segmentï¼ï¼æ¯ä¸ªåæ®µéç»´æ¤çå ä¸ªæ¡¶ï¼hashentryï¼ï¼å¤ä¸ªçº¿ç¨å¯ä»¥åæ¶è®¿é®ä¸ååæ®µéä¸çæ¡¶ï¼ä»èä½¿å¶å¹¶ååº¦æ´é«ï¼å¹¶ååº¦å°±æ¯ segment çä¸ªæ°ï¼ã\n\nsegment ç»§æ¿èª reentrantlockã\n\nstatic final class segment<k,v> extends reentrantlock implements serializable {\n\n    private static final long serialversionuid = 2249069246763182397l;\n\n    static final int max_scan_retries =\n        runtime.getruntime().availableprocessors() > 1 ? 64 : 1;\n\n    transient volatile hashentry<k,v>[] table;\n\n    transient int count;\n\n    transient int modcount;\n\n    transient int threshold;\n\n    final float loadfactor;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nfinal segment<k,v>[] segments;\n\n\n1\n\n\né»è®¤çå¹¶åçº§å«ä¸º 16ï¼ä¹å°±æ¯è¯´é»è®¤åå»º 16 ä¸ª segmentã\n\nstatic final int default_concurrency_level = 16;\n\n\n1\n\n\n\n\n\n# 2. size æä½\n\næ¯ä¸ª segment ç»´æ¤äºä¸ä¸ª count åéæ¥ç»è®¡è¯¥ segment ä¸­çé®å¼å¯¹ä¸ªæ°ã\n\n/**\n * the number of elements. accessed only either within locks\n * or among other volatile reads that maintain visibility.\n */\ntransient int count;\n\n\n1\n2\n3\n4\n5\n\n\nå¨æ§è¡ size æä½æ¶ï¼éè¦éåææ segment ç¶åæ count ç´¯è®¡èµ·æ¥ã\n\nconcurrenthashmap å¨æ§è¡ size æä½æ¶åå°è¯ä¸å éï¼å¦æè¿ç»­ä¸¤æ¬¡ä¸å éæä½å¾å°çç»æä¸è´ï¼é£ä¹å¯ä»¥è®¤ä¸ºè¿ä¸ªç»ææ¯æ­£ç¡®çã\n\nå°è¯æ¬¡æ°ä½¿ç¨ retries_before_lock å®ä¹ï¼è¯¥å¼ä¸º 2ï¼retries åå§å¼ä¸º -1ï¼å æ­¤å°è¯æ¬¡æ°ä¸º 3ã\n\nå¦æå°è¯çæ¬¡æ°è¶è¿ 3 æ¬¡ï¼å°±éè¦å¯¹æ¯ä¸ª segment å éã\n\n/**\n * number of unsynchronized retries in size and containsvalue\n * methods before resorting to locking. this is used to avoid\n * unbounded retries if tables undergo continuous modification\n * which would make it impossible to obtain an accurate result.\n * è¯ï¼å¨éå®ä¹åï¼sizeæ¹æ³åcontainsvalueæ¹æ³ä¸­ä¸åæ­¥éè¯çæ¬¡æ°ã\n * è¿æ ·åæ¯ä¸ºäºé¿åå¨è¡¨ä¸æ­ä¿®æ¹çæåµä¸è¿è¡æ çéè¯ï¼å ä¸ºä¿®æ¹ä¼å¯¼è´æ æ³è·å¾åç¡®çç»æã\n */\nstatic final int retries_before_lock = 2;\n\npublic int size() {\n    // try a few times to get accurate count. on failure due to\n    // continuous async changes in table, resort to locking.\n    // è¯å æ¬¡ï¼ä»¥è·å¾åç¡®çè®¡æ°ãç±äºè¡¨ä¸­çè¿ç»­å¼æ­¥æ´æ¹èå¯¼è´å¤±è´¥æ¶ï¼è¯·ä½¿ç¨éå®ã\n    final segment<k,v>[] segments = this.segments;\n    int size;\n    boolean overflow; // true if size overflows 32 bits\n    long sum;         // sum of modcounts\n    long last = 0l;   // previous sum(å³ä¸ä¸æ¬¡å¾å°çcountç»æå¼)\n    int retries = -1; // first iteration isn\'t retry\n    try {\n        for (;;) {\n            // è¶è¿å°è¯æ¬¡æ°ï¼åå¯¹æ¯ä¸ª segment å é\n            if (retries++ == retries_before_lock) {\n                for (int j = 0; j < segments.length; ++j)\n                    ensuresegment(j).lock(); // force creation\n            }\n            sum = 0l;\n            size = 0;\n            overflow = false;\n            for (int j = 0; j < segments.length; ++j) {\n                segment<k,v> seg = segmentat(segments, j);\n                if (seg != null) {\n                    sum += seg.modcount;\n                    // ä¸é¢ä¸¤æ­¥æ¯ä½æº¢åºå¤æ­æä½\n                    int c = seg.count;\n                    if (c < 0 || (size += c) < 0)\n                        overflow = true;\n                }\n            }\n            // è¿ç»­ä¸¤æ¬¡å¾å°çç»æä¸è´ï¼åè®¤ä¸ºè¿ä¸ªç»ææ¯æ­£ç¡®ç\n            if (sum == last)\n                break;\n            last = sum;\n        }\n    } finally {\n        if (retries > retries_before_lock) {\n            for (int j = 0; j < segments.length; ++j)\n                segmentat(segments, j).unlock();\n        }\n    }\n    return overflow ? integer.max_value : size;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n\n\n\n# 3. jdk 1.8 çæ¹å¨\n\njdk 1.7 ä½¿ç¨åæ®µéæºå¶æ¥å®ç°å¹¶åæ´æ°æä½ï¼æ ¸å¿ç±»ä¸º segmentï¼å®ç»§æ¿èªéå¥é reentrantlockï¼ å¹¶ååº¦ä¸ segmentæ°éç¸ç­ã\n\njdk 1.8 ä½¿ç¨äº cas æä½æ¥æ¯ææ´é«çå¹¶ååº¦ï¼å¨ cas æä½å¤±è´¥æ¶ä½¿ç¨åç½®é synchronizedã\n\nå¹¶ä¸ jdk 1.8 çå®ç°ä¹å¨é¾è¡¨è¿é¿æ¶ä¼è½¬æ¢ä¸ºçº¢é»æ ã\n\n\n# linkedhashmap\n\n\n# å­å¨ç»æ\n\nç»§æ¿èª hashmapï¼å æ­¤å·æå hashmap ä¸æ ·çå¿«éæ¥æ¾ç¹æ§ã\n\npublic class linkedhashmap<k,v> extends hashmap<k,v> implements map<k,v>\n\n\n1\n\n\nåé¨ç»´æ¤äºä¸ä¸ªååé¾è¡¨ï¼ç¨æ¥ç»´æ¤æå¥é¡ºåºæè lru é¡ºåºã\n\n/**\n * the head (eldest) of the doubly linked list.\n */\ntransient linkedhashmap.entry<k,v> head;\n\n/**\n * the tail (youngest) of the doubly linked list.\n */\ntransient linkedhashmap.entry<k,v> tail;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\naccessorder å³å®äºé¡ºåºï¼é»è®¤ä¸º falseï¼æ­¤æ¶ç»´æ¤çæ¯æå¥é¡ºåºã\n\nfinal boolean accessorder;\n\n\n1\n\n\nlinkedhashmap æéè¦çæ¯ä»¥ä¸ç¨äºç»´æ¤é¡ºåºçå½æ°ï¼å®ä»¬ä¼å¨ putãget ç­æ¹æ³ä¸­è°ç¨ã\n\nvoid afternodeaccess(node<k,v> p) { }\nvoid afternodeinsertion(boolean evict) { }\n\n\n1\n2\n\n\n\n# afternodeaccess()\n\nå½ä¸ä¸ªèç¹è¢«è®¿é®æ¶ï¼å¦æ accessorder ä¸º trueï¼åä¼å°è¯¥èç¹ç§»å°é¾è¡¨å°¾é¨ãä¹å°±æ¯è¯´æå®ä¸º lru é¡ºåºä¹åï¼å¨æ¯æ¬¡è®¿é®ä¸ä¸ªèç¹æ¶ï¼ä¼å°è¿ä¸ªèç¹ç§»å°é¾è¡¨å°¾é¨ï¼ä¿è¯é¾è¡¨å°¾é¨æ¯æè¿è®¿é®çèç¹ï¼é£ä¹é¾è¡¨é¦é¨å°±æ¯æè¿æä¹æªä½¿ç¨çèç¹ã\n\nvoid afternodeaccess(node<k,v> e) { // move node to last\n    linkedhashmap.entry<k,v> last;\n    // lru && è®¿é®çåç´ éå°¾åç´ \n    if (accessorder && (last = tail) != e) {\n        linkedhashmap.entry<k,v> p =\n            (linkedhashmap.entry<k,v>)e, b = p.before, a = p.after;\n        p.after = null;\n        if (b == null)\n            head = a;\n        else\n            b.after = a;\n        if (a != null)\n            a.before = b;\n        else\n            last = b;\n        if (last == null)\n            head = p;\n        else {\n            p.before = last;\n            last.after = p;\n        }\n        tail = p;\n        ++modcount;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\n\n\n\n# afternodeinsertion()\n\nå¨ put ç­æä½ä¹åæ§è¡ï¼å½ removeeldestentry() æ¹æ³è¿å true æ¶ä¼ç§»é¤ææçèç¹ï¼ä¹å°±æ¯é¾è¡¨é¦é¨èç¹ firstã\n\nevict åªæå¨æå»º map çæ¶åæä¸º falseï¼å¨è¿éä¸º trueã\n\nvoid afternodeinsertion(boolean evict) { // possibly remove eldest\n    linkedhashmap.entry<k,v> first;\n    // å¤´é¨èç¹ != null && removeeldestentryæ¹æ³è¿åtrue\n    if (evict && (first = head) != null && removeeldestentry(first)) {\n        k key = first.key;\n        removenode(hash(key), key, null, false, true);\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nremoveeldestentry() é»è®¤ä¸º falseï¼å¦æéè¦è®©å®ä¸º trueï¼éè¦ç»§æ¿ linkedhashmap å¹¶ä¸è¦çè¿ä¸ªæ¹æ³çå®ç°ï¼è¿å¨å®ç° lru çç¼å­ä¸­ç¹å«æç¨ï¼éè¿ç§»é¤æè¿æä¹æªä½¿ç¨çèç¹ï¼ä»èä¿è¯ç¼å­ç©ºé´è¶³å¤ï¼å¹¶ä¸ç¼å­çæ°æ®é½æ¯ç­ç¹æ°æ®ã\n\nprotected boolean removeeldestentry(map.entry<k,v> eldest) {\n    return false;\n}\n\n\n1\n2\n3\n\n\n\n# lru ç¼å­\n\nä»¥ä¸æ¯ä½¿ç¨ linkedhashmap å®ç°çä¸ä¸ª lru ç¼å­ï¼\n\nè®¾å®æå¤§ç¼å­ç©ºé´ max_entries ä¸º 3ï¼ ä½¿ç¨ linkedhashmap çæé å½æ°å° accessorder è®¾ç½®ä¸º trueï¼å¼å¯ lru é¡ºåºï¼ è¦ç removeeldestentry() æ¹æ³å®ç°ï¼å¨èç¹å¤äº max_entries å°±ä¼å°æè¿æä¹æªä½¿ç¨çæ°æ®ç§»é¤ã\n\nclass lrucache<k, v> extends linkedhashmap<k, v> {\n    private static final int max_entries = 3;\n\n    protected boolean removeeldestentry(map.entry eldest) {\n        return size() > max_entries;\n    }\n\n    lrucache() {\n        super(max_entries, 0.75f, true);\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\npublic static void main(string[] args) {\n    lrucache<integer, string> cache = new lrucache<>();\n    cache.put(1, "a");\n    cache.put(2, "b");\n    cache.put(3, "c");\n    cache.get(1);\n    cache.put(4, "d");\n    system.out.println(cache.keyset());\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n[3, 1, 4]\n\n\n1\n\n\n\n# weakhashmap\n\n\n# å­å¨ç»æ\n\nweakhashmap ç entry ç»§æ¿èª weakreferenceï¼è¢« weakreference å³èçå¯¹è±¡å¨ä¸ä¸æ¬¡åå¾åæ¶æ¶ä¼è¢«åæ¶ã\n\nweakhashmap ä¸»è¦ç¨æ¥å®ç°ç¼å­ï¼éè¿ä½¿ç¨ weakhashmap æ¥å¼ç¨ç¼å­å¯¹è±¡ï¼ç± jvm å¯¹è¿é¨åç¼å­è¿è¡åæ¶ã\n\nprivate static class entry<k,v> extends weakreference<object> implements map.entry<k,v>\n\n\n1\n\n\n\n# concurrentcache\n\ntomcat ä¸­ç concurrentcache ä½¿ç¨äº weakhashmap æ¥å®ç°ç¼å­åè½ã\n\nconcurrentcache éåçæ¯åä»£ç¼å­ï¼\n\n * ç»å¸¸ä½¿ç¨çå¯¹è±¡æ¾å¥ eden ä¸­ï¼eden ä½¿ç¨ concurrenthashmap å®ç°ï¼ä¸ç¨æå¿ä¼è¢«åæ¶ï¼ä¼ç¸å­ï¼ï¼\n * ä¸å¸¸ç¨çå¯¹è±¡æ¾å¥ longtermï¼longterm ä½¿ç¨ weakhashmap å®ç°ï¼è¿äºèå¯¹è±¡ä¼è¢«åå¾æ¶éå¨åæ¶ã\n * å½è°ç¨ get() æ¹æ³æ¶ï¼ä¼åä» eden åºè·åï¼å¦ææ²¡ææ¾å°çè¯åå° longterm è·åï¼å½ä» longterm è·åå°å°±æå¯¹è±¡æ¾å¥ eden ä¸­ï¼ä»èä¿è¯ç»å¸¸è¢«è®¿é®çèç¹ä¸å®¹æè¢«åæ¶ã\n * å½è°ç¨ put() æ¹æ³æ¶ï¼å¦æ eden çå¤§å°è¶è¿äº sizeï¼é£ä¹å°±å° eden ä¸­çææå¯¹è±¡é½æ¾å¥ longterm ä¸­ï¼å©ç¨èææºåæ¶æä¸é¨åä¸ç»å¸¸ä½¿ç¨çå¯¹è±¡ã\n\npublic final class concurrentcache<k, v> {\n\n    private final int size;\n\n    private final map<k, v> eden;\n\n    private final map<k, v> longterm;\n\n    public concurrentcache(int size) {\n        this.size = size;\n        this.eden = new concurrenthashmap<>(size);\n        this.longterm = new weakhashmap<>(size);\n    }\n\n    public v get(k k) {\n        v v = this.eden.get(k);\n        if (v == null) {\n            v = this.longterm.get(k);\n            if (v != null)\n                this.eden.put(k, v);\n        }\n        return v;\n    }\n\n    public void put(k k, v v) {\n        if (this.eden.size() >= size) {\n            this.longterm.putall(this.eden);\n            this.eden.clear();\n        }\n        this.eden.put(k, v);\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n\n\n----------------------------------------\n\nåèï¼\n\n * æ¼«ç»ï¼ä»ä¹æ¯hashmapï¼\n\nå³é®ç¹\n\n * ä¸ºä»ä¹éç¨å¤´ææ³ï¼\n\n> hashmapçåæèè®¤ä¸ºï¼åæå¥çentryè¢«æ¥æ¾çå¯è½æ§æ´å¤§ã\n\n * hashmapçé»è®¤åå§é¿åº¦æ¯16ï¼å¹¶ä¸æ¯æ¬¡èªå¨æ©å±ææå¨åå§åæ¶ï¼é¿åº¦å¿é¡»æ¯2çå¹ï¼ä¸ºä»ä¹ï¼\n\n> ä¹æä»¥éæ©16ï¼æ¯ä¸ºäºå¯ä»¥å°æ±æ¨¡è¿ç®è½¬æ¢æä½äºè¿ç®ï¼æé«hashæç\n\n\n# åæ¨¡è¿ç®å¯ä»¥è½¬æ¢æä½äºè¿ç®åé¨åçåæ:\n\nåè®¾ä¸ä¸ªkeyçhashcodeä¸º56ï¼tableå®¹éä¸º16ï¼æ­£å¸¸åæ¨¡åä½æ°ä¸º8ï¼å³æ¾å°ç´¢å¼ä¸º8çæ¡¶ä¸­ã\n\nå¦æéç¨ä½äºè¿ç®ï¼hashcode & ( length - 1 )\n\n56 äºè¿å¶ä¸ºï¼111000\n\n16 - 1 äºè¿å¶ä¸ºï¼1111\n\n  111000\n& 001111\n--------\n  001000\n\n\n1\n2\n3\n4\n\n\nç»æä¹æ¯8\n\nä½äºè¿ç®å¯ä»¥ä¿è¯åååå¸çåå æ¯ï¼ä¸ä¸ªkeyçhashcode å 16 -1 = 15 è¿è¡ä½ä¸è¿ç®ï¼å ä¸º15çååä½é½æ¯1ï¼1åè°ä¸ç»æå°±æ¯è°ï¼åé¢ä½æ°å¨æ¯0ï¼0åè°ä¸ç»æé½æ¯0ï¼æä»¥è®¡ç®åçç»æå°±æ¯hashcodeçååä½ä¸å°äºç­äº15ï¼èæækeyçhashcodeé½æ¯éæºçï¼ååä½ä¹æ¯éæºçï¼æ´ä½éæºï¼å±é¨ä¹éæºï¼ï¼å¯ä»¥ä¿è¯ç»æä¸ºéæºåååå¸ã',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Java IO",frontmatter:{title:"Java IO",date:"2022-02-03T19:02:41.000Z",permalink:"/pages/5859c4/",categories:["é¢è¯","Java","Javaåºç¡"],tags:[null]},regularPath:"/35.%E9%9D%A2%E8%AF%95/05.Java/05.Java%E5%9F%BA%E7%A1%80/15.Java%20IO.html",relativePath:"35.é¢è¯/05.Java/05.Javaåºç¡/15.Java IO.md",key:"v-fdf3da36",path:"/pages/5859c4/",headers:[{level:3,title:"å®ç°æä»¶å¤å¶",slug:"å®ç°æä»¶å¤å¶",normalizedTitle:"å®ç°æä»¶å¤å¶",charIndex:575},{level:3,title:"è£é¥°èæ¨¡å¼",slug:"è£é¥°èæ¨¡å¼",normalizedTitle:"è£é¥°èæ¨¡å¼",charIndex:1093},{level:3,title:"ç¼ç ä¸è§£ç ",slug:"ç¼ç ä¸è§£ç ",normalizedTitle:"ç¼ç ä¸è§£ç ",charIndex:1627},{level:3,title:"String çç¼ç æ¹å¼",slug:"string-çç¼ç æ¹å¼",normalizedTitle:"string çç¼ç æ¹å¼",charIndex:2032},{level:3,title:"Reader ä¸ Writer",slug:"reader-ä¸-writer",normalizedTitle:"reader ä¸ writer",charIndex:2450},{level:3,title:"å®ç°éè¡è¾åºææ¬æä»¶çåå®¹",slug:"å®ç°éè¡è¾åºææ¬æä»¶çåå®¹",normalizedTitle:"å®ç°éè¡è¾åºææ¬æä»¶çåå®¹",charIndex:2611},{level:3,title:"åºåå",slug:"åºåå",normalizedTitle:"åºåå",charIndex:3159},{level:3,title:"Serializable",slug:"serializable",normalizedTitle:"serializable",charIndex:112},{level:3,title:"transient",slug:"transient",normalizedTitle:"transient",charIndex:4286},{level:3,title:"InetAddress",slug:"inetaddress",normalizedTitle:"inetaddress",charIndex:4529},{level:3,title:"URL",slug:"url",normalizedTitle:"url",charIndex:4566},{level:3,title:"Sockets",slug:"sockets",normalizedTitle:"sockets",charIndex:4582},{level:3,title:"Datagram",slug:"datagram",normalizedTitle:"datagram",charIndex:4610},{level:3,title:"æµä¸å",slug:"æµä¸å",normalizedTitle:"æµä¸å",charIndex:5515},{level:3,title:"ééä¸ç¼å²åº",slug:"ééä¸ç¼å²åº",normalizedTitle:"ééä¸ç¼å²åº",charIndex:5900},{level:3,title:"ç¼å²åºç¶æåé",slug:"ç¼å²åºç¶æåé",normalizedTitle:"ç¼å²åºç¶æåé",charIndex:6489},{level:3,title:"æä»¶ NIO å®ä¾",slug:"æä»¶-nio-å®ä¾",normalizedTitle:"æä»¶ nio å®ä¾",charIndex:6909},{level:3,title:"éæ©å¨",slug:"éæ©å¨",normalizedTitle:"éæ©å¨",charIndex:7826},{level:3,title:"å¥æ¥å­ NIO å®ä¾",slug:"å¥æ¥å­-nio-å®ä¾",normalizedTitle:"å¥æ¥å­ nio å®ä¾",charIndex:9978},{level:3,title:"åå­æ å°æä»¶",slug:"åå­æ å°æä»¶",normalizedTitle:"åå­æ å°æä»¶",charIndex:12895},{level:3,title:"å¯¹æ¯",slug:"å¯¹æ¯",normalizedTitle:"å¯¹æ¯",charIndex:13237}],headersStr:"å®ç°æä»¶å¤å¶ è£é¥°èæ¨¡å¼ ç¼ç ä¸è§£ç  String çç¼ç æ¹å¼ Reader ä¸ Writer å®ç°éè¡è¾åºææ¬æä»¶çåå®¹ åºåå Serializable transient InetAddress URL Sockets Datagram æµä¸å ééä¸ç¼å²åº ç¼å²åºç¶æåé æä»¶ NIO å®ä¾ éæ©å¨ å¥æ¥å­ NIO å®ä¾ åå­æ å°æä»¶ å¯¹æ¯",content:'# ä¸ãæ¦è§\n\nJava ç I/O å¤§æ¦å¯ä»¥åæä»¥ä¸å ç±»ï¼\n\n * ç£çæä½ï¼File\n * å­èæä½ï¼InputStream å OutputStream\n * å­ç¬¦æä½ï¼Reader å Writer\n * å¯¹è±¡æä½ï¼Serializable\n * ç½ç»æä½ï¼Socket\n * æ°çè¾å¥/è¾åºï¼NIO\n\n\n# äºãç£çæä½\n\nFile ç±»å¯ä»¥ç¨äºè¡¨ç¤ºæä»¶åç®å½çä¿¡æ¯ï¼ä½æ¯å®ä¸è¡¨ç¤ºæä»¶çåå®¹ã\n\néå½å°ååºä¸ä¸ªç®å½ä¸æææä»¶ï¼\n\npublic static void listAllFiles(File dir) {\n    if (dir == null || !dir.exists()) {\n        return;\n    }\n    if (dir.isFile()) {\n        System.out.println(dir.getName());\n        return;\n    }\n    for (File file : dir.listFiles()) {\n        listAllFiles(file);\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä» Java7 å¼å§ï¼å¯ä»¥ä½¿ç¨ Paths å Files ä»£æ¿ Fileã\n\n\n# ä¸ãå­èæä½\n\n\n# å®ç°æä»¶å¤å¶\n\npublic static void copyFile(String src, String dist) throws IOException {\n    FileInputStream in = new FileInputStream(src);\n    FileOutputStream out = new FileOutputStream(dist);\n\n    byte[] buffer = new byte[20 * 1024];\n    int cnt;\n\n    // read() æå¤è¯»å buffer.length ä¸ªå­è\n    // è¿åçæ¯å®éè¯»åçä¸ªæ°\n    // è¿å -1 çæ¶åè¡¨ç¤ºè¯»å° eofï¼å³æä»¶å°¾\n    while ((cnt = in.read(buffer, 0, buffer.length)) != -1) {\n        out.write(buffer, 0, cnt);\n    }\n\n    in.close();\n    out.close();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n# è£é¥°èæ¨¡å¼\n\nJava I/O ä½¿ç¨äºè£é¥°èæ¨¡å¼æ¥å®ç°ãä»¥ InputStream ä¸ºä¾ï¼\n\n * InputStream æ¯æ½è±¡ç»ä»¶ï¼\n * FileInputStream æ¯ InputStream çå­ç±»ï¼å±äºå·ä½ç»ä»¶ï¼æä¾äºå­èæµçè¾å¥æä½ï¼\n * FilterInputStream å±äºæ½è±¡è£é¥°èï¼è£é¥°èç¨äºè£é¥°ç»ä»¶ï¼ä¸ºç»ä»¶æä¾é¢å¤çåè½ãä¾å¦ BufferedInputStream ä¸º FileInputStream æä¾ç¼å­çåè½ã\n\n\n\nå®ä¾åä¸ä¸ªå·æç¼å­åè½çå­èæµå¯¹è±¡æ¶ï¼åªéè¦å¨ FileInputStream å¯¹è±¡ä¸åå¥ä¸å± BufferedInputStream å¯¹è±¡å³å¯ã\n\nFileInputStream fileInputStream = new FileInputStream(filePath);\nBufferedInputStream bufferedInputStream = new BufferedInputStream(fileInputStream);\n\n\n1\n2\n\n\nDataInputStream è£é¥°èæä¾äºå¯¹æ´å¤æ°æ®ç±»åè¿è¡è¾å¥çæä½ï¼æ¯å¦ intãdouble ç­åºæ¬ç±»åã\n\n\n# åãå­ç¬¦æä½\n\n\n# ç¼ç ä¸è§£ç \n\nç¼ç å°±æ¯æå­ç¬¦è½¬æ¢ä¸ºå­èï¼èè§£ç æ¯æå­èéæ°ç»åæå­ç¬¦ã\n\nå¦æç¼ç åè§£ç è¿ç¨ä½¿ç¨ä¸åçç¼ç æ¹å¼é£ä¹å°±åºç°äºä¹±ç ã\n\n * GBK ç¼ç ä¸­ï¼ä¸­æå­ç¬¦å  2 ä¸ªå­èï¼è±æå­ç¬¦å  1 ä¸ªå­èï¼\n * UTF-8 ç¼ç ä¸­ï¼ä¸­æå­ç¬¦å  3 ä¸ªå­èï¼è±æå­ç¬¦å  1 ä¸ªå­èï¼\n * UTF-16be ç¼ç ä¸­ï¼ä¸­æå­ç¬¦åè±æå­ç¬¦é½å  2 ä¸ªå­èã\n\nUTF-16be ä¸­ç be æçæ¯ Big Endianï¼ä¹å°±æ¯å¤§ç«¯ãç¸åºå°ä¹æ UTF-16leï¼le æçæ¯ Little Endianï¼ä¹å°±æ¯å°ç«¯ã\n\nJava çåå­ç¼ç ä½¿ç¨åå­èç¼ç  UTF-16beï¼è¿ä¸æ¯æ Java åªæ¯æè¿ä¸ç§ç¼ç æ¹å¼ï¼èæ¯è¯´ char è¿ç§ç±»åä½¿ç¨ UTF-16be è¿è¡ç¼ç ãchar ç±»åå  16 ä½ï¼ä¹å°±æ¯ä¸¤ä¸ªå­èï¼Java ä½¿ç¨è¿ç§åå­èç¼ç æ¯ä¸ºäºè®©ä¸ä¸ªä¸­ææèä¸ä¸ªè±æé½è½ä½¿ç¨ä¸ä¸ª char æ¥å­å¨ã\n\n\n# String çç¼ç æ¹å¼\n\nString å¯ä»¥çæä¸ä¸ªå­ç¬¦åºåï¼å¯ä»¥æå®ä¸ä¸ªç¼ç æ¹å¼å°å®ç¼ç ä¸ºå­èåºåï¼ä¹å¯ä»¥æå®ä¸ä¸ªç¼ç æ¹å¼å°ä¸ä¸ªå­èåºåè§£ç ä¸º Stringã\n\nString str1 = "ä¸­æ";\nbyte[] bytes = str1.getBytes("UTF-8");\nString str2 = new String(bytes, "UTF-8");\nSystem.out.println(str2);\n\n\n1\n2\n3\n4\n\n\nå¨è°ç¨æ åæ° getBytes() æ¹æ³æ¶ï¼é»è®¤çç¼ç æ¹å¼ä¸æ¯ UTF-16beãåå­èç¼ç çå¥½å¤æ¯å¯ä»¥ä½¿ç¨ä¸ä¸ª char å­å¨ä¸­æåè±æï¼èå° String è½¬ä¸º bytes[] å­èæ°ç»å°±ä¸åéè¦è¿ä¸ªå¥½å¤ï¼å æ­¤ä¹å°±ä¸åéè¦åå­èç¼ç ãgetBytes() çé»è®¤ç¼ç æ¹å¼ä¸å¹³å°æå³ï¼ä¸è¬ä¸º UTF-8ã\n\nbyte[] bytes = str1.getBytes();\n\n\n1\n\n\n\n# Reader ä¸ Writer\n\nä¸ç®¡æ¯ç£çè¿æ¯ç½ç»ä¼ è¾ï¼æå°çå­å¨ååé½æ¯å­èï¼èä¸æ¯å­ç¬¦ãä½æ¯å¨ç¨åºä¸­æä½çéå¸¸æ¯å­ç¬¦å½¢å¼çæ°æ®ï¼å æ­¤éè¦æä¾å¯¹å­ç¬¦è¿è¡æä½çæ¹æ³ã\n\n * InputStreamReader å®ç°ä»å­èæµè§£ç æå­ç¬¦æµï¼\n * OutputStreamWriter å®ç°å­ç¬¦æµç¼ç æä¸ºå­èæµã\n\n\n# å®ç°éè¡è¾åºææ¬æä»¶çåå®¹\n\npublic static void readFileContent(String filePath) throws IOException {\n\n    FileReader fileReader = new FileReader(filePath);\n    BufferedReader bufferedReader = new BufferedReader(fileReader);\n\n    String line;\n    while ((line = bufferedReader.readLine()) != null) {\n        System.out.println(line);\n    }\n\n    // è£é¥°èæ¨¡å¼ä½¿å¾ BufferedReader ç»åäºä¸ä¸ª Reader å¯¹è±¡\n    // å¨è°ç¨ BufferedReader ç close() æ¹æ³æ¶ä¼å»è°ç¨ Reader ç close() æ¹æ³\n    // å æ­¤åªè¦ä¸ä¸ª close() è°ç¨å³å¯\n    bufferedReader.close();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# äºãå¯¹è±¡æä½\n\n\n# åºåå\n\nåºååå°±æ¯å°ä¸ä¸ªå¯¹è±¡è½¬æ¢æå­èåºåï¼æ¹ä¾¿å­å¨åä¼ è¾ã\n\n * åºååï¼ObjectOutputStream.writeObject()\n * ååºååï¼ObjectInputStream.readObject()\n\nä¸ä¼å¯¹éæåéè¿è¡åºååï¼å ä¸ºåºåååªæ¯ä¿å­å¯¹è±¡çç¶æï¼éæåéå±äºç±»çç¶æã\n\n\n# Serializable\n\nåºååçç±»éè¦å®ç° Serializable æ¥å£ï¼å®åªæ¯ä¸ä¸ªæ åï¼æ²¡æä»»ä½æ¹æ³éè¦å®ç°ï¼ä½æ¯å¦æä¸å»å®ç°å®çè¯èè¿è¡åºååï¼ä¼æåºå¼å¸¸ã\n\npublic static void main(String[] args) throws IOException, ClassNotFoundException {\n\n    A a1 = new A(123, "abc");\n    String objectFile = "file/a1";\n\n    ObjectOutputStream objectOutputStream = new ObjectOutputStream(new FileOutputStream(objectFile));\n    objectOutputStream.writeObject(a1);\n    objectOutputStream.close();\n\n    ObjectInputStream objectInputStream = new ObjectInputStream(new FileInputStream(objectFile));\n    A a2 = (A) objectInputStream.readObject();\n    objectInputStream.close();\n    System.out.println(a2);\n}\n\nprivate static class A implements Serializable {\n\n    private int x;\n    private String y;\n\n    A(int x, String y) {\n        this.x = x;\n        this.y = y;\n    }\n\n    @Override\n    public String toString() {\n        return "x = " + x + "  " + "y = " + y;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\n\n# transient\n\ntransient å³é®å­å¯ä»¥ä½¿ä¸äºå±æ§ä¸ä¼è¢«åºååã\n\nArrayList ä¸­å­å¨æ°æ®çæ°ç» elementData æ¯ç¨ transient ä¿®é¥°çï¼å ä¸ºè¿ä¸ªæ°ç»æ¯å¨ææ©å±çï¼å¹¶ä¸æ¯ææçç©ºé´é½è¢«ä½¿ç¨ï¼å æ­¤å°±ä¸éè¦ææçåå®¹é½è¢«åºååãéè¿éååºåååååºååæ¹æ³ï¼ä½¿å¾å¯ä»¥åªåºååæ°ç»ä¸­æåå®¹çé£é¨åæ°æ®ã\n\nprivate transient Object[] elementData;\n\n\n1\n\n\n\n# å­ãç½ç»æä½\n\nJava ä¸­çç½ç»æ¯æï¼\n\n * InetAddressï¼ç¨äºè¡¨ç¤ºç½ç»ä¸çç¡¬ä»¶èµæºï¼å³ IP å°åï¼\n * URLï¼ç»ä¸èµæºå®ä½ç¬¦ï¼\n * Socketsï¼ä½¿ç¨ TCP åè®®å®ç°ç½ç»éä¿¡ï¼\n * Datagramï¼ä½¿ç¨ UDP åè®®å®ç°ç½ç»éä¿¡ã\n\n\n# InetAddress\n\næ²¡æå¬æçæé å½æ°ï¼åªè½éè¿éææ¹æ³æ¥åå»ºå®ä¾ã\n\nInetAddress.getByName(String host);\nInetAddress.getByAddress(byte[] address);\n\n\n1\n2\n\n\n\n# URL\n\nå¯ä»¥ç´æ¥ä» URL ä¸­è¯»åå­èæµæ°æ®ã\n\npublic static void main(String[] args) throws IOException {\n\n    URL url = new URL("http://www.baidu.com");\n\n    /* å­èæµ */\n    InputStream is = url.openStream();\n\n    /* å­ç¬¦æµ */\n    InputStreamReader isr = new InputStreamReader(is, "utf-8");\n\n    /* æä¾ç¼å­åè½ */\n    BufferedReader br = new BufferedReader(isr);\n\n    String line;\n    while ((line = br.readLine()) != null) {\n        System.out.println(line);\n    }\n\n    br.close();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n\n# Sockets\n\n * ServerSocketï¼æå¡å¨ç«¯ç±»\n * Socketï¼å®¢æ·ç«¯ç±»\n * æå¡å¨åå®¢æ·ç«¯éè¿ InputStream å OutputStream è¿è¡è¾å¥è¾åºã\n\n\n\n\n# Datagram\n\n * DatagramSocketï¼éä¿¡ç±»\n * DatagramPacketï¼æ°æ®åç±»\n\n\n# ä¸ãNIO\n\næ°çè¾å¥/è¾åº (NIO) åºæ¯å¨ JDK 1.4 ä¸­å¼å¥çï¼å¼¥è¡¥äºåæ¥ç I/O çä¸è¶³ï¼æä¾äºé«éçãé¢ååç I/Oã\n\n\n# æµä¸å\n\nI/O ä¸ NIO æéè¦çåºå«æ¯æ°æ®æååä¼ è¾çæ¹å¼ï¼I/O ä»¥æµçæ¹å¼å¤çæ°æ®ï¼è NIO ä»¥åçæ¹å¼å¤çæ°æ®ã\n\né¢åæµç I/O ä¸æ¬¡å¤çä¸ä¸ªå­èæ°æ®ï¼ä¸ä¸ªè¾å¥æµäº§çä¸ä¸ªå­èæ°æ®ï¼ä¸ä¸ªè¾åºæµæ¶è´¹ä¸ä¸ªå­èæ°æ®ãä¸ºæµå¼æ°æ®åå»ºè¿æ»¤å¨éå¸¸å®¹æï¼é¾æ¥å ä¸ªè¿æ»¤å¨ï¼ä»¥ä¾¿æ¯ä¸ªè¿æ»¤å¨åªè´è´£å¤æå¤çæºå¶çä¸é¨åãä¸å©çä¸é¢æ¯ï¼é¢åæµç I/O éå¸¸ç¸å½æ¢ã\n\né¢ååç I/O ä¸æ¬¡å¤çä¸ä¸ªæ°æ®åï¼æåå¤çæ°æ®æ¯ææµå¤çæ°æ®è¦å¿«å¾å¤ãä½æ¯é¢ååç I/O ç¼ºå°ä¸äºé¢åæµç I/O æå·æçä¼éæ§åç®åæ§ã\n\nI/O åå NIO å·²ç»å¾å¥½å°éæäºï¼java.io.* å·²ç»ä»¥ NIO ä¸ºåºç¡éæ°å®ç°äºï¼æä»¥ç°å¨å®å¯ä»¥å©ç¨ NIO çä¸äºç¹æ§ãä¾å¦ï¼java.io.* åä¸­çä¸äºç±»åå«ä»¥åçå½¢å¼è¯»åæ°æ®çæ¹æ³ï¼è¿ä½¿å¾å³ä½¿å¨é¢åæµçç³»ç»ä¸­ï¼å¤çéåº¦ä¹ä¼æ´å¿«ã\n\n\n# ééä¸ç¼å²åº\n\n# 1. éé\n\néé Channel æ¯å¯¹å I/O åä¸­çæµçæ¨¡æï¼å¯ä»¥éè¿å®è¯»åååå¥æ°æ®ã\n\nééä¸æµçä¸åä¹å¤å¨äºï¼æµåªè½å¨ä¸ä¸ªæ¹åä¸ç§»å¨(ä¸ä¸ªæµå¿é¡»æ¯ InputStream æè OutputStream çå­ç±»)ï¼èééæ¯ååçï¼å¯ä»¥ç¨äºè¯»ãåæèåæ¶ç¨äºè¯»åã\n\nééåæ¬ä»¥ä¸ç±»åï¼\n\n * FileChannelï¼ä»æä»¶ä¸­è¯»åæ°æ®ï¼\n * DatagramChannelï¼éè¿ UDP è¯»åç½ç»ä¸­æ°æ®ï¼\n * SocketChannelï¼éè¿ TCP è¯»åç½ç»ä¸­æ°æ®ï¼\n * ServerSocketChannelï¼å¯ä»¥çå¬æ°è¿æ¥ç TCP è¿æ¥ï¼å¯¹æ¯ä¸ä¸ªæ°è¿æ¥çè¿æ¥é½ä¼åå»ºä¸ä¸ª SocketChannelã\n\n# 2. ç¼å²åº\n\nåéç»ä¸ä¸ªééçæææ°æ®é½å¿é¡»é¦åæ¾å°ç¼å²åºä¸­ï¼åæ ·å°ï¼ä»ééä¸­è¯»åçä»»ä½æ°æ®é½è¦åè¯»å°ç¼å²åºä¸­ãä¹å°±æ¯è¯´ï¼ä¸ä¼ç´æ¥å¯¹ééè¿è¡è¯»åæ°æ®ï¼èæ¯è¦åç»è¿ç¼å²åºã\n\nç¼å²åºå®è´¨ä¸æ¯ä¸ä¸ªæ°ç»ï¼ä½å®ä¸ä»ä»æ¯ä¸ä¸ªæ°ç»ãç¼å²åºæä¾äºå¯¹æ°æ®çç»æåè®¿é®ï¼èä¸è¿å¯ä»¥è·è¸ªç³»ç»çè¯»/åè¿ç¨ã\n\nç¼å²åºåæ¬ä»¥ä¸ç±»åï¼\n\n * ByteBuffer\n * CharBuffer\n * ShortBuffer\n * IntBuffer\n * LongBuffer\n * FloatBuffer\n * DoubleBuffer\n\n\n# ç¼å²åºç¶æåé\n\n * capacityï¼æå¤§å®¹éï¼\n * positionï¼å½åå·²ç»è¯»åçå­èæ°ï¼\n * limitï¼è¿å¯ä»¥è¯»åçå­èæ°ã\n\nç¶æåéçæ¹åè¿ç¨ä¸¾ä¾ï¼\n\nâ  æ°å»ºä¸ä¸ªå¤§å°ä¸º 8 ä¸ªå­èçç¼å²åºï¼æ­¤æ¶ position ä¸º 0ï¼è limit = capacity = 8ãcapacity åéä¸ä¼æ¹åï¼ä¸é¢çè®¨è®ºä¼å¿½ç¥å®ã\n\n\n\nâ¡ ä»è¾å¥ééä¸­è¯»å 5 ä¸ªå­èæ°æ®åå¥ç¼å²åºä¸­ï¼æ­¤æ¶ position ä¸º 5ï¼limit ä¿æä¸åã\n\n\n\nâ¢ å¨å°ç¼å²åºçæ°æ®åå°è¾åºééä¹åï¼éè¦åè°ç¨ flip() æ¹æ³ï¼è¿ä¸ªæ¹æ³å° limit è®¾ç½®ä¸ºå½å positionï¼å¹¶å° position è®¾ç½®ä¸º 0ã\n\n\n\nâ£ ä»ç¼å²åºä¸­å 4 ä¸ªå­èå°è¾åºç¼å²ä¸­ï¼æ­¤æ¶ position è®¾ä¸º 4ã\n\n\n\nâ¤ æåéè¦è°ç¨ clear() æ¹æ³æ¥æ¸ç©ºç¼å²åºï¼æ­¤æ¶ position å limit é½è¢«è®¾ç½®ä¸ºæåä½ç½®ã\n\n\n\n\n# æä»¶ NIO å®ä¾\n\nä»¥ä¸å±ç¤ºäºä½¿ç¨ NIO å¿«éå¤å¶æä»¶çå®ä¾ï¼\n\npublic static void fastCopy(String src, String dist) throws IOException {\n\n    /* è·å¾æºæä»¶çè¾å¥å­èæµ */\n    FileInputStream fin = new FileInputStream(src);\n\n    /* è·åè¾å¥å­èæµçæä»¶éé */\n    FileChannel fcin = fin.getChannel();\n\n    /* è·åç®æ æä»¶çè¾åºå­èæµ */\n    FileOutputStream fout = new FileOutputStream(dist);\n\n    /* è·åè¾åºå­èæµçæä»¶éé */\n    FileChannel fcout = fout.getChannel();\n\n    /* ä¸ºç¼å²åºåé 1024 ä¸ªå­è */\n    ByteBuffer buffer = ByteBuffer.allocateDirect(1024);\n\n    while (true) {\n\n        /* ä»è¾å¥ééä¸­è¯»åæ°æ®å°ç¼å²åºä¸­ */\n        int r = fcin.read(buffer);\n\n        /* read() è¿å -1 è¡¨ç¤º EOF */\n        if (r == -1) {\n            break;\n        }\n\n        /* åæ¢è¯»å */\n        buffer.flip();\n\n        /* æç¼å²åºçåå®¹åå¥è¾åºæä»¶ä¸­ */\n        fcout.write(buffer);\n\n        /* æ¸ç©ºç¼å²åº */\n        buffer.clear();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n\n\n\n# éæ©å¨\n\nNIO å¸¸å¸¸è¢«å«åéé»å¡ IOï¼ä¸»è¦æ¯å ä¸º NIO å¨ç½ç»éä¿¡ä¸­çéé»å¡ç¹æ§è¢«å¹¿æ³ä½¿ç¨ã\n\nNIO å®ç°äº IO å¤è·¯å¤ç¨ä¸­ç Reactor æ¨¡åï¼ä¸ä¸ªçº¿ç¨ Thread ä½¿ç¨ä¸ä¸ªéæ©å¨ Selector éè¿è½®è¯¢çæ¹å¼å»çå¬å¤ä¸ªéé Channel ä¸çäºä»¶ï¼ä»èè®©ä¸ä¸ªçº¿ç¨å°±å¯ä»¥å¤çå¤ä¸ªäºä»¶ã\n\néè¿éç½®çå¬çéé Channel ä¸ºéé»å¡ï¼é£ä¹å½ Channel ä¸ç IO äºä»¶è¿æªå°è¾¾æ¶ï¼å°±ä¸ä¼è¿å¥é»å¡ç¶æä¸ç´ç­å¾ï¼èæ¯ç»§ç»­è½®è¯¢å¶å® Channelï¼æ¾å° IO äºä»¶å·²ç»å°è¾¾ç Channel æ§è¡ã\n\nå ä¸ºåå»ºååæ¢çº¿ç¨çå¼éå¾å¤§ï¼å æ­¤ä½¿ç¨ä¸ä¸ªçº¿ç¨æ¥å¤çå¤ä¸ªäºä»¶èä¸æ¯ä¸ä¸ªçº¿ç¨å¤çä¸ä¸ªäºä»¶ï¼å¯¹äº IO å¯éåçåºç¨å·æå¾å¥½å°æ§è½ã\n\nåºè¯¥æ³¨æçæ¯ï¼åªæå¥æ¥å­ Channel æè½éç½®ä¸ºéé»å¡ï¼è FileChannel ä¸è½ï¼ä¸º FileChannel éç½®éé»å¡ä¹æ²¡ææä¹ã\n\n\n\n# 1. åå»ºéæ©å¨\n\nSelector selector = Selector.open();\n\n\n1\n\n\n# 2. å°ééæ³¨åå°éæ©å¨ä¸\n\nServerSocketChannel ssChannel = ServerSocketChannel.open();\nssChannel.configureBlocking(false);\nssChannel.register(selector, SelectionKey.OP_ACCEPT);\n\n\n1\n2\n3\n\n\nééå¿é¡»éç½®ä¸ºéé»å¡æ¨¡å¼ï¼å¦åä½¿ç¨éæ©å¨å°±æ²¡æä»»ä½æä¹äºï¼å ä¸ºå¦æééå¨æä¸ªäºä»¶ä¸è¢«é»å¡ï¼é£ä¹æå¡å¨å°±ä¸è½ååºå¶å®äºä»¶ï¼å¿é¡»ç­å¾è¿ä¸ªäºä»¶å¤çå®æ¯æè½å»å¤çå¶å®äºä»¶ï¼æ¾ç¶è¿åéæ©å¨çä½ç¨èéèé©°ã\n\nå¨å°ééæ³¨åå°éæ©å¨ä¸æ¶ï¼è¿éè¦æå®è¦æ³¨åçå·ä½äºä»¶ï¼ä¸»è¦æä»¥ä¸å ç±»ï¼\n\n * SelectionKey.OP_CONNECT\n * SelectionKey.OP_ACCEPT\n * SelectionKey.OP_READ\n * SelectionKey.OP_WRITE\n\nå®ä»¬å¨ SelectionKey çå®ä¹å¦ä¸ï¼\n\npublic static final int OP_READ = 1 << 0;\npublic static final int OP_WRITE = 1 << 2;\npublic static final int OP_CONNECT = 1 << 3;\npublic static final int OP_ACCEPT = 1 << 4;\n\n\n1\n2\n3\n4\n\n\nå¯ä»¥çåºæ¯ä¸ªäºä»¶å¯ä»¥è¢«å½æä¸ä¸ªä½åï¼ä»èç»æäºä»¶éæ´æ°ãä¾å¦ï¼\n\nint interestSet = SelectionKey.OP_READ | SelectionKey.OP_WRITE;\n\n\n1\n\n\n# 3. çå¬äºä»¶\n\nint num = selector.select();\n\n\n1\n\n\nä½¿ç¨ select() æ¥çå¬å°è¾¾çäºä»¶ï¼å®ä¼ä¸ç´é»å¡ç´å°æè³å°ä¸ä¸ªäºä»¶å°è¾¾ã\n\n# 4. è·åå°è¾¾çäºä»¶\n\nSet<SelectionKey> keys = selector.selectedKeys();\nIterator<SelectionKey> keyIterator = keys.iterator();\nwhile (keyIterator.hasNext()) {\n    SelectionKey key = keyIterator.next();\n    if (key.isAcceptable()) {\n        // ...\n    } else if (key.isReadable()) {\n        // ...\n    }\n    keyIterator.remove();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n# 5. äºä»¶å¾ªç¯\n\nå ä¸ºä¸æ¬¡ select() è°ç¨ä¸è½å¤çå®ææçäºä»¶ï¼å¹¶ä¸æå¡å¨ç«¯æå¯è½éè¦ä¸ç´çå¬äºä»¶ï¼å æ­¤æå¡å¨ç«¯å¤çäºä»¶çä»£ç ä¸è¬ä¼æ¾å¨ä¸ä¸ªæ­»å¾ªç¯åã\n\nwhile (true) {\n    int num = selector.select();\n    Set<SelectionKey> keys = selector.selectedKeys();\n    Iterator<SelectionKey> keyIterator = keys.iterator();\n    while (keyIterator.hasNext()) {\n        SelectionKey key = keyIterator.next();\n        if (key.isAcceptable()) {\n            // ...\n        } else if (key.isReadable()) {\n            // ...\n        }\n        keyIterator.remove();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# å¥æ¥å­ NIO å®ä¾\n\npublic class NIOServer {\n\n    public static void main(String[] args) throws IOException {\n\n        Selector selector = Selector.open();\n\n        ServerSocketChannel ssChannel = ServerSocketChannel.open();\n        ssChannel.configureBlocking(false);\n        ssChannel.register(selector, SelectionKey.OP_ACCEPT);\n\n        ServerSocket serverSocket = ssChannel.socket();\n        InetSocketAddress address = new InetSocketAddress("127.0.0.1", 8888);\n        serverSocket.bind(address);\n\n        while (true) {\n            // è½®è®­æ³¨åå°selectorçå¤ä¸ªééï¼çå¬ééä¸çIOäºä»¶æ¯å¦å°è¾¾ï¼å ä¸ºéééç½®æéé»å¡ï¼æä»¥selectorä¸ä¼å¨ééä¸é»å¡èæ¯è½®è®­å¶ä»ééï¼\n            // å¨æ²¡æééä¸çIOäºä»¶å°è¾¾æ¶ï¼selectorä»å¤é¨æ¥çæ¯é»å¡å¨æ­¤çï¼å³è¿éçselectæ¹æ³ã\n            selector.select();\n            Set<SelectionKey> keys = selector.selectedKeys();\n            Iterator<SelectionKey> keyIterator = keys.iterator();\n\n            while (keyIterator.hasNext()) {\n\n                SelectionKey key = keyIterator.next();\n                // ééæacceptäºä»¶å°è¾¾\n                if (key.isAcceptable()) {\n                    // è·åäºä»¶å°è¾¾çééï¼è¿éå ä¸ºå·²ç»å¤æ­åºæ¯acceptäºä»¶ï¼æä»¥ééç¸åºä¸ºServerSocketChannelï¼\n                    \n                    ServerSocketChannel ssChannel1 = (ServerSocketChannel) key.channel();\n\n                    // æå¡å¨ä¼ä¸ºæ¯ä¸ªæ°è¿æ¥åå»ºä¸ä¸ª SocketChannel\n                    // å ä¸ºééä¸å·²ç»çå¬å°acceptäºä»¶ï¼æä»¥è¿éç´æ¥è°ç¨acceptæ¹æ³å¯ä»¥ç´æ¥å¾å°ä¸ä¸ªSocketChannel\n                    SocketChannel sChannel = ssChannel1.accept();\n                    sChannel.configureBlocking(false);\n\n                    // è¿ä¸ªæ°è¿æ¥ä¸»è¦ç¨äºä»å®¢æ·ç«¯è¯»åæ°æ®\n                    // åæ ·æè¿ä¸ªç¨æ¥éè¿socketè¿è¡è¯»åçééæ³¨åå°selectorï¼ä»èçå¬IOè¯»äºä»¶\n                    sChannel.register(selector, SelectionKey.OP_READ);\n\n                } else if (key.isReadable()) {\n\n                    SocketChannel sChannel = (SocketChannel) key.channel();\n                    System.out.println(readDataFromSocketChannel(sChannel));\n                    sChannel.close();\n                }\n                // å¤çå®ééä¸çIOäºä»¶åï¼ä»å°è¾¾äºä»¶åè¡¨ä¸­å é¤ï¼é¿åéå¤å¤ç\n                keyIterator.remove();\n            }\n        }\n    }\n\n    private static String readDataFromSocketChannel(SocketChannel sChannel) throws IOException {\n\n        ByteBuffer buffer = ByteBuffer.allocate(1024);\n        StringBuilder data = new StringBuilder();\n\n        while (true) {\n\n            buffer.clear();\n            int n = sChannel.read(buffer);\n            if (n == -1) {\n                break;\n            }\n            buffer.flip();\n            int limit = buffer.limit();\n            char[] dst = new char[limit];\n            for (int i = 0; i < limit; i++) {\n                dst[i] = (char) buffer.get(i);\n            }\n            data.append(dst);\n            buffer.clear();\n        }\n        return data.toString();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n\n\n\n# åå­æ å°æä»¶\n\nåå­æ å°æä»¶ I/O æ¯ä¸ç§è¯»ååæä»¶æ°æ®çæ¹æ³ï¼å®å¯ä»¥æ¯å¸¸è§çåºäºæµæèåºäºééç I/O å¿«å¾å¤ã\n\nååå­æ å°æä»¶åå¥å¯è½æ¯å±é©çï¼åªæ¯æ¹åæ°ç»çåä¸ªåç´ è¿æ ·çç®åæä½ï¼å°±å¯è½ä¼ç´æ¥ä¿®æ¹ç£çä¸çæä»¶ãä¿®æ¹æ°æ®ä¸å°æ°æ®ä¿å­å°ç£çæ¯æ²¡æåå¼çã\n\nä¸é¢ä»£ç è¡å°æä»¶çå 1024 ä¸ªå­èæ å°å°åå­ä¸­ï¼map() æ¹æ³è¿åä¸ä¸ª MappedByteBufferï¼å®æ¯ ByteBuffer çå­ç±»ãå æ­¤ï¼å¯ä»¥åä½¿ç¨å¶ä»ä»»ä½ ByteBuffer ä¸æ ·ä½¿ç¨æ°æ å°çç¼å²åºï¼æä½ç³»ç»ä¼å¨éè¦æ¶è´è´£æ§è¡æ å°ã\n\nMappedByteBuffer mbb = fc.map(FileChannel.MapMode.READ_WRITE, 0, 1024);\n\n\n1\n\n\n\n# å¯¹æ¯\n\nNIO ä¸æ®é I/O çåºå«ä¸»è¦æä»¥ä¸ä¸¤ç¹ï¼\n\n * NIO æ¯éé»å¡çï¼\n * NIO é¢ååï¼I/O é¢åæµã',normalizedContent:'# ä¸ãæ¦è§\n\njava ç i/o å¤§æ¦å¯ä»¥åæä»¥ä¸å ç±»ï¼\n\n * ç£çæä½ï¼file\n * å­èæä½ï¼inputstream å outputstream\n * å­ç¬¦æä½ï¼reader å writer\n * å¯¹è±¡æä½ï¼serializable\n * ç½ç»æä½ï¼socket\n * æ°çè¾å¥/è¾åºï¼nio\n\n\n# äºãç£çæä½\n\nfile ç±»å¯ä»¥ç¨äºè¡¨ç¤ºæä»¶åç®å½çä¿¡æ¯ï¼ä½æ¯å®ä¸è¡¨ç¤ºæä»¶çåå®¹ã\n\néå½å°ååºä¸ä¸ªç®å½ä¸æææä»¶ï¼\n\npublic static void listallfiles(file dir) {\n    if (dir == null || !dir.exists()) {\n        return;\n    }\n    if (dir.isfile()) {\n        system.out.println(dir.getname());\n        return;\n    }\n    for (file file : dir.listfiles()) {\n        listallfiles(file);\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä» java7 å¼å§ï¼å¯ä»¥ä½¿ç¨ paths å files ä»£æ¿ fileã\n\n\n# ä¸ãå­èæä½\n\n\n# å®ç°æä»¶å¤å¶\n\npublic static void copyfile(string src, string dist) throws ioexception {\n    fileinputstream in = new fileinputstream(src);\n    fileoutputstream out = new fileoutputstream(dist);\n\n    byte[] buffer = new byte[20 * 1024];\n    int cnt;\n\n    // read() æå¤è¯»å buffer.length ä¸ªå­è\n    // è¿åçæ¯å®éè¯»åçä¸ªæ°\n    // è¿å -1 çæ¶åè¡¨ç¤ºè¯»å° eofï¼å³æä»¶å°¾\n    while ((cnt = in.read(buffer, 0, buffer.length)) != -1) {\n        out.write(buffer, 0, cnt);\n    }\n\n    in.close();\n    out.close();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n# è£é¥°èæ¨¡å¼\n\njava i/o ä½¿ç¨äºè£é¥°èæ¨¡å¼æ¥å®ç°ãä»¥ inputstream ä¸ºä¾ï¼\n\n * inputstream æ¯æ½è±¡ç»ä»¶ï¼\n * fileinputstream æ¯ inputstream çå­ç±»ï¼å±äºå·ä½ç»ä»¶ï¼æä¾äºå­èæµçè¾å¥æä½ï¼\n * filterinputstream å±äºæ½è±¡è£é¥°èï¼è£é¥°èç¨äºè£é¥°ç»ä»¶ï¼ä¸ºç»ä»¶æä¾é¢å¤çåè½ãä¾å¦ bufferedinputstream ä¸º fileinputstream æä¾ç¼å­çåè½ã\n\n\n\nå®ä¾åä¸ä¸ªå·æç¼å­åè½çå­èæµå¯¹è±¡æ¶ï¼åªéè¦å¨ fileinputstream å¯¹è±¡ä¸åå¥ä¸å± bufferedinputstream å¯¹è±¡å³å¯ã\n\nfileinputstream fileinputstream = new fileinputstream(filepath);\nbufferedinputstream bufferedinputstream = new bufferedinputstream(fileinputstream);\n\n\n1\n2\n\n\ndatainputstream è£é¥°èæä¾äºå¯¹æ´å¤æ°æ®ç±»åè¿è¡è¾å¥çæä½ï¼æ¯å¦ intãdouble ç­åºæ¬ç±»åã\n\n\n# åãå­ç¬¦æä½\n\n\n# ç¼ç ä¸è§£ç \n\nç¼ç å°±æ¯æå­ç¬¦è½¬æ¢ä¸ºå­èï¼èè§£ç æ¯æå­èéæ°ç»åæå­ç¬¦ã\n\nå¦æç¼ç åè§£ç è¿ç¨ä½¿ç¨ä¸åçç¼ç æ¹å¼é£ä¹å°±åºç°äºä¹±ç ã\n\n * gbk ç¼ç ä¸­ï¼ä¸­æå­ç¬¦å  2 ä¸ªå­èï¼è±æå­ç¬¦å  1 ä¸ªå­èï¼\n * utf-8 ç¼ç ä¸­ï¼ä¸­æå­ç¬¦å  3 ä¸ªå­èï¼è±æå­ç¬¦å  1 ä¸ªå­èï¼\n * utf-16be ç¼ç ä¸­ï¼ä¸­æå­ç¬¦åè±æå­ç¬¦é½å  2 ä¸ªå­èã\n\nutf-16be ä¸­ç be æçæ¯ big endianï¼ä¹å°±æ¯å¤§ç«¯ãç¸åºå°ä¹æ utf-16leï¼le æçæ¯ little endianï¼ä¹å°±æ¯å°ç«¯ã\n\njava çåå­ç¼ç ä½¿ç¨åå­èç¼ç  utf-16beï¼è¿ä¸æ¯æ java åªæ¯æè¿ä¸ç§ç¼ç æ¹å¼ï¼èæ¯è¯´ char è¿ç§ç±»åä½¿ç¨ utf-16be è¿è¡ç¼ç ãchar ç±»åå  16 ä½ï¼ä¹å°±æ¯ä¸¤ä¸ªå­èï¼java ä½¿ç¨è¿ç§åå­èç¼ç æ¯ä¸ºäºè®©ä¸ä¸ªä¸­ææèä¸ä¸ªè±æé½è½ä½¿ç¨ä¸ä¸ª char æ¥å­å¨ã\n\n\n# string çç¼ç æ¹å¼\n\nstring å¯ä»¥çæä¸ä¸ªå­ç¬¦åºåï¼å¯ä»¥æå®ä¸ä¸ªç¼ç æ¹å¼å°å®ç¼ç ä¸ºå­èåºåï¼ä¹å¯ä»¥æå®ä¸ä¸ªç¼ç æ¹å¼å°ä¸ä¸ªå­èåºåè§£ç ä¸º stringã\n\nstring str1 = "ä¸­æ";\nbyte[] bytes = str1.getbytes("utf-8");\nstring str2 = new string(bytes, "utf-8");\nsystem.out.println(str2);\n\n\n1\n2\n3\n4\n\n\nå¨è°ç¨æ åæ° getbytes() æ¹æ³æ¶ï¼é»è®¤çç¼ç æ¹å¼ä¸æ¯ utf-16beãåå­èç¼ç çå¥½å¤æ¯å¯ä»¥ä½¿ç¨ä¸ä¸ª char å­å¨ä¸­æåè±æï¼èå° string è½¬ä¸º bytes[] å­èæ°ç»å°±ä¸åéè¦è¿ä¸ªå¥½å¤ï¼å æ­¤ä¹å°±ä¸åéè¦åå­èç¼ç ãgetbytes() çé»è®¤ç¼ç æ¹å¼ä¸å¹³å°æå³ï¼ä¸è¬ä¸º utf-8ã\n\nbyte[] bytes = str1.getbytes();\n\n\n1\n\n\n\n# reader ä¸ writer\n\nä¸ç®¡æ¯ç£çè¿æ¯ç½ç»ä¼ è¾ï¼æå°çå­å¨ååé½æ¯å­èï¼èä¸æ¯å­ç¬¦ãä½æ¯å¨ç¨åºä¸­æä½çéå¸¸æ¯å­ç¬¦å½¢å¼çæ°æ®ï¼å æ­¤éè¦æä¾å¯¹å­ç¬¦è¿è¡æä½çæ¹æ³ã\n\n * inputstreamreader å®ç°ä»å­èæµè§£ç æå­ç¬¦æµï¼\n * outputstreamwriter å®ç°å­ç¬¦æµç¼ç æä¸ºå­èæµã\n\n\n# å®ç°éè¡è¾åºææ¬æä»¶çåå®¹\n\npublic static void readfilecontent(string filepath) throws ioexception {\n\n    filereader filereader = new filereader(filepath);\n    bufferedreader bufferedreader = new bufferedreader(filereader);\n\n    string line;\n    while ((line = bufferedreader.readline()) != null) {\n        system.out.println(line);\n    }\n\n    // è£é¥°èæ¨¡å¼ä½¿å¾ bufferedreader ç»åäºä¸ä¸ª reader å¯¹è±¡\n    // å¨è°ç¨ bufferedreader ç close() æ¹æ³æ¶ä¼å»è°ç¨ reader ç close() æ¹æ³\n    // å æ­¤åªè¦ä¸ä¸ª close() è°ç¨å³å¯\n    bufferedreader.close();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# äºãå¯¹è±¡æä½\n\n\n# åºåå\n\nåºååå°±æ¯å°ä¸ä¸ªå¯¹è±¡è½¬æ¢æå­èåºåï¼æ¹ä¾¿å­å¨åä¼ è¾ã\n\n * åºååï¼objectoutputstream.writeobject()\n * ååºååï¼objectinputstream.readobject()\n\nä¸ä¼å¯¹éæåéè¿è¡åºååï¼å ä¸ºåºåååªæ¯ä¿å­å¯¹è±¡çç¶æï¼éæåéå±äºç±»çç¶æã\n\n\n# serializable\n\nåºååçç±»éè¦å®ç° serializable æ¥å£ï¼å®åªæ¯ä¸ä¸ªæ åï¼æ²¡æä»»ä½æ¹æ³éè¦å®ç°ï¼ä½æ¯å¦æä¸å»å®ç°å®çè¯èè¿è¡åºååï¼ä¼æåºå¼å¸¸ã\n\npublic static void main(string[] args) throws ioexception, classnotfoundexception {\n\n    a a1 = new a(123, "abc");\n    string objectfile = "file/a1";\n\n    objectoutputstream objectoutputstream = new objectoutputstream(new fileoutputstream(objectfile));\n    objectoutputstream.writeobject(a1);\n    objectoutputstream.close();\n\n    objectinputstream objectinputstream = new objectinputstream(new fileinputstream(objectfile));\n    a a2 = (a) objectinputstream.readobject();\n    objectinputstream.close();\n    system.out.println(a2);\n}\n\nprivate static class a implements serializable {\n\n    private int x;\n    private string y;\n\n    a(int x, string y) {\n        this.x = x;\n        this.y = y;\n    }\n\n    @override\n    public string tostring() {\n        return "x = " + x + "  " + "y = " + y;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\n\n# transient\n\ntransient å³é®å­å¯ä»¥ä½¿ä¸äºå±æ§ä¸ä¼è¢«åºååã\n\narraylist ä¸­å­å¨æ°æ®çæ°ç» elementdata æ¯ç¨ transient ä¿®é¥°çï¼å ä¸ºè¿ä¸ªæ°ç»æ¯å¨ææ©å±çï¼å¹¶ä¸æ¯ææçç©ºé´é½è¢«ä½¿ç¨ï¼å æ­¤å°±ä¸éè¦ææçåå®¹é½è¢«åºååãéè¿éååºåååååºååæ¹æ³ï¼ä½¿å¾å¯ä»¥åªåºååæ°ç»ä¸­æåå®¹çé£é¨åæ°æ®ã\n\nprivate transient object[] elementdata;\n\n\n1\n\n\n\n# å­ãç½ç»æä½\n\njava ä¸­çç½ç»æ¯æï¼\n\n * inetaddressï¼ç¨äºè¡¨ç¤ºç½ç»ä¸çç¡¬ä»¶èµæºï¼å³ ip å°åï¼\n * urlï¼ç»ä¸èµæºå®ä½ç¬¦ï¼\n * socketsï¼ä½¿ç¨ tcp åè®®å®ç°ç½ç»éä¿¡ï¼\n * datagramï¼ä½¿ç¨ udp åè®®å®ç°ç½ç»éä¿¡ã\n\n\n# inetaddress\n\næ²¡æå¬æçæé å½æ°ï¼åªè½éè¿éææ¹æ³æ¥åå»ºå®ä¾ã\n\ninetaddress.getbyname(string host);\ninetaddress.getbyaddress(byte[] address);\n\n\n1\n2\n\n\n\n# url\n\nå¯ä»¥ç´æ¥ä» url ä¸­è¯»åå­èæµæ°æ®ã\n\npublic static void main(string[] args) throws ioexception {\n\n    url url = new url("http://www.baidu.com");\n\n    /* å­èæµ */\n    inputstream is = url.openstream();\n\n    /* å­ç¬¦æµ */\n    inputstreamreader isr = new inputstreamreader(is, "utf-8");\n\n    /* æä¾ç¼å­åè½ */\n    bufferedreader br = new bufferedreader(isr);\n\n    string line;\n    while ((line = br.readline()) != null) {\n        system.out.println(line);\n    }\n\n    br.close();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n\n# sockets\n\n * serversocketï¼æå¡å¨ç«¯ç±»\n * socketï¼å®¢æ·ç«¯ç±»\n * æå¡å¨åå®¢æ·ç«¯éè¿ inputstream å outputstream è¿è¡è¾å¥è¾åºã\n\n\n\n\n# datagram\n\n * datagramsocketï¼éä¿¡ç±»\n * datagrampacketï¼æ°æ®åç±»\n\n\n# ä¸ãnio\n\næ°çè¾å¥/è¾åº (nio) åºæ¯å¨ jdk 1.4 ä¸­å¼å¥çï¼å¼¥è¡¥äºåæ¥ç i/o çä¸è¶³ï¼æä¾äºé«éçãé¢ååç i/oã\n\n\n# æµä¸å\n\ni/o ä¸ nio æéè¦çåºå«æ¯æ°æ®æååä¼ è¾çæ¹å¼ï¼i/o ä»¥æµçæ¹å¼å¤çæ°æ®ï¼è nio ä»¥åçæ¹å¼å¤çæ°æ®ã\n\né¢åæµç i/o ä¸æ¬¡å¤çä¸ä¸ªå­èæ°æ®ï¼ä¸ä¸ªè¾å¥æµäº§çä¸ä¸ªå­èæ°æ®ï¼ä¸ä¸ªè¾åºæµæ¶è´¹ä¸ä¸ªå­èæ°æ®ãä¸ºæµå¼æ°æ®åå»ºè¿æ»¤å¨éå¸¸å®¹æï¼é¾æ¥å ä¸ªè¿æ»¤å¨ï¼ä»¥ä¾¿æ¯ä¸ªè¿æ»¤å¨åªè´è´£å¤æå¤çæºå¶çä¸é¨åãä¸å©çä¸é¢æ¯ï¼é¢åæµç i/o éå¸¸ç¸å½æ¢ã\n\né¢ååç i/o ä¸æ¬¡å¤çä¸ä¸ªæ°æ®åï¼æåå¤çæ°æ®æ¯ææµå¤çæ°æ®è¦å¿«å¾å¤ãä½æ¯é¢ååç i/o ç¼ºå°ä¸äºé¢åæµç i/o æå·æçä¼éæ§åç®åæ§ã\n\ni/o åå nio å·²ç»å¾å¥½å°éæäºï¼java.io.* å·²ç»ä»¥ nio ä¸ºåºç¡éæ°å®ç°äºï¼æä»¥ç°å¨å®å¯ä»¥å©ç¨ nio çä¸äºç¹æ§ãä¾å¦ï¼java.io.* åä¸­çä¸äºç±»åå«ä»¥åçå½¢å¼è¯»åæ°æ®çæ¹æ³ï¼è¿ä½¿å¾å³ä½¿å¨é¢åæµçç³»ç»ä¸­ï¼å¤çéåº¦ä¹ä¼æ´å¿«ã\n\n\n# ééä¸ç¼å²åº\n\n# 1. éé\n\néé channel æ¯å¯¹å i/o åä¸­çæµçæ¨¡æï¼å¯ä»¥éè¿å®è¯»åååå¥æ°æ®ã\n\nééä¸æµçä¸åä¹å¤å¨äºï¼æµåªè½å¨ä¸ä¸ªæ¹åä¸ç§»å¨(ä¸ä¸ªæµå¿é¡»æ¯ inputstream æè outputstream çå­ç±»)ï¼èééæ¯ååçï¼å¯ä»¥ç¨äºè¯»ãåæèåæ¶ç¨äºè¯»åã\n\nééåæ¬ä»¥ä¸ç±»åï¼\n\n * filechannelï¼ä»æä»¶ä¸­è¯»åæ°æ®ï¼\n * datagramchannelï¼éè¿ udp è¯»åç½ç»ä¸­æ°æ®ï¼\n * socketchannelï¼éè¿ tcp è¯»åç½ç»ä¸­æ°æ®ï¼\n * serversocketchannelï¼å¯ä»¥çå¬æ°è¿æ¥ç tcp è¿æ¥ï¼å¯¹æ¯ä¸ä¸ªæ°è¿æ¥çè¿æ¥é½ä¼åå»ºä¸ä¸ª socketchannelã\n\n# 2. ç¼å²åº\n\nåéç»ä¸ä¸ªééçæææ°æ®é½å¿é¡»é¦åæ¾å°ç¼å²åºä¸­ï¼åæ ·å°ï¼ä»ééä¸­è¯»åçä»»ä½æ°æ®é½è¦åè¯»å°ç¼å²åºä¸­ãä¹å°±æ¯è¯´ï¼ä¸ä¼ç´æ¥å¯¹ééè¿è¡è¯»åæ°æ®ï¼èæ¯è¦åç»è¿ç¼å²åºã\n\nç¼å²åºå®è´¨ä¸æ¯ä¸ä¸ªæ°ç»ï¼ä½å®ä¸ä»ä»æ¯ä¸ä¸ªæ°ç»ãç¼å²åºæä¾äºå¯¹æ°æ®çç»æåè®¿é®ï¼èä¸è¿å¯ä»¥è·è¸ªç³»ç»çè¯»/åè¿ç¨ã\n\nç¼å²åºåæ¬ä»¥ä¸ç±»åï¼\n\n * bytebuffer\n * charbuffer\n * shortbuffer\n * intbuffer\n * longbuffer\n * floatbuffer\n * doublebuffer\n\n\n# ç¼å²åºç¶æåé\n\n * capacityï¼æå¤§å®¹éï¼\n * positionï¼å½åå·²ç»è¯»åçå­èæ°ï¼\n * limitï¼è¿å¯ä»¥è¯»åçå­èæ°ã\n\nç¶æåéçæ¹åè¿ç¨ä¸¾ä¾ï¼\n\nâ  æ°å»ºä¸ä¸ªå¤§å°ä¸º 8 ä¸ªå­èçç¼å²åºï¼æ­¤æ¶ position ä¸º 0ï¼è limit = capacity = 8ãcapacity åéä¸ä¼æ¹åï¼ä¸é¢çè®¨è®ºä¼å¿½ç¥å®ã\n\n\n\nâ¡ ä»è¾å¥ééä¸­è¯»å 5 ä¸ªå­èæ°æ®åå¥ç¼å²åºä¸­ï¼æ­¤æ¶ position ä¸º 5ï¼limit ä¿æä¸åã\n\n\n\nâ¢ å¨å°ç¼å²åºçæ°æ®åå°è¾åºééä¹åï¼éè¦åè°ç¨ flip() æ¹æ³ï¼è¿ä¸ªæ¹æ³å° limit è®¾ç½®ä¸ºå½å positionï¼å¹¶å° position è®¾ç½®ä¸º 0ã\n\n\n\nâ£ ä»ç¼å²åºä¸­å 4 ä¸ªå­èå°è¾åºç¼å²ä¸­ï¼æ­¤æ¶ position è®¾ä¸º 4ã\n\n\n\nâ¤ æåéè¦è°ç¨ clear() æ¹æ³æ¥æ¸ç©ºç¼å²åºï¼æ­¤æ¶ position å limit é½è¢«è®¾ç½®ä¸ºæåä½ç½®ã\n\n\n\n\n# æä»¶ nio å®ä¾\n\nä»¥ä¸å±ç¤ºäºä½¿ç¨ nio å¿«éå¤å¶æä»¶çå®ä¾ï¼\n\npublic static void fastcopy(string src, string dist) throws ioexception {\n\n    /* è·å¾æºæä»¶çè¾å¥å­èæµ */\n    fileinputstream fin = new fileinputstream(src);\n\n    /* è·åè¾å¥å­èæµçæä»¶éé */\n    filechannel fcin = fin.getchannel();\n\n    /* è·åç®æ æä»¶çè¾åºå­èæµ */\n    fileoutputstream fout = new fileoutputstream(dist);\n\n    /* è·åè¾åºå­èæµçæä»¶éé */\n    filechannel fcout = fout.getchannel();\n\n    /* ä¸ºç¼å²åºåé 1024 ä¸ªå­è */\n    bytebuffer buffer = bytebuffer.allocatedirect(1024);\n\n    while (true) {\n\n        /* ä»è¾å¥ééä¸­è¯»åæ°æ®å°ç¼å²åºä¸­ */\n        int r = fcin.read(buffer);\n\n        /* read() è¿å -1 è¡¨ç¤º eof */\n        if (r == -1) {\n            break;\n        }\n\n        /* åæ¢è¯»å */\n        buffer.flip();\n\n        /* æç¼å²åºçåå®¹åå¥è¾åºæä»¶ä¸­ */\n        fcout.write(buffer);\n\n        /* æ¸ç©ºç¼å²åº */\n        buffer.clear();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n\n\n\n# éæ©å¨\n\nnio å¸¸å¸¸è¢«å«åéé»å¡ ioï¼ä¸»è¦æ¯å ä¸º nio å¨ç½ç»éä¿¡ä¸­çéé»å¡ç¹æ§è¢«å¹¿æ³ä½¿ç¨ã\n\nnio å®ç°äº io å¤è·¯å¤ç¨ä¸­ç reactor æ¨¡åï¼ä¸ä¸ªçº¿ç¨ thread ä½¿ç¨ä¸ä¸ªéæ©å¨ selector éè¿è½®è¯¢çæ¹å¼å»çå¬å¤ä¸ªéé channel ä¸çäºä»¶ï¼ä»èè®©ä¸ä¸ªçº¿ç¨å°±å¯ä»¥å¤çå¤ä¸ªäºä»¶ã\n\néè¿éç½®çå¬çéé channel ä¸ºéé»å¡ï¼é£ä¹å½ channel ä¸ç io äºä»¶è¿æªå°è¾¾æ¶ï¼å°±ä¸ä¼è¿å¥é»å¡ç¶æä¸ç´ç­å¾ï¼èæ¯ç»§ç»­è½®è¯¢å¶å® channelï¼æ¾å° io äºä»¶å·²ç»å°è¾¾ç channel æ§è¡ã\n\nå ä¸ºåå»ºååæ¢çº¿ç¨çå¼éå¾å¤§ï¼å æ­¤ä½¿ç¨ä¸ä¸ªçº¿ç¨æ¥å¤çå¤ä¸ªäºä»¶èä¸æ¯ä¸ä¸ªçº¿ç¨å¤çä¸ä¸ªäºä»¶ï¼å¯¹äº io å¯éåçåºç¨å·æå¾å¥½å°æ§è½ã\n\nåºè¯¥æ³¨æçæ¯ï¼åªæå¥æ¥å­ channel æè½éç½®ä¸ºéé»å¡ï¼è filechannel ä¸è½ï¼ä¸º filechannel éç½®éé»å¡ä¹æ²¡ææä¹ã\n\n\n\n# 1. åå»ºéæ©å¨\n\nselector selector = selector.open();\n\n\n1\n\n\n# 2. å°ééæ³¨åå°éæ©å¨ä¸\n\nserversocketchannel sschannel = serversocketchannel.open();\nsschannel.configureblocking(false);\nsschannel.register(selector, selectionkey.op_accept);\n\n\n1\n2\n3\n\n\nééå¿é¡»éç½®ä¸ºéé»å¡æ¨¡å¼ï¼å¦åä½¿ç¨éæ©å¨å°±æ²¡æä»»ä½æä¹äºï¼å ä¸ºå¦æééå¨æä¸ªäºä»¶ä¸è¢«é»å¡ï¼é£ä¹æå¡å¨å°±ä¸è½ååºå¶å®äºä»¶ï¼å¿é¡»ç­å¾è¿ä¸ªäºä»¶å¤çå®æ¯æè½å»å¤çå¶å®äºä»¶ï¼æ¾ç¶è¿åéæ©å¨çä½ç¨èéèé©°ã\n\nå¨å°ééæ³¨åå°éæ©å¨ä¸æ¶ï¼è¿éè¦æå®è¦æ³¨åçå·ä½äºä»¶ï¼ä¸»è¦æä»¥ä¸å ç±»ï¼\n\n * selectionkey.op_connect\n * selectionkey.op_accept\n * selectionkey.op_read\n * selectionkey.op_write\n\nå®ä»¬å¨ selectionkey çå®ä¹å¦ä¸ï¼\n\npublic static final int op_read = 1 << 0;\npublic static final int op_write = 1 << 2;\npublic static final int op_connect = 1 << 3;\npublic static final int op_accept = 1 << 4;\n\n\n1\n2\n3\n4\n\n\nå¯ä»¥çåºæ¯ä¸ªäºä»¶å¯ä»¥è¢«å½æä¸ä¸ªä½åï¼ä»èç»æäºä»¶éæ´æ°ãä¾å¦ï¼\n\nint interestset = selectionkey.op_read | selectionkey.op_write;\n\n\n1\n\n\n# 3. çå¬äºä»¶\n\nint num = selector.select();\n\n\n1\n\n\nä½¿ç¨ select() æ¥çå¬å°è¾¾çäºä»¶ï¼å®ä¼ä¸ç´é»å¡ç´å°æè³å°ä¸ä¸ªäºä»¶å°è¾¾ã\n\n# 4. è·åå°è¾¾çäºä»¶\n\nset<selectionkey> keys = selector.selectedkeys();\niterator<selectionkey> keyiterator = keys.iterator();\nwhile (keyiterator.hasnext()) {\n    selectionkey key = keyiterator.next();\n    if (key.isacceptable()) {\n        // ...\n    } else if (key.isreadable()) {\n        // ...\n    }\n    keyiterator.remove();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n# 5. äºä»¶å¾ªç¯\n\nå ä¸ºä¸æ¬¡ select() è°ç¨ä¸è½å¤çå®ææçäºä»¶ï¼å¹¶ä¸æå¡å¨ç«¯æå¯è½éè¦ä¸ç´çå¬äºä»¶ï¼å æ­¤æå¡å¨ç«¯å¤çäºä»¶çä»£ç ä¸è¬ä¼æ¾å¨ä¸ä¸ªæ­»å¾ªç¯åã\n\nwhile (true) {\n    int num = selector.select();\n    set<selectionkey> keys = selector.selectedkeys();\n    iterator<selectionkey> keyiterator = keys.iterator();\n    while (keyiterator.hasnext()) {\n        selectionkey key = keyiterator.next();\n        if (key.isacceptable()) {\n            // ...\n        } else if (key.isreadable()) {\n            // ...\n        }\n        keyiterator.remove();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# å¥æ¥å­ nio å®ä¾\n\npublic class nioserver {\n\n    public static void main(string[] args) throws ioexception {\n\n        selector selector = selector.open();\n\n        serversocketchannel sschannel = serversocketchannel.open();\n        sschannel.configureblocking(false);\n        sschannel.register(selector, selectionkey.op_accept);\n\n        serversocket serversocket = sschannel.socket();\n        inetsocketaddress address = new inetsocketaddress("127.0.0.1", 8888);\n        serversocket.bind(address);\n\n        while (true) {\n            // è½®è®­æ³¨åå°selectorçå¤ä¸ªééï¼çå¬ééä¸çioäºä»¶æ¯å¦å°è¾¾ï¼å ä¸ºéééç½®æéé»å¡ï¼æä»¥selectorä¸ä¼å¨ééä¸é»å¡èæ¯è½®è®­å¶ä»ééï¼\n            // å¨æ²¡æééä¸çioäºä»¶å°è¾¾æ¶ï¼selectorä»å¤é¨æ¥çæ¯é»å¡å¨æ­¤çï¼å³è¿éçselectæ¹æ³ã\n            selector.select();\n            set<selectionkey> keys = selector.selectedkeys();\n            iterator<selectionkey> keyiterator = keys.iterator();\n\n            while (keyiterator.hasnext()) {\n\n                selectionkey key = keyiterator.next();\n                // ééæacceptäºä»¶å°è¾¾\n                if (key.isacceptable()) {\n                    // è·åäºä»¶å°è¾¾çééï¼è¿éå ä¸ºå·²ç»å¤æ­åºæ¯acceptäºä»¶ï¼æä»¥ééç¸åºä¸ºserversocketchannelï¼\n                    \n                    serversocketchannel sschannel1 = (serversocketchannel) key.channel();\n\n                    // æå¡å¨ä¼ä¸ºæ¯ä¸ªæ°è¿æ¥åå»ºä¸ä¸ª socketchannel\n                    // å ä¸ºééä¸å·²ç»çå¬å°acceptäºä»¶ï¼æä»¥è¿éç´æ¥è°ç¨acceptæ¹æ³å¯ä»¥ç´æ¥å¾å°ä¸ä¸ªsocketchannel\n                    socketchannel schannel = sschannel1.accept();\n                    schannel.configureblocking(false);\n\n                    // è¿ä¸ªæ°è¿æ¥ä¸»è¦ç¨äºä»å®¢æ·ç«¯è¯»åæ°æ®\n                    // åæ ·æè¿ä¸ªç¨æ¥éè¿socketè¿è¡è¯»åçééæ³¨åå°selectorï¼ä»èçå¬ioè¯»äºä»¶\n                    schannel.register(selector, selectionkey.op_read);\n\n                } else if (key.isreadable()) {\n\n                    socketchannel schannel = (socketchannel) key.channel();\n                    system.out.println(readdatafromsocketchannel(schannel));\n                    schannel.close();\n                }\n                // å¤çå®ééä¸çioäºä»¶åï¼ä»å°è¾¾äºä»¶åè¡¨ä¸­å é¤ï¼é¿åéå¤å¤ç\n                keyiterator.remove();\n            }\n        }\n    }\n\n    private static string readdatafromsocketchannel(socketchannel schannel) throws ioexception {\n\n        bytebuffer buffer = bytebuffer.allocate(1024);\n        stringbuilder data = new stringbuilder();\n\n        while (true) {\n\n            buffer.clear();\n            int n = schannel.read(buffer);\n            if (n == -1) {\n                break;\n            }\n            buffer.flip();\n            int limit = buffer.limit();\n            char[] dst = new char[limit];\n            for (int i = 0; i < limit; i++) {\n                dst[i] = (char) buffer.get(i);\n            }\n            data.append(dst);\n            buffer.clear();\n        }\n        return data.tostring();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n\n\n\n# åå­æ å°æä»¶\n\nåå­æ å°æä»¶ i/o æ¯ä¸ç§è¯»ååæä»¶æ°æ®çæ¹æ³ï¼å®å¯ä»¥æ¯å¸¸è§çåºäºæµæèåºäºééç i/o å¿«å¾å¤ã\n\nååå­æ å°æä»¶åå¥å¯è½æ¯å±é©çï¼åªæ¯æ¹åæ°ç»çåä¸ªåç´ è¿æ ·çç®åæä½ï¼å°±å¯è½ä¼ç´æ¥ä¿®æ¹ç£çä¸çæä»¶ãä¿®æ¹æ°æ®ä¸å°æ°æ®ä¿å­å°ç£çæ¯æ²¡æåå¼çã\n\nä¸é¢ä»£ç è¡å°æä»¶çå 1024 ä¸ªå­èæ å°å°åå­ä¸­ï¼map() æ¹æ³è¿åä¸ä¸ª mappedbytebufferï¼å®æ¯ bytebuffer çå­ç±»ãå æ­¤ï¼å¯ä»¥åä½¿ç¨å¶ä»ä»»ä½ bytebuffer ä¸æ ·ä½¿ç¨æ°æ å°çç¼å²åºï¼æä½ç³»ç»ä¼å¨éè¦æ¶è´è´£æ§è¡æ å°ã\n\nmappedbytebuffer mbb = fc.map(filechannel.mapmode.read_write, 0, 1024);\n\n\n1\n\n\n\n# å¯¹æ¯\n\nnio ä¸æ®é i/o çåºå«ä¸»è¦æä»¥ä¸ä¸¤ç¹ï¼\n\n * nio æ¯éé»å¡çï¼\n * nio é¢ååï¼i/o é¢åæµã',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"JDK å¨æä»£ç",frontmatter:{title:"JDK å¨æä»£ç",date:"2022-02-03T19:02:27.000Z",permalink:"/pages/e5ea78/",categories:["é¢è¯","Java","Javaåºç¡"],tags:[null]},regularPath:"/35.%E9%9D%A2%E8%AF%95/05.Java/05.Java%E5%9F%BA%E7%A1%80/30.JDK%20%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86.html",relativePath:"35.é¢è¯/05.Java/05.Javaåºç¡/30.JDK å¨æä»£ç.md",key:"v-52f3ee7a",path:"/pages/e5ea78/",headersStr:null,content:'çäºå¥½å¤å³äºä»£ççæç« ï¼çè§£åæ´çä¸ä¸ã\n\n\n# 1ãä»£ççåºæ¬ææ\n\n * æ½è±¡è§è²ï¼å£°æçå®å¯¹è±¡åä»£çå¯¹è±¡çå±åæ¥å£,è¿æ ·å¯å¨ä»»ä½ä½¿ç¨çå®å¯¹è±¡çå°æ¹é½å¯ä»¥ä½¿ç¨ä»£çå¯¹è±¡ï¼å¤æï¼ã\n * ä»£çè§è²ï¼ä»£çå¯¹è±¡åé¨å«æçå®å¯¹è±¡çå¼ç¨ï¼ä»èå¯ä»¥å¨ä»»ä½æ¶åæä½çå®å¯¹è±¡ãä»£çå¯¹è±¡åçå®å¯¹è±¡å·æç¸åçæ¥å£ï¼è¿æ ·å°±å¯ä»¥å¨ä»»ä½æ¶åæ¿ä»£çå®å¯¹è±¡ãä»£çå¯¹è±¡éå¸¸å¨ ãå®¢æ·ç«¯è°ç¨ä¼ éç»çå®å¯¹è±¡ã ä¹åæä¹åï¼æ§è¡æä¸ªæä½ï¼èä¸æ¯åçº¯å°å°è°ç¨ä¼ éç»çå®å¯¹è±¡ï¼åæ¶ï¼ä»£çå¯¹è±¡å¯ä»¥å¨æ§è¡çå®å¯¹è±¡æä½ååï¼éå å¶ä»çæä½ï¼ç¸å½äºå¯¹çå®å¯¹è±¡è¿è¡å°è£ã\n * çå®è§è²ï¼å³ä¸ºä»£çå¯¹è±¡æä»£è¡¨çç®æ å¯¹è±¡ï¼ä»£çè§è²æä»£è¡¨ççå®å¯¹è±¡ï¼æ¯æä»¬æç»è¦å¼ç¨çå¯¹è±¡ã\n\nä¸å¾æä¸ç§è§è²ï¼Subjectæ½è±¡è§è²ãRealSubjectçå®è§è²ãProxyä»£çè§è²ãå¶ä¸­ï¼Subjectè§è²è´è´£å®ä¹RealSubjectåProxyè§è²åºè¯¥å®ç°çæ¥å£ï¼RealSubjectè§è²ç¨æ¥çæ­£å®æä¸å¡æå¡åè½ï¼Proxyè§è²è´è´£å°èªèº«çrequestè¯·æ±ï¼è°ç¨RealSubjectå¯¹åºçrequeståè½æ¥å®ç°ä¸å¡åè½ï¼èªå·±ä¸çæ­£åä¸å¡ã\n\n\n# 2ãéæä»£ç\n\ninterface Subject//æ½è±¡è§è²\n{  \n    public void doSomething();  \n}\nclass RealSubject implements Subject//çå®è§è²\n{  \n    public void doSomething()  \n  {  \n    System.out.println( "call doSomething()" );  \n  }  \n}\nclass SubjectProxy implements Subject//ä»£çè§è²\n{\n  //ä»£çæ¨¡å¼çä½ç¨æ¯ï¼ä¸ºå¶ä»å¯¹è±¡æä¾ä¸ç§ä»£çä»¥æ§å¶å¯¹è¿ä¸ªå¯¹è±¡çè®¿é®ã\n  Subject subimpl = new RealSubject();\n  public void doSomething()\n  {\n     System.out.println("before"); //è°ç¨ç®æ å¯¹è±¡ä¹åå¯ä»¥åç¸å³æä½\n     subimpl.doSomething();\n     System.out.println("after");//è°ç¨ç®æ å¯¹è±¡ä¹åå¯ä»¥åç¸å³æä½\n  }\n}\n \npublic class Test\n{\n    public static void main(String[] args) throws Exception\n    {\n        Subject sub = new SubjectProxy();\n        sub.doSomething();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n\n\nå¯ä»¥çå°ï¼SubjectProxyå®ç°äºSubjectæ¥å£ï¼åRealSubjectå®ç°ç¸åæ¥å£ï¼ï¼å¹¶ææçæ¯Subjectæ¥å£ç±»åçå¼ç¨ãè¿æ ·è°ç¨çä¾ç¶æ¯doSomethingæ¹æ³ï¼åªæ¯å®ä¾åå¯¹è±¡çè¿ç¨æ¹åäºï¼ç»ææ¥çï¼ä»£çç±»SubjectProxyå¯ä»¥èªå¨ä¸ºæä»¬å ä¸äºbeforeåafterç­æä»¬éè¦çå¨ä½ã\n\nå¦æå°æ¥éè¦å®ç°ä¸ä¸ªæ°çæ¥å£ï¼å°±éè¦å¨ä»£çç±»éååè¯¥æ¥å£çå®ç°æ¹æ³ï¼ä¼å¯¼è´ä»£çç±»çä»£ç åå¾èè¿ï¼å¦ä¸æ¹é¢ï¼å½éè¦æ¹åæ½è±¡è§è²æ¥å£æ¶ï¼æ ççå®è§è²åä»£çè§è²ä¹éè¦æ¹åã\n\n\n# 3ãJDKå¨æä»£ç\n\ninterface Subject  \n{  \n    public void doSomething();  \n}\nclass RealSubject implements Subject  \n{  \n    public void doSomething()  \n  {  \n     System.out.println( "call doSomething()" );  \n  }  \n}\nclass ProxyHandler implements InvocationHandler\n{\n    private Object target;\n    //ä¼ å¥ç®æ å¯¹è±¡ï¼è¿åä»£çå¯¹è±¡\n    public Object getProxyInstance(Object target)\n    {\n        this.target = target;\n        // ä½¿ç¨ Proxy çæç®æ ç±»çä»£çç±»\n        return Proxy.newProxyInstance(target.getClass().getClassLoader(),// çæçä»£çå¯¹è±¡åç®æ å¯¹è±¡ä½¿ç¨åä¸ç±»å è½½å¨\n                                      target.getClass().getInterfaces(),// ç®æ å¯¹è±¡å®ç°çæææ¥å£ï¼å ä¸ºçæçä»£çç±»ä¹éè¦å®ç°è¿äºæ¥å£\n                                      this);// InvocationHandler å¯¹è±¡ï¼\n    } \n    /**\n     * proxy: çæçä»£çå¯¹è±¡\n     * methodï¼ç®æ ç±»æ¹æ³\n     * argsï¼ç®æ ç±»æ¹æ³çåæ°\n     */\n    public Object invoke(Object proxy , Method method , Object[] args)throws Throwable//ä¸ä¾èµå·ä½æ¥å£å®ç°\n    {\n        Object result = null;//è¢«ä»£ççç±»åä¸ºObjectåºç±»\n        //è¿éå°±å¯ä»¥è¿è¡æè°çAOPç¼ç¨äº\n        //å¨è°ç¨ç®æ æ¹æ³åï¼æ§è¡åè½å¤ç\n        result = method.invoke(tar,args);\n        //å¨è°ç¨ç®æ æ¹æ³åï¼æ§è¡åè½å¤ç\n        return result;\n    }\n}\npublic class Test\n{\n    public static void main(String args[])\n    {      // å°JDKå¨æä»£ççæçclassæä»¶ä¿å­å°æ¬å°\n           System.getProperties().put("sun.misc.ProxyGenerator.saveGeneratedFiles", "true");\n           ProxyHandler proxyHandler = new ProxyHandler();\n           // çæä»£çå¯¹è±¡sub\n           Subject sub = (Subject) proxyHandler.getProxyInstance(new RealSubject());\n           // ä½¿ç¨ä»£çå¯¹è±¡è°ç¨doSomething()æ¹æ³ï¼å®éè°ç¨çæ¯ä»£çå¯¹è±¡éçinvokeæ¹æ³ï¼çæçä»£çç±»ç»§æ¿äºProxyï¼éåinvokeæ¹æ³ï¼èinvokeæ¹æ³çé»è¾ç±âåè°å½æ°âInvocationHandleræå®ï¼\n           // çæä»£çç±»è¦ä¹æ¯å®ç°åç®æ ç±»ç¸åçæ¥å£ï¼è¦ä¹æ¯ç´æ¥ç»§æ¿ç®æ ç±»ä½ä¸ºå¶å­ç±»ï¼èJDKå¨æä»£çæºå¶çæçä»£çç±»å·²ç»ç»§æ¿äºä¸ä¸ªProxyç±»ï¼ä¸è½åç»§æ¿ç®æ ç±»äºï¼javaæ¯åç»§æ¿ï¼ï¼æä»¥åªè½éè¿å®ç°åç®æ ç±»ç¸åçæ¥å£çå½¢å¼å»ä»£çç®æ ç±»ãè¿å°±æ¯ä¸ºä»ä¹ä½¿ç¨JDKå¨æä»£çç®æ ç±»å¿é¡»å®ç°æ¥å£çåå ï¼\n           sub.doSomething();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n\n\nå¨è°ç¨è¿ç¨ä¸­ä½¿ç¨äºéç¨çä»£çç±»åè£äºRealSubjectå®ä¾ï¼ç¶åè°ç¨äºJdkçä»£çå·¥åæ¹æ³å®ä¾åäºä¸ä¸ªå·ä½çä»£çç±»ãæåè°ç¨ä»£ççdoSomethingæ¹æ³ï¼è¿æéå çbeforeãafteræ¹æ³å¯ä»¥è¢«ä»»æå¤ç¨ï¼åªè¦æä»¬å¨è°ç¨ä»£ç å¤ä½¿ç¨è¿ä¸ªéç¨ä»£çç±»å»åè£ä»»ææ³è¦éè¦åè£çè¢«ä»£çç±»å³å¯ï¼ãå½æ¥å£æ¹åçæ¶åï¼è½ç¶ãè¢«ä»£çç±»ãéè¦æ¹åï¼ä½æ¯æä»¬çä»£çç±»å´ä¸ç¨æ¹åäºãè¿ä¸ªè°ç¨è½ç¶è¶³å¤çµæ´»ï¼å¯ä»¥å¨æçæä¸ä¸ªå·ä½çä»£çç±»ï¼èä¸ç¨èªå·±æ¾ç¤ºçåå»ºä¸ä¸ªå®ç°å·ä½æ¥å£çä»£çç±»ã\n\n----------------------------------------\n\n>  1. ä»£çç±»ç»§æ¿äºProxyç±»\n>  2. ä»£çç±»å®ç°äºåç®æ ç±»ä¸æ ·çæ¥å£Airplane\n>  3. m1ãm2ãm3ãm4 æ¯ç®æ ç±»éçæ¹æ³ï¼å³hashcodeãtostringãequalãbuyTicketæ¹æ³\n\n\n\n>  1. æé æ¹æ³ä¼ å¥InvocationHandlerå¯¹è±¡ï¼æä»¥è¿éä»£çè°ç¨æ¯ä¸ªæ¹æ³é½æ¯éè¿InvocationHandlerå¯¹è±¡çinvokeæ¹æ³å»è°ç\n>  2. æ¹æ³åæ°\n>     1. this: ä»£çç±»\n>     2. m3ï¼ç®æ æ¹æ³\n>     3. new Object[]{var1}ï¼ç®æ æ¹æ³åæ°\n>  3. è¿æ ·âåè°å½æ°âéçinvokeæ¹æ³å°±æ¿å°äºä¸é¢ä¸ä¸ªåæ°ï¼ç¶åå¯ä»¥å¨å®éæ§è¡ç®æ æ¹æ³ååç»å¥ç¸å³é»è¾\n\n\n# 4ãCglib å¨æä»£ç\n\n\n\n 1. Cglibçæçä»£çç±»æ¯å®ç°äºä¸ä¸ªFactoryæ¥å£ï¼æä»¥è¿å¯ä»¥ç»§æ¿ï¼æä»¥å¯ä»¥éè¿ç»§æ¿ç®æ ç±»çæ¹å¼çæä»£ç\n 2. è¿éçinterruptæ¹æ³å¯¹åºJDKå¨æä»£çéçinvoke',normalizedContent:'çäºå¥½å¤å³äºä»£ççæç« ï¼çè§£åæ´çä¸ä¸ã\n\n\n# 1ãä»£ççåºæ¬ææ\n\n * æ½è±¡è§è²ï¼å£°æçå®å¯¹è±¡åä»£çå¯¹è±¡çå±åæ¥å£,è¿æ ·å¯å¨ä»»ä½ä½¿ç¨çå®å¯¹è±¡çå°æ¹é½å¯ä»¥ä½¿ç¨ä»£çå¯¹è±¡ï¼å¤æï¼ã\n * ä»£çè§è²ï¼ä»£çå¯¹è±¡åé¨å«æçå®å¯¹è±¡çå¼ç¨ï¼ä»èå¯ä»¥å¨ä»»ä½æ¶åæä½çå®å¯¹è±¡ãä»£çå¯¹è±¡åçå®å¯¹è±¡å·æç¸åçæ¥å£ï¼è¿æ ·å°±å¯ä»¥å¨ä»»ä½æ¶åæ¿ä»£çå®å¯¹è±¡ãä»£çå¯¹è±¡éå¸¸å¨ ãå®¢æ·ç«¯è°ç¨ä¼ éç»çå®å¯¹è±¡ã ä¹åæä¹åï¼æ§è¡æä¸ªæä½ï¼èä¸æ¯åçº¯å°å°è°ç¨ä¼ éç»çå®å¯¹è±¡ï¼åæ¶ï¼ä»£çå¯¹è±¡å¯ä»¥å¨æ§è¡çå®å¯¹è±¡æä½ååï¼éå å¶ä»çæä½ï¼ç¸å½äºå¯¹çå®å¯¹è±¡è¿è¡å°è£ã\n * çå®è§è²ï¼å³ä¸ºä»£çå¯¹è±¡æä»£è¡¨çç®æ å¯¹è±¡ï¼ä»£çè§è²æä»£è¡¨ççå®å¯¹è±¡ï¼æ¯æä»¬æç»è¦å¼ç¨çå¯¹è±¡ã\n\nä¸å¾æä¸ç§è§è²ï¼subjectæ½è±¡è§è²ãrealsubjectçå®è§è²ãproxyä»£çè§è²ãå¶ä¸­ï¼subjectè§è²è´è´£å®ä¹realsubjectåproxyè§è²åºè¯¥å®ç°çæ¥å£ï¼realsubjectè§è²ç¨æ¥çæ­£å®æä¸å¡æå¡åè½ï¼proxyè§è²è´è´£å°èªèº«çrequestè¯·æ±ï¼è°ç¨realsubjectå¯¹åºçrequeståè½æ¥å®ç°ä¸å¡åè½ï¼èªå·±ä¸çæ­£åä¸å¡ã\n\n\n# 2ãéæä»£ç\n\ninterface subject//æ½è±¡è§è²\n{  \n    public void dosomething();  \n}\nclass realsubject implements subject//çå®è§è²\n{  \n    public void dosomething()  \n  {  \n    system.out.println( "call dosomething()" );  \n  }  \n}\nclass subjectproxy implements subject//ä»£çè§è²\n{\n  //ä»£çæ¨¡å¼çä½ç¨æ¯ï¼ä¸ºå¶ä»å¯¹è±¡æä¾ä¸ç§ä»£çä»¥æ§å¶å¯¹è¿ä¸ªå¯¹è±¡çè®¿é®ã\n  subject subimpl = new realsubject();\n  public void dosomething()\n  {\n     system.out.println("before"); //è°ç¨ç®æ å¯¹è±¡ä¹åå¯ä»¥åç¸å³æä½\n     subimpl.dosomething();\n     system.out.println("after");//è°ç¨ç®æ å¯¹è±¡ä¹åå¯ä»¥åç¸å³æä½\n  }\n}\n \npublic class test\n{\n    public static void main(string[] args) throws exception\n    {\n        subject sub = new subjectproxy();\n        sub.dosomething();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n\n\nå¯ä»¥çå°ï¼subjectproxyå®ç°äºsubjectæ¥å£ï¼årealsubjectå®ç°ç¸åæ¥å£ï¼ï¼å¹¶ææçæ¯subjectæ¥å£ç±»åçå¼ç¨ãè¿æ ·è°ç¨çä¾ç¶æ¯dosomethingæ¹æ³ï¼åªæ¯å®ä¾åå¯¹è±¡çè¿ç¨æ¹åäºï¼ç»ææ¥çï¼ä»£çç±»subjectproxyå¯ä»¥èªå¨ä¸ºæä»¬å ä¸äºbeforeåafterç­æä»¬éè¦çå¨ä½ã\n\nå¦æå°æ¥éè¦å®ç°ä¸ä¸ªæ°çæ¥å£ï¼å°±éè¦å¨ä»£çç±»éååè¯¥æ¥å£çå®ç°æ¹æ³ï¼ä¼å¯¼è´ä»£çç±»çä»£ç åå¾èè¿ï¼å¦ä¸æ¹é¢ï¼å½éè¦æ¹åæ½è±¡è§è²æ¥å£æ¶ï¼æ ççå®è§è²åä»£çè§è²ä¹éè¦æ¹åã\n\n\n# 3ãjdkå¨æä»£ç\n\ninterface subject  \n{  \n    public void dosomething();  \n}\nclass realsubject implements subject  \n{  \n    public void dosomething()  \n  {  \n     system.out.println( "call dosomething()" );  \n  }  \n}\nclass proxyhandler implements invocationhandler\n{\n    private object target;\n    //ä¼ å¥ç®æ å¯¹è±¡ï¼è¿åä»£çå¯¹è±¡\n    public object getproxyinstance(object target)\n    {\n        this.target = target;\n        // ä½¿ç¨ proxy çæç®æ ç±»çä»£çç±»\n        return proxy.newproxyinstance(target.getclass().getclassloader(),// çæçä»£çå¯¹è±¡åç®æ å¯¹è±¡ä½¿ç¨åä¸ç±»å è½½å¨\n                                      target.getclass().getinterfaces(),// ç®æ å¯¹è±¡å®ç°çæææ¥å£ï¼å ä¸ºçæçä»£çç±»ä¹éè¦å®ç°è¿äºæ¥å£\n                                      this);// invocationhandler å¯¹è±¡ï¼\n    } \n    /**\n     * proxy: çæçä»£çå¯¹è±¡\n     * methodï¼ç®æ ç±»æ¹æ³\n     * argsï¼ç®æ ç±»æ¹æ³çåæ°\n     */\n    public object invoke(object proxy , method method , object[] args)throws throwable//ä¸ä¾èµå·ä½æ¥å£å®ç°\n    {\n        object result = null;//è¢«ä»£ççç±»åä¸ºobjectåºç±»\n        //è¿éå°±å¯ä»¥è¿è¡æè°çaopç¼ç¨äº\n        //å¨è°ç¨ç®æ æ¹æ³åï¼æ§è¡åè½å¤ç\n        result = method.invoke(tar,args);\n        //å¨è°ç¨ç®æ æ¹æ³åï¼æ§è¡åè½å¤ç\n        return result;\n    }\n}\npublic class test\n{\n    public static void main(string args[])\n    {      // å°jdkå¨æä»£ççæçclassæä»¶ä¿å­å°æ¬å°\n           system.getproperties().put("sun.misc.proxygenerator.savegeneratedfiles", "true");\n           proxyhandler proxyhandler = new proxyhandler();\n           // çæä»£çå¯¹è±¡sub\n           subject sub = (subject) proxyhandler.getproxyinstance(new realsubject());\n           // ä½¿ç¨ä»£çå¯¹è±¡è°ç¨dosomething()æ¹æ³ï¼å®éè°ç¨çæ¯ä»£çå¯¹è±¡éçinvokeæ¹æ³ï¼çæçä»£çç±»ç»§æ¿äºproxyï¼éåinvokeæ¹æ³ï¼èinvokeæ¹æ³çé»è¾ç±âåè°å½æ°âinvocationhandleræå®ï¼\n           // çæä»£çç±»è¦ä¹æ¯å®ç°åç®æ ç±»ç¸åçæ¥å£ï¼è¦ä¹æ¯ç´æ¥ç»§æ¿ç®æ ç±»ä½ä¸ºå¶å­ç±»ï¼èjdkå¨æä»£çæºå¶çæçä»£çç±»å·²ç»ç»§æ¿äºä¸ä¸ªproxyç±»ï¼ä¸è½åç»§æ¿ç®æ ç±»äºï¼javaæ¯åç»§æ¿ï¼ï¼æä»¥åªè½éè¿å®ç°åç®æ ç±»ç¸åçæ¥å£çå½¢å¼å»ä»£çç®æ ç±»ãè¿å°±æ¯ä¸ºä»ä¹ä½¿ç¨jdkå¨æä»£çç®æ ç±»å¿é¡»å®ç°æ¥å£çåå ï¼\n           sub.dosomething();\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n\n\nå¨è°ç¨è¿ç¨ä¸­ä½¿ç¨äºéç¨çä»£çç±»åè£äºrealsubjectå®ä¾ï¼ç¶åè°ç¨äºjdkçä»£çå·¥åæ¹æ³å®ä¾åäºä¸ä¸ªå·ä½çä»£çç±»ãæåè°ç¨ä»£ççdosomethingæ¹æ³ï¼è¿æéå çbeforeãafteræ¹æ³å¯ä»¥è¢«ä»»æå¤ç¨ï¼åªè¦æä»¬å¨è°ç¨ä»£ç å¤ä½¿ç¨è¿ä¸ªéç¨ä»£çç±»å»åè£ä»»ææ³è¦éè¦åè£çè¢«ä»£çç±»å³å¯ï¼ãå½æ¥å£æ¹åçæ¶åï¼è½ç¶ãè¢«ä»£çç±»ãéè¦æ¹åï¼ä½æ¯æä»¬çä»£çç±»å´ä¸ç¨æ¹åäºãè¿ä¸ªè°ç¨è½ç¶è¶³å¤çµæ´»ï¼å¯ä»¥å¨æçæä¸ä¸ªå·ä½çä»£çç±»ï¼èä¸ç¨èªå·±æ¾ç¤ºçåå»ºä¸ä¸ªå®ç°å·ä½æ¥å£çä»£çç±»ã\n\n----------------------------------------\n\n>  1. ä»£çç±»ç»§æ¿äºproxyç±»\n>  2. ä»£çç±»å®ç°äºåç®æ ç±»ä¸æ ·çæ¥å£airplane\n>  3. m1ãm2ãm3ãm4 æ¯ç®æ ç±»éçæ¹æ³ï¼å³hashcodeãtostringãequalãbuyticketæ¹æ³\n\n\n\n>  1. æé æ¹æ³ä¼ å¥invocationhandlerå¯¹è±¡ï¼æä»¥è¿éä»£çè°ç¨æ¯ä¸ªæ¹æ³é½æ¯éè¿invocationhandlerå¯¹è±¡çinvokeæ¹æ³å»è°ç\n>  2. æ¹æ³åæ°\n>     1. this: ä»£çç±»\n>     2. m3ï¼ç®æ æ¹æ³\n>     3. new object[]{var1}ï¼ç®æ æ¹æ³åæ°\n>  3. è¿æ ·âåè°å½æ°âéçinvokeæ¹æ³å°±æ¿å°äºä¸é¢ä¸ä¸ªåæ°ï¼ç¶åå¯ä»¥å¨å®éæ§è¡ç®æ æ¹æ³ååç»å¥ç¸å³é»è¾\n\n\n# 4ãcglib å¨æä»£ç\n\n\n\n 1. cglibçæçä»£çç±»æ¯å®ç°äºä¸ä¸ªfactoryæ¥å£ï¼æä»¥è¿å¯ä»¥ç»§æ¿ï¼æä»¥å¯ä»¥éè¿ç»§æ¿ç®æ ç±»çæ¹å¼çæä»£ç\n 2. è¿éçinterruptæ¹æ³å¯¹åºjdkå¨æä»£çéçinvoke',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/14fc4f/"},regularPath:"/35.%E9%9D%A2%E8%AF%95/10.Java%20Web/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"35.é¢è¯/10.Java Web/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-6e96fc20",path:"/pages/14fc4f/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/1ca50c/"},regularPath:"/35.%E9%9D%A2%E8%AF%95/15.%E6%A1%86%E6%9E%B6%E5%8E%9F%E7%90%86/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"35.é¢è¯/15.æ¡æ¶åç/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-3cfa8772",path:"/pages/1ca50c/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/657a34/"},regularPath:"/30.%E5%B7%A5%E5%85%B7/15.git/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"30.å·¥å·/15.git/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-2a641a1f",path:"/pages/657a34/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/6678f4/"},regularPath:"/35.%E9%9D%A2%E8%AF%95/20.%E6%95%B0%E6%8D%AE%E5%BA%93/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"35.é¢è¯/20.æ°æ®åº/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-abf399c4",path:"/pages/6678f4/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/ddeaf7/"},regularPath:"/35.%E9%9D%A2%E8%AF%95/25.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"35.é¢è¯/25.è®¾è®¡æ¨¡å¼/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-dc40f1c0",path:"/pages/ddeaf7/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"IO æ¨¡å",frontmatter:{title:"IO æ¨¡å",date:"2022-02-03T18:54:29.000Z",permalink:"/pages/bc7c50/",categories:["é¢è¯","è®¡ç®æºåºç¡"],tags:[null]},regularPath:"/35.%E9%9D%A2%E8%AF%95/30.%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/10.IO%20%E6%A8%A1%E5%9E%8B.html",relativePath:"35.é¢è¯/30.è®¡ç®æºåºç¡/10.IO æ¨¡å.md",key:"v-10ef9d52",path:"/pages/bc7c50/",headers:[{level:3,title:"1. é»å¡å¼ I/Oï¼BIOï¼",slug:"_1-é»å¡å¼-i-o-bio",normalizedTitle:"1. é»å¡å¼ i/oï¼bioï¼",charIndex:244},{level:3,title:"2. éé»å¡å¼ I/O",slug:"_2-éé»å¡å¼-i-o",normalizedTitle:"2. éé»å¡å¼ i/o",charIndex:586},{level:3,title:"3. I/O ï¼å¤è·¯ï¼å¤ç¨ï¼NIOï¼",slug:"_3-i-o-å¤è·¯-å¤ç¨-nio",normalizedTitle:"3. i/o ï¼å¤è·¯ï¼å¤ç¨ï¼nioï¼",charIndex:723},{level:3,title:"4. ä¿¡å·é©±å¨ I/O",slug:"_4-ä¿¡å·é©±å¨-i-o",normalizedTitle:"4. ä¿¡å·é©±å¨ i/o",charIndex:1024},{level:3,title:"5. å¼æ­¥ I/Oï¼AIOï¼",slug:"_5-å¼æ­¥-i-o-aio",normalizedTitle:"5. å¼æ­¥ i/oï¼aioï¼",charIndex:1213},{level:3,title:"äºå¤§ I/O æ¨¡åæ¯è¾",slug:"äºå¤§-i-o-æ¨¡åæ¯è¾",normalizedTitle:"äºå¤§ i/o æ¨¡åæ¯è¾",charIndex:1380},{level:2,title:"1. select/pollæ¯è¾",slug:"_1-select-pollæ¯è¾",normalizedTitle:"1. select/pollæ¯è¾",charIndex:1639},{level:2,title:"2. epoll",slug:"_2-epoll",normalizedTitle:"2. epoll",charIndex:2192},{level:2,title:"3. åºç¨åºæ¯",slug:"_3-åºç¨åºæ¯",normalizedTitle:"3. åºç¨åºæ¯",charIndex:2404}],headersStr:"1. é»å¡å¼ I/Oï¼BIOï¼ 2. éé»å¡å¼ I/O 3. I/O ï¼å¤è·¯ï¼å¤ç¨ï¼NIOï¼ 4. ä¿¡å·é©±å¨ I/O 5. å¼æ­¥ I/Oï¼AIOï¼ äºå¤§ I/O æ¨¡åæ¯è¾ 1. select/pollæ¯è¾ 2. epoll 3. åºç¨åºæ¯",content:"# ä¸ãI/O æ¨¡å\n\nä¸ä¸ªè¾å¥æä½éå¸¸åæ¬ä¸¤ä¸ªé¶æ®µï¼\n\n * ç­å¾æ°æ®åå¤å¥½\n * ä»åæ ¸åè¿ç¨å¤å¶æ°æ®\n\nå¯¹äºä¸ä¸ªå¥æ¥å­ä¸çè¾å¥æä½ï¼ç¬¬ä¸æ­¥éå¸¸æ¶åç­å¾æ°æ®ä»ç½ç»ä¸­å°è¾¾ãå½æç­å¾æ°æ®å°è¾¾æ¶ï¼å®è¢«å¤å¶å°åæ ¸ä¸­çæä¸ªç¼å²åºãç¬¬äºæ­¥å°±æ¯ææ°æ®ä»åæ ¸ç¼å²åºå¤å¶å°åºç¨è¿ç¨ç¼å²åºã\n\nUnix æäºç§ I/O æ¨¡åï¼\n\n * é»å¡å¼ I/O\n * éé»å¡å¼ I/O\n * I/O å¤ç¨ï¼select å pollï¼\n * ä¿¡å·é©±å¨å¼ I/Oï¼SIGIOï¼\n * å¼æ­¥ I/Oï¼AIOï¼\n\n\n# 1. é»å¡å¼ I/Oï¼BIOï¼\n\nåºç¨è¿ç¨è¢«é»å¡ï¼ç´å°æ°æ®ä»åæ ¸ç¼å²åºå¤å¶å°åºç¨è¿ç¨ç¼å²åºä¸­æè¿åã\n\nåºè¯¥æ³¨æå°ï¼å¨é»å¡çè¿ç¨ä¸­ï¼å¶å®åºç¨è¿ç¨è¿å¯ä»¥æ§è¡ï¼å æ­¤é»å¡ä¸æå³çæ´ä¸ªæä½ç³»ç»é½è¢«é»å¡ãå ä¸ºå¶å®åºç¨è¿ç¨è¿å¯ä»¥æ§è¡ï¼æä»¥ä¸æ¶è CPU æ¶é´ï¼è¿ç§æ¨¡åç CPU å©ç¨çä¼æ¯è¾é«ã\n\nä¸å¾ä¸­ï¼recvfrom() ç¨äºæ¥æ¶ Socket ä¼ æ¥çæ°æ®ï¼å¹¶å¤å¶å°åºç¨è¿ç¨çç¼å²åº buf ä¸­ãè¿éæ recvfrom() å½æç³»ç»è°ç¨ã\n\nssize_t recvfrom(int sockfd, void *buf, size_t len, int flags, struct sockaddr *src_addr, socklen_t *addrlen);\n\n\n1\n\n\n\n\n\n# 2. éé»å¡å¼ I/O\n\nåºç¨è¿ç¨æ§è¡ç³»ç»è°ç¨ä¹åï¼åæ ¸è¿åä¸ä¸ªéè¯¯ç ãåºç¨è¿ç¨å¯ä»¥ç»§ç»­æ§è¡ï¼ä½æ¯éè¦ä¸æ­çæ§è¡ç³»ç»è°ç¨æ¥è·ç¥ I/O æ¯å¦å®æï¼è¿ç§æ¹å¼ç§°ä¸ºè½®è¯¢ï¼pollingï¼ã\n\nç±äº CPU è¦å¤çæ´å¤çç³»ç»è°ç¨ï¼å æ­¤è¿ç§æ¨¡åç CPU å©ç¨çæ¯è¾ä½ã\n\n\n\n\n# 3. I/O ï¼å¤è·¯ï¼å¤ç¨ï¼NIOï¼\n\nä½¿ç¨ select æè poll ç­å¾æ°æ®ï¼å¹¶ä¸å¯ä»¥ç­å¾å¤ä¸ªå¥æ¥å­ä¸­çä»»ä½ä¸ä¸ªåä¸ºå¯è¯»ãè¿ä¸è¿ç¨ä¼è¢«é»å¡ï¼å½æä¸ä¸ªå¥æ¥å­å¯è¯»æ¶è¿åï¼ä¹ååä½¿ç¨ recvfrom ææ°æ®ä»åæ ¸å¤å¶å°è¿ç¨ä¸­ã\n\nå®å¯ä»¥è®©åä¸ªè¿ç¨å·æå¤çå¤ä¸ª I/O äºä»¶çè½åãåè¢«ç§°ä¸º Event Driven I/Oï¼å³äºä»¶é©±å¨ I/Oã\n\nå¦æä¸ä¸ª Web æå¡å¨æ²¡æ I/O å¤ç¨ï¼é£ä¹æ¯ä¸ä¸ª Socket è¿æ¥é½éè¦åå»ºä¸ä¸ªçº¿ç¨å»å¤çãå¦æåæ¶æå ä¸ä¸ªè¿æ¥ï¼é£ä¹å°±éè¦åå»ºç¸åæ°éççº¿ç¨ãç¸æ¯äºå¤è¿ç¨åå¤çº¿ç¨ææ¯ï¼I/O å¤ç¨ä¸éè¦è¿ç¨çº¿ç¨åå»ºååæ¢çå¼éï¼ç³»ç»å¼éæ´å°ã\n\n\n\n\n# 4. ä¿¡å·é©±å¨ I/O\n\nåºç¨è¿ç¨ä½¿ç¨ sigaction ç³»ç»è°ç¨ï¼åæ ¸ç«å³è¿åï¼åºç¨è¿ç¨å¯ä»¥ç»§ç»­æ§è¡ï¼ä¹å°±æ¯è¯´ç­å¾æ°æ®é¶æ®µåºç¨è¿ç¨æ¯éé»å¡çãåæ ¸å¨æ°æ®å°è¾¾æ¶ååºç¨è¿ç¨åé SIGIO ä¿¡å·ï¼åºç¨è¿ç¨æ¶å°ä¹åå¨ä¿¡å·å¤çç¨åºä¸­è°ç¨ recvfrom å°æ°æ®ä»åæ ¸å¤å¶å°åºç¨è¿ç¨ä¸­ã\n\nç¸æ¯äºéé»å¡å¼ I/O çè½®è¯¢æ¹å¼ï¼ä¿¡å·é©±å¨ I/O ç CPU å©ç¨çæ´é«ã\n\n\n\n\n# 5. å¼æ­¥ I/Oï¼AIOï¼\n\nåºç¨è¿ç¨æ§è¡ aio_read ç³»ç»è°ç¨ä¼ç«å³è¿åï¼åºç¨è¿ç¨å¯ä»¥ç»§ç»­æ§è¡ï¼ä¸ä¼è¢«é»å¡ï¼åæ ¸ä¼å¨æææä½å®æä¹åååºç¨è¿ç¨åéä¿¡å·ã\n\nå¼æ­¥ I/O ä¸ä¿¡å·é©±å¨ I/O çåºå«å¨äºï¼å¼æ­¥ I/O çä¿¡å·æ¯éç¥åºç¨è¿ç¨ I/O å®æï¼èä¿¡å·é©±å¨ I/O çä¿¡å·æ¯éç¥åºç¨è¿ç¨å¯ä»¥å¼å§ I/Oã\n\n\n\n\n# äºå¤§ I/O æ¨¡åæ¯è¾\n\n * åæ­¥ I/Oï¼å°æ°æ®ä»åæ ¸ç¼å²åºå¤å¶å°åºç¨è¿ç¨ç¼å²åºçé¶æ®µï¼åºç¨è¿ç¨ä¼é»å¡ã\n * å¼æ­¥ I/Oï¼ä¸ä¼é»å¡ã\n\né»å¡å¼ I/Oãéé»å¡å¼ I/OãI/O å¤ç¨åä¿¡å·é©±å¨ I/O é½æ¯åæ­¥ I/Oï¼å®ä»¬çä¸»è¦åºå«å¨ç¬¬ä¸ä¸ªé¶æ®µã\n\néé»å¡å¼ I/O ãä¿¡å·é©±å¨ I/O åå¼æ­¥ I/O å¨ç¬¬ä¸é¶æ®µä¸ä¼é»å¡ã\n\n\n\n\n# äºãI/O ï¼å¤è·¯ï¼å¤ç¨\n\nselect/poll/epoll é½æ¯ I/O å¤è·¯å¤ç¨çå·ä½å®ç°ï¼select åºç°çææ©ï¼ä¹åæ¯ pollï¼åæ¯ epollã\n\n\n# 1. select/pollæ¯è¾\n\n# I. åè½\n\nselect å poll çåè½åºæ¬ç¸åï¼ä¸è¿å¨ä¸äºå®ç°ç»èä¸ææä¸åã\n\n * select ä¼ä¿®æ¹æè¿°ç¬¦ï¼è poll ä¸ä¼ï¼\n * select çæè¿°ç¬¦ç±»åä½¿ç¨æ°ç»å®ç°ï¼FD_SETSIZE å¤§å°é»è®¤ä¸º 1024ï¼å æ­¤é»è®¤åªè½çå¬ 1024 ä¸ªæè¿°ç¬¦ã å¦æè¦çå¬æ´å¤æè¿°ç¬¦çè¯ï¼éè¦ä¿®æ¹ FD_SETSIZE ä¹åéæ°ç¼è¯ï¼è poll çæè¿°ç¬¦ç±»åä½¿ç¨é¾è¡¨å®ç°ï¼æ²¡ææè¿°ç¬¦æ°éçéå¶ï¼\n * poll æä¾äºæ´å¤çäºä»¶ç±»åï¼å¹¶ä¸å¯¹æè¿°ç¬¦çéå¤å©ç¨ä¸æ¯ select é«ã\n * å¦æä¸ä¸ªçº¿ç¨å¯¹æä¸ªæè¿°ç¬¦è°ç¨äº select æè pollï¼å¦ä¸ä¸ªçº¿ç¨å³é­äºè¯¥æè¿°ç¬¦ï¼ä¼å¯¼è´è°ç¨ç»æä¸ç¡®å®ã\n\n# II. éåº¦\n\nselect å poll éåº¦é½æ¯è¾æ¢ã\n\n * select å poll æ¯æ¬¡è°ç¨é½éè¦å°å¨é¨æè¿°ç¬¦ä»åºç¨è¿ç¨ç¼å²åºå¤å¶å°åæ ¸ç¼å²åºã\n * select å poll çè¿åç»æä¸­æ²¡æå£°æåªäºæè¿°ç¬¦å·²ç»åå¤å¥½ï¼æä»¥å¦æè¿åå¼å¤§äº 0 æ¶ï¼åºç¨è¿ç¨é½éè¦ä½¿ç¨è½®è¯¢çæ¹å¼æ¥æ¾å° I/O å®æçæè¿°ç¬¦ã\n\n\n\n\n1\n\n\n# 3. å¯ç§»æ¤æ§\n\nå ä¹ææçç³»ç»é½æ¯æ selectï¼ä½æ¯åªææ¯è¾æ°çç³»ç»æ¯æ pollã\n\n\n# 2. epoll\n\nepoll åªéè¦å°æè¿°ç¬¦ä»è¿ç¨ç¼å²åºååæ ¸ç¼å²åºæ·è´ä¸æ¬¡ï¼å¹¶ä¸è¿ç¨ä¸éè¦éè¿è½®è¯¢æ¥è·å¾äºä»¶å®æçæè¿°ç¬¦ã\n\nepoll ä»éç¨äº Linux OSã\n\nepoll æ¯ select å poll æ´å çµæ´»èä¸æ²¡ææè¿°ç¬¦æ°ééå¶ã\n\nepoll å¯¹å¤çº¿ç¨ç¼ç¨æ´æåå¥½ï¼ä¸ä¸ªçº¿ç¨è°ç¨äº epoll_wait() å¦ä¸ä¸ªçº¿ç¨å³é­äºåä¸ä¸ªæè¿°ç¬¦ä¹ä¸ä¼äº§çå select å poll çä¸ç¡®å®æåµã\n\n\n# 3. åºç¨åºæ¯\n\nå¾å®¹æäº§çä¸ç§éè§è®¤ä¸ºåªè¦ç¨ epoll å°±å¯ä»¥äºï¼select å poll é½å·²ç»è¿æ¶äºï¼å¶å®å®ä»¬é½æåèªçä½¿ç¨åºæ¯ã\n\n# I. select åºç¨åºæ¯\n\nselect ç timeout åæ°ç²¾åº¦ä¸º 1nsï¼è poll å epoll ä¸º 1msï¼å æ­¤ select æ´å éç¨äºå®æ¶æ§è¦æ±æ¯è¾é«çåºæ¯ï¼æ¯å¦æ ¸ååºå çæ§å¶ã\n\nselect å¯ç§»æ¤æ§æ´å¥½ï¼å ä¹è¢«ææä¸»æµå¹³å°ææ¯æã\n\n# II. poll åºç¨åºæ¯\n\npoll æ²¡ææå¤§æè¿°ç¬¦æ°éçéå¶ï¼å¦æå¹³å°æ¯æå¹¶ä¸å¯¹å®æ¶æ§è¦æ±ä¸é«ï¼åºè¯¥ä½¿ç¨ poll èä¸æ¯ selectã\n\n# III. epoll åºç¨åºæ¯\n\nåªéè¦è¿è¡å¨ Linux å¹³å°ä¸ï¼æå¤§éçæè¿°ç¬¦éè¦åæ¶è½®è¯¢ï¼å¹¶ä¸è¿äºè¿æ¥æå¥½æ¯é¿è¿æ¥ã\n\néè¦åæ¶çæ§å°äº 1000 ä¸ªæè¿°ç¬¦ï¼å°±æ²¡æå¿è¦ä½¿ç¨ epollï¼å ä¸ºè¿ä¸ªåºç¨åºæ¯ä¸å¹¶ä¸è½ä½ç° epoll çä¼å¿ã\n\néè¦çæ§çæè¿°ç¬¦ç¶æååå¤ï¼èä¸é½æ¯éå¸¸ç­æçï¼ä¹æ²¡æå¿è¦ä½¿ç¨ epollãå ä¸º epoll ä¸­çæææè¿°ç¬¦é½å­å¨å¨åæ ¸ä¸­ï¼é ææ¯æ¬¡éè¦å¯¹æè¿°ç¬¦çç¶ææ¹åé½éè¦éè¿ epoll_ctl() è¿è¡ç³»ç»è°ç¨ï¼é¢ç¹ç³»ç»è°ç¨éä½æçãå¹¶ä¸ epoll çæè¿°ç¬¦å­å¨å¨åæ ¸ï¼ä¸å®¹æè°è¯ã",normalizedContent:"# ä¸ãi/o æ¨¡å\n\nä¸ä¸ªè¾å¥æä½éå¸¸åæ¬ä¸¤ä¸ªé¶æ®µï¼\n\n * ç­å¾æ°æ®åå¤å¥½\n * ä»åæ ¸åè¿ç¨å¤å¶æ°æ®\n\nå¯¹äºä¸ä¸ªå¥æ¥å­ä¸çè¾å¥æä½ï¼ç¬¬ä¸æ­¥éå¸¸æ¶åç­å¾æ°æ®ä»ç½ç»ä¸­å°è¾¾ãå½æç­å¾æ°æ®å°è¾¾æ¶ï¼å®è¢«å¤å¶å°åæ ¸ä¸­çæä¸ªç¼å²åºãç¬¬äºæ­¥å°±æ¯ææ°æ®ä»åæ ¸ç¼å²åºå¤å¶å°åºç¨è¿ç¨ç¼å²åºã\n\nunix æäºç§ i/o æ¨¡åï¼\n\n * é»å¡å¼ i/o\n * éé»å¡å¼ i/o\n * i/o å¤ç¨ï¼select å pollï¼\n * ä¿¡å·é©±å¨å¼ i/oï¼sigioï¼\n * å¼æ­¥ i/oï¼aioï¼\n\n\n# 1. é»å¡å¼ i/oï¼bioï¼\n\nåºç¨è¿ç¨è¢«é»å¡ï¼ç´å°æ°æ®ä»åæ ¸ç¼å²åºå¤å¶å°åºç¨è¿ç¨ç¼å²åºä¸­æè¿åã\n\nåºè¯¥æ³¨æå°ï¼å¨é»å¡çè¿ç¨ä¸­ï¼å¶å®åºç¨è¿ç¨è¿å¯ä»¥æ§è¡ï¼å æ­¤é»å¡ä¸æå³çæ´ä¸ªæä½ç³»ç»é½è¢«é»å¡ãå ä¸ºå¶å®åºç¨è¿ç¨è¿å¯ä»¥æ§è¡ï¼æä»¥ä¸æ¶è cpu æ¶é´ï¼è¿ç§æ¨¡åç cpu å©ç¨çä¼æ¯è¾é«ã\n\nä¸å¾ä¸­ï¼recvfrom() ç¨äºæ¥æ¶ socket ä¼ æ¥çæ°æ®ï¼å¹¶å¤å¶å°åºç¨è¿ç¨çç¼å²åº buf ä¸­ãè¿éæ recvfrom() å½æç³»ç»è°ç¨ã\n\nssize_t recvfrom(int sockfd, void *buf, size_t len, int flags, struct sockaddr *src_addr, socklen_t *addrlen);\n\n\n1\n\n\n\n\n\n# 2. éé»å¡å¼ i/o\n\nåºç¨è¿ç¨æ§è¡ç³»ç»è°ç¨ä¹åï¼åæ ¸è¿åä¸ä¸ªéè¯¯ç ãåºç¨è¿ç¨å¯ä»¥ç»§ç»­æ§è¡ï¼ä½æ¯éè¦ä¸æ­çæ§è¡ç³»ç»è°ç¨æ¥è·ç¥ i/o æ¯å¦å®æï¼è¿ç§æ¹å¼ç§°ä¸ºè½®è¯¢ï¼pollingï¼ã\n\nç±äº cpu è¦å¤çæ´å¤çç³»ç»è°ç¨ï¼å æ­¤è¿ç§æ¨¡åç cpu å©ç¨çæ¯è¾ä½ã\n\n\n\n\n# 3. i/o ï¼å¤è·¯ï¼å¤ç¨ï¼nioï¼\n\nä½¿ç¨ select æè poll ç­å¾æ°æ®ï¼å¹¶ä¸å¯ä»¥ç­å¾å¤ä¸ªå¥æ¥å­ä¸­çä»»ä½ä¸ä¸ªåä¸ºå¯è¯»ãè¿ä¸è¿ç¨ä¼è¢«é»å¡ï¼å½æä¸ä¸ªå¥æ¥å­å¯è¯»æ¶è¿åï¼ä¹ååä½¿ç¨ recvfrom ææ°æ®ä»åæ ¸å¤å¶å°è¿ç¨ä¸­ã\n\nå®å¯ä»¥è®©åä¸ªè¿ç¨å·æå¤çå¤ä¸ª i/o äºä»¶çè½åãåè¢«ç§°ä¸º event driven i/oï¼å³äºä»¶é©±å¨ i/oã\n\nå¦æä¸ä¸ª web æå¡å¨æ²¡æ i/o å¤ç¨ï¼é£ä¹æ¯ä¸ä¸ª socket è¿æ¥é½éè¦åå»ºä¸ä¸ªçº¿ç¨å»å¤çãå¦æåæ¶æå ä¸ä¸ªè¿æ¥ï¼é£ä¹å°±éè¦åå»ºç¸åæ°éççº¿ç¨ãç¸æ¯äºå¤è¿ç¨åå¤çº¿ç¨ææ¯ï¼i/o å¤ç¨ä¸éè¦è¿ç¨çº¿ç¨åå»ºååæ¢çå¼éï¼ç³»ç»å¼éæ´å°ã\n\n\n\n\n# 4. ä¿¡å·é©±å¨ i/o\n\nåºç¨è¿ç¨ä½¿ç¨ sigaction ç³»ç»è°ç¨ï¼åæ ¸ç«å³è¿åï¼åºç¨è¿ç¨å¯ä»¥ç»§ç»­æ§è¡ï¼ä¹å°±æ¯è¯´ç­å¾æ°æ®é¶æ®µåºç¨è¿ç¨æ¯éé»å¡çãåæ ¸å¨æ°æ®å°è¾¾æ¶ååºç¨è¿ç¨åé sigio ä¿¡å·ï¼åºç¨è¿ç¨æ¶å°ä¹åå¨ä¿¡å·å¤çç¨åºä¸­è°ç¨ recvfrom å°æ°æ®ä»åæ ¸å¤å¶å°åºç¨è¿ç¨ä¸­ã\n\nç¸æ¯äºéé»å¡å¼ i/o çè½®è¯¢æ¹å¼ï¼ä¿¡å·é©±å¨ i/o ç cpu å©ç¨çæ´é«ã\n\n\n\n\n# 5. å¼æ­¥ i/oï¼aioï¼\n\nåºç¨è¿ç¨æ§è¡ aio_read ç³»ç»è°ç¨ä¼ç«å³è¿åï¼åºç¨è¿ç¨å¯ä»¥ç»§ç»­æ§è¡ï¼ä¸ä¼è¢«é»å¡ï¼åæ ¸ä¼å¨æææä½å®æä¹åååºç¨è¿ç¨åéä¿¡å·ã\n\nå¼æ­¥ i/o ä¸ä¿¡å·é©±å¨ i/o çåºå«å¨äºï¼å¼æ­¥ i/o çä¿¡å·æ¯éç¥åºç¨è¿ç¨ i/o å®æï¼èä¿¡å·é©±å¨ i/o çä¿¡å·æ¯éç¥åºç¨è¿ç¨å¯ä»¥å¼å§ i/oã\n\n\n\n\n# äºå¤§ i/o æ¨¡åæ¯è¾\n\n * åæ­¥ i/oï¼å°æ°æ®ä»åæ ¸ç¼å²åºå¤å¶å°åºç¨è¿ç¨ç¼å²åºçé¶æ®µï¼åºç¨è¿ç¨ä¼é»å¡ã\n * å¼æ­¥ i/oï¼ä¸ä¼é»å¡ã\n\né»å¡å¼ i/oãéé»å¡å¼ i/oãi/o å¤ç¨åä¿¡å·é©±å¨ i/o é½æ¯åæ­¥ i/oï¼å®ä»¬çä¸»è¦åºå«å¨ç¬¬ä¸ä¸ªé¶æ®µã\n\néé»å¡å¼ i/o ãä¿¡å·é©±å¨ i/o åå¼æ­¥ i/o å¨ç¬¬ä¸é¶æ®µä¸ä¼é»å¡ã\n\n\n\n\n# äºãi/o ï¼å¤è·¯ï¼å¤ç¨\n\nselect/poll/epoll é½æ¯ i/o å¤è·¯å¤ç¨çå·ä½å®ç°ï¼select åºç°çææ©ï¼ä¹åæ¯ pollï¼åæ¯ epollã\n\n\n# 1. select/pollæ¯è¾\n\n# i. åè½\n\nselect å poll çåè½åºæ¬ç¸åï¼ä¸è¿å¨ä¸äºå®ç°ç»èä¸ææä¸åã\n\n * select ä¼ä¿®æ¹æè¿°ç¬¦ï¼è poll ä¸ä¼ï¼\n * select çæè¿°ç¬¦ç±»åä½¿ç¨æ°ç»å®ç°ï¼fd_setsize å¤§å°é»è®¤ä¸º 1024ï¼å æ­¤é»è®¤åªè½çå¬ 1024 ä¸ªæè¿°ç¬¦ã å¦æè¦çå¬æ´å¤æè¿°ç¬¦çè¯ï¼éè¦ä¿®æ¹ fd_setsize ä¹åéæ°ç¼è¯ï¼è poll çæè¿°ç¬¦ç±»åä½¿ç¨é¾è¡¨å®ç°ï¼æ²¡ææè¿°ç¬¦æ°éçéå¶ï¼\n * poll æä¾äºæ´å¤çäºä»¶ç±»åï¼å¹¶ä¸å¯¹æè¿°ç¬¦çéå¤å©ç¨ä¸æ¯ select é«ã\n * å¦æä¸ä¸ªçº¿ç¨å¯¹æä¸ªæè¿°ç¬¦è°ç¨äº select æè pollï¼å¦ä¸ä¸ªçº¿ç¨å³é­äºè¯¥æè¿°ç¬¦ï¼ä¼å¯¼è´è°ç¨ç»æä¸ç¡®å®ã\n\n# ii. éåº¦\n\nselect å poll éåº¦é½æ¯è¾æ¢ã\n\n * select å poll æ¯æ¬¡è°ç¨é½éè¦å°å¨é¨æè¿°ç¬¦ä»åºç¨è¿ç¨ç¼å²åºå¤å¶å°åæ ¸ç¼å²åºã\n * select å poll çè¿åç»æä¸­æ²¡æå£°æåªäºæè¿°ç¬¦å·²ç»åå¤å¥½ï¼æä»¥å¦æè¿åå¼å¤§äº 0 æ¶ï¼åºç¨è¿ç¨é½éè¦ä½¿ç¨è½®è¯¢çæ¹å¼æ¥æ¾å° i/o å®æçæè¿°ç¬¦ã\n\n\n\n\n1\n\n\n# 3. å¯ç§»æ¤æ§\n\nå ä¹ææçç³»ç»é½æ¯æ selectï¼ä½æ¯åªææ¯è¾æ°çç³»ç»æ¯æ pollã\n\n\n# 2. epoll\n\nepoll åªéè¦å°æè¿°ç¬¦ä»è¿ç¨ç¼å²åºååæ ¸ç¼å²åºæ·è´ä¸æ¬¡ï¼å¹¶ä¸è¿ç¨ä¸éè¦éè¿è½®è¯¢æ¥è·å¾äºä»¶å®æçæè¿°ç¬¦ã\n\nepoll ä»éç¨äº linux osã\n\nepoll æ¯ select å poll æ´å çµæ´»èä¸æ²¡ææè¿°ç¬¦æ°ééå¶ã\n\nepoll å¯¹å¤çº¿ç¨ç¼ç¨æ´æåå¥½ï¼ä¸ä¸ªçº¿ç¨è°ç¨äº epoll_wait() å¦ä¸ä¸ªçº¿ç¨å³é­äºåä¸ä¸ªæè¿°ç¬¦ä¹ä¸ä¼äº§çå select å poll çä¸ç¡®å®æåµã\n\n\n# 3. åºç¨åºæ¯\n\nå¾å®¹æäº§çä¸ç§éè§è®¤ä¸ºåªè¦ç¨ epoll å°±å¯ä»¥äºï¼select å poll é½å·²ç»è¿æ¶äºï¼å¶å®å®ä»¬é½æåèªçä½¿ç¨åºæ¯ã\n\n# i. select åºç¨åºæ¯\n\nselect ç timeout åæ°ç²¾åº¦ä¸º 1nsï¼è poll å epoll ä¸º 1msï¼å æ­¤ select æ´å éç¨äºå®æ¶æ§è¦æ±æ¯è¾é«çåºæ¯ï¼æ¯å¦æ ¸ååºå çæ§å¶ã\n\nselect å¯ç§»æ¤æ§æ´å¥½ï¼å ä¹è¢«ææä¸»æµå¹³å°ææ¯æã\n\n# ii. poll åºç¨åºæ¯\n\npoll æ²¡ææå¤§æè¿°ç¬¦æ°éçéå¶ï¼å¦æå¹³å°æ¯æå¹¶ä¸å¯¹å®æ¶æ§è¦æ±ä¸é«ï¼åºè¯¥ä½¿ç¨ poll èä¸æ¯ selectã\n\n# iii. epoll åºç¨åºæ¯\n\nåªéè¦è¿è¡å¨ linux å¹³å°ä¸ï¼æå¤§éçæè¿°ç¬¦éè¦åæ¶è½®è¯¢ï¼å¹¶ä¸è¿äºè¿æ¥æå¥½æ¯é¿è¿æ¥ã\n\néè¦åæ¶çæ§å°äº 1000 ä¸ªæè¿°ç¬¦ï¼å°±æ²¡æå¿è¦ä½¿ç¨ epollï¼å ä¸ºè¿ä¸ªåºç¨åºæ¯ä¸å¹¶ä¸è½ä½ç° epoll çä¼å¿ã\n\néè¦çæ§çæè¿°ç¬¦ç¶æååå¤ï¼èä¸é½æ¯éå¸¸ç­æçï¼ä¹æ²¡æå¿è¦ä½¿ç¨ epollãå ä¸º epoll ä¸­çæææè¿°ç¬¦é½å­å¨å¨åæ ¸ä¸­ï¼é ææ¯æ¬¡éè¦å¯¹æè¿°ç¬¦çç¶ææ¹åé½éè¦éè¿ epoll_ctl() è¿è¡ç³»ç»è°ç¨ï¼é¢ç¹ç³»ç»è°ç¨éä½æçãå¹¶ä¸ epoll çæè¿°ç¬¦å­å¨å¨åæ ¸ï¼ä¸å®¹æè°è¯ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",frontmatter:{title:"Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",date:"2022-02-03T23:04:37.000Z",categories:["æ¡æ¶","Redis"],tags:[null],permalink:"/pages/bdd0da/"},regularPath:"/40.%E6%9B%B4%E5%A4%9A/10.Redis%E9%AB%98%E7%BA%A7%E5%AE%A2%E6%88%B7%E7%AB%AFLettuce%E8%AF%A6%E8%A7%A3.html",relativePath:"40.æ´å¤/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md",key:"v-3b86a05e",path:"/pages/bdd0da/",headersStr:null,content:" * Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£",normalizedContent:" * redisé«çº§å®¢æ·ç«¯lettuceè¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"å½æ¡£",frontmatter:{archivesPage:!0,title:"å½æ¡£",permalink:"/archives/",article:!1},regularPath:"/@pages/archivesPage.html",relativePath:"@pages/archivesPage.md",key:"v-5176e105",path:"/archives/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"åç±»",frontmatter:{categoriesPage:!0,title:"åç±»",permalink:"/categories/",article:!1},regularPath:"/@pages/categoriesPage.html",relativePath:"@pages/categoriesPage.md",key:"v-75e41c65",path:"/categories/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"æ ç­¾",frontmatter:{tagsPage:!0,title:"æ ç­¾",permalink:"/tags/",article:!1},regularPath:"/@pages/tagsPage.html",relativePath:"@pages/tagsPage.md",key:"v-3249c685",path:"/tags/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ä½ ç¥éçè¶å¤ï¼ä¸ç¥éçä¹å°±è¶å¤",frontmatter:{title:"ä½ ç¥éçè¶å¤ï¼ä¸ç¥éçä¹å°±è¶å¤",date:"2020-05-06T15:52:40.000Z",permalink:"/pages/f2e63f",sidebar:"auto",categories:["éç¬"],tags:["å­¦ä¹ ","ç¥è¯","é¸¡æ±¤"],author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/_posts/%E9%9A%8F%E7%AC%94/%E4%BD%A0%E7%9F%A5%E9%81%93%E7%9A%84%E8%B6%8A%E5%A4%9A%EF%BC%8C%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E4%B9%9F%E5%B0%B1%E8%B6%8A%E5%A4%9A.html",relativePath:"_posts/éç¬/ä½ ç¥éçè¶å¤ï¼ä¸ç¥éçä¹å°±è¶å¤.md",key:"v-ec84fed2",path:"/pages/f2e63f/",excerpt:"<p>ä¸ç¥éå¤§å®¶ææ²¡æåç°ï¼æä»¬èº«è¾¹ç»å¸¸æè¿æ ·çäººï¼ä»ä»¬è¶æ¯æè½åçï¼è¶æ¯æç¥è¯çï¼è¶æ¯ä½è°ï¼è¶æ¯è°¦éï¼å ä¸ºä»ä»¬æ·±ç¥ï¼ç¥éçè¶å¤ï¼ä¸ç¥éçä¹å°±è¶å¤ã</p>\n",headersStr:null,content:"ä¸ç¥éå¤§å®¶ææ²¡æåç°ï¼æä»¬èº«è¾¹ç»å¸¸æè¿æ ·çäººï¼ä»ä»¬è¶æ¯æè½åçï¼è¶æ¯æç¥è¯çï¼è¶æ¯ä½è°ï¼è¶æ¯è°¦éï¼å ä¸ºä»ä»¬æ·±ç¥ï¼ç¥éçè¶å¤ï¼ä¸ç¥éçä¹å°±è¶å¤ã\n\nä½ ç¥éçè¶å¤ï¼ä½ ä¸ç¥éçä¹å°±è¶å¤ï¼è¿æ¯ä¸å¥éå¸¸æå²ççè¯ã\n\næ¯ä¸ªäººçç¥è¯é¢é½æ¯æéçï¼ä½ æå¯è½å¨æä¸ªé¢åä¼æè¾æ·±çç ç©¶ï¼æä¸ºè¿ä¸ªé¢åéçä¸å®¶ï¼ç­å°ä½ ç«å¨é«å¤çæ¶åï¼æä¼åç°ï¼èªå·±æ¯å¤ä¹çæ¸ºå°ï¼æç¥éèªå·±æå¤å°æ²¡ææ¶åçé¢åãç¥éçè¶å¤ï¼çæãé®é¢å°±ä¼è¶æ¥è¶å¤ï¼å¯¹å·²ç¥çè´¨çãçèãå°æå°±ä¼è¶æ¥è¶å¤ã\n\nå³ä½¿å¦æ­¤ï¼æä»¬ä¹åºè¯¥åªåï¼è³å°å¯ä»¥æä¸ºæä¸ªé¢åçä½¼ä½¼èã\n\né¸¡æ±¤1\n\nå¼±å°çäººï¼æä¹ æ¯å²è®½ä¸å¦å®ï¼èåå¿å¼ºå¤§çäººï¼ä»ä¸åå¬èµç¾ä¸é¼å±ã\n\né¸¡æ±¤2\n\nå½ä»£éå¹´äººé½åºè¯¥æè±å·æ°ï¼åªç®¡åä¸èµ°ï¼ä¸å¿å¬ä»èªæ´èªå¼èçæµè¨ãè½åäºçåäºï¼è½åå£°çåå£°ãæä¸ä»½ç­ï¼åä¸ä»½åï¼å°±åè¤ç«ä¸è¬ï¼ä¹å¯ä»¥å¨é»æéåä¸ç¹åï¼ä¸å¿ç­åç¬ç«ã",normalizedContent:"ä¸ç¥éå¤§å®¶ææ²¡æåç°ï¼æä»¬èº«è¾¹ç»å¸¸æè¿æ ·çäººï¼ä»ä»¬è¶æ¯æè½åçï¼è¶æ¯æç¥è¯çï¼è¶æ¯ä½è°ï¼è¶æ¯è°¦éï¼å ä¸ºä»ä»¬æ·±ç¥ï¼ç¥éçè¶å¤ï¼ä¸ç¥éçä¹å°±è¶å¤ã\n\nä½ ç¥éçè¶å¤ï¼ä½ ä¸ç¥éçä¹å°±è¶å¤ï¼è¿æ¯ä¸å¥éå¸¸æå²ççè¯ã\n\næ¯ä¸ªäººçç¥è¯é¢é½æ¯æéçï¼ä½ æå¯è½å¨æä¸ªé¢åä¼æè¾æ·±çç ç©¶ï¼æä¸ºè¿ä¸ªé¢åéçä¸å®¶ï¼ç­å°ä½ ç«å¨é«å¤çæ¶åï¼æä¼åç°ï¼èªå·±æ¯å¤ä¹çæ¸ºå°ï¼æç¥éèªå·±æå¤å°æ²¡ææ¶åçé¢åãç¥éçè¶å¤ï¼çæãé®é¢å°±ä¼è¶æ¥è¶å¤ï¼å¯¹å·²ç¥çè´¨çãçèãå°æå°±ä¼è¶æ¥è¶å¤ã\n\nå³ä½¿å¦æ­¤ï¼æä»¬ä¹åºè¯¥åªåï¼è³å°å¯ä»¥æä¸ºæä¸ªé¢åçä½¼ä½¼èã\n\né¸¡æ±¤1\n\nå¼±å°çäººï¼æä¹ æ¯å²è®½ä¸å¦å®ï¼èåå¿å¼ºå¤§çäººï¼ä»ä¸åå¬èµç¾ä¸é¼å±ã\n\né¸¡æ±¤2\n\nå½ä»£éå¹´äººé½åºè¯¥æè±å·æ°ï¼åªç®¡åä¸èµ°ï¼ä¸å¿å¬ä»èªæ´èªå¼èçæµè¨ãè½åäºçåäºï¼è½åå£°çåå£°ãæä¸ä»½ç­ï¼åä¸ä»½åï¼å°±åè¤ç«ä¸è¬ï¼ä¹å¯ä»¥å¨é»æéåä¸ç¹åï¼ä¸å¿ç­åç¬ç«ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"æ¥æ±çæ´»ï¼æ¥æ±å¿«ä¹",frontmatter:{title:"æ¥æ±çæ´»ï¼æ¥æ±å¿«ä¹",date:"2020-06-26T20:40:38.000Z",permalink:"/pages/cd8bde/",sidebar:"auto",categories:["éç¬"],tags:["é¸¡æ±¤"],author:{name:"xugaoyi",link:"https://github.com/xugaoyi"}},regularPath:"/_posts/%E9%9A%8F%E7%AC%94/%E6%8B%A5%E6%8A%B1%E7%94%9F%E6%B4%BB%EF%BC%8C%E6%8B%A5%E6%8A%B1%E5%BF%AB%E4%B9%90.html",relativePath:"_posts/éç¬/æ¥æ±çæ´»ï¼æ¥æ±å¿«ä¹.md",key:"v-2100b3d2",path:"/pages/cd8bde/",excerpt:"<p>çæ´»å¨åç°ä»£çä»å¤©ï¼å¾å¤äººé½æä¸ç§èæ æï¼è®¤ä¸ºäººçæ²¡ææä¹ãä½æ¯ï¼äººçä¸å¯è½æ²¡ææä¹ï¼å ä¸ºå½ä½ è®¤ä¸ºæ²¡ææä¹çæ¶åï¼ä¸å®æä¸ä¸ªä¸ä¹ç¸å¯¹åºçæ¦å¿µå«ææä¹ã</p>\n",headersStr:null,content:"çæ´»å¨åç°ä»£çä»å¤©ï¼å¾å¤äººé½æä¸ç§èæ æï¼è®¤ä¸ºäººçæ²¡ææä¹ãä½æ¯ï¼äººçä¸å¯è½æ²¡ææä¹ï¼å ä¸ºå½ä½ è®¤ä¸ºæ²¡ææä¹çæ¶åï¼ä¸å®æä¸ä¸ªä¸ä¹ç¸å¯¹åºçæ¦å¿µå«ææä¹ã\n\nå½ä½ æçäººçæ²¡ææä¹æ¶ï¼é¾éæçæ¬èº«ä¸å¼å¾æçåï¼\n\nä¸è¦ä»»ç±ä½ åå¿çèæ æèå»¶ï¼æä»¬éè¦å»æ¥æ±çå®ççæ´»ã\n\nææçå®çå¿«ä¹ï¼é½ç¦»ä¸å¼è°è¾çåªåï¼æ è®ºæ¯éæ¦é¢åçå¿«ä¹ï¼è¿æ¯äºä¸æåçåæ¦ï¼çè³åæ¬æ´æ¿è±ççæ¿å¨ãææçå®çå¿«ä¹ï¼é½éè¦é¿ä¹çéºå«ä¸åªåï¼æ²¡æè¾å¤çæ±æ°´ï¼å¿«ä¹ä¹å°±ä¸åçå®ã\n\nå¦æå¿«ä¹è§¦æå¯åï¼è¿ç§å»ä»·çå¿«ä¹ä¹å°±ä¸å¼å¾çæï¼éæ¶é½å¯è½æå¼ãå æ­¤ï¼å¯¹äºå¹´è½»äººèè¨ï¼ä¸ä¸ªéè¦çåè¯¾å°±æ¯å­¦ä¼å»èå¶æ¬²æã\n\nææéè¿æ·å¾æå¸¦æ¥çå¿«ä¹ï¼é½æ¯å»ä»·çï¼ä»¥è³äºææè¿½æ±é½åå¾æ¯«æ æä¹ï¼äººçå°±äºæ çè¶£ãæä»¬éè¦å¨æ¯å¤©çå®çåªåä¸­å»æ¥æ±çæ´»ï¼è¿½å¯»çå®çå¿«ä¹ã\n\n\n\n> æç« æå½èª:Bç«è§é¢ãç½ç¿è¯´åæ³ãï¼é¾æ¥https://b23.tv/K8ulrE",normalizedContent:"çæ´»å¨åç°ä»£çä»å¤©ï¼å¾å¤äººé½æä¸ç§èæ æï¼è®¤ä¸ºäººçæ²¡ææä¹ãä½æ¯ï¼äººçä¸å¯è½æ²¡ææä¹ï¼å ä¸ºå½ä½ è®¤ä¸ºæ²¡ææä¹çæ¶åï¼ä¸å®æä¸ä¸ªä¸ä¹ç¸å¯¹åºçæ¦å¿µå«ææä¹ã\n\nå½ä½ æçäººçæ²¡ææä¹æ¶ï¼é¾éæçæ¬èº«ä¸å¼å¾æçåï¼\n\nä¸è¦ä»»ç±ä½ åå¿çèæ æèå»¶ï¼æä»¬éè¦å»æ¥æ±çå®ççæ´»ã\n\nææçå®çå¿«ä¹ï¼é½ç¦»ä¸å¼è°è¾çåªåï¼æ è®ºæ¯éæ¦é¢åçå¿«ä¹ï¼è¿æ¯äºä¸æåçåæ¦ï¼çè³åæ¬æ´æ¿è±ççæ¿å¨ãææçå®çå¿«ä¹ï¼é½éè¦é¿ä¹çéºå«ä¸åªåï¼æ²¡æè¾å¤çæ±æ°´ï¼å¿«ä¹ä¹å°±ä¸åçå®ã\n\nå¦æå¿«ä¹è§¦æå¯åï¼è¿ç§å»ä»·çå¿«ä¹ä¹å°±ä¸å¼å¾çæï¼éæ¶é½å¯è½æå¼ãå æ­¤ï¼å¯¹äºå¹´è½»äººèè¨ï¼ä¸ä¸ªéè¦çåè¯¾å°±æ¯å­¦ä¼å»èå¶æ¬²æã\n\nææéè¿æ·å¾æå¸¦æ¥çå¿«ä¹ï¼é½æ¯å»ä»·çï¼ä»¥è³äºææè¿½æ±é½åå¾æ¯«æ æä¹ï¼äººçå°±äºæ çè¶£ãæä»¬éè¦å¨æ¯å¤©çå®çåªåä¸­å»æ¥æ±çæ´»ï¼è¿½å¯»çå®çå¿«ä¹ã\n\n\n\n> æç« æå½èª:bç«è§é¢ãç½ç¿è¯´åæ³ãï¼é¾æ¥https://b23.tv/k8ulre",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Home",frontmatter:{home:!0,heroText:"Evan's blog",tagline:"Webåç«¯ææ¯åå®¢ï¼ç§¯è·¬æ­¥ä»¥è³åéï¼è´æ¬æ¯ä¸ªç±å­¦ä¹ çä½ ã",features:[{title:"åç«¯",details:"JavaScriptãES6ãVueæ¡æ¶ç­åç«¯ææ¯",link:"/web/",imgUrl:"/img/web.png"},{title:"é¡µé¢",details:"html(5)/css(3)ï¼åç«¯é¡µé¢ç¸å³ææ¯",link:"/ui/",imgUrl:"/img/ui.png"},{title:"ææ¯",details:"ææ¯ææ¡£ãæç¨ãæå·§ãæ»ç»ç­æç« ",link:"/technology/",imgUrl:"/img/other.png"}]},regularPath:"/",relativePath:"index.md",key:"v-2b7111c4",path:"/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ECMAScript 6 ç®ä»",frontmatter:{title:"ECMAScript 6 ç®ä»",date:"2020-01-12T15:45:35.000Z",permalink:"/pages/f344d070a1031ef7",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/01.ECMAScript%206%20%E7%AE%80%E4%BB%8B.html",relativePath:"ãES6 æç¨ãç¬è®°/01.ECMAScript 6 ç®ä».md",key:"v-7b48c50c",path:"/pages/f344d070a1031ef7/",headers:[{level:2,title:"ECMAScript å JavaScript çå³ç³»",slug:"ecmascript-å-javascript-çå³ç³»",normalizedTitle:"ecmascript å javascript çå³ç³»",charIndex:210},{level:2,title:"ES6 ä¸ ECMAScript 2015 çå³ç³»",slug:"es6-ä¸-ecmascript-2015-çå³ç³»",normalizedTitle:"es6 ä¸ ecmascript 2015 çå³ç³»",charIndex:795},{level:2,title:"è¯­æ³ææ¡çæ¹åæµç¨",slug:"è¯­æ³ææ¡çæ¹åæµç¨",normalizedTitle:"è¯­æ³ææ¡çæ¹åæµç¨",charIndex:1756},{level:2,title:"ECMAScript çåå²",slug:"ecmascript-çåå²",normalizedTitle:"ecmascript çåå²",charIndex:2184},{level:2,title:"é¨ç½²è¿åº¦",slug:"é¨ç½²è¿åº¦",normalizedTitle:"é¨ç½²è¿åº¦",charIndex:3648},{level:2,title:"Babel è½¬ç å¨",slug:"babel-è½¬ç å¨",normalizedTitle:"babel è½¬ç å¨",charIndex:4336},{level:3,title:"éç½®æä»¶.babelrc",slug:"éç½®æä»¶-babelrc",normalizedTitle:"éç½®æä»¶.babelrc",charIndex:4688},{level:3,title:"å½ä»¤è¡è½¬ç ",slug:"å½ä»¤è¡è½¬ç ",normalizedTitle:"å½ä»¤è¡è½¬ç ",charIndex:5176},{level:3,title:"babel-node",slug:"babel-node",normalizedTitle:"babel-node",charIndex:5638},{level:3,title:"@babel/register æ¨¡å",slug:"babel-register-æ¨¡å",normalizedTitle:"@babel/register æ¨¡å",charIndex:6011},{level:3,title:"babel API",slug:"babel-api",normalizedTitle:"babel api",charIndex:6406},{level:3,title:"@babel/polyfill",slug:"babel-polyfill",normalizedTitle:"@babel/polyfill",charIndex:7300},{level:3,title:"æµè§å¨ç¯å¢",slug:"æµè§å¨ç¯å¢",normalizedTitle:"æµè§å¨ç¯å¢",charIndex:7791},{level:2,title:"Traceur è½¬ç å¨",slug:"traceur-è½¬ç å¨",normalizedTitle:"traceur è½¬ç å¨",charIndex:8118},{level:3,title:"ç´æ¥æå¥ç½é¡µ",slug:"ç´æ¥æå¥ç½é¡µ",normalizedTitle:"ç´æ¥æå¥ç½é¡µ",charIndex:8178},{level:3,title:"å¨çº¿è½¬æ¢",slug:"å¨çº¿è½¬æ¢",normalizedTitle:"å¨çº¿è½¬æ¢",charIndex:9938},{level:3,title:"å½ä»¤è¡è½¬æ¢",slug:"å½ä»¤è¡è½¬æ¢",normalizedTitle:"å½ä»¤è¡è½¬æ¢",charIndex:10679},{level:3,title:"Node ç¯å¢çç¨æ³",slug:"node-ç¯å¢çç¨æ³",normalizedTitle:"node ç¯å¢çç¨æ³",charIndex:11158}],excerpt:'<blockquote>\n<p>è¯´æï¼æ¬ç« åå®¹ä¸ºåä¸»å¨åæç¨åºç¡ä¸æ·»å èªå·±çå­¦ä¹ ç¬è®°ï¼æ¥æº<a href="http://es6.ruanyifeng.com/" target="_blank" rel="noopener noreferrer">http://es6.ruanyifeng.com/<OutboundLink/></a>ï¼æç¨çæå½åä½èææã</p>\n</blockquote>\n<h1 id="ecmascript-6-ç®ä»"><a class="header-anchor" href="#ecmascript-6-ç®ä»">#</a> ECMAScript 6 ç®ä»</h1>\n<p>ECMAScript 6.0ï¼ä»¥ä¸ç®ç§° ES6ï¼æ¯ JavaScript è¯­è¨çä¸ä¸ä»£æ åï¼å·²ç»å¨ 2015 å¹´ 6 ææ­£å¼åå¸äºãå®çç®æ ï¼æ¯ä½¿å¾ JavaScript è¯­è¨å¯ä»¥ç¨æ¥ç¼åå¤æçå¤§ååºç¨ç¨åºï¼æä¸ºä¼ä¸çº§å¼åè¯­è¨ã</p>\n',headersStr:"ECMAScript å JavaScript çå³ç³» ES6 ä¸ ECMAScript 2015 çå³ç³» è¯­æ³ææ¡çæ¹åæµç¨ ECMAScript çåå² é¨ç½²è¿åº¦ Babel è½¬ç å¨ éç½®æä»¶.babelrc å½ä»¤è¡è½¬ç  babel-node @babel/register æ¨¡å babel API @babel/polyfill æµè§å¨ç¯å¢ Traceur è½¬ç å¨ ç´æ¥æå¥ç½é¡µ å¨çº¿è½¬æ¢ å½ä»¤è¡è½¬æ¢ Node ç¯å¢çç¨æ³",content:"> è¯´æï¼æ¬ç« åå®¹ä¸ºåä¸»å¨åæç¨åºç¡ä¸æ·»å èªå·±çå­¦ä¹ ç¬è®°ï¼æ¥æºhttp://es6.ruanyifeng.com/ï¼æç¨çæå½åä½èææã\n\n\n# ECMAScript 6 ç®ä»\n\nECMAScript 6.0ï¼ä»¥ä¸ç®ç§° ES6ï¼æ¯ JavaScript è¯­è¨çä¸ä¸ä»£æ åï¼å·²ç»å¨ 2015 å¹´ 6 ææ­£å¼åå¸äºãå®çç®æ ï¼æ¯ä½¿å¾ JavaScript è¯­è¨å¯ä»¥ç¨æ¥ç¼åå¤æçå¤§ååºç¨ç¨åºï¼æä¸ºä¼ä¸çº§å¼åè¯­è¨ã\n\n\n# ECMAScript å JavaScript çå³ç³»\n\nä¸ä¸ªå¸¸è§çé®é¢æ¯ï¼ECMAScript å JavaScript å°åºæ¯ä»ä¹å³ç³»ï¼\n\nè¦è®²æ¸æ¥è¿ä¸ªé®é¢ï¼éè¦åé¡¾åå²ã1996 å¹´ 11 æï¼JavaScript çåé è Netscape å¬å¸ï¼å³å®å° JavaScript æäº¤ç»æ ååç»ç» ECMAï¼å¸æè¿ç§è¯­è¨è½å¤æä¸ºå½éæ åãæ¬¡å¹´ï¼ECMA åå¸ 262 å·æ åæä»¶ï¼ECMA-262ï¼çç¬¬ä¸çï¼è§å®äºæµè§å¨èæ¬è¯­è¨çæ åï¼å¹¶å°è¿ç§è¯­è¨ç§°ä¸º ECMAScriptï¼è¿ä¸ªçæ¬å°±æ¯ 1.0 çã\n\nè¯¥æ åä»ä¸å¼å§å°±æ¯éå¯¹ JavaScript è¯­è¨å¶å®çï¼ä½æ¯ä¹æä»¥ä¸å« JavaScriptï¼æä¸¤ä¸ªåå ãä¸æ¯åæ ï¼Java æ¯ Sun å¬å¸çåæ ï¼æ ¹æ®ææåè®®ï¼åªæ Netscape å¬å¸å¯ä»¥åæ³å°ä½¿ç¨ JavaScript è¿ä¸ªåå­ï¼ä¸ JavaScript æ¬èº«ä¹å·²ç»è¢« Netscape å¬å¸æ³¨åä¸ºåæ ãäºæ¯æ³ä½ç°è¿é¨è¯­è¨çå¶å®èæ¯ ECMAï¼ä¸æ¯ Netscapeï¼è¿æ ·æå©äºä¿è¯è¿é¨è¯­è¨çå¼æ¾æ§åä¸­ç«æ§ã\n\nå æ­¤ï¼ECMAScript å JavaScript çå³ç³»æ¯ï¼åèæ¯åèçè§æ ¼ï¼åèæ¯åèçä¸ç§å®ç°ï¼å¦å¤ç ECMAScript æ¹è¨è¿æ JScript å ActionScriptï¼ãæ¥å¸¸åºåï¼è¿ä¸¤ä¸ªè¯æ¯å¯ä»¥äºæ¢çã\n\n\n# ES6 ä¸ ECMAScript 2015 çå³ç³»\n\nECMAScript 2015ï¼ç®ç§° ES2015ï¼è¿ä¸ªè¯ï¼ä¹æ¯ç»å¸¸å¯ä»¥çå°çãå®ä¸ ES6 æ¯ä»ä¹å³ç³»å¢ï¼\n\n2011 å¹´ï¼ECMAScript 5.1 çåå¸åï¼å°±å¼å§å¶å® 6.0 çäºãå æ­¤ï¼ES6 è¿ä¸ªè¯çåæï¼å°±æ¯æ JavaScript è¯­è¨çä¸ä¸ä¸ªçæ¬ã\n\nä½æ¯ï¼å ä¸ºè¿ä¸ªçæ¬å¼å¥çè¯­æ³åè½å¤ªå¤ï¼èä¸å¶å®è¿ç¨å½ä¸­ï¼è¿æå¾å¤ç»ç»åä¸ªäººä¸æ­æäº¤æ°åè½ãäºæå¾å¿«å°±åå¾æ¸æ¥äºï¼ä¸å¯è½å¨ä¸ä¸ªçæ¬éé¢åæ¬ææå°è¦å¼å¥çåè½ãå¸¸è§çåæ³æ¯ååå¸ 6.0 çï¼è¿ä¸æ®µæ¶é´åå 6.1 çï¼ç¶åæ¯ 6.2 çã6.3 çç­ç­ã\n\nä½æ¯ï¼æ åçå¶å®èä¸æ³è¿æ ·åãä»ä»¬æ³è®©æ åçåçº§æä¸ºå¸¸è§æµç¨ï¼ä»»ä½äººå¨ä»»ä½æ¶åï¼é½å¯ä»¥åæ åå§åä¼æäº¤æ°è¯­æ³çææ¡ï¼ç¶åæ åå§åä¼æ¯ä¸ªæå¼ä¸æ¬¡ä¼ï¼è¯ä¼°è¿äºææ¡æ¯å¦å¯ä»¥æ¥åï¼éè¦åªäºæ¹è¿ãå¦æç»è¿å¤æ¬¡ä¼è®®ä»¥åï¼ä¸ä¸ªææ¡è¶³å¤æçäºï¼å°±å¯ä»¥æ­£å¼è¿å¥æ åäºãè¿å°±æ¯è¯´ï¼æ åççæ¬åçº§æä¸ºäºä¸ä¸ªä¸æ­æ»å¨çæµç¨ï¼æ¯ä¸ªæé½ä¼æåå¨ã\n\næ åå§åä¼æç»å³å®ï¼æ åå¨æ¯å¹´ç 6 æä»½æ­£å¼åå¸ä¸æ¬¡ï¼ä½ä¸ºå½å¹´çæ­£å¼çæ¬ãæ¥ä¸æ¥çæ¶é´ï¼å°±å¨è¿ä¸ªçæ¬çåºç¡ä¸åæ¹å¨ï¼ç´å°ä¸ä¸å¹´ç 6 æä»½ï¼èæ¡å°±èªç¶åæäºæ°ä¸å¹´ççæ¬ãè¿æ ·ä¸æ¥ï¼å°±ä¸éè¦ä»¥åççæ¬å·äºï¼åªè¦ç¨å¹´ä»½æ è®°å°±å¯ä»¥äºã\n\nES6 çç¬¬ä¸ä¸ªçæ¬ï¼å°±è¿æ ·å¨ 2015 å¹´ 6 æåå¸äºï¼æ­£å¼åç§°å°±æ¯ãECMAScript 2015 æ åãï¼ç®ç§° ES2015ï¼ã2016 å¹´ 6 æï¼å°å¹ä¿®è®¢çãECMAScript 2016 æ åãï¼ç®ç§° ES2016ï¼å¦æåå¸ï¼è¿ä¸ªçæ¬å¯ä»¥çä½æ¯ ES6.1 çï¼å ä¸ºä¸¤èçå·®å¼éå¸¸å°ï¼åªæ°å¢äºæ°ç»å®ä¾çincludesæ¹æ³åææ°è¿ç®ç¬¦ï¼ï¼åºæ¬ä¸æ¯åä¸ä¸ªæ åãæ ¹æ®è®¡åï¼2017 å¹´ 6 æåå¸ ES2017 æ åã\n\nå æ­¤ï¼ES6 æ¢æ¯ä¸ä¸ªåå²åè¯ï¼ä¹æ¯ä¸ä¸ªæ³æï¼å«ä¹æ¯ 5.1 çä»¥åç JavaScript çä¸ä¸ä»£æ åï¼æ¶µçäº ES2015ãES2016ãES2017 ç­ç­ï¼è ES2015 åæ¯æ­£å¼åç§°ï¼ç¹æè¯¥å¹´åå¸çæ­£å¼çæ¬çè¯­è¨æ åãæ¬ä¹¦ä¸­æå° ES6 çå°æ¹ï¼ä¸è¬æ¯æ ES2015 æ åï¼ä½ææ¶ä¹æ¯æ³æâä¸ä¸ä»£ JavaScript è¯­è¨âã\n\n\n# è¯­æ³ææ¡çæ¹åæµç¨\n\nä»»ä½äººé½å¯ä»¥åæ åå§åä¼ï¼åç§° TC39 å§åä¼ï¼ææ¡ï¼è¦æ±ä¿®æ¹è¯­è¨æ åã\n\nä¸ç§æ°çè¯­æ³ä»ææ¡å°åææ­£å¼æ åï¼éè¦ç»åäºä¸ªé¶æ®µãæ¯ä¸ªé¶æ®µçåå¨é½éè¦ç± TC39 å§åä¼æ¹åã\n\n * Stage 0 - Strawmanï¼å±ç¤ºé¶æ®µï¼\n * Stage 1 - Proposalï¼å¾æ±æè§é¶æ®µï¼\n * Stage 2 - Draftï¼èæ¡é¶æ®µï¼\n * Stage 3 - Candidateï¼åéäººé¶æ®µï¼\n * Stage 4 - Finishedï¼å®æ¡é¶æ®µï¼\n\nä¸ä¸ªææ¡åªè¦è½è¿å¥ Stage 2ï¼å°±å·®ä¸å¤è¯å®ä¼åæ¬å¨ä»¥åçæ­£å¼æ åéé¢ãECMAScript å½åçææææ¡ï¼å¯ä»¥å¨ TC39 çå®æ¹ç½ç«GitHub.com/tc39/ecma262æ¥çã\n\næ¬ä¹¦çåä½ç®æ ä¹ä¸ï¼æ¯è·è¸ª ECMAScript è¯­è¨çææ°è¿å±ï¼ä»ç» 5.1 çæ¬ä»¥åææçæ°è¯­æ³ãå¯¹äºé£äºæç¡®æå¾æå¸æï¼å°è¦åå¥æ åçæ°è¯­æ³ï¼é½å°äºä»¥ä»ç»ã\n\n\n# ECMAScript çåå²\n\nES6 ä»å¼å§å¶å®å°æååå¸ï¼æ´æ´ç¨äº 15 å¹´ã\n\nåé¢æå°ï¼ECMAScript 1.0 æ¯ 1997 å¹´åå¸çï¼æ¥ä¸æ¥çä¸¤å¹´ï¼è¿ç»­åå¸äº ECMAScript 2.0ï¼1998 å¹´ 6 æï¼å ECMAScript 3.0ï¼1999 å¹´ 12 æï¼ã3.0 çæ¯ä¸ä¸ªå·¨å¤§çæåï¼å¨ä¸çå¾å°å¹¿æ³æ¯æï¼æä¸ºéè¡æ åï¼å¥ å®äº JavaScript è¯­è¨çåºæ¬è¯­æ³ï¼ä»¥åççæ¬å®å¨ç»§æ¿ãç´å°ä»å¤©ï¼åå­¦èä¸å¼å§å­¦ä¹  JavaScriptï¼å¶å®å°±æ¯å¨å­¦ 3.0 ççè¯­æ³ã\n\n2000 å¹´ï¼ECMAScript 4.0 å¼å§éé¿ãè¿ä¸ªçæ¬æåæ²¡æéè¿ï¼ä½æ¯å®çå¤§é¨ååå®¹è¢« ES6 ç»§æ¿äºãå æ­¤ï¼ES6 å¶å®çèµ·ç¹å¶å®æ¯ 2000 å¹´ã\n\nä¸ºä»ä¹ ES4 æ²¡æéè¿å¢ï¼å ä¸ºè¿ä¸ªçæ¬å¤ªæ¿è¿äºï¼å¯¹ ES3 åäºå½»åºåçº§ï¼å¯¼è´æ åå§åä¼çä¸äºæåä¸æ¿ææ¥åãECMA çç¬¬ 39 å·ææ¯ä¸å®¶å§åä¼ï¼Technical Committee 39ï¼ç®ç§° TC39ï¼è´è´£å¶è®¢ ECMAScript æ åï¼æååæ¬ MicrosoftãMozillaãGoogle ç­å¤§å¬å¸ã\n\n2007 å¹´ 10 æï¼ECMAScript 4.0 çèæ¡åå¸ï¼æ¬æ¥é¢è®¡æ¬¡å¹´ 8 æåå¸æ­£å¼çæ¬ãä½æ¯ï¼åæ¹å¯¹äºæ¯å¦éè¿è¿ä¸ªæ åï¼åçäºä¸¥éåæ­§ãä»¥ YahooãMicrosoftãGoogle ä¸ºé¦çå¤§å¬å¸ï¼åå¯¹ JavaScript çå¤§å¹åçº§ï¼ä¸»å¼ å°å¹æ¹å¨ï¼ä»¥ JavaScript åé è Brendan Eich ä¸ºé¦ç Mozilla å¬å¸ï¼ååæå½åçèæ¡ã\n\n2008 å¹´ 7 æï¼ç±äºå¯¹äºä¸ä¸ä¸ªçæ¬åºè¯¥åæ¬åªäºåè½ï¼åæ¹åæ­§å¤ªå¤§ï¼äºè®ºè¿äºæ¿çï¼ECMA å¼ä¼å³å®ï¼ä¸­æ­¢ ECMAScript 4.0 çå¼åï¼å°å¶ä¸­æ¶åç°æåè½æ¹åçä¸å°é¨åï¼åå¸ä¸º ECMAScript 3.1ï¼èå°å¶ä»æ¿è¿çè®¾æ³æ©å¤§èå´ï¼æ¾å¥ä»¥åççæ¬ï¼ç±äºä¼è®®çæ°æ°ï¼è¯¥çæ¬çé¡¹ç®ä»£å·èµ·åä¸º Harmonyï¼åè°ï¼ãä¼åä¸ä¹ï¼ECMAScript 3.1 å°±æ¹åä¸º ECMAScript 5ã\n\n2009 å¹´ 12 æï¼ECMAScript 5.0 çæ­£å¼åå¸ãHarmony é¡¹ç®åä¸åä¸ºäºï¼ä¸äºè¾ä¸ºå¯è¡çè®¾æ³å®åä¸º JavaScript.next ç»§ç»­å¼åï¼åæ¥æ¼åæ ECMAScript 6ï¼ä¸äºä¸æ¯å¾æççè®¾æ³ï¼åè¢«è§ä¸º JavaScript.next.nextï¼å¨æ´è¿çå°æ¥åèèæ¨åºãTC39 å§åä¼çæ»ä½èèæ¯ï¼ES5 ä¸ ES3 åºæ¬ä¿æå¼å®¹ï¼è¾å¤§çè¯­æ³ä¿®æ­£åæ°åè½å å¥ï¼å°ç± JavaScript.next å®æãå½æ¶ï¼JavaScript.next æçæ¯ ES6ï¼ç¬¬å­çåå¸ä»¥åï¼å°±æ ES7ãTC39 çå¤æ­æ¯ï¼ES5 ä¼å¨ 2013 å¹´çå¹´ä¸­æä¸º JavaScript å¼åçä¸»æµæ åï¼å¹¶å¨æ­¤åäºå¹´ä¸­ä¸ç´ä¿æè¿ä¸ªä½ç½®ã\n\n2011 å¹´ 6 æï¼ECMAScript 5.1 çåå¸ï¼å¹¶ä¸æä¸º ISO å½éæ åï¼ISO/IEC 16262:2011ï¼ã\n\n2013 å¹´ 3 æï¼ECMAScript 6 èæ¡å»ç»ï¼ä¸åæ·»å æ°åè½ãæ°çåè½è®¾æ³å°è¢«æ¾å° ECMAScript 7ã\n\n2013 å¹´ 12 æï¼ECMAScript 6 èæ¡åå¸ãç¶åæ¯ 12 ä¸ªæçè®¨è®ºæï¼å¬ååæ¹åé¦ã\n\n2015 å¹´ 6 æï¼ECMAScript 6 æ­£å¼éè¿ï¼æä¸ºå½éæ åãä» 2000 å¹´ç®èµ·ï¼è¿æ¶å·²ç»è¿å»äº 15 å¹´ã\n\n\n# é¨ç½²è¿åº¦\n\nåå¤§æµè§å¨çææ°çæ¬ï¼å¯¹ ES6 çæ¯æå¯ä»¥æ¥çkangax.github.io/compat-table/es6/ãéçæ¶é´çæ¨ç§»ï¼æ¯æåº¦å·²ç»è¶æ¥è¶é«äºï¼è¶è¿ 90%ç ES6 è¯­æ³ç¹æ§é½å®ç°äºã\n\nNode æ¯ JavaScript çæå¡å¨è¿è¡ç¯å¢ï¼runtimeï¼ãå®å¯¹ ES6 çæ¯æåº¦æ´é«ãé¤äºé£äºé»è®¤æå¼çåè½ï¼è¿æä¸äºè¯­æ³åè½å·²ç»å®ç°äºï¼ä½æ¯é»è®¤æ²¡ææå¼ãä½¿ç¨ä¸é¢çå½ä»¤ï¼å¯ä»¥æ¥ç Node å·²ç»å®ç°ç ES6 ç¹æ§ã\n\n// Linux & Mac\n$ node --v8-options | grep harmony\n\n// Windows\n$ node --v8-options | findstr harmony\n\n\n1\n2\n3\n4\n5\n\n\næåäºä¸ä¸ªå·¥å· ES-Checkerï¼ç¨æ¥æ£æ¥åç§è¿è¡ç¯å¢å¯¹ ES6 çæ¯ææåµãè®¿é®ruanyf.github.io/es-checkerï¼å¯ä»¥çå°æ¨çæµè§å¨æ¯æ ES6 çç¨åº¦ãè¿è¡ä¸é¢çå½ä»¤ï¼å¯ä»¥æ¥çä½ æ­£å¨ä½¿ç¨ç Node ç¯å¢å¯¹ ES6 çæ¯æç¨åº¦ã\n\n$ npm install -g es-checker\n$ es-checker\n\n=========================================\nPasses 24 feature Detections\nYour runtime supports 57% of ECMAScript 6\n=========================================\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# Babel è½¬ç å¨\n\nBabel æ¯ä¸ä¸ªå¹¿æ³ä½¿ç¨ç ES6 è½¬ç å¨ï¼å¯ä»¥å° ES6 ä»£ç è½¬ä¸º ES5 ä»£ç ï¼ä»èå¨ç°æç¯å¢æ§è¡ãè¿æå³çï¼ä½ å¯ä»¥ç¨ ES6 çæ¹å¼ç¼åç¨åºï¼åä¸ç¨æå¿ç°æç¯å¢æ¯å¦æ¯æãä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\n// è½¬ç å\ninput.map(item => item + 1);\n\n// è½¬ç å\ninput.map(function (item) {\n  return item + 1;\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢çåå§ä»£ç ç¨äºç®­å¤´å½æ°ï¼Babel å°å¶è½¬ä¸ºæ®éå½æ°ï¼å°±è½å¨ä¸æ¯æç®­å¤´å½æ°ç JavaScript ç¯å¢æ§è¡äºã\n\nä¸é¢çå½ä»¤å¨é¡¹ç®ç®å½ä¸­ï¼å®è£ Babelã\n\n$ npm install --save-dev @babel/core\n\n\n1\n\n\n\n# éç½®æä»¶.babelrc\n\nBabel çéç½®æä»¶æ¯.babelrcï¼å­æ¾å¨é¡¹ç®çæ ¹ç®å½ä¸ãä½¿ç¨ Babel çç¬¬ä¸æ­¥ï¼å°±æ¯éç½®è¿ä¸ªæä»¶ã\n\nè¯¥æä»¶ç¨æ¥è®¾ç½®è½¬ç è§ååæä»¶ï¼åºæ¬æ ¼å¼å¦ä¸ã\n\n{\n  \"presets\": [],\n  \"plugins\": []\n}\n\n\n1\n2\n3\n4\n\n\npresetså­æ®µè®¾å®è½¬ç è§åï¼å®æ¹æä¾ä»¥ä¸çè§åéï¼ä½ å¯ä»¥æ ¹æ®éè¦å®è£ã\n\n# ææ°è½¬ç è§å\n$ npm install --save-dev @babel/preset-env\n\n# react è½¬ç è§å\n$ npm install --save-dev @babel/preset-react\n\n\n1\n2\n3\n4\n5\n\n\nç¶åï¼å°è¿äºè§åå å¥.babelrcã\n\n  {\n    \"presets\": [\n      \"@babel/env\",\n      \"@babel/preset-react\"\n    ],\n    \"plugins\": []\n  }\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næ³¨æï¼ä»¥ä¸ææ Babel å·¥å·åæ¨¡åçä½¿ç¨ï¼é½å¿é¡»ååå¥½.babelrcã\n\n\n# å½ä»¤è¡è½¬ç \n\nBabel æä¾å½ä»¤è¡å·¥å·@babel/cliï¼ç¨äºå½ä»¤è¡è½¬ç ã\n\nå®çå®è£å½ä»¤å¦ä¸ã\n\n$ npm install --save-dev @babel/cli\n\n\n1\n\n\nåºæ¬ç¨æ³å¦ä¸ã\n\n# è½¬ç ç»æè¾åºå°æ åè¾åº\n$ npx babel example.js\n\n# è½¬ç ç»æåå¥ä¸ä¸ªæä»¶\n# --out-file æ -o åæ°æå®è¾åºæä»¶\n$ npx babel example.js --out-file compiled.js\n# æè\n$ npx babel example.js -o compiled.js\n\n# æ´ä¸ªç®å½è½¬ç \n# --out-dir æ -d åæ°æå®è¾åºç®å½\n$ npx babel src --out-dir lib\n# æè\n$ npx babel src -d lib\n\n# -s åæ°çæsource mapæä»¶\n$ npx babel src -d lib -s\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n# babel-node\n\n@babel/nodeæ¨¡åçbabel-nodeå½ä»¤ï¼æä¾ä¸ä¸ªæ¯æ ES6 ç REPL ç¯å¢ãå®æ¯æ Node ç REPL ç¯å¢çææåè½ï¼èä¸å¯ä»¥ç´æ¥è¿è¡ ES6 ä»£ç ã\n\né¦åï¼å®è£è¿ä¸ªæ¨¡åã\n\n$ npm install --save-dev @babel/node\n\n\n1\n\n\nç¶åï¼æ§è¡babel-nodeå°±è¿å¥ REPL ç¯å¢ã\n\n$ npx babel-node\n> (x => x * 2)(1)\n2\n\n\n1\n2\n3\n\n\nbabel-nodeå½ä»¤å¯ä»¥ç´æ¥è¿è¡ ES6 èæ¬ãå°ä¸é¢çä»£ç æ¾å¥èæ¬æä»¶es6.jsï¼ç¶åç´æ¥è¿è¡ã\n\n# es6.js çä»£ç \n# console.log((x => x * 2)(1));\n$ npx babel-node es6.js\n2\n\n\n1\n2\n3\n4\n\n\n\n# @babel/register æ¨¡å\n\n@babel/registeræ¨¡åæ¹årequireå½ä»¤ï¼ä¸ºå®å ä¸ä¸ä¸ªé©å­ãæ­¤åï¼æ¯å½ä½¿ç¨requireå è½½.jsã.jsxã.eså.es6åç¼åçæä»¶ï¼å°±ä¼åç¨ Babel è¿è¡è½¬ç ã\n\n$ npm install --save-dev @babel/register\n\n\n1\n\n\nä½¿ç¨æ¶ï¼å¿é¡»é¦åå è½½@babel/registerã\n\n// index.js\nrequire('@babel/register');\nrequire('./es6.js');\n\n\n1\n2\n3\n\n\nç¶åï¼å°±ä¸éè¦æå¨å¯¹index.jsè½¬ç äºã\n\n$ node index.js\n2\n\n\n1\n2\n\n\néè¦æ³¨æçæ¯ï¼@babel/registeråªä¼å¯¹requireå½ä»¤å è½½çæä»¶è½¬ç ï¼èä¸ä¼å¯¹å½åæä»¶è½¬ç ãå¦å¤ï¼ç±äºå®æ¯å®æ¶è½¬ç ï¼æä»¥åªéåå¨å¼åç¯å¢ä½¿ç¨ã\n\n\n# babel API\n\nå¦ææäºä»£ç éè¦è°ç¨ Babel ç API è¿è¡è½¬ç ï¼å°±è¦ä½¿ç¨@babel/coreæ¨¡åã\n\nvar babel = require('@babel/core');\n\n// å­ç¬¦ä¸²è½¬ç \nbabel.transform('code();', options);\n// => { code, map, ast }\n\n// æä»¶è½¬ç ï¼å¼æ­¥ï¼\nbabel.transformFile('filename.js', options, function(err, result) {\n  result; // => { code, map, ast }\n});\n\n// æä»¶è½¬ç ï¼åæ­¥ï¼\nbabel.transformFileSync('filename.js', options);\n// => { code, map, ast }\n\n// Babel ASTè½¬ç \nbabel.transformFromAst(ast, code, options);\n// => { code, map, ast }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\néç½®å¯¹è±¡optionsï¼å¯ä»¥åçå®æ¹ææ¡£http://babeljs.io/docs/usage/options/ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nvar es6Code = 'let x = n => n + 1';\nvar es5Code = require('@babel/core')\n  .transform(es6Code, {\n    presets: ['@babel/env']\n  })\n  .code;\n\nconsole.log(es5Code);\n// '\"use strict\";\\n\\nvar x = function x(n) {\\n  return n + 1;\\n};'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼transformæ¹æ³çç¬¬ä¸ä¸ªåæ°æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼è¡¨ç¤ºéè¦è¢«è½¬æ¢ç ES6 ä»£ç ï¼ç¬¬äºä¸ªåæ°æ¯è½¬æ¢çéç½®å¯¹è±¡ã\n\n\n# @babel/polyfill\n\nBabel é»è®¤åªè½¬æ¢æ°ç JavaScript å¥æ³ï¼syntaxï¼ï¼èä¸è½¬æ¢æ°ç APIï¼æ¯å¦IteratorãGeneratorãSetãMapãProxyãReflectãSymbolãPromiseç­å¨å±å¯¹è±¡ï¼ä»¥åä¸äºå®ä¹å¨å¨å±å¯¹è±¡ä¸çæ¹æ³ï¼æ¯å¦Object.assignï¼é½ä¸ä¼è½¬ç ã\n\nä¸¾ä¾æ¥è¯´ï¼ES6 å¨Arrayå¯¹è±¡ä¸æ°å¢äºArray.fromæ¹æ³ãBabel å°±ä¸ä¼è½¬ç è¿ä¸ªæ¹æ³ãå¦ææ³è®©è¿ä¸ªæ¹æ³è¿è¡ï¼å¿é¡»ä½¿ç¨babel-polyfillï¼ä¸ºå½åç¯å¢æä¾ä¸ä¸ªå«çã\n\nå®è£å½ä»¤å¦ä¸ã\n\n$ npm install --save-dev @babel/polyfill\n\n\n1\n\n\nç¶åï¼å¨èæ¬å¤´é¨ï¼å å¥å¦ä¸ä¸è¡ä»£ç ã\n\nimport '@babel/polyfill';\n// æè\nrequire('@babel/polyfill');\n\n\n1\n2\n3\n\n\nBabel é»è®¤ä¸è½¬ç ç API éå¸¸å¤ï¼è¯¦ç»æ¸åå¯ä»¥æ¥çbabel-plugin-transform-runtimeæ¨¡åçdefinitions.jsæä»¶ã\n\n\n# æµè§å¨ç¯å¢\n\nBabel ä¹å¯ä»¥ç¨äºæµè§å¨ç¯å¢ï¼ä½¿ç¨@babel/standaloneæ¨¡åæä¾çæµè§å¨çæ¬ï¼å°å¶æå¥ç½é¡µã\n\n<script src=\"https://unpkg.com/@babel/standalone/babel.min.js\"><\/script>\n<script type=\"text/babel\">\n// Your ES6 code\n<\/script>\n\n\n1\n2\n3\n4\n\n\næ³¨æï¼ç½é¡µå®æ¶å° ES6 ä»£ç è½¬ä¸º ES5ï¼å¯¹æ§è½ä¼æå½±åãçäº§ç¯å¢éè¦å è½½å·²ç»è½¬ç å®æçèæ¬ã\n\nBabel æä¾ä¸ä¸ªREPL å¨çº¿ç¼è¯å¨ï¼å¯ä»¥å¨çº¿å° ES6 ä»£ç è½¬ä¸º ES5 ä»£ç ãè½¬æ¢åçä»£ç ï¼å¯ä»¥ç´æ¥ä½ä¸º ES5 ä»£ç æå¥ç½é¡µè¿è¡ã\n\n\n# Traceur è½¬ç å¨\n\nGoogle å¬å¸çTraceurè½¬ç å¨ï¼ä¹å¯ä»¥å° ES6 ä»£ç è½¬ä¸º ES5 ä»£ç ã\n\n\n# ç´æ¥æå¥ç½é¡µ\n\nTraceur åè®¸å° ES6 ä»£ç ç´æ¥æå¥ç½é¡µãé¦åï¼å¿é¡»å¨ç½é¡µå¤´é¨å è½½ Traceur åºæä»¶ã\n\n<script src=\"https://google.github.io/traceur-compiler/bin/traceur.js\"><\/script>\n<script src=\"https://google.github.io/traceur-compiler/bin/BrowserSystem.js\"><\/script>\n<script src=\"https://google.github.io/traceur-compiler/src/bootstrap.js\"><\/script>\n<script type=\"module\">\n  import './Greeter.js';\n<\/script>\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸å±æ 4 ä¸ªscriptæ ç­¾ãç¬¬ä¸ä¸ªæ¯å è½½ Traceur çåºæä»¶ï¼ç¬¬äºä¸ªåç¬¬ä¸ä¸ªæ¯å°è¿ä¸ªåºæä»¶ç¨äºæµè§å¨ç¯å¢ï¼ç¬¬åä¸ªåæ¯å è½½ç¨æ·èæ¬ï¼è¿ä¸ªèæ¬éé¢å¯ä»¥ä½¿ç¨ ES6 ä»£ç ã\n\næ³¨æï¼ç¬¬åä¸ªscriptæ ç­¾çtypeå±æ§çå¼æ¯moduleï¼èä¸æ¯text/javascriptãè¿æ¯ Traceur ç¼è¯å¨è¯å« ES6 ä»£ç çæ å¿ï¼ç¼è¯å¨ä¼èªå¨å°æætype=moduleçä»£ç ç¼è¯ä¸º ES5ï¼ç¶ååäº¤ç»æµè§å¨æ§è¡ã\n\né¤äºå¼ç¨å¤é¨ ES6 èæ¬ï¼ä¹å¯ä»¥ç´æ¥å¨ç½é¡µä¸­æ¾ç½® ES6 ä»£ç ã\n\n<script type=\"module\">\n  class Calc {\n    constructor() {\n      console.log('Calc constructor');\n    }\n    add(a, b) {\n      return a + b;\n    }\n  }\n\n  var c = new Calc();\n  console.log(c.add(4,5));\n<\/script>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\næ­£å¸¸æåµä¸ï¼ä¸é¢ä»£ç ä¼å¨æ§å¶å°æå°åº9ã\n\nå¦ææ³å¯¹ Traceur çè¡ä¸ºæç²¾ç¡®æ§å¶ï¼å¯ä»¥éç¨ä¸é¢åæ°éç½®çåæ³ã\n\n<script>\n  // Create the System object\n  window.System = new traceur.runtime.BrowserTraceurLoader();\n  // Set some experimental options\n  var metadata = {\n    traceurOptions: {\n      experimental: true,\n      properTailCalls: true,\n      symbols: true,\n      arrayComprehension: true,\n      asyncFunctions: true,\n      asyncGenerators: exponentiation,\n      forOn: true,\n      generatorComprehension: true\n    }\n  };\n  // Load your module\n  System.import('./myModule.js', {metadata: metadata}).catch(function(ex) {\n    console.error('Import failed', ex.stack || ex);\n  });\n<\/script>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nä¸é¢ä»£ç ä¸­ï¼é¦åçæ Traceur çå¨å±å¯¹è±¡window.Systemï¼ç¶åSystem.importæ¹æ³å¯ä»¥ç¨æ¥å è½½ ES6ãå è½½çæ¶åï¼éè¦ä¼ å¥ä¸ä¸ªéç½®å¯¹è±¡metadataï¼è¯¥å¯¹è±¡çtraceurOptionså±æ§å¯ä»¥éç½®æ¯æ ES6 åè½ãå¦æè®¾ä¸ºexperimental: trueï¼å°±è¡¨ç¤ºé¤äº ES6 ä»¥å¤ï¼è¿æ¯æä¸äºå®éªæ§çæ°åè½ã\n\n\n# å¨çº¿è½¬æ¢\n\nTraceur ä¹æä¾ä¸ä¸ªå¨çº¿ç¼è¯å¨ï¼å¯ä»¥å¨çº¿å° ES6 ä»£ç è½¬ä¸º ES5 ä»£ç ãè½¬æ¢åçä»£ç ï¼å¯ä»¥ç´æ¥ä½ä¸º ES5 ä»£ç æå¥ç½é¡µè¿è¡ã\n\nä¸é¢çä¾å­è½¬ä¸º ES5 ä»£ç è¿è¡ï¼å°±æ¯ä¸é¢è¿ä¸ªæ ·å­ã\n\n<script src=\"https://google.github.io/traceur-compiler/bin/traceur.js\"><\/script>\n<script src=\"https://google.github.io/traceur-compiler/bin/BrowserSystem.js\"><\/script>\n<script src=\"https://google.github.io/traceur-compiler/src/bootstrap.js\"><\/script>\n<script>\n$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n\n  var Calc = function Calc() {\n    console.log('Calc constructor');\n  };\n\n  ($traceurRuntime.createClass)(Calc, {add: function(a, b) {\n    return a + b;\n  }}, {});\n\n  var c = new Calc();\n  console.log(c.add(4, 5));\n  return {};\n});\n<\/script>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n\n# å½ä»¤è¡è½¬æ¢\n\nä½ä¸ºå½ä»¤è¡å·¥å·ä½¿ç¨æ¶ï¼Traceur æ¯ä¸ä¸ª Node çæ¨¡åï¼é¦åéè¦ç¨ npm å®è£ã\n\n$ npm install -g traceur\n\n\n1\n\n\nå®è£æååï¼å°±å¯ä»¥å¨å½ä»¤è¡ä¸ä½¿ç¨ Traceur äºã\n\nTraceur ç´æ¥è¿è¡ ES6 èæ¬æä»¶ï¼ä¼å¨æ åè¾åºæ¾ç¤ºè¿è¡ç»æï¼ä»¥åé¢çcalc.jsä¸ºä¾ã\n\n$ traceur calc.js\nCalc constructor\n9\n\n\n1\n2\n3\n\n\nå¦æè¦å° ES6 èæ¬è½¬ä¸º ES5 ä¿å­ï¼è¦éç¨ä¸é¢çåæ³ã\n\n$ traceur --script calc.es6.js --out calc.es5.js\n\n\n1\n\n\nä¸é¢ä»£ç ç--scriptéé¡¹è¡¨ç¤ºæå®è¾å¥æä»¶ï¼--outéé¡¹è¡¨ç¤ºæå®è¾åºæä»¶ã\n\nä¸ºäºé²æ­¢æäºç¹æ§ç¼è¯ä¸æåï¼æå¥½å ä¸--experimentaléé¡¹ã\n\n$ traceur --script calc.es6.js --out calc.es5.js --experimental\n\n\n1\n\n\nå½ä»¤è¡ä¸è½¬æ¢çæçæä»¶ï¼å°±å¯ä»¥ç´æ¥æ¾å°æµè§å¨ä¸­è¿è¡ã\n\n\n# Node ç¯å¢çç¨æ³\n\nTraceur ç Node ç¨æ³å¦ä¸ï¼åå®å·²å®è£traceuræ¨¡åï¼ã\n\nvar traceur = require('traceur');\nvar fs = require('fs');\n\n// å° ES6 èæ¬è½¬ä¸ºå­ç¬¦ä¸²\nvar contents = fs.readFileSync('es6-file.js').toString();\n\nvar result = traceur.compile(contents, {\n  filename: 'es6-file.js',\n  sourceMap: true,\n  // å¶ä»è®¾ç½®\n  modules: 'commonjs'\n});\n\nif (result.error)\n  throw result.error;\n\n// result å¯¹è±¡ç js å±æ§å°±æ¯è½¬æ¢åç ES5 ä»£ç \nfs.writeFileSync('out.js', result.js);\n// sourceMap å±æ§å¯¹åº map æä»¶\nfs.writeFileSync('out.js.map', result.sourceMap);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n",normalizedContent:"> è¯´æï¼æ¬ç« åå®¹ä¸ºåä¸»å¨åæç¨åºç¡ä¸æ·»å èªå·±çå­¦ä¹ ç¬è®°ï¼æ¥æºhttp://es6.ruanyifeng.com/ï¼æç¨çæå½åä½èææã\n\n\n# ecmascript 6 ç®ä»\n\necmascript 6.0ï¼ä»¥ä¸ç®ç§° es6ï¼æ¯ javascript è¯­è¨çä¸ä¸ä»£æ åï¼å·²ç»å¨ 2015 å¹´ 6 ææ­£å¼åå¸äºãå®çç®æ ï¼æ¯ä½¿å¾ javascript è¯­è¨å¯ä»¥ç¨æ¥ç¼åå¤æçå¤§ååºç¨ç¨åºï¼æä¸ºä¼ä¸çº§å¼åè¯­è¨ã\n\n\n# ecmascript å javascript çå³ç³»\n\nä¸ä¸ªå¸¸è§çé®é¢æ¯ï¼ecmascript å javascript å°åºæ¯ä»ä¹å³ç³»ï¼\n\nè¦è®²æ¸æ¥è¿ä¸ªé®é¢ï¼éè¦åé¡¾åå²ã1996 å¹´ 11 æï¼javascript çåé è netscape å¬å¸ï¼å³å®å° javascript æäº¤ç»æ ååç»ç» ecmaï¼å¸æè¿ç§è¯­è¨è½å¤æä¸ºå½éæ åãæ¬¡å¹´ï¼ecma åå¸ 262 å·æ åæä»¶ï¼ecma-262ï¼çç¬¬ä¸çï¼è§å®äºæµè§å¨èæ¬è¯­è¨çæ åï¼å¹¶å°è¿ç§è¯­è¨ç§°ä¸º ecmascriptï¼è¿ä¸ªçæ¬å°±æ¯ 1.0 çã\n\nè¯¥æ åä»ä¸å¼å§å°±æ¯éå¯¹ javascript è¯­è¨å¶å®çï¼ä½æ¯ä¹æä»¥ä¸å« javascriptï¼æä¸¤ä¸ªåå ãä¸æ¯åæ ï¼java æ¯ sun å¬å¸çåæ ï¼æ ¹æ®ææåè®®ï¼åªæ netscape å¬å¸å¯ä»¥åæ³å°ä½¿ç¨ javascript è¿ä¸ªåå­ï¼ä¸ javascript æ¬èº«ä¹å·²ç»è¢« netscape å¬å¸æ³¨åä¸ºåæ ãäºæ¯æ³ä½ç°è¿é¨è¯­è¨çå¶å®èæ¯ ecmaï¼ä¸æ¯ netscapeï¼è¿æ ·æå©äºä¿è¯è¿é¨è¯­è¨çå¼æ¾æ§åä¸­ç«æ§ã\n\nå æ­¤ï¼ecmascript å javascript çå³ç³»æ¯ï¼åèæ¯åèçè§æ ¼ï¼åèæ¯åèçä¸ç§å®ç°ï¼å¦å¤ç ecmascript æ¹è¨è¿æ jscript å actionscriptï¼ãæ¥å¸¸åºåï¼è¿ä¸¤ä¸ªè¯æ¯å¯ä»¥äºæ¢çã\n\n\n# es6 ä¸ ecmascript 2015 çå³ç³»\n\necmascript 2015ï¼ç®ç§° es2015ï¼è¿ä¸ªè¯ï¼ä¹æ¯ç»å¸¸å¯ä»¥çå°çãå®ä¸ es6 æ¯ä»ä¹å³ç³»å¢ï¼\n\n2011 å¹´ï¼ecmascript 5.1 çåå¸åï¼å°±å¼å§å¶å® 6.0 çäºãå æ­¤ï¼es6 è¿ä¸ªè¯çåæï¼å°±æ¯æ javascript è¯­è¨çä¸ä¸ä¸ªçæ¬ã\n\nä½æ¯ï¼å ä¸ºè¿ä¸ªçæ¬å¼å¥çè¯­æ³åè½å¤ªå¤ï¼èä¸å¶å®è¿ç¨å½ä¸­ï¼è¿æå¾å¤ç»ç»åä¸ªäººä¸æ­æäº¤æ°åè½ãäºæå¾å¿«å°±åå¾æ¸æ¥äºï¼ä¸å¯è½å¨ä¸ä¸ªçæ¬éé¢åæ¬ææå°è¦å¼å¥çåè½ãå¸¸è§çåæ³æ¯ååå¸ 6.0 çï¼è¿ä¸æ®µæ¶é´åå 6.1 çï¼ç¶åæ¯ 6.2 çã6.3 çç­ç­ã\n\nä½æ¯ï¼æ åçå¶å®èä¸æ³è¿æ ·åãä»ä»¬æ³è®©æ åçåçº§æä¸ºå¸¸è§æµç¨ï¼ä»»ä½äººå¨ä»»ä½æ¶åï¼é½å¯ä»¥åæ åå§åä¼æäº¤æ°è¯­æ³çææ¡ï¼ç¶åæ åå§åä¼æ¯ä¸ªæå¼ä¸æ¬¡ä¼ï¼è¯ä¼°è¿äºææ¡æ¯å¦å¯ä»¥æ¥åï¼éè¦åªäºæ¹è¿ãå¦æç»è¿å¤æ¬¡ä¼è®®ä»¥åï¼ä¸ä¸ªææ¡è¶³å¤æçäºï¼å°±å¯ä»¥æ­£å¼è¿å¥æ åäºãè¿å°±æ¯è¯´ï¼æ åççæ¬åçº§æä¸ºäºä¸ä¸ªä¸æ­æ»å¨çæµç¨ï¼æ¯ä¸ªæé½ä¼æåå¨ã\n\næ åå§åä¼æç»å³å®ï¼æ åå¨æ¯å¹´ç 6 æä»½æ­£å¼åå¸ä¸æ¬¡ï¼ä½ä¸ºå½å¹´çæ­£å¼çæ¬ãæ¥ä¸æ¥çæ¶é´ï¼å°±å¨è¿ä¸ªçæ¬çåºç¡ä¸åæ¹å¨ï¼ç´å°ä¸ä¸å¹´ç 6 æä»½ï¼èæ¡å°±èªç¶åæäºæ°ä¸å¹´ççæ¬ãè¿æ ·ä¸æ¥ï¼å°±ä¸éè¦ä»¥åççæ¬å·äºï¼åªè¦ç¨å¹´ä»½æ è®°å°±å¯ä»¥äºã\n\nes6 çç¬¬ä¸ä¸ªçæ¬ï¼å°±è¿æ ·å¨ 2015 å¹´ 6 æåå¸äºï¼æ­£å¼åç§°å°±æ¯ãecmascript 2015 æ åãï¼ç®ç§° es2015ï¼ã2016 å¹´ 6 æï¼å°å¹ä¿®è®¢çãecmascript 2016 æ åãï¼ç®ç§° es2016ï¼å¦æåå¸ï¼è¿ä¸ªçæ¬å¯ä»¥çä½æ¯ es6.1 çï¼å ä¸ºä¸¤èçå·®å¼éå¸¸å°ï¼åªæ°å¢äºæ°ç»å®ä¾çincludesæ¹æ³åææ°è¿ç®ç¬¦ï¼ï¼åºæ¬ä¸æ¯åä¸ä¸ªæ åãæ ¹æ®è®¡åï¼2017 å¹´ 6 æåå¸ es2017 æ åã\n\nå æ­¤ï¼es6 æ¢æ¯ä¸ä¸ªåå²åè¯ï¼ä¹æ¯ä¸ä¸ªæ³æï¼å«ä¹æ¯ 5.1 çä»¥åç javascript çä¸ä¸ä»£æ åï¼æ¶µçäº es2015ães2016ães2017 ç­ç­ï¼è es2015 åæ¯æ­£å¼åç§°ï¼ç¹æè¯¥å¹´åå¸çæ­£å¼çæ¬çè¯­è¨æ åãæ¬ä¹¦ä¸­æå° es6 çå°æ¹ï¼ä¸è¬æ¯æ es2015 æ åï¼ä½ææ¶ä¹æ¯æ³æâä¸ä¸ä»£ javascript è¯­è¨âã\n\n\n# è¯­æ³ææ¡çæ¹åæµç¨\n\nä»»ä½äººé½å¯ä»¥åæ åå§åä¼ï¼åç§° tc39 å§åä¼ï¼ææ¡ï¼è¦æ±ä¿®æ¹è¯­è¨æ åã\n\nä¸ç§æ°çè¯­æ³ä»ææ¡å°åææ­£å¼æ åï¼éè¦ç»åäºä¸ªé¶æ®µãæ¯ä¸ªé¶æ®µçåå¨é½éè¦ç± tc39 å§åä¼æ¹åã\n\n * stage 0 - strawmanï¼å±ç¤ºé¶æ®µï¼\n * stage 1 - proposalï¼å¾æ±æè§é¶æ®µï¼\n * stage 2 - draftï¼èæ¡é¶æ®µï¼\n * stage 3 - candidateï¼åéäººé¶æ®µï¼\n * stage 4 - finishedï¼å®æ¡é¶æ®µï¼\n\nä¸ä¸ªææ¡åªè¦è½è¿å¥ stage 2ï¼å°±å·®ä¸å¤è¯å®ä¼åæ¬å¨ä»¥åçæ­£å¼æ åéé¢ãecmascript å½åçææææ¡ï¼å¯ä»¥å¨ tc39 çå®æ¹ç½ç«github.com/tc39/ecma262æ¥çã\n\næ¬ä¹¦çåä½ç®æ ä¹ä¸ï¼æ¯è·è¸ª ecmascript è¯­è¨çææ°è¿å±ï¼ä»ç» 5.1 çæ¬ä»¥åææçæ°è¯­æ³ãå¯¹äºé£äºæç¡®æå¾æå¸æï¼å°è¦åå¥æ åçæ°è¯­æ³ï¼é½å°äºä»¥ä»ç»ã\n\n\n# ecmascript çåå²\n\nes6 ä»å¼å§å¶å®å°æååå¸ï¼æ´æ´ç¨äº 15 å¹´ã\n\nåé¢æå°ï¼ecmascript 1.0 æ¯ 1997 å¹´åå¸çï¼æ¥ä¸æ¥çä¸¤å¹´ï¼è¿ç»­åå¸äº ecmascript 2.0ï¼1998 å¹´ 6 æï¼å ecmascript 3.0ï¼1999 å¹´ 12 æï¼ã3.0 çæ¯ä¸ä¸ªå·¨å¤§çæåï¼å¨ä¸çå¾å°å¹¿æ³æ¯æï¼æä¸ºéè¡æ åï¼å¥ å®äº javascript è¯­è¨çåºæ¬è¯­æ³ï¼ä»¥åççæ¬å®å¨ç»§æ¿ãç´å°ä»å¤©ï¼åå­¦èä¸å¼å§å­¦ä¹  javascriptï¼å¶å®å°±æ¯å¨å­¦ 3.0 ççè¯­æ³ã\n\n2000 å¹´ï¼ecmascript 4.0 å¼å§éé¿ãè¿ä¸ªçæ¬æåæ²¡æéè¿ï¼ä½æ¯å®çå¤§é¨ååå®¹è¢« es6 ç»§æ¿äºãå æ­¤ï¼es6 å¶å®çèµ·ç¹å¶å®æ¯ 2000 å¹´ã\n\nä¸ºä»ä¹ es4 æ²¡æéè¿å¢ï¼å ä¸ºè¿ä¸ªçæ¬å¤ªæ¿è¿äºï¼å¯¹ es3 åäºå½»åºåçº§ï¼å¯¼è´æ åå§åä¼çä¸äºæåä¸æ¿ææ¥åãecma çç¬¬ 39 å·ææ¯ä¸å®¶å§åä¼ï¼technical committee 39ï¼ç®ç§° tc39ï¼è´è´£å¶è®¢ ecmascript æ åï¼æååæ¬ microsoftãmozillaãgoogle ç­å¤§å¬å¸ã\n\n2007 å¹´ 10 æï¼ecmascript 4.0 çèæ¡åå¸ï¼æ¬æ¥é¢è®¡æ¬¡å¹´ 8 æåå¸æ­£å¼çæ¬ãä½æ¯ï¼åæ¹å¯¹äºæ¯å¦éè¿è¿ä¸ªæ åï¼åçäºä¸¥éåæ­§ãä»¥ yahooãmicrosoftãgoogle ä¸ºé¦çå¤§å¬å¸ï¼åå¯¹ javascript çå¤§å¹åçº§ï¼ä¸»å¼ å°å¹æ¹å¨ï¼ä»¥ javascript åé è brendan eich ä¸ºé¦ç mozilla å¬å¸ï¼ååæå½åçèæ¡ã\n\n2008 å¹´ 7 æï¼ç±äºå¯¹äºä¸ä¸ä¸ªçæ¬åºè¯¥åæ¬åªäºåè½ï¼åæ¹åæ­§å¤ªå¤§ï¼äºè®ºè¿äºæ¿çï¼ecma å¼ä¼å³å®ï¼ä¸­æ­¢ ecmascript 4.0 çå¼åï¼å°å¶ä¸­æ¶åç°æåè½æ¹åçä¸å°é¨åï¼åå¸ä¸º ecmascript 3.1ï¼èå°å¶ä»æ¿è¿çè®¾æ³æ©å¤§èå´ï¼æ¾å¥ä»¥åççæ¬ï¼ç±äºä¼è®®çæ°æ°ï¼è¯¥çæ¬çé¡¹ç®ä»£å·èµ·åä¸º harmonyï¼åè°ï¼ãä¼åä¸ä¹ï¼ecmascript 3.1 å°±æ¹åä¸º ecmascript 5ã\n\n2009 å¹´ 12 æï¼ecmascript 5.0 çæ­£å¼åå¸ãharmony é¡¹ç®åä¸åä¸ºäºï¼ä¸äºè¾ä¸ºå¯è¡çè®¾æ³å®åä¸º javascript.next ç»§ç»­å¼åï¼åæ¥æ¼åæ ecmascript 6ï¼ä¸äºä¸æ¯å¾æççè®¾æ³ï¼åè¢«è§ä¸º javascript.next.nextï¼å¨æ´è¿çå°æ¥åèèæ¨åºãtc39 å§åä¼çæ»ä½èèæ¯ï¼es5 ä¸ es3 åºæ¬ä¿æå¼å®¹ï¼è¾å¤§çè¯­æ³ä¿®æ­£åæ°åè½å å¥ï¼å°ç± javascript.next å®æãå½æ¶ï¼javascript.next æçæ¯ es6ï¼ç¬¬å­çåå¸ä»¥åï¼å°±æ es7ãtc39 çå¤æ­æ¯ï¼es5 ä¼å¨ 2013 å¹´çå¹´ä¸­æä¸º javascript å¼åçä¸»æµæ åï¼å¹¶å¨æ­¤åäºå¹´ä¸­ä¸ç´ä¿æè¿ä¸ªä½ç½®ã\n\n2011 å¹´ 6 æï¼ecmascript 5.1 çåå¸ï¼å¹¶ä¸æä¸º iso å½éæ åï¼iso/iec 16262:2011ï¼ã\n\n2013 å¹´ 3 æï¼ecmascript 6 èæ¡å»ç»ï¼ä¸åæ·»å æ°åè½ãæ°çåè½è®¾æ³å°è¢«æ¾å° ecmascript 7ã\n\n2013 å¹´ 12 æï¼ecmascript 6 èæ¡åå¸ãç¶åæ¯ 12 ä¸ªæçè®¨è®ºæï¼å¬ååæ¹åé¦ã\n\n2015 å¹´ 6 æï¼ecmascript 6 æ­£å¼éè¿ï¼æä¸ºå½éæ åãä» 2000 å¹´ç®èµ·ï¼è¿æ¶å·²ç»è¿å»äº 15 å¹´ã\n\n\n# é¨ç½²è¿åº¦\n\nåå¤§æµè§å¨çææ°çæ¬ï¼å¯¹ es6 çæ¯æå¯ä»¥æ¥çkangax.github.io/compat-table/es6/ãéçæ¶é´çæ¨ç§»ï¼æ¯æåº¦å·²ç»è¶æ¥è¶é«äºï¼è¶è¿ 90%ç es6 è¯­æ³ç¹æ§é½å®ç°äºã\n\nnode æ¯ javascript çæå¡å¨è¿è¡ç¯å¢ï¼runtimeï¼ãå®å¯¹ es6 çæ¯æåº¦æ´é«ãé¤äºé£äºé»è®¤æå¼çåè½ï¼è¿æä¸äºè¯­æ³åè½å·²ç»å®ç°äºï¼ä½æ¯é»è®¤æ²¡ææå¼ãä½¿ç¨ä¸é¢çå½ä»¤ï¼å¯ä»¥æ¥ç node å·²ç»å®ç°ç es6 ç¹æ§ã\n\n// linux & mac\n$ node --v8-options | grep harmony\n\n// windows\n$ node --v8-options | findstr harmony\n\n\n1\n2\n3\n4\n5\n\n\næåäºä¸ä¸ªå·¥å· es-checkerï¼ç¨æ¥æ£æ¥åç§è¿è¡ç¯å¢å¯¹ es6 çæ¯ææåµãè®¿é®ruanyf.github.io/es-checkerï¼å¯ä»¥çå°æ¨çæµè§å¨æ¯æ es6 çç¨åº¦ãè¿è¡ä¸é¢çå½ä»¤ï¼å¯ä»¥æ¥çä½ æ­£å¨ä½¿ç¨ç node ç¯å¢å¯¹ es6 çæ¯æç¨åº¦ã\n\n$ npm install -g es-checker\n$ es-checker\n\n=========================================\npasses 24 feature detections\nyour runtime supports 57% of ecmascript 6\n=========================================\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# babel è½¬ç å¨\n\nbabel æ¯ä¸ä¸ªå¹¿æ³ä½¿ç¨ç es6 è½¬ç å¨ï¼å¯ä»¥å° es6 ä»£ç è½¬ä¸º es5 ä»£ç ï¼ä»èå¨ç°æç¯å¢æ§è¡ãè¿æå³çï¼ä½ å¯ä»¥ç¨ es6 çæ¹å¼ç¼åç¨åºï¼åä¸ç¨æå¿ç°æç¯å¢æ¯å¦æ¯æãä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\n// è½¬ç å\ninput.map(item => item + 1);\n\n// è½¬ç å\ninput.map(function (item) {\n  return item + 1;\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢çåå§ä»£ç ç¨äºç®­å¤´å½æ°ï¼babel å°å¶è½¬ä¸ºæ®éå½æ°ï¼å°±è½å¨ä¸æ¯æç®­å¤´å½æ°ç javascript ç¯å¢æ§è¡äºã\n\nä¸é¢çå½ä»¤å¨é¡¹ç®ç®å½ä¸­ï¼å®è£ babelã\n\n$ npm install --save-dev @babel/core\n\n\n1\n\n\n\n# éç½®æä»¶.babelrc\n\nbabel çéç½®æä»¶æ¯.babelrcï¼å­æ¾å¨é¡¹ç®çæ ¹ç®å½ä¸ãä½¿ç¨ babel çç¬¬ä¸æ­¥ï¼å°±æ¯éç½®è¿ä¸ªæä»¶ã\n\nè¯¥æä»¶ç¨æ¥è®¾ç½®è½¬ç è§ååæä»¶ï¼åºæ¬æ ¼å¼å¦ä¸ã\n\n{\n  \"presets\": [],\n  \"plugins\": []\n}\n\n\n1\n2\n3\n4\n\n\npresetså­æ®µè®¾å®è½¬ç è§åï¼å®æ¹æä¾ä»¥ä¸çè§åéï¼ä½ å¯ä»¥æ ¹æ®éè¦å®è£ã\n\n# ææ°è½¬ç è§å\n$ npm install --save-dev @babel/preset-env\n\n# react è½¬ç è§å\n$ npm install --save-dev @babel/preset-react\n\n\n1\n2\n3\n4\n5\n\n\nç¶åï¼å°è¿äºè§åå å¥.babelrcã\n\n  {\n    \"presets\": [\n      \"@babel/env\",\n      \"@babel/preset-react\"\n    ],\n    \"plugins\": []\n  }\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næ³¨æï¼ä»¥ä¸ææ babel å·¥å·åæ¨¡åçä½¿ç¨ï¼é½å¿é¡»ååå¥½.babelrcã\n\n\n# å½ä»¤è¡è½¬ç \n\nbabel æä¾å½ä»¤è¡å·¥å·@babel/cliï¼ç¨äºå½ä»¤è¡è½¬ç ã\n\nå®çå®è£å½ä»¤å¦ä¸ã\n\n$ npm install --save-dev @babel/cli\n\n\n1\n\n\nåºæ¬ç¨æ³å¦ä¸ã\n\n# è½¬ç ç»æè¾åºå°æ åè¾åº\n$ npx babel example.js\n\n# è½¬ç ç»æåå¥ä¸ä¸ªæä»¶\n# --out-file æ -o åæ°æå®è¾åºæä»¶\n$ npx babel example.js --out-file compiled.js\n# æè\n$ npx babel example.js -o compiled.js\n\n# æ´ä¸ªç®å½è½¬ç \n# --out-dir æ -d åæ°æå®è¾åºç®å½\n$ npx babel src --out-dir lib\n# æè\n$ npx babel src -d lib\n\n# -s åæ°çæsource mapæä»¶\n$ npx babel src -d lib -s\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n# babel-node\n\n@babel/nodeæ¨¡åçbabel-nodeå½ä»¤ï¼æä¾ä¸ä¸ªæ¯æ es6 ç repl ç¯å¢ãå®æ¯æ node ç repl ç¯å¢çææåè½ï¼èä¸å¯ä»¥ç´æ¥è¿è¡ es6 ä»£ç ã\n\né¦åï¼å®è£è¿ä¸ªæ¨¡åã\n\n$ npm install --save-dev @babel/node\n\n\n1\n\n\nç¶åï¼æ§è¡babel-nodeå°±è¿å¥ repl ç¯å¢ã\n\n$ npx babel-node\n> (x => x * 2)(1)\n2\n\n\n1\n2\n3\n\n\nbabel-nodeå½ä»¤å¯ä»¥ç´æ¥è¿è¡ es6 èæ¬ãå°ä¸é¢çä»£ç æ¾å¥èæ¬æä»¶es6.jsï¼ç¶åç´æ¥è¿è¡ã\n\n# es6.js çä»£ç \n# console.log((x => x * 2)(1));\n$ npx babel-node es6.js\n2\n\n\n1\n2\n3\n4\n\n\n\n# @babel/register æ¨¡å\n\n@babel/registeræ¨¡åæ¹årequireå½ä»¤ï¼ä¸ºå®å ä¸ä¸ä¸ªé©å­ãæ­¤åï¼æ¯å½ä½¿ç¨requireå è½½.jsã.jsxã.eså.es6åç¼åçæä»¶ï¼å°±ä¼åç¨ babel è¿è¡è½¬ç ã\n\n$ npm install --save-dev @babel/register\n\n\n1\n\n\nä½¿ç¨æ¶ï¼å¿é¡»é¦åå è½½@babel/registerã\n\n// index.js\nrequire('@babel/register');\nrequire('./es6.js');\n\n\n1\n2\n3\n\n\nç¶åï¼å°±ä¸éè¦æå¨å¯¹index.jsè½¬ç äºã\n\n$ node index.js\n2\n\n\n1\n2\n\n\néè¦æ³¨æçæ¯ï¼@babel/registeråªä¼å¯¹requireå½ä»¤å è½½çæä»¶è½¬ç ï¼èä¸ä¼å¯¹å½åæä»¶è½¬ç ãå¦å¤ï¼ç±äºå®æ¯å®æ¶è½¬ç ï¼æä»¥åªéåå¨å¼åç¯å¢ä½¿ç¨ã\n\n\n# babel api\n\nå¦ææäºä»£ç éè¦è°ç¨ babel ç api è¿è¡è½¬ç ï¼å°±è¦ä½¿ç¨@babel/coreæ¨¡åã\n\nvar babel = require('@babel/core');\n\n// å­ç¬¦ä¸²è½¬ç \nbabel.transform('code();', options);\n// => { code, map, ast }\n\n// æä»¶è½¬ç ï¼å¼æ­¥ï¼\nbabel.transformfile('filename.js', options, function(err, result) {\n  result; // => { code, map, ast }\n});\n\n// æä»¶è½¬ç ï¼åæ­¥ï¼\nbabel.transformfilesync('filename.js', options);\n// => { code, map, ast }\n\n// babel astè½¬ç \nbabel.transformfromast(ast, code, options);\n// => { code, map, ast }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\néç½®å¯¹è±¡optionsï¼å¯ä»¥åçå®æ¹ææ¡£http://babeljs.io/docs/usage/options/ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nvar es6code = 'let x = n => n + 1';\nvar es5code = require('@babel/core')\n  .transform(es6code, {\n    presets: ['@babel/env']\n  })\n  .code;\n\nconsole.log(es5code);\n// '\"use strict\";\\n\\nvar x = function x(n) {\\n  return n + 1;\\n};'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼transformæ¹æ³çç¬¬ä¸ä¸ªåæ°æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼è¡¨ç¤ºéè¦è¢«è½¬æ¢ç es6 ä»£ç ï¼ç¬¬äºä¸ªåæ°æ¯è½¬æ¢çéç½®å¯¹è±¡ã\n\n\n# @babel/polyfill\n\nbabel é»è®¤åªè½¬æ¢æ°ç javascript å¥æ³ï¼syntaxï¼ï¼èä¸è½¬æ¢æ°ç apiï¼æ¯å¦iteratorãgeneratorãsetãmapãproxyãreflectãsymbolãpromiseç­å¨å±å¯¹è±¡ï¼ä»¥åä¸äºå®ä¹å¨å¨å±å¯¹è±¡ä¸çæ¹æ³ï¼æ¯å¦object.assignï¼é½ä¸ä¼è½¬ç ã\n\nä¸¾ä¾æ¥è¯´ï¼es6 å¨arrayå¯¹è±¡ä¸æ°å¢äºarray.fromæ¹æ³ãbabel å°±ä¸ä¼è½¬ç è¿ä¸ªæ¹æ³ãå¦ææ³è®©è¿ä¸ªæ¹æ³è¿è¡ï¼å¿é¡»ä½¿ç¨babel-polyfillï¼ä¸ºå½åç¯å¢æä¾ä¸ä¸ªå«çã\n\nå®è£å½ä»¤å¦ä¸ã\n\n$ npm install --save-dev @babel/polyfill\n\n\n1\n\n\nç¶åï¼å¨èæ¬å¤´é¨ï¼å å¥å¦ä¸ä¸è¡ä»£ç ã\n\nimport '@babel/polyfill';\n// æè\nrequire('@babel/polyfill');\n\n\n1\n2\n3\n\n\nbabel é»è®¤ä¸è½¬ç ç api éå¸¸å¤ï¼è¯¦ç»æ¸åå¯ä»¥æ¥çbabel-plugin-transform-runtimeæ¨¡åçdefinitions.jsæä»¶ã\n\n\n# æµè§å¨ç¯å¢\n\nbabel ä¹å¯ä»¥ç¨äºæµè§å¨ç¯å¢ï¼ä½¿ç¨@babel/standaloneæ¨¡åæä¾çæµè§å¨çæ¬ï¼å°å¶æå¥ç½é¡µã\n\n<script src=\"https://unpkg.com/@babel/standalone/babel.min.js\"><\/script>\n<script type=\"text/babel\">\n// your es6 code\n<\/script>\n\n\n1\n2\n3\n4\n\n\næ³¨æï¼ç½é¡µå®æ¶å° es6 ä»£ç è½¬ä¸º es5ï¼å¯¹æ§è½ä¼æå½±åãçäº§ç¯å¢éè¦å è½½å·²ç»è½¬ç å®æçèæ¬ã\n\nbabel æä¾ä¸ä¸ªrepl å¨çº¿ç¼è¯å¨ï¼å¯ä»¥å¨çº¿å° es6 ä»£ç è½¬ä¸º es5 ä»£ç ãè½¬æ¢åçä»£ç ï¼å¯ä»¥ç´æ¥ä½ä¸º es5 ä»£ç æå¥ç½é¡µè¿è¡ã\n\n\n# traceur è½¬ç å¨\n\ngoogle å¬å¸çtraceurè½¬ç å¨ï¼ä¹å¯ä»¥å° es6 ä»£ç è½¬ä¸º es5 ä»£ç ã\n\n\n# ç´æ¥æå¥ç½é¡µ\n\ntraceur åè®¸å° es6 ä»£ç ç´æ¥æå¥ç½é¡µãé¦åï¼å¿é¡»å¨ç½é¡µå¤´é¨å è½½ traceur åºæä»¶ã\n\n<script src=\"https://google.github.io/traceur-compiler/bin/traceur.js\"><\/script>\n<script src=\"https://google.github.io/traceur-compiler/bin/browsersystem.js\"><\/script>\n<script src=\"https://google.github.io/traceur-compiler/src/bootstrap.js\"><\/script>\n<script type=\"module\">\n  import './greeter.js';\n<\/script>\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸å±æ 4 ä¸ªscriptæ ç­¾ãç¬¬ä¸ä¸ªæ¯å è½½ traceur çåºæä»¶ï¼ç¬¬äºä¸ªåç¬¬ä¸ä¸ªæ¯å°è¿ä¸ªåºæä»¶ç¨äºæµè§å¨ç¯å¢ï¼ç¬¬åä¸ªåæ¯å è½½ç¨æ·èæ¬ï¼è¿ä¸ªèæ¬éé¢å¯ä»¥ä½¿ç¨ es6 ä»£ç ã\n\næ³¨æï¼ç¬¬åä¸ªscriptæ ç­¾çtypeå±æ§çå¼æ¯moduleï¼èä¸æ¯text/javascriptãè¿æ¯ traceur ç¼è¯å¨è¯å« es6 ä»£ç çæ å¿ï¼ç¼è¯å¨ä¼èªå¨å°æætype=moduleçä»£ç ç¼è¯ä¸º es5ï¼ç¶ååäº¤ç»æµè§å¨æ§è¡ã\n\né¤äºå¼ç¨å¤é¨ es6 èæ¬ï¼ä¹å¯ä»¥ç´æ¥å¨ç½é¡µä¸­æ¾ç½® es6 ä»£ç ã\n\n<script type=\"module\">\n  class calc {\n    constructor() {\n      console.log('calc constructor');\n    }\n    add(a, b) {\n      return a + b;\n    }\n  }\n\n  var c = new calc();\n  console.log(c.add(4,5));\n<\/script>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\næ­£å¸¸æåµä¸ï¼ä¸é¢ä»£ç ä¼å¨æ§å¶å°æå°åº9ã\n\nå¦ææ³å¯¹ traceur çè¡ä¸ºæç²¾ç¡®æ§å¶ï¼å¯ä»¥éç¨ä¸é¢åæ°éç½®çåæ³ã\n\n<script>\n  // create the system object\n  window.system = new traceur.runtime.browsertraceurloader();\n  // set some experimental options\n  var metadata = {\n    traceuroptions: {\n      experimental: true,\n      propertailcalls: true,\n      symbols: true,\n      arraycomprehension: true,\n      asyncfunctions: true,\n      asyncgenerators: exponentiation,\n      foron: true,\n      generatorcomprehension: true\n    }\n  };\n  // load your module\n  system.import('./mymodule.js', {metadata: metadata}).catch(function(ex) {\n    console.error('import failed', ex.stack || ex);\n  });\n<\/script>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nä¸é¢ä»£ç ä¸­ï¼é¦åçæ traceur çå¨å±å¯¹è±¡window.systemï¼ç¶åsystem.importæ¹æ³å¯ä»¥ç¨æ¥å è½½ es6ãå è½½çæ¶åï¼éè¦ä¼ å¥ä¸ä¸ªéç½®å¯¹è±¡metadataï¼è¯¥å¯¹è±¡çtraceuroptionså±æ§å¯ä»¥éç½®æ¯æ es6 åè½ãå¦æè®¾ä¸ºexperimental: trueï¼å°±è¡¨ç¤ºé¤äº es6 ä»¥å¤ï¼è¿æ¯æä¸äºå®éªæ§çæ°åè½ã\n\n\n# å¨çº¿è½¬æ¢\n\ntraceur ä¹æä¾ä¸ä¸ªå¨çº¿ç¼è¯å¨ï¼å¯ä»¥å¨çº¿å° es6 ä»£ç è½¬ä¸º es5 ä»£ç ãè½¬æ¢åçä»£ç ï¼å¯ä»¥ç´æ¥ä½ä¸º es5 ä»£ç æå¥ç½é¡µè¿è¡ã\n\nä¸é¢çä¾å­è½¬ä¸º es5 ä»£ç è¿è¡ï¼å°±æ¯ä¸é¢è¿ä¸ªæ ·å­ã\n\n<script src=\"https://google.github.io/traceur-compiler/bin/traceur.js\"><\/script>\n<script src=\"https://google.github.io/traceur-compiler/bin/browsersystem.js\"><\/script>\n<script src=\"https://google.github.io/traceur-compiler/src/bootstrap.js\"><\/script>\n<script>\n$traceurruntime.modulestore.getanonymousmodule(function() {\n  \"use strict\";\n\n  var calc = function calc() {\n    console.log('calc constructor');\n  };\n\n  ($traceurruntime.createclass)(calc, {add: function(a, b) {\n    return a + b;\n  }}, {});\n\n  var c = new calc();\n  console.log(c.add(4, 5));\n  return {};\n});\n<\/script>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n\n# å½ä»¤è¡è½¬æ¢\n\nä½ä¸ºå½ä»¤è¡å·¥å·ä½¿ç¨æ¶ï¼traceur æ¯ä¸ä¸ª node çæ¨¡åï¼é¦åéè¦ç¨ npm å®è£ã\n\n$ npm install -g traceur\n\n\n1\n\n\nå®è£æååï¼å°±å¯ä»¥å¨å½ä»¤è¡ä¸ä½¿ç¨ traceur äºã\n\ntraceur ç´æ¥è¿è¡ es6 èæ¬æä»¶ï¼ä¼å¨æ åè¾åºæ¾ç¤ºè¿è¡ç»æï¼ä»¥åé¢çcalc.jsä¸ºä¾ã\n\n$ traceur calc.js\ncalc constructor\n9\n\n\n1\n2\n3\n\n\nå¦æè¦å° es6 èæ¬è½¬ä¸º es5 ä¿å­ï¼è¦éç¨ä¸é¢çåæ³ã\n\n$ traceur --script calc.es6.js --out calc.es5.js\n\n\n1\n\n\nä¸é¢ä»£ç ç--scriptéé¡¹è¡¨ç¤ºæå®è¾å¥æä»¶ï¼--outéé¡¹è¡¨ç¤ºæå®è¾åºæä»¶ã\n\nä¸ºäºé²æ­¢æäºç¹æ§ç¼è¯ä¸æåï¼æå¥½å ä¸--experimentaléé¡¹ã\n\n$ traceur --script calc.es6.js --out calc.es5.js --experimental\n\n\n1\n\n\nå½ä»¤è¡ä¸è½¬æ¢çæçæä»¶ï¼å°±å¯ä»¥ç´æ¥æ¾å°æµè§å¨ä¸­è¿è¡ã\n\n\n# node ç¯å¢çç¨æ³\n\ntraceur ç node ç¨æ³å¦ä¸ï¼åå®å·²å®è£traceuræ¨¡åï¼ã\n\nvar traceur = require('traceur');\nvar fs = require('fs');\n\n// å° es6 èæ¬è½¬ä¸ºå­ç¬¦ä¸²\nvar contents = fs.readfilesync('es6-file.js').tostring();\n\nvar result = traceur.compile(contents, {\n  filename: 'es6-file.js',\n  sourcemap: true,\n  // å¶ä»è®¾ç½®\n  modules: 'commonjs'\n});\n\nif (result.error)\n  throw result.error;\n\n// result å¯¹è±¡ç js å±æ§å°±æ¯è½¬æ¢åç es5 ä»£ç \nfs.writefilesync('out.js', result.js);\n// sourcemap å±æ§å¯¹åº map æä»¶\nfs.writefilesync('out.js.map', result.sourcemap);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"let å const å½ä»¤",frontmatter:{title:"let å const å½ä»¤",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/c1edd70a6b7c7872",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/02.let%20%E5%92%8C%20const%20%E5%91%BD%E4%BB%A4.html",relativePath:"ãES6 æç¨ãç¬è®°/02.let å const å½ä»¤.md",key:"v-399fd293",path:"/pages/c1edd70a6b7c7872/",headers:[{level:2,title:"let å½ä»¤",slug:"let-å½ä»¤",normalizedTitle:"let å½ä»¤",charIndex:21},{level:3,title:"åºæ¬ç¨æ³",slug:"åºæ¬ç¨æ³",normalizedTitle:"åºæ¬ç¨æ³",charIndex:32},{level:3,title:"ä¸å­å¨åéæå",slug:"ä¸å­å¨åéæå",normalizedTitle:"ä¸å­å¨åéæå",charIndex:1395},{level:3,title:"ææ¶æ§æ­»åº",slug:"ææ¶æ§æ­»åº",normalizedTitle:"ææ¶æ§æ­»åº",charIndex:1807},{level:3,title:"ä¸åè®¸éå¤å£°æ",slug:"ä¸åè®¸éå¤å£°æ",normalizedTitle:"ä¸åè®¸éå¤å£°æ",charIndex:3512},{level:2,title:"åçº§ä½ç¨å",slug:"åçº§ä½ç¨å",normalizedTitle:"åçº§ä½ç¨å",charIndex:95},{level:3,title:"ä¸ºä»ä¹éè¦åçº§ä½ç¨åï¼",slug:"ä¸ºä»ä¹éè¦åçº§ä½ç¨å",normalizedTitle:"ä¸ºä»ä¹éè¦åçº§ä½ç¨åï¼",charIndex:3848},{level:3,title:"ES6 çåçº§ä½ç¨å",slug:"es6-çåçº§ä½ç¨å",normalizedTitle:"es6 çåçº§ä½ç¨å",charIndex:4363},{level:3,title:"åçº§ä½ç¨åä¸å½æ°å£°æ",slug:"åçº§ä½ç¨åä¸å½æ°å£°æ",normalizedTitle:"åçº§ä½ç¨åä¸å½æ°å£°æ",charIndex:5026},{level:2,title:"const å½ä»¤",slug:"const-å½ä»¤",normalizedTitle:"const å½ä»¤",charIndex:8},{level:3,title:"åºæ¬ç¨æ³",slug:"åºæ¬ç¨æ³-2",normalizedTitle:"åºæ¬ç¨æ³",charIndex:32},{level:3,title:"æ¬è´¨",slug:"æ¬è´¨",normalizedTitle:"æ¬è´¨",charIndex:3441},{level:3,title:"ES6 å£°æåéçå­ç§æ¹æ³",slug:"es6-å£°æåéçå­ç§æ¹æ³",normalizedTitle:"es6 å£°æåéçå­ç§æ¹æ³",charIndex:9231},{level:2,title:"é¡¶å±å¯¹è±¡çå±æ§",slug:"é¡¶å±å¯¹è±¡çå±æ§",normalizedTitle:"é¡¶å±å¯¹è±¡çå±æ§",charIndex:9364},{level:2,title:"globalThis å¯¹è±¡",slug:"globalthis-å¯¹è±¡",normalizedTitle:"globalthis å¯¹è±¡",charIndex:10123}],excerpt:'<h1 id="let-å-const-å½ä»¤"><a class="header-anchor" href="#let-å-const-å½ä»¤">#</a> let å const å½ä»¤</h1>\n<h2 id="let-å½ä»¤"><a class="header-anchor" href="#let-å½ä»¤">#</a> let å½ä»¤</h2>\n<h3 id="åºæ¬ç¨æ³"><a class="header-anchor" href="#åºæ¬ç¨æ³">#</a> åºæ¬ç¨æ³</h3>\n<p>ES6 æ°å¢äº<code>let</code>å½ä»¤ï¼ç¨æ¥å£°æåéãå®çç¨æ³ç±»ä¼¼äº<code>var</code>ï¼ä½æ¯æå£°æçåéï¼<strong>åªå¨<code>let</code>å½ä»¤æå¨çä»£ç ååææ(åçº§ä½ç¨å)</strong>ã</p>\n\x3c!--beforebegin--\x3e<div class="language-javascript line-numbers-mode">\x3c!--afterbegin--\x3e<pre v-pre class="language-javascript"><code><span class="token punctuation">{</span>\n  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>\n  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\na <span class="token comment">// ReferenceError: a is not defined.</span>\nb <span class="token comment">// 1</span>\n</code></pre>\n<div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div>\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e',headersStr:"let å½ä»¤ åºæ¬ç¨æ³ ä¸å­å¨åéæå ææ¶æ§æ­»åº ä¸åè®¸éå¤å£°æ åçº§ä½ç¨å ä¸ºä»ä¹éè¦åçº§ä½ç¨åï¼ ES6 çåçº§ä½ç¨å åçº§ä½ç¨åä¸å½æ°å£°æ const å½ä»¤ åºæ¬ç¨æ³ æ¬è´¨ ES6 å£°æåéçå­ç§æ¹æ³ é¡¶å±å¯¹è±¡çå±æ§ globalThis å¯¹è±¡",content:"# let å const å½ä»¤\n\n\n# let å½ä»¤\n\n\n# åºæ¬ç¨æ³\n\nES6 æ°å¢äºletå½ä»¤ï¼ç¨æ¥å£°æåéãå®çç¨æ³ç±»ä¼¼äºvarï¼ä½æ¯æå£°æçåéï¼åªå¨letå½ä»¤æå¨çä»£ç ååææ(åçº§ä½ç¨å)ã\n\n{\n  let a = 10;\n  var b = 1;\n}\n\na // ReferenceError: a is not defined.\nb // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç å¨ä»£ç åä¹ä¸­ï¼åå«ç¨letåvarå£°æäºä¸¤ä¸ªåéãç¶åå¨ä»£ç åä¹å¤è°ç¨è¿ä¸¤ä¸ªåéï¼ç»æletå£°æçåéæ¥éï¼varå£°æçåéè¿åäºæ­£ç¡®çå¼ãè¿è¡¨æï¼letå£°æçåéåªå¨å®æå¨çä»£ç åææã\n\nforå¾ªç¯çè®¡æ°å¨ï¼å°±å¾åéä½¿ç¨letå½ä»¤ã\n\nfor (let i = 0; i < 10; i++) {\n  // ...\n}\n\nconsole.log(i);\n// ReferenceError: i is not defined\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼è®¡æ°å¨iåªå¨forå¾ªç¯ä½åææï¼å¨å¾ªç¯ä½å¤å¼ç¨å°±ä¼æ¥éã\n\n> å¦æforå¾ªç¯åç¨varå£°æiï¼åä¼æå°10\n\nä¸é¢çä»£ç å¦æä½¿ç¨varï¼æåè¾åºçæ¯10ã\n\nvar a = [];\nfor (var i = 0; i < 10; i++) {\n  a[i] = function () { // å¾ªç¯æ¶åªæ¯å°å½æ°èµå¼ç»a[i],å¹¶æªæ§è¡å½æ°ãå½æ°åçiæ¯å¨å±çi\n    console.log(i);\n  };\n}\na[6](); // 10\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åéiæ¯varå½ä»¤å£°æçï¼å¨å¨å±èå´åé½ææï¼æä»¥å¨å±åªæä¸ä¸ªåéiãæ¯ä¸æ¬¡å¾ªç¯ï¼åéiçå¼é½ä¼åçæ¹åï¼èå¾ªç¯åè¢«èµç»æ°ç»açå½æ°åé¨çconsole.log(i)ï¼éé¢çiæåçå°±æ¯å¨å±çiãä¹å°±æ¯è¯´ï¼æææ°ç»açæåéé¢çiï¼æåçé½æ¯åä¸ä¸ªiï¼å¯¼è´è¿è¡æ¶è¾åºçæ¯æåä¸è½®çiçå¼ï¼ä¹å°±æ¯ 10ã\n\nå¦æä½¿ç¨letï¼å£°æçåéä»å¨åçº§ä½ç¨ååææï¼æåè¾åºçæ¯ 6ã\n\nvar a = [];\nfor (let i = 0; i < 10; i++) {\n  a[i] = function () {\n    console.log(i);\n  };\n}\na[6](); // 6\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åéiæ¯letå£°æçï¼å½åçiåªå¨æ¬è½®å¾ªç¯ææï¼æä»¥æ¯ä¸æ¬¡å¾ªç¯çiå¶å®é½æ¯ä¸ä¸ªæ°çåéï¼æä»¥æåè¾åºçæ¯6ãä½ å¯è½ä¼é®ï¼å¦ææ¯ä¸è½®å¾ªç¯çåéié½æ¯éæ°å£°æçï¼é£å®æä¹ç¥éä¸ä¸è½®å¾ªç¯çå¼ï¼ä»èè®¡ç®åºæ¬è½®å¾ªç¯çå¼ï¼è¿æ¯å ä¸º JavaScript å¼æåé¨ä¼è®°ä½ä¸ä¸è½®å¾ªç¯çå¼ï¼åå§åæ¬è½®çåéiæ¶ï¼å°±å¨ä¸ä¸è½®å¾ªç¯çåºç¡ä¸è¿è¡è®¡ç®ã\n\nå¦å¤ï¼forå¾ªç¯è¿æä¸ä¸ªç¹å«ä¹å¤ï¼å°±æ¯è®¾ç½®å¾ªç¯åéçé£é¨åæ¯ä¸ä¸ªç¶ä½ç¨åï¼èå¾ªç¯ä½åé¨æ¯ä¸ä¸ªåç¬çå­ä½ç¨åã\n\nfor (let i = 0; i < 3; i++) {\n  let i = 'abc';\n  console.log(i);\n}\n// abc\n// abc\n// abc\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç æ­£ç¡®è¿è¡ï¼è¾åºäº 3 æ¬¡abcãè¿è¡¨æå½æ°åé¨çåéiä¸å¾ªç¯åéiä¸å¨åä¸ä¸ªä½ç¨åï¼æåèªåç¬çä½ç¨åã\n\n\n# ä¸å­å¨åéæå\n\nvarå½ä»¤ä¼åçâåéæåâç°è±¡ï¼å³åéå¯ä»¥å¨å£°æä¹åä½¿ç¨ï¼å¼ä¸ºundefinedãè¿ç§ç°è±¡å¤å¤å°å°æ¯æäºå¥æªçï¼æç§ä¸è¬çé»è¾ï¼åéåºè¯¥å¨å£°æè¯­å¥ä¹åæå¯ä»¥ä½¿ç¨ã\n\nä¸ºäºçº æ­£è¿ç§ç°è±¡ï¼letå½ä»¤æ¹åäºè¯­æ³è¡ä¸ºï¼å®æå£°æçåéä¸å®è¦å¨å£°æåä½¿ç¨ï¼å¦åæ¥éã\n\n// var çæåµ\nconsole.log(foo); // è¾åºundefined\nvar foo = 2;\n\n// let çæåµ\nconsole.log(bar); // æ¥éReferenceError\nlet bar = 2;\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åéfooç¨varå½ä»¤å£°æï¼ä¼åçåéæåï¼å³èæ¬å¼å§è¿è¡æ¶ï¼åéfooå·²ç»å­å¨äºï¼ä½æ¯æ²¡æå¼ï¼æä»¥ä¼è¾åºundefinedãåébarç¨letå½ä»¤å£°æï¼ä¸ä¼åçåéæåãè¿è¡¨ç¤ºå¨å£°æå®ä¹åï¼åébaræ¯ä¸å­å¨çï¼è¿æ¶å¦æç¨å°å®ï¼å°±ä¼æåºä¸ä¸ªéè¯¯ã\n\n\n# ææ¶æ§æ­»åº\n\nåªè¦åçº§ä½ç¨ååå­å¨letå½ä»¤ï¼å®æå£°æçåéå°±âç»å®âï¼bindingï¼è¿ä¸ªåºåï¼ä¸ååå¤é¨çå½±åã\n\nvar tmp = 123;\n\nif (true) {\n  tmp = 'abc'; // ReferenceError\n  let tmp;\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å­å¨å¨å±åétmpï¼ä½æ¯åçº§ä½ç¨ååletåå£°æäºä¸ä¸ªå±é¨åétmpï¼å¯¼è´åèç»å®è¿ä¸ªåçº§ä½ç¨åï¼æä»¥å¨letå£°æåéåï¼å¯¹tmpèµå¼ä¼æ¥éã\n\nES6 æç¡®è§å®ï¼å¦æåºåä¸­å­å¨letåconstå½ä»¤ï¼è¿ä¸ªåºåå¯¹è¿äºå½ä»¤å£°æçåéï¼ä»ä¸å¼å§å°±å½¢æäºå°é­ä½ç¨åãå¡æ¯å¨å£°æä¹åå°±ä½¿ç¨è¿äºåéï¼å°±ä¼æ¥éã\n\næ»ä¹ï¼å¨ä»£ç ååï¼**ä½¿ç¨letå½ä»¤å£°æåéä¹åï¼è¯¥åéé½æ¯ä¸å¯ç¨çãè¿å¨è¯­æ³ä¸ï¼ç§°ä¸ºâææ¶æ§æ­»åºâï¼**temporal dead zoneï¼ç®ç§° TDZï¼ã\n\nif (true) {\n  // TDZå¼å§\n  tmp = 'abc'; // ReferenceError\n  console.log(tmp); // ReferenceError\n\n  let tmp; // TDZç»æ\n  console.log(tmp); // undefined\n\n  tmp = 123;\n  console.log(tmp); // 123\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼å¨letå½ä»¤å£°æåétmpä¹åï¼é½å±äºåétmpçâæ­»åºâã\n\nâææ¶æ§æ­»åºâä¹æå³çtypeofä¸åæ¯ä¸ä¸ªç¾åä¹ç¾å®å¨çæä½ã\n\ntypeof x; // ReferenceError\nlet x;\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼åéxä½¿ç¨letå½ä»¤å£°æï¼æä»¥å¨å£°æä¹åï¼é½å±äºxçâæ­»åºâï¼åªè¦ç¨å°è¯¥åéå°±ä¼æ¥éãå æ­¤ï¼typeofè¿è¡æ¶å°±ä¼æåºä¸ä¸ªReferenceErrorã\n\nä½ä¸ºæ¯è¾ï¼å¦æä¸ä¸ªåéæ ¹æ¬æ²¡æè¢«å£°æï¼ä½¿ç¨typeofåèä¸ä¼æ¥éã\n\ntypeof undeclared_variable // \"undefined\"\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼undeclared_variableæ¯ä¸ä¸ªä¸å­å¨çåéåï¼ç»æè¿åâundefinedâãæä»¥ï¼å¨æ²¡æletä¹åï¼typeofè¿ç®ç¬¦æ¯ç¾åä¹ç¾å®å¨çï¼æ°¸è¿ä¸ä¼æ¥éãç°å¨è¿ä¸ç¹ä¸æç«äºãè¿æ ·çè®¾è®¡æ¯ä¸ºäºè®©å¤§å®¶å»æè¯å¥½çç¼ç¨ä¹ æ¯ï¼åéä¸å®è¦å¨å£°æä¹åä½¿ç¨ï¼å¦åå°±æ¥éã\n\næäºâæ­»åºâæ¯è¾éè½ï¼ä¸å¤ªå®¹æåç°ã\n\nfunction bar(x = y, y = 2) {\n  return [x, y];\n}\n\nbar(); // æ¥é\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼è°ç¨barå½æ°ä¹æä»¥æ¥éï¼æäºå®ç°å¯è½ä¸æ¥éï¼ï¼æ¯å ä¸ºåæ°xé»è®¤å¼ç­äºå¦ä¸ä¸ªåæ°yï¼èæ­¤æ¶yè¿æ²¡æå£°æï¼å±äºâæ­»åºâãå¦æyçé»è®¤å¼æ¯xï¼å°±ä¸ä¼æ¥éï¼å ä¸ºæ­¤æ¶xå·²ç»å£°æäºã\n\nfunction bar(x = 2, y = x) {\n  return [x, y];\n}\nbar(); // [2, 2]\n\n\n1\n2\n3\n4\n\n\nå¦å¤ï¼ä¸é¢çä»£ç ä¹ä¼æ¥éï¼ä¸varçè¡ä¸ºä¸åã\n\n// ä¸æ¥é\nvar x = x;\n\n// æ¥é\nlet x = x;\n// ReferenceError: x is not defined\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç æ¥éï¼ä¹æ¯å ä¸ºææ¶æ§æ­»åºãä½¿ç¨letå£°æåéæ¶ï¼åªè¦åéå¨è¿æ²¡æå£°æå®æåä½¿ç¨ï¼å°±ä¼æ¥éãä¸é¢è¿è¡å°±å±äºè¿ä¸ªæåµï¼å¨åéxçå£°æè¯­å¥è¿æ²¡ææ§è¡å®æåï¼å°±å»åxçå¼ï¼å¯¼è´æ¥éâx æªå®ä¹âã\n\nES6 è§å®ææ¶æ§æ­»åºåletãconstè¯­å¥ä¸åºç°åéæåï¼ä¸»è¦æ¯ä¸ºäºåå°è¿è¡æ¶éè¯¯ï¼é²æ­¢å¨åéå£°æåå°±ä½¿ç¨è¿ä¸ªåéï¼ä»èå¯¼è´ææä¹å¤çè¡ä¸ºãè¿æ ·çéè¯¯å¨ ES5 æ¯å¾å¸¸è§çï¼ç°å¨æäºè¿ç§è§å®ï¼é¿åæ­¤ç±»éè¯¯å°±å¾å®¹æäºã\n\næ»ä¹ï¼ææ¶æ§æ­»åºçæ¬è´¨å°±æ¯ï¼åªè¦ä¸è¿å¥å½åä½ç¨åï¼æè¦ä½¿ç¨çåéå°±å·²ç»å­å¨äºï¼ä½æ¯ä¸å¯è·åï¼åªæç­å°å£°æåéçé£ä¸è¡ä»£ç åºç°ï¼æå¯ä»¥è·ååä½¿ç¨è¯¥åéã\n\n\n# ä¸åè®¸éå¤å£°æ\n\nletä¸åè®¸å¨ç¸åä½ç¨ååï¼éå¤å£°æåä¸ä¸ªåéã\n\n// æ¥é\nfunction func() {\n  let a = 10;\n  var a = 1;\n}\n\n// æ¥é\nfunction func() {\n  let a = 10;\n  let a = 1;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå æ­¤ï¼ä¸è½å¨å½æ°åé¨éæ°å£°æåæ°ã\n\nfunction func(arg) {\n  let arg;\n}\nfunc() // æ¥é\n\nfunction func(arg) {\n  {\n    let arg;\n  }\n}\nfunc() // ä¸æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# åçº§ä½ç¨å\n\n\n# ä¸ºä»ä¹éè¦åçº§ä½ç¨åï¼\n\nES5 åªæå¨å±ä½ç¨ååå½æ°ä½ç¨åï¼æ²¡æåçº§ä½ç¨åï¼è¿å¸¦æ¥å¾å¤ä¸åççåºæ¯ã\n\nç¬¬ä¸ç§åºæ¯ï¼åå±åéå¯è½ä¼è¦çå¤å±åéã\n\nvar tmp = new Date();\n\nfunction f() {\n  console.log(tmp);\n  if (false) {\n    var tmp = 'hello world';\n  }\n}\n\nf(); // undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç çåææ¯ï¼ifä»£ç åçå¤é¨ä½¿ç¨å¤å±çtmpåéï¼åé¨ä½¿ç¨åå±çtmpåéãä½æ¯ï¼å½æ°fæ§è¡åï¼è¾åºç»æä¸ºundefinedï¼åå å¨äºåéæåï¼å¯¼è´åå±çtmpåéè¦çäºå¤å±çtmpåéã\n\nç¬¬äºç§åºæ¯ï¼ç¨æ¥è®¡æ°çå¾ªç¯åéæ³é²ä¸ºå¨å±åéã\n\nvar s = 'hello';\n\nfor (var i = 0; i < s.length; i++) {\n  console.log(s[i]);\n}\n\nconsole.log(i); // 5\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åéiåªç¨æ¥æ§å¶å¾ªç¯ï¼ä½æ¯å¾ªç¯ç»æåï¼å®å¹¶æ²¡ææ¶å¤±ï¼æ³é²æäºå¨å±åéã\n\n\n# ES6 çåçº§ä½ç¨å\n\nletå®éä¸ä¸º JavaScript æ°å¢äºåçº§ä½ç¨åã\n\nfunction f1() {\n  let n = 5;\n  if (true) {\n    let n = 10;\n  }\n  console.log(n); // 5\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢çå½æ°æä¸¤ä¸ªä»£ç åï¼é½å£°æäºåénï¼è¿è¡åè¾åº 5ãè¿è¡¨ç¤ºå¤å±ä»£ç åä¸ååå±ä»£ç åçå½±åãå¦æä¸¤æ¬¡é½ä½¿ç¨varå®ä¹åénï¼æåè¾åºçå¼ææ¯ 10ã\n\nES6 åè®¸åçº§ä½ç¨åçä»»æåµå¥ã\n\n{{{{\n  {let insane = 'Hello World'}\n  console.log(insane); // æ¥é\n}}}};\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä½¿ç¨äºä¸ä¸ªäºå±çåçº§ä½ç¨åï¼æ¯ä¸å±é½æ¯ä¸ä¸ªåç¬çä½ç¨åãç¬¬åå±ä½ç¨åæ æ³è¯»åç¬¬äºå±ä½ç¨åçåé¨åéã\n\nåå±ä½ç¨åå¯ä»¥å®ä¹å¤å±ä½ç¨åçåååéã\n\n{{{{\n  let insane = 'Hello World';\n  {let insane = 'Hello World'}\n}}}};\n\n\n1\n2\n3\n4\n\n\nåçº§ä½ç¨åçåºç°ï¼å®éä¸ä½¿å¾è·å¾å¹¿æ³åºç¨çå¿åç«å³æ§è¡å½æ°è¡¨è¾¾å¼ï¼å¿å IIFEï¼ä¸åå¿è¦äºã\n\n// IIFE åæ³\n(function () {\n  var tmp = ...;\n  ...\n}());\n\n// åçº§ä½ç¨ååæ³\n{\n  let tmp = ...;\n  ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# åçº§ä½ç¨åä¸å½æ°å£°æ\n\nå½æ°è½ä¸è½å¨åçº§ä½ç¨åä¹ä¸­å£°æï¼è¿æ¯ä¸ä¸ªç¸å½ä»¤äººæ··æ·çé®é¢ã\n\nES5 è§å®ï¼å½æ°åªè½å¨é¡¶å±ä½ç¨ååå½æ°ä½ç¨åä¹ä¸­å£°æï¼ä¸è½å¨åçº§ä½ç¨åå£°æã\n\n// æåµä¸\nif (true) {\n  function f() {}\n}\n\n// æåµäº\ntry {\n  function f() {}\n} catch(e) {\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä¸¤ç§å½æ°å£°æï¼æ ¹æ® ES5 çè§å®é½æ¯éæ³çã\n\nä½æ¯ï¼æµè§å¨æ²¡æéµå®è¿ä¸ªè§å®ï¼ä¸ºäºå¼å®¹ä»¥åçæ§ä»£ç ï¼è¿æ¯æ¯æå¨åçº§ä½ç¨åä¹ä¸­å£°æå½æ°ï¼å æ­¤ä¸é¢ä¸¤ç§æåµå®éé½è½è¿è¡ï¼ä¸ä¼æ¥éã\n\nES6 å¼å¥äºåçº§ä½ç¨åï¼æç¡®åè®¸å¨åçº§ä½ç¨åä¹ä¸­å£°æå½æ°ãES6 è§å®ï¼åçº§ä½ç¨åä¹ä¸­ï¼å½æ°å£°æè¯­å¥çè¡ä¸ºç±»ä¼¼äºletï¼å¨åçº§ä½ç¨åä¹å¤ä¸å¯å¼ç¨ã\n\nfunction f() { console.log('I am outside!'); }\n\n(function () {\n  if (false) {\n    // éå¤å£°æä¸æ¬¡å½æ°f\n    function f() { console.log('I am inside!'); }\n  }\n\n  f();\n}());\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å¨ ES5 ä¸­è¿è¡ï¼ä¼å¾å°âI am inside!âï¼å ä¸ºå¨ifåå£°æçå½æ°fä¼è¢«æåå°å½æ°å¤´é¨ï¼å®éè¿è¡çä»£ç å¦ä¸ã\n\n// ES5 ç¯å¢\nfunction f() { console.log('I am outside!'); }\n\n(function () {\n  function f() { console.log('I am inside!'); }\n  if (false) {\n  }\n  f();\n}());\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nES6 å°±å®å¨ä¸ä¸æ ·äºï¼çè®ºä¸ä¼å¾å°âI am outside!âãå ä¸ºåçº§ä½ç¨ååå£°æçå½æ°ç±»ä¼¼äºletï¼å¯¹ä½ç¨åä¹å¤æ²¡æå½±åãä½æ¯ï¼å¦æä½ ççå¨ ES6 æµè§å¨ä¸­è¿è¡ä¸ä¸ä¸é¢çä»£ç ï¼æ¯ä¼æ¥éçï¼è¿æ¯ä¸ºä»ä¹å¢ï¼\n\n// æµè§å¨ç ES6 ç¯å¢\nfunction f() { console.log('I am outside!'); }\n\n(function () {\n  if (false) {\n    // éå¤å£°æä¸æ¬¡å½æ°f\n    function f() { console.log('I am inside!'); }\n  }\n\n  f();\n}());\n// Uncaught TypeError: f is not a function\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢çä»£ç å¨ ES6 æµè§å¨ä¸­ï¼é½ä¼æ¥éã\n\nåæ¥ï¼å¦ææ¹åäºåçº§ä½ç¨ååå£°æçå½æ°çå¤çè§åï¼æ¾ç¶ä¼å¯¹èä»£ç äº§çå¾å¤§å½±åãä¸ºäºåè½»å æ­¤äº§ççä¸å¼å®¹é®é¢ï¼ES6 å¨éå½ Béé¢è§å®ï¼æµè§å¨çå®ç°å¯ä»¥ä¸éµå®ä¸é¢çè§å®ï¼æèªå·±çè¡ä¸ºæ¹å¼ã\n\n * åè®¸å¨åçº§ä½ç¨ååå£°æå½æ°ã\n * å½æ°å£°æç±»ä¼¼äºvarï¼å³ä¼æåå°å¨å±ä½ç¨åæå½æ°ä½ç¨åçå¤´é¨ã\n * åæ¶ï¼å½æ°å£°æè¿ä¼æåå°æå¨çåçº§ä½ç¨åçå¤´é¨ã\n\næ³¨æï¼ä¸é¢ä¸æ¡è§ååªå¯¹ ES6 çæµè§å¨å®ç°ææï¼å¶ä»ç¯å¢çå®ç°ä¸ç¨éµå®ï¼è¿æ¯å°åçº§ä½ç¨åçå½æ°å£°æå½ä½letå¤çã\n\næ ¹æ®è¿ä¸æ¡è§åï¼æµè§å¨ç ES6 ç¯å¢ä¸­ï¼åçº§ä½ç¨ååå£°æçå½æ°ï¼è¡ä¸ºç±»ä¼¼äºvarå£°æçåéãä¸é¢çä¾å­å®éè¿è¡çä»£ç å¦ä¸ã\n\n// æµè§å¨ç ES6 ç¯å¢\nfunction f() { console.log('I am outside!'); }\n(function () {\n  var f = undefined;\n  if (false) {\n    function f() { console.log('I am inside!'); }\n  }\n\n  f();\n}());\n// Uncaught TypeError: f is not a function\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nèèå°ç¯å¢å¯¼è´çè¡ä¸ºå·®å¼å¤ªå¤§ï¼åºè¯¥é¿åå¨åçº§ä½ç¨ååå£°æå½æ°ãå¦æç¡®å®éè¦ï¼ä¹åºè¯¥åæå½æ°è¡¨è¾¾å¼ï¼èä¸æ¯å½æ°å£°æè¯­å¥ã\n\n// åçº§ä½ç¨ååé¨çå½æ°å£°æè¯­å¥ï¼å»ºè®®ä¸è¦ä½¿ç¨\n{\n  let a = 'secret';\n  function f() {\n    return a;\n  }\n}\n\n// åçº§ä½ç¨ååé¨ï¼ä¼åä½¿ç¨å½æ°è¡¨è¾¾å¼\n{\n  let a = 'secret';\n  let f = function () {\n    return a;\n  };\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå¦å¤ï¼è¿æä¸ä¸ªéè¦æ³¨æçå°æ¹ãES6 çåçº§ä½ç¨åå¿é¡»æå¤§æ¬å·ï¼å¦ææ²¡æå¤§æ¬å·ï¼JavaScript å¼æå°±è®¤ä¸ºä¸å­å¨åçº§ä½ç¨åã\n\n// ç¬¬ä¸ç§åæ³ï¼æ¥é\nif (true) let x = 1;\n\n// ç¬¬äºç§åæ³ï¼ä¸æ¥é\nif (true) {\n  let x = 1;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬ä¸ç§åæ³æ²¡æå¤§æ¬å·ï¼æä»¥ä¸å­å¨åçº§ä½ç¨åï¼èletåªè½åºç°å¨å½åä½ç¨åçé¡¶å±ï¼æä»¥æ¥éãç¬¬äºç§åæ³æå¤§æ¬å·ï¼æä»¥åçº§ä½ç¨åæç«ã\n\nå½æ°å£°æä¹æ¯å¦æ­¤ï¼ä¸¥æ ¼æ¨¡å¼ä¸ï¼å½æ°åªè½å£°æå¨å½åä½ç¨åçé¡¶å±ã\n\n// ä¸æ¥é\n'use strict';\nif (true) {\n  function f() {}\n}\n\n// æ¥é\n'use strict';\nif (true)\n  function f() {}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# const å½ä»¤\n\n\n# åºæ¬ç¨æ³\n\nconstå£°æä¸ä¸ªåªè¯»çå¸¸éãä¸æ¦å£°æï¼å¸¸éçå¼å°±ä¸è½æ¹åã\n\nconst PI = 3.1415;\nPI // 3.1415\n\nPI = 3;\n// TypeError: Assignment to constant variable.\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç è¡¨ææ¹åå¸¸éçå¼ä¼æ¥éã\n\nconstå£°æçåéä¸å¾æ¹åå¼ï¼è¿æå³çï¼constä¸æ¦å£°æåéï¼å°±å¿é¡»ç«å³åå§åï¼ä¸è½çå°ä»¥åèµå¼ã\n\nconst foo;\n// SyntaxError: Missing initializer in const declaration\n\n\n1\n2\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼å¯¹äºconstæ¥è¯´ï¼åªå£°æä¸èµå¼ï¼å°±ä¼æ¥éã\n\nconstçä½ç¨åä¸letå½ä»¤ç¸åï¼åªå¨å£°ææå¨çåçº§ä½ç¨ååææã\n\nif (true) {\n  const MAX = 5;\n}\n\nMAX // Uncaught ReferenceError: MAX is not defined\n\n\n1\n2\n3\n4\n5\n\n\nconstå½ä»¤å£°æçå¸¸éä¹æ¯ä¸æåï¼åæ ·å­å¨ææ¶æ§æ­»åºï¼åªè½å¨å£°æçä½ç½®åé¢ä½¿ç¨ã\n\nif (true) {\n  console.log(MAX); // ReferenceError\n  const MAX = 5;\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç å¨å¸¸éMAXå£°æä¹åå°±è°ç¨ï¼ç»ææ¥éã\n\nconstå£°æçå¸¸éï¼ä¹ä¸letä¸æ ·ä¸å¯éå¤å£°æã\n\nvar message = \"Hello!\";\nlet age = 25;\n\n// ä»¥ä¸ä¸¤è¡é½ä¼æ¥é\nconst message = \"Goodbye!\";\nconst age = 30;\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# æ¬è´¨\n\nconstå®éä¸ä¿è¯çï¼å¹¶ä¸æ¯åéçå¼ä¸å¾æ¹å¨ï¼èæ¯åéæåçé£ä¸ªåå­å°åæä¿å­çæ°æ®ä¸å¾æ¹å¨ãå¯¹äºç®åç±»åçæ°æ®ï¼æ°å¼ãå­ç¬¦ä¸²ãå¸å°å¼ï¼ï¼å¼å°±ä¿å­å¨åéæåçé£ä¸ªåå­å°åï¼å æ­¤ç­åäºå¸¸éãä½å¯¹äºå¤åç±»åçæ°æ®ï¼ä¸»è¦æ¯å¯¹è±¡åæ°ç»ï¼ï¼åéæåçåå­å°åï¼ä¿å­çåªæ¯ä¸ä¸ªæåå®éæ°æ®çæéï¼conståªè½ä¿è¯è¿ä¸ªæéæ¯åºå®çï¼å³æ»æ¯æåå¦ä¸ä¸ªåºå®çå°åï¼ï¼è³äºå®æåçæ°æ®ç»ææ¯ä¸æ¯å¯åçï¼å°±å®å¨ä¸è½æ§å¶äºãå æ­¤ï¼å°ä¸ä¸ªå¯¹è±¡å£°æä¸ºå¸¸éå¿é¡»éå¸¸å°å¿ã\n\nconst foo = {};\n\n// ä¸º foo æ·»å ä¸ä¸ªå±æ§ï¼å¯ä»¥æå\nfoo.prop = 123;\nfoo.prop // 123\n\n// å° foo æåå¦ä¸ä¸ªå¯¹è±¡ï¼å°±ä¼æ¥é\nfoo = {}; // TypeError: \"foo\" is read-only\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼å¸¸éfooå¨å­çæ¯ä¸ä¸ªå°åï¼è¿ä¸ªå°åæåä¸ä¸ªå¯¹è±¡ãä¸å¯åçåªæ¯è¿ä¸ªå°åï¼å³ä¸è½æfooæåå¦ä¸ä¸ªå°åï¼ä½å¯¹è±¡æ¬èº«æ¯å¯åçï¼æä»¥ä¾ç¶å¯ä»¥ä¸ºå¶æ·»å æ°å±æ§ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nconst a = [];\na.push('Hello'); // å¯æ§è¡\na.length = 0;    // å¯æ§è¡\na = ['Dave'];    // æ¥é\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼å¸¸éaæ¯ä¸ä¸ªæ°ç»ï¼è¿ä¸ªæ°ç»æ¬èº«æ¯å¯åçï¼ä½æ¯å¦æå°å¦ä¸ä¸ªæ°ç»èµå¼ç»aï¼å°±ä¼æ¥éã\n\nå¦æççæ³å°å¯¹è±¡å»ç»ï¼åºè¯¥ä½¿ç¨Object.freezeæ¹æ³ã\n\nconst foo = Object.freeze({});\n\n// å¸¸è§æ¨¡å¼æ¶ï¼ä¸é¢ä¸è¡ä¸èµ·ä½ç¨ï¼\n// ä¸¥æ ¼æ¨¡å¼æ¶ï¼è¯¥è¡ä¼æ¥é\nfoo.prop = 123;\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å¸¸éfooæåä¸ä¸ªå»ç»çå¯¹è±¡ï¼æä»¥æ·»å æ°å±æ§ä¸èµ·ä½ç¨ï¼ä¸¥æ ¼æ¨¡å¼æ¶è¿ä¼æ¥éã\n\né¤äºå°å¯¹è±¡æ¬èº«å»ç»ï¼å¯¹è±¡çå±æ§ä¹åºè¯¥å»ç»ãä¸é¢æ¯ä¸ä¸ªå°å¯¹è±¡å½»åºå»ç»çå½æ°ã\n\nvar constantize = (obj) => {\n  Object.freeze(obj);\n  Object.keys(obj).forEach( (key, i) => {\n    if ( typeof obj[key] === 'object' ) {\n      constantize( obj[key] );\n    }\n  });\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# ES6 å£°æåéçå­ç§æ¹æ³\n\nES5 åªæä¸¤ç§å£°æåéçæ¹æ³ï¼varå½ä»¤åfunctionå½ä»¤ãES6 é¤äºæ·»å letåconstå½ä»¤ï¼åé¢ç« èè¿ä¼æå°ï¼å¦å¤ä¸¤ç§å£°æåéçæ¹æ³ï¼importå½ä»¤åclasså½ä»¤ãæä»¥ï¼ES6 ä¸å±æ 6 ç§å£°æåéçæ¹æ³ã\n\n\n# é¡¶å±å¯¹è±¡çå±æ§\n\né¡¶å±å¯¹è±¡ï¼å¨æµè§å¨ç¯å¢æçæ¯windowå¯¹è±¡ï¼å¨ Node æçæ¯globalå¯¹è±¡ãES5 ä¹ä¸­ï¼é¡¶å±å¯¹è±¡çå±æ§ä¸å¨å±åéæ¯ç­ä»·çã\n\nwindow.a = 1;\na // 1\n\na = 2;\nwindow.a // 2\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼é¡¶å±å¯¹è±¡çå±æ§èµå¼ä¸å¨å±åéçèµå¼ï¼æ¯åä¸ä»¶äºã\n\né¡¶å±å¯¹è±¡çå±æ§ä¸å¨å±åéæé©ï¼è¢«è®¤ä¸ºæ¯ JavaScript è¯­è¨æå¤§çè®¾è®¡è´¥ç¬ä¹ä¸ãè¿æ ·çè®¾è®¡å¸¦æ¥äºå ä¸ªå¾å¤§çé®é¢ï¼é¦åæ¯æ²¡æ³å¨ç¼è¯æ¶å°±æ¥åºåéæªå£°æçéè¯¯ï¼åªæè¿è¡æ¶æè½ç¥éï¼å ä¸ºå¨å±åéå¯è½æ¯é¡¶å±å¯¹è±¡çå±æ§åé çï¼èå±æ§çåé æ¯å¨æçï¼ï¼å¶æ¬¡ï¼ç¨åºåå¾å®¹æä¸ç¥ä¸è§å°å°±åå»ºäºå¨å±åéï¼æ¯å¦æå­åºéï¼ï¼æåï¼é¡¶å±å¯¹è±¡çå±æ§æ¯å°å¤å¯ä»¥è¯»åçï¼è¿éå¸¸ä¸å©äºæ¨¡ååç¼ç¨ãå¦ä¸æ¹é¢ï¼windowå¯¹è±¡æå®ä½å«ä¹ï¼æçæ¯æµè§å¨ççªå£å¯¹è±¡ï¼é¡¶å±å¯¹è±¡æ¯ä¸ä¸ªæå®ä½å«ä¹çå¯¹è±¡ï¼ä¹æ¯ä¸åéçã\n\nES6 ä¸ºäºæ¹åè¿ä¸ç¹ï¼ä¸æ¹é¢è§å®ï¼ä¸ºäºä¿æå¼å®¹æ§ï¼varå½ä»¤åfunctionå½ä»¤å£°æçå¨å±åéï¼ä¾æ§æ¯é¡¶å±å¯¹è±¡çå±æ§ï¼å¦ä¸æ¹é¢è§å®ï¼letå½ä»¤ãconstå½ä»¤ãclasså½ä»¤å£°æçå¨å±åéï¼ä¸å±äºé¡¶å±å¯¹è±¡çå±æ§ãä¹å°±æ¯è¯´ï¼ä» ES6 å¼å§ï¼å¨å±åéå°éæ­¥ä¸é¡¶å±å¯¹è±¡çå±æ§è±é©ã\n\nvar a = 1;\n// å¦æå¨ Node ç REPL ç¯å¢ï¼å¯ä»¥åæ global.a\n// æèéç¨éç¨æ¹æ³ï¼åæ this.a\nwindow.a // 1\n\nlet b = 1;\nwindow.b // undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼å¨å±åéaç±varå½ä»¤å£°æï¼æä»¥å®æ¯é¡¶å±å¯¹è±¡çå±æ§ï¼å¨å±åébç±letå½ä»¤å£°æï¼æä»¥å®ä¸æ¯é¡¶å±å¯¹è±¡çå±æ§ï¼è¿åundefinedã\n\n\n# globalThis å¯¹è±¡\n\nJavaScript è¯­è¨å­å¨ä¸ä¸ªé¡¶å±å¯¹è±¡ï¼å®æä¾å¨å±ç¯å¢ï¼å³å¨å±ä½ç¨åï¼ï¼ææä»£ç é½æ¯å¨è¿ä¸ªç¯å¢ä¸­è¿è¡ãä½æ¯ï¼é¡¶å±å¯¹è±¡å¨åç§å®ç°éé¢æ¯ä¸ç»ä¸çã\n\n * æµè§å¨éé¢ï¼é¡¶å±å¯¹è±¡æ¯windowï¼ä½ Node å Web Worker æ²¡æwindowã\n * æµè§å¨å Web Worker éé¢ï¼selfä¹æåé¡¶å±å¯¹è±¡ï¼ä½æ¯ Node æ²¡æselfã\n * Node éé¢ï¼é¡¶å±å¯¹è±¡æ¯globalï¼ä½å¶ä»ç¯å¢é½ä¸æ¯æã\n\nåä¸æ®µä»£ç ä¸ºäºè½å¤å¨åç§ç¯å¢ï¼é½è½åå°é¡¶å±å¯¹è±¡ï¼ç°å¨ä¸è¬æ¯ä½¿ç¨thisåéï¼ä½æ¯æå±éæ§ã\n\n * å¨å±ç¯å¢ä¸­ï¼thisä¼è¿åé¡¶å±å¯¹è±¡ãä½æ¯ï¼Node æ¨¡åå ES6 æ¨¡åä¸­ï¼thisè¿åçæ¯å½åæ¨¡åã\n * å½æ°éé¢çthisï¼å¦æå½æ°ä¸æ¯ä½ä¸ºå¯¹è±¡çæ¹æ³è¿è¡ï¼èæ¯åçº¯ä½ä¸ºå½æ°è¿è¡ï¼thisä¼æåé¡¶å±å¯¹è±¡ãä½æ¯ï¼ä¸¥æ ¼æ¨¡å¼ä¸ï¼è¿æ¶thisä¼è¿åundefinedã\n * ä¸ç®¡æ¯ä¸¥æ ¼æ¨¡å¼ï¼è¿æ¯æ®éæ¨¡å¼ï¼new Function('return this')()ï¼æ»æ¯ä¼è¿åå¨å±å¯¹è±¡ãä½æ¯ï¼å¦ææµè§å¨ç¨äº CSPï¼Content Security Policyï¼åå®¹å®å¨ç­ç¥ï¼ï¼é£ä¹evalãnew Functionè¿äºæ¹æ³é½å¯è½æ æ³ä½¿ç¨ã\n\nç»¼ä¸æè¿°ï¼å¾é¾æ¾å°ä¸ç§æ¹æ³ï¼å¯ä»¥å¨æææåµä¸ï¼é½åå°é¡¶å±å¯¹è±¡ãä¸é¢æ¯ä¸¤ç§åå¼ºå¯ä»¥ä½¿ç¨çæ¹æ³ã\n\n// æ¹æ³ä¸\n(typeof window !== 'undefined'\n   ? window\n   : (typeof process === 'object' &&\n      typeof require === 'function' &&\n      typeof global === 'object')\n     ? global\n     : this);\n\n// æ¹æ³äº\nvar getGlobal = function () {\n  if (typeof self !== 'undefined') { return self; }\n  if (typeof window !== 'undefined') { return window; }\n  if (typeof global !== 'undefined') { return global; }\n  throw new Error('unable to locate global object');\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nES2020 å¨è¯­è¨æ åçå±é¢ï¼å¼å¥globalThisä½ä¸ºé¡¶å±å¯¹è±¡ãä¹å°±æ¯è¯´ï¼ä»»ä½ç¯å¢ä¸ï¼globalThisé½æ¯å­å¨çï¼é½å¯ä»¥ä»å®æ¿å°é¡¶å±å¯¹è±¡ï¼æåå¨å±ç¯å¢ä¸çthisã\n\nå«çåºglobal-thisæ¨¡æäºè¿ä¸ªææ¡ï¼å¯ä»¥å¨ææç¯å¢æ¿å°globalThisã",normalizedContent:"# let å const å½ä»¤\n\n\n# let å½ä»¤\n\n\n# åºæ¬ç¨æ³\n\nes6 æ°å¢äºletå½ä»¤ï¼ç¨æ¥å£°æåéãå®çç¨æ³ç±»ä¼¼äºvarï¼ä½æ¯æå£°æçåéï¼åªå¨letå½ä»¤æå¨çä»£ç ååææ(åçº§ä½ç¨å)ã\n\n{\n  let a = 10;\n  var b = 1;\n}\n\na // referenceerror: a is not defined.\nb // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç å¨ä»£ç åä¹ä¸­ï¼åå«ç¨letåvarå£°æäºä¸¤ä¸ªåéãç¶åå¨ä»£ç åä¹å¤è°ç¨è¿ä¸¤ä¸ªåéï¼ç»æletå£°æçåéæ¥éï¼varå£°æçåéè¿åäºæ­£ç¡®çå¼ãè¿è¡¨æï¼letå£°æçåéåªå¨å®æå¨çä»£ç åææã\n\nforå¾ªç¯çè®¡æ°å¨ï¼å°±å¾åéä½¿ç¨letå½ä»¤ã\n\nfor (let i = 0; i < 10; i++) {\n  // ...\n}\n\nconsole.log(i);\n// referenceerror: i is not defined\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼è®¡æ°å¨iåªå¨forå¾ªç¯ä½åææï¼å¨å¾ªç¯ä½å¤å¼ç¨å°±ä¼æ¥éã\n\n> å¦æforå¾ªç¯åç¨varå£°æiï¼åä¼æå°10\n\nä¸é¢çä»£ç å¦æä½¿ç¨varï¼æåè¾åºçæ¯10ã\n\nvar a = [];\nfor (var i = 0; i < 10; i++) {\n  a[i] = function () { // å¾ªç¯æ¶åªæ¯å°å½æ°èµå¼ç»a[i],å¹¶æªæ§è¡å½æ°ãå½æ°åçiæ¯å¨å±çi\n    console.log(i);\n  };\n}\na[6](); // 10\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åéiæ¯varå½ä»¤å£°æçï¼å¨å¨å±èå´åé½ææï¼æä»¥å¨å±åªæä¸ä¸ªåéiãæ¯ä¸æ¬¡å¾ªç¯ï¼åéiçå¼é½ä¼åçæ¹åï¼èå¾ªç¯åè¢«èµç»æ°ç»açå½æ°åé¨çconsole.log(i)ï¼éé¢çiæåçå°±æ¯å¨å±çiãä¹å°±æ¯è¯´ï¼æææ°ç»açæåéé¢çiï¼æåçé½æ¯åä¸ä¸ªiï¼å¯¼è´è¿è¡æ¶è¾åºçæ¯æåä¸è½®çiçå¼ï¼ä¹å°±æ¯ 10ã\n\nå¦æä½¿ç¨letï¼å£°æçåéä»å¨åçº§ä½ç¨ååææï¼æåè¾åºçæ¯ 6ã\n\nvar a = [];\nfor (let i = 0; i < 10; i++) {\n  a[i] = function () {\n    console.log(i);\n  };\n}\na[6](); // 6\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åéiæ¯letå£°æçï¼å½åçiåªå¨æ¬è½®å¾ªç¯ææï¼æä»¥æ¯ä¸æ¬¡å¾ªç¯çiå¶å®é½æ¯ä¸ä¸ªæ°çåéï¼æä»¥æåè¾åºçæ¯6ãä½ å¯è½ä¼é®ï¼å¦ææ¯ä¸è½®å¾ªç¯çåéié½æ¯éæ°å£°æçï¼é£å®æä¹ç¥éä¸ä¸è½®å¾ªç¯çå¼ï¼ä»èè®¡ç®åºæ¬è½®å¾ªç¯çå¼ï¼è¿æ¯å ä¸º javascript å¼æåé¨ä¼è®°ä½ä¸ä¸è½®å¾ªç¯çå¼ï¼åå§åæ¬è½®çåéiæ¶ï¼å°±å¨ä¸ä¸è½®å¾ªç¯çåºç¡ä¸è¿è¡è®¡ç®ã\n\nå¦å¤ï¼forå¾ªç¯è¿æä¸ä¸ªç¹å«ä¹å¤ï¼å°±æ¯è®¾ç½®å¾ªç¯åéçé£é¨åæ¯ä¸ä¸ªç¶ä½ç¨åï¼èå¾ªç¯ä½åé¨æ¯ä¸ä¸ªåç¬çå­ä½ç¨åã\n\nfor (let i = 0; i < 3; i++) {\n  let i = 'abc';\n  console.log(i);\n}\n// abc\n// abc\n// abc\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç æ­£ç¡®è¿è¡ï¼è¾åºäº 3 æ¬¡abcãè¿è¡¨æå½æ°åé¨çåéiä¸å¾ªç¯åéiä¸å¨åä¸ä¸ªä½ç¨åï¼æåèªåç¬çä½ç¨åã\n\n\n# ä¸å­å¨åéæå\n\nvarå½ä»¤ä¼åçâåéæåâç°è±¡ï¼å³åéå¯ä»¥å¨å£°æä¹åä½¿ç¨ï¼å¼ä¸ºundefinedãè¿ç§ç°è±¡å¤å¤å°å°æ¯æäºå¥æªçï¼æç§ä¸è¬çé»è¾ï¼åéåºè¯¥å¨å£°æè¯­å¥ä¹åæå¯ä»¥ä½¿ç¨ã\n\nä¸ºäºçº æ­£è¿ç§ç°è±¡ï¼letå½ä»¤æ¹åäºè¯­æ³è¡ä¸ºï¼å®æå£°æçåéä¸å®è¦å¨å£°æåä½¿ç¨ï¼å¦åæ¥éã\n\n// var çæåµ\nconsole.log(foo); // è¾åºundefined\nvar foo = 2;\n\n// let çæåµ\nconsole.log(bar); // æ¥éreferenceerror\nlet bar = 2;\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åéfooç¨varå½ä»¤å£°æï¼ä¼åçåéæåï¼å³èæ¬å¼å§è¿è¡æ¶ï¼åéfooå·²ç»å­å¨äºï¼ä½æ¯æ²¡æå¼ï¼æä»¥ä¼è¾åºundefinedãåébarç¨letå½ä»¤å£°æï¼ä¸ä¼åçåéæåãè¿è¡¨ç¤ºå¨å£°æå®ä¹åï¼åébaræ¯ä¸å­å¨çï¼è¿æ¶å¦æç¨å°å®ï¼å°±ä¼æåºä¸ä¸ªéè¯¯ã\n\n\n# ææ¶æ§æ­»åº\n\nåªè¦åçº§ä½ç¨ååå­å¨letå½ä»¤ï¼å®æå£°æçåéå°±âç»å®âï¼bindingï¼è¿ä¸ªåºåï¼ä¸ååå¤é¨çå½±åã\n\nvar tmp = 123;\n\nif (true) {\n  tmp = 'abc'; // referenceerror\n  let tmp;\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å­å¨å¨å±åétmpï¼ä½æ¯åçº§ä½ç¨ååletåå£°æäºä¸ä¸ªå±é¨åétmpï¼å¯¼è´åèç»å®è¿ä¸ªåçº§ä½ç¨åï¼æä»¥å¨letå£°æåéåï¼å¯¹tmpèµå¼ä¼æ¥éã\n\nes6 æç¡®è§å®ï¼å¦æåºåä¸­å­å¨letåconstå½ä»¤ï¼è¿ä¸ªåºåå¯¹è¿äºå½ä»¤å£°æçåéï¼ä»ä¸å¼å§å°±å½¢æäºå°é­ä½ç¨åãå¡æ¯å¨å£°æä¹åå°±ä½¿ç¨è¿äºåéï¼å°±ä¼æ¥éã\n\næ»ä¹ï¼å¨ä»£ç ååï¼**ä½¿ç¨letå½ä»¤å£°æåéä¹åï¼è¯¥åéé½æ¯ä¸å¯ç¨çãè¿å¨è¯­æ³ä¸ï¼ç§°ä¸ºâææ¶æ§æ­»åºâï¼**temporal dead zoneï¼ç®ç§° tdzï¼ã\n\nif (true) {\n  // tdzå¼å§\n  tmp = 'abc'; // referenceerror\n  console.log(tmp); // referenceerror\n\n  let tmp; // tdzç»æ\n  console.log(tmp); // undefined\n\n  tmp = 123;\n  console.log(tmp); // 123\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼å¨letå½ä»¤å£°æåétmpä¹åï¼é½å±äºåétmpçâæ­»åºâã\n\nâææ¶æ§æ­»åºâä¹æå³çtypeofä¸åæ¯ä¸ä¸ªç¾åä¹ç¾å®å¨çæä½ã\n\ntypeof x; // referenceerror\nlet x;\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼åéxä½¿ç¨letå½ä»¤å£°æï¼æä»¥å¨å£°æä¹åï¼é½å±äºxçâæ­»åºâï¼åªè¦ç¨å°è¯¥åéå°±ä¼æ¥éãå æ­¤ï¼typeofè¿è¡æ¶å°±ä¼æåºä¸ä¸ªreferenceerrorã\n\nä½ä¸ºæ¯è¾ï¼å¦æä¸ä¸ªåéæ ¹æ¬æ²¡æè¢«å£°æï¼ä½¿ç¨typeofåèä¸ä¼æ¥éã\n\ntypeof undeclared_variable // \"undefined\"\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼undeclared_variableæ¯ä¸ä¸ªä¸å­å¨çåéåï¼ç»æè¿åâundefinedâãæä»¥ï¼å¨æ²¡æletä¹åï¼typeofè¿ç®ç¬¦æ¯ç¾åä¹ç¾å®å¨çï¼æ°¸è¿ä¸ä¼æ¥éãç°å¨è¿ä¸ç¹ä¸æç«äºãè¿æ ·çè®¾è®¡æ¯ä¸ºäºè®©å¤§å®¶å»æè¯å¥½çç¼ç¨ä¹ æ¯ï¼åéä¸å®è¦å¨å£°æä¹åä½¿ç¨ï¼å¦åå°±æ¥éã\n\næäºâæ­»åºâæ¯è¾éè½ï¼ä¸å¤ªå®¹æåç°ã\n\nfunction bar(x = y, y = 2) {\n  return [x, y];\n}\n\nbar(); // æ¥é\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼è°ç¨barå½æ°ä¹æä»¥æ¥éï¼æäºå®ç°å¯è½ä¸æ¥éï¼ï¼æ¯å ä¸ºåæ°xé»è®¤å¼ç­äºå¦ä¸ä¸ªåæ°yï¼èæ­¤æ¶yè¿æ²¡æå£°æï¼å±äºâæ­»åºâãå¦æyçé»è®¤å¼æ¯xï¼å°±ä¸ä¼æ¥éï¼å ä¸ºæ­¤æ¶xå·²ç»å£°æäºã\n\nfunction bar(x = 2, y = x) {\n  return [x, y];\n}\nbar(); // [2, 2]\n\n\n1\n2\n3\n4\n\n\nå¦å¤ï¼ä¸é¢çä»£ç ä¹ä¼æ¥éï¼ä¸varçè¡ä¸ºä¸åã\n\n// ä¸æ¥é\nvar x = x;\n\n// æ¥é\nlet x = x;\n// referenceerror: x is not defined\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç æ¥éï¼ä¹æ¯å ä¸ºææ¶æ§æ­»åºãä½¿ç¨letå£°æåéæ¶ï¼åªè¦åéå¨è¿æ²¡æå£°æå®æåä½¿ç¨ï¼å°±ä¼æ¥éãä¸é¢è¿è¡å°±å±äºè¿ä¸ªæåµï¼å¨åéxçå£°æè¯­å¥è¿æ²¡ææ§è¡å®æåï¼å°±å»åxçå¼ï¼å¯¼è´æ¥éâx æªå®ä¹âã\n\nes6 è§å®ææ¶æ§æ­»åºåletãconstè¯­å¥ä¸åºç°åéæåï¼ä¸»è¦æ¯ä¸ºäºåå°è¿è¡æ¶éè¯¯ï¼é²æ­¢å¨åéå£°æåå°±ä½¿ç¨è¿ä¸ªåéï¼ä»èå¯¼è´ææä¹å¤çè¡ä¸ºãè¿æ ·çéè¯¯å¨ es5 æ¯å¾å¸¸è§çï¼ç°å¨æäºè¿ç§è§å®ï¼é¿åæ­¤ç±»éè¯¯å°±å¾å®¹æäºã\n\næ»ä¹ï¼ææ¶æ§æ­»åºçæ¬è´¨å°±æ¯ï¼åªè¦ä¸è¿å¥å½åä½ç¨åï¼æè¦ä½¿ç¨çåéå°±å·²ç»å­å¨äºï¼ä½æ¯ä¸å¯è·åï¼åªæç­å°å£°æåéçé£ä¸è¡ä»£ç åºç°ï¼æå¯ä»¥è·ååä½¿ç¨è¯¥åéã\n\n\n# ä¸åè®¸éå¤å£°æ\n\nletä¸åè®¸å¨ç¸åä½ç¨ååï¼éå¤å£°æåä¸ä¸ªåéã\n\n// æ¥é\nfunction func() {\n  let a = 10;\n  var a = 1;\n}\n\n// æ¥é\nfunction func() {\n  let a = 10;\n  let a = 1;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå æ­¤ï¼ä¸è½å¨å½æ°åé¨éæ°å£°æåæ°ã\n\nfunction func(arg) {\n  let arg;\n}\nfunc() // æ¥é\n\nfunction func(arg) {\n  {\n    let arg;\n  }\n}\nfunc() // ä¸æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# åçº§ä½ç¨å\n\n\n# ä¸ºä»ä¹éè¦åçº§ä½ç¨åï¼\n\nes5 åªæå¨å±ä½ç¨ååå½æ°ä½ç¨åï¼æ²¡æåçº§ä½ç¨åï¼è¿å¸¦æ¥å¾å¤ä¸åççåºæ¯ã\n\nç¬¬ä¸ç§åºæ¯ï¼åå±åéå¯è½ä¼è¦çå¤å±åéã\n\nvar tmp = new date();\n\nfunction f() {\n  console.log(tmp);\n  if (false) {\n    var tmp = 'hello world';\n  }\n}\n\nf(); // undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç çåææ¯ï¼ifä»£ç åçå¤é¨ä½¿ç¨å¤å±çtmpåéï¼åé¨ä½¿ç¨åå±çtmpåéãä½æ¯ï¼å½æ°fæ§è¡åï¼è¾åºç»æä¸ºundefinedï¼åå å¨äºåéæåï¼å¯¼è´åå±çtmpåéè¦çäºå¤å±çtmpåéã\n\nç¬¬äºç§åºæ¯ï¼ç¨æ¥è®¡æ°çå¾ªç¯åéæ³é²ä¸ºå¨å±åéã\n\nvar s = 'hello';\n\nfor (var i = 0; i < s.length; i++) {\n  console.log(s[i]);\n}\n\nconsole.log(i); // 5\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åéiåªç¨æ¥æ§å¶å¾ªç¯ï¼ä½æ¯å¾ªç¯ç»æåï¼å®å¹¶æ²¡ææ¶å¤±ï¼æ³é²æäºå¨å±åéã\n\n\n# es6 çåçº§ä½ç¨å\n\nletå®éä¸ä¸º javascript æ°å¢äºåçº§ä½ç¨åã\n\nfunction f1() {\n  let n = 5;\n  if (true) {\n    let n = 10;\n  }\n  console.log(n); // 5\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢çå½æ°æä¸¤ä¸ªä»£ç åï¼é½å£°æäºåénï¼è¿è¡åè¾åº 5ãè¿è¡¨ç¤ºå¤å±ä»£ç åä¸ååå±ä»£ç åçå½±åãå¦æä¸¤æ¬¡é½ä½¿ç¨varå®ä¹åénï¼æåè¾åºçå¼ææ¯ 10ã\n\nes6 åè®¸åçº§ä½ç¨åçä»»æåµå¥ã\n\n{{{{\n  {let insane = 'hello world'}\n  console.log(insane); // æ¥é\n}}}};\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä½¿ç¨äºä¸ä¸ªäºå±çåçº§ä½ç¨åï¼æ¯ä¸å±é½æ¯ä¸ä¸ªåç¬çä½ç¨åãç¬¬åå±ä½ç¨åæ æ³è¯»åç¬¬äºå±ä½ç¨åçåé¨åéã\n\nåå±ä½ç¨åå¯ä»¥å®ä¹å¤å±ä½ç¨åçåååéã\n\n{{{{\n  let insane = 'hello world';\n  {let insane = 'hello world'}\n}}}};\n\n\n1\n2\n3\n4\n\n\nåçº§ä½ç¨åçåºç°ï¼å®éä¸ä½¿å¾è·å¾å¹¿æ³åºç¨çå¿åç«å³æ§è¡å½æ°è¡¨è¾¾å¼ï¼å¿å iifeï¼ä¸åå¿è¦äºã\n\n// iife åæ³\n(function () {\n  var tmp = ...;\n  ...\n}());\n\n// åçº§ä½ç¨ååæ³\n{\n  let tmp = ...;\n  ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# åçº§ä½ç¨åä¸å½æ°å£°æ\n\nå½æ°è½ä¸è½å¨åçº§ä½ç¨åä¹ä¸­å£°æï¼è¿æ¯ä¸ä¸ªç¸å½ä»¤äººæ··æ·çé®é¢ã\n\nes5 è§å®ï¼å½æ°åªè½å¨é¡¶å±ä½ç¨ååå½æ°ä½ç¨åä¹ä¸­å£°æï¼ä¸è½å¨åçº§ä½ç¨åå£°æã\n\n// æåµä¸\nif (true) {\n  function f() {}\n}\n\n// æåµäº\ntry {\n  function f() {}\n} catch(e) {\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä¸¤ç§å½æ°å£°æï¼æ ¹æ® es5 çè§å®é½æ¯éæ³çã\n\nä½æ¯ï¼æµè§å¨æ²¡æéµå®è¿ä¸ªè§å®ï¼ä¸ºäºå¼å®¹ä»¥åçæ§ä»£ç ï¼è¿æ¯æ¯æå¨åçº§ä½ç¨åä¹ä¸­å£°æå½æ°ï¼å æ­¤ä¸é¢ä¸¤ç§æåµå®éé½è½è¿è¡ï¼ä¸ä¼æ¥éã\n\nes6 å¼å¥äºåçº§ä½ç¨åï¼æç¡®åè®¸å¨åçº§ä½ç¨åä¹ä¸­å£°æå½æ°ães6 è§å®ï¼åçº§ä½ç¨åä¹ä¸­ï¼å½æ°å£°æè¯­å¥çè¡ä¸ºç±»ä¼¼äºletï¼å¨åçº§ä½ç¨åä¹å¤ä¸å¯å¼ç¨ã\n\nfunction f() { console.log('i am outside!'); }\n\n(function () {\n  if (false) {\n    // éå¤å£°æä¸æ¬¡å½æ°f\n    function f() { console.log('i am inside!'); }\n  }\n\n  f();\n}());\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å¨ es5 ä¸­è¿è¡ï¼ä¼å¾å°âi am inside!âï¼å ä¸ºå¨ifåå£°æçå½æ°fä¼è¢«æåå°å½æ°å¤´é¨ï¼å®éè¿è¡çä»£ç å¦ä¸ã\n\n// es5 ç¯å¢\nfunction f() { console.log('i am outside!'); }\n\n(function () {\n  function f() { console.log('i am inside!'); }\n  if (false) {\n  }\n  f();\n}());\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nes6 å°±å®å¨ä¸ä¸æ ·äºï¼çè®ºä¸ä¼å¾å°âi am outside!âãå ä¸ºåçº§ä½ç¨ååå£°æçå½æ°ç±»ä¼¼äºletï¼å¯¹ä½ç¨åä¹å¤æ²¡æå½±åãä½æ¯ï¼å¦æä½ ççå¨ es6 æµè§å¨ä¸­è¿è¡ä¸ä¸ä¸é¢çä»£ç ï¼æ¯ä¼æ¥éçï¼è¿æ¯ä¸ºä»ä¹å¢ï¼\n\n// æµè§å¨ç es6 ç¯å¢\nfunction f() { console.log('i am outside!'); }\n\n(function () {\n  if (false) {\n    // éå¤å£°æä¸æ¬¡å½æ°f\n    function f() { console.log('i am inside!'); }\n  }\n\n  f();\n}());\n// uncaught typeerror: f is not a function\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢çä»£ç å¨ es6 æµè§å¨ä¸­ï¼é½ä¼æ¥éã\n\nåæ¥ï¼å¦ææ¹åäºåçº§ä½ç¨ååå£°æçå½æ°çå¤çè§åï¼æ¾ç¶ä¼å¯¹èä»£ç äº§çå¾å¤§å½±åãä¸ºäºåè½»å æ­¤äº§ççä¸å¼å®¹é®é¢ï¼es6 å¨éå½ béé¢è§å®ï¼æµè§å¨çå®ç°å¯ä»¥ä¸éµå®ä¸é¢çè§å®ï¼æèªå·±çè¡ä¸ºæ¹å¼ã\n\n * åè®¸å¨åçº§ä½ç¨ååå£°æå½æ°ã\n * å½æ°å£°æç±»ä¼¼äºvarï¼å³ä¼æåå°å¨å±ä½ç¨åæå½æ°ä½ç¨åçå¤´é¨ã\n * åæ¶ï¼å½æ°å£°æè¿ä¼æåå°æå¨çåçº§ä½ç¨åçå¤´é¨ã\n\næ³¨æï¼ä¸é¢ä¸æ¡è§ååªå¯¹ es6 çæµè§å¨å®ç°ææï¼å¶ä»ç¯å¢çå®ç°ä¸ç¨éµå®ï¼è¿æ¯å°åçº§ä½ç¨åçå½æ°å£°æå½ä½letå¤çã\n\næ ¹æ®è¿ä¸æ¡è§åï¼æµè§å¨ç es6 ç¯å¢ä¸­ï¼åçº§ä½ç¨ååå£°æçå½æ°ï¼è¡ä¸ºç±»ä¼¼äºvarå£°æçåéãä¸é¢çä¾å­å®éè¿è¡çä»£ç å¦ä¸ã\n\n// æµè§å¨ç es6 ç¯å¢\nfunction f() { console.log('i am outside!'); }\n(function () {\n  var f = undefined;\n  if (false) {\n    function f() { console.log('i am inside!'); }\n  }\n\n  f();\n}());\n// uncaught typeerror: f is not a function\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nèèå°ç¯å¢å¯¼è´çè¡ä¸ºå·®å¼å¤ªå¤§ï¼åºè¯¥é¿åå¨åçº§ä½ç¨ååå£°æå½æ°ãå¦æç¡®å®éè¦ï¼ä¹åºè¯¥åæå½æ°è¡¨è¾¾å¼ï¼èä¸æ¯å½æ°å£°æè¯­å¥ã\n\n// åçº§ä½ç¨ååé¨çå½æ°å£°æè¯­å¥ï¼å»ºè®®ä¸è¦ä½¿ç¨\n{\n  let a = 'secret';\n  function f() {\n    return a;\n  }\n}\n\n// åçº§ä½ç¨ååé¨ï¼ä¼åä½¿ç¨å½æ°è¡¨è¾¾å¼\n{\n  let a = 'secret';\n  let f = function () {\n    return a;\n  };\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå¦å¤ï¼è¿æä¸ä¸ªéè¦æ³¨æçå°æ¹ães6 çåçº§ä½ç¨åå¿é¡»æå¤§æ¬å·ï¼å¦ææ²¡æå¤§æ¬å·ï¼javascript å¼æå°±è®¤ä¸ºä¸å­å¨åçº§ä½ç¨åã\n\n// ç¬¬ä¸ç§åæ³ï¼æ¥é\nif (true) let x = 1;\n\n// ç¬¬äºç§åæ³ï¼ä¸æ¥é\nif (true) {\n  let x = 1;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬ä¸ç§åæ³æ²¡æå¤§æ¬å·ï¼æä»¥ä¸å­å¨åçº§ä½ç¨åï¼èletåªè½åºç°å¨å½åä½ç¨åçé¡¶å±ï¼æä»¥æ¥éãç¬¬äºç§åæ³æå¤§æ¬å·ï¼æä»¥åçº§ä½ç¨åæç«ã\n\nå½æ°å£°æä¹æ¯å¦æ­¤ï¼ä¸¥æ ¼æ¨¡å¼ä¸ï¼å½æ°åªè½å£°æå¨å½åä½ç¨åçé¡¶å±ã\n\n// ä¸æ¥é\n'use strict';\nif (true) {\n  function f() {}\n}\n\n// æ¥é\n'use strict';\nif (true)\n  function f() {}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# const å½ä»¤\n\n\n# åºæ¬ç¨æ³\n\nconstå£°æä¸ä¸ªåªè¯»çå¸¸éãä¸æ¦å£°æï¼å¸¸éçå¼å°±ä¸è½æ¹åã\n\nconst pi = 3.1415;\npi // 3.1415\n\npi = 3;\n// typeerror: assignment to constant variable.\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç è¡¨ææ¹åå¸¸éçå¼ä¼æ¥éã\n\nconstå£°æçåéä¸å¾æ¹åå¼ï¼è¿æå³çï¼constä¸æ¦å£°æåéï¼å°±å¿é¡»ç«å³åå§åï¼ä¸è½çå°ä»¥åèµå¼ã\n\nconst foo;\n// syntaxerror: missing initializer in const declaration\n\n\n1\n2\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼å¯¹äºconstæ¥è¯´ï¼åªå£°æä¸èµå¼ï¼å°±ä¼æ¥éã\n\nconstçä½ç¨åä¸letå½ä»¤ç¸åï¼åªå¨å£°ææå¨çåçº§ä½ç¨ååææã\n\nif (true) {\n  const max = 5;\n}\n\nmax // uncaught referenceerror: max is not defined\n\n\n1\n2\n3\n4\n5\n\n\nconstå½ä»¤å£°æçå¸¸éä¹æ¯ä¸æåï¼åæ ·å­å¨ææ¶æ§æ­»åºï¼åªè½å¨å£°æçä½ç½®åé¢ä½¿ç¨ã\n\nif (true) {\n  console.log(max); // referenceerror\n  const max = 5;\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç å¨å¸¸émaxå£°æä¹åå°±è°ç¨ï¼ç»ææ¥éã\n\nconstå£°æçå¸¸éï¼ä¹ä¸letä¸æ ·ä¸å¯éå¤å£°æã\n\nvar message = \"hello!\";\nlet age = 25;\n\n// ä»¥ä¸ä¸¤è¡é½ä¼æ¥é\nconst message = \"goodbye!\";\nconst age = 30;\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# æ¬è´¨\n\nconstå®éä¸ä¿è¯çï¼å¹¶ä¸æ¯åéçå¼ä¸å¾æ¹å¨ï¼èæ¯åéæåçé£ä¸ªåå­å°åæä¿å­çæ°æ®ä¸å¾æ¹å¨ãå¯¹äºç®åç±»åçæ°æ®ï¼æ°å¼ãå­ç¬¦ä¸²ãå¸å°å¼ï¼ï¼å¼å°±ä¿å­å¨åéæåçé£ä¸ªåå­å°åï¼å æ­¤ç­åäºå¸¸éãä½å¯¹äºå¤åç±»åçæ°æ®ï¼ä¸»è¦æ¯å¯¹è±¡åæ°ç»ï¼ï¼åéæåçåå­å°åï¼ä¿å­çåªæ¯ä¸ä¸ªæåå®éæ°æ®çæéï¼conståªè½ä¿è¯è¿ä¸ªæéæ¯åºå®çï¼å³æ»æ¯æåå¦ä¸ä¸ªåºå®çå°åï¼ï¼è³äºå®æåçæ°æ®ç»ææ¯ä¸æ¯å¯åçï¼å°±å®å¨ä¸è½æ§å¶äºãå æ­¤ï¼å°ä¸ä¸ªå¯¹è±¡å£°æä¸ºå¸¸éå¿é¡»éå¸¸å°å¿ã\n\nconst foo = {};\n\n// ä¸º foo æ·»å ä¸ä¸ªå±æ§ï¼å¯ä»¥æå\nfoo.prop = 123;\nfoo.prop // 123\n\n// å° foo æåå¦ä¸ä¸ªå¯¹è±¡ï¼å°±ä¼æ¥é\nfoo = {}; // typeerror: \"foo\" is read-only\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼å¸¸éfooå¨å­çæ¯ä¸ä¸ªå°åï¼è¿ä¸ªå°åæåä¸ä¸ªå¯¹è±¡ãä¸å¯åçåªæ¯è¿ä¸ªå°åï¼å³ä¸è½æfooæåå¦ä¸ä¸ªå°åï¼ä½å¯¹è±¡æ¬èº«æ¯å¯åçï¼æä»¥ä¾ç¶å¯ä»¥ä¸ºå¶æ·»å æ°å±æ§ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nconst a = [];\na.push('hello'); // å¯æ§è¡\na.length = 0;    // å¯æ§è¡\na = ['dave'];    // æ¥é\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼å¸¸éaæ¯ä¸ä¸ªæ°ç»ï¼è¿ä¸ªæ°ç»æ¬èº«æ¯å¯åçï¼ä½æ¯å¦æå°å¦ä¸ä¸ªæ°ç»èµå¼ç»aï¼å°±ä¼æ¥éã\n\nå¦æççæ³å°å¯¹è±¡å»ç»ï¼åºè¯¥ä½¿ç¨object.freezeæ¹æ³ã\n\nconst foo = object.freeze({});\n\n// å¸¸è§æ¨¡å¼æ¶ï¼ä¸é¢ä¸è¡ä¸èµ·ä½ç¨ï¼\n// ä¸¥æ ¼æ¨¡å¼æ¶ï¼è¯¥è¡ä¼æ¥é\nfoo.prop = 123;\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å¸¸éfooæåä¸ä¸ªå»ç»çå¯¹è±¡ï¼æä»¥æ·»å æ°å±æ§ä¸èµ·ä½ç¨ï¼ä¸¥æ ¼æ¨¡å¼æ¶è¿ä¼æ¥éã\n\né¤äºå°å¯¹è±¡æ¬èº«å»ç»ï¼å¯¹è±¡çå±æ§ä¹åºè¯¥å»ç»ãä¸é¢æ¯ä¸ä¸ªå°å¯¹è±¡å½»åºå»ç»çå½æ°ã\n\nvar constantize = (obj) => {\n  object.freeze(obj);\n  object.keys(obj).foreach( (key, i) => {\n    if ( typeof obj[key] === 'object' ) {\n      constantize( obj[key] );\n    }\n  });\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# es6 å£°æåéçå­ç§æ¹æ³\n\nes5 åªæä¸¤ç§å£°æåéçæ¹æ³ï¼varå½ä»¤åfunctionå½ä»¤ães6 é¤äºæ·»å letåconstå½ä»¤ï¼åé¢ç« èè¿ä¼æå°ï¼å¦å¤ä¸¤ç§å£°æåéçæ¹æ³ï¼importå½ä»¤åclasså½ä»¤ãæä»¥ï¼es6 ä¸å±æ 6 ç§å£°æåéçæ¹æ³ã\n\n\n# é¡¶å±å¯¹è±¡çå±æ§\n\né¡¶å±å¯¹è±¡ï¼å¨æµè§å¨ç¯å¢æçæ¯windowå¯¹è±¡ï¼å¨ node æçæ¯globalå¯¹è±¡ães5 ä¹ä¸­ï¼é¡¶å±å¯¹è±¡çå±æ§ä¸å¨å±åéæ¯ç­ä»·çã\n\nwindow.a = 1;\na // 1\n\na = 2;\nwindow.a // 2\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼é¡¶å±å¯¹è±¡çå±æ§èµå¼ä¸å¨å±åéçèµå¼ï¼æ¯åä¸ä»¶äºã\n\né¡¶å±å¯¹è±¡çå±æ§ä¸å¨å±åéæé©ï¼è¢«è®¤ä¸ºæ¯ javascript è¯­è¨æå¤§çè®¾è®¡è´¥ç¬ä¹ä¸ãè¿æ ·çè®¾è®¡å¸¦æ¥äºå ä¸ªå¾å¤§çé®é¢ï¼é¦åæ¯æ²¡æ³å¨ç¼è¯æ¶å°±æ¥åºåéæªå£°æçéè¯¯ï¼åªæè¿è¡æ¶æè½ç¥éï¼å ä¸ºå¨å±åéå¯è½æ¯é¡¶å±å¯¹è±¡çå±æ§åé çï¼èå±æ§çåé æ¯å¨æçï¼ï¼å¶æ¬¡ï¼ç¨åºåå¾å®¹æä¸ç¥ä¸è§å°å°±åå»ºäºå¨å±åéï¼æ¯å¦æå­åºéï¼ï¼æåï¼é¡¶å±å¯¹è±¡çå±æ§æ¯å°å¤å¯ä»¥è¯»åçï¼è¿éå¸¸ä¸å©äºæ¨¡ååç¼ç¨ãå¦ä¸æ¹é¢ï¼windowå¯¹è±¡æå®ä½å«ä¹ï¼æçæ¯æµè§å¨ççªå£å¯¹è±¡ï¼é¡¶å±å¯¹è±¡æ¯ä¸ä¸ªæå®ä½å«ä¹çå¯¹è±¡ï¼ä¹æ¯ä¸åéçã\n\nes6 ä¸ºäºæ¹åè¿ä¸ç¹ï¼ä¸æ¹é¢è§å®ï¼ä¸ºäºä¿æå¼å®¹æ§ï¼varå½ä»¤åfunctionå½ä»¤å£°æçå¨å±åéï¼ä¾æ§æ¯é¡¶å±å¯¹è±¡çå±æ§ï¼å¦ä¸æ¹é¢è§å®ï¼letå½ä»¤ãconstå½ä»¤ãclasså½ä»¤å£°æçå¨å±åéï¼ä¸å±äºé¡¶å±å¯¹è±¡çå±æ§ãä¹å°±æ¯è¯´ï¼ä» es6 å¼å§ï¼å¨å±åéå°éæ­¥ä¸é¡¶å±å¯¹è±¡çå±æ§è±é©ã\n\nvar a = 1;\n// å¦æå¨ node ç repl ç¯å¢ï¼å¯ä»¥åæ global.a\n// æèéç¨éç¨æ¹æ³ï¼åæ this.a\nwindow.a // 1\n\nlet b = 1;\nwindow.b // undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼å¨å±åéaç±varå½ä»¤å£°æï¼æä»¥å®æ¯é¡¶å±å¯¹è±¡çå±æ§ï¼å¨å±åébç±letå½ä»¤å£°æï¼æä»¥å®ä¸æ¯é¡¶å±å¯¹è±¡çå±æ§ï¼è¿åundefinedã\n\n\n# globalthis å¯¹è±¡\n\njavascript è¯­è¨å­å¨ä¸ä¸ªé¡¶å±å¯¹è±¡ï¼å®æä¾å¨å±ç¯å¢ï¼å³å¨å±ä½ç¨åï¼ï¼ææä»£ç é½æ¯å¨è¿ä¸ªç¯å¢ä¸­è¿è¡ãä½æ¯ï¼é¡¶å±å¯¹è±¡å¨åç§å®ç°éé¢æ¯ä¸ç»ä¸çã\n\n * æµè§å¨éé¢ï¼é¡¶å±å¯¹è±¡æ¯windowï¼ä½ node å web worker æ²¡æwindowã\n * æµè§å¨å web worker éé¢ï¼selfä¹æåé¡¶å±å¯¹è±¡ï¼ä½æ¯ node æ²¡æselfã\n * node éé¢ï¼é¡¶å±å¯¹è±¡æ¯globalï¼ä½å¶ä»ç¯å¢é½ä¸æ¯æã\n\nåä¸æ®µä»£ç ä¸ºäºè½å¤å¨åç§ç¯å¢ï¼é½è½åå°é¡¶å±å¯¹è±¡ï¼ç°å¨ä¸è¬æ¯ä½¿ç¨thisåéï¼ä½æ¯æå±éæ§ã\n\n * å¨å±ç¯å¢ä¸­ï¼thisä¼è¿åé¡¶å±å¯¹è±¡ãä½æ¯ï¼node æ¨¡åå es6 æ¨¡åä¸­ï¼thisè¿åçæ¯å½åæ¨¡åã\n * å½æ°éé¢çthisï¼å¦æå½æ°ä¸æ¯ä½ä¸ºå¯¹è±¡çæ¹æ³è¿è¡ï¼èæ¯åçº¯ä½ä¸ºå½æ°è¿è¡ï¼thisä¼æåé¡¶å±å¯¹è±¡ãä½æ¯ï¼ä¸¥æ ¼æ¨¡å¼ä¸ï¼è¿æ¶thisä¼è¿åundefinedã\n * ä¸ç®¡æ¯ä¸¥æ ¼æ¨¡å¼ï¼è¿æ¯æ®éæ¨¡å¼ï¼new function('return this')()ï¼æ»æ¯ä¼è¿åå¨å±å¯¹è±¡ãä½æ¯ï¼å¦ææµè§å¨ç¨äº cspï¼content security policyï¼åå®¹å®å¨ç­ç¥ï¼ï¼é£ä¹evalãnew functionè¿äºæ¹æ³é½å¯è½æ æ³ä½¿ç¨ã\n\nç»¼ä¸æè¿°ï¼å¾é¾æ¾å°ä¸ç§æ¹æ³ï¼å¯ä»¥å¨æææåµä¸ï¼é½åå°é¡¶å±å¯¹è±¡ãä¸é¢æ¯ä¸¤ç§åå¼ºå¯ä»¥ä½¿ç¨çæ¹æ³ã\n\n// æ¹æ³ä¸\n(typeof window !== 'undefined'\n   ? window\n   : (typeof process === 'object' &&\n      typeof require === 'function' &&\n      typeof global === 'object')\n     ? global\n     : this);\n\n// æ¹æ³äº\nvar getglobal = function () {\n  if (typeof self !== 'undefined') { return self; }\n  if (typeof window !== 'undefined') { return window; }\n  if (typeof global !== 'undefined') { return global; }\n  throw new error('unable to locate global object');\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nes2020 å¨è¯­è¨æ åçå±é¢ï¼å¼å¥globalthisä½ä¸ºé¡¶å±å¯¹è±¡ãä¹å°±æ¯è¯´ï¼ä»»ä½ç¯å¢ä¸ï¼globalthisé½æ¯å­å¨çï¼é½å¯ä»¥ä»å®æ¿å°é¡¶å±å¯¹è±¡ï¼æåå¨å±ç¯å¢ä¸çthisã\n\nå«çåºglobal-thisæ¨¡æäºè¿ä¸ªææ¡ï¼å¯ä»¥å¨ææç¯å¢æ¿å°globalthisã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"åéçè§£æèµå¼",frontmatter:{title:"åéçè§£æèµå¼",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/b1ab10a62f7564da",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/03.%E5%8F%98%E9%87%8F%E7%9A%84%E8%A7%A3%E6%9E%84%E8%B5%8B%E5%80%BC.html",relativePath:"ãES6 æç¨ãç¬è®°/03.åéçè§£æèµå¼.md",key:"v-346f208f",path:"/pages/b1ab10a62f7564da/",headers:[{level:2,title:"æ°ç»çè§£æèµå¼",slug:"æ°ç»çè§£æèµå¼",normalizedTitle:"æ°ç»çè§£æèµå¼",charIndex:14},{level:3,title:"åºæ¬ç¨æ³",slug:"åºæ¬ç¨æ³",normalizedTitle:"åºæ¬ç¨æ³",charIndex:26},{level:3,title:"é»è®¤å¼",slug:"é»è®¤å¼",normalizedTitle:"é»è®¤å¼",charIndex:1628},{level:2,title:"å¯¹è±¡çè§£æèµå¼",slug:"å¯¹è±¡çè§£æèµå¼",normalizedTitle:"å¯¹è±¡çè§£æèµå¼",charIndex:2516},{level:3,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:2528},{level:3,title:"é»è®¤å¼",slug:"é»è®¤å¼-2",normalizedTitle:"é»è®¤å¼",charIndex:1628},{level:3,title:"æ³¨æç¹",slug:"æ³¨æç¹",normalizedTitle:"æ³¨æç¹",charIndex:5548},{level:2,title:"å­ç¬¦ä¸²çè§£æèµå¼",slug:"å­ç¬¦ä¸²çè§£æèµå¼",normalizedTitle:"å­ç¬¦ä¸²çè§£æèµå¼",charIndex:6212},{level:2,title:"æ°å¼åå¸å°å¼çè§£æèµå¼",slug:"æ°å¼åå¸å°å¼çè§£æèµå¼",normalizedTitle:"æ°å¼åå¸å°å¼çè§£æèµå¼",charIndex:6441},{level:2,title:"å½æ°åæ°çè§£æèµå¼",slug:"å½æ°åæ°çè§£æèµå¼",normalizedTitle:"å½æ°åæ°çè§£æèµå¼",charIndex:6840},{level:2,title:"åæ¬å·é®é¢",slug:"åæ¬å·é®é¢",normalizedTitle:"åæ¬å·é®é¢",charIndex:7706},{level:3,title:"ä¸è½ä½¿ç¨åæ¬å·çæåµ",slug:"ä¸è½ä½¿ç¨åæ¬å·çæåµ",normalizedTitle:"ä¸è½ä½¿ç¨åæ¬å·çæåµ",charIndex:7904},{level:3,title:"å¯ä»¥ä½¿ç¨åæ¬å·çæåµ",slug:"å¯ä»¥ä½¿ç¨åæ¬å·çæåµ",normalizedTitle:"å¯ä»¥ä½¿ç¨åæ¬å·çæåµ",charIndex:8440},{level:2,title:"ç¨é",slug:"ç¨é",normalizedTitle:"ç¨é",charIndex:8693}],excerpt:'<h1 id="åéçè§£æèµå¼"><a class="header-anchor" href="#åéçè§£æèµå¼">#</a> åéçè§£æèµå¼</h1>\n<h2 id="æ°ç»çè§£æèµå¼"><a class="header-anchor" href="#æ°ç»çè§£æèµå¼">#</a> æ°ç»çè§£æèµå¼</h2>\n<h3 id="åºæ¬ç¨æ³"><a class="header-anchor" href="#åºæ¬ç¨æ³">#</a> åºæ¬ç¨æ³</h3>\n<p>ES6 åè®¸æç§ä¸å®æ¨¡å¼ï¼<strong>ä»æ°ç»åå¯¹è±¡ä¸­æåå¼ï¼å¯¹åéè¿è¡èµå¼ï¼è¿è¢«ç§°ä¸ºè§£æ</strong>ï¼Destructuringï¼ã</p>\n<p>ä»¥åï¼ä¸ºåéèµå¼ï¼åªè½ç´æ¥æå®å¼ã</p>\n\x3c!--beforebegin--\x3e<div class="language-javascript line-numbers-mode">\x3c!--afterbegin--\x3e<pre v-pre class="language-javascript"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>\n</code></pre>\n<div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div>\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e',headersStr:"æ°ç»çè§£æèµå¼ åºæ¬ç¨æ³ é»è®¤å¼ å¯¹è±¡çè§£æèµå¼ ç®ä» é»è®¤å¼ æ³¨æç¹ å­ç¬¦ä¸²çè§£æèµå¼ æ°å¼åå¸å°å¼çè§£æèµå¼ å½æ°åæ°çè§£æèµå¼ åæ¬å·é®é¢ ä¸è½ä½¿ç¨åæ¬å·çæåµ å¯ä»¥ä½¿ç¨åæ¬å·çæåµ ç¨é",content:"# åéçè§£æèµå¼\n\n\n# æ°ç»çè§£æèµå¼\n\n\n# åºæ¬ç¨æ³\n\nES6 åè®¸æç§ä¸å®æ¨¡å¼ï¼ä»æ°ç»åå¯¹è±¡ä¸­æåå¼ï¼å¯¹åéè¿è¡èµå¼ï¼è¿è¢«ç§°ä¸ºè§£æï¼Destructuringï¼ã\n\nä»¥åï¼ä¸ºåéèµå¼ï¼åªè½ç´æ¥æå®å¼ã\n\nlet a = 1;\nlet b = 2;\nlet c = 3;\n\n\n1\n2\n3\n\n\nES6 åè®¸åæä¸é¢è¿æ ·ã\n\nlet [a, b, c] = [1, 2, 3];\n\n\n1\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼å¯ä»¥ä»æ°ç»ä¸­æåå¼ï¼æç§å¯¹åºä½ç½®ï¼å¯¹åéèµå¼ã\n\næ¬è´¨ä¸ï¼è¿ç§åæ³å±äºâæ¨¡å¼å¹éâï¼åªè¦ç­å·ä¸¤è¾¹çæ¨¡å¼ç¸åï¼å·¦è¾¹çåéå°±ä¼è¢«èµäºå¯¹åºçå¼ãä¸é¢æ¯ä¸äºä½¿ç¨åµå¥æ°ç»è¿è¡è§£æçä¾å­ã\n\nlet [foo, [[bar], baz]] = [1, [[2], 3]];\nfoo // 1\nbar // 2\nbaz // 3\n\nlet [ , , third] = [\"foo\", \"bar\", \"baz\"];\nthird // \"baz\"\n\nlet [x, , y] = [1, 2, 3];\nx // 1\ny // 3\n\nlet [head, ...tail] = [1, 2, 3, 4];\nhead // 1\ntail // [2, 3, 4]\n\nlet [x, y, ...z] = ['a'];\nx // \"a\"\ny // undefined\nz // []\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nå¦æè§£æä¸æåï¼åéçå¼å°±ç­äºundefinedã\n\nlet [foo] = [];\nlet [bar, foo] = [1];\n\n\n1\n2\n\n\nä»¥ä¸ä¸¤ç§æåµé½å±äºè§£æä¸æåï¼fooçå¼é½ä¼ç­äºundefinedã\n\nå¦ä¸ç§æåµæ¯ä¸å®å¨è§£æï¼å³ç­å·å·¦è¾¹çæ¨¡å¼ï¼åªå¹éä¸é¨åçç­å·å³è¾¹çæ°ç»ãè¿ç§æåµä¸ï¼è§£æä¾ç¶å¯ä»¥æåã\n\nlet [x, y] = [1, 2, 3];\nx // 1\ny // 2\n\nlet [a, [b], d] = [1, [2, 3], 4];\na // 1\nb // 2\nd // 4\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä¸¤ä¸ªä¾å­ï¼é½å±äºä¸å®å¨è§£æï¼ä½æ¯å¯ä»¥æåã\n\nå¦æç­å·çå³è¾¹ä¸æ¯æ°ç»ï¼æèä¸¥æ ¼å°è¯´ï¼ä¸æ¯å¯éåçç»æï¼åè§ãIteratorãä¸ç« ï¼ï¼é£ä¹å°ä¼æ¥éã\n\n// æ¥é\nlet [foo] = 1;\nlet [foo] = false;\nlet [foo] = NaN;\nlet [foo] = undefined;\nlet [foo] = null;\nlet [foo] = {};\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢çè¯­å¥é½ä¼æ¥éï¼å ä¸ºç­å·å³è¾¹çå¼ï¼è¦ä¹è½¬ä¸ºå¯¹è±¡ä»¥åä¸å·å¤ Iterator æ¥å£ï¼åäºä¸ªè¡¨è¾¾å¼ï¼ï¼è¦ä¹æ¬èº«å°±ä¸å·å¤ Iterator æ¥å£ï¼æåä¸ä¸ªè¡¨è¾¾å¼ï¼ã\n\nå¯¹äº Set ç»æï¼ä¹å¯ä»¥ä½¿ç¨æ°ç»çè§£æèµå¼ã\n\nlet [x, y, z] = new Set(['a', 'b', 'c']);\nx // \"a\"\n\n\n1\n2\n\n\näºå®ä¸ï¼åªè¦æç§æ°æ®ç»æå·æ Iterator æ¥å£ï¼é½å¯ä»¥éç¨æ°ç»å½¢å¼çè§£æèµå¼ã\n\nfunction* fibs() {\n  let a = 0;\n  let b = 1;\n  while (true) {\n    yield a;\n    [a, b] = [b, a + b];\n  }\n}\n\nlet [first, second, third, fourth, fifth, sixth] = fibs();\nsixth // 5\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼fibsæ¯ä¸ä¸ª Generator å½æ°ï¼åè§ãGenerator å½æ°ãä¸ç« ï¼ï¼åçå·æ Iterator æ¥å£ãè§£æèµå¼ä¼ä¾æ¬¡ä»è¿ä¸ªæ¥å£è·åå¼ã\n\n\n# é»è®¤å¼\n\nè§£æèµå¼åè®¸æå®é»è®¤å¼ã\n\nlet [foo = true] = [];\nfoo // true\n\nlet [x, y = 'b'] = ['a']; // x='a', y='b'\nlet [x, y = 'b'] = ['a', undefined]; // x='a', y='b'\n\n\n1\n2\n3\n4\n5\n\n\næ³¨æï¼ES6 åé¨ä½¿ç¨ä¸¥æ ¼ç¸ç­è¿ç®ç¬¦ï¼===ï¼ï¼å¤æ­ä¸ä¸ªä½ç½®æ¯å¦æå¼ãæä»¥ï¼åªæ å½ä¸ä¸ªæ°ç»æåä¸¥æ ¼ç­äºundefinedï¼é»è®¤å¼æä¼çæã\n\nlet [x = 1] = [undefined];\nx // 1\n\nlet [x = 1] = [null];\nx // null\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æä¸ä¸ªæ°ç»æåæ¯nullï¼é»è®¤å¼å°±ä¸ä¼çæï¼å ä¸ºnullä¸ä¸¥æ ¼ç­äºundefinedã\n\nå¦æé»è®¤å¼æ¯ä¸ä¸ªè¡¨è¾¾å¼ï¼é£ä¹è¿ä¸ªè¡¨è¾¾å¼æ¯æ°æ§æ±å¼çï¼å³åªæå¨ç¨å°çæ¶åï¼æä¼æ±å¼ã\n\nfunction f() {\n  console.log('aaa');\n}\n\nlet [x = f()] = [1];\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å ä¸ºxè½åå°å¼ï¼æä»¥å½æ°fæ ¹æ¬ä¸ä¼æ§è¡ãä¸é¢çä»£ç å¶å®ç­ä»·äºä¸é¢çä»£ç ã\n\nlet x;\nif ([1][0] === undefined) {\n  x = f();\n} else {\n  x = [1][0];\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\né»è®¤å¼å¯ä»¥å¼ç¨è§£æèµå¼çå¶ä»åéï¼ä½è¯¥åéå¿é¡»å·²ç»å£°æã\n\nlet [x = 1, y = x] = [];     // x=1; y=1\nlet [x = 1, y = x] = [2];    // x=2; y=2\nlet [x = 1, y = x] = [1, 2]; // x=1; y=2\nlet [x = y, y = 1] = [];     // ReferenceError: y is not defined\n\n\n1\n2\n3\n4\n\n\nä¸é¢æåä¸ä¸ªè¡¨è¾¾å¼ä¹æä»¥ä¼æ¥éï¼æ¯å ä¸ºxç¨yåé»è®¤å¼æ¶ï¼yè¿æ²¡æå£°æã\n\n\n# å¯¹è±¡çè§£æèµå¼\n\n\n# ç®ä»\n\nè§£æä¸ä»å¯ä»¥ç¨äºæ°ç»ï¼è¿å¯ä»¥ç¨äºå¯¹è±¡ã\n\nlet { foo, bar } = { foo: 'aaa', bar: 'bbb' };\nfoo // \"aaa\"\nbar // \"bbb\"\n\n\n1\n2\n3\n\n\nå¯¹è±¡çè§£æä¸æ°ç»æä¸ä¸ªéè¦çä¸åãæ°ç»çåç´ æ¯ææ¬¡åºæåçï¼åéçåå¼ç±å®çä½ç½®å³å®ï¼èå¯¹è±¡çå±æ§æ²¡ææ¬¡åºï¼åéå¿é¡»ä¸å±æ§ååï¼æè½åå°æ­£ç¡®çå¼ã\n\nlet { bar, foo } = { foo: 'aaa', bar: 'bbb' };\nfoo // \"aaa\"\nbar // \"bbb\"\n\nlet { baz } = { foo: 'aaa', bar: 'bbb' };\nbaz // undefined\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çç¬¬ä¸ä¸ªä¾å­ï¼ç­å·å·¦è¾¹çä¸¤ä¸ªåéçæ¬¡åºï¼ä¸ç­å·å³è¾¹ä¸¤ä¸ªååå±æ§çæ¬¡åºä¸ä¸è´ï¼ä½æ¯å¯¹åå¼å®å¨æ²¡æå½±åãç¬¬äºä¸ªä¾å­çåéæ²¡æå¯¹åºçååå±æ§ï¼å¯¼è´åä¸å°å¼ï¼æåç­äºundefinedã\n\nå¦æè§£æå¤±è´¥ï¼åéçå¼ç­äºundefinedã\n\nlet {foo} = {bar: 'baz'};\nfoo // undefined\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼ç­å·å³è¾¹çå¯¹è±¡æ²¡æfooå±æ§ï¼æä»¥åéfooåä¸å°å¼ï¼æä»¥ç­äºundefinedã\n\nå¯¹è±¡çè§£æèµå¼ï¼å¯ä»¥å¾æ¹ä¾¿å°å°ç°æå¯¹è±¡çæ¹æ³ï¼èµå¼å°æä¸ªåéã\n\n// ä¾ä¸\nlet { log, sin, cos } = Math;\n\n// ä¾äº\nconst { log } = console;\nlog('hello') // hello\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çä¾ä¸å°Mathå¯¹è±¡çå¯¹æ°ãæ­£å¼¦ãä½å¼¦ä¸ä¸ªæ¹æ³ï¼èµå¼å°å¯¹åºçåéä¸ï¼ä½¿ç¨èµ·æ¥å°±ä¼æ¹ä¾¿å¾å¤ãä¾äºå°console.logèµå¼å°logåéã\n\nå¦æåéåä¸å±æ§åä¸ä¸è´ï¼å¿é¡»åæä¸é¢è¿æ ·ã\n\nlet { foo: baz } = { foo: 'aaa', bar: 'bbb' };\nbaz // \"aaa\"\n\nlet obj = { first: 'hello', last: 'world' };\nlet { first: f, last: l } = obj;\nf // 'hello'\nl // 'world'\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¿å®éä¸è¯´æï¼å¯¹è±¡çè§£æèµå¼æ¯ä¸é¢å½¢å¼çç®åï¼åè§ãå¯¹è±¡çæ©å±ãä¸ç« ï¼ã\n\nlet { foo: foo, bar: bar } = { foo: 'aaa', bar: 'bbb' };\n\n\n1\n\n\nä¹å°±æ¯è¯´ï¼å¯¹è±¡çè§£æèµå¼çåé¨æºå¶ï¼æ¯åæ¾å°ååå±æ§ï¼ç¶ååèµç»å¯¹åºçåéãçæ­£è¢«èµå¼çæ¯åèï¼èä¸æ¯åèã\n\nlet { foo: baz } = { foo: 'aaa', bar: 'bbb' };\nbaz // \"aaa\"\nfoo // error: foo is not defined\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼fooæ¯å¹éçæ¨¡å¼ï¼bazææ¯åéãçæ­£è¢«èµå¼çæ¯åébazï¼èä¸æ¯æ¨¡å¼fooã\n\nä¸æ°ç»ä¸æ ·ï¼è§£æä¹å¯ä»¥ç¨äºåµå¥ç»æçå¯¹è±¡ã\n\nlet obj = {\n  p: [\n    'Hello',\n    { y: 'World' }\n  ]\n};\n\nlet { p: [x, { y }] } = obj;\nx // \"Hello\"\ny // \"World\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\næ³¨æï¼è¿æ¶pæ¯æ¨¡å¼ï¼ä¸æ¯åéï¼å æ­¤ä¸ä¼è¢«èµå¼ãå¦æpä¹è¦ä½ä¸ºåéèµå¼ï¼å¯ä»¥åæä¸é¢è¿æ ·ã\n\nlet obj = {\n  p: [\n    'Hello',\n    { y: 'World' }\n  ]\n};\n\nlet { p, p: [x, { y }] } = obj;\nx // \"Hello\"\ny // \"World\"\np // [\"Hello\", {y: \"World\"}]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nconst node = {\n  loc: {\n    start: {\n      line: 1,\n      column: 5\n    }\n  }\n};\n\nlet { loc, loc: { start }, loc: { start: { line }} } = node;\nline // 1\nloc  // Object {start: Object}\nstart // Object {line: 1, column: 5}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç æä¸æ¬¡è§£æèµå¼ï¼åå«æ¯å¯¹locãstartãlineä¸ä¸ªå±æ§çè§£æèµå¼ãæ³¨æï¼æåä¸æ¬¡å¯¹lineå±æ§çè§£æèµå¼ä¹ä¸­ï¼åªælineæ¯åéï¼locåstarté½æ¯æ¨¡å¼ï¼ä¸æ¯åéã\n\nä¸é¢æ¯åµå¥èµå¼çä¾å­ã\n\nlet obj = {};\nlet arr = [];\n\n({ foo: obj.prop, bar: arr[0] } = { foo: 123, bar: true });\n\nobj // {prop:123}\narr // [true]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦æè§£ææ¨¡å¼æ¯åµå¥çå¯¹è±¡ï¼èä¸å­å¯¹è±¡æå¨çç¶å±æ§ä¸å­å¨ï¼é£ä¹å°ä¼æ¥éã\n\n// æ¥é\nlet {foo: {bar}} = {baz: 'baz'};\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼ç­å·å·¦è¾¹å¯¹è±¡çfooå±æ§ï¼å¯¹åºä¸ä¸ªå­å¯¹è±¡ãè¯¥å­å¯¹è±¡çbarå±æ§ï¼è§£ææ¶ä¼æ¥éãåå å¾ç®åï¼å ä¸ºfooè¿æ¶ç­äºundefinedï¼ååå­å±æ§å°±ä¼æ¥éã\n\næ³¨æï¼å¯¹è±¡çè§£æèµå¼å¯ä»¥åå°ç»§æ¿çå±æ§ã\n\nconst obj1 = {};\nconst obj2 = { foo: 'bar' };\nObject.setPrototypeOf(obj1, obj2);\n\nconst { foo } = obj1;\nfoo // \"bar\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯¹è±¡obj1çååå¯¹è±¡æ¯obj2ãfooå±æ§ä¸æ¯obj1èªèº«çå±æ§ï¼èæ¯ç»§æ¿èªobj2çå±æ§ï¼è§£æèµå¼å¯ä»¥åå°è¿ä¸ªå±æ§ã\n\n\n# é»è®¤å¼\n\nå¯¹è±¡çè§£æä¹å¯ä»¥æå®é»è®¤å¼ã\n\nvar {x = 3} = {};\nx // 3\n\nvar {x, y = 5} = {x: 1};\nx // 1\ny // 5\n\nvar {x: y = 3} = {};\ny // 3\n\nvar {x: y = 3} = {x: 5};\ny // 5\n\nvar { message: msg = 'Something went wrong' } = {};\nmsg // \"Something went wrong\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\né»è®¤å¼çæçæ¡ä»¶æ¯ï¼å¯¹è±¡çå±æ§å¼ä¸¥æ ¼ç­äºundefinedã\n\nvar {x = 3} = {x: undefined};\nx // 3\n\nvar {x = 3} = {x: null};\nx // null\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å±æ§xç­äºnullï¼å ä¸ºnullä¸undefinedä¸ä¸¥æ ¼ç¸ç­ï¼æä»¥æ¯ä¸ªææçèµå¼ï¼å¯¼è´é»è®¤å¼3ä¸ä¼çæã\n\n\n# æ³¨æç¹\n\nï¼1ï¼å¦æè¦å°ä¸ä¸ªå·²ç»å£°æçåéç¨äºè§£æèµå¼ï¼å¿é¡»éå¸¸å°å¿ã\n\n// éè¯¯çåæ³\nlet x;\n{x} = {x: 1};\n// SyntaxError: syntax error\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç çåæ³ä¼æ¥éï¼å ä¸º JavaScript å¼æä¼å°{x}çè§£æä¸ä¸ªä»£ç åï¼ä»èåçè¯­æ³éè¯¯ãåªæä¸å°å¤§æ¬å·åå¨è¡é¦ï¼é¿å JavaScript å°å¶è§£éä¸ºä»£ç åï¼æè½è§£å³è¿ä¸ªé®é¢ã\n\n// æ­£ç¡®çåæ³\nlet x;\n({x} = {x: 1});\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç å°æ´ä¸ªè§£æèµå¼è¯­å¥ï¼æ¾å¨ä¸ä¸ªåæ¬å·éé¢ï¼å°±å¯ä»¥æ­£ç¡®æ§è¡ãå³äºåæ¬å·ä¸è§£æèµå¼çå³ç³»ï¼åè§ä¸æã\n\nï¼2ï¼è§£æèµå¼åè®¸ç­å·å·¦è¾¹çæ¨¡å¼ä¹ä¸­ï¼ä¸æ¾ç½®ä»»ä½åéåãå æ­¤ï¼å¯ä»¥ååºéå¸¸å¤æªçèµå¼è¡¨è¾¾å¼ã\n\n({} = [true, false]);\n({} = 'abc');\n({} = []);\n\n\n1\n2\n3\n\n\nä¸é¢çè¡¨è¾¾å¼è½ç¶æ¯«æ æä¹ï¼ä½æ¯è¯­æ³æ¯åæ³çï¼å¯ä»¥æ§è¡ã\n\nï¼3ï¼ç±äºæ°ç»æ¬è´¨æ¯ç¹æ®çå¯¹è±¡ï¼å æ­¤å¯ä»¥å¯¹æ°ç»è¿è¡å¯¹è±¡å±æ§çè§£æã\n\nlet arr = [1, 2, 3];\nlet {0 : first, [arr.length - 1] : last} = arr;\nfirst // 1\nlast // 3\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç å¯¹æ°ç»è¿è¡å¯¹è±¡è§£æãæ°ç»arrç0é®å¯¹åºçå¼æ¯1ï¼[arr.length - 1]å°±æ¯2é®ï¼å¯¹åºçå¼æ¯3ãæ¹æ¬å·è¿ç§åæ³ï¼å±äºâå±æ§åè¡¨è¾¾å¼âï¼åè§ãå¯¹è±¡çæ©å±ãä¸ç« ï¼ã\n\n\n# å­ç¬¦ä¸²çè§£æèµå¼\n\nå­ç¬¦ä¸²ä¹å¯ä»¥è§£æèµå¼ãè¿æ¯å ä¸ºæ­¤æ¶ï¼å­ç¬¦ä¸²è¢«è½¬æ¢æäºä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ã\n\nconst [a, b, c, d, e] = 'hello';\na // \"h\"\nb // \"e\"\nc // \"l\"\nd // \"l\"\ne // \"o\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nç±»ä¼¼æ°ç»çå¯¹è±¡é½æä¸ä¸ªlengthå±æ§ï¼å æ­¤è¿å¯ä»¥å¯¹è¿ä¸ªå±æ§è§£æèµå¼ã\n\nlet {length : len} = 'hello';\nlen // 5\n\n\n1\n2\n\n\n\n# æ°å¼åå¸å°å¼çè§£æèµå¼\n\nè§£æèµå¼æ¶ï¼å¦æç­å·å³è¾¹æ¯æ°å¼åå¸å°å¼ï¼åä¼åè½¬ä¸ºå¯¹è±¡ã\n\nlet {toString: s} = 123;\ns === Number.prototype.toString // true\n\nlet {toString: s} = true;\ns === Boolean.prototype.toString // true\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°å¼åå¸å°å¼çåè£å¯¹è±¡é½ætoStringå±æ§ï¼å æ­¤åésé½è½åå°å¼ã\n\nè§£æèµå¼çè§åæ¯ï¼åªè¦ç­å·å³è¾¹çå¼ä¸æ¯å¯¹è±¡ææ°ç»ï¼å°±åå°å¶è½¬ä¸ºå¯¹è±¡ãç±äºundefinedånullæ æ³è½¬ä¸ºå¯¹è±¡ï¼æä»¥å¯¹å®ä»¬è¿è¡è§£æèµå¼ï¼é½ä¼æ¥éã\n\nlet { prop: x } = undefined; // TypeError\nlet { prop: y } = null; // TypeError\n\n\n1\n2\n\n\n\n# å½æ°åæ°çè§£æèµå¼\n\nå½æ°çåæ°ä¹å¯ä»¥ä½¿ç¨è§£æèµå¼ã\n\nfunction add([x, y]){\n  return x + y;\n}\n\nadd([1, 2]); // 3\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°addçåæ°è¡¨é¢ä¸æ¯ä¸ä¸ªæ°ç»ï¼ä½å¨ä¼ å¥åæ°çé£ä¸å»ï¼æ°ç»åæ°å°±è¢«è§£ææåéxåyãå¯¹äºå½æ°åé¨çä»£ç æ¥è¯´ï¼å®ä»¬è½æåå°çåæ°å°±æ¯xåyã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\n[[1, 2], [3, 4]].map(([a, b]) => a + b);\n// [ 3, 7 ]\n\n\n1\n2\n\n\nå½æ°åæ°çè§£æä¹å¯ä»¥ä½¿ç¨é»è®¤å¼ã\n\nfunction move({x = 0, y = 0} = {}) {\n  return [x, y];\n}\n\nmove({x: 3, y: 8}); // [3, 8]\nmove({x: 3}); // [3, 0]\nmove({}); // [0, 0]\nmove(); // [0, 0]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°moveçåæ°æ¯ä¸ä¸ªå¯¹è±¡ï¼éè¿å¯¹è¿ä¸ªå¯¹è±¡è¿è¡è§£æï¼å¾å°åéxåyçå¼ãå¦æè§£æå¤±è´¥ï¼xåyç­äºé»è®¤å¼ã\n\næ³¨æï¼ä¸é¢çåæ³ä¼å¾å°ä¸ä¸æ ·çç»æã\n\nfunction move({x, y} = { x: 0, y: 0 }) {\n  return [x, y];\n}\n\nmove({x: 3, y: 8}); // [3, 8]\nmove({x: 3}); // [3, undefined]\nmove({}); // [undefined, undefined]\nmove(); // [0, 0]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç æ¯ä¸ºå½æ°moveçåæ°æå®é»è®¤å¼ï¼èä¸æ¯ä¸ºåéxåyæå®é»è®¤å¼ï¼æä»¥ä¼å¾å°ä¸åä¸ç§åæ³ä¸åçç»æã\n\nundefinedå°±ä¼è§¦åå½æ°åæ°çé»è®¤å¼ã\n\n[1, undefined, 3].map((x = 'yes') => x);\n// [ 1, 'yes', 3 ]\n\n\n1\n2\n\n\n\n# åæ¬å·é®é¢\n\nè§£æèµå¼è½ç¶å¾æ¹ä¾¿ï¼ä½æ¯è§£æèµ·æ¥å¹¶ä¸å®¹æãå¯¹äºç¼è¯å¨æ¥è¯´ï¼ä¸ä¸ªå¼å­å°åºæ¯æ¨¡å¼ï¼è¿æ¯è¡¨è¾¾å¼ï¼æ²¡æåæ³ä»ä¸å¼å§å°±ç¥éï¼å¿é¡»è§£æå°ï¼æè§£æä¸å°ï¼ç­å·æè½ç¥éã\n\nç±æ­¤å¸¦æ¥çé®é¢æ¯ï¼å¦ææ¨¡å¼ä¸­åºç°åæ¬å·æä¹å¤çãES6 çè§åæ¯ï¼åªè¦æå¯è½å¯¼è´è§£æçæ­§ä¹ï¼å°±ä¸å¾ä½¿ç¨åæ¬å·ã\n\nä½æ¯ï¼è¿æ¡è§åå®éä¸ä¸é£ä¹å®¹æè¾¨å«ï¼å¤çèµ·æ¥ç¸å½éº»ç¦ãå æ­¤ï¼å»ºè®®åªè¦æå¯è½ï¼å°±ä¸è¦å¨æ¨¡å¼ä¸­æ¾ç½®åæ¬å·ã\n\n\n# ä¸è½ä½¿ç¨åæ¬å·çæåµ\n\nä»¥ä¸ä¸ç§è§£æèµå¼ä¸å¾ä½¿ç¨åæ¬å·ã\n\nï¼1ï¼åéå£°æè¯­å¥\n\n// å¨é¨æ¥é\nlet [(a)] = [1];\n\nlet {x: (c)} = {};\nlet ({x: c}) = {};\nlet {(x: c)} = {};\nlet {(x): c} = {};\n\nlet { o: ({ p: p }) } = { o: { p: 2 } };\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ 6 ä¸ªè¯­å¥é½ä¼æ¥éï¼å ä¸ºå®ä»¬é½æ¯åéå£°æè¯­å¥ï¼æ¨¡å¼ä¸è½ä½¿ç¨åæ¬å·ã\n\nï¼2ï¼å½æ°åæ°\n\nå½æ°åæ°ä¹å±äºåéå£°æï¼å æ­¤ä¸è½å¸¦æåæ¬å·ã\n\n// æ¥é\nfunction f([(z)]) { return z; }\n// æ¥é\nfunction f([z,(x)]) { return x; }\n\n\n1\n2\n3\n4\n\n\nï¼3ï¼èµå¼è¯­å¥çæ¨¡å¼\n\n// å¨é¨æ¥é\n({ p: a }) = { p: 42 };\n([a]) = [5];\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç å°æ´ä¸ªæ¨¡å¼æ¾å¨åæ¬å·ä¹ä¸­ï¼å¯¼è´æ¥éã\n\n// æ¥é\n[({ p: a }), { x: c }] = [{}, {}];\n\n\n1\n2\n\n\nä¸é¢ä»£ç å°ä¸é¨åæ¨¡å¼æ¾å¨åæ¬å·ä¹ä¸­ï¼å¯¼è´æ¥éã\n\n\n# å¯ä»¥ä½¿ç¨åæ¬å·çæåµ\n\nå¯ä»¥ä½¿ç¨åæ¬å·çæåµåªæä¸ç§ï¼èµå¼è¯­å¥çéæ¨¡å¼é¨åï¼å¯ä»¥ä½¿ç¨åæ¬å·ã\n\n[(b)] = [3]; // æ­£ç¡®\n({ p: (d) } = {}); // æ­£ç¡®\n[(parseInt.prop)] = [3]; // æ­£ç¡®\n\n\n1\n2\n3\n\n\nä¸é¢ä¸è¡è¯­å¥é½å¯ä»¥æ­£ç¡®æ§è¡ï¼å ä¸ºé¦åå®ä»¬é½æ¯èµå¼è¯­å¥ï¼èä¸æ¯å£°æè¯­å¥ï¼å¶æ¬¡å®ä»¬çåæ¬å·é½ä¸å±äºæ¨¡å¼çä¸é¨åãç¬¬ä¸è¡è¯­å¥ä¸­ï¼æ¨¡å¼æ¯åæ°ç»çç¬¬ä¸ä¸ªæåï¼è·åæ¬å·æ å³ï¼ç¬¬äºè¡è¯­å¥ä¸­ï¼æ¨¡å¼æ¯pï¼èä¸æ¯dï¼ç¬¬ä¸è¡è¯­å¥ä¸ç¬¬ä¸è¡è¯­å¥çæ§è´¨ä¸è´ã\n\n\n# ç¨é\n\nåéçè§£æèµå¼ç¨éå¾å¤ã\n\nï¼1ï¼äº¤æ¢åéçå¼\n\nlet x = 1;\nlet y = 2;\n\n[x, y] = [y, x];\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç äº¤æ¢åéxåyçå¼ï¼è¿æ ·çåæ³ä¸ä»ç®æ´ï¼èä¸æè¯»ï¼è¯­ä¹éå¸¸æ¸æ°ã\n\nï¼2ï¼ä»å½æ°è¿åå¤ä¸ªå¼\n\nå½æ°åªè½è¿åä¸ä¸ªå¼ï¼å¦æè¦è¿åå¤ä¸ªå¼ï¼åªè½å°å®ä»¬æ¾å¨æ°ç»æå¯¹è±¡éè¿åãæäºè§£æèµå¼ï¼ååºè¿äºå¼å°±éå¸¸æ¹ä¾¿ã\n\n// è¿åä¸ä¸ªæ°ç»\n\nfunction example() {\n  return [1, 2, 3];\n}\nlet [a, b, c] = example();\n\n// è¿åä¸ä¸ªå¯¹è±¡\n\nfunction example() {\n  return {\n    foo: 1,\n    bar: 2\n  };\n}\nlet { foo, bar } = example();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nï¼3ï¼å½æ°åæ°çå®ä¹\n\nè§£æèµå¼å¯ä»¥æ¹ä¾¿å°å°ä¸ç»åæ°ä¸åéåå¯¹åºèµ·æ¥ã\n\n// åæ°æ¯ä¸ç»ææ¬¡åºçå¼\nfunction f([x, y, z]) { ... }\nf([1, 2, 3]);\n\n// åæ°æ¯ä¸ç»æ æ¬¡åºçå¼\nfunction f({x, y, z}) { ... }\nf({z: 3, y: 2, x: 1});\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nï¼4ï¼æå JSON æ°æ®\n\nè§£æèµå¼å¯¹æå JSON å¯¹è±¡ä¸­çæ°æ®ï¼å°¤å¶æç¨ã\n\nlet jsonData = {\n  id: 42,\n  status: \"OK\",\n  data: [867, 5309]\n};\n\nlet { id, status, data: number } = jsonData;\n\nconsole.log(id, status, number);\n// 42, \"OK\", [867, 5309]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å¯ä»¥å¿«éæå JSON æ°æ®çå¼ã\n\nï¼5ï¼å½æ°åæ°çé»è®¤å¼\n\njQuery.ajax = function (url, {\n  async = true,\n  beforeSend = function () {},\n  cache = true,\n  complete = function () {},\n  crossDomain = false,\n  global = true,\n  // ... more config\n} = {}) {\n  // ... do stuff\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\næå®åæ°çé»è®¤å¼ï¼å°±é¿åäºå¨å½æ°ä½åé¨ååvar foo = config.foo || 'default foo';è¿æ ·çè¯­å¥ã\n\nï¼6ï¼éå Map ç»æ\n\nä»»ä½é¨ç½²äº Iterator æ¥å£çå¯¹è±¡ï¼é½å¯ä»¥ç¨for...ofå¾ªç¯éåãMap ç»æåçæ¯æ Iterator æ¥å£ï¼éååéçè§£æèµå¼ï¼è·åé®ååé®å¼å°±éå¸¸æ¹ä¾¿ã\n\nconst map = new Map();\nmap.set('first', 'hello');\nmap.set('second', 'world');\n\nfor (let [key, value] of map) {\n  console.log(key + \" is \" + value);\n}\n// first is hello\n// second is world\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦æåªæ³è·åé®åï¼æèåªæ³è·åé®å¼ï¼å¯ä»¥åæä¸é¢è¿æ ·ã\n\n// è·åé®å\nfor (let [key] of map) {\n  // ...\n}\n\n// è·åé®å¼\nfor (let [,value] of map) {\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nï¼7ï¼è¾å¥æ¨¡åçæå®æ¹æ³\n\nå è½½æ¨¡åæ¶ï¼å¾å¾éè¦æå®è¾å¥åªäºæ¹æ³ãè§£æèµå¼ä½¿å¾è¾å¥è¯­å¥éå¸¸æ¸æ°ã\n\nconst { SourceMapConsumer, SourceNode } = require(\"source-map\");\n\n\n1\n",normalizedContent:"# åéçè§£æèµå¼\n\n\n# æ°ç»çè§£æèµå¼\n\n\n# åºæ¬ç¨æ³\n\nes6 åè®¸æç§ä¸å®æ¨¡å¼ï¼ä»æ°ç»åå¯¹è±¡ä¸­æåå¼ï¼å¯¹åéè¿è¡èµå¼ï¼è¿è¢«ç§°ä¸ºè§£æï¼destructuringï¼ã\n\nä»¥åï¼ä¸ºåéèµå¼ï¼åªè½ç´æ¥æå®å¼ã\n\nlet a = 1;\nlet b = 2;\nlet c = 3;\n\n\n1\n2\n3\n\n\nes6 åè®¸åæä¸é¢è¿æ ·ã\n\nlet [a, b, c] = [1, 2, 3];\n\n\n1\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼å¯ä»¥ä»æ°ç»ä¸­æåå¼ï¼æç§å¯¹åºä½ç½®ï¼å¯¹åéèµå¼ã\n\næ¬è´¨ä¸ï¼è¿ç§åæ³å±äºâæ¨¡å¼å¹éâï¼åªè¦ç­å·ä¸¤è¾¹çæ¨¡å¼ç¸åï¼å·¦è¾¹çåéå°±ä¼è¢«èµäºå¯¹åºçå¼ãä¸é¢æ¯ä¸äºä½¿ç¨åµå¥æ°ç»è¿è¡è§£æçä¾å­ã\n\nlet [foo, [[bar], baz]] = [1, [[2], 3]];\nfoo // 1\nbar // 2\nbaz // 3\n\nlet [ , , third] = [\"foo\", \"bar\", \"baz\"];\nthird // \"baz\"\n\nlet [x, , y] = [1, 2, 3];\nx // 1\ny // 3\n\nlet [head, ...tail] = [1, 2, 3, 4];\nhead // 1\ntail // [2, 3, 4]\n\nlet [x, y, ...z] = ['a'];\nx // \"a\"\ny // undefined\nz // []\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nå¦æè§£æä¸æåï¼åéçå¼å°±ç­äºundefinedã\n\nlet [foo] = [];\nlet [bar, foo] = [1];\n\n\n1\n2\n\n\nä»¥ä¸ä¸¤ç§æåµé½å±äºè§£æä¸æåï¼fooçå¼é½ä¼ç­äºundefinedã\n\nå¦ä¸ç§æåµæ¯ä¸å®å¨è§£æï¼å³ç­å·å·¦è¾¹çæ¨¡å¼ï¼åªå¹éä¸é¨åçç­å·å³è¾¹çæ°ç»ãè¿ç§æåµä¸ï¼è§£æä¾ç¶å¯ä»¥æåã\n\nlet [x, y] = [1, 2, 3];\nx // 1\ny // 2\n\nlet [a, [b], d] = [1, [2, 3], 4];\na // 1\nb // 2\nd // 4\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä¸¤ä¸ªä¾å­ï¼é½å±äºä¸å®å¨è§£æï¼ä½æ¯å¯ä»¥æåã\n\nå¦æç­å·çå³è¾¹ä¸æ¯æ°ç»ï¼æèä¸¥æ ¼å°è¯´ï¼ä¸æ¯å¯éåçç»æï¼åè§ãiteratorãä¸ç« ï¼ï¼é£ä¹å°ä¼æ¥éã\n\n// æ¥é\nlet [foo] = 1;\nlet [foo] = false;\nlet [foo] = nan;\nlet [foo] = undefined;\nlet [foo] = null;\nlet [foo] = {};\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢çè¯­å¥é½ä¼æ¥éï¼å ä¸ºç­å·å³è¾¹çå¼ï¼è¦ä¹è½¬ä¸ºå¯¹è±¡ä»¥åä¸å·å¤ iterator æ¥å£ï¼åäºä¸ªè¡¨è¾¾å¼ï¼ï¼è¦ä¹æ¬èº«å°±ä¸å·å¤ iterator æ¥å£ï¼æåä¸ä¸ªè¡¨è¾¾å¼ï¼ã\n\nå¯¹äº set ç»æï¼ä¹å¯ä»¥ä½¿ç¨æ°ç»çè§£æèµå¼ã\n\nlet [x, y, z] = new set(['a', 'b', 'c']);\nx // \"a\"\n\n\n1\n2\n\n\näºå®ä¸ï¼åªè¦æç§æ°æ®ç»æå·æ iterator æ¥å£ï¼é½å¯ä»¥éç¨æ°ç»å½¢å¼çè§£æèµå¼ã\n\nfunction* fibs() {\n  let a = 0;\n  let b = 1;\n  while (true) {\n    yield a;\n    [a, b] = [b, a + b];\n  }\n}\n\nlet [first, second, third, fourth, fifth, sixth] = fibs();\nsixth // 5\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼fibsæ¯ä¸ä¸ª generator å½æ°ï¼åè§ãgenerator å½æ°ãä¸ç« ï¼ï¼åçå·æ iterator æ¥å£ãè§£æèµå¼ä¼ä¾æ¬¡ä»è¿ä¸ªæ¥å£è·åå¼ã\n\n\n# é»è®¤å¼\n\nè§£æèµå¼åè®¸æå®é»è®¤å¼ã\n\nlet [foo = true] = [];\nfoo // true\n\nlet [x, y = 'b'] = ['a']; // x='a', y='b'\nlet [x, y = 'b'] = ['a', undefined]; // x='a', y='b'\n\n\n1\n2\n3\n4\n5\n\n\næ³¨æï¼es6 åé¨ä½¿ç¨ä¸¥æ ¼ç¸ç­è¿ç®ç¬¦ï¼===ï¼ï¼å¤æ­ä¸ä¸ªä½ç½®æ¯å¦æå¼ãæä»¥ï¼åªæ å½ä¸ä¸ªæ°ç»æåä¸¥æ ¼ç­äºundefinedï¼é»è®¤å¼æä¼çæã\n\nlet [x = 1] = [undefined];\nx // 1\n\nlet [x = 1] = [null];\nx // null\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æä¸ä¸ªæ°ç»æåæ¯nullï¼é»è®¤å¼å°±ä¸ä¼çæï¼å ä¸ºnullä¸ä¸¥æ ¼ç­äºundefinedã\n\nå¦æé»è®¤å¼æ¯ä¸ä¸ªè¡¨è¾¾å¼ï¼é£ä¹è¿ä¸ªè¡¨è¾¾å¼æ¯æ°æ§æ±å¼çï¼å³åªæå¨ç¨å°çæ¶åï¼æä¼æ±å¼ã\n\nfunction f() {\n  console.log('aaa');\n}\n\nlet [x = f()] = [1];\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å ä¸ºxè½åå°å¼ï¼æä»¥å½æ°fæ ¹æ¬ä¸ä¼æ§è¡ãä¸é¢çä»£ç å¶å®ç­ä»·äºä¸é¢çä»£ç ã\n\nlet x;\nif ([1][0] === undefined) {\n  x = f();\n} else {\n  x = [1][0];\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\né»è®¤å¼å¯ä»¥å¼ç¨è§£æèµå¼çå¶ä»åéï¼ä½è¯¥åéå¿é¡»å·²ç»å£°æã\n\nlet [x = 1, y = x] = [];     // x=1; y=1\nlet [x = 1, y = x] = [2];    // x=2; y=2\nlet [x = 1, y = x] = [1, 2]; // x=1; y=2\nlet [x = y, y = 1] = [];     // referenceerror: y is not defined\n\n\n1\n2\n3\n4\n\n\nä¸é¢æåä¸ä¸ªè¡¨è¾¾å¼ä¹æä»¥ä¼æ¥éï¼æ¯å ä¸ºxç¨yåé»è®¤å¼æ¶ï¼yè¿æ²¡æå£°æã\n\n\n# å¯¹è±¡çè§£æèµå¼\n\n\n# ç®ä»\n\nè§£æä¸ä»å¯ä»¥ç¨äºæ°ç»ï¼è¿å¯ä»¥ç¨äºå¯¹è±¡ã\n\nlet { foo, bar } = { foo: 'aaa', bar: 'bbb' };\nfoo // \"aaa\"\nbar // \"bbb\"\n\n\n1\n2\n3\n\n\nå¯¹è±¡çè§£æä¸æ°ç»æä¸ä¸ªéè¦çä¸åãæ°ç»çåç´ æ¯ææ¬¡åºæåçï¼åéçåå¼ç±å®çä½ç½®å³å®ï¼èå¯¹è±¡çå±æ§æ²¡ææ¬¡åºï¼åéå¿é¡»ä¸å±æ§ååï¼æè½åå°æ­£ç¡®çå¼ã\n\nlet { bar, foo } = { foo: 'aaa', bar: 'bbb' };\nfoo // \"aaa\"\nbar // \"bbb\"\n\nlet { baz } = { foo: 'aaa', bar: 'bbb' };\nbaz // undefined\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çç¬¬ä¸ä¸ªä¾å­ï¼ç­å·å·¦è¾¹çä¸¤ä¸ªåéçæ¬¡åºï¼ä¸ç­å·å³è¾¹ä¸¤ä¸ªååå±æ§çæ¬¡åºä¸ä¸è´ï¼ä½æ¯å¯¹åå¼å®å¨æ²¡æå½±åãç¬¬äºä¸ªä¾å­çåéæ²¡æå¯¹åºçååå±æ§ï¼å¯¼è´åä¸å°å¼ï¼æåç­äºundefinedã\n\nå¦æè§£æå¤±è´¥ï¼åéçå¼ç­äºundefinedã\n\nlet {foo} = {bar: 'baz'};\nfoo // undefined\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼ç­å·å³è¾¹çå¯¹è±¡æ²¡æfooå±æ§ï¼æä»¥åéfooåä¸å°å¼ï¼æä»¥ç­äºundefinedã\n\nå¯¹è±¡çè§£æèµå¼ï¼å¯ä»¥å¾æ¹ä¾¿å°å°ç°æå¯¹è±¡çæ¹æ³ï¼èµå¼å°æä¸ªåéã\n\n// ä¾ä¸\nlet { log, sin, cos } = math;\n\n// ä¾äº\nconst { log } = console;\nlog('hello') // hello\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çä¾ä¸å°mathå¯¹è±¡çå¯¹æ°ãæ­£å¼¦ãä½å¼¦ä¸ä¸ªæ¹æ³ï¼èµå¼å°å¯¹åºçåéä¸ï¼ä½¿ç¨èµ·æ¥å°±ä¼æ¹ä¾¿å¾å¤ãä¾äºå°console.logèµå¼å°logåéã\n\nå¦æåéåä¸å±æ§åä¸ä¸è´ï¼å¿é¡»åæä¸é¢è¿æ ·ã\n\nlet { foo: baz } = { foo: 'aaa', bar: 'bbb' };\nbaz // \"aaa\"\n\nlet obj = { first: 'hello', last: 'world' };\nlet { first: f, last: l } = obj;\nf // 'hello'\nl // 'world'\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¿å®éä¸è¯´æï¼å¯¹è±¡çè§£æèµå¼æ¯ä¸é¢å½¢å¼çç®åï¼åè§ãå¯¹è±¡çæ©å±ãä¸ç« ï¼ã\n\nlet { foo: foo, bar: bar } = { foo: 'aaa', bar: 'bbb' };\n\n\n1\n\n\nä¹å°±æ¯è¯´ï¼å¯¹è±¡çè§£æèµå¼çåé¨æºå¶ï¼æ¯åæ¾å°ååå±æ§ï¼ç¶ååèµç»å¯¹åºçåéãçæ­£è¢«èµå¼çæ¯åèï¼èä¸æ¯åèã\n\nlet { foo: baz } = { foo: 'aaa', bar: 'bbb' };\nbaz // \"aaa\"\nfoo // error: foo is not defined\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼fooæ¯å¹éçæ¨¡å¼ï¼bazææ¯åéãçæ­£è¢«èµå¼çæ¯åébazï¼èä¸æ¯æ¨¡å¼fooã\n\nä¸æ°ç»ä¸æ ·ï¼è§£æä¹å¯ä»¥ç¨äºåµå¥ç»æçå¯¹è±¡ã\n\nlet obj = {\n  p: [\n    'hello',\n    { y: 'world' }\n  ]\n};\n\nlet { p: [x, { y }] } = obj;\nx // \"hello\"\ny // \"world\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\næ³¨æï¼è¿æ¶pæ¯æ¨¡å¼ï¼ä¸æ¯åéï¼å æ­¤ä¸ä¼è¢«èµå¼ãå¦æpä¹è¦ä½ä¸ºåéèµå¼ï¼å¯ä»¥åæä¸é¢è¿æ ·ã\n\nlet obj = {\n  p: [\n    'hello',\n    { y: 'world' }\n  ]\n};\n\nlet { p, p: [x, { y }] } = obj;\nx // \"hello\"\ny // \"world\"\np // [\"hello\", {y: \"world\"}]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nconst node = {\n  loc: {\n    start: {\n      line: 1,\n      column: 5\n    }\n  }\n};\n\nlet { loc, loc: { start }, loc: { start: { line }} } = node;\nline // 1\nloc  // object {start: object}\nstart // object {line: 1, column: 5}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç æä¸æ¬¡è§£æèµå¼ï¼åå«æ¯å¯¹locãstartãlineä¸ä¸ªå±æ§çè§£æèµå¼ãæ³¨æï¼æåä¸æ¬¡å¯¹lineå±æ§çè§£æèµå¼ä¹ä¸­ï¼åªælineæ¯åéï¼locåstarté½æ¯æ¨¡å¼ï¼ä¸æ¯åéã\n\nä¸é¢æ¯åµå¥èµå¼çä¾å­ã\n\nlet obj = {};\nlet arr = [];\n\n({ foo: obj.prop, bar: arr[0] } = { foo: 123, bar: true });\n\nobj // {prop:123}\narr // [true]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦æè§£ææ¨¡å¼æ¯åµå¥çå¯¹è±¡ï¼èä¸å­å¯¹è±¡æå¨çç¶å±æ§ä¸å­å¨ï¼é£ä¹å°ä¼æ¥éã\n\n// æ¥é\nlet {foo: {bar}} = {baz: 'baz'};\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼ç­å·å·¦è¾¹å¯¹è±¡çfooå±æ§ï¼å¯¹åºä¸ä¸ªå­å¯¹è±¡ãè¯¥å­å¯¹è±¡çbarå±æ§ï¼è§£ææ¶ä¼æ¥éãåå å¾ç®åï¼å ä¸ºfooè¿æ¶ç­äºundefinedï¼ååå­å±æ§å°±ä¼æ¥éã\n\næ³¨æï¼å¯¹è±¡çè§£æèµå¼å¯ä»¥åå°ç»§æ¿çå±æ§ã\n\nconst obj1 = {};\nconst obj2 = { foo: 'bar' };\nobject.setprototypeof(obj1, obj2);\n\nconst { foo } = obj1;\nfoo // \"bar\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯¹è±¡obj1çååå¯¹è±¡æ¯obj2ãfooå±æ§ä¸æ¯obj1èªèº«çå±æ§ï¼èæ¯ç»§æ¿èªobj2çå±æ§ï¼è§£æèµå¼å¯ä»¥åå°è¿ä¸ªå±æ§ã\n\n\n# é»è®¤å¼\n\nå¯¹è±¡çè§£æä¹å¯ä»¥æå®é»è®¤å¼ã\n\nvar {x = 3} = {};\nx // 3\n\nvar {x, y = 5} = {x: 1};\nx // 1\ny // 5\n\nvar {x: y = 3} = {};\ny // 3\n\nvar {x: y = 3} = {x: 5};\ny // 5\n\nvar { message: msg = 'something went wrong' } = {};\nmsg // \"something went wrong\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\né»è®¤å¼çæçæ¡ä»¶æ¯ï¼å¯¹è±¡çå±æ§å¼ä¸¥æ ¼ç­äºundefinedã\n\nvar {x = 3} = {x: undefined};\nx // 3\n\nvar {x = 3} = {x: null};\nx // null\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å±æ§xç­äºnullï¼å ä¸ºnullä¸undefinedä¸ä¸¥æ ¼ç¸ç­ï¼æä»¥æ¯ä¸ªææçèµå¼ï¼å¯¼è´é»è®¤å¼3ä¸ä¼çæã\n\n\n# æ³¨æç¹\n\nï¼1ï¼å¦æè¦å°ä¸ä¸ªå·²ç»å£°æçåéç¨äºè§£æèµå¼ï¼å¿é¡»éå¸¸å°å¿ã\n\n// éè¯¯çåæ³\nlet x;\n{x} = {x: 1};\n// syntaxerror: syntax error\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç çåæ³ä¼æ¥éï¼å ä¸º javascript å¼æä¼å°{x}çè§£æä¸ä¸ªä»£ç åï¼ä»èåçè¯­æ³éè¯¯ãåªæä¸å°å¤§æ¬å·åå¨è¡é¦ï¼é¿å javascript å°å¶è§£éä¸ºä»£ç åï¼æè½è§£å³è¿ä¸ªé®é¢ã\n\n// æ­£ç¡®çåæ³\nlet x;\n({x} = {x: 1});\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç å°æ´ä¸ªè§£æèµå¼è¯­å¥ï¼æ¾å¨ä¸ä¸ªåæ¬å·éé¢ï¼å°±å¯ä»¥æ­£ç¡®æ§è¡ãå³äºåæ¬å·ä¸è§£æèµå¼çå³ç³»ï¼åè§ä¸æã\n\nï¼2ï¼è§£æèµå¼åè®¸ç­å·å·¦è¾¹çæ¨¡å¼ä¹ä¸­ï¼ä¸æ¾ç½®ä»»ä½åéåãå æ­¤ï¼å¯ä»¥ååºéå¸¸å¤æªçèµå¼è¡¨è¾¾å¼ã\n\n({} = [true, false]);\n({} = 'abc');\n({} = []);\n\n\n1\n2\n3\n\n\nä¸é¢çè¡¨è¾¾å¼è½ç¶æ¯«æ æä¹ï¼ä½æ¯è¯­æ³æ¯åæ³çï¼å¯ä»¥æ§è¡ã\n\nï¼3ï¼ç±äºæ°ç»æ¬è´¨æ¯ç¹æ®çå¯¹è±¡ï¼å æ­¤å¯ä»¥å¯¹æ°ç»è¿è¡å¯¹è±¡å±æ§çè§£æã\n\nlet arr = [1, 2, 3];\nlet {0 : first, [arr.length - 1] : last} = arr;\nfirst // 1\nlast // 3\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç å¯¹æ°ç»è¿è¡å¯¹è±¡è§£æãæ°ç»arrç0é®å¯¹åºçå¼æ¯1ï¼[arr.length - 1]å°±æ¯2é®ï¼å¯¹åºçå¼æ¯3ãæ¹æ¬å·è¿ç§åæ³ï¼å±äºâå±æ§åè¡¨è¾¾å¼âï¼åè§ãå¯¹è±¡çæ©å±ãä¸ç« ï¼ã\n\n\n# å­ç¬¦ä¸²çè§£æèµå¼\n\nå­ç¬¦ä¸²ä¹å¯ä»¥è§£æèµå¼ãè¿æ¯å ä¸ºæ­¤æ¶ï¼å­ç¬¦ä¸²è¢«è½¬æ¢æäºä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ã\n\nconst [a, b, c, d, e] = 'hello';\na // \"h\"\nb // \"e\"\nc // \"l\"\nd // \"l\"\ne // \"o\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nç±»ä¼¼æ°ç»çå¯¹è±¡é½æä¸ä¸ªlengthå±æ§ï¼å æ­¤è¿å¯ä»¥å¯¹è¿ä¸ªå±æ§è§£æèµå¼ã\n\nlet {length : len} = 'hello';\nlen // 5\n\n\n1\n2\n\n\n\n# æ°å¼åå¸å°å¼çè§£æèµå¼\n\nè§£æèµå¼æ¶ï¼å¦æç­å·å³è¾¹æ¯æ°å¼åå¸å°å¼ï¼åä¼åè½¬ä¸ºå¯¹è±¡ã\n\nlet {tostring: s} = 123;\ns === number.prototype.tostring // true\n\nlet {tostring: s} = true;\ns === boolean.prototype.tostring // true\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°å¼åå¸å°å¼çåè£å¯¹è±¡é½ætostringå±æ§ï¼å æ­¤åésé½è½åå°å¼ã\n\nè§£æèµå¼çè§åæ¯ï¼åªè¦ç­å·å³è¾¹çå¼ä¸æ¯å¯¹è±¡ææ°ç»ï¼å°±åå°å¶è½¬ä¸ºå¯¹è±¡ãç±äºundefinedånullæ æ³è½¬ä¸ºå¯¹è±¡ï¼æä»¥å¯¹å®ä»¬è¿è¡è§£æèµå¼ï¼é½ä¼æ¥éã\n\nlet { prop: x } = undefined; // typeerror\nlet { prop: y } = null; // typeerror\n\n\n1\n2\n\n\n\n# å½æ°åæ°çè§£æèµå¼\n\nå½æ°çåæ°ä¹å¯ä»¥ä½¿ç¨è§£æèµå¼ã\n\nfunction add([x, y]){\n  return x + y;\n}\n\nadd([1, 2]); // 3\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°addçåæ°è¡¨é¢ä¸æ¯ä¸ä¸ªæ°ç»ï¼ä½å¨ä¼ å¥åæ°çé£ä¸å»ï¼æ°ç»åæ°å°±è¢«è§£ææåéxåyãå¯¹äºå½æ°åé¨çä»£ç æ¥è¯´ï¼å®ä»¬è½æåå°çåæ°å°±æ¯xåyã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\n[[1, 2], [3, 4]].map(([a, b]) => a + b);\n// [ 3, 7 ]\n\n\n1\n2\n\n\nå½æ°åæ°çè§£æä¹å¯ä»¥ä½¿ç¨é»è®¤å¼ã\n\nfunction move({x = 0, y = 0} = {}) {\n  return [x, y];\n}\n\nmove({x: 3, y: 8}); // [3, 8]\nmove({x: 3}); // [3, 0]\nmove({}); // [0, 0]\nmove(); // [0, 0]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°moveçåæ°æ¯ä¸ä¸ªå¯¹è±¡ï¼éè¿å¯¹è¿ä¸ªå¯¹è±¡è¿è¡è§£æï¼å¾å°åéxåyçå¼ãå¦æè§£æå¤±è´¥ï¼xåyç­äºé»è®¤å¼ã\n\næ³¨æï¼ä¸é¢çåæ³ä¼å¾å°ä¸ä¸æ ·çç»æã\n\nfunction move({x, y} = { x: 0, y: 0 }) {\n  return [x, y];\n}\n\nmove({x: 3, y: 8}); // [3, 8]\nmove({x: 3}); // [3, undefined]\nmove({}); // [undefined, undefined]\nmove(); // [0, 0]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç æ¯ä¸ºå½æ°moveçåæ°æå®é»è®¤å¼ï¼èä¸æ¯ä¸ºåéxåyæå®é»è®¤å¼ï¼æä»¥ä¼å¾å°ä¸åä¸ç§åæ³ä¸åçç»æã\n\nundefinedå°±ä¼è§¦åå½æ°åæ°çé»è®¤å¼ã\n\n[1, undefined, 3].map((x = 'yes') => x);\n// [ 1, 'yes', 3 ]\n\n\n1\n2\n\n\n\n# åæ¬å·é®é¢\n\nè§£æèµå¼è½ç¶å¾æ¹ä¾¿ï¼ä½æ¯è§£æèµ·æ¥å¹¶ä¸å®¹æãå¯¹äºç¼è¯å¨æ¥è¯´ï¼ä¸ä¸ªå¼å­å°åºæ¯æ¨¡å¼ï¼è¿æ¯è¡¨è¾¾å¼ï¼æ²¡æåæ³ä»ä¸å¼å§å°±ç¥éï¼å¿é¡»è§£æå°ï¼æè§£æä¸å°ï¼ç­å·æè½ç¥éã\n\nç±æ­¤å¸¦æ¥çé®é¢æ¯ï¼å¦ææ¨¡å¼ä¸­åºç°åæ¬å·æä¹å¤çães6 çè§åæ¯ï¼åªè¦æå¯è½å¯¼è´è§£æçæ­§ä¹ï¼å°±ä¸å¾ä½¿ç¨åæ¬å·ã\n\nä½æ¯ï¼è¿æ¡è§åå®éä¸ä¸é£ä¹å®¹æè¾¨å«ï¼å¤çèµ·æ¥ç¸å½éº»ç¦ãå æ­¤ï¼å»ºè®®åªè¦æå¯è½ï¼å°±ä¸è¦å¨æ¨¡å¼ä¸­æ¾ç½®åæ¬å·ã\n\n\n# ä¸è½ä½¿ç¨åæ¬å·çæåµ\n\nä»¥ä¸ä¸ç§è§£æèµå¼ä¸å¾ä½¿ç¨åæ¬å·ã\n\nï¼1ï¼åéå£°æè¯­å¥\n\n// å¨é¨æ¥é\nlet [(a)] = [1];\n\nlet {x: (c)} = {};\nlet ({x: c}) = {};\nlet {(x: c)} = {};\nlet {(x): c} = {};\n\nlet { o: ({ p: p }) } = { o: { p: 2 } };\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ 6 ä¸ªè¯­å¥é½ä¼æ¥éï¼å ä¸ºå®ä»¬é½æ¯åéå£°æè¯­å¥ï¼æ¨¡å¼ä¸è½ä½¿ç¨åæ¬å·ã\n\nï¼2ï¼å½æ°åæ°\n\nå½æ°åæ°ä¹å±äºåéå£°æï¼å æ­¤ä¸è½å¸¦æåæ¬å·ã\n\n// æ¥é\nfunction f([(z)]) { return z; }\n// æ¥é\nfunction f([z,(x)]) { return x; }\n\n\n1\n2\n3\n4\n\n\nï¼3ï¼èµå¼è¯­å¥çæ¨¡å¼\n\n// å¨é¨æ¥é\n({ p: a }) = { p: 42 };\n([a]) = [5];\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç å°æ´ä¸ªæ¨¡å¼æ¾å¨åæ¬å·ä¹ä¸­ï¼å¯¼è´æ¥éã\n\n// æ¥é\n[({ p: a }), { x: c }] = [{}, {}];\n\n\n1\n2\n\n\nä¸é¢ä»£ç å°ä¸é¨åæ¨¡å¼æ¾å¨åæ¬å·ä¹ä¸­ï¼å¯¼è´æ¥éã\n\n\n# å¯ä»¥ä½¿ç¨åæ¬å·çæåµ\n\nå¯ä»¥ä½¿ç¨åæ¬å·çæåµåªæä¸ç§ï¼èµå¼è¯­å¥çéæ¨¡å¼é¨åï¼å¯ä»¥ä½¿ç¨åæ¬å·ã\n\n[(b)] = [3]; // æ­£ç¡®\n({ p: (d) } = {}); // æ­£ç¡®\n[(parseint.prop)] = [3]; // æ­£ç¡®\n\n\n1\n2\n3\n\n\nä¸é¢ä¸è¡è¯­å¥é½å¯ä»¥æ­£ç¡®æ§è¡ï¼å ä¸ºé¦åå®ä»¬é½æ¯èµå¼è¯­å¥ï¼èä¸æ¯å£°æè¯­å¥ï¼å¶æ¬¡å®ä»¬çåæ¬å·é½ä¸å±äºæ¨¡å¼çä¸é¨åãç¬¬ä¸è¡è¯­å¥ä¸­ï¼æ¨¡å¼æ¯åæ°ç»çç¬¬ä¸ä¸ªæåï¼è·åæ¬å·æ å³ï¼ç¬¬äºè¡è¯­å¥ä¸­ï¼æ¨¡å¼æ¯pï¼èä¸æ¯dï¼ç¬¬ä¸è¡è¯­å¥ä¸ç¬¬ä¸è¡è¯­å¥çæ§è´¨ä¸è´ã\n\n\n# ç¨é\n\nåéçè§£æèµå¼ç¨éå¾å¤ã\n\nï¼1ï¼äº¤æ¢åéçå¼\n\nlet x = 1;\nlet y = 2;\n\n[x, y] = [y, x];\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç äº¤æ¢åéxåyçå¼ï¼è¿æ ·çåæ³ä¸ä»ç®æ´ï¼èä¸æè¯»ï¼è¯­ä¹éå¸¸æ¸æ°ã\n\nï¼2ï¼ä»å½æ°è¿åå¤ä¸ªå¼\n\nå½æ°åªè½è¿åä¸ä¸ªå¼ï¼å¦æè¦è¿åå¤ä¸ªå¼ï¼åªè½å°å®ä»¬æ¾å¨æ°ç»æå¯¹è±¡éè¿åãæäºè§£æèµå¼ï¼ååºè¿äºå¼å°±éå¸¸æ¹ä¾¿ã\n\n// è¿åä¸ä¸ªæ°ç»\n\nfunction example() {\n  return [1, 2, 3];\n}\nlet [a, b, c] = example();\n\n// è¿åä¸ä¸ªå¯¹è±¡\n\nfunction example() {\n  return {\n    foo: 1,\n    bar: 2\n  };\n}\nlet { foo, bar } = example();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nï¼3ï¼å½æ°åæ°çå®ä¹\n\nè§£æèµå¼å¯ä»¥æ¹ä¾¿å°å°ä¸ç»åæ°ä¸åéåå¯¹åºèµ·æ¥ã\n\n// åæ°æ¯ä¸ç»ææ¬¡åºçå¼\nfunction f([x, y, z]) { ... }\nf([1, 2, 3]);\n\n// åæ°æ¯ä¸ç»æ æ¬¡åºçå¼\nfunction f({x, y, z}) { ... }\nf({z: 3, y: 2, x: 1});\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nï¼4ï¼æå json æ°æ®\n\nè§£æèµå¼å¯¹æå json å¯¹è±¡ä¸­çæ°æ®ï¼å°¤å¶æç¨ã\n\nlet jsondata = {\n  id: 42,\n  status: \"ok\",\n  data: [867, 5309]\n};\n\nlet { id, status, data: number } = jsondata;\n\nconsole.log(id, status, number);\n// 42, \"ok\", [867, 5309]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å¯ä»¥å¿«éæå json æ°æ®çå¼ã\n\nï¼5ï¼å½æ°åæ°çé»è®¤å¼\n\njquery.ajax = function (url, {\n  async = true,\n  beforesend = function () {},\n  cache = true,\n  complete = function () {},\n  crossdomain = false,\n  global = true,\n  // ... more config\n} = {}) {\n  // ... do stuff\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\næå®åæ°çé»è®¤å¼ï¼å°±é¿åäºå¨å½æ°ä½åé¨ååvar foo = config.foo || 'default foo';è¿æ ·çè¯­å¥ã\n\nï¼6ï¼éå map ç»æ\n\nä»»ä½é¨ç½²äº iterator æ¥å£çå¯¹è±¡ï¼é½å¯ä»¥ç¨for...ofå¾ªç¯éåãmap ç»æåçæ¯æ iterator æ¥å£ï¼éååéçè§£æèµå¼ï¼è·åé®ååé®å¼å°±éå¸¸æ¹ä¾¿ã\n\nconst map = new map();\nmap.set('first', 'hello');\nmap.set('second', 'world');\n\nfor (let [key, value] of map) {\n  console.log(key + \" is \" + value);\n}\n// first is hello\n// second is world\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦æåªæ³è·åé®åï¼æèåªæ³è·åé®å¼ï¼å¯ä»¥åæä¸é¢è¿æ ·ã\n\n// è·åé®å\nfor (let [key] of map) {\n  // ...\n}\n\n// è·åé®å¼\nfor (let [,value] of map) {\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nï¼7ï¼è¾å¥æ¨¡åçæå®æ¹æ³\n\nå è½½æ¨¡åæ¶ï¼å¾å¾éè¦æå®è¾å¥åªäºæ¹æ³ãè§£æèµå¼ä½¿å¾è¾å¥è¯­å¥éå¸¸æ¸æ°ã\n\nconst { sourcemapconsumer, sourcenode } = require(\"source-map\");\n\n\n1\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"å­ç¬¦ä¸²çæ°å¢æ¹æ³",frontmatter:{title:"å­ç¬¦ä¸²çæ°å¢æ¹æ³",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/a650b4a0ebfc9350",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/05.%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%96%B0%E5%A2%9E%E6%96%B9%E6%B3%95.html",relativePath:"ãES6 æç¨ãç¬è®°/05.å­ç¬¦ä¸²çæ°å¢æ¹æ³.md",key:"v-4d3a6db4",path:"/pages/a650b4a0ebfc9350/",headers:[{level:2,title:"String.fromCodePoint()",slug:"string-fromcodepoint",normalizedTitle:"string.fromcodepoint()",charIndex:32},{level:2,title:"String.raw()",slug:"string-raw",normalizedTitle:"string.raw()",charIndex:630},{level:2,title:"å®ä¾æ¹æ³ï¼codePointAt()",slug:"å®ä¾æ¹æ³-codepointat",normalizedTitle:"å®ä¾æ¹æ³ï¼codepointat()",charIndex:1613},{level:2,title:"å®ä¾æ¹æ³ï¼normalize()",slug:"å®ä¾æ¹æ³-normalize",normalizedTitle:"å®ä¾æ¹æ³ï¼normalize()",charIndex:3275},{level:2,title:"å®ä¾æ¹æ³ï¼includes() åå«, startsWith() å¤´é¨åå«, endsWith() æ«å°¾åå«",slug:"å®ä¾æ¹æ³-includes-åå«-startswith-å¤´é¨åå«-endswith-æ«å°¾åå«",normalizedTitle:"å®ä¾æ¹æ³ï¼includes() åå«, startswith() å¤´é¨åå«, endswith() æ«å°¾åå«",charIndex:4453},{level:2,title:"å®ä¾æ¹æ³ï¼repeat() éå¤",slug:"å®ä¾æ¹æ³-repeat-éå¤",normalizedTitle:"å®ä¾æ¹æ³ï¼repeat() éå¤",charIndex:5046},{level:2,title:"å®ä¾æ¹æ³ï¼padStart() è¡¥å¨å¤´é¨ï¼padEnd() è¡¥å¨æ«å°¾",slug:"å®ä¾æ¹æ³-padstart-è¡¥å¨å¤´é¨-padend-è¡¥å¨æ«å°¾",normalizedTitle:"å®ä¾æ¹æ³ï¼padstart() è¡¥å¨å¤´é¨ï¼padend() è¡¥å¨æ«å°¾",charIndex:5579},{level:2,title:"å®ä¾æ¹æ³ï¼trimStart() ä¿®åªå¤´é¨ï¼trimEnd() ä¿®åªæ«å°¾",slug:"å®ä¾æ¹æ³-trimstart-ä¿®åªå¤´é¨-trimend-ä¿®åªæ«å°¾",normalizedTitle:"å®ä¾æ¹æ³ï¼trimstart() ä¿®åªå¤´é¨ï¼trimend() ä¿®åªæ«å°¾",charIndex:6504},{level:2,title:"å®ä¾æ¹æ³ï¼matchAll()",slug:"å®ä¾æ¹æ³-matchall",normalizedTitle:"å®ä¾æ¹æ³ï¼matchall()",charIndex:6936}],excerpt:'<h1 id="å­ç¬¦ä¸²çæ°å¢æ¹æ³"><a class="header-anchor" href="#å­ç¬¦ä¸²çæ°å¢æ¹æ³">#</a> å­ç¬¦ä¸²çæ°å¢æ¹æ³</h1>\n<p>æ¬ç« ä»ç»å­ç¬¦ä¸²å¯¹è±¡çæ°å¢æ¹æ³ã</p>\n<h2 id="string-fromcodepoint"><a class="header-anchor" href="#string-fromcodepoint">#</a> String.fromCodePoint()</h2>\n<p>ES5 æä¾<code>String.fromCharCode()</code>æ¹æ³ï¼ç¨äºä» Unicode ç ç¹è¿åå¯¹åºå­ç¬¦ï¼ä½æ¯è¿ä¸ªæ¹æ³ä¸è½è¯å«ç ç¹å¤§äº<code>0xFFFF</code>çå­ç¬¦ã</p>\n\x3c!--beforebegin--\x3e<div class="language-javascript line-numbers-mode">\x3c!--afterbegin--\x3e<pre v-pre class="language-javascript"><code>String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span><span class="token number">0x20BB7</span><span class="token punctuation">)</span>\n<span class="token comment">// "à®·"</span>\n</code></pre>\n<div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div>\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e',headersStr:"String.fromCodePoint() String.raw() å®ä¾æ¹æ³ï¼codePointAt() å®ä¾æ¹æ³ï¼normalize() å®ä¾æ¹æ³ï¼includes() åå«, startsWith() å¤´é¨åå«, endsWith() æ«å°¾åå« å®ä¾æ¹æ³ï¼repeat() éå¤ å®ä¾æ¹æ³ï¼padStart() è¡¥å¨å¤´é¨ï¼padEnd() è¡¥å¨æ«å°¾ å®ä¾æ¹æ³ï¼trimStart() ä¿®åªå¤´é¨ï¼trimEnd() ä¿®åªæ«å°¾ å®ä¾æ¹æ³ï¼matchAll()",content:"# å­ç¬¦ä¸²çæ°å¢æ¹æ³\n\næ¬ç« ä»ç»å­ç¬¦ä¸²å¯¹è±¡çæ°å¢æ¹æ³ã\n\n\n# String.fromCodePoint()\n\nES5 æä¾String.fromCharCode()æ¹æ³ï¼ç¨äºä» Unicode ç ç¹è¿åå¯¹åºå­ç¬¦ï¼ä½æ¯è¿ä¸ªæ¹æ³ä¸è½è¯å«ç ç¹å¤§äº0xFFFFçå­ç¬¦ã\n\nString.fromCharCode(0x20BB7)\n// \"à®·\"\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼String.fromCharCode()ä¸è½è¯å«å¤§äº0xFFFFçç ç¹ï¼æä»¥0x20BB7å°±åçäºæº¢åºï¼æé«ä½2è¢«èå¼äºï¼æåè¿åç ç¹U+0BB7å¯¹åºçå­ç¬¦ï¼èä¸æ¯ç ç¹U+20BB7å¯¹åºçå­ç¬¦ã\n\nES6 æä¾äºString.fromCodePoint()æ¹æ³ï¼å¯ä»¥è¯å«å¤§äº0xFFFFçå­ç¬¦ï¼å¼¥è¡¥äºString.fromCharCode()æ¹æ³çä¸è¶³ãå¨ä½ç¨ä¸ï¼æ­£å¥½ä¸ä¸é¢çcodePointAt()æ¹æ³ç¸åã\n\nString.fromCodePoint(0x20BB7)\n// \"ð ®·\"\nString.fromCodePoint(0x78, 0x1f680, 0x79) === 'x\\uD83D\\uDE80y'\n// true\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æString.fromCodePointæ¹æ³æå¤ä¸ªåæ°ï¼åå®ä»¬ä¼è¢«åå¹¶æä¸ä¸ªå­ç¬¦ä¸²è¿åã\n\næ³¨æï¼fromCodePointæ¹æ³å®ä¹å¨Stringå¯¹è±¡ä¸ï¼ècodePointAtæ¹æ³å®ä¹å¨å­ç¬¦ä¸²çå®ä¾å¯¹è±¡ä¸ã\n\n\n# String.raw()\n\nES6 è¿ä¸ºåçç String å¯¹è±¡ï¼æä¾äºä¸ä¸ªraw()æ¹æ³ãè¯¥æ¹æ³è¿åä¸ä¸ªææ é½è¢«è½¬ä¹ï¼å³ææ åé¢åå ä¸ä¸ªææ ï¼çå­ç¬¦ä¸²ï¼å¾å¾ç¨äºæ¨¡æ¿å­ç¬¦ä¸²çå¤çæ¹æ³ã\n\nString.raw`Hi\\n${2+3}!`\n// å®éè¿å \"Hi\\\\n5!\"ï¼æ¾ç¤ºçæ¯è½¬ä¹åçç»æ \"Hi\\n5!\"\n\nString.raw`Hi\\u000A!`;\n// å®éè¿å \"Hi\\\\u000A!\"ï¼æ¾ç¤ºçæ¯è½¬ä¹åçç»æ \"Hi\\u000A!\"\n\n\n1\n2\n3\n4\n5\n\n\nå¦æåå­ç¬¦ä¸²çææ å·²ç»è½¬ä¹ï¼é£ä¹String.raw()ä¼è¿è¡åæ¬¡è½¬ä¹ã\n\nString.raw`Hi\\\\n`\n// è¿å \"Hi\\\\\\\\n\"\n\nString.raw`Hi\\\\n` === \"Hi\\\\\\\\n\" // true\n\n\n1\n2\n3\n4\n\n\nString.raw()æ¹æ³å¯ä»¥ä½ä¸ºå¤çæ¨¡æ¿å­ç¬¦ä¸²çåºæ¬æ¹æ³ï¼å®ä¼å°ææåéæ¿æ¢ï¼èä¸å¯¹ææ è¿è¡è½¬ä¹ï¼æ¹ä¾¿ä¸ä¸æ­¥ä½ä¸ºå­ç¬¦ä¸²æ¥ä½¿ç¨ã\n\nString.raw()æ¬è´¨ä¸æ¯ä¸ä¸ªæ­£å¸¸çå½æ°ï¼åªæ¯ä¸ç¨äºæ¨¡æ¿å­ç¬¦ä¸²çæ ç­¾å½æ°ãå¦æåææ­£å¸¸å½æ°çå½¢å¼ï¼å®çç¬¬ä¸ä¸ªåæ°ï¼åºè¯¥æ¯ä¸ä¸ªå·ærawå±æ§çå¯¹è±¡ï¼ä¸rawå±æ§çå¼åºè¯¥æ¯ä¸ä¸ªæ°ç»ï¼å¯¹åºæ¨¡æ¿å­ç¬¦ä¸²è§£æåçå¼ã\n\n// `foo${1 + 2}bar`\n// ç­åäº\nString.raw({ raw: ['foo', 'bar'] }, 1 + 2) // \"foo3bar\"\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼String.raw()æ¹æ³çç¬¬ä¸ä¸ªåæ°æ¯ä¸ä¸ªå¯¹è±¡ï¼å®çrawå±æ§ç­åäºåå§çæ¨¡æ¿å­ç¬¦ä¸²è§£æåå¾å°çæ°ç»ã\n\nä½ä¸ºå½æ°ï¼String.raw()çä»£ç å®ç°åºæ¬å¦ä¸ã\n\nString.raw = function (strings, ...values) {\n  let output = '';\n  let index;\n  for (index = 0; index < values.length; index++) {\n    output += strings.raw[index] + values[index];\n  }\n\n  output += strings.raw[index]\n  return output;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# å®ä¾æ¹æ³ï¼codePointAt()\n\nJavaScript åé¨ï¼å­ç¬¦ä»¥ UTF-16 çæ ¼å¼å¨å­ï¼æ¯ä¸ªå­ç¬¦åºå®ä¸º2ä¸ªå­èãå¯¹äºé£äºéè¦4ä¸ªå­èå¨å­çå­ç¬¦ï¼Unicode ç ç¹å¤§äº0xFFFFçå­ç¬¦ï¼ï¼JavaScript ä¼è®¤ä¸ºå®ä»¬æ¯ä¸¤ä¸ªå­ç¬¦ã\n\nvar s = \"ð ®·\";\n\ns.length // 2\ns.charAt(0) // ''\ns.charAt(1) // ''\ns.charCodeAt(0) // 55362\ns.charCodeAt(1) // 57271\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼æ±å­âð ®·âï¼æ³¨æï¼è¿ä¸ªå­ä¸æ¯âåç¥¥âçâåâï¼çç ç¹æ¯0x20BB7ï¼UTF-16 ç¼ç ä¸º0xD842 0xDFB7ï¼åè¿å¶ä¸º55362 57271ï¼ï¼éè¦4ä¸ªå­èå¨å­ãå¯¹äºè¿ç§4ä¸ªå­èçå­ç¬¦ï¼JavaScript ä¸è½æ­£ç¡®å¤çï¼å­ç¬¦ä¸²é¿åº¦ä¼è¯¯å¤ä¸º2ï¼èä¸charAt()æ¹æ³æ æ³è¯»åæ´ä¸ªå­ç¬¦ï¼charCodeAt()æ¹æ³åªè½åå«è¿ååä¸¤ä¸ªå­èååä¸¤ä¸ªå­èçå¼ã\n\nES6 æä¾äºcodePointAt()æ¹æ³ï¼è½å¤æ­£ç¡®å¤ç 4 ä¸ªå­èå¨å­çå­ç¬¦ï¼è¿åä¸ä¸ªå­ç¬¦çç ç¹ã\n\nlet s = 'ð ®·a';\n\ns.codePointAt(0) // 134071\ns.codePointAt(1) // 57271\n\ns.codePointAt(2) // 97\n\n\n1\n2\n3\n4\n5\n6\n\n\ncodePointAt()æ¹æ³çåæ°ï¼æ¯å­ç¬¦å¨å­ç¬¦ä¸²ä¸­çä½ç½®ï¼ä» 0 å¼å§ï¼ãä¸é¢ä»£ç ä¸­ï¼JavaScript å°âð ®·aâè§ä¸ºä¸ä¸ªå­ç¬¦ï¼codePointAt æ¹æ³å¨ç¬¬ä¸ä¸ªå­ç¬¦ä¸ï¼æ­£ç¡®å°è¯å«äºâð ®·âï¼è¿åäºå®çåè¿å¶ç ç¹ 134071ï¼å³åå­è¿å¶ç20BB7ï¼ãå¨ç¬¬äºä¸ªå­ç¬¦ï¼å³âð ®·âçåä¸¤ä¸ªå­èï¼åç¬¬ä¸ä¸ªå­ç¬¦âaâä¸ï¼codePointAt()æ¹æ³çç»æä¸charCodeAt()æ¹æ³ç¸åã\n\næ»ä¹ï¼codePointAt()æ¹æ³ä¼æ­£ç¡®è¿å 32 ä½ç UTF-16 å­ç¬¦çç ç¹ãå¯¹äºé£äºä¸¤ä¸ªå­èå¨å­çå¸¸è§å­ç¬¦ï¼å®çè¿åç»æä¸charCodeAt()æ¹æ³ç¸åã\n\ncodePointAt()æ¹æ³è¿åçæ¯ç ç¹çåè¿å¶å¼ï¼å¦ææ³è¦åå­è¿å¶çå¼ï¼å¯ä»¥ä½¿ç¨toString()æ¹æ³è½¬æ¢ä¸ä¸ã\n\nlet s = 'ð ®·a';\n\ns.codePointAt(0).toString(16) // \"20bb7\"\ns.codePointAt(2).toString(16) // \"61\"\n\n\n1\n2\n3\n4\n\n\nä½ å¯è½æ³¨æå°äºï¼codePointAt()æ¹æ³çåæ°ï¼ä»ç¶æ¯ä¸æ­£ç¡®çãæ¯å¦ï¼ä¸é¢ä»£ç ä¸­ï¼å­ç¬¦aå¨å­ç¬¦ä¸²sçæ­£ç¡®ä½ç½®åºå·åºè¯¥æ¯ 1ï¼ä½æ¯å¿é¡»åcodePointAt()æ¹æ³ä¼ å¥ 2ãè§£å³è¿ä¸ªé®é¢çä¸ä¸ªåæ³æ¯ä½¿ç¨for...ofå¾ªç¯ï¼å ä¸ºå®ä¼æ­£ç¡®è¯å« 32 ä½ç UTF-16 å­ç¬¦ã\n\nlet s = 'ð ®·a';\nfor (let ch of s) {\n  console.log(ch.codePointAt(0).toString(16));\n}\n// 20bb7\n// 61\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¦ä¸ç§æ¹æ³ä¹å¯ä»¥ï¼ä½¿ç¨æ©å±è¿ç®ç¬¦ï¼...ï¼è¿è¡å±å¼è¿ç®ã\n\nlet arr = [...'ð ®·a']; // arr.length === 2\narr.forEach(\n  ch => console.log(ch.codePointAt(0).toString(16))\n);\n// 20bb7\n// 61\n\n\n1\n2\n3\n4\n5\n6\n\n\ncodePointAt()æ¹æ³æ¯æµè¯ä¸ä¸ªå­ç¬¦ç±ä¸¤ä¸ªå­èè¿æ¯ç±åä¸ªå­èç»æçæç®åæ¹æ³ã\n\nfunction is32Bit(c) {\n  return c.codePointAt(0) > 0xFFFF;\n}\n\nis32Bit(\"ð ®·\") // true\nis32Bit(\"a\") // false\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# å®ä¾æ¹æ³ï¼normalize()\n\nè®¸å¤æ¬§æ´²è¯­è¨æè¯­è°ç¬¦å·åéé³ç¬¦å·ãä¸ºäºè¡¨ç¤ºå®ä»¬ï¼Unicode æä¾äºä¸¤ç§æ¹æ³ãä¸ç§æ¯ç´æ¥æä¾å¸¦éé³ç¬¦å·çå­ç¬¦ï¼æ¯å¦Çï¼\\u01D1ï¼ãå¦ä¸ç§æ¯æä¾åæç¬¦å·ï¼combining characterï¼ï¼å³åå­ç¬¦ä¸éé³ç¬¦å·çåæï¼ä¸¤ä¸ªå­ç¬¦åæä¸ä¸ªå­ç¬¦ï¼æ¯å¦Oï¼\\u004Fï¼åËï¼\\u030Cï¼åæÇï¼\\u004F\\u030Cï¼ã\n\nè¿ä¸¤ç§è¡¨ç¤ºæ¹æ³ï¼å¨è§è§åè¯­ä¹ä¸é½ç­ä»·ï¼ä½æ¯ JavaScript ä¸è½è¯å«ã\n\n'\\u01D1'==='\\u004F\\u030C' //false\n\n'\\u01D1'.length // 1\n'\\u004F\\u030C'.length // 2\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼JavaScript å°åæå­ç¬¦è§ä¸ºä¸¤ä¸ªå­ç¬¦ï¼å¯¼è´ä¸¤ç§è¡¨ç¤ºæ¹æ³ä¸ç¸ç­ã\n\nES6 æä¾å­ç¬¦ä¸²å®ä¾çnormalize()æ¹æ³ï¼ç¨æ¥å°å­ç¬¦çä¸åè¡¨ç¤ºæ¹æ³ç»ä¸ä¸ºåæ ·çå½¢å¼ï¼è¿ç§°ä¸º Unicode æ­£è§åã\n\n'\\u01D1'.normalize() === '\\u004F\\u030C'.normalize()\n// true\n\n\n1\n2\n\n\nnormalizeæ¹æ³å¯ä»¥æ¥åä¸ä¸ªåæ°æ¥æå®normalizeçæ¹å¼ï¼åæ°çåä¸ªå¯éå¼å¦ä¸ã\n\n * NFCï¼é»è®¤åæ°ï¼è¡¨ç¤ºâæ åç­ä»·åæâï¼Normalization Form Canonical Compositionï¼ï¼è¿åå¤ä¸ªç®åå­ç¬¦çåæå­ç¬¦ãæè°âæ åç­ä»·âæçæ¯è§è§åè¯­ä¹ä¸çç­ä»·ã\n * NFDï¼è¡¨ç¤ºâæ åç­ä»·åè§£âï¼Normalization Form Canonical Decompositionï¼ï¼å³å¨æ åç­ä»·çåæä¸ï¼è¿ååæå­ç¬¦åè§£çå¤ä¸ªç®åå­ç¬¦ã\n * NFKCï¼è¡¨ç¤ºâå¼å®¹ç­ä»·åæâï¼Normalization Form Compatibility Compositionï¼ï¼è¿ååæå­ç¬¦ãæè°âå¼å®¹ç­ä»·âæçæ¯è¯­ä¹ä¸å­å¨ç­ä»·ï¼ä½è§è§ä¸ä¸ç­ä»·ï¼æ¯å¦âåâåâååâãï¼è¿åªæ¯ç¨æ¥ä¸¾ä¾ï¼normalizeæ¹æ³ä¸è½è¯å«ä¸­æãï¼\n * NFKDï¼è¡¨ç¤ºâå¼å®¹ç­ä»·åè§£âï¼Normalization Form Compatibility Decompositionï¼ï¼å³å¨å¼å®¹ç­ä»·çåæä¸ï¼è¿ååæå­ç¬¦åè§£çå¤ä¸ªç®åå­ç¬¦ã\n\n'\\u004F\\u030C'.normalize('NFC').length // 1\n'\\u004F\\u030C'.normalize('NFD').length // 2\n\n\n1\n2\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼NFCåæ°è¿åå­ç¬¦çåæå½¢å¼ï¼NFDåæ°è¿åå­ç¬¦çåè§£å½¢å¼ã\n\nä¸è¿ï¼normalizeæ¹æ³ç®åä¸è½è¯å«ä¸ä¸ªæä¸ä¸ªä»¥ä¸å­ç¬¦çåæãè¿ç§æåµä¸ï¼è¿æ¯åªè½ä½¿ç¨æ­£åè¡¨è¾¾å¼ï¼éè¿ Unicode ç¼å·åºé´å¤æ­ã\n\n\n# å®ä¾æ¹æ³ï¼includes() åå«, startsWith() å¤´é¨åå«, endsWith() æ«å°¾åå«\n\nä¼ ç»ä¸ï¼JavaScript åªæindexOfæ¹æ³ï¼å¯ä»¥ç¨æ¥ç¡®å®ä¸ä¸ªå­ç¬¦ä¸²æ¯å¦åå«å¨å¦ä¸ä¸ªå­ç¬¦ä¸²ä¸­ãES6 åæä¾äºä¸ç§æ°æ¹æ³ã\n\n * includes()ï¼è¿åå¸å°å¼ï¼è¡¨ç¤ºæ¯å¦æ¾å°äºåæ°å­ç¬¦ä¸²ã\n * startsWith()ï¼è¿åå¸å°å¼ï¼è¡¨ç¤ºåæ°å­ç¬¦ä¸²æ¯å¦å¨åå­ç¬¦ä¸²çå¤´é¨ã\n * endsWith()ï¼è¿åå¸å°å¼ï¼è¡¨ç¤ºåæ°å­ç¬¦ä¸²æ¯å¦å¨åå­ç¬¦ä¸²çå°¾é¨ã\n\nlet s = 'Hello world!';\n\ns.startsWith('Hello') // true\ns.endsWith('!') // true\ns.includes('o') // true\n\n\n1\n2\n3\n4\n5\n\n\nè¿ä¸ä¸ªæ¹æ³é½æ¯æç¬¬äºä¸ªåæ°ï¼è¡¨ç¤ºå¼å§æç´¢çä½ç½®ã\n\nlet s = 'Hello world!';\n\ns.startsWith('world', 6) // true\ns.endsWith('Hello', 5) // true\ns.includes('Hello', 6) // false\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼ä½¿ç¨ç¬¬äºä¸ªåæ°næ¶ï¼endsWithçè¡ä¸ºä¸å¶ä»ä¸¤ä¸ªæ¹æ³ææä¸åãå®éå¯¹ånä¸ªå­ç¬¦ï¼èå¶ä»ä¸¤ä¸ªæ¹æ³éå¯¹ä»ç¬¬nä¸ªä½ç½®ç´å°å­ç¬¦ä¸²ç»æã\n\n\n# å®ä¾æ¹æ³ï¼repeat() éå¤\n\nrepeatæ¹æ³è¿åä¸ä¸ªæ°å­ç¬¦ä¸²ï¼è¡¨ç¤ºå°åå­ç¬¦ä¸²éå¤næ¬¡ã\n\n'x'.repeat(3) // \"xxx\"\n'hello'.repeat(2) // \"hellohello\"\n'na'.repeat(0) // \"\"\n\n\n1\n2\n3\n\n\nåæ°å¦ææ¯å°æ°ï¼ä¼è¢«åæ´ã\n\n'na'.repeat(2.9) // \"nana\"\n\n\n1\n\n\nå¦ærepeatçåæ°æ¯è´æ°æèInfinityï¼ä¼æ¥éã\n\n'na'.repeat(Infinity)\n// RangeError\n'na'.repeat(-1)\n// RangeError\n\n\n1\n2\n3\n4\n\n\nä½æ¯ï¼å¦æåæ°æ¯ 0 å°-1 ä¹é´çå°æ°ï¼åç­åäº 0ï¼è¿æ¯å ä¸ºä¼åè¿è¡åæ´è¿ç®ã0 å°-1 ä¹é´çå°æ°ï¼åæ´ä»¥åç­äº-0ï¼repeatè§åä¸º 0ã\n\n'na'.repeat(-0.9) // \"\"\n\n\n1\n\n\nåæ°NaNç­åäº 0ã\n\n'na'.repeat(NaN) // \"\"\n\n\n1\n\n\nå¦ærepeatçåæ°æ¯å­ç¬¦ä¸²ï¼åä¼åè½¬æ¢ææ°å­ã\n\n'na'.repeat('na') // \"\"\n'na'.repeat('3') // \"nanana\"\n\n\n1\n2\n\n\n\n# å®ä¾æ¹æ³ï¼padStart() è¡¥å¨å¤´é¨ï¼padEnd() è¡¥å¨æ«å°¾\n\nES2017 å¼å¥äºå­ç¬¦ä¸²è¡¥å¨é¿åº¦çåè½ãå¦ææä¸ªå­ç¬¦ä¸²ä¸å¤æå®é¿åº¦ï¼ä¼å¨å¤´é¨æå°¾é¨è¡¥å¨ãpadStart()ç¨äºå¤´é¨è¡¥å¨ï¼padEnd()ç¨äºå°¾é¨è¡¥å¨ã\n\n'x'.padStart(5, 'ab') // 'ababx'\n'x'.padStart(4, 'ab') // 'abax'\n\n'x'.padEnd(5, 'ab') // 'xabab'\n'x'.padEnd(4, 'ab') // 'xaba'\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼padStart()åpadEnd()ä¸å±æ¥åä¸¤ä¸ªåæ°ï¼ç¬¬ä¸ä¸ªåæ°æ¯å­ç¬¦ä¸²è¡¥å¨çæçæå¤§é¿åº¦ï¼ç¬¬äºä¸ªåæ°æ¯ç¨æ¥è¡¥å¨çå­ç¬¦ä¸²ã\n\nå¦æåå­ç¬¦ä¸²çé¿åº¦ï¼ç­äºæå¤§äºæå¤§é¿åº¦ï¼åå­ç¬¦ä¸²è¡¥å¨ä¸çæï¼è¿ååå­ç¬¦ä¸²ã\n\n'xxx'.padStart(2, 'ab') // 'xxx'\n'xxx'.padEnd(2, 'ab') // 'xxx'\n\n\n1\n2\n\n\nå¦æç¨æ¥è¡¥å¨çå­ç¬¦ä¸²ä¸åå­ç¬¦ä¸²ï¼ä¸¤èçé¿åº¦ä¹åè¶è¿äºæå¤§é¿åº¦ï¼åä¼æªå»è¶åºä½æ°çè¡¥å¨å­ç¬¦ä¸²ã\n\n'abc'.padStart(10, '0123456789')\n// '0123456abc'\n\n\n1\n2\n\n\nå¦æçç¥ç¬¬äºä¸ªåæ°ï¼é»è®¤ä½¿ç¨ç©ºæ ¼è¡¥å¨é¿åº¦ã\n\n'x'.padStart(4) // '   x'\n'x'.padEnd(4) // 'x   '\n\n\n1\n2\n\n\npadStart()çå¸¸è§ç¨éæ¯ä¸ºæ°å¼è¡¥å¨æå®ä½æ°ãä¸é¢ä»£ç çæ 10 ä½çæ°å¼å­ç¬¦ä¸²ã\n\n'1'.padStart(10, '0') // \"0000000001\"\n'12'.padStart(10, '0') // \"0000000012\"\n'123456'.padStart(10, '0') // \"0000123456\"\n\n\n1\n2\n3\n\n\nå¦ä¸ä¸ªç¨éæ¯æç¤ºå­ç¬¦ä¸²æ ¼å¼ã\n\n'12'.padStart(10, 'YYYY-MM-DD') // \"YYYY-MM-12\"\n'09-12'.padStart(10, 'YYYY-MM-DD') // \"YYYY-09-12\"\n\n\n1\n2\n\n\n\n# å®ä¾æ¹æ³ï¼trimStart() ä¿®åªå¤´é¨ï¼trimEnd() ä¿®åªæ«å°¾\n\nES2019 å¯¹å­ç¬¦ä¸²å®ä¾æ°å¢äºtrimStart()åtrimEnd()è¿ä¸¤ä¸ªæ¹æ³ãå®ä»¬çè¡ä¸ºä¸trim()ä¸è´ï¼trimStart()æ¶é¤å­ç¬¦ä¸²å¤´é¨çç©ºæ ¼ï¼trimEnd()æ¶é¤å°¾é¨çç©ºæ ¼ãå®ä»¬è¿åçé½æ¯æ°å­ç¬¦ä¸²ï¼ä¸ä¼ä¿®æ¹åå§å­ç¬¦ä¸²ã\n\nconst s = '  abc  ';\n\ns.trim() // \"abc\"\ns.trimStart() // \"abc  \"\ns.trimEnd() // \"  abc\"\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼trimStart()åªæ¶é¤å¤´é¨çç©ºæ ¼ï¼ä¿çå°¾é¨çç©ºæ ¼ãtrimEnd()ä¹æ¯ç±»ä¼¼è¡ä¸ºã\n\né¤äºç©ºæ ¼é®ï¼è¿ä¸¤ä¸ªæ¹æ³å¯¹å­ç¬¦ä¸²å¤´é¨ï¼æå°¾é¨ï¼ç tab é®ãæ¢è¡ç¬¦ç­ä¸å¯è§çç©ºç½ç¬¦å·ä¹ææã\n\næµè§å¨è¿é¨ç½²äºé¢å¤çä¸¤ä¸ªæ¹æ³ï¼trimLeft()æ¯trimStart()çå«åï¼trimRight()æ¯trimEnd()çå«åã\n\n\n# å®ä¾æ¹æ³ï¼matchAll()\n\nmatchAll()æ¹æ³è¿åä¸ä¸ªæ­£åè¡¨è¾¾å¼å¨å½åå­ç¬¦ä¸²çææå¹éï¼è¯¦è§ãæ­£åçæ©å±ãçä¸ç« ã",normalizedContent:"# å­ç¬¦ä¸²çæ°å¢æ¹æ³\n\næ¬ç« ä»ç»å­ç¬¦ä¸²å¯¹è±¡çæ°å¢æ¹æ³ã\n\n\n# string.fromcodepoint()\n\nes5 æä¾string.fromcharcode()æ¹æ³ï¼ç¨äºä» unicode ç ç¹è¿åå¯¹åºå­ç¬¦ï¼ä½æ¯è¿ä¸ªæ¹æ³ä¸è½è¯å«ç ç¹å¤§äº0xffffçå­ç¬¦ã\n\nstring.fromcharcode(0x20bb7)\n// \"à®·\"\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼string.fromcharcode()ä¸è½è¯å«å¤§äº0xffffçç ç¹ï¼æä»¥0x20bb7å°±åçäºæº¢åºï¼æé«ä½2è¢«èå¼äºï¼æåè¿åç ç¹u+0bb7å¯¹åºçå­ç¬¦ï¼èä¸æ¯ç ç¹u+20bb7å¯¹åºçå­ç¬¦ã\n\nes6 æä¾äºstring.fromcodepoint()æ¹æ³ï¼å¯ä»¥è¯å«å¤§äº0xffffçå­ç¬¦ï¼å¼¥è¡¥äºstring.fromcharcode()æ¹æ³çä¸è¶³ãå¨ä½ç¨ä¸ï¼æ­£å¥½ä¸ä¸é¢çcodepointat()æ¹æ³ç¸åã\n\nstring.fromcodepoint(0x20bb7)\n// \"ð ®·\"\nstring.fromcodepoint(0x78, 0x1f680, 0x79) === 'x\\ud83d\\ude80y'\n// true\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æstring.fromcodepointæ¹æ³æå¤ä¸ªåæ°ï¼åå®ä»¬ä¼è¢«åå¹¶æä¸ä¸ªå­ç¬¦ä¸²è¿åã\n\næ³¨æï¼fromcodepointæ¹æ³å®ä¹å¨stringå¯¹è±¡ä¸ï¼ècodepointatæ¹æ³å®ä¹å¨å­ç¬¦ä¸²çå®ä¾å¯¹è±¡ä¸ã\n\n\n# string.raw()\n\nes6 è¿ä¸ºåçç string å¯¹è±¡ï¼æä¾äºä¸ä¸ªraw()æ¹æ³ãè¯¥æ¹æ³è¿åä¸ä¸ªææ é½è¢«è½¬ä¹ï¼å³ææ åé¢åå ä¸ä¸ªææ ï¼çå­ç¬¦ä¸²ï¼å¾å¾ç¨äºæ¨¡æ¿å­ç¬¦ä¸²çå¤çæ¹æ³ã\n\nstring.raw`hi\\n${2+3}!`\n// å®éè¿å \"hi\\\\n5!\"ï¼æ¾ç¤ºçæ¯è½¬ä¹åçç»æ \"hi\\n5!\"\n\nstring.raw`hi\\u000a!`;\n// å®éè¿å \"hi\\\\u000a!\"ï¼æ¾ç¤ºçæ¯è½¬ä¹åçç»æ \"hi\\u000a!\"\n\n\n1\n2\n3\n4\n5\n\n\nå¦æåå­ç¬¦ä¸²çææ å·²ç»è½¬ä¹ï¼é£ä¹string.raw()ä¼è¿è¡åæ¬¡è½¬ä¹ã\n\nstring.raw`hi\\\\n`\n// è¿å \"hi\\\\\\\\n\"\n\nstring.raw`hi\\\\n` === \"hi\\\\\\\\n\" // true\n\n\n1\n2\n3\n4\n\n\nstring.raw()æ¹æ³å¯ä»¥ä½ä¸ºå¤çæ¨¡æ¿å­ç¬¦ä¸²çåºæ¬æ¹æ³ï¼å®ä¼å°ææåéæ¿æ¢ï¼èä¸å¯¹ææ è¿è¡è½¬ä¹ï¼æ¹ä¾¿ä¸ä¸æ­¥ä½ä¸ºå­ç¬¦ä¸²æ¥ä½¿ç¨ã\n\nstring.raw()æ¬è´¨ä¸æ¯ä¸ä¸ªæ­£å¸¸çå½æ°ï¼åªæ¯ä¸ç¨äºæ¨¡æ¿å­ç¬¦ä¸²çæ ç­¾å½æ°ãå¦æåææ­£å¸¸å½æ°çå½¢å¼ï¼å®çç¬¬ä¸ä¸ªåæ°ï¼åºè¯¥æ¯ä¸ä¸ªå·ærawå±æ§çå¯¹è±¡ï¼ä¸rawå±æ§çå¼åºè¯¥æ¯ä¸ä¸ªæ°ç»ï¼å¯¹åºæ¨¡æ¿å­ç¬¦ä¸²è§£æåçå¼ã\n\n// `foo${1 + 2}bar`\n// ç­åäº\nstring.raw({ raw: ['foo', 'bar'] }, 1 + 2) // \"foo3bar\"\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼string.raw()æ¹æ³çç¬¬ä¸ä¸ªåæ°æ¯ä¸ä¸ªå¯¹è±¡ï¼å®çrawå±æ§ç­åäºåå§çæ¨¡æ¿å­ç¬¦ä¸²è§£æåå¾å°çæ°ç»ã\n\nä½ä¸ºå½æ°ï¼string.raw()çä»£ç å®ç°åºæ¬å¦ä¸ã\n\nstring.raw = function (strings, ...values) {\n  let output = '';\n  let index;\n  for (index = 0; index < values.length; index++) {\n    output += strings.raw[index] + values[index];\n  }\n\n  output += strings.raw[index]\n  return output;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# å®ä¾æ¹æ³ï¼codepointat()\n\njavascript åé¨ï¼å­ç¬¦ä»¥ utf-16 çæ ¼å¼å¨å­ï¼æ¯ä¸ªå­ç¬¦åºå®ä¸º2ä¸ªå­èãå¯¹äºé£äºéè¦4ä¸ªå­èå¨å­çå­ç¬¦ï¼unicode ç ç¹å¤§äº0xffffçå­ç¬¦ï¼ï¼javascript ä¼è®¤ä¸ºå®ä»¬æ¯ä¸¤ä¸ªå­ç¬¦ã\n\nvar s = \"ð ®·\";\n\ns.length // 2\ns.charat(0) // ''\ns.charat(1) // ''\ns.charcodeat(0) // 55362\ns.charcodeat(1) // 57271\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼æ±å­âð ®·âï¼æ³¨æï¼è¿ä¸ªå­ä¸æ¯âåç¥¥âçâåâï¼çç ç¹æ¯0x20bb7ï¼utf-16 ç¼ç ä¸º0xd842 0xdfb7ï¼åè¿å¶ä¸º55362 57271ï¼ï¼éè¦4ä¸ªå­èå¨å­ãå¯¹äºè¿ç§4ä¸ªå­èçå­ç¬¦ï¼javascript ä¸è½æ­£ç¡®å¤çï¼å­ç¬¦ä¸²é¿åº¦ä¼è¯¯å¤ä¸º2ï¼èä¸charat()æ¹æ³æ æ³è¯»åæ´ä¸ªå­ç¬¦ï¼charcodeat()æ¹æ³åªè½åå«è¿ååä¸¤ä¸ªå­èååä¸¤ä¸ªå­èçå¼ã\n\nes6 æä¾äºcodepointat()æ¹æ³ï¼è½å¤æ­£ç¡®å¤ç 4 ä¸ªå­èå¨å­çå­ç¬¦ï¼è¿åä¸ä¸ªå­ç¬¦çç ç¹ã\n\nlet s = 'ð ®·a';\n\ns.codepointat(0) // 134071\ns.codepointat(1) // 57271\n\ns.codepointat(2) // 97\n\n\n1\n2\n3\n4\n5\n6\n\n\ncodepointat()æ¹æ³çåæ°ï¼æ¯å­ç¬¦å¨å­ç¬¦ä¸²ä¸­çä½ç½®ï¼ä» 0 å¼å§ï¼ãä¸é¢ä»£ç ä¸­ï¼javascript å°âð ®·aâè§ä¸ºä¸ä¸ªå­ç¬¦ï¼codepointat æ¹æ³å¨ç¬¬ä¸ä¸ªå­ç¬¦ä¸ï¼æ­£ç¡®å°è¯å«äºâð ®·âï¼è¿åäºå®çåè¿å¶ç ç¹ 134071ï¼å³åå­è¿å¶ç20bb7ï¼ãå¨ç¬¬äºä¸ªå­ç¬¦ï¼å³âð ®·âçåä¸¤ä¸ªå­èï¼åç¬¬ä¸ä¸ªå­ç¬¦âaâä¸ï¼codepointat()æ¹æ³çç»æä¸charcodeat()æ¹æ³ç¸åã\n\næ»ä¹ï¼codepointat()æ¹æ³ä¼æ­£ç¡®è¿å 32 ä½ç utf-16 å­ç¬¦çç ç¹ãå¯¹äºé£äºä¸¤ä¸ªå­èå¨å­çå¸¸è§å­ç¬¦ï¼å®çè¿åç»æä¸charcodeat()æ¹æ³ç¸åã\n\ncodepointat()æ¹æ³è¿åçæ¯ç ç¹çåè¿å¶å¼ï¼å¦ææ³è¦åå­è¿å¶çå¼ï¼å¯ä»¥ä½¿ç¨tostring()æ¹æ³è½¬æ¢ä¸ä¸ã\n\nlet s = 'ð ®·a';\n\ns.codepointat(0).tostring(16) // \"20bb7\"\ns.codepointat(2).tostring(16) // \"61\"\n\n\n1\n2\n3\n4\n\n\nä½ å¯è½æ³¨æå°äºï¼codepointat()æ¹æ³çåæ°ï¼ä»ç¶æ¯ä¸æ­£ç¡®çãæ¯å¦ï¼ä¸é¢ä»£ç ä¸­ï¼å­ç¬¦aå¨å­ç¬¦ä¸²sçæ­£ç¡®ä½ç½®åºå·åºè¯¥æ¯ 1ï¼ä½æ¯å¿é¡»åcodepointat()æ¹æ³ä¼ å¥ 2ãè§£å³è¿ä¸ªé®é¢çä¸ä¸ªåæ³æ¯ä½¿ç¨for...ofå¾ªç¯ï¼å ä¸ºå®ä¼æ­£ç¡®è¯å« 32 ä½ç utf-16 å­ç¬¦ã\n\nlet s = 'ð ®·a';\nfor (let ch of s) {\n  console.log(ch.codepointat(0).tostring(16));\n}\n// 20bb7\n// 61\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¦ä¸ç§æ¹æ³ä¹å¯ä»¥ï¼ä½¿ç¨æ©å±è¿ç®ç¬¦ï¼...ï¼è¿è¡å±å¼è¿ç®ã\n\nlet arr = [...'ð ®·a']; // arr.length === 2\narr.foreach(\n  ch => console.log(ch.codepointat(0).tostring(16))\n);\n// 20bb7\n// 61\n\n\n1\n2\n3\n4\n5\n6\n\n\ncodepointat()æ¹æ³æ¯æµè¯ä¸ä¸ªå­ç¬¦ç±ä¸¤ä¸ªå­èè¿æ¯ç±åä¸ªå­èç»æçæç®åæ¹æ³ã\n\nfunction is32bit(c) {\n  return c.codepointat(0) > 0xffff;\n}\n\nis32bit(\"ð ®·\") // true\nis32bit(\"a\") // false\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# å®ä¾æ¹æ³ï¼normalize()\n\nè®¸å¤æ¬§æ´²è¯­è¨æè¯­è°ç¬¦å·åéé³ç¬¦å·ãä¸ºäºè¡¨ç¤ºå®ä»¬ï¼unicode æä¾äºä¸¤ç§æ¹æ³ãä¸ç§æ¯ç´æ¥æä¾å¸¦éé³ç¬¦å·çå­ç¬¦ï¼æ¯å¦oï¼\\u01d1ï¼ãå¦ä¸ç§æ¯æä¾åæç¬¦å·ï¼combining characterï¼ï¼å³åå­ç¬¦ä¸éé³ç¬¦å·çåæï¼ä¸¤ä¸ªå­ç¬¦åæä¸ä¸ªå­ç¬¦ï¼æ¯å¦oï¼\\u004fï¼åËï¼\\u030cï¼åæoï¼\\u004f\\u030cï¼ã\n\nè¿ä¸¤ç§è¡¨ç¤ºæ¹æ³ï¼å¨è§è§åè¯­ä¹ä¸é½ç­ä»·ï¼ä½æ¯ javascript ä¸è½è¯å«ã\n\n'\\u01d1'==='\\u004f\\u030c' //false\n\n'\\u01d1'.length // 1\n'\\u004f\\u030c'.length // 2\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼javascript å°åæå­ç¬¦è§ä¸ºä¸¤ä¸ªå­ç¬¦ï¼å¯¼è´ä¸¤ç§è¡¨ç¤ºæ¹æ³ä¸ç¸ç­ã\n\nes6 æä¾å­ç¬¦ä¸²å®ä¾çnormalize()æ¹æ³ï¼ç¨æ¥å°å­ç¬¦çä¸åè¡¨ç¤ºæ¹æ³ç»ä¸ä¸ºåæ ·çå½¢å¼ï¼è¿ç§°ä¸º unicode æ­£è§åã\n\n'\\u01d1'.normalize() === '\\u004f\\u030c'.normalize()\n// true\n\n\n1\n2\n\n\nnormalizeæ¹æ³å¯ä»¥æ¥åä¸ä¸ªåæ°æ¥æå®normalizeçæ¹å¼ï¼åæ°çåä¸ªå¯éå¼å¦ä¸ã\n\n * nfcï¼é»è®¤åæ°ï¼è¡¨ç¤ºâæ åç­ä»·åæâï¼normalization form canonical compositionï¼ï¼è¿åå¤ä¸ªç®åå­ç¬¦çåæå­ç¬¦ãæè°âæ åç­ä»·âæçæ¯è§è§åè¯­ä¹ä¸çç­ä»·ã\n * nfdï¼è¡¨ç¤ºâæ åç­ä»·åè§£âï¼normalization form canonical decompositionï¼ï¼å³å¨æ åç­ä»·çåæä¸ï¼è¿ååæå­ç¬¦åè§£çå¤ä¸ªç®åå­ç¬¦ã\n * nfkcï¼è¡¨ç¤ºâå¼å®¹ç­ä»·åæâï¼normalization form compatibility compositionï¼ï¼è¿ååæå­ç¬¦ãæè°âå¼å®¹ç­ä»·âæçæ¯è¯­ä¹ä¸å­å¨ç­ä»·ï¼ä½è§è§ä¸ä¸ç­ä»·ï¼æ¯å¦âåâåâååâãï¼è¿åªæ¯ç¨æ¥ä¸¾ä¾ï¼normalizeæ¹æ³ä¸è½è¯å«ä¸­æãï¼\n * nfkdï¼è¡¨ç¤ºâå¼å®¹ç­ä»·åè§£âï¼normalization form compatibility decompositionï¼ï¼å³å¨å¼å®¹ç­ä»·çåæä¸ï¼è¿ååæå­ç¬¦åè§£çå¤ä¸ªç®åå­ç¬¦ã\n\n'\\u004f\\u030c'.normalize('nfc').length // 1\n'\\u004f\\u030c'.normalize('nfd').length // 2\n\n\n1\n2\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼nfcåæ°è¿åå­ç¬¦çåæå½¢å¼ï¼nfdåæ°è¿åå­ç¬¦çåè§£å½¢å¼ã\n\nä¸è¿ï¼normalizeæ¹æ³ç®åä¸è½è¯å«ä¸ä¸ªæä¸ä¸ªä»¥ä¸å­ç¬¦çåæãè¿ç§æåµä¸ï¼è¿æ¯åªè½ä½¿ç¨æ­£åè¡¨è¾¾å¼ï¼éè¿ unicode ç¼å·åºé´å¤æ­ã\n\n\n# å®ä¾æ¹æ³ï¼includes() åå«, startswith() å¤´é¨åå«, endswith() æ«å°¾åå«\n\nä¼ ç»ä¸ï¼javascript åªæindexofæ¹æ³ï¼å¯ä»¥ç¨æ¥ç¡®å®ä¸ä¸ªå­ç¬¦ä¸²æ¯å¦åå«å¨å¦ä¸ä¸ªå­ç¬¦ä¸²ä¸­ães6 åæä¾äºä¸ç§æ°æ¹æ³ã\n\n * includes()ï¼è¿åå¸å°å¼ï¼è¡¨ç¤ºæ¯å¦æ¾å°äºåæ°å­ç¬¦ä¸²ã\n * startswith()ï¼è¿åå¸å°å¼ï¼è¡¨ç¤ºåæ°å­ç¬¦ä¸²æ¯å¦å¨åå­ç¬¦ä¸²çå¤´é¨ã\n * endswith()ï¼è¿åå¸å°å¼ï¼è¡¨ç¤ºåæ°å­ç¬¦ä¸²æ¯å¦å¨åå­ç¬¦ä¸²çå°¾é¨ã\n\nlet s = 'hello world!';\n\ns.startswith('hello') // true\ns.endswith('!') // true\ns.includes('o') // true\n\n\n1\n2\n3\n4\n5\n\n\nè¿ä¸ä¸ªæ¹æ³é½æ¯æç¬¬äºä¸ªåæ°ï¼è¡¨ç¤ºå¼å§æç´¢çä½ç½®ã\n\nlet s = 'hello world!';\n\ns.startswith('world', 6) // true\ns.endswith('hello', 5) // true\ns.includes('hello', 6) // false\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼ä½¿ç¨ç¬¬äºä¸ªåæ°næ¶ï¼endswithçè¡ä¸ºä¸å¶ä»ä¸¤ä¸ªæ¹æ³ææä¸åãå®éå¯¹ånä¸ªå­ç¬¦ï¼èå¶ä»ä¸¤ä¸ªæ¹æ³éå¯¹ä»ç¬¬nä¸ªä½ç½®ç´å°å­ç¬¦ä¸²ç»æã\n\n\n# å®ä¾æ¹æ³ï¼repeat() éå¤\n\nrepeatæ¹æ³è¿åä¸ä¸ªæ°å­ç¬¦ä¸²ï¼è¡¨ç¤ºå°åå­ç¬¦ä¸²éå¤næ¬¡ã\n\n'x'.repeat(3) // \"xxx\"\n'hello'.repeat(2) // \"hellohello\"\n'na'.repeat(0) // \"\"\n\n\n1\n2\n3\n\n\nåæ°å¦ææ¯å°æ°ï¼ä¼è¢«åæ´ã\n\n'na'.repeat(2.9) // \"nana\"\n\n\n1\n\n\nå¦ærepeatçåæ°æ¯è´æ°æèinfinityï¼ä¼æ¥éã\n\n'na'.repeat(infinity)\n// rangeerror\n'na'.repeat(-1)\n// rangeerror\n\n\n1\n2\n3\n4\n\n\nä½æ¯ï¼å¦æåæ°æ¯ 0 å°-1 ä¹é´çå°æ°ï¼åç­åäº 0ï¼è¿æ¯å ä¸ºä¼åè¿è¡åæ´è¿ç®ã0 å°-1 ä¹é´çå°æ°ï¼åæ´ä»¥åç­äº-0ï¼repeatè§åä¸º 0ã\n\n'na'.repeat(-0.9) // \"\"\n\n\n1\n\n\nåæ°nanç­åäº 0ã\n\n'na'.repeat(nan) // \"\"\n\n\n1\n\n\nå¦ærepeatçåæ°æ¯å­ç¬¦ä¸²ï¼åä¼åè½¬æ¢ææ°å­ã\n\n'na'.repeat('na') // \"\"\n'na'.repeat('3') // \"nanana\"\n\n\n1\n2\n\n\n\n# å®ä¾æ¹æ³ï¼padstart() è¡¥å¨å¤´é¨ï¼padend() è¡¥å¨æ«å°¾\n\nes2017 å¼å¥äºå­ç¬¦ä¸²è¡¥å¨é¿åº¦çåè½ãå¦ææä¸ªå­ç¬¦ä¸²ä¸å¤æå®é¿åº¦ï¼ä¼å¨å¤´é¨æå°¾é¨è¡¥å¨ãpadstart()ç¨äºå¤´é¨è¡¥å¨ï¼padend()ç¨äºå°¾é¨è¡¥å¨ã\n\n'x'.padstart(5, 'ab') // 'ababx'\n'x'.padstart(4, 'ab') // 'abax'\n\n'x'.padend(5, 'ab') // 'xabab'\n'x'.padend(4, 'ab') // 'xaba'\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼padstart()åpadend()ä¸å±æ¥åä¸¤ä¸ªåæ°ï¼ç¬¬ä¸ä¸ªåæ°æ¯å­ç¬¦ä¸²è¡¥å¨çæçæå¤§é¿åº¦ï¼ç¬¬äºä¸ªåæ°æ¯ç¨æ¥è¡¥å¨çå­ç¬¦ä¸²ã\n\nå¦æåå­ç¬¦ä¸²çé¿åº¦ï¼ç­äºæå¤§äºæå¤§é¿åº¦ï¼åå­ç¬¦ä¸²è¡¥å¨ä¸çæï¼è¿ååå­ç¬¦ä¸²ã\n\n'xxx'.padstart(2, 'ab') // 'xxx'\n'xxx'.padend(2, 'ab') // 'xxx'\n\n\n1\n2\n\n\nå¦æç¨æ¥è¡¥å¨çå­ç¬¦ä¸²ä¸åå­ç¬¦ä¸²ï¼ä¸¤èçé¿åº¦ä¹åè¶è¿äºæå¤§é¿åº¦ï¼åä¼æªå»è¶åºä½æ°çè¡¥å¨å­ç¬¦ä¸²ã\n\n'abc'.padstart(10, '0123456789')\n// '0123456abc'\n\n\n1\n2\n\n\nå¦æçç¥ç¬¬äºä¸ªåæ°ï¼é»è®¤ä½¿ç¨ç©ºæ ¼è¡¥å¨é¿åº¦ã\n\n'x'.padstart(4) // '   x'\n'x'.padend(4) // 'x   '\n\n\n1\n2\n\n\npadstart()çå¸¸è§ç¨éæ¯ä¸ºæ°å¼è¡¥å¨æå®ä½æ°ãä¸é¢ä»£ç çæ 10 ä½çæ°å¼å­ç¬¦ä¸²ã\n\n'1'.padstart(10, '0') // \"0000000001\"\n'12'.padstart(10, '0') // \"0000000012\"\n'123456'.padstart(10, '0') // \"0000123456\"\n\n\n1\n2\n3\n\n\nå¦ä¸ä¸ªç¨éæ¯æç¤ºå­ç¬¦ä¸²æ ¼å¼ã\n\n'12'.padstart(10, 'yyyy-mm-dd') // \"yyyy-mm-12\"\n'09-12'.padstart(10, 'yyyy-mm-dd') // \"yyyy-09-12\"\n\n\n1\n2\n\n\n\n# å®ä¾æ¹æ³ï¼trimstart() ä¿®åªå¤´é¨ï¼trimend() ä¿®åªæ«å°¾\n\nes2019 å¯¹å­ç¬¦ä¸²å®ä¾æ°å¢äºtrimstart()åtrimend()è¿ä¸¤ä¸ªæ¹æ³ãå®ä»¬çè¡ä¸ºä¸trim()ä¸è´ï¼trimstart()æ¶é¤å­ç¬¦ä¸²å¤´é¨çç©ºæ ¼ï¼trimend()æ¶é¤å°¾é¨çç©ºæ ¼ãå®ä»¬è¿åçé½æ¯æ°å­ç¬¦ä¸²ï¼ä¸ä¼ä¿®æ¹åå§å­ç¬¦ä¸²ã\n\nconst s = '  abc  ';\n\ns.trim() // \"abc\"\ns.trimstart() // \"abc  \"\ns.trimend() // \"  abc\"\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼trimstart()åªæ¶é¤å¤´é¨çç©ºæ ¼ï¼ä¿çå°¾é¨çç©ºæ ¼ãtrimend()ä¹æ¯ç±»ä¼¼è¡ä¸ºã\n\né¤äºç©ºæ ¼é®ï¼è¿ä¸¤ä¸ªæ¹æ³å¯¹å­ç¬¦ä¸²å¤´é¨ï¼æå°¾é¨ï¼ç tab é®ãæ¢è¡ç¬¦ç­ä¸å¯è§çç©ºç½ç¬¦å·ä¹ææã\n\næµè§å¨è¿é¨ç½²äºé¢å¤çä¸¤ä¸ªæ¹æ³ï¼trimleft()æ¯trimstart()çå«åï¼trimright()æ¯trimend()çå«åã\n\n\n# å®ä¾æ¹æ³ï¼matchall()\n\nmatchall()æ¹æ³è¿åä¸ä¸ªæ­£åè¡¨è¾¾å¼å¨å½åå­ç¬¦ä¸²çææå¹éï¼è¯¦è§ãæ­£åçæ©å±ãçä¸ç« ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"æ­£åçæ©å±",frontmatter:{title:"æ­£åçæ©å±",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/0473261a6ab0ee8c",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/06.%E6%AD%A3%E5%88%99%E7%9A%84%E6%89%A9%E5%B1%95.html",relativePath:"ãES6 æç¨ãç¬è®°/06.æ­£åçæ©å±.md",key:"v-05ba6584",path:"/pages/0473261a6ab0ee8c/",headers:[{level:2,title:"RegExp æé å½æ°",slug:"regexp-æé å½æ°",normalizedTitle:"regexp æé å½æ°",charIndex:12},{level:2,title:"å­ç¬¦ä¸²çæ­£åæ¹æ³",slug:"å­ç¬¦ä¸²çæ­£åæ¹æ³",normalizedTitle:"å­ç¬¦ä¸²çæ­£åæ¹æ³",charIndex:614},{level:2,title:"u ä¿®é¥°ç¬¦",slug:"u-ä¿®é¥°ç¬¦",normalizedTitle:"u ä¿®é¥°ç¬¦",charIndex:1001},{level:2,title:"RegExp.prototype.unicode å±æ§",slug:"regexp-prototype-unicode-å±æ§",normalizedTitle:"regexp.prototype.unicode å±æ§",charIndex:2659},{level:2,title:"y ä¿®é¥°ç¬¦",slug:"y-ä¿®é¥°ç¬¦",normalizedTitle:"y ä¿®é¥°ç¬¦",charIndex:2857},{level:2,title:"RegExp.prototype.sticky å±æ§",slug:"regexp-prototype-sticky-å±æ§",normalizedTitle:"regexp.prototype.sticky å±æ§",charIndex:5123},{level:2,title:"RegExp.prototype.flags å±æ§",slug:"regexp-prototype-flags-å±æ§",normalizedTitle:"regexp.prototype.flags å±æ§",charIndex:5244},{level:2,title:"s ä¿®é¥°ç¬¦ï¼dotAll æ¨¡å¼",slug:"s-ä¿®é¥°ç¬¦-dotall-æ¨¡å¼",normalizedTitle:"s ä¿®é¥°ç¬¦ï¼dotall æ¨¡å¼",charIndex:5445},{level:2,title:"åè¡æ­è¨",slug:"åè¡æ­è¨",normalizedTitle:"åè¡æ­è¨",charIndex:6245},{level:2,title:"Unicode å±æ§ç±»",slug:"unicode-å±æ§ç±»",normalizedTitle:"unicode å±æ§ç±»",charIndex:7842},{level:2,title:"å·åç»å¹é",slug:"å·åç»å¹é",normalizedTitle:"å·åç»å¹é",charIndex:9210},{level:3,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:9220},{level:3,title:"è§£æèµå¼åæ¿æ¢",slug:"è§£æèµå¼åæ¿æ¢",normalizedTitle:"è§£æèµå¼åæ¿æ¢",charIndex:10371},{level:3,title:"å¼ç¨",slug:"å¼ç¨",normalizedTitle:"å¼ç¨",charIndex:7630},{level:2,title:"String.prototype.matchAll()",slug:"string-prototype-matchall",normalizedTitle:"string.prototype.matchall()",charIndex:11613}],excerpt:'<h1 id="æ­£åçæ©å±"><a class="header-anchor" href="#æ­£åçæ©å±">#</a> æ­£åçæ©å±</h1>\n<h2 id="regexp-æé å½æ°"><a class="header-anchor" href="#regexp-æé å½æ°">#</a> RegExp æé å½æ°</h2>\n<p>å¨ ES5 ä¸­ï¼<code>RegExp</code>æé å½æ°çåæ°æä¸¤ç§æåµã</p>\n<p>ç¬¬ä¸ç§æåµæ¯ï¼åæ°æ¯å­ç¬¦ä¸²ï¼è¿æ¶ç¬¬äºä¸ªåæ°è¡¨ç¤ºæ­£åè¡¨è¾¾å¼çä¿®é¥°ç¬¦ï¼flagï¼ã</p>\n\x3c!--beforebegin--\x3e<div class="language-javascript line-numbers-mode">\x3c!--afterbegin--\x3e<pre v-pre class="language-javascript"><code><span class="token keyword">var</span> regex <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">\'xyz\'</span><span class="token punctuation">,</span> <span class="token string">\'i\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ç­ä»·äº</span>\n<span class="token keyword">var</span> regex <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xyz</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">;</span>\n</code></pre>\n<div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div>\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e',headersStr:"RegExp æé å½æ° å­ç¬¦ä¸²çæ­£åæ¹æ³ u ä¿®é¥°ç¬¦ RegExp.prototype.unicode å±æ§ y ä¿®é¥°ç¬¦ RegExp.prototype.sticky å±æ§ RegExp.prototype.flags å±æ§ s ä¿®é¥°ç¬¦ï¼dotAll æ¨¡å¼ åè¡æ­è¨ Unicode å±æ§ç±» å·åç»å¹é ç®ä» è§£æèµå¼åæ¿æ¢ å¼ç¨ String.prototype.matchAll()",content:"# æ­£åçæ©å±\n\n\n# RegExp æé å½æ°\n\nå¨ ES5 ä¸­ï¼RegExpæé å½æ°çåæ°æä¸¤ç§æåµã\n\nç¬¬ä¸ç§æåµæ¯ï¼åæ°æ¯å­ç¬¦ä¸²ï¼è¿æ¶ç¬¬äºä¸ªåæ°è¡¨ç¤ºæ­£åè¡¨è¾¾å¼çä¿®é¥°ç¬¦ï¼flagï¼ã\n\nvar regex = new RegExp('xyz', 'i');\n// ç­ä»·äº\nvar regex = /xyz/i;\n\n\n1\n2\n3\n\n\nç¬¬äºç§æåµæ¯ï¼åæ°æ¯ä¸ä¸ªæ­£åè¡¨ç¤ºå¼ï¼è¿æ¶ä¼è¿åä¸ä¸ªåææ­£åè¡¨è¾¾å¼çæ·è´ã\n\nvar regex = new RegExp(/xyz/i);\n// ç­ä»·äº\nvar regex = /xyz/i;\n\n\n1\n2\n3\n\n\nä½æ¯ï¼ES5 ä¸åè®¸æ­¤æ¶ä½¿ç¨ç¬¬äºä¸ªåæ°æ·»å ä¿®é¥°ç¬¦ï¼å¦åä¼æ¥éã\n\nvar regex = new RegExp(/xyz/, 'i');\n// Uncaught TypeError: Cannot supply flags when constructing one RegExp from another\n\n\n1\n2\n\n\nES6 æ¹åäºè¿ç§è¡ä¸ºãå¦æRegExpæé å½æ°ç¬¬ä¸ä¸ªåæ°æ¯ä¸ä¸ªæ­£åå¯¹è±¡ï¼é£ä¹å¯ä»¥ä½¿ç¨ç¬¬äºä¸ªåæ°æå®ä¿®é¥°ç¬¦ãèä¸ï¼è¿åçæ­£åè¡¨è¾¾å¼ä¼å¿½ç¥åæçæ­£åè¡¨è¾¾å¼çä¿®é¥°ç¬¦ï¼åªä½¿ç¨æ°æå®çä¿®é¥°ç¬¦ã\n\nnew RegExp(/abc/ig, 'i').flags\n// \"i\"\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼åææ­£åå¯¹è±¡çä¿®é¥°ç¬¦æ¯igï¼å®ä¼è¢«ç¬¬äºä¸ªåæ°iè¦çã\n\n\n# å­ç¬¦ä¸²çæ­£åæ¹æ³\n\nå­ç¬¦ä¸²å¯¹è±¡å±æ 4 ä¸ªæ¹æ³ï¼å¯ä»¥ä½¿ç¨æ­£åè¡¨è¾¾å¼ï¼match()ãreplace()ãsearch()åsplit()ã\n\nES6 å°è¿ 4 ä¸ªæ¹æ³ï¼å¨è¯­è¨åé¨å¨é¨è°ç¨RegExpçå®ä¾æ¹æ³ï¼ä»èåå°ææä¸æ­£åç¸å³çæ¹æ³ï¼å¨é½å®ä¹å¨RegExpå¯¹è±¡ä¸ã\n\n * String.prototype.match è°ç¨ RegExp.prototype[Symbol.match]\n * String.prototype.replace è°ç¨ RegExp.prototype[Symbol.replace]\n * String.prototype.search è°ç¨ RegExp.prototype[Symbol.search]\n * String.prototype.split è°ç¨ RegExp.prototype[Symbol.split]\n\n\n# u ä¿®é¥°ç¬¦\n\nES6 å¯¹æ­£åè¡¨è¾¾å¼æ·»å äºuä¿®é¥°ç¬¦ï¼å«ä¹ä¸ºâUnicode æ¨¡å¼âï¼ç¨æ¥æ­£ç¡®å¤çå¤§äº\\uFFFFç Unicode å­ç¬¦ãä¹å°±æ¯è¯´ï¼ä¼æ­£ç¡®å¤çåä¸ªå­èç UTF-16 ç¼ç ã\n\n/^\\uD83D/u.test('\\uD83D\\uDC2A') // false\n/^\\uD83D/.test('\\uD83D\\uDC2A') // true\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼\\uD83D\\uDC2Aæ¯ä¸ä¸ªåä¸ªå­èç UTF-16 ç¼ç ï¼ä»£è¡¨ä¸ä¸ªå­ç¬¦ãä½æ¯ï¼ES5 ä¸æ¯æåä¸ªå­èç UTF-16 ç¼ç ï¼ä¼å°å¶è¯å«ä¸ºä¸¤ä¸ªå­ç¬¦ï¼å¯¼è´ç¬¬äºè¡ä»£ç ç»æä¸ºtrueãå äºuä¿®é¥°ç¬¦ä»¥åï¼ES6 å°±ä¼è¯å«å¶ä¸ºä¸ä¸ªå­ç¬¦ï¼æä»¥ç¬¬ä¸è¡ä»£ç ç»æä¸ºfalseã\n\nä¸æ¦å ä¸uä¿®é¥°ç¬¦å·ï¼å°±ä¼ä¿®æ¹ä¸é¢è¿äºæ­£åè¡¨è¾¾å¼çè¡ä¸ºã\n\nï¼1ï¼ç¹å­ç¬¦\n\nç¹ï¼.ï¼å­ç¬¦å¨æ­£åè¡¨è¾¾å¼ä¸­ï¼å«ä¹æ¯é¤äºæ¢è¡ç¬¦ä»¥å¤çä»»æåä¸ªå­ç¬¦ãå¯¹äºç ç¹å¤§äº0xFFFFç Unicode å­ç¬¦ï¼ç¹å­ç¬¦ä¸è½è¯å«ï¼å¿é¡»å ä¸uä¿®é¥°ç¬¦ã\n\nvar s = 'ð ®·';\n\n/^.$/.test(s) // false\n/^.$/u.test(s) // true\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼å¦æä¸æ·»å uä¿®é¥°ç¬¦ï¼æ­£åè¡¨è¾¾å¼å°±ä¼è®¤ä¸ºå­ç¬¦ä¸²ä¸ºä¸¤ä¸ªå­ç¬¦ï¼ä»èå¹éå¤±è´¥ã\n\nï¼2ï¼Unicode å­ç¬¦è¡¨ç¤ºæ³\n\nES6 æ°å¢äºä½¿ç¨å¤§æ¬å·è¡¨ç¤º Unicode å­ç¬¦ï¼è¿ç§è¡¨ç¤ºæ³å¨æ­£åè¡¨è¾¾å¼ä¸­å¿é¡»å ä¸uä¿®é¥°ç¬¦ï¼æè½è¯å«å½ä¸­çå¤§æ¬å·ï¼å¦åä¼è¢«è§£è¯»ä¸ºéè¯ã\n\n/\\u{61}/.test('a') // false\n/\\u{61}/u.test('a') // true\n/\\u{20BB7}/u.test('ð ®·') // true\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼å¦æä¸å uä¿®é¥°ç¬¦ï¼æ­£åè¡¨è¾¾å¼æ æ³è¯å«\\u{61}è¿ç§è¡¨ç¤ºæ³ï¼åªä¼è®¤ä¸ºè¿å¹é 61 ä¸ªè¿ç»­çuã\n\nï¼3ï¼éè¯\n\nä½¿ç¨uä¿®é¥°ç¬¦åï¼ææéè¯é½ä¼æ­£ç¡®è¯å«ç ç¹å¤§äº0xFFFFç Unicode å­ç¬¦ã\n\n/a{2}/.test('aa') // true\n/a{2}/u.test('aa') // true\n/ð ®·{2}/.test('ð ®·ð ®·') // false\n/ð ®·{2}/u.test('ð ®·ð ®·') // true\n\n\n1\n2\n3\n4\n\n\nï¼4ï¼é¢å®ä¹æ¨¡å¼\n\nuä¿®é¥°ç¬¦ä¹å½±åå°é¢å®ä¹æ¨¡å¼ï¼è½å¦æ­£ç¡®è¯å«ç ç¹å¤§äº0xFFFFç Unicode å­ç¬¦ã\n\n/^\\S$/.test('ð ®·') // false\n/^\\S$/u.test('ð ®·') // true\n\n\n1\n2\n\n\nä¸é¢ä»£ç ç\\Sæ¯é¢å®ä¹æ¨¡å¼ï¼å¹éææéç©ºç½å­ç¬¦ãåªæå äºuä¿®é¥°ç¬¦ï¼å®æè½æ­£ç¡®å¹éç ç¹å¤§äº0xFFFFç Unicode å­ç¬¦ã\n\nå©ç¨è¿ä¸ç¹ï¼å¯ä»¥ååºä¸ä¸ªæ­£ç¡®è¿åå­ç¬¦ä¸²é¿åº¦çå½æ°ã\n\nfunction codePointLength(text) {\n  var result = text.match(/[\\s\\S]/gu);\n  return result ? result.length : 0;\n}\n\nvar s = 'ð ®·ð ®·';\n\ns.length // 4\ncodePointLength(s) // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nï¼5ï¼i ä¿®é¥°ç¬¦\n\næäº Unicode å­ç¬¦çç¼ç ä¸åï¼ä½æ¯å­åå¾ç¸è¿ï¼æ¯å¦ï¼\\u004Bä¸\\u212Aé½æ¯å¤§åçKã\n\n/[a-z]/i.test('\\u212A') // false\n/[a-z]/iu.test('\\u212A') // true\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸å uä¿®é¥°ç¬¦ï¼å°±æ æ³è¯å«éè§èçKå­ç¬¦ã\n\nï¼6ï¼è½¬ä¹\n\næ²¡æuä¿®é¥°ç¬¦çæåµä¸ï¼æ­£åä¸­æ²¡æå®ä¹çè½¬ä¹ï¼å¦éå·çè½¬ä¹\\,ï¼æ æï¼èå¨uæ¨¡å¼ä¼æ¥éã\n\n/\\,/ // /\\,/\n/\\,/u // æ¥é\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼æ²¡æuä¿®é¥°ç¬¦æ¶ï¼éå·åé¢çåææ æ¯æ æçï¼å äºuä¿®é¥°ç¬¦å°±æ¥éã\n\n\n# RegExp.prototype.unicode å±æ§\n\næ­£åå®ä¾å¯¹è±¡æ°å¢unicodeå±æ§ï¼è¡¨ç¤ºæ¯å¦è®¾ç½®äºuä¿®é¥°ç¬¦ã\n\nconst r1 = /hello/;\nconst r2 = /hello/u;\n\nr1.unicode // false\nr2.unicode // true\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼æ­£åè¡¨è¾¾å¼æ¯å¦è®¾ç½®äºuä¿®é¥°ç¬¦ï¼å¯ä»¥ä»unicodeå±æ§çåºæ¥ã\n\n\n# y ä¿®é¥°ç¬¦\n\né¤äºuä¿®é¥°ç¬¦ï¼ES6 è¿ä¸ºæ­£åè¡¨è¾¾å¼æ·»å äºyä¿®é¥°ç¬¦ï¼å«åâç²è¿âï¼stickyï¼ä¿®é¥°ç¬¦ã\n\nyä¿®é¥°ç¬¦çä½ç¨ä¸gä¿®é¥°ç¬¦ç±»ä¼¼ï¼ä¹æ¯å¨å±å¹éï¼åä¸æ¬¡å¹éé½ä»ä¸ä¸æ¬¡å¹éæåçä¸ä¸ä¸ªä½ç½®å¼å§ãä¸åä¹å¤å¨äºï¼gä¿®é¥°ç¬¦åªè¦å©ä½ä½ç½®ä¸­å­å¨å¹éå°±å¯ï¼èyä¿®é¥°ç¬¦ç¡®ä¿å¹éå¿é¡»ä»å©ä½çç¬¬ä¸ä¸ªä½ç½®å¼å§ï¼è¿ä¹å°±æ¯âç²è¿âçæ¶µä¹ã\n\nvar s = 'aaa_aa_a';\nvar r1 = /a+/g;\nvar r2 = /a+/y;\n\nr1.exec(s) // [\"aaa\"]\nr2.exec(s) // [\"aaa\"]\n\nr1.exec(s) // [\"aa\"]\nr2.exec(s) // null\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç æä¸¤ä¸ªæ­£åè¡¨è¾¾å¼ï¼ä¸ä¸ªä½¿ç¨gä¿®é¥°ç¬¦ï¼å¦ä¸ä¸ªä½¿ç¨yä¿®é¥°ç¬¦ãè¿ä¸¤ä¸ªæ­£åè¡¨è¾¾å¼åæ§è¡äºä¸¤æ¬¡ï¼ç¬¬ä¸æ¬¡æ§è¡çæ¶åï¼ä¸¤èè¡ä¸ºç¸åï¼å©ä½å­ç¬¦ä¸²é½æ¯_aa_aãç±äºgä¿®é¥°æ²¡æä½ç½®è¦æ±ï¼æä»¥ç¬¬äºæ¬¡æ§è¡ä¼è¿åç»æï¼èyä¿®é¥°ç¬¦è¦æ±å¹éå¿é¡»ä»å¤´é¨å¼å§ï¼æä»¥è¿ånullã\n\nå¦ææ¹ä¸ä¸æ­£åè¡¨è¾¾å¼ï¼ä¿è¯æ¯æ¬¡é½è½å¤´é¨å¹éï¼yä¿®é¥°ç¬¦å°±ä¼è¿åç»æäºã\n\nvar s = 'aaa_aa_a';\nvar r = /a+_/y;\n\nr.exec(s) // [\"aaa_\"]\nr.exec(s) // [\"aa_\"]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç æ¯æ¬¡å¹éï¼é½æ¯ä»å©ä½å­ç¬¦ä¸²çå¤´é¨å¼å§ã\n\nä½¿ç¨lastIndexå±æ§ï¼å¯ä»¥æ´å¥½å°è¯´æyä¿®é¥°ç¬¦ã\n\nconst REGEX = /a/g;\n\n// æå®ä»2å·ä½ç½®ï¼yï¼å¼å§å¹é\nREGEX.lastIndex = 2;\n\n// å¹éæå\nconst match = REGEX.exec('xaya');\n\n// å¨3å·ä½ç½®å¹éæå\nmatch.index // 3\n\n// ä¸ä¸æ¬¡å¹éä»4å·ä½å¼å§\nREGEX.lastIndex // 4\n\n// 4å·ä½å¼å§å¹éå¤±è´¥\nREGEX.exec('xaya') // null\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼lastIndexå±æ§æå®æ¯æ¬¡æç´¢çå¼å§ä½ç½®ï¼gä¿®é¥°ç¬¦ä»è¿ä¸ªä½ç½®å¼å§ååæç´¢ï¼ç´å°åç°å¹éä¸ºæ­¢ã\n\nyä¿®é¥°ç¬¦åæ ·éµå®lastIndexå±æ§ï¼ä½æ¯è¦æ±å¿é¡»å¨lastIndexæå®çä½ç½®åç°å¹éã\n\nconst REGEX = /a/y;\n\n// æå®ä»2å·ä½ç½®å¼å§å¹é\nREGEX.lastIndex = 2;\n\n// ä¸æ¯ç²è¿ï¼å¹éå¤±è´¥\nREGEX.exec('xaya') // null\n\n// æå®ä»3å·ä½ç½®å¼å§å¹é\nREGEX.lastIndex = 3;\n\n// 3å·ä½ç½®æ¯ç²è¿ï¼å¹éæå\nconst match = REGEX.exec('xaya');\nmatch.index // 3\nREGEX.lastIndex // 4\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå®éä¸ï¼yä¿®é¥°ç¬¦å·éå«äºå¤´é¨å¹éçæ å¿^ã\n\n/b/y.exec('aba')\n// null\n\n\n1\n2\n\n\nä¸é¢ä»£ç ç±äºä¸è½ä¿è¯å¤´é¨å¹éï¼æä»¥è¿ånullãyä¿®é¥°ç¬¦çè®¾è®¡æ¬æï¼å°±æ¯è®©å¤´é¨å¹éçæ å¿^å¨å¨å±å¹éä¸­é½ææã\n\nä¸é¢æ¯å­ç¬¦ä¸²å¯¹è±¡çreplaceæ¹æ³çä¾å­ã\n\nconst REGEX = /a/gy;\n'aaxa'.replace(REGEX, '-') // '--xa'\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼æåä¸ä¸ªaå ä¸ºä¸æ¯åºç°å¨ä¸ä¸æ¬¡å¹éçå¤´é¨ï¼æä»¥ä¸ä¼è¢«æ¿æ¢ã\n\nååä¸ä¸ªyä¿®é¥°ç¬¦å¯¹matchæ¹æ³ï¼åªè½è¿åç¬¬ä¸ä¸ªå¹éï¼å¿é¡»ä¸gä¿®é¥°ç¬¦èç¨ï¼æè½è¿åææå¹éã\n\n'a1a2a3'.match(/a\\d/y) // [\"a1\"]\n'a1a2a3'.match(/a\\d/gy) // [\"a1\", \"a2\", \"a3\"]\n\n\n1\n2\n\n\nyä¿®é¥°ç¬¦çä¸ä¸ªåºç¨ï¼æ¯ä»å­ç¬¦ä¸²æå tokenï¼è¯åï¼ï¼yä¿®é¥°ç¬¦ç¡®ä¿äºå¹éä¹é´ä¸ä¼ææ¼æçå­ç¬¦ã\n\nconst TOKEN_Y = /\\s*(\\+|[0-9]+)\\s*/y;\nconst TOKEN_G  = /\\s*(\\+|[0-9]+)\\s*/g;\n\ntokenize(TOKEN_Y, '3 + 4')\n// [ '3', '+', '4' ]\ntokenize(TOKEN_G, '3 + 4')\n// [ '3', '+', '4' ]\n\nfunction tokenize(TOKEN_REGEX, str) {\n  let result = [];\n  let match;\n  while (match = TOKEN_REGEX.exec(str)) {\n    result.push(match[1]);\n  }\n  return result;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æå­ç¬¦ä¸²éé¢æ²¡æéæ³å­ç¬¦ï¼yä¿®é¥°ç¬¦ä¸gä¿®é¥°ç¬¦çæåç»ææ¯ä¸æ ·çãä½æ¯ï¼ä¸æ¦åºç°éæ³å­ç¬¦ï¼ä¸¤èçè¡ä¸ºå°±ä¸ä¸æ ·äºã\n\ntokenize(TOKEN_Y, '3x + 4')\n// [ '3' ]\ntokenize(TOKEN_G, '3x + 4')\n// [ '3', '+', '4' ]\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼gä¿®é¥°ç¬¦ä¼å¿½ç¥éæ³å­ç¬¦ï¼èyä¿®é¥°ç¬¦ä¸ä¼ï¼è¿æ ·å°±å¾å®¹æåç°éè¯¯ã\n\n\n# RegExp.prototype.sticky å±æ§\n\nä¸yä¿®é¥°ç¬¦ç¸å¹éï¼ES6 çæ­£åå®ä¾å¯¹è±¡å¤äºstickyå±æ§ï¼è¡¨ç¤ºæ¯å¦è®¾ç½®äºyä¿®é¥°ç¬¦ã\n\nvar r = /hello\\d/y;\nr.sticky // true\n\n\n1\n2\n\n\n\n# RegExp.prototype.flags å±æ§\n\nES6 ä¸ºæ­£åè¡¨è¾¾å¼æ°å¢äºflagså±æ§ï¼ä¼è¿åæ­£åè¡¨è¾¾å¼çä¿®é¥°ç¬¦ã\n\n// ES5 ç source å±æ§\n// è¿åæ­£åè¡¨è¾¾å¼çæ­£æ\n/abc/ig.source\n// \"abc\"\n\n// ES6 ç flags å±æ§\n// è¿åæ­£åè¡¨è¾¾å¼çä¿®é¥°ç¬¦\n/abc/ig.flags\n// 'gi'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# s ä¿®é¥°ç¬¦ï¼dotAll æ¨¡å¼\n\næ­£åè¡¨è¾¾å¼ä¸­ï¼ç¹ï¼.ï¼æ¯ä¸ä¸ªç¹æ®å­ç¬¦ï¼ä»£è¡¨ä»»æçåä¸ªå­ç¬¦ï¼ä½æ¯æä¸¤ä¸ªä¾å¤ãä¸ä¸ªæ¯åä¸ªå­èç UTF-16 å­ç¬¦ï¼è¿ä¸ªå¯ä»¥ç¨uä¿®é¥°ç¬¦è§£å³ï¼å¦ä¸ä¸ªæ¯è¡ç»æ­¢ç¬¦ï¼line terminator characterï¼ã\n\næè°è¡ç»æ­¢ç¬¦ï¼å°±æ¯è¯¥å­ç¬¦è¡¨ç¤ºä¸è¡çç»ç»ãä»¥ä¸åä¸ªå­ç¬¦å±äºâè¡ç»æ­¢ç¬¦âã\n\n * U+000A æ¢è¡ç¬¦ï¼\\nï¼\n * U+000D åè½¦ç¬¦ï¼\\rï¼\n * U+2028 è¡åéç¬¦ï¼line separatorï¼\n * U+2029 æ®µåéç¬¦ï¼paragraph separatorï¼\n\n/foo.bar/.test('foo\\nbar')\n// false\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼å ä¸º.ä¸å¹é\\nï¼æä»¥æ­£åè¡¨è¾¾å¼è¿åfalseã\n\nä½æ¯ï¼å¾å¤æ¶åæä»¬å¸æå¹éçæ¯ä»»æåä¸ªå­ç¬¦ï¼è¿æ¶æä¸ç§åéçåæ³ã\n\n/foo[^]bar/.test('foo\\nbar')\n// true\n\n\n1\n2\n\n\nè¿ç§è§£å³æ¹æ¡æ¯ç«ä¸å¤ªç¬¦åç´è§ï¼ES2018 å¼å¥sä¿®é¥°ç¬¦ï¼ä½¿å¾.å¯ä»¥å¹éä»»æåä¸ªå­ç¬¦ã\n\n/foo.bar/s.test('foo\\nbar') // true\n\n\n1\n\n\nè¿è¢«ç§°ä¸ºdotAllæ¨¡å¼ï¼å³ç¹ï¼dotï¼ä»£è¡¨ä¸åå­ç¬¦ãæä»¥ï¼æ­£åè¡¨è¾¾å¼è¿å¼å¥äºä¸ä¸ªdotAllå±æ§ï¼è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºè¯¥æ­£åè¡¨è¾¾å¼æ¯å¦å¤å¨dotAllæ¨¡å¼ã\n\nconst re = /foo.bar/s;\n// å¦ä¸ç§åæ³\n// const re = new RegExp('foo.bar', 's');\n\nre.test('foo\\nbar') // true\nre.dotAll // true\nre.flags // 's'\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n/sä¿®é¥°ç¬¦åå¤è¡ä¿®é¥°ç¬¦/mä¸å²çªï¼ä¸¤èä¸èµ·ä½¿ç¨çæåµä¸ï¼.å¹éææå­ç¬¦ï¼è^å$å¹éæ¯ä¸è¡çè¡é¦åè¡å°¾ã\n\n\n# åè¡æ­è¨\n\nJavaScript è¯­è¨çæ­£åè¡¨è¾¾å¼ï¼åªæ¯æåè¡æ­è¨ï¼lookaheadï¼ååè¡å¦å®æ­è¨ï¼negative lookaheadï¼ï¼ä¸æ¯æåè¡æ­è¨ï¼lookbehindï¼ååè¡å¦å®æ­è¨ï¼negative lookbehindï¼ãES2018 å¼å¥åè¡æ­è¨ï¼V8 å¼æ 4.9 çï¼Chrome 62ï¼å·²ç»æ¯æã\n\nâåè¡æ­è¨âæçæ¯ï¼xåªæå¨yåé¢æå¹éï¼å¿é¡»åæ/x(?=y)/ãæ¯å¦ï¼åªå¹éç¾åå·ä¹åçæ°å­ï¼è¦åæ/\\d+(?=%)/ãâåè¡å¦å®æ­è¨âæçæ¯ï¼xåªæä¸å¨yåé¢æå¹éï¼å¿é¡»åæ/x(?!y)/ãæ¯å¦ï¼åªå¹éä¸å¨ç¾åå·ä¹åçæ°å­ï¼è¦åæ/\\d+(?!%)/ã\n\n/\\d+(?=%)/.exec('100% of US presidents have been male')  // [\"100\"]\n/\\d+(?!%)/.exec('thatâs all 44 of them')                 // [\"44\"]\n\n\n1\n2\n\n\nä¸é¢ä¸¤ä¸ªå­ç¬¦ä¸²ï¼å¦æäºæ¢æ­£åè¡¨è¾¾å¼ï¼å°±ä¸ä¼å¾å°ç¸åç»æãå¦å¤ï¼è¿å¯ä»¥çå°ï¼âåè¡æ­è¨âæ¬å·ä¹ä¸­çé¨åï¼(?=%)ï¼ï¼æ¯ä¸è®¡å¥è¿åç»æçã\n\nâåè¡æ­è¨âæ­£å¥½ä¸âåè¡æ­è¨âç¸åï¼xåªæå¨yåé¢æå¹éï¼å¿é¡»åæ/(?<=y)x/ãæ¯å¦ï¼åªå¹éç¾åç¬¦å·ä¹åçæ°å­ï¼è¦åæ/(?<=\\$)\\d+/ãâåè¡å¦å®æ­è¨âåä¸âåè¡å¦å®æ­è¨âç¸åï¼xåªæä¸å¨yåé¢æå¹éï¼å¿é¡»åæ/(?<!y)x/ãæ¯å¦ï¼åªå¹éä¸å¨ç¾åç¬¦å·åé¢çæ°å­ï¼è¦åæ/(?<!\\$)\\d+/ã\n\n/(?<=\\$)\\d+/.exec('Benjamin Franklin is on the $100 bill')  // [\"100\"]\n/(?<!\\$)\\d+/.exec('itâs is worth about â¬90')                // [\"90\"]\n\n\n1\n2\n\n\nä¸é¢çä¾å­ä¸­ï¼âåè¡æ­è¨âçæ¬å·ä¹ä¸­çé¨åï¼(?<=\\$)ï¼ï¼ä¹æ¯ä¸è®¡å¥è¿åç»æã\n\nä¸é¢çä¾å­æ¯ä½¿ç¨åè¡æ­è¨è¿è¡å­ç¬¦ä¸²æ¿æ¢ã\n\nconst RE_DOLLAR_PREFIX = /(?<=\\$)foo/g;\n'$foo %foo foo'.replace(RE_DOLLAR_PREFIX, 'bar');\n// '$bar %foo foo'\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼åªæå¨ç¾åç¬¦å·åé¢çfooæä¼è¢«æ¿æ¢ã\n\nâåè¡æ­è¨âçå®ç°ï¼éè¦åå¹é/(?<=y)x/çxï¼ç¶åååå°å·¦è¾¹ï¼å¹éyçé¨åãè¿ç§âåå³åå·¦âçæ§è¡é¡ºåºï¼ä¸ææå¶ä»æ­£åæä½ç¸åï¼å¯¼è´äºä¸äºä¸ç¬¦åé¢æçè¡ä¸ºã\n\né¦åï¼åè¡æ­è¨çç»å¹éï¼ä¸æ­£å¸¸æåµä¸ç»ææ¯ä¸ä¸æ ·çã\n\n/(?<=(\\d+)(\\d+))$/.exec('1053') // [\"\", \"1\", \"053\"]\n/^(\\d+)(\\d+)$/.exec('1053') // [\"1053\", \"105\", \"3\"]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼éè¦ææä¸¤ä¸ªç»å¹éãæ²¡æâåè¡æ­è¨âæ¶ï¼ç¬¬ä¸ä¸ªæ¬å·æ¯è´ªå©ªæ¨¡å¼ï¼ç¬¬äºä¸ªæ¬å·åªè½æè·ä¸ä¸ªå­ç¬¦ï¼æä»¥ç»ææ¯105å3ãèâåè¡æ­è¨âæ¶ï¼ç±äºæ§è¡é¡ºåºæ¯ä»å³å°å·¦ï¼ç¬¬äºä¸ªæ¬å·æ¯è´ªå©ªæ¨¡å¼ï¼ç¬¬ä¸ä¸ªæ¬å·åªè½æè·ä¸ä¸ªå­ç¬¦ï¼æä»¥ç»ææ¯1å053ã\n\nå¶æ¬¡ï¼âåè¡æ­è¨âçåææ å¼ç¨ï¼ä¹ä¸éå¸¸çé¡ºåºç¸åï¼å¿é¡»æ¾å¨å¯¹åºçé£ä¸ªæ¬å·ä¹åã\n\n/(?<=(o)d\\1)r/.exec('hodor')  // null\n/(?<=\\1d(o))r/.exec('hodor')  // [\"r\", \"o\"]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æåè¡æ­è¨çåææ å¼ç¨ï¼\\1ï¼æ¾å¨æ¬å·çåé¢ï¼å°±ä¸ä¼å¾å°å¹éç»æï¼å¿é¡»æ¾å¨åé¢æå¯ä»¥ãå ä¸ºåè¡æ­è¨æ¯åä»å·¦å°å³æ«æï¼åç°å¹éä»¥åååè¿å¤´ï¼ä»å³å°å·¦å®æåææ å¼ç¨ã\n\n\n# Unicode å±æ§ç±»\n\nES2018 å¼å¥äºä¸ç§æ°çç±»çåæ³\\p{...}å\\P{...}ï¼åè®¸æ­£åè¡¨è¾¾å¼å¹éç¬¦å Unicode æç§å±æ§çææå­ç¬¦ã\n\nconst regexGreekSymbol = /\\p{Script=Greek}/u;\nregexGreekSymbol.test('Ï') // true\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼\\p{Script=Greek}æå®å¹éä¸ä¸ªå¸èæå­æ¯ï¼æä»¥å¹éÏæåã\n\nUnicode å±æ§ç±»è¦æå®å±æ§ååå±æ§å¼ã\n\n\\p{UnicodePropertyName=UnicodePropertyValue}\n\n\n1\n\n\nå¯¹äºæäºå±æ§ï¼å¯ä»¥åªåå±æ§åï¼æèåªåå±æ§å¼ã\n\n\\p{UnicodePropertyName}\n\\p{UnicodePropertyValue}\n\n\n1\n2\n\n\n\\P{â¦}æ¯\\p{â¦}çååå¹éï¼å³å¹éä¸æ»¡è¶³æ¡ä»¶çå­ç¬¦ã\n\næ³¨æï¼è¿ä¸¤ç§ç±»åªå¯¹ Unicode ææï¼æä»¥ä½¿ç¨çæ¶åä¸å®è¦å ä¸uä¿®é¥°ç¬¦ãå¦æä¸å uä¿®é¥°ç¬¦ï¼æ­£åè¡¨è¾¾å¼ä½¿ç¨\\på\\Pä¼æ¥éï¼ECMAScript é¢çäºè¿ä¸¤ä¸ªç±»ã\n\nç±äº Unicode çåç§å±æ§éå¸¸å¤ï¼æä»¥è¿ç§æ°çç±»çè¡¨è¾¾è½åéå¸¸å¼ºã\n\nconst regex = /^\\p{Decimal_Number}+$/u;\nregex.test('ððððððð©ðªð«ð¬ð­ð®ð¯ðºð»ð¼') // true\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼å±æ§ç±»æå®å¹éææåè¿å¶å­ç¬¦ï¼å¯ä»¥çå°åç§å­åçåè¿å¶å­ç¬¦é½ä¼å¹éæåã\n\n\\p{Number}çè³è½å¹éç½é©¬æ°å­ã\n\n// å¹éæææ°å­\nconst regex = /^\\p{Number}+$/u;\nregex.test('Â²Â³Â¹Â¼Â½Â¾') // true\nregex.test('ããã') // true\nregex.test('â â¡â¢â£â¤â¥â¦â§â¨â©âªâ«') // true\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢æ¯å¶ä»ä¸äºä¾å­ã\n\n// å¹éææç©ºæ ¼\n\\p{White_Space}\n\n// å¹éåç§æå­çææå­æ¯ï¼ç­åäº Unicode çç \\w\n[\\p{Alphabetic}\\p{Mark}\\p{Decimal_Number}\\p{Connector_Punctuation}\\p{Join_Control}]\n\n// å¹éåç§æå­çææéå­æ¯çå­ç¬¦ï¼ç­åäº Unicode çç \\W\n[^\\p{Alphabetic}\\p{Mark}\\p{Decimal_Number}\\p{Connector_Punctuation}\\p{Join_Control}]\n\n// å¹é Emoji\n/\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?|\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F/gu\n\n// å¹éææçç®­å¤´å­ç¬¦\nconst regexArrows = /^\\p{Block=Arrows}+$/u;\nregexArrows.test('ââââââââââââââââââââââ§â©') // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# å·åç»å¹é\n\n\n# ç®ä»\n\næ­£åè¡¨è¾¾å¼ä½¿ç¨åæ¬å·è¿è¡ç»å¹éã\n\nconst RE_DATE = /(\\d{4})-(\\d{2})-(\\d{2})/;\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼æ­£åè¡¨è¾¾å¼éé¢æä¸ç»åæ¬å·ãä½¿ç¨execæ¹æ³ï¼å°±å¯ä»¥å°è¿ä¸ç»å¹éç»ææååºæ¥ã\n\nconst RE_DATE = /(\\d{4})-(\\d{2})-(\\d{2})/;\n\nconst matchObj = RE_DATE.exec('1999-12-31');\nconst year = matchObj[1]; // 1999\nconst month = matchObj[2]; // 12\nconst day = matchObj[3]; // 31\n\n\n1\n2\n3\n4\n5\n6\n\n\nç»å¹éçä¸ä¸ªé®é¢æ¯ï¼æ¯ä¸ç»çå¹éå«ä¹ä¸å®¹æçåºæ¥ï¼èä¸åªè½ç¨æ°å­åºå·ï¼æ¯å¦matchObj[1]ï¼å¼ç¨ï¼è¦æ¯ç»çé¡ºåºåäºï¼å¼ç¨çæ¶åå°±å¿é¡»ä¿®æ¹åºå·ã\n\nES2018 å¼å¥äºå·åç»å¹éï¼Named Capture Groupsï¼ï¼åè®¸ä¸ºæ¯ä¸ä¸ªç»å¹éæå®ä¸ä¸ªåå­ï¼æ¢ä¾¿äºéè¯»ä»£ç ï¼åä¾¿äºå¼ç¨ã\n\nconst RE_DATE = /(?<year>\\d{4})-(?<month>\\d{2})-(?<day>\\d{2})/;\n\nconst matchObj = RE_DATE.exec('1999-12-31');\nconst year = matchObj.groups.year; // 1999\nconst month = matchObj.groups.month; // 12\nconst day = matchObj.groups.day; // 31\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼âå·åç»å¹éâå¨åæ¬å·åé¨ï¼æ¨¡å¼çå¤´é¨æ·»å âé®å· + å°æ¬å· + ç»åâï¼?<year>ï¼ï¼ç¶åå°±å¯ä»¥å¨execæ¹æ³è¿åç»æçgroupså±æ§ä¸å¼ç¨è¯¥ç»åãåæ¶ï¼æ°å­åºå·ï¼matchObj[1]ï¼ä¾ç¶ææã\n\nå·åç»å¹éç­äºä¸ºæ¯ä¸ç»å¹éå ä¸äº IDï¼ä¾¿äºæè¿°å¹éçç®çãå¦æç»çé¡ºåºåäºï¼ä¹ä¸ç¨æ¹åå¹éåçå¤çä»£ç ã\n\nå¦æå·åç»æ²¡æå¹éï¼é£ä¹å¯¹åºçgroupså¯¹è±¡å±æ§ä¼æ¯undefinedã\n\nconst RE_OPT_A = /^(?<as>a+)?$/;\nconst matchObj = RE_OPT_A.exec('');\n\nmatchObj.groups.as // undefined\n'as' in matchObj.groups // true\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å·åç»asæ²¡ææ¾å°å¹éï¼é£ä¹matchObj.groups.aså±æ§å¼å°±æ¯undefinedï¼å¹¶ä¸asè¿ä¸ªé®åå¨groupsæ¯å§ç»å­å¨çã\n\n\n# è§£æèµå¼åæ¿æ¢\n\næäºå·åç»å¹éä»¥åï¼å¯ä»¥ä½¿ç¨è§£æèµå¼ç´æ¥ä»å¹éç»æä¸ä¸ºåéèµå¼ã\n\nlet {groups: {one, two}} = /^(?<one>.*):(?<two>.*)$/u.exec('foo:bar');\none  // foo\ntwo  // bar\n\n\n1\n2\n3\n\n\nå­ç¬¦ä¸²æ¿æ¢æ¶ï¼ä½¿ç¨$<ç»å>å¼ç¨å·åç»ã\n\nlet re = /(?<year>\\d{4})-(?<month>\\d{2})-(?<day>\\d{2})/u;\n\n'2015-01-02'.replace(re, '$<day>/$<month>/$<year>')\n// '02/01/2015'\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼replaceæ¹æ³çç¬¬äºä¸ªåæ°æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼èä¸æ¯æ­£åè¡¨è¾¾å¼ã\n\nreplaceæ¹æ³çç¬¬äºä¸ªåæ°ä¹å¯ä»¥æ¯å½æ°ï¼è¯¥å½æ°çåæ°åºåå¦ä¸ã\n\n'2015-01-02'.replace(re, (\n   matched, // æ´ä¸ªå¹éç»æ 2015-01-02\n   capture1, // ç¬¬ä¸ä¸ªç»å¹é 2015\n   capture2, // ç¬¬äºä¸ªç»å¹é 01\n   capture3, // ç¬¬ä¸ä¸ªç»å¹é 02\n   position, // å¹éå¼å§çä½ç½® 0\n   S, // åå­ç¬¦ä¸² 2015-01-02\n   groups // å·åç»ææçä¸ä¸ªå¯¹è±¡ {year, month, day}\n ) => {\n let {day, month, year} = groups;\n return `${day}/${month}/${year}`;\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå·åç»å¹éå¨åæ¥çåºç¡ä¸ï¼æ°å¢äºæåä¸ä¸ªå½æ°åæ°ï¼å·åç»ææçä¸ä¸ªå¯¹è±¡ãå½æ°åé¨å¯ä»¥ç´æ¥å¯¹è¿ä¸ªå¯¹è±¡è¿è¡è§£æèµå¼ã\n\n\n# å¼ç¨\n\nå¦æè¦å¨æ­£åè¡¨è¾¾å¼åé¨å¼ç¨æä¸ªâå·åç»å¹éâï¼å¯ä»¥ä½¿ç¨\\k<ç»å>çåæ³ã\n\nconst RE_TWICE = /^(?<word>[a-z]+)!\\k<word>$/;\nRE_TWICE.test('abc!abc') // true\nRE_TWICE.test('abc!ab') // false\n\n\n1\n2\n3\n\n\næ°å­å¼ç¨ï¼\\1ï¼ä¾ç¶ææã\n\nconst RE_TWICE = /^(?<word>[a-z]+)!\\1$/;\nRE_TWICE.test('abc!abc') // true\nRE_TWICE.test('abc!ab') // false\n\n\n1\n2\n3\n\n\nè¿ä¸¤ç§å¼ç¨è¯­æ³è¿å¯ä»¥åæ¶ä½¿ç¨ã\n\nconst RE_TWICE = /^(?<word>[a-z]+)!\\k<word>!\\1$/;\nRE_TWICE.test('abc!abc!abc') // true\nRE_TWICE.test('abc!abc!ab') // false\n\n\n1\n2\n3\n\n\n\n# String.prototype.matchAll()\n\nå¦æä¸ä¸ªæ­£åè¡¨è¾¾å¼å¨å­ç¬¦ä¸²éé¢æå¤ä¸ªå¹éï¼ç°å¨ä¸è¬ä½¿ç¨gä¿®é¥°ç¬¦æyä¿®é¥°ç¬¦ï¼å¨å¾ªç¯éé¢éä¸ååºã\n\nvar regex = /t(e)(st(\\d?))/g;\nvar string = 'test1test2test3';\n\nvar matches = [];\nvar match;\nwhile (match = regex.exec(string)) {\n  matches.push(match);\n}\n\nmatches\n// [\n//   [\"test1\", \"e\", \"st1\", \"1\", index: 0, input: \"test1test2test3\"],\n//   [\"test2\", \"e\", \"st2\", \"2\", index: 5, input: \"test1test2test3\"],\n//   [\"test3\", \"e\", \"st3\", \"3\", index: 10, input: \"test1test2test3\"]\n// ]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼whileå¾ªç¯ååºæ¯ä¸è½®çæ­£åå¹éï¼ä¸å±ä¸è½®ã\n\nES2020 å¢å äºString.prototype.matchAll()æ¹æ³ï¼å¯ä»¥ä¸æ¬¡æ§ååºææå¹éãä¸è¿ï¼å®è¿åçæ¯ä¸ä¸ªéåå¨ï¼Iteratorï¼ï¼èä¸æ¯æ°ç»ã\n\nconst string = 'test1test2test3';\n\n// g ä¿®é¥°ç¬¦å ä¸å é½å¯ä»¥\nconst regex = /t(e)(st(\\d?))/g;\n\nfor (const match of string.matchAll(regex)) {\n  console.log(match);\n}\n// [\"test1\", \"e\", \"st1\", \"1\", index: 0, input: \"test1test2test3\"]\n// [\"test2\", \"e\", \"st2\", \"2\", index: 5, input: \"test1test2test3\"]\n// [\"test3\", \"e\", \"st3\", \"3\", index: 10, input: \"test1test2test3\"]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºstring.matchAll(regex)è¿åçæ¯éåå¨ï¼æä»¥å¯ä»¥ç¨for...ofå¾ªç¯ååºãç¸å¯¹äºè¿åæ°ç»ï¼è¿åéåå¨çå¥½å¤å¨äºï¼å¦æå¹éç»ææ¯ä¸ä¸ªå¾å¤§çæ°ç»ï¼é£ä¹éåå¨æ¯è¾èçèµæºã\n\néåå¨è½¬ä¸ºæ°ç»æ¯éå¸¸ç®åçï¼ä½¿ç¨...è¿ç®ç¬¦åArray.from()æ¹æ³å°±å¯ä»¥äºã\n\n// è½¬ä¸ºæ°ç»æ¹æ³ä¸\n[...string.matchAll(regex)]\n\n// è½¬ä¸ºæ°ç»æ¹æ³äº\nArray.from(string.matchAll(regex))\n\n\n1\n2\n3\n4\n5\n",normalizedContent:"# æ­£åçæ©å±\n\n\n# regexp æé å½æ°\n\nå¨ es5 ä¸­ï¼regexpæé å½æ°çåæ°æä¸¤ç§æåµã\n\nç¬¬ä¸ç§æåµæ¯ï¼åæ°æ¯å­ç¬¦ä¸²ï¼è¿æ¶ç¬¬äºä¸ªåæ°è¡¨ç¤ºæ­£åè¡¨è¾¾å¼çä¿®é¥°ç¬¦ï¼flagï¼ã\n\nvar regex = new regexp('xyz', 'i');\n// ç­ä»·äº\nvar regex = /xyz/i;\n\n\n1\n2\n3\n\n\nç¬¬äºç§æåµæ¯ï¼åæ°æ¯ä¸ä¸ªæ­£åè¡¨ç¤ºå¼ï¼è¿æ¶ä¼è¿åä¸ä¸ªåææ­£åè¡¨è¾¾å¼çæ·è´ã\n\nvar regex = new regexp(/xyz/i);\n// ç­ä»·äº\nvar regex = /xyz/i;\n\n\n1\n2\n3\n\n\nä½æ¯ï¼es5 ä¸åè®¸æ­¤æ¶ä½¿ç¨ç¬¬äºä¸ªåæ°æ·»å ä¿®é¥°ç¬¦ï¼å¦åä¼æ¥éã\n\nvar regex = new regexp(/xyz/, 'i');\n// uncaught typeerror: cannot supply flags when constructing one regexp from another\n\n\n1\n2\n\n\nes6 æ¹åäºè¿ç§è¡ä¸ºãå¦æregexpæé å½æ°ç¬¬ä¸ä¸ªåæ°æ¯ä¸ä¸ªæ­£åå¯¹è±¡ï¼é£ä¹å¯ä»¥ä½¿ç¨ç¬¬äºä¸ªåæ°æå®ä¿®é¥°ç¬¦ãèä¸ï¼è¿åçæ­£åè¡¨è¾¾å¼ä¼å¿½ç¥åæçæ­£åè¡¨è¾¾å¼çä¿®é¥°ç¬¦ï¼åªä½¿ç¨æ°æå®çä¿®é¥°ç¬¦ã\n\nnew regexp(/abc/ig, 'i').flags\n// \"i\"\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼åææ­£åå¯¹è±¡çä¿®é¥°ç¬¦æ¯igï¼å®ä¼è¢«ç¬¬äºä¸ªåæ°iè¦çã\n\n\n# å­ç¬¦ä¸²çæ­£åæ¹æ³\n\nå­ç¬¦ä¸²å¯¹è±¡å±æ 4 ä¸ªæ¹æ³ï¼å¯ä»¥ä½¿ç¨æ­£åè¡¨è¾¾å¼ï¼match()ãreplace()ãsearch()åsplit()ã\n\nes6 å°è¿ 4 ä¸ªæ¹æ³ï¼å¨è¯­è¨åé¨å¨é¨è°ç¨regexpçå®ä¾æ¹æ³ï¼ä»èåå°ææä¸æ­£åç¸å³çæ¹æ³ï¼å¨é½å®ä¹å¨regexpå¯¹è±¡ä¸ã\n\n * string.prototype.match è°ç¨ regexp.prototype[symbol.match]\n * string.prototype.replace è°ç¨ regexp.prototype[symbol.replace]\n * string.prototype.search è°ç¨ regexp.prototype[symbol.search]\n * string.prototype.split è°ç¨ regexp.prototype[symbol.split]\n\n\n# u ä¿®é¥°ç¬¦\n\nes6 å¯¹æ­£åè¡¨è¾¾å¼æ·»å äºuä¿®é¥°ç¬¦ï¼å«ä¹ä¸ºâunicode æ¨¡å¼âï¼ç¨æ¥æ­£ç¡®å¤çå¤§äº\\uffffç unicode å­ç¬¦ãä¹å°±æ¯è¯´ï¼ä¼æ­£ç¡®å¤çåä¸ªå­èç utf-16 ç¼ç ã\n\n/^\\ud83d/u.test('\\ud83d\\udc2a') // false\n/^\\ud83d/.test('\\ud83d\\udc2a') // true\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼\\ud83d\\udc2aæ¯ä¸ä¸ªåä¸ªå­èç utf-16 ç¼ç ï¼ä»£è¡¨ä¸ä¸ªå­ç¬¦ãä½æ¯ï¼es5 ä¸æ¯æåä¸ªå­èç utf-16 ç¼ç ï¼ä¼å°å¶è¯å«ä¸ºä¸¤ä¸ªå­ç¬¦ï¼å¯¼è´ç¬¬äºè¡ä»£ç ç»æä¸ºtrueãå äºuä¿®é¥°ç¬¦ä»¥åï¼es6 å°±ä¼è¯å«å¶ä¸ºä¸ä¸ªå­ç¬¦ï¼æä»¥ç¬¬ä¸è¡ä»£ç ç»æä¸ºfalseã\n\nä¸æ¦å ä¸uä¿®é¥°ç¬¦å·ï¼å°±ä¼ä¿®æ¹ä¸é¢è¿äºæ­£åè¡¨è¾¾å¼çè¡ä¸ºã\n\nï¼1ï¼ç¹å­ç¬¦\n\nç¹ï¼.ï¼å­ç¬¦å¨æ­£åè¡¨è¾¾å¼ä¸­ï¼å«ä¹æ¯é¤äºæ¢è¡ç¬¦ä»¥å¤çä»»æåä¸ªå­ç¬¦ãå¯¹äºç ç¹å¤§äº0xffffç unicode å­ç¬¦ï¼ç¹å­ç¬¦ä¸è½è¯å«ï¼å¿é¡»å ä¸uä¿®é¥°ç¬¦ã\n\nvar s = 'ð ®·';\n\n/^.$/.test(s) // false\n/^.$/u.test(s) // true\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼å¦æä¸æ·»å uä¿®é¥°ç¬¦ï¼æ­£åè¡¨è¾¾å¼å°±ä¼è®¤ä¸ºå­ç¬¦ä¸²ä¸ºä¸¤ä¸ªå­ç¬¦ï¼ä»èå¹éå¤±è´¥ã\n\nï¼2ï¼unicode å­ç¬¦è¡¨ç¤ºæ³\n\nes6 æ°å¢äºä½¿ç¨å¤§æ¬å·è¡¨ç¤º unicode å­ç¬¦ï¼è¿ç§è¡¨ç¤ºæ³å¨æ­£åè¡¨è¾¾å¼ä¸­å¿é¡»å ä¸uä¿®é¥°ç¬¦ï¼æè½è¯å«å½ä¸­çå¤§æ¬å·ï¼å¦åä¼è¢«è§£è¯»ä¸ºéè¯ã\n\n/\\u{61}/.test('a') // false\n/\\u{61}/u.test('a') // true\n/\\u{20bb7}/u.test('ð ®·') // true\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼å¦æä¸å uä¿®é¥°ç¬¦ï¼æ­£åè¡¨è¾¾å¼æ æ³è¯å«\\u{61}è¿ç§è¡¨ç¤ºæ³ï¼åªä¼è®¤ä¸ºè¿å¹é 61 ä¸ªè¿ç»­çuã\n\nï¼3ï¼éè¯\n\nä½¿ç¨uä¿®é¥°ç¬¦åï¼ææéè¯é½ä¼æ­£ç¡®è¯å«ç ç¹å¤§äº0xffffç unicode å­ç¬¦ã\n\n/a{2}/.test('aa') // true\n/a{2}/u.test('aa') // true\n/ð ®·{2}/.test('ð ®·ð ®·') // false\n/ð ®·{2}/u.test('ð ®·ð ®·') // true\n\n\n1\n2\n3\n4\n\n\nï¼4ï¼é¢å®ä¹æ¨¡å¼\n\nuä¿®é¥°ç¬¦ä¹å½±åå°é¢å®ä¹æ¨¡å¼ï¼è½å¦æ­£ç¡®è¯å«ç ç¹å¤§äº0xffffç unicode å­ç¬¦ã\n\n/^\\s$/.test('ð ®·') // false\n/^\\s$/u.test('ð ®·') // true\n\n\n1\n2\n\n\nä¸é¢ä»£ç ç\\sæ¯é¢å®ä¹æ¨¡å¼ï¼å¹éææéç©ºç½å­ç¬¦ãåªæå äºuä¿®é¥°ç¬¦ï¼å®æè½æ­£ç¡®å¹éç ç¹å¤§äº0xffffç unicode å­ç¬¦ã\n\nå©ç¨è¿ä¸ç¹ï¼å¯ä»¥ååºä¸ä¸ªæ­£ç¡®è¿åå­ç¬¦ä¸²é¿åº¦çå½æ°ã\n\nfunction codepointlength(text) {\n  var result = text.match(/[\\s\\s]/gu);\n  return result ? result.length : 0;\n}\n\nvar s = 'ð ®·ð ®·';\n\ns.length // 4\ncodepointlength(s) // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nï¼5ï¼i ä¿®é¥°ç¬¦\n\næäº unicode å­ç¬¦çç¼ç ä¸åï¼ä½æ¯å­åå¾ç¸è¿ï¼æ¯å¦ï¼\\u004bä¸\\u212aé½æ¯å¤§åçkã\n\n/[a-z]/i.test('\\u212a') // false\n/[a-z]/iu.test('\\u212a') // true\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸å uä¿®é¥°ç¬¦ï¼å°±æ æ³è¯å«éè§èçkå­ç¬¦ã\n\nï¼6ï¼è½¬ä¹\n\næ²¡æuä¿®é¥°ç¬¦çæåµä¸ï¼æ­£åä¸­æ²¡æå®ä¹çè½¬ä¹ï¼å¦éå·çè½¬ä¹\\,ï¼æ æï¼èå¨uæ¨¡å¼ä¼æ¥éã\n\n/\\,/ // /\\,/\n/\\,/u // æ¥é\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼æ²¡æuä¿®é¥°ç¬¦æ¶ï¼éå·åé¢çåææ æ¯æ æçï¼å äºuä¿®é¥°ç¬¦å°±æ¥éã\n\n\n# regexp.prototype.unicode å±æ§\n\næ­£åå®ä¾å¯¹è±¡æ°å¢unicodeå±æ§ï¼è¡¨ç¤ºæ¯å¦è®¾ç½®äºuä¿®é¥°ç¬¦ã\n\nconst r1 = /hello/;\nconst r2 = /hello/u;\n\nr1.unicode // false\nr2.unicode // true\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼æ­£åè¡¨è¾¾å¼æ¯å¦è®¾ç½®äºuä¿®é¥°ç¬¦ï¼å¯ä»¥ä»unicodeå±æ§çåºæ¥ã\n\n\n# y ä¿®é¥°ç¬¦\n\né¤äºuä¿®é¥°ç¬¦ï¼es6 è¿ä¸ºæ­£åè¡¨è¾¾å¼æ·»å äºyä¿®é¥°ç¬¦ï¼å«åâç²è¿âï¼stickyï¼ä¿®é¥°ç¬¦ã\n\nyä¿®é¥°ç¬¦çä½ç¨ä¸gä¿®é¥°ç¬¦ç±»ä¼¼ï¼ä¹æ¯å¨å±å¹éï¼åä¸æ¬¡å¹éé½ä»ä¸ä¸æ¬¡å¹éæåçä¸ä¸ä¸ªä½ç½®å¼å§ãä¸åä¹å¤å¨äºï¼gä¿®é¥°ç¬¦åªè¦å©ä½ä½ç½®ä¸­å­å¨å¹éå°±å¯ï¼èyä¿®é¥°ç¬¦ç¡®ä¿å¹éå¿é¡»ä»å©ä½çç¬¬ä¸ä¸ªä½ç½®å¼å§ï¼è¿ä¹å°±æ¯âç²è¿âçæ¶µä¹ã\n\nvar s = 'aaa_aa_a';\nvar r1 = /a+/g;\nvar r2 = /a+/y;\n\nr1.exec(s) // [\"aaa\"]\nr2.exec(s) // [\"aaa\"]\n\nr1.exec(s) // [\"aa\"]\nr2.exec(s) // null\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç æä¸¤ä¸ªæ­£åè¡¨è¾¾å¼ï¼ä¸ä¸ªä½¿ç¨gä¿®é¥°ç¬¦ï¼å¦ä¸ä¸ªä½¿ç¨yä¿®é¥°ç¬¦ãè¿ä¸¤ä¸ªæ­£åè¡¨è¾¾å¼åæ§è¡äºä¸¤æ¬¡ï¼ç¬¬ä¸æ¬¡æ§è¡çæ¶åï¼ä¸¤èè¡ä¸ºç¸åï¼å©ä½å­ç¬¦ä¸²é½æ¯_aa_aãç±äºgä¿®é¥°æ²¡æä½ç½®è¦æ±ï¼æä»¥ç¬¬äºæ¬¡æ§è¡ä¼è¿åç»æï¼èyä¿®é¥°ç¬¦è¦æ±å¹éå¿é¡»ä»å¤´é¨å¼å§ï¼æä»¥è¿ånullã\n\nå¦ææ¹ä¸ä¸æ­£åè¡¨è¾¾å¼ï¼ä¿è¯æ¯æ¬¡é½è½å¤´é¨å¹éï¼yä¿®é¥°ç¬¦å°±ä¼è¿åç»æäºã\n\nvar s = 'aaa_aa_a';\nvar r = /a+_/y;\n\nr.exec(s) // [\"aaa_\"]\nr.exec(s) // [\"aa_\"]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç æ¯æ¬¡å¹éï¼é½æ¯ä»å©ä½å­ç¬¦ä¸²çå¤´é¨å¼å§ã\n\nä½¿ç¨lastindexå±æ§ï¼å¯ä»¥æ´å¥½å°è¯´æyä¿®é¥°ç¬¦ã\n\nconst regex = /a/g;\n\n// æå®ä»2å·ä½ç½®ï¼yï¼å¼å§å¹é\nregex.lastindex = 2;\n\n// å¹éæå\nconst match = regex.exec('xaya');\n\n// å¨3å·ä½ç½®å¹éæå\nmatch.index // 3\n\n// ä¸ä¸æ¬¡å¹éä»4å·ä½å¼å§\nregex.lastindex // 4\n\n// 4å·ä½å¼å§å¹éå¤±è´¥\nregex.exec('xaya') // null\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼lastindexå±æ§æå®æ¯æ¬¡æç´¢çå¼å§ä½ç½®ï¼gä¿®é¥°ç¬¦ä»è¿ä¸ªä½ç½®å¼å§ååæç´¢ï¼ç´å°åç°å¹éä¸ºæ­¢ã\n\nyä¿®é¥°ç¬¦åæ ·éµå®lastindexå±æ§ï¼ä½æ¯è¦æ±å¿é¡»å¨lastindexæå®çä½ç½®åç°å¹éã\n\nconst regex = /a/y;\n\n// æå®ä»2å·ä½ç½®å¼å§å¹é\nregex.lastindex = 2;\n\n// ä¸æ¯ç²è¿ï¼å¹éå¤±è´¥\nregex.exec('xaya') // null\n\n// æå®ä»3å·ä½ç½®å¼å§å¹é\nregex.lastindex = 3;\n\n// 3å·ä½ç½®æ¯ç²è¿ï¼å¹éæå\nconst match = regex.exec('xaya');\nmatch.index // 3\nregex.lastindex // 4\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå®éä¸ï¼yä¿®é¥°ç¬¦å·éå«äºå¤´é¨å¹éçæ å¿^ã\n\n/b/y.exec('aba')\n// null\n\n\n1\n2\n\n\nä¸é¢ä»£ç ç±äºä¸è½ä¿è¯å¤´é¨å¹éï¼æä»¥è¿ånullãyä¿®é¥°ç¬¦çè®¾è®¡æ¬æï¼å°±æ¯è®©å¤´é¨å¹éçæ å¿^å¨å¨å±å¹éä¸­é½ææã\n\nä¸é¢æ¯å­ç¬¦ä¸²å¯¹è±¡çreplaceæ¹æ³çä¾å­ã\n\nconst regex = /a/gy;\n'aaxa'.replace(regex, '-') // '--xa'\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼æåä¸ä¸ªaå ä¸ºä¸æ¯åºç°å¨ä¸ä¸æ¬¡å¹éçå¤´é¨ï¼æä»¥ä¸ä¼è¢«æ¿æ¢ã\n\nååä¸ä¸ªyä¿®é¥°ç¬¦å¯¹matchæ¹æ³ï¼åªè½è¿åç¬¬ä¸ä¸ªå¹éï¼å¿é¡»ä¸gä¿®é¥°ç¬¦èç¨ï¼æè½è¿åææå¹éã\n\n'a1a2a3'.match(/a\\d/y) // [\"a1\"]\n'a1a2a3'.match(/a\\d/gy) // [\"a1\", \"a2\", \"a3\"]\n\n\n1\n2\n\n\nyä¿®é¥°ç¬¦çä¸ä¸ªåºç¨ï¼æ¯ä»å­ç¬¦ä¸²æå tokenï¼è¯åï¼ï¼yä¿®é¥°ç¬¦ç¡®ä¿äºå¹éä¹é´ä¸ä¼ææ¼æçå­ç¬¦ã\n\nconst token_y = /\\s*(\\+|[0-9]+)\\s*/y;\nconst token_g  = /\\s*(\\+|[0-9]+)\\s*/g;\n\ntokenize(token_y, '3 + 4')\n// [ '3', '+', '4' ]\ntokenize(token_g, '3 + 4')\n// [ '3', '+', '4' ]\n\nfunction tokenize(token_regex, str) {\n  let result = [];\n  let match;\n  while (match = token_regex.exec(str)) {\n    result.push(match[1]);\n  }\n  return result;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æå­ç¬¦ä¸²éé¢æ²¡æéæ³å­ç¬¦ï¼yä¿®é¥°ç¬¦ä¸gä¿®é¥°ç¬¦çæåç»ææ¯ä¸æ ·çãä½æ¯ï¼ä¸æ¦åºç°éæ³å­ç¬¦ï¼ä¸¤èçè¡ä¸ºå°±ä¸ä¸æ ·äºã\n\ntokenize(token_y, '3x + 4')\n// [ '3' ]\ntokenize(token_g, '3x + 4')\n// [ '3', '+', '4' ]\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼gä¿®é¥°ç¬¦ä¼å¿½ç¥éæ³å­ç¬¦ï¼èyä¿®é¥°ç¬¦ä¸ä¼ï¼è¿æ ·å°±å¾å®¹æåç°éè¯¯ã\n\n\n# regexp.prototype.sticky å±æ§\n\nä¸yä¿®é¥°ç¬¦ç¸å¹éï¼es6 çæ­£åå®ä¾å¯¹è±¡å¤äºstickyå±æ§ï¼è¡¨ç¤ºæ¯å¦è®¾ç½®äºyä¿®é¥°ç¬¦ã\n\nvar r = /hello\\d/y;\nr.sticky // true\n\n\n1\n2\n\n\n\n# regexp.prototype.flags å±æ§\n\nes6 ä¸ºæ­£åè¡¨è¾¾å¼æ°å¢äºflagså±æ§ï¼ä¼è¿åæ­£åè¡¨è¾¾å¼çä¿®é¥°ç¬¦ã\n\n// es5 ç source å±æ§\n// è¿åæ­£åè¡¨è¾¾å¼çæ­£æ\n/abc/ig.source\n// \"abc\"\n\n// es6 ç flags å±æ§\n// è¿åæ­£åè¡¨è¾¾å¼çä¿®é¥°ç¬¦\n/abc/ig.flags\n// 'gi'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# s ä¿®é¥°ç¬¦ï¼dotall æ¨¡å¼\n\næ­£åè¡¨è¾¾å¼ä¸­ï¼ç¹ï¼.ï¼æ¯ä¸ä¸ªç¹æ®å­ç¬¦ï¼ä»£è¡¨ä»»æçåä¸ªå­ç¬¦ï¼ä½æ¯æä¸¤ä¸ªä¾å¤ãä¸ä¸ªæ¯åä¸ªå­èç utf-16 å­ç¬¦ï¼è¿ä¸ªå¯ä»¥ç¨uä¿®é¥°ç¬¦è§£å³ï¼å¦ä¸ä¸ªæ¯è¡ç»æ­¢ç¬¦ï¼line terminator characterï¼ã\n\næè°è¡ç»æ­¢ç¬¦ï¼å°±æ¯è¯¥å­ç¬¦è¡¨ç¤ºä¸è¡çç»ç»ãä»¥ä¸åä¸ªå­ç¬¦å±äºâè¡ç»æ­¢ç¬¦âã\n\n * u+000a æ¢è¡ç¬¦ï¼\\nï¼\n * u+000d åè½¦ç¬¦ï¼\\rï¼\n * u+2028 è¡åéç¬¦ï¼line separatorï¼\n * u+2029 æ®µåéç¬¦ï¼paragraph separatorï¼\n\n/foo.bar/.test('foo\\nbar')\n// false\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼å ä¸º.ä¸å¹é\\nï¼æä»¥æ­£åè¡¨è¾¾å¼è¿åfalseã\n\nä½æ¯ï¼å¾å¤æ¶åæä»¬å¸æå¹éçæ¯ä»»æåä¸ªå­ç¬¦ï¼è¿æ¶æä¸ç§åéçåæ³ã\n\n/foo[^]bar/.test('foo\\nbar')\n// true\n\n\n1\n2\n\n\nè¿ç§è§£å³æ¹æ¡æ¯ç«ä¸å¤ªç¬¦åç´è§ï¼es2018 å¼å¥sä¿®é¥°ç¬¦ï¼ä½¿å¾.å¯ä»¥å¹éä»»æåä¸ªå­ç¬¦ã\n\n/foo.bar/s.test('foo\\nbar') // true\n\n\n1\n\n\nè¿è¢«ç§°ä¸ºdotallæ¨¡å¼ï¼å³ç¹ï¼dotï¼ä»£è¡¨ä¸åå­ç¬¦ãæä»¥ï¼æ­£åè¡¨è¾¾å¼è¿å¼å¥äºä¸ä¸ªdotallå±æ§ï¼è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºè¯¥æ­£åè¡¨è¾¾å¼æ¯å¦å¤å¨dotallæ¨¡å¼ã\n\nconst re = /foo.bar/s;\n// å¦ä¸ç§åæ³\n// const re = new regexp('foo.bar', 's');\n\nre.test('foo\\nbar') // true\nre.dotall // true\nre.flags // 's'\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n/sä¿®é¥°ç¬¦åå¤è¡ä¿®é¥°ç¬¦/mä¸å²çªï¼ä¸¤èä¸èµ·ä½¿ç¨çæåµä¸ï¼.å¹éææå­ç¬¦ï¼è^å$å¹éæ¯ä¸è¡çè¡é¦åè¡å°¾ã\n\n\n# åè¡æ­è¨\n\njavascript è¯­è¨çæ­£åè¡¨è¾¾å¼ï¼åªæ¯æåè¡æ­è¨ï¼lookaheadï¼ååè¡å¦å®æ­è¨ï¼negative lookaheadï¼ï¼ä¸æ¯æåè¡æ­è¨ï¼lookbehindï¼ååè¡å¦å®æ­è¨ï¼negative lookbehindï¼ães2018 å¼å¥åè¡æ­è¨ï¼v8 å¼æ 4.9 çï¼chrome 62ï¼å·²ç»æ¯æã\n\nâåè¡æ­è¨âæçæ¯ï¼xåªæå¨yåé¢æå¹éï¼å¿é¡»åæ/x(?=y)/ãæ¯å¦ï¼åªå¹éç¾åå·ä¹åçæ°å­ï¼è¦åæ/\\d+(?=%)/ãâåè¡å¦å®æ­è¨âæçæ¯ï¼xåªæä¸å¨yåé¢æå¹éï¼å¿é¡»åæ/x(?!y)/ãæ¯å¦ï¼åªå¹éä¸å¨ç¾åå·ä¹åçæ°å­ï¼è¦åæ/\\d+(?!%)/ã\n\n/\\d+(?=%)/.exec('100% of us presidents have been male')  // [\"100\"]\n/\\d+(?!%)/.exec('thatâs all 44 of them')                 // [\"44\"]\n\n\n1\n2\n\n\nä¸é¢ä¸¤ä¸ªå­ç¬¦ä¸²ï¼å¦æäºæ¢æ­£åè¡¨è¾¾å¼ï¼å°±ä¸ä¼å¾å°ç¸åç»æãå¦å¤ï¼è¿å¯ä»¥çå°ï¼âåè¡æ­è¨âæ¬å·ä¹ä¸­çé¨åï¼(?=%)ï¼ï¼æ¯ä¸è®¡å¥è¿åç»æçã\n\nâåè¡æ­è¨âæ­£å¥½ä¸âåè¡æ­è¨âç¸åï¼xåªæå¨yåé¢æå¹éï¼å¿é¡»åæ/(?<=y)x/ãæ¯å¦ï¼åªå¹éç¾åç¬¦å·ä¹åçæ°å­ï¼è¦åæ/(?<=\\$)\\d+/ãâåè¡å¦å®æ­è¨âåä¸âåè¡å¦å®æ­è¨âç¸åï¼xåªæä¸å¨yåé¢æå¹éï¼å¿é¡»åæ/(?<!y)x/ãæ¯å¦ï¼åªå¹éä¸å¨ç¾åç¬¦å·åé¢çæ°å­ï¼è¦åæ/(?<!\\$)\\d+/ã\n\n/(?<=\\$)\\d+/.exec('benjamin franklin is on the $100 bill')  // [\"100\"]\n/(?<!\\$)\\d+/.exec('itâs is worth about â¬90')                // [\"90\"]\n\n\n1\n2\n\n\nä¸é¢çä¾å­ä¸­ï¼âåè¡æ­è¨âçæ¬å·ä¹ä¸­çé¨åï¼(?<=\\$)ï¼ï¼ä¹æ¯ä¸è®¡å¥è¿åç»æã\n\nä¸é¢çä¾å­æ¯ä½¿ç¨åè¡æ­è¨è¿è¡å­ç¬¦ä¸²æ¿æ¢ã\n\nconst re_dollar_prefix = /(?<=\\$)foo/g;\n'$foo %foo foo'.replace(re_dollar_prefix, 'bar');\n// '$bar %foo foo'\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼åªæå¨ç¾åç¬¦å·åé¢çfooæä¼è¢«æ¿æ¢ã\n\nâåè¡æ­è¨âçå®ç°ï¼éè¦åå¹é/(?<=y)x/çxï¼ç¶åååå°å·¦è¾¹ï¼å¹éyçé¨åãè¿ç§âåå³åå·¦âçæ§è¡é¡ºåºï¼ä¸ææå¶ä»æ­£åæä½ç¸åï¼å¯¼è´äºä¸äºä¸ç¬¦åé¢æçè¡ä¸ºã\n\né¦åï¼åè¡æ­è¨çç»å¹éï¼ä¸æ­£å¸¸æåµä¸ç»ææ¯ä¸ä¸æ ·çã\n\n/(?<=(\\d+)(\\d+))$/.exec('1053') // [\"\", \"1\", \"053\"]\n/^(\\d+)(\\d+)$/.exec('1053') // [\"1053\", \"105\", \"3\"]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼éè¦ææä¸¤ä¸ªç»å¹éãæ²¡æâåè¡æ­è¨âæ¶ï¼ç¬¬ä¸ä¸ªæ¬å·æ¯è´ªå©ªæ¨¡å¼ï¼ç¬¬äºä¸ªæ¬å·åªè½æè·ä¸ä¸ªå­ç¬¦ï¼æä»¥ç»ææ¯105å3ãèâåè¡æ­è¨âæ¶ï¼ç±äºæ§è¡é¡ºåºæ¯ä»å³å°å·¦ï¼ç¬¬äºä¸ªæ¬å·æ¯è´ªå©ªæ¨¡å¼ï¼ç¬¬ä¸ä¸ªæ¬å·åªè½æè·ä¸ä¸ªå­ç¬¦ï¼æä»¥ç»ææ¯1å053ã\n\nå¶æ¬¡ï¼âåè¡æ­è¨âçåææ å¼ç¨ï¼ä¹ä¸éå¸¸çé¡ºåºç¸åï¼å¿é¡»æ¾å¨å¯¹åºçé£ä¸ªæ¬å·ä¹åã\n\n/(?<=(o)d\\1)r/.exec('hodor')  // null\n/(?<=\\1d(o))r/.exec('hodor')  // [\"r\", \"o\"]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æåè¡æ­è¨çåææ å¼ç¨ï¼\\1ï¼æ¾å¨æ¬å·çåé¢ï¼å°±ä¸ä¼å¾å°å¹éç»æï¼å¿é¡»æ¾å¨åé¢æå¯ä»¥ãå ä¸ºåè¡æ­è¨æ¯åä»å·¦å°å³æ«æï¼åç°å¹éä»¥åååè¿å¤´ï¼ä»å³å°å·¦å®æåææ å¼ç¨ã\n\n\n# unicode å±æ§ç±»\n\nes2018 å¼å¥äºä¸ç§æ°çç±»çåæ³\\p{...}å\\p{...}ï¼åè®¸æ­£åè¡¨è¾¾å¼å¹éç¬¦å unicode æç§å±æ§çææå­ç¬¦ã\n\nconst regexgreeksymbol = /\\p{script=greek}/u;\nregexgreeksymbol.test('Ï') // true\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼\\p{script=greek}æå®å¹éä¸ä¸ªå¸èæå­æ¯ï¼æä»¥å¹éÏæåã\n\nunicode å±æ§ç±»è¦æå®å±æ§ååå±æ§å¼ã\n\n\\p{unicodepropertyname=unicodepropertyvalue}\n\n\n1\n\n\nå¯¹äºæäºå±æ§ï¼å¯ä»¥åªåå±æ§åï¼æèåªåå±æ§å¼ã\n\n\\p{unicodepropertyname}\n\\p{unicodepropertyvalue}\n\n\n1\n2\n\n\n\\p{â¦}æ¯\\p{â¦}çååå¹éï¼å³å¹éä¸æ»¡è¶³æ¡ä»¶çå­ç¬¦ã\n\næ³¨æï¼è¿ä¸¤ç§ç±»åªå¯¹ unicode ææï¼æä»¥ä½¿ç¨çæ¶åä¸å®è¦å ä¸uä¿®é¥°ç¬¦ãå¦æä¸å uä¿®é¥°ç¬¦ï¼æ­£åè¡¨è¾¾å¼ä½¿ç¨\\på\\pä¼æ¥éï¼ecmascript é¢çäºè¿ä¸¤ä¸ªç±»ã\n\nç±äº unicode çåç§å±æ§éå¸¸å¤ï¼æä»¥è¿ç§æ°çç±»çè¡¨è¾¾è½åéå¸¸å¼ºã\n\nconst regex = /^\\p{decimal_number}+$/u;\nregex.test('ððððððð©ðªð«ð¬ð­ð®ð¯ðºð»ð¼') // true\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼å±æ§ç±»æå®å¹éææåè¿å¶å­ç¬¦ï¼å¯ä»¥çå°åç§å­åçåè¿å¶å­ç¬¦é½ä¼å¹éæåã\n\n\\p{number}çè³è½å¹éç½é©¬æ°å­ã\n\n// å¹éæææ°å­\nconst regex = /^\\p{number}+$/u;\nregex.test('Â²Â³Â¹Â¼Â½Â¾') // true\nregex.test('ããã') // true\nregex.test('â°â±â²â³â´âµâ¶â·â¸â¹âºâ»') // true\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢æ¯å¶ä»ä¸äºä¾å­ã\n\n// å¹éææç©ºæ ¼\n\\p{white_space}\n\n// å¹éåç§æå­çææå­æ¯ï¼ç­åäº unicode çç \\w\n[\\p{alphabetic}\\p{mark}\\p{decimal_number}\\p{connector_punctuation}\\p{join_control}]\n\n// å¹éåç§æå­çææéå­æ¯çå­ç¬¦ï¼ç­åäº unicode çç \\w\n[^\\p{alphabetic}\\p{mark}\\p{decimal_number}\\p{connector_punctuation}\\p{join_control}]\n\n// å¹é emoji\n/\\p{emoji_modifier_base}\\p{emoji_modifier}?|\\p{emoji_presentation}|\\p{emoji}\\ufe0f/gu\n\n// å¹éææçç®­å¤´å­ç¬¦\nconst regexarrows = /^\\p{block=arrows}+$/u;\nregexarrows.test('ââââââââââââââââââââââ§â©') // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# å·åç»å¹é\n\n\n# ç®ä»\n\næ­£åè¡¨è¾¾å¼ä½¿ç¨åæ¬å·è¿è¡ç»å¹éã\n\nconst re_date = /(\\d{4})-(\\d{2})-(\\d{2})/;\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼æ­£åè¡¨è¾¾å¼éé¢æä¸ç»åæ¬å·ãä½¿ç¨execæ¹æ³ï¼å°±å¯ä»¥å°è¿ä¸ç»å¹éç»ææååºæ¥ã\n\nconst re_date = /(\\d{4})-(\\d{2})-(\\d{2})/;\n\nconst matchobj = re_date.exec('1999-12-31');\nconst year = matchobj[1]; // 1999\nconst month = matchobj[2]; // 12\nconst day = matchobj[3]; // 31\n\n\n1\n2\n3\n4\n5\n6\n\n\nç»å¹éçä¸ä¸ªé®é¢æ¯ï¼æ¯ä¸ç»çå¹éå«ä¹ä¸å®¹æçåºæ¥ï¼èä¸åªè½ç¨æ°å­åºå·ï¼æ¯å¦matchobj[1]ï¼å¼ç¨ï¼è¦æ¯ç»çé¡ºåºåäºï¼å¼ç¨çæ¶åå°±å¿é¡»ä¿®æ¹åºå·ã\n\nes2018 å¼å¥äºå·åç»å¹éï¼named capture groupsï¼ï¼åè®¸ä¸ºæ¯ä¸ä¸ªç»å¹éæå®ä¸ä¸ªåå­ï¼æ¢ä¾¿äºéè¯»ä»£ç ï¼åä¾¿äºå¼ç¨ã\n\nconst re_date = /(?<year>\\d{4})-(?<month>\\d{2})-(?<day>\\d{2})/;\n\nconst matchobj = re_date.exec('1999-12-31');\nconst year = matchobj.groups.year; // 1999\nconst month = matchobj.groups.month; // 12\nconst day = matchobj.groups.day; // 31\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼âå·åç»å¹éâå¨åæ¬å·åé¨ï¼æ¨¡å¼çå¤´é¨æ·»å âé®å· + å°æ¬å· + ç»åâï¼?<year>ï¼ï¼ç¶åå°±å¯ä»¥å¨execæ¹æ³è¿åç»æçgroupså±æ§ä¸å¼ç¨è¯¥ç»åãåæ¶ï¼æ°å­åºå·ï¼matchobj[1]ï¼ä¾ç¶ææã\n\nå·åç»å¹éç­äºä¸ºæ¯ä¸ç»å¹éå ä¸äº idï¼ä¾¿äºæè¿°å¹éçç®çãå¦æç»çé¡ºåºåäºï¼ä¹ä¸ç¨æ¹åå¹éåçå¤çä»£ç ã\n\nå¦æå·åç»æ²¡æå¹éï¼é£ä¹å¯¹åºçgroupså¯¹è±¡å±æ§ä¼æ¯undefinedã\n\nconst re_opt_a = /^(?<as>a+)?$/;\nconst matchobj = re_opt_a.exec('');\n\nmatchobj.groups.as // undefined\n'as' in matchobj.groups // true\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å·åç»asæ²¡ææ¾å°å¹éï¼é£ä¹matchobj.groups.aså±æ§å¼å°±æ¯undefinedï¼å¹¶ä¸asè¿ä¸ªé®åå¨groupsæ¯å§ç»å­å¨çã\n\n\n# è§£æèµå¼åæ¿æ¢\n\næäºå·åç»å¹éä»¥åï¼å¯ä»¥ä½¿ç¨è§£æèµå¼ç´æ¥ä»å¹éç»æä¸ä¸ºåéèµå¼ã\n\nlet {groups: {one, two}} = /^(?<one>.*):(?<two>.*)$/u.exec('foo:bar');\none  // foo\ntwo  // bar\n\n\n1\n2\n3\n\n\nå­ç¬¦ä¸²æ¿æ¢æ¶ï¼ä½¿ç¨$<ç»å>å¼ç¨å·åç»ã\n\nlet re = /(?<year>\\d{4})-(?<month>\\d{2})-(?<day>\\d{2})/u;\n\n'2015-01-02'.replace(re, '$<day>/$<month>/$<year>')\n// '02/01/2015'\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼replaceæ¹æ³çç¬¬äºä¸ªåæ°æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼èä¸æ¯æ­£åè¡¨è¾¾å¼ã\n\nreplaceæ¹æ³çç¬¬äºä¸ªåæ°ä¹å¯ä»¥æ¯å½æ°ï¼è¯¥å½æ°çåæ°åºåå¦ä¸ã\n\n'2015-01-02'.replace(re, (\n   matched, // æ´ä¸ªå¹éç»æ 2015-01-02\n   capture1, // ç¬¬ä¸ä¸ªç»å¹é 2015\n   capture2, // ç¬¬äºä¸ªç»å¹é 01\n   capture3, // ç¬¬ä¸ä¸ªç»å¹é 02\n   position, // å¹éå¼å§çä½ç½® 0\n   s, // åå­ç¬¦ä¸² 2015-01-02\n   groups // å·åç»ææçä¸ä¸ªå¯¹è±¡ {year, month, day}\n ) => {\n let {day, month, year} = groups;\n return `${day}/${month}/${year}`;\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå·åç»å¹éå¨åæ¥çåºç¡ä¸ï¼æ°å¢äºæåä¸ä¸ªå½æ°åæ°ï¼å·åç»ææçä¸ä¸ªå¯¹è±¡ãå½æ°åé¨å¯ä»¥ç´æ¥å¯¹è¿ä¸ªå¯¹è±¡è¿è¡è§£æèµå¼ã\n\n\n# å¼ç¨\n\nå¦æè¦å¨æ­£åè¡¨è¾¾å¼åé¨å¼ç¨æä¸ªâå·åç»å¹éâï¼å¯ä»¥ä½¿ç¨\\k<ç»å>çåæ³ã\n\nconst re_twice = /^(?<word>[a-z]+)!\\k<word>$/;\nre_twice.test('abc!abc') // true\nre_twice.test('abc!ab') // false\n\n\n1\n2\n3\n\n\næ°å­å¼ç¨ï¼\\1ï¼ä¾ç¶ææã\n\nconst re_twice = /^(?<word>[a-z]+)!\\1$/;\nre_twice.test('abc!abc') // true\nre_twice.test('abc!ab') // false\n\n\n1\n2\n3\n\n\nè¿ä¸¤ç§å¼ç¨è¯­æ³è¿å¯ä»¥åæ¶ä½¿ç¨ã\n\nconst re_twice = /^(?<word>[a-z]+)!\\k<word>!\\1$/;\nre_twice.test('abc!abc!abc') // true\nre_twice.test('abc!abc!ab') // false\n\n\n1\n2\n3\n\n\n\n# string.prototype.matchall()\n\nå¦æä¸ä¸ªæ­£åè¡¨è¾¾å¼å¨å­ç¬¦ä¸²éé¢æå¤ä¸ªå¹éï¼ç°å¨ä¸è¬ä½¿ç¨gä¿®é¥°ç¬¦æyä¿®é¥°ç¬¦ï¼å¨å¾ªç¯éé¢éä¸ååºã\n\nvar regex = /t(e)(st(\\d?))/g;\nvar string = 'test1test2test3';\n\nvar matches = [];\nvar match;\nwhile (match = regex.exec(string)) {\n  matches.push(match);\n}\n\nmatches\n// [\n//   [\"test1\", \"e\", \"st1\", \"1\", index: 0, input: \"test1test2test3\"],\n//   [\"test2\", \"e\", \"st2\", \"2\", index: 5, input: \"test1test2test3\"],\n//   [\"test3\", \"e\", \"st3\", \"3\", index: 10, input: \"test1test2test3\"]\n// ]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼whileå¾ªç¯ååºæ¯ä¸è½®çæ­£åå¹éï¼ä¸å±ä¸è½®ã\n\nes2020 å¢å äºstring.prototype.matchall()æ¹æ³ï¼å¯ä»¥ä¸æ¬¡æ§ååºææå¹éãä¸è¿ï¼å®è¿åçæ¯ä¸ä¸ªéåå¨ï¼iteratorï¼ï¼èä¸æ¯æ°ç»ã\n\nconst string = 'test1test2test3';\n\n// g ä¿®é¥°ç¬¦å ä¸å é½å¯ä»¥\nconst regex = /t(e)(st(\\d?))/g;\n\nfor (const match of string.matchall(regex)) {\n  console.log(match);\n}\n// [\"test1\", \"e\", \"st1\", \"1\", index: 0, input: \"test1test2test3\"]\n// [\"test2\", \"e\", \"st2\", \"2\", index: 5, input: \"test1test2test3\"]\n// [\"test3\", \"e\", \"st3\", \"3\", index: 10, input: \"test1test2test3\"]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºstring.matchall(regex)è¿åçæ¯éåå¨ï¼æä»¥å¯ä»¥ç¨for...ofå¾ªç¯ååºãç¸å¯¹äºè¿åæ°ç»ï¼è¿åéåå¨çå¥½å¤å¨äºï¼å¦æå¹éç»ææ¯ä¸ä¸ªå¾å¤§çæ°ç»ï¼é£ä¹éåå¨æ¯è¾èçèµæºã\n\néåå¨è½¬ä¸ºæ°ç»æ¯éå¸¸ç®åçï¼ä½¿ç¨...è¿ç®ç¬¦åarray.from()æ¹æ³å°±å¯ä»¥äºã\n\n// è½¬ä¸ºæ°ç»æ¹æ³ä¸\n[...string.matchall(regex)]\n\n// è½¬ä¸ºæ°ç»æ¹æ³äº\narray.from(string.matchall(regex))\n\n\n1\n2\n3\n4\n5\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"æ°å¼çæ©å±",frontmatter:{title:"æ°å¼çæ©å±",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/5dfea9a0f2d1a392",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/07.%E6%95%B0%E5%80%BC%E7%9A%84%E6%89%A9%E5%B1%95.html",relativePath:"ãES6 æç¨ãç¬è®°/07.æ°å¼çæ©å±.md",key:"v-e165eb18",path:"/pages/5dfea9a0f2d1a392/",headers:[{level:2,title:"äºè¿å¶åå«è¿å¶è¡¨ç¤ºæ³",slug:"äºè¿å¶åå«è¿å¶è¡¨ç¤ºæ³",normalizedTitle:"äºè¿å¶åå«è¿å¶è¡¨ç¤ºæ³",charIndex:12},{level:2,title:"Number.isFinite() æ¯å¦ä¸ºæé, Number.isNaN() æ¯å¦ä¸ºNaN",slug:"number-isfinite-æ¯å¦ä¸ºæé-number-isnan-æ¯å¦ä¸ºnan",normalizedTitle:"number.isfinite() æ¯å¦ä¸ºæé, number.isnan() æ¯å¦ä¸ºnan",charIndex:508},{level:2,title:"Number.parseInt(), Number.parseFloat()",slug:"number-parseint-number-parsefloat",normalizedTitle:"number.parseint(), number.parsefloat()",charIndex:1690},{level:2,title:"Number.isInteger() æ¯å¦ä¸ºæ´æ°",slug:"number-isinteger-æ¯å¦ä¸ºæ´æ°",normalizedTitle:"number.isinteger() æ¯å¦ä¸ºæ´æ°",charIndex:2072},{level:2,title:"Number.EPSILON ç¨äºæµ®ç¹æ°è¯¯å·®æ£æ¥",slug:"number-epsilon-ç¨äºæµ®ç¹æ°è¯¯å·®æ£æ¥",normalizedTitle:"number.epsilon ç¨äºæµ®ç¹æ°è¯¯å·®æ£æ¥",charIndex:3060},{level:2,title:"å®å¨æ´æ°å Number.isSafeInteger()",slug:"å®å¨æ´æ°å-number-issafeinteger",normalizedTitle:"å®å¨æ´æ°å number.issafeinteger()",charIndex:4277},{level:2,title:"Math å¯¹è±¡çæ©å±",slug:"math-å¯¹è±¡çæ©å±",normalizedTitle:"math å¯¹è±¡çæ©å±",charIndex:6745},{level:3,title:"Math.trunc() å»é¤ä¸ä¸ªæ°çå°æ°é¨åï¼è¿åæ´æ°é¨å",slug:"math-trunc-å»é¤ä¸ä¸ªæ°çå°æ°é¨å-è¿åæ´æ°é¨å",normalizedTitle:"math.trunc() å»é¤ä¸ä¸ªæ°çå°æ°é¨åï¼è¿åæ´æ°é¨å",charIndex:6821},{level:3,title:"Math.sign() å¤æ­ä¸ä¸ªæ°æ¯æ­£æ°ãè´æ°ãè¿æ¯é¶",slug:"math-sign-å¤æ­ä¸ä¸ªæ°æ¯æ­£æ°ãè´æ°ãè¿æ¯é¶",normalizedTitle:"math.sign() å¤æ­ä¸ä¸ªæ°æ¯æ­£æ°ãè´æ°ãè¿æ¯é¶",charIndex:7441},{level:3,title:"Math.cbrt() è®¡ç®ä¸ä¸ªæ°çç«æ¹æ ¹",slug:"math-cbrt-è®¡ç®ä¸ä¸ªæ°çç«æ¹æ ¹",normalizedTitle:"math.cbrt() è®¡ç®ä¸ä¸ªæ°çç«æ¹æ ¹",charIndex:8155},{level:3,title:"Math.clz32()",slug:"math-clz32",normalizedTitle:"math.clz32()",charIndex:8551},{level:3,title:"Math.imul()",slug:"math-imul",normalizedTitle:"math.imul()",charIndex:9529},{level:3,title:"Math.fround()",slug:"math-fround",normalizedTitle:"math.fround()",charIndex:10121},{level:3,title:"Math.hypot()",slug:"math-hypot",normalizedTitle:"math.hypot()",charIndex:11181},{level:3,title:"å¯¹æ°æ¹æ³",slug:"å¯¹æ°æ¹æ³",normalizedTitle:"å¯¹æ°æ¹æ³",charIndex:11578},{level:3,title:"åæ²å½æ°æ¹æ³",slug:"åæ²å½æ°æ¹æ³",normalizedTitle:"åæ²å½æ°æ¹æ³",charIndex:12907},{level:2,title:"ææ°è¿ç®ç¬¦",slug:"ææ°è¿ç®ç¬¦",normalizedTitle:"ææ°è¿ç®ç¬¦",charIndex:13231},{level:2,title:"BigInt æ°æ®ç±»å",slug:"bigint-æ°æ®ç±»å",normalizedTitle:"bigint æ°æ®ç±»å",charIndex:13734},{level:3,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:13750},{level:3,title:"BigInt å¯¹è±¡",slug:"bigint-å¯¹è±¡",normalizedTitle:"bigint å¯¹è±¡",charIndex:15038},{level:3,title:"è½¬æ¢è§å",slug:"è½¬æ¢è§å",normalizedTitle:"è½¬æ¢è§å",charIndex:15097},{level:3,title:"æ°å­¦è¿ç®",slug:"æ°å­¦è¿ç®",normalizedTitle:"æ°å­¦è¿ç®",charIndex:17239},{level:3,title:"å¶ä»è¿ç®",slug:"å¶ä»è¿ç®",normalizedTitle:"å¶ä»è¿ç®",charIndex:18036}],excerpt:'<h1 id="æ°å¼çæ©å±"><a class="header-anchor" href="#æ°å¼çæ©å±">#</a> æ°å¼çæ©å±</h1>\n<h2 id="äºè¿å¶åå«è¿å¶è¡¨ç¤ºæ³"><a class="header-anchor" href="#äºè¿å¶åå«è¿å¶è¡¨ç¤ºæ³">#</a> äºè¿å¶åå«è¿å¶è¡¨ç¤ºæ³</h2>\n<p>ES6 æä¾äºäºè¿å¶åå«è¿å¶æ°å¼çæ°çåæ³ï¼åå«ç¨åç¼<code>0b</code>ï¼æ<code>0B</code>ï¼å<code>0o</code>ï¼æ<code>0O</code>ï¼è¡¨ç¤ºã</p>\n\x3c!--beforebegin--\x3e<div class="language-javascript line-numbers-mode">\x3c!--afterbegin--\x3e<pre v-pre class="language-javascript"><code><span class="token number">0b111110111</span> <span class="token operator">===</span> <span class="token number">503</span> <span class="token comment">// true</span>\n<span class="token number">0o767</span> <span class="token operator">===</span> <span class="token number">503</span> <span class="token comment">// true</span>\n</code></pre>\n<div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div>\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e',headersStr:"äºè¿å¶åå«è¿å¶è¡¨ç¤ºæ³ Number.isFinite() æ¯å¦ä¸ºæé, Number.isNaN() æ¯å¦ä¸ºNaN Number.parseInt(), Number.parseFloat() Number.isInteger() æ¯å¦ä¸ºæ´æ° Number.EPSILON ç¨äºæµ®ç¹æ°è¯¯å·®æ£æ¥ å®å¨æ´æ°å Number.isSafeInteger() Math å¯¹è±¡çæ©å± Math.trunc() å»é¤ä¸ä¸ªæ°çå°æ°é¨åï¼è¿åæ´æ°é¨å Math.sign() å¤æ­ä¸ä¸ªæ°æ¯æ­£æ°ãè´æ°ãè¿æ¯é¶ Math.cbrt() è®¡ç®ä¸ä¸ªæ°çç«æ¹æ ¹ Math.clz32() Math.imul() Math.fround() Math.hypot() å¯¹æ°æ¹æ³ åæ²å½æ°æ¹æ³ ææ°è¿ç®ç¬¦ BigInt æ°æ®ç±»å ç®ä» BigInt å¯¹è±¡ è½¬æ¢è§å æ°å­¦è¿ç® å¶ä»è¿ç®",content:"# æ°å¼çæ©å±\n\n\n# äºè¿å¶åå«è¿å¶è¡¨ç¤ºæ³\n\nES6 æä¾äºäºè¿å¶åå«è¿å¶æ°å¼çæ°çåæ³ï¼åå«ç¨åç¼0bï¼æ0Bï¼å0oï¼æ0Oï¼è¡¨ç¤ºã\n\n0b111110111 === 503 // true\n0o767 === 503 // true\n\n\n1\n2\n\n\nä» ES5 å¼å§ï¼å¨ä¸¥æ ¼æ¨¡å¼ä¹ä¸­ï¼å«è¿å¶å°±ä¸ååè®¸ä½¿ç¨åç¼0è¡¨ç¤ºï¼ES6 è¿ä¸æ­¥æç¡®ï¼è¦ä½¿ç¨åç¼0oè¡¨ç¤ºã\n\n// éä¸¥æ ¼æ¨¡å¼\n(function(){\n  console.log(0o11 === 011);\n})() // true\n\n// ä¸¥æ ¼æ¨¡å¼\n(function(){\n  'use strict';\n  console.log(0o11 === 011);\n})() // Uncaught SyntaxError: Octal literals are not allowed in strict mode.\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¦æè¦å°0bå0oåç¼çå­ç¬¦ä¸²æ°å¼è½¬ä¸ºåè¿å¶ï¼è¦ä½¿ç¨Numberæ¹æ³ã\n\nNumber('0b111')  // 7\nNumber('0o10')  // 8\n\n\n1\n2\n\n\n\n# Number.isFinite() æ¯å¦ä¸ºæé, Number.isNaN() æ¯å¦ä¸ºNaN\n\nES6 å¨Numberå¯¹è±¡ä¸ï¼æ°æä¾äºNumber.isFinite()åNumber.isNaN()ä¸¤ä¸ªæ¹æ³ã\n\nNumber.isFinite()ç¨æ¥æ£æ¥ä¸ä¸ªæ°å¼æ¯å¦ä¸ºæéçï¼finiteï¼ï¼å³ä¸æ¯Infinityã\n\nNumber.isFinite(15); // true\nNumber.isFinite(0.8); // true\nNumber.isFinite(NaN); // false\nNumber.isFinite(Infinity); // false\nNumber.isFinite(-Infinity); // false\nNumber.isFinite('foo'); // false\nNumber.isFinite('15'); // false\nNumber.isFinite(true); // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næ³¨æï¼å¦æåæ°ç±»åä¸æ¯æ°å¼ï¼Number.isFiniteä¸å¾è¿åfalseã\n\nNumber.isNaN()ç¨æ¥æ£æ¥ä¸ä¸ªå¼æ¯å¦ä¸ºNaNã\n\nNumber.isNaN(NaN) // true\nNumber.isNaN(15) // false\nNumber.isNaN('15') // false\nNumber.isNaN(true) // false\nNumber.isNaN(9/NaN) // true\nNumber.isNaN('true' / 0) // true\nNumber.isNaN('true' / 'true') // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦æåæ°ç±»åä¸æ¯NaNï¼Number.isNaNä¸å¾è¿åfalseã\n\nå®ä»¬ä¸ä¼ ç»çå¨å±æ¹æ³isFinite()åisNaN()çåºå«å¨äºï¼ä¼ ç»æ¹æ³åè°ç¨Number()å°éæ°å¼çå¼è½¬ä¸ºæ°å¼ï¼åè¿è¡å¤æ­ï¼èè¿ä¸¤ä¸ªæ°æ¹æ³åªå¯¹æ°å¼ææï¼Number.isFinite()å¯¹äºéæ°å¼ä¸å¾è¿åfalse, Number.isNaN()åªæå¯¹äºNaNæè¿åtrueï¼éNaNä¸å¾è¿åfalseã\n\nisFinite(25) // true\nisFinite(\"25\") // true\nNumber.isFinite(25) // true\nNumber.isFinite(\"25\") // false\n\nisNaN(NaN) // true\nisNaN(\"NaN\") // true\nNumber.isNaN(NaN) // true\nNumber.isNaN(\"NaN\") // false\nNumber.isNaN(1) // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# Number.parseInt(), Number.parseFloat()\n\nES6 å°å¨å±æ¹æ³parseInt()åparseFloat()ï¼ç§»æ¤å°Numberå¯¹è±¡ä¸é¢ï¼è¡ä¸ºå®å¨ä¿æä¸åã\n\n// ES5çåæ³\nparseInt('12.34') // 12\nparseFloat('123.45#') // 123.45\n\n// ES6çåæ³\nNumber.parseInt('12.34') // 12\nNumber.parseFloat('123.45#') // 123.45\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¿æ ·åçç®çï¼æ¯éæ­¥åå°å¨å±æ§æ¹æ³ï¼ä½¿å¾è¯­è¨éæ­¥æ¨¡ååã\n\nNumber.parseInt === parseInt // true\nNumber.parseFloat === parseFloat // true\n\n\n1\n2\n\n\n\n# Number.isInteger() æ¯å¦ä¸ºæ´æ°\n\nNumber.isInteger()ç¨æ¥å¤æ­ä¸ä¸ªæ°å¼æ¯å¦ä¸ºæ´æ°ã\n\nNumber.isInteger(25) // true\nNumber.isInteger(25.1) // false\n\n\n1\n2\n\n\nJavaScript åé¨ï¼æ´æ°åæµ®ç¹æ°éç¨çæ¯åæ ·çå¨å­æ¹æ³ï¼æä»¥ 25 å 25.0 è¢«è§ä¸ºåä¸ä¸ªå¼ã\n\nNumber.isInteger(25) // true\nNumber.isInteger(25.0) // true\n\n\n1\n2\n\n\nå¦æåæ°ä¸æ¯æ°å¼ï¼Number.isIntegerè¿åfalseã\n\nNumber.isInteger() // false\nNumber.isInteger(null) // false\nNumber.isInteger('15') // false\nNumber.isInteger(true) // false\n\n\n1\n2\n3\n4\n\n\næ³¨æï¼ç±äº JavaScript éç¨ IEEE 754 æ åï¼æ°å¼å­å¨ä¸º64ä½åç²¾åº¦æ ¼å¼ï¼æ°å¼ç²¾åº¦æå¤å¯ä»¥è¾¾å° 53 ä¸ªäºè¿å¶ä½ï¼1 ä¸ªéèä½ä¸ 52 ä¸ªææä½ï¼ãå¦ææ°å¼çç²¾åº¦è¶è¿è¿ä¸ªéåº¦ï¼ç¬¬54ä½ååé¢çä½å°±ä¼è¢«ä¸¢å¼ï¼è¿ç§æåµä¸ï¼Number.isIntegerå¯è½ä¼è¯¯å¤ã\n\nNumber.isInteger(3.0000000000000002) // true\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼Number.isIntegerçåæ°ææä¸æ¯æ´æ°ï¼ä½æ¯ä¼è¿åtrueãåå å°±æ¯è¿ä¸ªå°æ°çç²¾åº¦è¾¾å°äºå°æ°ç¹å16ä¸ªåè¿å¶ä½ï¼è½¬æäºè¿å¶ä½è¶è¿äº53ä¸ªäºè¿å¶ä½ï¼å¯¼è´æåçé£ä¸ª2è¢«ä¸¢å¼äºã\n\nç±»ä¼¼çæåµè¿æï¼å¦æä¸ä¸ªæ°å¼çç»å¯¹å¼å°äºNumber.MIN_VALUEï¼5E-324ï¼ï¼å³å°äº JavaScript è½å¤åè¾¨çæå°å¼ï¼ä¼è¢«èªå¨è½¬ä¸º 0ãè¿æ¶ï¼Number.isIntegerä¹ä¼è¯¯å¤ã\n\nNumber.isInteger(5E-324) // false\nNumber.isInteger(5E-325) // true\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼5E-325ç±äºå¼å¤ªå°ï¼ä¼è¢«èªå¨è½¬ä¸º0ï¼å æ­¤è¿åtrueã\n\næ»ä¹ï¼å¦æå¯¹æ°æ®ç²¾åº¦çè¦æ±è¾é«ï¼ä¸å»ºè®®ä½¿ç¨Number.isInteger()å¤æ­ä¸ä¸ªæ°å¼æ¯å¦ä¸ºæ´æ°ã\n\n\n# Number.EPSILON ç¨äºæµ®ç¹æ°è¯¯å·®æ£æ¥\n\nES6 å¨Numberå¯¹è±¡ä¸é¢ï¼æ°å¢ä¸ä¸ªæå°çå¸¸éNumber.EPSILONãæ ¹æ®è§æ ¼ï¼å®è¡¨ç¤º 1 ä¸å¤§äº 1 çæå°æµ®ç¹æ°ä¹é´çå·®ã\n\nå¯¹äº 64 ä½æµ®ç¹æ°æ¥è¯´ï¼å¤§äº 1 çæå°æµ®ç¹æ°ç¸å½äºäºè¿å¶ç1.00..001ï¼å°æ°ç¹åé¢æè¿ç»­ 51 ä¸ªé¶ãè¿ä¸ªå¼åå» 1 ä¹åï¼å°±ç­äº 2 ç -52 æ¬¡æ¹ã\n\nNumber.EPSILON === Math.pow(2, -52)\n// true\nNumber.EPSILON\n// 2.220446049250313e-16\nNumber.EPSILON.toFixed(20)\n// \"0.00000000000000022204\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nNumber.EPSILONå®éä¸æ¯ JavaScript è½å¤è¡¨ç¤ºçæå°ç²¾åº¦ãè¯¯å·®å¦æå°äºè¿ä¸ªå¼ï¼å°±å¯ä»¥è®¤ä¸ºå·²ç»æ²¡ææä¹äºï¼å³ä¸å­å¨è¯¯å·®äºã\n\nå¼å¥ä¸ä¸ªè¿ä¹å°çéçç®çï¼å¨äºä¸ºæµ®ç¹æ°è®¡ç®ï¼è®¾ç½®ä¸ä¸ªè¯¯å·®èå´ãæä»¬ç¥éæµ®ç¹æ°è®¡ç®æ¯ä¸ç²¾ç¡®çã\n\n0.1 + 0.2\n// 0.30000000000000004\n\n0.1 + 0.2 - 0.3\n// 5.551115123125783e-17\n\n5.551115123125783e-17.toFixed(20)\n// '0.00000000000000005551'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç è§£éäºï¼ä¸ºä»ä¹æ¯è¾0.1 + 0.2ä¸0.3å¾å°çç»ææ¯falseã\n\n0.1 + 0.2 === 0.3 // false\n\n\n1\n\n\nNumber.EPSILONå¯ä»¥ç¨æ¥è®¾ç½®âè½å¤æ¥åçè¯¯å·®èå´âãæ¯å¦ï¼è¯¯å·®èå´è®¾ä¸º 2 ç-50 æ¬¡æ¹ï¼å³Number.EPSILON * Math.pow(2, 2)ï¼ï¼å³å¦æä¸¤ä¸ªæµ®ç¹æ°çå·®å°äºè¿ä¸ªå¼ï¼æä»¬å°±è®¤ä¸ºè¿ä¸¤ä¸ªæµ®ç¹æ°ç¸ç­ã\n\n5.551115123125783e-17 < Number.EPSILON * Math.pow(2, 2)\n// true\n\n\n1\n2\n\n\nå æ­¤ï¼Number.EPSILONçå®è´¨æ¯ä¸ä¸ªå¯ä»¥æ¥åçæå°è¯¯å·®èå´ã\n\nfunction withinErrorMargin (left, right) {\n  return Math.abs(left - right) < Number.EPSILON * Math.pow(2, 2);\n}\n\n0.1 + 0.2 === 0.3 // false\nwithinErrorMargin(0.1 + 0.2, 0.3) // true\n\n1.1 + 1.3 === 2.4 // false\nwithinErrorMargin(1.1 + 1.3, 2.4) // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢çä»£ç ä¸ºæµ®ç¹æ°è¿ç®ï¼é¨ç½²äºä¸ä¸ªè¯¯å·®æ£æ¥å½æ°ã\n\n\n# å®å¨æ´æ°å Number.isSafeInteger()\n\nJavaScript è½å¤åç¡®è¡¨ç¤ºçæ´æ°èå´å¨-2^53å°2^53ä¹é´ï¼ä¸å«ä¸¤ä¸ªç«¯ç¹ï¼ï¼è¶è¿è¿ä¸ªèå´ï¼æ æ³ç²¾ç¡®è¡¨ç¤ºè¿ä¸ªå¼ã\n\nMath.pow(2, 53) // 9007199254740992\n\n9007199254740992  // 9007199254740992\n9007199254740993  // 9007199254740992\n\nMath.pow(2, 53) === Math.pow(2, 53) + 1\n// true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼è¶åº 2 ç 53 æ¬¡æ¹ä¹åï¼ä¸ä¸ªæ°å°±ä¸ç²¾ç¡®äºã\n\nES6 å¼å¥äºNumber.MAX_SAFE_INTEGERåNumber.MIN_SAFE_INTEGERè¿ä¸¤ä¸ªå¸¸éï¼ç¨æ¥è¡¨ç¤ºè¿ä¸ªèå´çä¸ä¸éã\n\nNumber.MAX_SAFE_INTEGER === Math.pow(2, 53) - 1\n// true\nNumber.MAX_SAFE_INTEGER === 9007199254740991\n// true\n\nNumber.MIN_SAFE_INTEGER === -Number.MAX_SAFE_INTEGER\n// true\nNumber.MIN_SAFE_INTEGER === -9007199254740991\n// true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯ä»¥çå° JavaScript è½å¤ç²¾ç¡®è¡¨ç¤ºçæéã\n\nNumber.isSafeInteger()åæ¯ç¨æ¥å¤æ­ä¸ä¸ªæ´æ°æ¯å¦è½å¨è¿ä¸ªèå´ä¹åã\n\nNumber.isSafeInteger('a') // false\nNumber.isSafeInteger(null) // false\nNumber.isSafeInteger(NaN) // false\nNumber.isSafeInteger(Infinity) // false\nNumber.isSafeInteger(-Infinity) // false\n\nNumber.isSafeInteger(3) // true\nNumber.isSafeInteger(1.2) // false\nNumber.isSafeInteger(9007199254740990) // true\nNumber.isSafeInteger(9007199254740992) // false\n\nNumber.isSafeInteger(Number.MIN_SAFE_INTEGER - 1) // false\nNumber.isSafeInteger(Number.MIN_SAFE_INTEGER) // true\nNumber.isSafeInteger(Number.MAX_SAFE_INTEGER) // true\nNumber.isSafeInteger(Number.MAX_SAFE_INTEGER + 1) // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nè¿ä¸ªå½æ°çå®ç°å¾ç®åï¼å°±æ¯è·å®å¨æ´æ°çä¸¤ä¸ªè¾¹çå¼æ¯è¾ä¸ä¸ã\n\nNumber.isSafeInteger = function (n) {\n  return (typeof n === 'number' &&\n    Math.round(n) === n &&\n    Number.MIN_SAFE_INTEGER <= n &&\n    n <= Number.MAX_SAFE_INTEGER);\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nå®éä½¿ç¨è¿ä¸ªå½æ°æ¶ï¼éè¦æ³¨æãéªè¯è¿ç®ç»ææ¯å¦è½å¨å®å¨æ´æ°çèå´åï¼ä¸è¦åªéªè¯è¿ç®ç»æï¼èè¦åæ¶éªè¯åä¸è¿ç®çæ¯ä¸ªå¼ã\n\nNumber.isSafeInteger(9007199254740993)\n// false\nNumber.isSafeInteger(990)\n// true\nNumber.isSafeInteger(9007199254740993 - 990)\n// true\n9007199254740993 - 990\n// è¿åç»æ 9007199254740002\n// æ­£ç¡®ç­æ¡åºè¯¥æ¯ 9007199254740003\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼9007199254740993ä¸æ¯ä¸ä¸ªå®å¨æ´æ°ï¼ä½æ¯Number.isSafeIntegerä¼è¿åç»æï¼æ¾ç¤ºè®¡ç®ç»ææ¯å®å¨çãè¿æ¯å ä¸ºï¼è¿ä¸ªæ°è¶åºäºç²¾åº¦èå´ï¼å¯¼è´å¨è®¡ç®æºåé¨ï¼ä»¥9007199254740992çå½¢å¼å¨å­ã\n\n9007199254740993 === 9007199254740992\n// true\n\n\n1\n2\n\n\næä»¥ï¼å¦æåªéªè¯è¿ç®ç»ææ¯å¦ä¸ºå®å¨æ´æ°ï¼å¾å¯è½å¾å°éè¯¯ç»æãä¸é¢çå½æ°å¯ä»¥åæ¶éªè¯ä¸¤ä¸ªè¿ç®æ°åè¿ç®ç»æã\n\nfunction trusty (left, right, result) {\n  if (\n    Number.isSafeInteger(left) &&\n    Number.isSafeInteger(right) &&\n    Number.isSafeInteger(result)\n  ) {\n    return result;\n  }\n  throw new RangeError('Operation cannot be trusted!');\n}\n\ntrusty(9007199254740993, 990, 9007199254740993 - 990)\n// RangeError: Operation cannot be trusted!\n\ntrusty(1, 2, 3)\n// 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n# Math å¯¹è±¡çæ©å±\n\nES6 å¨ Math å¯¹è±¡ä¸æ°å¢äº 17 ä¸ªä¸æ°å­¦ç¸å³çæ¹æ³ãææè¿äºæ¹æ³é½æ¯éææ¹æ³ï¼åªè½å¨ Math å¯¹è±¡ä¸è°ç¨ã\n\n\n# Math.trunc() å»é¤ä¸ä¸ªæ°çå°æ°é¨åï¼è¿åæ´æ°é¨å\n\nMath.truncæ¹æ³ç¨äºå»é¤ä¸ä¸ªæ°çå°æ°é¨åï¼è¿åæ´æ°é¨åã\n\nMath.trunc(4.1) // 4\nMath.trunc(4.9) // 4\nMath.trunc(-4.1) // -4\nMath.trunc(-4.9) // -4\nMath.trunc(-0.1234) // -0\n\n\n1\n2\n3\n4\n5\n\n\nå¯¹äºéæ°å¼ï¼Math.truncåé¨ä½¿ç¨Numberæ¹æ³å°å¶åè½¬ä¸ºæ°å¼ã\n\nMath.trunc('123.456') // 123\nMath.trunc(true) //1\nMath.trunc(false) // 0\nMath.trunc(null) // 0\n\n\n1\n2\n3\n4\n\n\nå¯¹äºç©ºå¼åæ æ³æªåæ´æ°çå¼ï¼è¿åNaNã\n\nMath.trunc(NaN);      // NaN\nMath.trunc('foo');    // NaN\nMath.trunc();         // NaN\nMath.trunc(undefined) // NaN\n\n\n1\n2\n3\n4\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nMath.trunc = Math.trunc || function(x) {\n  return x < 0 ? Math.ceil(x) : Math.floor(x);\n};\n\n\n1\n2\n3\n\n\n\n# Math.sign() å¤æ­ä¸ä¸ªæ°æ¯æ­£æ°ãè´æ°ãè¿æ¯é¶\n\nMath.signæ¹æ³ç¨æ¥å¤æ­ä¸ä¸ªæ°å°åºæ¯æ­£æ°ãè´æ°ãè¿æ¯é¶ãå¯¹äºéæ°å¼ï¼ä¼åå°å¶è½¬æ¢ä¸ºæ°å¼ã\n\nå®ä¼è¿åäºç§å¼ã\n\n * åæ°ä¸ºæ­£æ°ï¼è¿å+1ï¼\n * åæ°ä¸ºè´æ°ï¼è¿å-1ï¼\n * åæ°ä¸º 0ï¼è¿å0ï¼\n * åæ°ä¸º-0ï¼è¿å-0;\n * å¶ä»å¼ï¼è¿åNaNã\n\nMath.sign(-5) // -1\nMath.sign(5) // +1\nMath.sign(0) // +0\nMath.sign(-0) // -0\nMath.sign(NaN) // NaN\n\n\n1\n2\n3\n4\n5\n\n\nå¦æåæ°æ¯éæ°å¼ï¼ä¼èªå¨è½¬ä¸ºæ°å¼ãå¯¹äºé£äºæ æ³è½¬ä¸ºæ°å¼çå¼ï¼ä¼è¿åNaNã\n\nMath.sign('')  // 0\nMath.sign(true)  // +1\nMath.sign(false)  // 0\nMath.sign(null)  // 0\nMath.sign('9')  // +1\nMath.sign('foo')  // NaN\nMath.sign()  // NaN\nMath.sign(undefined)  // NaN\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nMath.sign = Math.sign || function(x) {\n  x = +x; // convert to a number\n  if (x === 0 || isNaN(x)) {\n    return x;\n  }\n  return x > 0 ? 1 : -1;\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# Math.cbrt() è®¡ç®ä¸ä¸ªæ°çç«æ¹æ ¹\n\nMath.cbrtæ¹æ³ç¨äºè®¡ç®ä¸ä¸ªæ°çç«æ¹æ ¹ã\n\nMath.cbrt(-1) // -1\nMath.cbrt(0)  // 0\nMath.cbrt(1)  // 1\nMath.cbrt(2)  // 1.2599210498948734\n\n\n1\n2\n3\n4\n\n\nå¯¹äºéæ°å¼ï¼Math.cbrtæ¹æ³åé¨ä¹æ¯åä½¿ç¨Numberæ¹æ³å°å¶è½¬ä¸ºæ°å¼ã\n\nMath.cbrt('8') // 2\nMath.cbrt('hello') // NaN\n\n\n1\n2\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nMath.cbrt = Math.cbrt || function(x) {\n  var y = Math.pow(Math.abs(x), 1/3);\n  return x < 0 ? -y : y;\n};\n\n\n1\n2\n3\n4\n\n\n\n# Math.clz32()\n\nMath.clz32()æ¹æ³å°åæ°è½¬ä¸º 32 ä½æ ç¬¦å·æ´æ°çå½¢å¼ï¼ç¶åè¿åè¿ä¸ª 32 ä½å¼éé¢æå¤å°ä¸ªåå¯¼ 0ã\n\nMath.clz32(0) // 32\nMath.clz32(1) // 31\nMath.clz32(1000) // 22\nMath.clz32(0b01000000000000000000000000000000) // 1\nMath.clz32(0b00100000000000000000000000000000) // 2\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼0 çäºè¿å¶å½¢å¼å¨ä¸º 0ï¼æä»¥æ 32 ä¸ªåå¯¼ 0ï¼1 çäºè¿å¶å½¢å¼æ¯0b1ï¼åªå  1 ä½ï¼æä»¥ 32 ä½ä¹ä¸­æ 31 ä¸ªåå¯¼ 0ï¼1000 çäºè¿å¶å½¢å¼æ¯0b1111101000ï¼ä¸å±æ 10 ä½ï¼æä»¥ 32 ä½ä¹ä¸­æ 22 ä¸ªåå¯¼ 0ã\n\nclz32è¿ä¸ªå½æ°åå°±æ¥èªâcount leading zero bits in 32-bit binary representation of a numberâï¼è®¡ç®ä¸ä¸ªæ°ç 32 ä½äºè¿å¶å½¢å¼çåå¯¼ 0 çä¸ªæ°ï¼çç¼©åã\n\nå·¦ç§»è¿ç®ç¬¦ï¼<<ï¼ä¸Math.clz32æ¹æ³ç´æ¥ç¸å³ã\n\nMath.clz32(0) // 32\nMath.clz32(1) // 31\nMath.clz32(1 << 1) // 30\nMath.clz32(1 << 2) // 29\nMath.clz32(1 << 29) // 2\n\n\n1\n2\n3\n4\n5\n\n\nå¯¹äºå°æ°ï¼Math.clz32æ¹æ³åªèèæ´æ°é¨åã\n\nMath.clz32(3.2) // 30\nMath.clz32(3.9) // 30\n\n\n1\n2\n\n\nå¯¹äºç©ºå¼æå¶ä»ç±»åçå¼ï¼Math.clz32æ¹æ³ä¼å°å®ä»¬åè½¬ä¸ºæ°å¼ï¼ç¶ååè®¡ç®ã\n\nMath.clz32() // 32\nMath.clz32(NaN) // 32\nMath.clz32(Infinity) // 32\nMath.clz32(null) // 32\nMath.clz32('foo') // 32\nMath.clz32([]) // 32\nMath.clz32({}) // 32\nMath.clz32(true) // 31\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# Math.imul()\n\nMath.imulæ¹æ³è¿åä¸¤ä¸ªæ°ä»¥ 32 ä½å¸¦ç¬¦å·æ´æ°å½¢å¼ç¸ä¹çç»æï¼è¿åçä¹æ¯ä¸ä¸ª 32 ä½çå¸¦ç¬¦å·æ´æ°ã\n\nMath.imul(2, 4)   // 8\nMath.imul(-1, 8)  // -8\nMath.imul(-2, -2) // 4\n\n\n1\n2\n3\n\n\nå¦æåªèèæå 32 ä½ï¼å¤§å¤æ°æåµä¸ï¼Math.imul(a, b)ä¸a * bçç»ææ¯ç¸åçï¼å³è¯¥æ¹æ³ç­åäº(a * b)|0çææï¼è¶è¿ 32 ä½çé¨åæº¢åºï¼ãä¹æä»¥éè¦é¨ç½²è¿ä¸ªæ¹æ³ï¼æ¯å ä¸º JavaScript æç²¾åº¦éå¶ï¼è¶è¿ 2 ç 53 æ¬¡æ¹çå¼æ æ³ç²¾ç¡®è¡¨ç¤ºãè¿å°±æ¯è¯´ï¼å¯¹äºé£äºå¾å¤§çæ°çä¹æ³ï¼ä½ä½æ°å¼å¾å¾é½æ¯ä¸ç²¾ç¡®çï¼Math.imulæ¹æ³å¯ä»¥è¿åæ­£ç¡®çä½ä½æ°å¼ã\n\n(0x7fffffff * 0x7fffffff)|0 // 0\n\n\n1\n\n\nä¸é¢è¿ä¸ªä¹æ³ç®å¼ï¼è¿åç»æä¸º 0ãä½æ¯ç±äºè¿ä¸¤ä¸ªäºè¿å¶æ°çæä½ä½é½æ¯ 1ï¼æä»¥è¿ä¸ªç»æè¯å®æ¯ä¸æ­£ç¡®çï¼å ä¸ºæ ¹æ®äºè¿å¶ä¹æ³ï¼è®¡ç®ç»æçäºè¿å¶æä½ä½åºè¯¥ä¹æ¯ 1ãè¿ä¸ªéè¯¯å°±æ¯å ä¸ºå®ä»¬çä¹ç§¯è¶è¿äº 2 ç 53 æ¬¡æ¹ï¼JavaScript æ æ³ä¿å­é¢å¤çç²¾åº¦ï¼å°±æä½ä½çå¼é½åæäº 0ãMath.imulæ¹æ³å¯ä»¥è¿åæ­£ç¡®çå¼ 1ã\n\nMath.imul(0x7fffffff, 0x7fffffff) // 1\n\n\n1\n\n\n\n# Math.fround()\n\nMath.froundæ¹æ³è¿åä¸ä¸ªæ°ç32ä½åç²¾åº¦æµ®ç¹æ°å½¢å¼ã\n\nå¯¹äº32ä½åç²¾åº¦æ ¼å¼æ¥è¯´ï¼æ°å¼ç²¾åº¦æ¯24ä¸ªäºè¿å¶ä½ï¼1 ä½éèä½ä¸ 23 ä½ææä½ï¼ï¼æä»¥å¯¹äº -224 è³ 224 ä¹é´çæ´æ°ï¼ä¸å«ä¸¤ä¸ªç«¯ç¹ï¼ï¼è¿åç»æä¸åæ°æ¬èº«ä¸è´ã\n\nMath.fround(0)   // 0\nMath.fround(1)   // 1\nMath.fround(2 ** 24 - 1)   // 16777215\n\n\n1\n2\n3\n\n\nå¦æåæ°çç»å¯¹å¼å¤§äº 224ï¼è¿åçç»æä¾¿å¼å§ä¸¢å¤±ç²¾åº¦ã\n\nMath.fround(2 ** 24)       // 16777216\nMath.fround(2 ** 24 + 1)   // 16777216\n\n\n1\n2\n\n\nMath.froundæ¹æ³çä¸»è¦ä½ç¨ï¼æ¯å°64ä½åç²¾åº¦æµ®ç¹æ°è½¬ä¸º32ä½åç²¾åº¦æµ®ç¹æ°ãå¦æå°æ°çç²¾åº¦è¶è¿24ä¸ªäºè¿å¶ä½ï¼è¿åå¼å°±ä¼ä¸åäºåå¼ï¼å¦åè¿åå¼ä¸åï¼å³ä¸64ä½åç²¾åº¦å¼ä¸è´ï¼ã\n\n// æªä¸¢å¤±ææç²¾åº¦\nMath.fround(1.125) // 1.125\nMath.fround(7.25)  // 7.25\n\n// ä¸¢å¤±ç²¾åº¦\nMath.fround(0.3)   // 0.30000001192092896\nMath.fround(0.7)   // 0.699999988079071\nMath.fround(1.0000000123) // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¯¹äº NaN å Infinityï¼æ­¤æ¹æ³è¿ååå¼ãå¯¹äºå¶å®ç±»åçéæ°å¼ï¼Math.fround æ¹æ³ä¼åå°å¶è½¬ä¸ºæ°å¼ï¼åè¿ååç²¾åº¦æµ®ç¹æ°ã\n\nMath.fround(NaN)      // NaN\nMath.fround(Infinity) // Infinity\n\nMath.fround('5')      // 5\nMath.fround(true)     // 1\nMath.fround(null)     // 0\nMath.fround([])       // 0\nMath.fround({})       // NaN\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nMath.fround = Math.fround || function (x) {\n  return new Float32Array([x])[0];\n};\n\n\n1\n2\n3\n\n\n\n# Math.hypot()\n\nMath.hypotæ¹æ³è¿åææåæ°çå¹³æ¹åçå¹³æ¹æ ¹ã\n\nMath.hypot(3, 4);        // 5\nMath.hypot(3, 4, 5);     // 7.0710678118654755\nMath.hypot();            // 0\nMath.hypot(NaN);         // NaN\nMath.hypot(3, 4, 'foo'); // NaN\nMath.hypot(3, 4, '5');   // 7.0710678118654755\nMath.hypot(-3);          // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼3 çå¹³æ¹å ä¸ 4 çå¹³æ¹ï¼ç­äº 5 çå¹³æ¹ã\n\nå¦æåæ°ä¸æ¯æ°å¼ï¼Math.hypotæ¹æ³ä¼å°å¶è½¬ä¸ºæ°å¼ãåªè¦æä¸ä¸ªåæ°æ æ³è½¬ä¸ºæ°å¼ï¼å°±ä¼è¿å NaNã\n\n\n# å¯¹æ°æ¹æ³\n\nES6 æ°å¢äº 4 ä¸ªå¯¹æ°ç¸å³æ¹æ³ã\n\nï¼1ï¼ Math.expm1()\n\nMath.expm1(x)è¿å ex - 1ï¼å³Math.exp(x) - 1ã\n\nMath.expm1(-1) // -0.6321205588285577\nMath.expm1(0)  // 0\nMath.expm1(1)  // 1.718281828459045\n\n\n1\n2\n3\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nMath.expm1 = Math.expm1 || function(x) {\n  return Math.exp(x) - 1;\n};\n\n\n1\n2\n3\n\n\nï¼2ï¼Math.log1p()\n\nMath.log1p(x)æ¹æ³è¿å1 + xçèªç¶å¯¹æ°ï¼å³Math.log(1 + x)ãå¦æxå°äº-1ï¼è¿åNaNã\n\nMath.log1p(1)  // 0.6931471805599453\nMath.log1p(0)  // 0\nMath.log1p(-1) // -Infinity\nMath.log1p(-2) // NaN\n\n\n1\n2\n3\n4\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nMath.log1p = Math.log1p || function(x) {\n  return Math.log(1 + x);\n};\n\n\n1\n2\n3\n\n\nï¼3ï¼Math.log10()\n\nMath.log10(x)è¿åä»¥ 10 ä¸ºåºçxçå¯¹æ°ãå¦æxå°äº 0ï¼åè¿å NaNã\n\nMath.log10(2)      // 0.3010299956639812\nMath.log10(1)      // 0\nMath.log10(0)      // -Infinity\nMath.log10(-2)     // NaN\nMath.log10(100000) // 5\n\n\n1\n2\n3\n4\n5\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nMath.log10 = Math.log10 || function(x) {\n  return Math.log(x) / Math.LN10;\n};\n\n\n1\n2\n3\n\n\nï¼4ï¼Math.log2()\n\nMath.log2(x)è¿åä»¥ 2 ä¸ºåºçxçå¯¹æ°ãå¦æxå°äº 0ï¼åè¿å NaNã\n\nMath.log2(3)       // 1.584962500721156\nMath.log2(2)       // 1\nMath.log2(1)       // 0\nMath.log2(0)       // -Infinity\nMath.log2(-2)      // NaN\nMath.log2(1024)    // 10\nMath.log2(1 << 29) // 29\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nMath.log2 = Math.log2 || function(x) {\n  return Math.log(x) / Math.LN2;\n};\n\n\n1\n2\n3\n\n\n\n# åæ²å½æ°æ¹æ³\n\nES6 æ°å¢äº 6 ä¸ªåæ²å½æ°æ¹æ³ã\n\n * Math.sinh(x) è¿åxçåæ²æ­£å¼¦ï¼hyperbolic sineï¼\n * Math.cosh(x) è¿åxçåæ²ä½å¼¦ï¼hyperbolic cosineï¼\n * Math.tanh(x) è¿åxçåæ²æ­£åï¼hyperbolic tangentï¼\n * Math.asinh(x) è¿åxçååæ²æ­£å¼¦ï¼inverse hyperbolic sineï¼\n * Math.acosh(x) è¿åxçååæ²ä½å¼¦ï¼inverse hyperbolic cosineï¼\n * Math.atanh(x) è¿åxçååæ²æ­£åï¼inverse hyperbolic tangentï¼\n\n\n# ææ°è¿ç®ç¬¦\n\nES2016 æ°å¢äºä¸ä¸ªææ°è¿ç®ç¬¦ï¼**ï¼ã\n\n2 ** 2 // 4\n2 ** 3 // 8\n\n\n1\n2\n\n\nè¿ä¸ªè¿ç®ç¬¦çä¸ä¸ªç¹ç¹æ¯å³ç»åï¼èä¸æ¯å¸¸è§çå·¦ç»åãå¤ä¸ªææ°è¿ç®ç¬¦è¿ç¨æ¶ï¼æ¯ä»æå³è¾¹å¼å§è®¡ç®çã\n\n// ç¸å½äº 2 ** (3 ** 2)\n2 ** 3 ** 2\n// 512\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼é¦åè®¡ç®çæ¯ç¬¬äºä¸ªææ°è¿ç®ç¬¦ï¼èä¸æ¯ç¬¬ä¸ä¸ªã\n\nææ°è¿ç®ç¬¦å¯ä»¥ä¸ç­å·ç»åï¼å½¢æä¸ä¸ªæ°çèµå¼è¿ç®ç¬¦ï¼**=ï¼ã\n\nlet a = 1.5;\na **= 2;\n// ç­åäº a = a * a;\n\nlet b = 4;\nb **= 3;\n// ç­åäº b = b * b * b;\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næ³¨æï¼V8 å¼æçææ°è¿ç®ç¬¦ä¸Math.powçå®ç°ä¸ç¸åï¼å¯¹äºç¹å«å¤§çè¿ç®ç»æï¼ä¸¤èä¼æç»å¾®çå·®å¼ã\n\nMath.pow(99, 99)\n// 3.697296376497263e+197\n\n99 ** 99\n// 3.697296376497268e+197\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸¤ä¸ªè¿ç®ç»æçæåä¸ä½æææ°å­æ¯æå·®å¼çã\n\n\n# BigInt æ°æ®ç±»å\n\n\n# ç®ä»\n\nJavaScript æææ°å­é½ä¿å­æ 64 ä½æµ®ç¹æ°ï¼è¿ç»æ°å¼çè¡¨ç¤ºå¸¦æ¥äºä¸¤å¤§éå¶ãä¸æ¯æ°å¼çç²¾åº¦åªè½å° 53 ä¸ªäºè¿å¶ä½ï¼ç¸å½äº 16 ä¸ªåè¿å¶ä½ï¼ï¼å¤§äºè¿ä¸ªèå´çæ´æ°ï¼JavaScript æ¯æ æ³ç²¾ç¡®è¡¨ç¤ºçï¼è¿ä½¿å¾ JavaScript ä¸éåè¿è¡ç§å­¦åéèæ¹é¢çç²¾ç¡®è®¡ç®ãäºæ¯å¤§äºæç­äº2ç1024æ¬¡æ¹çæ°å¼ï¼JavaScript æ æ³è¡¨ç¤ºï¼ä¼è¿åInfinityã\n\n// è¶è¿ 53 ä¸ªäºè¿å¶ä½çæ°å¼ï¼æ æ³ä¿æç²¾åº¦\nMath.pow(2, 53) === Math.pow(2, 53) + 1 // true\n\n// è¶è¿ 2 ç 1024 æ¬¡æ¹çæ°å¼ï¼æ æ³è¡¨ç¤º\nMath.pow(2, 1024) // Infinity\n\n\n1\n2\n3\n4\n5\n\n\nES2020 å¼å¥äºä¸ç§æ°çæ°æ®ç±»å BigIntï¼å¤§æ´æ°ï¼ï¼æ¥è§£å³è¿ä¸ªé®é¢ãBigInt åªç¨æ¥è¡¨ç¤ºæ´æ°ï¼æ²¡æä½æ°çéå¶ï¼ä»»ä½ä½æ°çæ´æ°é½å¯ä»¥ç²¾ç¡®è¡¨ç¤ºã\n\nconst a = 2172141653n;\nconst b = 15346349309n;\n\n// BigInt å¯ä»¥ä¿æç²¾åº¦\na * b // 33334444555566667777n\n\n// æ®éæ´æ°æ æ³ä¿æç²¾åº¦\nNumber(a) * Number(b) // 33334444555566670000\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸ºäºä¸ Number ç±»ååºå«ï¼BigInt ç±»åçæ°æ®å¿é¡»æ·»å åç¼nã\n\n1234 // æ®éæ´æ°\n1234n // BigInt\n\n// BigInt çè¿ç®\n1n + 2n // 3n\n\n\n1\n2\n3\n4\n5\n\n\nBigInt åæ ·å¯ä»¥ä½¿ç¨åç§è¿å¶è¡¨ç¤ºï¼é½è¦å ä¸åç¼nã\n\n0b1101n // äºè¿å¶\n0o777n // å«è¿å¶\n0xFFn // åå­è¿å¶\n\n\n1\n2\n3\n\n\nBigInt ä¸æ®éæ´æ°æ¯ä¸¤ç§å¼ï¼å®ä»¬ä¹é´å¹¶ä¸ç¸ç­ã\n\n42n === 42 // false\n\n\n1\n\n\ntypeofè¿ç®ç¬¦å¯¹äº BigInt ç±»åçæ°æ®è¿åbigintã\n\ntypeof 123n // 'bigint'\n\n\n1\n\n\nBigInt å¯ä»¥ä½¿ç¨è´å·ï¼-ï¼ï¼ä½æ¯ä¸è½ä½¿ç¨æ­£å·ï¼+ï¼ï¼å ä¸ºä¼ä¸ asm.js å²çªã\n\n-42n // æ­£ç¡®\n+42n // æ¥é\n\n\n1\n2\n\n\nJavaScript ä»¥åä¸è½è®¡ç®70çé¶ä¹ï¼å³70!ï¼ï¼å ä¸ºè¶åºäºå¯ä»¥è¡¨ç¤ºçç²¾åº¦ã\n\nlet p = 1;\nfor (let i = 1; i <= 70; i++) {\n  p *= i;\n}\nconsole.log(p); // 1.197857166996989e+100\n\n\n1\n2\n3\n4\n5\n\n\nç°å¨æ¯æå¤§æ´æ°äºï¼å°±å¯ä»¥ç®äºï¼æµè§å¨çå¼åèå·¥å·è¿è¡ä¸é¢ä»£ç ï¼å°±OKã\n\nlet p = 1n;\nfor (let i = 1n; i <= 70n; i++) {\n  p *= i;\n}\nconsole.log(p); // 11978571...00000000n\n\n\n1\n2\n3\n4\n5\n\n\n\n# BigInt å¯¹è±¡\n\nJavaScript åçæä¾BigIntå¯¹è±¡ï¼å¯ä»¥ç¨ä½æé å½æ°çæ BigInt ç±»åçæ°å¼ãè½¬æ¢è§ååºæ¬ä¸Number()ä¸è´ï¼å°å¶ä»ç±»åçå¼è½¬ä¸º BigIntã\n\nBigInt(123) // 123n\nBigInt('123') // 123n\nBigInt(false) // 0n\nBigInt(true) // 1n\n\n\n1\n2\n3\n4\n\n\nBigInt()æé å½æ°å¿é¡»æåæ°ï¼èä¸åæ°å¿é¡»å¯ä»¥æ­£å¸¸è½¬ä¸ºæ°å¼ï¼ä¸é¢çç¨æ³é½ä¼æ¥éã\n\nnew BigInt() // TypeError\nBigInt(undefined) //TypeError\nBigInt(null) // TypeError\nBigInt('123n') // SyntaxError\nBigInt('abc') // SyntaxError\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å°¤å¶å¼å¾æ³¨æå­ç¬¦ä¸²123næ æ³è§£ææ Number ç±»åï¼æä»¥ä¼æ¥éã\n\nåæ°å¦ææ¯å°æ°ï¼ä¹ä¼æ¥éã\n\nBigInt(1.5) // RangeError\nBigInt('1.5') // SyntaxError\n\n\n1\n2\n\n\nBigInt å¯¹è±¡ç»§æ¿äº Object å¯¹è±¡çä¸¤ä¸ªå®ä¾æ¹æ³ã\n\n * BigInt.prototype.toString()\n * BigInt.prototype.valueOf()\n\nå®è¿ç»§æ¿äº Number å¯¹è±¡çä¸ä¸ªå®ä¾æ¹æ³ã\n\n * BigInt.prototype.toLocaleString()\n\næ­¤å¤ï¼è¿æä¾äºä¸ä¸ªéææ¹æ³ã\n\n * BigInt.asUintN(width, BigInt)ï¼ ç»å®ç BigInt è½¬ä¸º 0 å° 2width - 1 ä¹é´å¯¹åºçå¼ã\n * BigInt.asIntN(width, BigInt)ï¼ç»å®ç BigInt è½¬ä¸º -2width - 1 å° 2width - 1 - 1 ä¹é´å¯¹åºçå¼ã\n * BigInt.parseInt(string[, radix])ï¼è¿ä¼¼äºNumber.parseInt()ï¼å°ä¸ä¸ªå­ç¬¦ä¸²è½¬æ¢ææå®è¿å¶ç BigIntã\n\nconst max = 2n ** (64n - 1n) - 1n;\n\nBigInt.asIntN(64, max)\n// 9223372036854775807n\nBigInt.asIntN(64, max + 1n)\n// -9223372036854775808n\nBigInt.asUintN(64, max + 1n)\n// 9223372036854775808n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼maxæ¯64ä½å¸¦ç¬¦å·ç BigInt æè½è¡¨ç¤ºçæå¤§å¼ãå¦æå¯¹è¿ä¸ªå¼å 1nï¼BigInt.asIntN()å°ä¼è¿åä¸ä¸ªè´å¼ï¼å ä¸ºè¿æ¶æ°å¢çä¸ä½å°è¢«è§£éä¸ºç¬¦å·ä½ãèBigInt.asUintN()æ¹æ³ç±äºä¸å­å¨ç¬¦å·ä½ï¼æä»¥å¯ä»¥æ­£ç¡®è¿åç»æã\n\nå¦æBigInt.asIntN()åBigInt.asUintN()æå®çä½æ°ï¼å°äºæ°å¼æ¬èº«çä½æ°ï¼é£ä¹å¤´é¨çä½å°è¢«èå¼ã\n\nconst max = 2n ** (64n - 1n) - 1n;\n\nBigInt.asIntN(32, max) // -1n\nBigInt.asUintN(32, max) // 4294967295n\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼maxæ¯ä¸ä¸ª64ä½ç BigIntï¼å¦æè½¬ä¸º32ä½ï¼åé¢ç32ä½é½ä¼è¢«èå¼ã\n\nä¸é¢æ¯BigInt.parseInt()çä¾å­ã\n\n// Number.parseInt() ä¸ BigInt.parseInt() çå¯¹æ¯\nNumber.parseInt('9007199254740993', 10)\n// 9007199254740992\nBigInt.parseInt('9007199254740993', 10)\n// 9007199254740993n\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºæææ°å­è¶åºäºæå¤§éåº¦ï¼Number.parseIntæ¹æ³è¿åçç»ææ¯ä¸ç²¾ç¡®çï¼èBigInt.parseIntæ¹æ³æ­£ç¡®è¿åäºå¯¹åºç BigIntã\n\nå¯¹äºäºè¿å¶æ°ç»ï¼BigInt æ°å¢äºä¸¤ä¸ªç±»åBigUint64ArrayåBigInt64Arrayï¼è¿ä¸¤ç§æ°æ®ç±»åè¿åçé½æ¯64ä½ BigIntãDataViewå¯¹è±¡çå®ä¾æ¹æ³DataView.prototype.getBigInt64()åDataView.prototype.getBigUint64()ï¼è¿åçä¹æ¯ BigIntã\n\n\n# è½¬æ¢è§å\n\nå¯ä»¥ä½¿ç¨Boolean()ãNumber()åString()è¿ä¸ä¸ªæ¹æ³ï¼å° BigInt å¯ä»¥è½¬ä¸ºå¸å°å¼ãæ°å¼åå­ç¬¦ä¸²ç±»åã\n\nBoolean(0n) // false\nBoolean(1n) // true\nNumber(1n)  // 1\nString(1n)  // \"1\"\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼æ³¨ææåä¸ä¸ªä¾å­ï¼è½¬ä¸ºå­ç¬¦ä¸²æ¶åç¼nä¼æ¶å¤±ã\n\nå¦å¤ï¼ååè¿ç®ç¬¦ï¼!ï¼ä¹å¯ä»¥å° BigInt è½¬ä¸ºå¸å°å¼ã\n\n!0n // true\n!1n // false\n\n\n1\n2\n\n\n\n# æ°å­¦è¿ç®\n\næ°å­¦è¿ç®æ¹é¢ï¼BigInt ç±»åç+ã-ã*å**è¿åä¸ªäºåè¿ç®ç¬¦ï¼ä¸ Number ç±»åçè¡ä¸ºä¸è´ãé¤æ³è¿ç®/ä¼èå»å°æ°é¨åï¼è¿åä¸ä¸ªæ´æ°ã\n\n9n / 5n\n// 1n\n\n\n1\n2\n\n\nå ä¹ææçæ°å¼è¿ç®ç¬¦é½å¯ä»¥ç¨å¨ BigIntï¼ä½æ¯æä¸¤ä¸ªä¾å¤ã\n\n * ä¸å¸¦ç¬¦å·çå³ç§»ä½è¿ç®ç¬¦>>>\n * ä¸åçæ±æ­£è¿ç®ç¬¦+\n\nä¸é¢ä¸¤ä¸ªè¿ç®ç¬¦ç¨å¨ BigInt ä¼æ¥éãåèæ¯å ä¸º>>>è¿ç®ç¬¦æ¯ä¸å¸¦ç¬¦å·çï¼ä½æ¯ BigInt æ»æ¯å¸¦æç¬¦å·çï¼å¯¼è´è¯¥è¿ç®æ æä¹ï¼å®å¨ç­åäºå³ç§»è¿ç®ç¬¦>>ãåèæ¯å ä¸ºä¸åè¿ç®ç¬¦+å¨ asm.js éé¢æ»æ¯è¿å Number ç±»åï¼ä¸ºäºä¸ç ´å asm.js å°±è§å®+1nä¼æ¥éã\n\nBigInt ä¸è½ä¸æ®éæ°å¼è¿è¡æ··åè¿ç®ã\n\n1n + 1.3 // æ¥é\n\n\n1\n\n\nä¸é¢ä»£ç æ¥éæ¯å ä¸ºæ è®ºè¿åçæ¯ BigInt æ Numberï¼é½ä¼å¯¼è´ä¸¢å¤±ç²¾åº¦ä¿¡æ¯ãæ¯å¦(2n**53n + 1n) + 0.5è¿ä¸ªè¡¨è¾¾å¼ï¼å¦æè¿å BigInt ç±»åï¼0.5è¿ä¸ªå°æ°é¨åä¼ä¸¢å¤±ï¼å¦æè¿å Number ç±»åï¼ææç²¾åº¦åªè½ä¿æ 53 ä½ï¼å¯¼è´ç²¾åº¦ä¸éã\n\nåæ ·çåå ï¼å¦æä¸ä¸ªæ ååºå½æ°çåæ°é¢ææ¯ Number ç±»åï¼ä½æ¯å¾å°çæ¯ä¸ä¸ª BigIntï¼å°±ä¼æ¥éã\n\n// éè¯¯çåæ³\nMath.sqrt(4n) // æ¥é\n\n// æ­£ç¡®çåæ³\nMath.sqrt(Number(4n)) // 2\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼Math.sqrtçåæ°é¢ææ¯ Number ç±»åï¼å¦ææ¯ BigInt å°±ä¼æ¥éï¼å¿é¡»åç¨Numberæ¹æ³è½¬ä¸ä¸ç±»åï¼æè½è¿è¡è®¡ç®ã\n\nasm.js éé¢ï¼|0è·å¨ä¸ä¸ªæ°å¼çåé¢ä¼è¿åä¸ä¸ª32ä½æ´æ°ãæ ¹æ®ä¸è½ä¸ Number ç±»åæ··åè¿ç®çè§åï¼BigInt å¦æä¸|0è¿è¡è¿ç®ä¼æ¥éã\n\n1n | 0 // æ¥é\n\n\n1\n\n\n\n# å¶ä»è¿ç®\n\nBigInt å¯¹åºçå¸å°å¼ï¼ä¸ Number ç±»åä¸è´ï¼å³0nä¼è½¬ä¸ºfalseï¼å¶ä»å¼è½¬ä¸ºtrueã\n\nif (0n) {\n  console.log('if');\n} else {\n  console.log('else');\n}\n// else\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼0nå¯¹åºfalseï¼æä»¥ä¼è¿å¥elseå­å¥ã\n\næ¯è¾è¿ç®ç¬¦ï¼æ¯å¦>ï¼åç¸ç­è¿ç®ç¬¦ï¼==ï¼åè®¸ BigInt ä¸å¶ä»ç±»åçå¼æ··åè®¡ç®ï¼å ä¸ºè¿æ ·åä¸ä¼æå¤±ç²¾åº¦ã\n\n0n < 1 // true\n0n < true // true\n0n == 0 // true\n0n == false // true\n0n === 0 // false\n\n\n1\n2\n3\n4\n5\n\n\nBigInt ä¸å­ç¬¦ä¸²æ··åè¿ç®æ¶ï¼ä¼åè½¬ä¸ºå­ç¬¦ä¸²ï¼åè¿è¡è¿ç®ã\n\n'' + 123n // \"123\"\n\n\n1\n",normalizedContent:"# æ°å¼çæ©å±\n\n\n# äºè¿å¶åå«è¿å¶è¡¨ç¤ºæ³\n\nes6 æä¾äºäºè¿å¶åå«è¿å¶æ°å¼çæ°çåæ³ï¼åå«ç¨åç¼0bï¼æ0bï¼å0oï¼æ0oï¼è¡¨ç¤ºã\n\n0b111110111 === 503 // true\n0o767 === 503 // true\n\n\n1\n2\n\n\nä» es5 å¼å§ï¼å¨ä¸¥æ ¼æ¨¡å¼ä¹ä¸­ï¼å«è¿å¶å°±ä¸ååè®¸ä½¿ç¨åç¼0è¡¨ç¤ºï¼es6 è¿ä¸æ­¥æç¡®ï¼è¦ä½¿ç¨åç¼0oè¡¨ç¤ºã\n\n// éä¸¥æ ¼æ¨¡å¼\n(function(){\n  console.log(0o11 === 011);\n})() // true\n\n// ä¸¥æ ¼æ¨¡å¼\n(function(){\n  'use strict';\n  console.log(0o11 === 011);\n})() // uncaught syntaxerror: octal literals are not allowed in strict mode.\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¦æè¦å°0bå0oåç¼çå­ç¬¦ä¸²æ°å¼è½¬ä¸ºåè¿å¶ï¼è¦ä½¿ç¨numberæ¹æ³ã\n\nnumber('0b111')  // 7\nnumber('0o10')  // 8\n\n\n1\n2\n\n\n\n# number.isfinite() æ¯å¦ä¸ºæé, number.isnan() æ¯å¦ä¸ºnan\n\nes6 å¨numberå¯¹è±¡ä¸ï¼æ°æä¾äºnumber.isfinite()ånumber.isnan()ä¸¤ä¸ªæ¹æ³ã\n\nnumber.isfinite()ç¨æ¥æ£æ¥ä¸ä¸ªæ°å¼æ¯å¦ä¸ºæéçï¼finiteï¼ï¼å³ä¸æ¯infinityã\n\nnumber.isfinite(15); // true\nnumber.isfinite(0.8); // true\nnumber.isfinite(nan); // false\nnumber.isfinite(infinity); // false\nnumber.isfinite(-infinity); // false\nnumber.isfinite('foo'); // false\nnumber.isfinite('15'); // false\nnumber.isfinite(true); // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næ³¨æï¼å¦æåæ°ç±»åä¸æ¯æ°å¼ï¼number.isfiniteä¸å¾è¿åfalseã\n\nnumber.isnan()ç¨æ¥æ£æ¥ä¸ä¸ªå¼æ¯å¦ä¸ºnanã\n\nnumber.isnan(nan) // true\nnumber.isnan(15) // false\nnumber.isnan('15') // false\nnumber.isnan(true) // false\nnumber.isnan(9/nan) // true\nnumber.isnan('true' / 0) // true\nnumber.isnan('true' / 'true') // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦æåæ°ç±»åä¸æ¯nanï¼number.isnanä¸å¾è¿åfalseã\n\nå®ä»¬ä¸ä¼ ç»çå¨å±æ¹æ³isfinite()åisnan()çåºå«å¨äºï¼ä¼ ç»æ¹æ³åè°ç¨number()å°éæ°å¼çå¼è½¬ä¸ºæ°å¼ï¼åè¿è¡å¤æ­ï¼èè¿ä¸¤ä¸ªæ°æ¹æ³åªå¯¹æ°å¼ææï¼number.isfinite()å¯¹äºéæ°å¼ä¸å¾è¿åfalse, number.isnan()åªæå¯¹äºnanæè¿åtrueï¼énanä¸å¾è¿åfalseã\n\nisfinite(25) // true\nisfinite(\"25\") // true\nnumber.isfinite(25) // true\nnumber.isfinite(\"25\") // false\n\nisnan(nan) // true\nisnan(\"nan\") // true\nnumber.isnan(nan) // true\nnumber.isnan(\"nan\") // false\nnumber.isnan(1) // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# number.parseint(), number.parsefloat()\n\nes6 å°å¨å±æ¹æ³parseint()åparsefloat()ï¼ç§»æ¤å°numberå¯¹è±¡ä¸é¢ï¼è¡ä¸ºå®å¨ä¿æä¸åã\n\n// es5çåæ³\nparseint('12.34') // 12\nparsefloat('123.45#') // 123.45\n\n// es6çåæ³\nnumber.parseint('12.34') // 12\nnumber.parsefloat('123.45#') // 123.45\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¿æ ·åçç®çï¼æ¯éæ­¥åå°å¨å±æ§æ¹æ³ï¼ä½¿å¾è¯­è¨éæ­¥æ¨¡ååã\n\nnumber.parseint === parseint // true\nnumber.parsefloat === parsefloat // true\n\n\n1\n2\n\n\n\n# number.isinteger() æ¯å¦ä¸ºæ´æ°\n\nnumber.isinteger()ç¨æ¥å¤æ­ä¸ä¸ªæ°å¼æ¯å¦ä¸ºæ´æ°ã\n\nnumber.isinteger(25) // true\nnumber.isinteger(25.1) // false\n\n\n1\n2\n\n\njavascript åé¨ï¼æ´æ°åæµ®ç¹æ°éç¨çæ¯åæ ·çå¨å­æ¹æ³ï¼æä»¥ 25 å 25.0 è¢«è§ä¸ºåä¸ä¸ªå¼ã\n\nnumber.isinteger(25) // true\nnumber.isinteger(25.0) // true\n\n\n1\n2\n\n\nå¦æåæ°ä¸æ¯æ°å¼ï¼number.isintegerè¿åfalseã\n\nnumber.isinteger() // false\nnumber.isinteger(null) // false\nnumber.isinteger('15') // false\nnumber.isinteger(true) // false\n\n\n1\n2\n3\n4\n\n\næ³¨æï¼ç±äº javascript éç¨ ieee 754 æ åï¼æ°å¼å­å¨ä¸º64ä½åç²¾åº¦æ ¼å¼ï¼æ°å¼ç²¾åº¦æå¤å¯ä»¥è¾¾å° 53 ä¸ªäºè¿å¶ä½ï¼1 ä¸ªéèä½ä¸ 52 ä¸ªææä½ï¼ãå¦ææ°å¼çç²¾åº¦è¶è¿è¿ä¸ªéåº¦ï¼ç¬¬54ä½ååé¢çä½å°±ä¼è¢«ä¸¢å¼ï¼è¿ç§æåµä¸ï¼number.isintegerå¯è½ä¼è¯¯å¤ã\n\nnumber.isinteger(3.0000000000000002) // true\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼number.isintegerçåæ°ææä¸æ¯æ´æ°ï¼ä½æ¯ä¼è¿åtrueãåå å°±æ¯è¿ä¸ªå°æ°çç²¾åº¦è¾¾å°äºå°æ°ç¹å16ä¸ªåè¿å¶ä½ï¼è½¬æäºè¿å¶ä½è¶è¿äº53ä¸ªäºè¿å¶ä½ï¼å¯¼è´æåçé£ä¸ª2è¢«ä¸¢å¼äºã\n\nç±»ä¼¼çæåµè¿æï¼å¦æä¸ä¸ªæ°å¼çç»å¯¹å¼å°äºnumber.min_valueï¼5e-324ï¼ï¼å³å°äº javascript è½å¤åè¾¨çæå°å¼ï¼ä¼è¢«èªå¨è½¬ä¸º 0ãè¿æ¶ï¼number.isintegerä¹ä¼è¯¯å¤ã\n\nnumber.isinteger(5e-324) // false\nnumber.isinteger(5e-325) // true\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼5e-325ç±äºå¼å¤ªå°ï¼ä¼è¢«èªå¨è½¬ä¸º0ï¼å æ­¤è¿åtrueã\n\næ»ä¹ï¼å¦æå¯¹æ°æ®ç²¾åº¦çè¦æ±è¾é«ï¼ä¸å»ºè®®ä½¿ç¨number.isinteger()å¤æ­ä¸ä¸ªæ°å¼æ¯å¦ä¸ºæ´æ°ã\n\n\n# number.epsilon ç¨äºæµ®ç¹æ°è¯¯å·®æ£æ¥\n\nes6 å¨numberå¯¹è±¡ä¸é¢ï¼æ°å¢ä¸ä¸ªæå°çå¸¸énumber.epsilonãæ ¹æ®è§æ ¼ï¼å®è¡¨ç¤º 1 ä¸å¤§äº 1 çæå°æµ®ç¹æ°ä¹é´çå·®ã\n\nå¯¹äº 64 ä½æµ®ç¹æ°æ¥è¯´ï¼å¤§äº 1 çæå°æµ®ç¹æ°ç¸å½äºäºè¿å¶ç1.00..001ï¼å°æ°ç¹åé¢æè¿ç»­ 51 ä¸ªé¶ãè¿ä¸ªå¼åå» 1 ä¹åï¼å°±ç­äº 2 ç -52 æ¬¡æ¹ã\n\nnumber.epsilon === math.pow(2, -52)\n// true\nnumber.epsilon\n// 2.220446049250313e-16\nnumber.epsilon.tofixed(20)\n// \"0.00000000000000022204\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nnumber.epsilonå®éä¸æ¯ javascript è½å¤è¡¨ç¤ºçæå°ç²¾åº¦ãè¯¯å·®å¦æå°äºè¿ä¸ªå¼ï¼å°±å¯ä»¥è®¤ä¸ºå·²ç»æ²¡ææä¹äºï¼å³ä¸å­å¨è¯¯å·®äºã\n\nå¼å¥ä¸ä¸ªè¿ä¹å°çéçç®çï¼å¨äºä¸ºæµ®ç¹æ°è®¡ç®ï¼è®¾ç½®ä¸ä¸ªè¯¯å·®èå´ãæä»¬ç¥éæµ®ç¹æ°è®¡ç®æ¯ä¸ç²¾ç¡®çã\n\n0.1 + 0.2\n// 0.30000000000000004\n\n0.1 + 0.2 - 0.3\n// 5.551115123125783e-17\n\n5.551115123125783e-17.tofixed(20)\n// '0.00000000000000005551'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç è§£éäºï¼ä¸ºä»ä¹æ¯è¾0.1 + 0.2ä¸0.3å¾å°çç»ææ¯falseã\n\n0.1 + 0.2 === 0.3 // false\n\n\n1\n\n\nnumber.epsilonå¯ä»¥ç¨æ¥è®¾ç½®âè½å¤æ¥åçè¯¯å·®èå´âãæ¯å¦ï¼è¯¯å·®èå´è®¾ä¸º 2 ç-50 æ¬¡æ¹ï¼å³number.epsilon * math.pow(2, 2)ï¼ï¼å³å¦æä¸¤ä¸ªæµ®ç¹æ°çå·®å°äºè¿ä¸ªå¼ï¼æä»¬å°±è®¤ä¸ºè¿ä¸¤ä¸ªæµ®ç¹æ°ç¸ç­ã\n\n5.551115123125783e-17 < number.epsilon * math.pow(2, 2)\n// true\n\n\n1\n2\n\n\nå æ­¤ï¼number.epsilonçå®è´¨æ¯ä¸ä¸ªå¯ä»¥æ¥åçæå°è¯¯å·®èå´ã\n\nfunction withinerrormargin (left, right) {\n  return math.abs(left - right) < number.epsilon * math.pow(2, 2);\n}\n\n0.1 + 0.2 === 0.3 // false\nwithinerrormargin(0.1 + 0.2, 0.3) // true\n\n1.1 + 1.3 === 2.4 // false\nwithinerrormargin(1.1 + 1.3, 2.4) // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢çä»£ç ä¸ºæµ®ç¹æ°è¿ç®ï¼é¨ç½²äºä¸ä¸ªè¯¯å·®æ£æ¥å½æ°ã\n\n\n# å®å¨æ´æ°å number.issafeinteger()\n\njavascript è½å¤åç¡®è¡¨ç¤ºçæ´æ°èå´å¨-2^53å°2^53ä¹é´ï¼ä¸å«ä¸¤ä¸ªç«¯ç¹ï¼ï¼è¶è¿è¿ä¸ªèå´ï¼æ æ³ç²¾ç¡®è¡¨ç¤ºè¿ä¸ªå¼ã\n\nmath.pow(2, 53) // 9007199254740992\n\n9007199254740992  // 9007199254740992\n9007199254740993  // 9007199254740992\n\nmath.pow(2, 53) === math.pow(2, 53) + 1\n// true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼è¶åº 2 ç 53 æ¬¡æ¹ä¹åï¼ä¸ä¸ªæ°å°±ä¸ç²¾ç¡®äºã\n\nes6 å¼å¥äºnumber.max_safe_integerånumber.min_safe_integerè¿ä¸¤ä¸ªå¸¸éï¼ç¨æ¥è¡¨ç¤ºè¿ä¸ªèå´çä¸ä¸éã\n\nnumber.max_safe_integer === math.pow(2, 53) - 1\n// true\nnumber.max_safe_integer === 9007199254740991\n// true\n\nnumber.min_safe_integer === -number.max_safe_integer\n// true\nnumber.min_safe_integer === -9007199254740991\n// true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯ä»¥çå° javascript è½å¤ç²¾ç¡®è¡¨ç¤ºçæéã\n\nnumber.issafeinteger()åæ¯ç¨æ¥å¤æ­ä¸ä¸ªæ´æ°æ¯å¦è½å¨è¿ä¸ªèå´ä¹åã\n\nnumber.issafeinteger('a') // false\nnumber.issafeinteger(null) // false\nnumber.issafeinteger(nan) // false\nnumber.issafeinteger(infinity) // false\nnumber.issafeinteger(-infinity) // false\n\nnumber.issafeinteger(3) // true\nnumber.issafeinteger(1.2) // false\nnumber.issafeinteger(9007199254740990) // true\nnumber.issafeinteger(9007199254740992) // false\n\nnumber.issafeinteger(number.min_safe_integer - 1) // false\nnumber.issafeinteger(number.min_safe_integer) // true\nnumber.issafeinteger(number.max_safe_integer) // true\nnumber.issafeinteger(number.max_safe_integer + 1) // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nè¿ä¸ªå½æ°çå®ç°å¾ç®åï¼å°±æ¯è·å®å¨æ´æ°çä¸¤ä¸ªè¾¹çå¼æ¯è¾ä¸ä¸ã\n\nnumber.issafeinteger = function (n) {\n  return (typeof n === 'number' &&\n    math.round(n) === n &&\n    number.min_safe_integer <= n &&\n    n <= number.max_safe_integer);\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nå®éä½¿ç¨è¿ä¸ªå½æ°æ¶ï¼éè¦æ³¨æãéªè¯è¿ç®ç»ææ¯å¦è½å¨å®å¨æ´æ°çèå´åï¼ä¸è¦åªéªè¯è¿ç®ç»æï¼èè¦åæ¶éªè¯åä¸è¿ç®çæ¯ä¸ªå¼ã\n\nnumber.issafeinteger(9007199254740993)\n// false\nnumber.issafeinteger(990)\n// true\nnumber.issafeinteger(9007199254740993 - 990)\n// true\n9007199254740993 - 990\n// è¿åç»æ 9007199254740002\n// æ­£ç¡®ç­æ¡åºè¯¥æ¯ 9007199254740003\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼9007199254740993ä¸æ¯ä¸ä¸ªå®å¨æ´æ°ï¼ä½æ¯number.issafeintegerä¼è¿åç»æï¼æ¾ç¤ºè®¡ç®ç»ææ¯å®å¨çãè¿æ¯å ä¸ºï¼è¿ä¸ªæ°è¶åºäºç²¾åº¦èå´ï¼å¯¼è´å¨è®¡ç®æºåé¨ï¼ä»¥9007199254740992çå½¢å¼å¨å­ã\n\n9007199254740993 === 9007199254740992\n// true\n\n\n1\n2\n\n\næä»¥ï¼å¦æåªéªè¯è¿ç®ç»ææ¯å¦ä¸ºå®å¨æ´æ°ï¼å¾å¯è½å¾å°éè¯¯ç»æãä¸é¢çå½æ°å¯ä»¥åæ¶éªè¯ä¸¤ä¸ªè¿ç®æ°åè¿ç®ç»æã\n\nfunction trusty (left, right, result) {\n  if (\n    number.issafeinteger(left) &&\n    number.issafeinteger(right) &&\n    number.issafeinteger(result)\n  ) {\n    return result;\n  }\n  throw new rangeerror('operation cannot be trusted!');\n}\n\ntrusty(9007199254740993, 990, 9007199254740993 - 990)\n// rangeerror: operation cannot be trusted!\n\ntrusty(1, 2, 3)\n// 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n# math å¯¹è±¡çæ©å±\n\nes6 å¨ math å¯¹è±¡ä¸æ°å¢äº 17 ä¸ªä¸æ°å­¦ç¸å³çæ¹æ³ãææè¿äºæ¹æ³é½æ¯éææ¹æ³ï¼åªè½å¨ math å¯¹è±¡ä¸è°ç¨ã\n\n\n# math.trunc() å»é¤ä¸ä¸ªæ°çå°æ°é¨åï¼è¿åæ´æ°é¨å\n\nmath.truncæ¹æ³ç¨äºå»é¤ä¸ä¸ªæ°çå°æ°é¨åï¼è¿åæ´æ°é¨åã\n\nmath.trunc(4.1) // 4\nmath.trunc(4.9) // 4\nmath.trunc(-4.1) // -4\nmath.trunc(-4.9) // -4\nmath.trunc(-0.1234) // -0\n\n\n1\n2\n3\n4\n5\n\n\nå¯¹äºéæ°å¼ï¼math.truncåé¨ä½¿ç¨numberæ¹æ³å°å¶åè½¬ä¸ºæ°å¼ã\n\nmath.trunc('123.456') // 123\nmath.trunc(true) //1\nmath.trunc(false) // 0\nmath.trunc(null) // 0\n\n\n1\n2\n3\n4\n\n\nå¯¹äºç©ºå¼åæ æ³æªåæ´æ°çå¼ï¼è¿ånanã\n\nmath.trunc(nan);      // nan\nmath.trunc('foo');    // nan\nmath.trunc();         // nan\nmath.trunc(undefined) // nan\n\n\n1\n2\n3\n4\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nmath.trunc = math.trunc || function(x) {\n  return x < 0 ? math.ceil(x) : math.floor(x);\n};\n\n\n1\n2\n3\n\n\n\n# math.sign() å¤æ­ä¸ä¸ªæ°æ¯æ­£æ°ãè´æ°ãè¿æ¯é¶\n\nmath.signæ¹æ³ç¨æ¥å¤æ­ä¸ä¸ªæ°å°åºæ¯æ­£æ°ãè´æ°ãè¿æ¯é¶ãå¯¹äºéæ°å¼ï¼ä¼åå°å¶è½¬æ¢ä¸ºæ°å¼ã\n\nå®ä¼è¿åäºç§å¼ã\n\n * åæ°ä¸ºæ­£æ°ï¼è¿å+1ï¼\n * åæ°ä¸ºè´æ°ï¼è¿å-1ï¼\n * åæ°ä¸º 0ï¼è¿å0ï¼\n * åæ°ä¸º-0ï¼è¿å-0;\n * å¶ä»å¼ï¼è¿ånanã\n\nmath.sign(-5) // -1\nmath.sign(5) // +1\nmath.sign(0) // +0\nmath.sign(-0) // -0\nmath.sign(nan) // nan\n\n\n1\n2\n3\n4\n5\n\n\nå¦æåæ°æ¯éæ°å¼ï¼ä¼èªå¨è½¬ä¸ºæ°å¼ãå¯¹äºé£äºæ æ³è½¬ä¸ºæ°å¼çå¼ï¼ä¼è¿ånanã\n\nmath.sign('')  // 0\nmath.sign(true)  // +1\nmath.sign(false)  // 0\nmath.sign(null)  // 0\nmath.sign('9')  // +1\nmath.sign('foo')  // nan\nmath.sign()  // nan\nmath.sign(undefined)  // nan\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nmath.sign = math.sign || function(x) {\n  x = +x; // convert to a number\n  if (x === 0 || isnan(x)) {\n    return x;\n  }\n  return x > 0 ? 1 : -1;\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# math.cbrt() è®¡ç®ä¸ä¸ªæ°çç«æ¹æ ¹\n\nmath.cbrtæ¹æ³ç¨äºè®¡ç®ä¸ä¸ªæ°çç«æ¹æ ¹ã\n\nmath.cbrt(-1) // -1\nmath.cbrt(0)  // 0\nmath.cbrt(1)  // 1\nmath.cbrt(2)  // 1.2599210498948734\n\n\n1\n2\n3\n4\n\n\nå¯¹äºéæ°å¼ï¼math.cbrtæ¹æ³åé¨ä¹æ¯åä½¿ç¨numberæ¹æ³å°å¶è½¬ä¸ºæ°å¼ã\n\nmath.cbrt('8') // 2\nmath.cbrt('hello') // nan\n\n\n1\n2\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nmath.cbrt = math.cbrt || function(x) {\n  var y = math.pow(math.abs(x), 1/3);\n  return x < 0 ? -y : y;\n};\n\n\n1\n2\n3\n4\n\n\n\n# math.clz32()\n\nmath.clz32()æ¹æ³å°åæ°è½¬ä¸º 32 ä½æ ç¬¦å·æ´æ°çå½¢å¼ï¼ç¶åè¿åè¿ä¸ª 32 ä½å¼éé¢æå¤å°ä¸ªåå¯¼ 0ã\n\nmath.clz32(0) // 32\nmath.clz32(1) // 31\nmath.clz32(1000) // 22\nmath.clz32(0b01000000000000000000000000000000) // 1\nmath.clz32(0b00100000000000000000000000000000) // 2\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼0 çäºè¿å¶å½¢å¼å¨ä¸º 0ï¼æä»¥æ 32 ä¸ªåå¯¼ 0ï¼1 çäºè¿å¶å½¢å¼æ¯0b1ï¼åªå  1 ä½ï¼æä»¥ 32 ä½ä¹ä¸­æ 31 ä¸ªåå¯¼ 0ï¼1000 çäºè¿å¶å½¢å¼æ¯0b1111101000ï¼ä¸å±æ 10 ä½ï¼æä»¥ 32 ä½ä¹ä¸­æ 22 ä¸ªåå¯¼ 0ã\n\nclz32è¿ä¸ªå½æ°åå°±æ¥èªâcount leading zero bits in 32-bit binary representation of a numberâï¼è®¡ç®ä¸ä¸ªæ°ç 32 ä½äºè¿å¶å½¢å¼çåå¯¼ 0 çä¸ªæ°ï¼çç¼©åã\n\nå·¦ç§»è¿ç®ç¬¦ï¼<<ï¼ä¸math.clz32æ¹æ³ç´æ¥ç¸å³ã\n\nmath.clz32(0) // 32\nmath.clz32(1) // 31\nmath.clz32(1 << 1) // 30\nmath.clz32(1 << 2) // 29\nmath.clz32(1 << 29) // 2\n\n\n1\n2\n3\n4\n5\n\n\nå¯¹äºå°æ°ï¼math.clz32æ¹æ³åªèèæ´æ°é¨åã\n\nmath.clz32(3.2) // 30\nmath.clz32(3.9) // 30\n\n\n1\n2\n\n\nå¯¹äºç©ºå¼æå¶ä»ç±»åçå¼ï¼math.clz32æ¹æ³ä¼å°å®ä»¬åè½¬ä¸ºæ°å¼ï¼ç¶ååè®¡ç®ã\n\nmath.clz32() // 32\nmath.clz32(nan) // 32\nmath.clz32(infinity) // 32\nmath.clz32(null) // 32\nmath.clz32('foo') // 32\nmath.clz32([]) // 32\nmath.clz32({}) // 32\nmath.clz32(true) // 31\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# math.imul()\n\nmath.imulæ¹æ³è¿åä¸¤ä¸ªæ°ä»¥ 32 ä½å¸¦ç¬¦å·æ´æ°å½¢å¼ç¸ä¹çç»æï¼è¿åçä¹æ¯ä¸ä¸ª 32 ä½çå¸¦ç¬¦å·æ´æ°ã\n\nmath.imul(2, 4)   // 8\nmath.imul(-1, 8)  // -8\nmath.imul(-2, -2) // 4\n\n\n1\n2\n3\n\n\nå¦æåªèèæå 32 ä½ï¼å¤§å¤æ°æåµä¸ï¼math.imul(a, b)ä¸a * bçç»ææ¯ç¸åçï¼å³è¯¥æ¹æ³ç­åäº(a * b)|0çææï¼è¶è¿ 32 ä½çé¨åæº¢åºï¼ãä¹æä»¥éè¦é¨ç½²è¿ä¸ªæ¹æ³ï¼æ¯å ä¸º javascript æç²¾åº¦éå¶ï¼è¶è¿ 2 ç 53 æ¬¡æ¹çå¼æ æ³ç²¾ç¡®è¡¨ç¤ºãè¿å°±æ¯è¯´ï¼å¯¹äºé£äºå¾å¤§çæ°çä¹æ³ï¼ä½ä½æ°å¼å¾å¾é½æ¯ä¸ç²¾ç¡®çï¼math.imulæ¹æ³å¯ä»¥è¿åæ­£ç¡®çä½ä½æ°å¼ã\n\n(0x7fffffff * 0x7fffffff)|0 // 0\n\n\n1\n\n\nä¸é¢è¿ä¸ªä¹æ³ç®å¼ï¼è¿åç»æä¸º 0ãä½æ¯ç±äºè¿ä¸¤ä¸ªäºè¿å¶æ°çæä½ä½é½æ¯ 1ï¼æä»¥è¿ä¸ªç»æè¯å®æ¯ä¸æ­£ç¡®çï¼å ä¸ºæ ¹æ®äºè¿å¶ä¹æ³ï¼è®¡ç®ç»æçäºè¿å¶æä½ä½åºè¯¥ä¹æ¯ 1ãè¿ä¸ªéè¯¯å°±æ¯å ä¸ºå®ä»¬çä¹ç§¯è¶è¿äº 2 ç 53 æ¬¡æ¹ï¼javascript æ æ³ä¿å­é¢å¤çç²¾åº¦ï¼å°±æä½ä½çå¼é½åæäº 0ãmath.imulæ¹æ³å¯ä»¥è¿åæ­£ç¡®çå¼ 1ã\n\nmath.imul(0x7fffffff, 0x7fffffff) // 1\n\n\n1\n\n\n\n# math.fround()\n\nmath.froundæ¹æ³è¿åä¸ä¸ªæ°ç32ä½åç²¾åº¦æµ®ç¹æ°å½¢å¼ã\n\nå¯¹äº32ä½åç²¾åº¦æ ¼å¼æ¥è¯´ï¼æ°å¼ç²¾åº¦æ¯24ä¸ªäºè¿å¶ä½ï¼1 ä½éèä½ä¸ 23 ä½ææä½ï¼ï¼æä»¥å¯¹äº -224 è³ 224 ä¹é´çæ´æ°ï¼ä¸å«ä¸¤ä¸ªç«¯ç¹ï¼ï¼è¿åç»æä¸åæ°æ¬èº«ä¸è´ã\n\nmath.fround(0)   // 0\nmath.fround(1)   // 1\nmath.fround(2 ** 24 - 1)   // 16777215\n\n\n1\n2\n3\n\n\nå¦æåæ°çç»å¯¹å¼å¤§äº 224ï¼è¿åçç»æä¾¿å¼å§ä¸¢å¤±ç²¾åº¦ã\n\nmath.fround(2 ** 24)       // 16777216\nmath.fround(2 ** 24 + 1)   // 16777216\n\n\n1\n2\n\n\nmath.froundæ¹æ³çä¸»è¦ä½ç¨ï¼æ¯å°64ä½åç²¾åº¦æµ®ç¹æ°è½¬ä¸º32ä½åç²¾åº¦æµ®ç¹æ°ãå¦æå°æ°çç²¾åº¦è¶è¿24ä¸ªäºè¿å¶ä½ï¼è¿åå¼å°±ä¼ä¸åäºåå¼ï¼å¦åè¿åå¼ä¸åï¼å³ä¸64ä½åç²¾åº¦å¼ä¸è´ï¼ã\n\n// æªä¸¢å¤±ææç²¾åº¦\nmath.fround(1.125) // 1.125\nmath.fround(7.25)  // 7.25\n\n// ä¸¢å¤±ç²¾åº¦\nmath.fround(0.3)   // 0.30000001192092896\nmath.fround(0.7)   // 0.699999988079071\nmath.fround(1.0000000123) // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¯¹äº nan å infinityï¼æ­¤æ¹æ³è¿ååå¼ãå¯¹äºå¶å®ç±»åçéæ°å¼ï¼math.fround æ¹æ³ä¼åå°å¶è½¬ä¸ºæ°å¼ï¼åè¿ååç²¾åº¦æµ®ç¹æ°ã\n\nmath.fround(nan)      // nan\nmath.fround(infinity) // infinity\n\nmath.fround('5')      // 5\nmath.fround(true)     // 1\nmath.fround(null)     // 0\nmath.fround([])       // 0\nmath.fround({})       // nan\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nmath.fround = math.fround || function (x) {\n  return new float32array([x])[0];\n};\n\n\n1\n2\n3\n\n\n\n# math.hypot()\n\nmath.hypotæ¹æ³è¿åææåæ°çå¹³æ¹åçå¹³æ¹æ ¹ã\n\nmath.hypot(3, 4);        // 5\nmath.hypot(3, 4, 5);     // 7.0710678118654755\nmath.hypot();            // 0\nmath.hypot(nan);         // nan\nmath.hypot(3, 4, 'foo'); // nan\nmath.hypot(3, 4, '5');   // 7.0710678118654755\nmath.hypot(-3);          // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼3 çå¹³æ¹å ä¸ 4 çå¹³æ¹ï¼ç­äº 5 çå¹³æ¹ã\n\nå¦æåæ°ä¸æ¯æ°å¼ï¼math.hypotæ¹æ³ä¼å°å¶è½¬ä¸ºæ°å¼ãåªè¦æä¸ä¸ªåæ°æ æ³è½¬ä¸ºæ°å¼ï¼å°±ä¼è¿å nanã\n\n\n# å¯¹æ°æ¹æ³\n\nes6 æ°å¢äº 4 ä¸ªå¯¹æ°ç¸å³æ¹æ³ã\n\nï¼1ï¼ math.expm1()\n\nmath.expm1(x)è¿å ex - 1ï¼å³math.exp(x) - 1ã\n\nmath.expm1(-1) // -0.6321205588285577\nmath.expm1(0)  // 0\nmath.expm1(1)  // 1.718281828459045\n\n\n1\n2\n3\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nmath.expm1 = math.expm1 || function(x) {\n  return math.exp(x) - 1;\n};\n\n\n1\n2\n3\n\n\nï¼2ï¼math.log1p()\n\nmath.log1p(x)æ¹æ³è¿å1 + xçèªç¶å¯¹æ°ï¼å³math.log(1 + x)ãå¦æxå°äº-1ï¼è¿ånanã\n\nmath.log1p(1)  // 0.6931471805599453\nmath.log1p(0)  // 0\nmath.log1p(-1) // -infinity\nmath.log1p(-2) // nan\n\n\n1\n2\n3\n4\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nmath.log1p = math.log1p || function(x) {\n  return math.log(1 + x);\n};\n\n\n1\n2\n3\n\n\nï¼3ï¼math.log10()\n\nmath.log10(x)è¿åä»¥ 10 ä¸ºåºçxçå¯¹æ°ãå¦æxå°äº 0ï¼åè¿å nanã\n\nmath.log10(2)      // 0.3010299956639812\nmath.log10(1)      // 0\nmath.log10(0)      // -infinity\nmath.log10(-2)     // nan\nmath.log10(100000) // 5\n\n\n1\n2\n3\n4\n5\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nmath.log10 = math.log10 || function(x) {\n  return math.log(x) / math.ln10;\n};\n\n\n1\n2\n3\n\n\nï¼4ï¼math.log2()\n\nmath.log2(x)è¿åä»¥ 2 ä¸ºåºçxçå¯¹æ°ãå¦æxå°äº 0ï¼åè¿å nanã\n\nmath.log2(3)       // 1.584962500721156\nmath.log2(2)       // 1\nmath.log2(1)       // 0\nmath.log2(0)       // -infinity\nmath.log2(-2)      // nan\nmath.log2(1024)    // 10\nmath.log2(1 << 29) // 29\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¯¹äºæ²¡æé¨ç½²è¿ä¸ªæ¹æ³çç¯å¢ï¼å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æã\n\nmath.log2 = math.log2 || function(x) {\n  return math.log(x) / math.ln2;\n};\n\n\n1\n2\n3\n\n\n\n# åæ²å½æ°æ¹æ³\n\nes6 æ°å¢äº 6 ä¸ªåæ²å½æ°æ¹æ³ã\n\n * math.sinh(x) è¿åxçåæ²æ­£å¼¦ï¼hyperbolic sineï¼\n * math.cosh(x) è¿åxçåæ²ä½å¼¦ï¼hyperbolic cosineï¼\n * math.tanh(x) è¿åxçåæ²æ­£åï¼hyperbolic tangentï¼\n * math.asinh(x) è¿åxçååæ²æ­£å¼¦ï¼inverse hyperbolic sineï¼\n * math.acosh(x) è¿åxçååæ²ä½å¼¦ï¼inverse hyperbolic cosineï¼\n * math.atanh(x) è¿åxçååæ²æ­£åï¼inverse hyperbolic tangentï¼\n\n\n# ææ°è¿ç®ç¬¦\n\nes2016 æ°å¢äºä¸ä¸ªææ°è¿ç®ç¬¦ï¼**ï¼ã\n\n2 ** 2 // 4\n2 ** 3 // 8\n\n\n1\n2\n\n\nè¿ä¸ªè¿ç®ç¬¦çä¸ä¸ªç¹ç¹æ¯å³ç»åï¼èä¸æ¯å¸¸è§çå·¦ç»åãå¤ä¸ªææ°è¿ç®ç¬¦è¿ç¨æ¶ï¼æ¯ä»æå³è¾¹å¼å§è®¡ç®çã\n\n// ç¸å½äº 2 ** (3 ** 2)\n2 ** 3 ** 2\n// 512\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼é¦åè®¡ç®çæ¯ç¬¬äºä¸ªææ°è¿ç®ç¬¦ï¼èä¸æ¯ç¬¬ä¸ä¸ªã\n\nææ°è¿ç®ç¬¦å¯ä»¥ä¸ç­å·ç»åï¼å½¢æä¸ä¸ªæ°çèµå¼è¿ç®ç¬¦ï¼**=ï¼ã\n\nlet a = 1.5;\na **= 2;\n// ç­åäº a = a * a;\n\nlet b = 4;\nb **= 3;\n// ç­åäº b = b * b * b;\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næ³¨æï¼v8 å¼æçææ°è¿ç®ç¬¦ä¸math.powçå®ç°ä¸ç¸åï¼å¯¹äºç¹å«å¤§çè¿ç®ç»æï¼ä¸¤èä¼æç»å¾®çå·®å¼ã\n\nmath.pow(99, 99)\n// 3.697296376497263e+197\n\n99 ** 99\n// 3.697296376497268e+197\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸¤ä¸ªè¿ç®ç»æçæåä¸ä½æææ°å­æ¯æå·®å¼çã\n\n\n# bigint æ°æ®ç±»å\n\n\n# ç®ä»\n\njavascript æææ°å­é½ä¿å­æ 64 ä½æµ®ç¹æ°ï¼è¿ç»æ°å¼çè¡¨ç¤ºå¸¦æ¥äºä¸¤å¤§éå¶ãä¸æ¯æ°å¼çç²¾åº¦åªè½å° 53 ä¸ªäºè¿å¶ä½ï¼ç¸å½äº 16 ä¸ªåè¿å¶ä½ï¼ï¼å¤§äºè¿ä¸ªèå´çæ´æ°ï¼javascript æ¯æ æ³ç²¾ç¡®è¡¨ç¤ºçï¼è¿ä½¿å¾ javascript ä¸éåè¿è¡ç§å­¦åéèæ¹é¢çç²¾ç¡®è®¡ç®ãäºæ¯å¤§äºæç­äº2ç1024æ¬¡æ¹çæ°å¼ï¼javascript æ æ³è¡¨ç¤ºï¼ä¼è¿åinfinityã\n\n// è¶è¿ 53 ä¸ªäºè¿å¶ä½çæ°å¼ï¼æ æ³ä¿æç²¾åº¦\nmath.pow(2, 53) === math.pow(2, 53) + 1 // true\n\n// è¶è¿ 2 ç 1024 æ¬¡æ¹çæ°å¼ï¼æ æ³è¡¨ç¤º\nmath.pow(2, 1024) // infinity\n\n\n1\n2\n3\n4\n5\n\n\nes2020 å¼å¥äºä¸ç§æ°çæ°æ®ç±»å bigintï¼å¤§æ´æ°ï¼ï¼æ¥è§£å³è¿ä¸ªé®é¢ãbigint åªç¨æ¥è¡¨ç¤ºæ´æ°ï¼æ²¡æä½æ°çéå¶ï¼ä»»ä½ä½æ°çæ´æ°é½å¯ä»¥ç²¾ç¡®è¡¨ç¤ºã\n\nconst a = 2172141653n;\nconst b = 15346349309n;\n\n// bigint å¯ä»¥ä¿æç²¾åº¦\na * b // 33334444555566667777n\n\n// æ®éæ´æ°æ æ³ä¿æç²¾åº¦\nnumber(a) * number(b) // 33334444555566670000\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸ºäºä¸ number ç±»ååºå«ï¼bigint ç±»åçæ°æ®å¿é¡»æ·»å åç¼nã\n\n1234 // æ®éæ´æ°\n1234n // bigint\n\n// bigint çè¿ç®\n1n + 2n // 3n\n\n\n1\n2\n3\n4\n5\n\n\nbigint åæ ·å¯ä»¥ä½¿ç¨åç§è¿å¶è¡¨ç¤ºï¼é½è¦å ä¸åç¼nã\n\n0b1101n // äºè¿å¶\n0o777n // å«è¿å¶\n0xffn // åå­è¿å¶\n\n\n1\n2\n3\n\n\nbigint ä¸æ®éæ´æ°æ¯ä¸¤ç§å¼ï¼å®ä»¬ä¹é´å¹¶ä¸ç¸ç­ã\n\n42n === 42 // false\n\n\n1\n\n\ntypeofè¿ç®ç¬¦å¯¹äº bigint ç±»åçæ°æ®è¿åbigintã\n\ntypeof 123n // 'bigint'\n\n\n1\n\n\nbigint å¯ä»¥ä½¿ç¨è´å·ï¼-ï¼ï¼ä½æ¯ä¸è½ä½¿ç¨æ­£å·ï¼+ï¼ï¼å ä¸ºä¼ä¸ asm.js å²çªã\n\n-42n // æ­£ç¡®\n+42n // æ¥é\n\n\n1\n2\n\n\njavascript ä»¥åä¸è½è®¡ç®70çé¶ä¹ï¼å³70!ï¼ï¼å ä¸ºè¶åºäºå¯ä»¥è¡¨ç¤ºçç²¾åº¦ã\n\nlet p = 1;\nfor (let i = 1; i <= 70; i++) {\n  p *= i;\n}\nconsole.log(p); // 1.197857166996989e+100\n\n\n1\n2\n3\n4\n5\n\n\nç°å¨æ¯æå¤§æ´æ°äºï¼å°±å¯ä»¥ç®äºï¼æµè§å¨çå¼åèå·¥å·è¿è¡ä¸é¢ä»£ç ï¼å°±okã\n\nlet p = 1n;\nfor (let i = 1n; i <= 70n; i++) {\n  p *= i;\n}\nconsole.log(p); // 11978571...00000000n\n\n\n1\n2\n3\n4\n5\n\n\n\n# bigint å¯¹è±¡\n\njavascript åçæä¾bigintå¯¹è±¡ï¼å¯ä»¥ç¨ä½æé å½æ°çæ bigint ç±»åçæ°å¼ãè½¬æ¢è§ååºæ¬ä¸number()ä¸è´ï¼å°å¶ä»ç±»åçå¼è½¬ä¸º bigintã\n\nbigint(123) // 123n\nbigint('123') // 123n\nbigint(false) // 0n\nbigint(true) // 1n\n\n\n1\n2\n3\n4\n\n\nbigint()æé å½æ°å¿é¡»æåæ°ï¼èä¸åæ°å¿é¡»å¯ä»¥æ­£å¸¸è½¬ä¸ºæ°å¼ï¼ä¸é¢çç¨æ³é½ä¼æ¥éã\n\nnew bigint() // typeerror\nbigint(undefined) //typeerror\nbigint(null) // typeerror\nbigint('123n') // syntaxerror\nbigint('abc') // syntaxerror\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å°¤å¶å¼å¾æ³¨æå­ç¬¦ä¸²123næ æ³è§£ææ number ç±»åï¼æä»¥ä¼æ¥éã\n\nåæ°å¦ææ¯å°æ°ï¼ä¹ä¼æ¥éã\n\nbigint(1.5) // rangeerror\nbigint('1.5') // syntaxerror\n\n\n1\n2\n\n\nbigint å¯¹è±¡ç»§æ¿äº object å¯¹è±¡çä¸¤ä¸ªå®ä¾æ¹æ³ã\n\n * bigint.prototype.tostring()\n * bigint.prototype.valueof()\n\nå®è¿ç»§æ¿äº number å¯¹è±¡çä¸ä¸ªå®ä¾æ¹æ³ã\n\n * bigint.prototype.tolocalestring()\n\næ­¤å¤ï¼è¿æä¾äºä¸ä¸ªéææ¹æ³ã\n\n * bigint.asuintn(width, bigint)ï¼ ç»å®ç bigint è½¬ä¸º 0 å° 2width - 1 ä¹é´å¯¹åºçå¼ã\n * bigint.asintn(width, bigint)ï¼ç»å®ç bigint è½¬ä¸º -2width - 1 å° 2width - 1 - 1 ä¹é´å¯¹åºçå¼ã\n * bigint.parseint(string[, radix])ï¼è¿ä¼¼äºnumber.parseint()ï¼å°ä¸ä¸ªå­ç¬¦ä¸²è½¬æ¢ææå®è¿å¶ç bigintã\n\nconst max = 2n ** (64n - 1n) - 1n;\n\nbigint.asintn(64, max)\n// 9223372036854775807n\nbigint.asintn(64, max + 1n)\n// -9223372036854775808n\nbigint.asuintn(64, max + 1n)\n// 9223372036854775808n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼maxæ¯64ä½å¸¦ç¬¦å·ç bigint æè½è¡¨ç¤ºçæå¤§å¼ãå¦æå¯¹è¿ä¸ªå¼å 1nï¼bigint.asintn()å°ä¼è¿åä¸ä¸ªè´å¼ï¼å ä¸ºè¿æ¶æ°å¢çä¸ä½å°è¢«è§£éä¸ºç¬¦å·ä½ãèbigint.asuintn()æ¹æ³ç±äºä¸å­å¨ç¬¦å·ä½ï¼æä»¥å¯ä»¥æ­£ç¡®è¿åç»æã\n\nå¦æbigint.asintn()åbigint.asuintn()æå®çä½æ°ï¼å°äºæ°å¼æ¬èº«çä½æ°ï¼é£ä¹å¤´é¨çä½å°è¢«èå¼ã\n\nconst max = 2n ** (64n - 1n) - 1n;\n\nbigint.asintn(32, max) // -1n\nbigint.asuintn(32, max) // 4294967295n\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼maxæ¯ä¸ä¸ª64ä½ç bigintï¼å¦æè½¬ä¸º32ä½ï¼åé¢ç32ä½é½ä¼è¢«èå¼ã\n\nä¸é¢æ¯bigint.parseint()çä¾å­ã\n\n// number.parseint() ä¸ bigint.parseint() çå¯¹æ¯\nnumber.parseint('9007199254740993', 10)\n// 9007199254740992\nbigint.parseint('9007199254740993', 10)\n// 9007199254740993n\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºæææ°å­è¶åºäºæå¤§éåº¦ï¼number.parseintæ¹æ³è¿åçç»ææ¯ä¸ç²¾ç¡®çï¼èbigint.parseintæ¹æ³æ­£ç¡®è¿åäºå¯¹åºç bigintã\n\nå¯¹äºäºè¿å¶æ°ç»ï¼bigint æ°å¢äºä¸¤ä¸ªç±»åbiguint64arrayåbigint64arrayï¼è¿ä¸¤ç§æ°æ®ç±»åè¿åçé½æ¯64ä½ bigintãdataviewå¯¹è±¡çå®ä¾æ¹æ³dataview.prototype.getbigint64()ådataview.prototype.getbiguint64()ï¼è¿åçä¹æ¯ bigintã\n\n\n# è½¬æ¢è§å\n\nå¯ä»¥ä½¿ç¨boolean()ãnumber()åstring()è¿ä¸ä¸ªæ¹æ³ï¼å° bigint å¯ä»¥è½¬ä¸ºå¸å°å¼ãæ°å¼åå­ç¬¦ä¸²ç±»åã\n\nboolean(0n) // false\nboolean(1n) // true\nnumber(1n)  // 1\nstring(1n)  // \"1\"\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼æ³¨ææåä¸ä¸ªä¾å­ï¼è½¬ä¸ºå­ç¬¦ä¸²æ¶åç¼nä¼æ¶å¤±ã\n\nå¦å¤ï¼ååè¿ç®ç¬¦ï¼!ï¼ä¹å¯ä»¥å° bigint è½¬ä¸ºå¸å°å¼ã\n\n!0n // true\n!1n // false\n\n\n1\n2\n\n\n\n# æ°å­¦è¿ç®\n\næ°å­¦è¿ç®æ¹é¢ï¼bigint ç±»åç+ã-ã*å**è¿åä¸ªäºåè¿ç®ç¬¦ï¼ä¸ number ç±»åçè¡ä¸ºä¸è´ãé¤æ³è¿ç®/ä¼èå»å°æ°é¨åï¼è¿åä¸ä¸ªæ´æ°ã\n\n9n / 5n\n// 1n\n\n\n1\n2\n\n\nå ä¹ææçæ°å¼è¿ç®ç¬¦é½å¯ä»¥ç¨å¨ bigintï¼ä½æ¯æä¸¤ä¸ªä¾å¤ã\n\n * ä¸å¸¦ç¬¦å·çå³ç§»ä½è¿ç®ç¬¦>>>\n * ä¸åçæ±æ­£è¿ç®ç¬¦+\n\nä¸é¢ä¸¤ä¸ªè¿ç®ç¬¦ç¨å¨ bigint ä¼æ¥éãåèæ¯å ä¸º>>>è¿ç®ç¬¦æ¯ä¸å¸¦ç¬¦å·çï¼ä½æ¯ bigint æ»æ¯å¸¦æç¬¦å·çï¼å¯¼è´è¯¥è¿ç®æ æä¹ï¼å®å¨ç­åäºå³ç§»è¿ç®ç¬¦>>ãåèæ¯å ä¸ºä¸åè¿ç®ç¬¦+å¨ asm.js éé¢æ»æ¯è¿å number ç±»åï¼ä¸ºäºä¸ç ´å asm.js å°±è§å®+1nä¼æ¥éã\n\nbigint ä¸è½ä¸æ®éæ°å¼è¿è¡æ··åè¿ç®ã\n\n1n + 1.3 // æ¥é\n\n\n1\n\n\nä¸é¢ä»£ç æ¥éæ¯å ä¸ºæ è®ºè¿åçæ¯ bigint æ numberï¼é½ä¼å¯¼è´ä¸¢å¤±ç²¾åº¦ä¿¡æ¯ãæ¯å¦(2n**53n + 1n) + 0.5è¿ä¸ªè¡¨è¾¾å¼ï¼å¦æè¿å bigint ç±»åï¼0.5è¿ä¸ªå°æ°é¨åä¼ä¸¢å¤±ï¼å¦æè¿å number ç±»åï¼ææç²¾åº¦åªè½ä¿æ 53 ä½ï¼å¯¼è´ç²¾åº¦ä¸éã\n\nåæ ·çåå ï¼å¦æä¸ä¸ªæ ååºå½æ°çåæ°é¢ææ¯ number ç±»åï¼ä½æ¯å¾å°çæ¯ä¸ä¸ª bigintï¼å°±ä¼æ¥éã\n\n// éè¯¯çåæ³\nmath.sqrt(4n) // æ¥é\n\n// æ­£ç¡®çåæ³\nmath.sqrt(number(4n)) // 2\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼math.sqrtçåæ°é¢ææ¯ number ç±»åï¼å¦ææ¯ bigint å°±ä¼æ¥éï¼å¿é¡»åç¨numberæ¹æ³è½¬ä¸ä¸ç±»åï¼æè½è¿è¡è®¡ç®ã\n\nasm.js éé¢ï¼|0è·å¨ä¸ä¸ªæ°å¼çåé¢ä¼è¿åä¸ä¸ª32ä½æ´æ°ãæ ¹æ®ä¸è½ä¸ number ç±»åæ··åè¿ç®çè§åï¼bigint å¦æä¸|0è¿è¡è¿ç®ä¼æ¥éã\n\n1n | 0 // æ¥é\n\n\n1\n\n\n\n# å¶ä»è¿ç®\n\nbigint å¯¹åºçå¸å°å¼ï¼ä¸ number ç±»åä¸è´ï¼å³0nä¼è½¬ä¸ºfalseï¼å¶ä»å¼è½¬ä¸ºtrueã\n\nif (0n) {\n  console.log('if');\n} else {\n  console.log('else');\n}\n// else\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼0nå¯¹åºfalseï¼æä»¥ä¼è¿å¥elseå­å¥ã\n\næ¯è¾è¿ç®ç¬¦ï¼æ¯å¦>ï¼åç¸ç­è¿ç®ç¬¦ï¼==ï¼åè®¸ bigint ä¸å¶ä»ç±»åçå¼æ··åè®¡ç®ï¼å ä¸ºè¿æ ·åä¸ä¼æå¤±ç²¾åº¦ã\n\n0n < 1 // true\n0n < true // true\n0n == 0 // true\n0n == false // true\n0n === 0 // false\n\n\n1\n2\n3\n4\n5\n\n\nbigint ä¸å­ç¬¦ä¸²æ··åè¿ç®æ¶ï¼ä¼åè½¬ä¸ºå­ç¬¦ä¸²ï¼åè¿è¡è¿ç®ã\n\n'' + 123n // \"123\"\n\n\n1\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"å½æ°çæ©å±",frontmatter:{title:"å½æ°çæ©å±",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/8ed309d668b20264",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/08.%E5%87%BD%E6%95%B0%E7%9A%84%E6%89%A9%E5%B1%95.html",relativePath:"ãES6 æç¨ãç¬è®°/08.å½æ°çæ©å±.md",key:"v-d6f05d32",path:"/pages/8ed309d668b20264/",headers:[{level:2,title:"å½æ°åæ°çé»è®¤å¼",slug:"å½æ°åæ°çé»è®¤å¼",normalizedTitle:"å½æ°åæ°çé»è®¤å¼",charIndex:12},{level:3,title:"åºæ¬ç¨æ³",slug:"åºæ¬ç¨æ³",normalizedTitle:"åºæ¬ç¨æ³",charIndex:25},{level:3,title:"ä¸è§£æèµå¼é»è®¤å¼ç»åä½¿ç¨",slug:"ä¸è§£æèµå¼é»è®¤å¼ç»åä½¿ç¨",normalizedTitle:"ä¸è§£æèµå¼é»è®¤å¼ç»åä½¿ç¨",charIndex:1543},{level:3,title:"åæ°é»è®¤å¼çä½ç½®",slug:"åæ°é»è®¤å¼çä½ç½®",normalizedTitle:"åæ°é»è®¤å¼çä½ç½®",charIndex:3183},{level:3,title:"å½æ°ç length å±æ§",slug:"å½æ°ç-length-å±æ§",normalizedTitle:"å½æ°ç length å±æ§",charIndex:3874},{level:3,title:"ä½ç¨å",slug:"ä½ç¨å",normalizedTitle:"ä½ç¨å",charIndex:4439},{level:3,title:"åºç¨",slug:"åºç¨",normalizedTitle:"åºç¨",charIndex:6230},{level:2,title:"rest åæ°",slug:"rest-åæ°",normalizedTitle:"rest åæ°",charIndex:4243},{level:2,title:"ä¸¥æ ¼æ¨¡å¼",slug:"ä¸¥æ ¼æ¨¡å¼",normalizedTitle:"ä¸¥æ ¼æ¨¡å¼",charIndex:7903},{level:2,title:"name å±æ§",slug:"name-å±æ§",normalizedTitle:"name å±æ§",charIndex:9120},{level:2,title:"ç®­å¤´å½æ°",slug:"ç®­å¤´å½æ°",normalizedTitle:"ç®­å¤´å½æ°",charIndex:9824},{level:3,title:"åºæ¬ç¨æ³",slug:"åºæ¬ç¨æ³-2",normalizedTitle:"åºæ¬ç¨æ³",charIndex:25},{level:3,title:"ä½¿ç¨æ³¨æç¹",slug:"ä½¿ç¨æ³¨æç¹",normalizedTitle:"ä½¿ç¨æ³¨æç¹",charIndex:11526},{level:3,title:"ä¸éç¨åºå",slug:"ä¸éç¨åºå",normalizedTitle:"ä¸éç¨åºå",charIndex:14619},{level:3,title:"åµå¥çç®­å¤´å½æ°",slug:"åµå¥çç®­å¤´å½æ°",normalizedTitle:"åµå¥çç®­å¤´å½æ°",charIndex:15264},{level:2,title:"å°¾è°ç¨ä¼å",slug:"å°¾è°ç¨ä¼å",normalizedTitle:"å°¾è°ç¨ä¼å",charIndex:16453},{level:3,title:"ä»ä¹æ¯å°¾è°ç¨ï¼",slug:"ä»ä¹æ¯å°¾è°ç¨",normalizedTitle:"ä»ä¹æ¯å°¾è°ç¨ï¼",charIndex:16463},{level:3,title:"å°¾è°ç¨ä¼å",slug:"å°¾è°ç¨ä¼å-2",normalizedTitle:"å°¾è°ç¨ä¼å",charIndex:16453},{level:3,title:"å°¾éå½",slug:"å°¾éå½",normalizedTitle:"å°¾éå½",charIndex:18046},{level:3,title:"éå½å½æ°çæ¹å",slug:"éå½å½æ°çæ¹å",normalizedTitle:"éå½å½æ°çæ¹å",charIndex:19198},{level:3,title:"ä¸¥æ ¼æ¨¡å¼",slug:"ä¸¥æ ¼æ¨¡å¼-2",normalizedTitle:"ä¸¥æ ¼æ¨¡å¼",charIndex:7903},{level:3,title:"å°¾éå½ä¼åçå®ç°",slug:"å°¾éå½ä¼åçå®ç°",normalizedTitle:"å°¾éå½ä¼åçå®ç°",charIndex:20764},{level:2,title:"å½æ°åæ°çå°¾éå·",slug:"å½æ°åæ°çå°¾éå·",normalizedTitle:"å½æ°åæ°çå°¾éå·",charIndex:22545},{level:2,title:"Function.prototype.toString()",slug:"function-prototype-tostring",normalizedTitle:"function.prototype.tostring()",charIndex:23110},{level:2,title:"catch å½ä»¤çåæ°çç¥",slug:"catch-å½ä»¤çåæ°çç¥",normalizedTitle:"catch å½ä»¤çåæ°çç¥",charIndex:23500}],excerpt:'<h1 id="å½æ°çæ©å±"><a class="header-anchor" href="#å½æ°çæ©å±">#</a> å½æ°çæ©å±</h1>\n<h2 id="å½æ°åæ°çé»è®¤å¼"><a class="header-anchor" href="#å½æ°åæ°çé»è®¤å¼">#</a> å½æ°åæ°çé»è®¤å¼</h2>\n<h3 id="åºæ¬ç¨æ³"><a class="header-anchor" href="#åºæ¬ç¨æ³">#</a> åºæ¬ç¨æ³</h3>\n<p>ES6 ä¹åï¼ä¸è½ç´æ¥ä¸ºå½æ°çåæ°æå®é»è®¤å¼ï¼åªè½éç¨åéçæ¹æ³ã</p>\n\x3c!--beforebegin--\x3e<div class="language-javascript line-numbers-mode">\x3c!--afterbegin--\x3e<pre v-pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  y <span class="token operator">=</span> y <span class="token operator">||</span> <span class="token string">\'World\'</span><span class="token punctuation">;</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Hello\'</span><span class="token punctuation">)</span> <span class="token comment">// Hello World</span>\n<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Hello\'</span><span class="token punctuation">,</span> <span class="token string">\'China\'</span><span class="token punctuation">)</span> <span class="token comment">// Hello China</span>\n<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Hello\'</span><span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span> <span class="token comment">// Hello World</span>\n</code></pre>\n<div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div>\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e',headersStr:"å½æ°åæ°çé»è®¤å¼ åºæ¬ç¨æ³ ä¸è§£æèµå¼é»è®¤å¼ç»åä½¿ç¨ åæ°é»è®¤å¼çä½ç½® å½æ°ç length å±æ§ ä½ç¨å åºç¨ rest åæ° ä¸¥æ ¼æ¨¡å¼ name å±æ§ ç®­å¤´å½æ° åºæ¬ç¨æ³ ä½¿ç¨æ³¨æç¹ ä¸éç¨åºå åµå¥çç®­å¤´å½æ° å°¾è°ç¨ä¼å ä»ä¹æ¯å°¾è°ç¨ï¼ å°¾è°ç¨ä¼å å°¾éå½ éå½å½æ°çæ¹å ä¸¥æ ¼æ¨¡å¼ å°¾éå½ä¼åçå®ç° å½æ°åæ°çå°¾éå· Function.prototype.toString() catch å½ä»¤çåæ°çç¥",content:"# å½æ°çæ©å±\n\n\n# å½æ°åæ°çé»è®¤å¼\n\n\n# åºæ¬ç¨æ³\n\nES6 ä¹åï¼ä¸è½ç´æ¥ä¸ºå½æ°çåæ°æå®é»è®¤å¼ï¼åªè½éç¨åéçæ¹æ³ã\n\nfunction log(x, y) {\n  y = y || 'World';\n  console.log(x, y);\n}\n\nlog('Hello') // Hello World\nlog('Hello', 'China') // Hello China\nlog('Hello', '') // Hello World\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç æ£æ¥å½æ°logçåæ°yææ²¡æèµå¼ï¼å¦ææ²¡æï¼åæå®é»è®¤å¼ä¸ºWorldãè¿ç§åæ³çç¼ºç¹å¨äºï¼å¦æåæ°yèµå¼äºï¼ä½æ¯å¯¹åºçå¸å°å¼ä¸ºfalseï¼åè¯¥èµå¼ä¸èµ·ä½ç¨ãå°±åä¸é¢ä»£ç çæåä¸è¡ï¼åæ°yç­äºç©ºå­ç¬¦ï¼ç»æè¢«æ¹ä¸ºé»è®¤å¼ã\n\nä¸ºäºé¿åè¿ä¸ªé®é¢ï¼éå¸¸éè¦åå¤æ­ä¸ä¸åæ°yæ¯å¦è¢«èµå¼ï¼å¦ææ²¡æï¼åç­äºé»è®¤å¼ã\n\nif (typeof y === 'undefined') {\n  y = 'World';\n}\n\n\n1\n2\n3\n\n\nES6 åè®¸ä¸ºå½æ°çåæ°è®¾ç½®é»è®¤å¼ï¼å³ç´æ¥åå¨åæ°å®ä¹çåé¢ã\n\nfunction log(x, y = 'World') {\n  console.log(x, y);\n}\n\nlog('Hello') // Hello World\nlog('Hello', 'China') // Hello China\nlog('Hello', '') // Hello\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¯ä»¥çå°ï¼ES6 çåæ³æ¯ ES5 ç®æ´è®¸å¤ï¼èä¸éå¸¸èªç¶ãä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nfunction Point(x = 0, y = 0) {\n  this.x = x;\n  this.y = y;\n}\n\nconst p = new Point();\np // { x: 0, y: 0 }\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\né¤äºç®æ´ï¼ES6 çåæ³è¿æä¸¤ä¸ªå¥½å¤ï¼é¦åï¼éè¯»ä»£ç çäººï¼å¯ä»¥ç«å»æè¯å°åªäºåæ°æ¯å¯ä»¥çç¥çï¼ä¸ç¨æ¥çå½æ°ä½æææ¡£ï¼å¶æ¬¡ï¼æå©äºå°æ¥çä»£ç ä¼åï¼å³ä½¿æªæ¥ççæ¬å¨å¯¹å¤æ¥å£ä¸­ï¼å½»åºæ¿æè¿ä¸ªåæ°ï¼ä¹ä¸ä¼å¯¼è´ä»¥åçä»£ç æ æ³è¿è¡ã\n\nåæ°åéæ¯é»è®¤å£°æçï¼æä»¥ä¸è½ç¨letæconståæ¬¡å£°æã\n\nfunction foo(x = 5) {\n  let x = 1; // error\n  const x = 2; // error\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°åéxæ¯é»è®¤å£°æçï¼å¨å½æ°ä½ä¸­ï¼ä¸è½ç¨letæconståæ¬¡å£°æï¼å¦åä¼æ¥éã\n\nä½¿ç¨åæ°é»è®¤å¼æ¶ï¼å½æ°ä¸è½æåååæ°ã\n\n// ä¸æ¥é\nfunction foo(x, x, y) {\n  // ...\n}\n\n// æ¥é\nfunction foo(x, x, y = 1) {\n  // ...\n}\n// SyntaxError: Duplicate parameter name not allowed in this context\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¦å¤ï¼ä¸ä¸ªå®¹æå¿½ç¥çå°æ¹æ¯ï¼åæ°é»è®¤å¼ä¸æ¯ä¼ å¼çï¼èæ¯æ¯æ¬¡é½éæ°è®¡ç®é»è®¤å¼è¡¨è¾¾å¼çå¼ãä¹å°±æ¯è¯´ï¼åæ°é»è®¤å¼æ¯æ°æ§æ±å¼çã\n\nlet x = 99;\nfunction foo(p = x + 1) {\n  console.log(p);\n}\n\nfoo() // 100\n\nx = 100;\nfoo() // 101\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°pçé»è®¤å¼æ¯x + 1ãè¿æ¶ï¼æ¯æ¬¡è°ç¨å½æ°fooï¼é½ä¼éæ°è®¡ç®x + 1ï¼èä¸æ¯é»è®¤pç­äº 100ã\n\n\n# ä¸è§£æèµå¼é»è®¤å¼ç»åä½¿ç¨\n\nåæ°é»è®¤å¼å¯ä»¥ä¸è§£æèµå¼çé»è®¤å¼ï¼ç»åèµ·æ¥ä½¿ç¨ã\n\nfunction foo({x, y = 5}) {\n  console.log(x, y);\n}\n\nfoo({}) // undefined 5\nfoo({x: 1}) // 1 5\nfoo({x: 1, y: 2}) // 1 2\nfoo() // TypeError: Cannot read property 'x' of undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç åªä½¿ç¨äºå¯¹è±¡çè§£æèµå¼é»è®¤å¼ï¼æ²¡æä½¿ç¨å½æ°åæ°çé»è®¤å¼ãåªæå½å½æ°fooçåæ°æ¯ä¸ä¸ªå¯¹è±¡æ¶ï¼åéxåyæä¼éè¿è§£æèµå¼çæãå¦æå½æ°fooè°ç¨æ¶æ²¡æä¾åæ°ï¼åéxåyå°±ä¸ä¼çæï¼ä»èæ¥éãéè¿æä¾å½æ°åæ°çé»è®¤å¼ï¼å°±å¯ä»¥é¿åè¿ç§æåµã\n\nfunction foo({x, y = 5} = {}) {\n  console.log(x, y);\n}\n\nfoo() // undefined 5\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç æå®ï¼å¦ææ²¡ææä¾åæ°ï¼å½æ°fooçåæ°é»è®¤ä¸ºä¸ä¸ªç©ºå¯¹è±¡ã\n\nä¸é¢æ¯å¦ä¸ä¸ªè§£æèµå¼é»è®¤å¼çä¾å­ã\n\nfunction fetch(url, { body = '', method = 'GET', headers = {} }) {\n  console.log(method);\n}\n\nfetch('http://example.com', {})\n// \"GET\"\n\nfetch('http://example.com')\n// æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æå½æ°fetchçç¬¬äºä¸ªåæ°æ¯ä¸ä¸ªå¯¹è±¡ï¼å°±å¯ä»¥ä¸ºå®çä¸ä¸ªå±æ§è®¾ç½®é»è®¤å¼ãè¿ç§åæ³ä¸è½çç¥ç¬¬äºä¸ªåæ°ï¼å¦æç»åå½æ°åæ°çé»è®¤å¼ï¼å°±å¯ä»¥çç¥ç¬¬äºä¸ªåæ°ãè¿æ¶ï¼å°±åºç°äºåéé»è®¤å¼ã\n\nfunction fetch(url, { body = '', method = 'GET', headers = {} } = {}) {\n  console.log(method);\n}\n\nfetch('http://example.com')\n// \"GET\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fetchæ²¡æç¬¬äºä¸ªåæ°æ¶ï¼å½æ°åæ°çé»è®¤å¼å°±ä¼çæï¼ç¶åææ¯è§£æèµå¼çé»è®¤å¼çæï¼åémethodæä¼åå°é»è®¤å¼GETã\n\nä½ä¸ºç»ä¹ ï¼è¯·é®ä¸é¢ä¸¤ç§åæ³æä»ä¹å·®å«ï¼\n\n// åæ³ä¸\nfunction m1({x = 0, y = 0} = {}) {\n  return [x, y];\n}\n\n// åæ³äº\nfunction m2({x, y} = { x: 0, y: 0 }) {\n  return [x, y];\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä¸¤ç§åæ³é½å¯¹å½æ°çåæ°è®¾å®äºé»è®¤å¼ï¼åºå«æ¯åæ³ä¸å½æ°åæ°çé»è®¤å¼æ¯ç©ºå¯¹è±¡ï¼ä½æ¯è®¾ç½®äºå¯¹è±¡è§£æèµå¼çé»è®¤å¼ï¼åæ³äºå½æ°åæ°çé»è®¤å¼æ¯ä¸ä¸ªæå·ä½å±æ§çå¯¹è±¡ï¼ä½æ¯æ²¡æè®¾ç½®å¯¹è±¡è§£æèµå¼çé»è®¤å¼ã\n\n// å½æ°æ²¡æåæ°çæåµ\nm1() // [0, 0]\nm2() // [0, 0]\n\n// x å y é½æå¼çæåµ\nm1({x: 3, y: 8}) // [3, 8]\nm2({x: 3, y: 8}) // [3, 8]\n\n// x æå¼ï¼y æ å¼çæåµ\nm1({x: 3}) // [3, 0]\nm2({x: 3}) // [3, undefined]\n\n// x å y é½æ å¼çæåµ\nm1({}) // [0, 0];\nm2({}) // [undefined, undefined]\n\nm1({z: 3}) // [0, 0]\nm2({z: 3}) // [undefined, undefined]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n# åæ°é»è®¤å¼çä½ç½®\n\néå¸¸æåµä¸ï¼å®ä¹äºé»è®¤å¼çåæ°ï¼åºè¯¥æ¯å½æ°çå°¾åæ°ãå ä¸ºè¿æ ·æ¯è¾å®¹æçåºæ¥ï¼å°åºçç¥äºåªäºåæ°ãå¦æéå°¾é¨çåæ°è®¾ç½®é»è®¤å¼ï¼å®éä¸è¿ä¸ªåæ°æ¯æ²¡æ³çç¥çã\n\n// ä¾ä¸\nfunction f(x = 1, y) {\n  return [x, y];\n}\n\nf() // [1, undefined]\nf(2) // [2, undefined])\nf(, 1) // æ¥é\nf(undefined, 1) // [1, 1]\n\n// ä¾äº\nfunction f(x, y = 5, z) {\n  return [x, y, z];\n}\n\nf() // [undefined, 5, undefined]\nf(1) // [1, 5, undefined]\nf(1, ,2) // æ¥é\nf(1, undefined, 2) // [1, 5, 2]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ä¸­ï¼æé»è®¤å¼çåæ°é½ä¸æ¯å°¾åæ°ãè¿æ¶ï¼æ æ³åªçç¥è¯¥åæ°ï¼èä¸çç¥å®åé¢çåæ°ï¼é¤éæ¾å¼è¾å¥undefinedã\n\nå¦æä¼ å¥undefinedï¼å°è§¦åè¯¥åæ°ç­äºé»è®¤å¼ï¼nullåæ²¡æè¿ä¸ªææã\n\nfunction foo(x = 5, y = 6) {\n  console.log(x, y);\n}\n\nfoo(undefined, null)\n// 5 null\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼xåæ°å¯¹åºundefinedï¼ç»æè§¦åäºé»è®¤å¼ï¼yåæ°ç­äºnullï¼å°±æ²¡æè§¦åé»è®¤å¼ã\n\n\n# å½æ°ç length å±æ§\n\næå®äºé»è®¤å¼ä»¥åï¼å½æ°çlengthå±æ§ï¼å°è¿åæ²¡ææå®é»è®¤å¼çåæ°ä¸ªæ°ãä¹å°±æ¯è¯´ï¼æå®äºé»è®¤å¼åï¼lengthå±æ§å°å¤±çã\n\n(function (a) {}).length // 1\n(function (a = 5) {}).length // 0\n(function (a, b, c = 5) {}).length // 2\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼lengthå±æ§çè¿åå¼ï¼ç­äºå½æ°çåæ°ä¸ªæ°åå»æå®äºé»è®¤å¼çåæ°ä¸ªæ°ãæ¯å¦ï¼ä¸é¢æåä¸ä¸ªå½æ°ï¼å®ä¹äº 3 ä¸ªåæ°ï¼å¶ä¸­æä¸ä¸ªåæ°cæå®äºé»è®¤å¼ï¼å æ­¤lengthå±æ§ç­äº3åå»1ï¼æåå¾å°2ã\n\nè¿æ¯å ä¸º**lengthå±æ§çå«ä¹æ¯ï¼è¯¥å½æ°é¢æä¼ å¥çåæ°ä¸ªæ°**ãæä¸ªåæ°æå®é»è®¤å¼ä»¥åï¼é¢æä¼ å¥çåæ°ä¸ªæ°å°±ä¸åæ¬è¿ä¸ªåæ°äºãåçï¼åæç rest åæ°ä¹ä¸ä¼è®¡å¥lengthå±æ§ã\n\n(function(...args) {}).length // 0\n\n\n1\n\n\nå¦æè®¾ç½®äºé»è®¤å¼çåæ°ä¸æ¯å°¾åæ°ï¼é£ä¹lengthå±æ§ä¹ä¸åè®¡å¥åé¢çåæ°äºã\n\n(function (a = 0, b, c) {}).length // 0\n(function (a, b = 1, c) {}).length // 1\n\n\n1\n2\n\n\n\n# ä½ç¨å\n\nä¸æ¦è®¾ç½®äºåæ°çé»è®¤å¼ï¼å½æ°è¿è¡å£°æåå§åæ¶ï¼åæ°ä¼å½¢æä¸ä¸ªåç¬çä½ç¨åï¼contextï¼ãç­å°åå§åç»æï¼è¿ä¸ªä½ç¨åå°±ä¼æ¶å¤±ãè¿ç§è¯­æ³è¡ä¸ºï¼å¨ä¸è®¾ç½®åæ°é»è®¤å¼æ¶ï¼æ¯ä¸ä¼åºç°çã\n\nvar x = 1;\n\nfunction f(x, y = x) {\n  console.log(y);\n}\n\nf(2) // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°yçé»è®¤å¼ç­äºåéxãè°ç¨å½æ°fæ¶ï¼åæ°å½¢æä¸ä¸ªåç¬çä½ç¨åãå¨è¿ä¸ªä½ç¨åéé¢ï¼é»è®¤å¼åéxæåç¬¬ä¸ä¸ªåæ°xï¼èä¸æ¯å¨å±åéxï¼æä»¥è¾åºæ¯2ã\n\nåçä¸é¢çä¾å­ã\n\nlet x = 1;\n\nfunction f(y = x) {\n  let x = 2;\n  console.log(y);\n}\n\nf() // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fè°ç¨æ¶ï¼åæ°y = xå½¢æä¸ä¸ªåç¬çä½ç¨åãè¿ä¸ªä½ç¨åéé¢ï¼åéxæ¬èº«æ²¡æå®ä¹ï¼æä»¥æåå¤å±çå¨å±åéxãå½æ°è°ç¨æ¶ï¼å½æ°ä½åé¨çå±é¨åéxå½±åä¸å°é»è®¤å¼åéxã\n\nå¦ææ­¤æ¶ï¼å¨å±åéxä¸å­å¨ï¼å°±ä¼æ¥éã\n\nfunction f(y = x) {\n  let x = 2;\n  console.log(y);\n}\n\nf() // ReferenceError: x is not defined\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢è¿æ ·åï¼ä¹ä¼æ¥éã\n\nvar x = 1;\n\nfunction foo(x = x) {\n  // ...\n}\n\nfoo() // ReferenceError: x is not defined\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°x = xå½¢æä¸ä¸ªåç¬ä½ç¨åãå®éæ§è¡çæ¯let x = xï¼ç±äºææ¶æ§æ­»åºçåå ï¼è¿è¡ä»£ç ä¼æ¥éâx æªå®ä¹âã\n\nå¦æåæ°çé»è®¤å¼æ¯ä¸ä¸ªå½æ°ï¼è¯¥å½æ°çä½ç¨åä¹éµå®è¿ä¸ªè§åãè¯·çä¸é¢çä¾å­ã\n\nlet foo = 'outer';\n\nfunction bar(func = () => foo) {\n  let foo = 'inner';\n  console.log(func());\n}\n\nbar(); // outer\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°barçåæ°funcçé»è®¤å¼æ¯ä¸ä¸ªå¿åå½æ°ï¼è¿åå¼ä¸ºåéfooãå½æ°åæ°å½¢æçåç¬ä½ç¨åéé¢ï¼å¹¶æ²¡æå®ä¹åéfooï¼æä»¥fooæåå¤å±çå¨å±åéfooï¼å æ­¤è¾åºouterã\n\nå¦æåæä¸é¢è¿æ ·ï¼å°±ä¼æ¥éã\n\nfunction bar(func = () => foo) {\n  let foo = 'inner';\n  console.log(func());\n}\n\nbar() // ReferenceError: foo is not defined\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å¿åå½æ°éé¢çfooæåå½æ°å¤å±ï¼ä½æ¯å½æ°å¤å±å¹¶æ²¡æå£°æåéfooï¼æä»¥å°±æ¥éäºã\n\nä¸é¢æ¯ä¸ä¸ªæ´å¤æçä¾å­ã\n\nvar x = 1;\nfunction foo(x, y = function() { x = 2; }) {\n  var x = 3;\n  y();\n  console.log(x);\n}\n\nfoo() // 3\nx // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fooçåæ°å½¢æä¸ä¸ªåç¬ä½ç¨åãè¿ä¸ªä½ç¨åéé¢ï¼é¦åå£°æäºåéxï¼ç¶åå£°æäºåéyï¼yçé»è®¤å¼æ¯ä¸ä¸ªå¿åå½æ°ãè¿ä¸ªå¿åå½æ°åé¨çåéxï¼æååä¸ä¸ªä½ç¨åçç¬¬ä¸ä¸ªåæ°xãå½æ°fooåé¨åå£°æäºä¸ä¸ªåé¨åéxï¼è¯¥åéä¸ç¬¬ä¸ä¸ªåæ°xç±äºä¸æ¯åä¸ä¸ªä½ç¨åï¼æä»¥ä¸æ¯åä¸ä¸ªåéï¼å æ­¤æ§è¡yåï¼åé¨åéxåå¤é¨å¨å±åéxçå¼é½æ²¡åã\n\nå¦æå°var x = 3çvarå»é¤ï¼å½æ°fooçåé¨åéxå°±æåç¬¬ä¸ä¸ªåæ°xï¼ä¸å¿åå½æ°åé¨çxæ¯ä¸è´çï¼æä»¥æåè¾åºçå°±æ¯2ï¼èå¤å±çå¨å±åéxä¾ç¶ä¸åå½±åã\n\nvar x = 1;\nfunction foo(x, y = function() { x = 2; }) {\n  x = 3;\n  y();\n  console.log(x);\n}\n\nfoo() // 2\nx // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# åºç¨\n\nå©ç¨åæ°é»è®¤å¼ï¼å¯ä»¥æå®æä¸ä¸ªåæ°ä¸å¾çç¥ï¼å¦æçç¥å°±æåºä¸ä¸ªéè¯¯ã\n\nfunction throwIfMissing() {\n  throw new Error('Missing parameter');\n}\n\nfunction foo(mustBeProvided = throwIfMissing()) {\n  return mustBeProvided;\n}\n\nfoo()\n// Error: Missing parameter\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç çfooå½æ°ï¼å¦æè°ç¨çæ¶åæ²¡æåæ°ï¼å°±ä¼è°ç¨é»è®¤å¼throwIfMissingå½æ°ï¼ä»èæåºä¸ä¸ªéè¯¯ã\n\nä»ä¸é¢ä»£ç è¿å¯ä»¥çå°ï¼åæ°mustBeProvidedçé»è®¤å¼ç­äºthrowIfMissingå½æ°çè¿è¡ç»æï¼æ³¨æå½æ°åthrowIfMissingä¹åæä¸å¯¹åæ¬å·ï¼ï¼è¿è¡¨æåæ°çé»è®¤å¼ä¸æ¯å¨å®ä¹æ¶æ§è¡ï¼èæ¯å¨è¿è¡æ¶æ§è¡ãå¦æåæ°å·²ç»èµå¼ï¼é»è®¤å¼ä¸­çå½æ°å°±ä¸ä¼è¿è¡ã\n\nå¦å¤ï¼å¯ä»¥å°åæ°é»è®¤å¼è®¾ä¸ºundefinedï¼è¡¨æè¿ä¸ªåæ°æ¯å¯ä»¥çç¥çã\n\nfunction foo(optional = undefined) { Â·Â·Â· }\n\n\n1\n\n\n\n# rest åæ°\n\nES6 å¼å¥ rest åæ°ï¼å½¢å¼ä¸º...åéåï¼ï¼ç¨äºè·åå½æ°çå¤ä½åæ°ï¼è¿æ ·å°±ä¸éè¦ä½¿ç¨argumentså¯¹è±¡äºãrest åæ°æ­éçåéæ¯ä¸ä¸ªæ°ç»ï¼è¯¥åéå°å¤ä½çåæ°æ¾å¥æ°ç»ä¸­ã\n\nfunction add(...values) { // valuesæ¯ä¸ä¸ªæ°ç»ï¼è¯¥åéå°å¤ä½çåæ°æ¾å¥æ°ç»ä¸­\n  let sum = 0;\n\n  for (var val of values) {\n    sum += val;\n  }\n\n  return sum;\n}\n\nadd(2, 5, 3) // 10\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç çaddå½æ°æ¯ä¸ä¸ªæ±åå½æ°ï¼å©ç¨ rest åæ°ï¼å¯ä»¥åè¯¥å½æ°ä¼ å¥ä»»ææ°ç®çåæ°ã\n\nä¸é¢æ¯ä¸ä¸ª rest åæ°ä»£æ¿argumentsåéçä¾å­ã\n\n// argumentsåéçåæ³\nfunction sortNumbers() {\n  return Array.prototype.slice.call(arguments).sort();\n}\n\n// reståæ°çåæ³\nconst sortNumbers = (...numbers) => numbers.sort();\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç çä¸¤ç§åæ³ï¼æ¯è¾åå¯ä»¥åç°ï¼rest åæ°çåæ³æ´èªç¶ä¹æ´ç®æ´ã\n\nargumentså¯¹è±¡ä¸æ¯æ°ç»ï¼èæ¯ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ãæä»¥ä¸ºäºä½¿ç¨æ°ç»çæ¹æ³ï¼å¿é¡»ä½¿ç¨Array.prototype.slice.callåå°å¶è½¬ä¸ºæ°ç»ãrest åæ°å°±ä¸å­å¨è¿ä¸ªé®é¢ï¼å®å°±æ¯ä¸ä¸ªçæ­£çæ°ç»ï¼æ°ç»ç¹æçæ¹æ³é½å¯ä»¥ä½¿ç¨ãä¸é¢æ¯ä¸ä¸ªå©ç¨ rest åæ°æ¹åæ°ç»pushæ¹æ³çä¾å­ã\n\nfunction push(array, ...items) {\n  items.forEach(function(item) {\n    array.push(item);\n    console.log(item);\n  });\n}\n\nvar a = [];\npush(a, 1, 2, 3)\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\næ³¨æï¼rest åæ°ä¹åä¸è½åæå¶ä»åæ°ï¼å³åªè½æ¯æåä¸ä¸ªåæ°ï¼ï¼å¦åä¼æ¥éã\n\n// æ¥é\nfunction f(a, ...b, c) {\n  // ...\n}\n\n\n1\n2\n3\n4\n\n\nå½æ°çlengthå±æ§ï¼ä¸åæ¬ rest åæ°ã\n\n(function(a) {}).length  // 1\n(function(...a) {}).length  // 0\n(function(a, ...b) {}).length  // 1\n\n\n1\n2\n3\n\n\n\n# ä¸¥æ ¼æ¨¡å¼\n\nä» ES5 å¼å§ï¼å½æ°åé¨å¯ä»¥è®¾å®ä¸ºä¸¥æ ¼æ¨¡å¼ã\n\nfunction doSomething(a, b) {\n  'use strict';\n  // code\n}\n\n\n1\n2\n3\n4\n\n\nES2016 åäºä¸ç¹ä¿®æ¹ï¼è§å®åªè¦å½æ°åæ°ä½¿ç¨äºé»è®¤å¼ãè§£æèµå¼ãæèæ©å±è¿ç®ç¬¦ï¼é£ä¹å½æ°åé¨å°±ä¸è½æ¾å¼è®¾å®ä¸ºä¸¥æ ¼æ¨¡å¼ï¼å¦åä¼æ¥éã\n\n// æ¥é\nfunction doSomething(a, b = a) {\n  'use strict';\n  // code\n}\n\n// æ¥é\nconst doSomething = function ({a, b}) {\n  'use strict';\n  // code\n};\n\n// æ¥é\nconst doSomething = (...a) => {\n  'use strict';\n  // code\n};\n\nconst obj = {\n  // æ¥é\n  doSomething({a, b}) {\n    'use strict';\n    // code\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nè¿æ ·è§å®çåå æ¯ï¼å½æ°åé¨çä¸¥æ ¼æ¨¡å¼ï¼åæ¶éç¨äºå½æ°ä½åå½æ°åæ°ãä½æ¯ï¼å½æ°æ§è¡çæ¶åï¼åæ§è¡å½æ°åæ°ï¼ç¶ååæ§è¡å½æ°ä½ãè¿æ ·å°±æä¸ä¸ªä¸åççå°æ¹ï¼åªæä»å½æ°ä½ä¹ä¸­ï¼æè½ç¥éåæ°æ¯å¦åºè¯¥ä»¥ä¸¥æ ¼æ¨¡å¼æ§è¡ï¼ä½æ¯åæ°å´åºè¯¥åäºå½æ°ä½æ§è¡ã\n\n// æ¥é\nfunction doSomething(value = 070) {\n  'use strict';\n  return value;\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°valueçé»è®¤å¼æ¯å«è¿å¶æ°070ï¼ä½æ¯ä¸¥æ ¼æ¨¡å¼ä¸ä¸è½ç¨åç¼0è¡¨ç¤ºå«è¿å¶ï¼æä»¥åºè¯¥æ¥éãä½æ¯å®éä¸ï¼JavaScript å¼æä¼åæåæ§è¡value = 070ï¼ç¶åè¿å¥å½æ°ä½åé¨ï¼åç°éè¦ç¨ä¸¥æ ¼æ¨¡å¼æ§è¡ï¼è¿æ¶æä¼æ¥éã\n\nè½ç¶å¯ä»¥åè§£æå½æ°ä½ä»£ç ï¼åæ§è¡åæ°ä»£ç ï¼ä½æ¯è¿æ ·æ çå°±å¢å äºå¤ææ§ãå æ­¤ï¼æ åç´¢æ§ç¦æ­¢äºè¿ç§ç¨æ³ï¼åªè¦åæ°ä½¿ç¨äºé»è®¤å¼ãè§£æèµå¼ãæèæ©å±è¿ç®ç¬¦ï¼å°±ä¸è½æ¾å¼æå®ä¸¥æ ¼æ¨¡å¼ã\n\nä¸¤ç§æ¹æ³å¯ä»¥è§é¿è¿ç§éå¶ãç¬¬ä¸ç§æ¯è®¾å®å¨å±æ§çä¸¥æ ¼æ¨¡å¼ï¼è¿æ¯åæ³çã\n\n'use strict';\n\nfunction doSomething(a, b = a) {\n  // code\n}\n\n\n1\n2\n3\n4\n5\n\n\nç¬¬äºç§æ¯æå½æ°åå¨ä¸ä¸ªæ åæ°çç«å³æ§è¡å½æ°éé¢ã\n\nconst doSomething = (function () {\n  'use strict';\n  return function(value = 42) {\n    return value;\n  };\n}());\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# name å±æ§\n\nå½æ°çnameå±æ§ï¼è¿åè¯¥å½æ°çå½æ°åã\n\nfunction foo() {}\nfoo.name // \"foo\"\n\n\n1\n2\n\n\nè¿ä¸ªå±æ§æ©å°±è¢«æµè§å¨å¹¿æ³æ¯æï¼ä½æ¯ç´å° ES6ï¼æå°å¶åå¥äºæ åã\n\néè¦æ³¨æçæ¯ï¼ES6 å¯¹è¿ä¸ªå±æ§çè¡ä¸ºååºäºä¸äºä¿®æ¹ãå¦æå°ä¸ä¸ªå¿åå½æ°èµå¼ç»ä¸ä¸ªåéï¼ES5 çnameå±æ§ï¼ä¼è¿åç©ºå­ç¬¦ä¸²ï¼è ES6 çnameå±æ§ä¼è¿åå®éçå½æ°åã\n\nvar f = function () {};\n\n// ES5\nf.name // \"\"\n\n// ES6\nf.name // \"f\"\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åéfç­äºä¸ä¸ªå¿åå½æ°ï¼ES5 å ES6 çnameå±æ§è¿åçå¼ä¸ä¸æ ·ã\n\nå¦æå°ä¸ä¸ªå·åå½æ°èµå¼ç»ä¸ä¸ªåéï¼å ES5 å ES6 çnameå±æ§é½è¿åè¿ä¸ªå·åå½æ°åæ¬çåå­ã\n\nconst bar = function baz() {};\n\n// ES5\nbar.name // \"baz\"\n\n// ES6\nbar.name // \"baz\"\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nFunctionæé å½æ°è¿åçå½æ°å®ä¾ï¼nameå±æ§çå¼ä¸ºanonymousã\n\n(new Function).name // \"anonymous\"\n\n\n1\n\n\nbindè¿åçå½æ°ï¼nameå±æ§å¼ä¼å ä¸boundåç¼ã\n\nfunction foo() {};\nfoo.bind({}).name // \"bound foo\"\n\n(function(){}).bind({}).name // \"bound \"\n\n\n1\n2\n3\n4\n\n\n\n# ç®­å¤´å½æ°\n\n\n# åºæ¬ç¨æ³\n\nES6 åè®¸ä½¿ç¨âç®­å¤´âï¼=>ï¼å®ä¹å½æ°ã\n\nvar f = v => v;\n\n// ç­åäº\nvar f = function (v) {\n  return v;\n};\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¦æç®­å¤´å½æ°ä¸éè¦åæ°æéè¦å¤ä¸ªåæ°ï¼å°±ä½¿ç¨ä¸ä¸ªåæ¬å·ä»£è¡¨åæ°é¨åã\n\nvar f = () => 5;\n// ç­åäº\nvar f = function () { return 5 };\n\nvar sum = (num1, num2) => num1 + num2;\n// ç­åäº\nvar sum = function(num1, num2) {\n  return num1 + num2;\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦æç®­å¤´å½æ°çä»£ç åé¨åå¤äºä¸æ¡è¯­å¥ï¼å°±è¦ä½¿ç¨å¤§æ¬å·å°å®ä»¬æ¬èµ·æ¥ï¼å¹¶ä¸ä½¿ç¨returnè¯­å¥è¿åã\n\nvar sum = (num1, num2) => { return num1 + num2; }\n\n\n1\n\n\nç±äºå¤§æ¬å·è¢«è§£éä¸ºä»£ç åï¼æä»¥å¦æç®­å¤´å½æ°ç´æ¥è¿åä¸ä¸ªå¯¹è±¡ï¼å¿é¡»å¨å¯¹è±¡å¤é¢å ä¸æ¬å·ï¼å¦åä¼æ¥éã\n\n// æ¥é\nlet getTempItem = id => { id: id, name: \"Temp\" };\n\n// ä¸æ¥é\nlet getTempItem = id => ({ id: id, name: \"Temp\" });\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢æ¯ä¸ç§ç¹æ®æåµï¼è½ç¶å¯ä»¥è¿è¡ï¼ä½ä¼å¾å°éè¯¯çç»æã\n\nlet foo = () => { a: 1 };\nfoo() // undefined\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼åå§æå¾æ¯è¿åä¸ä¸ªå¯¹è±¡{ a: 1 }ï¼ä½æ¯ç±äºå¼æè®¤ä¸ºå¤§æ¬å·æ¯ä»£ç åï¼æä»¥æ§è¡äºä¸è¡è¯­å¥a: 1ãè¿æ¶ï¼aå¯ä»¥è¢«è§£éä¸ºè¯­å¥çæ ç­¾ï¼å æ­¤å®éæ§è¡çè¯­å¥æ¯1;ï¼ç¶åå½æ°å°±ç»æäºï¼æ²¡æè¿åå¼ã\n\nå¦æç®­å¤´å½æ°åªæä¸è¡è¯­å¥ï¼ä¸ä¸éè¦è¿åå¼ï¼å¯ä»¥éç¨ä¸é¢çåæ³ï¼å°±ä¸ç¨åå¤§æ¬å·äºã\n\nlet fn = () => void doesNotReturn();\n\n\n1\n\n\nç®­å¤´å½æ°å¯ä»¥ä¸åéè§£æç»åä½¿ç¨ã\n\nconst full = ({ first, last }) => first + ' ' + last;\n\n// ç­åäº\nfunction full(person) {\n  return person.first + ' ' + person.last;\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nç®­å¤´å½æ°ä½¿å¾è¡¨è¾¾æ´å ç®æ´ã\n\nconst isEven = n => n % 2 === 0;\nconst square = n => n * n;\n\n\n1\n2\n\n\nä¸é¢ä»£ç åªç¨äºä¸¤è¡ï¼å°±å®ä¹äºä¸¤ä¸ªç®åçå·¥å·å½æ°ãå¦æä¸ç¨ç®­å¤´å½æ°ï¼å¯è½å°±è¦å ç¨å¤è¡ï¼èä¸è¿ä¸å¦ç°å¨è¿æ ·åéç®ã\n\nç®­å¤´å½æ°çä¸ä¸ªç¨å¤æ¯ç®ååè°å½æ°ã\n\n// æ­£å¸¸å½æ°åæ³\n[1,2,3].map(function (x) {\n  return x * x;\n});\n\n// ç®­å¤´å½æ°åæ³\n[1,2,3].map(x => x * x);\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦ä¸ä¸ªä¾å­æ¯\n\n// æ­£å¸¸å½æ°åæ³\nvar result = values.sort(function (a, b) {\n  return a - b;\n});\n\n// ç®­å¤´å½æ°åæ³\nvar result = values.sort((a, b) => a - b);\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢æ¯ rest åæ°ä¸ç®­å¤´å½æ°ç»åçä¾å­ã\n\nconst numbers = (...nums) => nums;\n\nnumbers(1, 2, 3, 4, 5)\n// [1,2,3,4,5]\n\nconst headAndTail = (head, ...tail) => [head, tail];\n\nheadAndTail(1, 2, 3, 4, 5)\n// [1,[2,3,4,5]]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# ä½¿ç¨æ³¨æç¹\n\nç®­å¤´å½æ°æå ä¸ªä½¿ç¨æ³¨æç¹ã\n\nï¼1ï¼å½æ°ä½åç**thiså¯¹è±¡**ï¼å°±æ¯å®ä¹æ¶æå¨çå¯¹è±¡ï¼èä¸æ¯ä½¿ç¨æ¶æå¨çå¯¹è±¡ã\n\nï¼2ï¼ä¸å¯ä»¥å½ä½æé å½æ°ï¼ä¹å°±æ¯è¯´ï¼ä¸å¯ä»¥ä½¿ç¨newå½ä»¤ï¼å¦åä¼æåºä¸ä¸ªéè¯¯ã\n\nï¼3ï¼ä¸å¯ä»¥ä½¿ç¨argumentså¯¹è±¡ï¼è¯¥å¯¹è±¡å¨å½æ°ä½åä¸å­å¨ãå¦æè¦ç¨ï¼å¯ä»¥ç¨ rest åæ°ä»£æ¿ã\n\nï¼4ï¼ä¸å¯ä»¥ä½¿ç¨yieldå½ä»¤ï¼å æ­¤ç®­å¤´å½æ°ä¸è½ç¨ä½ Generator å½æ°ã\n\nä¸é¢åç¹ä¸­ï¼ç¬¬ä¸ç¹å°¤å¶å¼å¾æ³¨æãthiså¯¹è±¡çæåæ¯å¯åçï¼ä½æ¯å¨ç®­å¤´å½æ°ä¸­ï¼å®æ¯åºå®çã\n\nfunction foo() {\n  setTimeout(() => {\n    console.log('id:', this.id);\n  }, 100);\n}\n\nvar id = 21;\n\nfoo.call({ id: 42 });\n// id: 42\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼setTimeoutçåæ°æ¯ä¸ä¸ªç®­å¤´å½æ°ï¼è¿ä¸ªç®­å¤´å½æ°çå®ä¹çææ¯å¨fooå½æ°çææ¶ï¼èå®ççæ­£æ§è¡è¦ç­å° 100 æ¯«ç§åãå¦ææ¯æ®éå½æ°ï¼æ§è¡æ¶thisåºè¯¥æåå¨å±å¯¹è±¡windowï¼è¿æ¶åºè¯¥è¾åº21ãä½æ¯ï¼ç®­å¤´å½æ°å¯¼è´thisæ»æ¯æåå½æ°å®ä¹çææ¶æå¨çå¯¹è±¡ï¼æ¬ä¾æ¯{id: 42}ï¼ï¼æä»¥è¾åºçæ¯42ã\n\nç®­å¤´å½æ°å¯ä»¥è®©setTimeoutéé¢çthisï¼ç»å®å®ä¹æ¶æå¨çä½ç¨åï¼èä¸æ¯æåè¿è¡æ¶æå¨çä½ç¨åãä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nfunction Timer() {\n  this.s1 = 0;\n  this.s2 = 0;\n  // ç®­å¤´å½æ°\n  setInterval(() => this.s1++, 1000);\n  // æ®éå½æ°\n  setInterval(function () {\n    this.s2++;\n  }, 1000);\n}\n\nvar timer = new Timer();\n\nsetTimeout(() => console.log('s1: ', timer.s1), 3100);\nsetTimeout(() => console.log('s2: ', timer.s2), 3100);\n// s1: 3\n// s2: 0\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼Timerå½æ°åé¨è®¾ç½®äºä¸¤ä¸ªå®æ¶å¨ï¼åå«ä½¿ç¨äºç®­å¤´å½æ°åæ®éå½æ°ãåèçthisç»å®å®ä¹æ¶æå¨çä½ç¨åï¼å³Timerå½æ°ï¼ï¼åèçthisæåè¿è¡æ¶æå¨çä½ç¨åï¼å³å¨å±å¯¹è±¡ï¼ãæä»¥ï¼3100 æ¯«ç§ä¹åï¼timer.s1è¢«æ´æ°äº 3 æ¬¡ï¼ètimer.s2ä¸æ¬¡é½æ²¡æ´æ°ã\n\nç®­å¤´å½æ°å¯ä»¥è®©thisæååºå®åï¼è¿ç§ç¹æ§å¾æå©äºå°è£åè°å½æ°ãä¸é¢æ¯ä¸ä¸ªä¾å­ï¼DOM äºä»¶çåè°å½æ°å°è£å¨ä¸ä¸ªå¯¹è±¡éé¢ã\n\nvar handler = {\n  id: '123456',\n\n  init: function() { // æ³¨æè¿éä¸æ¯ä½¿ç¨ç®­å¤´å½æ°ï¼å¦è¿éä½¿ç¨ç®­å¤´å½æ°å°æ¶thisæåå¨å±å¯¹è±¡\n    document.addEventListener('click',\n      event => this.doSomething(event.type), false);\n  },\n\n  doSomething: function(type) {\n    console.log('Handling ' + type  + ' for ' + this.id);\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç çinitæ¹æ³ä¸­ï¼ä½¿ç¨äºç®­å¤´å½æ°ï¼è¿å¯¼è´è¿ä¸ªç®­å¤´å½æ°éé¢çthisï¼æ»æ¯æåhandlerå¯¹è±¡ãå¦åï¼åè°å½æ°è¿è¡æ¶ï¼this.doSomethingè¿ä¸è¡ä¼æ¥éï¼å ä¸ºæ­¤æ¶thisæådocumentå¯¹è±¡ã\n\nthisæåçåºå®åï¼å¹¶ä¸æ¯å ä¸ºç®­å¤´å½æ°åé¨æç»å®thisçæºå¶ï¼å®éåå æ¯ç®­å¤´å½æ°æ ¹æ¬æ²¡æèªå·±çthisï¼å¯¼è´åé¨çthiså°±æ¯å¤å±ä»£ç åçthisãæ­£æ¯å ä¸ºå®æ²¡æthisï¼æä»¥ä¹å°±ä¸è½ç¨ä½æé å½æ°ã\n\næä»¥ï¼ç®­å¤´å½æ°è½¬æ ES5 çä»£ç å¦ä¸ã\n\n// ES6\nfunction foo() {\n  setTimeout(() => {\n    console.log('id:', this.id);\n  }, 100);\n}\n\n// ES5\nfunction foo() {\n  var _this = this;\n\n  setTimeout(function () {\n    console.log('id:', _this.id);\n  }, 100);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼è½¬æ¢åç ES5 çæ¬æ¸æ¥å°è¯´æäºï¼ç®­å¤´å½æ°éé¢æ ¹æ¬æ²¡æèªå·±çthisï¼èæ¯å¼ç¨å¤å±çthisã\n\nè¯·é®ä¸é¢çä»£ç ä¹ä¸­æå ä¸ªthisï¼\n\nfunction foo() {\n  return () => {\n    return () => {\n      return () => {\n        console.log('id:', this.id);\n      };\n    };\n  };\n}\n\nvar f = foo.call({id: 1});\n\nvar t1 = f.call({id: 2})()(); // id: 1\nvar t2 = f().call({id: 3})(); // id: 1\nvar t3 = f()().call({id: 4}); // id: 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¹ä¸­ï¼åªæä¸ä¸ªthisï¼å°±æ¯å½æ°fooçthisï¼æä»¥t1ãt2ãt3é½è¾åºåæ ·çç»æãå ä¸ºææçåå±å½æ°é½æ¯ç®­å¤´å½æ°ï¼é½æ²¡æèªå·±çthisï¼å®ä»¬çthiså¶å®é½æ¯æå¤å±fooå½æ°çthisã\n\né¤äºthisï¼ä»¥ä¸ä¸ä¸ªåéå¨ç®­å¤´å½æ°ä¹ä¸­ä¹æ¯ä¸å­å¨çï¼æåå¤å±å½æ°çå¯¹åºåéï¼argumentsãsuperãnew.targetã\n\nfunction foo() {\n  setTimeout(() => {\n    console.log('args:', arguments);\n  }, 100);\n}\n\nfoo(2, 4, 6, 8)\n// args: [2, 4, 6, 8]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼ç®­å¤´å½æ°åé¨çåéargumentsï¼å¶å®æ¯å½æ°fooçargumentsåéã\n\nå¦å¤ï¼ç±äºç®­å¤´å½æ°æ²¡æèªå·±çthisï¼æä»¥å½ç¶ä¹å°±ä¸è½ç¨call()ãapply()ãbind()è¿äºæ¹æ³å»æ¹åthisçæåã\n\n(function() {\n  return [\n    (() => this.x).bind({ x: 'inner' })()\n  ];\n}).call({ x: 'outer' });\n// ['outer']\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼ç®­å¤´å½æ°æ²¡æèªå·±çthisï¼æä»¥bindæ¹æ³æ æï¼åé¨çthisæåå¤é¨çthisã\n\né¿æä»¥æ¥ï¼JavaScript è¯­è¨çthiså¯¹è±¡ä¸ç´æ¯ä¸ä¸ªä»¤äººå¤´ççé®é¢ï¼å¨å¯¹è±¡æ¹æ³ä¸­ä½¿ç¨thisï¼å¿é¡»éå¸¸å°å¿ãç®­å¤´å½æ°âç»å®âthisï¼å¾å¤§ç¨åº¦ä¸è§£å³äºè¿ä¸ªå°æ°ã\n\n\n# ä¸éç¨åºå\n\nç±äºç®­å¤´å½æ°ä½¿å¾thisä»âå¨æâåæâéæâï¼ä¸é¢ä¸¤ä¸ªåºåä¸åºè¯¥ä½¿ç¨ç®­å¤´å½æ°ã\n\nç¬¬ä¸ä¸ªåºåæ¯å®ä¹å¯¹è±¡çæ¹æ³ï¼ä¸è¯¥æ¹æ³åé¨åæ¬thisã\n\nconst cat = {\n  lives: 9,\n  jumps: () => {\n    this.lives--;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼cat.jumps()æ¹æ³æ¯ä¸ä¸ªç®­å¤´å½æ°ï¼è¿æ¯éè¯¯çãè°ç¨cat.jumps()æ¶ï¼å¦ææ¯æ®éå½æ°ï¼è¯¥æ¹æ³åé¨çthisæåcatï¼å¦æåæä¸é¢é£æ ·çç®­å¤´å½æ°ï¼ä½¿å¾thisæåå¨å±å¯¹è±¡ï¼å æ­¤ä¸ä¼å¾å°é¢æç»æãè¿æ¯å ä¸ºå¯¹è±¡ä¸ææåç¬çä½ç¨åï¼å¯¼è´jumpsç®­å¤´å½æ°å®ä¹æ¶çä½ç¨åå°±æ¯å¨å±ä½ç¨åã\n\nç¬¬äºä¸ªåºåæ¯éè¦å¨æthisçæ¶åï¼ä¹ä¸åºä½¿ç¨ç®­å¤´å½æ°ã\n\nvar button = document.getElementById('press');\nbutton.addEventListener('click', () => {\n  this.classList.toggle('on');\n});\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç è¿è¡æ¶ï¼ç¹å»æé®ä¼æ¥éï¼å ä¸ºbuttonççå¬å½æ°æ¯ä¸ä¸ªç®­å¤´å½æ°ï¼å¯¼è´éé¢çthiså°±æ¯å¨å±å¯¹è±¡ãå¦ææ¹ææ®éå½æ°ï¼thiså°±ä¼å¨ææåè¢«ç¹å»çæé®å¯¹è±¡ã\n\nå¦å¤ï¼å¦æå½æ°ä½å¾å¤æï¼æè®¸å¤è¡ï¼æèå½æ°åé¨æå¤§éçè¯»åæä½ï¼ä¸åçº¯æ¯ä¸ºäºè®¡ç®å¼ï¼è¿æ¶ä¹ä¸åºè¯¥ä½¿ç¨ç®­å¤´å½æ°ï¼èæ¯è¦ä½¿ç¨æ®éå½æ°ï¼è¿æ ·å¯ä»¥æé«ä»£ç å¯è¯»æ§ã\n\n\n# åµå¥çç®­å¤´å½æ°\n\nç®­å¤´å½æ°åé¨ï¼è¿å¯ä»¥åä½¿ç¨ç®­å¤´å½æ°ãä¸é¢æ¯ä¸ä¸ª ES5 è¯­æ³çå¤éåµå¥å½æ°ã\n\nfunction insert(value) {\n  return {into: function (array) {\n    return {after: function (afterValue) {\n      array.splice(array.indexOf(afterValue) + 1, 0, value);\n      return array;\n    }};\n  }};\n}\n\ninsert(2).into([1, 3]).after(1); //[1, 2, 3]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢è¿ä¸ªå½æ°ï¼å¯ä»¥ä½¿ç¨ç®­å¤´å½æ°æ¹åã\n\nlet insert = (value) => ({into: (array) => ({after: (afterValue) => {\n  array.splice(array.indexOf(afterValue) + 1, 0, value);\n  return array;\n}})});\n\ninsert(2).into([1, 3]).after(1); //[1, 2, 3]\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢æ¯ä¸ä¸ªé¨ç½²ç®¡éæºå¶ï¼pipelineï¼çä¾å­ï¼å³åä¸ä¸ªå½æ°çè¾åºæ¯åä¸ä¸ªå½æ°çè¾å¥ã\n\nconst pipeline = (...funcs) =>\n  val => funcs.reduce((a, b) => b(a), val);\n\nconst plus1 = a => a + 1;\nconst mult2 = a => a * 2;\nconst addThenMult = pipeline(plus1, mult2);\n\naddThenMult(5)\n// 12\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦æè§å¾ä¸é¢çåæ³å¯è¯»æ§æ¯è¾å·®ï¼ä¹å¯ä»¥éç¨ä¸é¢çåæ³ã\n\nconst plus1 = a => a + 1;\nconst mult2 = a => a * 2;\n\nmult2(plus1(5))\n// 12\n\n\n1\n2\n3\n4\n5\n\n\nç®­å¤´å½æ°è¿æä¸ä¸ªåè½ï¼å°±æ¯å¯ä»¥å¾æ¹ä¾¿å°æ¹å Î» æ¼ç®ã\n\n// Î»æ¼ç®çåæ³\nfix = Î»f.(Î»x.f(Î»v.x(x)(v)))(Î»x.f(Î»v.x(x)(v)))\n\n// ES6çåæ³\nvar fix = f => (x => f(v => x(x)(v)))\n               (x => f(v => x(x)(v)));\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä¸¤ç§åæ³ï¼å ä¹æ¯ä¸ä¸å¯¹åºçãç±äº Î» æ¼ç®å¯¹äºè®¡ç®æºç§å­¦éå¸¸éè¦ï¼è¿ä½¿å¾æä»¬å¯ä»¥ç¨ ES6 ä½ä¸ºæ¿ä»£å·¥å·ï¼æ¢ç´¢è®¡ç®æºç§å­¦ã\n\n\n# å°¾è°ç¨ä¼å\n\n\n# ä»ä¹æ¯å°¾è°ç¨ï¼\n\nå°¾è°ç¨ï¼Tail Callï¼æ¯å½æ°å¼ç¼ç¨çä¸ä¸ªéè¦æ¦å¿µï¼æ¬èº«éå¸¸ç®åï¼ä¸å¥è¯å°±è½è¯´æ¸æ¥ï¼å°±æ¯ææä¸ªå½æ°çæåä¸æ­¥æ¯è°ç¨å¦ä¸ä¸ªå½æ°ã\n\nfunction f(x){\n  return g(x);\n}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fçæåä¸æ­¥æ¯è°ç¨å½æ°gï¼è¿å°±å«å°¾è°ç¨ã\n\nä»¥ä¸ä¸ç§æåµï¼é½ä¸å±äºå°¾è°ç¨ã\n\n// æåµä¸\nfunction f(x){\n  let y = g(x);\n  return y;\n}\n\n// æåµäº\nfunction f(x){\n  return g(x) + 1;\n}\n\n// æåµä¸\nfunction f(x){\n  g(x);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼æåµä¸æ¯è°ç¨å½æ°gä¹åï¼è¿æèµå¼æä½ï¼æä»¥ä¸å±äºå°¾è°ç¨ï¼å³ä½¿è¯­ä¹å®å¨ä¸æ ·ãæåµäºä¹å±äºè°ç¨åè¿ææä½ï¼å³ä½¿åå¨ä¸è¡åãæåµä¸ç­åäºä¸é¢çä»£ç ã\n\nfunction f(x){\n  g(x);\n  return undefined;\n}\n\n\n1\n2\n3\n4\n\n\nå°¾è°ç¨ä¸ä¸å®åºç°å¨å½æ°å°¾é¨ï¼åªè¦æ¯æåä¸æ­¥æä½å³å¯ã\n\nfunction f(x) {\n  if (x > 0) {\n    return m(x)\n  }\n  return n(x);\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°måné½å±äºå°¾è°ç¨ï¼å ä¸ºå®ä»¬é½æ¯å½æ°fçæåä¸æ­¥æä½ã\n\n\n# å°¾è°ç¨ä¼å\n\nå°¾è°ç¨ä¹æä»¥ä¸å¶ä»è°ç¨ä¸åï¼å°±å¨äºå®çç¹æ®çè°ç¨ä½ç½®ã\n\næä»¬ç¥éï¼å½æ°è°ç¨ä¼å¨åå­å½¢æä¸ä¸ªâè°ç¨è®°å½âï¼åç§°âè°ç¨å¸§âï¼call frameï¼ï¼ä¿å­è°ç¨ä½ç½®ååé¨åéç­ä¿¡æ¯ãå¦æå¨å½æ°Açåé¨è°ç¨å½æ°Bï¼é£ä¹å¨Açè°ç¨å¸§ä¸æ¹ï¼è¿ä¼å½¢æä¸ä¸ªBçè°ç¨å¸§ãç­å°Bè¿è¡ç»æï¼å°ç»æè¿åå°Aï¼Bçè°ç¨å¸§æä¼æ¶å¤±ãå¦æå½æ°Båé¨è¿è°ç¨å½æ°Cï¼é£å°±è¿æä¸ä¸ªCçè°ç¨å¸§ï¼ä»¥æ­¤ç±»æ¨ãææçè°ç¨å¸§ï¼å°±å½¢æä¸ä¸ªâè°ç¨æ âï¼call stackï¼ã\n\nå°¾è°ç¨ç±äºæ¯å½æ°çæåä¸æ­¥æä½ï¼æä»¥ä¸éè¦ä¿çå¤å±å½æ°çè°ç¨å¸§ï¼å ä¸ºè°ç¨ä½ç½®ãåé¨åéç­ä¿¡æ¯é½ä¸ä¼åç¨å°äºï¼åªè¦ç´æ¥ç¨åå±å½æ°çè°ç¨å¸§ï¼åä»£å¤å±å½æ°çè°ç¨å¸§å°±å¯ä»¥äºã\n\nfunction f() {\n  let m = 1;\n  let n = 2;\n  return g(m + n);\n}\nf();\n\n// ç­åäº\nfunction f() {\n  return g(3);\n}\nf();\n\n// ç­åäº\ng(3);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æå½æ°gä¸æ¯å°¾è°ç¨ï¼å½æ°få°±éè¦ä¿å­åé¨åémånçå¼ãgçè°ç¨ä½ç½®ç­ä¿¡æ¯ãä½ç±äºè°ç¨gä¹åï¼å½æ°få°±ç»æäºï¼æä»¥æ§è¡å°æåä¸æ­¥ï¼å®å¨å¯ä»¥å é¤f(x)çè°ç¨å¸§ï¼åªä¿çg(3)çè°ç¨å¸§ã\n\nè¿å°±å«åâå°¾è°ç¨ä¼åâï¼Tail call optimizationï¼ï¼å³åªä¿çåå±å½æ°çè°ç¨å¸§ãå¦æææå½æ°é½æ¯å°¾è°ç¨ï¼é£ä¹å®å¨å¯ä»¥åå°æ¯æ¬¡æ§è¡æ¶ï¼è°ç¨å¸§åªæä¸é¡¹ï¼è¿å°å¤§å¤§èçåå­ãè¿å°±æ¯âå°¾è°ç¨ä¼åâçæä¹ã\n\næ³¨æï¼åªæä¸åç¨å°å¤å±å½æ°çåé¨åéï¼åå±å½æ°çè°ç¨å¸§æä¼åä»£å¤å±å½æ°çè°ç¨å¸§ï¼å¦åå°±æ æ³è¿è¡âå°¾è°ç¨ä¼åâã\n\nfunction addOne(a){\n  var one = 1;\n  function inner(b){\n    return b + one;\n  }\n  return inner(a);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢çå½æ°ä¸ä¼è¿è¡å°¾è°ç¨ä¼åï¼å ä¸ºåå±å½æ°innerç¨å°äºå¤å±å½æ°addOneçåé¨åéoneã\n\næ³¨æï¼ç®ååªæ Safari æµè§å¨æ¯æå°¾è°ç¨ä¼åï¼Chrome å Firefox é½ä¸æ¯æã\n\n\n# å°¾éå½\n\nå½æ°è°ç¨èªèº«ï¼ç§°ä¸ºéå½ãå¦æå°¾è°ç¨èªèº«ï¼å°±ç§°ä¸ºå°¾éå½ã\n\néå½éå¸¸èè´¹åå­ï¼å ä¸ºéè¦åæ¶ä¿å­æåä¸ç¾ä¸ªè°ç¨å¸§ï¼å¾å®¹æåçâæ æº¢åºâéè¯¯ï¼stack overflowï¼ãä½å¯¹äºå°¾éå½æ¥è¯´ï¼ç±äºåªå­å¨ä¸ä¸ªè°ç¨å¸§ï¼æä»¥æ°¸è¿ä¸ä¼åçâæ æº¢åºâéè¯¯ã\n\nfunction factorial(n) {\n  if (n === 1) return 1;\n  return n * factorial(n - 1);\n}\n\nfactorial(5) // 120\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç æ¯ä¸ä¸ªé¶ä¹å½æ°ï¼è®¡ç®nçé¶ä¹ï¼æå¤éè¦ä¿å­nä¸ªè°ç¨è®°å½ï¼å¤æåº¦ O(n) ã\n\nå¦ææ¹åæå°¾éå½ï¼åªä¿çä¸ä¸ªè°ç¨è®°å½ï¼å¤æåº¦ O(1) ã\n\nfunction factorial(n, total) {\n  if (n === 1) return total;\n  return factorial(n - 1, n * total);\n}\n\nfactorial(5, 1) // 120\n\n\n1\n2\n3\n4\n5\n6\n\n\nè¿æä¸ä¸ªæ¯è¾èåçä¾å­ï¼å°±æ¯è®¡ç® Fibonacci æ°åï¼ä¹è½ååè¯´æå°¾éå½ä¼åçéè¦æ§ã\n\néå°¾éå½ç Fibonacci æ°åå®ç°å¦ä¸ã\n\nfunction Fibonacci (n) {\n  if ( n <= 1 ) {return 1};\n\n  return Fibonacci(n - 1) + Fibonacci(n - 2);\n}\n\nFibonacci(10) // 89\nFibonacci(100) // è¶æ¶\nFibonacci(500) // è¶æ¶\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå°¾éå½ä¼åè¿ç Fibonacci æ°åå®ç°å¦ä¸ã\n\nfunction Fibonacci2 (n , ac1 = 1 , ac2 = 1) {\n  if( n <= 1 ) {return ac2};\n\n  return Fibonacci2 (n - 1, ac2, ac1 + ac2);\n}\n\nFibonacci2(100) // 573147844013817200000\nFibonacci2(1000) // 7.0330367711422765e+208\nFibonacci2(10000) // Infinity\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nç±æ­¤å¯è§ï¼âå°¾è°ç¨ä¼åâå¯¹éå½æä½æä¹éå¤§ï¼æä»¥ä¸äºå½æ°å¼ç¼ç¨è¯­è¨å°å¶åå¥äºè¯­è¨è§æ ¼ãES6 äº¦æ¯å¦æ­¤ï¼ç¬¬ä¸æ¬¡æç¡®è§å®ï¼ææ ECMAScript çå®ç°ï¼é½å¿é¡»é¨ç½²âå°¾è°ç¨ä¼åâãè¿å°±æ¯è¯´ï¼ES6 ä¸­åªè¦ä½¿ç¨å°¾éå½ï¼å°±ä¸ä¼åçæ æº¢åºï¼æèå±å±éå½é æçè¶æ¶ï¼ï¼ç¸å¯¹èçåå­ã\n\n\n# éå½å½æ°çæ¹å\n\nå°¾éå½çå®ç°ï¼å¾å¾éè¦æ¹åéå½å½æ°ï¼ç¡®ä¿æåä¸æ­¥åªè°ç¨èªèº«ãåå°è¿ä¸ç¹çæ¹æ³ï¼å°±æ¯æææç¨å°çåé¨åéæ¹åæå½æ°çåæ°ãæ¯å¦ä¸é¢çä¾å­ï¼é¶ä¹å½æ° factorial éè¦ç¨å°ä¸ä¸ªä¸­é´åétotalï¼é£å°±æè¿ä¸ªä¸­é´åéæ¹åæå½æ°çåæ°ãè¿æ ·åçç¼ºç¹å°±æ¯ä¸å¤ªç´è§ï¼ç¬¬ä¸ç¼å¾é¾çåºæ¥ï¼ä¸ºä»ä¹è®¡ç®5çé¶ä¹ï¼éè¦ä¼ å¥ä¸¤ä¸ªåæ°5å1ï¼\n\nä¸¤ä¸ªæ¹æ³å¯ä»¥è§£å³è¿ä¸ªé®é¢ãæ¹æ³ä¸æ¯å¨å°¾éå½å½æ°ä¹å¤ï¼åæä¾ä¸ä¸ªæ­£å¸¸å½¢å¼çå½æ°ã\n\nfunction tailFactorial(n, total) {\n  if (n === 1) return total;\n  return tailFactorial(n - 1, n * total);\n}\n\nfunction factorial(n) {\n  return tailFactorial(n, 1);\n}\n\nfactorial(5) // 120\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç éè¿ä¸ä¸ªæ­£å¸¸å½¢å¼çé¶ä¹å½æ°factorialï¼è°ç¨å°¾éå½å½æ°tailFactorialï¼çèµ·æ¥å°±æ­£å¸¸å¤äºã\n\nå½æ°å¼ç¼ç¨æä¸ä¸ªæ¦å¿µï¼å«åæ¯éåï¼curryingï¼ï¼æææ¯å°å¤åæ°çå½æ°è½¬æ¢æååæ°çå½¢å¼ãè¿éä¹å¯ä»¥ä½¿ç¨æ¯éåã\n\nfunction currying(fn, n) {\n  return function (m) {\n    return fn.call(this, m, n);\n  };\n}\n\nfunction tailFactorial(n, total) {\n  if (n === 1) return total;\n  return tailFactorial(n - 1, n * total);\n}\n\nconst factorial = currying(tailFactorial, 1);\n\nfactorial(5) // 120\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç éè¿æ¯éåï¼å°å°¾éå½å½æ°tailFactorialåä¸ºåªæ¥åä¸ä¸ªåæ°çfactorialã\n\nç¬¬äºç§æ¹æ³å°±ç®åå¤äºï¼å°±æ¯éç¨ ES6 çå½æ°é»è®¤å¼ã\n\nfunction factorial(n, total = 1) {\n  if (n === 1) return total;\n  return factorial(n - 1, n * total);\n}\n\nfactorial(5) // 120\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°totalæé»è®¤å¼1ï¼æä»¥è°ç¨æ¶ä¸ç¨æä¾è¿ä¸ªå¼ã\n\næ»ç»ä¸ä¸ï¼éå½æ¬è´¨ä¸æ¯ä¸ç§å¾ªç¯æä½ãçº¯ç²¹çå½æ°å¼ç¼ç¨è¯­è¨æ²¡æå¾ªç¯æä½å½ä»¤ï¼ææçå¾ªç¯é½ç¨éå½å®ç°ï¼è¿å°±æ¯ä¸ºä»ä¹å°¾éå½å¯¹è¿äºè¯­è¨æå¶éè¦ãå¯¹äºå¶ä»æ¯æâå°¾è°ç¨ä¼åâçè¯­è¨ï¼æ¯å¦ Luaï¼ES6ï¼ï¼åªéè¦ç¥éå¾ªç¯å¯ä»¥ç¨éå½ä»£æ¿ï¼èä¸æ¦ä½¿ç¨éå½ï¼å°±æå¥½ä½¿ç¨å°¾éå½ã\n\n\n# ä¸¥æ ¼æ¨¡å¼\n\nES6 çå°¾è°ç¨ä¼ååªå¨ä¸¥æ ¼æ¨¡å¼ä¸å¼å¯ï¼æ­£å¸¸æ¨¡å¼æ¯æ æçã\n\nè¿æ¯å ä¸ºå¨æ­£å¸¸æ¨¡å¼ä¸ï¼å½æ°åé¨æä¸¤ä¸ªåéï¼å¯ä»¥è·è¸ªå½æ°çè°ç¨æ ã\n\n * func.argumentsï¼è¿åè°ç¨æ¶å½æ°çåæ°ã\n * func.callerï¼è¿åè°ç¨å½åå½æ°çé£ä¸ªå½æ°ã\n\nå°¾è°ç¨ä¼ååçæ¶ï¼å½æ°çè°ç¨æ ä¼æ¹åï¼å æ­¤ä¸é¢ä¸¤ä¸ªåéå°±ä¼å¤±çãä¸¥æ ¼æ¨¡å¼ç¦ç¨è¿ä¸¤ä¸ªåéï¼æä»¥å°¾è°ç¨æ¨¡å¼ä»å¨ä¸¥æ ¼æ¨¡å¼ä¸çæã\n\nfunction restricted() {\n  'use strict';\n  restricted.caller;    // æ¥é\n  restricted.arguments; // æ¥é\n}\nrestricted();\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# å°¾éå½ä¼åçå®ç°\n\nå°¾éå½ä¼ååªå¨ä¸¥æ ¼æ¨¡å¼ä¸çæï¼é£ä¹æ­£å¸¸æ¨¡å¼ä¸ï¼æèé£äºä¸æ¯æè¯¥åè½çç¯å¢ä¸­ï¼ææ²¡æåæ³ä¹ä½¿ç¨å°¾éå½ä¼åå¢ï¼åç­æ¯å¯ä»¥çï¼å°±æ¯èªå·±å®ç°å°¾éå½ä¼åã\n\nå®çåçéå¸¸ç®åãå°¾éå½ä¹æä»¥éè¦ä¼åï¼åå æ¯è°ç¨æ å¤ªå¤ï¼é ææº¢åºï¼é£ä¹åªè¦åå°è°ç¨æ ï¼å°±ä¸ä¼æº¢åºãæä¹åå¯ä»¥åå°è°ç¨æ å¢ï¼å°±æ¯éç¨âå¾ªç¯âæ¢æâéå½âã\n\nä¸é¢æ¯ä¸ä¸ªæ­£å¸¸çéå½å½æ°ã\n\nfunction sum(x, y) {\n  if (y > 0) {\n    return sum(x + 1, y - 1);\n  } else {\n    return x;\n  }\n}\n\nsum(1, 100000)\n// Uncaught RangeError: Maximum call stack size exceeded(â¦)\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼sumæ¯ä¸ä¸ªéå½å½æ°ï¼åæ°xæ¯éè¦ç´¯å çå¼ï¼åæ°yæ§å¶éå½æ¬¡æ°ãä¸æ¦æå®suméå½ 100000 æ¬¡ï¼å°±ä¼æ¥éï¼æç¤ºè¶åºè°ç¨æ çæå¤§æ¬¡æ°ã\n\nè¹¦åºå½æ°ï¼trampolineï¼å¯ä»¥å°éå½æ§è¡è½¬ä¸ºå¾ªç¯æ§è¡ã\n\nfunction trampoline(f) {\n  while (f && f instanceof Function) {\n    f = f();\n  }\n  return f;\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢å°±æ¯è¹¦åºå½æ°çä¸ä¸ªå®ç°ï¼å®æ¥åä¸ä¸ªå½æ°fä½ä¸ºåæ°ãåªè¦fæ§è¡åè¿åä¸ä¸ªå½æ°ï¼å°±ç»§ç»­æ§è¡ãæ³¨æï¼è¿éæ¯è¿åä¸ä¸ªå½æ°ï¼ç¶åæ§è¡è¯¥å½æ°ï¼èä¸æ¯å½æ°éé¢è°ç¨å½æ°ï¼è¿æ ·å°±é¿åäºéå½æ§è¡ï¼ä»èå°±æ¶é¤äºè°ç¨æ è¿å¤§çé®é¢ã\n\nç¶åï¼è¦åçå°±æ¯å°åæ¥çéå½å½æ°ï¼æ¹åä¸ºæ¯ä¸æ­¥è¿åå¦ä¸ä¸ªå½æ°ã\n\nfunction sum(x, y) {\n  if (y > 0) {\n    return sum.bind(null, x + 1, y - 1);\n  } else {\n    return x;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼sumå½æ°çæ¯æ¬¡æ§è¡ï¼é½ä¼è¿åèªèº«çå¦ä¸ä¸ªçæ¬ã\n\nç°å¨ï¼ä½¿ç¨è¹¦åºå½æ°æ§è¡sumï¼å°±ä¸ä¼åçè°ç¨æ æº¢åºã\n\ntrampoline(sum(1, 100000))\n// 100001\n\n\n1\n2\n\n\nè¹¦åºå½æ°å¹¶ä¸æ¯çæ­£çå°¾éå½ä¼åï¼ä¸é¢çå®ç°ææ¯ã\n\nfunction tco(f) {\n  var value;\n  var active = false;\n  var accumulated = [];\n\n  return function accumulator() {\n    accumulated.push(arguments);\n    if (!active) {\n      active = true;\n      while (accumulated.length) {\n        value = f.apply(this, accumulated.shift());\n      }\n      active = false;\n      return value;\n    }\n  };\n}\n\nvar sum = tco(function(x, y) {\n  if (y > 0) {\n    return sum(x + 1, y - 1)\n  }\n  else {\n    return x\n  }\n});\n\nsum(1, 100000)\n// 100001\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nä¸é¢ä»£ç ä¸­ï¼tcoå½æ°æ¯å°¾éå½ä¼åçå®ç°ï¼å®çå¥¥å¦å°±å¨äºç¶æåéactiveãé»è®¤æåµä¸ï¼è¿ä¸ªåéæ¯ä¸æ¿æ´»çãä¸æ¦è¿å¥å°¾éå½ä¼åçè¿ç¨ï¼è¿ä¸ªåéå°±æ¿æ´»äºãç¶åï¼æ¯ä¸è½®éå½sumè¿åçé½æ¯undefinedï¼æä»¥å°±é¿åäºéå½æ§è¡ï¼èaccumulatedæ°ç»å­æ¾æ¯ä¸è½®sumæ§è¡çåæ°ï¼æ»æ¯æå¼çï¼è¿å°±ä¿è¯äºaccumulatorå½æ°åé¨çwhileå¾ªç¯æ»æ¯ä¼æ§è¡ãè¿æ ·å°±å¾å·§å¦å°å°âéå½âæ¹æäºâå¾ªç¯âï¼èåä¸è½®çåæ°ä¼åä»£åä¸è½®çåæ°ï¼ä¿è¯äºè°ç¨æ åªæä¸å±ã\n\n\n# å½æ°åæ°çå°¾éå·\n\nES2017 åè®¸å½æ°çæåä¸ä¸ªåæ°æå°¾éå·ï¼trailing commaï¼ã\n\næ­¤åï¼å½æ°å®ä¹åè°ç¨æ¶ï¼é½ä¸åè®¸æåä¸ä¸ªåæ°åé¢åºç°éå·ã\n\nfunction clownsEverywhere(\n  param1,\n  param2\n) { /* ... */ }\n\nclownsEverywhere(\n  'foo',\n  'bar'\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æå¨param2æbaråé¢å ä¸ä¸ªéå·ï¼å°±ä¼æ¥éã\n\nå¦æåä¸é¢è¿æ ·ï¼å°åæ°åæå¤è¡ï¼å³æ¯ä¸ªåæ°å æ®ä¸è¡ï¼ï¼ä»¥åä¿®æ¹ä»£ç çæ¶åï¼æ³ä¸ºå½æ°clownsEverywhereæ·»å ç¬¬ä¸ä¸ªåæ°ï¼æèè°æ´åæ°çæ¬¡åºï¼å°±å¿å¿è¦å¨åæ¥æåä¸ä¸ªåæ°åé¢æ·»å ä¸ä¸ªéå·ãè¿å¯¹äºçæ¬ç®¡çç³»ç»æ¥è¯´ï¼å°±ä¼æ¾ç¤ºæ·»å éå·çé£ä¸è¡ä¹åçäºåå¨ãè¿çä¸å»æç¹åä½ï¼å æ­¤æ°çè¯­æ³åè®¸å®ä¹åè°ç¨æ¶ï¼å°¾é¨ç´æ¥æä¸ä¸ªéå·ã\n\nfunction clownsEverywhere(\n  param1,\n  param2,\n) { /* ... */ }\n\nclownsEverywhere(\n  'foo',\n  'bar',\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nè¿æ ·çè§å®ä¹ä½¿å¾ï¼å½æ°åæ°ä¸æ°ç»åå¯¹è±¡çå°¾éå·è§åï¼ä¿æä¸è´äºã\n\n\n# Function.prototype.toString()\n\nES2019 å¯¹å½æ°å®ä¾çtoString()æ¹æ³ååºäºä¿®æ¹ã\n\ntoString()æ¹æ³è¿åå½æ°ä»£ç æ¬èº«ï¼ä»¥åä¼çç¥æ³¨éåç©ºæ ¼ã\n\nfunction /* foo comment */ foo () {}\n\nfoo.toString()\n// function foo() {}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fooçåå§ä»£ç åå«æ³¨éï¼å½æ°åfooååæ¬å·ä¹é´æç©ºæ ¼ï¼ä½æ¯toString()æ¹æ³é½æå®ä»¬çç¥äºã\n\nä¿®æ¹åçtoString()æ¹æ³ï¼æç¡®è¦æ±è¿åä¸æ¨¡ä¸æ ·çåå§ä»£ç ã\n\nfunction /* foo comment */ foo () {}\n\nfoo.toString()\n// \"function /* foo comment */ foo () {}\"\n\n\n1\n2\n3\n4\n\n\n\n# catch å½ä»¤çåæ°çç¥\n\nJavaScript è¯­è¨çtry...catchç»æï¼ä»¥åæç¡®è¦æ±catchå½ä»¤åé¢å¿é¡»è·åæ°ï¼æ¥åtryä»£ç åæåºçéè¯¯å¯¹è±¡ã\n\ntry {\n  // ...\n} catch (err) {\n  // å¤çéè¯¯\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼catchå½ä»¤åé¢å¸¦æåæ°errã\n\nå¾å¤æ¶åï¼catchä»£ç åå¯è½ç¨ä¸å°è¿ä¸ªåæ°ãä½æ¯ï¼ä¸ºäºä¿è¯è¯­æ³æ­£ç¡®ï¼è¿æ¯å¿é¡»åãES2019 ååºäºæ¹åï¼åè®¸catchè¯­å¥çç¥åæ°ã\n\ntry {\n  // ...\n} catch {\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n",normalizedContent:"# å½æ°çæ©å±\n\n\n# å½æ°åæ°çé»è®¤å¼\n\n\n# åºæ¬ç¨æ³\n\nes6 ä¹åï¼ä¸è½ç´æ¥ä¸ºå½æ°çåæ°æå®é»è®¤å¼ï¼åªè½éç¨åéçæ¹æ³ã\n\nfunction log(x, y) {\n  y = y || 'world';\n  console.log(x, y);\n}\n\nlog('hello') // hello world\nlog('hello', 'china') // hello china\nlog('hello', '') // hello world\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç æ£æ¥å½æ°logçåæ°yææ²¡æèµå¼ï¼å¦ææ²¡æï¼åæå®é»è®¤å¼ä¸ºworldãè¿ç§åæ³çç¼ºç¹å¨äºï¼å¦æåæ°yèµå¼äºï¼ä½æ¯å¯¹åºçå¸å°å¼ä¸ºfalseï¼åè¯¥èµå¼ä¸èµ·ä½ç¨ãå°±åä¸é¢ä»£ç çæåä¸è¡ï¼åæ°yç­äºç©ºå­ç¬¦ï¼ç»æè¢«æ¹ä¸ºé»è®¤å¼ã\n\nä¸ºäºé¿åè¿ä¸ªé®é¢ï¼éå¸¸éè¦åå¤æ­ä¸ä¸åæ°yæ¯å¦è¢«èµå¼ï¼å¦ææ²¡æï¼åç­äºé»è®¤å¼ã\n\nif (typeof y === 'undefined') {\n  y = 'world';\n}\n\n\n1\n2\n3\n\n\nes6 åè®¸ä¸ºå½æ°çåæ°è®¾ç½®é»è®¤å¼ï¼å³ç´æ¥åå¨åæ°å®ä¹çåé¢ã\n\nfunction log(x, y = 'world') {\n  console.log(x, y);\n}\n\nlog('hello') // hello world\nlog('hello', 'china') // hello china\nlog('hello', '') // hello\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¯ä»¥çå°ï¼es6 çåæ³æ¯ es5 ç®æ´è®¸å¤ï¼èä¸éå¸¸èªç¶ãä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nfunction point(x = 0, y = 0) {\n  this.x = x;\n  this.y = y;\n}\n\nconst p = new point();\np // { x: 0, y: 0 }\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\né¤äºç®æ´ï¼es6 çåæ³è¿æä¸¤ä¸ªå¥½å¤ï¼é¦åï¼éè¯»ä»£ç çäººï¼å¯ä»¥ç«å»æè¯å°åªäºåæ°æ¯å¯ä»¥çç¥çï¼ä¸ç¨æ¥çå½æ°ä½æææ¡£ï¼å¶æ¬¡ï¼æå©äºå°æ¥çä»£ç ä¼åï¼å³ä½¿æªæ¥ççæ¬å¨å¯¹å¤æ¥å£ä¸­ï¼å½»åºæ¿æè¿ä¸ªåæ°ï¼ä¹ä¸ä¼å¯¼è´ä»¥åçä»£ç æ æ³è¿è¡ã\n\nåæ°åéæ¯é»è®¤å£°æçï¼æä»¥ä¸è½ç¨letæconståæ¬¡å£°æã\n\nfunction foo(x = 5) {\n  let x = 1; // error\n  const x = 2; // error\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°åéxæ¯é»è®¤å£°æçï¼å¨å½æ°ä½ä¸­ï¼ä¸è½ç¨letæconståæ¬¡å£°æï¼å¦åä¼æ¥éã\n\nä½¿ç¨åæ°é»è®¤å¼æ¶ï¼å½æ°ä¸è½æåååæ°ã\n\n// ä¸æ¥é\nfunction foo(x, x, y) {\n  // ...\n}\n\n// æ¥é\nfunction foo(x, x, y = 1) {\n  // ...\n}\n// syntaxerror: duplicate parameter name not allowed in this context\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¦å¤ï¼ä¸ä¸ªå®¹æå¿½ç¥çå°æ¹æ¯ï¼åæ°é»è®¤å¼ä¸æ¯ä¼ å¼çï¼èæ¯æ¯æ¬¡é½éæ°è®¡ç®é»è®¤å¼è¡¨è¾¾å¼çå¼ãä¹å°±æ¯è¯´ï¼åæ°é»è®¤å¼æ¯æ°æ§æ±å¼çã\n\nlet x = 99;\nfunction foo(p = x + 1) {\n  console.log(p);\n}\n\nfoo() // 100\n\nx = 100;\nfoo() // 101\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°pçé»è®¤å¼æ¯x + 1ãè¿æ¶ï¼æ¯æ¬¡è°ç¨å½æ°fooï¼é½ä¼éæ°è®¡ç®x + 1ï¼èä¸æ¯é»è®¤pç­äº 100ã\n\n\n# ä¸è§£æèµå¼é»è®¤å¼ç»åä½¿ç¨\n\nåæ°é»è®¤å¼å¯ä»¥ä¸è§£æèµå¼çé»è®¤å¼ï¼ç»åèµ·æ¥ä½¿ç¨ã\n\nfunction foo({x, y = 5}) {\n  console.log(x, y);\n}\n\nfoo({}) // undefined 5\nfoo({x: 1}) // 1 5\nfoo({x: 1, y: 2}) // 1 2\nfoo() // typeerror: cannot read property 'x' of undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç åªä½¿ç¨äºå¯¹è±¡çè§£æèµå¼é»è®¤å¼ï¼æ²¡æä½¿ç¨å½æ°åæ°çé»è®¤å¼ãåªæå½å½æ°fooçåæ°æ¯ä¸ä¸ªå¯¹è±¡æ¶ï¼åéxåyæä¼éè¿è§£æèµå¼çæãå¦æå½æ°fooè°ç¨æ¶æ²¡æä¾åæ°ï¼åéxåyå°±ä¸ä¼çæï¼ä»èæ¥éãéè¿æä¾å½æ°åæ°çé»è®¤å¼ï¼å°±å¯ä»¥é¿åè¿ç§æåµã\n\nfunction foo({x, y = 5} = {}) {\n  console.log(x, y);\n}\n\nfoo() // undefined 5\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç æå®ï¼å¦ææ²¡ææä¾åæ°ï¼å½æ°fooçåæ°é»è®¤ä¸ºä¸ä¸ªç©ºå¯¹è±¡ã\n\nä¸é¢æ¯å¦ä¸ä¸ªè§£æèµå¼é»è®¤å¼çä¾å­ã\n\nfunction fetch(url, { body = '', method = 'get', headers = {} }) {\n  console.log(method);\n}\n\nfetch('http://example.com', {})\n// \"get\"\n\nfetch('http://example.com')\n// æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æå½æ°fetchçç¬¬äºä¸ªåæ°æ¯ä¸ä¸ªå¯¹è±¡ï¼å°±å¯ä»¥ä¸ºå®çä¸ä¸ªå±æ§è®¾ç½®é»è®¤å¼ãè¿ç§åæ³ä¸è½çç¥ç¬¬äºä¸ªåæ°ï¼å¦æç»åå½æ°åæ°çé»è®¤å¼ï¼å°±å¯ä»¥çç¥ç¬¬äºä¸ªåæ°ãè¿æ¶ï¼å°±åºç°äºåéé»è®¤å¼ã\n\nfunction fetch(url, { body = '', method = 'get', headers = {} } = {}) {\n  console.log(method);\n}\n\nfetch('http://example.com')\n// \"get\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fetchæ²¡æç¬¬äºä¸ªåæ°æ¶ï¼å½æ°åæ°çé»è®¤å¼å°±ä¼çæï¼ç¶åææ¯è§£æèµå¼çé»è®¤å¼çæï¼åémethodæä¼åå°é»è®¤å¼getã\n\nä½ä¸ºç»ä¹ ï¼è¯·é®ä¸é¢ä¸¤ç§åæ³æä»ä¹å·®å«ï¼\n\n// åæ³ä¸\nfunction m1({x = 0, y = 0} = {}) {\n  return [x, y];\n}\n\n// åæ³äº\nfunction m2({x, y} = { x: 0, y: 0 }) {\n  return [x, y];\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä¸¤ç§åæ³é½å¯¹å½æ°çåæ°è®¾å®äºé»è®¤å¼ï¼åºå«æ¯åæ³ä¸å½æ°åæ°çé»è®¤å¼æ¯ç©ºå¯¹è±¡ï¼ä½æ¯è®¾ç½®äºå¯¹è±¡è§£æèµå¼çé»è®¤å¼ï¼åæ³äºå½æ°åæ°çé»è®¤å¼æ¯ä¸ä¸ªæå·ä½å±æ§çå¯¹è±¡ï¼ä½æ¯æ²¡æè®¾ç½®å¯¹è±¡è§£æèµå¼çé»è®¤å¼ã\n\n// å½æ°æ²¡æåæ°çæåµ\nm1() // [0, 0]\nm2() // [0, 0]\n\n// x å y é½æå¼çæåµ\nm1({x: 3, y: 8}) // [3, 8]\nm2({x: 3, y: 8}) // [3, 8]\n\n// x æå¼ï¼y æ å¼çæåµ\nm1({x: 3}) // [3, 0]\nm2({x: 3}) // [3, undefined]\n\n// x å y é½æ å¼çæåµ\nm1({}) // [0, 0];\nm2({}) // [undefined, undefined]\n\nm1({z: 3}) // [0, 0]\nm2({z: 3}) // [undefined, undefined]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n# åæ°é»è®¤å¼çä½ç½®\n\néå¸¸æåµä¸ï¼å®ä¹äºé»è®¤å¼çåæ°ï¼åºè¯¥æ¯å½æ°çå°¾åæ°ãå ä¸ºè¿æ ·æ¯è¾å®¹æçåºæ¥ï¼å°åºçç¥äºåªäºåæ°ãå¦æéå°¾é¨çåæ°è®¾ç½®é»è®¤å¼ï¼å®éä¸è¿ä¸ªåæ°æ¯æ²¡æ³çç¥çã\n\n// ä¾ä¸\nfunction f(x = 1, y) {\n  return [x, y];\n}\n\nf() // [1, undefined]\nf(2) // [2, undefined])\nf(, 1) // æ¥é\nf(undefined, 1) // [1, 1]\n\n// ä¾äº\nfunction f(x, y = 5, z) {\n  return [x, y, z];\n}\n\nf() // [undefined, 5, undefined]\nf(1) // [1, 5, undefined]\nf(1, ,2) // æ¥é\nf(1, undefined, 2) // [1, 5, 2]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ä¸­ï¼æé»è®¤å¼çåæ°é½ä¸æ¯å°¾åæ°ãè¿æ¶ï¼æ æ³åªçç¥è¯¥åæ°ï¼èä¸çç¥å®åé¢çåæ°ï¼é¤éæ¾å¼è¾å¥undefinedã\n\nå¦æä¼ å¥undefinedï¼å°è§¦åè¯¥åæ°ç­äºé»è®¤å¼ï¼nullåæ²¡æè¿ä¸ªææã\n\nfunction foo(x = 5, y = 6) {\n  console.log(x, y);\n}\n\nfoo(undefined, null)\n// 5 null\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼xåæ°å¯¹åºundefinedï¼ç»æè§¦åäºé»è®¤å¼ï¼yåæ°ç­äºnullï¼å°±æ²¡æè§¦åé»è®¤å¼ã\n\n\n# å½æ°ç length å±æ§\n\næå®äºé»è®¤å¼ä»¥åï¼å½æ°çlengthå±æ§ï¼å°è¿åæ²¡ææå®é»è®¤å¼çåæ°ä¸ªæ°ãä¹å°±æ¯è¯´ï¼æå®äºé»è®¤å¼åï¼lengthå±æ§å°å¤±çã\n\n(function (a) {}).length // 1\n(function (a = 5) {}).length // 0\n(function (a, b, c = 5) {}).length // 2\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼lengthå±æ§çè¿åå¼ï¼ç­äºå½æ°çåæ°ä¸ªæ°åå»æå®äºé»è®¤å¼çåæ°ä¸ªæ°ãæ¯å¦ï¼ä¸é¢æåä¸ä¸ªå½æ°ï¼å®ä¹äº 3 ä¸ªåæ°ï¼å¶ä¸­æä¸ä¸ªåæ°cæå®äºé»è®¤å¼ï¼å æ­¤lengthå±æ§ç­äº3åå»1ï¼æåå¾å°2ã\n\nè¿æ¯å ä¸º**lengthå±æ§çå«ä¹æ¯ï¼è¯¥å½æ°é¢æä¼ å¥çåæ°ä¸ªæ°**ãæä¸ªåæ°æå®é»è®¤å¼ä»¥åï¼é¢æä¼ å¥çåæ°ä¸ªæ°å°±ä¸åæ¬è¿ä¸ªåæ°äºãåçï¼åæç rest åæ°ä¹ä¸ä¼è®¡å¥lengthå±æ§ã\n\n(function(...args) {}).length // 0\n\n\n1\n\n\nå¦æè®¾ç½®äºé»è®¤å¼çåæ°ä¸æ¯å°¾åæ°ï¼é£ä¹lengthå±æ§ä¹ä¸åè®¡å¥åé¢çåæ°äºã\n\n(function (a = 0, b, c) {}).length // 0\n(function (a, b = 1, c) {}).length // 1\n\n\n1\n2\n\n\n\n# ä½ç¨å\n\nä¸æ¦è®¾ç½®äºåæ°çé»è®¤å¼ï¼å½æ°è¿è¡å£°æåå§åæ¶ï¼åæ°ä¼å½¢æä¸ä¸ªåç¬çä½ç¨åï¼contextï¼ãç­å°åå§åç»æï¼è¿ä¸ªä½ç¨åå°±ä¼æ¶å¤±ãè¿ç§è¯­æ³è¡ä¸ºï¼å¨ä¸è®¾ç½®åæ°é»è®¤å¼æ¶ï¼æ¯ä¸ä¼åºç°çã\n\nvar x = 1;\n\nfunction f(x, y = x) {\n  console.log(y);\n}\n\nf(2) // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°yçé»è®¤å¼ç­äºåéxãè°ç¨å½æ°fæ¶ï¼åæ°å½¢æä¸ä¸ªåç¬çä½ç¨åãå¨è¿ä¸ªä½ç¨åéé¢ï¼é»è®¤å¼åéxæåç¬¬ä¸ä¸ªåæ°xï¼èä¸æ¯å¨å±åéxï¼æä»¥è¾åºæ¯2ã\n\nåçä¸é¢çä¾å­ã\n\nlet x = 1;\n\nfunction f(y = x) {\n  let x = 2;\n  console.log(y);\n}\n\nf() // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fè°ç¨æ¶ï¼åæ°y = xå½¢æä¸ä¸ªåç¬çä½ç¨åãè¿ä¸ªä½ç¨åéé¢ï¼åéxæ¬èº«æ²¡æå®ä¹ï¼æä»¥æåå¤å±çå¨å±åéxãå½æ°è°ç¨æ¶ï¼å½æ°ä½åé¨çå±é¨åéxå½±åä¸å°é»è®¤å¼åéxã\n\nå¦ææ­¤æ¶ï¼å¨å±åéxä¸å­å¨ï¼å°±ä¼æ¥éã\n\nfunction f(y = x) {\n  let x = 2;\n  console.log(y);\n}\n\nf() // referenceerror: x is not defined\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢è¿æ ·åï¼ä¹ä¼æ¥éã\n\nvar x = 1;\n\nfunction foo(x = x) {\n  // ...\n}\n\nfoo() // referenceerror: x is not defined\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°x = xå½¢æä¸ä¸ªåç¬ä½ç¨åãå®éæ§è¡çæ¯let x = xï¼ç±äºææ¶æ§æ­»åºçåå ï¼è¿è¡ä»£ç ä¼æ¥éâx æªå®ä¹âã\n\nå¦æåæ°çé»è®¤å¼æ¯ä¸ä¸ªå½æ°ï¼è¯¥å½æ°çä½ç¨åä¹éµå®è¿ä¸ªè§åãè¯·çä¸é¢çä¾å­ã\n\nlet foo = 'outer';\n\nfunction bar(func = () => foo) {\n  let foo = 'inner';\n  console.log(func());\n}\n\nbar(); // outer\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°barçåæ°funcçé»è®¤å¼æ¯ä¸ä¸ªå¿åå½æ°ï¼è¿åå¼ä¸ºåéfooãå½æ°åæ°å½¢æçåç¬ä½ç¨åéé¢ï¼å¹¶æ²¡æå®ä¹åéfooï¼æä»¥fooæåå¤å±çå¨å±åéfooï¼å æ­¤è¾åºouterã\n\nå¦æåæä¸é¢è¿æ ·ï¼å°±ä¼æ¥éã\n\nfunction bar(func = () => foo) {\n  let foo = 'inner';\n  console.log(func());\n}\n\nbar() // referenceerror: foo is not defined\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å¿åå½æ°éé¢çfooæåå½æ°å¤å±ï¼ä½æ¯å½æ°å¤å±å¹¶æ²¡æå£°æåéfooï¼æä»¥å°±æ¥éäºã\n\nä¸é¢æ¯ä¸ä¸ªæ´å¤æçä¾å­ã\n\nvar x = 1;\nfunction foo(x, y = function() { x = 2; }) {\n  var x = 3;\n  y();\n  console.log(x);\n}\n\nfoo() // 3\nx // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fooçåæ°å½¢æä¸ä¸ªåç¬ä½ç¨åãè¿ä¸ªä½ç¨åéé¢ï¼é¦åå£°æäºåéxï¼ç¶åå£°æäºåéyï¼yçé»è®¤å¼æ¯ä¸ä¸ªå¿åå½æ°ãè¿ä¸ªå¿åå½æ°åé¨çåéxï¼æååä¸ä¸ªä½ç¨åçç¬¬ä¸ä¸ªåæ°xãå½æ°fooåé¨åå£°æäºä¸ä¸ªåé¨åéxï¼è¯¥åéä¸ç¬¬ä¸ä¸ªåæ°xç±äºä¸æ¯åä¸ä¸ªä½ç¨åï¼æä»¥ä¸æ¯åä¸ä¸ªåéï¼å æ­¤æ§è¡yåï¼åé¨åéxåå¤é¨å¨å±åéxçå¼é½æ²¡åã\n\nå¦æå°var x = 3çvarå»é¤ï¼å½æ°fooçåé¨åéxå°±æåç¬¬ä¸ä¸ªåæ°xï¼ä¸å¿åå½æ°åé¨çxæ¯ä¸è´çï¼æä»¥æåè¾åºçå°±æ¯2ï¼èå¤å±çå¨å±åéxä¾ç¶ä¸åå½±åã\n\nvar x = 1;\nfunction foo(x, y = function() { x = 2; }) {\n  x = 3;\n  y();\n  console.log(x);\n}\n\nfoo() // 2\nx // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# åºç¨\n\nå©ç¨åæ°é»è®¤å¼ï¼å¯ä»¥æå®æä¸ä¸ªåæ°ä¸å¾çç¥ï¼å¦æçç¥å°±æåºä¸ä¸ªéè¯¯ã\n\nfunction throwifmissing() {\n  throw new error('missing parameter');\n}\n\nfunction foo(mustbeprovided = throwifmissing()) {\n  return mustbeprovided;\n}\n\nfoo()\n// error: missing parameter\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç çfooå½æ°ï¼å¦æè°ç¨çæ¶åæ²¡æåæ°ï¼å°±ä¼è°ç¨é»è®¤å¼throwifmissingå½æ°ï¼ä»èæåºä¸ä¸ªéè¯¯ã\n\nä»ä¸é¢ä»£ç è¿å¯ä»¥çå°ï¼åæ°mustbeprovidedçé»è®¤å¼ç­äºthrowifmissingå½æ°çè¿è¡ç»æï¼æ³¨æå½æ°åthrowifmissingä¹åæä¸å¯¹åæ¬å·ï¼ï¼è¿è¡¨æåæ°çé»è®¤å¼ä¸æ¯å¨å®ä¹æ¶æ§è¡ï¼èæ¯å¨è¿è¡æ¶æ§è¡ãå¦æåæ°å·²ç»èµå¼ï¼é»è®¤å¼ä¸­çå½æ°å°±ä¸ä¼è¿è¡ã\n\nå¦å¤ï¼å¯ä»¥å°åæ°é»è®¤å¼è®¾ä¸ºundefinedï¼è¡¨æè¿ä¸ªåæ°æ¯å¯ä»¥çç¥çã\n\nfunction foo(optional = undefined) { Â·Â·Â· }\n\n\n1\n\n\n\n# rest åæ°\n\nes6 å¼å¥ rest åæ°ï¼å½¢å¼ä¸º...åéåï¼ï¼ç¨äºè·åå½æ°çå¤ä½åæ°ï¼è¿æ ·å°±ä¸éè¦ä½¿ç¨argumentså¯¹è±¡äºãrest åæ°æ­éçåéæ¯ä¸ä¸ªæ°ç»ï¼è¯¥åéå°å¤ä½çåæ°æ¾å¥æ°ç»ä¸­ã\n\nfunction add(...values) { // valuesæ¯ä¸ä¸ªæ°ç»ï¼è¯¥åéå°å¤ä½çåæ°æ¾å¥æ°ç»ä¸­\n  let sum = 0;\n\n  for (var val of values) {\n    sum += val;\n  }\n\n  return sum;\n}\n\nadd(2, 5, 3) // 10\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç çaddå½æ°æ¯ä¸ä¸ªæ±åå½æ°ï¼å©ç¨ rest åæ°ï¼å¯ä»¥åè¯¥å½æ°ä¼ å¥ä»»ææ°ç®çåæ°ã\n\nä¸é¢æ¯ä¸ä¸ª rest åæ°ä»£æ¿argumentsåéçä¾å­ã\n\n// argumentsåéçåæ³\nfunction sortnumbers() {\n  return array.prototype.slice.call(arguments).sort();\n}\n\n// reståæ°çåæ³\nconst sortnumbers = (...numbers) => numbers.sort();\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç çä¸¤ç§åæ³ï¼æ¯è¾åå¯ä»¥åç°ï¼rest åæ°çåæ³æ´èªç¶ä¹æ´ç®æ´ã\n\nargumentså¯¹è±¡ä¸æ¯æ°ç»ï¼èæ¯ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ãæä»¥ä¸ºäºä½¿ç¨æ°ç»çæ¹æ³ï¼å¿é¡»ä½¿ç¨array.prototype.slice.callåå°å¶è½¬ä¸ºæ°ç»ãrest åæ°å°±ä¸å­å¨è¿ä¸ªé®é¢ï¼å®å°±æ¯ä¸ä¸ªçæ­£çæ°ç»ï¼æ°ç»ç¹æçæ¹æ³é½å¯ä»¥ä½¿ç¨ãä¸é¢æ¯ä¸ä¸ªå©ç¨ rest åæ°æ¹åæ°ç»pushæ¹æ³çä¾å­ã\n\nfunction push(array, ...items) {\n  items.foreach(function(item) {\n    array.push(item);\n    console.log(item);\n  });\n}\n\nvar a = [];\npush(a, 1, 2, 3)\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\næ³¨æï¼rest åæ°ä¹åä¸è½åæå¶ä»åæ°ï¼å³åªè½æ¯æåä¸ä¸ªåæ°ï¼ï¼å¦åä¼æ¥éã\n\n// æ¥é\nfunction f(a, ...b, c) {\n  // ...\n}\n\n\n1\n2\n3\n4\n\n\nå½æ°çlengthå±æ§ï¼ä¸åæ¬ rest åæ°ã\n\n(function(a) {}).length  // 1\n(function(...a) {}).length  // 0\n(function(a, ...b) {}).length  // 1\n\n\n1\n2\n3\n\n\n\n# ä¸¥æ ¼æ¨¡å¼\n\nä» es5 å¼å§ï¼å½æ°åé¨å¯ä»¥è®¾å®ä¸ºä¸¥æ ¼æ¨¡å¼ã\n\nfunction dosomething(a, b) {\n  'use strict';\n  // code\n}\n\n\n1\n2\n3\n4\n\n\nes2016 åäºä¸ç¹ä¿®æ¹ï¼è§å®åªè¦å½æ°åæ°ä½¿ç¨äºé»è®¤å¼ãè§£æèµå¼ãæèæ©å±è¿ç®ç¬¦ï¼é£ä¹å½æ°åé¨å°±ä¸è½æ¾å¼è®¾å®ä¸ºä¸¥æ ¼æ¨¡å¼ï¼å¦åä¼æ¥éã\n\n// æ¥é\nfunction dosomething(a, b = a) {\n  'use strict';\n  // code\n}\n\n// æ¥é\nconst dosomething = function ({a, b}) {\n  'use strict';\n  // code\n};\n\n// æ¥é\nconst dosomething = (...a) => {\n  'use strict';\n  // code\n};\n\nconst obj = {\n  // æ¥é\n  dosomething({a, b}) {\n    'use strict';\n    // code\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nè¿æ ·è§å®çåå æ¯ï¼å½æ°åé¨çä¸¥æ ¼æ¨¡å¼ï¼åæ¶éç¨äºå½æ°ä½åå½æ°åæ°ãä½æ¯ï¼å½æ°æ§è¡çæ¶åï¼åæ§è¡å½æ°åæ°ï¼ç¶ååæ§è¡å½æ°ä½ãè¿æ ·å°±æä¸ä¸ªä¸åççå°æ¹ï¼åªæä»å½æ°ä½ä¹ä¸­ï¼æè½ç¥éåæ°æ¯å¦åºè¯¥ä»¥ä¸¥æ ¼æ¨¡å¼æ§è¡ï¼ä½æ¯åæ°å´åºè¯¥åäºå½æ°ä½æ§è¡ã\n\n// æ¥é\nfunction dosomething(value = 070) {\n  'use strict';\n  return value;\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°valueçé»è®¤å¼æ¯å«è¿å¶æ°070ï¼ä½æ¯ä¸¥æ ¼æ¨¡å¼ä¸ä¸è½ç¨åç¼0è¡¨ç¤ºå«è¿å¶ï¼æä»¥åºè¯¥æ¥éãä½æ¯å®éä¸ï¼javascript å¼æä¼åæåæ§è¡value = 070ï¼ç¶åè¿å¥å½æ°ä½åé¨ï¼åç°éè¦ç¨ä¸¥æ ¼æ¨¡å¼æ§è¡ï¼è¿æ¶æä¼æ¥éã\n\nè½ç¶å¯ä»¥åè§£æå½æ°ä½ä»£ç ï¼åæ§è¡åæ°ä»£ç ï¼ä½æ¯è¿æ ·æ çå°±å¢å äºå¤ææ§ãå æ­¤ï¼æ åç´¢æ§ç¦æ­¢äºè¿ç§ç¨æ³ï¼åªè¦åæ°ä½¿ç¨äºé»è®¤å¼ãè§£æèµå¼ãæèæ©å±è¿ç®ç¬¦ï¼å°±ä¸è½æ¾å¼æå®ä¸¥æ ¼æ¨¡å¼ã\n\nä¸¤ç§æ¹æ³å¯ä»¥è§é¿è¿ç§éå¶ãç¬¬ä¸ç§æ¯è®¾å®å¨å±æ§çä¸¥æ ¼æ¨¡å¼ï¼è¿æ¯åæ³çã\n\n'use strict';\n\nfunction dosomething(a, b = a) {\n  // code\n}\n\n\n1\n2\n3\n4\n5\n\n\nç¬¬äºç§æ¯æå½æ°åå¨ä¸ä¸ªæ åæ°çç«å³æ§è¡å½æ°éé¢ã\n\nconst dosomething = (function () {\n  'use strict';\n  return function(value = 42) {\n    return value;\n  };\n}());\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# name å±æ§\n\nå½æ°çnameå±æ§ï¼è¿åè¯¥å½æ°çå½æ°åã\n\nfunction foo() {}\nfoo.name // \"foo\"\n\n\n1\n2\n\n\nè¿ä¸ªå±æ§æ©å°±è¢«æµè§å¨å¹¿æ³æ¯æï¼ä½æ¯ç´å° es6ï¼æå°å¶åå¥äºæ åã\n\néè¦æ³¨æçæ¯ï¼es6 å¯¹è¿ä¸ªå±æ§çè¡ä¸ºååºäºä¸äºä¿®æ¹ãå¦æå°ä¸ä¸ªå¿åå½æ°èµå¼ç»ä¸ä¸ªåéï¼es5 çnameå±æ§ï¼ä¼è¿åç©ºå­ç¬¦ä¸²ï¼è es6 çnameå±æ§ä¼è¿åå®éçå½æ°åã\n\nvar f = function () {};\n\n// es5\nf.name // \"\"\n\n// es6\nf.name // \"f\"\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åéfç­äºä¸ä¸ªå¿åå½æ°ï¼es5 å es6 çnameå±æ§è¿åçå¼ä¸ä¸æ ·ã\n\nå¦æå°ä¸ä¸ªå·åå½æ°èµå¼ç»ä¸ä¸ªåéï¼å es5 å es6 çnameå±æ§é½è¿åè¿ä¸ªå·åå½æ°åæ¬çåå­ã\n\nconst bar = function baz() {};\n\n// es5\nbar.name // \"baz\"\n\n// es6\nbar.name // \"baz\"\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nfunctionæé å½æ°è¿åçå½æ°å®ä¾ï¼nameå±æ§çå¼ä¸ºanonymousã\n\n(new function).name // \"anonymous\"\n\n\n1\n\n\nbindè¿åçå½æ°ï¼nameå±æ§å¼ä¼å ä¸boundåç¼ã\n\nfunction foo() {};\nfoo.bind({}).name // \"bound foo\"\n\n(function(){}).bind({}).name // \"bound \"\n\n\n1\n2\n3\n4\n\n\n\n# ç®­å¤´å½æ°\n\n\n# åºæ¬ç¨æ³\n\nes6 åè®¸ä½¿ç¨âç®­å¤´âï¼=>ï¼å®ä¹å½æ°ã\n\nvar f = v => v;\n\n// ç­åäº\nvar f = function (v) {\n  return v;\n};\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¦æç®­å¤´å½æ°ä¸éè¦åæ°æéè¦å¤ä¸ªåæ°ï¼å°±ä½¿ç¨ä¸ä¸ªåæ¬å·ä»£è¡¨åæ°é¨åã\n\nvar f = () => 5;\n// ç­åäº\nvar f = function () { return 5 };\n\nvar sum = (num1, num2) => num1 + num2;\n// ç­åäº\nvar sum = function(num1, num2) {\n  return num1 + num2;\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦æç®­å¤´å½æ°çä»£ç åé¨åå¤äºä¸æ¡è¯­å¥ï¼å°±è¦ä½¿ç¨å¤§æ¬å·å°å®ä»¬æ¬èµ·æ¥ï¼å¹¶ä¸ä½¿ç¨returnè¯­å¥è¿åã\n\nvar sum = (num1, num2) => { return num1 + num2; }\n\n\n1\n\n\nç±äºå¤§æ¬å·è¢«è§£éä¸ºä»£ç åï¼æä»¥å¦æç®­å¤´å½æ°ç´æ¥è¿åä¸ä¸ªå¯¹è±¡ï¼å¿é¡»å¨å¯¹è±¡å¤é¢å ä¸æ¬å·ï¼å¦åä¼æ¥éã\n\n// æ¥é\nlet gettempitem = id => { id: id, name: \"temp\" };\n\n// ä¸æ¥é\nlet gettempitem = id => ({ id: id, name: \"temp\" });\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢æ¯ä¸ç§ç¹æ®æåµï¼è½ç¶å¯ä»¥è¿è¡ï¼ä½ä¼å¾å°éè¯¯çç»æã\n\nlet foo = () => { a: 1 };\nfoo() // undefined\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼åå§æå¾æ¯è¿åä¸ä¸ªå¯¹è±¡{ a: 1 }ï¼ä½æ¯ç±äºå¼æè®¤ä¸ºå¤§æ¬å·æ¯ä»£ç åï¼æä»¥æ§è¡äºä¸è¡è¯­å¥a: 1ãè¿æ¶ï¼aå¯ä»¥è¢«è§£éä¸ºè¯­å¥çæ ç­¾ï¼å æ­¤å®éæ§è¡çè¯­å¥æ¯1;ï¼ç¶åå½æ°å°±ç»æäºï¼æ²¡æè¿åå¼ã\n\nå¦æç®­å¤´å½æ°åªæä¸è¡è¯­å¥ï¼ä¸ä¸éè¦è¿åå¼ï¼å¯ä»¥éç¨ä¸é¢çåæ³ï¼å°±ä¸ç¨åå¤§æ¬å·äºã\n\nlet fn = () => void doesnotreturn();\n\n\n1\n\n\nç®­å¤´å½æ°å¯ä»¥ä¸åéè§£æç»åä½¿ç¨ã\n\nconst full = ({ first, last }) => first + ' ' + last;\n\n// ç­åäº\nfunction full(person) {\n  return person.first + ' ' + person.last;\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nç®­å¤´å½æ°ä½¿å¾è¡¨è¾¾æ´å ç®æ´ã\n\nconst iseven = n => n % 2 === 0;\nconst square = n => n * n;\n\n\n1\n2\n\n\nä¸é¢ä»£ç åªç¨äºä¸¤è¡ï¼å°±å®ä¹äºä¸¤ä¸ªç®åçå·¥å·å½æ°ãå¦æä¸ç¨ç®­å¤´å½æ°ï¼å¯è½å°±è¦å ç¨å¤è¡ï¼èä¸è¿ä¸å¦ç°å¨è¿æ ·åéç®ã\n\nç®­å¤´å½æ°çä¸ä¸ªç¨å¤æ¯ç®ååè°å½æ°ã\n\n// æ­£å¸¸å½æ°åæ³\n[1,2,3].map(function (x) {\n  return x * x;\n});\n\n// ç®­å¤´å½æ°åæ³\n[1,2,3].map(x => x * x);\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦ä¸ä¸ªä¾å­æ¯\n\n// æ­£å¸¸å½æ°åæ³\nvar result = values.sort(function (a, b) {\n  return a - b;\n});\n\n// ç®­å¤´å½æ°åæ³\nvar result = values.sort((a, b) => a - b);\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢æ¯ rest åæ°ä¸ç®­å¤´å½æ°ç»åçä¾å­ã\n\nconst numbers = (...nums) => nums;\n\nnumbers(1, 2, 3, 4, 5)\n// [1,2,3,4,5]\n\nconst headandtail = (head, ...tail) => [head, tail];\n\nheadandtail(1, 2, 3, 4, 5)\n// [1,[2,3,4,5]]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# ä½¿ç¨æ³¨æç¹\n\nç®­å¤´å½æ°æå ä¸ªä½¿ç¨æ³¨æç¹ã\n\nï¼1ï¼å½æ°ä½åç**thiså¯¹è±¡**ï¼å°±æ¯å®ä¹æ¶æå¨çå¯¹è±¡ï¼èä¸æ¯ä½¿ç¨æ¶æå¨çå¯¹è±¡ã\n\nï¼2ï¼ä¸å¯ä»¥å½ä½æé å½æ°ï¼ä¹å°±æ¯è¯´ï¼ä¸å¯ä»¥ä½¿ç¨newå½ä»¤ï¼å¦åä¼æåºä¸ä¸ªéè¯¯ã\n\nï¼3ï¼ä¸å¯ä»¥ä½¿ç¨argumentså¯¹è±¡ï¼è¯¥å¯¹è±¡å¨å½æ°ä½åä¸å­å¨ãå¦æè¦ç¨ï¼å¯ä»¥ç¨ rest åæ°ä»£æ¿ã\n\nï¼4ï¼ä¸å¯ä»¥ä½¿ç¨yieldå½ä»¤ï¼å æ­¤ç®­å¤´å½æ°ä¸è½ç¨ä½ generator å½æ°ã\n\nä¸é¢åç¹ä¸­ï¼ç¬¬ä¸ç¹å°¤å¶å¼å¾æ³¨æãthiså¯¹è±¡çæåæ¯å¯åçï¼ä½æ¯å¨ç®­å¤´å½æ°ä¸­ï¼å®æ¯åºå®çã\n\nfunction foo() {\n  settimeout(() => {\n    console.log('id:', this.id);\n  }, 100);\n}\n\nvar id = 21;\n\nfoo.call({ id: 42 });\n// id: 42\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼settimeoutçåæ°æ¯ä¸ä¸ªç®­å¤´å½æ°ï¼è¿ä¸ªç®­å¤´å½æ°çå®ä¹çææ¯å¨fooå½æ°çææ¶ï¼èå®ççæ­£æ§è¡è¦ç­å° 100 æ¯«ç§åãå¦ææ¯æ®éå½æ°ï¼æ§è¡æ¶thisåºè¯¥æåå¨å±å¯¹è±¡windowï¼è¿æ¶åºè¯¥è¾åº21ãä½æ¯ï¼ç®­å¤´å½æ°å¯¼è´thisæ»æ¯æåå½æ°å®ä¹çææ¶æå¨çå¯¹è±¡ï¼æ¬ä¾æ¯{id: 42}ï¼ï¼æä»¥è¾åºçæ¯42ã\n\nç®­å¤´å½æ°å¯ä»¥è®©settimeoutéé¢çthisï¼ç»å®å®ä¹æ¶æå¨çä½ç¨åï¼èä¸æ¯æåè¿è¡æ¶æå¨çä½ç¨åãä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nfunction timer() {\n  this.s1 = 0;\n  this.s2 = 0;\n  // ç®­å¤´å½æ°\n  setinterval(() => this.s1++, 1000);\n  // æ®éå½æ°\n  setinterval(function () {\n    this.s2++;\n  }, 1000);\n}\n\nvar timer = new timer();\n\nsettimeout(() => console.log('s1: ', timer.s1), 3100);\nsettimeout(() => console.log('s2: ', timer.s2), 3100);\n// s1: 3\n// s2: 0\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼timerå½æ°åé¨è®¾ç½®äºä¸¤ä¸ªå®æ¶å¨ï¼åå«ä½¿ç¨äºç®­å¤´å½æ°åæ®éå½æ°ãåèçthisç»å®å®ä¹æ¶æå¨çä½ç¨åï¼å³timerå½æ°ï¼ï¼åèçthisæåè¿è¡æ¶æå¨çä½ç¨åï¼å³å¨å±å¯¹è±¡ï¼ãæä»¥ï¼3100 æ¯«ç§ä¹åï¼timer.s1è¢«æ´æ°äº 3 æ¬¡ï¼ètimer.s2ä¸æ¬¡é½æ²¡æ´æ°ã\n\nç®­å¤´å½æ°å¯ä»¥è®©thisæååºå®åï¼è¿ç§ç¹æ§å¾æå©äºå°è£åè°å½æ°ãä¸é¢æ¯ä¸ä¸ªä¾å­ï¼dom äºä»¶çåè°å½æ°å°è£å¨ä¸ä¸ªå¯¹è±¡éé¢ã\n\nvar handler = {\n  id: '123456',\n\n  init: function() { // æ³¨æè¿éä¸æ¯ä½¿ç¨ç®­å¤´å½æ°ï¼å¦è¿éä½¿ç¨ç®­å¤´å½æ°å°æ¶thisæåå¨å±å¯¹è±¡\n    document.addeventlistener('click',\n      event => this.dosomething(event.type), false);\n  },\n\n  dosomething: function(type) {\n    console.log('handling ' + type  + ' for ' + this.id);\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç çinitæ¹æ³ä¸­ï¼ä½¿ç¨äºç®­å¤´å½æ°ï¼è¿å¯¼è´è¿ä¸ªç®­å¤´å½æ°éé¢çthisï¼æ»æ¯æåhandlerå¯¹è±¡ãå¦åï¼åè°å½æ°è¿è¡æ¶ï¼this.dosomethingè¿ä¸è¡ä¼æ¥éï¼å ä¸ºæ­¤æ¶thisæådocumentå¯¹è±¡ã\n\nthisæåçåºå®åï¼å¹¶ä¸æ¯å ä¸ºç®­å¤´å½æ°åé¨æç»å®thisçæºå¶ï¼å®éåå æ¯ç®­å¤´å½æ°æ ¹æ¬æ²¡æèªå·±çthisï¼å¯¼è´åé¨çthiså°±æ¯å¤å±ä»£ç åçthisãæ­£æ¯å ä¸ºå®æ²¡æthisï¼æä»¥ä¹å°±ä¸è½ç¨ä½æé å½æ°ã\n\næä»¥ï¼ç®­å¤´å½æ°è½¬æ es5 çä»£ç å¦ä¸ã\n\n// es6\nfunction foo() {\n  settimeout(() => {\n    console.log('id:', this.id);\n  }, 100);\n}\n\n// es5\nfunction foo() {\n  var _this = this;\n\n  settimeout(function () {\n    console.log('id:', _this.id);\n  }, 100);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼è½¬æ¢åç es5 çæ¬æ¸æ¥å°è¯´æäºï¼ç®­å¤´å½æ°éé¢æ ¹æ¬æ²¡æèªå·±çthisï¼èæ¯å¼ç¨å¤å±çthisã\n\nè¯·é®ä¸é¢çä»£ç ä¹ä¸­æå ä¸ªthisï¼\n\nfunction foo() {\n  return () => {\n    return () => {\n      return () => {\n        console.log('id:', this.id);\n      };\n    };\n  };\n}\n\nvar f = foo.call({id: 1});\n\nvar t1 = f.call({id: 2})()(); // id: 1\nvar t2 = f().call({id: 3})(); // id: 1\nvar t3 = f()().call({id: 4}); // id: 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¹ä¸­ï¼åªæä¸ä¸ªthisï¼å°±æ¯å½æ°fooçthisï¼æä»¥t1ãt2ãt3é½è¾åºåæ ·çç»æãå ä¸ºææçåå±å½æ°é½æ¯ç®­å¤´å½æ°ï¼é½æ²¡æèªå·±çthisï¼å®ä»¬çthiså¶å®é½æ¯æå¤å±fooå½æ°çthisã\n\né¤äºthisï¼ä»¥ä¸ä¸ä¸ªåéå¨ç®­å¤´å½æ°ä¹ä¸­ä¹æ¯ä¸å­å¨çï¼æåå¤å±å½æ°çå¯¹åºåéï¼argumentsãsuperãnew.targetã\n\nfunction foo() {\n  settimeout(() => {\n    console.log('args:', arguments);\n  }, 100);\n}\n\nfoo(2, 4, 6, 8)\n// args: [2, 4, 6, 8]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼ç®­å¤´å½æ°åé¨çåéargumentsï¼å¶å®æ¯å½æ°fooçargumentsåéã\n\nå¦å¤ï¼ç±äºç®­å¤´å½æ°æ²¡æèªå·±çthisï¼æä»¥å½ç¶ä¹å°±ä¸è½ç¨call()ãapply()ãbind()è¿äºæ¹æ³å»æ¹åthisçæåã\n\n(function() {\n  return [\n    (() => this.x).bind({ x: 'inner' })()\n  ];\n}).call({ x: 'outer' });\n// ['outer']\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼ç®­å¤´å½æ°æ²¡æèªå·±çthisï¼æä»¥bindæ¹æ³æ æï¼åé¨çthisæåå¤é¨çthisã\n\né¿æä»¥æ¥ï¼javascript è¯­è¨çthiså¯¹è±¡ä¸ç´æ¯ä¸ä¸ªä»¤äººå¤´ççé®é¢ï¼å¨å¯¹è±¡æ¹æ³ä¸­ä½¿ç¨thisï¼å¿é¡»éå¸¸å°å¿ãç®­å¤´å½æ°âç»å®âthisï¼å¾å¤§ç¨åº¦ä¸è§£å³äºè¿ä¸ªå°æ°ã\n\n\n# ä¸éç¨åºå\n\nç±äºç®­å¤´å½æ°ä½¿å¾thisä»âå¨æâåæâéæâï¼ä¸é¢ä¸¤ä¸ªåºåä¸åºè¯¥ä½¿ç¨ç®­å¤´å½æ°ã\n\nç¬¬ä¸ä¸ªåºåæ¯å®ä¹å¯¹è±¡çæ¹æ³ï¼ä¸è¯¥æ¹æ³åé¨åæ¬thisã\n\nconst cat = {\n  lives: 9,\n  jumps: () => {\n    this.lives--;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼cat.jumps()æ¹æ³æ¯ä¸ä¸ªç®­å¤´å½æ°ï¼è¿æ¯éè¯¯çãè°ç¨cat.jumps()æ¶ï¼å¦ææ¯æ®éå½æ°ï¼è¯¥æ¹æ³åé¨çthisæåcatï¼å¦æåæä¸é¢é£æ ·çç®­å¤´å½æ°ï¼ä½¿å¾thisæåå¨å±å¯¹è±¡ï¼å æ­¤ä¸ä¼å¾å°é¢æç»æãè¿æ¯å ä¸ºå¯¹è±¡ä¸ææåç¬çä½ç¨åï¼å¯¼è´jumpsç®­å¤´å½æ°å®ä¹æ¶çä½ç¨åå°±æ¯å¨å±ä½ç¨åã\n\nç¬¬äºä¸ªåºåæ¯éè¦å¨æthisçæ¶åï¼ä¹ä¸åºä½¿ç¨ç®­å¤´å½æ°ã\n\nvar button = document.getelementbyid('press');\nbutton.addeventlistener('click', () => {\n  this.classlist.toggle('on');\n});\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç è¿è¡æ¶ï¼ç¹å»æé®ä¼æ¥éï¼å ä¸ºbuttonççå¬å½æ°æ¯ä¸ä¸ªç®­å¤´å½æ°ï¼å¯¼è´éé¢çthiså°±æ¯å¨å±å¯¹è±¡ãå¦ææ¹ææ®éå½æ°ï¼thiså°±ä¼å¨ææåè¢«ç¹å»çæé®å¯¹è±¡ã\n\nå¦å¤ï¼å¦æå½æ°ä½å¾å¤æï¼æè®¸å¤è¡ï¼æèå½æ°åé¨æå¤§éçè¯»åæä½ï¼ä¸åçº¯æ¯ä¸ºäºè®¡ç®å¼ï¼è¿æ¶ä¹ä¸åºè¯¥ä½¿ç¨ç®­å¤´å½æ°ï¼èæ¯è¦ä½¿ç¨æ®éå½æ°ï¼è¿æ ·å¯ä»¥æé«ä»£ç å¯è¯»æ§ã\n\n\n# åµå¥çç®­å¤´å½æ°\n\nç®­å¤´å½æ°åé¨ï¼è¿å¯ä»¥åä½¿ç¨ç®­å¤´å½æ°ãä¸é¢æ¯ä¸ä¸ª es5 è¯­æ³çå¤éåµå¥å½æ°ã\n\nfunction insert(value) {\n  return {into: function (array) {\n    return {after: function (aftervalue) {\n      array.splice(array.indexof(aftervalue) + 1, 0, value);\n      return array;\n    }};\n  }};\n}\n\ninsert(2).into([1, 3]).after(1); //[1, 2, 3]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢è¿ä¸ªå½æ°ï¼å¯ä»¥ä½¿ç¨ç®­å¤´å½æ°æ¹åã\n\nlet insert = (value) => ({into: (array) => ({after: (aftervalue) => {\n  array.splice(array.indexof(aftervalue) + 1, 0, value);\n  return array;\n}})});\n\ninsert(2).into([1, 3]).after(1); //[1, 2, 3]\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢æ¯ä¸ä¸ªé¨ç½²ç®¡éæºå¶ï¼pipelineï¼çä¾å­ï¼å³åä¸ä¸ªå½æ°çè¾åºæ¯åä¸ä¸ªå½æ°çè¾å¥ã\n\nconst pipeline = (...funcs) =>\n  val => funcs.reduce((a, b) => b(a), val);\n\nconst plus1 = a => a + 1;\nconst mult2 = a => a * 2;\nconst addthenmult = pipeline(plus1, mult2);\n\naddthenmult(5)\n// 12\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦æè§å¾ä¸é¢çåæ³å¯è¯»æ§æ¯è¾å·®ï¼ä¹å¯ä»¥éç¨ä¸é¢çåæ³ã\n\nconst plus1 = a => a + 1;\nconst mult2 = a => a * 2;\n\nmult2(plus1(5))\n// 12\n\n\n1\n2\n3\n4\n5\n\n\nç®­å¤´å½æ°è¿æä¸ä¸ªåè½ï¼å°±æ¯å¯ä»¥å¾æ¹ä¾¿å°æ¹å Î» æ¼ç®ã\n\n// Î»æ¼ç®çåæ³\nfix = Î»f.(Î»x.f(Î»v.x(x)(v)))(Î»x.f(Î»v.x(x)(v)))\n\n// es6çåæ³\nvar fix = f => (x => f(v => x(x)(v)))\n               (x => f(v => x(x)(v)));\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä¸¤ç§åæ³ï¼å ä¹æ¯ä¸ä¸å¯¹åºçãç±äº Î» æ¼ç®å¯¹äºè®¡ç®æºç§å­¦éå¸¸éè¦ï¼è¿ä½¿å¾æä»¬å¯ä»¥ç¨ es6 ä½ä¸ºæ¿ä»£å·¥å·ï¼æ¢ç´¢è®¡ç®æºç§å­¦ã\n\n\n# å°¾è°ç¨ä¼å\n\n\n# ä»ä¹æ¯å°¾è°ç¨ï¼\n\nå°¾è°ç¨ï¼tail callï¼æ¯å½æ°å¼ç¼ç¨çä¸ä¸ªéè¦æ¦å¿µï¼æ¬èº«éå¸¸ç®åï¼ä¸å¥è¯å°±è½è¯´æ¸æ¥ï¼å°±æ¯ææä¸ªå½æ°çæåä¸æ­¥æ¯è°ç¨å¦ä¸ä¸ªå½æ°ã\n\nfunction f(x){\n  return g(x);\n}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fçæåä¸æ­¥æ¯è°ç¨å½æ°gï¼è¿å°±å«å°¾è°ç¨ã\n\nä»¥ä¸ä¸ç§æåµï¼é½ä¸å±äºå°¾è°ç¨ã\n\n// æåµä¸\nfunction f(x){\n  let y = g(x);\n  return y;\n}\n\n// æåµäº\nfunction f(x){\n  return g(x) + 1;\n}\n\n// æåµä¸\nfunction f(x){\n  g(x);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼æåµä¸æ¯è°ç¨å½æ°gä¹åï¼è¿æèµå¼æä½ï¼æä»¥ä¸å±äºå°¾è°ç¨ï¼å³ä½¿è¯­ä¹å®å¨ä¸æ ·ãæåµäºä¹å±äºè°ç¨åè¿ææä½ï¼å³ä½¿åå¨ä¸è¡åãæåµä¸ç­åäºä¸é¢çä»£ç ã\n\nfunction f(x){\n  g(x);\n  return undefined;\n}\n\n\n1\n2\n3\n4\n\n\nå°¾è°ç¨ä¸ä¸å®åºç°å¨å½æ°å°¾é¨ï¼åªè¦æ¯æåä¸æ­¥æä½å³å¯ã\n\nfunction f(x) {\n  if (x > 0) {\n    return m(x)\n  }\n  return n(x);\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°måné½å±äºå°¾è°ç¨ï¼å ä¸ºå®ä»¬é½æ¯å½æ°fçæåä¸æ­¥æä½ã\n\n\n# å°¾è°ç¨ä¼å\n\nå°¾è°ç¨ä¹æä»¥ä¸å¶ä»è°ç¨ä¸åï¼å°±å¨äºå®çç¹æ®çè°ç¨ä½ç½®ã\n\næä»¬ç¥éï¼å½æ°è°ç¨ä¼å¨åå­å½¢æä¸ä¸ªâè°ç¨è®°å½âï¼åç§°âè°ç¨å¸§âï¼call frameï¼ï¼ä¿å­è°ç¨ä½ç½®ååé¨åéç­ä¿¡æ¯ãå¦æå¨å½æ°açåé¨è°ç¨å½æ°bï¼é£ä¹å¨açè°ç¨å¸§ä¸æ¹ï¼è¿ä¼å½¢æä¸ä¸ªbçè°ç¨å¸§ãç­å°bè¿è¡ç»æï¼å°ç»æè¿åå°aï¼bçè°ç¨å¸§æä¼æ¶å¤±ãå¦æå½æ°båé¨è¿è°ç¨å½æ°cï¼é£å°±è¿æä¸ä¸ªcçè°ç¨å¸§ï¼ä»¥æ­¤ç±»æ¨ãææçè°ç¨å¸§ï¼å°±å½¢æä¸ä¸ªâè°ç¨æ âï¼call stackï¼ã\n\nå°¾è°ç¨ç±äºæ¯å½æ°çæåä¸æ­¥æä½ï¼æä»¥ä¸éè¦ä¿çå¤å±å½æ°çè°ç¨å¸§ï¼å ä¸ºè°ç¨ä½ç½®ãåé¨åéç­ä¿¡æ¯é½ä¸ä¼åç¨å°äºï¼åªè¦ç´æ¥ç¨åå±å½æ°çè°ç¨å¸§ï¼åä»£å¤å±å½æ°çè°ç¨å¸§å°±å¯ä»¥äºã\n\nfunction f() {\n  let m = 1;\n  let n = 2;\n  return g(m + n);\n}\nf();\n\n// ç­åäº\nfunction f() {\n  return g(3);\n}\nf();\n\n// ç­åäº\ng(3);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æå½æ°gä¸æ¯å°¾è°ç¨ï¼å½æ°få°±éè¦ä¿å­åé¨åémånçå¼ãgçè°ç¨ä½ç½®ç­ä¿¡æ¯ãä½ç±äºè°ç¨gä¹åï¼å½æ°få°±ç»æäºï¼æä»¥æ§è¡å°æåä¸æ­¥ï¼å®å¨å¯ä»¥å é¤f(x)çè°ç¨å¸§ï¼åªä¿çg(3)çè°ç¨å¸§ã\n\nè¿å°±å«åâå°¾è°ç¨ä¼åâï¼tail call optimizationï¼ï¼å³åªä¿çåå±å½æ°çè°ç¨å¸§ãå¦æææå½æ°é½æ¯å°¾è°ç¨ï¼é£ä¹å®å¨å¯ä»¥åå°æ¯æ¬¡æ§è¡æ¶ï¼è°ç¨å¸§åªæä¸é¡¹ï¼è¿å°å¤§å¤§èçåå­ãè¿å°±æ¯âå°¾è°ç¨ä¼åâçæä¹ã\n\næ³¨æï¼åªæä¸åç¨å°å¤å±å½æ°çåé¨åéï¼åå±å½æ°çè°ç¨å¸§æä¼åä»£å¤å±å½æ°çè°ç¨å¸§ï¼å¦åå°±æ æ³è¿è¡âå°¾è°ç¨ä¼åâã\n\nfunction addone(a){\n  var one = 1;\n  function inner(b){\n    return b + one;\n  }\n  return inner(a);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢çå½æ°ä¸ä¼è¿è¡å°¾è°ç¨ä¼åï¼å ä¸ºåå±å½æ°innerç¨å°äºå¤å±å½æ°addoneçåé¨åéoneã\n\næ³¨æï¼ç®ååªæ safari æµè§å¨æ¯æå°¾è°ç¨ä¼åï¼chrome å firefox é½ä¸æ¯æã\n\n\n# å°¾éå½\n\nå½æ°è°ç¨èªèº«ï¼ç§°ä¸ºéå½ãå¦æå°¾è°ç¨èªèº«ï¼å°±ç§°ä¸ºå°¾éå½ã\n\néå½éå¸¸èè´¹åå­ï¼å ä¸ºéè¦åæ¶ä¿å­æåä¸ç¾ä¸ªè°ç¨å¸§ï¼å¾å®¹æåçâæ æº¢åºâéè¯¯ï¼stack overflowï¼ãä½å¯¹äºå°¾éå½æ¥è¯´ï¼ç±äºåªå­å¨ä¸ä¸ªè°ç¨å¸§ï¼æä»¥æ°¸è¿ä¸ä¼åçâæ æº¢åºâéè¯¯ã\n\nfunction factorial(n) {\n  if (n === 1) return 1;\n  return n * factorial(n - 1);\n}\n\nfactorial(5) // 120\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç æ¯ä¸ä¸ªé¶ä¹å½æ°ï¼è®¡ç®nçé¶ä¹ï¼æå¤éè¦ä¿å­nä¸ªè°ç¨è®°å½ï¼å¤æåº¦ o(n) ã\n\nå¦ææ¹åæå°¾éå½ï¼åªä¿çä¸ä¸ªè°ç¨è®°å½ï¼å¤æåº¦ o(1) ã\n\nfunction factorial(n, total) {\n  if (n === 1) return total;\n  return factorial(n - 1, n * total);\n}\n\nfactorial(5, 1) // 120\n\n\n1\n2\n3\n4\n5\n6\n\n\nè¿æä¸ä¸ªæ¯è¾èåçä¾å­ï¼å°±æ¯è®¡ç® fibonacci æ°åï¼ä¹è½ååè¯´æå°¾éå½ä¼åçéè¦æ§ã\n\néå°¾éå½ç fibonacci æ°åå®ç°å¦ä¸ã\n\nfunction fibonacci (n) {\n  if ( n <= 1 ) {return 1};\n\n  return fibonacci(n - 1) + fibonacci(n - 2);\n}\n\nfibonacci(10) // 89\nfibonacci(100) // è¶æ¶\nfibonacci(500) // è¶æ¶\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå°¾éå½ä¼åè¿ç fibonacci æ°åå®ç°å¦ä¸ã\n\nfunction fibonacci2 (n , ac1 = 1 , ac2 = 1) {\n  if( n <= 1 ) {return ac2};\n\n  return fibonacci2 (n - 1, ac2, ac1 + ac2);\n}\n\nfibonacci2(100) // 573147844013817200000\nfibonacci2(1000) // 7.0330367711422765e+208\nfibonacci2(10000) // infinity\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nç±æ­¤å¯è§ï¼âå°¾è°ç¨ä¼åâå¯¹éå½æä½æä¹éå¤§ï¼æä»¥ä¸äºå½æ°å¼ç¼ç¨è¯­è¨å°å¶åå¥äºè¯­è¨è§æ ¼ães6 äº¦æ¯å¦æ­¤ï¼ç¬¬ä¸æ¬¡æç¡®è§å®ï¼ææ ecmascript çå®ç°ï¼é½å¿é¡»é¨ç½²âå°¾è°ç¨ä¼åâãè¿å°±æ¯è¯´ï¼es6 ä¸­åªè¦ä½¿ç¨å°¾éå½ï¼å°±ä¸ä¼åçæ æº¢åºï¼æèå±å±éå½é æçè¶æ¶ï¼ï¼ç¸å¯¹èçåå­ã\n\n\n# éå½å½æ°çæ¹å\n\nå°¾éå½çå®ç°ï¼å¾å¾éè¦æ¹åéå½å½æ°ï¼ç¡®ä¿æåä¸æ­¥åªè°ç¨èªèº«ãåå°è¿ä¸ç¹çæ¹æ³ï¼å°±æ¯æææç¨å°çåé¨åéæ¹åæå½æ°çåæ°ãæ¯å¦ä¸é¢çä¾å­ï¼é¶ä¹å½æ° factorial éè¦ç¨å°ä¸ä¸ªä¸­é´åétotalï¼é£å°±æè¿ä¸ªä¸­é´åéæ¹åæå½æ°çåæ°ãè¿æ ·åçç¼ºç¹å°±æ¯ä¸å¤ªç´è§ï¼ç¬¬ä¸ç¼å¾é¾çåºæ¥ï¼ä¸ºä»ä¹è®¡ç®5çé¶ä¹ï¼éè¦ä¼ å¥ä¸¤ä¸ªåæ°5å1ï¼\n\nä¸¤ä¸ªæ¹æ³å¯ä»¥è§£å³è¿ä¸ªé®é¢ãæ¹æ³ä¸æ¯å¨å°¾éå½å½æ°ä¹å¤ï¼åæä¾ä¸ä¸ªæ­£å¸¸å½¢å¼çå½æ°ã\n\nfunction tailfactorial(n, total) {\n  if (n === 1) return total;\n  return tailfactorial(n - 1, n * total);\n}\n\nfunction factorial(n) {\n  return tailfactorial(n, 1);\n}\n\nfactorial(5) // 120\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç éè¿ä¸ä¸ªæ­£å¸¸å½¢å¼çé¶ä¹å½æ°factorialï¼è°ç¨å°¾éå½å½æ°tailfactorialï¼çèµ·æ¥å°±æ­£å¸¸å¤äºã\n\nå½æ°å¼ç¼ç¨æä¸ä¸ªæ¦å¿µï¼å«åæ¯éåï¼curryingï¼ï¼æææ¯å°å¤åæ°çå½æ°è½¬æ¢æååæ°çå½¢å¼ãè¿éä¹å¯ä»¥ä½¿ç¨æ¯éåã\n\nfunction currying(fn, n) {\n  return function (m) {\n    return fn.call(this, m, n);\n  };\n}\n\nfunction tailfactorial(n, total) {\n  if (n === 1) return total;\n  return tailfactorial(n - 1, n * total);\n}\n\nconst factorial = currying(tailfactorial, 1);\n\nfactorial(5) // 120\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç éè¿æ¯éåï¼å°å°¾éå½å½æ°tailfactorialåä¸ºåªæ¥åä¸ä¸ªåæ°çfactorialã\n\nç¬¬äºç§æ¹æ³å°±ç®åå¤äºï¼å°±æ¯éç¨ es6 çå½æ°é»è®¤å¼ã\n\nfunction factorial(n, total = 1) {\n  if (n === 1) return total;\n  return factorial(n - 1, n * total);\n}\n\nfactorial(5) // 120\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°totalæé»è®¤å¼1ï¼æä»¥è°ç¨æ¶ä¸ç¨æä¾è¿ä¸ªå¼ã\n\næ»ç»ä¸ä¸ï¼éå½æ¬è´¨ä¸æ¯ä¸ç§å¾ªç¯æä½ãçº¯ç²¹çå½æ°å¼ç¼ç¨è¯­è¨æ²¡æå¾ªç¯æä½å½ä»¤ï¼ææçå¾ªç¯é½ç¨éå½å®ç°ï¼è¿å°±æ¯ä¸ºä»ä¹å°¾éå½å¯¹è¿äºè¯­è¨æå¶éè¦ãå¯¹äºå¶ä»æ¯æâå°¾è°ç¨ä¼åâçè¯­è¨ï¼æ¯å¦ luaï¼es6ï¼ï¼åªéè¦ç¥éå¾ªç¯å¯ä»¥ç¨éå½ä»£æ¿ï¼èä¸æ¦ä½¿ç¨éå½ï¼å°±æå¥½ä½¿ç¨å°¾éå½ã\n\n\n# ä¸¥æ ¼æ¨¡å¼\n\nes6 çå°¾è°ç¨ä¼ååªå¨ä¸¥æ ¼æ¨¡å¼ä¸å¼å¯ï¼æ­£å¸¸æ¨¡å¼æ¯æ æçã\n\nè¿æ¯å ä¸ºå¨æ­£å¸¸æ¨¡å¼ä¸ï¼å½æ°åé¨æä¸¤ä¸ªåéï¼å¯ä»¥è·è¸ªå½æ°çè°ç¨æ ã\n\n * func.argumentsï¼è¿åè°ç¨æ¶å½æ°çåæ°ã\n * func.callerï¼è¿åè°ç¨å½åå½æ°çé£ä¸ªå½æ°ã\n\nå°¾è°ç¨ä¼ååçæ¶ï¼å½æ°çè°ç¨æ ä¼æ¹åï¼å æ­¤ä¸é¢ä¸¤ä¸ªåéå°±ä¼å¤±çãä¸¥æ ¼æ¨¡å¼ç¦ç¨è¿ä¸¤ä¸ªåéï¼æä»¥å°¾è°ç¨æ¨¡å¼ä»å¨ä¸¥æ ¼æ¨¡å¼ä¸çæã\n\nfunction restricted() {\n  'use strict';\n  restricted.caller;    // æ¥é\n  restricted.arguments; // æ¥é\n}\nrestricted();\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# å°¾éå½ä¼åçå®ç°\n\nå°¾éå½ä¼ååªå¨ä¸¥æ ¼æ¨¡å¼ä¸çæï¼é£ä¹æ­£å¸¸æ¨¡å¼ä¸ï¼æèé£äºä¸æ¯æè¯¥åè½çç¯å¢ä¸­ï¼ææ²¡æåæ³ä¹ä½¿ç¨å°¾éå½ä¼åå¢ï¼åç­æ¯å¯ä»¥çï¼å°±æ¯èªå·±å®ç°å°¾éå½ä¼åã\n\nå®çåçéå¸¸ç®åãå°¾éå½ä¹æä»¥éè¦ä¼åï¼åå æ¯è°ç¨æ å¤ªå¤ï¼é ææº¢åºï¼é£ä¹åªè¦åå°è°ç¨æ ï¼å°±ä¸ä¼æº¢åºãæä¹åå¯ä»¥åå°è°ç¨æ å¢ï¼å°±æ¯éç¨âå¾ªç¯âæ¢æâéå½âã\n\nä¸é¢æ¯ä¸ä¸ªæ­£å¸¸çéå½å½æ°ã\n\nfunction sum(x, y) {\n  if (y > 0) {\n    return sum(x + 1, y - 1);\n  } else {\n    return x;\n  }\n}\n\nsum(1, 100000)\n// uncaught rangeerror: maximum call stack size exceeded(â¦)\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼sumæ¯ä¸ä¸ªéå½å½æ°ï¼åæ°xæ¯éè¦ç´¯å çå¼ï¼åæ°yæ§å¶éå½æ¬¡æ°ãä¸æ¦æå®suméå½ 100000 æ¬¡ï¼å°±ä¼æ¥éï¼æç¤ºè¶åºè°ç¨æ çæå¤§æ¬¡æ°ã\n\nè¹¦åºå½æ°ï¼trampolineï¼å¯ä»¥å°éå½æ§è¡è½¬ä¸ºå¾ªç¯æ§è¡ã\n\nfunction trampoline(f) {\n  while (f && f instanceof function) {\n    f = f();\n  }\n  return f;\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢å°±æ¯è¹¦åºå½æ°çä¸ä¸ªå®ç°ï¼å®æ¥åä¸ä¸ªå½æ°fä½ä¸ºåæ°ãåªè¦fæ§è¡åè¿åä¸ä¸ªå½æ°ï¼å°±ç»§ç»­æ§è¡ãæ³¨æï¼è¿éæ¯è¿åä¸ä¸ªå½æ°ï¼ç¶åæ§è¡è¯¥å½æ°ï¼èä¸æ¯å½æ°éé¢è°ç¨å½æ°ï¼è¿æ ·å°±é¿åäºéå½æ§è¡ï¼ä»èå°±æ¶é¤äºè°ç¨æ è¿å¤§çé®é¢ã\n\nç¶åï¼è¦åçå°±æ¯å°åæ¥çéå½å½æ°ï¼æ¹åä¸ºæ¯ä¸æ­¥è¿åå¦ä¸ä¸ªå½æ°ã\n\nfunction sum(x, y) {\n  if (y > 0) {\n    return sum.bind(null, x + 1, y - 1);\n  } else {\n    return x;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼sumå½æ°çæ¯æ¬¡æ§è¡ï¼é½ä¼è¿åèªèº«çå¦ä¸ä¸ªçæ¬ã\n\nç°å¨ï¼ä½¿ç¨è¹¦åºå½æ°æ§è¡sumï¼å°±ä¸ä¼åçè°ç¨æ æº¢åºã\n\ntrampoline(sum(1, 100000))\n// 100001\n\n\n1\n2\n\n\nè¹¦åºå½æ°å¹¶ä¸æ¯çæ­£çå°¾éå½ä¼åï¼ä¸é¢çå®ç°ææ¯ã\n\nfunction tco(f) {\n  var value;\n  var active = false;\n  var accumulated = [];\n\n  return function accumulator() {\n    accumulated.push(arguments);\n    if (!active) {\n      active = true;\n      while (accumulated.length) {\n        value = f.apply(this, accumulated.shift());\n      }\n      active = false;\n      return value;\n    }\n  };\n}\n\nvar sum = tco(function(x, y) {\n  if (y > 0) {\n    return sum(x + 1, y - 1)\n  }\n  else {\n    return x\n  }\n});\n\nsum(1, 100000)\n// 100001\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nä¸é¢ä»£ç ä¸­ï¼tcoå½æ°æ¯å°¾éå½ä¼åçå®ç°ï¼å®çå¥¥å¦å°±å¨äºç¶æåéactiveãé»è®¤æåµä¸ï¼è¿ä¸ªåéæ¯ä¸æ¿æ´»çãä¸æ¦è¿å¥å°¾éå½ä¼åçè¿ç¨ï¼è¿ä¸ªåéå°±æ¿æ´»äºãç¶åï¼æ¯ä¸è½®éå½sumè¿åçé½æ¯undefinedï¼æä»¥å°±é¿åäºéå½æ§è¡ï¼èaccumulatedæ°ç»å­æ¾æ¯ä¸è½®sumæ§è¡çåæ°ï¼æ»æ¯æå¼çï¼è¿å°±ä¿è¯äºaccumulatorå½æ°åé¨çwhileå¾ªç¯æ»æ¯ä¼æ§è¡ãè¿æ ·å°±å¾å·§å¦å°å°âéå½âæ¹æäºâå¾ªç¯âï¼èåä¸è½®çåæ°ä¼åä»£åä¸è½®çåæ°ï¼ä¿è¯äºè°ç¨æ åªæä¸å±ã\n\n\n# å½æ°åæ°çå°¾éå·\n\nes2017 åè®¸å½æ°çæåä¸ä¸ªåæ°æå°¾éå·ï¼trailing commaï¼ã\n\næ­¤åï¼å½æ°å®ä¹åè°ç¨æ¶ï¼é½ä¸åè®¸æåä¸ä¸ªåæ°åé¢åºç°éå·ã\n\nfunction clownseverywhere(\n  param1,\n  param2\n) { /* ... */ }\n\nclownseverywhere(\n  'foo',\n  'bar'\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æå¨param2æbaråé¢å ä¸ä¸ªéå·ï¼å°±ä¼æ¥éã\n\nå¦æåä¸é¢è¿æ ·ï¼å°åæ°åæå¤è¡ï¼å³æ¯ä¸ªåæ°å æ®ä¸è¡ï¼ï¼ä»¥åä¿®æ¹ä»£ç çæ¶åï¼æ³ä¸ºå½æ°clownseverywhereæ·»å ç¬¬ä¸ä¸ªåæ°ï¼æèè°æ´åæ°çæ¬¡åºï¼å°±å¿å¿è¦å¨åæ¥æåä¸ä¸ªåæ°åé¢æ·»å ä¸ä¸ªéå·ãè¿å¯¹äºçæ¬ç®¡çç³»ç»æ¥è¯´ï¼å°±ä¼æ¾ç¤ºæ·»å éå·çé£ä¸è¡ä¹åçäºåå¨ãè¿çä¸å»æç¹åä½ï¼å æ­¤æ°çè¯­æ³åè®¸å®ä¹åè°ç¨æ¶ï¼å°¾é¨ç´æ¥æä¸ä¸ªéå·ã\n\nfunction clownseverywhere(\n  param1,\n  param2,\n) { /* ... */ }\n\nclownseverywhere(\n  'foo',\n  'bar',\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nè¿æ ·çè§å®ä¹ä½¿å¾ï¼å½æ°åæ°ä¸æ°ç»åå¯¹è±¡çå°¾éå·è§åï¼ä¿æä¸è´äºã\n\n\n# function.prototype.tostring()\n\nes2019 å¯¹å½æ°å®ä¾çtostring()æ¹æ³ååºäºä¿®æ¹ã\n\ntostring()æ¹æ³è¿åå½æ°ä»£ç æ¬èº«ï¼ä»¥åä¼çç¥æ³¨éåç©ºæ ¼ã\n\nfunction /* foo comment */ foo () {}\n\nfoo.tostring()\n// function foo() {}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fooçåå§ä»£ç åå«æ³¨éï¼å½æ°åfooååæ¬å·ä¹é´æç©ºæ ¼ï¼ä½æ¯tostring()æ¹æ³é½æå®ä»¬çç¥äºã\n\nä¿®æ¹åçtostring()æ¹æ³ï¼æç¡®è¦æ±è¿åä¸æ¨¡ä¸æ ·çåå§ä»£ç ã\n\nfunction /* foo comment */ foo () {}\n\nfoo.tostring()\n// \"function /* foo comment */ foo () {}\"\n\n\n1\n2\n3\n4\n\n\n\n# catch å½ä»¤çåæ°çç¥\n\njavascript è¯­è¨çtry...catchç»æï¼ä»¥åæç¡®è¦æ±catchå½ä»¤åé¢å¿é¡»è·åæ°ï¼æ¥åtryä»£ç åæåºçéè¯¯å¯¹è±¡ã\n\ntry {\n  // ...\n} catch (err) {\n  // å¤çéè¯¯\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼catchå½ä»¤åé¢å¸¦æåæ°errã\n\nå¾å¤æ¶åï¼catchä»£ç åå¯è½ç¨ä¸å°è¿ä¸ªåæ°ãä½æ¯ï¼ä¸ºäºä¿è¯è¯­æ³æ­£ç¡®ï¼è¿æ¯å¿é¡»åães2019 ååºäºæ¹åï¼åè®¸catchè¯­å¥çç¥åæ°ã\n\ntry {\n  // ...\n} catch {\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"æ°ç»çæ©å±",frontmatter:{title:"æ°ç»çæ©å±",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/e34009d60d8bc4b2",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/09.%E6%95%B0%E7%BB%84%E7%9A%84%E6%89%A9%E5%B1%95.html",relativePath:"ãES6 æç¨ãç¬è®°/09.æ°ç»çæ©å±.md",key:"v-1f0d05a1",path:"/pages/e34009d60d8bc4b2/",headers:[{level:2,title:"æ©å±è¿ç®ç¬¦",slug:"æ©å±è¿ç®ç¬¦",normalizedTitle:"æ©å±è¿ç®ç¬¦",charIndex:12},{level:3,title:"å«ä¹",slug:"å«ä¹",normalizedTitle:"å«ä¹",charIndex:22},{level:3,title:"æ¿ä»£å½æ°ç apply æ¹æ³",slug:"æ¿ä»£å½æ°ç-apply-æ¹æ³",normalizedTitle:"æ¿ä»£å½æ°ç apply æ¹æ³",charIndex:1036},{level:3,title:"æ©å±è¿ç®ç¬¦çåºç¨",slug:"æ©å±è¿ç®ç¬¦çåºç¨",normalizedTitle:"æ©å±è¿ç®ç¬¦çåºç¨",charIndex:2002},{level:2,title:"Array.from()",slug:"array-from",normalizedTitle:"array.from()",charIndex:5585},{level:2,title:"Array.of() æ»æ¯è¿ååæ°å¼ç»æçæ°ç»",slug:"array-of-æ»æ¯è¿ååæ°å¼ç»æçæ°ç»",normalizedTitle:"array.of() æ»æ¯è¿ååæ°å¼ç»æçæ°ç»",charIndex:8479},{level:2,title:"æ°ç»å®ä¾ç copyWithin()",slug:"æ°ç»å®ä¾ç-copywithin",normalizedTitle:"æ°ç»å®ä¾ç copywithin()",charIndex:9153},{level:2,title:"æ°ç»å®ä¾ç find() å findIndex()",slug:"æ°ç»å®ä¾ç-find-å-findindex",normalizedTitle:"æ°ç»å®ä¾ç find() å findindex()",charIndex:10190},{level:2,title:"æ°ç»å®ä¾ç fill()",slug:"æ°ç»å®ä¾ç-fill",normalizedTitle:"æ°ç»å®ä¾ç fill()",charIndex:11109},{level:2,title:"æ°ç»å®ä¾ç entries()ï¼keys() å values()",slug:"æ°ç»å®ä¾ç-entries-keys-å-values",normalizedTitle:"æ°ç»å®ä¾ç entries()ï¼keys() å values()",charIndex:11674},{level:2,title:"æ°ç»å®ä¾ç includes()",slug:"æ°ç»å®ä¾ç-includes",normalizedTitle:"æ°ç»å®ä¾ç includes()",charIndex:12418},{level:2,title:"æ°ç»å®ä¾ç flat()ï¼flatMap()",slug:"æ°ç»å®ä¾ç-flat-flatmap",normalizedTitle:"æ°ç»å®ä¾ç flat()ï¼flatmap()",charIndex:13583},{level:2,title:"æ°ç»çç©ºä½",slug:"æ°ç»çç©ºä½",normalizedTitle:"æ°ç»çç©ºä½",charIndex:14764},{level:2,title:"Array.prototype.sort() çæåºç¨³å®æ§",slug:"array-prototype-sort-çæåºç¨³å®æ§",normalizedTitle:"array.prototype.sort() çæåºç¨³å®æ§",charIndex:16595}],excerpt:'<h1 id="æ°ç»çæ©å±"><a class="header-anchor" href="#æ°ç»çæ©å±">#</a> æ°ç»çæ©å±</h1>\n<h2 id="æ©å±è¿ç®ç¬¦"><a class="header-anchor" href="#æ©å±è¿ç®ç¬¦">#</a> æ©å±è¿ç®ç¬¦</h2>\n<h3 id="å«ä¹"><a class="header-anchor" href="#å«ä¹">#</a> å«ä¹</h3>\n<p>æ©å±è¿ç®ç¬¦ï¼spreadï¼æ¯ä¸ä¸ªç¹ï¼<code>...</code>ï¼ãå®å¥½æ¯ rest åæ°çéè¿ç®ï¼<strong>å°ä¸ä¸ªæ°ç»è½¬ä¸ºç¨éå·åéçåæ°åºå</strong>ã</p>\n\x3c!--beforebegin--\x3e<div class="language-javascript line-numbers-mode">\x3c!--afterbegin--\x3e<pre v-pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n<span class="token comment">// 1 2 3</span>\n\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>\n<span class="token comment">// 1 2 3 4 5</span>\n\n<span class="token punctuation">[</span><span class="token operator">...</span>document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">\'div\'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n<span class="token comment">// [&lt;div>, &lt;div>, &lt;div>]</span>\n</code></pre>\n<div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div>\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e',headersStr:"æ©å±è¿ç®ç¬¦ å«ä¹ æ¿ä»£å½æ°ç apply æ¹æ³ æ©å±è¿ç®ç¬¦çåºç¨ Array.from() Array.of() æ»æ¯è¿ååæ°å¼ç»æçæ°ç» æ°ç»å®ä¾ç copyWithin() æ°ç»å®ä¾ç find() å findIndex() æ°ç»å®ä¾ç fill() æ°ç»å®ä¾ç entries()ï¼keys() å values() æ°ç»å®ä¾ç includes() æ°ç»å®ä¾ç flat()ï¼flatMap() æ°ç»çç©ºä½ Array.prototype.sort() çæåºç¨³å®æ§",content:"# æ°ç»çæ©å±\n\n\n# æ©å±è¿ç®ç¬¦\n\n\n# å«ä¹\n\næ©å±è¿ç®ç¬¦ï¼spreadï¼æ¯ä¸ä¸ªç¹ï¼...ï¼ãå®å¥½æ¯ rest åæ°çéè¿ç®ï¼å°ä¸ä¸ªæ°ç»è½¬ä¸ºç¨éå·åéçåæ°åºåã\n\nconsole.log(...[1, 2, 3])\n// 1 2 3\n\nconsole.log(1, ...[2, 3, 4], 5)\n// 1 2 3 4 5\n\n[...document.querySelectorAll('div')]\n// [<div>, <div>, <div>]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nè¯¥è¿ç®ç¬¦ä¸»è¦ç¨äºå½æ°è°ç¨ã\n\nfunction push(array, ...items) {\n  array.push(...items);\n}\n\nfunction add(x, y) {\n  return x + y;\n}\n\nconst numbers = [4, 38];\nadd(...numbers) // 42\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼array.push(...items)åadd(...numbers)è¿ä¸¤è¡ï¼é½æ¯å½æ°çè°ç¨ï¼å®ä»¬é½ä½¿ç¨äºæ©å±è¿ç®ç¬¦ãè¯¥è¿ç®ç¬¦å°ä¸ä¸ªæ°ç»ï¼åä¸ºåæ°åºåã\n\næ©å±è¿ç®ç¬¦ä¸æ­£å¸¸çå½æ°åæ°å¯ä»¥ç»åä½¿ç¨ï¼éå¸¸çµæ´»ã\n\nfunction f(v, w, x, y, z) { }\nconst args = [0, 1];\nf(-1, ...args, 2, ...[3]);\n\n\n1\n2\n3\n\n\næ©å±è¿ç®ç¬¦åé¢è¿å¯ä»¥æ¾ç½®è¡¨è¾¾å¼ã\n\nconst arr = [\n  ...(x > 0 ? ['a'] : []),\n  'b',\n];\n\n\n1\n2\n3\n4\n\n\nå¦ææ©å±è¿ç®ç¬¦åé¢æ¯ä¸ä¸ªç©ºæ°ç»ï¼åä¸äº§çä»»ä½ææã\n\n[...[], 1]\n// [1]\n\n\n1\n2\n\n\næ³¨æï¼åªæå½æ°è°ç¨æ¶ï¼æ©å±è¿ç®ç¬¦æå¯ä»¥æ¾å¨åæ¬å·ä¸­ï¼å¦åä¼æ¥éã\n\n(...[1, 2])\n// Uncaught SyntaxError: Unexpected number\n\nconsole.log((...[1, 2]))\n// Uncaught SyntaxError: Unexpected number\n\nconsole.log(...[1, 2])\n// 1 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä¸ç§æåµï¼æ©å±è¿ç®ç¬¦é½æ¾å¨åæ¬å·éé¢ï¼ä½æ¯åä¸¤ç§æåµä¼æ¥éï¼å ä¸ºæ©å±è¿ç®ç¬¦æå¨çæ¬å·ä¸æ¯å½æ°è°ç¨ã\n\n\n# æ¿ä»£å½æ°ç apply æ¹æ³\n\nç±äºæ©å±è¿ç®ç¬¦å¯ä»¥å±å¼æ°ç»ï¼æä»¥ä¸åéè¦applyæ¹æ³ï¼å°æ°ç»è½¬ä¸ºå½æ°çåæ°äºã\n\n// ES5 çåæ³\nfunction f(x, y, z) {\n  // ...\n}\nvar args = [0, 1, 2];\nf.apply(null, args);\n\n// ES6çåæ³\nfunction f(x, y, z) {\n  // ...\n}\nlet args = [0, 1, 2];\nf(...args);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢æ¯æ©å±è¿ç®ç¬¦åä»£applyæ¹æ³çä¸ä¸ªå®éçä¾å­ï¼åºç¨Math.maxæ¹æ³ï¼ç®åæ±åºä¸ä¸ªæ°ç»æå¤§åç´ çåæ³ã\n\n// ES5 çåæ³\nMath.max.apply(null, [14, 3, 77])\n\n// ES6 çåæ³\nMath.max(...[14, 3, 77])\n\n// ç­åäº\nMath.max(14, 3, 77);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äº JavaScript ä¸æä¾æ±æ°ç»æå¤§åç´ çå½æ°ï¼æä»¥åªè½å¥ç¨Math.maxå½æ°ï¼å°æ°ç»è½¬ä¸ºä¸ä¸ªåæ°åºåï¼ç¶åæ±æå¤§å¼ãæäºæ©å±è¿ç®ç¬¦ä»¥åï¼å°±å¯ä»¥ç´æ¥ç¨Math.maxäºã\n\nå¦ä¸ä¸ªä¾å­æ¯éè¿pushå½æ°ï¼å°ä¸ä¸ªæ°ç»æ·»å å°å¦ä¸ä¸ªæ°ç»çå°¾é¨ã\n\n// ES5ç åæ³\nvar arr1 = [0, 1, 2];\nvar arr2 = [3, 4, 5];\nArray.prototype.push.apply(arr1, arr2);\n\n// ES6 çåæ³\nlet arr1 = [0, 1, 2];\nlet arr2 = [3, 4, 5];\narr1.push(...arr2);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ç ES5 åæ³ä¸­ï¼pushæ¹æ³çåæ°ä¸è½æ¯æ°ç»ï¼æä»¥åªå¥½éè¿applyæ¹æ³åéä½¿ç¨pushæ¹æ³ãæäºæ©å±è¿ç®ç¬¦ï¼å°±å¯ä»¥ç´æ¥å°æ°ç»ä¼ å¥pushæ¹æ³ã\n\nä¸é¢æ¯å¦å¤ä¸ä¸ªä¾å­ã\n\n// ES5\nnew (Date.bind.apply(Date, [null, 2015, 1, 1]))\n// ES6\nnew Date(...[2015, 1, 1]);\n\n\n1\n2\n3\n4\n\n\n\n# æ©å±è¿ç®ç¬¦çåºç¨\n\nï¼1ï¼å¤å¶æ°ç»\n\næ°ç»æ¯å¤åçæ°æ®ç±»åï¼ç´æ¥å¤å¶çè¯ï¼åªæ¯å¤å¶äºæååºå±æ°æ®ç»æçæéï¼èä¸æ¯åéä¸ä¸ªå¨æ°çæ°ç»ã\n\nconst a1 = [1, 2];\nconst a2 = a1;\n\na2[0] = 2;\na1 // [2, 2]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼a2å¹¶ä¸æ¯a1çåéï¼èæ¯æååä¸ä»½æ°æ®çå¦ä¸ä¸ªæéãä¿®æ¹a2ï¼ä¼ç´æ¥å¯¼è´a1çååã\n\nES5 åªè½ç¨åéæ¹æ³æ¥å¤å¶æ°ç»ã\n\nconst a1 = [1, 2];\nconst a2 = a1.concat();\n\na2[0] = 2;\na1 // [1, 2]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼a1ä¼è¿ååæ°ç»çåéï¼åä¿®æ¹a2å°±ä¸ä¼å¯¹a1äº§çå½±åã\n\næ©å±è¿ç®ç¬¦æä¾äºå¤å¶æ°ç»çç®ä¾¿åæ³ã\n\nconst a1 = [1, 2];\n// åæ³ä¸\nconst a2 = [...a1];\n// åæ³äº\nconst [...a2] = a1;\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çä¸¤ç§åæ³ï¼a2é½æ¯a1çåéã\n\nï¼2ï¼åå¹¶æ°ç»\n\næ©å±è¿ç®ç¬¦æä¾äºæ°ç»åå¹¶çæ°åæ³ã\n\nconst arr1 = ['a', 'b'];\nconst arr2 = ['c'];\nconst arr3 = ['d', 'e'];\n\n// ES5 çåå¹¶æ°ç»\narr1.concat(arr2, arr3);\n// [ 'a', 'b', 'c', 'd', 'e' ]\n\n// ES6 çåå¹¶æ°ç»\n[...arr1, ...arr2, ...arr3]\n// [ 'a', 'b', 'c', 'd', 'e' ]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸è¿ï¼è¿ä¸¤ç§æ¹æ³é½æ¯æµæ·è´ï¼ä½¿ç¨çæ¶åéè¦æ³¨æã\n\nconst a1 = [{ foo: 1 }];\nconst a2 = [{ bar: 2 }];\n\nconst a3 = a1.concat(a2);\nconst a4 = [...a1, ...a2];\n\na3[0] === a1[0] // true\na4[0] === a1[0] // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼a3åa4æ¯ç¨ä¸¤ç§ä¸åæ¹æ³åå¹¶èæçæ°æ°ç»ï¼ä½æ¯å®ä»¬çæåé½æ¯å¯¹åæ°ç»æåçå¼ç¨ï¼è¿å°±æ¯æµæ·è´ãå¦æä¿®æ¹äºå¼ç¨æåçå¼ï¼ä¼åæ­¥åæ å°æ°æ°ç»ã\n\nï¼3ï¼ä¸è§£æèµå¼ç»å\n\næ©å±è¿ç®ç¬¦å¯ä»¥ä¸è§£æèµå¼ç»åèµ·æ¥ï¼ç¨äºçææ°ç»ã\n\n// ES5\na = list[0], rest = list.slice(1)\n// ES6\n[a, ...rest] = list\n\n\n1\n2\n3\n4\n\n\nä¸é¢æ¯å¦å¤ä¸äºä¾å­ã\n\nconst [first, ...rest] = [1, 2, 3, 4, 5];\nfirst // 1\nrest  // [2, 3, 4, 5]\n\nconst [first, ...rest] = [];\nfirst // undefined\nrest  // []\n\nconst [first, ...rest] = [\"foo\"];\nfirst  // \"foo\"\nrest   // []\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¦æå°æ©å±è¿ç®ç¬¦ç¨äºæ°ç»èµå¼ï¼åªè½æ¾å¨åæ°çæåä¸ä½ï¼å¦åä¼æ¥éã\n\nconst [...butLast, last] = [1, 2, 3, 4, 5];\n// æ¥é\n\nconst [first, ...middle, last] = [1, 2, 3, 4, 5];\n// æ¥é\n\n\n1\n2\n3\n4\n5\n\n\nï¼4ï¼å­ç¬¦ä¸²\n\næ©å±è¿ç®ç¬¦è¿å¯ä»¥å°å­ç¬¦ä¸²è½¬ä¸ºçæ­£çæ°ç»ã\n\n[...'hello']\n// [ \"h\", \"e\", \"l\", \"l\", \"o\" ]\n\n\n1\n2\n\n\nä¸é¢çåæ³ï¼æä¸ä¸ªéè¦çå¥½å¤ï¼é£å°±æ¯è½å¤æ­£ç¡®è¯å«åä¸ªå­èç Unicode å­ç¬¦ã\n\n'x\\uD83D\\uDE80y'.length // 4\n[...'x\\uD83D\\uDE80y'].length // 3\n\n\n1\n2\n\n\nä¸é¢ä»£ç çç¬¬ä¸ç§åæ³ï¼JavaScript ä¼å°åä¸ªå­èç Unicode å­ç¬¦ï¼è¯å«ä¸º 2 ä¸ªå­ç¬¦ï¼éç¨æ©å±è¿ç®ç¬¦å°±æ²¡æè¿ä¸ªé®é¢ãå æ­¤ï¼æ­£ç¡®è¿åå­ç¬¦ä¸²é¿åº¦çå½æ°ï¼å¯ä»¥åä¸é¢è¿æ ·åã\n\nfunction length(str) {\n  return [...str].length;\n}\n\nlength('x\\uD83D\\uDE80y') // 3\n\n\n1\n2\n3\n4\n5\n\n\nå¡æ¯æ¶åå°æä½åä¸ªå­èç Unicode å­ç¬¦çå½æ°ï¼é½æè¿ä¸ªé®é¢ãå æ­¤ï¼æå¥½é½ç¨æ©å±è¿ç®ç¬¦æ¹åã\n\nlet str = 'x\\uD83D\\uDE80y';\n\nstr.split('').reverse().join('')\n// 'y\\uDE80\\uD83Dx'\n\n[...str].reverse().join('')\n// 'y\\uD83D\\uDE80x'\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æä¸ç¨æ©å±è¿ç®ç¬¦ï¼å­ç¬¦ä¸²çreverseæä½å°±ä¸æ­£ç¡®ã\n\nï¼5ï¼å®ç°äº Iterator æ¥å£çå¯¹è±¡\n\nä»»ä½å®ä¹äºéåå¨ï¼Iteratorï¼æ¥å£çå¯¹è±¡ï¼åé Iterator ä¸ç« ï¼ï¼é½å¯ä»¥ç¨æ©å±è¿ç®ç¬¦è½¬ä¸ºçæ­£çæ°ç»ã\n\nlet nodeList = document.querySelectorAll('div');\nlet array = [...nodeList];\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼querySelectorAllæ¹æ³è¿åçæ¯ä¸ä¸ªNodeListå¯¹è±¡ãå®ä¸æ¯æ°ç»ï¼èæ¯ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ãè¿æ¶ï¼æ©å±è¿ç®ç¬¦å¯ä»¥å°å¶è½¬ä¸ºçæ­£çæ°ç»ï¼åå å°±å¨äºNodeListå¯¹è±¡å®ç°äº Iterator ã\n\nNumber.prototype[Symbol.iterator] = function*() {\n  let i = 0;\n  let num = this.valueOf();\n  while (i < num) {\n    yield i++;\n  }\n}\n\nconsole.log([...5]) // [0, 1, 2, 3, 4]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼åå®ä¹äºNumberå¯¹è±¡çéåå¨æ¥å£ï¼æ©å±è¿ç®ç¬¦å°5èªå¨è½¬æNumberå®ä¾ä»¥åï¼å°±ä¼è°ç¨è¿ä¸ªæ¥å£ï¼å°±ä¼è¿åèªå®ä¹çç»æã\n\nå¯¹äºé£äºæ²¡æé¨ç½² Iterator æ¥å£çç±»ä¼¼æ°ç»çå¯¹è±¡ï¼æ©å±è¿ç®ç¬¦å°±æ æ³å°å¶è½¬ä¸ºçæ­£çæ°ç»ã\n\nlet arrayLike = {\n  '0': 'a',\n  '1': 'b',\n  '2': 'c',\n  length: 3\n};\n\n// TypeError: Cannot spread non-iterable object.\nlet arr = [...arrayLike];\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼arrayLikeæ¯ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ï¼ä½æ¯æ²¡æé¨ç½² Iterator æ¥å£ï¼æ©å±è¿ç®ç¬¦å°±ä¼æ¥éãè¿æ¶ï¼å¯ä»¥æ¹ä¸ºä½¿ç¨Array.fromæ¹æ³å°arrayLikeè½¬ä¸ºçæ­£çæ°ç»ã\n\nï¼6ï¼Map å Set ç»æï¼Generator å½æ°\n\næ©å±è¿ç®ç¬¦åé¨è°ç¨çæ¯æ°æ®ç»æç Iterator æ¥å£ï¼å æ­¤åªè¦å·æ Iterator æ¥å£çå¯¹è±¡ï¼é½å¯ä»¥ä½¿ç¨æ©å±è¿ç®ç¬¦ï¼æ¯å¦ Map ç»æã\n\nlet map = new Map([\n  [1, 'one'],\n  [2, 'two'],\n  [3, 'three'],\n]);\n\nlet arr = [...map.keys()]; // [1, 2, 3]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nGenerator å½æ°è¿è¡åï¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼å æ­¤ä¹å¯ä»¥ä½¿ç¨æ©å±è¿ç®ç¬¦ã\n\nconst go = function*(){\n  yield 1;\n  yield 2;\n  yield 3;\n};\n\n[...go()] // [1, 2, 3]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åégoæ¯ä¸ä¸ª Generator å½æ°ï¼æ§è¡åè¿åçæ¯ä¸ä¸ªéåå¨å¯¹è±¡ï¼å¯¹è¿ä¸ªéåå¨å¯¹è±¡æ§è¡æ©å±è¿ç®ç¬¦ï¼å°±ä¼å°åé¨éåå¾å°çå¼ï¼è½¬ä¸ºä¸ä¸ªæ°ç»ã\n\nå¦æå¯¹æ²¡æ Iterator æ¥å£çå¯¹è±¡ï¼ä½¿ç¨æ©å±è¿ç®ç¬¦ï¼å°ä¼æ¥éã\n\nconst obj = {a: 1, b: 2};\nlet arr = [...obj]; // TypeError: Cannot spread non-iterable object\n\n\n1\n2\n\n\n\n# Array.from()\n\nArray.fromæ¹æ³ç¨äºå°ä¸¤ç±»å¯¹è±¡è½¬ä¸ºçæ­£çæ°ç»ï¼ç±»ä¼¼æ°ç»çå¯¹è±¡ï¼array-like objectï¼åå¯éåï¼iterableï¼çå¯¹è±¡ï¼åæ¬ ES6 æ°å¢çæ°æ®ç»æ Set å Mapï¼ã\n\nä¸é¢æ¯ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ï¼Array.fromå°å®è½¬ä¸ºçæ­£çæ°ç»ã\n\nlet arrayLike = {\n    '0': 'a',\n    '1': 'b',\n    '2': 'c',\n    length: 3\n};\n\n// ES5çåæ³\nvar arr1 = [].slice.call(arrayLike); // ['a', 'b', 'c']\n\n// ES6çåæ³\nlet arr2 = Array.from(arrayLike); // ['a', 'b', 'c']\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå®éåºç¨ä¸­ï¼å¸¸è§çç±»ä¼¼æ°ç»çå¯¹è±¡æ¯ DOM æä½è¿åç NodeList éåï¼ä»¥åå½æ°åé¨çargumentså¯¹è±¡ãArray.fromé½å¯ä»¥å°å®ä»¬è½¬ä¸ºçæ­£çæ°ç»ã\n\n// NodeListå¯¹è±¡\nlet ps = document.querySelectorAll('p');\nArray.from(ps).filter(p => {\n  return p.textContent.length > 100;\n});\n\n// argumentså¯¹è±¡\nfunction foo() {\n  var args = Array.from(arguments);\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼querySelectorAllæ¹æ³è¿åçæ¯ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ï¼å¯ä»¥å°è¿ä¸ªå¯¹è±¡è½¬ä¸ºçæ­£çæ°ç»ï¼åä½¿ç¨filteræ¹æ³ã\n\nåªè¦æ¯é¨ç½²äº Iterator æ¥å£çæ°æ®ç»æï¼Array.fromé½è½å°å¶è½¬ä¸ºæ°ç»ã\n\nArray.from('hello')\n// ['h', 'e', 'l', 'l', 'o']\n\nlet namesSet = new Set(['a', 'b'])\nArray.from(namesSet) // ['a', 'b']\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç¬¦ä¸²å Set ç»æé½å·æ Iterator æ¥å£ï¼å æ­¤å¯ä»¥è¢«Array.fromè½¬ä¸ºçæ­£çæ°ç»ã\n\nå¦æåæ°æ¯ä¸ä¸ªçæ­£çæ°ç»ï¼Array.fromä¼è¿åä¸ä¸ªä¸æ¨¡ä¸æ ·çæ°æ°ç»ã\n\nArray.from([1, 2, 3])\n// [1, 2, 3]\n\n\n1\n2\n\n\nå¼å¾æéçæ¯ï¼æ©å±è¿ç®ç¬¦ï¼...ï¼ä¹å¯ä»¥å°æäºæ°æ®ç»æè½¬ä¸ºæ°ç»ã\n\n// argumentså¯¹è±¡\nfunction foo() {\n  const args = [...arguments];\n}\n\n// NodeListå¯¹è±¡\n[...document.querySelectorAll('div')]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næ©å±è¿ç®ç¬¦èåè°ç¨çæ¯éåå¨æ¥å£ï¼Symbol.iteratorï¼ï¼å¦æä¸ä¸ªå¯¹è±¡æ²¡æé¨ç½²è¿ä¸ªæ¥å£ï¼å°±æ æ³è½¬æ¢ãArray.fromæ¹æ³è¿æ¯æç±»ä¼¼æ°ç»çå¯¹è±¡ãæè°ç±»ä¼¼æ°ç»çå¯¹è±¡ï¼æ¬è´¨ç¹å¾åªæä¸ç¹ï¼å³å¿é¡»ælengthå±æ§ãå æ­¤ï¼ä»»ä½ælengthå±æ§çå¯¹è±¡ï¼é½å¯ä»¥éè¿Array.fromæ¹æ³è½¬ä¸ºæ°ç»ï¼èæ­¤æ¶æ©å±è¿ç®ç¬¦å°±æ æ³è½¬æ¢ã\n\nArray.from({ length: 3 });\n// [ undefined, undefined, undefined ]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼Array.fromè¿åäºä¸ä¸ªå·æä¸ä¸ªæåçæ°ç»ï¼æ¯ä¸ªä½ç½®çå¼é½æ¯undefinedãæ©å±è¿ç®ç¬¦è½¬æ¢ä¸äºè¿ä¸ªå¯¹è±¡ã\n\nå¯¹äºè¿æ²¡æé¨ç½²è¯¥æ¹æ³çæµè§å¨ï¼å¯ä»¥ç¨Array.prototype.sliceæ¹æ³æ¿ä»£ã\n\nconst toArray = (() =>\n  Array.from ? Array.from : obj => [].slice.call(obj)\n)();\n\n\n1\n2\n3\n\n\nArray.fromè¿å¯ä»¥æ¥åç¬¬äºä¸ªåæ°ï¼ä½ç¨ç±»ä¼¼äºæ°ç»çmapæ¹æ³ï¼ç¨æ¥å¯¹æ¯ä¸ªåç´ è¿è¡å¤çï¼å°å¤çåçå¼æ¾å¥è¿åçæ°ç»ã\n\nArray.from(arrayLike, x => x * x);\n// ç­åäº\nArray.from(arrayLike).map(x => x * x);\n\nArray.from([1, 2, 3], (x) => x * x)\n// [1, 4, 9]\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢çä¾å­æ¯ååºä¸ç» DOM èç¹çææ¬åå®¹ã\n\nlet spans = document.querySelectorAll('span.name');\n\n// map()\nlet names1 = Array.prototype.map.call(spans, s => s.textContent);\n\n// Array.from()\nlet names2 = Array.from(spans, s => s.textContent)\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢çä¾å­å°æ°ç»ä¸­å¸å°å¼ä¸ºfalseçæåè½¬ä¸º0ã\n\nArray.from([1, , 2, , 3], (n) => n || 0)\n// [1, 0, 2, 0, 3]\n\n\n1\n2\n\n\nå¦ä¸ä¸ªä¾å­æ¯è¿ååç§æ°æ®çç±»åã\n\nfunction typesOf () {\n  return Array.from(arguments, value => typeof value)\n}\ntypesOf(null, [], NaN)\n// ['object', 'object', 'number']\n\n\n1\n2\n3\n4\n5\n\n\nå¦æmapå½æ°éé¢ç¨å°äºthiså³é®å­ï¼è¿å¯ä»¥ä¼ å¥Array.fromçç¬¬ä¸ä¸ªåæ°ï¼ç¨æ¥ç»å®thisã\n\nArray.from()å¯ä»¥å°åç§å¼è½¬ä¸ºçæ­£çæ°ç»ï¼å¹¶ä¸è¿æä¾mapåè½ãè¿å®éä¸æå³çï¼åªè¦æä¸ä¸ªåå§çæ°æ®ç»æï¼ä½ å°±å¯ä»¥åå¯¹å®çå¼è¿è¡å¤çï¼ç¶åè½¬æè§èçæ°ç»ç»æï¼è¿èå°±å¯ä»¥ä½¿ç¨æ°éä¼å¤çæ°ç»æ¹æ³ã\n\nArray.from({ length: 2 }, () => 'jack')\n// ['jack', 'jack']\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼Array.fromçç¬¬ä¸ä¸ªåæ°æå®äºç¬¬äºä¸ªåæ°è¿è¡çæ¬¡æ°ãè¿ç§ç¹æ§å¯ä»¥è®©è¯¥æ¹æ³çç¨æ³åå¾éå¸¸çµæ´»ã\n\nArray.from()çå¦ä¸ä¸ªåºç¨æ¯ï¼å°å­ç¬¦ä¸²è½¬ä¸ºæ°ç»ï¼ç¶åè¿åå­ç¬¦ä¸²çé¿åº¦ãå ä¸ºå®è½æ­£ç¡®å¤çåç§ Unicode å­ç¬¦ï¼å¯ä»¥é¿å JavaScript å°å¤§äº\\uFFFFç Unicode å­ç¬¦ï¼ç®ä½ä¸¤ä¸ªå­ç¬¦ç bugã\n\nfunction countSymbols(string) {\n  return Array.from(string).length;\n}\n\n\n1\n2\n3\n\n\n\n# Array.of() æ»æ¯è¿ååæ°å¼ç»æçæ°ç»\n\nArray.ofæ¹æ³ç¨äºå°ä¸ç»å¼ï¼è½¬æ¢ä¸ºæ°ç»ã\n\nArray.of(3, 11, 8) // [3,11,8]\nArray.of(3) // [3]\nArray.of(3).length // 1\n\n\n1\n2\n3\n\n\nè¿ä¸ªæ¹æ³çä¸»è¦ç®çï¼æ¯å¼¥è¡¥æ°ç»æé å½æ°Array()çä¸è¶³ãå ä¸ºåæ°ä¸ªæ°çä¸åï¼ä¼å¯¼è´Array()çè¡ä¸ºæå·®å¼ã\n\nArray() // []\nArray(3) // [, , ,]\nArray(3, 11, 8) // [3, 11, 8]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼Arrayæ¹æ³æ²¡æåæ°ãä¸ä¸ªåæ°ãä¸ä¸ªåæ°æ¶ï¼è¿åç»æé½ä¸ä¸æ ·ãåªæå½åæ°ä¸ªæ°ä¸å°äº 2 ä¸ªæ¶ï¼Array()æä¼è¿åç±åæ°ç»æçæ°æ°ç»ãåæ°ä¸ªæ°åªæä¸ä¸ªæ¶ï¼å®éä¸æ¯æå®æ°ç»çé¿åº¦ã\n\nArray.ofåºæ¬ä¸å¯ä»¥ç¨æ¥æ¿ä»£Array()ænew Array()ï¼å¹¶ä¸ä¸å­å¨ç±äºåæ°ä¸åèå¯¼è´çéè½½ãå®çè¡ä¸ºéå¸¸ç»ä¸ã\n\nArray.of() // []\nArray.of(undefined) // [undefined]\nArray.of(1) // [1]\nArray.of(1, 2) // [1, 2]\n\n\n1\n2\n3\n4\n\n\nArray.ofæ»æ¯è¿ååæ°å¼ç»æçæ°ç»ãå¦ææ²¡æåæ°ï¼å°±è¿åä¸ä¸ªç©ºæ°ç»ã\n\nArray.ofæ¹æ³å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æå®ç°ã\n\nfunction ArrayOf(){\n  return [].slice.call(arguments);\n}\n\n\n1\n2\n3\n\n\n\n# æ°ç»å®ä¾ç copyWithin()\n\næ°ç»å®ä¾çcopyWithin()æ¹æ³ï¼å¨å½åæ°ç»åé¨ï¼å°æå®ä½ç½®çæåå¤å¶å°å¶ä»ä½ç½®ï¼ä¼è¦çåææåï¼ï¼ç¶åè¿åå½åæ°ç»ãä¹å°±æ¯è¯´ï¼ä½¿ç¨è¿ä¸ªæ¹æ³ï¼ä¼ä¿®æ¹å½åæ°ç»ã\n\nArray.prototype.copyWithin(target, start = 0, end = this.length)\n\n\n1\n\n\nå®æ¥åä¸ä¸ªåæ°ã\n\n * targetï¼å¿éï¼ï¼ä»è¯¥ä½ç½®å¼å§æ¿æ¢æ°æ®ãå¦æä¸ºè´å¼ï¼è¡¨ç¤ºåæ°ã\n * startï¼å¯éï¼ï¼ä»è¯¥ä½ç½®å¼å§è¯»åæ°æ®ï¼é»è®¤ä¸º 0ãå¦æä¸ºè´å¼ï¼è¡¨ç¤ºä»æ«å°¾å¼å§è®¡ç®ã\n * endï¼å¯éï¼ï¼å°è¯¥ä½ç½®ååæ­¢è¯»åæ°æ®ï¼é»è®¤ç­äºæ°ç»é¿åº¦ãå¦æä¸ºè´å¼ï¼è¡¨ç¤ºä»æ«å°¾å¼å§è®¡ç®ã\n\nè¿ä¸ä¸ªåæ°é½åºè¯¥æ¯æ°å¼ï¼å¦æä¸æ¯ï¼ä¼èªå¨è½¬ä¸ºæ°å¼ã\n\n[1, 2, 3, 4, 5].copyWithin(0, 3)\n// [4, 5, 3, 4, 5]\n\n\n1\n2\n\n\nä¸é¢ä»£ç è¡¨ç¤ºå°ä» 3 å·ä½ç´å°æ°ç»ç»æçæåï¼4 å 5ï¼ï¼å¤å¶å°ä» 0 å·ä½å¼å§çä½ç½®ï¼ç»æè¦çäºåæ¥ç 1 å 2ã\n\nä¸é¢æ¯æ´å¤ä¾å­ã\n\n// å°3å·ä½å¤å¶å°0å·ä½\n[1, 2, 3, 4, 5].copyWithin(0, 3, 4)\n// [4, 2, 3, 4, 5]\n\n// -2ç¸å½äº3å·ä½ï¼-1ç¸å½äº4å·ä½\n[1, 2, 3, 4, 5].copyWithin(0, -2, -1)\n// [4, 2, 3, 4, 5]\n\n// å°3å·ä½å¤å¶å°0å·ä½\n[].copyWithin.call({length: 5, 3: 1}, 0, 3)\n// {0: 1, 3: 1, length: 5}\n\n// å°2å·ä½å°æ°ç»ç»æï¼å¤å¶å°0å·ä½\nlet i32a = new Int32Array([1, 2, 3, 4, 5]);\ni32a.copyWithin(0, 2);\n// Int32Array [3, 4, 5, 4, 5]\n\n// å¯¹äºæ²¡æé¨ç½² TypedArray ç copyWithin æ¹æ³çå¹³å°\n// éè¦éç¨ä¸é¢çåæ³\n[].copyWithin.call(new Int32Array([1, 2, 3, 4, 5]), 0, 3, 4);\n// Int32Array [4, 2, 3, 4, 5]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n\n# æ°ç»å®ä¾ç find() å findIndex()\n\næ°ç»å®ä¾çfindæ¹æ³ï¼ç¨äºæ¾åºç¬¬ä¸ä¸ªç¬¦åæ¡ä»¶çæ°ç»æåãå®çåæ°æ¯ä¸ä¸ªåè°å½æ°ï¼æææ°ç»æåä¾æ¬¡æ§è¡è¯¥åè°å½æ°ï¼ç´å°æ¾åºç¬¬ä¸ä¸ªè¿åå¼ä¸ºtrueçæåï¼ç¶åè¿åè¯¥æåãå¦ææ²¡æç¬¦åæ¡ä»¶çæåï¼åè¿åundefinedã\n\n[1, 4, -5, 10].find((n) => n < 0)\n// -5\n\n\n1\n2\n\n\nä¸é¢ä»£ç æ¾åºæ°ç»ä¸­ç¬¬ä¸ä¸ªå°äº 0 çæåã\n\n[1, 5, 10, 15].find(function(value, index, arr) {\n  return value > 9;\n}) // 10\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼findæ¹æ³çåè°å½æ°å¯ä»¥æ¥åä¸ä¸ªåæ°ï¼ä¾æ¬¡ä¸ºå½åçå¼ãå½åçä½ç½®ååæ°ç»ã\n\næ°ç»å®ä¾çfindIndexæ¹æ³çç¨æ³ä¸findæ¹æ³éå¸¸ç±»ä¼¼ï¼è¿åç¬¬ä¸ä¸ªç¬¦åæ¡ä»¶çæ°ç»æåçä½ç½®ï¼å¦ææææåé½ä¸ç¬¦åæ¡ä»¶ï¼åè¿å-1ã\n\n[1, 5, 10, 15].findIndex(function(value, index, arr) {\n  return value > 9;\n}) // 2\n\n\n1\n2\n3\n\n\nè¿ä¸¤ä¸ªæ¹æ³é½å¯ä»¥æ¥åç¬¬äºä¸ªåæ°ï¼ç¨æ¥ç»å®åè°å½æ°çthiså¯¹è±¡ã\n\nfunction f(v){\n  return v > this.age;\n}\nlet person = {name: 'John', age: 20};\n[10, 12, 26, 15].find(f, person);    // 26\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çä»£ç ä¸­ï¼findå½æ°æ¥æ¶äºç¬¬äºä¸ªåæ°personå¯¹è±¡ï¼åè°å½æ°ä¸­çthiså¯¹è±¡æåpersonå¯¹è±¡ã\n\nå¦å¤ï¼è¿ä¸¤ä¸ªæ¹æ³é½å¯ä»¥åç°NaNï¼å¼¥è¡¥äºæ°ç»çindexOfæ¹æ³çä¸è¶³ã\n\n[NaN].indexOf(NaN)\n// -1\n\n[NaN].findIndex(y => Object.is(NaN, y))\n// 0\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼indexOfæ¹æ³æ æ³è¯å«æ°ç»çNaNæåï¼ä½æ¯findIndexæ¹æ³å¯ä»¥åå©Object.isæ¹æ³åå°ã\n\n\n# æ°ç»å®ä¾ç fill()\n\nfillæ¹æ³ä½¿ç¨ç»å®å¼ï¼å¡«åä¸ä¸ªæ°ç»ã\n\n['a', 'b', 'c'].fill(7)\n// [7, 7, 7]\n\nnew Array(3).fill(7)\n// [7, 7, 7]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç è¡¨æï¼fillæ¹æ³ç¨äºç©ºæ°ç»çåå§åéå¸¸æ¹ä¾¿ãæ°ç»ä¸­å·²æçåç´ ï¼ä¼è¢«å¨é¨æ¹å»ã\n\nfillæ¹æ³è¿å¯ä»¥æ¥åç¬¬äºä¸ªåç¬¬ä¸ä¸ªåæ°ï¼ç¨äºæå®å¡«åçèµ·å§ä½ç½®åç»æä½ç½®ã\n\n['a', 'b', 'c'].fill(7, 1, 2)\n// ['a', 7, 'c']\n\n\n1\n2\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼fillæ¹æ³ä» 1 å·ä½å¼å§ï¼ååæ°ç»å¡«å 7ï¼å° 2 å·ä½ä¹åç»æã\n\næ³¨æï¼å¦æå¡«åçç±»åä¸ºå¯¹è±¡ï¼é£ä¹è¢«èµå¼çæ¯åä¸ä¸ªåå­å°åçå¯¹è±¡ï¼èä¸æ¯æ·±æ·è´å¯¹è±¡ã\n\nlet arr = new Array(3).fill({name: \"Mike\"});\narr[0].name = \"Ben\";\narr\n// [{name: \"Ben\"}, {name: \"Ben\"}, {name: \"Ben\"}]\n\nlet arr = new Array(3).fill([]);\narr[0].push(5);\narr\n// [[5], [5], [5]]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# æ°ç»å®ä¾ç entries()ï¼keys() å values()\n\nES6 æä¾ä¸ä¸ªæ°çæ¹æ³ââentries()ï¼keys()åvalues()ââç¨äºéåæ°ç»ãå®ä»¬é½è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼è¯¦è§ãIteratorãä¸ç« ï¼ï¼å¯ä»¥ç¨for...ofå¾ªç¯è¿è¡éåï¼å¯ä¸çåºå«æ¯keys()æ¯å¯¹é®åçéåãvalues()æ¯å¯¹é®å¼çéåï¼entries()æ¯å¯¹é®å¼å¯¹çéåã\n\nfor (let index of ['a', 'b'].keys()) {\n  console.log(index);\n}\n// 0\n// 1\n\nfor (let elem of ['a', 'b'].values()) {\n  console.log(elem);\n}\n// 'a'\n// 'b'\n\nfor (let [index, elem] of ['a', 'b'].entries()) {\n  console.log(index, elem);\n}\n// 0 \"a\"\n// 1 \"b\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nå¦æä¸ä½¿ç¨for...ofå¾ªç¯ï¼å¯ä»¥æå¨è°ç¨éåå¨å¯¹è±¡çnextæ¹æ³ï¼è¿è¡éåã\n\nlet letter = ['a', 'b', 'c'];\nlet entries = letter.entries();\nconsole.log(entries.next().value); // [0, 'a']\nconsole.log(entries.next().value); // [1, 'b']\nconsole.log(entries.next().value); // [2, 'c']\n\n\n1\n2\n3\n4\n5\n\n\n\n# æ°ç»å®ä¾ç includes()\n\nArray.prototype.includesæ¹æ³è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºæä¸ªæ°ç»æ¯å¦åå«ç»å®çå¼ï¼ä¸å­ç¬¦ä¸²çincludesæ¹æ³ç±»ä¼¼ãES2016 å¼å¥äºè¯¥æ¹æ³ã\n\n[1, 2, 3].includes(2)     // true\n[1, 2, 3].includes(4)     // false\n[1, 2, NaN].includes(NaN) // true\n\n\n1\n2\n3\n\n\nè¯¥æ¹æ³çç¬¬äºä¸ªåæ°è¡¨ç¤ºæç´¢çèµ·å§ä½ç½®ï¼é»è®¤ä¸º0ãå¦æç¬¬äºä¸ªåæ°ä¸ºè´æ°ï¼åè¡¨ç¤ºåæ°çä½ç½®ï¼å¦æè¿æ¶å®å¤§äºæ°ç»é¿åº¦ï¼æ¯å¦ç¬¬äºä¸ªåæ°ä¸º-4ï¼ä½æ°ç»é¿åº¦ä¸º3ï¼ï¼åä¼éç½®ä¸ºä»0å¼å§ã\n\n[1, 2, 3].includes(3, 3);  // false\n[1, 2, 3].includes(3, -1); // true\n\n\n1\n2\n\n\næ²¡æè¯¥æ¹æ³ä¹åï¼æä»¬éå¸¸ä½¿ç¨æ°ç»çindexOfæ¹æ³ï¼æ£æ¥æ¯å¦åå«æä¸ªå¼ã\n\nif (arr.indexOf(el) !== -1) {\n  // ...\n}\n\n\n1\n2\n3\n\n\nindexOfæ¹æ³æä¸¤ä¸ªç¼ºç¹ï¼ä¸æ¯ä¸å¤è¯­ä¹åï¼å®çå«ä¹æ¯æ¾å°åæ°å¼çç¬¬ä¸ä¸ªåºç°ä½ç½®ï¼æä»¥è¦å»æ¯è¾æ¯å¦ä¸ç­äº-1ï¼è¡¨è¾¾èµ·æ¥ä¸å¤ç´è§ãäºæ¯ï¼å®åé¨ä½¿ç¨ä¸¥æ ¼ç¸ç­è¿ç®ç¬¦ï¼===ï¼è¿è¡å¤æ­ï¼è¿ä¼å¯¼è´å¯¹NaNçè¯¯å¤ã\n\n[NaN].indexOf(NaN)\n// -1\n\n\n1\n2\n\n\nincludesä½¿ç¨çæ¯ä¸ä¸æ ·çå¤æ­ç®æ³ï¼å°±æ²¡æè¿ä¸ªé®é¢ã\n\n[NaN].includes(NaN)\n// true\n\n\n1\n2\n\n\nä¸é¢ä»£ç ç¨æ¥æ£æ¥å½åç¯å¢æ¯å¦æ¯æè¯¥æ¹æ³ï¼å¦æä¸æ¯æï¼é¨ç½²ä¸ä¸ªç®æçæ¿ä»£çæ¬ã\n\nconst contains = (() =>\n  Array.prototype.includes\n    ? (arr, value) => arr.includes(value)\n    : (arr, value) => arr.some(el => el === value)\n)();\ncontains(['foo', 'bar'], 'baz'); // => false\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¦å¤ï¼Map å Set æ°æ®ç»ææä¸ä¸ªhasæ¹æ³ï¼éè¦æ³¨æä¸includesåºåã\n\n * Map ç»æçhasæ¹æ³ï¼æ¯ç¨æ¥æ¥æ¾é®åçï¼æ¯å¦Map.prototype.has(key)ãWeakMap.prototype.has(key)ãReflect.has(target, propertyKey)ã\n * Set ç»æçhasæ¹æ³ï¼æ¯ç¨æ¥æ¥æ¾å¼çï¼æ¯å¦Set.prototype.has(value)ãWeakSet.prototype.has(value)ã\n\n\n# æ°ç»å®ä¾ç flat()ï¼flatMap()\n\næ°ç»çæåææ¶è¿æ¯æ°ç»ï¼Array.prototype.flat()ç¨äºå°åµå¥çæ°ç»âæå¹³âï¼åæä¸ç»´çæ°ç»ãè¯¥æ¹æ³è¿åä¸ä¸ªæ°æ°ç»ï¼å¯¹åæ°æ®æ²¡æå½±åã\n\n[1, 2, [3, 4]].flat()\n// [1, 2, 3, 4]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°ç»çæåéé¢æä¸ä¸ªæ°ç»ï¼flat()æ¹æ³å°å­æ°ç»çæåååºæ¥ï¼æ·»å å¨åæ¥çä½ç½®ã\n\nflat()é»è®¤åªä¼âæå¹³âä¸å±ï¼å¦ææ³è¦âæå¹³âå¤å±çåµå¥æ°ç»ï¼å¯ä»¥å°flat()æ¹æ³çåæ°åæä¸ä¸ªæ´æ°ï¼è¡¨ç¤ºæ³è¦æå¹³çå±æ°ï¼é»è®¤ä¸º1ã\n\n[1, 2, [3, [4, 5]]].flat()\n// [1, 2, 3, [4, 5]]\n\n[1, 2, [3, [4, 5]]].flat(2)\n// [1, 2, 3, 4, 5]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼flat()çåæ°ä¸º2ï¼è¡¨ç¤ºè¦âæå¹³âä¸¤å±çåµå¥æ°ç»ã\n\nå¦æä¸ç®¡æå¤å°å±åµå¥ï¼é½è¦è½¬æä¸ç»´æ°ç»ï¼å¯ä»¥ç¨Infinityå³é®å­ä½ä¸ºåæ°ã\n\n[1, [2, [3]]].flat(Infinity)\n// [1, 2, 3]\n\n\n1\n2\n\n\nå¦æåæ°ç»æç©ºä½ï¼flat()æ¹æ³ä¼è·³è¿ç©ºä½ã\n\n[1, 2, , 4, 5].flat()\n// [1, 2, 4, 5]\n\n\n1\n2\n\n\nflatMap()æ¹æ³å¯¹åæ°ç»çæ¯ä¸ªæåæ§è¡ä¸ä¸ªå½æ°ï¼ç¸å½äºæ§è¡Array.prototype.map()ï¼ï¼ç¶åå¯¹è¿åå¼ç»æçæ°ç»æ§è¡flat()æ¹æ³ãè¯¥æ¹æ³è¿åä¸ä¸ªæ°æ°ç»ï¼ä¸æ¹ååæ°ç»ã\n\n// ç¸å½äº [2, 3, 4].map(x => [x, x*2]).flat()\n[2, 3, 4].flatMap((x) => [x, x * 2])\n// [2, 4, 3, 6, 4, 8]\n\n\n1\n2\n3\n\n\nflatMap()åªè½å±å¼ä¸å±æ°ç»ã\n\n// ç¸å½äº [[[2]], [[4]], [[6]], [[8]]].flat()\n[1, 2, 3, 4].flatMap(x => [[x * 2]])\n// [[2], [4], [6], [8]]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼éåå½æ°è¿åçæ¯ä¸ä¸ªåå±çæ°ç»ï¼ä½æ¯é»è®¤åªè½å±å¼ä¸å±ï¼å æ­¤flatMap()è¿åçè¿æ¯ä¸ä¸ªåµå¥æ°ç»ã\n\nflatMap()æ¹æ³çåæ°æ¯ä¸ä¸ªéåå½æ°ï¼è¯¥å½æ°å¯ä»¥æ¥åä¸ä¸ªåæ°ï¼åå«æ¯å½åæ°ç»æåãå½åæ°ç»æåçä½ç½®ï¼ä»é¶å¼å§ï¼ãåæ°ç»ã\n\narr.flatMap(function callback(currentValue[, index[, array]]) {\n  // ...\n}[, thisArg])\n\n\n1\n2\n3\n\n\nflatMap()æ¹æ³è¿å¯ä»¥æç¬¬äºä¸ªåæ°ï¼ç¨æ¥ç»å®éåå½æ°éé¢çthisã\n\n\n# æ°ç»çç©ºä½\n\næ°ç»çç©ºä½æï¼æ°ç»çæä¸ä¸ªä½ç½®æ²¡æä»»ä½å¼ãæ¯å¦ï¼Arrayæé å½æ°è¿åçæ°ç»é½æ¯ç©ºä½ã\n\nArray(3) // [, , ,]\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼Array(3)è¿åä¸ä¸ªå·æ 3 ä¸ªç©ºä½çæ°ç»ã\n\næ³¨æï¼ç©ºä½ä¸æ¯undefinedï¼ä¸ä¸ªä½ç½®çå¼ç­äºundefinedï¼ä¾ç¶æ¯æå¼çãç©ºä½æ¯æ²¡æä»»ä½å¼ï¼inè¿ç®ç¬¦å¯ä»¥è¯´æè¿ä¸ç¹ã\n\n0 in [undefined, undefined, undefined] // true\n0 in [, , ,] // false\n\n\n1\n2\n\n\nä¸é¢ä»£ç è¯´æï¼ç¬¬ä¸ä¸ªæ°ç»ç 0 å·ä½ç½®æ¯æå¼çï¼ç¬¬äºä¸ªæ°ç»ç 0 å·ä½ç½®æ²¡æå¼ã\n\nES5 å¯¹ç©ºä½çå¤çï¼å·²ç»å¾ä¸ä¸è´äºï¼å¤§å¤æ°æåµä¸ä¼å¿½ç¥ç©ºä½ã\n\n * forEach(), filter(), reduce(), every() åsome()é½ä¼è·³è¿ç©ºä½ã\n * map()ä¼è·³è¿ç©ºä½ï¼ä½ä¼ä¿çè¿ä¸ªå¼\n * join()åtoString()ä¼å°ç©ºä½è§ä¸ºundefinedï¼èundefinedånullä¼è¢«å¤çæç©ºå­ç¬¦ä¸²ã\n\n// forEachæ¹æ³\n[,'a'].forEach((x,i) => console.log(i)); // 1\n\n// filteræ¹æ³\n['a',,'b'].filter(x => true) // ['a','b']\n\n// everyæ¹æ³\n[,'a'].every(x => x==='a') // true\n\n// reduceæ¹æ³\n[1,,2].reduce((x,y) => x+y) // 3\n\n// someæ¹æ³\n[,'a'].some(x => x !== 'a') // false\n\n// mapæ¹æ³\n[,'a'].map(x => 1) // [,1]\n\n// joinæ¹æ³\n[,'a',undefined,null].join('#') // \"#a##\"\n\n// toStringæ¹æ³\n[,'a',undefined,null].toString() // \",a,,\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nES6 åæ¯æç¡®å°ç©ºä½è½¬ä¸ºundefinedã\n\nArray.fromæ¹æ³ä¼å°æ°ç»çç©ºä½ï¼è½¬ä¸ºundefinedï¼ä¹å°±æ¯è¯´ï¼è¿ä¸ªæ¹æ³ä¸ä¼å¿½ç¥ç©ºä½ã\n\nArray.from(['a',,'b'])\n// [ \"a\", undefined, \"b\" ]\n\n\n1\n2\n\n\næ©å±è¿ç®ç¬¦ï¼...ï¼ä¹ä¼å°ç©ºä½è½¬ä¸ºundefinedã\n\n[...['a',,'b']]\n// [ \"a\", undefined, \"b\" ]\n\n\n1\n2\n\n\ncopyWithin()ä¼è¿ç©ºä½ä¸èµ·æ·è´ã\n\n[,'a','b',,].copyWithin(2,0) // [,\"a\",,\"a\"]\n\n\n1\n\n\nfill()ä¼å°ç©ºä½è§ä¸ºæ­£å¸¸çæ°ç»ä½ç½®ã\n\nnew Array(3).fill('a') // [\"a\",\"a\",\"a\"]\n\n\n1\n\n\nfor...ofå¾ªç¯ä¹ä¼éåç©ºä½ã\n\nlet arr = [, ,];\nfor (let i of arr) {\n  console.log(1);\n}\n// 1\n// 1\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»arræä¸¤ä¸ªç©ºä½ï¼for...ofå¹¶æ²¡æå¿½ç¥å®ä»¬ãå¦ææ¹æmapæ¹æ³éåï¼ç©ºä½æ¯ä¼è·³è¿çã\n\nentries()ãkeys()ãvalues()ãfind()åfindIndex()ä¼å°ç©ºä½å¤çæundefinedã\n\n// entries()\n[...[,'a'].entries()] // [[0,undefined], [1,\"a\"]]\n\n// keys()\n[...[,'a'].keys()] // [0,1]\n\n// values()\n[...[,'a'].values()] // [undefined,\"a\"]\n\n// find()\n[,'a'].find(x => true) // undefined\n\n// findIndex()\n[,'a'].findIndex(x => true) // 0\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nç±äºç©ºä½çå¤çè§åéå¸¸ä¸ç»ä¸ï¼æä»¥å»ºè®®é¿ååºç°ç©ºä½ã\n\n\n# Array.prototype.sort() çæåºç¨³å®æ§\n\næåºç¨³å®æ§ï¼stable sortingï¼æ¯æåºç®æ³çéè¦å±æ§ï¼æçæ¯æåºå³é®å­ç¸åçé¡¹ç®ï¼æåºååçé¡ºåºä¸åã\n\nconst arr = [\n  'peach',\n  'straw',\n  'apple',\n  'spork'\n];\n\nconst stableSorting = (s1, s2) => {\n  if (s1[0] < s2[0]) return -1;\n  return 1;\n};\n\narr.sort(stableSorting)\n// [\"apple\", \"peach\", \"straw\", \"spork\"]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç å¯¹æ°ç»arræç§é¦å­æ¯è¿è¡æåºãæåºç»æä¸­ï¼strawå¨sporkçåé¢ï¼è·åå§é¡ºåºä¸è´ï¼æä»¥æåºç®æ³stableSortingæ¯ç¨³å®æåºã\n\nconst unstableSorting = (s1, s2) => {\n  if (s1[0] <= s2[0]) return -1;\n  return 1;\n};\n\narr.sort(unstableSorting)\n// [\"apple\", \"peach\", \"spork\", \"straw\"]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼æåºç»ææ¯sporkå¨strawåé¢ï¼è·åå§é¡ºåºç¸åï¼æä»¥æåºç®æ³unstableSortingæ¯ä¸ç¨³å®çã\n\nå¸¸è§çæåºç®æ³ä¹ä¸­ï¼æå¥æåºãåå¹¶æåºãåæ³¡æåºç­é½æ¯ç¨³å®çï¼å æåºãå¿«éæåºç­æ¯ä¸ç¨³å®çãä¸ç¨³å®æåºçä¸»è¦ç¼ºç¹æ¯ï¼å¤éæåºæ¶å¯è½ä¼äº§çé®é¢ãåè®¾æä¸ä¸ªå§ååçåè¡¨ï¼è¦æ±æç§âå§æ°ä¸ºä¸»è¦å³é®å­ï¼åå­ä¸ºæ¬¡è¦å³é®å­âè¿è¡æåºãå¼åèå¯è½ä¼åæåå­æåºï¼åæå§æ°è¿è¡æåºãå¦ææåºç®æ³æ¯ç¨³å®çï¼è¿æ ·å°±å¯ä»¥è¾¾å°âåå§æ°ï¼ååå­âçæåºææãå¦ææ¯ä¸ç¨³å®çï¼å°±ä¸è¡ã\n\næ©åç ECMAScript æ²¡æè§å®ï¼Array.prototype.sort()çé»è®¤æåºç®æ³æ¯å¦ç¨³å®ï¼çç»æµè§å¨èªå·±å³å®ï¼è¿å¯¼è´æäºå®ç°æ¯ä¸ç¨³å®çãES2019 æç¡®è§å®ï¼Array.prototype.sort()çé»è®¤æåºç®æ³å¿é¡»ç¨³å®ãè¿ä¸ªè§å®å·²ç»åå°äºï¼ç°å¨ JavaScript åä¸ªä¸»è¦å®ç°çé»è®¤æåºç®æ³é½æ¯ç¨³å®çã",normalizedContent:"# æ°ç»çæ©å±\n\n\n# æ©å±è¿ç®ç¬¦\n\n\n# å«ä¹\n\næ©å±è¿ç®ç¬¦ï¼spreadï¼æ¯ä¸ä¸ªç¹ï¼...ï¼ãå®å¥½æ¯ rest åæ°çéè¿ç®ï¼å°ä¸ä¸ªæ°ç»è½¬ä¸ºç¨éå·åéçåæ°åºåã\n\nconsole.log(...[1, 2, 3])\n// 1 2 3\n\nconsole.log(1, ...[2, 3, 4], 5)\n// 1 2 3 4 5\n\n[...document.queryselectorall('div')]\n// [<div>, <div>, <div>]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nè¯¥è¿ç®ç¬¦ä¸»è¦ç¨äºå½æ°è°ç¨ã\n\nfunction push(array, ...items) {\n  array.push(...items);\n}\n\nfunction add(x, y) {\n  return x + y;\n}\n\nconst numbers = [4, 38];\nadd(...numbers) // 42\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼array.push(...items)åadd(...numbers)è¿ä¸¤è¡ï¼é½æ¯å½æ°çè°ç¨ï¼å®ä»¬é½ä½¿ç¨äºæ©å±è¿ç®ç¬¦ãè¯¥è¿ç®ç¬¦å°ä¸ä¸ªæ°ç»ï¼åä¸ºåæ°åºåã\n\næ©å±è¿ç®ç¬¦ä¸æ­£å¸¸çå½æ°åæ°å¯ä»¥ç»åä½¿ç¨ï¼éå¸¸çµæ´»ã\n\nfunction f(v, w, x, y, z) { }\nconst args = [0, 1];\nf(-1, ...args, 2, ...[3]);\n\n\n1\n2\n3\n\n\næ©å±è¿ç®ç¬¦åé¢è¿å¯ä»¥æ¾ç½®è¡¨è¾¾å¼ã\n\nconst arr = [\n  ...(x > 0 ? ['a'] : []),\n  'b',\n];\n\n\n1\n2\n3\n4\n\n\nå¦ææ©å±è¿ç®ç¬¦åé¢æ¯ä¸ä¸ªç©ºæ°ç»ï¼åä¸äº§çä»»ä½ææã\n\n[...[], 1]\n// [1]\n\n\n1\n2\n\n\næ³¨æï¼åªæå½æ°è°ç¨æ¶ï¼æ©å±è¿ç®ç¬¦æå¯ä»¥æ¾å¨åæ¬å·ä¸­ï¼å¦åä¼æ¥éã\n\n(...[1, 2])\n// uncaught syntaxerror: unexpected number\n\nconsole.log((...[1, 2]))\n// uncaught syntaxerror: unexpected number\n\nconsole.log(...[1, 2])\n// 1 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä¸ç§æåµï¼æ©å±è¿ç®ç¬¦é½æ¾å¨åæ¬å·éé¢ï¼ä½æ¯åä¸¤ç§æåµä¼æ¥éï¼å ä¸ºæ©å±è¿ç®ç¬¦æå¨çæ¬å·ä¸æ¯å½æ°è°ç¨ã\n\n\n# æ¿ä»£å½æ°ç apply æ¹æ³\n\nç±äºæ©å±è¿ç®ç¬¦å¯ä»¥å±å¼æ°ç»ï¼æä»¥ä¸åéè¦applyæ¹æ³ï¼å°æ°ç»è½¬ä¸ºå½æ°çåæ°äºã\n\n// es5 çåæ³\nfunction f(x, y, z) {\n  // ...\n}\nvar args = [0, 1, 2];\nf.apply(null, args);\n\n// es6çåæ³\nfunction f(x, y, z) {\n  // ...\n}\nlet args = [0, 1, 2];\nf(...args);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢æ¯æ©å±è¿ç®ç¬¦åä»£applyæ¹æ³çä¸ä¸ªå®éçä¾å­ï¼åºç¨math.maxæ¹æ³ï¼ç®åæ±åºä¸ä¸ªæ°ç»æå¤§åç´ çåæ³ã\n\n// es5 çåæ³\nmath.max.apply(null, [14, 3, 77])\n\n// es6 çåæ³\nmath.max(...[14, 3, 77])\n\n// ç­åäº\nmath.max(14, 3, 77);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äº javascript ä¸æä¾æ±æ°ç»æå¤§åç´ çå½æ°ï¼æä»¥åªè½å¥ç¨math.maxå½æ°ï¼å°æ°ç»è½¬ä¸ºä¸ä¸ªåæ°åºåï¼ç¶åæ±æå¤§å¼ãæäºæ©å±è¿ç®ç¬¦ä»¥åï¼å°±å¯ä»¥ç´æ¥ç¨math.maxäºã\n\nå¦ä¸ä¸ªä¾å­æ¯éè¿pushå½æ°ï¼å°ä¸ä¸ªæ°ç»æ·»å å°å¦ä¸ä¸ªæ°ç»çå°¾é¨ã\n\n// es5ç åæ³\nvar arr1 = [0, 1, 2];\nvar arr2 = [3, 4, 5];\narray.prototype.push.apply(arr1, arr2);\n\n// es6 çåæ³\nlet arr1 = [0, 1, 2];\nlet arr2 = [3, 4, 5];\narr1.push(...arr2);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ç es5 åæ³ä¸­ï¼pushæ¹æ³çåæ°ä¸è½æ¯æ°ç»ï¼æä»¥åªå¥½éè¿applyæ¹æ³åéä½¿ç¨pushæ¹æ³ãæäºæ©å±è¿ç®ç¬¦ï¼å°±å¯ä»¥ç´æ¥å°æ°ç»ä¼ å¥pushæ¹æ³ã\n\nä¸é¢æ¯å¦å¤ä¸ä¸ªä¾å­ã\n\n// es5\nnew (date.bind.apply(date, [null, 2015, 1, 1]))\n// es6\nnew date(...[2015, 1, 1]);\n\n\n1\n2\n3\n4\n\n\n\n# æ©å±è¿ç®ç¬¦çåºç¨\n\nï¼1ï¼å¤å¶æ°ç»\n\næ°ç»æ¯å¤åçæ°æ®ç±»åï¼ç´æ¥å¤å¶çè¯ï¼åªæ¯å¤å¶äºæååºå±æ°æ®ç»æçæéï¼èä¸æ¯åéä¸ä¸ªå¨æ°çæ°ç»ã\n\nconst a1 = [1, 2];\nconst a2 = a1;\n\na2[0] = 2;\na1 // [2, 2]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼a2å¹¶ä¸æ¯a1çåéï¼èæ¯æååä¸ä»½æ°æ®çå¦ä¸ä¸ªæéãä¿®æ¹a2ï¼ä¼ç´æ¥å¯¼è´a1çååã\n\nes5 åªè½ç¨åéæ¹æ³æ¥å¤å¶æ°ç»ã\n\nconst a1 = [1, 2];\nconst a2 = a1.concat();\n\na2[0] = 2;\na1 // [1, 2]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼a1ä¼è¿ååæ°ç»çåéï¼åä¿®æ¹a2å°±ä¸ä¼å¯¹a1äº§çå½±åã\n\næ©å±è¿ç®ç¬¦æä¾äºå¤å¶æ°ç»çç®ä¾¿åæ³ã\n\nconst a1 = [1, 2];\n// åæ³ä¸\nconst a2 = [...a1];\n// åæ³äº\nconst [...a2] = a1;\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çä¸¤ç§åæ³ï¼a2é½æ¯a1çåéã\n\nï¼2ï¼åå¹¶æ°ç»\n\næ©å±è¿ç®ç¬¦æä¾äºæ°ç»åå¹¶çæ°åæ³ã\n\nconst arr1 = ['a', 'b'];\nconst arr2 = ['c'];\nconst arr3 = ['d', 'e'];\n\n// es5 çåå¹¶æ°ç»\narr1.concat(arr2, arr3);\n// [ 'a', 'b', 'c', 'd', 'e' ]\n\n// es6 çåå¹¶æ°ç»\n[...arr1, ...arr2, ...arr3]\n// [ 'a', 'b', 'c', 'd', 'e' ]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸è¿ï¼è¿ä¸¤ç§æ¹æ³é½æ¯æµæ·è´ï¼ä½¿ç¨çæ¶åéè¦æ³¨æã\n\nconst a1 = [{ foo: 1 }];\nconst a2 = [{ bar: 2 }];\n\nconst a3 = a1.concat(a2);\nconst a4 = [...a1, ...a2];\n\na3[0] === a1[0] // true\na4[0] === a1[0] // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼a3åa4æ¯ç¨ä¸¤ç§ä¸åæ¹æ³åå¹¶èæçæ°æ°ç»ï¼ä½æ¯å®ä»¬çæåé½æ¯å¯¹åæ°ç»æåçå¼ç¨ï¼è¿å°±æ¯æµæ·è´ãå¦æä¿®æ¹äºå¼ç¨æåçå¼ï¼ä¼åæ­¥åæ å°æ°æ°ç»ã\n\nï¼3ï¼ä¸è§£æèµå¼ç»å\n\næ©å±è¿ç®ç¬¦å¯ä»¥ä¸è§£æèµå¼ç»åèµ·æ¥ï¼ç¨äºçææ°ç»ã\n\n// es5\na = list[0], rest = list.slice(1)\n// es6\n[a, ...rest] = list\n\n\n1\n2\n3\n4\n\n\nä¸é¢æ¯å¦å¤ä¸äºä¾å­ã\n\nconst [first, ...rest] = [1, 2, 3, 4, 5];\nfirst // 1\nrest  // [2, 3, 4, 5]\n\nconst [first, ...rest] = [];\nfirst // undefined\nrest  // []\n\nconst [first, ...rest] = [\"foo\"];\nfirst  // \"foo\"\nrest   // []\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¦æå°æ©å±è¿ç®ç¬¦ç¨äºæ°ç»èµå¼ï¼åªè½æ¾å¨åæ°çæåä¸ä½ï¼å¦åä¼æ¥éã\n\nconst [...butlast, last] = [1, 2, 3, 4, 5];\n// æ¥é\n\nconst [first, ...middle, last] = [1, 2, 3, 4, 5];\n// æ¥é\n\n\n1\n2\n3\n4\n5\n\n\nï¼4ï¼å­ç¬¦ä¸²\n\næ©å±è¿ç®ç¬¦è¿å¯ä»¥å°å­ç¬¦ä¸²è½¬ä¸ºçæ­£çæ°ç»ã\n\n[...'hello']\n// [ \"h\", \"e\", \"l\", \"l\", \"o\" ]\n\n\n1\n2\n\n\nä¸é¢çåæ³ï¼æä¸ä¸ªéè¦çå¥½å¤ï¼é£å°±æ¯è½å¤æ­£ç¡®è¯å«åä¸ªå­èç unicode å­ç¬¦ã\n\n'x\\ud83d\\ude80y'.length // 4\n[...'x\\ud83d\\ude80y'].length // 3\n\n\n1\n2\n\n\nä¸é¢ä»£ç çç¬¬ä¸ç§åæ³ï¼javascript ä¼å°åä¸ªå­èç unicode å­ç¬¦ï¼è¯å«ä¸º 2 ä¸ªå­ç¬¦ï¼éç¨æ©å±è¿ç®ç¬¦å°±æ²¡æè¿ä¸ªé®é¢ãå æ­¤ï¼æ­£ç¡®è¿åå­ç¬¦ä¸²é¿åº¦çå½æ°ï¼å¯ä»¥åä¸é¢è¿æ ·åã\n\nfunction length(str) {\n  return [...str].length;\n}\n\nlength('x\\ud83d\\ude80y') // 3\n\n\n1\n2\n3\n4\n5\n\n\nå¡æ¯æ¶åå°æä½åä¸ªå­èç unicode å­ç¬¦çå½æ°ï¼é½æè¿ä¸ªé®é¢ãå æ­¤ï¼æå¥½é½ç¨æ©å±è¿ç®ç¬¦æ¹åã\n\nlet str = 'x\\ud83d\\ude80y';\n\nstr.split('').reverse().join('')\n// 'y\\ude80\\ud83dx'\n\n[...str].reverse().join('')\n// 'y\\ud83d\\ude80x'\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æä¸ç¨æ©å±è¿ç®ç¬¦ï¼å­ç¬¦ä¸²çreverseæä½å°±ä¸æ­£ç¡®ã\n\nï¼5ï¼å®ç°äº iterator æ¥å£çå¯¹è±¡\n\nä»»ä½å®ä¹äºéåå¨ï¼iteratorï¼æ¥å£çå¯¹è±¡ï¼åé iterator ä¸ç« ï¼ï¼é½å¯ä»¥ç¨æ©å±è¿ç®ç¬¦è½¬ä¸ºçæ­£çæ°ç»ã\n\nlet nodelist = document.queryselectorall('div');\nlet array = [...nodelist];\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼queryselectorallæ¹æ³è¿åçæ¯ä¸ä¸ªnodelistå¯¹è±¡ãå®ä¸æ¯æ°ç»ï¼èæ¯ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ãè¿æ¶ï¼æ©å±è¿ç®ç¬¦å¯ä»¥å°å¶è½¬ä¸ºçæ­£çæ°ç»ï¼åå å°±å¨äºnodelistå¯¹è±¡å®ç°äº iterator ã\n\nnumber.prototype[symbol.iterator] = function*() {\n  let i = 0;\n  let num = this.valueof();\n  while (i < num) {\n    yield i++;\n  }\n}\n\nconsole.log([...5]) // [0, 1, 2, 3, 4]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼åå®ä¹äºnumberå¯¹è±¡çéåå¨æ¥å£ï¼æ©å±è¿ç®ç¬¦å°5èªå¨è½¬ænumberå®ä¾ä»¥åï¼å°±ä¼è°ç¨è¿ä¸ªæ¥å£ï¼å°±ä¼è¿åèªå®ä¹çç»æã\n\nå¯¹äºé£äºæ²¡æé¨ç½² iterator æ¥å£çç±»ä¼¼æ°ç»çå¯¹è±¡ï¼æ©å±è¿ç®ç¬¦å°±æ æ³å°å¶è½¬ä¸ºçæ­£çæ°ç»ã\n\nlet arraylike = {\n  '0': 'a',\n  '1': 'b',\n  '2': 'c',\n  length: 3\n};\n\n// typeerror: cannot spread non-iterable object.\nlet arr = [...arraylike];\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼arraylikeæ¯ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ï¼ä½æ¯æ²¡æé¨ç½² iterator æ¥å£ï¼æ©å±è¿ç®ç¬¦å°±ä¼æ¥éãè¿æ¶ï¼å¯ä»¥æ¹ä¸ºä½¿ç¨array.fromæ¹æ³å°arraylikeè½¬ä¸ºçæ­£çæ°ç»ã\n\nï¼6ï¼map å set ç»æï¼generator å½æ°\n\næ©å±è¿ç®ç¬¦åé¨è°ç¨çæ¯æ°æ®ç»æç iterator æ¥å£ï¼å æ­¤åªè¦å·æ iterator æ¥å£çå¯¹è±¡ï¼é½å¯ä»¥ä½¿ç¨æ©å±è¿ç®ç¬¦ï¼æ¯å¦ map ç»æã\n\nlet map = new map([\n  [1, 'one'],\n  [2, 'two'],\n  [3, 'three'],\n]);\n\nlet arr = [...map.keys()]; // [1, 2, 3]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\ngenerator å½æ°è¿è¡åï¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼å æ­¤ä¹å¯ä»¥ä½¿ç¨æ©å±è¿ç®ç¬¦ã\n\nconst go = function*(){\n  yield 1;\n  yield 2;\n  yield 3;\n};\n\n[...go()] // [1, 2, 3]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åégoæ¯ä¸ä¸ª generator å½æ°ï¼æ§è¡åè¿åçæ¯ä¸ä¸ªéåå¨å¯¹è±¡ï¼å¯¹è¿ä¸ªéåå¨å¯¹è±¡æ§è¡æ©å±è¿ç®ç¬¦ï¼å°±ä¼å°åé¨éåå¾å°çå¼ï¼è½¬ä¸ºä¸ä¸ªæ°ç»ã\n\nå¦æå¯¹æ²¡æ iterator æ¥å£çå¯¹è±¡ï¼ä½¿ç¨æ©å±è¿ç®ç¬¦ï¼å°ä¼æ¥éã\n\nconst obj = {a: 1, b: 2};\nlet arr = [...obj]; // typeerror: cannot spread non-iterable object\n\n\n1\n2\n\n\n\n# array.from()\n\narray.fromæ¹æ³ç¨äºå°ä¸¤ç±»å¯¹è±¡è½¬ä¸ºçæ­£çæ°ç»ï¼ç±»ä¼¼æ°ç»çå¯¹è±¡ï¼array-like objectï¼åå¯éåï¼iterableï¼çå¯¹è±¡ï¼åæ¬ es6 æ°å¢çæ°æ®ç»æ set å mapï¼ã\n\nä¸é¢æ¯ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ï¼array.fromå°å®è½¬ä¸ºçæ­£çæ°ç»ã\n\nlet arraylike = {\n    '0': 'a',\n    '1': 'b',\n    '2': 'c',\n    length: 3\n};\n\n// es5çåæ³\nvar arr1 = [].slice.call(arraylike); // ['a', 'b', 'c']\n\n// es6çåæ³\nlet arr2 = array.from(arraylike); // ['a', 'b', 'c']\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå®éåºç¨ä¸­ï¼å¸¸è§çç±»ä¼¼æ°ç»çå¯¹è±¡æ¯ dom æä½è¿åç nodelist éåï¼ä»¥åå½æ°åé¨çargumentså¯¹è±¡ãarray.fromé½å¯ä»¥å°å®ä»¬è½¬ä¸ºçæ­£çæ°ç»ã\n\n// nodelistå¯¹è±¡\nlet ps = document.queryselectorall('p');\narray.from(ps).filter(p => {\n  return p.textcontent.length > 100;\n});\n\n// argumentså¯¹è±¡\nfunction foo() {\n  var args = array.from(arguments);\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼queryselectorallæ¹æ³è¿åçæ¯ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ï¼å¯ä»¥å°è¿ä¸ªå¯¹è±¡è½¬ä¸ºçæ­£çæ°ç»ï¼åä½¿ç¨filteræ¹æ³ã\n\nåªè¦æ¯é¨ç½²äº iterator æ¥å£çæ°æ®ç»æï¼array.fromé½è½å°å¶è½¬ä¸ºæ°ç»ã\n\narray.from('hello')\n// ['h', 'e', 'l', 'l', 'o']\n\nlet namesset = new set(['a', 'b'])\narray.from(namesset) // ['a', 'b']\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç¬¦ä¸²å set ç»æé½å·æ iterator æ¥å£ï¼å æ­¤å¯ä»¥è¢«array.fromè½¬ä¸ºçæ­£çæ°ç»ã\n\nå¦æåæ°æ¯ä¸ä¸ªçæ­£çæ°ç»ï¼array.fromä¼è¿åä¸ä¸ªä¸æ¨¡ä¸æ ·çæ°æ°ç»ã\n\narray.from([1, 2, 3])\n// [1, 2, 3]\n\n\n1\n2\n\n\nå¼å¾æéçæ¯ï¼æ©å±è¿ç®ç¬¦ï¼...ï¼ä¹å¯ä»¥å°æäºæ°æ®ç»æè½¬ä¸ºæ°ç»ã\n\n// argumentså¯¹è±¡\nfunction foo() {\n  const args = [...arguments];\n}\n\n// nodelistå¯¹è±¡\n[...document.queryselectorall('div')]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næ©å±è¿ç®ç¬¦èåè°ç¨çæ¯éåå¨æ¥å£ï¼symbol.iteratorï¼ï¼å¦æä¸ä¸ªå¯¹è±¡æ²¡æé¨ç½²è¿ä¸ªæ¥å£ï¼å°±æ æ³è½¬æ¢ãarray.fromæ¹æ³è¿æ¯æç±»ä¼¼æ°ç»çå¯¹è±¡ãæè°ç±»ä¼¼æ°ç»çå¯¹è±¡ï¼æ¬è´¨ç¹å¾åªæä¸ç¹ï¼å³å¿é¡»ælengthå±æ§ãå æ­¤ï¼ä»»ä½ælengthå±æ§çå¯¹è±¡ï¼é½å¯ä»¥éè¿array.fromæ¹æ³è½¬ä¸ºæ°ç»ï¼èæ­¤æ¶æ©å±è¿ç®ç¬¦å°±æ æ³è½¬æ¢ã\n\narray.from({ length: 3 });\n// [ undefined, undefined, undefined ]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼array.fromè¿åäºä¸ä¸ªå·æä¸ä¸ªæåçæ°ç»ï¼æ¯ä¸ªä½ç½®çå¼é½æ¯undefinedãæ©å±è¿ç®ç¬¦è½¬æ¢ä¸äºè¿ä¸ªå¯¹è±¡ã\n\nå¯¹äºè¿æ²¡æé¨ç½²è¯¥æ¹æ³çæµè§å¨ï¼å¯ä»¥ç¨array.prototype.sliceæ¹æ³æ¿ä»£ã\n\nconst toarray = (() =>\n  array.from ? array.from : obj => [].slice.call(obj)\n)();\n\n\n1\n2\n3\n\n\narray.fromè¿å¯ä»¥æ¥åç¬¬äºä¸ªåæ°ï¼ä½ç¨ç±»ä¼¼äºæ°ç»çmapæ¹æ³ï¼ç¨æ¥å¯¹æ¯ä¸ªåç´ è¿è¡å¤çï¼å°å¤çåçå¼æ¾å¥è¿åçæ°ç»ã\n\narray.from(arraylike, x => x * x);\n// ç­åäº\narray.from(arraylike).map(x => x * x);\n\narray.from([1, 2, 3], (x) => x * x)\n// [1, 4, 9]\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢çä¾å­æ¯ååºä¸ç» dom èç¹çææ¬åå®¹ã\n\nlet spans = document.queryselectorall('span.name');\n\n// map()\nlet names1 = array.prototype.map.call(spans, s => s.textcontent);\n\n// array.from()\nlet names2 = array.from(spans, s => s.textcontent)\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢çä¾å­å°æ°ç»ä¸­å¸å°å¼ä¸ºfalseçæåè½¬ä¸º0ã\n\narray.from([1, , 2, , 3], (n) => n || 0)\n// [1, 0, 2, 0, 3]\n\n\n1\n2\n\n\nå¦ä¸ä¸ªä¾å­æ¯è¿ååç§æ°æ®çç±»åã\n\nfunction typesof () {\n  return array.from(arguments, value => typeof value)\n}\ntypesof(null, [], nan)\n// ['object', 'object', 'number']\n\n\n1\n2\n3\n4\n5\n\n\nå¦æmapå½æ°éé¢ç¨å°äºthiså³é®å­ï¼è¿å¯ä»¥ä¼ å¥array.fromçç¬¬ä¸ä¸ªåæ°ï¼ç¨æ¥ç»å®thisã\n\narray.from()å¯ä»¥å°åç§å¼è½¬ä¸ºçæ­£çæ°ç»ï¼å¹¶ä¸è¿æä¾mapåè½ãè¿å®éä¸æå³çï¼åªè¦æä¸ä¸ªåå§çæ°æ®ç»æï¼ä½ å°±å¯ä»¥åå¯¹å®çå¼è¿è¡å¤çï¼ç¶åè½¬æè§èçæ°ç»ç»æï¼è¿èå°±å¯ä»¥ä½¿ç¨æ°éä¼å¤çæ°ç»æ¹æ³ã\n\narray.from({ length: 2 }, () => 'jack')\n// ['jack', 'jack']\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼array.fromçç¬¬ä¸ä¸ªåæ°æå®äºç¬¬äºä¸ªåæ°è¿è¡çæ¬¡æ°ãè¿ç§ç¹æ§å¯ä»¥è®©è¯¥æ¹æ³çç¨æ³åå¾éå¸¸çµæ´»ã\n\narray.from()çå¦ä¸ä¸ªåºç¨æ¯ï¼å°å­ç¬¦ä¸²è½¬ä¸ºæ°ç»ï¼ç¶åè¿åå­ç¬¦ä¸²çé¿åº¦ãå ä¸ºå®è½æ­£ç¡®å¤çåç§ unicode å­ç¬¦ï¼å¯ä»¥é¿å javascript å°å¤§äº\\uffffç unicode å­ç¬¦ï¼ç®ä½ä¸¤ä¸ªå­ç¬¦ç bugã\n\nfunction countsymbols(string) {\n  return array.from(string).length;\n}\n\n\n1\n2\n3\n\n\n\n# array.of() æ»æ¯è¿ååæ°å¼ç»æçæ°ç»\n\narray.ofæ¹æ³ç¨äºå°ä¸ç»å¼ï¼è½¬æ¢ä¸ºæ°ç»ã\n\narray.of(3, 11, 8) // [3,11,8]\narray.of(3) // [3]\narray.of(3).length // 1\n\n\n1\n2\n3\n\n\nè¿ä¸ªæ¹æ³çä¸»è¦ç®çï¼æ¯å¼¥è¡¥æ°ç»æé å½æ°array()çä¸è¶³ãå ä¸ºåæ°ä¸ªæ°çä¸åï¼ä¼å¯¼è´array()çè¡ä¸ºæå·®å¼ã\n\narray() // []\narray(3) // [, , ,]\narray(3, 11, 8) // [3, 11, 8]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼arrayæ¹æ³æ²¡æåæ°ãä¸ä¸ªåæ°ãä¸ä¸ªåæ°æ¶ï¼è¿åç»æé½ä¸ä¸æ ·ãåªæå½åæ°ä¸ªæ°ä¸å°äº 2 ä¸ªæ¶ï¼array()æä¼è¿åç±åæ°ç»æçæ°æ°ç»ãåæ°ä¸ªæ°åªæä¸ä¸ªæ¶ï¼å®éä¸æ¯æå®æ°ç»çé¿åº¦ã\n\narray.ofåºæ¬ä¸å¯ä»¥ç¨æ¥æ¿ä»£array()ænew array()ï¼å¹¶ä¸ä¸å­å¨ç±äºåæ°ä¸åèå¯¼è´çéè½½ãå®çè¡ä¸ºéå¸¸ç»ä¸ã\n\narray.of() // []\narray.of(undefined) // [undefined]\narray.of(1) // [1]\narray.of(1, 2) // [1, 2]\n\n\n1\n2\n3\n4\n\n\narray.ofæ»æ¯è¿ååæ°å¼ç»æçæ°ç»ãå¦ææ²¡æåæ°ï¼å°±è¿åä¸ä¸ªç©ºæ°ç»ã\n\narray.ofæ¹æ³å¯ä»¥ç¨ä¸é¢çä»£ç æ¨¡æå®ç°ã\n\nfunction arrayof(){\n  return [].slice.call(arguments);\n}\n\n\n1\n2\n3\n\n\n\n# æ°ç»å®ä¾ç copywithin()\n\næ°ç»å®ä¾çcopywithin()æ¹æ³ï¼å¨å½åæ°ç»åé¨ï¼å°æå®ä½ç½®çæåå¤å¶å°å¶ä»ä½ç½®ï¼ä¼è¦çåææåï¼ï¼ç¶åè¿åå½åæ°ç»ãä¹å°±æ¯è¯´ï¼ä½¿ç¨è¿ä¸ªæ¹æ³ï¼ä¼ä¿®æ¹å½åæ°ç»ã\n\narray.prototype.copywithin(target, start = 0, end = this.length)\n\n\n1\n\n\nå®æ¥åä¸ä¸ªåæ°ã\n\n * targetï¼å¿éï¼ï¼ä»è¯¥ä½ç½®å¼å§æ¿æ¢æ°æ®ãå¦æä¸ºè´å¼ï¼è¡¨ç¤ºåæ°ã\n * startï¼å¯éï¼ï¼ä»è¯¥ä½ç½®å¼å§è¯»åæ°æ®ï¼é»è®¤ä¸º 0ãå¦æä¸ºè´å¼ï¼è¡¨ç¤ºä»æ«å°¾å¼å§è®¡ç®ã\n * endï¼å¯éï¼ï¼å°è¯¥ä½ç½®ååæ­¢è¯»åæ°æ®ï¼é»è®¤ç­äºæ°ç»é¿åº¦ãå¦æä¸ºè´å¼ï¼è¡¨ç¤ºä»æ«å°¾å¼å§è®¡ç®ã\n\nè¿ä¸ä¸ªåæ°é½åºè¯¥æ¯æ°å¼ï¼å¦æä¸æ¯ï¼ä¼èªå¨è½¬ä¸ºæ°å¼ã\n\n[1, 2, 3, 4, 5].copywithin(0, 3)\n// [4, 5, 3, 4, 5]\n\n\n1\n2\n\n\nä¸é¢ä»£ç è¡¨ç¤ºå°ä» 3 å·ä½ç´å°æ°ç»ç»æçæåï¼4 å 5ï¼ï¼å¤å¶å°ä» 0 å·ä½å¼å§çä½ç½®ï¼ç»æè¦çäºåæ¥ç 1 å 2ã\n\nä¸é¢æ¯æ´å¤ä¾å­ã\n\n// å°3å·ä½å¤å¶å°0å·ä½\n[1, 2, 3, 4, 5].copywithin(0, 3, 4)\n// [4, 2, 3, 4, 5]\n\n// -2ç¸å½äº3å·ä½ï¼-1ç¸å½äº4å·ä½\n[1, 2, 3, 4, 5].copywithin(0, -2, -1)\n// [4, 2, 3, 4, 5]\n\n// å°3å·ä½å¤å¶å°0å·ä½\n[].copywithin.call({length: 5, 3: 1}, 0, 3)\n// {0: 1, 3: 1, length: 5}\n\n// å°2å·ä½å°æ°ç»ç»æï¼å¤å¶å°0å·ä½\nlet i32a = new int32array([1, 2, 3, 4, 5]);\ni32a.copywithin(0, 2);\n// int32array [3, 4, 5, 4, 5]\n\n// å¯¹äºæ²¡æé¨ç½² typedarray ç copywithin æ¹æ³çå¹³å°\n// éè¦éç¨ä¸é¢çåæ³\n[].copywithin.call(new int32array([1, 2, 3, 4, 5]), 0, 3, 4);\n// int32array [4, 2, 3, 4, 5]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n\n# æ°ç»å®ä¾ç find() å findindex()\n\næ°ç»å®ä¾çfindæ¹æ³ï¼ç¨äºæ¾åºç¬¬ä¸ä¸ªç¬¦åæ¡ä»¶çæ°ç»æåãå®çåæ°æ¯ä¸ä¸ªåè°å½æ°ï¼æææ°ç»æåä¾æ¬¡æ§è¡è¯¥åè°å½æ°ï¼ç´å°æ¾åºç¬¬ä¸ä¸ªè¿åå¼ä¸ºtrueçæåï¼ç¶åè¿åè¯¥æåãå¦ææ²¡æç¬¦åæ¡ä»¶çæåï¼åè¿åundefinedã\n\n[1, 4, -5, 10].find((n) => n < 0)\n// -5\n\n\n1\n2\n\n\nä¸é¢ä»£ç æ¾åºæ°ç»ä¸­ç¬¬ä¸ä¸ªå°äº 0 çæåã\n\n[1, 5, 10, 15].find(function(value, index, arr) {\n  return value > 9;\n}) // 10\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼findæ¹æ³çåè°å½æ°å¯ä»¥æ¥åä¸ä¸ªåæ°ï¼ä¾æ¬¡ä¸ºå½åçå¼ãå½åçä½ç½®ååæ°ç»ã\n\næ°ç»å®ä¾çfindindexæ¹æ³çç¨æ³ä¸findæ¹æ³éå¸¸ç±»ä¼¼ï¼è¿åç¬¬ä¸ä¸ªç¬¦åæ¡ä»¶çæ°ç»æåçä½ç½®ï¼å¦ææææåé½ä¸ç¬¦åæ¡ä»¶ï¼åè¿å-1ã\n\n[1, 5, 10, 15].findindex(function(value, index, arr) {\n  return value > 9;\n}) // 2\n\n\n1\n2\n3\n\n\nè¿ä¸¤ä¸ªæ¹æ³é½å¯ä»¥æ¥åç¬¬äºä¸ªåæ°ï¼ç¨æ¥ç»å®åè°å½æ°çthiså¯¹è±¡ã\n\nfunction f(v){\n  return v > this.age;\n}\nlet person = {name: 'john', age: 20};\n[10, 12, 26, 15].find(f, person);    // 26\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çä»£ç ä¸­ï¼findå½æ°æ¥æ¶äºç¬¬äºä¸ªåæ°personå¯¹è±¡ï¼åè°å½æ°ä¸­çthiså¯¹è±¡æåpersonå¯¹è±¡ã\n\nå¦å¤ï¼è¿ä¸¤ä¸ªæ¹æ³é½å¯ä»¥åç°nanï¼å¼¥è¡¥äºæ°ç»çindexofæ¹æ³çä¸è¶³ã\n\n[nan].indexof(nan)\n// -1\n\n[nan].findindex(y => object.is(nan, y))\n// 0\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼indexofæ¹æ³æ æ³è¯å«æ°ç»çnanæåï¼ä½æ¯findindexæ¹æ³å¯ä»¥åå©object.isæ¹æ³åå°ã\n\n\n# æ°ç»å®ä¾ç fill()\n\nfillæ¹æ³ä½¿ç¨ç»å®å¼ï¼å¡«åä¸ä¸ªæ°ç»ã\n\n['a', 'b', 'c'].fill(7)\n// [7, 7, 7]\n\nnew array(3).fill(7)\n// [7, 7, 7]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç è¡¨æï¼fillæ¹æ³ç¨äºç©ºæ°ç»çåå§åéå¸¸æ¹ä¾¿ãæ°ç»ä¸­å·²æçåç´ ï¼ä¼è¢«å¨é¨æ¹å»ã\n\nfillæ¹æ³è¿å¯ä»¥æ¥åç¬¬äºä¸ªåç¬¬ä¸ä¸ªåæ°ï¼ç¨äºæå®å¡«åçèµ·å§ä½ç½®åç»æä½ç½®ã\n\n['a', 'b', 'c'].fill(7, 1, 2)\n// ['a', 7, 'c']\n\n\n1\n2\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼fillæ¹æ³ä» 1 å·ä½å¼å§ï¼ååæ°ç»å¡«å 7ï¼å° 2 å·ä½ä¹åç»æã\n\næ³¨æï¼å¦æå¡«åçç±»åä¸ºå¯¹è±¡ï¼é£ä¹è¢«èµå¼çæ¯åä¸ä¸ªåå­å°åçå¯¹è±¡ï¼èä¸æ¯æ·±æ·è´å¯¹è±¡ã\n\nlet arr = new array(3).fill({name: \"mike\"});\narr[0].name = \"ben\";\narr\n// [{name: \"ben\"}, {name: \"ben\"}, {name: \"ben\"}]\n\nlet arr = new array(3).fill([]);\narr[0].push(5);\narr\n// [[5], [5], [5]]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# æ°ç»å®ä¾ç entries()ï¼keys() å values()\n\nes6 æä¾ä¸ä¸ªæ°çæ¹æ³ââentries()ï¼keys()åvalues()ââç¨äºéåæ°ç»ãå®ä»¬é½è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼è¯¦è§ãiteratorãä¸ç« ï¼ï¼å¯ä»¥ç¨for...ofå¾ªç¯è¿è¡éåï¼å¯ä¸çåºå«æ¯keys()æ¯å¯¹é®åçéåãvalues()æ¯å¯¹é®å¼çéåï¼entries()æ¯å¯¹é®å¼å¯¹çéåã\n\nfor (let index of ['a', 'b'].keys()) {\n  console.log(index);\n}\n// 0\n// 1\n\nfor (let elem of ['a', 'b'].values()) {\n  console.log(elem);\n}\n// 'a'\n// 'b'\n\nfor (let [index, elem] of ['a', 'b'].entries()) {\n  console.log(index, elem);\n}\n// 0 \"a\"\n// 1 \"b\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nå¦æä¸ä½¿ç¨for...ofå¾ªç¯ï¼å¯ä»¥æå¨è°ç¨éåå¨å¯¹è±¡çnextæ¹æ³ï¼è¿è¡éåã\n\nlet letter = ['a', 'b', 'c'];\nlet entries = letter.entries();\nconsole.log(entries.next().value); // [0, 'a']\nconsole.log(entries.next().value); // [1, 'b']\nconsole.log(entries.next().value); // [2, 'c']\n\n\n1\n2\n3\n4\n5\n\n\n\n# æ°ç»å®ä¾ç includes()\n\narray.prototype.includesæ¹æ³è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºæä¸ªæ°ç»æ¯å¦åå«ç»å®çå¼ï¼ä¸å­ç¬¦ä¸²çincludesæ¹æ³ç±»ä¼¼ães2016 å¼å¥äºè¯¥æ¹æ³ã\n\n[1, 2, 3].includes(2)     // true\n[1, 2, 3].includes(4)     // false\n[1, 2, nan].includes(nan) // true\n\n\n1\n2\n3\n\n\nè¯¥æ¹æ³çç¬¬äºä¸ªåæ°è¡¨ç¤ºæç´¢çèµ·å§ä½ç½®ï¼é»è®¤ä¸º0ãå¦æç¬¬äºä¸ªåæ°ä¸ºè´æ°ï¼åè¡¨ç¤ºåæ°çä½ç½®ï¼å¦æè¿æ¶å®å¤§äºæ°ç»é¿åº¦ï¼æ¯å¦ç¬¬äºä¸ªåæ°ä¸º-4ï¼ä½æ°ç»é¿åº¦ä¸º3ï¼ï¼åä¼éç½®ä¸ºä»0å¼å§ã\n\n[1, 2, 3].includes(3, 3);  // false\n[1, 2, 3].includes(3, -1); // true\n\n\n1\n2\n\n\næ²¡æè¯¥æ¹æ³ä¹åï¼æä»¬éå¸¸ä½¿ç¨æ°ç»çindexofæ¹æ³ï¼æ£æ¥æ¯å¦åå«æä¸ªå¼ã\n\nif (arr.indexof(el) !== -1) {\n  // ...\n}\n\n\n1\n2\n3\n\n\nindexofæ¹æ³æä¸¤ä¸ªç¼ºç¹ï¼ä¸æ¯ä¸å¤è¯­ä¹åï¼å®çå«ä¹æ¯æ¾å°åæ°å¼çç¬¬ä¸ä¸ªåºç°ä½ç½®ï¼æä»¥è¦å»æ¯è¾æ¯å¦ä¸ç­äº-1ï¼è¡¨è¾¾èµ·æ¥ä¸å¤ç´è§ãäºæ¯ï¼å®åé¨ä½¿ç¨ä¸¥æ ¼ç¸ç­è¿ç®ç¬¦ï¼===ï¼è¿è¡å¤æ­ï¼è¿ä¼å¯¼è´å¯¹nançè¯¯å¤ã\n\n[nan].indexof(nan)\n// -1\n\n\n1\n2\n\n\nincludesä½¿ç¨çæ¯ä¸ä¸æ ·çå¤æ­ç®æ³ï¼å°±æ²¡æè¿ä¸ªé®é¢ã\n\n[nan].includes(nan)\n// true\n\n\n1\n2\n\n\nä¸é¢ä»£ç ç¨æ¥æ£æ¥å½åç¯å¢æ¯å¦æ¯æè¯¥æ¹æ³ï¼å¦æä¸æ¯æï¼é¨ç½²ä¸ä¸ªç®æçæ¿ä»£çæ¬ã\n\nconst contains = (() =>\n  array.prototype.includes\n    ? (arr, value) => arr.includes(value)\n    : (arr, value) => arr.some(el => el === value)\n)();\ncontains(['foo', 'bar'], 'baz'); // => false\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¦å¤ï¼map å set æ°æ®ç»ææä¸ä¸ªhasæ¹æ³ï¼éè¦æ³¨æä¸includesåºåã\n\n * map ç»æçhasæ¹æ³ï¼æ¯ç¨æ¥æ¥æ¾é®åçï¼æ¯å¦map.prototype.has(key)ãweakmap.prototype.has(key)ãreflect.has(target, propertykey)ã\n * set ç»æçhasæ¹æ³ï¼æ¯ç¨æ¥æ¥æ¾å¼çï¼æ¯å¦set.prototype.has(value)ãweakset.prototype.has(value)ã\n\n\n# æ°ç»å®ä¾ç flat()ï¼flatmap()\n\næ°ç»çæåææ¶è¿æ¯æ°ç»ï¼array.prototype.flat()ç¨äºå°åµå¥çæ°ç»âæå¹³âï¼åæä¸ç»´çæ°ç»ãè¯¥æ¹æ³è¿åä¸ä¸ªæ°æ°ç»ï¼å¯¹åæ°æ®æ²¡æå½±åã\n\n[1, 2, [3, 4]].flat()\n// [1, 2, 3, 4]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°ç»çæåéé¢æä¸ä¸ªæ°ç»ï¼flat()æ¹æ³å°å­æ°ç»çæåååºæ¥ï¼æ·»å å¨åæ¥çä½ç½®ã\n\nflat()é»è®¤åªä¼âæå¹³âä¸å±ï¼å¦ææ³è¦âæå¹³âå¤å±çåµå¥æ°ç»ï¼å¯ä»¥å°flat()æ¹æ³çåæ°åæä¸ä¸ªæ´æ°ï¼è¡¨ç¤ºæ³è¦æå¹³çå±æ°ï¼é»è®¤ä¸º1ã\n\n[1, 2, [3, [4, 5]]].flat()\n// [1, 2, 3, [4, 5]]\n\n[1, 2, [3, [4, 5]]].flat(2)\n// [1, 2, 3, 4, 5]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼flat()çåæ°ä¸º2ï¼è¡¨ç¤ºè¦âæå¹³âä¸¤å±çåµå¥æ°ç»ã\n\nå¦æä¸ç®¡æå¤å°å±åµå¥ï¼é½è¦è½¬æä¸ç»´æ°ç»ï¼å¯ä»¥ç¨infinityå³é®å­ä½ä¸ºåæ°ã\n\n[1, [2, [3]]].flat(infinity)\n// [1, 2, 3]\n\n\n1\n2\n\n\nå¦æåæ°ç»æç©ºä½ï¼flat()æ¹æ³ä¼è·³è¿ç©ºä½ã\n\n[1, 2, , 4, 5].flat()\n// [1, 2, 4, 5]\n\n\n1\n2\n\n\nflatmap()æ¹æ³å¯¹åæ°ç»çæ¯ä¸ªæåæ§è¡ä¸ä¸ªå½æ°ï¼ç¸å½äºæ§è¡array.prototype.map()ï¼ï¼ç¶åå¯¹è¿åå¼ç»æçæ°ç»æ§è¡flat()æ¹æ³ãè¯¥æ¹æ³è¿åä¸ä¸ªæ°æ°ç»ï¼ä¸æ¹ååæ°ç»ã\n\n// ç¸å½äº [2, 3, 4].map(x => [x, x*2]).flat()\n[2, 3, 4].flatmap((x) => [x, x * 2])\n// [2, 4, 3, 6, 4, 8]\n\n\n1\n2\n3\n\n\nflatmap()åªè½å±å¼ä¸å±æ°ç»ã\n\n// ç¸å½äº [[[2]], [[4]], [[6]], [[8]]].flat()\n[1, 2, 3, 4].flatmap(x => [[x * 2]])\n// [[2], [4], [6], [8]]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼éåå½æ°è¿åçæ¯ä¸ä¸ªåå±çæ°ç»ï¼ä½æ¯é»è®¤åªè½å±å¼ä¸å±ï¼å æ­¤flatmap()è¿åçè¿æ¯ä¸ä¸ªåµå¥æ°ç»ã\n\nflatmap()æ¹æ³çåæ°æ¯ä¸ä¸ªéåå½æ°ï¼è¯¥å½æ°å¯ä»¥æ¥åä¸ä¸ªåæ°ï¼åå«æ¯å½åæ°ç»æåãå½åæ°ç»æåçä½ç½®ï¼ä»é¶å¼å§ï¼ãåæ°ç»ã\n\narr.flatmap(function callback(currentvalue[, index[, array]]) {\n  // ...\n}[, thisarg])\n\n\n1\n2\n3\n\n\nflatmap()æ¹æ³è¿å¯ä»¥æç¬¬äºä¸ªåæ°ï¼ç¨æ¥ç»å®éåå½æ°éé¢çthisã\n\n\n# æ°ç»çç©ºä½\n\næ°ç»çç©ºä½æï¼æ°ç»çæä¸ä¸ªä½ç½®æ²¡æä»»ä½å¼ãæ¯å¦ï¼arrayæé å½æ°è¿åçæ°ç»é½æ¯ç©ºä½ã\n\narray(3) // [, , ,]\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼array(3)è¿åä¸ä¸ªå·æ 3 ä¸ªç©ºä½çæ°ç»ã\n\næ³¨æï¼ç©ºä½ä¸æ¯undefinedï¼ä¸ä¸ªä½ç½®çå¼ç­äºundefinedï¼ä¾ç¶æ¯æå¼çãç©ºä½æ¯æ²¡æä»»ä½å¼ï¼inè¿ç®ç¬¦å¯ä»¥è¯´æè¿ä¸ç¹ã\n\n0 in [undefined, undefined, undefined] // true\n0 in [, , ,] // false\n\n\n1\n2\n\n\nä¸é¢ä»£ç è¯´æï¼ç¬¬ä¸ä¸ªæ°ç»ç 0 å·ä½ç½®æ¯æå¼çï¼ç¬¬äºä¸ªæ°ç»ç 0 å·ä½ç½®æ²¡æå¼ã\n\nes5 å¯¹ç©ºä½çå¤çï¼å·²ç»å¾ä¸ä¸è´äºï¼å¤§å¤æ°æåµä¸ä¼å¿½ç¥ç©ºä½ã\n\n * foreach(), filter(), reduce(), every() åsome()é½ä¼è·³è¿ç©ºä½ã\n * map()ä¼è·³è¿ç©ºä½ï¼ä½ä¼ä¿çè¿ä¸ªå¼\n * join()åtostring()ä¼å°ç©ºä½è§ä¸ºundefinedï¼èundefinedånullä¼è¢«å¤çæç©ºå­ç¬¦ä¸²ã\n\n// foreachæ¹æ³\n[,'a'].foreach((x,i) => console.log(i)); // 1\n\n// filteræ¹æ³\n['a',,'b'].filter(x => true) // ['a','b']\n\n// everyæ¹æ³\n[,'a'].every(x => x==='a') // true\n\n// reduceæ¹æ³\n[1,,2].reduce((x,y) => x+y) // 3\n\n// someæ¹æ³\n[,'a'].some(x => x !== 'a') // false\n\n// mapæ¹æ³\n[,'a'].map(x => 1) // [,1]\n\n// joinæ¹æ³\n[,'a',undefined,null].join('#') // \"#a##\"\n\n// tostringæ¹æ³\n[,'a',undefined,null].tostring() // \",a,,\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nes6 åæ¯æç¡®å°ç©ºä½è½¬ä¸ºundefinedã\n\narray.fromæ¹æ³ä¼å°æ°ç»çç©ºä½ï¼è½¬ä¸ºundefinedï¼ä¹å°±æ¯è¯´ï¼è¿ä¸ªæ¹æ³ä¸ä¼å¿½ç¥ç©ºä½ã\n\narray.from(['a',,'b'])\n// [ \"a\", undefined, \"b\" ]\n\n\n1\n2\n\n\næ©å±è¿ç®ç¬¦ï¼...ï¼ä¹ä¼å°ç©ºä½è½¬ä¸ºundefinedã\n\n[...['a',,'b']]\n// [ \"a\", undefined, \"b\" ]\n\n\n1\n2\n\n\ncopywithin()ä¼è¿ç©ºä½ä¸èµ·æ·è´ã\n\n[,'a','b',,].copywithin(2,0) // [,\"a\",,\"a\"]\n\n\n1\n\n\nfill()ä¼å°ç©ºä½è§ä¸ºæ­£å¸¸çæ°ç»ä½ç½®ã\n\nnew array(3).fill('a') // [\"a\",\"a\",\"a\"]\n\n\n1\n\n\nfor...ofå¾ªç¯ä¹ä¼éåç©ºä½ã\n\nlet arr = [, ,];\nfor (let i of arr) {\n  console.log(1);\n}\n// 1\n// 1\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»arræä¸¤ä¸ªç©ºä½ï¼for...ofå¹¶æ²¡æå¿½ç¥å®ä»¬ãå¦ææ¹æmapæ¹æ³éåï¼ç©ºä½æ¯ä¼è·³è¿çã\n\nentries()ãkeys()ãvalues()ãfind()åfindindex()ä¼å°ç©ºä½å¤çæundefinedã\n\n// entries()\n[...[,'a'].entries()] // [[0,undefined], [1,\"a\"]]\n\n// keys()\n[...[,'a'].keys()] // [0,1]\n\n// values()\n[...[,'a'].values()] // [undefined,\"a\"]\n\n// find()\n[,'a'].find(x => true) // undefined\n\n// findindex()\n[,'a'].findindex(x => true) // 0\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nç±äºç©ºä½çå¤çè§åéå¸¸ä¸ç»ä¸ï¼æä»¥å»ºè®®é¿ååºç°ç©ºä½ã\n\n\n# array.prototype.sort() çæåºç¨³å®æ§\n\næåºç¨³å®æ§ï¼stable sortingï¼æ¯æåºç®æ³çéè¦å±æ§ï¼æçæ¯æåºå³é®å­ç¸åçé¡¹ç®ï¼æåºååçé¡ºåºä¸åã\n\nconst arr = [\n  'peach',\n  'straw',\n  'apple',\n  'spork'\n];\n\nconst stablesorting = (s1, s2) => {\n  if (s1[0] < s2[0]) return -1;\n  return 1;\n};\n\narr.sort(stablesorting)\n// [\"apple\", \"peach\", \"straw\", \"spork\"]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç å¯¹æ°ç»arræç§é¦å­æ¯è¿è¡æåºãæåºç»æä¸­ï¼strawå¨sporkçåé¢ï¼è·åå§é¡ºåºä¸è´ï¼æä»¥æåºç®æ³stablesortingæ¯ç¨³å®æåºã\n\nconst unstablesorting = (s1, s2) => {\n  if (s1[0] <= s2[0]) return -1;\n  return 1;\n};\n\narr.sort(unstablesorting)\n// [\"apple\", \"peach\", \"spork\", \"straw\"]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼æåºç»ææ¯sporkå¨strawåé¢ï¼è·åå§é¡ºåºç¸åï¼æä»¥æåºç®æ³unstablesortingæ¯ä¸ç¨³å®çã\n\nå¸¸è§çæåºç®æ³ä¹ä¸­ï¼æå¥æåºãåå¹¶æåºãåæ³¡æåºç­é½æ¯ç¨³å®çï¼å æåºãå¿«éæåºç­æ¯ä¸ç¨³å®çãä¸ç¨³å®æåºçä¸»è¦ç¼ºç¹æ¯ï¼å¤éæåºæ¶å¯è½ä¼äº§çé®é¢ãåè®¾æä¸ä¸ªå§ååçåè¡¨ï¼è¦æ±æç§âå§æ°ä¸ºä¸»è¦å³é®å­ï¼åå­ä¸ºæ¬¡è¦å³é®å­âè¿è¡æåºãå¼åèå¯è½ä¼åæåå­æåºï¼åæå§æ°è¿è¡æåºãå¦ææåºç®æ³æ¯ç¨³å®çï¼è¿æ ·å°±å¯ä»¥è¾¾å°âåå§æ°ï¼ååå­âçæåºææãå¦ææ¯ä¸ç¨³å®çï¼å°±ä¸è¡ã\n\næ©åç ecmascript æ²¡æè§å®ï¼array.prototype.sort()çé»è®¤æåºç®æ³æ¯å¦ç¨³å®ï¼çç»æµè§å¨èªå·±å³å®ï¼è¿å¯¼è´æäºå®ç°æ¯ä¸ç¨³å®çães2019 æç¡®è§å®ï¼array.prototype.sort()çé»è®¤æåºç®æ³å¿é¡»ç¨³å®ãè¿ä¸ªè§å®å·²ç»åå°äºï¼ç°å¨ javascript åä¸ªä¸»è¦å®ç°çé»è®¤æåºç®æ³é½æ¯ç¨³å®çã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"å¯¹è±¡çæ©å±",frontmatter:{title:"å¯¹è±¡çæ©å±",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/b5e3e0a0ff6e9c25",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/10.%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%89%A9%E5%B1%95.html",relativePath:"ãES6 æç¨ãç¬è®°/10.å¯¹è±¡çæ©å±.md",key:"v-c1496618",path:"/pages/b5e3e0a0ff6e9c25/",headers:[{level:2,title:"å±æ§çç®æ´è¡¨ç¤ºæ³",slug:"å±æ§çç®æ´è¡¨ç¤ºæ³",normalizedTitle:"å±æ§çç®æ´è¡¨ç¤ºæ³",charIndex:93},{level:2,title:"å±æ§åè¡¨è¾¾å¼",slug:"å±æ§åè¡¨è¾¾å¼",normalizedTitle:"å±æ§åè¡¨è¾¾å¼",charIndex:2152},{level:2,title:"æ¹æ³ç name å±æ§",slug:"æ¹æ³ç-name-å±æ§",normalizedTitle:"æ¹æ³ç name å±æ§",charIndex:3364},{level:2,title:"å±æ§çå¯æä¸¾æ§åéå",slug:"å±æ§çå¯æä¸¾æ§åéå",normalizedTitle:"å±æ§çå¯æä¸¾æ§åéå",charIndex:4433},{level:3,title:"å¯æä¸¾æ§",slug:"å¯æä¸¾æ§",normalizedTitle:"å¯æä¸¾æ§",charIndex:4436},{level:3,title:"å±æ§çéå",slug:"å±æ§çéå",normalizedTitle:"å±æ§çéå",charIndex:5669},{level:2,title:"super å³é®å­",slug:"super-å³é®å­",normalizedTitle:"super å³é®å­",charIndex:6448},{level:2,title:"å¯¹è±¡çæ©å±è¿ç®ç¬¦",slug:"å¯¹è±¡çæ©å±è¿ç®ç¬¦",normalizedTitle:"å¯¹è±¡çæ©å±è¿ç®ç¬¦",charIndex:7595},{level:3,title:"è§£æèµå¼",slug:"è§£æèµå¼",normalizedTitle:"è§£æèµå¼",charIndex:7656},{level:3,title:"æ©å±è¿ç®ç¬¦",slug:"æ©å±è¿ç®ç¬¦",normalizedTitle:"æ©å±è¿ç®ç¬¦",charIndex:7598},{level:2,title:"é¾å¤æ­è¿ç®ç¬¦",slug:"é¾å¤æ­è¿ç®ç¬¦",normalizedTitle:"é¾å¤æ­è¿ç®ç¬¦",charIndex:11842},{level:2,title:"Null å¤æ­è¿ç®ç¬¦",slug:"null-å¤æ­è¿ç®ç¬¦",normalizedTitle:"null å¤æ­è¿ç®ç¬¦",charIndex:14050}],excerpt:'<h1 id="å¯¹è±¡çæ©å±"><a class="header-anchor" href="#å¯¹è±¡çæ©å±">#</a> å¯¹è±¡çæ©å±</h1>\n<p>å¯¹è±¡ï¼objectï¼æ¯ JavaScript æéè¦çæ°æ®ç»æãES6 å¯¹å®è¿è¡äºéå¤§åçº§ï¼æ¬ç« ä»ç»æ°æ®ç»ææ¬èº«çæ¹åï¼ä¸ä¸ç« ä»ç»<code>Object</code>å¯¹è±¡çæ°å¢æ¹æ³ã</p>\n',headersStr:"å±æ§çç®æ´è¡¨ç¤ºæ³ å±æ§åè¡¨è¾¾å¼ æ¹æ³ç name å±æ§ å±æ§çå¯æä¸¾æ§åéå å¯æä¸¾æ§ å±æ§çéå super å³é®å­ å¯¹è±¡çæ©å±è¿ç®ç¬¦ è§£æèµå¼ æ©å±è¿ç®ç¬¦ é¾å¤æ­è¿ç®ç¬¦ Null å¤æ­è¿ç®ç¬¦",content:"# å¯¹è±¡çæ©å±\n\nå¯¹è±¡ï¼objectï¼æ¯ JavaScript æéè¦çæ°æ®ç»æãES6 å¯¹å®è¿è¡äºéå¤§åçº§ï¼æ¬ç« ä»ç»æ°æ®ç»ææ¬èº«çæ¹åï¼ä¸ä¸ç« ä»ç»Objectå¯¹è±¡çæ°å¢æ¹æ³ã\n\n\n# å±æ§çç®æ´è¡¨ç¤ºæ³\n\nES6 åè®¸å¨å¤§æ¬å·éé¢ï¼ç´æ¥åå¥åéåå½æ°ï¼ä½ä¸ºå¯¹è±¡çå±æ§åæ¹æ³ãè¿æ ·çä¹¦åæ´å ç®æ´ã\n\nconst foo = 'bar';\nconst baz = {foo};\nbaz // {foo: \"bar\"}\n\n// ç­åäº\nconst baz = {foo: foo};\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼åéfooç´æ¥åå¨å¤§æ¬å·éé¢ãè¿æ¶ï¼å±æ§åå°±æ¯åéå, å±æ§å¼å°±æ¯åéå¼ãä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nfunction f(x, y) {\n  return {x, y};\n}\n\n// ç­åäº\n\nfunction f(x, y) {\n  return {x: x, y: y};\n}\n\nf(1, 2) // Object {x: 1, y: 2}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\né¤äºå±æ§ç®åï¼æ¹æ³ä¹å¯ä»¥ç®åã\n\nconst o = {\n  method() {\n    return \"Hello!\";\n  }\n};\n\n// ç­åäº\n\nconst o = {\n  method: function() {\n    return \"Hello!\";\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢æ¯ä¸ä¸ªå®éçä¾å­ã\n\nlet birth = '2000/01/01';\n\nconst Person = {\n\n  name: 'å¼ ä¸',\n\n  //ç­åäºbirth: birth\n  birth,\n\n  // ç­åäºhello: function ()...\n  hello() { console.log('æçåå­æ¯', this.name); }\n\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nè¿ç§åæ³ç¨äºå½æ°çè¿åå¼ï¼å°ä¼éå¸¸æ¹ä¾¿ã\n\nfunction getPoint() {\n  const x = 1;\n  const y = 10;\n  return {x, y};\n}\n\ngetPoint()\n// {x:1, y:10}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nCommonJS æ¨¡åè¾åºä¸ç»åéï¼å°±éå¸¸åéä½¿ç¨ç®æ´åæ³ã\n\nlet ms = {};\n\nfunction getItem (key) {\n  return key in ms ? ms[key] : null;\n}\n\nfunction setItem (key, value) {\n  ms[key] = value;\n}\n\nfunction clear () {\n  ms = {};\n}\n\nmodule.exports = { getItem, setItem, clear };\n// ç­åäº\nmodule.exports = {\n  getItem: getItem,\n  setItem: setItem,\n  clear: clear\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nå±æ§çèµå¼å¨ï¼setterï¼ååå¼å¨ï¼getterï¼ï¼äºå®ä¸ä¹æ¯éç¨è¿ç§åæ³ã\n\nconst cart = {\n  _wheels: 4,\n\n  get wheels () {\n    return this._wheels;\n  },\n\n  set wheels (value) {\n    if (value < this._wheels) {\n      throw new Error('æ°å¼å¤ªå°äºï¼');\n    }\n    this._wheels = value;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nç®æ´åæ³å¨æå°å¯¹è±¡æ¶ä¹å¾æç¨ã\n\nlet user = {\n  name: 'test'\n};\n\nlet foo = {\n  bar: 'baz'\n};\n\nconsole.log(user, foo)\n// {name: \"test\"} {bar: \"baz\"}\nconsole.log({user, foo})\n// {user: {name: \"test\"}, foo: {bar: \"baz\"}}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼console.logç´æ¥è¾åºuseråfooä¸¤ä¸ªå¯¹è±¡æ¶ï¼å°±æ¯ä¸¤ç»é®å¼å¯¹ï¼å¯è½ä¼æ··æ·ãæå®ä»¬æ¾å¨å¤§æ¬å·éé¢è¾åºï¼å°±åæäºå¯¹è±¡çç®æ´è¡¨ç¤ºæ³ï¼æ¯ç»é®å¼å¯¹åé¢ä¼æå°å¯¹è±¡åï¼è¿æ ·å°±æ¯è¾æ¸æ°äºã\n\næ³¨æï¼ç®åçå¯¹è±¡æ¹æ³ä¸è½ç¨ä½æé å½æ°ï¼ä¼æ¥éã\n\nconst obj = {\n  f() {\n    this.foo = 'bar';\n  }\n};\n\nnew obj.f() // æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼fæ¯ä¸ä¸ªç®åçå¯¹è±¡æ¹æ³ï¼æä»¥obj.fä¸è½å½ä½æé å½æ°ä½¿ç¨ã\n\n\n# å±æ§åè¡¨è¾¾å¼\n\nJavaScript å®ä¹å¯¹è±¡çå±æ§ï¼æä¸¤ç§æ¹æ³ã\n\n// æ¹æ³ä¸\nobj.foo = true;\n\n// æ¹æ³äº\nobj['a' + 'bc'] = 123;\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç çæ¹æ³ä¸æ¯ç´æ¥ç¨æ è¯ç¬¦ä½ä¸ºå±æ§åï¼æ¹æ³äºæ¯ç¨è¡¨è¾¾å¼ä½ä¸ºå±æ§åï¼è¿æ¶è¦å°è¡¨è¾¾å¼æ¾å¨æ¹æ¬å·ä¹åã\n\nä½æ¯ï¼å¦æä½¿ç¨å­é¢éæ¹å¼å®ä¹å¯¹è±¡ï¼ä½¿ç¨å¤§æ¬å·ï¼ï¼å¨ ES5 ä¸­åªè½ä½¿ç¨æ¹æ³ä¸ï¼æ è¯ç¬¦ï¼å®ä¹å±æ§ã\n\nvar obj = {\n  foo: true,\n  abc: 123\n};\n\n\n1\n2\n3\n4\n\n\nES6 åè®¸å­é¢éå®ä¹å¯¹è±¡æ¶ï¼ç¨æ¹æ³äºï¼è¡¨è¾¾å¼ï¼ä½ä¸ºå¯¹è±¡çå±æ§åï¼å³æè¡¨è¾¾å¼æ¾å¨æ¹æ¬å·åã\n\nlet propKey = 'foo';\n\nlet obj = {\n  [propKey]: true,\n  ['a' + 'bc']: 123\n};\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nlet lastWord = 'last word';\n\nconst a = {\n  'first word': 'hello',\n  [lastWord]: 'world'\n};\n\na['first word'] // \"hello\"\na[lastWord] // \"world\"\na['last word'] // \"world\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nè¡¨è¾¾å¼è¿å¯ä»¥ç¨äºå®ä¹æ¹æ³åã\n\nlet obj = {\n  ['h' + 'ello']() {\n    return 'hi';\n  }\n};\n\nobj.hello() // hi\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næ³¨æï¼å±æ§åè¡¨è¾¾å¼ä¸ç®æ´è¡¨ç¤ºæ³ï¼ä¸è½åæ¶ä½¿ç¨ï¼ä¼æ¥éã\n\n// æ¥é\nconst foo = 'bar';\nconst bar = 'abc';\nconst baz = { [foo] };\n\n// æ­£ç¡®\nconst foo = 'bar';\nconst baz = { [foo]: 'abc'};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næ³¨æï¼å±æ§åè¡¨è¾¾å¼å¦ææ¯ä¸ä¸ªå¯¹è±¡ï¼é»è®¤æåµä¸ä¼èªå¨å°å¯¹è±¡è½¬ä¸ºå­ç¬¦ä¸²[object Object]ï¼è¿ä¸ç¹è¦ç¹å«å°å¿ã\n\nconst keyA = {a: 1};\nconst keyB = {b: 2};\n\nconst myObject = {\n  [keyA]: 'valueA',\n  [keyB]: 'valueB'\n};\n\nmyObject // Object {[object Object]: \"valueB\"}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼[keyA]å[keyB]å¾å°çé½æ¯[object Object]ï¼æä»¥[keyB]ä¼æ[keyA]è¦çæï¼èmyObjectæååªæä¸ä¸ª[object Object]å±æ§ã\n\n\n# æ¹æ³ç name å±æ§\n\nå½æ°çnameå±æ§ï¼è¿åå½æ°åãå¯¹è±¡æ¹æ³ä¹æ¯å½æ°ï¼å æ­¤ä¹ænameå±æ§ã\n\nconst person = {\n  sayName() {\n    console.log('hello!');\n  },\n};\n\nperson.sayName.name   // \"sayName\"\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¹æ³çnameå±æ§è¿åå½æ°åï¼å³æ¹æ³åï¼ã\n\nå¦æå¯¹è±¡çæ¹æ³ä½¿ç¨äºåå¼å½æ°ï¼getterï¼åå­å¼å½æ°ï¼setterï¼ï¼ånameå±æ§ä¸æ¯å¨è¯¥æ¹æ³ä¸é¢ï¼èæ¯è¯¥æ¹æ³çå±æ§çæè¿°å¯¹è±¡çgetåsetå±æ§ä¸é¢ï¼è¿åå¼æ¯æ¹æ³ååå ä¸getåsetã\n\nconst obj = {\n  get foo() {},\n  set foo(x) {}\n};\n\nobj.foo.name\n// TypeError: Cannot read property 'name' of undefined\n\nconst descriptor = Object.getOwnPropertyDescriptor(obj, 'foo');\n\ndescriptor.get.name // \"get foo\"\ndescriptor.set.name // \"set foo\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\næä¸¤ç§ç¹æ®æåµï¼bindæ¹æ³åé çå½æ°ï¼nameå±æ§è¿åboundå ä¸åå½æ°çåå­ï¼Functionæé å½æ°åé çå½æ°ï¼nameå±æ§è¿åanonymousã\n\n(new Function()).name // \"anonymous\"\n\nvar doSomething = function() {\n  // ...\n};\ndoSomething.bind().name // \"bound doSomething\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¦æå¯¹è±¡çæ¹æ³æ¯ä¸ä¸ª Symbol å¼ï¼é£ä¹nameå±æ§è¿åçæ¯è¿ä¸ª Symbol å¼çæè¿°ã\n\nconst key1 = Symbol('description');\nconst key2 = Symbol();\nlet obj = {\n  [key1]() {},\n  [key2]() {},\n};\nobj[key1].name // \"[description]\"\nobj[key2].name // \"\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼key1å¯¹åºç Symbol å¼ææè¿°ï¼key2æ²¡æã\n\n\n# å±æ§çå¯æä¸¾æ§åéå\n\n\n# å¯æä¸¾æ§\n\nå¯¹è±¡çæ¯ä¸ªå±æ§é½æä¸ä¸ªæè¿°å¯¹è±¡ï¼Descriptorï¼ï¼ç¨æ¥æ§å¶è¯¥å±æ§çè¡ä¸ºãObject.getOwnPropertyDescriptoræ¹æ³å¯ä»¥è·åè¯¥å±æ§çæè¿°å¯¹è±¡ã\n\nlet obj = { foo: 123 };\nObject.getOwnPropertyDescriptor(obj, 'foo')\n//  {\n//    value: 123,\n//    writable: true,\n//    enumerable: true,\n//    configurable: true\n//  }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næè¿°å¯¹è±¡çenumerableå±æ§ï¼ç§°ä¸ºâå¯æä¸¾æ§âï¼å¦æè¯¥å±æ§ä¸ºfalseï¼å°±è¡¨ç¤ºæäºæä½ä¼å¿½ç¥å½åå±æ§ã\n\nç®åï¼æåä¸ªæä½ä¼å¿½ç¥enumerableä¸ºfalseçå±æ§ã\n\n * for...inå¾ªç¯ï¼åªéåå¯¹è±¡èªèº«çåç»§æ¿çå¯æä¸¾çå±æ§ã\n * Object.keys()ï¼è¿åå¯¹è±¡èªèº«çææå¯æä¸¾çå±æ§çé®åã\n * JSON.stringify()ï¼åªä¸²è¡åå¯¹è±¡èªèº«çå¯æä¸¾çå±æ§ã\n * Object.assign()ï¼ å¿½ç¥enumerableä¸ºfalseçå±æ§ï¼åªæ·è´å¯¹è±¡èªèº«çå¯æä¸¾çå±æ§ã\n\nè¿åä¸ªæä½ä¹ä¸­ï¼åä¸ä¸ªæ¯ ES5 å°±æçï¼æåä¸ä¸ªObject.assign()æ¯ ES6 æ°å¢çãå¶ä¸­ï¼åªæfor...inä¼è¿åç»§æ¿çå±æ§ï¼å¶ä»ä¸ä¸ªæ¹æ³é½ä¼å¿½ç¥ç»§æ¿çå±æ§ï¼åªå¤çå¯¹è±¡èªèº«çå±æ§ãå®éä¸ï¼å¼å¥âå¯æä¸¾âï¼enumerableï¼è¿ä¸ªæ¦å¿µçæåç®çï¼å°±æ¯è®©æäºå±æ§å¯ä»¥è§é¿æfor...inæä½ï¼ä¸ç¶ææåé¨å±æ§åæ¹æ³é½ä¼è¢«éåå°ãæ¯å¦ï¼å¯¹è±¡ååçtoStringæ¹æ³ï¼ä»¥åæ°ç»çlengthå±æ§ï¼å°±éè¿âå¯æä¸¾æ§âï¼ä»èé¿åè¢«for...inéåå°ã\n\nObject.getOwnPropertyDescriptor(Object.prototype, 'toString').enumerable\n// false\n\nObject.getOwnPropertyDescriptor([], 'length').enumerable\n// false\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼toStringålengthå±æ§çenumerableé½æ¯falseï¼å æ­¤for...inä¸ä¼éåå°è¿ä¸¤ä¸ªç»§æ¿èªååçå±æ§ã\n\nå¦å¤ï¼ES6 è§å®ï¼ææ Class çååçæ¹æ³é½æ¯ä¸å¯æä¸¾çã\n\nObject.getOwnPropertyDescriptor(class {foo() {}}.prototype, 'foo').enumerable\n// false\n\n\n1\n2\n\n\næ»çæ¥è¯´ï¼æä½ä¸­å¼å¥ç»§æ¿çå±æ§ä¼è®©é®é¢å¤æåï¼å¤§å¤æ°æ¶åï¼æä»¬åªå³å¿å¯¹è±¡èªèº«çå±æ§ãæä»¥ï¼å°½éä¸è¦ç¨for...inå¾ªç¯ï¼èç¨Object.keys()ä»£æ¿ã\n\n\n# å±æ§çéå\n\nES6 ä¸å±æ 5 ç§æ¹æ³å¯ä»¥éåå¯¹è±¡çå±æ§ã\n\nï¼1ï¼for...in\n\nfor...inå¾ªç¯éåå¯¹è±¡èªèº«çåç»§æ¿çå¯æä¸¾å±æ§ï¼ä¸å« Symbol å±æ§ï¼ã\n\nï¼2ï¼Object.keys(obj)\n\nObject.keysè¿åä¸ä¸ªæ°ç»ï¼åæ¬å¯¹è±¡èªèº«çï¼ä¸å«ç»§æ¿çï¼ææå¯æä¸¾å±æ§ï¼ä¸å« Symbol å±æ§ï¼çé®åã\n\nï¼3ï¼Object.getOwnPropertyNames(obj)\n\nObject.getOwnPropertyNamesè¿åä¸ä¸ªæ°ç»ï¼åå«å¯¹è±¡èªèº«çææå±æ§ï¼ä¸å« Symbol å±æ§ï¼ä½æ¯åæ¬ä¸å¯æä¸¾å±æ§ï¼çé®åã\n\nï¼4ï¼Object.getOwnPropertySymbols(obj)\n\nObject.getOwnPropertySymbolsè¿åä¸ä¸ªæ°ç»ï¼åå«å¯¹è±¡èªèº«çææ Symbol å±æ§çé®åã\n\nï¼5ï¼Reflect.ownKeys(obj)\n\nReflect.ownKeysè¿åä¸ä¸ªæ°ç»ï¼åå«å¯¹è±¡èªèº«çææé®åï¼ä¸ç®¡é®åæ¯ Symbol æå­ç¬¦ä¸²ï¼ä¹ä¸ç®¡æ¯å¦å¯æä¸¾ã\n\nä»¥ä¸ç 5 ç§æ¹æ³éåå¯¹è±¡çé®åï¼é½éµå®åæ ·çå±æ§éåçæ¬¡åºè§åã\n\n * é¦åéåæææ°å¼é®ï¼æç§æ°å¼ååºæåã\n * å¶æ¬¡éåææå­ç¬¦ä¸²é®ï¼æç§å å¥æ¶é´ååºæåã\n * æåéåææ Symbol é®ï¼æç§å å¥æ¶é´ååºæåã\n\nReflect.ownKeys({ [Symbol()]:0, b:0, 10:0, 2:0, a:0 })\n// ['2', '10', 'b', 'a', Symbol()]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼Reflect.ownKeysæ¹æ³è¿åä¸ä¸ªæ°ç»ï¼åå«äºåæ°å¯¹è±¡çææå±æ§ãè¿ä¸ªæ°ç»çå±æ§æ¬¡åºæ¯è¿æ ·çï¼é¦åæ¯æ°å¼å±æ§2å10ï¼å¶æ¬¡æ¯å­ç¬¦ä¸²å±æ§båaï¼æåæ¯ Symbol å±æ§ã\n\n\n# super å³é®å­\n\næä»¬ç¥éï¼thiså³é®å­æ»æ¯æåå½æ°æå¨çå½åå¯¹è±¡ï¼ES6 åæ°å¢äºå¦ä¸ä¸ªç±»ä¼¼çå³é®å­superï¼æåå½åå¯¹è±¡çååå¯¹è±¡ã\n\nconst proto = {\n  foo: 'hello'\n};\n\nconst obj = {\n  foo: 'world',\n  find() {\n    return super.foo;\n  }\n};\n\nObject.setPrototypeOf(obj, proto);\nobj.find() // \"hello\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯¹è±¡obj.find()æ¹æ³ä¹ä¸­ï¼éè¿super.fooå¼ç¨äºååå¯¹è±¡protoçfooå±æ§ã\n\næ³¨æï¼superå³é®å­è¡¨ç¤ºååå¯¹è±¡æ¶ï¼åªè½ç¨å¨å¯¹è±¡çæ¹æ³ä¹ä¸­ï¼ç¨å¨å¶ä»å°æ¹é½ä¼æ¥éã\n\n// æ¥é\nconst obj = {\n  foo: super.foo\n}\n\n// æ¥é\nconst obj = {\n  foo: () => super.foo\n}\n\n// æ¥é\nconst obj = {\n  foo: function () {\n    return super.foo\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä¸ç§superçç¨æ³é½ä¼æ¥éï¼å ä¸ºå¯¹äº JavaScript å¼ææ¥è¯´ï¼è¿éçsuperé½æ²¡æç¨å¨å¯¹è±¡çæ¹æ³ä¹ä¸­ãç¬¬ä¸ç§åæ³æ¯superç¨å¨å±æ§éé¢ï¼ç¬¬äºç§åç¬¬ä¸ç§åæ³æ¯superç¨å¨ä¸ä¸ªå½æ°éé¢ï¼ç¶åèµå¼ç»fooå±æ§ãç®åï¼åªæå¯¹è±¡æ¹æ³çç®åæ³å¯ä»¥è®© JavaScript å¼æç¡®è®¤ï¼å®ä¹çæ¯å¯¹è±¡çæ¹æ³ã\n\nJavaScript å¼æåé¨ï¼super.fooç­åäºObject.getPrototypeOf(this).fooï¼å±æ§ï¼æObject.getPrototypeOf(this).foo.call(this)ï¼æ¹æ³ï¼ã\n\nconst proto = {\n  x: 'hello',\n  foo() {\n    console.log(this.x);\n  },\n};\n\nconst obj = {\n  x: 'world',\n  foo() {\n    super.foo();\n  }\n}\n\nObject.setPrototypeOf(obj, proto);\n\nobj.foo() // \"world\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼super.fooæåååå¯¹è±¡protoçfooæ¹æ³ï¼ä½æ¯ç»å®çthiså´è¿æ¯å½åå¯¹è±¡objï¼å æ­¤è¾åºçå°±æ¯worldã\n\n\n# å¯¹è±¡çæ©å±è¿ç®ç¬¦\n\nãæ°ç»çæ©å±ãä¸ç« ä¸­ï¼å·²ç»ä»ç»è¿æ©å±è¿ç®ç¬¦ï¼...ï¼ãES2018 å°è¿ä¸ªè¿ç®ç¬¦å¼å¥äºå¯¹è±¡ã\n\n\n# è§£æèµå¼\n\nå¯¹è±¡çè§£æèµå¼ç¨äºä»ä¸ä¸ªå¯¹è±¡åå¼ï¼ç¸å½äºå°ç®æ å¯¹è±¡èªèº«çææå¯éåçï¼enumerableï¼ãä½å°æªè¢«è¯»åçå±æ§ï¼åéå°æå®çå¯¹è±¡ä¸é¢ãææçé®åå®ä»¬çå¼ï¼é½ä¼æ·è´å°æ°å¯¹è±¡ä¸é¢ã\n\nlet { x, y, ...z } = { x: 1, y: 2, a: 3, b: 4 };\nx // 1\ny // 2\nz // { a: 3, b: 4 }\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼åézæ¯è§£æèµå¼æå¨çå¯¹è±¡ãå®è·åç­å·å³è¾¹çææå°æªè¯»åçé®ï¼aåbï¼ï¼å°å®ä»¬è¿åå¼ä¸èµ·æ·è´è¿æ¥ã\n\nç±äºè§£æèµå¼è¦æ±ç­å·å³è¾¹æ¯ä¸ä¸ªå¯¹è±¡ï¼æä»¥å¦æç­å·å³è¾¹æ¯undefinedænullï¼å°±ä¼æ¥éï¼å ä¸ºå®ä»¬æ æ³è½¬ä¸ºå¯¹è±¡ã\n\nlet { ...z } = null; // è¿è¡æ¶éè¯¯\nlet { ...z } = undefined; // è¿è¡æ¶éè¯¯\n\n\n1\n2\n\n\nè§£æèµå¼å¿é¡»æ¯æåä¸ä¸ªåæ°ï¼å¦åä¼æ¥éã\n\nlet { ...x, y, z } = someObject; // å¥æ³éè¯¯\nlet { x, ...y, ...z } = someObject; // å¥æ³éè¯¯\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼è§£æèµå¼ä¸æ¯æåä¸ä¸ªåæ°ï¼æä»¥ä¼æ¥éã\n\næ³¨æï¼è§£æèµå¼çæ·è´æ¯æµæ·è´ï¼å³å¦æä¸ä¸ªé®çå¼æ¯å¤åç±»åçå¼ï¼æ°ç»ãå¯¹è±¡ãå½æ°ï¼ãé£ä¹è§£æèµå¼æ·è´çæ¯è¿ä¸ªå¼çå¼ç¨ï¼èä¸æ¯è¿ä¸ªå¼çå¯æ¬ã\n\nlet obj = { a: { b: 1 } };\nlet { ...x } = obj;\nobj.a.b = 2;\nx.a.b // 2\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼xæ¯è§£æèµå¼æå¨çå¯¹è±¡ï¼æ·è´äºå¯¹è±¡objçaå±æ§ãaå±æ§å¼ç¨äºä¸ä¸ªå¯¹è±¡ï¼ä¿®æ¹è¿ä¸ªå¯¹è±¡çå¼ï¼ä¼å½±åå°è§£æèµå¼å¯¹å®çå¼ç¨ã\n\nå¦å¤ï¼æ©å±è¿ç®ç¬¦çè§£æèµå¼ï¼ä¸è½å¤å¶ç»§æ¿èªååå¯¹è±¡çå±æ§ã\n\nlet o1 = { a: 1 };\nlet o2 = { b: 2 };\no2.__proto__ = o1;\nlet { ...o3 } = o2;\no3 // { b: 2 }\no3.a // undefined\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯¹è±¡o3å¤å¶äºo2ï¼ä½æ¯åªå¤å¶äºo2èªèº«çå±æ§ï¼æ²¡æå¤å¶å®çååå¯¹è±¡o1çå±æ§ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nconst o = Object.create({ x: 1, y: 2 });\no.z = 3;\n\nlet { x, ...newObj } = o;\nlet { y, z } = newObj;\nx // 1\ny // undefined\nz // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼åéxæ¯åçº¯çè§£æèµå¼ï¼æä»¥å¯ä»¥è¯»åå¯¹è±¡oç»§æ¿çå±æ§ï¼åéyåzæ¯æ©å±è¿ç®ç¬¦çè§£æèµå¼ï¼åªè½è¯»åå¯¹è±¡oèªèº«çå±æ§ï¼æä»¥åézå¯ä»¥èµå¼æåï¼åéyåä¸å°å¼ãES6 è§å®ï¼åéå£°æè¯­å¥ä¹ä¸­ï¼å¦æä½¿ç¨è§£æèµå¼ï¼æ©å±è¿ç®ç¬¦åé¢å¿é¡»æ¯ä¸ä¸ªåéåï¼èä¸è½æ¯ä¸ä¸ªè§£æèµå¼è¡¨è¾¾å¼ï¼æä»¥ä¸é¢ä»£ç å¼å¥äºä¸­é´åénewObjï¼å¦æåæä¸é¢è¿æ ·ä¼æ¥éã\n\nlet { x, ...{ y, z } } = o;\n// SyntaxError: ... must be followed by an identifier in declaration contexts\n\n\n1\n2\n\n\nè§£æèµå¼çä¸ä¸ªç¨å¤ï¼æ¯æ©å±æä¸ªå½æ°çåæ°ï¼å¼å¥å¶ä»æä½ã\n\nfunction baseFunction({ a, b }) {\n  // ...\n}\nfunction wrapperFunction({ x, y, ...restConfig }) {\n  // ä½¿ç¨ x å y åæ°è¿è¡æä½\n  // å¶ä½åæ°ä¼ ç»åå§å½æ°\n  return baseFunction(restConfig);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼åå§å½æ°baseFunctionæ¥åaåbä½ä¸ºåæ°ï¼å½æ°wrapperFunctionå¨baseFunctionçåºç¡ä¸è¿è¡äºæ©å±ï¼è½å¤æ¥åå¤ä½çåæ°ï¼å¹¶ä¸ä¿çåå§å½æ°çè¡ä¸ºã\n\n\n# æ©å±è¿ç®ç¬¦\n\nå¯¹è±¡çæ©å±è¿ç®ç¬¦ï¼...ï¼ç¨äºååºåæ°å¯¹è±¡çææå¯éåå±æ§ï¼æ·è´å°å½åå¯¹è±¡ä¹ä¸­ã\n\nlet z = { a: 3, b: 4 };\nlet n = { ...z };\nn // { a: 3, b: 4 }\n\n\n1\n2\n3\n\n\nç±äºæ°ç»æ¯ç¹æ®çå¯¹è±¡ï¼æä»¥å¯¹è±¡çæ©å±è¿ç®ç¬¦ä¹å¯ä»¥ç¨äºæ°ç»ã\n\nlet foo = { ...['a', 'b', 'c'] };\nfoo\n// {0: \"a\", 1: \"b\", 2: \"c\"}\n\n\n1\n2\n3\n\n\nå¦ææ©å±è¿ç®ç¬¦åé¢æ¯ä¸ä¸ªç©ºå¯¹è±¡ï¼åæ²¡æä»»ä½ææã\n\n{...{}, a: 1}\n// { a: 1 }\n\n\n1\n2\n\n\nå¦ææ©å±è¿ç®ç¬¦åé¢ä¸æ¯å¯¹è±¡ï¼åä¼èªå¨å°å¶è½¬ä¸ºå¯¹è±¡ã\n\n// ç­åäº {...Object(1)}\n{...1} // {}\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼æ©å±è¿ç®ç¬¦åé¢æ¯æ´æ°1ï¼ä¼èªå¨è½¬ä¸ºæ°å¼çåè£å¯¹è±¡Number{1}ãç±äºè¯¥å¯¹è±¡æ²¡æèªèº«å±æ§ï¼æä»¥è¿åä¸ä¸ªç©ºå¯¹è±¡ã\n\nä¸é¢çä¾å­é½æ¯ç±»ä¼¼çéçã\n\n// ç­åäº {...Object(true)}\n{...true} // {}\n\n// ç­åäº {...Object(undefined)}\n{...undefined} // {}\n\n// ç­åäº {...Object(null)}\n{...null} // {}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä½æ¯ï¼å¦ææ©å±è¿ç®ç¬¦åé¢æ¯å­ç¬¦ä¸²ï¼å®ä¼èªå¨è½¬æä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ï¼å æ­¤è¿åçä¸æ¯ç©ºå¯¹è±¡ã\n\n{...'hello'}\n// {0: \"h\", 1: \"e\", 2: \"l\", 3: \"l\", 4: \"o\"}\n\n\n1\n2\n\n\nå¯¹è±¡çæ©å±è¿ç®ç¬¦ç­åäºä½¿ç¨Object.assign()æ¹æ³ã\n\nlet aClone = { ...a };\n// ç­åäº\nlet aClone = Object.assign({}, a);\n\n\n1\n2\n3\n\n\nä¸é¢çä¾å­åªæ¯æ·è´äºå¯¹è±¡å®ä¾çå±æ§ï¼å¦ææ³å®æ´åéä¸ä¸ªå¯¹è±¡ï¼è¿æ·è´å¯¹è±¡ååçå±æ§ï¼å¯ä»¥éç¨ä¸é¢çåæ³ã\n\n// åæ³ä¸\nconst clone1 = {\n  __proto__: Object.getPrototypeOf(obj),\n  ...obj\n};\n\n// åæ³äº\nconst clone2 = Object.assign(\n  Object.create(Object.getPrototypeOf(obj)),\n  obj\n);\n\n// åæ³ä¸\nconst clone3 = Object.create(\n  Object.getPrototypeOf(obj),\n  Object.getOwnPropertyDescriptors(obj)\n)\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ³ä¸ç__proto__å±æ§å¨éæµè§å¨çç¯å¢ä¸ä¸å®é¨ç½²ï¼å æ­¤æ¨èä½¿ç¨åæ³äºååæ³ä¸ã\n\næ©å±è¿ç®ç¬¦å¯ä»¥ç¨äºåå¹¶ä¸¤ä¸ªå¯¹è±¡ã\n\nlet ab = { ...a, ...b };\n// ç­åäº\nlet ab = Object.assign({}, a, b);\n\n\n1\n2\n3\n\n\nå¦æç¨æ·èªå®ä¹çå±æ§ï¼æ¾å¨æ©å±è¿ç®ç¬¦åé¢ï¼åæ©å±è¿ç®ç¬¦åé¨çååå±æ§ä¼è¢«è¦çæã\n\nlet aWithOverrides = { ...a, x: 1, y: 2 };\n// ç­åäº\nlet aWithOverrides = { ...a, ...{ x: 1, y: 2 } };\n// ç­åäº\nlet x = 1, y = 2, aWithOverrides = { ...a, x, y };\n// ç­åäº\nlet aWithOverrides = Object.assign({}, a, { x: 1, y: 2 });\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼aå¯¹è±¡çxå±æ§åyå±æ§ï¼æ·è´å°æ°å¯¹è±¡åä¼è¢«è¦çæã\n\nè¿ç¨æ¥ä¿®æ¹ç°æå¯¹è±¡é¨åçå±æ§å°±å¾æ¹ä¾¿äºã\n\nlet newVersion = {\n  ...previousVersion,\n  name: 'New Name' // Override the name property\n};\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼newVersionå¯¹è±¡èªå®ä¹äºnameå±æ§ï¼å¶ä»å±æ§å¨é¨å¤å¶èªpreviousVersionå¯¹è±¡ã\n\nå¦ææèªå®ä¹å±æ§æ¾å¨æ©å±è¿ç®ç¬¦åé¢ï¼å°±åæäºè®¾ç½®æ°å¯¹è±¡çé»è®¤å±æ§å¼ã\n\nlet aWithDefaults = { x: 1, y: 2, ...a };\n// ç­åäº\nlet aWithDefaults = Object.assign({}, { x: 1, y: 2 }, a);\n// ç­åäº\nlet aWithDefaults = Object.assign({ x: 1, y: 2 }, a);\n\n\n1\n2\n3\n4\n5\n\n\nä¸æ°ç»çæ©å±è¿ç®ç¬¦ä¸æ ·ï¼å¯¹è±¡çæ©å±è¿ç®ç¬¦åé¢å¯ä»¥è·è¡¨è¾¾å¼ã\n\nconst obj = {\n  ...(x > 1 ? {a: 1} : {}),\n  b: 2,\n};\n\n\n1\n2\n3\n4\n\n\næ©å±è¿ç®ç¬¦çåæ°å¯¹è±¡ä¹ä¸­ï¼å¦ææåå¼å½æ°getï¼è¿ä¸ªå½æ°æ¯ä¼æ§è¡çã\n\n// å¹¶ä¸ä¼æåºéè¯¯ï¼å ä¸º x å±æ§åªæ¯è¢«å®ä¹ï¼ä½æ²¡æ§è¡\nlet aWithXGetter = {\n  ...a,\n  get x() {\n    throw new Error('not throw yet');\n  }\n};\n\n// ä¼æåºéè¯¯ï¼å ä¸º x å±æ§è¢«æ§è¡äº\nlet runtimeError = {\n  ...a,\n  ...{\n    get x() {\n      throw new Error('throw now');\n    }\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n# é¾å¤æ­è¿ç®ç¬¦\n\nç¼ç¨å®å¡ä¸­ï¼å¦æè¯»åå¯¹è±¡åé¨çæä¸ªå±æ§ï¼å¾å¾éè¦å¤æ­ä¸ä¸è¯¥å¯¹è±¡æ¯å¦å­å¨ãæ¯å¦ï¼è¦è¯»åmessage.body.user.firstNameï¼å®å¨çåæ³æ¯åæä¸é¢è¿æ ·ã\n\nconst firstName = (message\n  && message.body\n  && message.body.user\n  && message.body.user.firstName) || 'default';\n\n\n1\n2\n3\n4\n\n\næèä½¿ç¨ä¸åè¿ç®ç¬¦?:ï¼å¤æ­ä¸ä¸ªå¯¹è±¡æ¯å¦å­å¨ã\n\nconst fooInput = myForm.querySelector('input[name=foo]')\nconst fooValue = fooInput ? fooInput.value : undefined\n\n\n1\n2\n\n\nè¿æ ·çå±å±å¤æ­éå¸¸éº»ç¦ï¼å æ­¤ ES2020 å¼å¥äºâé¾å¤æ­è¿ç®ç¬¦âï¼optional chaining operatorï¼?.ï¼ç®åä¸é¢çåæ³ã\n\nconst firstName = message?.body?.user?.firstName || 'default';\nconst fooValue = myForm.querySelector('input[name=foo]')?.value\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä½¿ç¨äº?.è¿ç®ç¬¦ï¼ç´æ¥å¨é¾å¼è°ç¨çæ¶åå¤æ­ï¼å·¦ä¾§çå¯¹è±¡æ¯å¦ä¸ºnullæundefinedãå¦ææ¯çï¼å°±ä¸åå¾ä¸è¿ç®ï¼èæ¯è¿åundefinedã\n\né¾å¤æ­è¿ç®ç¬¦æä¸ç§ç¨æ³ã\n\n * obj?.prop // å¯¹è±¡å±æ§\n * obj?.[expr] // åä¸\n * func?.(...args) // å½æ°æå¯¹è±¡æ¹æ³çè°ç¨\n\nä¸é¢æ¯å¤æ­å¯¹è±¡æ¹æ³æ¯å¦å­å¨ï¼å¦æå­å¨å°±ç«å³æ§è¡çä¾å­ã\n\niterator.return?.()\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼iterator.returnå¦ææå®ä¹ï¼å°±ä¼è°ç¨è¯¥æ¹æ³ï¼å¦åç´æ¥è¿åundefinedã\n\nå¯¹äºé£äºå¯è½æ²¡æå®ç°çæ¹æ³ï¼è¿ä¸ªè¿ç®ç¬¦å°¤å¶æç¨ã\n\nif (myForm.checkValidity?.() === false) {\n  // è¡¨åæ ¡éªå¤±è´¥\n  return;\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼èå¼æµè§å¨çè¡¨åå¯è½æ²¡æcheckValidityè¿ä¸ªæ¹æ³ï¼è¿æ¶?.è¿ç®ç¬¦å°±ä¼è¿åundefinedï¼å¤æ­è¯­å¥å°±åæäºundefined === falseï¼æä»¥å°±ä¼è·³è¿ä¸é¢çä»£ç ã\n\nä¸é¢æ¯è¿ä¸ªè¿ç®ç¬¦å¸¸è§çä½¿ç¨å½¢å¼ï¼ä»¥åä¸ä½¿ç¨è¯¥è¿ç®ç¬¦æ¶çç­ä»·å½¢å¼ã\n\na?.b\n// ç­åäº\na == null ? undefined : a.b\n\na?.[x]\n// ç­åäº\na == null ? undefined : a[x]\n\na?.b()\n// ç­åäº\na == null ? undefined : a.b()\n\na?.()\n// ç­åäº\na == null ? undefined : a()\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¹å«æ³¨æåä¸¤ç§å½¢å¼ï¼å¦æa?.b()éé¢ça.bä¸æ¯å½æ°ï¼ä¸å¯è°ç¨ï¼é£ä¹a?.b()æ¯ä¼æ¥éçãa?.()ä¹æ¯å¦æ­¤ï¼å¦æaä¸æ¯nullæundefinedï¼ä½ä¹ä¸æ¯å½æ°ï¼é£ä¹a?.()ä¼æ¥éã\n\nä½¿ç¨è¿ä¸ªè¿ç®ç¬¦ï¼æå ä¸ªæ³¨æç¹ã\n\nï¼1ï¼ç­è·¯æºå¶\n\na?.[++x]\n// ç­åäº\na == null ? undefined : a[++x]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æaæ¯undefinedænullï¼é£ä¹xä¸ä¼è¿è¡éå¢è¿ç®ãä¹å°±æ¯è¯´ï¼é¾å¤æ­è¿ç®ç¬¦ä¸æ¦ä¸ºçï¼å³ä¾§çè¡¨è¾¾å¼å°±ä¸åæ±å¼ã\n\nï¼2ï¼delete è¿ç®ç¬¦\n\ndelete a?.b\n// ç­åäº\na == null ? undefined : delete a.b\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æaæ¯undefinedænullï¼ä¼ç´æ¥è¿åundefinedï¼èä¸ä¼è¿è¡deleteè¿ç®ã\n\nï¼3ï¼æ¬å·çå½±å\n\nå¦æå±æ§é¾æåæ¬å·ï¼é¾å¤æ­è¿ç®ç¬¦å¯¹åæ¬å·å¤é¨æ²¡æå½±åï¼åªå¯¹åæ¬å·åé¨æå½±åã\n\n(a?.b).c\n// ç­ä»·äº\n(a == null ? undefined : a.b).c\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼?.å¯¹åæ¬å·å¤é¨æ²¡æå½±åï¼ä¸ç®¡aå¯¹è±¡æ¯å¦å­å¨ï¼åæ¬å·åé¢ç.cæ»æ¯ä¼æ§è¡ã\n\nä¸è¬æ¥è¯´ï¼ä½¿ç¨?.è¿ç®ç¬¦çåºåï¼ä¸åºè¯¥ä½¿ç¨åæ¬å·ã\n\nï¼4ï¼æ¥éåºå\n\nä»¥ä¸åæ³æ¯ç¦æ­¢çï¼ä¼æ¥éã\n\n// æé å½æ°\nnew a?.()\nnew a?.b()\n\n// é¾å¤æ­è¿ç®ç¬¦çå³ä¾§ææ¨¡æ¿å­ç¬¦ä¸²\na?.`{b}`\na?.b`{c}`\n\n// é¾å¤æ­è¿ç®ç¬¦çå·¦ä¾§æ¯ super\nsuper?.()\nsuper?.foo\n\n// é¾è¿ç®ç¬¦ç¨äºèµå¼è¿ç®ç¬¦å·¦ä¾§\na?.b = c\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nï¼5ï¼å³ä¾§ä¸å¾ä¸ºåè¿å¶æ°å¼\n\nä¸ºäºä¿è¯å¼å®¹ä»¥åçä»£ç ï¼åè®¸foo?.3:0è¢«è§£ææfoo ? .3 : 0ï¼å æ­¤è§å®å¦æ?.åé¢ç´§è·ä¸ä¸ªåè¿å¶æ°å­ï¼é£ä¹?.ä¸åè¢«çææ¯ä¸ä¸ªå®æ´çè¿ç®ç¬¦ï¼èä¼æç§ä¸åè¿ç®ç¬¦è¿è¡å¤çï¼ä¹å°±æ¯è¯´ï¼é£ä¸ªå°æ°ç¹ä¼å½å±äºåé¢çåè¿å¶æ°å­ï¼å½¢æä¸ä¸ªå°æ°ã\n\n\n# Null å¤æ­è¿ç®ç¬¦\n\nè¯»åå¯¹è±¡å±æ§çæ¶åï¼å¦ææä¸ªå±æ§çå¼æ¯nullæundefinedï¼ææ¶åéè¦ä¸ºå®ä»¬æå®é»è®¤å¼ãå¸¸è§åæ³æ¯éè¿||è¿ç®ç¬¦æå®é»è®¤å¼ã\n\nconst headerText = response.settings.headerText || 'Hello, world!';\nconst animationDuration = response.settings.animationDuration || 300;\nconst showSplashScreen = response.settings.showSplashScreen || true;\n\n\n1\n2\n3\n\n\nä¸é¢çä¸è¡ä»£ç é½éè¿||è¿ç®ç¬¦æå®é»è®¤å¼ï¼ä½æ¯è¿æ ·åæ¯éçãå¼åèçåææ¯ï¼åªè¦å±æ§çå¼ä¸ºnullæundefinedï¼é»è®¤å¼å°±ä¼çæï¼ä½æ¯å±æ§çå¼å¦æä¸ºç©ºå­ç¬¦ä¸²æfalseæ0ï¼é»è®¤å¼ä¹ä¼çæã\n\nä¸ºäºé¿åè¿ç§æåµï¼ES2020 å¼å¥äºä¸ä¸ªæ°ç Null å¤æ­è¿ç®ç¬¦??ãå®çè¡ä¸ºç±»ä¼¼||ï¼ä½æ¯åªæè¿ç®ç¬¦å·¦ä¾§çå¼ä¸ºnullæundefinedæ¶ï¼æä¼è¿åå³ä¾§çå¼ã\n\nconst headerText = response.settings.headerText ?? 'Hello, world!';\nconst animationDuration = response.settings.animationDuration ?? 300;\nconst showSplashScreen = response.settings.showSplashScreen ?? true;\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼é»è®¤å¼åªæå¨å±æ§å¼ä¸ºnullæundefinedæ¶ï¼æä¼çæã\n\nè¿ä¸ªè¿ç®ç¬¦çä¸ä¸ªç®çï¼å°±æ¯è·é¾å¤æ­è¿ç®ç¬¦?.éåä½¿ç¨ï¼ä¸ºnullæundefinedçå¼è®¾ç½®é»è®¤å¼ã\n\nconst animationDuration = response.settings?.animationDuration ?? 300;\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼response.settingså¦ææ¯nullæundefinedï¼å°±ä¼è¿åé»è®¤å¼300ã\n\nè¿ä¸ªè¿ç®ç¬¦å¾éåå¤æ­å½æ°åæ°æ¯å¦èµå¼ã\n\nfunction Component(props) {\n  const enable = props.enabled ?? true;\n  // â¦\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç å¤æ­propsåæ°çenabledå±æ§æ¯å¦èµå¼ï¼ç­åäºä¸é¢çåæ³ã\n\nfunction Component(props) {\n  const {\n    enabled: enable = true,\n  } = props;\n  // â¦\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\n??æä¸ä¸ªè¿ç®ä¼åçº§é®é¢ï¼å®ä¸&&å||çä¼åçº§å­°é«å­°ä½ãç°å¨çè§åæ¯ï¼å¦æå¤ä¸ªé»è¾è¿ç®ç¬¦ä¸èµ·ä½¿ç¨ï¼å¿é¡»ç¨æ¬å·è¡¨æä¼åçº§ï¼å¦åä¼æ¥éã\n\n// æ¥é\nlhs && middle ?? rhs\nlhs ?? middle && rhs\nlhs || middle ?? rhs\nlhs ?? middle || rhs\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢åä¸ªè¡¨è¾¾å¼é½ä¼æ¥éï¼å¿é¡»å å¥è¡¨æä¼åçº§çæ¬å·ã\n\n(lhs && middle) ?? rhs;\nlhs && (middle ?? rhs);\n\n(lhs ?? middle) && rhs;\nlhs ?? (middle && rhs);\n\n(lhs || middle) ?? rhs;\nlhs || (middle ?? rhs);\n\n(lhs ?? middle) || rhs;\nlhs ?? (middle || rhs);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n",normalizedContent:"# å¯¹è±¡çæ©å±\n\nå¯¹è±¡ï¼objectï¼æ¯ javascript æéè¦çæ°æ®ç»æães6 å¯¹å®è¿è¡äºéå¤§åçº§ï¼æ¬ç« ä»ç»æ°æ®ç»ææ¬èº«çæ¹åï¼ä¸ä¸ç« ä»ç»objectå¯¹è±¡çæ°å¢æ¹æ³ã\n\n\n# å±æ§çç®æ´è¡¨ç¤ºæ³\n\nes6 åè®¸å¨å¤§æ¬å·éé¢ï¼ç´æ¥åå¥åéåå½æ°ï¼ä½ä¸ºå¯¹è±¡çå±æ§åæ¹æ³ãè¿æ ·çä¹¦åæ´å ç®æ´ã\n\nconst foo = 'bar';\nconst baz = {foo};\nbaz // {foo: \"bar\"}\n\n// ç­åäº\nconst baz = {foo: foo};\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼åéfooç´æ¥åå¨å¤§æ¬å·éé¢ãè¿æ¶ï¼å±æ§åå°±æ¯åéå, å±æ§å¼å°±æ¯åéå¼ãä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nfunction f(x, y) {\n  return {x, y};\n}\n\n// ç­åäº\n\nfunction f(x, y) {\n  return {x: x, y: y};\n}\n\nf(1, 2) // object {x: 1, y: 2}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\né¤äºå±æ§ç®åï¼æ¹æ³ä¹å¯ä»¥ç®åã\n\nconst o = {\n  method() {\n    return \"hello!\";\n  }\n};\n\n// ç­åäº\n\nconst o = {\n  method: function() {\n    return \"hello!\";\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢æ¯ä¸ä¸ªå®éçä¾å­ã\n\nlet birth = '2000/01/01';\n\nconst person = {\n\n  name: 'å¼ ä¸',\n\n  //ç­åäºbirth: birth\n  birth,\n\n  // ç­åäºhello: function ()...\n  hello() { console.log('æçåå­æ¯', this.name); }\n\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nè¿ç§åæ³ç¨äºå½æ°çè¿åå¼ï¼å°ä¼éå¸¸æ¹ä¾¿ã\n\nfunction getpoint() {\n  const x = 1;\n  const y = 10;\n  return {x, y};\n}\n\ngetpoint()\n// {x:1, y:10}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\ncommonjs æ¨¡åè¾åºä¸ç»åéï¼å°±éå¸¸åéä½¿ç¨ç®æ´åæ³ã\n\nlet ms = {};\n\nfunction getitem (key) {\n  return key in ms ? ms[key] : null;\n}\n\nfunction setitem (key, value) {\n  ms[key] = value;\n}\n\nfunction clear () {\n  ms = {};\n}\n\nmodule.exports = { getitem, setitem, clear };\n// ç­åäº\nmodule.exports = {\n  getitem: getitem,\n  setitem: setitem,\n  clear: clear\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nå±æ§çèµå¼å¨ï¼setterï¼ååå¼å¨ï¼getterï¼ï¼äºå®ä¸ä¹æ¯éç¨è¿ç§åæ³ã\n\nconst cart = {\n  _wheels: 4,\n\n  get wheels () {\n    return this._wheels;\n  },\n\n  set wheels (value) {\n    if (value < this._wheels) {\n      throw new error('æ°å¼å¤ªå°äºï¼');\n    }\n    this._wheels = value;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nç®æ´åæ³å¨æå°å¯¹è±¡æ¶ä¹å¾æç¨ã\n\nlet user = {\n  name: 'test'\n};\n\nlet foo = {\n  bar: 'baz'\n};\n\nconsole.log(user, foo)\n// {name: \"test\"} {bar: \"baz\"}\nconsole.log({user, foo})\n// {user: {name: \"test\"}, foo: {bar: \"baz\"}}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼console.logç´æ¥è¾åºuseråfooä¸¤ä¸ªå¯¹è±¡æ¶ï¼å°±æ¯ä¸¤ç»é®å¼å¯¹ï¼å¯è½ä¼æ··æ·ãæå®ä»¬æ¾å¨å¤§æ¬å·éé¢è¾åºï¼å°±åæäºå¯¹è±¡çç®æ´è¡¨ç¤ºæ³ï¼æ¯ç»é®å¼å¯¹åé¢ä¼æå°å¯¹è±¡åï¼è¿æ ·å°±æ¯è¾æ¸æ°äºã\n\næ³¨æï¼ç®åçå¯¹è±¡æ¹æ³ä¸è½ç¨ä½æé å½æ°ï¼ä¼æ¥éã\n\nconst obj = {\n  f() {\n    this.foo = 'bar';\n  }\n};\n\nnew obj.f() // æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼fæ¯ä¸ä¸ªç®åçå¯¹è±¡æ¹æ³ï¼æä»¥obj.fä¸è½å½ä½æé å½æ°ä½¿ç¨ã\n\n\n# å±æ§åè¡¨è¾¾å¼\n\njavascript å®ä¹å¯¹è±¡çå±æ§ï¼æä¸¤ç§æ¹æ³ã\n\n// æ¹æ³ä¸\nobj.foo = true;\n\n// æ¹æ³äº\nobj['a' + 'bc'] = 123;\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç çæ¹æ³ä¸æ¯ç´æ¥ç¨æ è¯ç¬¦ä½ä¸ºå±æ§åï¼æ¹æ³äºæ¯ç¨è¡¨è¾¾å¼ä½ä¸ºå±æ§åï¼è¿æ¶è¦å°è¡¨è¾¾å¼æ¾å¨æ¹æ¬å·ä¹åã\n\nä½æ¯ï¼å¦æä½¿ç¨å­é¢éæ¹å¼å®ä¹å¯¹è±¡ï¼ä½¿ç¨å¤§æ¬å·ï¼ï¼å¨ es5 ä¸­åªè½ä½¿ç¨æ¹æ³ä¸ï¼æ è¯ç¬¦ï¼å®ä¹å±æ§ã\n\nvar obj = {\n  foo: true,\n  abc: 123\n};\n\n\n1\n2\n3\n4\n\n\nes6 åè®¸å­é¢éå®ä¹å¯¹è±¡æ¶ï¼ç¨æ¹æ³äºï¼è¡¨è¾¾å¼ï¼ä½ä¸ºå¯¹è±¡çå±æ§åï¼å³æè¡¨è¾¾å¼æ¾å¨æ¹æ¬å·åã\n\nlet propkey = 'foo';\n\nlet obj = {\n  [propkey]: true,\n  ['a' + 'bc']: 123\n};\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nlet lastword = 'last word';\n\nconst a = {\n  'first word': 'hello',\n  [lastword]: 'world'\n};\n\na['first word'] // \"hello\"\na[lastword] // \"world\"\na['last word'] // \"world\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nè¡¨è¾¾å¼è¿å¯ä»¥ç¨äºå®ä¹æ¹æ³åã\n\nlet obj = {\n  ['h' + 'ello']() {\n    return 'hi';\n  }\n};\n\nobj.hello() // hi\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næ³¨æï¼å±æ§åè¡¨è¾¾å¼ä¸ç®æ´è¡¨ç¤ºæ³ï¼ä¸è½åæ¶ä½¿ç¨ï¼ä¼æ¥éã\n\n// æ¥é\nconst foo = 'bar';\nconst bar = 'abc';\nconst baz = { [foo] };\n\n// æ­£ç¡®\nconst foo = 'bar';\nconst baz = { [foo]: 'abc'};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næ³¨æï¼å±æ§åè¡¨è¾¾å¼å¦ææ¯ä¸ä¸ªå¯¹è±¡ï¼é»è®¤æåµä¸ä¼èªå¨å°å¯¹è±¡è½¬ä¸ºå­ç¬¦ä¸²[object object]ï¼è¿ä¸ç¹è¦ç¹å«å°å¿ã\n\nconst keya = {a: 1};\nconst keyb = {b: 2};\n\nconst myobject = {\n  [keya]: 'valuea',\n  [keyb]: 'valueb'\n};\n\nmyobject // object {[object object]: \"valueb\"}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼[keya]å[keyb]å¾å°çé½æ¯[object object]ï¼æä»¥[keyb]ä¼æ[keya]è¦çæï¼èmyobjectæååªæä¸ä¸ª[object object]å±æ§ã\n\n\n# æ¹æ³ç name å±æ§\n\nå½æ°çnameå±æ§ï¼è¿åå½æ°åãå¯¹è±¡æ¹æ³ä¹æ¯å½æ°ï¼å æ­¤ä¹ænameå±æ§ã\n\nconst person = {\n  sayname() {\n    console.log('hello!');\n  },\n};\n\nperson.sayname.name   // \"sayname\"\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¹æ³çnameå±æ§è¿åå½æ°åï¼å³æ¹æ³åï¼ã\n\nå¦æå¯¹è±¡çæ¹æ³ä½¿ç¨äºåå¼å½æ°ï¼getterï¼åå­å¼å½æ°ï¼setterï¼ï¼ånameå±æ§ä¸æ¯å¨è¯¥æ¹æ³ä¸é¢ï¼èæ¯è¯¥æ¹æ³çå±æ§çæè¿°å¯¹è±¡çgetåsetå±æ§ä¸é¢ï¼è¿åå¼æ¯æ¹æ³ååå ä¸getåsetã\n\nconst obj = {\n  get foo() {},\n  set foo(x) {}\n};\n\nobj.foo.name\n// typeerror: cannot read property 'name' of undefined\n\nconst descriptor = object.getownpropertydescriptor(obj, 'foo');\n\ndescriptor.get.name // \"get foo\"\ndescriptor.set.name // \"set foo\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\næä¸¤ç§ç¹æ®æåµï¼bindæ¹æ³åé çå½æ°ï¼nameå±æ§è¿åboundå ä¸åå½æ°çåå­ï¼functionæé å½æ°åé çå½æ°ï¼nameå±æ§è¿åanonymousã\n\n(new function()).name // \"anonymous\"\n\nvar dosomething = function() {\n  // ...\n};\ndosomething.bind().name // \"bound dosomething\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¦æå¯¹è±¡çæ¹æ³æ¯ä¸ä¸ª symbol å¼ï¼é£ä¹nameå±æ§è¿åçæ¯è¿ä¸ª symbol å¼çæè¿°ã\n\nconst key1 = symbol('description');\nconst key2 = symbol();\nlet obj = {\n  [key1]() {},\n  [key2]() {},\n};\nobj[key1].name // \"[description]\"\nobj[key2].name // \"\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼key1å¯¹åºç symbol å¼ææè¿°ï¼key2æ²¡æã\n\n\n# å±æ§çå¯æä¸¾æ§åéå\n\n\n# å¯æä¸¾æ§\n\nå¯¹è±¡çæ¯ä¸ªå±æ§é½æä¸ä¸ªæè¿°å¯¹è±¡ï¼descriptorï¼ï¼ç¨æ¥æ§å¶è¯¥å±æ§çè¡ä¸ºãobject.getownpropertydescriptoræ¹æ³å¯ä»¥è·åè¯¥å±æ§çæè¿°å¯¹è±¡ã\n\nlet obj = { foo: 123 };\nobject.getownpropertydescriptor(obj, 'foo')\n//  {\n//    value: 123,\n//    writable: true,\n//    enumerable: true,\n//    configurable: true\n//  }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næè¿°å¯¹è±¡çenumerableå±æ§ï¼ç§°ä¸ºâå¯æä¸¾æ§âï¼å¦æè¯¥å±æ§ä¸ºfalseï¼å°±è¡¨ç¤ºæäºæä½ä¼å¿½ç¥å½åå±æ§ã\n\nç®åï¼æåä¸ªæä½ä¼å¿½ç¥enumerableä¸ºfalseçå±æ§ã\n\n * for...inå¾ªç¯ï¼åªéåå¯¹è±¡èªèº«çåç»§æ¿çå¯æä¸¾çå±æ§ã\n * object.keys()ï¼è¿åå¯¹è±¡èªèº«çææå¯æä¸¾çå±æ§çé®åã\n * json.stringify()ï¼åªä¸²è¡åå¯¹è±¡èªèº«çå¯æä¸¾çå±æ§ã\n * object.assign()ï¼ å¿½ç¥enumerableä¸ºfalseçå±æ§ï¼åªæ·è´å¯¹è±¡èªèº«çå¯æä¸¾çå±æ§ã\n\nè¿åä¸ªæä½ä¹ä¸­ï¼åä¸ä¸ªæ¯ es5 å°±æçï¼æåä¸ä¸ªobject.assign()æ¯ es6 æ°å¢çãå¶ä¸­ï¼åªæfor...inä¼è¿åç»§æ¿çå±æ§ï¼å¶ä»ä¸ä¸ªæ¹æ³é½ä¼å¿½ç¥ç»§æ¿çå±æ§ï¼åªå¤çå¯¹è±¡èªèº«çå±æ§ãå®éä¸ï¼å¼å¥âå¯æä¸¾âï¼enumerableï¼è¿ä¸ªæ¦å¿µçæåç®çï¼å°±æ¯è®©æäºå±æ§å¯ä»¥è§é¿æfor...inæä½ï¼ä¸ç¶ææåé¨å±æ§åæ¹æ³é½ä¼è¢«éåå°ãæ¯å¦ï¼å¯¹è±¡ååçtostringæ¹æ³ï¼ä»¥åæ°ç»çlengthå±æ§ï¼å°±éè¿âå¯æä¸¾æ§âï¼ä»èé¿åè¢«for...inéåå°ã\n\nobject.getownpropertydescriptor(object.prototype, 'tostring').enumerable\n// false\n\nobject.getownpropertydescriptor([], 'length').enumerable\n// false\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼tostringålengthå±æ§çenumerableé½æ¯falseï¼å æ­¤for...inä¸ä¼éåå°è¿ä¸¤ä¸ªç»§æ¿èªååçå±æ§ã\n\nå¦å¤ï¼es6 è§å®ï¼ææ class çååçæ¹æ³é½æ¯ä¸å¯æä¸¾çã\n\nobject.getownpropertydescriptor(class {foo() {}}.prototype, 'foo').enumerable\n// false\n\n\n1\n2\n\n\næ»çæ¥è¯´ï¼æä½ä¸­å¼å¥ç»§æ¿çå±æ§ä¼è®©é®é¢å¤æåï¼å¤§å¤æ°æ¶åï¼æä»¬åªå³å¿å¯¹è±¡èªèº«çå±æ§ãæä»¥ï¼å°½éä¸è¦ç¨for...inå¾ªç¯ï¼èç¨object.keys()ä»£æ¿ã\n\n\n# å±æ§çéå\n\nes6 ä¸å±æ 5 ç§æ¹æ³å¯ä»¥éåå¯¹è±¡çå±æ§ã\n\nï¼1ï¼for...in\n\nfor...inå¾ªç¯éåå¯¹è±¡èªèº«çåç»§æ¿çå¯æä¸¾å±æ§ï¼ä¸å« symbol å±æ§ï¼ã\n\nï¼2ï¼object.keys(obj)\n\nobject.keysè¿åä¸ä¸ªæ°ç»ï¼åæ¬å¯¹è±¡èªèº«çï¼ä¸å«ç»§æ¿çï¼ææå¯æä¸¾å±æ§ï¼ä¸å« symbol å±æ§ï¼çé®åã\n\nï¼3ï¼object.getownpropertynames(obj)\n\nobject.getownpropertynamesè¿åä¸ä¸ªæ°ç»ï¼åå«å¯¹è±¡èªèº«çææå±æ§ï¼ä¸å« symbol å±æ§ï¼ä½æ¯åæ¬ä¸å¯æä¸¾å±æ§ï¼çé®åã\n\nï¼4ï¼object.getownpropertysymbols(obj)\n\nobject.getownpropertysymbolsè¿åä¸ä¸ªæ°ç»ï¼åå«å¯¹è±¡èªèº«çææ symbol å±æ§çé®åã\n\nï¼5ï¼reflect.ownkeys(obj)\n\nreflect.ownkeysè¿åä¸ä¸ªæ°ç»ï¼åå«å¯¹è±¡èªèº«çææé®åï¼ä¸ç®¡é®åæ¯ symbol æå­ç¬¦ä¸²ï¼ä¹ä¸ç®¡æ¯å¦å¯æä¸¾ã\n\nä»¥ä¸ç 5 ç§æ¹æ³éåå¯¹è±¡çé®åï¼é½éµå®åæ ·çå±æ§éåçæ¬¡åºè§åã\n\n * é¦åéåæææ°å¼é®ï¼æç§æ°å¼ååºæåã\n * å¶æ¬¡éåææå­ç¬¦ä¸²é®ï¼æç§å å¥æ¶é´ååºæåã\n * æåéåææ symbol é®ï¼æç§å å¥æ¶é´ååºæåã\n\nreflect.ownkeys({ [symbol()]:0, b:0, 10:0, 2:0, a:0 })\n// ['2', '10', 'b', 'a', symbol()]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼reflect.ownkeysæ¹æ³è¿åä¸ä¸ªæ°ç»ï¼åå«äºåæ°å¯¹è±¡çææå±æ§ãè¿ä¸ªæ°ç»çå±æ§æ¬¡åºæ¯è¿æ ·çï¼é¦åæ¯æ°å¼å±æ§2å10ï¼å¶æ¬¡æ¯å­ç¬¦ä¸²å±æ§båaï¼æåæ¯ symbol å±æ§ã\n\n\n# super å³é®å­\n\næä»¬ç¥éï¼thiså³é®å­æ»æ¯æåå½æ°æå¨çå½åå¯¹è±¡ï¼es6 åæ°å¢äºå¦ä¸ä¸ªç±»ä¼¼çå³é®å­superï¼æåå½åå¯¹è±¡çååå¯¹è±¡ã\n\nconst proto = {\n  foo: 'hello'\n};\n\nconst obj = {\n  foo: 'world',\n  find() {\n    return super.foo;\n  }\n};\n\nobject.setprototypeof(obj, proto);\nobj.find() // \"hello\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯¹è±¡obj.find()æ¹æ³ä¹ä¸­ï¼éè¿super.fooå¼ç¨äºååå¯¹è±¡protoçfooå±æ§ã\n\næ³¨æï¼superå³é®å­è¡¨ç¤ºååå¯¹è±¡æ¶ï¼åªè½ç¨å¨å¯¹è±¡çæ¹æ³ä¹ä¸­ï¼ç¨å¨å¶ä»å°æ¹é½ä¼æ¥éã\n\n// æ¥é\nconst obj = {\n  foo: super.foo\n}\n\n// æ¥é\nconst obj = {\n  foo: () => super.foo\n}\n\n// æ¥é\nconst obj = {\n  foo: function () {\n    return super.foo\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä¸ç§superçç¨æ³é½ä¼æ¥éï¼å ä¸ºå¯¹äº javascript å¼ææ¥è¯´ï¼è¿éçsuperé½æ²¡æç¨å¨å¯¹è±¡çæ¹æ³ä¹ä¸­ãç¬¬ä¸ç§åæ³æ¯superç¨å¨å±æ§éé¢ï¼ç¬¬äºç§åç¬¬ä¸ç§åæ³æ¯superç¨å¨ä¸ä¸ªå½æ°éé¢ï¼ç¶åèµå¼ç»fooå±æ§ãç®åï¼åªæå¯¹è±¡æ¹æ³çç®åæ³å¯ä»¥è®© javascript å¼æç¡®è®¤ï¼å®ä¹çæ¯å¯¹è±¡çæ¹æ³ã\n\njavascript å¼æåé¨ï¼super.fooç­åäºobject.getprototypeof(this).fooï¼å±æ§ï¼æobject.getprototypeof(this).foo.call(this)ï¼æ¹æ³ï¼ã\n\nconst proto = {\n  x: 'hello',\n  foo() {\n    console.log(this.x);\n  },\n};\n\nconst obj = {\n  x: 'world',\n  foo() {\n    super.foo();\n  }\n}\n\nobject.setprototypeof(obj, proto);\n\nobj.foo() // \"world\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼super.fooæåååå¯¹è±¡protoçfooæ¹æ³ï¼ä½æ¯ç»å®çthiså´è¿æ¯å½åå¯¹è±¡objï¼å æ­¤è¾åºçå°±æ¯worldã\n\n\n# å¯¹è±¡çæ©å±è¿ç®ç¬¦\n\nãæ°ç»çæ©å±ãä¸ç« ä¸­ï¼å·²ç»ä»ç»è¿æ©å±è¿ç®ç¬¦ï¼...ï¼ães2018 å°è¿ä¸ªè¿ç®ç¬¦å¼å¥äºå¯¹è±¡ã\n\n\n# è§£æèµå¼\n\nå¯¹è±¡çè§£æèµå¼ç¨äºä»ä¸ä¸ªå¯¹è±¡åå¼ï¼ç¸å½äºå°ç®æ å¯¹è±¡èªèº«çææå¯éåçï¼enumerableï¼ãä½å°æªè¢«è¯»åçå±æ§ï¼åéå°æå®çå¯¹è±¡ä¸é¢ãææçé®åå®ä»¬çå¼ï¼é½ä¼æ·è´å°æ°å¯¹è±¡ä¸é¢ã\n\nlet { x, y, ...z } = { x: 1, y: 2, a: 3, b: 4 };\nx // 1\ny // 2\nz // { a: 3, b: 4 }\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼åézæ¯è§£æèµå¼æå¨çå¯¹è±¡ãå®è·åç­å·å³è¾¹çææå°æªè¯»åçé®ï¼aåbï¼ï¼å°å®ä»¬è¿åå¼ä¸èµ·æ·è´è¿æ¥ã\n\nç±äºè§£æèµå¼è¦æ±ç­å·å³è¾¹æ¯ä¸ä¸ªå¯¹è±¡ï¼æä»¥å¦æç­å·å³è¾¹æ¯undefinedænullï¼å°±ä¼æ¥éï¼å ä¸ºå®ä»¬æ æ³è½¬ä¸ºå¯¹è±¡ã\n\nlet { ...z } = null; // è¿è¡æ¶éè¯¯\nlet { ...z } = undefined; // è¿è¡æ¶éè¯¯\n\n\n1\n2\n\n\nè§£æèµå¼å¿é¡»æ¯æåä¸ä¸ªåæ°ï¼å¦åä¼æ¥éã\n\nlet { ...x, y, z } = someobject; // å¥æ³éè¯¯\nlet { x, ...y, ...z } = someobject; // å¥æ³éè¯¯\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼è§£æèµå¼ä¸æ¯æåä¸ä¸ªåæ°ï¼æä»¥ä¼æ¥éã\n\næ³¨æï¼è§£æèµå¼çæ·è´æ¯æµæ·è´ï¼å³å¦æä¸ä¸ªé®çå¼æ¯å¤åç±»åçå¼ï¼æ°ç»ãå¯¹è±¡ãå½æ°ï¼ãé£ä¹è§£æèµå¼æ·è´çæ¯è¿ä¸ªå¼çå¼ç¨ï¼èä¸æ¯è¿ä¸ªå¼çå¯æ¬ã\n\nlet obj = { a: { b: 1 } };\nlet { ...x } = obj;\nobj.a.b = 2;\nx.a.b // 2\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼xæ¯è§£æèµå¼æå¨çå¯¹è±¡ï¼æ·è´äºå¯¹è±¡objçaå±æ§ãaå±æ§å¼ç¨äºä¸ä¸ªå¯¹è±¡ï¼ä¿®æ¹è¿ä¸ªå¯¹è±¡çå¼ï¼ä¼å½±åå°è§£æèµå¼å¯¹å®çå¼ç¨ã\n\nå¦å¤ï¼æ©å±è¿ç®ç¬¦çè§£æèµå¼ï¼ä¸è½å¤å¶ç»§æ¿èªååå¯¹è±¡çå±æ§ã\n\nlet o1 = { a: 1 };\nlet o2 = { b: 2 };\no2.__proto__ = o1;\nlet { ...o3 } = o2;\no3 // { b: 2 }\no3.a // undefined\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯¹è±¡o3å¤å¶äºo2ï¼ä½æ¯åªå¤å¶äºo2èªèº«çå±æ§ï¼æ²¡æå¤å¶å®çååå¯¹è±¡o1çå±æ§ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nconst o = object.create({ x: 1, y: 2 });\no.z = 3;\n\nlet { x, ...newobj } = o;\nlet { y, z } = newobj;\nx // 1\ny // undefined\nz // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼åéxæ¯åçº¯çè§£æèµå¼ï¼æä»¥å¯ä»¥è¯»åå¯¹è±¡oç»§æ¿çå±æ§ï¼åéyåzæ¯æ©å±è¿ç®ç¬¦çè§£æèµå¼ï¼åªè½è¯»åå¯¹è±¡oèªèº«çå±æ§ï¼æä»¥åézå¯ä»¥èµå¼æåï¼åéyåä¸å°å¼ães6 è§å®ï¼åéå£°æè¯­å¥ä¹ä¸­ï¼å¦æä½¿ç¨è§£æèµå¼ï¼æ©å±è¿ç®ç¬¦åé¢å¿é¡»æ¯ä¸ä¸ªåéåï¼èä¸è½æ¯ä¸ä¸ªè§£æèµå¼è¡¨è¾¾å¼ï¼æä»¥ä¸é¢ä»£ç å¼å¥äºä¸­é´åénewobjï¼å¦æåæä¸é¢è¿æ ·ä¼æ¥éã\n\nlet { x, ...{ y, z } } = o;\n// syntaxerror: ... must be followed by an identifier in declaration contexts\n\n\n1\n2\n\n\nè§£æèµå¼çä¸ä¸ªç¨å¤ï¼æ¯æ©å±æä¸ªå½æ°çåæ°ï¼å¼å¥å¶ä»æä½ã\n\nfunction basefunction({ a, b }) {\n  // ...\n}\nfunction wrapperfunction({ x, y, ...restconfig }) {\n  // ä½¿ç¨ x å y åæ°è¿è¡æä½\n  // å¶ä½åæ°ä¼ ç»åå§å½æ°\n  return basefunction(restconfig);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼åå§å½æ°basefunctionæ¥åaåbä½ä¸ºåæ°ï¼å½æ°wrapperfunctionå¨basefunctionçåºç¡ä¸è¿è¡äºæ©å±ï¼è½å¤æ¥åå¤ä½çåæ°ï¼å¹¶ä¸ä¿çåå§å½æ°çè¡ä¸ºã\n\n\n# æ©å±è¿ç®ç¬¦\n\nå¯¹è±¡çæ©å±è¿ç®ç¬¦ï¼...ï¼ç¨äºååºåæ°å¯¹è±¡çææå¯éåå±æ§ï¼æ·è´å°å½åå¯¹è±¡ä¹ä¸­ã\n\nlet z = { a: 3, b: 4 };\nlet n = { ...z };\nn // { a: 3, b: 4 }\n\n\n1\n2\n3\n\n\nç±äºæ°ç»æ¯ç¹æ®çå¯¹è±¡ï¼æä»¥å¯¹è±¡çæ©å±è¿ç®ç¬¦ä¹å¯ä»¥ç¨äºæ°ç»ã\n\nlet foo = { ...['a', 'b', 'c'] };\nfoo\n// {0: \"a\", 1: \"b\", 2: \"c\"}\n\n\n1\n2\n3\n\n\nå¦ææ©å±è¿ç®ç¬¦åé¢æ¯ä¸ä¸ªç©ºå¯¹è±¡ï¼åæ²¡æä»»ä½ææã\n\n{...{}, a: 1}\n// { a: 1 }\n\n\n1\n2\n\n\nå¦ææ©å±è¿ç®ç¬¦åé¢ä¸æ¯å¯¹è±¡ï¼åä¼èªå¨å°å¶è½¬ä¸ºå¯¹è±¡ã\n\n// ç­åäº {...object(1)}\n{...1} // {}\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼æ©å±è¿ç®ç¬¦åé¢æ¯æ´æ°1ï¼ä¼èªå¨è½¬ä¸ºæ°å¼çåè£å¯¹è±¡number{1}ãç±äºè¯¥å¯¹è±¡æ²¡æèªèº«å±æ§ï¼æä»¥è¿åä¸ä¸ªç©ºå¯¹è±¡ã\n\nä¸é¢çä¾å­é½æ¯ç±»ä¼¼çéçã\n\n// ç­åäº {...object(true)}\n{...true} // {}\n\n// ç­åäº {...object(undefined)}\n{...undefined} // {}\n\n// ç­åäº {...object(null)}\n{...null} // {}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä½æ¯ï¼å¦ææ©å±è¿ç®ç¬¦åé¢æ¯å­ç¬¦ä¸²ï¼å®ä¼èªå¨è½¬æä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ï¼å æ­¤è¿åçä¸æ¯ç©ºå¯¹è±¡ã\n\n{...'hello'}\n// {0: \"h\", 1: \"e\", 2: \"l\", 3: \"l\", 4: \"o\"}\n\n\n1\n2\n\n\nå¯¹è±¡çæ©å±è¿ç®ç¬¦ç­åäºä½¿ç¨object.assign()æ¹æ³ã\n\nlet aclone = { ...a };\n// ç­åäº\nlet aclone = object.assign({}, a);\n\n\n1\n2\n3\n\n\nä¸é¢çä¾å­åªæ¯æ·è´äºå¯¹è±¡å®ä¾çå±æ§ï¼å¦ææ³å®æ´åéä¸ä¸ªå¯¹è±¡ï¼è¿æ·è´å¯¹è±¡ååçå±æ§ï¼å¯ä»¥éç¨ä¸é¢çåæ³ã\n\n// åæ³ä¸\nconst clone1 = {\n  __proto__: object.getprototypeof(obj),\n  ...obj\n};\n\n// åæ³äº\nconst clone2 = object.assign(\n  object.create(object.getprototypeof(obj)),\n  obj\n);\n\n// åæ³ä¸\nconst clone3 = object.create(\n  object.getprototypeof(obj),\n  object.getownpropertydescriptors(obj)\n)\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ³ä¸ç__proto__å±æ§å¨éæµè§å¨çç¯å¢ä¸ä¸å®é¨ç½²ï¼å æ­¤æ¨èä½¿ç¨åæ³äºååæ³ä¸ã\n\næ©å±è¿ç®ç¬¦å¯ä»¥ç¨äºåå¹¶ä¸¤ä¸ªå¯¹è±¡ã\n\nlet ab = { ...a, ...b };\n// ç­åäº\nlet ab = object.assign({}, a, b);\n\n\n1\n2\n3\n\n\nå¦æç¨æ·èªå®ä¹çå±æ§ï¼æ¾å¨æ©å±è¿ç®ç¬¦åé¢ï¼åæ©å±è¿ç®ç¬¦åé¨çååå±æ§ä¼è¢«è¦çæã\n\nlet awithoverrides = { ...a, x: 1, y: 2 };\n// ç­åäº\nlet awithoverrides = { ...a, ...{ x: 1, y: 2 } };\n// ç­åäº\nlet x = 1, y = 2, awithoverrides = { ...a, x, y };\n// ç­åäº\nlet awithoverrides = object.assign({}, a, { x: 1, y: 2 });\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼aå¯¹è±¡çxå±æ§åyå±æ§ï¼æ·è´å°æ°å¯¹è±¡åä¼è¢«è¦çæã\n\nè¿ç¨æ¥ä¿®æ¹ç°æå¯¹è±¡é¨åçå±æ§å°±å¾æ¹ä¾¿äºã\n\nlet newversion = {\n  ...previousversion,\n  name: 'new name' // override the name property\n};\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼newversionå¯¹è±¡èªå®ä¹äºnameå±æ§ï¼å¶ä»å±æ§å¨é¨å¤å¶èªpreviousversionå¯¹è±¡ã\n\nå¦ææèªå®ä¹å±æ§æ¾å¨æ©å±è¿ç®ç¬¦åé¢ï¼å°±åæäºè®¾ç½®æ°å¯¹è±¡çé»è®¤å±æ§å¼ã\n\nlet awithdefaults = { x: 1, y: 2, ...a };\n// ç­åäº\nlet awithdefaults = object.assign({}, { x: 1, y: 2 }, a);\n// ç­åäº\nlet awithdefaults = object.assign({ x: 1, y: 2 }, a);\n\n\n1\n2\n3\n4\n5\n\n\nä¸æ°ç»çæ©å±è¿ç®ç¬¦ä¸æ ·ï¼å¯¹è±¡çæ©å±è¿ç®ç¬¦åé¢å¯ä»¥è·è¡¨è¾¾å¼ã\n\nconst obj = {\n  ...(x > 1 ? {a: 1} : {}),\n  b: 2,\n};\n\n\n1\n2\n3\n4\n\n\næ©å±è¿ç®ç¬¦çåæ°å¯¹è±¡ä¹ä¸­ï¼å¦ææåå¼å½æ°getï¼è¿ä¸ªå½æ°æ¯ä¼æ§è¡çã\n\n// å¹¶ä¸ä¼æåºéè¯¯ï¼å ä¸º x å±æ§åªæ¯è¢«å®ä¹ï¼ä½æ²¡æ§è¡\nlet awithxgetter = {\n  ...a,\n  get x() {\n    throw new error('not throw yet');\n  }\n};\n\n// ä¼æåºéè¯¯ï¼å ä¸º x å±æ§è¢«æ§è¡äº\nlet runtimeerror = {\n  ...a,\n  ...{\n    get x() {\n      throw new error('throw now');\n    }\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n# é¾å¤æ­è¿ç®ç¬¦\n\nç¼ç¨å®å¡ä¸­ï¼å¦æè¯»åå¯¹è±¡åé¨çæä¸ªå±æ§ï¼å¾å¾éè¦å¤æ­ä¸ä¸è¯¥å¯¹è±¡æ¯å¦å­å¨ãæ¯å¦ï¼è¦è¯»åmessage.body.user.firstnameï¼å®å¨çåæ³æ¯åæä¸é¢è¿æ ·ã\n\nconst firstname = (message\n  && message.body\n  && message.body.user\n  && message.body.user.firstname) || 'default';\n\n\n1\n2\n3\n4\n\n\næèä½¿ç¨ä¸åè¿ç®ç¬¦?:ï¼å¤æ­ä¸ä¸ªå¯¹è±¡æ¯å¦å­å¨ã\n\nconst fooinput = myform.queryselector('input[name=foo]')\nconst foovalue = fooinput ? fooinput.value : undefined\n\n\n1\n2\n\n\nè¿æ ·çå±å±å¤æ­éå¸¸éº»ç¦ï¼å æ­¤ es2020 å¼å¥äºâé¾å¤æ­è¿ç®ç¬¦âï¼optional chaining operatorï¼?.ï¼ç®åä¸é¢çåæ³ã\n\nconst firstname = message?.body?.user?.firstname || 'default';\nconst foovalue = myform.queryselector('input[name=foo]')?.value\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä½¿ç¨äº?.è¿ç®ç¬¦ï¼ç´æ¥å¨é¾å¼è°ç¨çæ¶åå¤æ­ï¼å·¦ä¾§çå¯¹è±¡æ¯å¦ä¸ºnullæundefinedãå¦ææ¯çï¼å°±ä¸åå¾ä¸è¿ç®ï¼èæ¯è¿åundefinedã\n\né¾å¤æ­è¿ç®ç¬¦æä¸ç§ç¨æ³ã\n\n * obj?.prop // å¯¹è±¡å±æ§\n * obj?.[expr] // åä¸\n * func?.(...args) // å½æ°æå¯¹è±¡æ¹æ³çè°ç¨\n\nä¸é¢æ¯å¤æ­å¯¹è±¡æ¹æ³æ¯å¦å­å¨ï¼å¦æå­å¨å°±ç«å³æ§è¡çä¾å­ã\n\niterator.return?.()\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼iterator.returnå¦ææå®ä¹ï¼å°±ä¼è°ç¨è¯¥æ¹æ³ï¼å¦åç´æ¥è¿åundefinedã\n\nå¯¹äºé£äºå¯è½æ²¡æå®ç°çæ¹æ³ï¼è¿ä¸ªè¿ç®ç¬¦å°¤å¶æç¨ã\n\nif (myform.checkvalidity?.() === false) {\n  // è¡¨åæ ¡éªå¤±è´¥\n  return;\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼èå¼æµè§å¨çè¡¨åå¯è½æ²¡æcheckvalidityè¿ä¸ªæ¹æ³ï¼è¿æ¶?.è¿ç®ç¬¦å°±ä¼è¿åundefinedï¼å¤æ­è¯­å¥å°±åæäºundefined === falseï¼æä»¥å°±ä¼è·³è¿ä¸é¢çä»£ç ã\n\nä¸é¢æ¯è¿ä¸ªè¿ç®ç¬¦å¸¸è§çä½¿ç¨å½¢å¼ï¼ä»¥åä¸ä½¿ç¨è¯¥è¿ç®ç¬¦æ¶çç­ä»·å½¢å¼ã\n\na?.b\n// ç­åäº\na == null ? undefined : a.b\n\na?.[x]\n// ç­åäº\na == null ? undefined : a[x]\n\na?.b()\n// ç­åäº\na == null ? undefined : a.b()\n\na?.()\n// ç­åäº\na == null ? undefined : a()\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¹å«æ³¨æåä¸¤ç§å½¢å¼ï¼å¦æa?.b()éé¢ça.bä¸æ¯å½æ°ï¼ä¸å¯è°ç¨ï¼é£ä¹a?.b()æ¯ä¼æ¥éçãa?.()ä¹æ¯å¦æ­¤ï¼å¦æaä¸æ¯nullæundefinedï¼ä½ä¹ä¸æ¯å½æ°ï¼é£ä¹a?.()ä¼æ¥éã\n\nä½¿ç¨è¿ä¸ªè¿ç®ç¬¦ï¼æå ä¸ªæ³¨æç¹ã\n\nï¼1ï¼ç­è·¯æºå¶\n\na?.[++x]\n// ç­åäº\na == null ? undefined : a[++x]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æaæ¯undefinedænullï¼é£ä¹xä¸ä¼è¿è¡éå¢è¿ç®ãä¹å°±æ¯è¯´ï¼é¾å¤æ­è¿ç®ç¬¦ä¸æ¦ä¸ºçï¼å³ä¾§çè¡¨è¾¾å¼å°±ä¸åæ±å¼ã\n\nï¼2ï¼delete è¿ç®ç¬¦\n\ndelete a?.b\n// ç­åäº\na == null ? undefined : delete a.b\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æaæ¯undefinedænullï¼ä¼ç´æ¥è¿åundefinedï¼èä¸ä¼è¿è¡deleteè¿ç®ã\n\nï¼3ï¼æ¬å·çå½±å\n\nå¦æå±æ§é¾æåæ¬å·ï¼é¾å¤æ­è¿ç®ç¬¦å¯¹åæ¬å·å¤é¨æ²¡æå½±åï¼åªå¯¹åæ¬å·åé¨æå½±åã\n\n(a?.b).c\n// ç­ä»·äº\n(a == null ? undefined : a.b).c\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼?.å¯¹åæ¬å·å¤é¨æ²¡æå½±åï¼ä¸ç®¡aå¯¹è±¡æ¯å¦å­å¨ï¼åæ¬å·åé¢ç.cæ»æ¯ä¼æ§è¡ã\n\nä¸è¬æ¥è¯´ï¼ä½¿ç¨?.è¿ç®ç¬¦çåºåï¼ä¸åºè¯¥ä½¿ç¨åæ¬å·ã\n\nï¼4ï¼æ¥éåºå\n\nä»¥ä¸åæ³æ¯ç¦æ­¢çï¼ä¼æ¥éã\n\n// æé å½æ°\nnew a?.()\nnew a?.b()\n\n// é¾å¤æ­è¿ç®ç¬¦çå³ä¾§ææ¨¡æ¿å­ç¬¦ä¸²\na?.`{b}`\na?.b`{c}`\n\n// é¾å¤æ­è¿ç®ç¬¦çå·¦ä¾§æ¯ super\nsuper?.()\nsuper?.foo\n\n// é¾è¿ç®ç¬¦ç¨äºèµå¼è¿ç®ç¬¦å·¦ä¾§\na?.b = c\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nï¼5ï¼å³ä¾§ä¸å¾ä¸ºåè¿å¶æ°å¼\n\nä¸ºäºä¿è¯å¼å®¹ä»¥åçä»£ç ï¼åè®¸foo?.3:0è¢«è§£ææfoo ? .3 : 0ï¼å æ­¤è§å®å¦æ?.åé¢ç´§è·ä¸ä¸ªåè¿å¶æ°å­ï¼é£ä¹?.ä¸åè¢«çææ¯ä¸ä¸ªå®æ´çè¿ç®ç¬¦ï¼èä¼æç§ä¸åè¿ç®ç¬¦è¿è¡å¤çï¼ä¹å°±æ¯è¯´ï¼é£ä¸ªå°æ°ç¹ä¼å½å±äºåé¢çåè¿å¶æ°å­ï¼å½¢æä¸ä¸ªå°æ°ã\n\n\n# null å¤æ­è¿ç®ç¬¦\n\nè¯»åå¯¹è±¡å±æ§çæ¶åï¼å¦ææä¸ªå±æ§çå¼æ¯nullæundefinedï¼ææ¶åéè¦ä¸ºå®ä»¬æå®é»è®¤å¼ãå¸¸è§åæ³æ¯éè¿||è¿ç®ç¬¦æå®é»è®¤å¼ã\n\nconst headertext = response.settings.headertext || 'hello, world!';\nconst animationduration = response.settings.animationduration || 300;\nconst showsplashscreen = response.settings.showsplashscreen || true;\n\n\n1\n2\n3\n\n\nä¸é¢çä¸è¡ä»£ç é½éè¿||è¿ç®ç¬¦æå®é»è®¤å¼ï¼ä½æ¯è¿æ ·åæ¯éçãå¼åèçåææ¯ï¼åªè¦å±æ§çå¼ä¸ºnullæundefinedï¼é»è®¤å¼å°±ä¼çæï¼ä½æ¯å±æ§çå¼å¦æä¸ºç©ºå­ç¬¦ä¸²æfalseæ0ï¼é»è®¤å¼ä¹ä¼çæã\n\nä¸ºäºé¿åè¿ç§æåµï¼es2020 å¼å¥äºä¸ä¸ªæ°ç null å¤æ­è¿ç®ç¬¦??ãå®çè¡ä¸ºç±»ä¼¼||ï¼ä½æ¯åªæè¿ç®ç¬¦å·¦ä¾§çå¼ä¸ºnullæundefinedæ¶ï¼æä¼è¿åå³ä¾§çå¼ã\n\nconst headertext = response.settings.headertext ?? 'hello, world!';\nconst animationduration = response.settings.animationduration ?? 300;\nconst showsplashscreen = response.settings.showsplashscreen ?? true;\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼é»è®¤å¼åªæå¨å±æ§å¼ä¸ºnullæundefinedæ¶ï¼æä¼çæã\n\nè¿ä¸ªè¿ç®ç¬¦çä¸ä¸ªç®çï¼å°±æ¯è·é¾å¤æ­è¿ç®ç¬¦?.éåä½¿ç¨ï¼ä¸ºnullæundefinedçå¼è®¾ç½®é»è®¤å¼ã\n\nconst animationduration = response.settings?.animationduration ?? 300;\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼response.settingså¦ææ¯nullæundefinedï¼å°±ä¼è¿åé»è®¤å¼300ã\n\nè¿ä¸ªè¿ç®ç¬¦å¾éåå¤æ­å½æ°åæ°æ¯å¦èµå¼ã\n\nfunction component(props) {\n  const enable = props.enabled ?? true;\n  // â¦\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç å¤æ­propsåæ°çenabledå±æ§æ¯å¦èµå¼ï¼ç­åäºä¸é¢çåæ³ã\n\nfunction component(props) {\n  const {\n    enabled: enable = true,\n  } = props;\n  // â¦\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\n??æä¸ä¸ªè¿ç®ä¼åçº§é®é¢ï¼å®ä¸&&å||çä¼åçº§å­°é«å­°ä½ãç°å¨çè§åæ¯ï¼å¦æå¤ä¸ªé»è¾è¿ç®ç¬¦ä¸èµ·ä½¿ç¨ï¼å¿é¡»ç¨æ¬å·è¡¨æä¼åçº§ï¼å¦åä¼æ¥éã\n\n// æ¥é\nlhs && middle ?? rhs\nlhs ?? middle && rhs\nlhs || middle ?? rhs\nlhs ?? middle || rhs\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢åä¸ªè¡¨è¾¾å¼é½ä¼æ¥éï¼å¿é¡»å å¥è¡¨æä¼åçº§çæ¬å·ã\n\n(lhs && middle) ?? rhs;\nlhs && (middle ?? rhs);\n\n(lhs ?? middle) && rhs;\nlhs ?? (middle && rhs);\n\n(lhs || middle) ?? rhs;\nlhs || (middle ?? rhs);\n\n(lhs ?? middle) || rhs;\nlhs ?? (middle || rhs);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"å¯¹è±¡çæ°å¢æ¹æ³",frontmatter:{title:"å¯¹è±¡çæ°å¢æ¹æ³",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/e85e68947502cf90",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/11.%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B0%E5%A2%9E%E6%96%B9%E6%B3%95.html",relativePath:"ãES6 æç¨ãç¬è®°/11.å¯¹è±¡çæ°å¢æ¹æ³.md",key:"v-2b833066",path:"/pages/e85e68947502cf90/",headers:[{level:2,title:"Object.is()",slug:"object-is",normalizedTitle:"object.is()",charIndex:36},{level:2,title:"Object.assign()",slug:"object-assign",normalizedTitle:"object.assign()",charIndex:829},{level:3,title:"åºæ¬ç¨æ³",slug:"åºæ¬ç¨æ³",normalizedTitle:"åºæ¬ç¨æ³",charIndex:849},{level:3,title:"æ³¨æç¹",slug:"æ³¨æç¹",normalizedTitle:"æ³¨æç¹",charIndex:2867},{level:3,title:"å¸¸è§ç¨é",slug:"å¸¸è§ç¨é",normalizedTitle:"å¸¸è§ç¨é",charIndex:3937},{level:2,title:"Object.getOwnPropertyDescriptors()",slug:"object-getownpropertydescriptors",normalizedTitle:"object.getownpropertydescriptors()",charIndex:5719},{level:2,title:"__proto__å±æ§ï¼Object.setPrototypeOf()ï¼Object.getPrototypeOf()",slug:"proto-å±æ§-object-setprototypeof-object-getprototypeof",normalizedTitle:"__proto__å±æ§ï¼object.setprototypeof()ï¼object.getprototypeof()",charIndex:9059},{level:3,title:"__proto__å±æ§",slug:"proto-å±æ§",normalizedTitle:"__proto__å±æ§",charIndex:9059},{level:3,title:"Object.setPrototypeOf()",slug:"object-setprototypeof",normalizedTitle:"object.setprototypeof()",charIndex:9071},{level:3,title:"Object.getPrototypeOf()",slug:"object-getprototypeof",normalizedTitle:"object.getprototypeof()",charIndex:9095},{level:2,title:"Object.keys()ï¼Object.values()ï¼Object.entries()",slug:"object-keys-object-values-object-entries",normalizedTitle:"object.keys()ï¼object.values()ï¼object.entries()",charIndex:12688},{level:3,title:"Object.keys()",slug:"object-keys",normalizedTitle:"object.keys()",charIndex:12688},{level:3,title:"Object.values()",slug:"object-values",normalizedTitle:"object.values()",charIndex:12702},{level:3,title:"Object.entries()",slug:"object-entries",normalizedTitle:"object.entries()",charIndex:12718},{level:2,title:"Object.fromEntries()",slug:"object-fromentries",normalizedTitle:"object.fromentries()",charIndex:15639}],excerpt:'<h1 id="å¯¹è±¡çæ°å¢æ¹æ³"><a class="header-anchor" href="#å¯¹è±¡çæ°å¢æ¹æ³">#</a> å¯¹è±¡çæ°å¢æ¹æ³</h1>\n<p>æ¬ç« ä»ç» Object å¯¹è±¡çæ°å¢æ¹æ³ã</p>\n<h2 id="object-is"><a class="header-anchor" href="#object-is">#</a> Object.is()</h2>\n<p>ES5 æ¯è¾ä¸¤ä¸ªå¼æ¯å¦ç¸ç­ï¼åªæä¸¤ä¸ªè¿ç®ç¬¦ï¼ç¸ç­è¿ç®ç¬¦ï¼<code>==</code>ï¼åä¸¥æ ¼ç¸ç­è¿ç®ç¬¦ï¼<code>===</code>ï¼ãå®ä»¬é½æç¼ºç¹ï¼åèä¼èªå¨è½¬æ¢æ°æ®ç±»åï¼åèç<code>NaN</code>ä¸ç­äºèªèº«ï¼ä»¥å<code>+0</code>ç­äº<code>-0</code>ãJavaScript ç¼ºä¹ä¸ç§è¿ç®ï¼å¨ææç¯å¢ä¸­ï¼åªè¦ä¸¤ä¸ªå¼æ¯ä¸æ ·çï¼å®ä»¬å°±åºè¯¥ç¸ç­ã</p>\n<p>ES6 æåºâSame-value equalityâï¼åå¼ç¸ç­ï¼ç®æ³ï¼ç¨æ¥è§£å³è¿ä¸ªé®é¢ã<code>Object.is</code>å°±æ¯é¨ç½²è¿ä¸ªç®æ³çæ°æ¹æ³ãå®ç¨æ¥æ¯è¾ä¸¤ä¸ªå¼æ¯å¦ä¸¥æ ¼ç¸ç­ï¼ä¸ä¸¥æ ¼æ¯è¾è¿ç®ç¬¦ï¼===ï¼çè¡ä¸ºåºæ¬ä¸è´ã</p>\n',headersStr:"Object.is() Object.assign() åºæ¬ç¨æ³ æ³¨æç¹ å¸¸è§ç¨é Object.getOwnPropertyDescriptors() __proto__å±æ§ï¼Object.setPrototypeOf()ï¼Object.getPrototypeOf() __proto__å±æ§ Object.setPrototypeOf() Object.getPrototypeOf() Object.keys()ï¼Object.values()ï¼Object.entries() Object.keys() Object.values() Object.entries() Object.fromEntries()",content:"# å¯¹è±¡çæ°å¢æ¹æ³\n\næ¬ç« ä»ç» Object å¯¹è±¡çæ°å¢æ¹æ³ã\n\n\n# Object.is()\n\nES5 æ¯è¾ä¸¤ä¸ªå¼æ¯å¦ç¸ç­ï¼åªæä¸¤ä¸ªè¿ç®ç¬¦ï¼ç¸ç­è¿ç®ç¬¦ï¼==ï¼åä¸¥æ ¼ç¸ç­è¿ç®ç¬¦ï¼===ï¼ãå®ä»¬é½æç¼ºç¹ï¼åèä¼èªå¨è½¬æ¢æ°æ®ç±»åï¼åèçNaNä¸ç­äºèªèº«ï¼ä»¥å+0ç­äº-0ãJavaScript ç¼ºä¹ä¸ç§è¿ç®ï¼å¨ææç¯å¢ä¸­ï¼åªè¦ä¸¤ä¸ªå¼æ¯ä¸æ ·çï¼å®ä»¬å°±åºè¯¥ç¸ç­ã\n\nES6 æåºâSame-value equalityâï¼åå¼ç¸ç­ï¼ç®æ³ï¼ç¨æ¥è§£å³è¿ä¸ªé®é¢ãObject.iså°±æ¯é¨ç½²è¿ä¸ªç®æ³çæ°æ¹æ³ãå®ç¨æ¥æ¯è¾ä¸¤ä¸ªå¼æ¯å¦ä¸¥æ ¼ç¸ç­ï¼ä¸ä¸¥æ ¼æ¯è¾è¿ç®ç¬¦ï¼===ï¼çè¡ä¸ºåºæ¬ä¸è´ã\n\nObject.is('foo', 'foo')\n// true\nObject.is({}, {})\n// false\n\n\n1\n2\n3\n4\n\n\nä¸åä¹å¤åªæä¸¤ä¸ªï¼ä¸æ¯+0ä¸ç­äº-0ï¼äºæ¯NaNç­äºèªèº«ã\n\n+0 === -0 //true\nNaN === NaN // false\n\nObject.is(+0, -0) // false\nObject.is(NaN, NaN) // true\n\n\n1\n2\n3\n4\n5\n\n\nES5 å¯ä»¥éè¿ä¸é¢çä»£ç ï¼é¨ç½²Object.isã\n\nObject.defineProperty(Object, 'is', {\n  value: function(x, y) {\n    if (x === y) {\n      // éå¯¹+0 ä¸ç­äº -0çæåµ\n      return x !== 0 || 1 / x === 1 / y;\n    }\n    // éå¯¹NaNçæåµ\n    return x !== x && y !== y;\n  },\n  configurable: true,\n  enumerable: false,\n  writable: true\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# Object.assign()\n\n\n# åºæ¬ç¨æ³\n\nObject.assignæ¹æ³ç¨äºå¯¹è±¡çåå¹¶ï¼å°æºå¯¹è±¡ï¼sourceï¼çææå¯æä¸¾å±æ§ï¼å¤å¶å°ç®æ å¯¹è±¡ï¼targetï¼ã\n\nconst target = { a: 1 };\n\nconst source1 = { b: 2 };\nconst source2 = { c: 3 };\n\nObject.assign(target, source1, source2);\ntarget // {a:1, b:2, c:3}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nObject.assignæ¹æ³çç¬¬ä¸ä¸ªåæ°æ¯ç®æ å¯¹è±¡ï¼åé¢çåæ°é½æ¯æºå¯¹è±¡ã\n\næ³¨æï¼å¦æç®æ å¯¹è±¡ä¸æºå¯¹è±¡æååå±æ§ï¼æå¤ä¸ªæºå¯¹è±¡æååå±æ§ï¼ååé¢çå±æ§ä¼è¦çåé¢çå±æ§ã\n\nconst target = { a: 1, b: 1 };\n\nconst source1 = { b: 2, c: 2 };\nconst source2 = { c: 3 };\n\nObject.assign(target, source1, source2);\ntarget // {a:1, b:2, c:3}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦æåªæä¸ä¸ªåæ°ï¼Object.assignä¼ç´æ¥è¿åè¯¥åæ°ã\n\nconst obj = {a: 1};\nObject.assign(obj) === obj // true\n\n\n1\n2\n\n\nå¦æè¯¥åæ°ä¸æ¯å¯¹è±¡ï¼åä¼åè½¬æå¯¹è±¡ï¼ç¶åè¿åã\n\ntypeof Object.assign(2) // \"object\"\n\n\n1\n\n\nç±äºundefinedånullæ æ³è½¬æå¯¹è±¡ï¼æä»¥å¦æå®ä»¬ä½ä¸ºåæ°ï¼å°±ä¼æ¥éã\n\nObject.assign(undefined) // æ¥é\nObject.assign(null) // æ¥é\n\n\n1\n2\n\n\nå¦æéå¯¹è±¡åæ°åºç°å¨æºå¯¹è±¡çä½ç½®ï¼å³éé¦åæ°ï¼ï¼é£ä¹å¤çè§åææä¸åãé¦åï¼è¿äºåæ°é½ä¼è½¬æå¯¹è±¡ï¼å¦ææ æ³è½¬æå¯¹è±¡ï¼å°±ä¼è·³è¿ãè¿æå³çï¼å¦æundefinedånullä¸å¨é¦åæ°ï¼å°±ä¸ä¼æ¥éã\n\nlet obj = {a: 1};\nObject.assign(obj, undefined) === obj // true\nObject.assign(obj, null) === obj // true\n\n\n1\n2\n3\n\n\nå¶ä»ç±»åçå¼ï¼å³æ°å¼ãå­ç¬¦ä¸²åå¸å°å¼ï¼ä¸å¨é¦åæ°ï¼ä¹ä¸ä¼æ¥éãä½æ¯ï¼é¤äºå­ç¬¦ä¸²ä¼ä»¥æ°ç»å½¢å¼ï¼æ·è´å¥ç®æ å¯¹è±¡ï¼å¶ä»å¼é½ä¸ä¼äº§çææã\n\nconst v1 = 'abc';\nconst v2 = true;\nconst v3 = 10;\n\nconst obj = Object.assign({}, v1, v2, v3);\nconsole.log(obj); // { \"0\": \"a\", \"1\": \"b\", \"2\": \"c\" }\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼v1ãv2ãv3åå«æ¯å­ç¬¦ä¸²ãå¸å°å¼åæ°å¼ï¼ç»æåªæå­ç¬¦ä¸²åå¥ç®æ å¯¹è±¡ï¼ä»¥å­ç¬¦æ°ç»çå½¢å¼ï¼ï¼æ°å¼åå¸å°å¼é½ä¼è¢«å¿½ç¥ãè¿æ¯å ä¸ºåªæå­ç¬¦ä¸²çåè£å¯¹è±¡ï¼ä¼äº§çå¯æä¸¾å±æ§ã\n\nObject(true) // {[[PrimitiveValue]]: true}\nObject(10)  //  {[[PrimitiveValue]]: 10}\nObject('abc') // {0: \"a\", 1: \"b\", 2: \"c\", length: 3, [[PrimitiveValue]]: \"abc\"}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼å¸å°å¼ãæ°å¼ãå­ç¬¦ä¸²åå«è½¬æå¯¹åºçåè£å¯¹è±¡ï¼å¯ä»¥çå°å®ä»¬çåå§å¼é½å¨åè£å¯¹è±¡çåé¨å±æ§[[PrimitiveValue]]ä¸é¢ï¼è¿ä¸ªå±æ§æ¯ä¸ä¼è¢«Object.assignæ·è´çãåªæå­ç¬¦ä¸²çåè£å¯¹è±¡ï¼ä¼äº§çå¯æä¸¾çå®ä¹å±æ§ï¼é£äºå±æ§åä¼è¢«æ·è´ã\n\nObject.assignæ·è´çå±æ§æ¯æéå¶çï¼åªæ·è´æºå¯¹è±¡çèªèº«å±æ§ï¼ä¸æ·è´ç»§æ¿å±æ§ï¼ï¼ä¹ä¸æ·è´ä¸å¯æä¸¾çå±æ§ï¼enumerable: falseï¼ã\n\nObject.assign({b: 'c'},\n  Object.defineProperty({}, 'invisible', {\n    enumerable: false,\n    value: 'hello'\n  })\n)\n// { b: 'c' }\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼Object.assignè¦æ·è´çå¯¹è±¡åªæä¸ä¸ªä¸å¯æä¸¾å±æ§invisibleï¼è¿ä¸ªå±æ§å¹¶æ²¡æè¢«æ·è´è¿å»ã\n\nå±æ§åä¸º Symbol å¼çå±æ§ï¼ä¹ä¼è¢«Object.assignæ·è´ã\n\nObject.assign({ a: 'b' }, { [Symbol('c')]: 'd' })\n// { a: 'b', Symbol(c): 'd' }\n\n\n1\n2\n\n\n\n# æ³¨æç¹\n\nï¼1ï¼æµæ·è´\n\nObject.assignæ¹æ³å®è¡çæ¯æµæ·è´ï¼èä¸æ¯æ·±æ·è´ãä¹å°±æ¯è¯´ï¼å¦ææºå¯¹è±¡æä¸ªå±æ§çå¼æ¯å¯¹è±¡ï¼é£ä¹ç®æ å¯¹è±¡æ·è´å¾å°çæ¯è¿ä¸ªå¯¹è±¡çå¼ç¨ã\n\nconst obj1 = {a: {b: 1}};\nconst obj2 = Object.assign({}, obj1);\n\nobj1.a.b = 2;\nobj2.a.b // 2\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼æºå¯¹è±¡obj1çaå±æ§çå¼æ¯ä¸ä¸ªå¯¹è±¡ï¼Object.assignæ·è´å¾å°çæ¯è¿ä¸ªå¯¹è±¡çå¼ç¨ãè¿ä¸ªå¯¹è±¡çä»»ä½ååï¼é½ä¼åæ å°ç®æ å¯¹è±¡ä¸é¢ã\n\nï¼2ï¼ååå±æ§çæ¿æ¢\n\nå¯¹äºè¿ç§åµå¥çå¯¹è±¡ï¼ä¸æ¦éå°ååå±æ§ï¼Object.assignçå¤çæ¹æ³æ¯æ¿æ¢ï¼èä¸æ¯æ·»å ã\n\nconst target = { a: { b: 'c', d: 'e' } }\nconst source = { a: { b: 'hello' } }\nObject.assign(target, source)\n// { a: { b: 'hello' } }\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼targetå¯¹è±¡çaå±æ§è¢«sourceå¯¹è±¡çaå±æ§æ´ä¸ªæ¿æ¢æäºï¼èä¸ä¼å¾å°{ a: { b: 'hello', d: 'e' } }çç»æãè¿éå¸¸ä¸æ¯å¼åèæ³è¦çï¼éè¦ç¹å«å°å¿ã\n\nä¸äºå½æ°åºæä¾Object.assignçå®å¶çæ¬ï¼æ¯å¦ Lodash ç_.defaultsDeepæ¹æ³ï¼ï¼å¯ä»¥å¾å°æ·±æ·è´çåå¹¶ã\n\nï¼3ï¼æ°ç»çå¤ç\n\nObject.assignå¯ä»¥ç¨æ¥å¤çæ°ç»ï¼ä½æ¯ä¼ææ°ç»è§ä¸ºå¯¹è±¡ã\n\nObject.assign([1, 2, 3], [4, 5])\n// [4, 5, 3]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼Object.assignææ°ç»è§ä¸ºå±æ§åä¸º 0ã1ã2 çå¯¹è±¡ï¼å æ­¤æºæ°ç»ç 0 å·å±æ§4è¦çäºç®æ æ°ç»ç 0 å·å±æ§1ã\n\nï¼4ï¼åå¼å½æ°çå¤ç\n\nObject.assignåªè½è¿è¡å¼çå¤å¶ï¼å¦æè¦å¤å¶çå¼æ¯ä¸ä¸ªåå¼å½æ°ï¼é£ä¹å°æ±å¼ååå¤å¶ã\n\nconst source = {\n  get foo() { return 1 }\n};\nconst target = {};\n\nObject.assign(target, source)\n// { foo: 1 }\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼sourceå¯¹è±¡çfooå±æ§æ¯ä¸ä¸ªåå¼å½æ°ï¼Object.assignä¸ä¼å¤å¶è¿ä¸ªåå¼å½æ°ï¼åªä¼æ¿å°å¼ä»¥åï¼å°è¿ä¸ªå¼å¤å¶è¿å»ã\n\n\n# å¸¸è§ç¨é\n\nObject.assignæ¹æ³æå¾å¤ç¨å¤ã\n\nï¼1ï¼ä¸ºå¯¹è±¡æ·»å å±æ§\n\nclass Point {\n  constructor(x, y) {\n    Object.assign(this, {x, y});\n  }\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢æ¹æ³éè¿Object.assignæ¹æ³ï¼å°xå±æ§åyå±æ§æ·»å å°Pointç±»çå¯¹è±¡å®ä¾ã\n\nï¼2ï¼ä¸ºå¯¹è±¡æ·»å æ¹æ³\n\nObject.assign(SomeClass.prototype, {\n  someMethod(arg1, arg2) {\n    Â·Â·Â·\n  },\n  anotherMethod() {\n    Â·Â·Â·\n  }\n});\n\n// ç­åäºä¸é¢çåæ³\nSomeClass.prototype.someMethod = function (arg1, arg2) {\n  Â·Â·Â·\n};\nSomeClass.prototype.anotherMethod = function () {\n  Â·Â·Â·\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä½¿ç¨äºå¯¹è±¡å±æ§çç®æ´è¡¨ç¤ºæ³ï¼ç´æ¥å°ä¸¤ä¸ªå½æ°æ¾å¨å¤§æ¬å·ä¸­ï¼åä½¿ç¨assignæ¹æ³æ·»å å°SomeClass.prototypeä¹ä¸­ã\n\nï¼3ï¼åéå¯¹è±¡\n\nfunction clone(origin) {\n  return Object.assign({}, origin);\n}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç å°åå§å¯¹è±¡æ·è´å°ä¸ä¸ªç©ºå¯¹è±¡ï¼å°±å¾å°äºåå§å¯¹è±¡çåéã\n\nä¸è¿ï¼éç¨è¿ç§æ¹æ³åéï¼åªè½åéåå§å¯¹è±¡èªèº«çå¼ï¼ä¸è½åéå®ç»§æ¿çå¼ãå¦ææ³è¦ä¿æç»§æ¿é¾ï¼å¯ä»¥éç¨ä¸é¢çä»£ç ã\n\nfunction clone(origin) {\n  let originProto = Object.getPrototypeOf(origin);\n  return Object.assign(Object.create(originProto), origin);\n}\n\n\n1\n2\n3\n4\n\n\nï¼4ï¼åå¹¶å¤ä¸ªå¯¹è±¡\n\nå°å¤ä¸ªå¯¹è±¡åå¹¶å°æä¸ªå¯¹è±¡ã\n\nconst merge =\n  (target, ...sources) => Object.assign(target, ...sources);\n\n\n1\n2\n\n\nå¦æå¸æåå¹¶åè¿åä¸ä¸ªæ°å¯¹è±¡ï¼å¯ä»¥æ¹åä¸é¢å½æ°ï¼å¯¹ä¸ä¸ªç©ºå¯¹è±¡åå¹¶ã\n\nconst merge =\n  (...sources) => Object.assign({}, ...sources);\n\n\n1\n2\n\n\nï¼5ï¼ä¸ºå±æ§æå®é»è®¤å¼\n\nconst DEFAULTS = {\n  logLevel: 0,\n  outputFormat: 'html'\n};\n\nfunction processContent(options) {\n  options = Object.assign({}, DEFAULTS, options);\n  console.log(options);\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼DEFAULTSå¯¹è±¡æ¯é»è®¤å¼ï¼optionså¯¹è±¡æ¯ç¨æ·æä¾çåæ°ãObject.assignæ¹æ³å°DEFAULTSåoptionsåå¹¶æä¸ä¸ªæ°å¯¹è±¡ï¼å¦æä¸¤èæååå±æ§ï¼åoptionsçå±æ§å¼ä¼è¦çDEFAULTSçå±æ§å¼ã\n\næ³¨æï¼ç±äºå­å¨æµæ·è´çé®é¢ï¼DEFAULTSå¯¹è±¡åoptionså¯¹è±¡çææå±æ§çå¼ï¼æå¥½é½æ¯ç®åç±»åï¼ä¸è¦æåå¦ä¸ä¸ªå¯¹è±¡ãå¦åï¼DEFAULTSå¯¹è±¡çè¯¥å±æ§å¾å¯è½ä¸èµ·ä½ç¨ã\n\nconst DEFAULTS = {\n  url: {\n    host: 'example.com',\n    port: 7070\n  },\n};\n\nprocessContent({ url: {port: 8000} })\n// {\n//   url: {port: 8000}\n// }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç çåææ¯å°url.portæ¹æ 8000ï¼url.hostä¸åãå®éç»æå´æ¯options.urlè¦çæDEFAULTS.urlï¼æä»¥url.hostå°±ä¸å­å¨äºã\n\n\n# Object.getOwnPropertyDescriptors()\n\nES5 çObject.getOwnPropertyDescriptor()æ¹æ³ä¼è¿åæä¸ªå¯¹è±¡å±æ§çæè¿°å¯¹è±¡ï¼descriptorï¼ãES2017 å¼å¥äºObject.getOwnPropertyDescriptors()æ¹æ³ï¼è¿åæå®å¯¹è±¡ææèªèº«å±æ§ï¼éç»§æ¿å±æ§ï¼çæè¿°å¯¹è±¡ã\n\nconst obj = {\n  foo: 123,\n  get bar() { return 'abc' }\n};\n\nObject.getOwnPropertyDescriptors(obj)\n// { foo:\n//    { value: 123,\n//      writable: true,\n//      enumerable: true,\n//      configurable: true },\n//   bar:\n//    { get: [Function: get bar],\n//      set: undefined,\n//      enumerable: true,\n//      configurable: true } }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼Object.getOwnPropertyDescriptors()æ¹æ³è¿åä¸ä¸ªå¯¹è±¡ï¼ææåå¯¹è±¡çå±æ§åé½æ¯è¯¥å¯¹è±¡çå±æ§åï¼å¯¹åºçå±æ§å¼å°±æ¯è¯¥å±æ§çæè¿°å¯¹è±¡ã\n\nè¯¥æ¹æ³çå®ç°éå¸¸å®¹æã\n\nfunction getOwnPropertyDescriptors(obj) {\n  const result = {};\n  for (let key of Reflect.ownKeys(obj)) {\n    result[key] = Object.getOwnPropertyDescriptor(obj, key);\n  }\n  return result;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¯¥æ¹æ³çå¼å¥ç®çï¼ä¸»è¦æ¯ä¸ºäºè§£å³Object.assign()æ æ³æ­£ç¡®æ·è´getå±æ§åsetå±æ§çé®é¢ã\n\nconst source = {\n  set foo(value) {\n    console.log(value);\n  }\n};\n\nconst target1 = {};\nObject.assign(target1, source);\n\nObject.getOwnPropertyDescriptor(target1, 'foo')\n// { value: undefined,\n//   writable: true,\n//   enumerable: true,\n//   configurable: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼sourceå¯¹è±¡çfooå±æ§çå¼æ¯ä¸ä¸ªèµå¼å½æ°ï¼Object.assignæ¹æ³å°è¿ä¸ªå±æ§æ·è´ç»target1å¯¹è±¡ï¼ç»æè¯¥å±æ§çå¼åæäºundefinedãè¿æ¯å ä¸ºObject.assignæ¹æ³æ»æ¯æ·è´ä¸ä¸ªå±æ§çå¼ï¼èä¸ä¼æ·è´å®èåçèµå¼æ¹æ³æåå¼æ¹æ³ã\n\nè¿æ¶ï¼Object.getOwnPropertyDescriptors()æ¹æ³éåObject.defineProperties()æ¹æ³ï¼å°±å¯ä»¥å®ç°æ­£ç¡®æ·è´ã\n\nconst source = {\n  set foo(value) {\n    console.log(value);\n  }\n};\n\nconst target2 = {};\nObject.defineProperties(target2, Object.getOwnPropertyDescriptors(source));\nObject.getOwnPropertyDescriptor(target2, 'foo')\n// { get: undefined,\n//   set: [Function: set foo],\n//   enumerable: true,\n//   configurable: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸¤ä¸ªå¯¹è±¡åå¹¶çé»è¾å¯ä»¥åæä¸ä¸ªå½æ°ã\n\nconst shallowMerge = (target, source) => Object.defineProperties(\n  target,\n  Object.getOwnPropertyDescriptors(source)\n);\n\n\n1\n2\n3\n4\n\n\nObject.getOwnPropertyDescriptors()æ¹æ³çå¦ä¸ä¸ªç¨å¤ï¼æ¯éåObject.create()æ¹æ³ï¼å°å¯¹è±¡å±æ§åéå°ä¸ä¸ªæ°å¯¹è±¡ãè¿å±äºæµæ·è´ã\n\nconst clone = Object.create(Object.getPrototypeOf(obj),\n  Object.getOwnPropertyDescriptors(obj));\n\n// æè\n\nconst shallowClone = (obj) => Object.create(\n  Object.getPrototypeOf(obj),\n  Object.getOwnPropertyDescriptors(obj)\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¼åéå¯¹è±¡objã\n\nå¦å¤ï¼Object.getOwnPropertyDescriptors()æ¹æ³å¯ä»¥å®ç°ä¸ä¸ªå¯¹è±¡ç»§æ¿å¦ä¸ä¸ªå¯¹è±¡ãä»¥åï¼ç»§æ¿å¦ä¸ä¸ªå¯¹è±¡ï¼å¸¸å¸¸åæä¸é¢è¿æ ·ã\n\nconst obj = {\n  __proto__: prot,\n  foo: 123,\n};\n\n\n1\n2\n3\n4\n\n\nES6 è§å®__proto__åªææµè§å¨è¦é¨ç½²ï¼å¶ä»ç¯å¢ä¸ç¨é¨ç½²ãå¦æå»é¤__proto__ï¼ä¸é¢ä»£ç å°±è¦æ¹æä¸é¢è¿æ ·ã\n\nconst obj = Object.create(prot);\nobj.foo = 123;\n\n// æè\n\nconst obj = Object.assign(\n  Object.create(prot),\n  {\n    foo: 123,\n  }\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\næäºObject.getOwnPropertyDescriptors()ï¼æä»¬å°±æäºå¦ä¸ç§åæ³ã\n\nconst obj = Object.create(\n  prot,\n  Object.getOwnPropertyDescriptors({\n    foo: 123,\n  })\n);\n\n\n1\n2\n3\n4\n5\n6\n\n\nObject.getOwnPropertyDescriptors()ä¹å¯ä»¥ç¨æ¥å®ç° Mixinï¼æ··å¥ï¼æ¨¡å¼ã\n\nlet mix = (object) => ({\n  with: (...mixins) => mixins.reduce(\n    (c, mixin) => Object.create(\n      c, Object.getOwnPropertyDescriptors(mixin)\n    ), object)\n});\n\n// multiple mixins example\nlet a = {a: 'a'};\nlet b = {b: 'b'};\nlet c = {c: 'c'};\nlet d = mix(c).with(a, b);\n\nd.c // \"c\"\nd.b // \"b\"\nd.a // \"a\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç è¿åä¸ä¸ªæ°çå¯¹è±¡dï¼ä»£è¡¨äºå¯¹è±¡aåbè¢«æ··å¥äºå¯¹è±¡cçæä½ã\n\nåºäºå®æ´æ§çèèï¼Object.getOwnPropertyDescriptors()è¿å¥æ åä»¥åï¼ä»¥åè¿ä¼æ°å¢Reflect.getOwnPropertyDescriptors()æ¹æ³ã\n\n\n# __proto__å±æ§ï¼Object.setPrototypeOf()ï¼Object.getPrototypeOf()\n\nJavaScript è¯­è¨çå¯¹è±¡ç»§æ¿æ¯éè¿ååé¾å®ç°çãES6 æä¾äºæ´å¤ååå¯¹è±¡çæä½æ¹æ³ã\n\n\n# __proto__å±æ§\n\n__proto__å±æ§ï¼åååä¸¤ä¸ªä¸åçº¿ï¼ï¼ç¨æ¥è¯»åæè®¾ç½®å½åå¯¹è±¡çprototypeå¯¹è±¡ãç®åï¼æææµè§å¨ï¼åæ¬ IE11ï¼é½é¨ç½²äºè¿ä¸ªå±æ§ã\n\n// es5 çåæ³\nconst obj = {\n  method: function() { ... }\n};\nobj.__proto__ = someOtherObj;\n\n// es6 çåæ³\nvar obj = Object.create(someOtherObj);\nobj.method = function() { ... };\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nè¯¥å±æ§æ²¡æåå¥ ES6 çæ­£æï¼èæ¯åå¥äºéå½ï¼åå æ¯__proto__ååçåä¸åçº¿ï¼è¯´æå®æ¬è´¨ä¸æ¯ä¸ä¸ªåé¨å±æ§ï¼èä¸æ¯ä¸ä¸ªæ­£å¼çå¯¹å¤ç APIï¼åªæ¯ç±äºæµè§å¨å¹¿æ³æ¯æï¼æè¢«å å¥äº ES6ãæ åæç¡®è§å®ï¼åªææµè§å¨å¿é¡»é¨ç½²è¿ä¸ªå±æ§ï¼å¶ä»è¿è¡ç¯å¢ä¸ä¸å®éè¦é¨ç½²ï¼èä¸æ°çä»£ç æå¥½è®¤ä¸ºè¿ä¸ªå±æ§æ¯ä¸å­å¨çãå æ­¤ï¼æ è®ºä»è¯­ä¹çè§åº¦ï¼è¿æ¯ä»å¼å®¹æ§çè§åº¦ï¼é½ä¸è¦ä½¿ç¨è¿ä¸ªå±æ§ï¼èæ¯ä½¿ç¨ä¸é¢çObject.setPrototypeOf()ï¼åæä½ï¼ãObject.getPrototypeOf()ï¼è¯»æä½ï¼ãObject.create()ï¼çææä½ï¼ä»£æ¿ã\n\nå®ç°ä¸ï¼__proto__è°ç¨çæ¯Object.prototype.__proto__ï¼å·ä½å®ç°å¦ä¸ã\n\nObject.defineProperty(Object.prototype, '__proto__', {\n  get() {\n    let _thisObj = Object(this);\n    return Object.getPrototypeOf(_thisObj);\n  },\n  set(proto) {\n    if (this === undefined || this === null) {\n      throw new TypeError();\n    }\n    if (!isObject(this)) {\n      return undefined;\n    }\n    if (!isObject(proto)) {\n      return undefined;\n    }\n    let status = Reflect.setPrototypeOf(this, proto);\n    if (!status) {\n      throw new TypeError();\n    }\n  },\n});\n\nfunction isObject(value) {\n  return Object(value) === value;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nå¦æä¸ä¸ªå¯¹è±¡æ¬èº«é¨ç½²äº__proto__å±æ§ï¼è¯¥å±æ§çå¼å°±æ¯å¯¹è±¡çååã\n\nObject.getPrototypeOf({ __proto__: null })\n// null\n\n\n1\n2\n\n\n\n# Object.setPrototypeOf()\n\nObject.setPrototypeOfæ¹æ³çä½ç¨ä¸__proto__ç¸åï¼ç¨æ¥è®¾ç½®ä¸ä¸ªå¯¹è±¡çprototypeå¯¹è±¡ï¼è¿ååæ°å¯¹è±¡æ¬èº«ãå®æ¯ ES6 æ­£å¼æ¨èçè®¾ç½®ååå¯¹è±¡çæ¹æ³ã\n\n// æ ¼å¼\nObject.setPrototypeOf(object, prototype)\n\n// ç¨æ³\nconst o = Object.setPrototypeOf({}, null);\n\n\n1\n2\n3\n4\n5\n\n\nè¯¥æ¹æ³ç­åäºä¸é¢çå½æ°ã\n\nfunction setPrototypeOf(obj, proto) {\n  obj.__proto__ = proto;\n  return obj;\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nlet proto = {};\nlet obj = { x: 10 };\nObject.setPrototypeOf(obj, proto);\n\nproto.y = 20;\nproto.z = 40;\n\nobj.x // 10\nobj.y // 20\nobj.z // 40\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å°protoå¯¹è±¡è®¾ä¸ºobjå¯¹è±¡çååï¼æä»¥ä»objå¯¹è±¡å¯ä»¥è¯»åprotoå¯¹è±¡çå±æ§ã\n\nå¦æç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼ä¼èªå¨è½¬ä¸ºå¯¹è±¡ãä½æ¯ç±äºè¿åçè¿æ¯ç¬¬ä¸ä¸ªåæ°ï¼æä»¥è¿ä¸ªæä½ä¸ä¼äº§çä»»ä½ææã\n\nObject.setPrototypeOf(1, {}) === 1 // true\nObject.setPrototypeOf('foo', {}) === 'foo' // true\nObject.setPrototypeOf(true, {}) === true // true\n\n\n1\n2\n3\n\n\nç±äºundefinedånullæ æ³è½¬ä¸ºå¯¹è±¡ï¼æä»¥å¦æç¬¬ä¸ä¸ªåæ°æ¯undefinedænullï¼å°±ä¼æ¥éã\n\nObject.setPrototypeOf(undefined, {})\n// TypeError: Object.setPrototypeOf called on null or undefined\n\nObject.setPrototypeOf(null, {})\n// TypeError: Object.setPrototypeOf called on null or undefined\n\n\n1\n2\n3\n4\n5\n\n\n\n# Object.getPrototypeOf()\n\nè¯¥æ¹æ³ä¸Object.setPrototypeOfæ¹æ³éå¥ï¼ç¨äºè¯»åä¸ä¸ªå¯¹è±¡çååå¯¹è±¡ã\n\nObject.getPrototypeOf(obj);\n\n\n1\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nfunction Rectangle() {\n  // ...\n}\n\nconst rec = new Rectangle();\n\nObject.getPrototypeOf(rec) === Rectangle.prototype\n// true\n\nObject.setPrototypeOf(rec, Object.prototype);\nObject.getPrototypeOf(rec) === Rectangle.prototype\n// false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå¦æåæ°ä¸æ¯å¯¹è±¡ï¼ä¼è¢«èªå¨è½¬ä¸ºå¯¹è±¡ã\n\n// ç­åäº Object.getPrototypeOf(Number(1))\nObject.getPrototypeOf(1)\n// Number {[[PrimitiveValue]]: 0}\n\n// ç­åäº Object.getPrototypeOf(String('foo'))\nObject.getPrototypeOf('foo')\n// String {length: 0, [[PrimitiveValue]]: \"\"}\n\n// ç­åäº Object.getPrototypeOf(Boolean(true))\nObject.getPrototypeOf(true)\n// Boolean {[[PrimitiveValue]]: false}\n\nObject.getPrototypeOf(1) === Number.prototype // true\nObject.getPrototypeOf('foo') === String.prototype // true\nObject.getPrototypeOf(true) === Boolean.prototype // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå¦æåæ°æ¯undefinedænullï¼å®ä»¬æ æ³è½¬ä¸ºå¯¹è±¡ï¼æä»¥ä¼æ¥éã\n\nObject.getPrototypeOf(null)\n// TypeError: Cannot convert undefined or null to object\n\nObject.getPrototypeOf(undefined)\n// TypeError: Cannot convert undefined or null to object\n\n\n1\n2\n3\n4\n5\n\n\n\n# Object.keys()ï¼Object.values()ï¼Object.entries()\n\n\n# Object.keys()\n\nES5 å¼å¥äºObject.keysæ¹æ³ï¼è¿åä¸ä¸ªæ°ç»ï¼æåæ¯åæ°å¯¹è±¡èªèº«çï¼ä¸å«ç»§æ¿çï¼ææå¯éåï¼enumerableï¼å±æ§çé®åã\n\nvar obj = { foo: 'bar', baz: 42 };\nObject.keys(obj)\n// [\"foo\", \"baz\"]\n\n\n1\n2\n3\n\n\nES2017 å¼å¥äºè·Object.keyséå¥çObject.valuesåObject.entriesï¼ä½ä¸ºéåä¸ä¸ªå¯¹è±¡çè¡¥åææ®µï¼ä¾for...ofå¾ªç¯ä½¿ç¨ã\n\nlet {keys, values, entries} = Object;\nlet obj = { a: 1, b: 2, c: 3 };\n\nfor (let key of keys(obj)) {\n  console.log(key); // 'a', 'b', 'c'\n}\n\nfor (let value of values(obj)) {\n  console.log(value); // 1, 2, 3\n}\n\nfor (let [key, value] of entries(obj)) {\n  console.log([key, value]); // ['a', 1], ['b', 2], ['c', 3]\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# Object.values()\n\nObject.valuesæ¹æ³è¿åä¸ä¸ªæ°ç»ï¼æåæ¯åæ°å¯¹è±¡èªèº«çï¼ä¸å«ç»§æ¿çï¼ææå¯éåï¼enumerableï¼å±æ§çé®å¼ã\n\nconst obj = { foo: 'bar', baz: 42 };\nObject.values(obj)\n// [\"bar\", 42]\n\n\n1\n2\n3\n\n\nè¿åæ°ç»çæåé¡ºåºï¼ä¸æ¬ç« çãå±æ§çéåãé¨åä»ç»çæåè§åä¸è´ã\n\nconst obj = { 100: 'a', 2: 'b', 7: 'c' };\nObject.values(obj)\n// [\"b\", \"c\", \"a\"]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼å±æ§åä¸ºæ°å¼çå±æ§ï¼æ¯æç§æ°å¼å¤§å°ï¼ä»å°å°å¤§éåçï¼å æ­¤è¿åçé¡ºåºæ¯bãcãaã\n\nObject.valuesåªè¿åå¯¹è±¡èªèº«çå¯éåå±æ§ã\n\nconst obj = Object.create({}, {p: {value: 42}});\nObject.values(obj) // []\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼Object.createæ¹æ³çç¬¬äºä¸ªåæ°æ·»å çå¯¹è±¡å±æ§ï¼å±æ§pï¼ï¼å¦æä¸æ¾å¼å£°æï¼é»è®¤æ¯ä¸å¯éåçï¼å ä¸ºpçå±æ§æè¿°å¯¹è±¡çenumerableé»è®¤æ¯falseï¼Object.valuesä¸ä¼è¿åè¿ä¸ªå±æ§ãåªè¦æenumerableæ¹ætrueï¼Object.valueså°±ä¼è¿åå±æ§pçå¼ã\n\nconst obj = Object.create({}, {p:\n  {\n    value: 42,\n    enumerable: true\n  }\n});\nObject.values(obj) // [42]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nObject.valuesä¼è¿æ»¤å±æ§åä¸º Symbol å¼çå±æ§ã\n\nObject.values({ [Symbol()]: 123, foo: 'abc' });\n// ['abc']\n\n\n1\n2\n\n\nå¦æObject.valuesæ¹æ³çåæ°æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼ä¼è¿ååä¸ªå­ç¬¦ç»æçä¸ä¸ªæ°ç»ã\n\nObject.values('foo')\n// ['f', 'o', 'o']\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç¬¦ä¸²ä¼åè½¬æä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ãå­ç¬¦ä¸²çæ¯ä¸ªå­ç¬¦ï¼å°±æ¯è¯¥å¯¹è±¡çä¸ä¸ªå±æ§ãå æ­¤ï¼Object.valuesè¿åæ¯ä¸ªå±æ§çé®å¼ï¼å°±æ¯åä¸ªå­ç¬¦ç»æçä¸ä¸ªæ°ç»ã\n\nå¦æåæ°ä¸æ¯å¯¹è±¡ï¼Object.valuesä¼åå°å¶è½¬ä¸ºå¯¹è±¡ãç±äºæ°å¼åå¸å°å¼çåè£å¯¹è±¡ï¼é½ä¸ä¼ä¸ºå®ä¾æ·»å éç»§æ¿çå±æ§ãæä»¥ï¼Object.valuesä¼è¿åç©ºæ°ç»ã\n\nObject.values(42) // []\nObject.values(true) // []\n\n\n1\n2\n\n\n\n# Object.entries()\n\nObject.entries()æ¹æ³è¿åä¸ä¸ªæ°ç»ï¼æåæ¯åæ°å¯¹è±¡èªèº«çï¼ä¸å«ç»§æ¿çï¼ææå¯éåï¼enumerableï¼å±æ§çé®å¼å¯¹æ°ç»ã\n\nconst obj = { foo: 'bar', baz: 42 };\nObject.entries(obj)\n// [ [\"foo\", \"bar\"], [\"baz\", 42] ]\n\n\n1\n2\n3\n\n\né¤äºè¿åå¼ä¸ä¸æ ·ï¼è¯¥æ¹æ³çè¡ä¸ºä¸Object.valuesåºæ¬ä¸è´ã\n\nå¦æåå¯¹è±¡çå±æ§åæ¯ä¸ä¸ª Symbol å¼ï¼è¯¥å±æ§ä¼è¢«å¿½ç¥ã\n\nObject.entries({ [Symbol()]: 123, foo: 'abc' });\n// [ [ 'foo', 'abc' ] ]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼åå¯¹è±¡æä¸¤ä¸ªå±æ§ï¼Object.entriesåªè¾åºå±æ§åé Symbol å¼çå±æ§ãå°æ¥å¯è½ä¼æReflect.ownEntries()æ¹æ³ï¼è¿åå¯¹è±¡èªèº«çææå±æ§ã\n\nObject.entriesçåºæ¬ç¨éæ¯éåå¯¹è±¡çå±æ§ã\n\nlet obj = { one: 1, two: 2 };\nfor (let [k, v] of Object.entries(obj)) {\n  console.log(\n    `${JSON.stringify(k)}: ${JSON.stringify(v)}`\n  );\n}\n// \"one\": 1\n// \"two\": 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nObject.entriesæ¹æ³çå¦ä¸ä¸ªç¨å¤æ¯ï¼å°å¯¹è±¡è½¬ä¸ºçæ­£çMapç»æã\n\nconst obj = { foo: 'bar', baz: 42 };\nconst map = new Map(Object.entries(obj));\nmap // Map { foo: \"bar\", baz: 42 }\n\n\n1\n2\n3\n\n\nèªå·±å®ç°Object.entriesæ¹æ³ï¼éå¸¸ç®åã\n\n// Generatorå½æ°ççæ¬\nfunction* entries(obj) {\n  for (let key of Object.keys(obj)) {\n    yield [key, obj[key]];\n  }\n}\n\n// éGeneratorå½æ°ççæ¬\nfunction entries(obj) {\n  let arr = [];\n  for (let key of Object.keys(obj)) {\n    arr.push([key, obj[key]]);\n  }\n  return arr;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# Object.fromEntries()\n\nObject.fromEntries()æ¹æ³æ¯Object.entries()çéæä½ï¼ç¨äºå°ä¸ä¸ªé®å¼å¯¹æ°ç»è½¬ä¸ºå¯¹è±¡ã\n\nObject.fromEntries([\n  ['foo', 'bar'],\n  ['baz', 42]\n])\n// { foo: \"bar\", baz: 42 }\n\n\n1\n2\n3\n4\n5\n\n\nè¯¥æ¹æ³çä¸»è¦ç®çï¼æ¯å°é®å¼å¯¹çæ°æ®ç»æè¿åä¸ºå¯¹è±¡ï¼å æ­¤ç¹å«éåå° Map ç»æè½¬ä¸ºå¯¹è±¡ã\n\n// ä¾ä¸\nconst entries = new Map([\n  ['foo', 'bar'],\n  ['baz', 42]\n]);\n\nObject.fromEntries(entries)\n// { foo: \"bar\", baz: 42 }\n\n// ä¾äº\nconst map = new Map().set('foo', true).set('bar', false);\nObject.fromEntries(map)\n// { foo: true, bar: false }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nè¯¥æ¹æ³çä¸ä¸ªç¨å¤æ¯éåURLSearchParamså¯¹è±¡ï¼å°æ¥è¯¢å­ç¬¦ä¸²è½¬ä¸ºå¯¹è±¡ã\n\nObject.fromEntries(new URLSearchParams('foo=bar&baz=qux'))\n// { foo: \"bar\", baz: \"qux\" }\n\n\n1\n2\n",normalizedContent:"# å¯¹è±¡çæ°å¢æ¹æ³\n\næ¬ç« ä»ç» object å¯¹è±¡çæ°å¢æ¹æ³ã\n\n\n# object.is()\n\nes5 æ¯è¾ä¸¤ä¸ªå¼æ¯å¦ç¸ç­ï¼åªæä¸¤ä¸ªè¿ç®ç¬¦ï¼ç¸ç­è¿ç®ç¬¦ï¼==ï¼åä¸¥æ ¼ç¸ç­è¿ç®ç¬¦ï¼===ï¼ãå®ä»¬é½æç¼ºç¹ï¼åèä¼èªå¨è½¬æ¢æ°æ®ç±»åï¼åèçnanä¸ç­äºèªèº«ï¼ä»¥å+0ç­äº-0ãjavascript ç¼ºä¹ä¸ç§è¿ç®ï¼å¨ææç¯å¢ä¸­ï¼åªè¦ä¸¤ä¸ªå¼æ¯ä¸æ ·çï¼å®ä»¬å°±åºè¯¥ç¸ç­ã\n\nes6 æåºâsame-value equalityâï¼åå¼ç¸ç­ï¼ç®æ³ï¼ç¨æ¥è§£å³è¿ä¸ªé®é¢ãobject.iså°±æ¯é¨ç½²è¿ä¸ªç®æ³çæ°æ¹æ³ãå®ç¨æ¥æ¯è¾ä¸¤ä¸ªå¼æ¯å¦ä¸¥æ ¼ç¸ç­ï¼ä¸ä¸¥æ ¼æ¯è¾è¿ç®ç¬¦ï¼===ï¼çè¡ä¸ºåºæ¬ä¸è´ã\n\nobject.is('foo', 'foo')\n// true\nobject.is({}, {})\n// false\n\n\n1\n2\n3\n4\n\n\nä¸åä¹å¤åªæä¸¤ä¸ªï¼ä¸æ¯+0ä¸ç­äº-0ï¼äºæ¯nanç­äºèªèº«ã\n\n+0 === -0 //true\nnan === nan // false\n\nobject.is(+0, -0) // false\nobject.is(nan, nan) // true\n\n\n1\n2\n3\n4\n5\n\n\nes5 å¯ä»¥éè¿ä¸é¢çä»£ç ï¼é¨ç½²object.isã\n\nobject.defineproperty(object, 'is', {\n  value: function(x, y) {\n    if (x === y) {\n      // éå¯¹+0 ä¸ç­äº -0çæåµ\n      return x !== 0 || 1 / x === 1 / y;\n    }\n    // éå¯¹nançæåµ\n    return x !== x && y !== y;\n  },\n  configurable: true,\n  enumerable: false,\n  writable: true\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# object.assign()\n\n\n# åºæ¬ç¨æ³\n\nobject.assignæ¹æ³ç¨äºå¯¹è±¡çåå¹¶ï¼å°æºå¯¹è±¡ï¼sourceï¼çææå¯æä¸¾å±æ§ï¼å¤å¶å°ç®æ å¯¹è±¡ï¼targetï¼ã\n\nconst target = { a: 1 };\n\nconst source1 = { b: 2 };\nconst source2 = { c: 3 };\n\nobject.assign(target, source1, source2);\ntarget // {a:1, b:2, c:3}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nobject.assignæ¹æ³çç¬¬ä¸ä¸ªåæ°æ¯ç®æ å¯¹è±¡ï¼åé¢çåæ°é½æ¯æºå¯¹è±¡ã\n\næ³¨æï¼å¦æç®æ å¯¹è±¡ä¸æºå¯¹è±¡æååå±æ§ï¼æå¤ä¸ªæºå¯¹è±¡æååå±æ§ï¼ååé¢çå±æ§ä¼è¦çåé¢çå±æ§ã\n\nconst target = { a: 1, b: 1 };\n\nconst source1 = { b: 2, c: 2 };\nconst source2 = { c: 3 };\n\nobject.assign(target, source1, source2);\ntarget // {a:1, b:2, c:3}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦æåªæä¸ä¸ªåæ°ï¼object.assignä¼ç´æ¥è¿åè¯¥åæ°ã\n\nconst obj = {a: 1};\nobject.assign(obj) === obj // true\n\n\n1\n2\n\n\nå¦æè¯¥åæ°ä¸æ¯å¯¹è±¡ï¼åä¼åè½¬æå¯¹è±¡ï¼ç¶åè¿åã\n\ntypeof object.assign(2) // \"object\"\n\n\n1\n\n\nç±äºundefinedånullæ æ³è½¬æå¯¹è±¡ï¼æä»¥å¦æå®ä»¬ä½ä¸ºåæ°ï¼å°±ä¼æ¥éã\n\nobject.assign(undefined) // æ¥é\nobject.assign(null) // æ¥é\n\n\n1\n2\n\n\nå¦æéå¯¹è±¡åæ°åºç°å¨æºå¯¹è±¡çä½ç½®ï¼å³éé¦åæ°ï¼ï¼é£ä¹å¤çè§åææä¸åãé¦åï¼è¿äºåæ°é½ä¼è½¬æå¯¹è±¡ï¼å¦ææ æ³è½¬æå¯¹è±¡ï¼å°±ä¼è·³è¿ãè¿æå³çï¼å¦æundefinedånullä¸å¨é¦åæ°ï¼å°±ä¸ä¼æ¥éã\n\nlet obj = {a: 1};\nobject.assign(obj, undefined) === obj // true\nobject.assign(obj, null) === obj // true\n\n\n1\n2\n3\n\n\nå¶ä»ç±»åçå¼ï¼å³æ°å¼ãå­ç¬¦ä¸²åå¸å°å¼ï¼ä¸å¨é¦åæ°ï¼ä¹ä¸ä¼æ¥éãä½æ¯ï¼é¤äºå­ç¬¦ä¸²ä¼ä»¥æ°ç»å½¢å¼ï¼æ·è´å¥ç®æ å¯¹è±¡ï¼å¶ä»å¼é½ä¸ä¼äº§çææã\n\nconst v1 = 'abc';\nconst v2 = true;\nconst v3 = 10;\n\nconst obj = object.assign({}, v1, v2, v3);\nconsole.log(obj); // { \"0\": \"a\", \"1\": \"b\", \"2\": \"c\" }\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼v1ãv2ãv3åå«æ¯å­ç¬¦ä¸²ãå¸å°å¼åæ°å¼ï¼ç»æåªæå­ç¬¦ä¸²åå¥ç®æ å¯¹è±¡ï¼ä»¥å­ç¬¦æ°ç»çå½¢å¼ï¼ï¼æ°å¼åå¸å°å¼é½ä¼è¢«å¿½ç¥ãè¿æ¯å ä¸ºåªæå­ç¬¦ä¸²çåè£å¯¹è±¡ï¼ä¼äº§çå¯æä¸¾å±æ§ã\n\nobject(true) // {[[primitivevalue]]: true}\nobject(10)  //  {[[primitivevalue]]: 10}\nobject('abc') // {0: \"a\", 1: \"b\", 2: \"c\", length: 3, [[primitivevalue]]: \"abc\"}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼å¸å°å¼ãæ°å¼ãå­ç¬¦ä¸²åå«è½¬æå¯¹åºçåè£å¯¹è±¡ï¼å¯ä»¥çå°å®ä»¬çåå§å¼é½å¨åè£å¯¹è±¡çåé¨å±æ§[[primitivevalue]]ä¸é¢ï¼è¿ä¸ªå±æ§æ¯ä¸ä¼è¢«object.assignæ·è´çãåªæå­ç¬¦ä¸²çåè£å¯¹è±¡ï¼ä¼äº§çå¯æä¸¾çå®ä¹å±æ§ï¼é£äºå±æ§åä¼è¢«æ·è´ã\n\nobject.assignæ·è´çå±æ§æ¯æéå¶çï¼åªæ·è´æºå¯¹è±¡çèªèº«å±æ§ï¼ä¸æ·è´ç»§æ¿å±æ§ï¼ï¼ä¹ä¸æ·è´ä¸å¯æä¸¾çå±æ§ï¼enumerable: falseï¼ã\n\nobject.assign({b: 'c'},\n  object.defineproperty({}, 'invisible', {\n    enumerable: false,\n    value: 'hello'\n  })\n)\n// { b: 'c' }\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼object.assignè¦æ·è´çå¯¹è±¡åªæä¸ä¸ªä¸å¯æä¸¾å±æ§invisibleï¼è¿ä¸ªå±æ§å¹¶æ²¡æè¢«æ·è´è¿å»ã\n\nå±æ§åä¸º symbol å¼çå±æ§ï¼ä¹ä¼è¢«object.assignæ·è´ã\n\nobject.assign({ a: 'b' }, { [symbol('c')]: 'd' })\n// { a: 'b', symbol(c): 'd' }\n\n\n1\n2\n\n\n\n# æ³¨æç¹\n\nï¼1ï¼æµæ·è´\n\nobject.assignæ¹æ³å®è¡çæ¯æµæ·è´ï¼èä¸æ¯æ·±æ·è´ãä¹å°±æ¯è¯´ï¼å¦ææºå¯¹è±¡æä¸ªå±æ§çå¼æ¯å¯¹è±¡ï¼é£ä¹ç®æ å¯¹è±¡æ·è´å¾å°çæ¯è¿ä¸ªå¯¹è±¡çå¼ç¨ã\n\nconst obj1 = {a: {b: 1}};\nconst obj2 = object.assign({}, obj1);\n\nobj1.a.b = 2;\nobj2.a.b // 2\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼æºå¯¹è±¡obj1çaå±æ§çå¼æ¯ä¸ä¸ªå¯¹è±¡ï¼object.assignæ·è´å¾å°çæ¯è¿ä¸ªå¯¹è±¡çå¼ç¨ãè¿ä¸ªå¯¹è±¡çä»»ä½ååï¼é½ä¼åæ å°ç®æ å¯¹è±¡ä¸é¢ã\n\nï¼2ï¼ååå±æ§çæ¿æ¢\n\nå¯¹äºè¿ç§åµå¥çå¯¹è±¡ï¼ä¸æ¦éå°ååå±æ§ï¼object.assignçå¤çæ¹æ³æ¯æ¿æ¢ï¼èä¸æ¯æ·»å ã\n\nconst target = { a: { b: 'c', d: 'e' } }\nconst source = { a: { b: 'hello' } }\nobject.assign(target, source)\n// { a: { b: 'hello' } }\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼targetå¯¹è±¡çaå±æ§è¢«sourceå¯¹è±¡çaå±æ§æ´ä¸ªæ¿æ¢æäºï¼èä¸ä¼å¾å°{ a: { b: 'hello', d: 'e' } }çç»æãè¿éå¸¸ä¸æ¯å¼åèæ³è¦çï¼éè¦ç¹å«å°å¿ã\n\nä¸äºå½æ°åºæä¾object.assignçå®å¶çæ¬ï¼æ¯å¦ lodash ç_.defaultsdeepæ¹æ³ï¼ï¼å¯ä»¥å¾å°æ·±æ·è´çåå¹¶ã\n\nï¼3ï¼æ°ç»çå¤ç\n\nobject.assignå¯ä»¥ç¨æ¥å¤çæ°ç»ï¼ä½æ¯ä¼ææ°ç»è§ä¸ºå¯¹è±¡ã\n\nobject.assign([1, 2, 3], [4, 5])\n// [4, 5, 3]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼object.assignææ°ç»è§ä¸ºå±æ§åä¸º 0ã1ã2 çå¯¹è±¡ï¼å æ­¤æºæ°ç»ç 0 å·å±æ§4è¦çäºç®æ æ°ç»ç 0 å·å±æ§1ã\n\nï¼4ï¼åå¼å½æ°çå¤ç\n\nobject.assignåªè½è¿è¡å¼çå¤å¶ï¼å¦æè¦å¤å¶çå¼æ¯ä¸ä¸ªåå¼å½æ°ï¼é£ä¹å°æ±å¼ååå¤å¶ã\n\nconst source = {\n  get foo() { return 1 }\n};\nconst target = {};\n\nobject.assign(target, source)\n// { foo: 1 }\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼sourceå¯¹è±¡çfooå±æ§æ¯ä¸ä¸ªåå¼å½æ°ï¼object.assignä¸ä¼å¤å¶è¿ä¸ªåå¼å½æ°ï¼åªä¼æ¿å°å¼ä»¥åï¼å°è¿ä¸ªå¼å¤å¶è¿å»ã\n\n\n# å¸¸è§ç¨é\n\nobject.assignæ¹æ³æå¾å¤ç¨å¤ã\n\nï¼1ï¼ä¸ºå¯¹è±¡æ·»å å±æ§\n\nclass point {\n  constructor(x, y) {\n    object.assign(this, {x, y});\n  }\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢æ¹æ³éè¿object.assignæ¹æ³ï¼å°xå±æ§åyå±æ§æ·»å å°pointç±»çå¯¹è±¡å®ä¾ã\n\nï¼2ï¼ä¸ºå¯¹è±¡æ·»å æ¹æ³\n\nobject.assign(someclass.prototype, {\n  somemethod(arg1, arg2) {\n    Â·Â·Â·\n  },\n  anothermethod() {\n    Â·Â·Â·\n  }\n});\n\n// ç­åäºä¸é¢çåæ³\nsomeclass.prototype.somemethod = function (arg1, arg2) {\n  Â·Â·Â·\n};\nsomeclass.prototype.anothermethod = function () {\n  Â·Â·Â·\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä½¿ç¨äºå¯¹è±¡å±æ§çç®æ´è¡¨ç¤ºæ³ï¼ç´æ¥å°ä¸¤ä¸ªå½æ°æ¾å¨å¤§æ¬å·ä¸­ï¼åä½¿ç¨assignæ¹æ³æ·»å å°someclass.prototypeä¹ä¸­ã\n\nï¼3ï¼åéå¯¹è±¡\n\nfunction clone(origin) {\n  return object.assign({}, origin);\n}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç å°åå§å¯¹è±¡æ·è´å°ä¸ä¸ªç©ºå¯¹è±¡ï¼å°±å¾å°äºåå§å¯¹è±¡çåéã\n\nä¸è¿ï¼éç¨è¿ç§æ¹æ³åéï¼åªè½åéåå§å¯¹è±¡èªèº«çå¼ï¼ä¸è½åéå®ç»§æ¿çå¼ãå¦ææ³è¦ä¿æç»§æ¿é¾ï¼å¯ä»¥éç¨ä¸é¢çä»£ç ã\n\nfunction clone(origin) {\n  let originproto = object.getprototypeof(origin);\n  return object.assign(object.create(originproto), origin);\n}\n\n\n1\n2\n3\n4\n\n\nï¼4ï¼åå¹¶å¤ä¸ªå¯¹è±¡\n\nå°å¤ä¸ªå¯¹è±¡åå¹¶å°æä¸ªå¯¹è±¡ã\n\nconst merge =\n  (target, ...sources) => object.assign(target, ...sources);\n\n\n1\n2\n\n\nå¦æå¸æåå¹¶åè¿åä¸ä¸ªæ°å¯¹è±¡ï¼å¯ä»¥æ¹åä¸é¢å½æ°ï¼å¯¹ä¸ä¸ªç©ºå¯¹è±¡åå¹¶ã\n\nconst merge =\n  (...sources) => object.assign({}, ...sources);\n\n\n1\n2\n\n\nï¼5ï¼ä¸ºå±æ§æå®é»è®¤å¼\n\nconst defaults = {\n  loglevel: 0,\n  outputformat: 'html'\n};\n\nfunction processcontent(options) {\n  options = object.assign({}, defaults, options);\n  console.log(options);\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼defaultså¯¹è±¡æ¯é»è®¤å¼ï¼optionså¯¹è±¡æ¯ç¨æ·æä¾çåæ°ãobject.assignæ¹æ³å°defaultsåoptionsåå¹¶æä¸ä¸ªæ°å¯¹è±¡ï¼å¦æä¸¤èæååå±æ§ï¼åoptionsçå±æ§å¼ä¼è¦çdefaultsçå±æ§å¼ã\n\næ³¨æï¼ç±äºå­å¨æµæ·è´çé®é¢ï¼defaultså¯¹è±¡åoptionså¯¹è±¡çææå±æ§çå¼ï¼æå¥½é½æ¯ç®åç±»åï¼ä¸è¦æåå¦ä¸ä¸ªå¯¹è±¡ãå¦åï¼defaultså¯¹è±¡çè¯¥å±æ§å¾å¯è½ä¸èµ·ä½ç¨ã\n\nconst defaults = {\n  url: {\n    host: 'example.com',\n    port: 7070\n  },\n};\n\nprocesscontent({ url: {port: 8000} })\n// {\n//   url: {port: 8000}\n// }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç çåææ¯å°url.portæ¹æ 8000ï¼url.hostä¸åãå®éç»æå´æ¯options.urlè¦çædefaults.urlï¼æä»¥url.hostå°±ä¸å­å¨äºã\n\n\n# object.getownpropertydescriptors()\n\nes5 çobject.getownpropertydescriptor()æ¹æ³ä¼è¿åæä¸ªå¯¹è±¡å±æ§çæè¿°å¯¹è±¡ï¼descriptorï¼ães2017 å¼å¥äºobject.getownpropertydescriptors()æ¹æ³ï¼è¿åæå®å¯¹è±¡ææèªèº«å±æ§ï¼éç»§æ¿å±æ§ï¼çæè¿°å¯¹è±¡ã\n\nconst obj = {\n  foo: 123,\n  get bar() { return 'abc' }\n};\n\nobject.getownpropertydescriptors(obj)\n// { foo:\n//    { value: 123,\n//      writable: true,\n//      enumerable: true,\n//      configurable: true },\n//   bar:\n//    { get: [function: get bar],\n//      set: undefined,\n//      enumerable: true,\n//      configurable: true } }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼object.getownpropertydescriptors()æ¹æ³è¿åä¸ä¸ªå¯¹è±¡ï¼ææåå¯¹è±¡çå±æ§åé½æ¯è¯¥å¯¹è±¡çå±æ§åï¼å¯¹åºçå±æ§å¼å°±æ¯è¯¥å±æ§çæè¿°å¯¹è±¡ã\n\nè¯¥æ¹æ³çå®ç°éå¸¸å®¹æã\n\nfunction getownpropertydescriptors(obj) {\n  const result = {};\n  for (let key of reflect.ownkeys(obj)) {\n    result[key] = object.getownpropertydescriptor(obj, key);\n  }\n  return result;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¯¥æ¹æ³çå¼å¥ç®çï¼ä¸»è¦æ¯ä¸ºäºè§£å³object.assign()æ æ³æ­£ç¡®æ·è´getå±æ§åsetå±æ§çé®é¢ã\n\nconst source = {\n  set foo(value) {\n    console.log(value);\n  }\n};\n\nconst target1 = {};\nobject.assign(target1, source);\n\nobject.getownpropertydescriptor(target1, 'foo')\n// { value: undefined,\n//   writable: true,\n//   enumerable: true,\n//   configurable: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼sourceå¯¹è±¡çfooå±æ§çå¼æ¯ä¸ä¸ªèµå¼å½æ°ï¼object.assignæ¹æ³å°è¿ä¸ªå±æ§æ·è´ç»target1å¯¹è±¡ï¼ç»æè¯¥å±æ§çå¼åæäºundefinedãè¿æ¯å ä¸ºobject.assignæ¹æ³æ»æ¯æ·è´ä¸ä¸ªå±æ§çå¼ï¼èä¸ä¼æ·è´å®èåçèµå¼æ¹æ³æåå¼æ¹æ³ã\n\nè¿æ¶ï¼object.getownpropertydescriptors()æ¹æ³éåobject.defineproperties()æ¹æ³ï¼å°±å¯ä»¥å®ç°æ­£ç¡®æ·è´ã\n\nconst source = {\n  set foo(value) {\n    console.log(value);\n  }\n};\n\nconst target2 = {};\nobject.defineproperties(target2, object.getownpropertydescriptors(source));\nobject.getownpropertydescriptor(target2, 'foo')\n// { get: undefined,\n//   set: [function: set foo],\n//   enumerable: true,\n//   configurable: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸¤ä¸ªå¯¹è±¡åå¹¶çé»è¾å¯ä»¥åæä¸ä¸ªå½æ°ã\n\nconst shallowmerge = (target, source) => object.defineproperties(\n  target,\n  object.getownpropertydescriptors(source)\n);\n\n\n1\n2\n3\n4\n\n\nobject.getownpropertydescriptors()æ¹æ³çå¦ä¸ä¸ªç¨å¤ï¼æ¯éåobject.create()æ¹æ³ï¼å°å¯¹è±¡å±æ§åéå°ä¸ä¸ªæ°å¯¹è±¡ãè¿å±äºæµæ·è´ã\n\nconst clone = object.create(object.getprototypeof(obj),\n  object.getownpropertydescriptors(obj));\n\n// æè\n\nconst shallowclone = (obj) => object.create(\n  object.getprototypeof(obj),\n  object.getownpropertydescriptors(obj)\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¼åéå¯¹è±¡objã\n\nå¦å¤ï¼object.getownpropertydescriptors()æ¹æ³å¯ä»¥å®ç°ä¸ä¸ªå¯¹è±¡ç»§æ¿å¦ä¸ä¸ªå¯¹è±¡ãä»¥åï¼ç»§æ¿å¦ä¸ä¸ªå¯¹è±¡ï¼å¸¸å¸¸åæä¸é¢è¿æ ·ã\n\nconst obj = {\n  __proto__: prot,\n  foo: 123,\n};\n\n\n1\n2\n3\n4\n\n\nes6 è§å®__proto__åªææµè§å¨è¦é¨ç½²ï¼å¶ä»ç¯å¢ä¸ç¨é¨ç½²ãå¦æå»é¤__proto__ï¼ä¸é¢ä»£ç å°±è¦æ¹æä¸é¢è¿æ ·ã\n\nconst obj = object.create(prot);\nobj.foo = 123;\n\n// æè\n\nconst obj = object.assign(\n  object.create(prot),\n  {\n    foo: 123,\n  }\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\næäºobject.getownpropertydescriptors()ï¼æä»¬å°±æäºå¦ä¸ç§åæ³ã\n\nconst obj = object.create(\n  prot,\n  object.getownpropertydescriptors({\n    foo: 123,\n  })\n);\n\n\n1\n2\n3\n4\n5\n6\n\n\nobject.getownpropertydescriptors()ä¹å¯ä»¥ç¨æ¥å®ç° mixinï¼æ··å¥ï¼æ¨¡å¼ã\n\nlet mix = (object) => ({\n  with: (...mixins) => mixins.reduce(\n    (c, mixin) => object.create(\n      c, object.getownpropertydescriptors(mixin)\n    ), object)\n});\n\n// multiple mixins example\nlet a = {a: 'a'};\nlet b = {b: 'b'};\nlet c = {c: 'c'};\nlet d = mix(c).with(a, b);\n\nd.c // \"c\"\nd.b // \"b\"\nd.a // \"a\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç è¿åä¸ä¸ªæ°çå¯¹è±¡dï¼ä»£è¡¨äºå¯¹è±¡aåbè¢«æ··å¥äºå¯¹è±¡cçæä½ã\n\nåºäºå®æ´æ§çèèï¼object.getownpropertydescriptors()è¿å¥æ åä»¥åï¼ä»¥åè¿ä¼æ°å¢reflect.getownpropertydescriptors()æ¹æ³ã\n\n\n# __proto__å±æ§ï¼object.setprototypeof()ï¼object.getprototypeof()\n\njavascript è¯­è¨çå¯¹è±¡ç»§æ¿æ¯éè¿ååé¾å®ç°çães6 æä¾äºæ´å¤ååå¯¹è±¡çæä½æ¹æ³ã\n\n\n# __proto__å±æ§\n\n__proto__å±æ§ï¼åååä¸¤ä¸ªä¸åçº¿ï¼ï¼ç¨æ¥è¯»åæè®¾ç½®å½åå¯¹è±¡çprototypeå¯¹è±¡ãç®åï¼æææµè§å¨ï¼åæ¬ ie11ï¼é½é¨ç½²äºè¿ä¸ªå±æ§ã\n\n// es5 çåæ³\nconst obj = {\n  method: function() { ... }\n};\nobj.__proto__ = someotherobj;\n\n// es6 çåæ³\nvar obj = object.create(someotherobj);\nobj.method = function() { ... };\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nè¯¥å±æ§æ²¡æåå¥ es6 çæ­£æï¼èæ¯åå¥äºéå½ï¼åå æ¯__proto__ååçåä¸åçº¿ï¼è¯´æå®æ¬è´¨ä¸æ¯ä¸ä¸ªåé¨å±æ§ï¼èä¸æ¯ä¸ä¸ªæ­£å¼çå¯¹å¤ç apiï¼åªæ¯ç±äºæµè§å¨å¹¿æ³æ¯æï¼æè¢«å å¥äº es6ãæ åæç¡®è§å®ï¼åªææµè§å¨å¿é¡»é¨ç½²è¿ä¸ªå±æ§ï¼å¶ä»è¿è¡ç¯å¢ä¸ä¸å®éè¦é¨ç½²ï¼èä¸æ°çä»£ç æå¥½è®¤ä¸ºè¿ä¸ªå±æ§æ¯ä¸å­å¨çãå æ­¤ï¼æ è®ºä»è¯­ä¹çè§åº¦ï¼è¿æ¯ä»å¼å®¹æ§çè§åº¦ï¼é½ä¸è¦ä½¿ç¨è¿ä¸ªå±æ§ï¼èæ¯ä½¿ç¨ä¸é¢çobject.setprototypeof()ï¼åæä½ï¼ãobject.getprototypeof()ï¼è¯»æä½ï¼ãobject.create()ï¼çææä½ï¼ä»£æ¿ã\n\nå®ç°ä¸ï¼__proto__è°ç¨çæ¯object.prototype.__proto__ï¼å·ä½å®ç°å¦ä¸ã\n\nobject.defineproperty(object.prototype, '__proto__', {\n  get() {\n    let _thisobj = object(this);\n    return object.getprototypeof(_thisobj);\n  },\n  set(proto) {\n    if (this === undefined || this === null) {\n      throw new typeerror();\n    }\n    if (!isobject(this)) {\n      return undefined;\n    }\n    if (!isobject(proto)) {\n      return undefined;\n    }\n    let status = reflect.setprototypeof(this, proto);\n    if (!status) {\n      throw new typeerror();\n    }\n  },\n});\n\nfunction isobject(value) {\n  return object(value) === value;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nå¦æä¸ä¸ªå¯¹è±¡æ¬èº«é¨ç½²äº__proto__å±æ§ï¼è¯¥å±æ§çå¼å°±æ¯å¯¹è±¡çååã\n\nobject.getprototypeof({ __proto__: null })\n// null\n\n\n1\n2\n\n\n\n# object.setprototypeof()\n\nobject.setprototypeofæ¹æ³çä½ç¨ä¸__proto__ç¸åï¼ç¨æ¥è®¾ç½®ä¸ä¸ªå¯¹è±¡çprototypeå¯¹è±¡ï¼è¿ååæ°å¯¹è±¡æ¬èº«ãå®æ¯ es6 æ­£å¼æ¨èçè®¾ç½®ååå¯¹è±¡çæ¹æ³ã\n\n// æ ¼å¼\nobject.setprototypeof(object, prototype)\n\n// ç¨æ³\nconst o = object.setprototypeof({}, null);\n\n\n1\n2\n3\n4\n5\n\n\nè¯¥æ¹æ³ç­åäºä¸é¢çå½æ°ã\n\nfunction setprototypeof(obj, proto) {\n  obj.__proto__ = proto;\n  return obj;\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nlet proto = {};\nlet obj = { x: 10 };\nobject.setprototypeof(obj, proto);\n\nproto.y = 20;\nproto.z = 40;\n\nobj.x // 10\nobj.y // 20\nobj.z // 40\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å°protoå¯¹è±¡è®¾ä¸ºobjå¯¹è±¡çååï¼æä»¥ä»objå¯¹è±¡å¯ä»¥è¯»åprotoå¯¹è±¡çå±æ§ã\n\nå¦æç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼ä¼èªå¨è½¬ä¸ºå¯¹è±¡ãä½æ¯ç±äºè¿åçè¿æ¯ç¬¬ä¸ä¸ªåæ°ï¼æä»¥è¿ä¸ªæä½ä¸ä¼äº§çä»»ä½ææã\n\nobject.setprototypeof(1, {}) === 1 // true\nobject.setprototypeof('foo', {}) === 'foo' // true\nobject.setprototypeof(true, {}) === true // true\n\n\n1\n2\n3\n\n\nç±äºundefinedånullæ æ³è½¬ä¸ºå¯¹è±¡ï¼æä»¥å¦æç¬¬ä¸ä¸ªåæ°æ¯undefinedænullï¼å°±ä¼æ¥éã\n\nobject.setprototypeof(undefined, {})\n// typeerror: object.setprototypeof called on null or undefined\n\nobject.setprototypeof(null, {})\n// typeerror: object.setprototypeof called on null or undefined\n\n\n1\n2\n3\n4\n5\n\n\n\n# object.getprototypeof()\n\nè¯¥æ¹æ³ä¸object.setprototypeofæ¹æ³éå¥ï¼ç¨äºè¯»åä¸ä¸ªå¯¹è±¡çååå¯¹è±¡ã\n\nobject.getprototypeof(obj);\n\n\n1\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nfunction rectangle() {\n  // ...\n}\n\nconst rec = new rectangle();\n\nobject.getprototypeof(rec) === rectangle.prototype\n// true\n\nobject.setprototypeof(rec, object.prototype);\nobject.getprototypeof(rec) === rectangle.prototype\n// false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå¦æåæ°ä¸æ¯å¯¹è±¡ï¼ä¼è¢«èªå¨è½¬ä¸ºå¯¹è±¡ã\n\n// ç­åäº object.getprototypeof(number(1))\nobject.getprototypeof(1)\n// number {[[primitivevalue]]: 0}\n\n// ç­åäº object.getprototypeof(string('foo'))\nobject.getprototypeof('foo')\n// string {length: 0, [[primitivevalue]]: \"\"}\n\n// ç­åäº object.getprototypeof(boolean(true))\nobject.getprototypeof(true)\n// boolean {[[primitivevalue]]: false}\n\nobject.getprototypeof(1) === number.prototype // true\nobject.getprototypeof('foo') === string.prototype // true\nobject.getprototypeof(true) === boolean.prototype // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå¦æåæ°æ¯undefinedænullï¼å®ä»¬æ æ³è½¬ä¸ºå¯¹è±¡ï¼æä»¥ä¼æ¥éã\n\nobject.getprototypeof(null)\n// typeerror: cannot convert undefined or null to object\n\nobject.getprototypeof(undefined)\n// typeerror: cannot convert undefined or null to object\n\n\n1\n2\n3\n4\n5\n\n\n\n# object.keys()ï¼object.values()ï¼object.entries()\n\n\n# object.keys()\n\nes5 å¼å¥äºobject.keysæ¹æ³ï¼è¿åä¸ä¸ªæ°ç»ï¼æåæ¯åæ°å¯¹è±¡èªèº«çï¼ä¸å«ç»§æ¿çï¼ææå¯éåï¼enumerableï¼å±æ§çé®åã\n\nvar obj = { foo: 'bar', baz: 42 };\nobject.keys(obj)\n// [\"foo\", \"baz\"]\n\n\n1\n2\n3\n\n\nes2017 å¼å¥äºè·object.keyséå¥çobject.valuesåobject.entriesï¼ä½ä¸ºéåä¸ä¸ªå¯¹è±¡çè¡¥åææ®µï¼ä¾for...ofå¾ªç¯ä½¿ç¨ã\n\nlet {keys, values, entries} = object;\nlet obj = { a: 1, b: 2, c: 3 };\n\nfor (let key of keys(obj)) {\n  console.log(key); // 'a', 'b', 'c'\n}\n\nfor (let value of values(obj)) {\n  console.log(value); // 1, 2, 3\n}\n\nfor (let [key, value] of entries(obj)) {\n  console.log([key, value]); // ['a', 1], ['b', 2], ['c', 3]\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# object.values()\n\nobject.valuesæ¹æ³è¿åä¸ä¸ªæ°ç»ï¼æåæ¯åæ°å¯¹è±¡èªèº«çï¼ä¸å«ç»§æ¿çï¼ææå¯éåï¼enumerableï¼å±æ§çé®å¼ã\n\nconst obj = { foo: 'bar', baz: 42 };\nobject.values(obj)\n// [\"bar\", 42]\n\n\n1\n2\n3\n\n\nè¿åæ°ç»çæåé¡ºåºï¼ä¸æ¬ç« çãå±æ§çéåãé¨åä»ç»çæåè§åä¸è´ã\n\nconst obj = { 100: 'a', 2: 'b', 7: 'c' };\nobject.values(obj)\n// [\"b\", \"c\", \"a\"]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼å±æ§åä¸ºæ°å¼çå±æ§ï¼æ¯æç§æ°å¼å¤§å°ï¼ä»å°å°å¤§éåçï¼å æ­¤è¿åçé¡ºåºæ¯bãcãaã\n\nobject.valuesåªè¿åå¯¹è±¡èªèº«çå¯éåå±æ§ã\n\nconst obj = object.create({}, {p: {value: 42}});\nobject.values(obj) // []\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼object.createæ¹æ³çç¬¬äºä¸ªåæ°æ·»å çå¯¹è±¡å±æ§ï¼å±æ§pï¼ï¼å¦æä¸æ¾å¼å£°æï¼é»è®¤æ¯ä¸å¯éåçï¼å ä¸ºpçå±æ§æè¿°å¯¹è±¡çenumerableé»è®¤æ¯falseï¼object.valuesä¸ä¼è¿åè¿ä¸ªå±æ§ãåªè¦æenumerableæ¹ætrueï¼object.valueså°±ä¼è¿åå±æ§pçå¼ã\n\nconst obj = object.create({}, {p:\n  {\n    value: 42,\n    enumerable: true\n  }\n});\nobject.values(obj) // [42]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nobject.valuesä¼è¿æ»¤å±æ§åä¸º symbol å¼çå±æ§ã\n\nobject.values({ [symbol()]: 123, foo: 'abc' });\n// ['abc']\n\n\n1\n2\n\n\nå¦æobject.valuesæ¹æ³çåæ°æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼ä¼è¿ååä¸ªå­ç¬¦ç»æçä¸ä¸ªæ°ç»ã\n\nobject.values('foo')\n// ['f', 'o', 'o']\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç¬¦ä¸²ä¼åè½¬æä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ãå­ç¬¦ä¸²çæ¯ä¸ªå­ç¬¦ï¼å°±æ¯è¯¥å¯¹è±¡çä¸ä¸ªå±æ§ãå æ­¤ï¼object.valuesè¿åæ¯ä¸ªå±æ§çé®å¼ï¼å°±æ¯åä¸ªå­ç¬¦ç»æçä¸ä¸ªæ°ç»ã\n\nå¦æåæ°ä¸æ¯å¯¹è±¡ï¼object.valuesä¼åå°å¶è½¬ä¸ºå¯¹è±¡ãç±äºæ°å¼åå¸å°å¼çåè£å¯¹è±¡ï¼é½ä¸ä¼ä¸ºå®ä¾æ·»å éç»§æ¿çå±æ§ãæä»¥ï¼object.valuesä¼è¿åç©ºæ°ç»ã\n\nobject.values(42) // []\nobject.values(true) // []\n\n\n1\n2\n\n\n\n# object.entries()\n\nobject.entries()æ¹æ³è¿åä¸ä¸ªæ°ç»ï¼æåæ¯åæ°å¯¹è±¡èªèº«çï¼ä¸å«ç»§æ¿çï¼ææå¯éåï¼enumerableï¼å±æ§çé®å¼å¯¹æ°ç»ã\n\nconst obj = { foo: 'bar', baz: 42 };\nobject.entries(obj)\n// [ [\"foo\", \"bar\"], [\"baz\", 42] ]\n\n\n1\n2\n3\n\n\né¤äºè¿åå¼ä¸ä¸æ ·ï¼è¯¥æ¹æ³çè¡ä¸ºä¸object.valuesåºæ¬ä¸è´ã\n\nå¦æåå¯¹è±¡çå±æ§åæ¯ä¸ä¸ª symbol å¼ï¼è¯¥å±æ§ä¼è¢«å¿½ç¥ã\n\nobject.entries({ [symbol()]: 123, foo: 'abc' });\n// [ [ 'foo', 'abc' ] ]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼åå¯¹è±¡æä¸¤ä¸ªå±æ§ï¼object.entriesåªè¾åºå±æ§åé symbol å¼çå±æ§ãå°æ¥å¯è½ä¼æreflect.ownentries()æ¹æ³ï¼è¿åå¯¹è±¡èªèº«çææå±æ§ã\n\nobject.entriesçåºæ¬ç¨éæ¯éåå¯¹è±¡çå±æ§ã\n\nlet obj = { one: 1, two: 2 };\nfor (let [k, v] of object.entries(obj)) {\n  console.log(\n    `${json.stringify(k)}: ${json.stringify(v)}`\n  );\n}\n// \"one\": 1\n// \"two\": 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nobject.entriesæ¹æ³çå¦ä¸ä¸ªç¨å¤æ¯ï¼å°å¯¹è±¡è½¬ä¸ºçæ­£çmapç»æã\n\nconst obj = { foo: 'bar', baz: 42 };\nconst map = new map(object.entries(obj));\nmap // map { foo: \"bar\", baz: 42 }\n\n\n1\n2\n3\n\n\nèªå·±å®ç°object.entriesæ¹æ³ï¼éå¸¸ç®åã\n\n// generatorå½æ°ççæ¬\nfunction* entries(obj) {\n  for (let key of object.keys(obj)) {\n    yield [key, obj[key]];\n  }\n}\n\n// égeneratorå½æ°ççæ¬\nfunction entries(obj) {\n  let arr = [];\n  for (let key of object.keys(obj)) {\n    arr.push([key, obj[key]]);\n  }\n  return arr;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# object.fromentries()\n\nobject.fromentries()æ¹æ³æ¯object.entries()çéæä½ï¼ç¨äºå°ä¸ä¸ªé®å¼å¯¹æ°ç»è½¬ä¸ºå¯¹è±¡ã\n\nobject.fromentries([\n  ['foo', 'bar'],\n  ['baz', 42]\n])\n// { foo: \"bar\", baz: 42 }\n\n\n1\n2\n3\n4\n5\n\n\nè¯¥æ¹æ³çä¸»è¦ç®çï¼æ¯å°é®å¼å¯¹çæ°æ®ç»æè¿åä¸ºå¯¹è±¡ï¼å æ­¤ç¹å«éåå° map ç»æè½¬ä¸ºå¯¹è±¡ã\n\n// ä¾ä¸\nconst entries = new map([\n  ['foo', 'bar'],\n  ['baz', 42]\n]);\n\nobject.fromentries(entries)\n// { foo: \"bar\", baz: 42 }\n\n// ä¾äº\nconst map = new map().set('foo', true).set('bar', false);\nobject.fromentries(map)\n// { foo: true, bar: false }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nè¯¥æ¹æ³çä¸ä¸ªç¨å¤æ¯éåurlsearchparamså¯¹è±¡ï¼å°æ¥è¯¢å­ç¬¦ä¸²è½¬ä¸ºå¯¹è±¡ã\n\nobject.fromentries(new urlsearchparams('foo=bar&baz=qux'))\n// { foo: \"bar\", baz: \"qux\" }\n\n\n1\n2\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"å­ç¬¦ä¸²çæ©å±",frontmatter:{title:"å­ç¬¦ä¸²çæ©å±",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/ca89eca8adeba5f4",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/04.%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%89%A9%E5%B1%95.html",relativePath:"ãES6 æç¨ãç¬è®°/04.å­ç¬¦ä¸²çæ©å±.md",key:"v-0a300e27",path:"/pages/ca89eca8adeba5f4/",headers:[{level:2,title:"å­ç¬¦ç Unicode è¡¨ç¤ºæ³",slug:"å­ç¬¦ç-unicode-è¡¨ç¤ºæ³",normalizedTitle:"å­ç¬¦ç unicode è¡¨ç¤ºæ³",charIndex:51},{level:2,title:"å­ç¬¦ä¸²çéåå¨æ¥å£",slug:"å­ç¬¦ä¸²çéåå¨æ¥å£",normalizedTitle:"å­ç¬¦ä¸²çéåå¨æ¥å£",charIndex:786},{level:2,title:"ç´æ¥è¾å¥ U+2028 å U+2029",slug:"ç´æ¥è¾å¥-u-2028-å-u-2029",normalizedTitle:"ç´æ¥è¾å¥ u+2028 å u+2029",charIndex:1281},{level:2,title:"JSON.stringify() çæ¹é ",slug:"json-stringify-çæ¹é ",normalizedTitle:"json.stringify() çæ¹é ",charIndex:2078},{level:2,title:"æ¨¡æ¿å­ç¬¦ä¸²",slug:"æ¨¡æ¿å­ç¬¦ä¸²",normalizedTitle:"æ¨¡æ¿å­ç¬¦ä¸²",charIndex:1998},{level:2,title:"å®ä¾ï¼æ¨¡æ¿ç¼è¯",slug:"å®ä¾-æ¨¡æ¿ç¼è¯",normalizedTitle:"å®ä¾ï¼æ¨¡æ¿ç¼è¯",charIndex:5433},{level:2,title:"æ ç­¾æ¨¡æ¿",slug:"æ ç­¾æ¨¡æ¿",normalizedTitle:"æ ç­¾æ¨¡æ¿",charIndex:7163},{level:2,title:"æ¨¡æ¿å­ç¬¦ä¸²çéå¶",slug:"æ¨¡æ¿å­ç¬¦ä¸²çéå¶",normalizedTitle:"æ¨¡æ¿å­ç¬¦ä¸²çéå¶",charIndex:11475}],excerpt:'<h1 id="å­ç¬¦ä¸²çæ©å±"><a class="header-anchor" href="#å­ç¬¦ä¸²çæ©å±">#</a> å­ç¬¦ä¸²çæ©å±</h1>\n<p>æ¬ç« ä»ç» ES6 å¯¹å­ç¬¦ä¸²çæ¹é åå¢å¼ºï¼ä¸ä¸ç« ä»ç»å­ç¬¦ä¸²å¯¹è±¡çæ°å¢æ¹æ³ã</p>\n<h2 id="å­ç¬¦ç-unicode-è¡¨ç¤ºæ³"><a class="header-anchor" href="#å­ç¬¦ç-unicode-è¡¨ç¤ºæ³">#</a> å­ç¬¦ç Unicode è¡¨ç¤ºæ³</h2>\n<p>ES6 å å¼ºäºå¯¹ Unicode çæ¯æï¼åè®¸éç¨<code>\\uxxxx</code>å½¢å¼è¡¨ç¤ºä¸ä¸ªå­ç¬¦ï¼å¶ä¸­<code>xxxx</code>è¡¨ç¤ºå­ç¬¦ç Unicode ç ç¹ã</p>\n\x3c!--beforebegin--\x3e<div class="language-javascript line-numbers-mode">\x3c!--afterbegin--\x3e<pre v-pre class="language-javascript"><code><span class="token string">"\\u0061"</span>\n<span class="token comment">// "a"</span>\n</code></pre>\n<div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div>\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e',headersStr:"å­ç¬¦ç Unicode è¡¨ç¤ºæ³ å­ç¬¦ä¸²çéåå¨æ¥å£ ç´æ¥è¾å¥ U+2028 å U+2029 JSON.stringify() çæ¹é  æ¨¡æ¿å­ç¬¦ä¸² å®ä¾ï¼æ¨¡æ¿ç¼è¯ æ ç­¾æ¨¡æ¿ æ¨¡æ¿å­ç¬¦ä¸²çéå¶",content:"# å­ç¬¦ä¸²çæ©å±\n\næ¬ç« ä»ç» ES6 å¯¹å­ç¬¦ä¸²çæ¹é åå¢å¼ºï¼ä¸ä¸ç« ä»ç»å­ç¬¦ä¸²å¯¹è±¡çæ°å¢æ¹æ³ã\n\n\n# å­ç¬¦ç Unicode è¡¨ç¤ºæ³\n\nES6 å å¼ºäºå¯¹ Unicode çæ¯æï¼åè®¸éç¨\\uxxxxå½¢å¼è¡¨ç¤ºä¸ä¸ªå­ç¬¦ï¼å¶ä¸­xxxxè¡¨ç¤ºå­ç¬¦ç Unicode ç ç¹ã\n\n\"\\u0061\"\n// \"a\"\n\n\n1\n2\n\n\nä½æ¯ï¼è¿ç§è¡¨ç¤ºæ³åªéäºç ç¹å¨\\u0000~\\uFFFFä¹é´çå­ç¬¦ãè¶åºè¿ä¸ªèå´çå­ç¬¦ï¼å¿é¡»ç¨ä¸¤ä¸ªåå­èçå½¢å¼è¡¨ç¤ºã\n\n\"\\uD842\\uDFB7\"\n// \"ð ®·\"\n\n\"\\u20BB7\"\n// \" 7\"\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼å¦æç´æ¥å¨\\uåé¢è·ä¸è¶è¿0xFFFFçæ°å¼ï¼æ¯å¦\\u20BB7ï¼ï¼JavaScript ä¼çè§£æ\\u20BB+7ãç±äº\\u20BBæ¯ä¸ä¸ªä¸å¯æå°å­ç¬¦ï¼æä»¥åªä¼æ¾ç¤ºä¸ä¸ªç©ºæ ¼ï¼åé¢è·çä¸ä¸ª7ã\n\nES6 å¯¹è¿ä¸ç¹ååºäºæ¹è¿ï¼åªè¦å°ç ç¹æ¾å¥å¤§æ¬å·ï¼å°±è½æ­£ç¡®è§£è¯»è¯¥å­ç¬¦ã\n\n\"\\u{20BB7}\"\n// \"ð ®·\"\n\n\"\\u{41}\\u{42}\\u{43}\"\n// \"ABC\"\n\nlet hello = 123;\nhell\\u{6F} // 123\n\n'\\u{1F680}' === '\\uD83D\\uDE80'\n// true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼æåä¸ä¸ªä¾å­è¡¨æï¼å¤§æ¬å·è¡¨ç¤ºæ³ä¸åå­èç UTF-16 ç¼ç æ¯ç­ä»·çã\n\næäºè¿ç§è¡¨ç¤ºæ³ä¹åï¼JavaScript å±æ 6 ç§æ¹æ³å¯ä»¥è¡¨ç¤ºä¸ä¸ªå­ç¬¦ã\n\n'\\z' === 'z'  // true\n'\\172' === 'z' // true\n'\\x7A' === 'z' // true\n'\\u007A' === 'z' // true\n'\\u{7A}' === 'z' // true\n\n\n1\n2\n3\n4\n5\n\n\n\n# å­ç¬¦ä¸²çéåå¨æ¥å£\n\nES6 ä¸ºå­ç¬¦ä¸²æ·»å äºéåå¨æ¥å£ï¼è¯¦è§ãIteratorãä¸ç« ï¼ï¼ä½¿å¾å­ç¬¦ä¸²å¯ä»¥è¢«for...ofå¾ªç¯éåã\n\nfor (let codePoint of 'foo') {\n  console.log(codePoint)\n}\n// \"f\"\n// \"o\"\n// \"o\"\n\n\n1\n2\n3\n4\n5\n6\n\n\né¤äºéåå­ç¬¦ä¸²ï¼è¿ä¸ªéåå¨æå¤§çä¼ç¹æ¯å¯ä»¥è¯å«å¤§äº0xFFFFçç ç¹ï¼ä¼ ç»çforå¾ªç¯æ æ³è¯å«è¿æ ·çç ç¹ã\n\nlet text = String.fromCodePoint(0x20BB7);\n\nfor (let i = 0; i < text.length; i++) {\n  console.log(text[i]);\n}\n// \" \"\n// \" \"\n\nfor (let i of text) {\n  console.log(i);\n}\n// \"ð ®·\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç¬¦ä¸²textåªæä¸ä¸ªå­ç¬¦ï¼ä½æ¯forå¾ªç¯ä¼è®¤ä¸ºå®åå«ä¸¤ä¸ªå­ç¬¦ï¼é½ä¸å¯æå°ï¼ï¼èfor...ofå¾ªç¯ä¼æ­£ç¡®è¯å«åºè¿ä¸ä¸ªå­ç¬¦ã\n\n\n# ç´æ¥è¾å¥ U+2028 å U+2029\n\nJavaScript å­ç¬¦ä¸²åè®¸ç´æ¥è¾å¥å­ç¬¦ï¼ä»¥åè¾å¥å­ç¬¦çè½¬ä¹å½¢å¼ãä¸¾ä¾æ¥è¯´ï¼âä¸­âç Unicode ç ç¹æ¯ U+4e2dï¼ä½ å¯ä»¥ç´æ¥å¨å­ç¬¦ä¸²éé¢è¾å¥è¿ä¸ªæ±å­ï¼ä¹å¯ä»¥è¾å¥å®çè½¬ä¹å½¢å¼\\u4e2dï¼ä¸¤èæ¯ç­ä»·çã\n\n'ä¸­' === '\\u4e2d' // true\n\n\n1\n\n\nä½æ¯ï¼JavaScript è§å®æ5ä¸ªå­ç¬¦ï¼ä¸è½å¨å­ç¬¦ä¸²éé¢ç´æ¥ä½¿ç¨ï¼åªè½ä½¿ç¨è½¬ä¹å½¢å¼ã\n\n * U+005Cï¼åææ ï¼reverse solidus)\n * U+000Dï¼åè½¦ï¼carriage returnï¼\n * U+2028ï¼è¡åéç¬¦ï¼line separatorï¼\n * U+2029ï¼æ®µåéç¬¦ï¼paragraph separatorï¼\n * U+000Aï¼æ¢è¡ç¬¦ï¼line feedï¼\n\nä¸¾ä¾æ¥è¯´ï¼å­ç¬¦ä¸²éé¢ä¸è½ç´æ¥åå«åææ ï¼ä¸å®è¦è½¬ä¹åæ\\\\æè\\u005cã\n\nè¿ä¸ªè§å®æ¬èº«æ²¡æé®é¢ï¼éº»ç¦å¨äº JSON æ ¼å¼åè®¸å­ç¬¦ä¸²éé¢ç´æ¥ä½¿ç¨ U+2028ï¼è¡åéç¬¦ï¼å U+2029ï¼æ®µåéç¬¦ï¼ãè¿æ ·ä¸æ¥ï¼æå¡å¨è¾åºç JSON è¢«JSON.parseè§£æï¼å°±æå¯è½ç´æ¥æ¥éã\n\nconst json = '\"\\u2028\"';\nJSON.parse(json); // å¯è½æ¥é\n\n\n1\n2\n\n\nJSON æ ¼å¼å·²ç»å»ç»ï¼RFC 7159ï¼ï¼æ²¡æ³ä¿®æ¹äºãä¸ºäºæ¶é¤è¿ä¸ªæ¥éï¼ES2019 åè®¸ JavaScript å­ç¬¦ä¸²ç´æ¥è¾å¥ U+2028ï¼è¡åéç¬¦ï¼å U+2029ï¼æ®µåéç¬¦ï¼ã\n\nconst PS = eval(\"'\\u2029'\");\n\n\n1\n\n\næ ¹æ®è¿ä¸ªææ¡ï¼ä¸é¢çä»£ç ä¸ä¼æ¥éã\n\næ³¨æï¼æ¨¡æ¿å­ç¬¦ä¸²ç°å¨å°±åè®¸ç´æ¥è¾å¥è¿ä¸¤ä¸ªå­ç¬¦ãå¦å¤ï¼æ­£åè¡¨è¾¾å¼ä¾ç¶ä¸åè®¸ç´æ¥è¾å¥è¿ä¸¤ä¸ªå­ç¬¦ï¼è¿æ¯æ²¡æé®é¢çï¼å ä¸º JSON æ¬æ¥å°±ä¸åè®¸ç´æ¥åå«æ­£åè¡¨è¾¾å¼ã\n\n\n# JSON.stringify() çæ¹é \n\næ ¹æ®æ åï¼JSON æ°æ®å¿é¡»æ¯ UTF-8 ç¼ç ãä½æ¯ï¼ç°å¨çJSON.stringify()æ¹æ³æå¯è½è¿åä¸ç¬¦å UTF-8 æ åçå­ç¬¦ä¸²ã\n\nå·ä½æ¥è¯´ï¼UTF-8 æ åè§å®ï¼0xD800å°0xDFFFä¹é´çç ç¹ï¼ä¸è½åç¬ä½¿ç¨ï¼å¿é¡»éå¯¹ä½¿ç¨ãæ¯å¦ï¼\\uD834\\uDF06æ¯ä¸¤ä¸ªç ç¹ï¼ä½æ¯å¿é¡»æ¾å¨ä¸èµ·éå¯¹ä½¿ç¨ï¼ä»£è¡¨å­ç¬¦ðãè¿æ¯ä¸ºäºè¡¨ç¤ºç ç¹å¤§äº0xFFFFçå­ç¬¦çä¸ç§åéæ¹æ³ãåç¬ä½¿ç¨\\uD834å\\uDFO6è¿ä¸¤ä¸ªç ç¹æ¯ä¸åæ³çï¼æèé¢ åé¡ºåºä¹ä¸è¡ï¼å ä¸º\\uDF06\\uD834å¹¶æ²¡æå¯¹åºçå­ç¬¦ã\n\nJSON.stringify()çé®é¢å¨äºï¼å®å¯è½è¿å0xD800å°0xDFFFä¹é´çåä¸ªç ç¹ã\n\nJSON.stringify('\\u{D834}') // \"\\u{D834}\"\n\n\n1\n\n\nä¸ºäºç¡®ä¿è¿åçæ¯åæ³ç UTF-8 å­ç¬¦ï¼ES2019 æ¹åäºJSON.stringify()çè¡ä¸ºãå¦æéå°0xD800å°0xDFFFä¹é´çåä¸ªç ç¹ï¼æèä¸å­å¨çéå¯¹å½¢å¼ï¼å®ä¼è¿åè½¬ä¹å­ç¬¦ä¸²ï¼çç»åºç¨èªå·±å³å®ä¸ä¸æ­¥çå¤çã\n\nJSON.stringify('\\u{D834}') // \"\"\\\\uD834\"\"\nJSON.stringify('\\uDF06\\uD834') // \"\"\\\\udf06\\\\ud834\"\"\n\n\n1\n2\n\n\n\n# æ¨¡æ¿å­ç¬¦ä¸²\n\nä¼ ç»ç JavaScript è¯­è¨ï¼è¾åºæ¨¡æ¿éå¸¸æ¯è¿æ ·åçï¼ä¸é¢ä½¿ç¨äº jQuery çæ¹æ³ï¼ã\n\n$('#result').append(\n  'There are <b>' + basket.count + '</b> ' +\n  'items in your basket, ' +\n  '<em>' + basket.onSale +\n  '</em> are on sale!'\n);\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢è¿ç§åæ³ç¸å½ç¹çä¸æ¹ä¾¿ï¼ES6 å¼å¥äºæ¨¡æ¿å­ç¬¦ä¸²è§£å³è¿ä¸ªé®é¢ã\n\n$('#result').append(`\n  There are <b>${basket.count}</b> items\n   in your basket, <em>${basket.onSale}</em>\n  are on sale!\n`);\n\n\n1\n2\n3\n4\n5\n\n\næ¨¡æ¿å­ç¬¦ä¸²ï¼template stringï¼æ¯å¢å¼ºççå­ç¬¦ä¸²ï¼ç¨åå¼å·ï¼`ï¼æ è¯ãå®å¯ä»¥å½ä½æ®éå­ç¬¦ä¸²ä½¿ç¨ï¼ä¹å¯ä»¥ç¨æ¥å®ä¹å¤è¡å­ç¬¦ä¸²ï¼æèå¨å­ç¬¦ä¸²ä¸­åµå¥åéã\n\n// æ®éå­ç¬¦ä¸²\n`In JavaScript '\\n' is a line-feed.`\n\n// å¤è¡å­ç¬¦ä¸²\n`In JavaScript this is\n not legal.`\n\nconsole.log(`string text line 1\nstring text line 2`);\n\n// å­ç¬¦ä¸²ä¸­åµå¥åé\nlet name = \"Bob\", time = \"today\";\n`Hello ${name}, how are you ${time}?`\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­çæ¨¡æ¿å­ç¬¦ä¸²ï¼é½æ¯ç¨åå¼å·è¡¨ç¤ºãå¦æå¨æ¨¡æ¿å­ç¬¦ä¸²ä¸­éè¦ä½¿ç¨åå¼å·ï¼ååé¢è¦ç¨åææ è½¬ä¹ã\n\nlet greeting = `\\`Yo\\` World!`;\n\n\n1\n\n\nå¦æä½¿ç¨æ¨¡æ¿å­ç¬¦ä¸²è¡¨ç¤ºå¤è¡å­ç¬¦ä¸²ï¼ææçç©ºæ ¼åç¼©è¿é½ä¼è¢«ä¿çå¨è¾åºä¹ä¸­ã\n\n$('#list').html(`\n<ul>\n  <li>first</li>\n  <li>second</li>\n</ul>\n`);\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼æææ¨¡æ¿å­ç¬¦ä¸²çç©ºæ ¼åæ¢è¡ï¼é½æ¯è¢«ä¿ççï¼æ¯å¦<ul>æ ç­¾åé¢ä¼æä¸ä¸ªæ¢è¡ãå¦æä½ ä¸æ³è¦è¿ä¸ªæ¢è¡ï¼å¯ä»¥ä½¿ç¨trimæ¹æ³æ¶é¤å®ã\n\n$('#list').html(`\n<ul>\n  <li>first</li>\n  <li>second</li>\n</ul>\n`.trim());\n\n\n1\n2\n3\n4\n5\n6\n\n\næ¨¡æ¿å­ç¬¦ä¸²ä¸­åµå¥åéï¼éè¦å°åéååå¨${}ä¹ä¸­ã\n\nfunction authorize(user, action) {\n  if (!user.hasPrivilege(action)) {\n    throw new Error(\n      // ä¼ ç»åæ³ä¸º\n      // 'User '\n      // + user.name\n      // + ' is not authorized to do '\n      // + action\n      // + '.'\n      `User ${user.name} is not authorized to do ${action}.`);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå¤§æ¬å·åé¨å¯ä»¥æ¾å¥ä»»æç JavaScript è¡¨è¾¾å¼ï¼å¯ä»¥è¿è¡è¿ç®ï¼ä»¥åå¼ç¨å¯¹è±¡å±æ§ã\n\nlet x = 1;\nlet y = 2;\n\n`${x} + ${y} = ${x + y}`\n// \"1 + 2 = 3\"\n\n`${x} + ${y * 2} = ${x + y * 2}`\n// \"1 + 4 = 5\"\n\nlet obj = {x: 1, y: 2};\n`${obj.x + obj.y}`\n// \"3\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\næ¨¡æ¿å­ç¬¦ä¸²ä¹ä¸­è¿è½è°ç¨å½æ°ã\n\nfunction fn() {\n  return \"Hello World\";\n}\n\n`foo ${fn()} bar`\n// foo Hello World bar\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¦æå¤§æ¬å·ä¸­çå¼ä¸æ¯å­ç¬¦ä¸²ï¼å°æç§ä¸è¬çè§åè½¬ä¸ºå­ç¬¦ä¸²ãæ¯å¦ï¼å¤§æ¬å·ä¸­æ¯ä¸ä¸ªå¯¹è±¡ï¼å°é»è®¤è°ç¨å¯¹è±¡çtoStringæ¹æ³ã\n\nå¦ææ¨¡æ¿å­ç¬¦ä¸²ä¸­çåéæ²¡æå£°æï¼å°æ¥éã\n\n// åéplaceæ²¡æå£°æ\nlet msg = `Hello, ${place}`;\n// æ¥é\n\n\n1\n2\n3\n\n\nç±äºæ¨¡æ¿å­ç¬¦ä¸²çå¤§æ¬å·åé¨ï¼å°±æ¯æ§è¡ JavaScript ä»£ç ï¼å æ­¤å¦æå¤§æ¬å·åé¨æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼å°ä¼åæ ·è¾åºã\n\n`Hello ${'World'}`\n// \"Hello World\"\n\n\n1\n2\n\n\næ¨¡æ¿å­ç¬¦ä¸²çè³è¿è½åµå¥ã\n\nconst tmpl = addrs => `\n  <table>\n  ${addrs.map(addr => `\n    <tr><td>${addr.first}</td></tr>\n    <tr><td>${addr.last}</td></tr>\n  `).join('')}\n  </table>\n`;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¨¡æ¿å­ç¬¦ä¸²çåéä¹ä¸­ï¼ååµå¥äºå¦ä¸ä¸ªæ¨¡æ¿å­ç¬¦ä¸²ï¼ä½¿ç¨æ¹æ³å¦ä¸ã\n\nconst data = [\n    { first: '<Jane>', last: 'Bond' },\n    { first: 'Lars', last: '<Croft>' },\n];\n\nconsole.log(tmpl(data));\n// <table>\n//\n//   <tr><td><Jane></td></tr>\n//   <tr><td>Bond</td></tr>\n//\n//   <tr><td>Lars</td></tr>\n//   <tr><td><Croft></td></tr>\n//\n// </table>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå¦æéè¦å¼ç¨æ¨¡æ¿å­ç¬¦ä¸²æ¬èº«ï¼å¨éè¦æ¶æ§è¡ï¼å¯ä»¥åæå½æ°ã\n\nlet func = (name) => `Hello ${name}!`;\nfunc('Jack') // \"Hello Jack!\"\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¨¡æ¿å­ç¬¦ä¸²åæäºä¸ä¸ªå½æ°çè¿åå¼ãæ§è¡è¿ä¸ªå½æ°ï¼å°±ç¸å½äºæ§è¡è¿ä¸ªæ¨¡æ¿å­ç¬¦ä¸²äºã\n\n\n# å®ä¾ï¼æ¨¡æ¿ç¼è¯\n\nä¸é¢ï¼æä»¬æ¥çä¸ä¸ªéè¿æ¨¡æ¿å­ç¬¦ä¸²ï¼çææ­£å¼æ¨¡æ¿çå®ä¾ã\n\nlet template = `\n<ul>\n  <% for(let i=0; i < data.supplies.length; i++) { %>\n    <li><%= data.supplies[i] %></li>\n  <% } %>\n</ul>\n`;\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç å¨æ¨¡æ¿å­ç¬¦ä¸²ä¹ä¸­ï¼æ¾ç½®äºä¸ä¸ªå¸¸è§æ¨¡æ¿ãè¯¥æ¨¡æ¿ä½¿ç¨<%...%>æ¾ç½® JavaScript ä»£ç ï¼ä½¿ç¨<%= ... %>è¾åº JavaScript è¡¨è¾¾å¼ã\n\næä¹ç¼è¯è¿ä¸ªæ¨¡æ¿å­ç¬¦ä¸²å¢ï¼\n\nä¸ç§æè·¯æ¯å°å¶è½¬æ¢ä¸º JavaScript è¡¨è¾¾å¼å­ç¬¦ä¸²ã\n\necho('<ul>');\nfor(let i=0; i < data.supplies.length; i++) {\n  echo('<li>');\n  echo(data.supplies[i]);\n  echo('</li>');\n};\necho('</ul>');\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¿ä¸ªè½¬æ¢ä½¿ç¨æ­£åè¡¨è¾¾å¼å°±è¡äºã\n\nlet evalExpr = /<%=(.+?)%>/g;\nlet expr = /<%([\\s\\S]+?)%>/g;\n\ntemplate = template\n  .replace(evalExpr, '`); \\n  echo( $1 ); \\n  echo(`')\n  .replace(expr, '`); \\n $1 \\n  echo(`');\n\ntemplate = 'echo(`' + template + '`);';\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nç¶åï¼å°templateå°è£å¨ä¸ä¸ªå½æ°éé¢è¿åï¼å°±å¯ä»¥äºã\n\nlet script =\n`(function parse(data){\n  let output = \"\";\n\n  function echo(html){\n    output += html;\n  }\n\n  ${ template }\n\n  return output;\n})`;\n\nreturn script;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nå°ä¸é¢çåå®¹æ¼è£æä¸ä¸ªæ¨¡æ¿ç¼è¯å½æ°compileã\n\nfunction compile(template){\n  const evalExpr = /<%=(.+?)%>/g;\n  const expr = /<%([\\s\\S]+?)%>/g;\n\n  template = template\n    .replace(evalExpr, '`); \\n  echo( $1 ); \\n  echo(`')\n    .replace(expr, '`); \\n $1 \\n  echo(`');\n\n  template = 'echo(`' + template + '`);';\n\n  let script =\n  `(function parse(data){\n    let output = \"\";\n\n    function echo(html){\n      output += html;\n    }\n\n    ${ template }\n\n    return output;\n  })`;\n\n  return script;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\ncompileå½æ°çç¨æ³å¦ä¸ã\n\nlet parse = eval(compile(template));\ndiv.innerHTML = parse({ supplies: [ \"broom\", \"mop\", \"cleaner\" ] });\n//   <ul>\n//     <li>broom</li>\n//     <li>mop</li>\n//     <li>cleaner</li>\n//   </ul>\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# æ ç­¾æ¨¡æ¿\n\næ¨¡æ¿å­ç¬¦ä¸²çåè½ï¼ä¸ä»ä»æ¯ä¸é¢è¿äºãå®å¯ä»¥ç´§è·å¨ä¸ä¸ªå½æ°ååé¢ï¼è¯¥å½æ°å°è¢«è°ç¨æ¥å¤çè¿ä¸ªæ¨¡æ¿å­ç¬¦ä¸²ãè¿è¢«ç§°ä¸ºâæ ç­¾æ¨¡æ¿âåè½ï¼tagged templateï¼ã\n\nalert`123`\n// ç­åäº\nalert(123)\n\n\n1\n2\n3\n\n\næ ç­¾æ¨¡æ¿å¶å®ä¸æ¯æ¨¡æ¿ï¼èæ¯å½æ°è°ç¨çä¸ç§ç¹æ®å½¢å¼ãâæ ç­¾âæçå°±æ¯å½æ°ï¼ç´§è·å¨åé¢çæ¨¡æ¿å­ç¬¦ä¸²å°±æ¯å®çåæ°ã\n\nä½æ¯ï¼å¦ææ¨¡æ¿å­ç¬¦éé¢æåéï¼å°±ä¸æ¯ç®åçè°ç¨äºï¼èæ¯ä¼å°æ¨¡æ¿å­ç¬¦ä¸²åå¤çæå¤ä¸ªåæ°ï¼åè°ç¨å½æ°ã\n\nlet a = 5;\nlet b = 10;\n\ntag`Hello ${ a + b } world ${ a * b }`;\n// ç­åäº\ntag(['Hello ', ' world ', ''], 15, 50);\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¨¡æ¿å­ç¬¦ä¸²åé¢æä¸ä¸ªæ è¯åtagï¼å®æ¯ä¸ä¸ªå½æ°ãæ´ä¸ªè¡¨è¾¾å¼çè¿åå¼ï¼å°±æ¯tagå½æ°å¤çæ¨¡æ¿å­ç¬¦ä¸²åçè¿åå¼ã\n\nå½æ°tagä¾æ¬¡ä¼æ¥æ¶å°å¤ä¸ªåæ°ã\n\nfunction tag(stringArr, value1, value2){\n  // ...\n}\n\n// ç­åäº\n\nfunction tag(stringArr, ...values){\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\ntagå½æ°çç¬¬ä¸ä¸ªåæ°æ¯ä¸ä¸ªæ°ç»ï¼è¯¥æ°ç»çæåæ¯æ¨¡æ¿å­ç¬¦ä¸²ä¸­é£äºæ²¡æåéæ¿æ¢çé¨åï¼ä¹å°±æ¯è¯´ï¼åéæ¿æ¢åªåçå¨æ°ç»çç¬¬ä¸ä¸ªæåä¸ç¬¬äºä¸ªæåä¹é´ãç¬¬äºä¸ªæåä¸ç¬¬ä¸ä¸ªæåä¹é´ï¼ä»¥æ­¤ç±»æ¨ã\n\ntagå½æ°çå¶ä»åæ°ï¼é½æ¯æ¨¡æ¿å­ç¬¦ä¸²åä¸ªåéè¢«æ¿æ¢åçå¼ãç±äºæ¬ä¾ä¸­ï¼æ¨¡æ¿å­ç¬¦ä¸²å«æä¸¤ä¸ªåéï¼å æ­¤tagä¼æ¥åå°value1åvalue2ä¸¤ä¸ªåæ°ã\n\ntagå½æ°ææåæ°çå®éå¼å¦ä¸ã\n\n * ç¬¬ä¸ä¸ªåæ°ï¼['Hello ', ' world ', '']\n * ç¬¬äºä¸ªåæ°: 15\n * ç¬¬ä¸ä¸ªåæ°ï¼50\n\nä¹å°±æ¯è¯´ï¼tagå½æ°å®éä¸ä»¥ä¸é¢çå½¢å¼è°ç¨ã\n\ntag(['Hello ', ' world ', ''], 15, 50)\n\n\n1\n\n\næä»¬å¯ä»¥æç§éè¦ç¼åtagå½æ°çä»£ç ãä¸é¢æ¯tagå½æ°çä¸ç§åæ³ï¼ä»¥åè¿è¡ç»æã\n\nlet a = 5;\nlet b = 10;\n\nfunction tag(s, v1, v2) {\n  console.log(s[0]);\n  console.log(s[1]);\n  console.log(s[2]);\n  console.log(v1);\n  console.log(v2);\n\n  return \"OK\";\n}\n\ntag`Hello ${ a + b } world ${ a * b}`;\n// \"Hello \"\n// \" world \"\n// \"\"\n// 15\n// 50\n// \"OK\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¸é¢æ¯ä¸ä¸ªæ´å¤æçä¾å­ã\n\nlet total = 30;\nlet msg = passthru`The total is ${total} (${total*1.05} with tax)`;\n\nfunction passthru(literals) {\n  let result = '';\n  let i = 0;\n\n  while (i < literals.length) {\n    result += literals[i++];\n    if (i < arguments.length) {\n      result += arguments[i];\n    }\n  }\n\n  return result;\n}\n\nmsg // \"The total is 30 (31.5 with tax)\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä¸é¢è¿ä¸ªä¾å­å±ç¤ºäºï¼å¦ä½å°åä¸ªåæ°æç§åæ¥çä½ç½®æ¼ååå»ã\n\npassthruå½æ°éç¨ rest åæ°çåæ³å¦ä¸ã\n\nfunction passthru(literals, ...values) {\n  let output = \"\";\n  let index;\n  for (index = 0; index < values.length; index++) {\n    output += literals[index] + values[index];\n  }\n\n  output += literals[index]\n  return output;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nâæ ç­¾æ¨¡æ¿âçä¸ä¸ªéè¦åºç¨ï¼å°±æ¯è¿æ»¤ HTML å­ç¬¦ä¸²ï¼é²æ­¢ç¨æ·è¾å¥æ¶æåå®¹ã\n\nlet message =\n  SaferHTML`<p>${sender} has sent you a message.</p>`;\n\nfunction SaferHTML(templateData) {\n  let s = templateData[0];\n  for (let i = 1; i < arguments.length; i++) {\n    let arg = String(arguments[i]);\n\n    // Escape special characters in the substitution.\n    s += arg.replace(/&/g, \"&amp;\")\n            .replace(/</g, \"&lt;\")\n            .replace(/>/g, \"&gt;\");\n\n    // Don't escape special characters in the template.\n    s += templateData[i];\n  }\n  return s;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä¸é¢ä»£ç ä¸­ï¼senderåéå¾å¾æ¯ç¨æ·æä¾çï¼ç»è¿SaferHTMLå½æ°å¤çï¼éé¢çç¹æ®å­ç¬¦é½ä¼è¢«è½¬ä¹ã\n\nlet sender = '<script>alert(\"abc\")<\/script>'; // æ¶æä»£ç \nlet message = SaferHTML`<p>${sender} has sent you a message.</p>`;\n\nmessage\n// <p>&lt;script&gt;alert(\"abc\")&lt;/script&gt; has sent you a message.</p>\n\n\n1\n2\n3\n4\n5\n\n\næ ç­¾æ¨¡æ¿çå¦ä¸ä¸ªåºç¨ï¼å°±æ¯å¤è¯­è¨è½¬æ¢ï¼å½éåå¤çï¼ã\n\ni18n`Welcome to ${siteName}, you are visitor number ${visitorNumber}!`\n// \"æ¬¢è¿è®¿é®xxxï¼æ¨æ¯ç¬¬xxxxä½è®¿é®èï¼\"\n\n\n1\n2\n\n\næ¨¡æ¿å­ç¬¦ä¸²æ¬èº«å¹¶ä¸è½åä»£ Mustache ä¹ç±»çæ¨¡æ¿åºï¼å ä¸ºæ²¡ææ¡ä»¶å¤æ­åå¾ªç¯å¤çåè½ï¼ä½æ¯éè¿æ ç­¾å½æ°ï¼ä½ å¯ä»¥èªå·±æ·»å è¿äºåè½ã\n\n// ä¸é¢çhashTemplateå½æ°\n// æ¯ä¸ä¸ªèªå®ä¹çæ¨¡æ¿å¤çå½æ°\nlet libraryHtml = hashTemplate`\n  <ul>\n    #for book in ${myBooks}\n      <li><i>#{book.title}</i> by #{book.author}</li>\n    #end\n  </ul>\n`;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\né¤æ­¤ä¹å¤ï¼ä½ çè³å¯ä»¥ä½¿ç¨æ ç­¾æ¨¡æ¿ï¼å¨ JavaScript è¯­è¨ä¹ä¸­åµå¥å¶ä»è¯­è¨ã\n\njsx`\n  <div>\n    <input\n      ref='input'\n      onChange='${this.handleChange}'\n      defaultValue='${this.state.value}' />\n      ${this.state.value}\n   </div>\n`\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢çä»£ç éè¿jsxå½æ°ï¼å°ä¸ä¸ª DOM å­ç¬¦ä¸²è½¬ä¸º React å¯¹è±¡ãä½ å¯ä»¥å¨ GitHub æ¾å°jsxå½æ°çå·ä½å®ç°ã\n\nä¸é¢åæ¯ä¸ä¸ªåæ³çä¾å­ï¼éè¿javaå½æ°ï¼å¨ JavaScript ä»£ç ä¹ä¸­è¿è¡ Java ä»£ç ã\n\njava`\nclass HelloWorldApp {\n  public static void main(String[] args) {\n    System.out.println(\"Hello World!\"); // Display the string.\n  }\n}\n`\nHelloWorldApp.main();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næ¨¡æ¿å¤çå½æ°çç¬¬ä¸ä¸ªåæ°ï¼æ¨¡æ¿å­ç¬¦ä¸²æ°ç»ï¼ï¼è¿æä¸ä¸ªrawå±æ§ã\n\nconsole.log`123`\n// [\"123\", raw: Array[1]]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼console.logæ¥åçåæ°ï¼å®éä¸æ¯ä¸ä¸ªæ°ç»ãè¯¥æ°ç»æä¸ä¸ªrawå±æ§ï¼ä¿å­çæ¯è½¬ä¹åçåå­ç¬¦ä¸²ã\n\nè¯·çä¸é¢çä¾å­ã\n\ntag`First line\\nSecond line`\n\nfunction tag(strings) {\n  console.log(strings.raw[0]);\n  // strings.raw[0] ä¸º \"First line\\\\nSecond line\"\n  // æå°è¾åº \"First line\\nSecond line\"\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼tagå½æ°çç¬¬ä¸ä¸ªåæ°stringsï¼æä¸ä¸ªrawå±æ§ï¼ä¹æåä¸ä¸ªæ°ç»ãè¯¥æ°ç»çæåä¸stringsæ°ç»å®å¨ä¸è´ãæ¯å¦ï¼stringsæ°ç»æ¯[\"First line\\nSecond line\"]ï¼é£ä¹strings.rawæ°ç»å°±æ¯[\"First line\\\\nSecond line\"]ãä¸¤èå¯ä¸çåºå«ï¼å°±æ¯å­ç¬¦ä¸²éé¢çææ é½è¢«è½¬ä¹äºãæ¯å¦ï¼strings.raw æ°ç»ä¼å°\\nè§ä¸º\\\\ånä¸¤ä¸ªå­ç¬¦ï¼èä¸æ¯æ¢è¡ç¬¦ãè¿æ¯ä¸ºäºæ¹ä¾¿åå¾è½¬ä¹ä¹åçåå§æ¨¡æ¿èè®¾è®¡çã\n\n\n# æ¨¡æ¿å­ç¬¦ä¸²çéå¶\n\nåé¢æå°æ ç­¾æ¨¡æ¿éé¢ï¼å¯ä»¥ååµå¶ä»è¯­è¨ãä½æ¯ï¼æ¨¡æ¿å­ç¬¦ä¸²é»è®¤ä¼å°å­ç¬¦ä¸²è½¬ä¹ï¼å¯¼è´æ æ³åµå¥å¶ä»è¯­è¨ã\n\nä¸¾ä¾æ¥è¯´ï¼æ ç­¾æ¨¡æ¿éé¢å¯ä»¥åµå¥ LaTEX è¯­è¨ã\n\nfunction latex(strings) {\n  // ...\n}\n\nlet document = latex`\n\\newcommand{\\fun}{\\textbf{Fun!}}  // æ­£å¸¸å·¥ä½\n\\newcommand{\\unicode}{\\textbf{Unicode!}} // æ¥é\n\\newcommand{\\xerxes}{\\textbf{King!}} // æ¥é\n\nBreve over the h goes \\u{h}ere // æ¥é\n`\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼åédocumentååµçæ¨¡æ¿å­ç¬¦ä¸²ï¼å¯¹äº LaTEX è¯­è¨æ¥è¯´å®å¨æ¯åæ³çï¼ä½æ¯ JavaScript å¼æä¼æ¥éãåå å°±å¨äºå­ç¬¦ä¸²çè½¬ä¹ã\n\næ¨¡æ¿å­ç¬¦ä¸²ä¼å°\\u00FFå\\u{42}å½ä½ Unicode å­ç¬¦è¿è¡è½¬ä¹ï¼æä»¥\\unicodeè§£ææ¶æ¥éï¼è\\x56ä¼è¢«å½ä½åå­è¿å¶å­ç¬¦ä¸²è½¬ä¹ï¼æä»¥\\xerxesä¼æ¥éãä¹å°±æ¯è¯´ï¼\\uå\\xå¨ LaTEX éé¢æç¹æ®å«ä¹ï¼ä½æ¯ JavaScript å°å®ä»¬è½¬ä¹äºã\n\nä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼ES2018 æ¾æ¾äºå¯¹æ ç­¾æ¨¡æ¿éé¢çå­ç¬¦ä¸²è½¬ä¹çéå¶ãå¦æéå°ä¸åæ³çå­ç¬¦ä¸²è½¬ä¹ï¼å°±è¿åundefinedï¼èä¸æ¯æ¥éï¼å¹¶ä¸ä»rawå±æ§ä¸é¢å¯ä»¥å¾å°åå§å­ç¬¦ä¸²ã\n\nfunction tag(strs) {\n  strs[0] === undefined\n  strs.raw[0] === \"\\\\unicode and \\\\u{55}\";\n}\ntag`\\unicode and \\u{55}`\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¨¡æ¿å­ç¬¦ä¸²åæ¬æ¯åºè¯¥æ¥éçï¼ä½æ¯ç±äºæ¾æ¾äºå¯¹å­ç¬¦ä¸²è½¬ä¹çéå¶ï¼æä»¥ä¸æ¥éäºï¼JavaScript å¼æå°ç¬¬ä¸ä¸ªå­ç¬¦è®¾ç½®ä¸ºundefinedï¼ä½æ¯rawå±æ§ä¾ç¶å¯ä»¥å¾å°åå§å­ç¬¦ä¸²ï¼å æ­¤tagå½æ°è¿æ¯å¯ä»¥å¯¹åå­ç¬¦ä¸²è¿è¡å¤çã\n\næ³¨æï¼è¿ç§å¯¹å­ç¬¦ä¸²è½¬ä¹çæ¾æ¾ï¼åªå¨æ ç­¾æ¨¡æ¿è§£æå­ç¬¦ä¸²æ¶çæï¼ä¸æ¯æ ç­¾æ¨¡æ¿çåºåï¼ä¾ç¶ä¼æ¥éã\n\nlet bad = `bad escape sequence: \\unicode`; // æ¥é\n\n\n1\n",normalizedContent:"# å­ç¬¦ä¸²çæ©å±\n\næ¬ç« ä»ç» es6 å¯¹å­ç¬¦ä¸²çæ¹é åå¢å¼ºï¼ä¸ä¸ç« ä»ç»å­ç¬¦ä¸²å¯¹è±¡çæ°å¢æ¹æ³ã\n\n\n# å­ç¬¦ç unicode è¡¨ç¤ºæ³\n\nes6 å å¼ºäºå¯¹ unicode çæ¯æï¼åè®¸éç¨\\uxxxxå½¢å¼è¡¨ç¤ºä¸ä¸ªå­ç¬¦ï¼å¶ä¸­xxxxè¡¨ç¤ºå­ç¬¦ç unicode ç ç¹ã\n\n\"\\u0061\"\n// \"a\"\n\n\n1\n2\n\n\nä½æ¯ï¼è¿ç§è¡¨ç¤ºæ³åªéäºç ç¹å¨\\u0000~\\uffffä¹é´çå­ç¬¦ãè¶åºè¿ä¸ªèå´çå­ç¬¦ï¼å¿é¡»ç¨ä¸¤ä¸ªåå­èçå½¢å¼è¡¨ç¤ºã\n\n\"\\ud842\\udfb7\"\n// \"ð ®·\"\n\n\"\\u20bb7\"\n// \" 7\"\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼å¦æç´æ¥å¨\\uåé¢è·ä¸è¶è¿0xffffçæ°å¼ï¼æ¯å¦\\u20bb7ï¼ï¼javascript ä¼çè§£æ\\u20bb+7ãç±äº\\u20bbæ¯ä¸ä¸ªä¸å¯æå°å­ç¬¦ï¼æä»¥åªä¼æ¾ç¤ºä¸ä¸ªç©ºæ ¼ï¼åé¢è·çä¸ä¸ª7ã\n\nes6 å¯¹è¿ä¸ç¹ååºäºæ¹è¿ï¼åªè¦å°ç ç¹æ¾å¥å¤§æ¬å·ï¼å°±è½æ­£ç¡®è§£è¯»è¯¥å­ç¬¦ã\n\n\"\\u{20bb7}\"\n// \"ð ®·\"\n\n\"\\u{41}\\u{42}\\u{43}\"\n// \"abc\"\n\nlet hello = 123;\nhell\\u{6f} // 123\n\n'\\u{1f680}' === '\\ud83d\\ude80'\n// true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼æåä¸ä¸ªä¾å­è¡¨æï¼å¤§æ¬å·è¡¨ç¤ºæ³ä¸åå­èç utf-16 ç¼ç æ¯ç­ä»·çã\n\næäºè¿ç§è¡¨ç¤ºæ³ä¹åï¼javascript å±æ 6 ç§æ¹æ³å¯ä»¥è¡¨ç¤ºä¸ä¸ªå­ç¬¦ã\n\n'\\z' === 'z'  // true\n'\\172' === 'z' // true\n'\\x7a' === 'z' // true\n'\\u007a' === 'z' // true\n'\\u{7a}' === 'z' // true\n\n\n1\n2\n3\n4\n5\n\n\n\n# å­ç¬¦ä¸²çéåå¨æ¥å£\n\nes6 ä¸ºå­ç¬¦ä¸²æ·»å äºéåå¨æ¥å£ï¼è¯¦è§ãiteratorãä¸ç« ï¼ï¼ä½¿å¾å­ç¬¦ä¸²å¯ä»¥è¢«for...ofå¾ªç¯éåã\n\nfor (let codepoint of 'foo') {\n  console.log(codepoint)\n}\n// \"f\"\n// \"o\"\n// \"o\"\n\n\n1\n2\n3\n4\n5\n6\n\n\né¤äºéåå­ç¬¦ä¸²ï¼è¿ä¸ªéåå¨æå¤§çä¼ç¹æ¯å¯ä»¥è¯å«å¤§äº0xffffçç ç¹ï¼ä¼ ç»çforå¾ªç¯æ æ³è¯å«è¿æ ·çç ç¹ã\n\nlet text = string.fromcodepoint(0x20bb7);\n\nfor (let i = 0; i < text.length; i++) {\n  console.log(text[i]);\n}\n// \" \"\n// \" \"\n\nfor (let i of text) {\n  console.log(i);\n}\n// \"ð ®·\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç¬¦ä¸²textåªæä¸ä¸ªå­ç¬¦ï¼ä½æ¯forå¾ªç¯ä¼è®¤ä¸ºå®åå«ä¸¤ä¸ªå­ç¬¦ï¼é½ä¸å¯æå°ï¼ï¼èfor...ofå¾ªç¯ä¼æ­£ç¡®è¯å«åºè¿ä¸ä¸ªå­ç¬¦ã\n\n\n# ç´æ¥è¾å¥ u+2028 å u+2029\n\njavascript å­ç¬¦ä¸²åè®¸ç´æ¥è¾å¥å­ç¬¦ï¼ä»¥åè¾å¥å­ç¬¦çè½¬ä¹å½¢å¼ãä¸¾ä¾æ¥è¯´ï¼âä¸­âç unicode ç ç¹æ¯ u+4e2dï¼ä½ å¯ä»¥ç´æ¥å¨å­ç¬¦ä¸²éé¢è¾å¥è¿ä¸ªæ±å­ï¼ä¹å¯ä»¥è¾å¥å®çè½¬ä¹å½¢å¼\\u4e2dï¼ä¸¤èæ¯ç­ä»·çã\n\n'ä¸­' === '\\u4e2d' // true\n\n\n1\n\n\nä½æ¯ï¼javascript è§å®æ5ä¸ªå­ç¬¦ï¼ä¸è½å¨å­ç¬¦ä¸²éé¢ç´æ¥ä½¿ç¨ï¼åªè½ä½¿ç¨è½¬ä¹å½¢å¼ã\n\n * u+005cï¼åææ ï¼reverse solidus)\n * u+000dï¼åè½¦ï¼carriage returnï¼\n * u+2028ï¼è¡åéç¬¦ï¼line separatorï¼\n * u+2029ï¼æ®µåéç¬¦ï¼paragraph separatorï¼\n * u+000aï¼æ¢è¡ç¬¦ï¼line feedï¼\n\nä¸¾ä¾æ¥è¯´ï¼å­ç¬¦ä¸²éé¢ä¸è½ç´æ¥åå«åææ ï¼ä¸å®è¦è½¬ä¹åæ\\\\æè\\u005cã\n\nè¿ä¸ªè§å®æ¬èº«æ²¡æé®é¢ï¼éº»ç¦å¨äº json æ ¼å¼åè®¸å­ç¬¦ä¸²éé¢ç´æ¥ä½¿ç¨ u+2028ï¼è¡åéç¬¦ï¼å u+2029ï¼æ®µåéç¬¦ï¼ãè¿æ ·ä¸æ¥ï¼æå¡å¨è¾åºç json è¢«json.parseè§£æï¼å°±æå¯è½ç´æ¥æ¥éã\n\nconst json = '\"\\u2028\"';\njson.parse(json); // å¯è½æ¥é\n\n\n1\n2\n\n\njson æ ¼å¼å·²ç»å»ç»ï¼rfc 7159ï¼ï¼æ²¡æ³ä¿®æ¹äºãä¸ºäºæ¶é¤è¿ä¸ªæ¥éï¼es2019 åè®¸ javascript å­ç¬¦ä¸²ç´æ¥è¾å¥ u+2028ï¼è¡åéç¬¦ï¼å u+2029ï¼æ®µåéç¬¦ï¼ã\n\nconst ps = eval(\"'\\u2029'\");\n\n\n1\n\n\næ ¹æ®è¿ä¸ªææ¡ï¼ä¸é¢çä»£ç ä¸ä¼æ¥éã\n\næ³¨æï¼æ¨¡æ¿å­ç¬¦ä¸²ç°å¨å°±åè®¸ç´æ¥è¾å¥è¿ä¸¤ä¸ªå­ç¬¦ãå¦å¤ï¼æ­£åè¡¨è¾¾å¼ä¾ç¶ä¸åè®¸ç´æ¥è¾å¥è¿ä¸¤ä¸ªå­ç¬¦ï¼è¿æ¯æ²¡æé®é¢çï¼å ä¸º json æ¬æ¥å°±ä¸åè®¸ç´æ¥åå«æ­£åè¡¨è¾¾å¼ã\n\n\n# json.stringify() çæ¹é \n\næ ¹æ®æ åï¼json æ°æ®å¿é¡»æ¯ utf-8 ç¼ç ãä½æ¯ï¼ç°å¨çjson.stringify()æ¹æ³æå¯è½è¿åä¸ç¬¦å utf-8 æ åçå­ç¬¦ä¸²ã\n\nå·ä½æ¥è¯´ï¼utf-8 æ åè§å®ï¼0xd800å°0xdfffä¹é´çç ç¹ï¼ä¸è½åç¬ä½¿ç¨ï¼å¿é¡»éå¯¹ä½¿ç¨ãæ¯å¦ï¼\\ud834\\udf06æ¯ä¸¤ä¸ªç ç¹ï¼ä½æ¯å¿é¡»æ¾å¨ä¸èµ·éå¯¹ä½¿ç¨ï¼ä»£è¡¨å­ç¬¦ðãè¿æ¯ä¸ºäºè¡¨ç¤ºç ç¹å¤§äº0xffffçå­ç¬¦çä¸ç§åéæ¹æ³ãåç¬ä½¿ç¨\\ud834å\\udfo6è¿ä¸¤ä¸ªç ç¹æ¯ä¸åæ³çï¼æèé¢ åé¡ºåºä¹ä¸è¡ï¼å ä¸º\\udf06\\ud834å¹¶æ²¡æå¯¹åºçå­ç¬¦ã\n\njson.stringify()çé®é¢å¨äºï¼å®å¯è½è¿å0xd800å°0xdfffä¹é´çåä¸ªç ç¹ã\n\njson.stringify('\\u{d834}') // \"\\u{d834}\"\n\n\n1\n\n\nä¸ºäºç¡®ä¿è¿åçæ¯åæ³ç utf-8 å­ç¬¦ï¼es2019 æ¹åäºjson.stringify()çè¡ä¸ºãå¦æéå°0xd800å°0xdfffä¹é´çåä¸ªç ç¹ï¼æèä¸å­å¨çéå¯¹å½¢å¼ï¼å®ä¼è¿åè½¬ä¹å­ç¬¦ä¸²ï¼çç»åºç¨èªå·±å³å®ä¸ä¸æ­¥çå¤çã\n\njson.stringify('\\u{d834}') // \"\"\\\\ud834\"\"\njson.stringify('\\udf06\\ud834') // \"\"\\\\udf06\\\\ud834\"\"\n\n\n1\n2\n\n\n\n# æ¨¡æ¿å­ç¬¦ä¸²\n\nä¼ ç»ç javascript è¯­è¨ï¼è¾åºæ¨¡æ¿éå¸¸æ¯è¿æ ·åçï¼ä¸é¢ä½¿ç¨äº jquery çæ¹æ³ï¼ã\n\n$('#result').append(\n  'there are <b>' + basket.count + '</b> ' +\n  'items in your basket, ' +\n  '<em>' + basket.onsale +\n  '</em> are on sale!'\n);\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢è¿ç§åæ³ç¸å½ç¹çä¸æ¹ä¾¿ï¼es6 å¼å¥äºæ¨¡æ¿å­ç¬¦ä¸²è§£å³è¿ä¸ªé®é¢ã\n\n$('#result').append(`\n  there are <b>${basket.count}</b> items\n   in your basket, <em>${basket.onsale}</em>\n  are on sale!\n`);\n\n\n1\n2\n3\n4\n5\n\n\næ¨¡æ¿å­ç¬¦ä¸²ï¼template stringï¼æ¯å¢å¼ºççå­ç¬¦ä¸²ï¼ç¨åå¼å·ï¼`ï¼æ è¯ãå®å¯ä»¥å½ä½æ®éå­ç¬¦ä¸²ä½¿ç¨ï¼ä¹å¯ä»¥ç¨æ¥å®ä¹å¤è¡å­ç¬¦ä¸²ï¼æèå¨å­ç¬¦ä¸²ä¸­åµå¥åéã\n\n// æ®éå­ç¬¦ä¸²\n`in javascript '\\n' is a line-feed.`\n\n// å¤è¡å­ç¬¦ä¸²\n`in javascript this is\n not legal.`\n\nconsole.log(`string text line 1\nstring text line 2`);\n\n// å­ç¬¦ä¸²ä¸­åµå¥åé\nlet name = \"bob\", time = \"today\";\n`hello ${name}, how are you ${time}?`\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­çæ¨¡æ¿å­ç¬¦ä¸²ï¼é½æ¯ç¨åå¼å·è¡¨ç¤ºãå¦æå¨æ¨¡æ¿å­ç¬¦ä¸²ä¸­éè¦ä½¿ç¨åå¼å·ï¼ååé¢è¦ç¨åææ è½¬ä¹ã\n\nlet greeting = `\\`yo\\` world!`;\n\n\n1\n\n\nå¦æä½¿ç¨æ¨¡æ¿å­ç¬¦ä¸²è¡¨ç¤ºå¤è¡å­ç¬¦ä¸²ï¼ææçç©ºæ ¼åç¼©è¿é½ä¼è¢«ä¿çå¨è¾åºä¹ä¸­ã\n\n$('#list').html(`\n<ul>\n  <li>first</li>\n  <li>second</li>\n</ul>\n`);\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼æææ¨¡æ¿å­ç¬¦ä¸²çç©ºæ ¼åæ¢è¡ï¼é½æ¯è¢«ä¿ççï¼æ¯å¦<ul>æ ç­¾åé¢ä¼æä¸ä¸ªæ¢è¡ãå¦æä½ ä¸æ³è¦è¿ä¸ªæ¢è¡ï¼å¯ä»¥ä½¿ç¨trimæ¹æ³æ¶é¤å®ã\n\n$('#list').html(`\n<ul>\n  <li>first</li>\n  <li>second</li>\n</ul>\n`.trim());\n\n\n1\n2\n3\n4\n5\n6\n\n\næ¨¡æ¿å­ç¬¦ä¸²ä¸­åµå¥åéï¼éè¦å°åéååå¨${}ä¹ä¸­ã\n\nfunction authorize(user, action) {\n  if (!user.hasprivilege(action)) {\n    throw new error(\n      // ä¼ ç»åæ³ä¸º\n      // 'user '\n      // + user.name\n      // + ' is not authorized to do '\n      // + action\n      // + '.'\n      `user ${user.name} is not authorized to do ${action}.`);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå¤§æ¬å·åé¨å¯ä»¥æ¾å¥ä»»æç javascript è¡¨è¾¾å¼ï¼å¯ä»¥è¿è¡è¿ç®ï¼ä»¥åå¼ç¨å¯¹è±¡å±æ§ã\n\nlet x = 1;\nlet y = 2;\n\n`${x} + ${y} = ${x + y}`\n// \"1 + 2 = 3\"\n\n`${x} + ${y * 2} = ${x + y * 2}`\n// \"1 + 4 = 5\"\n\nlet obj = {x: 1, y: 2};\n`${obj.x + obj.y}`\n// \"3\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\næ¨¡æ¿å­ç¬¦ä¸²ä¹ä¸­è¿è½è°ç¨å½æ°ã\n\nfunction fn() {\n  return \"hello world\";\n}\n\n`foo ${fn()} bar`\n// foo hello world bar\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¦æå¤§æ¬å·ä¸­çå¼ä¸æ¯å­ç¬¦ä¸²ï¼å°æç§ä¸è¬çè§åè½¬ä¸ºå­ç¬¦ä¸²ãæ¯å¦ï¼å¤§æ¬å·ä¸­æ¯ä¸ä¸ªå¯¹è±¡ï¼å°é»è®¤è°ç¨å¯¹è±¡çtostringæ¹æ³ã\n\nå¦ææ¨¡æ¿å­ç¬¦ä¸²ä¸­çåéæ²¡æå£°æï¼å°æ¥éã\n\n// åéplaceæ²¡æå£°æ\nlet msg = `hello, ${place}`;\n// æ¥é\n\n\n1\n2\n3\n\n\nç±äºæ¨¡æ¿å­ç¬¦ä¸²çå¤§æ¬å·åé¨ï¼å°±æ¯æ§è¡ javascript ä»£ç ï¼å æ­¤å¦æå¤§æ¬å·åé¨æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼å°ä¼åæ ·è¾åºã\n\n`hello ${'world'}`\n// \"hello world\"\n\n\n1\n2\n\n\næ¨¡æ¿å­ç¬¦ä¸²çè³è¿è½åµå¥ã\n\nconst tmpl = addrs => `\n  <table>\n  ${addrs.map(addr => `\n    <tr><td>${addr.first}</td></tr>\n    <tr><td>${addr.last}</td></tr>\n  `).join('')}\n  </table>\n`;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¨¡æ¿å­ç¬¦ä¸²çåéä¹ä¸­ï¼ååµå¥äºå¦ä¸ä¸ªæ¨¡æ¿å­ç¬¦ä¸²ï¼ä½¿ç¨æ¹æ³å¦ä¸ã\n\nconst data = [\n    { first: '<jane>', last: 'bond' },\n    { first: 'lars', last: '<croft>' },\n];\n\nconsole.log(tmpl(data));\n// <table>\n//\n//   <tr><td><jane></td></tr>\n//   <tr><td>bond</td></tr>\n//\n//   <tr><td>lars</td></tr>\n//   <tr><td><croft></td></tr>\n//\n// </table>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå¦æéè¦å¼ç¨æ¨¡æ¿å­ç¬¦ä¸²æ¬èº«ï¼å¨éè¦æ¶æ§è¡ï¼å¯ä»¥åæå½æ°ã\n\nlet func = (name) => `hello ${name}!`;\nfunc('jack') // \"hello jack!\"\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¨¡æ¿å­ç¬¦ä¸²åæäºä¸ä¸ªå½æ°çè¿åå¼ãæ§è¡è¿ä¸ªå½æ°ï¼å°±ç¸å½äºæ§è¡è¿ä¸ªæ¨¡æ¿å­ç¬¦ä¸²äºã\n\n\n# å®ä¾ï¼æ¨¡æ¿ç¼è¯\n\nä¸é¢ï¼æä»¬æ¥çä¸ä¸ªéè¿æ¨¡æ¿å­ç¬¦ä¸²ï¼çææ­£å¼æ¨¡æ¿çå®ä¾ã\n\nlet template = `\n<ul>\n  <% for(let i=0; i < data.supplies.length; i++) { %>\n    <li><%= data.supplies[i] %></li>\n  <% } %>\n</ul>\n`;\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç å¨æ¨¡æ¿å­ç¬¦ä¸²ä¹ä¸­ï¼æ¾ç½®äºä¸ä¸ªå¸¸è§æ¨¡æ¿ãè¯¥æ¨¡æ¿ä½¿ç¨<%...%>æ¾ç½® javascript ä»£ç ï¼ä½¿ç¨<%= ... %>è¾åº javascript è¡¨è¾¾å¼ã\n\næä¹ç¼è¯è¿ä¸ªæ¨¡æ¿å­ç¬¦ä¸²å¢ï¼\n\nä¸ç§æè·¯æ¯å°å¶è½¬æ¢ä¸º javascript è¡¨è¾¾å¼å­ç¬¦ä¸²ã\n\necho('<ul>');\nfor(let i=0; i < data.supplies.length; i++) {\n  echo('<li>');\n  echo(data.supplies[i]);\n  echo('</li>');\n};\necho('</ul>');\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¿ä¸ªè½¬æ¢ä½¿ç¨æ­£åè¡¨è¾¾å¼å°±è¡äºã\n\nlet evalexpr = /<%=(.+?)%>/g;\nlet expr = /<%([\\s\\s]+?)%>/g;\n\ntemplate = template\n  .replace(evalexpr, '`); \\n  echo( $1 ); \\n  echo(`')\n  .replace(expr, '`); \\n $1 \\n  echo(`');\n\ntemplate = 'echo(`' + template + '`);';\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nç¶åï¼å°templateå°è£å¨ä¸ä¸ªå½æ°éé¢è¿åï¼å°±å¯ä»¥äºã\n\nlet script =\n`(function parse(data){\n  let output = \"\";\n\n  function echo(html){\n    output += html;\n  }\n\n  ${ template }\n\n  return output;\n})`;\n\nreturn script;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nå°ä¸é¢çåå®¹æ¼è£æä¸ä¸ªæ¨¡æ¿ç¼è¯å½æ°compileã\n\nfunction compile(template){\n  const evalexpr = /<%=(.+?)%>/g;\n  const expr = /<%([\\s\\s]+?)%>/g;\n\n  template = template\n    .replace(evalexpr, '`); \\n  echo( $1 ); \\n  echo(`')\n    .replace(expr, '`); \\n $1 \\n  echo(`');\n\n  template = 'echo(`' + template + '`);';\n\n  let script =\n  `(function parse(data){\n    let output = \"\";\n\n    function echo(html){\n      output += html;\n    }\n\n    ${ template }\n\n    return output;\n  })`;\n\n  return script;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\ncompileå½æ°çç¨æ³å¦ä¸ã\n\nlet parse = eval(compile(template));\ndiv.innerhtml = parse({ supplies: [ \"broom\", \"mop\", \"cleaner\" ] });\n//   <ul>\n//     <li>broom</li>\n//     <li>mop</li>\n//     <li>cleaner</li>\n//   </ul>\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# æ ç­¾æ¨¡æ¿\n\næ¨¡æ¿å­ç¬¦ä¸²çåè½ï¼ä¸ä»ä»æ¯ä¸é¢è¿äºãå®å¯ä»¥ç´§è·å¨ä¸ä¸ªå½æ°ååé¢ï¼è¯¥å½æ°å°è¢«è°ç¨æ¥å¤çè¿ä¸ªæ¨¡æ¿å­ç¬¦ä¸²ãè¿è¢«ç§°ä¸ºâæ ç­¾æ¨¡æ¿âåè½ï¼tagged templateï¼ã\n\nalert`123`\n// ç­åäº\nalert(123)\n\n\n1\n2\n3\n\n\næ ç­¾æ¨¡æ¿å¶å®ä¸æ¯æ¨¡æ¿ï¼èæ¯å½æ°è°ç¨çä¸ç§ç¹æ®å½¢å¼ãâæ ç­¾âæçå°±æ¯å½æ°ï¼ç´§è·å¨åé¢çæ¨¡æ¿å­ç¬¦ä¸²å°±æ¯å®çåæ°ã\n\nä½æ¯ï¼å¦ææ¨¡æ¿å­ç¬¦éé¢æåéï¼å°±ä¸æ¯ç®åçè°ç¨äºï¼èæ¯ä¼å°æ¨¡æ¿å­ç¬¦ä¸²åå¤çæå¤ä¸ªåæ°ï¼åè°ç¨å½æ°ã\n\nlet a = 5;\nlet b = 10;\n\ntag`hello ${ a + b } world ${ a * b }`;\n// ç­åäº\ntag(['hello ', ' world ', ''], 15, 50);\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¨¡æ¿å­ç¬¦ä¸²åé¢æä¸ä¸ªæ è¯åtagï¼å®æ¯ä¸ä¸ªå½æ°ãæ´ä¸ªè¡¨è¾¾å¼çè¿åå¼ï¼å°±æ¯tagå½æ°å¤çæ¨¡æ¿å­ç¬¦ä¸²åçè¿åå¼ã\n\nå½æ°tagä¾æ¬¡ä¼æ¥æ¶å°å¤ä¸ªåæ°ã\n\nfunction tag(stringarr, value1, value2){\n  // ...\n}\n\n// ç­åäº\n\nfunction tag(stringarr, ...values){\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\ntagå½æ°çç¬¬ä¸ä¸ªåæ°æ¯ä¸ä¸ªæ°ç»ï¼è¯¥æ°ç»çæåæ¯æ¨¡æ¿å­ç¬¦ä¸²ä¸­é£äºæ²¡æåéæ¿æ¢çé¨åï¼ä¹å°±æ¯è¯´ï¼åéæ¿æ¢åªåçå¨æ°ç»çç¬¬ä¸ä¸ªæåä¸ç¬¬äºä¸ªæåä¹é´ãç¬¬äºä¸ªæåä¸ç¬¬ä¸ä¸ªæåä¹é´ï¼ä»¥æ­¤ç±»æ¨ã\n\ntagå½æ°çå¶ä»åæ°ï¼é½æ¯æ¨¡æ¿å­ç¬¦ä¸²åä¸ªåéè¢«æ¿æ¢åçå¼ãç±äºæ¬ä¾ä¸­ï¼æ¨¡æ¿å­ç¬¦ä¸²å«æä¸¤ä¸ªåéï¼å æ­¤tagä¼æ¥åå°value1åvalue2ä¸¤ä¸ªåæ°ã\n\ntagå½æ°ææåæ°çå®éå¼å¦ä¸ã\n\n * ç¬¬ä¸ä¸ªåæ°ï¼['hello ', ' world ', '']\n * ç¬¬äºä¸ªåæ°: 15\n * ç¬¬ä¸ä¸ªåæ°ï¼50\n\nä¹å°±æ¯è¯´ï¼tagå½æ°å®éä¸ä»¥ä¸é¢çå½¢å¼è°ç¨ã\n\ntag(['hello ', ' world ', ''], 15, 50)\n\n\n1\n\n\næä»¬å¯ä»¥æç§éè¦ç¼åtagå½æ°çä»£ç ãä¸é¢æ¯tagå½æ°çä¸ç§åæ³ï¼ä»¥åè¿è¡ç»æã\n\nlet a = 5;\nlet b = 10;\n\nfunction tag(s, v1, v2) {\n  console.log(s[0]);\n  console.log(s[1]);\n  console.log(s[2]);\n  console.log(v1);\n  console.log(v2);\n\n  return \"ok\";\n}\n\ntag`hello ${ a + b } world ${ a * b}`;\n// \"hello \"\n// \" world \"\n// \"\"\n// 15\n// 50\n// \"ok\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¸é¢æ¯ä¸ä¸ªæ´å¤æçä¾å­ã\n\nlet total = 30;\nlet msg = passthru`the total is ${total} (${total*1.05} with tax)`;\n\nfunction passthru(literals) {\n  let result = '';\n  let i = 0;\n\n  while (i < literals.length) {\n    result += literals[i++];\n    if (i < arguments.length) {\n      result += arguments[i];\n    }\n  }\n\n  return result;\n}\n\nmsg // \"the total is 30 (31.5 with tax)\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä¸é¢è¿ä¸ªä¾å­å±ç¤ºäºï¼å¦ä½å°åä¸ªåæ°æç§åæ¥çä½ç½®æ¼ååå»ã\n\npassthruå½æ°éç¨ rest åæ°çåæ³å¦ä¸ã\n\nfunction passthru(literals, ...values) {\n  let output = \"\";\n  let index;\n  for (index = 0; index < values.length; index++) {\n    output += literals[index] + values[index];\n  }\n\n  output += literals[index]\n  return output;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nâæ ç­¾æ¨¡æ¿âçä¸ä¸ªéè¦åºç¨ï¼å°±æ¯è¿æ»¤ html å­ç¬¦ä¸²ï¼é²æ­¢ç¨æ·è¾å¥æ¶æåå®¹ã\n\nlet message =\n  saferhtml`<p>${sender} has sent you a message.</p>`;\n\nfunction saferhtml(templatedata) {\n  let s = templatedata[0];\n  for (let i = 1; i < arguments.length; i++) {\n    let arg = string(arguments[i]);\n\n    // escape special characters in the substitution.\n    s += arg.replace(/&/g, \"&amp;\")\n            .replace(/</g, \"&lt;\")\n            .replace(/>/g, \"&gt;\");\n\n    // don't escape special characters in the template.\n    s += templatedata[i];\n  }\n  return s;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä¸é¢ä»£ç ä¸­ï¼senderåéå¾å¾æ¯ç¨æ·æä¾çï¼ç»è¿saferhtmlå½æ°å¤çï¼éé¢çç¹æ®å­ç¬¦é½ä¼è¢«è½¬ä¹ã\n\nlet sender = '<script>alert(\"abc\")<\/script>'; // æ¶æä»£ç \nlet message = saferhtml`<p>${sender} has sent you a message.</p>`;\n\nmessage\n// <p>&lt;script&gt;alert(\"abc\")&lt;/script&gt; has sent you a message.</p>\n\n\n1\n2\n3\n4\n5\n\n\næ ç­¾æ¨¡æ¿çå¦ä¸ä¸ªåºç¨ï¼å°±æ¯å¤è¯­è¨è½¬æ¢ï¼å½éåå¤çï¼ã\n\ni18n`welcome to ${sitename}, you are visitor number ${visitornumber}!`\n// \"æ¬¢è¿è®¿é®xxxï¼æ¨æ¯ç¬¬xxxxä½è®¿é®èï¼\"\n\n\n1\n2\n\n\næ¨¡æ¿å­ç¬¦ä¸²æ¬èº«å¹¶ä¸è½åä»£ mustache ä¹ç±»çæ¨¡æ¿åºï¼å ä¸ºæ²¡ææ¡ä»¶å¤æ­åå¾ªç¯å¤çåè½ï¼ä½æ¯éè¿æ ç­¾å½æ°ï¼ä½ å¯ä»¥èªå·±æ·»å è¿äºåè½ã\n\n// ä¸é¢çhashtemplateå½æ°\n// æ¯ä¸ä¸ªèªå®ä¹çæ¨¡æ¿å¤çå½æ°\nlet libraryhtml = hashtemplate`\n  <ul>\n    #for book in ${mybooks}\n      <li><i>#{book.title}</i> by #{book.author}</li>\n    #end\n  </ul>\n`;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\né¤æ­¤ä¹å¤ï¼ä½ çè³å¯ä»¥ä½¿ç¨æ ç­¾æ¨¡æ¿ï¼å¨ javascript è¯­è¨ä¹ä¸­åµå¥å¶ä»è¯­è¨ã\n\njsx`\n  <div>\n    <input\n      ref='input'\n      onchange='${this.handlechange}'\n      defaultvalue='${this.state.value}' />\n      ${this.state.value}\n   </div>\n`\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢çä»£ç éè¿jsxå½æ°ï¼å°ä¸ä¸ª dom å­ç¬¦ä¸²è½¬ä¸º react å¯¹è±¡ãä½ å¯ä»¥å¨ github æ¾å°jsxå½æ°çå·ä½å®ç°ã\n\nä¸é¢åæ¯ä¸ä¸ªåæ³çä¾å­ï¼éè¿javaå½æ°ï¼å¨ javascript ä»£ç ä¹ä¸­è¿è¡ java ä»£ç ã\n\njava`\nclass helloworldapp {\n  public static void main(string[] args) {\n    system.out.println(\"hello world!\"); // display the string.\n  }\n}\n`\nhelloworldapp.main();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næ¨¡æ¿å¤çå½æ°çç¬¬ä¸ä¸ªåæ°ï¼æ¨¡æ¿å­ç¬¦ä¸²æ°ç»ï¼ï¼è¿æä¸ä¸ªrawå±æ§ã\n\nconsole.log`123`\n// [\"123\", raw: array[1]]\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼console.logæ¥åçåæ°ï¼å®éä¸æ¯ä¸ä¸ªæ°ç»ãè¯¥æ°ç»æä¸ä¸ªrawå±æ§ï¼ä¿å­çæ¯è½¬ä¹åçåå­ç¬¦ä¸²ã\n\nè¯·çä¸é¢çä¾å­ã\n\ntag`first line\\nsecond line`\n\nfunction tag(strings) {\n  console.log(strings.raw[0]);\n  // strings.raw[0] ä¸º \"first line\\\\nsecond line\"\n  // æå°è¾åº \"first line\\nsecond line\"\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼tagå½æ°çç¬¬ä¸ä¸ªåæ°stringsï¼æä¸ä¸ªrawå±æ§ï¼ä¹æåä¸ä¸ªæ°ç»ãè¯¥æ°ç»çæåä¸stringsæ°ç»å®å¨ä¸è´ãæ¯å¦ï¼stringsæ°ç»æ¯[\"first line\\nsecond line\"]ï¼é£ä¹strings.rawæ°ç»å°±æ¯[\"first line\\\\nsecond line\"]ãä¸¤èå¯ä¸çåºå«ï¼å°±æ¯å­ç¬¦ä¸²éé¢çææ é½è¢«è½¬ä¹äºãæ¯å¦ï¼strings.raw æ°ç»ä¼å°\\nè§ä¸º\\\\ånä¸¤ä¸ªå­ç¬¦ï¼èä¸æ¯æ¢è¡ç¬¦ãè¿æ¯ä¸ºäºæ¹ä¾¿åå¾è½¬ä¹ä¹åçåå§æ¨¡æ¿èè®¾è®¡çã\n\n\n# æ¨¡æ¿å­ç¬¦ä¸²çéå¶\n\nåé¢æå°æ ç­¾æ¨¡æ¿éé¢ï¼å¯ä»¥ååµå¶ä»è¯­è¨ãä½æ¯ï¼æ¨¡æ¿å­ç¬¦ä¸²é»è®¤ä¼å°å­ç¬¦ä¸²è½¬ä¹ï¼å¯¼è´æ æ³åµå¥å¶ä»è¯­è¨ã\n\nä¸¾ä¾æ¥è¯´ï¼æ ç­¾æ¨¡æ¿éé¢å¯ä»¥åµå¥ latex è¯­è¨ã\n\nfunction latex(strings) {\n  // ...\n}\n\nlet document = latex`\n\\newcommand{\\fun}{\\textbf{fun!}}  // æ­£å¸¸å·¥ä½\n\\newcommand{\\unicode}{\\textbf{unicode!}} // æ¥é\n\\newcommand{\\xerxes}{\\textbf{king!}} // æ¥é\n\nbreve over the h goes \\u{h}ere // æ¥é\n`\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼åédocumentååµçæ¨¡æ¿å­ç¬¦ä¸²ï¼å¯¹äº latex è¯­è¨æ¥è¯´å®å¨æ¯åæ³çï¼ä½æ¯ javascript å¼æä¼æ¥éãåå å°±å¨äºå­ç¬¦ä¸²çè½¬ä¹ã\n\næ¨¡æ¿å­ç¬¦ä¸²ä¼å°\\u00ffå\\u{42}å½ä½ unicode å­ç¬¦è¿è¡è½¬ä¹ï¼æä»¥\\unicodeè§£ææ¶æ¥éï¼è\\x56ä¼è¢«å½ä½åå­è¿å¶å­ç¬¦ä¸²è½¬ä¹ï¼æä»¥\\xerxesä¼æ¥éãä¹å°±æ¯è¯´ï¼\\uå\\xå¨ latex éé¢æç¹æ®å«ä¹ï¼ä½æ¯ javascript å°å®ä»¬è½¬ä¹äºã\n\nä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼es2018 æ¾æ¾äºå¯¹æ ç­¾æ¨¡æ¿éé¢çå­ç¬¦ä¸²è½¬ä¹çéå¶ãå¦æéå°ä¸åæ³çå­ç¬¦ä¸²è½¬ä¹ï¼å°±è¿åundefinedï¼èä¸æ¯æ¥éï¼å¹¶ä¸ä»rawå±æ§ä¸é¢å¯ä»¥å¾å°åå§å­ç¬¦ä¸²ã\n\nfunction tag(strs) {\n  strs[0] === undefined\n  strs.raw[0] === \"\\\\unicode and \\\\u{55}\";\n}\ntag`\\unicode and \\u{55}`\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¨¡æ¿å­ç¬¦ä¸²åæ¬æ¯åºè¯¥æ¥éçï¼ä½æ¯ç±äºæ¾æ¾äºå¯¹å­ç¬¦ä¸²è½¬ä¹çéå¶ï¼æä»¥ä¸æ¥éäºï¼javascript å¼æå°ç¬¬ä¸ä¸ªå­ç¬¦è®¾ç½®ä¸ºundefinedï¼ä½æ¯rawå±æ§ä¾ç¶å¯ä»¥å¾å°åå§å­ç¬¦ä¸²ï¼å æ­¤tagå½æ°è¿æ¯å¯ä»¥å¯¹åå­ç¬¦ä¸²è¿è¡å¤çã\n\næ³¨æï¼è¿ç§å¯¹å­ç¬¦ä¸²è½¬ä¹çæ¾æ¾ï¼åªå¨æ ç­¾æ¨¡æ¿è§£æå­ç¬¦ä¸²æ¶çæï¼ä¸æ¯æ ç­¾æ¨¡æ¿çåºåï¼ä¾ç¶ä¼æ¥éã\n\nlet bad = `bad escape sequence: \\unicode`; // æ¥é\n\n\n1\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Symbol",frontmatter:{title:"Symbol",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/02c86eb2792f3262",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/12.Symbol.html",relativePath:"ãES6 æç¨ãç¬è®°/12.Symbol.md",key:"v-1f5f8d8a",path:"/pages/02c86eb2792f3262/",headers:[{level:2,title:"æ¦è¿°",slug:"æ¦è¿°",normalizedTitle:"æ¦è¿°",charIndex:13},{level:2,title:"Symbol.prototype.description",slug:"symbol-prototype-description",normalizedTitle:"symbol.prototype.description",charIndex:1989},{level:2,title:"ä½ä¸ºå±æ§åç Symbol",slug:"ä½ä¸ºå±æ§åç-symbol",normalizedTitle:"ä½ä¸ºå±æ§åç symbol",charIndex:2361},{level:2,title:"å®ä¾ï¼æ¶é¤é­æ¯å­ç¬¦ä¸²",slug:"å®ä¾-æ¶é¤é­æ¯å­ç¬¦ä¸²",normalizedTitle:"å®ä¾ï¼æ¶é¤é­æ¯å­ç¬¦ä¸²",charIndex:4025},{level:2,title:"å±æ§åçéå",slug:"å±æ§åçéå",normalizedTitle:"å±æ§åçéå",charIndex:5150},{level:2,title:"Symbol.for()ï¼Symbol.keyFor()",slug:"symbol-for-symbol-keyfor",normalizedTitle:"symbol.for()ï¼symbol.keyfor()",charIndex:6973},{level:2,title:"å®ä¾ï¼æ¨¡åç Singleton æ¨¡å¼",slug:"å®ä¾-æ¨¡åç-singleton-æ¨¡å¼",normalizedTitle:"å®ä¾ï¼æ¨¡åç singleton æ¨¡å¼",charIndex:8487},{level:2,title:"åç½®ç Symbol å¼",slug:"åç½®ç-symbol-å¼",normalizedTitle:"åç½®ç symbol å¼",charIndex:9655},{level:3,title:"Symbol.hasInstance",slug:"symbol-hasinstance",normalizedTitle:"symbol.hasinstance",charIndex:9733},{level:3,title:"Symbol.isConcatSpreadable",slug:"symbol-isconcatspreadable",normalizedTitle:"symbol.isconcatspreadable",charIndex:10473},{level:3,title:"Symbol.species",slug:"symbol-species",normalizedTitle:"symbol.species",charIndex:11782},{level:3,title:"Symbol.match",slug:"symbol-match",normalizedTitle:"symbol.match",charIndex:13261},{level:3,title:"Symbol.replace",slug:"symbol-replace",normalizedTitle:"symbol.replace",charIndex:13572},{level:3,title:"Symbol.search",slug:"symbol-search",normalizedTitle:"symbol.search",charIndex:13999},{level:3,title:"Symbol.split",slug:"symbol-split",normalizedTitle:"symbol.split",charIndex:14375},{level:3,title:"Symbol.iterator",slug:"symbol-iterator",normalizedTitle:"symbol.iterator",charIndex:15135},{level:3,title:"Symbol.toPrimitive",slug:"symbol-toprimitive",normalizedTitle:"symbol.toprimitive",charIndex:15768},{level:3,title:"Symbol.toStringTag",slug:"symbol-tostringtag",normalizedTitle:"symbol.tostringtag",charIndex:16374},{level:3,title:"Symbol.unscopables",slug:"symbol-unscopables",normalizedTitle:"symbol.unscopables",charIndex:17756}],excerpt:'<h1 id="symbol"><a class="header-anchor" href="#symbol">#</a> Symbol</h1>\n<h2 id="æ¦è¿°"><a class="header-anchor" href="#æ¦è¿°">#</a> æ¦è¿°</h2>\n<p>ES5 çå¯¹è±¡å±æ§åé½æ¯å­ç¬¦ä¸²ï¼è¿å®¹æé æå±æ§åçå²çªãæ¯å¦ï¼ä½ ä½¿ç¨äºä¸ä¸ªä»äººæä¾çå¯¹è±¡ï¼ä½åæ³ä¸ºè¿ä¸ªå¯¹è±¡æ·»å æ°çæ¹æ³ï¼mixin æ¨¡å¼ï¼ï¼æ°æ¹æ³çåå­å°±æå¯è½ä¸ç°ææ¹æ³äº§çå²çªãå¦ææä¸ç§æºå¶ï¼<strong>ä¿è¯æ¯ä¸ªå±æ§çåå­é½æ¯ç¬ä¸æ äº</strong>çå°±å¥½äºï¼è¿æ ·å°±ä»æ ¹æ¬ä¸é²æ­¢å±æ§åçå²çªãè¿å°±æ¯ ES6 å¼å¥<code>Symbol</code>çåå ã</p>\n',headersStr:"æ¦è¿° Symbol.prototype.description ä½ä¸ºå±æ§åç Symbol å®ä¾ï¼æ¶é¤é­æ¯å­ç¬¦ä¸² å±æ§åçéå Symbol.for()ï¼Symbol.keyFor() å®ä¾ï¼æ¨¡åç Singleton æ¨¡å¼ åç½®ç Symbol å¼ Symbol.hasInstance Symbol.isConcatSpreadable Symbol.species Symbol.match Symbol.replace Symbol.search Symbol.split Symbol.iterator Symbol.toPrimitive Symbol.toStringTag Symbol.unscopables",content:"# Symbol\n\n\n# æ¦è¿°\n\nES5 çå¯¹è±¡å±æ§åé½æ¯å­ç¬¦ä¸²ï¼è¿å®¹æé æå±æ§åçå²çªãæ¯å¦ï¼ä½ ä½¿ç¨äºä¸ä¸ªä»äººæä¾çå¯¹è±¡ï¼ä½åæ³ä¸ºè¿ä¸ªå¯¹è±¡æ·»å æ°çæ¹æ³ï¼mixin æ¨¡å¼ï¼ï¼æ°æ¹æ³çåå­å°±æå¯è½ä¸ç°ææ¹æ³äº§çå²çªãå¦ææä¸ç§æºå¶ï¼ä¿è¯æ¯ä¸ªå±æ§çåå­é½æ¯ç¬ä¸æ äºçå°±å¥½äºï¼è¿æ ·å°±ä»æ ¹æ¬ä¸é²æ­¢å±æ§åçå²çªãè¿å°±æ¯ ES6 å¼å¥Symbolçåå ã\n\nES6 å¼å¥äºä¸ç§æ°çåå§æ°æ®ç±»åSymbolï¼è¡¨ç¤ºç¬ä¸æ äºçå¼ãå®æ¯ JavaScript è¯­è¨çç¬¬ä¸ç§æ°æ®ç±»åï¼åå­ç§æ¯ï¼undefinedãnullãå¸å°å¼ï¼Booleanï¼ãå­ç¬¦ä¸²ï¼Stringï¼ãæ°å¼ï¼Numberï¼ãå¯¹è±¡ï¼Objectï¼ã\n\nSymbol å¼éè¿Symbolå½æ°çæãè¿å°±æ¯è¯´ï¼**å¯¹è±¡çå±æ§åç°å¨å¯ä»¥æä¸¤ç§ç±»åï¼ä¸ç§æ¯åæ¥å°±æçå­ç¬¦ä¸²ï¼å¦ä¸ç§å°±æ¯æ°å¢ç Symbol ç±»åã**å¡æ¯å±æ§åå±äº Symbol ç±»åï¼å°±é½æ¯ç¬ä¸æ äºçï¼å¯ä»¥ä¿è¯ä¸ä¼ä¸å¶ä»å±æ§åäº§çå²çªã\n\nlet s = Symbol();\n\ntypeof s\n// \"symbol\"\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼åéså°±æ¯ä¸ä¸ªç¬ä¸æ äºçå¼ãtypeofè¿ç®ç¬¦çç»æï¼è¡¨æåésæ¯ Symbol æ°æ®ç±»åï¼èä¸æ¯å­ç¬¦ä¸²ä¹ç±»çå¶ä»ç±»åã\n\næ³¨æï¼Symbolå½æ°åä¸è½ä½¿ç¨newå½ä»¤ï¼å¦åä¼æ¥éãè¿æ¯å ä¸ºçæç Symbol æ¯ä¸ä¸ªåå§ç±»åçå¼ï¼ä¸æ¯å¯¹è±¡ãä¹å°±æ¯è¯´ï¼ç±äº Symbol å¼ä¸æ¯å¯¹è±¡ï¼æä»¥ä¸è½æ·»å å±æ§ãåºæ¬ä¸ï¼å®æ¯ä¸ç§ç±»ä¼¼äºå­ç¬¦ä¸²çæ°æ®ç±»åã\n\nSymbolå½æ°å¯ä»¥æ¥åä¸ä¸ªå­ç¬¦ä¸²ä½ä¸ºåæ°ï¼è¡¨ç¤ºå¯¹ Symbol å®ä¾çæè¿°ï¼ä¸»è¦æ¯ä¸ºäºå¨æ§å¶å°æ¾ç¤ºï¼æèè½¬ä¸ºå­ç¬¦ä¸²æ¶ï¼æ¯è¾å®¹æåºåã\n\nlet s1 = Symbol('foo');\nlet s2 = Symbol('bar');\n\ns1 // Symbol(foo)\ns2 // Symbol(bar)\n\ns1.toString() // \"Symbol(foo)\"\ns2.toString() // \"Symbol(bar)\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼s1ås2æ¯ä¸¤ä¸ª Symbol å¼ãå¦æä¸å åæ°ï¼å®ä»¬å¨æ§å¶å°çè¾åºé½æ¯Symbol()ï¼ä¸å©äºåºåãæäºåæ°ä»¥åï¼å°±ç­äºä¸ºå®ä»¬å ä¸äºæè¿°ï¼è¾åºçæ¶åå°±è½å¤åæ¸ï¼å°åºæ¯åªä¸ä¸ªå¼ã\n\nå¦æ Symbol çåæ°æ¯ä¸ä¸ªå¯¹è±¡ï¼å°±ä¼è°ç¨è¯¥å¯¹è±¡çtoStringæ¹æ³ï¼å°å¶è½¬ä¸ºå­ç¬¦ä¸²ï¼ç¶åæçæä¸ä¸ª Symbol å¼ã\n\nconst obj = {\n  toString() {\n    return 'abc';\n  }\n};\nconst sym = Symbol(obj);\nsym // Symbol(abc)\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næ³¨æï¼Symbolå½æ°çåæ°åªæ¯è¡¨ç¤ºå¯¹å½å Symbol å¼çæè¿°ï¼å æ­¤ç¸ååæ°çSymbolå½æ°çè¿åå¼æ¯ä¸ç¸ç­çã\n\n// æ²¡æåæ°çæåµ\nlet s1 = Symbol();\nlet s2 = Symbol();\n\ns1 === s2 // false\n\n// æåæ°çæåµ\nlet s1 = Symbol('foo');\nlet s2 = Symbol('foo');\n\ns1 === s2 // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼s1ås2é½æ¯Symbolå½æ°çè¿åå¼ï¼èä¸åæ°ç¸åï¼ä½æ¯å®ä»¬æ¯ä¸ç¸ç­çã\n\nSymbol å¼ä¸è½ä¸å¶ä»ç±»åçå¼è¿è¡è¿ç®ï¼ä¼æ¥éã\n\nlet sym = Symbol('My symbol');\n\n\"your symbol is \" + sym\n// TypeError: can't convert symbol to string\n`your symbol is ${sym}`\n// TypeError: can't convert symbol to string\n\n\n1\n2\n3\n4\n5\n6\n\n\nä½æ¯ï¼Symbol å¼å¯ä»¥æ¾å¼è½¬ä¸ºå­ç¬¦ä¸²ã\n\nlet sym = Symbol('My symbol');\n\nString(sym) // 'Symbol(My symbol)'\nsym.toString() // 'Symbol(My symbol)'\n\n\n1\n2\n3\n4\n\n\nå¦å¤ï¼Symbol å¼ä¹å¯ä»¥è½¬ä¸ºå¸å°å¼ï¼ä½æ¯ä¸è½è½¬ä¸ºæ°å¼ã\n\nlet sym = Symbol();\nBoolean(sym) // true\n!sym  // false\n\nif (sym) {\n  // ...\n}\n\nNumber(sym) // TypeError\nsym + 2 // TypeError\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# Symbol.prototype.description\n\nåå»º Symbol çæ¶åï¼å¯ä»¥æ·»å ä¸ä¸ªæè¿°ã\n\nconst sym = Symbol('foo');\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼symçæè¿°å°±æ¯å­ç¬¦ä¸²fooã\n\nä½æ¯ï¼è¯»åè¿ä¸ªæè¿°éè¦å° Symbol æ¾å¼è½¬ä¸ºå­ç¬¦ä¸²ï¼å³ä¸é¢çåæ³ã\n\nconst sym = Symbol('foo');\n\nString(sym) // \"Symbol(foo)\"\nsym.toString() // \"Symbol(foo)\"\n\n\n1\n2\n3\n4\n\n\nä¸é¢çç¨æ³ä¸æ¯å¾æ¹ä¾¿ãES2019 æä¾äºä¸ä¸ªå®ä¾å±æ§descriptionï¼ç´æ¥è¿å Symbol çæè¿°ã\n\nconst sym = Symbol('foo');\n\nsym.description // \"foo\"\n\n\n1\n2\n3\n\n\n\n# ä½ä¸ºå±æ§åç Symbol\n\nç±äºæ¯ä¸ä¸ª Symbol å¼é½æ¯ä¸ç¸ç­çï¼è¿æå³ç Symbol å¼å¯ä»¥ä½ä¸ºæ è¯ç¬¦ï¼ç¨äºå¯¹è±¡çå±æ§åï¼å°±è½ä¿è¯ä¸ä¼åºç°ååçå±æ§ãè¿å¯¹äºä¸ä¸ªå¯¹è±¡ç±å¤ä¸ªæ¨¡åææçæåµéå¸¸æç¨ï¼è½é²æ­¢æä¸ä¸ªé®è¢«ä¸å°å¿æ¹åæè¦çã\n\nlet mySymbol = Symbol();\n\n// ç¬¬ä¸ç§åæ³\nlet a = {};\na[mySymbol] = 'Hello!';\n\n// ç¬¬äºç§åæ³\nlet a = {\n  [mySymbol]: 'Hello!'\n};\n\n// ç¬¬ä¸ç§åæ³\nlet a = {};\nObject.defineProperty(a, mySymbol, { value: 'Hello!' });\n\n// ä»¥ä¸åæ³é½å¾å°åæ ·ç»æ\na[mySymbol] // \"Hello!\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç éè¿æ¹æ¬å·ç»æåObject.definePropertyï¼å°å¯¹è±¡çå±æ§åæå®ä¸ºä¸ä¸ª Symbol å¼ã\n\næ³¨æï¼Symbol å¼ä½ä¸ºå¯¹è±¡å±æ§åæ¶ï¼ä¸è½ç¨ç¹è¿ç®ç¬¦ã\n\nconst mySymbol = Symbol();\nconst a = {};\n\na.mySymbol = 'Hello!';\na[mySymbol] // undefined\na['mySymbol'] // \"Hello!\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å ä¸ºç¹è¿ç®ç¬¦åé¢æ»æ¯å­ç¬¦ä¸²ï¼æä»¥ä¸ä¼è¯»åmySymbolä½ä¸ºæ è¯åææä»£çé£ä¸ªå¼ï¼å¯¼è´açå±æ§åå®éä¸æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼èä¸æ¯ä¸ä¸ª Symbol å¼ã\n\nåçï¼å¨å¯¹è±¡çåé¨ï¼ä½¿ç¨ Symbol å¼å®ä¹å±æ§æ¶ï¼Symbol å¼å¿é¡»æ¾å¨æ¹æ¬å·ä¹ä¸­ã\n\nlet s = Symbol();\n\nlet obj = {\n  [s]: function (arg) { ... }\n};\n\nobj[s](123);\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æsä¸æ¾å¨æ¹æ¬å·ä¸­ï¼è¯¥å±æ§çé®åå°±æ¯å­ç¬¦ä¸²sï¼èä¸æ¯sæä»£è¡¨çé£ä¸ª Symbol å¼ã\n\néç¨å¢å¼ºçå¯¹è±¡åæ³ï¼ä¸é¢ä»£ç çobjå¯¹è±¡å¯ä»¥åå¾æ´ç®æ´ä¸äºã\n\nlet obj = {\n  [s](arg) { ... }\n};\n\n\n1\n2\n3\n\n\nSymbol ç±»åè¿å¯ä»¥ç¨äºå®ä¹ä¸ç»å¸¸éï¼ä¿è¯è¿ç»å¸¸éçå¼é½æ¯ä¸ç¸ç­çã\n\nconst log = {};\n\nlog.levels = {\n  DEBUG: Symbol('debug'),\n  INFO: Symbol('info'),\n  WARN: Symbol('warn')\n};\nconsole.log(log.levels.DEBUG, 'debug message');\nconsole.log(log.levels.INFO, 'info message');\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢æ¯å¦å¤ä¸ä¸ªä¾å­ã\n\nconst COLOR_RED    = Symbol();\nconst COLOR_GREEN  = Symbol();\n\nfunction getComplement(color) {\n  switch (color) {\n    case COLOR_RED:\n      return COLOR_GREEN;\n    case COLOR_GREEN:\n      return COLOR_RED;\n    default:\n      throw new Error('Undefined color');\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nå¸¸éä½¿ç¨ Symbol å¼æå¤§çå¥½å¤ï¼å°±æ¯å¶ä»ä»»ä½å¼é½ä¸å¯è½æç¸åçå¼äºï¼å æ­¤å¯ä»¥ä¿è¯ä¸é¢çswitchè¯­å¥ä¼æè®¾è®¡çæ¹å¼å·¥ä½ã\n\nè¿æä¸ç¹éè¦æ³¨æï¼Symbol å¼ä½ä¸ºå±æ§åæ¶ï¼è¯¥å±æ§è¿æ¯å¬å¼å±æ§ï¼ä¸æ¯ç§æå±æ§ã\n\n\n# å®ä¾ï¼æ¶é¤é­æ¯å­ç¬¦ä¸²\n\né­æ¯å­ç¬¦ä¸²æçæ¯ï¼å¨ä»£ç ä¹ä¸­å¤æ¬¡åºç°ãä¸ä»£ç å½¢æå¼ºè¦åçæä¸ä¸ªå·ä½çå­ç¬¦ä¸²æèæ°å¼ãé£æ ¼è¯å¥½çä»£ç ï¼åºè¯¥å°½éæ¶é¤é­æ¯å­ç¬¦ä¸²ï¼æ¹ç±å«ä¹æ¸æ°çåéä»£æ¿ã\n\nfunction getArea(shape, options) {\n  let area = 0;\n\n  switch (shape) {\n    case 'Triangle': // é­æ¯å­ç¬¦ä¸²\n      area = .5 * options.width * options.height;\n      break;\n    /* ... more code ... */\n  }\n\n  return area;\n}\n\ngetArea('Triangle', { width: 100, height: 100 }); // é­æ¯å­ç¬¦ä¸²\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç¬¦ä¸²Triangleå°±æ¯ä¸ä¸ªé­æ¯å­ç¬¦ä¸²ãå®å¤æ¬¡åºç°ï¼ä¸ä»£ç å½¢æâå¼ºè¦åâï¼ä¸å©äºå°æ¥çä¿®æ¹åç»´æ¤ã\n\n> ç¬è®°ï¼\n> \n> Triangleå­ç¬¦ä¸²å¨ä»£ç ä¸­åºç°å¤æ¬¡ï¼å¦æåææ³ä¿®æ¹è¿ä¸ªå­ç¬¦ä¸²éè¦ä¿®æ¹å¾å¤å¤ï¼ä¸å©äºç»´æ¤ã\n\nå¸¸ç¨çæ¶é¤é­æ¯å­ç¬¦ä¸²çæ¹æ³ï¼å°±æ¯æå®åæä¸ä¸ªåéã\n\nconst shapeType = {\n  triangle: 'Triangle'\n};\n\nfunction getArea(shape, options) {\n  let area = 0;\n  switch (shape) {\n    case shapeType.triangle:\n      area = .5 * options.width * options.height;\n      break;\n  }\n  return area;\n}\n\ngetArea(shapeType.triangle, { width: 100, height: 100 });\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼æä»¬æTriangleåæshapeTypeå¯¹è±¡çtriangleå±æ§ï¼è¿æ ·å°±æ¶é¤äºå¼ºè¦åã\n\nå¦æä»ç»åæï¼å¯ä»¥åç°shapeType.triangleç­äºåªä¸ªå¼å¹¶ä¸éè¦ï¼åªè¦ç¡®ä¿ä¸ä¼è·å¶ä»shapeTypeå±æ§çå¼å²çªå³å¯ãå æ­¤ï¼è¿éå°±å¾éåæ¹ç¨ Symbol å¼ã\n\nconst shapeType = {\n  triangle: Symbol()\n};\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼é¤äºå°shapeType.triangleçå¼è®¾ä¸ºä¸ä¸ª Symbolï¼å¶ä»å°æ¹é½ä¸ç¨ä¿®æ¹ã\n\n\n# å±æ§åçéå\n\nSymbol ä½ä¸ºå±æ§åï¼éåå¯¹è±¡çæ¶åï¼è¯¥å±æ§ä¸ä¼åºç°å¨for...inãfor...ofå¾ªç¯ä¸­ï¼ä¹ä¸ä¼è¢«Object.keys()ãObject.getOwnPropertyNames()ãJSON.stringify()è¿åã\n\nä½æ¯ï¼å®ä¹ä¸æ¯ç§æå±æ§ï¼æä¸ä¸ª**Object.getOwnPropertySymbols()æ¹æ³ï¼å¯ä»¥è·åæå®å¯¹è±¡çææ Symbol å±æ§å**ãè¯¥æ¹æ³è¿åä¸ä¸ªæ°ç»ï¼æåæ¯å½åå¯¹è±¡çææç¨ä½å±æ§åç Symbol å¼ã\n\nconst obj = {};\nlet a = Symbol('a');\nlet b = Symbol('b');\n\nobj[a] = 'Hello';\nobj[b] = 'World';\n\nconst objectSymbols = Object.getOwnPropertySymbols(obj);\n\nobjectSymbols\n// [Symbol(a), Symbol(b)]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç æ¯Object.getOwnPropertySymbols()æ¹æ³çç¤ºä¾ï¼å¯ä»¥è·åææ Symbol å±æ§åã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ï¼Object.getOwnPropertySymbols()æ¹æ³ä¸for...inå¾ªç¯ãObject.getOwnPropertyNamesæ¹æ³è¿è¡å¯¹æ¯çä¾å­ã\n\nconst obj = {};\nconst foo = Symbol('foo');\n\nobj[foo] = 'bar';\n\nfor (let i in obj) {\n  console.log(i); // æ è¾åº\n}\n\nObject.getOwnPropertyNames(obj) // []\nObject.getOwnPropertySymbols(obj) // [Symbol(foo)]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ä½¿ç¨for...inå¾ªç¯åObject.getOwnPropertyNames()æ¹æ³é½å¾ä¸å° Symbol é®åï¼éè¦ä½¿ç¨Object.getOwnPropertySymbols()æ¹æ³ã\n\nå¦ä¸ä¸ªæ°ç APIï¼Reflect.ownKeys()æ¹æ³å¯ä»¥è¿åææç±»åçé®åï¼åæ¬å¸¸è§é®åå Symbol é®åã\n\nlet obj = {\n  [Symbol('my_key')]: 1,\n  enum: 2,\n  nonEnum: 3\n};\n\nReflect.ownKeys(obj)\n//  [\"enum\", \"nonEnum\", Symbol(my_key)]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nç±äºä»¥ Symbol å¼ä½ä¸ºé®åï¼ä¸ä¼è¢«å¸¸è§æ¹æ³éåå¾å°ãæä»¬å¯ä»¥å©ç¨è¿ä¸ªç¹æ§ï¼ä¸ºå¯¹è±¡å®ä¹ä¸äºéç§æçãä½åå¸æåªç¨äºåé¨çæ¹æ³ã\n\nlet size = Symbol('size');\n\nclass Collection {\n  constructor() {\n    this[size] = 0;\n  }\n\n  add(item) {\n    this[this[size]] = item;\n    this[size]++;\n  }\n\n  static sizeOf(instance) {\n    return instance[size];\n  }\n}\n\nlet x = new Collection();\nCollection.sizeOf(x) // 0\n\nx.add('foo');\nCollection.sizeOf(x) // 1\n\nObject.keys(x) // ['0']\nObject.getOwnPropertyNames(x) // ['0']\nObject.getOwnPropertySymbols(x) // [Symbol(size)]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯¹è±¡xçsizeå±æ§æ¯ä¸ä¸ª Symbol å¼ï¼æä»¥Object.keys(x)ãObject.getOwnPropertyNames(x)é½æ æ³è·åå®ãè¿å°±é æäºä¸ç§éç§æçåé¨æ¹æ³çææã\n\n\n# Symbol.for()ï¼Symbol.keyFor()\n\nææ¶ï¼æä»¬å¸æéæ°ä½¿ç¨åä¸ä¸ª Symbol å¼ï¼Symbol.for()æ¹æ³å¯ä»¥åå°è¿ä¸ç¹ãå®æ¥åä¸ä¸ªå­ç¬¦ä¸²ä½ä¸ºåæ°ï¼ç¶åæç´¢ææ²¡æä»¥è¯¥åæ°ä½ä¸ºåç§°ç Symbol å¼ãå¦ææï¼å°±è¿åè¿ä¸ª Symbol å¼ï¼å¦åå°±æ°å»ºä¸ä¸ªä»¥è¯¥å­ç¬¦ä¸²ä¸ºåç§°ç Symbol å¼ï¼å¹¶å°å¶æ³¨åå°å¨å±ã\n\nlet s1 = Symbol.for('foo');\nlet s2 = Symbol.for('foo');\n\ns1 === s2 // true\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼s1ås2é½æ¯ Symbol å¼ï¼ä½æ¯å®ä»¬é½æ¯åæ ·åæ°çSymbol.foræ¹æ³çæçï¼æä»¥å®éä¸æ¯åä¸ä¸ªå¼ã\n\nSymbol.for()ä¸Symbol()è¿ä¸¤ç§åæ³ï¼é½ä¼çææ°ç Symbolãå®ä»¬çåºå«æ¯ï¼åèä¼è¢«ç»è®°å¨å¨å±ç¯å¢ä¸­ä¾æç´¢ï¼åèä¸ä¼ãSymbol.for()ä¸ä¼æ¯æ¬¡è°ç¨å°±è¿åä¸ä¸ªæ°ç Symbol ç±»åçå¼ï¼èæ¯ä¼åæ£æ¥ç»å®çkeyæ¯å¦å·²ç»å­å¨ï¼å¦æä¸å­å¨æä¼æ°å»ºä¸ä¸ªå¼ãæ¯å¦ï¼å¦æä½ è°ç¨Symbol.for(\"cat\")30 æ¬¡ï¼æ¯æ¬¡é½ä¼è¿ååä¸ä¸ª Symbol å¼ï¼ä½æ¯è°ç¨Symbol(\"cat\")30 æ¬¡ï¼ä¼è¿å 30 ä¸ªä¸åç Symbol å¼ã\n\nSymbol.for(\"bar\") === Symbol.for(\"bar\")\n// true\n\nSymbol(\"bar\") === Symbol(\"bar\")\n// false\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºSymbol()åæ³æ²¡æç»è®°æºå¶ï¼æä»¥æ¯æ¬¡è°ç¨é½ä¼è¿åä¸ä¸ªä¸åçå¼ã\n\nSymbol.keyFor()æ¹æ³è¿åä¸ä¸ªå·²ç»è®°ç Symbol ç±»åå¼çkeyã\n\nlet s1 = Symbol.for(\"foo\");\nSymbol.keyFor(s1) // \"foo\"\n\nlet s2 = Symbol(\"foo\");\nSymbol.keyFor(s2) // undefined\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼åés2å±äºæªç»è®°ç Symbol å¼ï¼æä»¥è¿åundefinedã\n\næ³¨æï¼Symbol.for()ä¸º Symbol å¼ç»è®°çåå­ï¼æ¯å¨å±ç¯å¢çï¼ä¸ç®¡ææ²¡æå¨å¨å±ç¯å¢è¿è¡ã\n\nfunction foo() {\n  return Symbol.for('bar');\n}\n\nconst x = foo();\nconst y = Symbol.for('bar');\nconsole.log(x === y); // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼Symbol.for('bar')æ¯å½æ°åé¨è¿è¡çï¼ä½æ¯çæç Symbol å¼æ¯ç»è®°å¨å¨å±ç¯å¢çãæä»¥ï¼ç¬¬äºæ¬¡è¿è¡Symbol.for('bar')å¯ä»¥åå°è¿ä¸ª Symbol å¼ã\n\nSymbol.for()çè¿ä¸ªå¨å±ç»è®°ç¹æ§ï¼å¯ä»¥ç¨å¨ä¸åç iframe æ service worker ä¸­åå°åä¸ä¸ªå¼ã\n\niframe = document.createElement('iframe');\niframe.src = String(window.location);\ndocument.body.appendChild(iframe);\n\niframe.contentWindow.Symbol.for('foo') === Symbol.for('foo')\n// true\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼iframe çªå£çæç Symbol å¼ï¼å¯ä»¥å¨ä¸»é¡µé¢å¾å°ã\n\n\n# å®ä¾ï¼æ¨¡åç Singleton æ¨¡å¼\n\nSingleton æ¨¡å¼æçæ¯è°ç¨ä¸ä¸ªç±»ï¼ä»»ä½æ¶åè¿åçé½æ¯åä¸ä¸ªå®ä¾ã\n\nå¯¹äº Node æ¥è¯´ï¼æ¨¡åæä»¶å¯ä»¥çææ¯ä¸ä¸ªç±»ãæä¹ä¿è¯æ¯æ¬¡æ§è¡è¿ä¸ªæ¨¡åæä»¶ï¼è¿åçé½æ¯åä¸ä¸ªå®ä¾å¢ï¼\n\nå¾å®¹ææ³å°ï¼å¯ä»¥æå®ä¾æ¾å°é¡¶å±å¯¹è±¡globalã\n\n// mod.js\nfunction A() {\n  this.foo = 'hello';\n}\n\nif (!global._foo) {\n  global._foo = new A();\n}\n\nmodule.exports = global._foo;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nç¶åï¼å è½½ä¸é¢çmod.jsã\n\nconst a = require('./mod.js');\nconsole.log(a.foo);\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼åéaä»»ä½æ¶åå è½½çé½æ¯Açåä¸ä¸ªå®ä¾ã\n\nä½æ¯ï¼è¿éæä¸ä¸ªé®é¢ï¼å¨å±åéglobal._fooæ¯å¯åçï¼ä»»ä½æä»¶é½å¯ä»¥ä¿®æ¹ã\n\nglobal._foo = { foo: 'world' };\n\nconst a = require('./mod.js');\nconsole.log(a.foo);\n\n\n1\n2\n3\n4\n\n\nä¸é¢çä»£ç ï¼ä¼ä½¿å¾å è½½mod.jsçèæ¬é½å¤±çã\n\nä¸ºäºé²æ­¢è¿ç§æåµåºç°ï¼æä»¬å°±å¯ä»¥ä½¿ç¨ Symbolã\n\n// mod.js\nconst FOO_KEY = Symbol.for('foo');\n\nfunction A() {\n  this.foo = 'hello';\n}\n\nif (!global[FOO_KEY]) {\n  global[FOO_KEY] = new A();\n}\n\nmodule.exports = global[FOO_KEY];\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯ä»¥ä¿è¯global[FOO_KEY]ä¸ä¼è¢«æ æé´è¦çï¼ä½è¿æ¯å¯ä»¥è¢«æ¹åã\n\nglobal[Symbol.for('foo')] = { foo: 'world' };\n\nconst a = require('./mod.js');\n\n\n1\n2\n3\n\n\nå¦æé®åä½¿ç¨Symbolæ¹æ³çæï¼é£ä¹å¤é¨å°æ æ³å¼ç¨è¿ä¸ªå¼ï¼å½ç¶ä¹å°±æ æ³æ¹åã\n\n// mod.js\nconst FOO_KEY = Symbol('foo');\n\n// åé¢ä»£ç ç¸å â¦â¦\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç å°å¯¼è´å¶ä»èæ¬é½æ æ³å¼ç¨FOO_KEYãä½è¿æ ·ä¹æä¸ä¸ªé®é¢ï¼å°±æ¯å¦æå¤æ¬¡æ§è¡è¿ä¸ªèæ¬ï¼æ¯æ¬¡å¾å°çFOO_KEYé½æ¯ä¸ä¸æ ·çãè½ç¶ Node ä¼å°èæ¬çæ§è¡ç»æç¼å­ï¼ä¸è¬æåµä¸ï¼ä¸ä¼å¤æ¬¡æ§è¡åä¸ä¸ªèæ¬ï¼ä½æ¯ç¨æ·å¯ä»¥æå¨æ¸é¤ç¼å­ï¼æä»¥ä¹ä¸æ¯ç»å¯¹å¯é ã\n\n\n# åç½®ç Symbol å¼\n\né¤äºå®ä¹èªå·±ä½¿ç¨ç Symbol å¼ä»¥å¤ï¼ES6 è¿æä¾äº 11 ä¸ªåç½®ç Symbol å¼ï¼æåè¯­è¨åé¨ä½¿ç¨çæ¹æ³ã\n\n\n# Symbol.hasInstance\n\nå¯¹è±¡çSymbol.hasInstanceå±æ§ï¼æåä¸ä¸ªåé¨æ¹æ³ãå½å¶ä»å¯¹è±¡ä½¿ç¨instanceofè¿ç®ç¬¦ï¼å¤æ­æ¯å¦ä¸ºè¯¥å¯¹è±¡çå®ä¾æ¶ï¼ä¼è°ç¨è¿ä¸ªæ¹æ³ãæ¯å¦ï¼foo instanceof Fooå¨è¯­è¨åé¨ï¼å®éè°ç¨çæ¯Foo[Symbol.hasInstance](foo)ã\n\nclass MyClass {\n  [Symbol.hasInstance](foo) {\n    return foo instanceof Array;\n  }\n}\n\n[1, 2, 3] instanceof new MyClass() // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼MyClassæ¯ä¸ä¸ªç±»ï¼new MyClass()ä¼è¿åä¸ä¸ªå®ä¾ãè¯¥å®ä¾çSymbol.hasInstanceæ¹æ³ï¼ä¼å¨è¿è¡instanceofè¿ç®æ¶èªå¨è°ç¨ï¼å¤æ­å·¦ä¾§çè¿ç®å­æ¯å¦ä¸ºArrayçå®ä¾ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nclass Even {\n  static [Symbol.hasInstance](obj) {\n    return Number(obj) % 2 === 0;\n  }\n}\n\n// ç­åäº\nconst Even = {\n  [Symbol.hasInstance](obj) {\n    return Number(obj) % 2 === 0;\n  }\n};\n\n1 instanceof Even // false\n2 instanceof Even // true\n12345 instanceof Even // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n# Symbol.isConcatSpreadable\n\nå¯¹è±¡çSymbol.isConcatSpreadableå±æ§ç­äºä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºè¯¥å¯¹è±¡ç¨äºArray.prototype.concat()æ¶ï¼æ¯å¦å¯ä»¥å±å¼ã\n\nlet arr1 = ['c', 'd'];\n['a', 'b'].concat(arr1, 'e') // ['a', 'b', 'c', 'd', 'e']\narr1[Symbol.isConcatSpreadable] // undefined\n\nlet arr2 = ['c', 'd'];\narr2[Symbol.isConcatSpreadable] = false;\n['a', 'b'].concat(arr2, 'e') // ['a', 'b', ['c','d'], 'e']\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç è¯´æï¼æ°ç»çé»è®¤è¡ä¸ºæ¯å¯ä»¥å±å¼ï¼Symbol.isConcatSpreadableé»è®¤ç­äºundefinedãè¯¥å±æ§ç­äºtrueæ¶ï¼ä¹æå±å¼çææã\n\nç±»ä¼¼æ°ç»çå¯¹è±¡æ­£å¥½ç¸åï¼é»è®¤ä¸å±å¼ãå®çSymbol.isConcatSpreadableå±æ§è®¾ä¸ºtrueï¼æå¯ä»¥å±å¼ã\n\nlet obj = {length: 2, 0: 'c', 1: 'd'};\n['a', 'b'].concat(obj, 'e') // ['a', 'b', obj, 'e']\n\nobj[Symbol.isConcatSpreadable] = true;\n['a', 'b'].concat(obj, 'e') // ['a', 'b', 'c', 'd', 'e']\n\n\n1\n2\n3\n4\n5\n\n\nSymbol.isConcatSpreadableå±æ§ä¹å¯ä»¥å®ä¹å¨ç±»éé¢ã\n\nclass A1 extends Array {\n  constructor(args) {\n    super(args);\n    this[Symbol.isConcatSpreadable] = true;\n  }\n}\nclass A2 extends Array {\n  constructor(args) {\n    super(args);\n  }\n  get [Symbol.isConcatSpreadable] () {\n    return false;\n  }\n}\nlet a1 = new A1();\na1[0] = 3;\na1[1] = 4;\nlet a2 = new A2();\na2[0] = 5;\na2[1] = 6;\n[1, 2].concat(a1).concat(a2)\n// [1, 2, 3, 4, [5, 6]]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±»A1æ¯å¯å±å¼çï¼ç±»A2æ¯ä¸å¯å±å¼çï¼æä»¥ä½¿ç¨concatæ¶æä¸ä¸æ ·çç»æã\n\næ³¨æï¼Symbol.isConcatSpreadableçä½ç½®å·®å¼ï¼A1æ¯å®ä¹å¨å®ä¾ä¸ï¼A2æ¯å®ä¹å¨ç±»æ¬èº«ï¼ææç¸åã\n\n\n# Symbol.species\n\nå¯¹è±¡çSymbol.specieså±æ§ï¼æåä¸ä¸ªæé å½æ°ãåå»ºè¡çå¯¹è±¡æ¶ï¼ä¼ä½¿ç¨è¯¥å±æ§ã\n\nclass MyArray extends Array {\n}\n\nconst a = new MyArray(1, 2, 3);\nconst b = a.map(x => x);\nconst c = a.filter(x => x > 1);\n\nb instanceof MyArray // true\nc instanceof MyArray // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç±»MyArrayç»§æ¿äºç¶ç±»Arrayï¼aæ¯MyArrayçå®ä¾ï¼båcæ¯açè¡çå¯¹è±¡ãä½ å¯è½ä¼è®¤ä¸ºï¼båcé½æ¯è°ç¨æ°ç»æ¹æ³çæçï¼æä»¥åºè¯¥æ¯æ°ç»ï¼Arrayçå®ä¾ï¼ï¼ä½å®éä¸å®ä»¬ä¹æ¯MyArrayçå®ä¾ã\n\nSymbol.specieså±æ§å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢èæä¾çãç°å¨ï¼æä»¬å¯ä»¥ä¸ºMyArrayè®¾ç½®Symbol.specieså±æ§ã\n\nclass MyArray extends Array {\n  static get [Symbol.species]() { return Array; }\n}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºå®ä¹äºSymbol.specieså±æ§ï¼åå»ºè¡çå¯¹è±¡æ¶å°±ä¼ä½¿ç¨è¿ä¸ªå±æ§è¿åçå½æ°ï¼ä½ä¸ºæé å½æ°ãè¿ä¸ªä¾å­ä¹è¯´æï¼å®ä¹Symbol.specieså±æ§è¦éç¨getåå¼å¨ãé»è®¤çSymbol.specieså±æ§ç­åäºä¸é¢çåæ³ã\n\nstatic get [Symbol.species]() {\n  return this;\n}\n\n\n1\n2\n3\n\n\nç°å¨ï¼åæ¥çåé¢çä¾å­ã\n\nclass MyArray extends Array {\n  static get [Symbol.species]() { return Array; }\n}\n\nconst a = new MyArray();\nconst b = a.map(x => x);\n\nb instanceof MyArray // false\nb instanceof Array // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼a.map(x => x)çæçè¡çå¯¹è±¡ï¼å°±ä¸æ¯MyArrayçå®ä¾ï¼èç´æ¥å°±æ¯Arrayçå®ä¾ã\n\nåçä¸ä¸ªä¾å­ã\n\nclass T1 extends Promise {\n}\n\nclass T2 extends Promise {\n  static get [Symbol.species]() {\n    return Promise;\n  }\n}\n\nnew T1(r => r()).then(v => v) instanceof T1 // true\nnew T2(r => r()).then(v => v) instanceof T2 // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼T2å®ä¹äºSymbol.specieså±æ§ï¼T1æ²¡æãç»æå°±å¯¼è´äºåå»ºè¡çå¯¹è±¡æ¶ï¼thenæ¹æ³ï¼ï¼T1è°ç¨çæ¯èªèº«çæé æ¹æ³ï¼èT2è°ç¨çæ¯Promiseçæé æ¹æ³ã\n\næ»ä¹ï¼Symbol.speciesçä½ç¨å¨äºï¼å®ä¾å¯¹è±¡å¨è¿è¡è¿ç¨ä¸­ï¼éè¦åæ¬¡è°ç¨èªèº«çæé å½æ°æ¶ï¼ä¼è°ç¨è¯¥å±æ§æå®çæé å½æ°ãå®ä¸»è¦çç¨éæ¯ï¼æäºç±»åºæ¯å¨åºç±»çåºç¡ä¸ä¿®æ¹çï¼é£ä¹å­ç±»ä½¿ç¨ç»§æ¿çæ¹æ³æ¶ï¼ä½èå¯è½å¸æè¿ååºç±»çå®ä¾ï¼èä¸æ¯å­ç±»çå®ä¾ã\n\n\n# Symbol.match\n\nå¯¹è±¡çSymbol.matchå±æ§ï¼æåä¸ä¸ªå½æ°ãå½æ§è¡str.match(myObject)æ¶ï¼å¦æè¯¥å±æ§å­å¨ï¼ä¼è°ç¨å®ï¼è¿åè¯¥æ¹æ³çè¿åå¼ã\n\nString.prototype.match(regexp)\n// ç­åäº\nregexp[Symbol.match](this)\n\nclass MyMatcher {\n  [Symbol.match](string) {\n    return 'hello world'.indexOf(string);\n  }\n}\n\n'e'.match(new MyMatcher()) // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# Symbol.replace\n\nå¯¹è±¡çSymbol.replaceå±æ§ï¼æåä¸ä¸ªæ¹æ³ï¼å½è¯¥å¯¹è±¡è¢«String.prototype.replaceæ¹æ³è°ç¨æ¶ï¼ä¼è¿åè¯¥æ¹æ³çè¿åå¼ã\n\nString.prototype.replace(searchValue, replaceValue)\n// ç­åäº\nsearchValue[Symbol.replace](this, replaceValue)\n\n\n1\n2\n3\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nconst x = {};\nx[Symbol.replace] = (...s) => console.log(s);\n\n'Hello'.replace(x, 'World') // [\"Hello\", \"World\"]\n\n\n1\n2\n3\n4\n\n\nSymbol.replaceæ¹æ³ä¼æ¶å°ä¸¤ä¸ªåæ°ï¼ç¬¬ä¸ä¸ªåæ°æ¯replaceæ¹æ³æ­£å¨ä½ç¨çå¯¹è±¡ï¼ä¸é¢ä¾å­æ¯Helloï¼ç¬¬äºä¸ªåæ°æ¯æ¿æ¢åçå¼ï¼ä¸é¢ä¾å­æ¯Worldã\n\n\n# Symbol.search\n\nå¯¹è±¡çSymbol.searchå±æ§ï¼æåä¸ä¸ªæ¹æ³ï¼å½è¯¥å¯¹è±¡è¢«String.prototype.searchæ¹æ³è°ç¨æ¶ï¼ä¼è¿åè¯¥æ¹æ³çè¿åå¼ã\n\nString.prototype.search(regexp)\n// ç­åäº\nregexp[Symbol.search](this)\n\nclass MySearch {\n  constructor(value) {\n    this.value = value;\n  }\n  [Symbol.search](string) {\n    return string.indexOf(this.value);\n  }\n}\n'foobar'.search(new MySearch('foo')) // 0\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# Symbol.split\n\nå¯¹è±¡çSymbol.splitå±æ§ï¼æåä¸ä¸ªæ¹æ³ï¼å½è¯¥å¯¹è±¡è¢«String.prototype.splitæ¹æ³è°ç¨æ¶ï¼ä¼è¿åè¯¥æ¹æ³çè¿åå¼ã\n\nString.prototype.split(separator, limit)\n// ç­åäº\nseparator[Symbol.split](this, limit)\n\n\n1\n2\n3\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nclass MySplitter {\n  constructor(value) {\n    this.value = value;\n  }\n  [Symbol.split](string) {\n    let index = string.indexOf(this.value);\n    if (index === -1) {\n      return string;\n    }\n    return [\n      string.substr(0, index),\n      string.substr(index + this.value.length)\n    ];\n  }\n}\n\n'foobar'.split(new MySplitter('foo'))\n// ['', 'bar']\n\n'foobar'.split(new MySplitter('bar'))\n// ['foo', '']\n\n'foobar'.split(new MySplitter('baz'))\n// 'foobar'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nä¸é¢æ¹æ³ä½¿ç¨Symbol.splitæ¹æ³ï¼éæ°å®ä¹äºå­ç¬¦ä¸²å¯¹è±¡çsplitæ¹æ³çè¡ä¸ºï¼\n\n\n# Symbol.iterator\n\nå¯¹è±¡çSymbol.iteratorå±æ§ï¼æåè¯¥å¯¹è±¡çé»è®¤éåå¨æ¹æ³ã\n\nconst myIterable = {};\nmyIterable[Symbol.iterator] = function* () {\n  yield 1;\n  yield 2;\n  yield 3;\n};\n\n[...myIterable] // [1, 2, 3]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¯¹è±¡è¿è¡for...ofå¾ªç¯æ¶ï¼ä¼è°ç¨Symbol.iteratoræ¹æ³ï¼è¿åè¯¥å¯¹è±¡çé»è®¤éåå¨ï¼è¯¦ç»ä»ç»åè§ãIterator å for...of å¾ªç¯ãä¸ç« ã\n\nclass Collection {\n  *[Symbol.iterator]() {\n    let i = 0;\n    while(this[i] !== undefined) {\n      yield this[i];\n      ++i;\n    }\n  }\n}\n\nlet myCollection = new Collection();\nmyCollection[0] = 1;\nmyCollection[1] = 2;\n\nfor(let value of myCollection) {\n  console.log(value);\n}\n// 1\n// 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n# Symbol.toPrimitive\n\nå¯¹è±¡çSymbol.toPrimitiveå±æ§ï¼æåä¸ä¸ªæ¹æ³ãè¯¥å¯¹è±¡è¢«è½¬ä¸ºåå§ç±»åçå¼æ¶ï¼ä¼è°ç¨è¿ä¸ªæ¹æ³ï¼è¿åè¯¥å¯¹è±¡å¯¹åºçåå§ç±»åå¼ã\n\nSymbol.toPrimitiveè¢«è°ç¨æ¶ï¼ä¼æ¥åä¸ä¸ªå­ç¬¦ä¸²åæ°ï¼è¡¨ç¤ºå½åè¿ç®çæ¨¡å¼ï¼ä¸å±æä¸ç§æ¨¡å¼ã\n\n * Numberï¼è¯¥åºåéè¦è½¬ææ°å¼\n * Stringï¼è¯¥åºåéè¦è½¬æå­ç¬¦ä¸²\n * Defaultï¼è¯¥åºåå¯ä»¥è½¬ææ°å¼ï¼ä¹å¯ä»¥è½¬æå­ç¬¦ä¸²\n\nlet obj = {\n  [Symbol.toPrimitive](hint) {\n    switch (hint) {\n      case 'number':\n        return 123;\n      case 'string':\n        return 'str';\n      case 'default':\n        return 'default';\n      default:\n        throw new Error();\n     }\n   }\n};\n\n2 * obj // 246\n3 + obj // '3default'\nobj == 'default' // true\nString(obj) // 'str'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n# Symbol.toStringTag\n\nå¯¹è±¡çSymbol.toStringTagå±æ§ï¼æåä¸ä¸ªæ¹æ³ãå¨è¯¥å¯¹è±¡ä¸é¢è°ç¨Object.prototype.toStringæ¹æ³æ¶ï¼å¦æè¿ä¸ªå±æ§å­å¨ï¼å®çè¿åå¼ä¼åºç°å¨toStringæ¹æ³è¿åçå­ç¬¦ä¸²ä¹ä¸­ï¼è¡¨ç¤ºå¯¹è±¡çç±»åãä¹å°±æ¯è¯´ï¼è¿ä¸ªå±æ§å¯ä»¥ç¨æ¥å®å¶[object Object]æ[object Array]ä¸­objectåé¢çé£ä¸ªå­ç¬¦ä¸²ã\n\n// ä¾ä¸\n({[Symbol.toStringTag]: 'Foo'}.toString())\n// \"[object Foo]\"\n\n// ä¾äº\nclass Collection {\n  get [Symbol.toStringTag]() {\n    return 'xxx';\n  }\n}\nlet x = new Collection();\nObject.prototype.toString.call(x) // \"[object xxx]\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nES6 æ°å¢åç½®å¯¹è±¡çSymbol.toStringTagå±æ§å¼å¦ä¸ã\n\n * JSON[Symbol.toStringTag]ï¼'JSON'\n * Math[Symbol.toStringTag]ï¼'Math'\n * Module å¯¹è±¡M[Symbol.toStringTag]ï¼'Module'\n * ArrayBuffer.prototype[Symbol.toStringTag]ï¼'ArrayBuffer'\n * DataView.prototype[Symbol.toStringTag]ï¼'DataView'\n * Map.prototype[Symbol.toStringTag]ï¼'Map'\n * Promise.prototype[Symbol.toStringTag]ï¼'Promise'\n * Set.prototype[Symbol.toStringTag]ï¼'Set'\n * %TypedArray%.prototype[Symbol.toStringTag]ï¼'Uint8Array'ç­\n * WeakMap.prototype[Symbol.toStringTag]ï¼'WeakMap'\n * WeakSet.prototype[Symbol.toStringTag]ï¼'WeakSet'\n * %MapIteratorPrototype%[Symbol.toStringTag]ï¼'Map Iterator'\n * %SetIteratorPrototype%[Symbol.toStringTag]ï¼'Set Iterator'\n * %StringIteratorPrototype%[Symbol.toStringTag]ï¼'String Iterator'\n * Symbol.prototype[Symbol.toStringTag]ï¼'Symbol'\n * Generator.prototype[Symbol.toStringTag]ï¼'Generator'\n * GeneratorFunction.prototype[Symbol.toStringTag]ï¼'GeneratorFunction'\n\n\n# Symbol.unscopables\n\nå¯¹è±¡çSymbol.unscopableså±æ§ï¼æåä¸ä¸ªå¯¹è±¡ãè¯¥å¯¹è±¡æå®äºä½¿ç¨withå³é®å­æ¶ï¼åªäºå±æ§ä¼è¢«withç¯å¢æé¤ã\n\nArray.prototype[Symbol.unscopables]\n// {\n//   copyWithin: true,\n//   entries: true,\n//   fill: true,\n//   find: true,\n//   findIndex: true,\n//   includes: true,\n//   keys: true\n// }\n\nObject.keys(Array.prototype[Symbol.unscopables])\n// ['copyWithin', 'entries', 'fill', 'find', 'findIndex', 'includes', 'keys']\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç è¯´æï¼æ°ç»æ 7 ä¸ªå±æ§ï¼ä¼è¢«withå½ä»¤æé¤ã\n\n// æ²¡æ unscopables æ¶\nclass MyClass {\n  foo() { return 1; }\n}\n\nvar foo = function () { return 2; };\n\nwith (MyClass.prototype) {\n  foo(); // 1\n}\n\n// æ unscopables æ¶\nclass MyClass {\n  foo() { return 1; }\n  get [Symbol.unscopables]() {\n    return { foo: true };\n  }\n}\n\nvar foo = function () { return 2; };\n\nwith (MyClass.prototype) {\n  foo(); // 2\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nä¸é¢ä»£ç éè¿æå®Symbol.unscopableså±æ§ï¼ä½¿å¾withè¯­æ³åä¸ä¼å¨å½åä½ç¨åå¯»æ¾fooå±æ§ï¼å³fooå°æåå¤å±ä½ç¨åçåéã",normalizedContent:"# symbol\n\n\n# æ¦è¿°\n\nes5 çå¯¹è±¡å±æ§åé½æ¯å­ç¬¦ä¸²ï¼è¿å®¹æé æå±æ§åçå²çªãæ¯å¦ï¼ä½ ä½¿ç¨äºä¸ä¸ªä»äººæä¾çå¯¹è±¡ï¼ä½åæ³ä¸ºè¿ä¸ªå¯¹è±¡æ·»å æ°çæ¹æ³ï¼mixin æ¨¡å¼ï¼ï¼æ°æ¹æ³çåå­å°±æå¯è½ä¸ç°ææ¹æ³äº§çå²çªãå¦ææä¸ç§æºå¶ï¼ä¿è¯æ¯ä¸ªå±æ§çåå­é½æ¯ç¬ä¸æ äºçå°±å¥½äºï¼è¿æ ·å°±ä»æ ¹æ¬ä¸é²æ­¢å±æ§åçå²çªãè¿å°±æ¯ es6 å¼å¥symbolçåå ã\n\nes6 å¼å¥äºä¸ç§æ°çåå§æ°æ®ç±»åsymbolï¼è¡¨ç¤ºç¬ä¸æ äºçå¼ãå®æ¯ javascript è¯­è¨çç¬¬ä¸ç§æ°æ®ç±»åï¼åå­ç§æ¯ï¼undefinedãnullãå¸å°å¼ï¼booleanï¼ãå­ç¬¦ä¸²ï¼stringï¼ãæ°å¼ï¼numberï¼ãå¯¹è±¡ï¼objectï¼ã\n\nsymbol å¼éè¿symbolå½æ°çæãè¿å°±æ¯è¯´ï¼**å¯¹è±¡çå±æ§åç°å¨å¯ä»¥æä¸¤ç§ç±»åï¼ä¸ç§æ¯åæ¥å°±æçå­ç¬¦ä¸²ï¼å¦ä¸ç§å°±æ¯æ°å¢ç symbol ç±»åã**å¡æ¯å±æ§åå±äº symbol ç±»åï¼å°±é½æ¯ç¬ä¸æ äºçï¼å¯ä»¥ä¿è¯ä¸ä¼ä¸å¶ä»å±æ§åäº§çå²çªã\n\nlet s = symbol();\n\ntypeof s\n// \"symbol\"\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼åéså°±æ¯ä¸ä¸ªç¬ä¸æ äºçå¼ãtypeofè¿ç®ç¬¦çç»æï¼è¡¨æåésæ¯ symbol æ°æ®ç±»åï¼èä¸æ¯å­ç¬¦ä¸²ä¹ç±»çå¶ä»ç±»åã\n\næ³¨æï¼symbolå½æ°åä¸è½ä½¿ç¨newå½ä»¤ï¼å¦åä¼æ¥éãè¿æ¯å ä¸ºçæç symbol æ¯ä¸ä¸ªåå§ç±»åçå¼ï¼ä¸æ¯å¯¹è±¡ãä¹å°±æ¯è¯´ï¼ç±äº symbol å¼ä¸æ¯å¯¹è±¡ï¼æä»¥ä¸è½æ·»å å±æ§ãåºæ¬ä¸ï¼å®æ¯ä¸ç§ç±»ä¼¼äºå­ç¬¦ä¸²çæ°æ®ç±»åã\n\nsymbolå½æ°å¯ä»¥æ¥åä¸ä¸ªå­ç¬¦ä¸²ä½ä¸ºåæ°ï¼è¡¨ç¤ºå¯¹ symbol å®ä¾çæè¿°ï¼ä¸»è¦æ¯ä¸ºäºå¨æ§å¶å°æ¾ç¤ºï¼æèè½¬ä¸ºå­ç¬¦ä¸²æ¶ï¼æ¯è¾å®¹æåºåã\n\nlet s1 = symbol('foo');\nlet s2 = symbol('bar');\n\ns1 // symbol(foo)\ns2 // symbol(bar)\n\ns1.tostring() // \"symbol(foo)\"\ns2.tostring() // \"symbol(bar)\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼s1ås2æ¯ä¸¤ä¸ª symbol å¼ãå¦æä¸å åæ°ï¼å®ä»¬å¨æ§å¶å°çè¾åºé½æ¯symbol()ï¼ä¸å©äºåºåãæäºåæ°ä»¥åï¼å°±ç­äºä¸ºå®ä»¬å ä¸äºæè¿°ï¼è¾åºçæ¶åå°±è½å¤åæ¸ï¼å°åºæ¯åªä¸ä¸ªå¼ã\n\nå¦æ symbol çåæ°æ¯ä¸ä¸ªå¯¹è±¡ï¼å°±ä¼è°ç¨è¯¥å¯¹è±¡çtostringæ¹æ³ï¼å°å¶è½¬ä¸ºå­ç¬¦ä¸²ï¼ç¶åæçæä¸ä¸ª symbol å¼ã\n\nconst obj = {\n  tostring() {\n    return 'abc';\n  }\n};\nconst sym = symbol(obj);\nsym // symbol(abc)\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næ³¨æï¼symbolå½æ°çåæ°åªæ¯è¡¨ç¤ºå¯¹å½å symbol å¼çæè¿°ï¼å æ­¤ç¸ååæ°çsymbolå½æ°çè¿åå¼æ¯ä¸ç¸ç­çã\n\n// æ²¡æåæ°çæåµ\nlet s1 = symbol();\nlet s2 = symbol();\n\ns1 === s2 // false\n\n// æåæ°çæåµ\nlet s1 = symbol('foo');\nlet s2 = symbol('foo');\n\ns1 === s2 // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼s1ås2é½æ¯symbolå½æ°çè¿åå¼ï¼èä¸åæ°ç¸åï¼ä½æ¯å®ä»¬æ¯ä¸ç¸ç­çã\n\nsymbol å¼ä¸è½ä¸å¶ä»ç±»åçå¼è¿è¡è¿ç®ï¼ä¼æ¥éã\n\nlet sym = symbol('my symbol');\n\n\"your symbol is \" + sym\n// typeerror: can't convert symbol to string\n`your symbol is ${sym}`\n// typeerror: can't convert symbol to string\n\n\n1\n2\n3\n4\n5\n6\n\n\nä½æ¯ï¼symbol å¼å¯ä»¥æ¾å¼è½¬ä¸ºå­ç¬¦ä¸²ã\n\nlet sym = symbol('my symbol');\n\nstring(sym) // 'symbol(my symbol)'\nsym.tostring() // 'symbol(my symbol)'\n\n\n1\n2\n3\n4\n\n\nå¦å¤ï¼symbol å¼ä¹å¯ä»¥è½¬ä¸ºå¸å°å¼ï¼ä½æ¯ä¸è½è½¬ä¸ºæ°å¼ã\n\nlet sym = symbol();\nboolean(sym) // true\n!sym  // false\n\nif (sym) {\n  // ...\n}\n\nnumber(sym) // typeerror\nsym + 2 // typeerror\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# symbol.prototype.description\n\nåå»º symbol çæ¶åï¼å¯ä»¥æ·»å ä¸ä¸ªæè¿°ã\n\nconst sym = symbol('foo');\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼symçæè¿°å°±æ¯å­ç¬¦ä¸²fooã\n\nä½æ¯ï¼è¯»åè¿ä¸ªæè¿°éè¦å° symbol æ¾å¼è½¬ä¸ºå­ç¬¦ä¸²ï¼å³ä¸é¢çåæ³ã\n\nconst sym = symbol('foo');\n\nstring(sym) // \"symbol(foo)\"\nsym.tostring() // \"symbol(foo)\"\n\n\n1\n2\n3\n4\n\n\nä¸é¢çç¨æ³ä¸æ¯å¾æ¹ä¾¿ães2019 æä¾äºä¸ä¸ªå®ä¾å±æ§descriptionï¼ç´æ¥è¿å symbol çæè¿°ã\n\nconst sym = symbol('foo');\n\nsym.description // \"foo\"\n\n\n1\n2\n3\n\n\n\n# ä½ä¸ºå±æ§åç symbol\n\nç±äºæ¯ä¸ä¸ª symbol å¼é½æ¯ä¸ç¸ç­çï¼è¿æå³ç symbol å¼å¯ä»¥ä½ä¸ºæ è¯ç¬¦ï¼ç¨äºå¯¹è±¡çå±æ§åï¼å°±è½ä¿è¯ä¸ä¼åºç°ååçå±æ§ãè¿å¯¹äºä¸ä¸ªå¯¹è±¡ç±å¤ä¸ªæ¨¡åææçæåµéå¸¸æç¨ï¼è½é²æ­¢æä¸ä¸ªé®è¢«ä¸å°å¿æ¹åæè¦çã\n\nlet mysymbol = symbol();\n\n// ç¬¬ä¸ç§åæ³\nlet a = {};\na[mysymbol] = 'hello!';\n\n// ç¬¬äºç§åæ³\nlet a = {\n  [mysymbol]: 'hello!'\n};\n\n// ç¬¬ä¸ç§åæ³\nlet a = {};\nobject.defineproperty(a, mysymbol, { value: 'hello!' });\n\n// ä»¥ä¸åæ³é½å¾å°åæ ·ç»æ\na[mysymbol] // \"hello!\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç éè¿æ¹æ¬å·ç»æåobject.definepropertyï¼å°å¯¹è±¡çå±æ§åæå®ä¸ºä¸ä¸ª symbol å¼ã\n\næ³¨æï¼symbol å¼ä½ä¸ºå¯¹è±¡å±æ§åæ¶ï¼ä¸è½ç¨ç¹è¿ç®ç¬¦ã\n\nconst mysymbol = symbol();\nconst a = {};\n\na.mysymbol = 'hello!';\na[mysymbol] // undefined\na['mysymbol'] // \"hello!\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å ä¸ºç¹è¿ç®ç¬¦åé¢æ»æ¯å­ç¬¦ä¸²ï¼æä»¥ä¸ä¼è¯»åmysymbolä½ä¸ºæ è¯åææä»£çé£ä¸ªå¼ï¼å¯¼è´açå±æ§åå®éä¸æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼èä¸æ¯ä¸ä¸ª symbol å¼ã\n\nåçï¼å¨å¯¹è±¡çåé¨ï¼ä½¿ç¨ symbol å¼å®ä¹å±æ§æ¶ï¼symbol å¼å¿é¡»æ¾å¨æ¹æ¬å·ä¹ä¸­ã\n\nlet s = symbol();\n\nlet obj = {\n  [s]: function (arg) { ... }\n};\n\nobj[s](123);\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æsä¸æ¾å¨æ¹æ¬å·ä¸­ï¼è¯¥å±æ§çé®åå°±æ¯å­ç¬¦ä¸²sï¼èä¸æ¯sæä»£è¡¨çé£ä¸ª symbol å¼ã\n\néç¨å¢å¼ºçå¯¹è±¡åæ³ï¼ä¸é¢ä»£ç çobjå¯¹è±¡å¯ä»¥åå¾æ´ç®æ´ä¸äºã\n\nlet obj = {\n  [s](arg) { ... }\n};\n\n\n1\n2\n3\n\n\nsymbol ç±»åè¿å¯ä»¥ç¨äºå®ä¹ä¸ç»å¸¸éï¼ä¿è¯è¿ç»å¸¸éçå¼é½æ¯ä¸ç¸ç­çã\n\nconst log = {};\n\nlog.levels = {\n  debug: symbol('debug'),\n  info: symbol('info'),\n  warn: symbol('warn')\n};\nconsole.log(log.levels.debug, 'debug message');\nconsole.log(log.levels.info, 'info message');\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢æ¯å¦å¤ä¸ä¸ªä¾å­ã\n\nconst color_red    = symbol();\nconst color_green  = symbol();\n\nfunction getcomplement(color) {\n  switch (color) {\n    case color_red:\n      return color_green;\n    case color_green:\n      return color_red;\n    default:\n      throw new error('undefined color');\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nå¸¸éä½¿ç¨ symbol å¼æå¤§çå¥½å¤ï¼å°±æ¯å¶ä»ä»»ä½å¼é½ä¸å¯è½æç¸åçå¼äºï¼å æ­¤å¯ä»¥ä¿è¯ä¸é¢çswitchè¯­å¥ä¼æè®¾è®¡çæ¹å¼å·¥ä½ã\n\nè¿æä¸ç¹éè¦æ³¨æï¼symbol å¼ä½ä¸ºå±æ§åæ¶ï¼è¯¥å±æ§è¿æ¯å¬å¼å±æ§ï¼ä¸æ¯ç§æå±æ§ã\n\n\n# å®ä¾ï¼æ¶é¤é­æ¯å­ç¬¦ä¸²\n\né­æ¯å­ç¬¦ä¸²æçæ¯ï¼å¨ä»£ç ä¹ä¸­å¤æ¬¡åºç°ãä¸ä»£ç å½¢æå¼ºè¦åçæä¸ä¸ªå·ä½çå­ç¬¦ä¸²æèæ°å¼ãé£æ ¼è¯å¥½çä»£ç ï¼åºè¯¥å°½éæ¶é¤é­æ¯å­ç¬¦ä¸²ï¼æ¹ç±å«ä¹æ¸æ°çåéä»£æ¿ã\n\nfunction getarea(shape, options) {\n  let area = 0;\n\n  switch (shape) {\n    case 'triangle': // é­æ¯å­ç¬¦ä¸²\n      area = .5 * options.width * options.height;\n      break;\n    /* ... more code ... */\n  }\n\n  return area;\n}\n\ngetarea('triangle', { width: 100, height: 100 }); // é­æ¯å­ç¬¦ä¸²\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç¬¦ä¸²triangleå°±æ¯ä¸ä¸ªé­æ¯å­ç¬¦ä¸²ãå®å¤æ¬¡åºç°ï¼ä¸ä»£ç å½¢æâå¼ºè¦åâï¼ä¸å©äºå°æ¥çä¿®æ¹åç»´æ¤ã\n\n> ç¬è®°ï¼\n> \n> triangleå­ç¬¦ä¸²å¨ä»£ç ä¸­åºç°å¤æ¬¡ï¼å¦æåææ³ä¿®æ¹è¿ä¸ªå­ç¬¦ä¸²éè¦ä¿®æ¹å¾å¤å¤ï¼ä¸å©äºç»´æ¤ã\n\nå¸¸ç¨çæ¶é¤é­æ¯å­ç¬¦ä¸²çæ¹æ³ï¼å°±æ¯æå®åæä¸ä¸ªåéã\n\nconst shapetype = {\n  triangle: 'triangle'\n};\n\nfunction getarea(shape, options) {\n  let area = 0;\n  switch (shape) {\n    case shapetype.triangle:\n      area = .5 * options.width * options.height;\n      break;\n  }\n  return area;\n}\n\ngetarea(shapetype.triangle, { width: 100, height: 100 });\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼æä»¬ætriangleåæshapetypeå¯¹è±¡çtriangleå±æ§ï¼è¿æ ·å°±æ¶é¤äºå¼ºè¦åã\n\nå¦æä»ç»åæï¼å¯ä»¥åç°shapetype.triangleç­äºåªä¸ªå¼å¹¶ä¸éè¦ï¼åªè¦ç¡®ä¿ä¸ä¼è·å¶ä»shapetypeå±æ§çå¼å²çªå³å¯ãå æ­¤ï¼è¿éå°±å¾éåæ¹ç¨ symbol å¼ã\n\nconst shapetype = {\n  triangle: symbol()\n};\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼é¤äºå°shapetype.triangleçå¼è®¾ä¸ºä¸ä¸ª symbolï¼å¶ä»å°æ¹é½ä¸ç¨ä¿®æ¹ã\n\n\n# å±æ§åçéå\n\nsymbol ä½ä¸ºå±æ§åï¼éåå¯¹è±¡çæ¶åï¼è¯¥å±æ§ä¸ä¼åºç°å¨for...inãfor...ofå¾ªç¯ä¸­ï¼ä¹ä¸ä¼è¢«object.keys()ãobject.getownpropertynames()ãjson.stringify()è¿åã\n\nä½æ¯ï¼å®ä¹ä¸æ¯ç§æå±æ§ï¼æä¸ä¸ª**object.getownpropertysymbols()æ¹æ³ï¼å¯ä»¥è·åæå®å¯¹è±¡çææ symbol å±æ§å**ãè¯¥æ¹æ³è¿åä¸ä¸ªæ°ç»ï¼æåæ¯å½åå¯¹è±¡çææç¨ä½å±æ§åç symbol å¼ã\n\nconst obj = {};\nlet a = symbol('a');\nlet b = symbol('b');\n\nobj[a] = 'hello';\nobj[b] = 'world';\n\nconst objectsymbols = object.getownpropertysymbols(obj);\n\nobjectsymbols\n// [symbol(a), symbol(b)]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç æ¯object.getownpropertysymbols()æ¹æ³çç¤ºä¾ï¼å¯ä»¥è·åææ symbol å±æ§åã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ï¼object.getownpropertysymbols()æ¹æ³ä¸for...inå¾ªç¯ãobject.getownpropertynamesæ¹æ³è¿è¡å¯¹æ¯çä¾å­ã\n\nconst obj = {};\nconst foo = symbol('foo');\n\nobj[foo] = 'bar';\n\nfor (let i in obj) {\n  console.log(i); // æ è¾åº\n}\n\nobject.getownpropertynames(obj) // []\nobject.getownpropertysymbols(obj) // [symbol(foo)]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ä½¿ç¨for...inå¾ªç¯åobject.getownpropertynames()æ¹æ³é½å¾ä¸å° symbol é®åï¼éè¦ä½¿ç¨object.getownpropertysymbols()æ¹æ³ã\n\nå¦ä¸ä¸ªæ°ç apiï¼reflect.ownkeys()æ¹æ³å¯ä»¥è¿åææç±»åçé®åï¼åæ¬å¸¸è§é®åå symbol é®åã\n\nlet obj = {\n  [symbol('my_key')]: 1,\n  enum: 2,\n  nonenum: 3\n};\n\nreflect.ownkeys(obj)\n//  [\"enum\", \"nonenum\", symbol(my_key)]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nç±äºä»¥ symbol å¼ä½ä¸ºé®åï¼ä¸ä¼è¢«å¸¸è§æ¹æ³éåå¾å°ãæä»¬å¯ä»¥å©ç¨è¿ä¸ªç¹æ§ï¼ä¸ºå¯¹è±¡å®ä¹ä¸äºéç§æçãä½åå¸æåªç¨äºåé¨çæ¹æ³ã\n\nlet size = symbol('size');\n\nclass collection {\n  constructor() {\n    this[size] = 0;\n  }\n\n  add(item) {\n    this[this[size]] = item;\n    this[size]++;\n  }\n\n  static sizeof(instance) {\n    return instance[size];\n  }\n}\n\nlet x = new collection();\ncollection.sizeof(x) // 0\n\nx.add('foo');\ncollection.sizeof(x) // 1\n\nobject.keys(x) // ['0']\nobject.getownpropertynames(x) // ['0']\nobject.getownpropertysymbols(x) // [symbol(size)]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯¹è±¡xçsizeå±æ§æ¯ä¸ä¸ª symbol å¼ï¼æä»¥object.keys(x)ãobject.getownpropertynames(x)é½æ æ³è·åå®ãè¿å°±é æäºä¸ç§éç§æçåé¨æ¹æ³çææã\n\n\n# symbol.for()ï¼symbol.keyfor()\n\nææ¶ï¼æä»¬å¸æéæ°ä½¿ç¨åä¸ä¸ª symbol å¼ï¼symbol.for()æ¹æ³å¯ä»¥åå°è¿ä¸ç¹ãå®æ¥åä¸ä¸ªå­ç¬¦ä¸²ä½ä¸ºåæ°ï¼ç¶åæç´¢ææ²¡æä»¥è¯¥åæ°ä½ä¸ºåç§°ç symbol å¼ãå¦ææï¼å°±è¿åè¿ä¸ª symbol å¼ï¼å¦åå°±æ°å»ºä¸ä¸ªä»¥è¯¥å­ç¬¦ä¸²ä¸ºåç§°ç symbol å¼ï¼å¹¶å°å¶æ³¨åå°å¨å±ã\n\nlet s1 = symbol.for('foo');\nlet s2 = symbol.for('foo');\n\ns1 === s2 // true\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼s1ås2é½æ¯ symbol å¼ï¼ä½æ¯å®ä»¬é½æ¯åæ ·åæ°çsymbol.foræ¹æ³çæçï¼æä»¥å®éä¸æ¯åä¸ä¸ªå¼ã\n\nsymbol.for()ä¸symbol()è¿ä¸¤ç§åæ³ï¼é½ä¼çææ°ç symbolãå®ä»¬çåºå«æ¯ï¼åèä¼è¢«ç»è®°å¨å¨å±ç¯å¢ä¸­ä¾æç´¢ï¼åèä¸ä¼ãsymbol.for()ä¸ä¼æ¯æ¬¡è°ç¨å°±è¿åä¸ä¸ªæ°ç symbol ç±»åçå¼ï¼èæ¯ä¼åæ£æ¥ç»å®çkeyæ¯å¦å·²ç»å­å¨ï¼å¦æä¸å­å¨æä¼æ°å»ºä¸ä¸ªå¼ãæ¯å¦ï¼å¦æä½ è°ç¨symbol.for(\"cat\")30 æ¬¡ï¼æ¯æ¬¡é½ä¼è¿ååä¸ä¸ª symbol å¼ï¼ä½æ¯è°ç¨symbol(\"cat\")30 æ¬¡ï¼ä¼è¿å 30 ä¸ªä¸åç symbol å¼ã\n\nsymbol.for(\"bar\") === symbol.for(\"bar\")\n// true\n\nsymbol(\"bar\") === symbol(\"bar\")\n// false\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºsymbol()åæ³æ²¡æç»è®°æºå¶ï¼æä»¥æ¯æ¬¡è°ç¨é½ä¼è¿åä¸ä¸ªä¸åçå¼ã\n\nsymbol.keyfor()æ¹æ³è¿åä¸ä¸ªå·²ç»è®°ç symbol ç±»åå¼çkeyã\n\nlet s1 = symbol.for(\"foo\");\nsymbol.keyfor(s1) // \"foo\"\n\nlet s2 = symbol(\"foo\");\nsymbol.keyfor(s2) // undefined\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼åés2å±äºæªç»è®°ç symbol å¼ï¼æä»¥è¿åundefinedã\n\næ³¨æï¼symbol.for()ä¸º symbol å¼ç»è®°çåå­ï¼æ¯å¨å±ç¯å¢çï¼ä¸ç®¡ææ²¡æå¨å¨å±ç¯å¢è¿è¡ã\n\nfunction foo() {\n  return symbol.for('bar');\n}\n\nconst x = foo();\nconst y = symbol.for('bar');\nconsole.log(x === y); // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼symbol.for('bar')æ¯å½æ°åé¨è¿è¡çï¼ä½æ¯çæç symbol å¼æ¯ç»è®°å¨å¨å±ç¯å¢çãæä»¥ï¼ç¬¬äºæ¬¡è¿è¡symbol.for('bar')å¯ä»¥åå°è¿ä¸ª symbol å¼ã\n\nsymbol.for()çè¿ä¸ªå¨å±ç»è®°ç¹æ§ï¼å¯ä»¥ç¨å¨ä¸åç iframe æ service worker ä¸­åå°åä¸ä¸ªå¼ã\n\niframe = document.createelement('iframe');\niframe.src = string(window.location);\ndocument.body.appendchild(iframe);\n\niframe.contentwindow.symbol.for('foo') === symbol.for('foo')\n// true\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼iframe çªå£çæç symbol å¼ï¼å¯ä»¥å¨ä¸»é¡µé¢å¾å°ã\n\n\n# å®ä¾ï¼æ¨¡åç singleton æ¨¡å¼\n\nsingleton æ¨¡å¼æçæ¯è°ç¨ä¸ä¸ªç±»ï¼ä»»ä½æ¶åè¿åçé½æ¯åä¸ä¸ªå®ä¾ã\n\nå¯¹äº node æ¥è¯´ï¼æ¨¡åæä»¶å¯ä»¥çææ¯ä¸ä¸ªç±»ãæä¹ä¿è¯æ¯æ¬¡æ§è¡è¿ä¸ªæ¨¡åæä»¶ï¼è¿åçé½æ¯åä¸ä¸ªå®ä¾å¢ï¼\n\nå¾å®¹ææ³å°ï¼å¯ä»¥æå®ä¾æ¾å°é¡¶å±å¯¹è±¡globalã\n\n// mod.js\nfunction a() {\n  this.foo = 'hello';\n}\n\nif (!global._foo) {\n  global._foo = new a();\n}\n\nmodule.exports = global._foo;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nç¶åï¼å è½½ä¸é¢çmod.jsã\n\nconst a = require('./mod.js');\nconsole.log(a.foo);\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼åéaä»»ä½æ¶åå è½½çé½æ¯açåä¸ä¸ªå®ä¾ã\n\nä½æ¯ï¼è¿éæä¸ä¸ªé®é¢ï¼å¨å±åéglobal._fooæ¯å¯åçï¼ä»»ä½æä»¶é½å¯ä»¥ä¿®æ¹ã\n\nglobal._foo = { foo: 'world' };\n\nconst a = require('./mod.js');\nconsole.log(a.foo);\n\n\n1\n2\n3\n4\n\n\nä¸é¢çä»£ç ï¼ä¼ä½¿å¾å è½½mod.jsçèæ¬é½å¤±çã\n\nä¸ºäºé²æ­¢è¿ç§æåµåºç°ï¼æä»¬å°±å¯ä»¥ä½¿ç¨ symbolã\n\n// mod.js\nconst foo_key = symbol.for('foo');\n\nfunction a() {\n  this.foo = 'hello';\n}\n\nif (!global[foo_key]) {\n  global[foo_key] = new a();\n}\n\nmodule.exports = global[foo_key];\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯ä»¥ä¿è¯global[foo_key]ä¸ä¼è¢«æ æé´è¦çï¼ä½è¿æ¯å¯ä»¥è¢«æ¹åã\n\nglobal[symbol.for('foo')] = { foo: 'world' };\n\nconst a = require('./mod.js');\n\n\n1\n2\n3\n\n\nå¦æé®åä½¿ç¨symbolæ¹æ³çæï¼é£ä¹å¤é¨å°æ æ³å¼ç¨è¿ä¸ªå¼ï¼å½ç¶ä¹å°±æ æ³æ¹åã\n\n// mod.js\nconst foo_key = symbol('foo');\n\n// åé¢ä»£ç ç¸å â¦â¦\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç å°å¯¼è´å¶ä»èæ¬é½æ æ³å¼ç¨foo_keyãä½è¿æ ·ä¹æä¸ä¸ªé®é¢ï¼å°±æ¯å¦æå¤æ¬¡æ§è¡è¿ä¸ªèæ¬ï¼æ¯æ¬¡å¾å°çfoo_keyé½æ¯ä¸ä¸æ ·çãè½ç¶ node ä¼å°èæ¬çæ§è¡ç»æç¼å­ï¼ä¸è¬æåµä¸ï¼ä¸ä¼å¤æ¬¡æ§è¡åä¸ä¸ªèæ¬ï¼ä½æ¯ç¨æ·å¯ä»¥æå¨æ¸é¤ç¼å­ï¼æä»¥ä¹ä¸æ¯ç»å¯¹å¯é ã\n\n\n# åç½®ç symbol å¼\n\né¤äºå®ä¹èªå·±ä½¿ç¨ç symbol å¼ä»¥å¤ï¼es6 è¿æä¾äº 11 ä¸ªåç½®ç symbol å¼ï¼æåè¯­è¨åé¨ä½¿ç¨çæ¹æ³ã\n\n\n# symbol.hasinstance\n\nå¯¹è±¡çsymbol.hasinstanceå±æ§ï¼æåä¸ä¸ªåé¨æ¹æ³ãå½å¶ä»å¯¹è±¡ä½¿ç¨instanceofè¿ç®ç¬¦ï¼å¤æ­æ¯å¦ä¸ºè¯¥å¯¹è±¡çå®ä¾æ¶ï¼ä¼è°ç¨è¿ä¸ªæ¹æ³ãæ¯å¦ï¼foo instanceof fooå¨è¯­è¨åé¨ï¼å®éè°ç¨çæ¯foo[symbol.hasinstance](foo)ã\n\nclass myclass {\n  [symbol.hasinstance](foo) {\n    return foo instanceof array;\n  }\n}\n\n[1, 2, 3] instanceof new myclass() // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼myclassæ¯ä¸ä¸ªç±»ï¼new myclass()ä¼è¿åä¸ä¸ªå®ä¾ãè¯¥å®ä¾çsymbol.hasinstanceæ¹æ³ï¼ä¼å¨è¿è¡instanceofè¿ç®æ¶èªå¨è°ç¨ï¼å¤æ­å·¦ä¾§çè¿ç®å­æ¯å¦ä¸ºarrayçå®ä¾ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nclass even {\n  static [symbol.hasinstance](obj) {\n    return number(obj) % 2 === 0;\n  }\n}\n\n// ç­åäº\nconst even = {\n  [symbol.hasinstance](obj) {\n    return number(obj) % 2 === 0;\n  }\n};\n\n1 instanceof even // false\n2 instanceof even // true\n12345 instanceof even // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n# symbol.isconcatspreadable\n\nå¯¹è±¡çsymbol.isconcatspreadableå±æ§ç­äºä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºè¯¥å¯¹è±¡ç¨äºarray.prototype.concat()æ¶ï¼æ¯å¦å¯ä»¥å±å¼ã\n\nlet arr1 = ['c', 'd'];\n['a', 'b'].concat(arr1, 'e') // ['a', 'b', 'c', 'd', 'e']\narr1[symbol.isconcatspreadable] // undefined\n\nlet arr2 = ['c', 'd'];\narr2[symbol.isconcatspreadable] = false;\n['a', 'b'].concat(arr2, 'e') // ['a', 'b', ['c','d'], 'e']\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç è¯´æï¼æ°ç»çé»è®¤è¡ä¸ºæ¯å¯ä»¥å±å¼ï¼symbol.isconcatspreadableé»è®¤ç­äºundefinedãè¯¥å±æ§ç­äºtrueæ¶ï¼ä¹æå±å¼çææã\n\nç±»ä¼¼æ°ç»çå¯¹è±¡æ­£å¥½ç¸åï¼é»è®¤ä¸å±å¼ãå®çsymbol.isconcatspreadableå±æ§è®¾ä¸ºtrueï¼æå¯ä»¥å±å¼ã\n\nlet obj = {length: 2, 0: 'c', 1: 'd'};\n['a', 'b'].concat(obj, 'e') // ['a', 'b', obj, 'e']\n\nobj[symbol.isconcatspreadable] = true;\n['a', 'b'].concat(obj, 'e') // ['a', 'b', 'c', 'd', 'e']\n\n\n1\n2\n3\n4\n5\n\n\nsymbol.isconcatspreadableå±æ§ä¹å¯ä»¥å®ä¹å¨ç±»éé¢ã\n\nclass a1 extends array {\n  constructor(args) {\n    super(args);\n    this[symbol.isconcatspreadable] = true;\n  }\n}\nclass a2 extends array {\n  constructor(args) {\n    super(args);\n  }\n  get [symbol.isconcatspreadable] () {\n    return false;\n  }\n}\nlet a1 = new a1();\na1[0] = 3;\na1[1] = 4;\nlet a2 = new a2();\na2[0] = 5;\na2[1] = 6;\n[1, 2].concat(a1).concat(a2)\n// [1, 2, 3, 4, [5, 6]]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±»a1æ¯å¯å±å¼çï¼ç±»a2æ¯ä¸å¯å±å¼çï¼æä»¥ä½¿ç¨concatæ¶æä¸ä¸æ ·çç»æã\n\næ³¨æï¼symbol.isconcatspreadableçä½ç½®å·®å¼ï¼a1æ¯å®ä¹å¨å®ä¾ä¸ï¼a2æ¯å®ä¹å¨ç±»æ¬èº«ï¼ææç¸åã\n\n\n# symbol.species\n\nå¯¹è±¡çsymbol.specieså±æ§ï¼æåä¸ä¸ªæé å½æ°ãåå»ºè¡çå¯¹è±¡æ¶ï¼ä¼ä½¿ç¨è¯¥å±æ§ã\n\nclass myarray extends array {\n}\n\nconst a = new myarray(1, 2, 3);\nconst b = a.map(x => x);\nconst c = a.filter(x => x > 1);\n\nb instanceof myarray // true\nc instanceof myarray // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç±»myarrayç»§æ¿äºç¶ç±»arrayï¼aæ¯myarrayçå®ä¾ï¼båcæ¯açè¡çå¯¹è±¡ãä½ å¯è½ä¼è®¤ä¸ºï¼båcé½æ¯è°ç¨æ°ç»æ¹æ³çæçï¼æä»¥åºè¯¥æ¯æ°ç»ï¼arrayçå®ä¾ï¼ï¼ä½å®éä¸å®ä»¬ä¹æ¯myarrayçå®ä¾ã\n\nsymbol.specieså±æ§å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢èæä¾çãç°å¨ï¼æä»¬å¯ä»¥ä¸ºmyarrayè®¾ç½®symbol.specieså±æ§ã\n\nclass myarray extends array {\n  static get [symbol.species]() { return array; }\n}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºå®ä¹äºsymbol.specieså±æ§ï¼åå»ºè¡çå¯¹è±¡æ¶å°±ä¼ä½¿ç¨è¿ä¸ªå±æ§è¿åçå½æ°ï¼ä½ä¸ºæé å½æ°ãè¿ä¸ªä¾å­ä¹è¯´æï¼å®ä¹symbol.specieså±æ§è¦éç¨getåå¼å¨ãé»è®¤çsymbol.specieså±æ§ç­åäºä¸é¢çåæ³ã\n\nstatic get [symbol.species]() {\n  return this;\n}\n\n\n1\n2\n3\n\n\nç°å¨ï¼åæ¥çåé¢çä¾å­ã\n\nclass myarray extends array {\n  static get [symbol.species]() { return array; }\n}\n\nconst a = new myarray();\nconst b = a.map(x => x);\n\nb instanceof myarray // false\nb instanceof array // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼a.map(x => x)çæçè¡çå¯¹è±¡ï¼å°±ä¸æ¯myarrayçå®ä¾ï¼èç´æ¥å°±æ¯arrayçå®ä¾ã\n\nåçä¸ä¸ªä¾å­ã\n\nclass t1 extends promise {\n}\n\nclass t2 extends promise {\n  static get [symbol.species]() {\n    return promise;\n  }\n}\n\nnew t1(r => r()).then(v => v) instanceof t1 // true\nnew t2(r => r()).then(v => v) instanceof t2 // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼t2å®ä¹äºsymbol.specieså±æ§ï¼t1æ²¡æãç»æå°±å¯¼è´äºåå»ºè¡çå¯¹è±¡æ¶ï¼thenæ¹æ³ï¼ï¼t1è°ç¨çæ¯èªèº«çæé æ¹æ³ï¼èt2è°ç¨çæ¯promiseçæé æ¹æ³ã\n\næ»ä¹ï¼symbol.speciesçä½ç¨å¨äºï¼å®ä¾å¯¹è±¡å¨è¿è¡è¿ç¨ä¸­ï¼éè¦åæ¬¡è°ç¨èªèº«çæé å½æ°æ¶ï¼ä¼è°ç¨è¯¥å±æ§æå®çæé å½æ°ãå®ä¸»è¦çç¨éæ¯ï¼æäºç±»åºæ¯å¨åºç±»çåºç¡ä¸ä¿®æ¹çï¼é£ä¹å­ç±»ä½¿ç¨ç»§æ¿çæ¹æ³æ¶ï¼ä½èå¯è½å¸æè¿ååºç±»çå®ä¾ï¼èä¸æ¯å­ç±»çå®ä¾ã\n\n\n# symbol.match\n\nå¯¹è±¡çsymbol.matchå±æ§ï¼æåä¸ä¸ªå½æ°ãå½æ§è¡str.match(myobject)æ¶ï¼å¦æè¯¥å±æ§å­å¨ï¼ä¼è°ç¨å®ï¼è¿åè¯¥æ¹æ³çè¿åå¼ã\n\nstring.prototype.match(regexp)\n// ç­åäº\nregexp[symbol.match](this)\n\nclass mymatcher {\n  [symbol.match](string) {\n    return 'hello world'.indexof(string);\n  }\n}\n\n'e'.match(new mymatcher()) // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# symbol.replace\n\nå¯¹è±¡çsymbol.replaceå±æ§ï¼æåä¸ä¸ªæ¹æ³ï¼å½è¯¥å¯¹è±¡è¢«string.prototype.replaceæ¹æ³è°ç¨æ¶ï¼ä¼è¿åè¯¥æ¹æ³çè¿åå¼ã\n\nstring.prototype.replace(searchvalue, replacevalue)\n// ç­åäº\nsearchvalue[symbol.replace](this, replacevalue)\n\n\n1\n2\n3\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nconst x = {};\nx[symbol.replace] = (...s) => console.log(s);\n\n'hello'.replace(x, 'world') // [\"hello\", \"world\"]\n\n\n1\n2\n3\n4\n\n\nsymbol.replaceæ¹æ³ä¼æ¶å°ä¸¤ä¸ªåæ°ï¼ç¬¬ä¸ä¸ªåæ°æ¯replaceæ¹æ³æ­£å¨ä½ç¨çå¯¹è±¡ï¼ä¸é¢ä¾å­æ¯helloï¼ç¬¬äºä¸ªåæ°æ¯æ¿æ¢åçå¼ï¼ä¸é¢ä¾å­æ¯worldã\n\n\n# symbol.search\n\nå¯¹è±¡çsymbol.searchå±æ§ï¼æåä¸ä¸ªæ¹æ³ï¼å½è¯¥å¯¹è±¡è¢«string.prototype.searchæ¹æ³è°ç¨æ¶ï¼ä¼è¿åè¯¥æ¹æ³çè¿åå¼ã\n\nstring.prototype.search(regexp)\n// ç­åäº\nregexp[symbol.search](this)\n\nclass mysearch {\n  constructor(value) {\n    this.value = value;\n  }\n  [symbol.search](string) {\n    return string.indexof(this.value);\n  }\n}\n'foobar'.search(new mysearch('foo')) // 0\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# symbol.split\n\nå¯¹è±¡çsymbol.splitå±æ§ï¼æåä¸ä¸ªæ¹æ³ï¼å½è¯¥å¯¹è±¡è¢«string.prototype.splitæ¹æ³è°ç¨æ¶ï¼ä¼è¿åè¯¥æ¹æ³çè¿åå¼ã\n\nstring.prototype.split(separator, limit)\n// ç­åäº\nseparator[symbol.split](this, limit)\n\n\n1\n2\n3\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nclass mysplitter {\n  constructor(value) {\n    this.value = value;\n  }\n  [symbol.split](string) {\n    let index = string.indexof(this.value);\n    if (index === -1) {\n      return string;\n    }\n    return [\n      string.substr(0, index),\n      string.substr(index + this.value.length)\n    ];\n  }\n}\n\n'foobar'.split(new mysplitter('foo'))\n// ['', 'bar']\n\n'foobar'.split(new mysplitter('bar'))\n// ['foo', '']\n\n'foobar'.split(new mysplitter('baz'))\n// 'foobar'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nä¸é¢æ¹æ³ä½¿ç¨symbol.splitæ¹æ³ï¼éæ°å®ä¹äºå­ç¬¦ä¸²å¯¹è±¡çsplitæ¹æ³çè¡ä¸ºï¼\n\n\n# symbol.iterator\n\nå¯¹è±¡çsymbol.iteratorå±æ§ï¼æåè¯¥å¯¹è±¡çé»è®¤éåå¨æ¹æ³ã\n\nconst myiterable = {};\nmyiterable[symbol.iterator] = function* () {\n  yield 1;\n  yield 2;\n  yield 3;\n};\n\n[...myiterable] // [1, 2, 3]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¯¹è±¡è¿è¡for...ofå¾ªç¯æ¶ï¼ä¼è°ç¨symbol.iteratoræ¹æ³ï¼è¿åè¯¥å¯¹è±¡çé»è®¤éåå¨ï¼è¯¦ç»ä»ç»åè§ãiterator å for...of å¾ªç¯ãä¸ç« ã\n\nclass collection {\n  *[symbol.iterator]() {\n    let i = 0;\n    while(this[i] !== undefined) {\n      yield this[i];\n      ++i;\n    }\n  }\n}\n\nlet mycollection = new collection();\nmycollection[0] = 1;\nmycollection[1] = 2;\n\nfor(let value of mycollection) {\n  console.log(value);\n}\n// 1\n// 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n# symbol.toprimitive\n\nå¯¹è±¡çsymbol.toprimitiveå±æ§ï¼æåä¸ä¸ªæ¹æ³ãè¯¥å¯¹è±¡è¢«è½¬ä¸ºåå§ç±»åçå¼æ¶ï¼ä¼è°ç¨è¿ä¸ªæ¹æ³ï¼è¿åè¯¥å¯¹è±¡å¯¹åºçåå§ç±»åå¼ã\n\nsymbol.toprimitiveè¢«è°ç¨æ¶ï¼ä¼æ¥åä¸ä¸ªå­ç¬¦ä¸²åæ°ï¼è¡¨ç¤ºå½åè¿ç®çæ¨¡å¼ï¼ä¸å±æä¸ç§æ¨¡å¼ã\n\n * numberï¼è¯¥åºåéè¦è½¬ææ°å¼\n * stringï¼è¯¥åºåéè¦è½¬æå­ç¬¦ä¸²\n * defaultï¼è¯¥åºåå¯ä»¥è½¬ææ°å¼ï¼ä¹å¯ä»¥è½¬æå­ç¬¦ä¸²\n\nlet obj = {\n  [symbol.toprimitive](hint) {\n    switch (hint) {\n      case 'number':\n        return 123;\n      case 'string':\n        return 'str';\n      case 'default':\n        return 'default';\n      default:\n        throw new error();\n     }\n   }\n};\n\n2 * obj // 246\n3 + obj // '3default'\nobj == 'default' // true\nstring(obj) // 'str'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n# symbol.tostringtag\n\nå¯¹è±¡çsymbol.tostringtagå±æ§ï¼æåä¸ä¸ªæ¹æ³ãå¨è¯¥å¯¹è±¡ä¸é¢è°ç¨object.prototype.tostringæ¹æ³æ¶ï¼å¦æè¿ä¸ªå±æ§å­å¨ï¼å®çè¿åå¼ä¼åºç°å¨tostringæ¹æ³è¿åçå­ç¬¦ä¸²ä¹ä¸­ï¼è¡¨ç¤ºå¯¹è±¡çç±»åãä¹å°±æ¯è¯´ï¼è¿ä¸ªå±æ§å¯ä»¥ç¨æ¥å®å¶[object object]æ[object array]ä¸­objectåé¢çé£ä¸ªå­ç¬¦ä¸²ã\n\n// ä¾ä¸\n({[symbol.tostringtag]: 'foo'}.tostring())\n// \"[object foo]\"\n\n// ä¾äº\nclass collection {\n  get [symbol.tostringtag]() {\n    return 'xxx';\n  }\n}\nlet x = new collection();\nobject.prototype.tostring.call(x) // \"[object xxx]\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nes6 æ°å¢åç½®å¯¹è±¡çsymbol.tostringtagå±æ§å¼å¦ä¸ã\n\n * json[symbol.tostringtag]ï¼'json'\n * math[symbol.tostringtag]ï¼'math'\n * module å¯¹è±¡m[symbol.tostringtag]ï¼'module'\n * arraybuffer.prototype[symbol.tostringtag]ï¼'arraybuffer'\n * dataview.prototype[symbol.tostringtag]ï¼'dataview'\n * map.prototype[symbol.tostringtag]ï¼'map'\n * promise.prototype[symbol.tostringtag]ï¼'promise'\n * set.prototype[symbol.tostringtag]ï¼'set'\n * %typedarray%.prototype[symbol.tostringtag]ï¼'uint8array'ç­\n * weakmap.prototype[symbol.tostringtag]ï¼'weakmap'\n * weakset.prototype[symbol.tostringtag]ï¼'weakset'\n * %mapiteratorprototype%[symbol.tostringtag]ï¼'map iterator'\n * %setiteratorprototype%[symbol.tostringtag]ï¼'set iterator'\n * %stringiteratorprototype%[symbol.tostringtag]ï¼'string iterator'\n * symbol.prototype[symbol.tostringtag]ï¼'symbol'\n * generator.prototype[symbol.tostringtag]ï¼'generator'\n * generatorfunction.prototype[symbol.tostringtag]ï¼'generatorfunction'\n\n\n# symbol.unscopables\n\nå¯¹è±¡çsymbol.unscopableså±æ§ï¼æåä¸ä¸ªå¯¹è±¡ãè¯¥å¯¹è±¡æå®äºä½¿ç¨withå³é®å­æ¶ï¼åªäºå±æ§ä¼è¢«withç¯å¢æé¤ã\n\narray.prototype[symbol.unscopables]\n// {\n//   copywithin: true,\n//   entries: true,\n//   fill: true,\n//   find: true,\n//   findindex: true,\n//   includes: true,\n//   keys: true\n// }\n\nobject.keys(array.prototype[symbol.unscopables])\n// ['copywithin', 'entries', 'fill', 'find', 'findindex', 'includes', 'keys']\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç è¯´æï¼æ°ç»æ 7 ä¸ªå±æ§ï¼ä¼è¢«withå½ä»¤æé¤ã\n\n// æ²¡æ unscopables æ¶\nclass myclass {\n  foo() { return 1; }\n}\n\nvar foo = function () { return 2; };\n\nwith (myclass.prototype) {\n  foo(); // 1\n}\n\n// æ unscopables æ¶\nclass myclass {\n  foo() { return 1; }\n  get [symbol.unscopables]() {\n    return { foo: true };\n  }\n}\n\nvar foo = function () { return 2; };\n\nwith (myclass.prototype) {\n  foo(); // 2\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nä¸é¢ä»£ç éè¿æå®symbol.unscopableså±æ§ï¼ä½¿å¾withè¯­æ³åä¸ä¼å¨å½åä½ç¨åå¯»æ¾fooå±æ§ï¼å³fooå°æåå¤å±ä½ç¨åçåéã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Set å Map æ°æ®ç»æ",frontmatter:{title:"Set å Map æ°æ®ç»æ",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/0c21dae358fca16b",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/13.Set%20%E5%92%8C%20Map%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.html",relativePath:"ãES6 æç¨ãç¬è®°/13.Set å Map æ°æ®ç»æ.md",key:"v-2ec63a50",path:"/pages/0c21dae358fca16b/",headers:[{level:2,title:"Set",slug:"set",normalizedTitle:"set",charIndex:2},{level:3,title:"åºæ¬ç¨æ³",slug:"åºæ¬ç¨æ³",normalizedTitle:"åºæ¬ç¨æ³",charIndex:29},{level:3,title:"Set å®ä¾çå±æ§åæ¹æ³",slug:"set-å®ä¾çå±æ§åæ¹æ³",normalizedTitle:"set å®ä¾çå±æ§åæ¹æ³",charIndex:1372},{level:3,title:"éåæä½",slug:"éåæä½",normalizedTitle:"éåæä½",charIndex:2514},{level:2,title:"WeakSet",slug:"weakset",normalizedTitle:"weakset",charIndex:5255},{level:3,title:"å«ä¹",slug:"å«ä¹",normalizedTitle:"å«ä¹",charIndex:5267},{level:3,title:"è¯­æ³",slug:"è¯­æ³",normalizedTitle:"è¯­æ³",charIndex:6044},{level:2,title:"Map",slug:"map",normalizedTitle:"map",charIndex:8},{level:3,title:"å«ä¹ååºæ¬ç¨æ³",slug:"å«ä¹ååºæ¬ç¨æ³",normalizedTitle:"å«ä¹ååºæ¬ç¨æ³",charIndex:7722},{level:3,title:"å®ä¾çå±æ§åæä½æ¹æ³",slug:"å®ä¾çå±æ§åæä½æ¹æ³",normalizedTitle:"å®ä¾çå±æ§åæä½æ¹æ³",charIndex:10533},{level:3,title:"éåæ¹æ³",slug:"éåæ¹æ³",normalizedTitle:"éåæ¹æ³",charIndex:1513},{level:3,title:"ä¸å¶ä»æ°æ®ç»æçäºç¸è½¬æ¢",slug:"ä¸å¶ä»æ°æ®ç»æçäºç¸è½¬æ¢",normalizedTitle:"ä¸å¶ä»æ°æ®ç»æçäºç¸è½¬æ¢",charIndex:14067},{level:2,title:"WeakMap",slug:"weakmap",normalizedTitle:"weakmap",charIndex:6028},{level:3,title:"å«ä¹",slug:"å«ä¹-2",normalizedTitle:"å«ä¹",charIndex:5267},{level:3,title:"WeakMap çè¯­æ³",slug:"weakmap-çè¯­æ³",normalizedTitle:"weakmap çè¯­æ³",charIndex:18170},{level:3,title:"WeakMap çç¤ºä¾",slug:"weakmap-çç¤ºä¾",normalizedTitle:"weakmap çç¤ºä¾",charIndex:18571},{level:3,title:"WeakMap çç¨é",slug:"weakmap-çç¨é",normalizedTitle:"weakmap çç¨é",charIndex:19977}],excerpt:'<h1 id="set-å-map-æ°æ®ç»æ"><a class="header-anchor" href="#set-å-map-æ°æ®ç»æ">#</a> Set å Map æ°æ®ç»æ</h1>\n<h2 id="set"><a class="header-anchor" href="#set">#</a> Set</h2>\n<h3 id="åºæ¬ç¨æ³"><a class="header-anchor" href="#åºæ¬ç¨æ³">#</a> åºæ¬ç¨æ³</h3>\n<p>ES6 æä¾äºæ°çæ°æ®ç»æ Setãå®<strong>ç±»ä¼¼äºæ°ç»ï¼ä½æ¯æåçå¼é½æ¯å¯ä¸çï¼æ²¡æéå¤çå¼</strong>ã</p>\n<p><strong><code>Set</code>æ¬èº«æ¯ä¸ä¸ªæé å½æ°ï¼ç¨æ¥çæ Set æ°æ®ç»æ</strong>ã</p>\n\x3c!--beforebegin--\x3e<div class="language-javascript line-numbers-mode">\x3c!--afterbegin--\x3e<pre v-pre class="language-javascript"><code><span class="token keyword">const</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=></span> s<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">of</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token comment">// 2 3 5 4</span>\n</code></pre>\n<div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div>\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e',headersStr:"Set åºæ¬ç¨æ³ Set å®ä¾çå±æ§åæ¹æ³ éåæä½ WeakSet å«ä¹ è¯­æ³ Map å«ä¹ååºæ¬ç¨æ³ å®ä¾çå±æ§åæä½æ¹æ³ éåæ¹æ³ ä¸å¶ä»æ°æ®ç»æçäºç¸è½¬æ¢ WeakMap å«ä¹ WeakMap çè¯­æ³ WeakMap çç¤ºä¾ WeakMap çç¨é",content:"# Set å Map æ°æ®ç»æ\n\n\n# Set\n\n\n# åºæ¬ç¨æ³\n\nES6 æä¾äºæ°çæ°æ®ç»æ Setãå®ç±»ä¼¼äºæ°ç»ï¼ä½æ¯æåçå¼é½æ¯å¯ä¸çï¼æ²¡æéå¤çå¼ã\n\nSetæ¬èº«æ¯ä¸ä¸ªæé å½æ°ï¼ç¨æ¥çæ Set æ°æ®ç»æã\n\nconst s = new Set();\n\n[2, 3, 5, 4, 5, 2, 2].forEach(x => s.add(x));\n\nfor (let i of s) {\n  console.log(i);\n}\n// 2 3 5 4\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç éè¿add()æ¹æ³å Set ç»æå å¥æåï¼ç»æè¡¨æ Set ç»æä¸ä¼æ·»å éå¤çå¼ã\n\nSetå½æ°å¯ä»¥æ¥åä¸ä¸ªæ°ç»ï¼æèå·æ iterable æ¥å£çå¶ä»æ°æ®ç»æï¼ä½ä¸ºåæ°ï¼ç¨æ¥åå§åã\n\n// ä¾ä¸\nconst set = new Set([1, 2, 3, 4, 4]);\n[...set]\n// [1, 2, 3, 4]\n\n// ä¾äº\nconst items = new Set([1, 2, 3, 4, 5, 5, 5, 5]);\nitems.size // 5\n\n// ä¾ä¸\nconst set = new Set(document.querySelectorAll('div'));\nset.size // 56\n\n// ç±»ä¼¼äº\nconst set = new Set();\ndocument\n .querySelectorAll('div')\n .forEach(div => set.add(div));\nset.size // 56\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¾ä¸åä¾äºé½æ¯Setå½æ°æ¥åæ°ç»ä½ä¸ºåæ°ï¼ä¾ä¸æ¯æ¥åç±»ä¼¼æ°ç»çå¯¹è±¡ä½ä¸ºåæ°ã\n\nä¸é¢ä»£ç ä¹å±ç¤ºäºä¸ç§å»é¤æ°ç»éå¤æåçæ¹æ³ã\n\n// å»é¤æ°ç»çéå¤æå\n[...new Set(array)]\n\n\n1\n2\n\n\nä¸é¢çæ¹æ³ä¹å¯ä»¥ç¨äºï¼å»é¤å­ç¬¦ä¸²éé¢çéå¤å­ç¬¦ã\n\n[...new Set('ababbc')].join('')\n// \"abc\"\n\n\n1\n2\n\n\nå Set å å¥å¼çæ¶åï¼ä¸ä¼åçç±»åè½¬æ¢ï¼æä»¥5å\"5\"æ¯ä¸¤ä¸ªä¸åçå¼ãSet åé¨å¤æ­ä¸¤ä¸ªå¼æ¯å¦ä¸åï¼ä½¿ç¨çç®æ³å«åâSame-value-zero equalityâï¼å®ç±»ä¼¼äºç²¾ç¡®ç¸ç­è¿ç®ç¬¦ï¼===ï¼ï¼ä¸»è¦çåºå«æ¯å Set å å¥å¼æ¶è®¤ä¸ºNaNç­äºèªèº«ï¼èç²¾ç¡®ç¸ç­è¿ç®ç¬¦è®¤ä¸ºNaNä¸ç­äºèªèº«ã\n\nlet set = new Set();\nlet a = NaN;\nlet b = NaN;\nset.add(a);\nset.add(b);\nset // Set {NaN}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç å Set å®ä¾æ·»å äºä¸¤æ¬¡NaNï¼ä½æ¯åªä¼å å¥ä¸ä¸ªãè¿è¡¨æï¼å¨ Set åé¨ï¼ä¸¤ä¸ªNaNæ¯ç¸ç­çã\n\nå¦å¤ï¼ä¸¤ä¸ªå¯¹è±¡æ»æ¯ä¸ç¸ç­çã\n\nlet set = new Set();\n\nset.add({});\nset.size // 1\n\nset.add({});\nset.size // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼ç±äºä¸¤ä¸ªç©ºå¯¹è±¡ä¸ç¸ç­ï¼æä»¥å®ä»¬è¢«è§ä¸ºä¸¤ä¸ªå¼ã\n\n\n# Set å®ä¾çå±æ§åæ¹æ³\n\nSet ç»æçå®ä¾æä»¥ä¸å±æ§ã\n\n * Set.prototype.constructorï¼æé å½æ°ï¼é»è®¤å°±æ¯Setå½æ°ã\n * Set.prototype.sizeï¼è¿åSetå®ä¾çæåæ»æ°ã\n\nSet å®ä¾çæ¹æ³åä¸ºä¸¤å¤§ç±»ï¼æä½æ¹æ³ï¼ç¨äºæä½æ°æ®ï¼åéåæ¹æ³ï¼ç¨äºéåæåï¼ãä¸é¢åä»ç»åä¸ªæä½æ¹æ³ã\n\n * Set.prototype.add(value)ï¼æ·»å æä¸ªå¼ï¼è¿å Set ç»ææ¬èº«ã\n * Set.prototype.delete(value)ï¼å é¤æä¸ªå¼ï¼è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºå é¤æ¯å¦æåã\n * Set.prototype.has(value)ï¼è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºè¯¥å¼æ¯å¦ä¸ºSetçæåã\n * Set.prototype.clear()ï¼æ¸é¤æææåï¼æ²¡æè¿åå¼ã\n\nä¸é¢è¿äºå±æ§åæ¹æ³çå®ä¾å¦ä¸ã\n\ns.add(1).add(2).add(2);\n// æ³¨æ2è¢«å å¥äºä¸¤æ¬¡\n\ns.size // 2\n\ns.has(1) // true\ns.has(2) // true\ns.has(3) // false\n\ns.delete(2);\ns.has(2) // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢æ¯ä¸ä¸ªå¯¹æ¯ï¼ççå¨å¤æ­æ¯å¦åæ¬ä¸ä¸ªé®ä¸é¢ï¼Objectç»æåSetç»æçåæ³ä¸åã\n\n// å¯¹è±¡çåæ³\nconst properties = {\n  'width': 1,\n  'height': 1\n};\n\nif (properties[someName]) {\n  // do something\n}\n\n// Setçåæ³\nconst properties = new Set();\n\nproperties.add('width');\nproperties.add('height');\n\nif (properties.has(someName)) {\n  // do something\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nArray.fromæ¹æ³å¯ä»¥å° Set ç»æè½¬ä¸ºæ°ç»ã\n\nconst items = new Set([1, 2, 3, 4, 5]);\nconst array = Array.from(items);\n\n\n1\n2\n\n\nè¿å°±æä¾äºå»é¤æ°ç»éå¤æåçå¦ä¸ç§æ¹æ³ã\n\nfunction dedupe(array) {\n  return Array.from(new Set(array));\n}\n\ndedupe([1, 1, 2, 3]) // [1, 2, 3]\n\n\n1\n2\n3\n4\n5\n\n\n\n# éåæä½\n\nSet ç»æçå®ä¾æåä¸ªéåæ¹æ³ï¼å¯ä»¥ç¨äºéåæåã\n\n * Set.prototype.keys()ï¼è¿åé®åçéåå¨\n * Set.prototype.values()ï¼è¿åé®å¼çéåå¨\n * Set.prototype.entries()ï¼è¿åé®å¼å¯¹çéåå¨\n * Set.prototype.forEach()ï¼ä½¿ç¨åè°å½æ°éåæ¯ä¸ªæå\n\néè¦ç¹å«æåºçæ¯ï¼Setçéåé¡ºåºå°±æ¯æå¥é¡ºåºãè¿ä¸ªç¹æ§ææ¶éå¸¸æç¨ï¼æ¯å¦ä½¿ç¨ Set ä¿å­ä¸ä¸ªåè°å½æ°åè¡¨ï¼è°ç¨æ¶å°±è½ä¿è¯æç§æ·»å é¡ºåºè°ç¨ã\n\nï¼1ï¼keys()ï¼values()ï¼entries()\n\nkeysæ¹æ³ãvaluesæ¹æ³ãentriesæ¹æ³è¿åçé½æ¯éåå¨å¯¹è±¡ï¼è¯¦è§ãIterator å¯¹è±¡ãä¸ç« ï¼ãç±äº Set ç»ææ²¡æé®åï¼åªæé®å¼ï¼æèè¯´é®ååé®å¼æ¯åä¸ä¸ªå¼ï¼ï¼æä»¥keysæ¹æ³åvaluesæ¹æ³çè¡ä¸ºå®å¨ä¸è´ã\n\nlet set = new Set(['red', 'green', 'blue']);\n\nfor (let item of set.keys()) {\n  console.log(item);\n}\n// red\n// green\n// blue\n\nfor (let item of set.values()) {\n  console.log(item);\n}\n// red\n// green\n// blue\n\nfor (let item of set.entries()) {\n  console.log(item);\n}\n// [\"red\", \"red\"]\n// [\"green\", \"green\"]\n// [\"blue\", \"blue\"]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\nä¸é¢ä»£ç ä¸­ï¼entriesæ¹æ³è¿åçéåå¨ï¼åæ¶åæ¬é®ååé®å¼ï¼æä»¥æ¯æ¬¡è¾åºä¸ä¸ªæ°ç»ï¼å®çä¸¤ä¸ªæåå®å¨ç¸ç­ã\n\nSet ç»æçå®ä¾é»è®¤å¯éåï¼å®çé»è®¤éåå¨çæå½æ°å°±æ¯å®çvaluesæ¹æ³ã\n\nSet.prototype[Symbol.iterator] === Set.prototype.values\n// true\n\n\n1\n2\n\n\nè¿æå³çï¼å¯ä»¥çç¥valuesæ¹æ³ï¼ç´æ¥ç¨for...ofå¾ªç¯éå Setã\n\nlet set = new Set(['red', 'green', 'blue']);\n\nfor (let x of set) {\n  console.log(x);\n}\n// red\n// green\n// blue\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nï¼2ï¼forEach()\n\nSet ç»æçå®ä¾ä¸æ°ç»ä¸æ ·ï¼ä¹æ¥æforEachæ¹æ³ï¼ç¨äºå¯¹æ¯ä¸ªæåæ§è¡æç§æä½ï¼æ²¡æè¿åå¼ã\n\nlet set = new Set([1, 4, 9]);\nset.forEach((value, key) => console.log(key + ' : ' + value))\n// 1 : 1\n// 4 : 4\n// 9 : 9\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç è¯´æï¼forEachæ¹æ³çåæ°å°±æ¯ä¸ä¸ªå¤çå½æ°ãè¯¥å½æ°çåæ°ä¸æ°ç»çforEachä¸è´ï¼ä¾æ¬¡ä¸ºé®å¼ãé®åãéåæ¬èº«ï¼ä¸ä¾çç¥äºè¯¥åæ°ï¼ãè¿ééè¦æ³¨æï¼Set ç»æçé®åå°±æ¯é®å¼ï¼ä¸¤èæ¯åä¸ä¸ªå¼ï¼ï¼å æ­¤ç¬¬ä¸ä¸ªåæ°ä¸ç¬¬äºä¸ªåæ°çå¼æ°¸è¿é½æ¯ä¸æ ·çã\n\nå¦å¤ï¼forEachæ¹æ³è¿å¯ä»¥æç¬¬äºä¸ªåæ°ï¼è¡¨ç¤ºç»å®å¤çå½æ°åé¨çthiså¯¹è±¡ã\n\nï¼3ï¼éåçåºç¨\n\næ©å±è¿ç®ç¬¦ï¼...ï¼åé¨ä½¿ç¨for...ofå¾ªç¯ï¼æä»¥ä¹å¯ä»¥ç¨äº Set ç»æã\n\nlet set = new Set(['red', 'green', 'blue']);\nlet arr = [...set];\n// ['red', 'green', 'blue']\n\n\n1\n2\n3\n\n\næ©å±è¿ç®ç¬¦å Set ç»æç¸ç»åï¼å°±å¯ä»¥å»é¤æ°ç»çéå¤æåã\n\nlet arr = [3, 5, 2, 2, 5, 5];\nlet unique = [...new Set(arr)];\n// [3, 5, 2]\n\n\n1\n2\n3\n\n\nèä¸ï¼æ°ç»çmapåfilteræ¹æ³ä¹å¯ä»¥é´æ¥ç¨äº Set äºã\n\nlet set = new Set([1, 2, 3]);\nset = new Set([...set].map(x => x * 2));\n// è¿åSetç»æï¼{2, 4, 6}\n\nlet set = new Set([1, 2, 3, 4, 5]);\nset = new Set([...set].filter(x => (x % 2) == 0));\n// è¿åSetç»æï¼{2, 4}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå æ­¤ä½¿ç¨ Set å¯ä»¥å¾å®¹æå°å®ç°å¹¶éï¼Unionï¼ãäº¤éï¼Intersectï¼åå·®éï¼Differenceï¼ã\n\nlet a = new Set([1, 2, 3]);\nlet b = new Set([4, 3, 2]);\n\n// å¹¶é\nlet union = new Set([...a, ...b]);\n// Set {1, 2, 3, 4}\n\n// äº¤é\nlet intersect = new Set([...a].filter(x => b.has(x)));\n// set {2, 3}\n\n// å·®é\nlet difference = new Set([...a].filter(x => !b.has(x)));\n// Set {1}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nå¦ææ³å¨éåæä½ä¸­ï¼åæ­¥æ¹ååæ¥ç Set ç»æï¼ç®åæ²¡æç´æ¥çæ¹æ³ï¼ä½æä¸¤ç§åéæ¹æ³ãä¸ç§æ¯å©ç¨å Set ç»ææ å°åºä¸ä¸ªæ°çç»æï¼ç¶åèµå¼ç»åæ¥ç Set ç»æï¼å¦ä¸ç§æ¯å©ç¨Array.fromæ¹æ³ã\n\n// æ¹æ³ä¸\nlet set = new Set([1, 2, 3]);\nset = new Set([...set].map(val => val * 2));\n// setçå¼æ¯2, 4, 6\n\n// æ¹æ³äº\nlet set = new Set([1, 2, 3]);\nset = new Set(Array.from(set, val => val * 2));\n// setçå¼æ¯2, 4, 6\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç æä¾äºä¸¤ç§æ¹æ³ï¼ç´æ¥å¨éåæä½ä¸­æ¹ååæ¥ç Set ç»æã\n\n\n# WeakSet\n\n\n# å«ä¹\n\nWeakSet ç»æä¸ Set ç±»ä¼¼ï¼ä¹æ¯ä¸éå¤çå¼çéåãä½æ¯ï¼å®ä¸ Set æä¸¤ä¸ªåºå«ã\n\né¦åï¼WeakSet çæååªè½æ¯å¯¹è±¡ï¼èä¸è½æ¯å¶ä»ç±»åçå¼ã\n\nconst ws = new WeakSet();\nws.add(1)\n// TypeError: Invalid value used in weak set\nws.add(Symbol())\n// TypeError: invalid value used in weak set\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç è¯å¾å WeakSet æ·»å ä¸ä¸ªæ°å¼åSymbolå¼ï¼ç»ææ¥éï¼å ä¸º WeakSet åªè½æ¾ç½®å¯¹è±¡ã\n\nå¶æ¬¡ï¼WeakSet ä¸­çå¯¹è±¡é½æ¯å¼±å¼ç¨ï¼å³åå¾åæ¶æºå¶ä¸èè WeakSet å¯¹è¯¥å¯¹è±¡çå¼ç¨ï¼ä¹å°±æ¯è¯´ï¼å¦æå¶ä»å¯¹è±¡é½ä¸åå¼ç¨è¯¥å¯¹è±¡ï¼é£ä¹åå¾åæ¶æºå¶ä¼èªå¨åæ¶è¯¥å¯¹è±¡æå ç¨çåå­ï¼ä¸èèè¯¥å¯¹è±¡è¿å­å¨äº WeakSet ä¹ä¸­ã\n\nè¿æ¯å ä¸ºåå¾åæ¶æºå¶ä¾èµå¼ç¨è®¡æ°ï¼å¦æä¸ä¸ªå¼çå¼ç¨æ¬¡æ°ä¸ä¸º0ï¼åå¾åæ¶æºå¶å°±ä¸ä¼éæ¾è¿ååå­ãç»æä½¿ç¨è¯¥å¼ä¹åï¼ææ¶ä¼å¿è®°åæ¶å¼ç¨ï¼å¯¼è´åå­æ æ³éæ¾ï¼è¿èå¯è½ä¼å¼ååå­æ³æ¼ãWeakSet éé¢çå¼ç¨ï¼é½ä¸è®¡å¥åå¾åæ¶æºå¶ï¼æä»¥å°±ä¸å­å¨è¿ä¸ªé®é¢ãå æ­¤ï¼WeakSet éåä¸´æ¶å­æ¾ä¸ç»å¯¹è±¡ï¼ä»¥åå­æ¾è·å¯¹è±¡ç»å®çä¿¡æ¯ãåªè¦è¿äºå¯¹è±¡å¨å¤é¨æ¶å¤±ï¼å®å¨ WeakSet éé¢çå¼ç¨å°±ä¼èªå¨æ¶å¤±ã\n\nç±äºä¸é¢è¿ä¸ªç¹ç¹ï¼WeakSet çæåæ¯ä¸éåå¼ç¨çï¼å ä¸ºå®ä¼éæ¶æ¶å¤±ãå¦å¤ï¼ç±äº WeakSet åé¨æå¤å°ä¸ªæåï¼åå³äºåå¾åæ¶æºå¶ææ²¡æè¿è¡ï¼è¿è¡ååå¾å¯è½æåä¸ªæ°æ¯ä¸ä¸æ ·çï¼èåå¾åæ¶æºå¶ä½æ¶è¿è¡æ¯ä¸å¯é¢æµçï¼å æ­¤ ES6 è§å® WeakSet ä¸å¯éåã\n\nè¿äºç¹ç¹åæ ·éç¨äºæ¬ç« åé¢è¦ä»ç»ç WeakMap ç»æã\n\n\n# è¯­æ³\n\nWeakSet æ¯ä¸ä¸ªæé å½æ°ï¼å¯ä»¥ä½¿ç¨newå½ä»¤ï¼åå»º WeakSet æ°æ®ç»æã\n\nconst ws = new WeakSet();\n\n\n1\n\n\nä½ä¸ºæé å½æ°ï¼WeakSet å¯ä»¥æ¥åä¸ä¸ªæ°ç»æç±»ä¼¼æ°ç»çå¯¹è±¡ä½ä¸ºåæ°ãï¼å®éä¸ï¼ä»»ä½å·æ Iterable æ¥å£çå¯¹è±¡ï¼é½å¯ä»¥ä½ä¸º WeakSet çåæ°ãï¼è¯¥æ°ç»çæææåï¼é½ä¼èªå¨æä¸º WeakSet å®ä¾å¯¹è±¡çæåã\n\nconst a = [[1, 2], [3, 4]];\nconst ws = new WeakSet(a);\n// WeakSet {[1, 2], [3, 4]}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼aæ¯ä¸ä¸ªæ°ç»ï¼å®æä¸¤ä¸ªæåï¼ä¹é½æ¯æ°ç»ãå°aä½ä¸º WeakSet æé å½æ°çåæ°ï¼açæåä¼èªå¨æä¸º WeakSet çæåã\n\næ³¨æï¼æ¯aæ°ç»çæåæä¸º WeakSet çæåï¼èä¸æ¯aæ°ç»æ¬èº«ãè¿æå³çï¼æ°ç»çæååªè½æ¯å¯¹è±¡ã\n\nconst b = [3, 4];\nconst ws = new WeakSet(b);\n// Uncaught TypeError: Invalid value used in weak set(â¦)\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»bçæåä¸æ¯å¯¹è±¡ï¼å å¥ WeakSet å°±ä¼æ¥éã\n\nWeakSet ç»ææä»¥ä¸ä¸ä¸ªæ¹æ³ã\n\n * WeakSet.prototype.add(value)ï¼å WeakSet å®ä¾æ·»å ä¸ä¸ªæ°æåã\n * WeakSet.prototype.delete(value)ï¼æ¸é¤ WeakSet å®ä¾çæå®æåã\n * WeakSet.prototype.has(value)ï¼è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºæä¸ªå¼æ¯å¦å¨ WeakSet å®ä¾ä¹ä¸­ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nconst ws = new WeakSet();\nconst obj = {};\nconst foo = {};\n\nws.add(window);\nws.add(obj);\n\nws.has(window); // true\nws.has(foo);    // false\n\nws.delete(window);\nws.has(window);    // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nWeakSet æ²¡æsizeå±æ§ï¼æ²¡æåæ³éåå®çæåã\n\nws.size // undefined\nws.forEach // undefined\n\nws.forEach(function(item){ console.log('WeakSet has ' + item)})\n// TypeError: undefined is not a function\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç è¯å¾è·åsizeåforEachå±æ§ï¼ç»æé½ä¸è½æåã\n\nWeakSet ä¸è½éåï¼æ¯å ä¸ºæåé½æ¯å¼±å¼ç¨ï¼éæ¶å¯è½æ¶å¤±ï¼éåæºå¶æ æ³ä¿è¯æåçå­å¨ï¼å¾å¯è½ååéåç»æï¼æåå°±åä¸å°äºãWeakSet çä¸ä¸ªç¨å¤ï¼æ¯å¨å­ DOM èç¹ï¼èä¸ç¨æå¿è¿äºèç¹ä»ææ¡£ç§»é¤æ¶ï¼ä¼å¼ååå­æ³æ¼ã\n\nä¸é¢æ¯ WeakSet çå¦ä¸ä¸ªä¾å­ã\n\nconst foos = new WeakSet()\nclass Foo {\n  constructor() {\n    foos.add(this)\n  }\n  method () {\n    if (!foos.has(this)) {\n      throw new TypeError('Foo.prototype.method åªè½å¨Fooçå®ä¾ä¸è°ç¨ï¼');\n    }\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¿è¯äºFooçå®ä¾æ¹æ³ï¼åªè½å¨Fooçå®ä¾ä¸è°ç¨ãè¿éä½¿ç¨ WeakSet çå¥½å¤æ¯ï¼fooså¯¹å®ä¾çå¼ç¨ï¼ä¸ä¼è¢«è®¡å¥åå­åæ¶æºå¶ï¼æä»¥å é¤å®ä¾çæ¶åï¼ä¸ç¨èèfoosï¼ä¹ä¸ä¼åºç°åå­æ³æ¼ã\n\n\n# Map\n\n\n# å«ä¹ååºæ¬ç¨æ³\n\nJavaScript çå¯¹è±¡ï¼Objectï¼ï¼æ¬è´¨ä¸æ¯é®å¼å¯¹çéåï¼Hash ç»æï¼ï¼ä½æ¯ä¼ ç»ä¸åªè½ç¨å­ç¬¦ä¸²å½ä½é®ãè¿ç»å®çä½¿ç¨å¸¦æ¥äºå¾å¤§çéå¶ã\n\nconst data = {};\nconst element = document.getElementById('myDiv');\n\ndata[element] = 'metadata';\ndata['[object HTMLDivElement]'] // \"metadata\"\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç åææ¯å°ä¸ä¸ª DOM èç¹ä½ä¸ºå¯¹è±¡dataçé®ï¼ä½æ¯ç±äºå¯¹è±¡åªæ¥åå­ç¬¦ä¸²ä½ä¸ºé®åï¼æä»¥elementè¢«èªå¨è½¬ä¸ºå­ç¬¦ä¸²[object HTMLDivElement]ã\n\nä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼ES6 æä¾äº Map æ°æ®ç»æãå®ç±»ä¼¼äºå¯¹è±¡ï¼ä¹æ¯é®å¼å¯¹çéåï¼ä½æ¯âé®âçèå´ä¸éäºå­ç¬¦ä¸²ï¼åç§ç±»åçå¼ï¼åæ¬å¯¹è±¡ï¼é½å¯ä»¥å½ä½é®ãä¹å°±æ¯è¯´ï¼Object ç»ææä¾äºâå­ç¬¦ä¸²âå¼âçå¯¹åºï¼Map ç»ææä¾äºâå¼âå¼âçå¯¹åºï¼æ¯ä¸ç§æ´å®åç Hash ç»æå®ç°ãå¦æä½ éè¦âé®å¼å¯¹âçæ°æ®ç»æï¼Map æ¯ Object æ´åéã\n\nconst m = new Map();\nconst o = {p: 'Hello World'};\n\nm.set(o, 'content')\nm.get(o) // \"content\"\n\nm.has(o) // true\nm.delete(o) // true\nm.has(o) // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä½¿ç¨ Map ç»æçsetæ¹æ³ï¼å°å¯¹è±¡oå½ä½mçä¸ä¸ªé®ï¼ç¶ååä½¿ç¨getæ¹æ³è¯»åè¿ä¸ªé®ï¼æ¥çä½¿ç¨deleteæ¹æ³å é¤äºè¿ä¸ªé®ã\n\nä¸é¢çä¾å­å±ç¤ºäºå¦ä½å Map æ·»å æåãä½ä¸ºæé å½æ°ï¼Map ä¹å¯ä»¥æ¥åä¸ä¸ªæ°ç»ä½ä¸ºåæ°ãè¯¥æ°ç»çæåæ¯ä¸ä¸ªä¸ªè¡¨ç¤ºé®å¼å¯¹çæ°ç»ã\n\nconst map = new Map([\n  ['name', 'å¼ ä¸'],\n  ['title', 'Author']\n]);\n\nmap.size // 2\nmap.has('name') // true\nmap.get('name') // \"å¼ ä¸\"\nmap.has('title') // true\nmap.get('title') // \"Author\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å¨æ°å»º Map å®ä¾æ¶ï¼å°±æå®äºä¸¤ä¸ªé®nameåtitleã\n\nMapæé å½æ°æ¥åæ°ç»ä½ä¸ºåæ°ï¼å®éä¸æ§è¡çæ¯ä¸é¢çç®æ³ã\n\nconst items = [\n  ['name', 'å¼ ä¸'],\n  ['title', 'Author']\n];\n\nconst map = new Map();\n\nitems.forEach(\n  ([key, value]) => map.set(key, value)\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\näºå®ä¸ï¼ä¸ä»ä»æ¯æ°ç»ï¼ä»»ä½å·æ Iterator æ¥å£ãä¸æ¯ä¸ªæåé½æ¯ä¸ä¸ªååç´ çæ°ç»çæ°æ®ç»æï¼è¯¦è§ãIteratorãä¸ç« ï¼é½å¯ä»¥å½ä½Mapæé å½æ°çåæ°ãè¿å°±æ¯è¯´ï¼SetåMapé½å¯ä»¥ç¨æ¥çææ°ç Mapã\n\nconst set = new Set([\n  ['foo', 1],\n  ['bar', 2]\n]);\nconst m1 = new Map(set);\nm1.get('foo') // 1\n\nconst m2 = new Map([['baz', 3]]);\nconst m3 = new Map(m2);\nm3.get('baz') // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼æä»¬åå«ä½¿ç¨ Set å¯¹è±¡å Map å¯¹è±¡ï¼å½ä½Mapæé å½æ°çåæ°ï¼ç»æé½çæäºæ°ç Map å¯¹è±¡ã\n\nå¦æå¯¹åä¸ä¸ªé®å¤æ¬¡èµå¼ï¼åé¢çå¼å°è¦çåé¢çå¼ã\n\nconst map = new Map();\n\nmap\n.set(1, 'aaa')\n.set(1, 'bbb');\n\nmap.get(1) // \"bbb\"\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç å¯¹é®1è¿ç»­èµå¼ä¸¤æ¬¡ï¼åä¸æ¬¡çå¼è¦çåä¸æ¬¡çå¼ã\n\nå¦æè¯»åä¸ä¸ªæªç¥çé®ï¼åè¿åundefinedã\n\nnew Map().get('asfddfsasadf')\n// undefined\n\n\n1\n2\n\n\næ³¨æï¼åªæå¯¹åä¸ä¸ªå¯¹è±¡çå¼ç¨ï¼Map ç»ææå°å¶è§ä¸ºåä¸ä¸ªé®ãè¿ä¸ç¹è¦éå¸¸å°å¿ã\n\nconst map = new Map();\n\nmap.set(['a'], 555);\nmap.get(['a']) // undefined\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç çsetågetæ¹æ³ï¼è¡¨é¢æ¯éå¯¹åä¸ä¸ªé®ï¼ä½å®éä¸è¿æ¯ä¸¤ä¸ªä¸åçæ°ç»å®ä¾ï¼åå­å°åæ¯ä¸ä¸æ ·çï¼å æ­¤getæ¹æ³æ æ³è¯»åè¯¥é®ï¼è¿åundefinedã\n\nåçï¼åæ ·çå¼çä¸¤ä¸ªå®ä¾ï¼å¨ Map ç»æä¸­è¢«è§ä¸ºä¸¤ä¸ªé®ã\n\nconst map = new Map();\n\nconst k1 = ['a'];\nconst k2 = ['a'];\n\nmap\n.set(k1, 111)\n.set(k2, 222);\n\nmap.get(k1) // 111\nmap.get(k2) // 222\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼åék1åk2çå¼æ¯ä¸æ ·çï¼ä½æ¯å®ä»¬å¨ Map ç»æä¸­è¢«è§ä¸ºä¸¤ä¸ªé®ã\n\nç±ä¸å¯ç¥ï¼Map çé®å®éä¸æ¯è·åå­å°åç»å®çï¼åªè¦åå­å°åä¸ä¸æ ·ï¼å°±è§ä¸ºä¸¤ä¸ªé®ãè¿å°±è§£å³äºååå±æ§ç¢°æï¼clashï¼çé®é¢ï¼æä»¬æ©å±å«äººçåºçæ¶åï¼å¦æä½¿ç¨å¯¹è±¡ä½ä¸ºé®åï¼å°±ä¸ç¨æå¿èªå·±çå±æ§ä¸åä½èçå±æ§ååã\n\nå¦æ Map çé®æ¯ä¸ä¸ªç®åç±»åçå¼ï¼æ°å­ãå­ç¬¦ä¸²ãå¸å°å¼ï¼ï¼ååªè¦ä¸¤ä¸ªå¼ä¸¥æ ¼ç¸ç­ï¼Map å°å¶è§ä¸ºä¸ä¸ªé®ï¼æ¯å¦0å-0å°±æ¯ä¸ä¸ªé®ï¼å¸å°å¼trueåå­ç¬¦ä¸²trueåæ¯ä¸¤ä¸ªä¸åçé®ãå¦å¤ï¼undefinedånullä¹æ¯ä¸¤ä¸ªä¸åçé®ãè½ç¶NaNä¸ä¸¥æ ¼ç¸ç­äºèªèº«ï¼ä½ Map å°å¶è§ä¸ºåä¸ä¸ªé®ã\n\nlet map = new Map();\n\nmap.set(-0, 123);\nmap.get(+0) // 123\n\nmap.set(true, 1);\nmap.set('true', 2);\nmap.get(true) // 1\n\nmap.set(undefined, 3);\nmap.set(null, 4);\nmap.get(undefined) // 3\n\nmap.set(NaN, 123);\nmap.get(NaN) // 123\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# å®ä¾çå±æ§åæä½æ¹æ³\n\nMap ç»æçå®ä¾æä»¥ä¸å±æ§åæä½æ¹æ³ã\n\nï¼1ï¼size å±æ§\n\nsizeå±æ§è¿å Map ç»æçæåæ»æ°ã\n\nconst map = new Map();\nmap.set('foo', true);\nmap.set('bar', false);\n\nmap.size // 2\n\n\n1\n2\n3\n4\n5\n\n\nï¼2ï¼Map.prototype.set(key, value)\n\nsetæ¹æ³è®¾ç½®é®åkeyå¯¹åºçé®å¼ä¸ºvalueï¼ç¶åè¿åæ´ä¸ª Map ç»æãå¦ækeyå·²ç»æå¼ï¼åé®å¼ä¼è¢«æ´æ°ï¼å¦åå°±æ°çæè¯¥é®ã\n\nconst m = new Map();\n\nm.set('edition', 6)        // é®æ¯å­ç¬¦ä¸²\nm.set(262, 'standard')     // é®æ¯æ°å¼\nm.set(undefined, 'nah')    // é®æ¯ undefined\n\n\n1\n2\n3\n4\n5\n\n\nsetæ¹æ³è¿åçæ¯å½åçMapå¯¹è±¡ï¼å æ­¤å¯ä»¥éç¨é¾å¼åæ³ã\n\nlet map = new Map()\n  .set(1, 'a')\n  .set(2, 'b')\n  .set(3, 'c');\n\n\n1\n2\n3\n4\n\n\nï¼3ï¼Map.prototype.get(key)\n\ngetæ¹æ³è¯»åkeyå¯¹åºçé®å¼ï¼å¦ææ¾ä¸å°keyï¼è¿åundefinedã\n\nconst m = new Map();\n\nconst hello = function() {console.log('hello');};\nm.set(hello, 'Hello ES6!') // é®æ¯å½æ°\n\nm.get(hello)  // Hello ES6!\n\n\n1\n2\n3\n4\n5\n6\n\n\nï¼4ï¼Map.prototype.has(key)\n\nhasæ¹æ³è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºæä¸ªé®æ¯å¦å¨å½å Map å¯¹è±¡ä¹ä¸­ã\n\nconst m = new Map();\n\nm.set('edition', 6);\nm.set(262, 'standard');\nm.set(undefined, 'nah');\n\nm.has('edition')     // true\nm.has('years')       // false\nm.has(262)           // true\nm.has(undefined)     // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nï¼5ï¼Map.prototype.delete(key)\n\ndeleteæ¹æ³å é¤æä¸ªé®ï¼è¿åtrueãå¦æå é¤å¤±è´¥ï¼è¿åfalseã\n\nconst m = new Map();\nm.set(undefined, 'nah');\nm.has(undefined)     // true\n\nm.delete(undefined)\nm.has(undefined)       // false\n\n\n1\n2\n3\n4\n5\n6\n\n\nï¼6ï¼Map.prototype.clear()\n\nclearæ¹æ³æ¸é¤æææåï¼æ²¡æè¿åå¼ã\n\nlet map = new Map();\nmap.set('foo', true);\nmap.set('bar', false);\n\nmap.size // 2\nmap.clear()\nmap.size // 0\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# éåæ¹æ³\n\nMap ç»æåçæä¾ä¸ä¸ªéåå¨çæå½æ°åä¸ä¸ªéåæ¹æ³ã\n\n * Map.prototype.keys()ï¼è¿åé®åçéåå¨ã\n * Map.prototype.values()ï¼è¿åé®å¼çéåå¨ã\n * Map.prototype.entries()ï¼è¿åæææåçéåå¨ã\n * Map.prototype.forEach()ï¼éå Map çæææåã\n\néè¦ç¹å«æ³¨æçæ¯ï¼Map çéåé¡ºåºå°±æ¯æå¥é¡ºåºã\n\nconst map = new Map([\n  ['F', 'no'],\n  ['T',  'yes'],\n]);\n\nfor (let key of map.keys()) {\n  console.log(key);\n}\n// \"F\"\n// \"T\"\n\nfor (let value of map.values()) {\n  console.log(value);\n}\n// \"no\"\n// \"yes\"\n\nfor (let item of map.entries()) {\n  console.log(item[0], item[1]);\n}\n// \"F\" \"no\"\n// \"T\" \"yes\"\n\n// æè\nfor (let [key, value] of map.entries()) {\n  console.log(key, value);\n}\n// \"F\" \"no\"\n// \"T\" \"yes\"\n\n// ç­åäºä½¿ç¨map.entries()\nfor (let [key, value] of map) {\n  console.log(key, value);\n}\n// \"F\" \"no\"\n// \"T\" \"yes\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n\n\nä¸é¢ä»£ç æåçé£ä¸ªä¾å­ï¼è¡¨ç¤º Map ç»æçé»è®¤éåå¨æ¥å£ï¼Symbol.iteratorå±æ§ï¼ï¼å°±æ¯entriesæ¹æ³ã\n\nmap[Symbol.iterator] === map.entries\n// true\n\n\n1\n2\n\n\nMap ç»æè½¬ä¸ºæ°ç»ç»æï¼æ¯è¾å¿«éçæ¹æ³æ¯ä½¿ç¨æ©å±è¿ç®ç¬¦ï¼...ï¼ã\n\nconst map = new Map([\n  [1, 'one'],\n  [2, 'two'],\n  [3, 'three'],\n]);\n\n[...map.keys()]\n// [1, 2, 3]\n\n[...map.values()]\n// ['one', 'two', 'three']\n\n[...map.entries()]\n// [[1,'one'], [2, 'two'], [3, 'three']]\n\n[...map]\n// [[1,'one'], [2, 'two'], [3, 'three']]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nç»åæ°ç»çmapæ¹æ³ãfilteræ¹æ³ï¼å¯ä»¥å®ç° Map çéååè¿æ»¤ï¼Map æ¬èº«æ²¡æmapåfilteræ¹æ³ï¼ã\n\nconst map0 = new Map()\n  .set(1, 'a')\n  .set(2, 'b')\n  .set(3, 'c');\n\nconst map1 = new Map(\n  [...map0].filter(([k, v]) => k < 3)\n);\n// äº§ç Map ç»æ {1 => 'a', 2 => 'b'}\n\nconst map2 = new Map(\n  [...map0].map(([k, v]) => [k * 2, '_' + v])\n    );\n// äº§ç Map ç»æ {2 => '_a', 4 => '_b', 6 => '_c'}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\næ­¤å¤ï¼Map è¿æä¸ä¸ªforEachæ¹æ³ï¼ä¸æ°ç»çforEachæ¹æ³ç±»ä¼¼ï¼ä¹å¯ä»¥å®ç°éåã\n\nmap.forEach(function(value, key, map) {\n  console.log(\"Key: %s, Value: %s\", key, value);\n});\n\n\n1\n2\n3\n\n\nforEachæ¹æ³è¿å¯ä»¥æ¥åç¬¬äºä¸ªåæ°ï¼ç¨æ¥ç»å®thisã\n\nconst reporter = {\n  report: function(key, value) {\n    console.log(\"Key: %s, Value: %s\", key, value);\n  }\n};\n\nmap.forEach(function(value, key, map) {\n  this.report(key, value);\n}, reporter);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼forEachæ¹æ³çåè°å½æ°çthisï¼å°±æåreporterã\n\n\n# ä¸å¶ä»æ°æ®ç»æçäºç¸è½¬æ¢\n\nï¼1ï¼Map è½¬ä¸ºæ°ç»\n\nåé¢å·²ç»æè¿ï¼Map è½¬ä¸ºæ°ç»ææ¹ä¾¿çæ¹æ³ï¼å°±æ¯ä½¿ç¨æ©å±è¿ç®ç¬¦ï¼...ï¼ã\n\nconst myMap = new Map()\n  .set(true, 7)\n  .set({foo: 3}, ['abc']);\n[...myMap]\n// [ [ true, 7 ], [ { foo: 3 }, [ 'abc' ] ] ]\n\n\n1\n2\n3\n4\n5\n\n\nï¼2ï¼æ°ç» è½¬ä¸º Map\n\nå°æ°ç»ä¼ å¥ Map æé å½æ°ï¼å°±å¯ä»¥è½¬ä¸º Mapã\n\nnew Map([\n  [true, 7],\n  [{foo: 3}, ['abc']]\n])\n// Map {\n//   true => 7,\n//   Object {foo: 3} => ['abc']\n// }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nï¼3ï¼Map è½¬ä¸ºå¯¹è±¡\n\nå¦æææ Map çé®é½æ¯å­ç¬¦ä¸²ï¼å®å¯ä»¥æ æå°è½¬ä¸ºå¯¹è±¡ã\n\nfunction strMapToObj(strMap) {\n  let obj = Object.create(null);\n  for (let [k,v] of strMap) {\n    obj[k] = v;\n  }\n  return obj;\n}\n\nconst myMap = new Map()\n  .set('yes', true)\n  .set('no', false);\nstrMapToObj(myMap)\n// { yes: true, no: false }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nå¦ææéå­ç¬¦ä¸²çé®åï¼é£ä¹è¿ä¸ªé®åä¼è¢«è½¬æå­ç¬¦ä¸²ï¼åä½ä¸ºå¯¹è±¡çé®åã\n\nï¼4ï¼å¯¹è±¡è½¬ä¸º Map\n\nfunction objToStrMap(obj) {\n  let strMap = new Map();\n  for (let k of Object.keys(obj)) {\n    strMap.set(k, obj[k]);\n  }\n  return strMap;\n}\n\nobjToStrMap({yes: true, no: false})\n// Map {\"yes\" => true, \"no\" => false}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nï¼5ï¼Map è½¬ä¸º JSON\n\nMap è½¬ä¸º JSON è¦åºåä¸¤ç§æåµãä¸ç§æåµæ¯ï¼Map çé®åé½æ¯å­ç¬¦ä¸²ï¼è¿æ¶å¯ä»¥éæ©è½¬ä¸ºå¯¹è±¡ JSONã\n\nfunction strMapToJson(strMap) {\n  return JSON.stringify(strMapToObj(strMap));\n}\n\nlet myMap = new Map().set('yes', true).set('no', false);\nstrMapToJson(myMap)\n// '{\"yes\":true,\"no\":false}'\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦ä¸ç§æåµæ¯ï¼Map çé®åæéå­ç¬¦ä¸²ï¼è¿æ¶å¯ä»¥éæ©è½¬ä¸ºæ°ç» JSONã\n\nfunction mapToArrayJson(map) {\n  return JSON.stringify([...map]);\n}\n\nlet myMap = new Map().set(true, 7).set({foo: 3}, ['abc']);\nmapToArrayJson(myMap)\n// '[[true,7],[{\"foo\":3},[\"abc\"]]]'\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nï¼6ï¼JSON è½¬ä¸º Map\n\nJSON è½¬ä¸º Mapï¼æ­£å¸¸æåµä¸ï¼ææé®åé½æ¯å­ç¬¦ä¸²ã\n\nfunction jsonToStrMap(jsonStr) {\n  return objToStrMap(JSON.parse(jsonStr));\n}\n\njsonToStrMap('{\"yes\": true, \"no\": false}')\n// Map {'yes' => true, 'no' => false}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä½æ¯ï¼æä¸ç§ç¹æ®æåµï¼æ´ä¸ª JSON å°±æ¯ä¸ä¸ªæ°ç»ï¼ä¸æ¯ä¸ªæ°ç»æåæ¬èº«ï¼åæ¯ä¸ä¸ªæä¸¤ä¸ªæåçæ°ç»ãè¿æ¶ï¼å®å¯ä»¥ä¸ä¸å¯¹åºå°è½¬ä¸º Mapãè¿å¾å¾æ¯ Map è½¬ä¸ºæ°ç» JSON çéæä½ã\n\nfunction jsonToMap(jsonStr) {\n  return new Map(JSON.parse(jsonStr));\n}\n\njsonToMap('[[true,7],[{\"foo\":3},[\"abc\"]]]')\n// Map {true => 7, Object {foo: 3} => ['abc']}\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# WeakMap\n\n\n# å«ä¹\n\nWeakMapç»æä¸Mapç»æç±»ä¼¼ï¼ä¹æ¯ç¨äºçæé®å¼å¯¹çéåã\n\n// WeakMap å¯ä»¥ä½¿ç¨ set æ¹æ³æ·»å æå\nconst wm1 = new WeakMap();\nconst key = {foo: 1};\nwm1.set(key, 2);\nwm1.get(key) // 2\n\n// WeakMap ä¹å¯ä»¥æ¥åä¸ä¸ªæ°ç»ï¼\n// ä½ä¸ºæé å½æ°çåæ°\nconst k1 = [1, 2, 3];\nconst k2 = [4, 5, 6];\nconst wm2 = new WeakMap([[k1, 'foo'], [k2, 'bar']]);\nwm2.get(k2) // \"bar\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nWeakMapä¸Mapçåºå«æä¸¤ç¹ã\n\né¦åï¼WeakMapåªæ¥åå¯¹è±¡ä½ä¸ºé®åï¼nullé¤å¤ï¼ï¼ä¸æ¥åå¶ä»ç±»åçå¼ä½ä¸ºé®åã\n\nconst map = new WeakMap();\nmap.set(1, 2)\n// TypeError: 1 is not an object!\nmap.set(Symbol(), 2)\n// TypeError: Invalid value used as weak map key\nmap.set(null, 2)\n// TypeError: Invalid value used as weak map key\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æå°æ°å¼1åSymbolå¼ä½ä¸º WeakMap çé®åï¼é½ä¼æ¥éã\n\nå¶æ¬¡ï¼WeakMapçé®åææåçå¯¹è±¡ï¼ä¸è®¡å¥åå¾åæ¶æºå¶ã\n\nWeakMapçè®¾è®¡ç®çå¨äºï¼ææ¶æä»¬æ³å¨æä¸ªå¯¹è±¡ä¸é¢å­æ¾ä¸äºæ°æ®ï¼ä½æ¯è¿ä¼å½¢æå¯¹äºè¿ä¸ªå¯¹è±¡çå¼ç¨ãè¯·çä¸é¢çä¾å­ã\n\nconst e1 = document.getElementById('foo');\nconst e2 = document.getElementById('bar');\nconst arr = [\n  [e1, 'foo åç´ '],\n  [e2, 'bar åç´ '],\n];\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼e1åe2æ¯ä¸¤ä¸ªå¯¹è±¡ï¼æä»¬éè¿arræ°ç»å¯¹è¿ä¸¤ä¸ªå¯¹è±¡æ·»å ä¸äºæå­è¯´æãè¿å°±å½¢æäºarrå¯¹e1åe2çå¼ç¨ã\n\nä¸æ¦ä¸åéè¦è¿ä¸¤ä¸ªå¯¹è±¡ï¼æä»¬å°±å¿é¡»æå¨å é¤è¿ä¸ªå¼ç¨ï¼å¦ååå¾åæ¶æºå¶å°±ä¸ä¼éæ¾e1åe2å ç¨çåå­ã\n\n// ä¸éè¦ e1 å e2 çæ¶å\n// å¿é¡»æå¨å é¤å¼ç¨\narr [0] = null;\narr [1] = null;\n\n\n1\n2\n3\n4\n\n\nä¸é¢è¿æ ·çåæ³æ¾ç¶å¾ä¸æ¹ä¾¿ãä¸æ¦å¿äºåï¼å°±ä¼é æåå­æ³é²ã\n\nWeakMap å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢èè¯ççï¼å®çé®åæå¼ç¨çå¯¹è±¡é½æ¯å¼±å¼ç¨ï¼å³åå¾åæ¶æºå¶ä¸å°è¯¥å¼ç¨èèå¨åãå æ­¤ï¼åªè¦æå¼ç¨çå¯¹è±¡çå¶ä»å¼ç¨é½è¢«æ¸é¤ï¼åå¾åæ¶æºå¶å°±ä¼éæ¾è¯¥å¯¹è±¡æå ç¨çåå­ãä¹å°±æ¯è¯´ï¼ä¸æ¦ä¸åéè¦ï¼WeakMap éé¢çé®åå¯¹è±¡åæå¯¹åºçé®å¼å¯¹ä¼èªå¨æ¶å¤±ï¼ä¸ç¨æå¨å é¤å¼ç¨ã\n\nåºæ¬ä¸ï¼å¦æä½ è¦å¾å¯¹è±¡ä¸æ·»å æ°æ®ï¼åä¸æ³å¹²æ°åå¾åæ¶æºå¶ï¼å°±å¯ä»¥ä½¿ç¨ WeakMapãä¸ä¸ªå¸ååºç¨åºæ¯æ¯ï¼å¨ç½é¡µç DOM åç´ ä¸æ·»å æ°æ®ï¼å°±å¯ä»¥ä½¿ç¨WeakMapç»æãå½è¯¥ DOM åç´ è¢«æ¸é¤ï¼å¶æå¯¹åºçWeakMapè®°å½å°±ä¼èªå¨è¢«ç§»é¤ã\n\nconst wm = new WeakMap();\n\nconst element = document.getElementById('example');\n\nwm.set(element, 'some information');\nwm.get(element) // \"some information\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°å»ºä¸ä¸ª Weakmap å®ä¾ãç¶åï¼å°ä¸ä¸ª DOM èç¹ä½ä¸ºé®åå­å¥è¯¥å®ä¾ï¼å¹¶å°ä¸äºéå ä¿¡æ¯ä½ä¸ºé®å¼ï¼ä¸èµ·å­æ¾å¨ WeakMap éé¢ãè¿æ¶ï¼WeakMap éé¢å¯¹elementçå¼ç¨å°±æ¯å¼±å¼ç¨ï¼ä¸ä¼è¢«è®¡å¥åå¾åæ¶æºå¶ã\n\nä¹å°±æ¯è¯´ï¼ä¸é¢ç DOM èç¹å¯¹è±¡çå¼ç¨è®¡æ°æ¯1ï¼èä¸æ¯2ãè¿æ¶ï¼ä¸æ¦æ¶é¤å¯¹è¯¥èç¹çå¼ç¨ï¼å®å ç¨çåå­å°±ä¼è¢«åå¾åæ¶æºå¶éæ¾ãWeakmap ä¿å­çè¿ä¸ªé®å¼å¯¹ï¼ä¹ä¼èªå¨æ¶å¤±ã\n\næ»ä¹ï¼WeakMapçä¸ç¨åºåå°±æ¯ï¼å®çé®æå¯¹åºçå¯¹è±¡ï¼å¯è½ä¼å¨å°æ¥æ¶å¤±ãWeakMapç»ææå©äºé²æ­¢åå­æ³æ¼ã\n\næ³¨æï¼WeakMap å¼±å¼ç¨çåªæ¯é®åï¼èä¸æ¯é®å¼ãé®å¼ä¾ç¶æ¯æ­£å¸¸å¼ç¨ã\n\nconst wm = new WeakMap();\nlet key = {};\nlet obj = {foo: 1};\n\nwm.set(key, obj);\nobj = null;\nwm.get(key)\n// Object {foo: 1}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼é®å¼objæ¯æ­£å¸¸å¼ç¨ãæä»¥ï¼å³ä½¿å¨ WeakMap å¤é¨æ¶é¤äºobjçå¼ç¨ï¼WeakMap åé¨çå¼ç¨ä¾ç¶å­å¨ã\n\n\n# WeakMap çè¯­æ³\n\nWeakMap ä¸ Map å¨ API ä¸çåºå«ä¸»è¦æ¯ä¸¤ä¸ªï¼ä¸æ¯æ²¡æéåæä½ï¼å³æ²¡ækeys()ãvalues()åentries()æ¹æ³ï¼ï¼ä¹æ²¡æsizeå±æ§ãå ä¸ºæ²¡æåæ³ååºææé®åï¼æä¸ªé®åæ¯å¦å­å¨å®å¨ä¸å¯é¢æµï¼è·åå¾åæ¶æºå¶æ¯å¦è¿è¡ç¸å³ãè¿ä¸å»å¯ä»¥åå°é®åï¼ä¸ä¸å»åå¾åæ¶æºå¶çªç¶è¿è¡äºï¼è¿ä¸ªé®åå°±æ²¡äºï¼ä¸ºäºé²æ­¢åºç°ä¸ç¡®å®æ§ï¼å°±ç»ä¸è§å®ä¸è½åå°é®åãäºæ¯æ æ³æ¸ç©ºï¼å³ä¸æ¯æclearæ¹æ³ãå æ­¤ï¼WeakMapåªæåä¸ªæ¹æ³å¯ç¨ï¼get()ãset()ãhas()ãdelete()ã\n\nconst wm = new WeakMap();\n\n// sizeãforEachãclear æ¹æ³é½ä¸å­å¨\nwm.size // undefined\nwm.forEach // undefined\nwm.clear // undefined\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# WeakMap çç¤ºä¾\n\nWeakMap çä¾å­å¾é¾æ¼ç¤ºï¼å ä¸ºæ æ³è§å¯å®éé¢çå¼ç¨ä¼èªå¨æ¶å¤±ãæ­¤æ¶ï¼å¶ä»å¼ç¨é½è§£é¤äºï¼å·²ç»æ²¡æå¼ç¨æå WeakMap çé®åäºï¼å¯¼è´æ æ³è¯å®é£ä¸ªé®åæ¯ä¸æ¯å­å¨ã\n\nè´ºå¸ä¿èå¸æç¤ºï¼å¦æå¼ç¨ææåçå¼å ç¨ç¹å«å¤çåå­ï¼å°±å¯ä»¥éè¿ Node çprocess.memoryUsageæ¹æ³çåºæ¥ãæ ¹æ®è¿ä¸ªæè·¯ï¼ç½åvtxfè¡¥åäºä¸é¢çä¾å­ã\n\né¦åï¼æå¼ Node å½ä»¤è¡ã\n\n$ node --expose-gc\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼--expose-gcåæ°è¡¨ç¤ºåè®¸æå¨æ§è¡åå¾åæ¶æºå¶ã\n\nç¶åï¼æ§è¡ä¸é¢çä»£ç ã\n\n// æå¨æ§è¡ä¸æ¬¡åå¾åæ¶ï¼ä¿è¯è·åçåå­ä½¿ç¨ç¶æåç¡®\n> global.gc();\nundefined\n\n// æ¥çåå­å ç¨çåå§ç¶æï¼heapUsed ä¸º 4M å·¦å³\n> process.memoryUsage();\n{ rss: 21106688,\n  heapTotal: 7376896,\n  heapUsed: 4153936,\n  external: 9059 }\n\n> let wm = new WeakMap();\nundefined\n\n// æ°å»ºä¸ä¸ªåé keyï¼æåä¸ä¸ª 5*1024*1024 çæ°ç»\n> let key = new Array(5 * 1024 * 1024);\nundefined\n\n// è®¾ç½® WeakMap å®ä¾çé®åï¼ä¹æå key æ°ç»\n// è¿æ¶ï¼key æ°ç»å®éè¢«å¼ç¨äºä¸¤æ¬¡ï¼\n// åé key å¼ç¨ä¸æ¬¡ï¼WeakMap çé®åå¼ç¨äºç¬¬äºæ¬¡\n// ä½æ¯ï¼WeakMap æ¯å¼±å¼ç¨ï¼å¯¹äºå¼ææ¥è¯´ï¼å¼ç¨è®¡æ°è¿æ¯1\n> wm.set(key, 1);\nWeakMap {}\n\n> global.gc();\nundefined\n\n// è¿æ¶åå­å ç¨ heapUsed å¢å å° 45M äº\n> process.memoryUsage();\n{ rss: 67538944,\n  heapTotal: 7376896,\n  heapUsed: 45782816,\n  external: 8945 }\n\n// æ¸é¤åé key å¯¹æ°ç»çå¼ç¨ï¼\n// ä½æ²¡ææå¨æ¸é¤ WeakMap å®ä¾çé®åå¯¹æ°ç»çå¼ç¨\n> key = null;\nnull\n\n// åæ¬¡æ§è¡åå¾åæ¶\n> global.gc();\nundefined\n\n// åå­å ç¨ heapUsed åå 4M å·¦å³ï¼\n// å¯ä»¥çå° WeakMap çé®åå¼ç¨æ²¡æé»æ­¢ gc å¯¹åå­çåæ¶\n> process.memoryUsage();\n{ rss: 20639744,\n  heapTotal: 8425472,\n  heapUsed: 3979792,\n  external: 8956 }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n\n\nä¸é¢ä»£ç ä¸­ï¼åªè¦å¤é¨çå¼ç¨æ¶å¤±ï¼WeakMap åé¨çå¼ç¨ï¼å°±ä¼èªå¨è¢«åå¾åæ¶æ¸é¤ãç±æ­¤å¯è§ï¼æäº WeakMap çå¸®å©ï¼è§£å³åå­æ³æ¼å°±ä¼ç®åå¾å¤ã\n\n\n# WeakMap çç¨é\n\nåæè¯´è¿ï¼WeakMap åºç¨çå¸ååºåå°±æ¯ DOM èç¹ä½ä¸ºé®åãä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nlet myElement = document.getElementById('logo');\nlet myWeakmap = new WeakMap();\n\nmyWeakmap.set(myElement, {timesClicked: 0});\n\nmyElement.addEventListener('click', function() {\n  let logoData = myWeakmap.get(myElement);\n  logoData.timesClicked++;\n}, false);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼myElementæ¯ä¸ä¸ª DOM èç¹ï¼æ¯å½åçclickäºä»¶ï¼å°±æ´æ°ä¸ä¸ç¶æãæä»¬å°è¿ä¸ªç¶æä½ä¸ºé®å¼æ¾å¨ WeakMap éï¼å¯¹åºçé®åå°±æ¯myElementãä¸æ¦è¿ä¸ª DOM èç¹å é¤ï¼è¯¥ç¶æå°±ä¼èªå¨æ¶å¤±ï¼ä¸å­å¨åå­æ³æ¼é£é©ã\n\nWeakMap çå¦ä¸ä¸ªç¨å¤æ¯é¨ç½²ç§æå±æ§ã\n\nconst _counter = new WeakMap();\nconst _action = new WeakMap();\n\nclass Countdown {\n  constructor(counter, action) {\n    _counter.set(this, counter);\n    _action.set(this, action);\n  }\n  dec() {\n    let counter = _counter.get(this);\n    if (counter < 1) return;\n    counter--;\n    _counter.set(this, counter);\n    if (counter === 0) {\n      _action.get(this)();\n    }\n  }\n}\n\nconst c = new Countdown(2, () => console.log('DONE'));\n\nc.dec()\nc.dec()\n// DONE\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nä¸é¢ä»£ç ä¸­ï¼Countdownç±»çä¸¤ä¸ªåé¨å±æ§_counterå_actionï¼æ¯å®ä¾çå¼±å¼ç¨ï¼æä»¥å¦æå é¤å®ä¾ï¼å®ä»¬ä¹å°±éä¹æ¶å¤±ï¼ä¸ä¼é æåå­æ³æ¼ã",normalizedContent:"# set å map æ°æ®ç»æ\n\n\n# set\n\n\n# åºæ¬ç¨æ³\n\nes6 æä¾äºæ°çæ°æ®ç»æ setãå®ç±»ä¼¼äºæ°ç»ï¼ä½æ¯æåçå¼é½æ¯å¯ä¸çï¼æ²¡æéå¤çå¼ã\n\nsetæ¬èº«æ¯ä¸ä¸ªæé å½æ°ï¼ç¨æ¥çæ set æ°æ®ç»æã\n\nconst s = new set();\n\n[2, 3, 5, 4, 5, 2, 2].foreach(x => s.add(x));\n\nfor (let i of s) {\n  console.log(i);\n}\n// 2 3 5 4\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç éè¿add()æ¹æ³å set ç»æå å¥æåï¼ç»æè¡¨æ set ç»æä¸ä¼æ·»å éå¤çå¼ã\n\nsetå½æ°å¯ä»¥æ¥åä¸ä¸ªæ°ç»ï¼æèå·æ iterable æ¥å£çå¶ä»æ°æ®ç»æï¼ä½ä¸ºåæ°ï¼ç¨æ¥åå§åã\n\n// ä¾ä¸\nconst set = new set([1, 2, 3, 4, 4]);\n[...set]\n// [1, 2, 3, 4]\n\n// ä¾äº\nconst items = new set([1, 2, 3, 4, 5, 5, 5, 5]);\nitems.size // 5\n\n// ä¾ä¸\nconst set = new set(document.queryselectorall('div'));\nset.size // 56\n\n// ç±»ä¼¼äº\nconst set = new set();\ndocument\n .queryselectorall('div')\n .foreach(div => set.add(div));\nset.size // 56\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¾ä¸åä¾äºé½æ¯setå½æ°æ¥åæ°ç»ä½ä¸ºåæ°ï¼ä¾ä¸æ¯æ¥åç±»ä¼¼æ°ç»çå¯¹è±¡ä½ä¸ºåæ°ã\n\nä¸é¢ä»£ç ä¹å±ç¤ºäºä¸ç§å»é¤æ°ç»éå¤æåçæ¹æ³ã\n\n// å»é¤æ°ç»çéå¤æå\n[...new set(array)]\n\n\n1\n2\n\n\nä¸é¢çæ¹æ³ä¹å¯ä»¥ç¨äºï¼å»é¤å­ç¬¦ä¸²éé¢çéå¤å­ç¬¦ã\n\n[...new set('ababbc')].join('')\n// \"abc\"\n\n\n1\n2\n\n\nå set å å¥å¼çæ¶åï¼ä¸ä¼åçç±»åè½¬æ¢ï¼æä»¥5å\"5\"æ¯ä¸¤ä¸ªä¸åçå¼ãset åé¨å¤æ­ä¸¤ä¸ªå¼æ¯å¦ä¸åï¼ä½¿ç¨çç®æ³å«åâsame-value-zero equalityâï¼å®ç±»ä¼¼äºç²¾ç¡®ç¸ç­è¿ç®ç¬¦ï¼===ï¼ï¼ä¸»è¦çåºå«æ¯å set å å¥å¼æ¶è®¤ä¸ºnanç­äºèªèº«ï¼èç²¾ç¡®ç¸ç­è¿ç®ç¬¦è®¤ä¸ºnanä¸ç­äºèªèº«ã\n\nlet set = new set();\nlet a = nan;\nlet b = nan;\nset.add(a);\nset.add(b);\nset // set {nan}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç å set å®ä¾æ·»å äºä¸¤æ¬¡nanï¼ä½æ¯åªä¼å å¥ä¸ä¸ªãè¿è¡¨æï¼å¨ set åé¨ï¼ä¸¤ä¸ªnanæ¯ç¸ç­çã\n\nå¦å¤ï¼ä¸¤ä¸ªå¯¹è±¡æ»æ¯ä¸ç¸ç­çã\n\nlet set = new set();\n\nset.add({});\nset.size // 1\n\nset.add({});\nset.size // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼ç±äºä¸¤ä¸ªç©ºå¯¹è±¡ä¸ç¸ç­ï¼æä»¥å®ä»¬è¢«è§ä¸ºä¸¤ä¸ªå¼ã\n\n\n# set å®ä¾çå±æ§åæ¹æ³\n\nset ç»æçå®ä¾æä»¥ä¸å±æ§ã\n\n * set.prototype.constructorï¼æé å½æ°ï¼é»è®¤å°±æ¯setå½æ°ã\n * set.prototype.sizeï¼è¿åsetå®ä¾çæåæ»æ°ã\n\nset å®ä¾çæ¹æ³åä¸ºä¸¤å¤§ç±»ï¼æä½æ¹æ³ï¼ç¨äºæä½æ°æ®ï¼åéåæ¹æ³ï¼ç¨äºéåæåï¼ãä¸é¢åä»ç»åä¸ªæä½æ¹æ³ã\n\n * set.prototype.add(value)ï¼æ·»å æä¸ªå¼ï¼è¿å set ç»ææ¬èº«ã\n * set.prototype.delete(value)ï¼å é¤æä¸ªå¼ï¼è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºå é¤æ¯å¦æåã\n * set.prototype.has(value)ï¼è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºè¯¥å¼æ¯å¦ä¸ºsetçæåã\n * set.prototype.clear()ï¼æ¸é¤æææåï¼æ²¡æè¿åå¼ã\n\nä¸é¢è¿äºå±æ§åæ¹æ³çå®ä¾å¦ä¸ã\n\ns.add(1).add(2).add(2);\n// æ³¨æ2è¢«å å¥äºä¸¤æ¬¡\n\ns.size // 2\n\ns.has(1) // true\ns.has(2) // true\ns.has(3) // false\n\ns.delete(2);\ns.has(2) // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢æ¯ä¸ä¸ªå¯¹æ¯ï¼ççå¨å¤æ­æ¯å¦åæ¬ä¸ä¸ªé®ä¸é¢ï¼objectç»æåsetç»æçåæ³ä¸åã\n\n// å¯¹è±¡çåæ³\nconst properties = {\n  'width': 1,\n  'height': 1\n};\n\nif (properties[somename]) {\n  // do something\n}\n\n// setçåæ³\nconst properties = new set();\n\nproperties.add('width');\nproperties.add('height');\n\nif (properties.has(somename)) {\n  // do something\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\narray.fromæ¹æ³å¯ä»¥å° set ç»æè½¬ä¸ºæ°ç»ã\n\nconst items = new set([1, 2, 3, 4, 5]);\nconst array = array.from(items);\n\n\n1\n2\n\n\nè¿å°±æä¾äºå»é¤æ°ç»éå¤æåçå¦ä¸ç§æ¹æ³ã\n\nfunction dedupe(array) {\n  return array.from(new set(array));\n}\n\ndedupe([1, 1, 2, 3]) // [1, 2, 3]\n\n\n1\n2\n3\n4\n5\n\n\n\n# éåæä½\n\nset ç»æçå®ä¾æåä¸ªéåæ¹æ³ï¼å¯ä»¥ç¨äºéåæåã\n\n * set.prototype.keys()ï¼è¿åé®åçéåå¨\n * set.prototype.values()ï¼è¿åé®å¼çéåå¨\n * set.prototype.entries()ï¼è¿åé®å¼å¯¹çéåå¨\n * set.prototype.foreach()ï¼ä½¿ç¨åè°å½æ°éåæ¯ä¸ªæå\n\néè¦ç¹å«æåºçæ¯ï¼setçéåé¡ºåºå°±æ¯æå¥é¡ºåºãè¿ä¸ªç¹æ§ææ¶éå¸¸æç¨ï¼æ¯å¦ä½¿ç¨ set ä¿å­ä¸ä¸ªåè°å½æ°åè¡¨ï¼è°ç¨æ¶å°±è½ä¿è¯æç§æ·»å é¡ºåºè°ç¨ã\n\nï¼1ï¼keys()ï¼values()ï¼entries()\n\nkeysæ¹æ³ãvaluesæ¹æ³ãentriesæ¹æ³è¿åçé½æ¯éåå¨å¯¹è±¡ï¼è¯¦è§ãiterator å¯¹è±¡ãä¸ç« ï¼ãç±äº set ç»ææ²¡æé®åï¼åªæé®å¼ï¼æèè¯´é®ååé®å¼æ¯åä¸ä¸ªå¼ï¼ï¼æä»¥keysæ¹æ³åvaluesæ¹æ³çè¡ä¸ºå®å¨ä¸è´ã\n\nlet set = new set(['red', 'green', 'blue']);\n\nfor (let item of set.keys()) {\n  console.log(item);\n}\n// red\n// green\n// blue\n\nfor (let item of set.values()) {\n  console.log(item);\n}\n// red\n// green\n// blue\n\nfor (let item of set.entries()) {\n  console.log(item);\n}\n// [\"red\", \"red\"]\n// [\"green\", \"green\"]\n// [\"blue\", \"blue\"]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\nä¸é¢ä»£ç ä¸­ï¼entriesæ¹æ³è¿åçéåå¨ï¼åæ¶åæ¬é®ååé®å¼ï¼æä»¥æ¯æ¬¡è¾åºä¸ä¸ªæ°ç»ï¼å®çä¸¤ä¸ªæåå®å¨ç¸ç­ã\n\nset ç»æçå®ä¾é»è®¤å¯éåï¼å®çé»è®¤éåå¨çæå½æ°å°±æ¯å®çvaluesæ¹æ³ã\n\nset.prototype[symbol.iterator] === set.prototype.values\n// true\n\n\n1\n2\n\n\nè¿æå³çï¼å¯ä»¥çç¥valuesæ¹æ³ï¼ç´æ¥ç¨for...ofå¾ªç¯éå setã\n\nlet set = new set(['red', 'green', 'blue']);\n\nfor (let x of set) {\n  console.log(x);\n}\n// red\n// green\n// blue\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nï¼2ï¼foreach()\n\nset ç»æçå®ä¾ä¸æ°ç»ä¸æ ·ï¼ä¹æ¥æforeachæ¹æ³ï¼ç¨äºå¯¹æ¯ä¸ªæåæ§è¡æç§æä½ï¼æ²¡æè¿åå¼ã\n\nlet set = new set([1, 4, 9]);\nset.foreach((value, key) => console.log(key + ' : ' + value))\n// 1 : 1\n// 4 : 4\n// 9 : 9\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç è¯´æï¼foreachæ¹æ³çåæ°å°±æ¯ä¸ä¸ªå¤çå½æ°ãè¯¥å½æ°çåæ°ä¸æ°ç»çforeachä¸è´ï¼ä¾æ¬¡ä¸ºé®å¼ãé®åãéåæ¬èº«ï¼ä¸ä¾çç¥äºè¯¥åæ°ï¼ãè¿ééè¦æ³¨æï¼set ç»æçé®åå°±æ¯é®å¼ï¼ä¸¤èæ¯åä¸ä¸ªå¼ï¼ï¼å æ­¤ç¬¬ä¸ä¸ªåæ°ä¸ç¬¬äºä¸ªåæ°çå¼æ°¸è¿é½æ¯ä¸æ ·çã\n\nå¦å¤ï¼foreachæ¹æ³è¿å¯ä»¥æç¬¬äºä¸ªåæ°ï¼è¡¨ç¤ºç»å®å¤çå½æ°åé¨çthiså¯¹è±¡ã\n\nï¼3ï¼éåçåºç¨\n\næ©å±è¿ç®ç¬¦ï¼...ï¼åé¨ä½¿ç¨for...ofå¾ªç¯ï¼æä»¥ä¹å¯ä»¥ç¨äº set ç»æã\n\nlet set = new set(['red', 'green', 'blue']);\nlet arr = [...set];\n// ['red', 'green', 'blue']\n\n\n1\n2\n3\n\n\næ©å±è¿ç®ç¬¦å set ç»æç¸ç»åï¼å°±å¯ä»¥å»é¤æ°ç»çéå¤æåã\n\nlet arr = [3, 5, 2, 2, 5, 5];\nlet unique = [...new set(arr)];\n// [3, 5, 2]\n\n\n1\n2\n3\n\n\nèä¸ï¼æ°ç»çmapåfilteræ¹æ³ä¹å¯ä»¥é´æ¥ç¨äº set äºã\n\nlet set = new set([1, 2, 3]);\nset = new set([...set].map(x => x * 2));\n// è¿åsetç»æï¼{2, 4, 6}\n\nlet set = new set([1, 2, 3, 4, 5]);\nset = new set([...set].filter(x => (x % 2) == 0));\n// è¿åsetç»æï¼{2, 4}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå æ­¤ä½¿ç¨ set å¯ä»¥å¾å®¹æå°å®ç°å¹¶éï¼unionï¼ãäº¤éï¼intersectï¼åå·®éï¼differenceï¼ã\n\nlet a = new set([1, 2, 3]);\nlet b = new set([4, 3, 2]);\n\n// å¹¶é\nlet union = new set([...a, ...b]);\n// set {1, 2, 3, 4}\n\n// äº¤é\nlet intersect = new set([...a].filter(x => b.has(x)));\n// set {2, 3}\n\n// å·®é\nlet difference = new set([...a].filter(x => !b.has(x)));\n// set {1}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nå¦ææ³å¨éåæä½ä¸­ï¼åæ­¥æ¹ååæ¥ç set ç»æï¼ç®åæ²¡æç´æ¥çæ¹æ³ï¼ä½æä¸¤ç§åéæ¹æ³ãä¸ç§æ¯å©ç¨å set ç»ææ å°åºä¸ä¸ªæ°çç»æï¼ç¶åèµå¼ç»åæ¥ç set ç»æï¼å¦ä¸ç§æ¯å©ç¨array.fromæ¹æ³ã\n\n// æ¹æ³ä¸\nlet set = new set([1, 2, 3]);\nset = new set([...set].map(val => val * 2));\n// setçå¼æ¯2, 4, 6\n\n// æ¹æ³äº\nlet set = new set([1, 2, 3]);\nset = new set(array.from(set, val => val * 2));\n// setçå¼æ¯2, 4, 6\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç æä¾äºä¸¤ç§æ¹æ³ï¼ç´æ¥å¨éåæä½ä¸­æ¹ååæ¥ç set ç»æã\n\n\n# weakset\n\n\n# å«ä¹\n\nweakset ç»æä¸ set ç±»ä¼¼ï¼ä¹æ¯ä¸éå¤çå¼çéåãä½æ¯ï¼å®ä¸ set æä¸¤ä¸ªåºå«ã\n\né¦åï¼weakset çæååªè½æ¯å¯¹è±¡ï¼èä¸è½æ¯å¶ä»ç±»åçå¼ã\n\nconst ws = new weakset();\nws.add(1)\n// typeerror: invalid value used in weak set\nws.add(symbol())\n// typeerror: invalid value used in weak set\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç è¯å¾å weakset æ·»å ä¸ä¸ªæ°å¼åsymbolå¼ï¼ç»ææ¥éï¼å ä¸º weakset åªè½æ¾ç½®å¯¹è±¡ã\n\nå¶æ¬¡ï¼weakset ä¸­çå¯¹è±¡é½æ¯å¼±å¼ç¨ï¼å³åå¾åæ¶æºå¶ä¸èè weakset å¯¹è¯¥å¯¹è±¡çå¼ç¨ï¼ä¹å°±æ¯è¯´ï¼å¦æå¶ä»å¯¹è±¡é½ä¸åå¼ç¨è¯¥å¯¹è±¡ï¼é£ä¹åå¾åæ¶æºå¶ä¼èªå¨åæ¶è¯¥å¯¹è±¡æå ç¨çåå­ï¼ä¸èèè¯¥å¯¹è±¡è¿å­å¨äº weakset ä¹ä¸­ã\n\nè¿æ¯å ä¸ºåå¾åæ¶æºå¶ä¾èµå¼ç¨è®¡æ°ï¼å¦æä¸ä¸ªå¼çå¼ç¨æ¬¡æ°ä¸ä¸º0ï¼åå¾åæ¶æºå¶å°±ä¸ä¼éæ¾è¿ååå­ãç»æä½¿ç¨è¯¥å¼ä¹åï¼ææ¶ä¼å¿è®°åæ¶å¼ç¨ï¼å¯¼è´åå­æ æ³éæ¾ï¼è¿èå¯è½ä¼å¼ååå­æ³æ¼ãweakset éé¢çå¼ç¨ï¼é½ä¸è®¡å¥åå¾åæ¶æºå¶ï¼æä»¥å°±ä¸å­å¨è¿ä¸ªé®é¢ãå æ­¤ï¼weakset éåä¸´æ¶å­æ¾ä¸ç»å¯¹è±¡ï¼ä»¥åå­æ¾è·å¯¹è±¡ç»å®çä¿¡æ¯ãåªè¦è¿äºå¯¹è±¡å¨å¤é¨æ¶å¤±ï¼å®å¨ weakset éé¢çå¼ç¨å°±ä¼èªå¨æ¶å¤±ã\n\nç±äºä¸é¢è¿ä¸ªç¹ç¹ï¼weakset çæåæ¯ä¸éåå¼ç¨çï¼å ä¸ºå®ä¼éæ¶æ¶å¤±ãå¦å¤ï¼ç±äº weakset åé¨æå¤å°ä¸ªæåï¼åå³äºåå¾åæ¶æºå¶ææ²¡æè¿è¡ï¼è¿è¡ååå¾å¯è½æåä¸ªæ°æ¯ä¸ä¸æ ·çï¼èåå¾åæ¶æºå¶ä½æ¶è¿è¡æ¯ä¸å¯é¢æµçï¼å æ­¤ es6 è§å® weakset ä¸å¯éåã\n\nè¿äºç¹ç¹åæ ·éç¨äºæ¬ç« åé¢è¦ä»ç»ç weakmap ç»æã\n\n\n# è¯­æ³\n\nweakset æ¯ä¸ä¸ªæé å½æ°ï¼å¯ä»¥ä½¿ç¨newå½ä»¤ï¼åå»º weakset æ°æ®ç»æã\n\nconst ws = new weakset();\n\n\n1\n\n\nä½ä¸ºæé å½æ°ï¼weakset å¯ä»¥æ¥åä¸ä¸ªæ°ç»æç±»ä¼¼æ°ç»çå¯¹è±¡ä½ä¸ºåæ°ãï¼å®éä¸ï¼ä»»ä½å·æ iterable æ¥å£çå¯¹è±¡ï¼é½å¯ä»¥ä½ä¸º weakset çåæ°ãï¼è¯¥æ°ç»çæææåï¼é½ä¼èªå¨æä¸º weakset å®ä¾å¯¹è±¡çæåã\n\nconst a = [[1, 2], [3, 4]];\nconst ws = new weakset(a);\n// weakset {[1, 2], [3, 4]}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼aæ¯ä¸ä¸ªæ°ç»ï¼å®æä¸¤ä¸ªæåï¼ä¹é½æ¯æ°ç»ãå°aä½ä¸º weakset æé å½æ°çåæ°ï¼açæåä¼èªå¨æä¸º weakset çæåã\n\næ³¨æï¼æ¯aæ°ç»çæåæä¸º weakset çæåï¼èä¸æ¯aæ°ç»æ¬èº«ãè¿æå³çï¼æ°ç»çæååªè½æ¯å¯¹è±¡ã\n\nconst b = [3, 4];\nconst ws = new weakset(b);\n// uncaught typeerror: invalid value used in weak set(â¦)\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»bçæåä¸æ¯å¯¹è±¡ï¼å å¥ weakset å°±ä¼æ¥éã\n\nweakset ç»ææä»¥ä¸ä¸ä¸ªæ¹æ³ã\n\n * weakset.prototype.add(value)ï¼å weakset å®ä¾æ·»å ä¸ä¸ªæ°æåã\n * weakset.prototype.delete(value)ï¼æ¸é¤ weakset å®ä¾çæå®æåã\n * weakset.prototype.has(value)ï¼è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºæä¸ªå¼æ¯å¦å¨ weakset å®ä¾ä¹ä¸­ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nconst ws = new weakset();\nconst obj = {};\nconst foo = {};\n\nws.add(window);\nws.add(obj);\n\nws.has(window); // true\nws.has(foo);    // false\n\nws.delete(window);\nws.has(window);    // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nweakset æ²¡æsizeå±æ§ï¼æ²¡æåæ³éåå®çæåã\n\nws.size // undefined\nws.foreach // undefined\n\nws.foreach(function(item){ console.log('weakset has ' + item)})\n// typeerror: undefined is not a function\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç è¯å¾è·åsizeåforeachå±æ§ï¼ç»æé½ä¸è½æåã\n\nweakset ä¸è½éåï¼æ¯å ä¸ºæåé½æ¯å¼±å¼ç¨ï¼éæ¶å¯è½æ¶å¤±ï¼éåæºå¶æ æ³ä¿è¯æåçå­å¨ï¼å¾å¯è½ååéåç»æï¼æåå°±åä¸å°äºãweakset çä¸ä¸ªç¨å¤ï¼æ¯å¨å­ dom èç¹ï¼èä¸ç¨æå¿è¿äºèç¹ä»ææ¡£ç§»é¤æ¶ï¼ä¼å¼ååå­æ³æ¼ã\n\nä¸é¢æ¯ weakset çå¦ä¸ä¸ªä¾å­ã\n\nconst foos = new weakset()\nclass foo {\n  constructor() {\n    foos.add(this)\n  }\n  method () {\n    if (!foos.has(this)) {\n      throw new typeerror('foo.prototype.method åªè½å¨fooçå®ä¾ä¸è°ç¨ï¼');\n    }\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¿è¯äºfooçå®ä¾æ¹æ³ï¼åªè½å¨fooçå®ä¾ä¸è°ç¨ãè¿éä½¿ç¨ weakset çå¥½å¤æ¯ï¼fooså¯¹å®ä¾çå¼ç¨ï¼ä¸ä¼è¢«è®¡å¥åå­åæ¶æºå¶ï¼æä»¥å é¤å®ä¾çæ¶åï¼ä¸ç¨èèfoosï¼ä¹ä¸ä¼åºç°åå­æ³æ¼ã\n\n\n# map\n\n\n# å«ä¹ååºæ¬ç¨æ³\n\njavascript çå¯¹è±¡ï¼objectï¼ï¼æ¬è´¨ä¸æ¯é®å¼å¯¹çéåï¼hash ç»æï¼ï¼ä½æ¯ä¼ ç»ä¸åªè½ç¨å­ç¬¦ä¸²å½ä½é®ãè¿ç»å®çä½¿ç¨å¸¦æ¥äºå¾å¤§çéå¶ã\n\nconst data = {};\nconst element = document.getelementbyid('mydiv');\n\ndata[element] = 'metadata';\ndata['[object htmldivelement]'] // \"metadata\"\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç åææ¯å°ä¸ä¸ª dom èç¹ä½ä¸ºå¯¹è±¡dataçé®ï¼ä½æ¯ç±äºå¯¹è±¡åªæ¥åå­ç¬¦ä¸²ä½ä¸ºé®åï¼æä»¥elementè¢«èªå¨è½¬ä¸ºå­ç¬¦ä¸²[object htmldivelement]ã\n\nä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼es6 æä¾äº map æ°æ®ç»æãå®ç±»ä¼¼äºå¯¹è±¡ï¼ä¹æ¯é®å¼å¯¹çéåï¼ä½æ¯âé®âçèå´ä¸éäºå­ç¬¦ä¸²ï¼åç§ç±»åçå¼ï¼åæ¬å¯¹è±¡ï¼é½å¯ä»¥å½ä½é®ãä¹å°±æ¯è¯´ï¼object ç»ææä¾äºâå­ç¬¦ä¸²âå¼âçå¯¹åºï¼map ç»ææä¾äºâå¼âå¼âçå¯¹åºï¼æ¯ä¸ç§æ´å®åç hash ç»æå®ç°ãå¦æä½ éè¦âé®å¼å¯¹âçæ°æ®ç»æï¼map æ¯ object æ´åéã\n\nconst m = new map();\nconst o = {p: 'hello world'};\n\nm.set(o, 'content')\nm.get(o) // \"content\"\n\nm.has(o) // true\nm.delete(o) // true\nm.has(o) // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä½¿ç¨ map ç»æçsetæ¹æ³ï¼å°å¯¹è±¡oå½ä½mçä¸ä¸ªé®ï¼ç¶ååä½¿ç¨getæ¹æ³è¯»åè¿ä¸ªé®ï¼æ¥çä½¿ç¨deleteæ¹æ³å é¤äºè¿ä¸ªé®ã\n\nä¸é¢çä¾å­å±ç¤ºäºå¦ä½å map æ·»å æåãä½ä¸ºæé å½æ°ï¼map ä¹å¯ä»¥æ¥åä¸ä¸ªæ°ç»ä½ä¸ºåæ°ãè¯¥æ°ç»çæåæ¯ä¸ä¸ªä¸ªè¡¨ç¤ºé®å¼å¯¹çæ°ç»ã\n\nconst map = new map([\n  ['name', 'å¼ ä¸'],\n  ['title', 'author']\n]);\n\nmap.size // 2\nmap.has('name') // true\nmap.get('name') // \"å¼ ä¸\"\nmap.has('title') // true\nmap.get('title') // \"author\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å¨æ°å»º map å®ä¾æ¶ï¼å°±æå®äºä¸¤ä¸ªé®nameåtitleã\n\nmapæé å½æ°æ¥åæ°ç»ä½ä¸ºåæ°ï¼å®éä¸æ§è¡çæ¯ä¸é¢çç®æ³ã\n\nconst items = [\n  ['name', 'å¼ ä¸'],\n  ['title', 'author']\n];\n\nconst map = new map();\n\nitems.foreach(\n  ([key, value]) => map.set(key, value)\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\näºå®ä¸ï¼ä¸ä»ä»æ¯æ°ç»ï¼ä»»ä½å·æ iterator æ¥å£ãä¸æ¯ä¸ªæåé½æ¯ä¸ä¸ªååç´ çæ°ç»çæ°æ®ç»æï¼è¯¦è§ãiteratorãä¸ç« ï¼é½å¯ä»¥å½ä½mapæé å½æ°çåæ°ãè¿å°±æ¯è¯´ï¼setåmapé½å¯ä»¥ç¨æ¥çææ°ç mapã\n\nconst set = new set([\n  ['foo', 1],\n  ['bar', 2]\n]);\nconst m1 = new map(set);\nm1.get('foo') // 1\n\nconst m2 = new map([['baz', 3]]);\nconst m3 = new map(m2);\nm3.get('baz') // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼æä»¬åå«ä½¿ç¨ set å¯¹è±¡å map å¯¹è±¡ï¼å½ä½mapæé å½æ°çåæ°ï¼ç»æé½çæäºæ°ç map å¯¹è±¡ã\n\nå¦æå¯¹åä¸ä¸ªé®å¤æ¬¡èµå¼ï¼åé¢çå¼å°è¦çåé¢çå¼ã\n\nconst map = new map();\n\nmap\n.set(1, 'aaa')\n.set(1, 'bbb');\n\nmap.get(1) // \"bbb\"\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç å¯¹é®1è¿ç»­èµå¼ä¸¤æ¬¡ï¼åä¸æ¬¡çå¼è¦çåä¸æ¬¡çå¼ã\n\nå¦æè¯»åä¸ä¸ªæªç¥çé®ï¼åè¿åundefinedã\n\nnew map().get('asfddfsasadf')\n// undefined\n\n\n1\n2\n\n\næ³¨æï¼åªæå¯¹åä¸ä¸ªå¯¹è±¡çå¼ç¨ï¼map ç»ææå°å¶è§ä¸ºåä¸ä¸ªé®ãè¿ä¸ç¹è¦éå¸¸å°å¿ã\n\nconst map = new map();\n\nmap.set(['a'], 555);\nmap.get(['a']) // undefined\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç çsetågetæ¹æ³ï¼è¡¨é¢æ¯éå¯¹åä¸ä¸ªé®ï¼ä½å®éä¸è¿æ¯ä¸¤ä¸ªä¸åçæ°ç»å®ä¾ï¼åå­å°åæ¯ä¸ä¸æ ·çï¼å æ­¤getæ¹æ³æ æ³è¯»åè¯¥é®ï¼è¿åundefinedã\n\nåçï¼åæ ·çå¼çä¸¤ä¸ªå®ä¾ï¼å¨ map ç»æä¸­è¢«è§ä¸ºä¸¤ä¸ªé®ã\n\nconst map = new map();\n\nconst k1 = ['a'];\nconst k2 = ['a'];\n\nmap\n.set(k1, 111)\n.set(k2, 222);\n\nmap.get(k1) // 111\nmap.get(k2) // 222\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼åék1åk2çå¼æ¯ä¸æ ·çï¼ä½æ¯å®ä»¬å¨ map ç»æä¸­è¢«è§ä¸ºä¸¤ä¸ªé®ã\n\nç±ä¸å¯ç¥ï¼map çé®å®éä¸æ¯è·åå­å°åç»å®çï¼åªè¦åå­å°åä¸ä¸æ ·ï¼å°±è§ä¸ºä¸¤ä¸ªé®ãè¿å°±è§£å³äºååå±æ§ç¢°æï¼clashï¼çé®é¢ï¼æä»¬æ©å±å«äººçåºçæ¶åï¼å¦æä½¿ç¨å¯¹è±¡ä½ä¸ºé®åï¼å°±ä¸ç¨æå¿èªå·±çå±æ§ä¸åä½èçå±æ§ååã\n\nå¦æ map çé®æ¯ä¸ä¸ªç®åç±»åçå¼ï¼æ°å­ãå­ç¬¦ä¸²ãå¸å°å¼ï¼ï¼ååªè¦ä¸¤ä¸ªå¼ä¸¥æ ¼ç¸ç­ï¼map å°å¶è§ä¸ºä¸ä¸ªé®ï¼æ¯å¦0å-0å°±æ¯ä¸ä¸ªé®ï¼å¸å°å¼trueåå­ç¬¦ä¸²trueåæ¯ä¸¤ä¸ªä¸åçé®ãå¦å¤ï¼undefinedånullä¹æ¯ä¸¤ä¸ªä¸åçé®ãè½ç¶nanä¸ä¸¥æ ¼ç¸ç­äºèªèº«ï¼ä½ map å°å¶è§ä¸ºåä¸ä¸ªé®ã\n\nlet map = new map();\n\nmap.set(-0, 123);\nmap.get(+0) // 123\n\nmap.set(true, 1);\nmap.set('true', 2);\nmap.get(true) // 1\n\nmap.set(undefined, 3);\nmap.set(null, 4);\nmap.get(undefined) // 3\n\nmap.set(nan, 123);\nmap.get(nan) // 123\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# å®ä¾çå±æ§åæä½æ¹æ³\n\nmap ç»æçå®ä¾æä»¥ä¸å±æ§åæä½æ¹æ³ã\n\nï¼1ï¼size å±æ§\n\nsizeå±æ§è¿å map ç»æçæåæ»æ°ã\n\nconst map = new map();\nmap.set('foo', true);\nmap.set('bar', false);\n\nmap.size // 2\n\n\n1\n2\n3\n4\n5\n\n\nï¼2ï¼map.prototype.set(key, value)\n\nsetæ¹æ³è®¾ç½®é®åkeyå¯¹åºçé®å¼ä¸ºvalueï¼ç¶åè¿åæ´ä¸ª map ç»æãå¦ækeyå·²ç»æå¼ï¼åé®å¼ä¼è¢«æ´æ°ï¼å¦åå°±æ°çæè¯¥é®ã\n\nconst m = new map();\n\nm.set('edition', 6)        // é®æ¯å­ç¬¦ä¸²\nm.set(262, 'standard')     // é®æ¯æ°å¼\nm.set(undefined, 'nah')    // é®æ¯ undefined\n\n\n1\n2\n3\n4\n5\n\n\nsetæ¹æ³è¿åçæ¯å½åçmapå¯¹è±¡ï¼å æ­¤å¯ä»¥éç¨é¾å¼åæ³ã\n\nlet map = new map()\n  .set(1, 'a')\n  .set(2, 'b')\n  .set(3, 'c');\n\n\n1\n2\n3\n4\n\n\nï¼3ï¼map.prototype.get(key)\n\ngetæ¹æ³è¯»åkeyå¯¹åºçé®å¼ï¼å¦ææ¾ä¸å°keyï¼è¿åundefinedã\n\nconst m = new map();\n\nconst hello = function() {console.log('hello');};\nm.set(hello, 'hello es6!') // é®æ¯å½æ°\n\nm.get(hello)  // hello es6!\n\n\n1\n2\n3\n4\n5\n6\n\n\nï¼4ï¼map.prototype.has(key)\n\nhasæ¹æ³è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºæä¸ªé®æ¯å¦å¨å½å map å¯¹è±¡ä¹ä¸­ã\n\nconst m = new map();\n\nm.set('edition', 6);\nm.set(262, 'standard');\nm.set(undefined, 'nah');\n\nm.has('edition')     // true\nm.has('years')       // false\nm.has(262)           // true\nm.has(undefined)     // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nï¼5ï¼map.prototype.delete(key)\n\ndeleteæ¹æ³å é¤æä¸ªé®ï¼è¿åtrueãå¦æå é¤å¤±è´¥ï¼è¿åfalseã\n\nconst m = new map();\nm.set(undefined, 'nah');\nm.has(undefined)     // true\n\nm.delete(undefined)\nm.has(undefined)       // false\n\n\n1\n2\n3\n4\n5\n6\n\n\nï¼6ï¼map.prototype.clear()\n\nclearæ¹æ³æ¸é¤æææåï¼æ²¡æè¿åå¼ã\n\nlet map = new map();\nmap.set('foo', true);\nmap.set('bar', false);\n\nmap.size // 2\nmap.clear()\nmap.size // 0\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# éåæ¹æ³\n\nmap ç»æåçæä¾ä¸ä¸ªéåå¨çæå½æ°åä¸ä¸ªéåæ¹æ³ã\n\n * map.prototype.keys()ï¼è¿åé®åçéåå¨ã\n * map.prototype.values()ï¼è¿åé®å¼çéåå¨ã\n * map.prototype.entries()ï¼è¿åæææåçéåå¨ã\n * map.prototype.foreach()ï¼éå map çæææåã\n\néè¦ç¹å«æ³¨æçæ¯ï¼map çéåé¡ºåºå°±æ¯æå¥é¡ºåºã\n\nconst map = new map([\n  ['f', 'no'],\n  ['t',  'yes'],\n]);\n\nfor (let key of map.keys()) {\n  console.log(key);\n}\n// \"f\"\n// \"t\"\n\nfor (let value of map.values()) {\n  console.log(value);\n}\n// \"no\"\n// \"yes\"\n\nfor (let item of map.entries()) {\n  console.log(item[0], item[1]);\n}\n// \"f\" \"no\"\n// \"t\" \"yes\"\n\n// æè\nfor (let [key, value] of map.entries()) {\n  console.log(key, value);\n}\n// \"f\" \"no\"\n// \"t\" \"yes\"\n\n// ç­åäºä½¿ç¨map.entries()\nfor (let [key, value] of map) {\n  console.log(key, value);\n}\n// \"f\" \"no\"\n// \"t\" \"yes\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n\n\nä¸é¢ä»£ç æåçé£ä¸ªä¾å­ï¼è¡¨ç¤º map ç»æçé»è®¤éåå¨æ¥å£ï¼symbol.iteratorå±æ§ï¼ï¼å°±æ¯entriesæ¹æ³ã\n\nmap[symbol.iterator] === map.entries\n// true\n\n\n1\n2\n\n\nmap ç»æè½¬ä¸ºæ°ç»ç»æï¼æ¯è¾å¿«éçæ¹æ³æ¯ä½¿ç¨æ©å±è¿ç®ç¬¦ï¼...ï¼ã\n\nconst map = new map([\n  [1, 'one'],\n  [2, 'two'],\n  [3, 'three'],\n]);\n\n[...map.keys()]\n// [1, 2, 3]\n\n[...map.values()]\n// ['one', 'two', 'three']\n\n[...map.entries()]\n// [[1,'one'], [2, 'two'], [3, 'three']]\n\n[...map]\n// [[1,'one'], [2, 'two'], [3, 'three']]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nç»åæ°ç»çmapæ¹æ³ãfilteræ¹æ³ï¼å¯ä»¥å®ç° map çéååè¿æ»¤ï¼map æ¬èº«æ²¡æmapåfilteræ¹æ³ï¼ã\n\nconst map0 = new map()\n  .set(1, 'a')\n  .set(2, 'b')\n  .set(3, 'c');\n\nconst map1 = new map(\n  [...map0].filter(([k, v]) => k < 3)\n);\n// äº§ç map ç»æ {1 => 'a', 2 => 'b'}\n\nconst map2 = new map(\n  [...map0].map(([k, v]) => [k * 2, '_' + v])\n    );\n// äº§ç map ç»æ {2 => '_a', 4 => '_b', 6 => '_c'}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\næ­¤å¤ï¼map è¿æä¸ä¸ªforeachæ¹æ³ï¼ä¸æ°ç»çforeachæ¹æ³ç±»ä¼¼ï¼ä¹å¯ä»¥å®ç°éåã\n\nmap.foreach(function(value, key, map) {\n  console.log(\"key: %s, value: %s\", key, value);\n});\n\n\n1\n2\n3\n\n\nforeachæ¹æ³è¿å¯ä»¥æ¥åç¬¬äºä¸ªåæ°ï¼ç¨æ¥ç»å®thisã\n\nconst reporter = {\n  report: function(key, value) {\n    console.log(\"key: %s, value: %s\", key, value);\n  }\n};\n\nmap.foreach(function(value, key, map) {\n  this.report(key, value);\n}, reporter);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼foreachæ¹æ³çåè°å½æ°çthisï¼å°±æåreporterã\n\n\n# ä¸å¶ä»æ°æ®ç»æçäºç¸è½¬æ¢\n\nï¼1ï¼map è½¬ä¸ºæ°ç»\n\nåé¢å·²ç»æè¿ï¼map è½¬ä¸ºæ°ç»ææ¹ä¾¿çæ¹æ³ï¼å°±æ¯ä½¿ç¨æ©å±è¿ç®ç¬¦ï¼...ï¼ã\n\nconst mymap = new map()\n  .set(true, 7)\n  .set({foo: 3}, ['abc']);\n[...mymap]\n// [ [ true, 7 ], [ { foo: 3 }, [ 'abc' ] ] ]\n\n\n1\n2\n3\n4\n5\n\n\nï¼2ï¼æ°ç» è½¬ä¸º map\n\nå°æ°ç»ä¼ å¥ map æé å½æ°ï¼å°±å¯ä»¥è½¬ä¸º mapã\n\nnew map([\n  [true, 7],\n  [{foo: 3}, ['abc']]\n])\n// map {\n//   true => 7,\n//   object {foo: 3} => ['abc']\n// }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nï¼3ï¼map è½¬ä¸ºå¯¹è±¡\n\nå¦æææ map çé®é½æ¯å­ç¬¦ä¸²ï¼å®å¯ä»¥æ æå°è½¬ä¸ºå¯¹è±¡ã\n\nfunction strmaptoobj(strmap) {\n  let obj = object.create(null);\n  for (let [k,v] of strmap) {\n    obj[k] = v;\n  }\n  return obj;\n}\n\nconst mymap = new map()\n  .set('yes', true)\n  .set('no', false);\nstrmaptoobj(mymap)\n// { yes: true, no: false }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nå¦ææéå­ç¬¦ä¸²çé®åï¼é£ä¹è¿ä¸ªé®åä¼è¢«è½¬æå­ç¬¦ä¸²ï¼åä½ä¸ºå¯¹è±¡çé®åã\n\nï¼4ï¼å¯¹è±¡è½¬ä¸º map\n\nfunction objtostrmap(obj) {\n  let strmap = new map();\n  for (let k of object.keys(obj)) {\n    strmap.set(k, obj[k]);\n  }\n  return strmap;\n}\n\nobjtostrmap({yes: true, no: false})\n// map {\"yes\" => true, \"no\" => false}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nï¼5ï¼map è½¬ä¸º json\n\nmap è½¬ä¸º json è¦åºåä¸¤ç§æåµãä¸ç§æåµæ¯ï¼map çé®åé½æ¯å­ç¬¦ä¸²ï¼è¿æ¶å¯ä»¥éæ©è½¬ä¸ºå¯¹è±¡ jsonã\n\nfunction strmaptojson(strmap) {\n  return json.stringify(strmaptoobj(strmap));\n}\n\nlet mymap = new map().set('yes', true).set('no', false);\nstrmaptojson(mymap)\n// '{\"yes\":true,\"no\":false}'\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦ä¸ç§æåµæ¯ï¼map çé®åæéå­ç¬¦ä¸²ï¼è¿æ¶å¯ä»¥éæ©è½¬ä¸ºæ°ç» jsonã\n\nfunction maptoarrayjson(map) {\n  return json.stringify([...map]);\n}\n\nlet mymap = new map().set(true, 7).set({foo: 3}, ['abc']);\nmaptoarrayjson(mymap)\n// '[[true,7],[{\"foo\":3},[\"abc\"]]]'\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nï¼6ï¼json è½¬ä¸º map\n\njson è½¬ä¸º mapï¼æ­£å¸¸æåµä¸ï¼ææé®åé½æ¯å­ç¬¦ä¸²ã\n\nfunction jsontostrmap(jsonstr) {\n  return objtostrmap(json.parse(jsonstr));\n}\n\njsontostrmap('{\"yes\": true, \"no\": false}')\n// map {'yes' => true, 'no' => false}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä½æ¯ï¼æä¸ç§ç¹æ®æåµï¼æ´ä¸ª json å°±æ¯ä¸ä¸ªæ°ç»ï¼ä¸æ¯ä¸ªæ°ç»æåæ¬èº«ï¼åæ¯ä¸ä¸ªæä¸¤ä¸ªæåçæ°ç»ãè¿æ¶ï¼å®å¯ä»¥ä¸ä¸å¯¹åºå°è½¬ä¸º mapãè¿å¾å¾æ¯ map è½¬ä¸ºæ°ç» json çéæä½ã\n\nfunction jsontomap(jsonstr) {\n  return new map(json.parse(jsonstr));\n}\n\njsontomap('[[true,7],[{\"foo\":3},[\"abc\"]]]')\n// map {true => 7, object {foo: 3} => ['abc']}\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# weakmap\n\n\n# å«ä¹\n\nweakmapç»æä¸mapç»æç±»ä¼¼ï¼ä¹æ¯ç¨äºçæé®å¼å¯¹çéåã\n\n// weakmap å¯ä»¥ä½¿ç¨ set æ¹æ³æ·»å æå\nconst wm1 = new weakmap();\nconst key = {foo: 1};\nwm1.set(key, 2);\nwm1.get(key) // 2\n\n// weakmap ä¹å¯ä»¥æ¥åä¸ä¸ªæ°ç»ï¼\n// ä½ä¸ºæé å½æ°çåæ°\nconst k1 = [1, 2, 3];\nconst k2 = [4, 5, 6];\nconst wm2 = new weakmap([[k1, 'foo'], [k2, 'bar']]);\nwm2.get(k2) // \"bar\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nweakmapä¸mapçåºå«æä¸¤ç¹ã\n\né¦åï¼weakmapåªæ¥åå¯¹è±¡ä½ä¸ºé®åï¼nullé¤å¤ï¼ï¼ä¸æ¥åå¶ä»ç±»åçå¼ä½ä¸ºé®åã\n\nconst map = new weakmap();\nmap.set(1, 2)\n// typeerror: 1 is not an object!\nmap.set(symbol(), 2)\n// typeerror: invalid value used as weak map key\nmap.set(null, 2)\n// typeerror: invalid value used as weak map key\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æå°æ°å¼1åsymbolå¼ä½ä¸º weakmap çé®åï¼é½ä¼æ¥éã\n\nå¶æ¬¡ï¼weakmapçé®åææåçå¯¹è±¡ï¼ä¸è®¡å¥åå¾åæ¶æºå¶ã\n\nweakmapçè®¾è®¡ç®çå¨äºï¼ææ¶æä»¬æ³å¨æä¸ªå¯¹è±¡ä¸é¢å­æ¾ä¸äºæ°æ®ï¼ä½æ¯è¿ä¼å½¢æå¯¹äºè¿ä¸ªå¯¹è±¡çå¼ç¨ãè¯·çä¸é¢çä¾å­ã\n\nconst e1 = document.getelementbyid('foo');\nconst e2 = document.getelementbyid('bar');\nconst arr = [\n  [e1, 'foo åç´ '],\n  [e2, 'bar åç´ '],\n];\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼e1åe2æ¯ä¸¤ä¸ªå¯¹è±¡ï¼æä»¬éè¿arræ°ç»å¯¹è¿ä¸¤ä¸ªå¯¹è±¡æ·»å ä¸äºæå­è¯´æãè¿å°±å½¢æäºarrå¯¹e1åe2çå¼ç¨ã\n\nä¸æ¦ä¸åéè¦è¿ä¸¤ä¸ªå¯¹è±¡ï¼æä»¬å°±å¿é¡»æå¨å é¤è¿ä¸ªå¼ç¨ï¼å¦ååå¾åæ¶æºå¶å°±ä¸ä¼éæ¾e1åe2å ç¨çåå­ã\n\n// ä¸éè¦ e1 å e2 çæ¶å\n// å¿é¡»æå¨å é¤å¼ç¨\narr [0] = null;\narr [1] = null;\n\n\n1\n2\n3\n4\n\n\nä¸é¢è¿æ ·çåæ³æ¾ç¶å¾ä¸æ¹ä¾¿ãä¸æ¦å¿äºåï¼å°±ä¼é æåå­æ³é²ã\n\nweakmap å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢èè¯ççï¼å®çé®åæå¼ç¨çå¯¹è±¡é½æ¯å¼±å¼ç¨ï¼å³åå¾åæ¶æºå¶ä¸å°è¯¥å¼ç¨èèå¨åãå æ­¤ï¼åªè¦æå¼ç¨çå¯¹è±¡çå¶ä»å¼ç¨é½è¢«æ¸é¤ï¼åå¾åæ¶æºå¶å°±ä¼éæ¾è¯¥å¯¹è±¡æå ç¨çåå­ãä¹å°±æ¯è¯´ï¼ä¸æ¦ä¸åéè¦ï¼weakmap éé¢çé®åå¯¹è±¡åæå¯¹åºçé®å¼å¯¹ä¼èªå¨æ¶å¤±ï¼ä¸ç¨æå¨å é¤å¼ç¨ã\n\nåºæ¬ä¸ï¼å¦æä½ è¦å¾å¯¹è±¡ä¸æ·»å æ°æ®ï¼åä¸æ³å¹²æ°åå¾åæ¶æºå¶ï¼å°±å¯ä»¥ä½¿ç¨ weakmapãä¸ä¸ªå¸ååºç¨åºæ¯æ¯ï¼å¨ç½é¡µç dom åç´ ä¸æ·»å æ°æ®ï¼å°±å¯ä»¥ä½¿ç¨weakmapç»æãå½è¯¥ dom åç´ è¢«æ¸é¤ï¼å¶æå¯¹åºçweakmapè®°å½å°±ä¼èªå¨è¢«ç§»é¤ã\n\nconst wm = new weakmap();\n\nconst element = document.getelementbyid('example');\n\nwm.set(element, 'some information');\nwm.get(element) // \"some information\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°å»ºä¸ä¸ª weakmap å®ä¾ãç¶åï¼å°ä¸ä¸ª dom èç¹ä½ä¸ºé®åå­å¥è¯¥å®ä¾ï¼å¹¶å°ä¸äºéå ä¿¡æ¯ä½ä¸ºé®å¼ï¼ä¸èµ·å­æ¾å¨ weakmap éé¢ãè¿æ¶ï¼weakmap éé¢å¯¹elementçå¼ç¨å°±æ¯å¼±å¼ç¨ï¼ä¸ä¼è¢«è®¡å¥åå¾åæ¶æºå¶ã\n\nä¹å°±æ¯è¯´ï¼ä¸é¢ç dom èç¹å¯¹è±¡çå¼ç¨è®¡æ°æ¯1ï¼èä¸æ¯2ãè¿æ¶ï¼ä¸æ¦æ¶é¤å¯¹è¯¥èç¹çå¼ç¨ï¼å®å ç¨çåå­å°±ä¼è¢«åå¾åæ¶æºå¶éæ¾ãweakmap ä¿å­çè¿ä¸ªé®å¼å¯¹ï¼ä¹ä¼èªå¨æ¶å¤±ã\n\næ»ä¹ï¼weakmapçä¸ç¨åºåå°±æ¯ï¼å®çé®æå¯¹åºçå¯¹è±¡ï¼å¯è½ä¼å¨å°æ¥æ¶å¤±ãweakmapç»ææå©äºé²æ­¢åå­æ³æ¼ã\n\næ³¨æï¼weakmap å¼±å¼ç¨çåªæ¯é®åï¼èä¸æ¯é®å¼ãé®å¼ä¾ç¶æ¯æ­£å¸¸å¼ç¨ã\n\nconst wm = new weakmap();\nlet key = {};\nlet obj = {foo: 1};\n\nwm.set(key, obj);\nobj = null;\nwm.get(key)\n// object {foo: 1}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼é®å¼objæ¯æ­£å¸¸å¼ç¨ãæä»¥ï¼å³ä½¿å¨ weakmap å¤é¨æ¶é¤äºobjçå¼ç¨ï¼weakmap åé¨çå¼ç¨ä¾ç¶å­å¨ã\n\n\n# weakmap çè¯­æ³\n\nweakmap ä¸ map å¨ api ä¸çåºå«ä¸»è¦æ¯ä¸¤ä¸ªï¼ä¸æ¯æ²¡æéåæä½ï¼å³æ²¡ækeys()ãvalues()åentries()æ¹æ³ï¼ï¼ä¹æ²¡æsizeå±æ§ãå ä¸ºæ²¡æåæ³ååºææé®åï¼æä¸ªé®åæ¯å¦å­å¨å®å¨ä¸å¯é¢æµï¼è·åå¾åæ¶æºå¶æ¯å¦è¿è¡ç¸å³ãè¿ä¸å»å¯ä»¥åå°é®åï¼ä¸ä¸å»åå¾åæ¶æºå¶çªç¶è¿è¡äºï¼è¿ä¸ªé®åå°±æ²¡äºï¼ä¸ºäºé²æ­¢åºç°ä¸ç¡®å®æ§ï¼å°±ç»ä¸è§å®ä¸è½åå°é®åãäºæ¯æ æ³æ¸ç©ºï¼å³ä¸æ¯æclearæ¹æ³ãå æ­¤ï¼weakmapåªæåä¸ªæ¹æ³å¯ç¨ï¼get()ãset()ãhas()ãdelete()ã\n\nconst wm = new weakmap();\n\n// sizeãforeachãclear æ¹æ³é½ä¸å­å¨\nwm.size // undefined\nwm.foreach // undefined\nwm.clear // undefined\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# weakmap çç¤ºä¾\n\nweakmap çä¾å­å¾é¾æ¼ç¤ºï¼å ä¸ºæ æ³è§å¯å®éé¢çå¼ç¨ä¼èªå¨æ¶å¤±ãæ­¤æ¶ï¼å¶ä»å¼ç¨é½è§£é¤äºï¼å·²ç»æ²¡æå¼ç¨æå weakmap çé®åäºï¼å¯¼è´æ æ³è¯å®é£ä¸ªé®åæ¯ä¸æ¯å­å¨ã\n\nè´ºå¸ä¿èå¸æç¤ºï¼å¦æå¼ç¨ææåçå¼å ç¨ç¹å«å¤çåå­ï¼å°±å¯ä»¥éè¿ node çprocess.memoryusageæ¹æ³çåºæ¥ãæ ¹æ®è¿ä¸ªæè·¯ï¼ç½åvtxfè¡¥åäºä¸é¢çä¾å­ã\n\né¦åï¼æå¼ node å½ä»¤è¡ã\n\n$ node --expose-gc\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼--expose-gcåæ°è¡¨ç¤ºåè®¸æå¨æ§è¡åå¾åæ¶æºå¶ã\n\nç¶åï¼æ§è¡ä¸é¢çä»£ç ã\n\n// æå¨æ§è¡ä¸æ¬¡åå¾åæ¶ï¼ä¿è¯è·åçåå­ä½¿ç¨ç¶æåç¡®\n> global.gc();\nundefined\n\n// æ¥çåå­å ç¨çåå§ç¶æï¼heapused ä¸º 4m å·¦å³\n> process.memoryusage();\n{ rss: 21106688,\n  heaptotal: 7376896,\n  heapused: 4153936,\n  external: 9059 }\n\n> let wm = new weakmap();\nundefined\n\n// æ°å»ºä¸ä¸ªåé keyï¼æåä¸ä¸ª 5*1024*1024 çæ°ç»\n> let key = new array(5 * 1024 * 1024);\nundefined\n\n// è®¾ç½® weakmap å®ä¾çé®åï¼ä¹æå key æ°ç»\n// è¿æ¶ï¼key æ°ç»å®éè¢«å¼ç¨äºä¸¤æ¬¡ï¼\n// åé key å¼ç¨ä¸æ¬¡ï¼weakmap çé®åå¼ç¨äºç¬¬äºæ¬¡\n// ä½æ¯ï¼weakmap æ¯å¼±å¼ç¨ï¼å¯¹äºå¼ææ¥è¯´ï¼å¼ç¨è®¡æ°è¿æ¯1\n> wm.set(key, 1);\nweakmap {}\n\n> global.gc();\nundefined\n\n// è¿æ¶åå­å ç¨ heapused å¢å å° 45m äº\n> process.memoryusage();\n{ rss: 67538944,\n  heaptotal: 7376896,\n  heapused: 45782816,\n  external: 8945 }\n\n// æ¸é¤åé key å¯¹æ°ç»çå¼ç¨ï¼\n// ä½æ²¡ææå¨æ¸é¤ weakmap å®ä¾çé®åå¯¹æ°ç»çå¼ç¨\n> key = null;\nnull\n\n// åæ¬¡æ§è¡åå¾åæ¶\n> global.gc();\nundefined\n\n// åå­å ç¨ heapused åå 4m å·¦å³ï¼\n// å¯ä»¥çå° weakmap çé®åå¼ç¨æ²¡æé»æ­¢ gc å¯¹åå­çåæ¶\n> process.memoryusage();\n{ rss: 20639744,\n  heaptotal: 8425472,\n  heapused: 3979792,\n  external: 8956 }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n\n\nä¸é¢ä»£ç ä¸­ï¼åªè¦å¤é¨çå¼ç¨æ¶å¤±ï¼weakmap åé¨çå¼ç¨ï¼å°±ä¼èªå¨è¢«åå¾åæ¶æ¸é¤ãç±æ­¤å¯è§ï¼æäº weakmap çå¸®å©ï¼è§£å³åå­æ³æ¼å°±ä¼ç®åå¾å¤ã\n\n\n# weakmap çç¨é\n\nåæè¯´è¿ï¼weakmap åºç¨çå¸ååºåå°±æ¯ dom èç¹ä½ä¸ºé®åãä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nlet myelement = document.getelementbyid('logo');\nlet myweakmap = new weakmap();\n\nmyweakmap.set(myelement, {timesclicked: 0});\n\nmyelement.addeventlistener('click', function() {\n  let logodata = myweakmap.get(myelement);\n  logodata.timesclicked++;\n}, false);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼myelementæ¯ä¸ä¸ª dom èç¹ï¼æ¯å½åçclickäºä»¶ï¼å°±æ´æ°ä¸ä¸ç¶æãæä»¬å°è¿ä¸ªç¶æä½ä¸ºé®å¼æ¾å¨ weakmap éï¼å¯¹åºçé®åå°±æ¯myelementãä¸æ¦è¿ä¸ª dom èç¹å é¤ï¼è¯¥ç¶æå°±ä¼èªå¨æ¶å¤±ï¼ä¸å­å¨åå­æ³æ¼é£é©ã\n\nweakmap çå¦ä¸ä¸ªç¨å¤æ¯é¨ç½²ç§æå±æ§ã\n\nconst _counter = new weakmap();\nconst _action = new weakmap();\n\nclass countdown {\n  constructor(counter, action) {\n    _counter.set(this, counter);\n    _action.set(this, action);\n  }\n  dec() {\n    let counter = _counter.get(this);\n    if (counter < 1) return;\n    counter--;\n    _counter.set(this, counter);\n    if (counter === 0) {\n      _action.get(this)();\n    }\n  }\n}\n\nconst c = new countdown(2, () => console.log('done'));\n\nc.dec()\nc.dec()\n// done\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nä¸é¢ä»£ç ä¸­ï¼countdownç±»çä¸¤ä¸ªåé¨å±æ§_counterå_actionï¼æ¯å®ä¾çå¼±å¼ç¨ï¼æä»¥å¦æå é¤å®ä¾ï¼å®ä»¬ä¹å°±éä¹æ¶å¤±ï¼ä¸ä¼é æåå­æ³æ¼ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Proxy",frontmatter:{title:"Proxy",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/f56ec2ab97d60483",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/14.Proxy.html",relativePath:"ãES6 æç¨ãç¬è®°/14.Proxy.md",key:"v-7055771a",path:"/pages/f56ec2ab97d60483/",headers:[{level:2,title:"æ¦è¿°",slug:"æ¦è¿°",normalizedTitle:"æ¦è¿°",charIndex:12},{level:2,title:"Proxy å®ä¾çæ¹æ³",slug:"proxy-å®ä¾çæ¹æ³",normalizedTitle:"proxy å®ä¾çæ¹æ³",charIndex:3952},{level:3,title:"get()",slug:"get",normalizedTitle:"get()",charIndex:3987},{level:3,title:"set()",slug:"set",normalizedTitle:"set()",charIndex:7820},{level:3,title:"apply()",slug:"apply",normalizedTitle:"apply()",charIndex:10813},{level:3,title:"has()",slug:"has",normalizedTitle:"has()",charIndex:11742},{level:3,title:"construct()",slug:"construct",normalizedTitle:"construct()",charIndex:13347},{level:3,title:"deleteProperty()",slug:"deleteproperty",normalizedTitle:"deleteproperty()",charIndex:14078},{level:3,title:"defineProperty()",slug:"defineproperty",normalizedTitle:"defineproperty()",charIndex:14754},{level:3,title:"getOwnPropertyDescriptor()",slug:"getownpropertydescriptor",normalizedTitle:"getownpropertydescriptor()",charIndex:15196},{level:3,title:"getPrototypeOf()",slug:"getprototypeof",normalizedTitle:"getprototypeof()",charIndex:15916},{level:3,title:"isExtensible()",slug:"isextensible",normalizedTitle:"isextensible()",charIndex:16445},{level:3,title:"ownKeys()",slug:"ownkeys",normalizedTitle:"ownkeys()",charIndex:17155},{level:3,title:"preventExtensions()",slug:"preventextensions",normalizedTitle:"preventextensions()",charIndex:20334},{level:3,title:"setPrototypeOf()",slug:"setprototypeof",normalizedTitle:"setprototypeof()",charIndex:21184},{level:2,title:"Proxy.revocable()",slug:"proxy-revocable",normalizedTitle:"proxy.revocable()",charIndex:21689},{level:2,title:"this é®é¢",slug:"this-é®é¢",normalizedTitle:"this é®é¢",charIndex:22124},{level:2,title:"å®ä¾ï¼Web æå¡çå®¢æ·ç«¯",slug:"å®ä¾-web-æå¡çå®¢æ·ç«¯",normalizedTitle:"å®ä¾ï¼web æå¡çå®¢æ·ç«¯",charIndex:23563}],excerpt:'<h1 id="proxy"><a class="header-anchor" href="#proxy">#</a> Proxy</h1>\n<h2 id="æ¦è¿°"><a class="header-anchor" href="#æ¦è¿°">#</a> æ¦è¿°</h2>\n<p>Proxy ç¨äºä¿®æ¹æäºæä½çé»è®¤è¡ä¸ºï¼ç­åäºå¨è¯­è¨å±é¢ååºä¿®æ¹ï¼æä»¥å±äºä¸ç§â<strong>åç¼ç¨</strong>âï¼meta programmingï¼ï¼å³<strong>å¯¹ç¼ç¨è¯­è¨è¿è¡ç¼ç¨</strong>ã</p>\n<p>Proxy å¯ä»¥çè§£æï¼å¨ç®æ å¯¹è±¡ä¹åæ¶è®¾ä¸å±âæ¦æªâï¼<strong>å¤çå¯¹è¯¥å¯¹è±¡çè®¿é®ï¼é½å¿é¡»åéè¿è¿å±æ¦æª</strong>ï¼å æ­¤æä¾äºä¸ç§æºå¶ï¼å¯ä»¥å¯¹å¤ççè®¿é®è¿è¡è¿æ»¤åæ¹åãProxy è¿ä¸ªè¯çåææ¯ä»£çï¼ç¨å¨è¿éè¡¨ç¤ºç±å®æ¥âä»£çâæäºæä½ï¼å¯ä»¥è¯ä¸ºâä»£çå¨âã</p>\n',headersStr:"æ¦è¿° Proxy å®ä¾çæ¹æ³ get() set() apply() has() construct() deleteProperty() defineProperty() getOwnPropertyDescriptor() getPrototypeOf() isExtensible() ownKeys() preventExtensions() setPrototypeOf() Proxy.revocable() this é®é¢ å®ä¾ï¼Web æå¡çå®¢æ·ç«¯",content:"# Proxy\n\n\n# æ¦è¿°\n\nProxy ç¨äºä¿®æ¹æäºæä½çé»è®¤è¡ä¸ºï¼ç­åäºå¨è¯­è¨å±é¢ååºä¿®æ¹ï¼æä»¥å±äºä¸ç§âåç¼ç¨âï¼meta programmingï¼ï¼å³å¯¹ç¼ç¨è¯­è¨è¿è¡ç¼ç¨ã\n\nProxy å¯ä»¥çè§£æï¼å¨ç®æ å¯¹è±¡ä¹åæ¶è®¾ä¸å±âæ¦æªâï¼å¤çå¯¹è¯¥å¯¹è±¡çè®¿é®ï¼é½å¿é¡»åéè¿è¿å±æ¦æªï¼å æ­¤æä¾äºä¸ç§æºå¶ï¼å¯ä»¥å¯¹å¤ççè®¿é®è¿è¡è¿æ»¤åæ¹åãProxy è¿ä¸ªè¯çåææ¯ä»£çï¼ç¨å¨è¿éè¡¨ç¤ºç±å®æ¥âä»£çâæäºæä½ï¼å¯ä»¥è¯ä¸ºâä»£çå¨âã\n\nvar obj = new Proxy({}, {\n  get: function (target, propKey, receiver) {\n    console.log(`getting ${propKey}!`);\n    return Reflect.get(target, propKey, receiver);\n  },\n  set: function (target, propKey, value, receiver) {\n    console.log(`setting ${propKey}!`);\n    return Reflect.set(target, propKey, value, receiver);\n  }\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å¯¹ä¸ä¸ªç©ºå¯¹è±¡æ¶è®¾äºä¸å±æ¦æªï¼éå®ä¹äºå±æ§çè¯»åï¼getï¼åè®¾ç½®ï¼setï¼è¡ä¸ºãè¿éææ¶åä¸è§£éå·ä½çè¯­æ³ï¼åªçè¿è¡ç»æãå¯¹è®¾ç½®äºæ¦æªè¡ä¸ºçå¯¹è±¡objï¼å»è¯»åå®çå±æ§ï¼å°±ä¼å¾å°ä¸é¢çç»æã\n\nobj.count = 1\n//  setting count!\n++obj.count\n//  getting count!\n//  setting count!\n//  2\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç è¯´æï¼Proxy å®éä¸éè½½ï¼overloadï¼äºç¹è¿ç®ç¬¦ï¼å³ç¨èªå·±çå®ä¹è¦çäºè¯­è¨çåå§å®ä¹ã\n\nES6 åçæä¾ Proxy æé å½æ°ï¼ç¨æ¥çæ Proxy å®ä¾ã\n\nvar proxy = new Proxy(target, handler);\n\n\n1\n\n\nProxy å¯¹è±¡çææç¨æ³ï¼é½æ¯ä¸é¢è¿ç§å½¢å¼ï¼ä¸åçåªæ¯handleråæ°çåæ³ãå¶ä¸­ï¼new Proxy()è¡¨ç¤ºçæä¸ä¸ªProxyå®ä¾ï¼targetåæ°è¡¨ç¤ºæè¦æ¦æªçç®æ å¯¹è±¡ï¼handleråæ°ä¹æ¯ä¸ä¸ªå¯¹è±¡ï¼ç¨æ¥å®å¶æ¦æªè¡ä¸ºã\n\nä¸é¢æ¯å¦ä¸ä¸ªæ¦æªè¯»åå±æ§è¡ä¸ºçä¾å­ã\n\nvar proxy = new Proxy({}, {\n  get: function(target, propKey) {\n    return 35;\n  }\n});\n\nproxy.time // 35\nproxy.name // 35\nproxy.title // 35\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼ä½ä¸ºæé å½æ°ï¼Proxyæ¥åä¸¤ä¸ªåæ°ãç¬¬ä¸ä¸ªåæ°æ¯æè¦ä»£ççç®æ å¯¹è±¡ï¼ä¸ä¾æ¯ä¸ä¸ªç©ºå¯¹è±¡ï¼ï¼å³å¦ææ²¡æProxyçä»å¥ï¼æä½åæ¥è¦è®¿é®çå°±æ¯è¿ä¸ªå¯¹è±¡ï¼ç¬¬äºä¸ªåæ°æ¯ä¸ä¸ªéç½®å¯¹è±¡ï¼å¯¹äºæ¯ä¸ä¸ªè¢«ä»£ççæä½ï¼éè¦æä¾ä¸ä¸ªå¯¹åºçå¤çå½æ°ï¼è¯¥å½æ°å°æ¦æªå¯¹åºçæä½ãæ¯å¦ï¼ä¸é¢ä»£ç ä¸­ï¼éç½®å¯¹è±¡æä¸ä¸ªgetæ¹æ³ï¼ç¨æ¥æ¦æªå¯¹ç®æ å¯¹è±¡å±æ§çè®¿é®è¯·æ±ãgetæ¹æ³çä¸¤ä¸ªåæ°åå«æ¯ç®æ å¯¹è±¡åæè¦è®¿é®çå±æ§ãå¯ä»¥çå°ï¼ç±äºæ¦æªå½æ°æ»æ¯è¿å35ï¼æä»¥è®¿é®ä»»ä½å±æ§é½å¾å°35ã\n\næ³¨æï¼è¦ä½¿å¾Proxyèµ·ä½ç¨ï¼å¿é¡»éå¯¹Proxyå®ä¾ï¼ä¸ä¾æ¯proxyå¯¹è±¡ï¼è¿è¡æä½ï¼èä¸æ¯éå¯¹ç®æ å¯¹è±¡ï¼ä¸ä¾æ¯ç©ºå¯¹è±¡ï¼è¿è¡æä½ã\n\nå¦æhandleræ²¡æè®¾ç½®ä»»ä½æ¦æªï¼é£å°±ç­åäºç´æ¥éååå¯¹è±¡ã\n\nvar target = {};\nvar handler = {};\nvar proxy = new Proxy(target, handler);\nproxy.a = 'b';\ntarget.a // \"b\"\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼handleræ¯ä¸ä¸ªç©ºå¯¹è±¡ï¼æ²¡æä»»ä½æ¦æªææï¼è®¿é®proxyå°±ç­åäºè®¿é®targetã\n\nä¸ä¸ªæå·§æ¯å° Proxy å¯¹è±¡ï¼è®¾ç½®å°object.proxyå±æ§ï¼ä»èå¯ä»¥å¨objectå¯¹è±¡ä¸è°ç¨ã\n\nvar object = { proxy: new Proxy(target, handler) };\n\n\n1\n\n\nProxy å®ä¾ä¹å¯ä»¥ä½ä¸ºå¶ä»å¯¹è±¡çååå¯¹è±¡ã\n\nvar proxy = new Proxy({}, {\n  get: function(target, propKey) {\n    return 35;\n  }\n});\n\nlet obj = Object.create(proxy);\nobj.time // 35\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼proxyå¯¹è±¡æ¯objå¯¹è±¡çååï¼objå¯¹è±¡æ¬èº«å¹¶æ²¡ætimeå±æ§ï¼æä»¥æ ¹æ®ååé¾ï¼ä¼å¨proxyå¯¹è±¡ä¸è¯»åè¯¥å±æ§ï¼å¯¼è´è¢«æ¦æªã\n\nåä¸ä¸ªæ¦æªå¨å½æ°ï¼å¯ä»¥è®¾ç½®æ¦æªå¤ä¸ªæä½ã\n\nvar handler = {\n  get: function(target, name) {\n    if (name === 'prototype') {\n      return Object.prototype;\n    }\n    return 'Hello, ' + name;\n  },\n\n  apply: function(target, thisBinding, args) {\n    return args[0];\n  },\n\n  construct: function(target, args) {\n    return {value: args[1]};\n  }\n};\n\nvar fproxy = new Proxy(function(x, y) {\n  return x + y;\n}, handler);\n\nfproxy(1, 2) // 1\nnew fproxy(1, 2) // {value: 2}\nfproxy.prototype === Object.prototype // true\nfproxy.foo === \"Hello, foo\" // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nå¯¹äºå¯ä»¥è®¾ç½®ãä½æ²¡æè®¾ç½®æ¦æªçæä½ï¼åç´æ¥è½å¨ç®æ å¯¹è±¡ä¸ï¼æç§ååçæ¹å¼äº§çç»æã\n\nä¸é¢æ¯ Proxy æ¯æçæ¦æªæä½ä¸è§ï¼ä¸å± 13 ç§ã\n\n * get(target, propKey, receiver)ï¼æ¦æªå¯¹è±¡å±æ§çè¯»åï¼æ¯å¦proxy.fooåproxy['foo']ã\n * set(target, propKey, value, receiver)ï¼æ¦æªå¯¹è±¡å±æ§çè®¾ç½®ï¼æ¯å¦proxy.foo = væproxy['foo'] = vï¼è¿åä¸ä¸ªå¸å°å¼ã\n * has(target, propKey)ï¼æ¦æªpropKey in proxyçæä½ï¼è¿åä¸ä¸ªå¸å°å¼ã\n * deleteProperty(target, propKey)ï¼æ¦æªdelete proxy[propKey]çæä½ï¼è¿åä¸ä¸ªå¸å°å¼ã\n * ownKeys(target)ï¼æ¦æªObject.getOwnPropertyNames(proxy)ãObject.getOwnPropertySymbols(proxy)ãObject.keys(proxy)ãfor...inå¾ªç¯ï¼è¿åä¸ä¸ªæ°ç»ãè¯¥æ¹æ³è¿åç®æ å¯¹è±¡ææèªèº«çå±æ§çå±æ§åï¼èObject.keys()çè¿åç»æä»åæ¬ç®æ å¯¹è±¡èªèº«çå¯éåå±æ§ã\n * getOwnPropertyDescriptor(target, propKey)ï¼æ¦æªObject.getOwnPropertyDescriptor(proxy, propKey)ï¼è¿åå±æ§çæè¿°å¯¹è±¡ã\n * defineProperty(target, propKey, propDesc)ï¼æ¦æªObject.defineProperty(proxy, propKey, propDescï¼ãObject.defineProperties(proxy, propDescs)ï¼è¿åä¸ä¸ªå¸å°å¼ã\n * preventExtensions(target)ï¼æ¦æªObject.preventExtensions(proxy)ï¼è¿åä¸ä¸ªå¸å°å¼ã\n * getPrototypeOf(target)ï¼æ¦æªObject.getPrototypeOf(proxy)ï¼è¿åä¸ä¸ªå¯¹è±¡ã\n * isExtensible(target)ï¼æ¦æªObject.isExtensible(proxy)ï¼è¿åä¸ä¸ªå¸å°å¼ã\n * setPrototypeOf(target, proto)ï¼æ¦æªObject.setPrototypeOf(proxy, proto)ï¼è¿åä¸ä¸ªå¸å°å¼ãå¦æç®æ å¯¹è±¡æ¯å½æ°ï¼é£ä¹è¿æä¸¤ç§é¢å¤æä½å¯ä»¥æ¦æªã\n * apply(target, object, args)ï¼æ¦æª Proxy å®ä¾ä½ä¸ºå½æ°è°ç¨çæä½ï¼æ¯å¦proxy(...args)ãproxy.call(object, ...args)ãproxy.apply(...)ã\n * construct(target, args)ï¼æ¦æª Proxy å®ä¾ä½ä¸ºæé å½æ°è°ç¨çæä½ï¼æ¯å¦new proxy(...args)ã\n\n\n# Proxy å®ä¾çæ¹æ³\n\nä¸é¢æ¯ä¸é¢è¿äºæ¦æªæ¹æ³çè¯¦ç»ä»ç»ã\n\n\n# get()\n\ngetæ¹æ³ç¨äºæ¦æªæä¸ªå±æ§çè¯»åæä½ï¼å¯ä»¥æ¥åä¸ä¸ªåæ°ï¼ä¾æ¬¡ä¸ºç®æ å¯¹è±¡ãå±æ§åå proxy å®ä¾æ¬èº«ï¼ä¸¥æ ¼å°è¯´ï¼æ¯æä½è¡ä¸ºæéå¯¹çå¯¹è±¡ï¼ï¼å¶ä¸­æåä¸ä¸ªåæ°å¯éã\n\ngetæ¹æ³çç¨æ³ï¼ä¸æå·²ç»æä¸ä¸ªä¾å­ï¼ä¸é¢æ¯å¦ä¸ä¸ªæ¦æªè¯»åæä½çä¾å­ã\n\nvar person = {\n  name: \"å¼ ä¸\"\n};\n\nvar proxy = new Proxy(person, {\n  get: function(target, propKey) {\n    if (propKey in target) {\n      return target[propKey];\n    } else {\n      throw new ReferenceError(\"Prop name \\\"\" + propKey + \"\\\" does not exist.\");\n    }\n  }\n});\n\nproxy.name // \"å¼ ä¸\"\nproxy.age // æåºä¸ä¸ªéè¯¯\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼å¦æè®¿é®ç®æ å¯¹è±¡ä¸å­å¨çå±æ§ï¼ä¼æåºä¸ä¸ªéè¯¯ãå¦ææ²¡æè¿ä¸ªæ¦æªå½æ°ï¼è®¿é®ä¸å­å¨çå±æ§ï¼åªä¼è¿åundefinedã\n\ngetæ¹æ³å¯ä»¥ç»§æ¿ã\n\nlet proto = new Proxy({}, {\n  get(target, propertyKey, receiver) {\n    console.log('GET ' + propertyKey);\n    return target[propertyKey];\n  }\n});\n\nlet obj = Object.create(proto);\nobj.foo // \"GET foo\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¦æªæä½å®ä¹å¨Prototypeå¯¹è±¡ä¸é¢ï¼æä»¥å¦æè¯»åobjå¯¹è±¡ç»§æ¿çå±æ§æ¶ï¼æ¦æªä¼çæã\n\nä¸é¢çä¾å­ä½¿ç¨getæ¦æªï¼å®ç°æ°ç»è¯»åè´æ°çç´¢å¼ã\n\nfunction createArray(...elements) {\n  let handler = {\n    get(target, propKey, receiver) {\n      let index = Number(propKey);\n      if (index < 0) {\n        propKey = String(target.length + index);\n      }\n      return Reflect.get(target, propKey, receiver);\n    }\n  };\n\n  let target = [];\n  target.push(...elements);\n  return new Proxy(target, handler);\n}\n\nlet arr = createArray('a', 'b', 'c');\narr[-1] // c\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»çä½ç½®åæ°æ¯-1ï¼å°±ä¼è¾åºæ°ç»çåæ°ç¬¬ä¸ä¸ªæåã\n\nå©ç¨ Proxyï¼å¯ä»¥å°è¯»åå±æ§çæä½ï¼getï¼ï¼è½¬åä¸ºæ§è¡æä¸ªå½æ°ï¼ä»èå®ç°å±æ§çé¾å¼æä½ã\n\nvar pipe = (function () {\n  return function (value) {\n    var funcStack = [];\n    var oproxy = new Proxy({} , {\n      get : function (pipeObject, fnName) {\n        if (fnName === 'get') {\n          return funcStack.reduce(function (val, fn) {\n            return fn(val);\n          },value);\n        }\n        funcStack.push(window[fnName]);\n        return oproxy;\n      }\n    });\n\n    return oproxy;\n  }\n}());\n\nvar double = n => n * 2;\nvar pow    = n => n * n;\nvar reverseInt = n => n.toString().split(\"\").reverse().join(\"\") | 0;\n\npipe(3).double.pow.reverseInt.get; // 63\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nä¸é¢ä»£ç è®¾ç½® Proxy ä»¥åï¼è¾¾å°äºå°å½æ°åé¾å¼ä½¿ç¨çææã\n\nä¸é¢çä¾å­åæ¯å©ç¨getæ¦æªï¼å®ç°ä¸ä¸ªçæåç§ DOM èç¹çéç¨å½æ°domã\n\nconst dom = new Proxy({}, {\n  get(target, property) {\n    return function(attrs = {}, ...children) {\n      const el = document.createElement(property);\n      for (let prop of Object.keys(attrs)) {\n        el.setAttribute(prop, attrs[prop]);\n      }\n      for (let child of children) {\n        if (typeof child === 'string') {\n          child = document.createTextNode(child);\n        }\n        el.appendChild(child);\n      }\n      return el;\n    }\n  }\n});\n\nconst el = dom.div({},\n  'Hello, my name is ',\n  dom.a({href: '//example.com'}, 'Mark'),\n  '. I like:',\n  dom.ul({},\n    dom.li({}, 'The web'),\n    dom.li({}, 'Food'),\n    dom.li({}, 'â¦actually that\\'s it')\n  )\n);\n\ndocument.body.appendChild(el);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\nä¸é¢æ¯ä¸ä¸ªgetæ¹æ³çç¬¬ä¸ä¸ªåæ°çä¾å­ï¼å®æ»æ¯æååå§çè¯»æä½æå¨çé£ä¸ªå¯¹è±¡ï¼ä¸è¬æåµä¸å°±æ¯ Proxy å®ä¾ã\n\nconst proxy = new Proxy({}, {\n  get: function(target, key, receiver) {\n    return receiver;\n  }\n});\nproxy.getReceiver === proxy // true\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼proxyå¯¹è±¡çgetReceiverå±æ§æ¯ç±proxyå¯¹è±¡æä¾çï¼æä»¥receiveræåproxyå¯¹è±¡ã\n\nconst proxy = new Proxy({}, {\n  get: function(target, key, receiver) {\n    return receiver;\n  }\n});\n\nconst d = Object.create(proxy);\nd.a === d // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼då¯¹è±¡æ¬èº«æ²¡æaå±æ§ï¼æä»¥è¯»åd.açæ¶åï¼ä¼å»dçååproxyå¯¹è±¡æ¾ãè¿æ¶ï¼receiverå°±æådï¼ä»£è¡¨åå§çè¯»æä½æå¨çé£ä¸ªå¯¹è±¡ã\n\nå¦æä¸ä¸ªå±æ§ä¸å¯éç½®ï¼configurableï¼ä¸ä¸å¯åï¼writableï¼ï¼å Proxy ä¸è½ä¿®æ¹è¯¥å±æ§ï¼å¦åéè¿ Proxy å¯¹è±¡è®¿é®è¯¥å±æ§ä¼æ¥éã\n\nconst target = Object.defineProperties({}, {\n  foo: {\n    value: 123,\n    writable: false,\n    configurable: false\n  },\n});\n\nconst handler = {\n  get(target, propKey) {\n    return 'abc';\n  }\n};\n\nconst proxy = new Proxy(target, handler);\n\nproxy.foo\n// TypeError: Invariant check failed\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n# set()\n\nsetæ¹æ³ç¨æ¥æ¦æªæä¸ªå±æ§çèµå¼æä½ï¼å¯ä»¥æ¥ååä¸ªåæ°ï¼ä¾æ¬¡ä¸ºç®æ å¯¹è±¡ãå±æ§åãå±æ§å¼å Proxy å®ä¾æ¬èº«ï¼å¶ä¸­æåä¸ä¸ªåæ°å¯éã\n\nåå®Personå¯¹è±¡æä¸ä¸ªageå±æ§ï¼è¯¥å±æ§åºè¯¥æ¯ä¸ä¸ªä¸å¤§äº 200 çæ´æ°ï¼é£ä¹å¯ä»¥ä½¿ç¨Proxyä¿è¯ageçå±æ§å¼ç¬¦åè¦æ±ã\n\nlet validator = {\n  set: function(obj, prop, value) {\n    if (prop === 'age') {\n      if (!Number.isInteger(value)) {\n        throw new TypeError('The age is not an integer');\n      }\n      if (value > 200) {\n        throw new RangeError('The age seems invalid');\n      }\n    }\n\n    // å¯¹äºæ»¡è¶³æ¡ä»¶ç age å±æ§ä»¥åå¶ä»å±æ§ï¼ç´æ¥ä¿å­\n    obj[prop] = value;\n  }\n};\n\nlet person = new Proxy({}, validator);\n\nperson.age = 100;\n\nperson.age // 100\nperson.age = 'young' // æ¥é\nperson.age = 300 // æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºè®¾ç½®äºå­å¼å½æ°setï¼ä»»ä½ä¸ç¬¦åè¦æ±çageå±æ§èµå¼ï¼é½ä¼æåºä¸ä¸ªéè¯¯ï¼è¿æ¯æ°æ®éªè¯çä¸ç§å®ç°æ¹æ³ãå©ç¨setæ¹æ³ï¼è¿å¯ä»¥æ°æ®ç»å®ï¼å³æ¯å½å¯¹è±¡åçååæ¶ï¼ä¼èªå¨æ´æ° DOMã\n\nææ¶ï¼æä»¬ä¼å¨å¯¹è±¡ä¸é¢è®¾ç½®åé¨å±æ§ï¼å±æ§åçç¬¬ä¸ä¸ªå­ç¬¦ä½¿ç¨ä¸åçº¿å¼å¤´ï¼è¡¨ç¤ºè¿äºå±æ§ä¸åºè¯¥è¢«å¤é¨ä½¿ç¨ãç»ågetåsetæ¹æ³ï¼å°±å¯ä»¥åå°é²æ­¢è¿äºåé¨å±æ§è¢«å¤é¨è¯»åã\n\nconst handler = {\n  get (target, key) {\n    invariant(key, 'get');\n    return target[key];\n  },\n  set (target, key, value) {\n    invariant(key, 'set');\n    target[key] = value;\n    return true;\n  }\n};\nfunction invariant (key, action) {\n  if (key[0] === '_') {\n    throw new Error(`Invalid attempt to ${action} private \"${key}\" property`);\n  }\n}\nconst target = {};\nconst proxy = new Proxy(target, handler);\nproxy._prop\n// Error: Invalid attempt to get private \"_prop\" property\nproxy._prop = 'c'\n// Error: Invalid attempt to set private \"_prop\" property\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\nä¸é¢ä»£ç ä¸­ï¼åªè¦è¯»åçå±æ§åçç¬¬ä¸ä¸ªå­ç¬¦æ¯ä¸åçº¿ï¼ä¸å¾æéï¼ä»èè¾¾å°ç¦æ­¢è¯»ååé¨å±æ§çç®çã\n\nä¸é¢æ¯setæ¹æ³ç¬¬åä¸ªåæ°çä¾å­ã\n\nconst handler = {\n  set: function(obj, prop, value, receiver) {\n    obj[prop] = receiver;\n  }\n};\nconst proxy = new Proxy({}, handler);\nproxy.foo = 'bar';\nproxy.foo === proxy // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼setæ¹æ³çç¬¬åä¸ªåæ°receiverï¼æçæ¯åå§çæä½è¡ä¸ºæå¨çé£ä¸ªå¯¹è±¡ï¼ä¸è¬æåµä¸æ¯proxyå®ä¾æ¬èº«ï¼è¯·çä¸é¢çä¾å­ã\n\nconst handler = {\n  set: function(obj, prop, value, receiver) {\n    obj[prop] = receiver;\n  }\n};\nconst proxy = new Proxy({}, handler);\nconst myObj = {};\nObject.setPrototypeOf(myObj, proxy);\n\nmyObj.foo = 'bar';\nmyObj.foo === myObj // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼è®¾ç½®myObj.fooå±æ§çå¼æ¶ï¼myObjå¹¶æ²¡æfooå±æ§ï¼å æ­¤å¼æä¼å°myObjçååé¾å»æ¾fooå±æ§ãmyObjçååå¯¹è±¡proxyæ¯ä¸ä¸ª Proxy å®ä¾ï¼è®¾ç½®å®çfooå±æ§ä¼è§¦åsetæ¹æ³ãè¿æ¶ï¼ç¬¬åä¸ªåæ°receiverå°±æååå§èµå¼è¡ä¸ºæå¨çå¯¹è±¡myObjã\n\næ³¨æï¼å¦æç®æ å¯¹è±¡èªèº«çæä¸ªå±æ§ï¼ä¸å¯åä¸ä¸å¯éç½®ï¼é£ä¹setæ¹æ³å°ä¸èµ·ä½ç¨ã\n\nconst obj = {};\nObject.defineProperty(obj, 'foo', {\n  value: 'bar',\n  writable: false,\n});\n\nconst handler = {\n  set: function(obj, prop, value, receiver) {\n    obj[prop] = 'baz';\n  }\n};\n\nconst proxy = new Proxy(obj, handler);\nproxy.foo = 'baz';\nproxy.foo // \"bar\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼obj.fooå±æ§ä¸å¯åï¼Proxy å¯¹è¿ä¸ªå±æ§çsetä»£çå°ä¸ä¼çæã\n\næ³¨æï¼ä¸¥æ ¼æ¨¡å¼ä¸ï¼setä»£çå¦ææ²¡æè¿åtrueï¼å°±ä¼æ¥éã\n\n'use strict';\nconst handler = {\n  set: function(obj, prop, value, receiver) {\n    obj[prop] = receiver;\n    // æ è®ºææ²¡æä¸é¢è¿ä¸è¡ï¼é½ä¼æ¥é\n    return false;\n  }\n};\nconst proxy = new Proxy({}, handler);\nproxy.foo = 'bar';\n// TypeError: 'set' on proxy: trap returned falsish for property 'foo'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸¥æ ¼æ¨¡å¼ä¸ï¼setä»£çè¿åfalseæèundefinedï¼é½ä¼æ¥éã\n\n\n# apply()\n\napplyæ¹æ³æ¦æªå½æ°çè°ç¨ãcallåapplyæä½ã\n\napplyæ¹æ³å¯ä»¥æ¥åä¸ä¸ªåæ°ï¼åå«æ¯ç®æ å¯¹è±¡ãç®æ å¯¹è±¡çä¸ä¸æå¯¹è±¡ï¼thisï¼åç®æ å¯¹è±¡çåæ°æ°ç»ã\n\nvar handler = {\n  apply (target, ctx, args) {\n    return Reflect.apply(...arguments);\n  }\n};\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nvar target = function () { return 'I am the target'; };\nvar handler = {\n  apply: function () {\n    return 'I am the proxy';\n  }\n};\n\nvar p = new Proxy(target, handler);\n\np()\n// \"I am the proxy\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼åépæ¯ Proxy çå®ä¾ï¼å½å®ä½ä¸ºå½æ°è°ç¨æ¶ï¼p()ï¼ï¼å°±ä¼è¢«applyæ¹æ³æ¦æªï¼è¿åä¸ä¸ªå­ç¬¦ä¸²ã\n\nä¸é¢æ¯å¦å¤ä¸ä¸ªä¾å­ã\n\nvar twice = {\n  apply (target, ctx, args) {\n    return Reflect.apply(...arguments) * 2;\n  }\n};\nfunction sum (left, right) {\n  return left + right;\n};\nvar proxy = new Proxy(sum, twice);\nproxy(1, 2) // 6\nproxy.call(null, 5, 6) // 22\nproxy.apply(null, [7, 8]) // 30\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¯å½æ§è¡proxyå½æ°ï¼ç´æ¥è°ç¨æcallåapplyè°ç¨ï¼ï¼å°±ä¼è¢«applyæ¹æ³æ¦æªã\n\nå¦å¤ï¼ç´æ¥è°ç¨Reflect.applyæ¹æ³ï¼ä¹ä¼è¢«æ¦æªã\n\nReflect.apply(proxy, null, [9, 10]) // 38\n\n\n1\n\n\n\n# has()\n\nhasæ¹æ³ç¨æ¥æ¦æªHasPropertyæä½ï¼å³å¤æ­å¯¹è±¡æ¯å¦å·ææä¸ªå±æ§æ¶ï¼è¿ä¸ªæ¹æ³ä¼çæãå¸åçæä½å°±æ¯inè¿ç®ç¬¦ã\n\nhasæ¹æ³å¯ä»¥æ¥åä¸¤ä¸ªåæ°ï¼åå«æ¯ç®æ å¯¹è±¡ãéæ¥è¯¢çå±æ§åã\n\nä¸é¢çä¾å­ä½¿ç¨hasæ¹æ³éèæäºå±æ§ï¼ä¸è¢«inè¿ç®ç¬¦åç°ã\n\nvar handler = {\n  has (target, key) {\n    if (key[0] === '_') {\n      return false;\n    }\n    return key in target;\n  }\n};\nvar target = { _prop: 'foo', prop: 'foo' };\nvar proxy = new Proxy(target, handler);\n'_prop' in proxy // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æåå¯¹è±¡çå±æ§åçç¬¬ä¸ä¸ªå­ç¬¦æ¯ä¸åçº¿ï¼proxy.haså°±ä¼è¿åfalseï¼ä»èä¸ä¼è¢«inè¿ç®ç¬¦åç°ã\n\nå¦æåå¯¹è±¡ä¸å¯éç½®æèç¦æ­¢æ©å±ï¼è¿æ¶hasæ¦æªä¼æ¥éã\n\nvar obj = { a: 10 };\nObject.preventExtensions(obj);\n\nvar p = new Proxy(obj, {\n  has: function(target, prop) {\n    return false;\n  }\n});\n\n'a' in p // TypeError is thrown\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼objå¯¹è±¡ç¦æ­¢æ©å±ï¼ç»æä½¿ç¨hasæ¦æªå°±ä¼æ¥éãä¹å°±æ¯è¯´ï¼å¦ææä¸ªå±æ§ä¸å¯éç½®ï¼æèç®æ å¯¹è±¡ä¸å¯æ©å±ï¼ï¼åhasæ¹æ³å°±ä¸å¾âéèâï¼å³è¿åfalseï¼ç®æ å¯¹è±¡çè¯¥å±æ§ã\n\nå¼å¾æ³¨æçæ¯ï¼hasæ¹æ³æ¦æªçæ¯HasPropertyæä½ï¼èä¸æ¯HasOwnPropertyæä½ï¼å³hasæ¹æ³ä¸å¤æ­ä¸ä¸ªå±æ§æ¯å¯¹è±¡èªèº«çå±æ§ï¼è¿æ¯ç»§æ¿çå±æ§ã\n\nå¦å¤ï¼è½ç¶for...inå¾ªç¯ä¹ç¨å°äºinè¿ç®ç¬¦ï¼ä½æ¯hasæ¦æªå¯¹for...inå¾ªç¯ä¸çæã\n\nlet stu1 = {name: 'å¼ ä¸', score: 59};\nlet stu2 = {name: 'æå', score: 99};\n\nlet handler = {\n  has(target, prop) {\n    if (prop === 'score' && target[prop] < 60) {\n      console.log(`${target.name} ä¸åæ ¼`);\n      return false;\n    }\n    return prop in target;\n  }\n}\n\nlet oproxy1 = new Proxy(stu1, handler);\nlet oproxy2 = new Proxy(stu2, handler);\n\n'score' in oproxy1\n// å¼ ä¸ ä¸åæ ¼\n// false\n\n'score' in oproxy2\n// true\n\nfor (let a in oproxy1) {\n  console.log(oproxy1[a]);\n}\n// å¼ ä¸\n// 59\n\nfor (let b in oproxy2) {\n  console.log(oproxy2[b]);\n}\n// æå\n// 99\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n\n\nä¸é¢ä»£ç ä¸­ï¼hasæ¦æªåªå¯¹inè¿ç®ç¬¦çæï¼å¯¹for...inå¾ªç¯ä¸çæï¼å¯¼è´ä¸ç¬¦åè¦æ±çå±æ§æ²¡æè¢«for...inå¾ªç¯ææé¤ã\n\n\n# construct()\n\nconstructæ¹æ³ç¨äºæ¦æªnewå½ä»¤ï¼ä¸é¢æ¯æ¦æªå¯¹è±¡çåæ³ã\n\nvar handler = {\n  construct (target, args, newTarget) {\n    return new target(...args);\n  }\n};\n\n\n1\n2\n3\n4\n5\n\n\nconstructæ¹æ³å¯ä»¥æ¥åä¸¤ä¸ªåæ°ã\n\n * targetï¼ç®æ å¯¹è±¡\n * argsï¼æé å½æ°çåæ°å¯¹è±¡\n * newTargetï¼åé å®ä¾å¯¹è±¡æ¶ï¼newå½ä»¤ä½ç¨çæé å½æ°ï¼ä¸é¢ä¾å­çpï¼\n\nvar p = new Proxy(function () {}, {\n  construct: function(target, args) {\n    console.log('called: ' + args.join(', '));\n    return { value: args[0] * 10 };\n  }\n});\n\n(new p(1)).value\n// \"called: 1\"\n// 10\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nconstructæ¹æ³è¿åçå¿é¡»æ¯ä¸ä¸ªå¯¹è±¡ï¼å¦åä¼æ¥éã\n\nvar p = new Proxy(function() {}, {\n  construct: function(target, argumentsList) {\n    return 1;\n  }\n});\n\nnew p() // æ¥é\n// Uncaught TypeError: 'construct' on proxy: trap returned non-object ('1')\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# deleteProperty()\n\ndeletePropertyæ¹æ³ç¨äºæ¦æªdeleteæä½ï¼å¦æè¿ä¸ªæ¹æ³æåºéè¯¯æèè¿åfalseï¼å½åå±æ§å°±æ æ³è¢«deleteå½ä»¤å é¤ã\n\nvar handler = {\n  deleteProperty (target, key) {\n    invariant(key, 'delete');\n    delete target[key];\n    return true;\n  }\n};\nfunction invariant (key, action) {\n  if (key[0] === '_') {\n    throw new Error(`Invalid attempt to ${action} private \"${key}\" property`);\n  }\n}\n\nvar target = { _prop: 'foo' };\nvar proxy = new Proxy(target, handler);\ndelete proxy._prop\n// Error: Invalid attempt to delete private \"_prop\" property\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼deletePropertyæ¹æ³æ¦æªäºdeleteæä½ç¬¦ï¼å é¤ç¬¬ä¸ä¸ªå­ç¬¦ä¸ºä¸åçº¿çå±æ§ä¼æ¥éã\n\næ³¨æï¼ç®æ å¯¹è±¡èªèº«çä¸å¯éç½®ï¼configurableï¼çå±æ§ï¼ä¸è½è¢«deletePropertyæ¹æ³å é¤ï¼å¦åæ¥éã\n\n\n# defineProperty()\n\ndefinePropertyæ¹æ³æ¦æªäºObject.definePropertyæä½ã\n\nvar handler = {\n  defineProperty (target, key, descriptor) {\n    return false;\n  }\n};\nvar target = {};\nvar proxy = new Proxy(target, handler);\nproxy.foo = 'bar' // ä¸ä¼çæ\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼definePropertyæ¹æ³è¿åfalseï¼å¯¼è´æ·»å æ°å±æ§æ»æ¯æ æã\n\næ³¨æï¼å¦æç®æ å¯¹è±¡ä¸å¯æ©å±ï¼non-extensibleï¼ï¼ådefinePropertyä¸è½å¢å ç®æ å¯¹è±¡ä¸ä¸å­å¨çå±æ§ï¼å¦åä¼æ¥éãå¦å¤ï¼å¦æç®æ å¯¹è±¡çæä¸ªå±æ§ä¸å¯åï¼writableï¼æä¸å¯éç½®ï¼configurableï¼ï¼ådefinePropertyæ¹æ³ä¸å¾æ¹åè¿ä¸¤ä¸ªè®¾ç½®ã\n\n\n# getOwnPropertyDescriptor()\n\ngetOwnPropertyDescriptoræ¹æ³æ¦æªObject.getOwnPropertyDescriptor()ï¼è¿åä¸ä¸ªå±æ§æè¿°å¯¹è±¡æèundefinedã\n\nvar handler = {\n  getOwnPropertyDescriptor (target, key) {\n    if (key[0] === '_') {\n      return;\n    }\n    return Object.getOwnPropertyDescriptor(target, key);\n  }\n};\nvar target = { _foo: 'bar', baz: 'tar' };\nvar proxy = new Proxy(target, handler);\nObject.getOwnPropertyDescriptor(proxy, 'wat')\n// undefined\nObject.getOwnPropertyDescriptor(proxy, '_foo')\n// undefined\nObject.getOwnPropertyDescriptor(proxy, 'baz')\n// { value: 'tar', writable: true, enumerable: true, configurable: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼handler.getOwnPropertyDescriptoræ¹æ³å¯¹äºç¬¬ä¸ä¸ªå­ç¬¦ä¸ºä¸åçº¿çå±æ§åä¼è¿åundefinedã\n\n\n# getPrototypeOf()\n\ngetPrototypeOfæ¹æ³ä¸»è¦ç¨æ¥æ¦æªè·åå¯¹è±¡ååãå·ä½æ¥è¯´ï¼æ¦æªä¸é¢è¿äºæä½ã\n\n * Object.prototype.__proto__\n * Object.prototype.isPrototypeOf()\n * Object.getPrototypeOf()\n * Reflect.getPrototypeOf()\n * instanceof\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nvar proto = {};\nvar p = new Proxy({}, {\n  getPrototypeOf(target) {\n    return proto;\n  }\n});\nObject.getPrototypeOf(p) === proto // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼getPrototypeOfæ¹æ³æ¦æªObject.getPrototypeOf()ï¼è¿åprotoå¯¹è±¡ã\n\næ³¨æï¼getPrototypeOfæ¹æ³çè¿åå¼å¿é¡»æ¯å¯¹è±¡æènullï¼å¦åæ¥éãå¦å¤ï¼å¦æç®æ å¯¹è±¡ä¸å¯æ©å±ï¼non-extensibleï¼ï¼ getPrototypeOfæ¹æ³å¿é¡»è¿åç®æ å¯¹è±¡çååå¯¹è±¡ã\n\n\n# isExtensible()\n\nisExtensibleæ¹æ³æ¦æªObject.isExtensibleæä½ã\n\nvar p = new Proxy({}, {\n  isExtensible: function(target) {\n    console.log(\"called\");\n    return true;\n  }\n});\n\nObject.isExtensible(p)\n// \"called\"\n// true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç è®¾ç½®äºisExtensibleæ¹æ³ï¼å¨è°ç¨Object.isExtensibleæ¶ä¼è¾åºcalledã\n\næ³¨æï¼è¯¥æ¹æ³åªè½è¿åå¸å°å¼ï¼å¦åè¿åå¼ä¼è¢«èªå¨è½¬ä¸ºå¸å°å¼ã\n\nè¿ä¸ªæ¹æ³æä¸ä¸ªå¼ºéå¶ï¼å®çè¿åå¼å¿é¡»ä¸ç®æ å¯¹è±¡çisExtensibleå±æ§ä¿æä¸è´ï¼å¦åå°±ä¼æåºéè¯¯ã\n\nObject.isExtensible(proxy) === Object.isExtensible(target)\n\n\n1\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nvar p = new Proxy({}, {\n  isExtensible: function(target) {\n    return false;\n  }\n});\n\nObject.isExtensible(p)\n// Uncaught TypeError: 'isExtensible' on proxy: trap result does not reflect extensibility of proxy target (which is 'true')\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# ownKeys()\n\nownKeysæ¹æ³ç¨æ¥æ¦æªå¯¹è±¡èªèº«å±æ§çè¯»åæä½ãå·ä½æ¥è¯´ï¼æ¦æªä»¥ä¸æä½ã\n\n * Object.getOwnPropertyNames()\n * Object.getOwnPropertySymbols()\n * Object.keys()\n * for...inå¾ªç¯\n\nä¸é¢æ¯æ¦æªObject.keys()çä¾å­ã\n\nlet target = {\n  a: 1,\n  b: 2,\n  c: 3\n};\n\nlet handler = {\n  ownKeys(target) {\n    return ['a'];\n  }\n};\n\nlet proxy = new Proxy(target, handler);\n\nObject.keys(proxy)\n// [ 'a' ]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç æ¦æªäºå¯¹äºtargetå¯¹è±¡çObject.keys()æä½ï¼åªè¿åaãbãcä¸ä¸ªå±æ§ä¹ä¸­çaå±æ§ã\n\nä¸é¢çä¾å­æ¯æ¦æªç¬¬ä¸ä¸ªå­ç¬¦ä¸ºä¸åçº¿çå±æ§åã\n\nlet target = {\n  _bar: 'foo',\n  _prop: 'bar',\n  prop: 'baz'\n};\n\nlet handler = {\n  ownKeys (target) {\n    return Reflect.ownKeys(target).filter(key => key[0] !== '_');\n  }\n};\n\nlet proxy = new Proxy(target, handler);\nfor (let key of Object.keys(proxy)) {\n  console.log(target[key]);\n}\n// \"baz\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\næ³¨æï¼ä½¿ç¨Object.keysæ¹æ³æ¶ï¼æä¸ç±»å±æ§ä¼è¢«ownKeysæ¹æ³èªå¨è¿æ»¤ï¼ä¸ä¼è¿åã\n\n * ç®æ å¯¹è±¡ä¸ä¸å­å¨çå±æ§\n * å±æ§åä¸º Symbol å¼\n * ä¸å¯éåï¼enumerableï¼çå±æ§\n\nlet target = {\n  a: 1,\n  b: 2,\n  c: 3,\n  [Symbol.for('secret')]: '4',\n};\n\nObject.defineProperty(target, 'key', {\n  enumerable: false,\n  configurable: true,\n  writable: true,\n  value: 'static'\n});\n\nlet handler = {\n  ownKeys(target) {\n    return ['a', 'd', Symbol.for('secret'), 'key'];\n  }\n};\n\nlet proxy = new Proxy(target, handler);\n\nObject.keys(proxy)\n// ['a']\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nä¸é¢ä»£ç ä¸­ï¼ownKeysæ¹æ³ä¹ä¸­ï¼æ¾å¼è¿åä¸å­å¨çå±æ§ï¼dï¼ãSymbol å¼ï¼Symbol.for('secret')ï¼ãä¸å¯éåçå±æ§ï¼keyï¼ï¼ç»æé½è¢«èªå¨è¿æ»¤æã\n\nownKeysæ¹æ³è¿å¯ä»¥æ¦æªObject.getOwnPropertyNames()ã\n\nvar p = new Proxy({}, {\n  ownKeys: function(target) {\n    return ['a', 'b', 'c'];\n  }\n});\n\nObject.getOwnPropertyNames(p)\n// [ 'a', 'b', 'c' ]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nfor...inå¾ªç¯ä¹åå°ownKeysæ¹æ³çæ¦æªã\n\nconst obj = { hello: 'world' };\nconst proxy = new Proxy(obj, {\n  ownKeys: function () {\n    return ['a', 'b'];\n  }\n});\n\nfor (let key in proxy) {\n  console.log(key); // æ²¡æä»»ä½è¾åº\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼ownkeysæå®åªè¿åaåbå±æ§ï¼ç±äºobjæ²¡æè¿ä¸¤ä¸ªå±æ§ï¼å æ­¤for...inå¾ªç¯ä¸ä¼æä»»ä½è¾åºã\n\nownKeysæ¹æ³è¿åçæ°ç»æåï¼åªè½æ¯å­ç¬¦ä¸²æ Symbol å¼ãå¦ææå¶ä»ç±»åçå¼ï¼æèè¿åçæ ¹æ¬ä¸æ¯æ°ç»ï¼å°±ä¼æ¥éã\n\nvar obj = {};\n\nvar p = new Proxy(obj, {\n  ownKeys: function(target) {\n    return [123, true, undefined, null, {}, []];\n  }\n});\n\nObject.getOwnPropertyNames(p)\n// Uncaught TypeError: 123 is not a valid property name\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼ownKeysæ¹æ³è½ç¶è¿åä¸ä¸ªæ°ç»ï¼ä½æ¯æ¯ä¸ä¸ªæ°ç»æåé½ä¸æ¯å­ç¬¦ä¸²æ Symbol å¼ï¼å æ­¤å°±æ¥éäºã\n\nå¦æç®æ å¯¹è±¡èªèº«åå«ä¸å¯éç½®çå±æ§ï¼åè¯¥å±æ§å¿é¡»è¢«ownKeysæ¹æ³è¿åï¼å¦åæ¥éã\n\nvar obj = {};\nObject.defineProperty(obj, 'a', {\n  configurable: false,\n  enumerable: true,\n  value: 10 }\n);\n\nvar p = new Proxy(obj, {\n  ownKeys: function(target) {\n    return ['b'];\n  }\n});\n\nObject.getOwnPropertyNames(p)\n// Uncaught TypeError: 'ownKeys' on proxy: trap result did not include 'a'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼objå¯¹è±¡çaå±æ§æ¯ä¸å¯éç½®çï¼è¿æ¶ownKeysæ¹æ³è¿åçæ°ç»ä¹ä¸­ï¼å¿é¡»åå«aï¼å¦åä¼æ¥éã\n\nå¦å¤ï¼å¦æç®æ å¯¹è±¡æ¯ä¸å¯æ©å±çï¼non-extensibleï¼ï¼è¿æ¶ownKeysæ¹æ³è¿åçæ°ç»ä¹ä¸­ï¼å¿é¡»åå«åå¯¹è±¡çææå±æ§ï¼ä¸ä¸è½åå«å¤ä½çå±æ§ï¼å¦åæ¥éã\n\nvar obj = {\n  a: 1\n};\n\nObject.preventExtensions(obj);\n\nvar p = new Proxy(obj, {\n  ownKeys: function(target) {\n    return ['a', 'b'];\n  }\n});\n\nObject.getOwnPropertyNames(p)\n// Uncaught TypeError: 'ownKeys' on proxy: trap returned extra keys but proxy target is non-extensible\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼objå¯¹è±¡æ¯ä¸å¯æ©å±çï¼è¿æ¶ownKeysæ¹æ³è¿åçæ°ç»ä¹ä¸­ï¼åå«äºobjå¯¹è±¡çå¤ä½å±æ§bï¼æä»¥å¯¼è´äºæ¥éã\n\n\n# preventExtensions()\n\npreventExtensionsæ¹æ³æ¦æªObject.preventExtensions()ãè¯¥æ¹æ³å¿é¡»è¿åä¸ä¸ªå¸å°å¼ï¼å¦åä¼è¢«èªå¨è½¬ä¸ºå¸å°å¼ã\n\nè¿ä¸ªæ¹æ³æä¸ä¸ªéå¶ï¼åªæç®æ å¯¹è±¡ä¸å¯æ©å±æ¶ï¼å³Object.isExtensible(proxy)ä¸ºfalseï¼ï¼proxy.preventExtensionsæè½è¿åtrueï¼å¦åä¼æ¥éã\n\nvar proxy = new Proxy({}, {\n  preventExtensions: function(target) {\n    return true;\n  }\n});\n\nObject.preventExtensions(proxy)\n// Uncaught TypeError: 'preventExtensions' on proxy: trap returned truish but the proxy target is extensible\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼proxy.preventExtensionsæ¹æ³è¿åtrueï¼ä½è¿æ¶Object.isExtensible(proxy)ä¼è¿åtrueï¼å æ­¤æ¥éã\n\nä¸ºäºé²æ­¢åºç°è¿ä¸ªé®é¢ï¼éå¸¸è¦å¨proxy.preventExtensionsæ¹æ³éé¢ï¼è°ç¨ä¸æ¬¡Object.preventExtensionsã\n\nvar proxy = new Proxy({}, {\n  preventExtensions: function(target) {\n    console.log('called');\n    Object.preventExtensions(target);\n    return true;\n  }\n});\n\nObject.preventExtensions(proxy)\n// \"called\"\n// Proxy {}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# setPrototypeOf()\n\nsetPrototypeOfæ¹æ³ä¸»è¦ç¨æ¥æ¦æªObject.setPrototypeOfæ¹æ³ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nvar handler = {\n  setPrototypeOf (target, proto) {\n    throw new Error('Changing the prototype is forbidden');\n  }\n};\nvar proto = {};\nvar target = function () {};\nvar proxy = new Proxy(target, handler);\nObject.setPrototypeOf(proxy, proto);\n// Error: Changing the prototype is forbidden\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼åªè¦ä¿®æ¹targetçååå¯¹è±¡ï¼å°±ä¼æ¥éã\n\næ³¨æï¼è¯¥æ¹æ³åªè½è¿åå¸å°å¼ï¼å¦åä¼è¢«èªå¨è½¬ä¸ºå¸å°å¼ãå¦å¤ï¼å¦æç®æ å¯¹è±¡ä¸å¯æ©å±ï¼non-extensibleï¼ï¼setPrototypeOfæ¹æ³ä¸å¾æ¹åç®æ å¯¹è±¡çååã\n\n\n# Proxy.revocable()\n\nProxy.revocableæ¹æ³è¿åä¸ä¸ªå¯åæ¶ç Proxy å®ä¾ã\n\nlet target = {};\nlet handler = {};\n\nlet {proxy, revoke} = Proxy.revocable(target, handler);\n\nproxy.foo = 123;\nproxy.foo // 123\n\nrevoke();\nproxy.foo // TypeError: Revoked\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nProxy.revocableæ¹æ³è¿åä¸ä¸ªå¯¹è±¡ï¼è¯¥å¯¹è±¡çproxyå±æ§æ¯Proxyå®ä¾ï¼revokeå±æ§æ¯ä¸ä¸ªå½æ°ï¼å¯ä»¥åæ¶Proxyå®ä¾ãä¸é¢ä»£ç ä¸­ï¼å½æ§è¡revokeå½æ°ä¹åï¼åè®¿é®Proxyå®ä¾ï¼å°±ä¼æåºä¸ä¸ªéè¯¯ã\n\nProxy.revocableçä¸ä¸ªä½¿ç¨åºæ¯æ¯ï¼ç®æ å¯¹è±¡ä¸åè®¸ç´æ¥è®¿é®ï¼å¿é¡»éè¿ä»£çè®¿é®ï¼ä¸æ¦è®¿é®ç»æï¼å°±æ¶åä»£çæï¼ä¸åè®¸åæ¬¡è®¿é®ã\n\n\n# this é®é¢\n\nè½ç¶ Proxy å¯ä»¥ä»£çéå¯¹ç®æ å¯¹è±¡çè®¿é®ï¼ä½å®ä¸æ¯ç®æ å¯¹è±¡çéæä»£çï¼å³ä¸åä»»ä½æ¦æªçæåµä¸ï¼ä¹æ æ³ä¿è¯ä¸ç®æ å¯¹è±¡çè¡ä¸ºä¸è´ãä¸»è¦åå å°±æ¯å¨ Proxy ä»£ççæåµä¸ï¼ç®æ å¯¹è±¡åé¨çthiså³é®å­ä¼æå Proxy ä»£çã\n\nconst target = {\n  m: function () {\n    console.log(this === proxy);\n  }\n};\nconst handler = {};\n\nconst proxy = new Proxy(target, handler);\n\ntarget.m() // false\nproxy.m()  // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸æ¦proxyä»£çtarget.mï¼åèåé¨çthiså°±æ¯æåproxyï¼èä¸æ¯targetã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ï¼ç±äºthisæåçååï¼å¯¼è´ Proxy æ æ³ä»£çç®æ å¯¹è±¡ã\n\nconst _name = new WeakMap();\n\nclass Person {\n  constructor(name) {\n    _name.set(this, name);\n  }\n  get name() {\n    return _name.get(this);\n  }\n}\n\nconst jane = new Person('Jane');\njane.name // 'Jane'\n\nconst proxy = new Proxy(jane, {});\nproxy.name // undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼ç®æ å¯¹è±¡janeçnameå±æ§ï¼å®éä¿å­å¨å¤é¨WeakMapå¯¹è±¡_nameä¸é¢ï¼éè¿thisé®åºåãç±äºéè¿proxy.nameè®¿é®æ¶ï¼thisæåproxyï¼å¯¼è´æ æ³åå°å¼ï¼æä»¥è¿åundefinedã\n\næ­¤å¤ï¼æäºåçå¯¹è±¡çåé¨å±æ§ï¼åªæéè¿æ­£ç¡®çthisæè½æ¿å°ï¼æä»¥ Proxy ä¹æ æ³ä»£çè¿äºåçå¯¹è±¡çå±æ§ã\n\nconst target = new Date();\nconst handler = {};\nconst proxy = new Proxy(target, handler);\n\nproxy.getDate();\n// TypeError: this is not a Date object.\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼getDateæ¹æ³åªè½å¨Dateå¯¹è±¡å®ä¾ä¸é¢æ¿å°ï¼å¦æthisä¸æ¯Dateå¯¹è±¡å®ä¾å°±ä¼æ¥éãè¿æ¶ï¼thisç»å®åå§å¯¹è±¡ï¼å°±å¯ä»¥è§£å³è¿ä¸ªé®é¢ã\n\nconst target = new Date('2015-01-01');\nconst handler = {\n  get(target, prop) {\n    if (prop === 'getDate') {\n      return target.getDate.bind(target);\n    }\n    return Reflect.get(target, prop);\n  }\n};\nconst proxy = new Proxy(target, handler);\n\nproxy.getDate() // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n\n# å®ä¾ï¼Web æå¡çå®¢æ·ç«¯\n\nProxy å¯¹è±¡å¯ä»¥æ¦æªç®æ å¯¹è±¡çä»»æå±æ§ï¼è¿ä½¿å¾å®å¾åéç¨æ¥å Web æå¡çå®¢æ·ç«¯ã\n\nconst service = createWebService('http://example.com/data');\n\nservice.employees().then(json => {\n  const employees = JSON.parse(json);\n  // Â·Â·Â·\n});\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç æ°å»ºäºä¸ä¸ª Web æå¡çæ¥å£ï¼è¿ä¸ªæ¥å£è¿ååç§æ°æ®ãProxy å¯ä»¥æ¦æªè¿ä¸ªå¯¹è±¡çä»»æå±æ§ï¼æä»¥ä¸ç¨ä¸ºæ¯ä¸ç§æ°æ®åä¸ä¸ªééæ¹æ³ï¼åªè¦åä¸ä¸ª Proxy æ¦æªå°±å¯ä»¥äºã\n\nfunction createWebService(baseUrl) {\n  return new Proxy({}, {\n    get(target, propKey, receiver) {\n      return () => httpGet(baseUrl + '/' + propKey);\n    }\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nåçï¼Proxy ä¹å¯ä»¥ç¨æ¥å®ç°æ°æ®åºç ORM å±ã",normalizedContent:"# proxy\n\n\n# æ¦è¿°\n\nproxy ç¨äºä¿®æ¹æäºæä½çé»è®¤è¡ä¸ºï¼ç­åäºå¨è¯­è¨å±é¢ååºä¿®æ¹ï¼æä»¥å±äºä¸ç§âåç¼ç¨âï¼meta programmingï¼ï¼å³å¯¹ç¼ç¨è¯­è¨è¿è¡ç¼ç¨ã\n\nproxy å¯ä»¥çè§£æï¼å¨ç®æ å¯¹è±¡ä¹åæ¶è®¾ä¸å±âæ¦æªâï¼å¤çå¯¹è¯¥å¯¹è±¡çè®¿é®ï¼é½å¿é¡»åéè¿è¿å±æ¦æªï¼å æ­¤æä¾äºä¸ç§æºå¶ï¼å¯ä»¥å¯¹å¤ççè®¿é®è¿è¡è¿æ»¤åæ¹åãproxy è¿ä¸ªè¯çåææ¯ä»£çï¼ç¨å¨è¿éè¡¨ç¤ºç±å®æ¥âä»£çâæäºæä½ï¼å¯ä»¥è¯ä¸ºâä»£çå¨âã\n\nvar obj = new proxy({}, {\n  get: function (target, propkey, receiver) {\n    console.log(`getting ${propkey}!`);\n    return reflect.get(target, propkey, receiver);\n  },\n  set: function (target, propkey, value, receiver) {\n    console.log(`setting ${propkey}!`);\n    return reflect.set(target, propkey, value, receiver);\n  }\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å¯¹ä¸ä¸ªç©ºå¯¹è±¡æ¶è®¾äºä¸å±æ¦æªï¼éå®ä¹äºå±æ§çè¯»åï¼getï¼åè®¾ç½®ï¼setï¼è¡ä¸ºãè¿éææ¶åä¸è§£éå·ä½çè¯­æ³ï¼åªçè¿è¡ç»æãå¯¹è®¾ç½®äºæ¦æªè¡ä¸ºçå¯¹è±¡objï¼å»è¯»åå®çå±æ§ï¼å°±ä¼å¾å°ä¸é¢çç»æã\n\nobj.count = 1\n//  setting count!\n++obj.count\n//  getting count!\n//  setting count!\n//  2\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç è¯´æï¼proxy å®éä¸éè½½ï¼overloadï¼äºç¹è¿ç®ç¬¦ï¼å³ç¨èªå·±çå®ä¹è¦çäºè¯­è¨çåå§å®ä¹ã\n\nes6 åçæä¾ proxy æé å½æ°ï¼ç¨æ¥çæ proxy å®ä¾ã\n\nvar proxy = new proxy(target, handler);\n\n\n1\n\n\nproxy å¯¹è±¡çææç¨æ³ï¼é½æ¯ä¸é¢è¿ç§å½¢å¼ï¼ä¸åçåªæ¯handleråæ°çåæ³ãå¶ä¸­ï¼new proxy()è¡¨ç¤ºçæä¸ä¸ªproxyå®ä¾ï¼targetåæ°è¡¨ç¤ºæè¦æ¦æªçç®æ å¯¹è±¡ï¼handleråæ°ä¹æ¯ä¸ä¸ªå¯¹è±¡ï¼ç¨æ¥å®å¶æ¦æªè¡ä¸ºã\n\nä¸é¢æ¯å¦ä¸ä¸ªæ¦æªè¯»åå±æ§è¡ä¸ºçä¾å­ã\n\nvar proxy = new proxy({}, {\n  get: function(target, propkey) {\n    return 35;\n  }\n});\n\nproxy.time // 35\nproxy.name // 35\nproxy.title // 35\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼ä½ä¸ºæé å½æ°ï¼proxyæ¥åä¸¤ä¸ªåæ°ãç¬¬ä¸ä¸ªåæ°æ¯æè¦ä»£ççç®æ å¯¹è±¡ï¼ä¸ä¾æ¯ä¸ä¸ªç©ºå¯¹è±¡ï¼ï¼å³å¦ææ²¡æproxyçä»å¥ï¼æä½åæ¥è¦è®¿é®çå°±æ¯è¿ä¸ªå¯¹è±¡ï¼ç¬¬äºä¸ªåæ°æ¯ä¸ä¸ªéç½®å¯¹è±¡ï¼å¯¹äºæ¯ä¸ä¸ªè¢«ä»£ççæä½ï¼éè¦æä¾ä¸ä¸ªå¯¹åºçå¤çå½æ°ï¼è¯¥å½æ°å°æ¦æªå¯¹åºçæä½ãæ¯å¦ï¼ä¸é¢ä»£ç ä¸­ï¼éç½®å¯¹è±¡æä¸ä¸ªgetæ¹æ³ï¼ç¨æ¥æ¦æªå¯¹ç®æ å¯¹è±¡å±æ§çè®¿é®è¯·æ±ãgetæ¹æ³çä¸¤ä¸ªåæ°åå«æ¯ç®æ å¯¹è±¡åæè¦è®¿é®çå±æ§ãå¯ä»¥çå°ï¼ç±äºæ¦æªå½æ°æ»æ¯è¿å35ï¼æä»¥è®¿é®ä»»ä½å±æ§é½å¾å°35ã\n\næ³¨æï¼è¦ä½¿å¾proxyèµ·ä½ç¨ï¼å¿é¡»éå¯¹proxyå®ä¾ï¼ä¸ä¾æ¯proxyå¯¹è±¡ï¼è¿è¡æä½ï¼èä¸æ¯éå¯¹ç®æ å¯¹è±¡ï¼ä¸ä¾æ¯ç©ºå¯¹è±¡ï¼è¿è¡æä½ã\n\nå¦æhandleræ²¡æè®¾ç½®ä»»ä½æ¦æªï¼é£å°±ç­åäºç´æ¥éååå¯¹è±¡ã\n\nvar target = {};\nvar handler = {};\nvar proxy = new proxy(target, handler);\nproxy.a = 'b';\ntarget.a // \"b\"\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼handleræ¯ä¸ä¸ªç©ºå¯¹è±¡ï¼æ²¡æä»»ä½æ¦æªææï¼è®¿é®proxyå°±ç­åäºè®¿é®targetã\n\nä¸ä¸ªæå·§æ¯å° proxy å¯¹è±¡ï¼è®¾ç½®å°object.proxyå±æ§ï¼ä»èå¯ä»¥å¨objectå¯¹è±¡ä¸è°ç¨ã\n\nvar object = { proxy: new proxy(target, handler) };\n\n\n1\n\n\nproxy å®ä¾ä¹å¯ä»¥ä½ä¸ºå¶ä»å¯¹è±¡çååå¯¹è±¡ã\n\nvar proxy = new proxy({}, {\n  get: function(target, propkey) {\n    return 35;\n  }\n});\n\nlet obj = object.create(proxy);\nobj.time // 35\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼proxyå¯¹è±¡æ¯objå¯¹è±¡çååï¼objå¯¹è±¡æ¬èº«å¹¶æ²¡ætimeå±æ§ï¼æä»¥æ ¹æ®ååé¾ï¼ä¼å¨proxyå¯¹è±¡ä¸è¯»åè¯¥å±æ§ï¼å¯¼è´è¢«æ¦æªã\n\nåä¸ä¸ªæ¦æªå¨å½æ°ï¼å¯ä»¥è®¾ç½®æ¦æªå¤ä¸ªæä½ã\n\nvar handler = {\n  get: function(target, name) {\n    if (name === 'prototype') {\n      return object.prototype;\n    }\n    return 'hello, ' + name;\n  },\n\n  apply: function(target, thisbinding, args) {\n    return args[0];\n  },\n\n  construct: function(target, args) {\n    return {value: args[1]};\n  }\n};\n\nvar fproxy = new proxy(function(x, y) {\n  return x + y;\n}, handler);\n\nfproxy(1, 2) // 1\nnew fproxy(1, 2) // {value: 2}\nfproxy.prototype === object.prototype // true\nfproxy.foo === \"hello, foo\" // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nå¯¹äºå¯ä»¥è®¾ç½®ãä½æ²¡æè®¾ç½®æ¦æªçæä½ï¼åç´æ¥è½å¨ç®æ å¯¹è±¡ä¸ï¼æç§ååçæ¹å¼äº§çç»æã\n\nä¸é¢æ¯ proxy æ¯æçæ¦æªæä½ä¸è§ï¼ä¸å± 13 ç§ã\n\n * get(target, propkey, receiver)ï¼æ¦æªå¯¹è±¡å±æ§çè¯»åï¼æ¯å¦proxy.fooåproxy['foo']ã\n * set(target, propkey, value, receiver)ï¼æ¦æªå¯¹è±¡å±æ§çè®¾ç½®ï¼æ¯å¦proxy.foo = væproxy['foo'] = vï¼è¿åä¸ä¸ªå¸å°å¼ã\n * has(target, propkey)ï¼æ¦æªpropkey in proxyçæä½ï¼è¿åä¸ä¸ªå¸å°å¼ã\n * deleteproperty(target, propkey)ï¼æ¦æªdelete proxy[propkey]çæä½ï¼è¿åä¸ä¸ªå¸å°å¼ã\n * ownkeys(target)ï¼æ¦æªobject.getownpropertynames(proxy)ãobject.getownpropertysymbols(proxy)ãobject.keys(proxy)ãfor...inå¾ªç¯ï¼è¿åä¸ä¸ªæ°ç»ãè¯¥æ¹æ³è¿åç®æ å¯¹è±¡ææèªèº«çå±æ§çå±æ§åï¼èobject.keys()çè¿åç»æä»åæ¬ç®æ å¯¹è±¡èªèº«çå¯éåå±æ§ã\n * getownpropertydescriptor(target, propkey)ï¼æ¦æªobject.getownpropertydescriptor(proxy, propkey)ï¼è¿åå±æ§çæè¿°å¯¹è±¡ã\n * defineproperty(target, propkey, propdesc)ï¼æ¦æªobject.defineproperty(proxy, propkey, propdescï¼ãobject.defineproperties(proxy, propdescs)ï¼è¿åä¸ä¸ªå¸å°å¼ã\n * preventextensions(target)ï¼æ¦æªobject.preventextensions(proxy)ï¼è¿åä¸ä¸ªå¸å°å¼ã\n * getprototypeof(target)ï¼æ¦æªobject.getprototypeof(proxy)ï¼è¿åä¸ä¸ªå¯¹è±¡ã\n * isextensible(target)ï¼æ¦æªobject.isextensible(proxy)ï¼è¿åä¸ä¸ªå¸å°å¼ã\n * setprototypeof(target, proto)ï¼æ¦æªobject.setprototypeof(proxy, proto)ï¼è¿åä¸ä¸ªå¸å°å¼ãå¦æç®æ å¯¹è±¡æ¯å½æ°ï¼é£ä¹è¿æä¸¤ç§é¢å¤æä½å¯ä»¥æ¦æªã\n * apply(target, object, args)ï¼æ¦æª proxy å®ä¾ä½ä¸ºå½æ°è°ç¨çæä½ï¼æ¯å¦proxy(...args)ãproxy.call(object, ...args)ãproxy.apply(...)ã\n * construct(target, args)ï¼æ¦æª proxy å®ä¾ä½ä¸ºæé å½æ°è°ç¨çæä½ï¼æ¯å¦new proxy(...args)ã\n\n\n# proxy å®ä¾çæ¹æ³\n\nä¸é¢æ¯ä¸é¢è¿äºæ¦æªæ¹æ³çè¯¦ç»ä»ç»ã\n\n\n# get()\n\ngetæ¹æ³ç¨äºæ¦æªæä¸ªå±æ§çè¯»åæä½ï¼å¯ä»¥æ¥åä¸ä¸ªåæ°ï¼ä¾æ¬¡ä¸ºç®æ å¯¹è±¡ãå±æ§åå proxy å®ä¾æ¬èº«ï¼ä¸¥æ ¼å°è¯´ï¼æ¯æä½è¡ä¸ºæéå¯¹çå¯¹è±¡ï¼ï¼å¶ä¸­æåä¸ä¸ªåæ°å¯éã\n\ngetæ¹æ³çç¨æ³ï¼ä¸æå·²ç»æä¸ä¸ªä¾å­ï¼ä¸é¢æ¯å¦ä¸ä¸ªæ¦æªè¯»åæä½çä¾å­ã\n\nvar person = {\n  name: \"å¼ ä¸\"\n};\n\nvar proxy = new proxy(person, {\n  get: function(target, propkey) {\n    if (propkey in target) {\n      return target[propkey];\n    } else {\n      throw new referenceerror(\"prop name \\\"\" + propkey + \"\\\" does not exist.\");\n    }\n  }\n});\n\nproxy.name // \"å¼ ä¸\"\nproxy.age // æåºä¸ä¸ªéè¯¯\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼å¦æè®¿é®ç®æ å¯¹è±¡ä¸å­å¨çå±æ§ï¼ä¼æåºä¸ä¸ªéè¯¯ãå¦ææ²¡æè¿ä¸ªæ¦æªå½æ°ï¼è®¿é®ä¸å­å¨çå±æ§ï¼åªä¼è¿åundefinedã\n\ngetæ¹æ³å¯ä»¥ç»§æ¿ã\n\nlet proto = new proxy({}, {\n  get(target, propertykey, receiver) {\n    console.log('get ' + propertykey);\n    return target[propertykey];\n  }\n});\n\nlet obj = object.create(proto);\nobj.foo // \"get foo\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¦æªæä½å®ä¹å¨prototypeå¯¹è±¡ä¸é¢ï¼æä»¥å¦æè¯»åobjå¯¹è±¡ç»§æ¿çå±æ§æ¶ï¼æ¦æªä¼çæã\n\nä¸é¢çä¾å­ä½¿ç¨getæ¦æªï¼å®ç°æ°ç»è¯»åè´æ°çç´¢å¼ã\n\nfunction createarray(...elements) {\n  let handler = {\n    get(target, propkey, receiver) {\n      let index = number(propkey);\n      if (index < 0) {\n        propkey = string(target.length + index);\n      }\n      return reflect.get(target, propkey, receiver);\n    }\n  };\n\n  let target = [];\n  target.push(...elements);\n  return new proxy(target, handler);\n}\n\nlet arr = createarray('a', 'b', 'c');\narr[-1] // c\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»çä½ç½®åæ°æ¯-1ï¼å°±ä¼è¾åºæ°ç»çåæ°ç¬¬ä¸ä¸ªæåã\n\nå©ç¨ proxyï¼å¯ä»¥å°è¯»åå±æ§çæä½ï¼getï¼ï¼è½¬åä¸ºæ§è¡æä¸ªå½æ°ï¼ä»èå®ç°å±æ§çé¾å¼æä½ã\n\nvar pipe = (function () {\n  return function (value) {\n    var funcstack = [];\n    var oproxy = new proxy({} , {\n      get : function (pipeobject, fnname) {\n        if (fnname === 'get') {\n          return funcstack.reduce(function (val, fn) {\n            return fn(val);\n          },value);\n        }\n        funcstack.push(window[fnname]);\n        return oproxy;\n      }\n    });\n\n    return oproxy;\n  }\n}());\n\nvar double = n => n * 2;\nvar pow    = n => n * n;\nvar reverseint = n => n.tostring().split(\"\").reverse().join(\"\") | 0;\n\npipe(3).double.pow.reverseint.get; // 63\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nä¸é¢ä»£ç è®¾ç½® proxy ä»¥åï¼è¾¾å°äºå°å½æ°åé¾å¼ä½¿ç¨çææã\n\nä¸é¢çä¾å­åæ¯å©ç¨getæ¦æªï¼å®ç°ä¸ä¸ªçæåç§ dom èç¹çéç¨å½æ°domã\n\nconst dom = new proxy({}, {\n  get(target, property) {\n    return function(attrs = {}, ...children) {\n      const el = document.createelement(property);\n      for (let prop of object.keys(attrs)) {\n        el.setattribute(prop, attrs[prop]);\n      }\n      for (let child of children) {\n        if (typeof child === 'string') {\n          child = document.createtextnode(child);\n        }\n        el.appendchild(child);\n      }\n      return el;\n    }\n  }\n});\n\nconst el = dom.div({},\n  'hello, my name is ',\n  dom.a({href: '//example.com'}, 'mark'),\n  '. i like:',\n  dom.ul({},\n    dom.li({}, 'the web'),\n    dom.li({}, 'food'),\n    dom.li({}, 'â¦actually that\\'s it')\n  )\n);\n\ndocument.body.appendchild(el);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\nä¸é¢æ¯ä¸ä¸ªgetæ¹æ³çç¬¬ä¸ä¸ªåæ°çä¾å­ï¼å®æ»æ¯æååå§çè¯»æä½æå¨çé£ä¸ªå¯¹è±¡ï¼ä¸è¬æåµä¸å°±æ¯ proxy å®ä¾ã\n\nconst proxy = new proxy({}, {\n  get: function(target, key, receiver) {\n    return receiver;\n  }\n});\nproxy.getreceiver === proxy // true\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼proxyå¯¹è±¡çgetreceiverå±æ§æ¯ç±proxyå¯¹è±¡æä¾çï¼æä»¥receiveræåproxyå¯¹è±¡ã\n\nconst proxy = new proxy({}, {\n  get: function(target, key, receiver) {\n    return receiver;\n  }\n});\n\nconst d = object.create(proxy);\nd.a === d // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼då¯¹è±¡æ¬èº«æ²¡æaå±æ§ï¼æä»¥è¯»åd.açæ¶åï¼ä¼å»dçååproxyå¯¹è±¡æ¾ãè¿æ¶ï¼receiverå°±æådï¼ä»£è¡¨åå§çè¯»æä½æå¨çé£ä¸ªå¯¹è±¡ã\n\nå¦æä¸ä¸ªå±æ§ä¸å¯éç½®ï¼configurableï¼ä¸ä¸å¯åï¼writableï¼ï¼å proxy ä¸è½ä¿®æ¹è¯¥å±æ§ï¼å¦åéè¿ proxy å¯¹è±¡è®¿é®è¯¥å±æ§ä¼æ¥éã\n\nconst target = object.defineproperties({}, {\n  foo: {\n    value: 123,\n    writable: false,\n    configurable: false\n  },\n});\n\nconst handler = {\n  get(target, propkey) {\n    return 'abc';\n  }\n};\n\nconst proxy = new proxy(target, handler);\n\nproxy.foo\n// typeerror: invariant check failed\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n# set()\n\nsetæ¹æ³ç¨æ¥æ¦æªæä¸ªå±æ§çèµå¼æä½ï¼å¯ä»¥æ¥ååä¸ªåæ°ï¼ä¾æ¬¡ä¸ºç®æ å¯¹è±¡ãå±æ§åãå±æ§å¼å proxy å®ä¾æ¬èº«ï¼å¶ä¸­æåä¸ä¸ªåæ°å¯éã\n\nåå®personå¯¹è±¡æä¸ä¸ªageå±æ§ï¼è¯¥å±æ§åºè¯¥æ¯ä¸ä¸ªä¸å¤§äº 200 çæ´æ°ï¼é£ä¹å¯ä»¥ä½¿ç¨proxyä¿è¯ageçå±æ§å¼ç¬¦åè¦æ±ã\n\nlet validator = {\n  set: function(obj, prop, value) {\n    if (prop === 'age') {\n      if (!number.isinteger(value)) {\n        throw new typeerror('the age is not an integer');\n      }\n      if (value > 200) {\n        throw new rangeerror('the age seems invalid');\n      }\n    }\n\n    // å¯¹äºæ»¡è¶³æ¡ä»¶ç age å±æ§ä»¥åå¶ä»å±æ§ï¼ç´æ¥ä¿å­\n    obj[prop] = value;\n  }\n};\n\nlet person = new proxy({}, validator);\n\nperson.age = 100;\n\nperson.age // 100\nperson.age = 'young' // æ¥é\nperson.age = 300 // æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºè®¾ç½®äºå­å¼å½æ°setï¼ä»»ä½ä¸ç¬¦åè¦æ±çageå±æ§èµå¼ï¼é½ä¼æåºä¸ä¸ªéè¯¯ï¼è¿æ¯æ°æ®éªè¯çä¸ç§å®ç°æ¹æ³ãå©ç¨setæ¹æ³ï¼è¿å¯ä»¥æ°æ®ç»å®ï¼å³æ¯å½å¯¹è±¡åçååæ¶ï¼ä¼èªå¨æ´æ° domã\n\nææ¶ï¼æä»¬ä¼å¨å¯¹è±¡ä¸é¢è®¾ç½®åé¨å±æ§ï¼å±æ§åçç¬¬ä¸ä¸ªå­ç¬¦ä½¿ç¨ä¸åçº¿å¼å¤´ï¼è¡¨ç¤ºè¿äºå±æ§ä¸åºè¯¥è¢«å¤é¨ä½¿ç¨ãç»ågetåsetæ¹æ³ï¼å°±å¯ä»¥åå°é²æ­¢è¿äºåé¨å±æ§è¢«å¤é¨è¯»åã\n\nconst handler = {\n  get (target, key) {\n    invariant(key, 'get');\n    return target[key];\n  },\n  set (target, key, value) {\n    invariant(key, 'set');\n    target[key] = value;\n    return true;\n  }\n};\nfunction invariant (key, action) {\n  if (key[0] === '_') {\n    throw new error(`invalid attempt to ${action} private \"${key}\" property`);\n  }\n}\nconst target = {};\nconst proxy = new proxy(target, handler);\nproxy._prop\n// error: invalid attempt to get private \"_prop\" property\nproxy._prop = 'c'\n// error: invalid attempt to set private \"_prop\" property\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\nä¸é¢ä»£ç ä¸­ï¼åªè¦è¯»åçå±æ§åçç¬¬ä¸ä¸ªå­ç¬¦æ¯ä¸åçº¿ï¼ä¸å¾æéï¼ä»èè¾¾å°ç¦æ­¢è¯»ååé¨å±æ§çç®çã\n\nä¸é¢æ¯setæ¹æ³ç¬¬åä¸ªåæ°çä¾å­ã\n\nconst handler = {\n  set: function(obj, prop, value, receiver) {\n    obj[prop] = receiver;\n  }\n};\nconst proxy = new proxy({}, handler);\nproxy.foo = 'bar';\nproxy.foo === proxy // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼setæ¹æ³çç¬¬åä¸ªåæ°receiverï¼æçæ¯åå§çæä½è¡ä¸ºæå¨çé£ä¸ªå¯¹è±¡ï¼ä¸è¬æåµä¸æ¯proxyå®ä¾æ¬èº«ï¼è¯·çä¸é¢çä¾å­ã\n\nconst handler = {\n  set: function(obj, prop, value, receiver) {\n    obj[prop] = receiver;\n  }\n};\nconst proxy = new proxy({}, handler);\nconst myobj = {};\nobject.setprototypeof(myobj, proxy);\n\nmyobj.foo = 'bar';\nmyobj.foo === myobj // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼è®¾ç½®myobj.fooå±æ§çå¼æ¶ï¼myobjå¹¶æ²¡æfooå±æ§ï¼å æ­¤å¼æä¼å°myobjçååé¾å»æ¾fooå±æ§ãmyobjçååå¯¹è±¡proxyæ¯ä¸ä¸ª proxy å®ä¾ï¼è®¾ç½®å®çfooå±æ§ä¼è§¦åsetæ¹æ³ãè¿æ¶ï¼ç¬¬åä¸ªåæ°receiverå°±æååå§èµå¼è¡ä¸ºæå¨çå¯¹è±¡myobjã\n\næ³¨æï¼å¦æç®æ å¯¹è±¡èªèº«çæä¸ªå±æ§ï¼ä¸å¯åä¸ä¸å¯éç½®ï¼é£ä¹setæ¹æ³å°ä¸èµ·ä½ç¨ã\n\nconst obj = {};\nobject.defineproperty(obj, 'foo', {\n  value: 'bar',\n  writable: false,\n});\n\nconst handler = {\n  set: function(obj, prop, value, receiver) {\n    obj[prop] = 'baz';\n  }\n};\n\nconst proxy = new proxy(obj, handler);\nproxy.foo = 'baz';\nproxy.foo // \"bar\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼obj.fooå±æ§ä¸å¯åï¼proxy å¯¹è¿ä¸ªå±æ§çsetä»£çå°ä¸ä¼çæã\n\næ³¨æï¼ä¸¥æ ¼æ¨¡å¼ä¸ï¼setä»£çå¦ææ²¡æè¿åtrueï¼å°±ä¼æ¥éã\n\n'use strict';\nconst handler = {\n  set: function(obj, prop, value, receiver) {\n    obj[prop] = receiver;\n    // æ è®ºææ²¡æä¸é¢è¿ä¸è¡ï¼é½ä¼æ¥é\n    return false;\n  }\n};\nconst proxy = new proxy({}, handler);\nproxy.foo = 'bar';\n// typeerror: 'set' on proxy: trap returned falsish for property 'foo'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸¥æ ¼æ¨¡å¼ä¸ï¼setä»£çè¿åfalseæèundefinedï¼é½ä¼æ¥éã\n\n\n# apply()\n\napplyæ¹æ³æ¦æªå½æ°çè°ç¨ãcallåapplyæä½ã\n\napplyæ¹æ³å¯ä»¥æ¥åä¸ä¸ªåæ°ï¼åå«æ¯ç®æ å¯¹è±¡ãç®æ å¯¹è±¡çä¸ä¸æå¯¹è±¡ï¼thisï¼åç®æ å¯¹è±¡çåæ°æ°ç»ã\n\nvar handler = {\n  apply (target, ctx, args) {\n    return reflect.apply(...arguments);\n  }\n};\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nvar target = function () { return 'i am the target'; };\nvar handler = {\n  apply: function () {\n    return 'i am the proxy';\n  }\n};\n\nvar p = new proxy(target, handler);\n\np()\n// \"i am the proxy\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼åépæ¯ proxy çå®ä¾ï¼å½å®ä½ä¸ºå½æ°è°ç¨æ¶ï¼p()ï¼ï¼å°±ä¼è¢«applyæ¹æ³æ¦æªï¼è¿åä¸ä¸ªå­ç¬¦ä¸²ã\n\nä¸é¢æ¯å¦å¤ä¸ä¸ªä¾å­ã\n\nvar twice = {\n  apply (target, ctx, args) {\n    return reflect.apply(...arguments) * 2;\n  }\n};\nfunction sum (left, right) {\n  return left + right;\n};\nvar proxy = new proxy(sum, twice);\nproxy(1, 2) // 6\nproxy.call(null, 5, 6) // 22\nproxy.apply(null, [7, 8]) // 30\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¯å½æ§è¡proxyå½æ°ï¼ç´æ¥è°ç¨æcallåapplyè°ç¨ï¼ï¼å°±ä¼è¢«applyæ¹æ³æ¦æªã\n\nå¦å¤ï¼ç´æ¥è°ç¨reflect.applyæ¹æ³ï¼ä¹ä¼è¢«æ¦æªã\n\nreflect.apply(proxy, null, [9, 10]) // 38\n\n\n1\n\n\n\n# has()\n\nhasæ¹æ³ç¨æ¥æ¦æªhaspropertyæä½ï¼å³å¤æ­å¯¹è±¡æ¯å¦å·ææä¸ªå±æ§æ¶ï¼è¿ä¸ªæ¹æ³ä¼çæãå¸åçæä½å°±æ¯inè¿ç®ç¬¦ã\n\nhasæ¹æ³å¯ä»¥æ¥åä¸¤ä¸ªåæ°ï¼åå«æ¯ç®æ å¯¹è±¡ãéæ¥è¯¢çå±æ§åã\n\nä¸é¢çä¾å­ä½¿ç¨hasæ¹æ³éèæäºå±æ§ï¼ä¸è¢«inè¿ç®ç¬¦åç°ã\n\nvar handler = {\n  has (target, key) {\n    if (key[0] === '_') {\n      return false;\n    }\n    return key in target;\n  }\n};\nvar target = { _prop: 'foo', prop: 'foo' };\nvar proxy = new proxy(target, handler);\n'_prop' in proxy // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æåå¯¹è±¡çå±æ§åçç¬¬ä¸ä¸ªå­ç¬¦æ¯ä¸åçº¿ï¼proxy.haså°±ä¼è¿åfalseï¼ä»èä¸ä¼è¢«inè¿ç®ç¬¦åç°ã\n\nå¦æåå¯¹è±¡ä¸å¯éç½®æèç¦æ­¢æ©å±ï¼è¿æ¶hasæ¦æªä¼æ¥éã\n\nvar obj = { a: 10 };\nobject.preventextensions(obj);\n\nvar p = new proxy(obj, {\n  has: function(target, prop) {\n    return false;\n  }\n});\n\n'a' in p // typeerror is thrown\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼objå¯¹è±¡ç¦æ­¢æ©å±ï¼ç»æä½¿ç¨hasæ¦æªå°±ä¼æ¥éãä¹å°±æ¯è¯´ï¼å¦ææä¸ªå±æ§ä¸å¯éç½®ï¼æèç®æ å¯¹è±¡ä¸å¯æ©å±ï¼ï¼åhasæ¹æ³å°±ä¸å¾âéèâï¼å³è¿åfalseï¼ç®æ å¯¹è±¡çè¯¥å±æ§ã\n\nå¼å¾æ³¨æçæ¯ï¼hasæ¹æ³æ¦æªçæ¯haspropertyæä½ï¼èä¸æ¯hasownpropertyæä½ï¼å³hasæ¹æ³ä¸å¤æ­ä¸ä¸ªå±æ§æ¯å¯¹è±¡èªèº«çå±æ§ï¼è¿æ¯ç»§æ¿çå±æ§ã\n\nå¦å¤ï¼è½ç¶for...inå¾ªç¯ä¹ç¨å°äºinè¿ç®ç¬¦ï¼ä½æ¯hasæ¦æªå¯¹for...inå¾ªç¯ä¸çæã\n\nlet stu1 = {name: 'å¼ ä¸', score: 59};\nlet stu2 = {name: 'æå', score: 99};\n\nlet handler = {\n  has(target, prop) {\n    if (prop === 'score' && target[prop] < 60) {\n      console.log(`${target.name} ä¸åæ ¼`);\n      return false;\n    }\n    return prop in target;\n  }\n}\n\nlet oproxy1 = new proxy(stu1, handler);\nlet oproxy2 = new proxy(stu2, handler);\n\n'score' in oproxy1\n// å¼ ä¸ ä¸åæ ¼\n// false\n\n'score' in oproxy2\n// true\n\nfor (let a in oproxy1) {\n  console.log(oproxy1[a]);\n}\n// å¼ ä¸\n// 59\n\nfor (let b in oproxy2) {\n  console.log(oproxy2[b]);\n}\n// æå\n// 99\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n\n\nä¸é¢ä»£ç ä¸­ï¼hasæ¦æªåªå¯¹inè¿ç®ç¬¦çæï¼å¯¹for...inå¾ªç¯ä¸çæï¼å¯¼è´ä¸ç¬¦åè¦æ±çå±æ§æ²¡æè¢«for...inå¾ªç¯ææé¤ã\n\n\n# construct()\n\nconstructæ¹æ³ç¨äºæ¦æªnewå½ä»¤ï¼ä¸é¢æ¯æ¦æªå¯¹è±¡çåæ³ã\n\nvar handler = {\n  construct (target, args, newtarget) {\n    return new target(...args);\n  }\n};\n\n\n1\n2\n3\n4\n5\n\n\nconstructæ¹æ³å¯ä»¥æ¥åä¸¤ä¸ªåæ°ã\n\n * targetï¼ç®æ å¯¹è±¡\n * argsï¼æé å½æ°çåæ°å¯¹è±¡\n * newtargetï¼åé å®ä¾å¯¹è±¡æ¶ï¼newå½ä»¤ä½ç¨çæé å½æ°ï¼ä¸é¢ä¾å­çpï¼\n\nvar p = new proxy(function () {}, {\n  construct: function(target, args) {\n    console.log('called: ' + args.join(', '));\n    return { value: args[0] * 10 };\n  }\n});\n\n(new p(1)).value\n// \"called: 1\"\n// 10\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nconstructæ¹æ³è¿åçå¿é¡»æ¯ä¸ä¸ªå¯¹è±¡ï¼å¦åä¼æ¥éã\n\nvar p = new proxy(function() {}, {\n  construct: function(target, argumentslist) {\n    return 1;\n  }\n});\n\nnew p() // æ¥é\n// uncaught typeerror: 'construct' on proxy: trap returned non-object ('1')\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# deleteproperty()\n\ndeletepropertyæ¹æ³ç¨äºæ¦æªdeleteæä½ï¼å¦æè¿ä¸ªæ¹æ³æåºéè¯¯æèè¿åfalseï¼å½åå±æ§å°±æ æ³è¢«deleteå½ä»¤å é¤ã\n\nvar handler = {\n  deleteproperty (target, key) {\n    invariant(key, 'delete');\n    delete target[key];\n    return true;\n  }\n};\nfunction invariant (key, action) {\n  if (key[0] === '_') {\n    throw new error(`invalid attempt to ${action} private \"${key}\" property`);\n  }\n}\n\nvar target = { _prop: 'foo' };\nvar proxy = new proxy(target, handler);\ndelete proxy._prop\n// error: invalid attempt to delete private \"_prop\" property\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼deletepropertyæ¹æ³æ¦æªäºdeleteæä½ç¬¦ï¼å é¤ç¬¬ä¸ä¸ªå­ç¬¦ä¸ºä¸åçº¿çå±æ§ä¼æ¥éã\n\næ³¨æï¼ç®æ å¯¹è±¡èªèº«çä¸å¯éç½®ï¼configurableï¼çå±æ§ï¼ä¸è½è¢«deletepropertyæ¹æ³å é¤ï¼å¦åæ¥éã\n\n\n# defineproperty()\n\ndefinepropertyæ¹æ³æ¦æªäºobject.definepropertyæä½ã\n\nvar handler = {\n  defineproperty (target, key, descriptor) {\n    return false;\n  }\n};\nvar target = {};\nvar proxy = new proxy(target, handler);\nproxy.foo = 'bar' // ä¸ä¼çæ\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼definepropertyæ¹æ³è¿åfalseï¼å¯¼è´æ·»å æ°å±æ§æ»æ¯æ æã\n\næ³¨æï¼å¦æç®æ å¯¹è±¡ä¸å¯æ©å±ï¼non-extensibleï¼ï¼ådefinepropertyä¸è½å¢å ç®æ å¯¹è±¡ä¸ä¸å­å¨çå±æ§ï¼å¦åä¼æ¥éãå¦å¤ï¼å¦æç®æ å¯¹è±¡çæä¸ªå±æ§ä¸å¯åï¼writableï¼æä¸å¯éç½®ï¼configurableï¼ï¼ådefinepropertyæ¹æ³ä¸å¾æ¹åè¿ä¸¤ä¸ªè®¾ç½®ã\n\n\n# getownpropertydescriptor()\n\ngetownpropertydescriptoræ¹æ³æ¦æªobject.getownpropertydescriptor()ï¼è¿åä¸ä¸ªå±æ§æè¿°å¯¹è±¡æèundefinedã\n\nvar handler = {\n  getownpropertydescriptor (target, key) {\n    if (key[0] === '_') {\n      return;\n    }\n    return object.getownpropertydescriptor(target, key);\n  }\n};\nvar target = { _foo: 'bar', baz: 'tar' };\nvar proxy = new proxy(target, handler);\nobject.getownpropertydescriptor(proxy, 'wat')\n// undefined\nobject.getownpropertydescriptor(proxy, '_foo')\n// undefined\nobject.getownpropertydescriptor(proxy, 'baz')\n// { value: 'tar', writable: true, enumerable: true, configurable: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼handler.getownpropertydescriptoræ¹æ³å¯¹äºç¬¬ä¸ä¸ªå­ç¬¦ä¸ºä¸åçº¿çå±æ§åä¼è¿åundefinedã\n\n\n# getprototypeof()\n\ngetprototypeofæ¹æ³ä¸»è¦ç¨æ¥æ¦æªè·åå¯¹è±¡ååãå·ä½æ¥è¯´ï¼æ¦æªä¸é¢è¿äºæä½ã\n\n * object.prototype.__proto__\n * object.prototype.isprototypeof()\n * object.getprototypeof()\n * reflect.getprototypeof()\n * instanceof\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nvar proto = {};\nvar p = new proxy({}, {\n  getprototypeof(target) {\n    return proto;\n  }\n});\nobject.getprototypeof(p) === proto // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼getprototypeofæ¹æ³æ¦æªobject.getprototypeof()ï¼è¿åprotoå¯¹è±¡ã\n\næ³¨æï¼getprototypeofæ¹æ³çè¿åå¼å¿é¡»æ¯å¯¹è±¡æènullï¼å¦åæ¥éãå¦å¤ï¼å¦æç®æ å¯¹è±¡ä¸å¯æ©å±ï¼non-extensibleï¼ï¼ getprototypeofæ¹æ³å¿é¡»è¿åç®æ å¯¹è±¡çååå¯¹è±¡ã\n\n\n# isextensible()\n\nisextensibleæ¹æ³æ¦æªobject.isextensibleæä½ã\n\nvar p = new proxy({}, {\n  isextensible: function(target) {\n    console.log(\"called\");\n    return true;\n  }\n});\n\nobject.isextensible(p)\n// \"called\"\n// true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç è®¾ç½®äºisextensibleæ¹æ³ï¼å¨è°ç¨object.isextensibleæ¶ä¼è¾åºcalledã\n\næ³¨æï¼è¯¥æ¹æ³åªè½è¿åå¸å°å¼ï¼å¦åè¿åå¼ä¼è¢«èªå¨è½¬ä¸ºå¸å°å¼ã\n\nè¿ä¸ªæ¹æ³æä¸ä¸ªå¼ºéå¶ï¼å®çè¿åå¼å¿é¡»ä¸ç®æ å¯¹è±¡çisextensibleå±æ§ä¿æä¸è´ï¼å¦åå°±ä¼æåºéè¯¯ã\n\nobject.isextensible(proxy) === object.isextensible(target)\n\n\n1\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nvar p = new proxy({}, {\n  isextensible: function(target) {\n    return false;\n  }\n});\n\nobject.isextensible(p)\n// uncaught typeerror: 'isextensible' on proxy: trap result does not reflect extensibility of proxy target (which is 'true')\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# ownkeys()\n\nownkeysæ¹æ³ç¨æ¥æ¦æªå¯¹è±¡èªèº«å±æ§çè¯»åæä½ãå·ä½æ¥è¯´ï¼æ¦æªä»¥ä¸æä½ã\n\n * object.getownpropertynames()\n * object.getownpropertysymbols()\n * object.keys()\n * for...inå¾ªç¯\n\nä¸é¢æ¯æ¦æªobject.keys()çä¾å­ã\n\nlet target = {\n  a: 1,\n  b: 2,\n  c: 3\n};\n\nlet handler = {\n  ownkeys(target) {\n    return ['a'];\n  }\n};\n\nlet proxy = new proxy(target, handler);\n\nobject.keys(proxy)\n// [ 'a' ]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç æ¦æªäºå¯¹äºtargetå¯¹è±¡çobject.keys()æä½ï¼åªè¿åaãbãcä¸ä¸ªå±æ§ä¹ä¸­çaå±æ§ã\n\nä¸é¢çä¾å­æ¯æ¦æªç¬¬ä¸ä¸ªå­ç¬¦ä¸ºä¸åçº¿çå±æ§åã\n\nlet target = {\n  _bar: 'foo',\n  _prop: 'bar',\n  prop: 'baz'\n};\n\nlet handler = {\n  ownkeys (target) {\n    return reflect.ownkeys(target).filter(key => key[0] !== '_');\n  }\n};\n\nlet proxy = new proxy(target, handler);\nfor (let key of object.keys(proxy)) {\n  console.log(target[key]);\n}\n// \"baz\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\næ³¨æï¼ä½¿ç¨object.keysæ¹æ³æ¶ï¼æä¸ç±»å±æ§ä¼è¢«ownkeysæ¹æ³èªå¨è¿æ»¤ï¼ä¸ä¼è¿åã\n\n * ç®æ å¯¹è±¡ä¸ä¸å­å¨çå±æ§\n * å±æ§åä¸º symbol å¼\n * ä¸å¯éåï¼enumerableï¼çå±æ§\n\nlet target = {\n  a: 1,\n  b: 2,\n  c: 3,\n  [symbol.for('secret')]: '4',\n};\n\nobject.defineproperty(target, 'key', {\n  enumerable: false,\n  configurable: true,\n  writable: true,\n  value: 'static'\n});\n\nlet handler = {\n  ownkeys(target) {\n    return ['a', 'd', symbol.for('secret'), 'key'];\n  }\n};\n\nlet proxy = new proxy(target, handler);\n\nobject.keys(proxy)\n// ['a']\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nä¸é¢ä»£ç ä¸­ï¼ownkeysæ¹æ³ä¹ä¸­ï¼æ¾å¼è¿åä¸å­å¨çå±æ§ï¼dï¼ãsymbol å¼ï¼symbol.for('secret')ï¼ãä¸å¯éåçå±æ§ï¼keyï¼ï¼ç»æé½è¢«èªå¨è¿æ»¤æã\n\nownkeysæ¹æ³è¿å¯ä»¥æ¦æªobject.getownpropertynames()ã\n\nvar p = new proxy({}, {\n  ownkeys: function(target) {\n    return ['a', 'b', 'c'];\n  }\n});\n\nobject.getownpropertynames(p)\n// [ 'a', 'b', 'c' ]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nfor...inå¾ªç¯ä¹åå°ownkeysæ¹æ³çæ¦æªã\n\nconst obj = { hello: 'world' };\nconst proxy = new proxy(obj, {\n  ownkeys: function () {\n    return ['a', 'b'];\n  }\n});\n\nfor (let key in proxy) {\n  console.log(key); // æ²¡æä»»ä½è¾åº\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼ownkeysæå®åªè¿åaåbå±æ§ï¼ç±äºobjæ²¡æè¿ä¸¤ä¸ªå±æ§ï¼å æ­¤for...inå¾ªç¯ä¸ä¼æä»»ä½è¾åºã\n\nownkeysæ¹æ³è¿åçæ°ç»æåï¼åªè½æ¯å­ç¬¦ä¸²æ symbol å¼ãå¦ææå¶ä»ç±»åçå¼ï¼æèè¿åçæ ¹æ¬ä¸æ¯æ°ç»ï¼å°±ä¼æ¥éã\n\nvar obj = {};\n\nvar p = new proxy(obj, {\n  ownkeys: function(target) {\n    return [123, true, undefined, null, {}, []];\n  }\n});\n\nobject.getownpropertynames(p)\n// uncaught typeerror: 123 is not a valid property name\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼ownkeysæ¹æ³è½ç¶è¿åä¸ä¸ªæ°ç»ï¼ä½æ¯æ¯ä¸ä¸ªæ°ç»æåé½ä¸æ¯å­ç¬¦ä¸²æ symbol å¼ï¼å æ­¤å°±æ¥éäºã\n\nå¦æç®æ å¯¹è±¡èªèº«åå«ä¸å¯éç½®çå±æ§ï¼åè¯¥å±æ§å¿é¡»è¢«ownkeysæ¹æ³è¿åï¼å¦åæ¥éã\n\nvar obj = {};\nobject.defineproperty(obj, 'a', {\n  configurable: false,\n  enumerable: true,\n  value: 10 }\n);\n\nvar p = new proxy(obj, {\n  ownkeys: function(target) {\n    return ['b'];\n  }\n});\n\nobject.getownpropertynames(p)\n// uncaught typeerror: 'ownkeys' on proxy: trap result did not include 'a'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼objå¯¹è±¡çaå±æ§æ¯ä¸å¯éç½®çï¼è¿æ¶ownkeysæ¹æ³è¿åçæ°ç»ä¹ä¸­ï¼å¿é¡»åå«aï¼å¦åä¼æ¥éã\n\nå¦å¤ï¼å¦æç®æ å¯¹è±¡æ¯ä¸å¯æ©å±çï¼non-extensibleï¼ï¼è¿æ¶ownkeysæ¹æ³è¿åçæ°ç»ä¹ä¸­ï¼å¿é¡»åå«åå¯¹è±¡çææå±æ§ï¼ä¸ä¸è½åå«å¤ä½çå±æ§ï¼å¦åæ¥éã\n\nvar obj = {\n  a: 1\n};\n\nobject.preventextensions(obj);\n\nvar p = new proxy(obj, {\n  ownkeys: function(target) {\n    return ['a', 'b'];\n  }\n});\n\nobject.getownpropertynames(p)\n// uncaught typeerror: 'ownkeys' on proxy: trap returned extra keys but proxy target is non-extensible\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼objå¯¹è±¡æ¯ä¸å¯æ©å±çï¼è¿æ¶ownkeysæ¹æ³è¿åçæ°ç»ä¹ä¸­ï¼åå«äºobjå¯¹è±¡çå¤ä½å±æ§bï¼æä»¥å¯¼è´äºæ¥éã\n\n\n# preventextensions()\n\npreventextensionsæ¹æ³æ¦æªobject.preventextensions()ãè¯¥æ¹æ³å¿é¡»è¿åä¸ä¸ªå¸å°å¼ï¼å¦åä¼è¢«èªå¨è½¬ä¸ºå¸å°å¼ã\n\nè¿ä¸ªæ¹æ³æä¸ä¸ªéå¶ï¼åªæç®æ å¯¹è±¡ä¸å¯æ©å±æ¶ï¼å³object.isextensible(proxy)ä¸ºfalseï¼ï¼proxy.preventextensionsæè½è¿åtrueï¼å¦åä¼æ¥éã\n\nvar proxy = new proxy({}, {\n  preventextensions: function(target) {\n    return true;\n  }\n});\n\nobject.preventextensions(proxy)\n// uncaught typeerror: 'preventextensions' on proxy: trap returned truish but the proxy target is extensible\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼proxy.preventextensionsæ¹æ³è¿åtrueï¼ä½è¿æ¶object.isextensible(proxy)ä¼è¿åtrueï¼å æ­¤æ¥éã\n\nä¸ºäºé²æ­¢åºç°è¿ä¸ªé®é¢ï¼éå¸¸è¦å¨proxy.preventextensionsæ¹æ³éé¢ï¼è°ç¨ä¸æ¬¡object.preventextensionsã\n\nvar proxy = new proxy({}, {\n  preventextensions: function(target) {\n    console.log('called');\n    object.preventextensions(target);\n    return true;\n  }\n});\n\nobject.preventextensions(proxy)\n// \"called\"\n// proxy {}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# setprototypeof()\n\nsetprototypeofæ¹æ³ä¸»è¦ç¨æ¥æ¦æªobject.setprototypeofæ¹æ³ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nvar handler = {\n  setprototypeof (target, proto) {\n    throw new error('changing the prototype is forbidden');\n  }\n};\nvar proto = {};\nvar target = function () {};\nvar proxy = new proxy(target, handler);\nobject.setprototypeof(proxy, proto);\n// error: changing the prototype is forbidden\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼åªè¦ä¿®æ¹targetçååå¯¹è±¡ï¼å°±ä¼æ¥éã\n\næ³¨æï¼è¯¥æ¹æ³åªè½è¿åå¸å°å¼ï¼å¦åä¼è¢«èªå¨è½¬ä¸ºå¸å°å¼ãå¦å¤ï¼å¦æç®æ å¯¹è±¡ä¸å¯æ©å±ï¼non-extensibleï¼ï¼setprototypeofæ¹æ³ä¸å¾æ¹åç®æ å¯¹è±¡çååã\n\n\n# proxy.revocable()\n\nproxy.revocableæ¹æ³è¿åä¸ä¸ªå¯åæ¶ç proxy å®ä¾ã\n\nlet target = {};\nlet handler = {};\n\nlet {proxy, revoke} = proxy.revocable(target, handler);\n\nproxy.foo = 123;\nproxy.foo // 123\n\nrevoke();\nproxy.foo // typeerror: revoked\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nproxy.revocableæ¹æ³è¿åä¸ä¸ªå¯¹è±¡ï¼è¯¥å¯¹è±¡çproxyå±æ§æ¯proxyå®ä¾ï¼revokeå±æ§æ¯ä¸ä¸ªå½æ°ï¼å¯ä»¥åæ¶proxyå®ä¾ãä¸é¢ä»£ç ä¸­ï¼å½æ§è¡revokeå½æ°ä¹åï¼åè®¿é®proxyå®ä¾ï¼å°±ä¼æåºä¸ä¸ªéè¯¯ã\n\nproxy.revocableçä¸ä¸ªä½¿ç¨åºæ¯æ¯ï¼ç®æ å¯¹è±¡ä¸åè®¸ç´æ¥è®¿é®ï¼å¿é¡»éè¿ä»£çè®¿é®ï¼ä¸æ¦è®¿é®ç»æï¼å°±æ¶åä»£çæï¼ä¸åè®¸åæ¬¡è®¿é®ã\n\n\n# this é®é¢\n\nè½ç¶ proxy å¯ä»¥ä»£çéå¯¹ç®æ å¯¹è±¡çè®¿é®ï¼ä½å®ä¸æ¯ç®æ å¯¹è±¡çéæä»£çï¼å³ä¸åä»»ä½æ¦æªçæåµä¸ï¼ä¹æ æ³ä¿è¯ä¸ç®æ å¯¹è±¡çè¡ä¸ºä¸è´ãä¸»è¦åå å°±æ¯å¨ proxy ä»£ççæåµä¸ï¼ç®æ å¯¹è±¡åé¨çthiså³é®å­ä¼æå proxy ä»£çã\n\nconst target = {\n  m: function () {\n    console.log(this === proxy);\n  }\n};\nconst handler = {};\n\nconst proxy = new proxy(target, handler);\n\ntarget.m() // false\nproxy.m()  // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸æ¦proxyä»£çtarget.mï¼åèåé¨çthiså°±æ¯æåproxyï¼èä¸æ¯targetã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ï¼ç±äºthisæåçååï¼å¯¼è´ proxy æ æ³ä»£çç®æ å¯¹è±¡ã\n\nconst _name = new weakmap();\n\nclass person {\n  constructor(name) {\n    _name.set(this, name);\n  }\n  get name() {\n    return _name.get(this);\n  }\n}\n\nconst jane = new person('jane');\njane.name // 'jane'\n\nconst proxy = new proxy(jane, {});\nproxy.name // undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼ç®æ å¯¹è±¡janeçnameå±æ§ï¼å®éä¿å­å¨å¤é¨weakmapå¯¹è±¡_nameä¸é¢ï¼éè¿thisé®åºåãç±äºéè¿proxy.nameè®¿é®æ¶ï¼thisæåproxyï¼å¯¼è´æ æ³åå°å¼ï¼æä»¥è¿åundefinedã\n\næ­¤å¤ï¼æäºåçå¯¹è±¡çåé¨å±æ§ï¼åªæéè¿æ­£ç¡®çthisæè½æ¿å°ï¼æä»¥ proxy ä¹æ æ³ä»£çè¿äºåçå¯¹è±¡çå±æ§ã\n\nconst target = new date();\nconst handler = {};\nconst proxy = new proxy(target, handler);\n\nproxy.getdate();\n// typeerror: this is not a date object.\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼getdateæ¹æ³åªè½å¨dateå¯¹è±¡å®ä¾ä¸é¢æ¿å°ï¼å¦æthisä¸æ¯dateå¯¹è±¡å®ä¾å°±ä¼æ¥éãè¿æ¶ï¼thisç»å®åå§å¯¹è±¡ï¼å°±å¯ä»¥è§£å³è¿ä¸ªé®é¢ã\n\nconst target = new date('2015-01-01');\nconst handler = {\n  get(target, prop) {\n    if (prop === 'getdate') {\n      return target.getdate.bind(target);\n    }\n    return reflect.get(target, prop);\n  }\n};\nconst proxy = new proxy(target, handler);\n\nproxy.getdate() // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n\n# å®ä¾ï¼web æå¡çå®¢æ·ç«¯\n\nproxy å¯¹è±¡å¯ä»¥æ¦æªç®æ å¯¹è±¡çä»»æå±æ§ï¼è¿ä½¿å¾å®å¾åéç¨æ¥å web æå¡çå®¢æ·ç«¯ã\n\nconst service = createwebservice('http://example.com/data');\n\nservice.employees().then(json => {\n  const employees = json.parse(json);\n  // Â·Â·Â·\n});\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç æ°å»ºäºä¸ä¸ª web æå¡çæ¥å£ï¼è¿ä¸ªæ¥å£è¿ååç§æ°æ®ãproxy å¯ä»¥æ¦æªè¿ä¸ªå¯¹è±¡çä»»æå±æ§ï¼æä»¥ä¸ç¨ä¸ºæ¯ä¸ç§æ°æ®åä¸ä¸ªééæ¹æ³ï¼åªè¦åä¸ä¸ª proxy æ¦æªå°±å¯ä»¥äºã\n\nfunction createwebservice(baseurl) {\n  return new proxy({}, {\n    get(target, propkey, receiver) {\n      return () => httpget(baseurl + '/' + propkey);\n    }\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nåçï¼proxy ä¹å¯ä»¥ç¨æ¥å®ç°æ°æ®åºç orm å±ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Generator å½æ°çè¯­æ³",frontmatter:{title:"Generator å½æ°çè¯­æ³",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/718b48ed9ce0adce",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/18.Generator%20%E5%87%BD%E6%95%B0%E7%9A%84%E8%AF%AD%E6%B3%95.html",relativePath:"ãES6 æç¨ãç¬è®°/18.Generator å½æ°çè¯­æ³.md",key:"v-20b8f620",path:"/pages/718b48ed9ce0adce/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:22},{level:3,title:"åºæ¬æ¦å¿µ",slug:"åºæ¬æ¦å¿µ",normalizedTitle:"åºæ¬æ¦å¿µ",charIndex:29},{level:3,title:"yield è¡¨è¾¾å¼",slug:"yield-è¡¨è¾¾å¼",normalizedTitle:"yield è¡¨è¾¾å¼",charIndex:2098},{level:3,title:"ä¸ Iterator æ¥å£çå³ç³»",slug:"ä¸-iterator-æ¥å£çå³ç³»",normalizedTitle:"ä¸ iterator æ¥å£çå³ç³»",charIndex:4558},{level:2,title:"next æ¹æ³çåæ°",slug:"next-æ¹æ³çåæ°",normalizedTitle:"next æ¹æ³çåæ°",charIndex:5227},{level:2,title:"for...of å¾ªç¯",slug:"for-of-å¾ªç¯",normalizedTitle:"for...of å¾ªç¯",charIndex:7662},{level:2,title:"Generator.prototype.throw()",slug:"generator-prototype-throw",normalizedTitle:"generator.prototype.throw()",charIndex:9786},{level:2,title:"Generator.prototype.return()",slug:"generator-prototype-return",normalizedTitle:"generator.prototype.return()",charIndex:14471},{level:2,title:"next()ãthrow()ãreturn() çå±åç¹",slug:"next-ãthrow-ãreturn-çå±åç¹",normalizedTitle:"next()ãthrow()ãreturn() çå±åç¹",charIndex:15733},{level:2,title:"yield* è¡¨è¾¾å¼",slug:"yield-è¡¨è¾¾å¼-2",normalizedTitle:"yield* è¡¨è¾¾å¼",charIndex:16559},{level:2,title:"ä½ä¸ºå¯¹è±¡å±æ§ç Generator å½æ°",slug:"ä½ä¸ºå¯¹è±¡å±æ§ç-generator-å½æ°",normalizedTitle:"ä½ä¸ºå¯¹è±¡å±æ§ç generator å½æ°",charIndex:21944},{level:2,title:"Generator å½æ°çthis",slug:"generator-å½æ°çthis",normalizedTitle:"generator å½æ°çthis",charIndex:22233},{level:2,title:"å«ä¹",slug:"å«ä¹",normalizedTitle:"å«ä¹",charIndex:24337},{level:3,title:"Generator ä¸ç¶ææº",slug:"generator-ä¸ç¶ææº",normalizedTitle:"generator ä¸ç¶ææº",charIndex:24344},{level:3,title:"Generator ä¸åç¨",slug:"generator-ä¸åç¨",normalizedTitle:"generator ä¸åç¨",charIndex:24942},{level:3,title:"Generator ä¸ä¸ä¸æ",slug:"generator-ä¸ä¸ä¸æ",normalizedTitle:"generator ä¸ä¸ä¸æ",charIndex:25932},{level:2,title:"åºç¨",slug:"åºç¨",normalizedTitle:"åºç¨",charIndex:115},{level:3,title:"ï¼1ï¼å¼æ­¥æä½çåæ­¥åè¡¨è¾¾",slug:"_1-å¼æ­¥æä½çåæ­¥åè¡¨è¾¾",normalizedTitle:"ï¼1ï¼å¼æ­¥æä½çåæ­¥åè¡¨è¾¾",charIndex:26639},{level:3,title:"ï¼2ï¼æ§å¶æµç®¡ç",slug:"_2-æ§å¶æµç®¡ç",normalizedTitle:"ï¼2ï¼æ§å¶æµç®¡ç",charIndex:27994},{level:3,title:"ï¼3ï¼é¨ç½² Iterator æ¥å£",slug:"_3-é¨ç½²-iterator-æ¥å£",normalizedTitle:"ï¼3ï¼é¨ç½² iterator æ¥å£",charIndex:30267},{level:3,title:"ï¼4ï¼ä½ä¸ºæ°æ®ç»æ",slug:"_4-ä½ä¸ºæ°æ®ç»æ",normalizedTitle:"ï¼4ï¼ä½ä¸ºæ°æ®ç»æ",charIndex:31061}],excerpt:'<h1 id="generator-å½æ°çè¯­æ³"><a class="header-anchor" href="#generator-å½æ°çè¯­æ³">#</a> Generator å½æ°çè¯­æ³</h1>\n<h2 id="ç®ä»"><a class="header-anchor" href="#ç®ä»">#</a> ç®ä»</h2>\n<h3 id="åºæ¬æ¦å¿µ"><a class="header-anchor" href="#åºæ¬æ¦å¿µ">#</a> åºæ¬æ¦å¿µ</h3>\n<p>Generator å½æ°æ¯ ES6 æä¾çä¸ç§<strong>å¼æ­¥ç¼ç¨è§£å³æ¹æ¡</strong>ï¼è¯­æ³è¡ä¸ºä¸ä¼ ç»å½æ°å®å¨ä¸åãæ¬ç« è¯¦ç»ä»ç» Generator å½æ°çè¯­æ³å APIï¼å®çå¼æ­¥ç¼ç¨åºç¨è¯·çãGenerator å½æ°çå¼æ­¥åºç¨ãä¸ç« ã</p>\n',headersStr:"ç®ä» åºæ¬æ¦å¿µ yield è¡¨è¾¾å¼ ä¸ Iterator æ¥å£çå³ç³» next æ¹æ³çåæ° for...of å¾ªç¯ Generator.prototype.throw() Generator.prototype.return() next()ãthrow()ãreturn() çå±åç¹ yield* è¡¨è¾¾å¼ ä½ä¸ºå¯¹è±¡å±æ§ç Generator å½æ° Generator å½æ°çthis å«ä¹ Generator ä¸ç¶ææº Generator ä¸åç¨ Generator ä¸ä¸ä¸æ åºç¨ ï¼1ï¼å¼æ­¥æä½çåæ­¥åè¡¨è¾¾ ï¼2ï¼æ§å¶æµç®¡ç ï¼3ï¼é¨ç½² Iterator æ¥å£ ï¼4ï¼ä½ä¸ºæ°æ®ç»æ",content:"# Generator å½æ°çè¯­æ³\n\n\n# ç®ä»\n\n\n# åºæ¬æ¦å¿µ\n\nGenerator å½æ°æ¯ ES6 æä¾çä¸ç§å¼æ­¥ç¼ç¨è§£å³æ¹æ¡ï¼è¯­æ³è¡ä¸ºä¸ä¼ ç»å½æ°å®å¨ä¸åãæ¬ç« è¯¦ç»ä»ç» Generator å½æ°çè¯­æ³å APIï¼å®çå¼æ­¥ç¼ç¨åºç¨è¯·çãGenerator å½æ°çå¼æ­¥åºç¨ãä¸ç« ã Generator å½æ°æå¤ç§çè§£è§åº¦ãè¯­æ³ä¸ï¼é¦åå¯ä»¥æå®çè§£æï¼Generator å½æ°æ¯ä¸ä¸ªç¶ææºï¼å°è£äºå¤ä¸ªåé¨ç¶æã\n\næ§è¡ Generator å½æ°ä¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼ä¹å°±æ¯è¯´ï¼Generator å½æ°é¤äºç¶ææºï¼è¿æ¯ä¸ä¸ªéåå¨å¯¹è±¡çæå½æ°ãè¿åçéåå¨å¯¹è±¡ï¼å¯ä»¥ä¾æ¬¡éå Generator å½æ°åé¨çæ¯ä¸ä¸ªç¶æã\n\nå½¢å¼ä¸ï¼Generator å½æ°æ¯ä¸ä¸ªæ®éå½æ°ï¼ä½æ¯æä¸¤ä¸ªç¹å¾ãä¸æ¯ï¼functionå³é®å­ä¸å½æ°åä¹é´æä¸ä¸ªæå·ï¼äºæ¯ï¼å½æ°ä½åé¨ä½¿ç¨yieldè¡¨è¾¾å¼ï¼å®ä¹ä¸åçåé¨ç¶æï¼yieldå¨è±è¯­éçææå°±æ¯âäº§åºâï¼ã\n\nfunction* helloWorldGenerator() {\n  yield 'hello';\n  yield 'world';\n  return 'ending';\n}\n\nvar hw = helloWorldGenerator();\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç å®ä¹äºä¸ä¸ª Generator å½æ°helloWorldGeneratorï¼å®åé¨æä¸¤ä¸ªyieldè¡¨è¾¾å¼ï¼helloåworldï¼ï¼å³è¯¥å½æ°æä¸ä¸ªç¶æï¼helloï¼world å return è¯­å¥ï¼ç»ææ§è¡ï¼ã\n\nç¶åï¼Generator å½æ°çè°ç¨æ¹æ³ä¸æ®éå½æ°ä¸æ ·ï¼ä¹æ¯å¨å½æ°ååé¢å ä¸ä¸å¯¹åæ¬å·ãä¸åçæ¯ï¼è°ç¨ Generator å½æ°åï¼è¯¥å½æ°å¹¶ä¸æ§è¡ï¼è¿åçä¹ä¸æ¯å½æ°è¿è¡ç»æï¼èæ¯ä¸ä¸ªæååé¨ç¶æçæéå¯¹è±¡ï¼ä¹å°±æ¯ä¸ä¸ç« ä»ç»çéåå¨å¯¹è±¡ï¼Iterator Objectï¼ã\n\nä¸ä¸æ­¥ï¼å¿é¡»è°ç¨éåå¨å¯¹è±¡çnextæ¹æ³ï¼ä½¿å¾æéç§»åä¸ä¸ä¸ªç¶æãä¹å°±æ¯è¯´ï¼æ¯æ¬¡è°ç¨nextæ¹æ³ï¼åé¨æéå°±ä»å½æ°å¤´é¨æä¸ä¸æ¬¡åä¸æ¥çå°æ¹å¼å§æ§è¡ï¼ç´å°éå°ä¸ä¸ä¸ªyieldè¡¨è¾¾å¼ï¼æreturnè¯­å¥ï¼ä¸ºæ­¢ãæ¢è¨ä¹ï¼Generator å½æ°æ¯åæ®µæ§è¡çï¼yieldè¡¨è¾¾å¼æ¯æåæ§è¡çæ è®°ï¼ènextæ¹æ³å¯ä»¥æ¢å¤æ§è¡ã\n\nhw.next()\n// { value: 'hello', done: false }\n\nhw.next()\n// { value: 'world', done: false }\n\nhw.next()\n// { value: 'ending', done: true }\n\nhw.next()\n// { value: undefined, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸å±è°ç¨äºåæ¬¡nextæ¹æ³ã\n\nç¬¬ä¸æ¬¡è°ç¨ï¼Generator å½æ°å¼å§æ§è¡ï¼ç´å°éå°ç¬¬ä¸ä¸ªyieldè¡¨è¾¾å¼ä¸ºæ­¢ãnextæ¹æ³è¿åä¸ä¸ªå¯¹è±¡ï¼å®çvalueå±æ§å°±æ¯å½åyieldè¡¨è¾¾å¼çå¼helloï¼doneå±æ§çå¼falseï¼è¡¨ç¤ºéåè¿æ²¡æç»æã\n\nç¬¬äºæ¬¡è°ç¨ï¼Generator å½æ°ä»ä¸æ¬¡yieldè¡¨è¾¾å¼åä¸çå°æ¹ï¼ä¸ç´æ§è¡å°ä¸ä¸ä¸ªyieldè¡¨è¾¾å¼ãnextæ¹æ³è¿åçå¯¹è±¡çvalueå±æ§å°±æ¯å½åyieldè¡¨è¾¾å¼çå¼worldï¼doneå±æ§çå¼falseï¼è¡¨ç¤ºéåè¿æ²¡æç»æã\n\nç¬¬ä¸æ¬¡è°ç¨ï¼Generator å½æ°ä»ä¸æ¬¡yieldè¡¨è¾¾å¼åä¸çå°æ¹ï¼ä¸ç´æ§è¡å°returnè¯­å¥ï¼å¦ææ²¡æreturnè¯­å¥ï¼å°±æ§è¡å°å½æ°ç»æï¼ãnextæ¹æ³è¿åçå¯¹è±¡çvalueå±æ§ï¼å°±æ¯ç´§è·å¨returnè¯­å¥åé¢çè¡¨è¾¾å¼çå¼ï¼å¦ææ²¡æreturnè¯­å¥ï¼åvalueå±æ§çå¼ä¸ºundefinedï¼ï¼doneå±æ§çå¼trueï¼è¡¨ç¤ºéåå·²ç»ç»æã\n\nç¬¬åæ¬¡è°ç¨ï¼æ­¤æ¶ Generator å½æ°å·²ç»è¿è¡å®æ¯ï¼nextæ¹æ³è¿åå¯¹è±¡çvalueå±æ§ä¸ºundefinedï¼doneå±æ§ä¸ºtrueãä»¥ååè°ç¨nextæ¹æ³ï¼è¿åçé½æ¯è¿ä¸ªå¼ã\n\næ»ç»ä¸ä¸ï¼è°ç¨ Generator å½æ°ï¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼ä»£è¡¨ Generator å½æ°çåé¨æéãä»¥åï¼æ¯æ¬¡è°ç¨éåå¨å¯¹è±¡çnextæ¹æ³ï¼å°±ä¼è¿åä¸ä¸ªæçvalueådoneä¸¤ä¸ªå±æ§çå¯¹è±¡ãvalueå±æ§è¡¨ç¤ºå½åçåé¨ç¶æçå¼ï¼æ¯yieldè¡¨è¾¾å¼åé¢é£ä¸ªè¡¨è¾¾å¼çå¼ï¼doneå±æ§æ¯ä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºæ¯å¦éåç»æã\n\nES6 æ²¡æè§å®ï¼functionå³é®å­ä¸å½æ°åä¹é´çæå·ï¼åå¨åªä¸ªä½ç½®ãè¿å¯¼è´ä¸é¢çåæ³é½è½éè¿ã\n\nfunction * foo(x, y) { Â·Â·Â· }\nfunction *foo(x, y) { Â·Â·Â· }\nfunction* foo(x, y) { Â·Â·Â· }\nfunction*foo(x, y) { Â·Â·Â· }\n\n\n1\n2\n3\n4\n\n\nç±äº Generator å½æ°ä»ç¶æ¯æ®éå½æ°ï¼æä»¥ä¸è¬çåæ³æ¯ä¸é¢çç¬¬ä¸ç§ï¼å³æå·ç´§è·å¨functionå³é®å­åé¢ãæ¬ä¹¦ä¹éç¨è¿ç§åæ³ã\n\n\n# yield è¡¨è¾¾å¼\n\nç±äº Generator å½æ°è¿åçéåå¨å¯¹è±¡ï¼åªæè°ç¨nextæ¹æ³æä¼éåä¸ä¸ä¸ªåé¨ç¶æï¼æä»¥å¶å®æä¾äºä¸ç§å¯ä»¥æåæ§è¡çå½æ°ãyieldè¡¨è¾¾å¼å°±æ¯æåæ å¿ã\n\néåå¨å¯¹è±¡çnextæ¹æ³çè¿è¡é»è¾å¦ä¸ã\n\nï¼1ï¼éå°yieldè¡¨è¾¾å¼ï¼å°±æåæ§è¡åé¢çæä½ï¼å¹¶å°ç´§è·å¨yieldåé¢çé£ä¸ªè¡¨è¾¾å¼çå¼ï¼ä½ä¸ºè¿åçå¯¹è±¡çvalueå±æ§å¼ã\n\nï¼2ï¼ä¸ä¸æ¬¡è°ç¨nextæ¹æ³æ¶ï¼åç»§ç»­å¾ä¸æ§è¡ï¼ç´å°éå°ä¸ä¸ä¸ªyieldè¡¨è¾¾å¼ã\n\nï¼3ï¼å¦ææ²¡æåéå°æ°çyieldè¡¨è¾¾å¼ï¼å°±ä¸ç´è¿è¡å°å½æ°ç»æï¼ç´å°returnè¯­å¥ä¸ºæ­¢ï¼å¹¶å°returnè¯­å¥åé¢çè¡¨è¾¾å¼çå¼ï¼ä½ä¸ºè¿åçå¯¹è±¡çvalueå±æ§å¼ã\n\nï¼4ï¼å¦æè¯¥å½æ°æ²¡æreturnè¯­å¥ï¼åè¿åçå¯¹è±¡çvalueå±æ§å¼ä¸ºundefinedã\n\néè¦æ³¨æçæ¯ï¼yieldè¡¨è¾¾å¼åé¢çè¡¨è¾¾å¼ï¼åªæå½è°ç¨nextæ¹æ³ãåé¨æéæåè¯¥è¯­å¥æ¶æä¼æ§è¡ï¼å æ­¤ç­äºä¸º JavaScript æä¾äºæå¨çâæ°æ§æ±å¼âï¼Lazy Evaluationï¼çè¯­æ³åè½ã\n\nfunction* gen() {\n  yield  123 + 456;\n}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼yieldåé¢çè¡¨è¾¾å¼123 + 456ï¼ä¸ä¼ç«å³æ±å¼ï¼åªä¼å¨nextæ¹æ³å°æéç§»å°è¿ä¸å¥æ¶ï¼æä¼æ±å¼ã\n\nyieldè¡¨è¾¾å¼ä¸returnè¯­å¥æ¢æç¸ä¼¼ä¹å¤ï¼ä¹æåºå«ãç¸ä¼¼ä¹å¤å¨äºï¼é½è½è¿åç´§è·å¨è¯­å¥åé¢çé£ä¸ªè¡¨è¾¾å¼çå¼ãåºå«å¨äºæ¯æ¬¡éå°yieldï¼å½æ°æåæ§è¡ï¼ä¸ä¸æ¬¡åä»è¯¥ä½ç½®ç»§ç»­ååæ§è¡ï¼è**returnè¯­å¥ä¸å·å¤ä½ç½®è®°å¿çåè½**ãä¸ä¸ªå½æ°éé¢ï¼åªè½æ§è¡ä¸æ¬¡ï¼æèè¯´ä¸ä¸ªï¼returnè¯­å¥ï¼ä½æ¯å¯ä»¥æ§è¡å¤æ¬¡ï¼æèè¯´å¤ä¸ªï¼yieldè¡¨è¾¾å¼ãæ­£å¸¸å½æ°åªè½è¿åä¸ä¸ªå¼ï¼å ä¸ºåªè½æ§è¡ä¸æ¬¡returnï¼Generator å½æ°å¯ä»¥è¿åä¸ç³»åçå¼ï¼å ä¸ºå¯ä»¥æä»»æå¤ä¸ªyieldãä»å¦ä¸ä¸ªè§åº¦çï¼ä¹å¯ä»¥è¯´ Generator çæäºä¸ç³»åçå¼ï¼è¿ä¹å°±æ¯å®çåç§°çæ¥åï¼è±è¯­ä¸­ï¼generator è¿ä¸ªè¯æ¯âçæå¨âçææï¼ã\n\nGenerator å½æ°å¯ä»¥ä¸ç¨yieldè¡¨è¾¾å¼ï¼è¿æ¶å°±åæäºä¸ä¸ªåçº¯çæç¼æ§è¡å½æ°ã\n\nfunction* f() {\n  console.log('æ§è¡äºï¼')\n}\n\nvar generator = f();\n\nsetTimeout(function () {\n  generator.next()\n}, 2000);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°få¦ææ¯æ®éå½æ°ï¼å¨ä¸ºåégeneratorèµå¼æ¶å°±ä¼æ§è¡ãä½æ¯ï¼å½æ°fæ¯ä¸ä¸ª Generator å½æ°ï¼å°±åæåªæè°ç¨nextæ¹æ³æ¶ï¼å½æ°fæä¼æ§è¡ã\n\nå¦å¤éè¦æ³¨æï¼yieldè¡¨è¾¾å¼åªè½ç¨å¨ Generator å½æ°éé¢ï¼ç¨å¨å¶ä»å°æ¹é½ä¼æ¥éã\n\n(function (){\n  yield 1;\n})()\n// SyntaxError: Unexpected number\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç å¨ä¸ä¸ªæ®éå½æ°ä¸­ä½¿ç¨yieldè¡¨è¾¾å¼ï¼ç»æäº§çä¸ä¸ªå¥æ³éè¯¯ã\n\nä¸é¢æ¯å¦å¤ä¸ä¸ªä¾å­ã\n\nvar arr = [1, [[2, 3], 4], [5, 6]];\n\nvar flat = function* (a) {\n  a.forEach(function (item) {\n    if (typeof item !== 'number') {\n      yield* flat(item);\n    } else {\n      yield item;\n    }\n  });\n};\n\nfor (var f of flat(arr)){\n  console.log(f);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¹ä¼äº§çå¥æ³éè¯¯ï¼å ä¸ºforEachæ¹æ³çåæ°æ¯ä¸ä¸ªæ®éå½æ°ï¼ä½æ¯å¨éé¢ä½¿ç¨äºyieldè¡¨è¾¾å¼ï¼è¿ä¸ªå½æ°éé¢è¿ä½¿ç¨äºyield*è¡¨è¾¾å¼ï¼è¯¦ç»ä»ç»è§åæï¼ãä¸ç§ä¿®æ¹æ¹æ³æ¯æ¹ç¨forå¾ªç¯ã\n\nvar arr = [1, [[2, 3], 4], [5, 6]];\n\nvar flat = function* (a) {\n  var length = a.length;\n  for (var i = 0; i < length; i++) {\n    var item = a[i];\n    if (typeof item !== 'number') {\n      yield* flat(item);\n    } else {\n      yield item;\n    }\n  }\n};\n\nfor (var f of flat(arr)) {\n  console.log(f);\n}\n// 1, 2, 3, 4, 5, 6\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nå¦å¤ï¼yieldè¡¨è¾¾å¼å¦æç¨å¨å¦ä¸ä¸ªè¡¨è¾¾å¼ä¹ä¸­ï¼å¿é¡»æ¾å¨åæ¬å·éé¢ã\n\nfunction* demo() {\n  console.log('Hello' + yield); // SyntaxError\n  console.log('Hello' + yield 123); // SyntaxError\n\n  console.log('Hello' + (yield)); // OK\n  console.log('Hello' + (yield 123)); // OK\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nyieldè¡¨è¾¾å¼ç¨ä½å½æ°åæ°ææ¾å¨èµå¼è¡¨è¾¾å¼çå³è¾¹ï¼å¯ä»¥ä¸å æ¬å·ã\n\nfunction* demo() {\n  foo(yield 'a', yield 'b'); // OK\n  let input = yield; // OK\n}\n\n\n1\n2\n3\n4\n\n\n\n# ä¸ Iterator æ¥å£çå³ç³»\n\nä¸ä¸ç« è¯´è¿ï¼ä»»æä¸ä¸ªå¯¹è±¡çSymbol.iteratoræ¹æ³ï¼ç­äºè¯¥å¯¹è±¡çéåå¨çæå½æ°ï¼è°ç¨è¯¥å½æ°ä¼è¿åè¯¥å¯¹è±¡çä¸ä¸ªéåå¨å¯¹è±¡ã\n\nç±äº Generator å½æ°å°±æ¯éåå¨çæå½æ°ï¼å æ­¤å¯ä»¥æ Generator èµå¼ç»å¯¹è±¡çSymbol.iteratorå±æ§ï¼ä»èä½¿å¾è¯¥å¯¹è±¡å·æ Iterator æ¥å£ã\n\nvar myIterable = {};\nmyIterable[Symbol.iterator] = function* () {\n  yield 1;\n  yield 2;\n  yield 3;\n};\n\n[...myIterable] // [1, 2, 3]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼Generator å½æ°èµå¼ç»Symbol.iteratorå±æ§ï¼ä»èä½¿å¾myIterableå¯¹è±¡å·æäº Iterator æ¥å£ï¼å¯ä»¥è¢«...è¿ç®ç¬¦éåäºã\n\nGenerator å½æ°æ§è¡åï¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ãè¯¥å¯¹è±¡æ¬èº«ä¹å·æSymbol.iteratorå±æ§ï¼æ§è¡åè¿åèªèº«ã\n\nfunction* gen(){\n  // some code\n}\n\nvar g = gen();\n\ng[Symbol.iterator]() === g\n// true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼genæ¯ä¸ä¸ª Generator å½æ°ï¼è°ç¨å®ä¼çæä¸ä¸ªéåå¨å¯¹è±¡gãå®çSymbol.iteratorå±æ§ï¼ä¹æ¯ä¸ä¸ªéåå¨å¯¹è±¡çæå½æ°ï¼æ§è¡åè¿åå®èªå·±ã\n\n\n# next æ¹æ³çåæ°\n\nyieldè¡¨è¾¾å¼æ¬èº«æ²¡æè¿åå¼ï¼æèè¯´æ»æ¯è¿åundefinedãnextæ¹æ³å¯ä»¥å¸¦ä¸ä¸ªåæ°ï¼è¯¥åæ°å°±ä¼è¢«å½ä½ä¸ä¸ä¸ªyieldè¡¨è¾¾å¼çè¿åå¼ã\n\nfunction* f() {\n  for(var i = 0; true; i++) {\n    var reset = yield i;\n    if(reset) { i = -1; }\n  }\n}\n\nvar g = f();\n\ng.next() // { value: 0, done: false }\ng.next() // { value: 1, done: false }\ng.next(true) // { value: 0, done: false } // åæ°true ä¼ ç»ä¸é¢çåéreset\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç åå®ä¹äºä¸ä¸ªå¯ä»¥æ éè¿è¡ç Generator å½æ°fï¼å¦ænextæ¹æ³æ²¡æåæ°ï¼æ¯æ¬¡è¿è¡å°yieldè¡¨è¾¾å¼ï¼åéresetçå¼æ»æ¯undefinedãå½nextæ¹æ³å¸¦ä¸ä¸ªåæ°trueæ¶ï¼åéresetå°±è¢«éç½®ä¸ºè¿ä¸ªåæ°ï¼å³trueï¼ï¼å æ­¤iä¼ç­äº-1ï¼ä¸ä¸è½®å¾ªç¯å°±ä¼ä»-1å¼å§éå¢ã\n\nè¿ä¸ªåè½æå¾éè¦çè¯­æ³æä¹ãGenerator å½æ°ä»æåç¶æå°æ¢å¤è¿è¡ï¼å®çä¸ä¸æç¶æï¼contextï¼æ¯ä¸åçãéè¿nextæ¹æ³çåæ°ï¼å°±æåæ³å¨ Generator å½æ°å¼å§è¿è¡ä¹åï¼ç»§ç»­åå½æ°ä½åé¨æ³¨å¥å¼ãä¹å°±æ¯è¯´ï¼å¯ä»¥å¨ Generator å½æ°è¿è¡çä¸åé¶æ®µï¼ä»å¤é¨ååé¨æ³¨å¥ä¸åçå¼ï¼ä»èè°æ´å½æ°è¡ä¸ºã\n\nåçä¸ä¸ªä¾å­ã\n\nfunction* foo(x) {\n  var y = 2 * (yield (x + 1));\n  var z = yield (y / 3);\n  return (x + y + z);\n}\n\nvar a = foo(5);\na.next() // Object{value:6, done:false}\na.next() // Object{value:NaN, done:false}\na.next() // Object{value:NaN, done:true}\n\nvar b = foo(5);\nb.next() // { value:6, done:false }\nb.next(12) // { value:8, done:false }\nb.next(13) // { value:42, done:true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬äºæ¬¡è¿è¡nextæ¹æ³çæ¶åä¸å¸¦åæ°ï¼å¯¼è´ y çå¼ç­äº2 * undefinedï¼å³NaNï¼ï¼é¤ä»¥ 3 ä»¥åè¿æ¯NaNï¼å æ­¤è¿åå¯¹è±¡çvalueå±æ§ä¹ç­äºNaNãç¬¬ä¸æ¬¡è¿è¡Nextæ¹æ³çæ¶åä¸å¸¦åæ°ï¼æä»¥zç­äºundefinedï¼è¿åå¯¹è±¡çvalueå±æ§ç­äº5 + NaN + undefinedï¼å³NaNã\n\nå¦æånextæ¹æ³æä¾åæ°ï¼è¿åç»æå°±å®å¨ä¸ä¸æ ·äºãä¸é¢ä»£ç ç¬¬ä¸æ¬¡è°ç¨bçnextæ¹æ³æ¶ï¼è¿åx+1çå¼6ï¼ç¬¬äºæ¬¡è°ç¨nextæ¹æ³ï¼å°ä¸ä¸æ¬¡yieldè¡¨è¾¾å¼çå¼è®¾ä¸º12ï¼å æ­¤yç­äº24ï¼è¿åy / 3çå¼8ï¼ç¬¬ä¸æ¬¡è°ç¨nextæ¹æ³ï¼å°ä¸ä¸æ¬¡yieldè¡¨è¾¾å¼çå¼è®¾ä¸º13ï¼å æ­¤zç­äº13ï¼è¿æ¶xç­äº5ï¼yç­äº24ï¼æä»¥returnè¯­å¥çå¼ç­äº42ã\n\næ³¨æï¼ç±äºnextæ¹æ³çåæ°è¡¨ç¤ºä¸ä¸ä¸ªyieldè¡¨è¾¾å¼çè¿åå¼ï¼æä»¥å¨ç¬¬ä¸æ¬¡ä½¿ç¨nextæ¹æ³æ¶ï¼ä¼ éåæ°æ¯æ æçãV8 å¼æç´æ¥å¿½ç¥ç¬¬ä¸æ¬¡ä½¿ç¨nextæ¹æ³æ¶çåæ°ï¼åªæä»ç¬¬äºæ¬¡ä½¿ç¨nextæ¹æ³å¼å§ï¼åæ°ææ¯ææçãä»è¯­ä¹ä¸è®²ï¼ç¬¬ä¸ä¸ªnextæ¹æ³ç¨æ¥å¯å¨éåå¨å¯¹è±¡ï¼æä»¥ä¸ç¨å¸¦æåæ°ã\n\nåçä¸ä¸ªéè¿nextæ¹æ³çåæ°ï¼å Generator å½æ°åé¨è¾å¥å¼çä¾å­ã\n\nfunction* dataConsumer() {\n  console.log('Started');\n  console.log(`1. ${yield}`);\n  console.log(`2. ${yield}`);\n  return 'result';\n}\n\nlet genObj = dataConsumer();\ngenObj.next();\n// Started\ngenObj.next('a')\n// 1. a\ngenObj.next('b')\n// 2. b\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç æ¯ä¸ä¸ªå¾ç´è§çä¾å­ï¼æ¯æ¬¡éè¿nextæ¹æ³å Generator å½æ°è¾å¥å¼ï¼ç¶åæå°åºæ¥ã\n\nå¦ææ³è¦ç¬¬ä¸æ¬¡è°ç¨nextæ¹æ³æ¶ï¼å°±è½å¤è¾å¥å¼ï¼å¯ä»¥å¨ Generator å½æ°å¤é¢ååä¸å±ã\n\nfunction wrapper(generatorFunction) {\n  return function (...args) {\n    let generatorObject = generatorFunction(...args);\n    generatorObject.next();\n    return generatorObject;\n  };\n}\n\nconst wrapped = wrapper(function* () {\n  console.log(`First input: ${yield}`);\n  return 'DONE';\n});\n\nwrapped().next('hello!')\n// First input: hello!\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼Generator å½æ°å¦æä¸ç¨wrapperååä¸å±ï¼æ¯æ æ³ç¬¬ä¸æ¬¡è°ç¨nextæ¹æ³ï¼å°±è¾å¥åæ°çã\n\n\n# for...of å¾ªç¯\n\nfor...ofå¾ªç¯å¯ä»¥èªå¨éå Generator å½æ°è¿è¡æ¶çæçIteratorå¯¹è±¡ï¼ä¸æ­¤æ¶ä¸åéè¦è°ç¨nextæ¹æ³ã\n\nfunction* foo() {\n  yield 1;\n  yield 2;\n  yield 3;\n  yield 4;\n  yield 5;\n  return 6;\n}\n\nfor (let v of foo()) {\n  console.log(v);\n}\n// 1 2 3 4 5\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä½¿ç¨for...ofå¾ªç¯ï¼ä¾æ¬¡æ¾ç¤º 5 ä¸ªyieldè¡¨è¾¾å¼çå¼ãè¿ééè¦æ³¨æï¼ä¸æ¦nextæ¹æ³çè¿åå¯¹è±¡çdoneå±æ§ä¸ºtrueï¼for...ofå¾ªç¯å°±ä¼ä¸­æ­¢ï¼ä¸ä¸åå«è¯¥è¿åå¯¹è±¡ï¼æä»¥ä¸é¢ä»£ç çreturnè¯­å¥è¿åç6ï¼ä¸åæ¬å¨for...ofå¾ªç¯ä¹ä¸­ã\n\nä¸é¢æ¯ä¸ä¸ªå©ç¨ Generator å½æ°åfor...ofå¾ªç¯ï¼å®ç°ææ³¢é£å¥æ°åçä¾å­ã\n\nfunction* fibonacci() {\n  let [prev, curr] = [0, 1];\n  for (;;) {\n    yield curr;\n    [prev, curr] = [curr, prev + curr];\n  }\n}\n\nfor (let n of fibonacci()) {\n  if (n > 1000) break;\n  console.log(n);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä»ä¸é¢ä»£ç å¯è§ï¼ä½¿ç¨for...ofè¯­å¥æ¶ä¸éè¦ä½¿ç¨nextæ¹æ³ã\n\nå©ç¨for...ofå¾ªç¯ï¼å¯ä»¥ååºéåä»»æå¯¹è±¡ï¼objectï¼çæ¹æ³ãåçç JavaScript å¯¹è±¡æ²¡æéåæ¥å£ï¼æ æ³ä½¿ç¨for...ofå¾ªç¯ï¼éè¿ Generator å½æ°ä¸ºå®å ä¸è¿ä¸ªæ¥å£ï¼å°±å¯ä»¥ç¨äºã\n\nfunction* objectEntries(obj) {\n  let propKeys = Reflect.ownKeys(obj);\n\n  for (let propKey of propKeys) {\n    yield [propKey, obj[propKey]];\n  }\n}\n\nlet jane = { first: 'Jane', last: 'Doe' };\n\nfor (let [key, value] of objectEntries(jane)) {\n  console.log(`${key}: ${value}`);\n}\n// first: Jane\n// last: Doe\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯¹è±¡janeåçä¸å·å¤ Iterator æ¥å£ï¼æ æ³ç¨for...oféåãè¿æ¶ï¼æä»¬éè¿ Generator å½æ°objectEntriesä¸ºå®å ä¸éåå¨æ¥å£ï¼å°±å¯ä»¥ç¨for...oféåäºãå ä¸éåå¨æ¥å£çå¦ä¸ç§åæ³æ¯ï¼å° Generator å½æ°å å°å¯¹è±¡çSymbol.iteratorå±æ§ä¸é¢ã\n\nfunction* objectEntries() {\n  let propKeys = Object.keys(this);\n\n  for (let propKey of propKeys) {\n    yield [propKey, this[propKey]];\n  }\n}\n\nlet jane = { first: 'Jane', last: 'Doe' };\n\njane[Symbol.iterator] = objectEntries;\n\nfor (let [key, value] of jane) {\n  console.log(`${key}: ${value}`);\n}\n// first: Jane\n// last: Doe\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\né¤äºfor...ofå¾ªç¯ä»¥å¤ï¼æ©å±è¿ç®ç¬¦ï¼...ï¼ãè§£æèµå¼åArray.fromæ¹æ³åé¨è°ç¨çï¼é½æ¯éåå¨æ¥å£ãè¿æå³çï¼å®ä»¬é½å¯ä»¥å° Generator å½æ°è¿åç Iterator å¯¹è±¡ï¼ä½ä¸ºåæ°ã\n\nfunction* numbers () {\n  yield 1\n  yield 2\n  return 3\n  yield 4\n}\n\n// æ©å±è¿ç®ç¬¦\n[...numbers()] // [1, 2]\n\n// Array.from æ¹æ³\nArray.from(numbers()) // [1, 2]\n\n// è§£æèµå¼\nlet [x, y] = numbers();\nx // 1\ny // 2\n\n// for...of å¾ªç¯\nfor (let n of numbers()) {\n  console.log(n)\n}\n// 1\n// 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n\n# Generator.prototype.throw()\n\nGenerator å½æ°è¿åçéåå¨å¯¹è±¡ï¼é½æä¸ä¸ªthrowæ¹æ³ï¼å¯ä»¥å¨å½æ°ä½å¤æåºéè¯¯ï¼ç¶åå¨ Generator å½æ°ä½åæè·ã\n\nvar g = function* () {\n  try {\n    yield;\n  } catch (e) {\n    console.log('åé¨æè·', e);\n  }\n};\n\nvar i = g();\ni.next();\n\ntry {\n  i.throw('a');\n  i.throw('b');\n} catch (e) {\n  console.log('å¤é¨æè·', e);\n}\n// åé¨æè· a\n// å¤é¨æè· b\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ä¸­ï¼éåå¨å¯¹è±¡iè¿ç»­æåºä¸¤ä¸ªéè¯¯ãç¬¬ä¸ä¸ªéè¯¯è¢« Generator å½æ°ä½åçcatchè¯­å¥æè·ãiç¬¬äºæ¬¡æåºéè¯¯ï¼ç±äº Generator å½æ°åé¨çcatchè¯­å¥å·²ç»æ§è¡è¿äºï¼ä¸ä¼åææå°è¿ä¸ªéè¯¯äºï¼æä»¥è¿ä¸ªéè¯¯å°±è¢«æåºäº Generator å½æ°ä½ï¼è¢«å½æ°ä½å¤çcatchè¯­å¥æè·ã\n\nthrowæ¹æ³å¯ä»¥æ¥åä¸ä¸ªåæ°ï¼è¯¥åæ°ä¼è¢«catchè¯­å¥æ¥æ¶ï¼å»ºè®®æåºErrorå¯¹è±¡çå®ä¾ã\n\nvar g = function* () {\n  try {\n    yield;\n  } catch (e) {\n    console.log(e);\n  }\n};\n\nvar i = g();\ni.next();\ni.throw(new Error('åºéäºï¼'));\n// Error: åºéäºï¼(â¦)\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\næ³¨æï¼ä¸è¦æ··æ·éåå¨å¯¹è±¡çthrowæ¹æ³åå¨å±çthrowå½ä»¤ãä¸é¢ä»£ç çéè¯¯ï¼æ¯ç¨éåå¨å¯¹è±¡çthrowæ¹æ³æåºçï¼èä¸æ¯ç¨throwå½ä»¤æåºçãåèåªè½è¢«å½æ°ä½å¤çcatchè¯­å¥æè·ã\n\nvar g = function* () {\n  while (true) {\n    try {\n      yield;\n    } catch (e) {\n      if (e != 'a') throw e;\n      console.log('åé¨æè·', e);\n    }\n  }\n};\n\nvar i = g();\ni.next();\n\ntry {\n  throw new Error('a');\n  throw new Error('b');\n} catch (e) {\n  console.log('å¤é¨æè·', e);\n}\n// å¤é¨æè· [Error: a]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nä¸é¢ä»£ç ä¹æä»¥åªæè·äºaï¼æ¯å ä¸ºå½æ°ä½å¤çcatchè¯­å¥åï¼æè·äºæåºçaéè¯¯ä»¥åï¼å°±ä¸ä¼åç»§ç»­tryä»£ç åéé¢å©ä½çè¯­å¥äºã\n\nå¦æ Generator å½æ°åé¨æ²¡æé¨ç½²try...catchä»£ç åï¼é£ä¹throwæ¹æ³æåºçéè¯¯ï¼å°è¢«å¤é¨try...catchä»£ç åæè·ã\n\nvar g = function* () {\n  while (true) {\n    yield;\n    console.log('åé¨æè·', e);\n  }\n};\n\nvar i = g();\ni.next();\n\ntry {\n  i.throw('a');\n  i.throw('b');\n} catch (e) {\n  console.log('å¤é¨æè·', e);\n}\n// å¤é¨æè· a\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼Generator å½æ°gåé¨æ²¡æé¨ç½²try...catchä»£ç åï¼æä»¥æåºçéè¯¯ç´æ¥è¢«å¤é¨catchä»£ç åæè·ã\n\nå¦æ Generator å½æ°åé¨åå¤é¨ï¼é½æ²¡æé¨ç½²try...catchä»£ç åï¼é£ä¹ç¨åºå°æ¥éï¼ç´æ¥ä¸­æ­æ§è¡ã\n\nvar gen = function* gen(){\n  yield console.log('hello');\n  yield console.log('world');\n}\n\nvar g = gen();\ng.next();\ng.throw();\n// hello\n// Uncaught undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼g.throwæåºéè¯¯ä»¥åï¼æ²¡æä»»ä½try...catchä»£ç åå¯ä»¥æè·è¿ä¸ªéè¯¯ï¼å¯¼è´ç¨åºæ¥éï¼ä¸­æ­æ§è¡ã\n\nthrowæ¹æ³æåºçéè¯¯è¦è¢«åé¨æè·ï¼åææ¯å¿é¡»è³å°æ§è¡è¿ä¸æ¬¡nextæ¹æ³ã\n\nfunction* gen() {\n  try {\n    yield 1;\n  } catch (e) {\n    console.log('åé¨æè·');\n  }\n}\n\nvar g = gen();\ng.throw(1);\n// Uncaught 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼g.throw(1)æ§è¡æ¶ï¼nextæ¹æ³ä¸æ¬¡é½æ²¡ææ§è¡è¿ãè¿æ¶ï¼æåºçéè¯¯ä¸ä¼è¢«åé¨æè·ï¼èæ¯ç´æ¥å¨å¤é¨æåºï¼å¯¼è´ç¨åºåºéãè¿ç§è¡ä¸ºå¶å®å¾å¥½çè§£ï¼å ä¸ºç¬¬ä¸æ¬¡æ§è¡nextæ¹æ³ï¼ç­åäºå¯å¨æ§è¡ Generator å½æ°çåé¨ä»£ç ï¼å¦å Generator å½æ°è¿æ²¡æå¼å§æ§è¡ï¼è¿æ¶throwæ¹æ³æéåªå¯è½æåºå¨å½æ°å¤é¨ã\n\nthrowæ¹æ³è¢«æè·ä»¥åï¼ä¼éå¸¦æ§è¡ä¸ä¸æ¡yieldè¡¨è¾¾å¼ãä¹å°±æ¯è¯´ï¼ä¼éå¸¦æ§è¡ä¸æ¬¡nextæ¹æ³ã\n\nvar gen = function* gen(){\n  try {\n    yield console.log('a');\n  } catch (e) {\n    // ...\n  }\n  yield console.log('b');\n  yield console.log('c');\n}\n\nvar g = gen();\ng.next() // a\ng.throw() // b\ng.next() // c\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼g.throwæ¹æ³è¢«æè·ä»¥åï¼èªå¨æ§è¡äºä¸æ¬¡nextæ¹æ³ï¼æä»¥ä¼æå°bãå¦å¤ï¼ä¹å¯ä»¥çå°ï¼åªè¦ Generator å½æ°åé¨é¨ç½²äºtry...catchä»£ç åï¼é£ä¹éåå¨çthrowæ¹æ³æåºçéè¯¯ï¼ä¸å½±åä¸ä¸æ¬¡éåã\n\nå¦å¤ï¼throwå½ä»¤ä¸g.throwæ¹æ³æ¯æ å³çï¼ä¸¤èäºä¸å½±åã\n\nvar gen = function* gen(){\n  yield console.log('hello');\n  yield console.log('world');\n}\n\nvar g = gen();\ng.next();\n\ntry {\n  throw new Error();\n} catch (e) {\n  g.next();\n}\n// hello\n// world\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼throwå½ä»¤æåºçéè¯¯ä¸ä¼å½±åå°éåå¨çç¶æï¼æä»¥ä¸¤æ¬¡æ§è¡nextæ¹æ³ï¼é½è¿è¡äºæ­£ç¡®çæä½ã\n\nè¿ç§å½æ°ä½åæè·éè¯¯çæºå¶ï¼å¤§å¤§æ¹ä¾¿äºå¯¹éè¯¯çå¤çãå¤ä¸ªyieldè¡¨è¾¾å¼ï¼å¯ä»¥åªç¨ä¸ä¸ªtry...catchä»£ç åæ¥æè·éè¯¯ãå¦æä½¿ç¨åè°å½æ°çåæ³ï¼æ³è¦æè·å¤ä¸ªéè¯¯ï¼å°±ä¸å¾ä¸ä¸ºæ¯ä¸ªå½æ°åé¨åä¸ä¸ªéè¯¯å¤çè¯­å¥ï¼ç°å¨åªå¨ Generator å½æ°åé¨åä¸æ¬¡catchè¯­å¥å°±å¯ä»¥äºã\n\nGenerator å½æ°ä½å¤æåºçéè¯¯ï¼å¯ä»¥å¨å½æ°ä½åæè·ï¼åè¿æ¥ï¼Generator å½æ°ä½åæåºçéè¯¯ï¼ä¹å¯ä»¥è¢«å½æ°ä½å¤çcatchæè·ã\n\nfunction* foo() {\n  var x = yield 3;\n  var y = x.toUpperCase();\n  yield y;\n}\n\nvar it = foo();\n\nit.next(); // { value:3, done:false }\n\ntry {\n  it.next(42);\n} catch (err) {\n  console.log(err);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬äºä¸ªnextæ¹æ³åå½æ°ä½åä¼ å¥ä¸ä¸ªåæ° 42ï¼æ°å¼æ¯æ²¡ætoUpperCaseæ¹æ³çï¼æä»¥ä¼æåºä¸ä¸ª TypeError éè¯¯ï¼è¢«å½æ°ä½å¤çcatchæè·ã\n\nä¸æ¦ Generator æ§è¡è¿ç¨ä¸­æåºéè¯¯ï¼ä¸æ²¡æè¢«åé¨æè·ï¼å°±ä¸ä¼åæ§è¡ä¸å»äºãå¦ææ­¤åè¿è°ç¨nextæ¹æ³ï¼å°è¿åä¸ä¸ªvalueå±æ§ç­äºundefinedãdoneå±æ§ç­äºtrueçå¯¹è±¡ï¼å³ JavaScript å¼æè®¤ä¸ºè¿ä¸ª Generator å·²ç»è¿è¡ç»æäºã\n\nfunction* g() {\n  yield 1;\n  console.log('throwing an exception');\n  throw new Error('generator broke!');\n  yield 2;\n  yield 3;\n}\n\nfunction log(generator) {\n  var v;\n  console.log('starting generator');\n  try {\n    v = generator.next();\n    console.log('ç¬¬ä¸æ¬¡è¿è¡nextæ¹æ³', v);\n  } catch (err) {\n    console.log('ææéè¯¯', v);\n  }\n  try {\n    v = generator.next();\n    console.log('ç¬¬äºæ¬¡è¿è¡nextæ¹æ³', v);\n  } catch (err) {\n    console.log('ææéè¯¯', v);\n  }\n  try {\n    v = generator.next();\n    console.log('ç¬¬ä¸æ¬¡è¿è¡nextæ¹æ³', v);\n  } catch (err) {\n    console.log('ææéè¯¯', v);\n  }\n  console.log('caller done');\n}\n\nlog(g());\n// starting generator\n// ç¬¬ä¸æ¬¡è¿è¡nextæ¹æ³ { value: 1, done: false }\n// throwing an exception\n// ææéè¯¯ { value: 1, done: false }\n// ç¬¬ä¸æ¬¡è¿è¡nextæ¹æ³ { value: undefined, done: true }\n// caller done\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n\n\nä¸é¢ä»£ç ä¸å±ä¸æ¬¡è¿è¡nextæ¹æ³ï¼ç¬¬äºæ¬¡è¿è¡çæ¶åä¼æåºéè¯¯ï¼ç¶åç¬¬ä¸æ¬¡è¿è¡çæ¶åï¼Generator å½æ°å°±å·²ç»ç»æäºï¼ä¸åæ§è¡ä¸å»äºã\n\n\n# Generator.prototype.return()\n\nGenerator å½æ°è¿åçéåå¨å¯¹è±¡ï¼è¿æä¸ä¸ª**returnæ¹æ³ï¼å¯ä»¥è¿åç»å®çå¼ï¼å¹¶ä¸ç»ç»éå Generator å½æ°ã**\n\nfunction* gen() {\n  yield 1;\n  yield 2;\n  yield 3;\n}\n\nvar g = gen();\n\ng.next()        // { value: 1, done: false }\ng.return('foo') // { value: \"foo\", done: true }\ng.next()        // { value: undefined, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼éåå¨å¯¹è±¡gè°ç¨returnæ¹æ³åï¼è¿åå¼çvalueå±æ§å°±æ¯returnæ¹æ³çåæ°fooãå¹¶ä¸ï¼Generator å½æ°çéåå°±ç»æ­¢äºï¼è¿åå¼çdoneå±æ§ä¸ºtrueï¼ä»¥ååè°ç¨nextæ¹æ³ï¼doneå±æ§æ»æ¯è¿åtrueã\n\nå¦æreturnæ¹æ³è°ç¨æ¶ï¼ä¸æä¾åæ°ï¼åè¿åå¼çvalueå±æ§ä¸ºundefinedã\n\nfunction* gen() {\n  yield 1;\n  yield 2;\n  yield 3;\n}\n\nvar g = gen();\n\ng.next()        // { value: 1, done: false }\ng.return() // { value: undefined, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¦æ Generator å½æ°åé¨ætry...finallyä»£ç åï¼ä¸æ­£å¨æ§è¡tryä»£ç åï¼é£ä¹returnæ¹æ³ä¼å¯¼è´ç«å»è¿å¥finallyä»£ç åï¼æ§è¡å®ä»¥åï¼æ´ä¸ªå½æ°æä¼ç»æã\n\nfunction* numbers () {\n  yield 1;\n  try {\n    yield 2;\n    yield 3;\n  } finally {\n    yield 4;\n    yield 5;\n  }\n  yield 6;\n}\nvar g = numbers();\ng.next() // { value: 1, done: false }\ng.next() // { value: 2, done: false }\ng.return(7) // { value: 4, done: false }\ng.next() // { value: 5, done: false }\ng.next() // { value: 7, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼è°ç¨return()æ¹æ³åï¼å°±å¼å§æ§è¡finallyä»£ç åï¼ä¸æ§è¡tryéé¢å©ä¸çä»£ç äºï¼ç¶åç­å°finallyä»£ç åæ§è¡å®ï¼åè¿åreturn()æ¹æ³æå®çè¿åå¼ã\n\n\n# next()ãthrow()ãreturn() çå±åç¹\n\nnext()ãthrow()ãreturn()è¿ä¸ä¸ªæ¹æ³æ¬è´¨ä¸æ¯åä¸ä»¶äºï¼å¯ä»¥æ¾å¨ä¸èµ·çè§£ãå®ä»¬çä½ç¨é½æ¯è®© Generator å½æ°æ¢å¤æ§è¡ï¼å¹¶ä¸ä½¿ç¨ä¸åçè¯­å¥æ¿æ¢yieldè¡¨è¾¾å¼ã\n\nnext()æ¯å°yieldè¡¨è¾¾å¼æ¿æ¢æä¸ä¸ªå¼ã\n\nconst g = function* (x, y) {\n  let result = yield x + y;\n  return result;\n};\n\nconst gen = g(1, 2);\ngen.next(); // Object {value: 3, done: false}\n\ngen.next(1); // Object {value: 1, done: true}\n// ç¸å½äºå° let result = yield x + y\n// æ¿æ¢æ let result = 1;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬äºä¸ªnext(1)æ¹æ³å°±ç¸å½äºå°yieldè¡¨è¾¾å¼æ¿æ¢æä¸ä¸ªå¼1ãå¦ænextæ¹æ³æ²¡æåæ°ï¼å°±ç¸å½äºæ¿æ¢æundefinedã\n\nthrow()æ¯å°yieldè¡¨è¾¾å¼æ¿æ¢æä¸ä¸ªthrowè¯­å¥ã\n\ngen.throw(new Error('åºéäº')); // Uncaught Error: åºéäº\n// ç¸å½äºå° let result = yield x + y\n// æ¿æ¢æ let result = throw(new Error('åºéäº'));\n\n\n1\n2\n3\n\n\nreturn()æ¯å°yieldè¡¨è¾¾å¼æ¿æ¢æä¸ä¸ªreturnè¯­å¥ã\n\ngen.return(2); // Object {value: 2, done: true}\n// ç¸å½äºå° let result = yield x + y\n// æ¿æ¢æ let result = return 2;\n\n\n1\n2\n3\n\n\n\n# yield* è¡¨è¾¾å¼\n\nå¦æå¨ Generator å½æ°åé¨ï¼è°ç¨å¦ä¸ä¸ª Generator å½æ°ãéè¦å¨åèçå½æ°ä½åé¨ï¼èªå·±æå¨å®æéåã\n\nfunction* foo() {\n  yield 'a';\n  yield 'b';\n}\n\nfunction* bar() {\n  yield 'x';\n  // æå¨éå foo()\n  for (let i of foo()) {\n    console.log(i);\n  }\n  yield 'y';\n}\n\nfor (let v of bar()){\n  console.log(v);\n}\n// x\n// a\n// b\n// y\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nä¸é¢ä»£ç ä¸­ï¼fooåbaré½æ¯ Generator å½æ°ï¼å¨baréé¢è°ç¨fooï¼å°±éè¦æå¨éåfooãå¦ææå¤ä¸ª Generator å½æ°åµå¥ï¼åèµ·æ¥å°±éå¸¸éº»ç¦ã\n\nES6 æä¾äºyield*è¡¨è¾¾å¼ï¼ä½ä¸ºè§£å³åæ³ï¼ç¨æ¥å¨ä¸ä¸ª Generator å½æ°éé¢æ§è¡å¦ä¸ä¸ª Generator å½æ°ã\n\nfunction* bar() {\n  yield 'x';\n  yield* foo();\n  yield 'y';\n}\n\n// ç­åäº\nfunction* bar() {\n  yield 'x';\n  yield 'a';\n  yield 'b';\n  yield 'y';\n}\n\n// ç­åäº\nfunction* bar() {\n  yield 'x';\n  for (let v of foo()) {\n    yield v;\n  }\n  yield 'y';\n}\n\nfor (let v of bar()){\n  console.log(v);\n}\n// \"x\"\n// \"a\"\n// \"b\"\n// \"y\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\nåæ¥çä¸ä¸ªå¯¹æ¯çä¾å­ã\n\nfunction* inner() {\n  yield 'hello!';\n}\n\nfunction* outer1() {\n  yield 'open';\n  yield inner();\n  yield 'close';\n}\n\nvar gen = outer1()\ngen.next().value // \"open\"\ngen.next().value // è¿åä¸ä¸ªéåå¨å¯¹è±¡\ngen.next().value // \"close\"\n\nfunction* outer2() {\n  yield 'open'\n  yield* inner()\n  yield 'close'\n}\n\nvar gen = outer2()\ngen.next().value // \"open\"\ngen.next().value // \"hello!\"\ngen.next().value // \"close\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nä¸é¢ä¾å­ä¸­ï¼outer2ä½¿ç¨äºyield*ï¼outer1æ²¡ä½¿ç¨ãç»æå°±æ¯ï¼outer1è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼outer2è¿åè¯¥éåå¨å¯¹è±¡çåé¨å¼ã\n\nä»è¯­æ³è§åº¦çï¼å¦æyieldè¡¨è¾¾å¼åé¢è·çæ¯ä¸ä¸ªéåå¨å¯¹è±¡ï¼éè¦å¨yieldè¡¨è¾¾å¼åé¢å ä¸æå·ï¼è¡¨æå®è¿åçæ¯ä¸ä¸ªéåå¨å¯¹è±¡ãè¿è¢«ç§°ä¸ºyield*è¡¨è¾¾å¼ã\n\nlet delegatedIterator = (function* () {\n  yield 'Hello!';\n  yield 'Bye!';\n}());\n\nlet delegatingIterator = (function* () {\n  yield 'Greetings!';\n  yield* delegatedIterator;\n  yield 'Ok, bye.';\n}());\n\nfor(let value of delegatingIterator) {\n  console.log(value);\n}\n// \"Greetings!\n// \"Hello!\"\n// \"Bye!\"\n// \"Ok, bye.\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä¸é¢ä»£ç ä¸­ï¼delegatingIteratoræ¯ä»£çèï¼delegatedIteratoræ¯è¢«ä»£çèãç±äºyield* delegatedIteratorè¯­å¥å¾å°çå¼ï¼æ¯ä¸ä¸ªéåå¨ï¼æä»¥è¦ç¨æå·è¡¨ç¤ºãè¿è¡ç»æå°±æ¯ä½¿ç¨ä¸ä¸ªéåå¨ï¼éåäºå¤ä¸ª Generator å½æ°ï¼æéå½çææã\n\nyield*åé¢ç Generator å½æ°ï¼æ²¡æreturnè¯­å¥æ¶ï¼ï¼ç­åäºå¨ Generator å½æ°åé¨ï¼é¨ç½²ä¸ä¸ªfor...ofå¾ªç¯ã\n\nfunction* concat(iter1, iter2) {\n  yield* iter1;\n  yield* iter2;\n}\n\n// ç­åäº\n\nfunction* concat(iter1, iter2) {\n  for (var value of iter1) {\n    yield value;\n  }\n  for (var value of iter2) {\n    yield value;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç è¯´æï¼yield*åé¢ç Generator å½æ°ï¼æ²¡æreturnè¯­å¥æ¶ï¼ï¼ä¸è¿æ¯for...ofçä¸ç§ç®åå½¢å¼ï¼å®å¨å¯ä»¥ç¨åèæ¿ä»£åèãåä¹ï¼å¨æreturnè¯­å¥æ¶ï¼åéè¦ç¨var value = yield* iteratorçå½¢å¼è·åreturnè¯­å¥çå¼ã\n\nå¦æyield*åé¢è·çä¸ä¸ªæ°ç»ï¼ç±äºæ°ç»åçæ¯æéåå¨ï¼å æ­¤å°±ä¼éåæ°ç»æåã\n\nfunction* gen(){\n  yield* [\"a\", \"b\", \"c\"];\n}\n\ngen().next() // { value:\"a\", done:false }\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼yieldå½ä»¤åé¢å¦æä¸å æå·ï¼è¿åçæ¯æ´ä¸ªæ°ç»ï¼å äºæå·å°±è¡¨ç¤ºè¿åçæ¯æ°ç»çéåå¨å¯¹è±¡ã\n\nå®éä¸ï¼ä»»ä½æ°æ®ç»æåªè¦æ Iterator æ¥å£ï¼å°±å¯ä»¥è¢«yield*éåã\n\nlet read = (function* () {\n  yield 'hello';\n  yield* 'hello';\n})();\n\nread.next().value // \"hello\"\nread.next().value // \"h\"\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼yieldè¡¨è¾¾å¼è¿åæ´ä¸ªå­ç¬¦ä¸²ï¼yield*è¯­å¥è¿ååä¸ªå­ç¬¦ãå ä¸ºå­ç¬¦ä¸²å·æ Iterator æ¥å£ï¼æä»¥è¢«yield*éåã\n\nå¦æè¢«ä»£çç Generator å½æ°æreturnè¯­å¥ï¼é£ä¹å°±å¯ä»¥åä»£çå®ç Generator å½æ°è¿åæ°æ®ã\n\nfunction* foo() {\n  yield 2;\n  yield 3;\n  return \"foo\";\n}\n\nfunction* bar() {\n  yield 1;\n  var v = yield* foo();\n  console.log(\"v: \" + v);\n  yield 4;\n}\n\nvar it = bar();\n\nit.next()\n// {value: 1, done: false}\nit.next()\n// {value: 2, done: false}\nit.next()\n// {value: 3, done: false}\nit.next();\n// \"v: foo\"\n// {value: 4, done: false}\nit.next()\n// {value: undefined, done: true}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nä¸é¢ä»£ç å¨ç¬¬åæ¬¡è°ç¨nextæ¹æ³çæ¶åï¼å±å¹ä¸ä¼æè¾åºï¼è¿æ¯å ä¸ºå½æ°fooçreturnè¯­å¥ï¼åå½æ°baræä¾äºè¿åå¼ã\n\nåçä¸ä¸ªä¾å­ã\n\nfunction* genFuncWithReturn() {\n  yield 'a';\n  yield 'b';\n  return 'The result';\n}\nfunction* logReturned(genObj) {\n  let result = yield* genObj;\n  console.log(result);\n}\n\n[...logReturned(genFuncWithReturn())]\n// The result\n// å¼ä¸º [ 'a', 'b' ]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼å­å¨ä¸¤æ¬¡éåãç¬¬ä¸æ¬¡æ¯æ©å±è¿ç®ç¬¦éåå½æ°logReturnedè¿åçéåå¨å¯¹è±¡ï¼ç¬¬äºæ¬¡æ¯yield*è¯­å¥éåå½æ°genFuncWithReturnè¿åçéåå¨å¯¹è±¡ãè¿ä¸¤æ¬¡éåçæææ¯å å çï¼æç»è¡¨ç°ä¸ºæ©å±è¿ç®ç¬¦éåå½æ°genFuncWithReturnè¿åçéåå¨å¯¹è±¡ãæä»¥ï¼æåçæ°æ®è¡¨è¾¾å¼å¾å°çå¼ç­äº[ 'a', 'b' ]ãä½æ¯ï¼å½æ°genFuncWithReturnçreturnè¯­å¥çè¿åå¼The resultï¼ä¼è¿åç»å½æ°logReturnedåé¨çresultåéï¼å æ­¤ä¼æç»ç«¯è¾åºã\n\nyield*å½ä»¤å¯ä»¥å¾æ¹ä¾¿å°ååºåµå¥æ°ç»çæææåã\n\nfunction* iterTree(tree) {\n  if (Array.isArray(tree)) {\n    for(let i=0; i < tree.length; i++) {\n      yield* iterTree(tree[i]);\n    }\n  } else {\n    yield tree;\n  }\n}\n\nconst tree = [ 'a', ['b', 'c'], ['d', 'e'] ];\n\nfor(let x of iterTree(tree)) {\n  console.log(x);\n}\n// a\n// b\n// c\n// d\n// e\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nç±äºæ©å±è¿ç®ç¬¦...é»è®¤è°ç¨ Iterator æ¥å£ï¼æä»¥ä¸é¢è¿ä¸ªå½æ°ä¹å¯ä»¥ç¨äºåµå¥æ°ç»çå¹³éºã\n\n[...iterTree(tree)] // [\"a\", \"b\", \"c\", \"d\", \"e\"]\n\n\n1\n\n\nä¸é¢æ¯ä¸ä¸ªç¨å¾®å¤æçä¾å­ï¼ä½¿ç¨yield*è¯­å¥éåå®å¨äºåæ ã\n\n// ä¸é¢æ¯äºåæ çæé å½æ°ï¼\n// ä¸ä¸ªåæ°åå«æ¯å·¦æ ãå½åèç¹åå³æ \nfunction Tree(left, label, right) {\n  this.left = left;\n  this.label = label;\n  this.right = right;\n}\n\n// ä¸é¢æ¯ä¸­åºï¼inorderï¼éåå½æ°ã\n// ç±äºè¿åçæ¯ä¸ä¸ªéåå¨ï¼æä»¥è¦ç¨generatorå½æ°ã\n// å½æ°ä½åéç¨éå½ç®æ³ï¼æä»¥å·¦æ åå³æ è¦ç¨yield*éå\nfunction* inorder(t) {\n  if (t) {\n    yield* inorder(t.left);\n    yield t.label;\n    yield* inorder(t.right);\n  }\n}\n\n// ä¸é¢çæäºåæ \nfunction make(array) {\n  // å¤æ­æ¯å¦ä¸ºå¶èç¹\n  if (array.length == 1) return new Tree(null, array[0], null);\n  return new Tree(make(array[0]), array[1], make(array[2]));\n}\nlet tree = make([[['a'], 'b', ['c']], 'd', [['e'], 'f', ['g']]]);\n\n// éåäºåæ \nvar result = [];\nfor (let node of inorder(tree)) {\n  result.push(node);\n}\n\nresult\n// ['a', 'b', 'c', 'd', 'e', 'f', 'g']\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n\n\n\n# ä½ä¸ºå¯¹è±¡å±æ§ç Generator å½æ°\n\nå¦æä¸ä¸ªå¯¹è±¡çå±æ§æ¯ Generator å½æ°ï¼å¯ä»¥ç®åæä¸é¢çå½¢å¼ã\n\nlet obj = {\n  * myGeneratorMethod() {\n    Â·Â·Â·\n  }\n};\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼myGeneratorMethodå±æ§åé¢æä¸ä¸ªæå·ï¼è¡¨ç¤ºè¿ä¸ªå±æ§æ¯ä¸ä¸ª Generator å½æ°ã\n\nå®çå®æ´å½¢å¼å¦ä¸ï¼ä¸ä¸é¢çåæ³æ¯ç­ä»·çã\n\nlet obj = {\n  myGeneratorMethod: function* () {\n    // Â·Â·Â·\n  }\n};\n\n\n1\n2\n3\n4\n5\n\n\n\n# Generator å½æ°çthis\n\nGenerator å½æ°æ»æ¯è¿åä¸ä¸ªéåå¨ï¼ES6 è§å®è¿ä¸ªéåå¨æ¯ Generator å½æ°çå®ä¾ï¼ä¹ç»§æ¿äº Generator å½æ°çprototypeå¯¹è±¡ä¸çæ¹æ³ã\n\nfunction* g() {}\n\ng.prototype.hello = function () {\n  return 'hi!';\n};\n\nlet obj = g();\n\nobj instanceof g // true\nobj.hello() // 'hi!'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç è¡¨æï¼Generator å½æ°gè¿åçéåå¨objï¼æ¯gçå®ä¾ï¼èä¸ç»§æ¿äºg.prototypeãä½æ¯ï¼å¦æægå½ä½æ®éçæé å½æ°ï¼å¹¶ä¸ä¼çæï¼å ä¸ºgè¿åçæ»æ¯éåå¨å¯¹è±¡ï¼èä¸æ¯thiså¯¹è±¡ã\n\nfunction* g() {\n  this.a = 11;\n}\n\nlet obj = g();\nobj.next();\nobj.a // undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼Generator å½æ°gå¨thiså¯¹è±¡ä¸é¢æ·»å äºä¸ä¸ªå±æ§aï¼ä½æ¯objå¯¹è±¡æ¿ä¸å°è¿ä¸ªå±æ§ã\n\nGenerator å½æ°ä¹ä¸è½è·newå½ä»¤ä¸èµ·ç¨ï¼ä¼æ¥éã\n\nfunction* F() {\n  yield this.x = 2;\n  yield this.y = 3;\n}\n\nnew F()\n// TypeError: F is not a constructor\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼newå½ä»¤è·æé å½æ°Fä¸èµ·ä½¿ç¨ï¼ç»ææ¥éï¼å ä¸ºFä¸æ¯æé å½æ°ã\n\né£ä¹ï¼ææ²¡æåæ³è®© Generator å½æ°è¿åä¸ä¸ªæ­£å¸¸çå¯¹è±¡å®ä¾ï¼æ¢å¯ä»¥ç¨nextæ¹æ³ï¼åå¯ä»¥è·å¾æ­£å¸¸çthisï¼\n\nä¸é¢æ¯ä¸ä¸ªåéæ¹æ³ãé¦åï¼çæä¸ä¸ªç©ºå¯¹è±¡ï¼ä½¿ç¨callæ¹æ³ç»å® Generator å½æ°åé¨çthisãè¿æ ·ï¼æé å½æ°è°ç¨ä»¥åï¼è¿ä¸ªç©ºå¯¹è±¡å°±æ¯ Generator å½æ°çå®ä¾å¯¹è±¡äºã\n\nfunction* F() {\n  this.a = 1;\n  yield this.b = 2;\n  yield this.c = 3;\n}\nvar obj = {};\nvar f = F.call(obj);\n\nf.next();  // Object {value: 2, done: false}\nf.next();  // Object {value: 3, done: false}\nf.next();  // Object {value: undefined, done: true}\n\nobj.a // 1\nobj.b // 2\nobj.c // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼é¦åæ¯Fåé¨çthiså¯¹è±¡ç»å®objå¯¹è±¡ï¼ç¶åè°ç¨å®ï¼è¿åä¸ä¸ª Iterator å¯¹è±¡ãè¿ä¸ªå¯¹è±¡æ§è¡ä¸æ¬¡nextæ¹æ³ï¼å ä¸ºFåé¨æä¸¤ä¸ªyieldè¡¨è¾¾å¼ï¼ï¼å®æ F åé¨ææä»£ç çè¿è¡ãè¿æ¶ï¼ææåé¨å±æ§é½ç»å®å¨objå¯¹è±¡ä¸äºï¼å æ­¤objå¯¹è±¡ä¹å°±æäºFçå®ä¾ã\n\nä¸é¢ä»£ç ä¸­ï¼æ§è¡çæ¯éåå¨å¯¹è±¡fï¼ä½æ¯çæçå¯¹è±¡å®ä¾æ¯objï¼ææ²¡æåæ³å°è¿ä¸¤ä¸ªå¯¹è±¡ç»ä¸å¢ï¼\n\nä¸ä¸ªåæ³å°±æ¯å°objæ¢æF.prototypeã\n\nfunction* F() {\n  this.a = 1;\n  yield this.b = 2;\n  yield this.c = 3;\n}\nvar f = F.call(F.prototype);\n\nf.next();  // Object {value: 2, done: false}\nf.next();  // Object {value: 3, done: false}\nf.next();  // Object {value: undefined, done: true}\n\nf.a // 1\nf.b // 2\nf.c // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nåå°Fæ¹ææé å½æ°ï¼å°±å¯ä»¥å¯¹å®æ§è¡newå½ä»¤äºã\n\nfunction* gen() {\n  this.a = 1;\n  yield this.b = 2;\n  yield this.c = 3;\n}\n\nfunction F() {\n  return gen.call(gen.prototype);\n}\n\nvar f = new F();\n\nf.next();  // Object {value: 2, done: false}\nf.next();  // Object {value: 3, done: false}\nf.next();  // Object {value: undefined, done: true}\n\nf.a // 1\nf.b // 2\nf.c // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n# å«ä¹\n\n\n# Generator ä¸ç¶ææº\n\nGenerator æ¯å®ç°ç¶ææºçæä½³ç»æãæ¯å¦ï¼ä¸é¢çclockå½æ°å°±æ¯ä¸ä¸ªç¶ææºã\n\nvar ticking = true;\nvar clock = function() {\n  if (ticking)\n    console.log('Tick!');\n  else\n    console.log('Tock!');\n  ticking = !ticking;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç çclockå½æ°ä¸å±æä¸¤ç§ç¶æï¼TickåTockï¼ï¼æ¯è¿è¡ä¸æ¬¡ï¼å°±æ¹åä¸æ¬¡ç¶æãè¿ä¸ªå½æ°å¦æç¨ Generator å®ç°ï¼å°±æ¯ä¸é¢è¿æ ·ã\n\nvar clock = function* () {\n  while (true) {\n    console.log('Tick!');\n    yield;\n    console.log('Tock!');\n    yield;\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ç Generator å®ç°ä¸ ES5 å®ç°å¯¹æ¯ï¼å¯ä»¥çå°å°äºç¨æ¥ä¿å­ç¶æçå¤é¨åétickingï¼è¿æ ·å°±æ´ç®æ´ï¼æ´å®å¨ï¼ç¶æä¸ä¼è¢«éæ³ç¯¡æ¹ï¼ãæ´ç¬¦åå½æ°å¼ç¼ç¨çææ³ï¼å¨åæ³ä¸ä¹æ´ä¼éãGenerator ä¹æä»¥å¯ä»¥ä¸ç¨å¤é¨åéä¿å­ç¶æï¼æ¯å ä¸ºå®æ¬èº«å°±åå«äºä¸ä¸ªç¶æä¿¡æ¯ï¼å³ç®åæ¯å¦å¤äºæåæã\n\n\n# Generator ä¸åç¨\n\nåç¨ï¼coroutineï¼æ¯ä¸ç§ç¨åºè¿è¡çæ¹å¼ï¼å¯ä»¥çè§£æâåä½ççº¿ç¨âæâåä½çå½æ°âãåç¨æ¢å¯ä»¥ç¨åçº¿ç¨å®ç°ï¼ä¹å¯ä»¥ç¨å¤çº¿ç¨å®ç°ãåèæ¯ä¸ç§ç¹æ®çå­ä¾ç¨ï¼åèæ¯ä¸ç§ç¹æ®ççº¿ç¨ã\n\nï¼1ï¼åç¨ä¸å­ä¾ç¨çå·®å¼\n\nä¼ ç»çâå­ä¾ç¨âï¼subroutineï¼éç¨å æ å¼âåè¿ååºâçæ§è¡æ¹å¼ï¼åªæå½è°ç¨çå­å½æ°å®å¨æ§è¡å®æ¯ï¼æä¼ç»ææ§è¡ç¶å½æ°ãåç¨ä¸å¶ä¸åï¼å¤ä¸ªçº¿ç¨ï¼åçº¿ç¨æåµä¸ï¼å³å¤ä¸ªå½æ°ï¼å¯ä»¥å¹¶è¡æ§è¡ï¼ä½æ¯åªæä¸ä¸ªçº¿ç¨ï¼æå½æ°ï¼å¤äºæ­£å¨è¿è¡çç¶æï¼å¶ä»çº¿ç¨ï¼æå½æ°ï¼é½å¤äºæåæï¼suspendedï¼ï¼çº¿ç¨ï¼æå½æ°ï¼ä¹é´å¯ä»¥äº¤æ¢æ§è¡æãä¹å°±æ¯è¯´ï¼ä¸ä¸ªçº¿ç¨ï¼æå½æ°ï¼æ§è¡å°ä¸åï¼å¯ä»¥æåæ§è¡ï¼å°æ§è¡æäº¤ç»å¦ä¸ä¸ªçº¿ç¨ï¼æå½æ°ï¼ï¼ç­å°ç¨åæ¶åæ§è¡æçæ¶åï¼åæ¢å¤æ§è¡ãè¿ç§å¯ä»¥å¹¶è¡æ§è¡ãäº¤æ¢æ§è¡æççº¿ç¨ï¼æå½æ°ï¼ï¼å°±ç§°ä¸ºåç¨ã\n\nä»å®ç°ä¸çï¼å¨åå­ä¸­ï¼å­ä¾ç¨åªä½¿ç¨ä¸ä¸ªæ ï¼stackï¼ï¼èåç¨æ¯åæ¶å­å¨å¤ä¸ªæ ï¼ä½åªæä¸ä¸ªæ æ¯å¨è¿è¡ç¶æï¼ä¹å°±æ¯è¯´ï¼åç¨æ¯ä»¥å¤å ç¨åå­ä¸ºä»£ä»·ï¼å®ç°å¤ä»»å¡çå¹¶è¡ã\n\nï¼2ï¼åç¨ä¸æ®éçº¿ç¨çå·®å¼\n\nä¸é¾çåºï¼åç¨éåç¨äºå¤ä»»å¡è¿è¡çç¯å¢ãå¨è¿ä¸ªæä¹ä¸ï¼å®ä¸æ®éççº¿ç¨å¾ç¸ä¼¼ï¼é½æèªå·±çæ§è¡ä¸ä¸æãå¯ä»¥åäº«å¨å±åéãå®ä»¬çä¸åä¹å¤å¨äºï¼åä¸æ¶é´å¯ä»¥æå¤ä¸ªçº¿ç¨å¤äºè¿è¡ç¶æï¼ä½æ¯è¿è¡çåç¨åªè½æä¸ä¸ªï¼å¶ä»åç¨é½å¤äºæåç¶æãæ­¤å¤ï¼æ®éççº¿ç¨æ¯æ¢åå¼çï¼å°åºåªä¸ªçº¿ç¨ä¼åå¾å°èµæºï¼å¿é¡»ç±è¿è¡ç¯å¢å³å®ï¼ä½æ¯åç¨æ¯åä½å¼çï¼æ§è¡æç±åç¨èªå·±åéã\n\nç±äº JavaScript æ¯åçº¿ç¨è¯­è¨ï¼åªè½ä¿æä¸ä¸ªè°ç¨æ ãå¼å¥åç¨ä»¥åï¼æ¯ä¸ªä»»å¡å¯ä»¥ä¿æèªå·±çè°ç¨æ ãè¿æ ·åçæå¤§å¥½å¤ï¼å°±æ¯æåºéè¯¯çæ¶åï¼å¯ä»¥æ¾å°åå§çè°ç¨æ ãä¸è³äºåå¼æ­¥æä½çåè°å½æ°é£æ ·ï¼ä¸æ¦åºéï¼åå§çè°ç¨æ æ©å°±ç»æã\n\nGenerator å½æ°æ¯ ES6 å¯¹åç¨çå®ç°ï¼ä½å±äºä¸å®å¨å®ç°ãGenerator å½æ°è¢«ç§°ä¸ºâååç¨âï¼semi-coroutineï¼ï¼æææ¯åªæ Generator å½æ°çè°ç¨èï¼æè½å°ç¨åºçæ§è¡æè¿ç» Generator å½æ°ãå¦ææ¯å®å¨æ§è¡çåç¨ï¼ä»»ä½å½æ°é½å¯ä»¥è®©æåçåç¨ç»§ç»­æ§è¡ã\n\nå¦æå° Generator å½æ°å½ä½åç¨ï¼å®å¨å¯ä»¥å°å¤ä¸ªéè¦äºç¸åä½çä»»å¡åæ Generator å½æ°ï¼å®ä»¬ä¹é´ä½¿ç¨yieldè¡¨è¾¾å¼äº¤æ¢æ§å¶æã\n\n\n# Generator ä¸ä¸ä¸æ\n\nJavaScript ä»£ç è¿è¡æ¶ï¼ä¼äº§çä¸ä¸ªå¨å±çä¸ä¸æç¯å¢ï¼contextï¼åç§°è¿è¡ç¯å¢ï¼ï¼åå«äºå½åææçåéåå¯¹è±¡ãç¶åï¼æ§è¡å½æ°ï¼æåçº§ä»£ç ï¼çæ¶åï¼åä¼å¨å½åä¸ä¸æç¯å¢çä¸å±ï¼äº§çä¸ä¸ªå½æ°è¿è¡çä¸ä¸æï¼åæå½åï¼activeï¼çä¸ä¸æï¼ç±æ­¤å½¢æä¸ä¸ªä¸ä¸æç¯å¢çå æ ï¼context stackï¼ã\n\nè¿ä¸ªå æ æ¯âåè¿ååºâçæ°æ®ç»æï¼æåäº§ççä¸ä¸æç¯å¢é¦åæ§è¡å®æï¼éåºå æ ï¼ç¶ååæ§è¡å®æå®ä¸å±çä¸ä¸æï¼ç´è³ææä»£ç æ§è¡å®æï¼å æ æ¸ç©ºã\n\nGenerator å½æ°ä¸æ¯è¿æ ·ï¼å®æ§è¡äº§ççä¸ä¸æç¯å¢ï¼ä¸æ¦éå°yieldå½ä»¤ï¼å°±ä¼ææ¶éåºå æ ï¼ä½æ¯å¹¶ä¸æ¶å¤±ï¼éé¢çææåéåå¯¹è±¡ä¼å»ç»å¨å½åç¶æãç­å°å¯¹å®æ§è¡nextå½ä»¤æ¶ï¼è¿ä¸ªä¸ä¸æç¯å¢åä¼éæ°å å¥è°ç¨æ ï¼å»ç»çåéåå¯¹è±¡æ¢å¤æ§è¡ã\n\nfunction* gen() {\n  yield 1;\n  return 2;\n}\n\nlet g = gen();\n\nconsole.log(\n  g.next().value,\n  g.next().value,\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬ä¸æ¬¡æ§è¡g.next()æ¶ï¼Generator å½æ°gençä¸ä¸æä¼å å¥å æ ï¼å³å¼å§è¿è¡genåé¨çä»£ç ãç­éå°yield 1æ¶ï¼genä¸ä¸æéåºå æ ï¼åé¨ç¶æå»ç»ãç¬¬äºæ¬¡æ§è¡g.next()æ¶ï¼genä¸ä¸æéæ°å å¥å æ ï¼åæå½åçä¸ä¸æï¼éæ°æ¢å¤æ§è¡ã\n\n\n# åºç¨\n\nGenerator å¯ä»¥æåå½æ°æ§è¡ï¼è¿åä»»æè¡¨è¾¾å¼çå¼ãè¿ç§ç¹ç¹ä½¿å¾ Generator æå¤ç§åºç¨åºæ¯ã\n\n\n# ï¼1ï¼å¼æ­¥æä½çåæ­¥åè¡¨è¾¾\n\nGenerator å½æ°çæåæ§è¡çææï¼æå³çå¯ä»¥æå¼æ­¥æä½åå¨yieldè¡¨è¾¾å¼éé¢ï¼ç­å°è°ç¨nextæ¹æ³æ¶åå¾åæ§è¡ãè¿å®éä¸ç­åäºä¸éè¦ååè°å½æ°äºï¼å ä¸ºå¼æ­¥æä½çåç»­æä½å¯ä»¥æ¾å¨yieldè¡¨è¾¾å¼ä¸é¢ï¼åæ­£è¦ç­å°è°ç¨nextæ¹æ³æ¶åæ§è¡ãæä»¥ï¼Generator å½æ°çä¸ä¸ªéè¦å®éæä¹å°±æ¯ç¨æ¥å¤çå¼æ­¥æä½ï¼æ¹ååè°å½æ°ã\n\nfunction* loadUI() {\n  showLoadingScreen();\n  yield loadUIDataAsynchronously();\n  hideLoadingScreen();\n}\nvar loader = loadUI();\n// å è½½UI\nloader.next()\n\n// å¸è½½UI\nloader.next()\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬ä¸æ¬¡è°ç¨loadUIå½æ°æ¶ï¼è¯¥å½æ°ä¸ä¼æ§è¡ï¼ä»è¿åä¸ä¸ªéåå¨ãä¸ä¸æ¬¡å¯¹è¯¥éåå¨è°ç¨nextæ¹æ³ï¼åä¼æ¾ç¤ºLoadingçé¢ï¼showLoadingScreenï¼ï¼å¹¶ä¸å¼æ­¥å è½½æ°æ®ï¼loadUIDataAsynchronouslyï¼ãç­å°æ°æ®å è½½å®æï¼åä¸æ¬¡ä½¿ç¨nextæ¹æ³ï¼åä¼éèLoadingçé¢ãå¯ä»¥çå°ï¼è¿ç§åæ³çå¥½å¤æ¯ææLoadingçé¢çé»è¾ï¼é½è¢«å°è£å¨ä¸ä¸ªå½æ°ï¼æé¨å°±ç­éå¸¸æ¸æ°ã\n\nAjax æ¯å¸åçå¼æ­¥æä½ï¼éè¿ Generator å½æ°é¨ç½² Ajax æä½ï¼å¯ä»¥ç¨åæ­¥çæ¹å¼è¡¨è¾¾ã\n\nfunction* main() {\n  var result = yield request(\"http://some.url\");\n  var resp = JSON.parse(result);\n    console.log(resp.value);\n}\n\nfunction request(url) {\n  makeAjaxCall(url, function(response){\n    it.next(response);\n  });\n}\n\nvar it = main();\nit.next();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç çmainå½æ°ï¼å°±æ¯éè¿ Ajax æä½è·åæ°æ®ãå¯ä»¥çå°ï¼é¤äºå¤äºä¸ä¸ªyieldï¼å®å ä¹ä¸åæ­¥æä½çåæ³å®å¨ä¸æ ·ãæ³¨æï¼makeAjaxCallå½æ°ä¸­çnextæ¹æ³ï¼å¿é¡»å ä¸responseåæ°ï¼å ä¸ºyieldè¡¨è¾¾å¼ï¼æ¬èº«æ¯æ²¡æå¼çï¼æ»æ¯ç­äºundefinedã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ï¼éè¿ Generator å½æ°éè¡è¯»åææ¬æä»¶ã\n\nfunction* numbers() {\n  let file = new FileReader(\"numbers.txt\");\n  try {\n    while(!file.eof) {\n      yield parseInt(file.readLine(), 10);\n    }\n  } finally {\n    file.close();\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç æå¼ææ¬æä»¶ï¼ä½¿ç¨yieldè¡¨è¾¾å¼å¯ä»¥æå¨éè¡è¯»åæä»¶ã\n\n\n# ï¼2ï¼æ§å¶æµç®¡ç\n\nå¦ææä¸ä¸ªå¤æ­¥æä½éå¸¸èæ¶ï¼éç¨åè°å½æ°ï¼å¯è½ä¼åæä¸é¢è¿æ ·ã\n\nstep1(function (value1) {\n  step2(value1, function(value2) {\n    step3(value2, function(value3) {\n      step4(value3, function(value4) {\n        // Do something with value4\n      });\n    });\n  });\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\néç¨ Promise æ¹åä¸é¢çä»£ç ã\n\nPromise.resolve(step1)\n  .then(step2)\n  .then(step3)\n  .then(step4)\n  .then(function (value4) {\n    // Do something with value4\n  }, function (error) {\n    // Handle any error from step1 through step4\n  })\n  .done();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å·²ç»æåè°å½æ°ï¼æ¹æäºç´çº¿æ§è¡çå½¢å¼ï¼ä½æ¯å å¥äºå¤§é Promise çè¯­æ³ãGenerator å½æ°å¯ä»¥è¿ä¸æ­¥æ¹åä»£ç è¿è¡æµç¨ã\n\nfunction* longRunningTask(value1) {\n  try {\n    var value2 = yield step1(value1);\n    var value3 = yield step2(value2);\n    var value4 = yield step3(value3);\n    var value5 = yield step4(value4);\n    // Do something with value4\n  } catch (e) {\n    // Handle any error from step1 through step4\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nç¶åï¼ä½¿ç¨ä¸ä¸ªå½æ°ï¼ææ¬¡åºèªå¨æ§è¡æææ­¥éª¤ã\n\nscheduler(longRunningTask(initialValue));\n\nfunction scheduler(task) {\n  var taskObj = task.next(task.value);\n  // å¦æGeneratorå½æ°æªç»æï¼å°±ç»§ç»­è°ç¨\n  if (!taskObj.done) {\n    task.value = taskObj.value\n    scheduler(task);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\næ³¨æï¼ä¸é¢è¿ç§åæ³ï¼åªéååæ­¥æä½ï¼å³ææçtaské½å¿é¡»æ¯åæ­¥çï¼ä¸è½æå¼æ­¥æä½ãå ä¸ºè¿éçä»£ç ä¸å¾å°è¿åå¼ï¼å°±ç»§ç»­å¾ä¸æ§è¡ï¼æ²¡æå¤æ­å¼æ­¥æä½ä½æ¶å®æãå¦æè¦æ§å¶å¼æ­¥çæä½æµç¨ï¼è¯¦è§åé¢çãå¼æ­¥æä½ãä¸ç« ã\n\nä¸é¢ï¼å©ç¨for...ofå¾ªç¯ä¼èªå¨ä¾æ¬¡æ§è¡yieldå½ä»¤çç¹æ§ï¼æä¾ä¸ç§æ´ä¸è¬çæ§å¶æµç®¡ççæ¹æ³ã\n\nlet steps = [step1Func, step2Func, step3Func];\n\nfunction* iterateSteps(steps){\n  for (var i=0; i< steps.length; i++){\n    var step = steps[i];\n    yield step();\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»stepså°è£äºä¸ä¸ªä»»å¡çå¤ä¸ªæ­¥éª¤ï¼Generator å½æ°iterateStepsåæ¯ä¾æ¬¡ä¸ºè¿äºæ­¥éª¤å ä¸yieldå½ä»¤ã\n\nå°ä»»å¡åè§£ææ­¥éª¤ä¹åï¼è¿å¯ä»¥å°é¡¹ç®åè§£æå¤ä¸ªä¾æ¬¡æ§è¡çä»»å¡ã\n\nlet jobs = [job1, job2, job3];\n\nfunction* iterateJobs(jobs){\n  for (var i=0; i< jobs.length; i++){\n    var job = jobs[i];\n    yield* iterateSteps(job.steps);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»jobså°è£äºä¸ä¸ªé¡¹ç®çå¤ä¸ªä»»å¡ï¼Generator å½æ°iterateJobsåæ¯ä¾æ¬¡ä¸ºè¿äºä»»å¡å ä¸yield*å½ä»¤ã\n\næåï¼å°±å¯ä»¥ç¨for...ofå¾ªç¯ä¸æ¬¡æ§ä¾æ¬¡æ§è¡ææä»»å¡çæææ­¥éª¤ã\n\nfor (var step of iterateJobs(jobs)){\n  console.log(step.id);\n}\n\n\n1\n2\n3\n\n\nåæ¬¡æéï¼ä¸é¢çåæ³åªè½ç¨äºæææ­¥éª¤é½æ¯åæ­¥æä½çæåµï¼ä¸è½æå¼æ­¥æä½çæ­¥éª¤ãå¦ææ³è¦ä¾æ¬¡æ§è¡å¼æ­¥çæ­¥éª¤ï¼å¿é¡»ä½¿ç¨åé¢çãå¼æ­¥æä½ãä¸ç« ä»ç»çæ¹æ³ã\n\nfor...ofçæ¬è´¨æ¯ä¸ä¸ªwhileå¾ªç¯ï¼æä»¥ä¸é¢çä»£ç å®è´¨ä¸æ§è¡çæ¯ä¸é¢çé»è¾ã\n\nvar it = iterateJobs(jobs);\nvar res = it.next();\n\nwhile (!res.done){\n  var result = res.value;\n  // ...\n  res = it.next();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# ï¼3ï¼é¨ç½² Iterator æ¥å£\n\nå©ç¨ Generator å½æ°ï¼å¯ä»¥å¨ä»»æå¯¹è±¡ä¸é¨ç½² Iterator æ¥å£ã\n\nfunction* iterEntries(obj) {\n  let keys = Object.keys(obj);\n  for (let i=0; i < keys.length; i++) {\n    let key = keys[i];\n    yield [key, obj[key]];\n  }\n}\n\nlet myObj = { foo: 3, bar: 7 };\n\nfor (let [key, value] of iterEntries(myObj)) {\n  console.log(key, value);\n}\n\n// foo 3\n// bar 7\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸è¿°ä»£ç ä¸­ï¼myObjæ¯ä¸ä¸ªæ®éå¯¹è±¡ï¼éè¿iterEntrieså½æ°ï¼å°±æäº Iterator æ¥å£ãä¹å°±æ¯è¯´ï¼å¯ä»¥å¨ä»»æå¯¹è±¡ä¸é¨ç½²nextæ¹æ³ã\n\nä¸é¢æ¯ä¸ä¸ªå¯¹æ°ç»é¨ç½² Iterator æ¥å£çä¾å­ï¼å°½ç®¡æ°ç»åçå·æè¿ä¸ªæ¥å£ã\n\nfunction* makeSimpleGenerator(array){\n  var nextIndex = 0;\n\n  while(nextIndex < array.length){\n    yield array[nextIndex++];\n  }\n}\n\nvar gen = makeSimpleGenerator(['yo', 'ya']);\n\ngen.next().value // 'yo'\ngen.next().value // 'ya'\ngen.next().done  // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# ï¼4ï¼ä½ä¸ºæ°æ®ç»æ\n\nGenerator å¯ä»¥çä½æ¯æ°æ®ç»æï¼æ´ç¡®åå°è¯´ï¼å¯ä»¥çä½æ¯ä¸ä¸ªæ°ç»ç»æï¼å ä¸º Generator å½æ°å¯ä»¥è¿åä¸ç³»åçå¼ï¼è¿æå³çå®å¯ä»¥å¯¹ä»»æè¡¨è¾¾å¼ï¼æä¾ç±»ä¼¼æ°ç»çæ¥å£ã\n\nfunction* doStuff() {\n  yield fs.readFile.bind(null, 'hello.txt');\n  yield fs.readFile.bind(null, 'world.txt');\n  yield fs.readFile.bind(null, 'and-such.txt');\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç å°±æ¯ä¾æ¬¡è¿åä¸ä¸ªå½æ°ï¼ä½æ¯ç±äºä½¿ç¨äº Generator å½æ°ï¼å¯¼è´å¯ä»¥åå¤çæ°ç»é£æ ·ï¼å¤çè¿ä¸ä¸ªè¿åçå½æ°ã\n\nfor (task of doStuff()) {\n  // taskæ¯ä¸ä¸ªå½æ°ï¼å¯ä»¥ååè°å½æ°é£æ ·ä½¿ç¨å®\n}\n\n\n1\n2\n3\n\n\nå®éä¸ï¼å¦æç¨ ES5 è¡¨è¾¾ï¼å®å¨å¯ä»¥ç¨æ°ç»æ¨¡æ Generator çè¿ç§ç¨æ³ã\n\nfunction doStuff() {\n  return [\n    fs.readFile.bind(null, 'hello.txt'),\n    fs.readFile.bind(null, 'world.txt'),\n    fs.readFile.bind(null, 'and-such.txt')\n  ];\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢çå½æ°ï¼å¯ä»¥ç¨ä¸æ¨¡ä¸æ ·çfor...ofå¾ªç¯å¤çï¼ä¸¤ç¸ä¸æ¯è¾ï¼å°±ä¸é¾çåº Generator ä½¿å¾æ°æ®æèæä½ï¼å·å¤äºç±»ä¼¼æ°ç»çæ¥å£ã",normalizedContent:"# generator å½æ°çè¯­æ³\n\n\n# ç®ä»\n\n\n# åºæ¬æ¦å¿µ\n\ngenerator å½æ°æ¯ es6 æä¾çä¸ç§å¼æ­¥ç¼ç¨è§£å³æ¹æ¡ï¼è¯­æ³è¡ä¸ºä¸ä¼ ç»å½æ°å®å¨ä¸åãæ¬ç« è¯¦ç»ä»ç» generator å½æ°çè¯­æ³å apiï¼å®çå¼æ­¥ç¼ç¨åºç¨è¯·çãgenerator å½æ°çå¼æ­¥åºç¨ãä¸ç« ã generator å½æ°æå¤ç§çè§£è§åº¦ãè¯­æ³ä¸ï¼é¦åå¯ä»¥æå®çè§£æï¼generator å½æ°æ¯ä¸ä¸ªç¶ææºï¼å°è£äºå¤ä¸ªåé¨ç¶æã\n\næ§è¡ generator å½æ°ä¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼ä¹å°±æ¯è¯´ï¼generator å½æ°é¤äºç¶ææºï¼è¿æ¯ä¸ä¸ªéåå¨å¯¹è±¡çæå½æ°ãè¿åçéåå¨å¯¹è±¡ï¼å¯ä»¥ä¾æ¬¡éå generator å½æ°åé¨çæ¯ä¸ä¸ªç¶æã\n\nå½¢å¼ä¸ï¼generator å½æ°æ¯ä¸ä¸ªæ®éå½æ°ï¼ä½æ¯æä¸¤ä¸ªç¹å¾ãä¸æ¯ï¼functionå³é®å­ä¸å½æ°åä¹é´æä¸ä¸ªæå·ï¼äºæ¯ï¼å½æ°ä½åé¨ä½¿ç¨yieldè¡¨è¾¾å¼ï¼å®ä¹ä¸åçåé¨ç¶æï¼yieldå¨è±è¯­éçææå°±æ¯âäº§åºâï¼ã\n\nfunction* helloworldgenerator() {\n  yield 'hello';\n  yield 'world';\n  return 'ending';\n}\n\nvar hw = helloworldgenerator();\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç å®ä¹äºä¸ä¸ª generator å½æ°helloworldgeneratorï¼å®åé¨æä¸¤ä¸ªyieldè¡¨è¾¾å¼ï¼helloåworldï¼ï¼å³è¯¥å½æ°æä¸ä¸ªç¶æï¼helloï¼world å return è¯­å¥ï¼ç»ææ§è¡ï¼ã\n\nç¶åï¼generator å½æ°çè°ç¨æ¹æ³ä¸æ®éå½æ°ä¸æ ·ï¼ä¹æ¯å¨å½æ°ååé¢å ä¸ä¸å¯¹åæ¬å·ãä¸åçæ¯ï¼è°ç¨ generator å½æ°åï¼è¯¥å½æ°å¹¶ä¸æ§è¡ï¼è¿åçä¹ä¸æ¯å½æ°è¿è¡ç»æï¼èæ¯ä¸ä¸ªæååé¨ç¶æçæéå¯¹è±¡ï¼ä¹å°±æ¯ä¸ä¸ç« ä»ç»çéåå¨å¯¹è±¡ï¼iterator objectï¼ã\n\nä¸ä¸æ­¥ï¼å¿é¡»è°ç¨éåå¨å¯¹è±¡çnextæ¹æ³ï¼ä½¿å¾æéç§»åä¸ä¸ä¸ªç¶æãä¹å°±æ¯è¯´ï¼æ¯æ¬¡è°ç¨nextæ¹æ³ï¼åé¨æéå°±ä»å½æ°å¤´é¨æä¸ä¸æ¬¡åä¸æ¥çå°æ¹å¼å§æ§è¡ï¼ç´å°éå°ä¸ä¸ä¸ªyieldè¡¨è¾¾å¼ï¼æreturnè¯­å¥ï¼ä¸ºæ­¢ãæ¢è¨ä¹ï¼generator å½æ°æ¯åæ®µæ§è¡çï¼yieldè¡¨è¾¾å¼æ¯æåæ§è¡çæ è®°ï¼ènextæ¹æ³å¯ä»¥æ¢å¤æ§è¡ã\n\nhw.next()\n// { value: 'hello', done: false }\n\nhw.next()\n// { value: 'world', done: false }\n\nhw.next()\n// { value: 'ending', done: true }\n\nhw.next()\n// { value: undefined, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸å±è°ç¨äºåæ¬¡nextæ¹æ³ã\n\nç¬¬ä¸æ¬¡è°ç¨ï¼generator å½æ°å¼å§æ§è¡ï¼ç´å°éå°ç¬¬ä¸ä¸ªyieldè¡¨è¾¾å¼ä¸ºæ­¢ãnextæ¹æ³è¿åä¸ä¸ªå¯¹è±¡ï¼å®çvalueå±æ§å°±æ¯å½åyieldè¡¨è¾¾å¼çå¼helloï¼doneå±æ§çå¼falseï¼è¡¨ç¤ºéåè¿æ²¡æç»æã\n\nç¬¬äºæ¬¡è°ç¨ï¼generator å½æ°ä»ä¸æ¬¡yieldè¡¨è¾¾å¼åä¸çå°æ¹ï¼ä¸ç´æ§è¡å°ä¸ä¸ä¸ªyieldè¡¨è¾¾å¼ãnextæ¹æ³è¿åçå¯¹è±¡çvalueå±æ§å°±æ¯å½åyieldè¡¨è¾¾å¼çå¼worldï¼doneå±æ§çå¼falseï¼è¡¨ç¤ºéåè¿æ²¡æç»æã\n\nç¬¬ä¸æ¬¡è°ç¨ï¼generator å½æ°ä»ä¸æ¬¡yieldè¡¨è¾¾å¼åä¸çå°æ¹ï¼ä¸ç´æ§è¡å°returnè¯­å¥ï¼å¦ææ²¡æreturnè¯­å¥ï¼å°±æ§è¡å°å½æ°ç»æï¼ãnextæ¹æ³è¿åçå¯¹è±¡çvalueå±æ§ï¼å°±æ¯ç´§è·å¨returnè¯­å¥åé¢çè¡¨è¾¾å¼çå¼ï¼å¦ææ²¡æreturnè¯­å¥ï¼åvalueå±æ§çå¼ä¸ºundefinedï¼ï¼doneå±æ§çå¼trueï¼è¡¨ç¤ºéåå·²ç»ç»æã\n\nç¬¬åæ¬¡è°ç¨ï¼æ­¤æ¶ generator å½æ°å·²ç»è¿è¡å®æ¯ï¼nextæ¹æ³è¿åå¯¹è±¡çvalueå±æ§ä¸ºundefinedï¼doneå±æ§ä¸ºtrueãä»¥ååè°ç¨nextæ¹æ³ï¼è¿åçé½æ¯è¿ä¸ªå¼ã\n\næ»ç»ä¸ä¸ï¼è°ç¨ generator å½æ°ï¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼ä»£è¡¨ generator å½æ°çåé¨æéãä»¥åï¼æ¯æ¬¡è°ç¨éåå¨å¯¹è±¡çnextæ¹æ³ï¼å°±ä¼è¿åä¸ä¸ªæçvalueådoneä¸¤ä¸ªå±æ§çå¯¹è±¡ãvalueå±æ§è¡¨ç¤ºå½åçåé¨ç¶æçå¼ï¼æ¯yieldè¡¨è¾¾å¼åé¢é£ä¸ªè¡¨è¾¾å¼çå¼ï¼doneå±æ§æ¯ä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºæ¯å¦éåç»æã\n\nes6 æ²¡æè§å®ï¼functionå³é®å­ä¸å½æ°åä¹é´çæå·ï¼åå¨åªä¸ªä½ç½®ãè¿å¯¼è´ä¸é¢çåæ³é½è½éè¿ã\n\nfunction * foo(x, y) { Â·Â·Â· }\nfunction *foo(x, y) { Â·Â·Â· }\nfunction* foo(x, y) { Â·Â·Â· }\nfunction*foo(x, y) { Â·Â·Â· }\n\n\n1\n2\n3\n4\n\n\nç±äº generator å½æ°ä»ç¶æ¯æ®éå½æ°ï¼æä»¥ä¸è¬çåæ³æ¯ä¸é¢çç¬¬ä¸ç§ï¼å³æå·ç´§è·å¨functionå³é®å­åé¢ãæ¬ä¹¦ä¹éç¨è¿ç§åæ³ã\n\n\n# yield è¡¨è¾¾å¼\n\nç±äº generator å½æ°è¿åçéåå¨å¯¹è±¡ï¼åªæè°ç¨nextæ¹æ³æä¼éåä¸ä¸ä¸ªåé¨ç¶æï¼æä»¥å¶å®æä¾äºä¸ç§å¯ä»¥æåæ§è¡çå½æ°ãyieldè¡¨è¾¾å¼å°±æ¯æåæ å¿ã\n\néåå¨å¯¹è±¡çnextæ¹æ³çè¿è¡é»è¾å¦ä¸ã\n\nï¼1ï¼éå°yieldè¡¨è¾¾å¼ï¼å°±æåæ§è¡åé¢çæä½ï¼å¹¶å°ç´§è·å¨yieldåé¢çé£ä¸ªè¡¨è¾¾å¼çå¼ï¼ä½ä¸ºè¿åçå¯¹è±¡çvalueå±æ§å¼ã\n\nï¼2ï¼ä¸ä¸æ¬¡è°ç¨nextæ¹æ³æ¶ï¼åç»§ç»­å¾ä¸æ§è¡ï¼ç´å°éå°ä¸ä¸ä¸ªyieldè¡¨è¾¾å¼ã\n\nï¼3ï¼å¦ææ²¡æåéå°æ°çyieldè¡¨è¾¾å¼ï¼å°±ä¸ç´è¿è¡å°å½æ°ç»æï¼ç´å°returnè¯­å¥ä¸ºæ­¢ï¼å¹¶å°returnè¯­å¥åé¢çè¡¨è¾¾å¼çå¼ï¼ä½ä¸ºè¿åçå¯¹è±¡çvalueå±æ§å¼ã\n\nï¼4ï¼å¦æè¯¥å½æ°æ²¡æreturnè¯­å¥ï¼åè¿åçå¯¹è±¡çvalueå±æ§å¼ä¸ºundefinedã\n\néè¦æ³¨æçæ¯ï¼yieldè¡¨è¾¾å¼åé¢çè¡¨è¾¾å¼ï¼åªæå½è°ç¨nextæ¹æ³ãåé¨æéæåè¯¥è¯­å¥æ¶æä¼æ§è¡ï¼å æ­¤ç­äºä¸º javascript æä¾äºæå¨çâæ°æ§æ±å¼âï¼lazy evaluationï¼çè¯­æ³åè½ã\n\nfunction* gen() {\n  yield  123 + 456;\n}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼yieldåé¢çè¡¨è¾¾å¼123 + 456ï¼ä¸ä¼ç«å³æ±å¼ï¼åªä¼å¨nextæ¹æ³å°æéç§»å°è¿ä¸å¥æ¶ï¼æä¼æ±å¼ã\n\nyieldè¡¨è¾¾å¼ä¸returnè¯­å¥æ¢æç¸ä¼¼ä¹å¤ï¼ä¹æåºå«ãç¸ä¼¼ä¹å¤å¨äºï¼é½è½è¿åç´§è·å¨è¯­å¥åé¢çé£ä¸ªè¡¨è¾¾å¼çå¼ãåºå«å¨äºæ¯æ¬¡éå°yieldï¼å½æ°æåæ§è¡ï¼ä¸ä¸æ¬¡åä»è¯¥ä½ç½®ç»§ç»­ååæ§è¡ï¼è**returnè¯­å¥ä¸å·å¤ä½ç½®è®°å¿çåè½**ãä¸ä¸ªå½æ°éé¢ï¼åªè½æ§è¡ä¸æ¬¡ï¼æèè¯´ä¸ä¸ªï¼returnè¯­å¥ï¼ä½æ¯å¯ä»¥æ§è¡å¤æ¬¡ï¼æèè¯´å¤ä¸ªï¼yieldè¡¨è¾¾å¼ãæ­£å¸¸å½æ°åªè½è¿åä¸ä¸ªå¼ï¼å ä¸ºåªè½æ§è¡ä¸æ¬¡returnï¼generator å½æ°å¯ä»¥è¿åä¸ç³»åçå¼ï¼å ä¸ºå¯ä»¥æä»»æå¤ä¸ªyieldãä»å¦ä¸ä¸ªè§åº¦çï¼ä¹å¯ä»¥è¯´ generator çæäºä¸ç³»åçå¼ï¼è¿ä¹å°±æ¯å®çåç§°çæ¥åï¼è±è¯­ä¸­ï¼generator è¿ä¸ªè¯æ¯âçæå¨âçææï¼ã\n\ngenerator å½æ°å¯ä»¥ä¸ç¨yieldè¡¨è¾¾å¼ï¼è¿æ¶å°±åæäºä¸ä¸ªåçº¯çæç¼æ§è¡å½æ°ã\n\nfunction* f() {\n  console.log('æ§è¡äºï¼')\n}\n\nvar generator = f();\n\nsettimeout(function () {\n  generator.next()\n}, 2000);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°få¦ææ¯æ®éå½æ°ï¼å¨ä¸ºåégeneratorèµå¼æ¶å°±ä¼æ§è¡ãä½æ¯ï¼å½æ°fæ¯ä¸ä¸ª generator å½æ°ï¼å°±åæåªæè°ç¨nextæ¹æ³æ¶ï¼å½æ°fæä¼æ§è¡ã\n\nå¦å¤éè¦æ³¨æï¼yieldè¡¨è¾¾å¼åªè½ç¨å¨ generator å½æ°éé¢ï¼ç¨å¨å¶ä»å°æ¹é½ä¼æ¥éã\n\n(function (){\n  yield 1;\n})()\n// syntaxerror: unexpected number\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç å¨ä¸ä¸ªæ®éå½æ°ä¸­ä½¿ç¨yieldè¡¨è¾¾å¼ï¼ç»æäº§çä¸ä¸ªå¥æ³éè¯¯ã\n\nä¸é¢æ¯å¦å¤ä¸ä¸ªä¾å­ã\n\nvar arr = [1, [[2, 3], 4], [5, 6]];\n\nvar flat = function* (a) {\n  a.foreach(function (item) {\n    if (typeof item !== 'number') {\n      yield* flat(item);\n    } else {\n      yield item;\n    }\n  });\n};\n\nfor (var f of flat(arr)){\n  console.log(f);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¹ä¼äº§çå¥æ³éè¯¯ï¼å ä¸ºforeachæ¹æ³çåæ°æ¯ä¸ä¸ªæ®éå½æ°ï¼ä½æ¯å¨éé¢ä½¿ç¨äºyieldè¡¨è¾¾å¼ï¼è¿ä¸ªå½æ°éé¢è¿ä½¿ç¨äºyield*è¡¨è¾¾å¼ï¼è¯¦ç»ä»ç»è§åæï¼ãä¸ç§ä¿®æ¹æ¹æ³æ¯æ¹ç¨forå¾ªç¯ã\n\nvar arr = [1, [[2, 3], 4], [5, 6]];\n\nvar flat = function* (a) {\n  var length = a.length;\n  for (var i = 0; i < length; i++) {\n    var item = a[i];\n    if (typeof item !== 'number') {\n      yield* flat(item);\n    } else {\n      yield item;\n    }\n  }\n};\n\nfor (var f of flat(arr)) {\n  console.log(f);\n}\n// 1, 2, 3, 4, 5, 6\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nå¦å¤ï¼yieldè¡¨è¾¾å¼å¦æç¨å¨å¦ä¸ä¸ªè¡¨è¾¾å¼ä¹ä¸­ï¼å¿é¡»æ¾å¨åæ¬å·éé¢ã\n\nfunction* demo() {\n  console.log('hello' + yield); // syntaxerror\n  console.log('hello' + yield 123); // syntaxerror\n\n  console.log('hello' + (yield)); // ok\n  console.log('hello' + (yield 123)); // ok\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nyieldè¡¨è¾¾å¼ç¨ä½å½æ°åæ°ææ¾å¨èµå¼è¡¨è¾¾å¼çå³è¾¹ï¼å¯ä»¥ä¸å æ¬å·ã\n\nfunction* demo() {\n  foo(yield 'a', yield 'b'); // ok\n  let input = yield; // ok\n}\n\n\n1\n2\n3\n4\n\n\n\n# ä¸ iterator æ¥å£çå³ç³»\n\nä¸ä¸ç« è¯´è¿ï¼ä»»æä¸ä¸ªå¯¹è±¡çsymbol.iteratoræ¹æ³ï¼ç­äºè¯¥å¯¹è±¡çéåå¨çæå½æ°ï¼è°ç¨è¯¥å½æ°ä¼è¿åè¯¥å¯¹è±¡çä¸ä¸ªéåå¨å¯¹è±¡ã\n\nç±äº generator å½æ°å°±æ¯éåå¨çæå½æ°ï¼å æ­¤å¯ä»¥æ generator èµå¼ç»å¯¹è±¡çsymbol.iteratorå±æ§ï¼ä»èä½¿å¾è¯¥å¯¹è±¡å·æ iterator æ¥å£ã\n\nvar myiterable = {};\nmyiterable[symbol.iterator] = function* () {\n  yield 1;\n  yield 2;\n  yield 3;\n};\n\n[...myiterable] // [1, 2, 3]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼generator å½æ°èµå¼ç»symbol.iteratorå±æ§ï¼ä»èä½¿å¾myiterableå¯¹è±¡å·æäº iterator æ¥å£ï¼å¯ä»¥è¢«...è¿ç®ç¬¦éåäºã\n\ngenerator å½æ°æ§è¡åï¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ãè¯¥å¯¹è±¡æ¬èº«ä¹å·æsymbol.iteratorå±æ§ï¼æ§è¡åè¿åèªèº«ã\n\nfunction* gen(){\n  // some code\n}\n\nvar g = gen();\n\ng[symbol.iterator]() === g\n// true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼genæ¯ä¸ä¸ª generator å½æ°ï¼è°ç¨å®ä¼çæä¸ä¸ªéåå¨å¯¹è±¡gãå®çsymbol.iteratorå±æ§ï¼ä¹æ¯ä¸ä¸ªéåå¨å¯¹è±¡çæå½æ°ï¼æ§è¡åè¿åå®èªå·±ã\n\n\n# next æ¹æ³çåæ°\n\nyieldè¡¨è¾¾å¼æ¬èº«æ²¡æè¿åå¼ï¼æèè¯´æ»æ¯è¿åundefinedãnextæ¹æ³å¯ä»¥å¸¦ä¸ä¸ªåæ°ï¼è¯¥åæ°å°±ä¼è¢«å½ä½ä¸ä¸ä¸ªyieldè¡¨è¾¾å¼çè¿åå¼ã\n\nfunction* f() {\n  for(var i = 0; true; i++) {\n    var reset = yield i;\n    if(reset) { i = -1; }\n  }\n}\n\nvar g = f();\n\ng.next() // { value: 0, done: false }\ng.next() // { value: 1, done: false }\ng.next(true) // { value: 0, done: false } // åæ°true ä¼ ç»ä¸é¢çåéreset\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç åå®ä¹äºä¸ä¸ªå¯ä»¥æ éè¿è¡ç generator å½æ°fï¼å¦ænextæ¹æ³æ²¡æåæ°ï¼æ¯æ¬¡è¿è¡å°yieldè¡¨è¾¾å¼ï¼åéresetçå¼æ»æ¯undefinedãå½nextæ¹æ³å¸¦ä¸ä¸ªåæ°trueæ¶ï¼åéresetå°±è¢«éç½®ä¸ºè¿ä¸ªåæ°ï¼å³trueï¼ï¼å æ­¤iä¼ç­äº-1ï¼ä¸ä¸è½®å¾ªç¯å°±ä¼ä»-1å¼å§éå¢ã\n\nè¿ä¸ªåè½æå¾éè¦çè¯­æ³æä¹ãgenerator å½æ°ä»æåç¶æå°æ¢å¤è¿è¡ï¼å®çä¸ä¸æç¶æï¼contextï¼æ¯ä¸åçãéè¿nextæ¹æ³çåæ°ï¼å°±æåæ³å¨ generator å½æ°å¼å§è¿è¡ä¹åï¼ç»§ç»­åå½æ°ä½åé¨æ³¨å¥å¼ãä¹å°±æ¯è¯´ï¼å¯ä»¥å¨ generator å½æ°è¿è¡çä¸åé¶æ®µï¼ä»å¤é¨ååé¨æ³¨å¥ä¸åçå¼ï¼ä»èè°æ´å½æ°è¡ä¸ºã\n\nåçä¸ä¸ªä¾å­ã\n\nfunction* foo(x) {\n  var y = 2 * (yield (x + 1));\n  var z = yield (y / 3);\n  return (x + y + z);\n}\n\nvar a = foo(5);\na.next() // object{value:6, done:false}\na.next() // object{value:nan, done:false}\na.next() // object{value:nan, done:true}\n\nvar b = foo(5);\nb.next() // { value:6, done:false }\nb.next(12) // { value:8, done:false }\nb.next(13) // { value:42, done:true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬äºæ¬¡è¿è¡nextæ¹æ³çæ¶åä¸å¸¦åæ°ï¼å¯¼è´ y çå¼ç­äº2 * undefinedï¼å³nanï¼ï¼é¤ä»¥ 3 ä»¥åè¿æ¯nanï¼å æ­¤è¿åå¯¹è±¡çvalueå±æ§ä¹ç­äºnanãç¬¬ä¸æ¬¡è¿è¡nextæ¹æ³çæ¶åä¸å¸¦åæ°ï¼æä»¥zç­äºundefinedï¼è¿åå¯¹è±¡çvalueå±æ§ç­äº5 + nan + undefinedï¼å³nanã\n\nå¦æånextæ¹æ³æä¾åæ°ï¼è¿åç»æå°±å®å¨ä¸ä¸æ ·äºãä¸é¢ä»£ç ç¬¬ä¸æ¬¡è°ç¨bçnextæ¹æ³æ¶ï¼è¿åx+1çå¼6ï¼ç¬¬äºæ¬¡è°ç¨nextæ¹æ³ï¼å°ä¸ä¸æ¬¡yieldè¡¨è¾¾å¼çå¼è®¾ä¸º12ï¼å æ­¤yç­äº24ï¼è¿åy / 3çå¼8ï¼ç¬¬ä¸æ¬¡è°ç¨nextæ¹æ³ï¼å°ä¸ä¸æ¬¡yieldè¡¨è¾¾å¼çå¼è®¾ä¸º13ï¼å æ­¤zç­äº13ï¼è¿æ¶xç­äº5ï¼yç­äº24ï¼æä»¥returnè¯­å¥çå¼ç­äº42ã\n\næ³¨æï¼ç±äºnextæ¹æ³çåæ°è¡¨ç¤ºä¸ä¸ä¸ªyieldè¡¨è¾¾å¼çè¿åå¼ï¼æä»¥å¨ç¬¬ä¸æ¬¡ä½¿ç¨nextæ¹æ³æ¶ï¼ä¼ éåæ°æ¯æ æçãv8 å¼æç´æ¥å¿½ç¥ç¬¬ä¸æ¬¡ä½¿ç¨nextæ¹æ³æ¶çåæ°ï¼åªæä»ç¬¬äºæ¬¡ä½¿ç¨nextæ¹æ³å¼å§ï¼åæ°ææ¯ææçãä»è¯­ä¹ä¸è®²ï¼ç¬¬ä¸ä¸ªnextæ¹æ³ç¨æ¥å¯å¨éåå¨å¯¹è±¡ï¼æä»¥ä¸ç¨å¸¦æåæ°ã\n\nåçä¸ä¸ªéè¿nextæ¹æ³çåæ°ï¼å generator å½æ°åé¨è¾å¥å¼çä¾å­ã\n\nfunction* dataconsumer() {\n  console.log('started');\n  console.log(`1. ${yield}`);\n  console.log(`2. ${yield}`);\n  return 'result';\n}\n\nlet genobj = dataconsumer();\ngenobj.next();\n// started\ngenobj.next('a')\n// 1. a\ngenobj.next('b')\n// 2. b\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç æ¯ä¸ä¸ªå¾ç´è§çä¾å­ï¼æ¯æ¬¡éè¿nextæ¹æ³å generator å½æ°è¾å¥å¼ï¼ç¶åæå°åºæ¥ã\n\nå¦ææ³è¦ç¬¬ä¸æ¬¡è°ç¨nextæ¹æ³æ¶ï¼å°±è½å¤è¾å¥å¼ï¼å¯ä»¥å¨ generator å½æ°å¤é¢ååä¸å±ã\n\nfunction wrapper(generatorfunction) {\n  return function (...args) {\n    let generatorobject = generatorfunction(...args);\n    generatorobject.next();\n    return generatorobject;\n  };\n}\n\nconst wrapped = wrapper(function* () {\n  console.log(`first input: ${yield}`);\n  return 'done';\n});\n\nwrapped().next('hello!')\n// first input: hello!\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼generator å½æ°å¦æä¸ç¨wrapperååä¸å±ï¼æ¯æ æ³ç¬¬ä¸æ¬¡è°ç¨nextæ¹æ³ï¼å°±è¾å¥åæ°çã\n\n\n# for...of å¾ªç¯\n\nfor...ofå¾ªç¯å¯ä»¥èªå¨éå generator å½æ°è¿è¡æ¶çæçiteratorå¯¹è±¡ï¼ä¸æ­¤æ¶ä¸åéè¦è°ç¨nextæ¹æ³ã\n\nfunction* foo() {\n  yield 1;\n  yield 2;\n  yield 3;\n  yield 4;\n  yield 5;\n  return 6;\n}\n\nfor (let v of foo()) {\n  console.log(v);\n}\n// 1 2 3 4 5\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä½¿ç¨for...ofå¾ªç¯ï¼ä¾æ¬¡æ¾ç¤º 5 ä¸ªyieldè¡¨è¾¾å¼çå¼ãè¿ééè¦æ³¨æï¼ä¸æ¦nextæ¹æ³çè¿åå¯¹è±¡çdoneå±æ§ä¸ºtrueï¼for...ofå¾ªç¯å°±ä¼ä¸­æ­¢ï¼ä¸ä¸åå«è¯¥è¿åå¯¹è±¡ï¼æä»¥ä¸é¢ä»£ç çreturnè¯­å¥è¿åç6ï¼ä¸åæ¬å¨for...ofå¾ªç¯ä¹ä¸­ã\n\nä¸é¢æ¯ä¸ä¸ªå©ç¨ generator å½æ°åfor...ofå¾ªç¯ï¼å®ç°ææ³¢é£å¥æ°åçä¾å­ã\n\nfunction* fibonacci() {\n  let [prev, curr] = [0, 1];\n  for (;;) {\n    yield curr;\n    [prev, curr] = [curr, prev + curr];\n  }\n}\n\nfor (let n of fibonacci()) {\n  if (n > 1000) break;\n  console.log(n);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä»ä¸é¢ä»£ç å¯è§ï¼ä½¿ç¨for...ofè¯­å¥æ¶ä¸éè¦ä½¿ç¨nextæ¹æ³ã\n\nå©ç¨for...ofå¾ªç¯ï¼å¯ä»¥ååºéåä»»æå¯¹è±¡ï¼objectï¼çæ¹æ³ãåçç javascript å¯¹è±¡æ²¡æéåæ¥å£ï¼æ æ³ä½¿ç¨for...ofå¾ªç¯ï¼éè¿ generator å½æ°ä¸ºå®å ä¸è¿ä¸ªæ¥å£ï¼å°±å¯ä»¥ç¨äºã\n\nfunction* objectentries(obj) {\n  let propkeys = reflect.ownkeys(obj);\n\n  for (let propkey of propkeys) {\n    yield [propkey, obj[propkey]];\n  }\n}\n\nlet jane = { first: 'jane', last: 'doe' };\n\nfor (let [key, value] of objectentries(jane)) {\n  console.log(`${key}: ${value}`);\n}\n// first: jane\n// last: doe\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯¹è±¡janeåçä¸å·å¤ iterator æ¥å£ï¼æ æ³ç¨for...oféåãè¿æ¶ï¼æä»¬éè¿ generator å½æ°objectentriesä¸ºå®å ä¸éåå¨æ¥å£ï¼å°±å¯ä»¥ç¨for...oféåäºãå ä¸éåå¨æ¥å£çå¦ä¸ç§åæ³æ¯ï¼å° generator å½æ°å å°å¯¹è±¡çsymbol.iteratorå±æ§ä¸é¢ã\n\nfunction* objectentries() {\n  let propkeys = object.keys(this);\n\n  for (let propkey of propkeys) {\n    yield [propkey, this[propkey]];\n  }\n}\n\nlet jane = { first: 'jane', last: 'doe' };\n\njane[symbol.iterator] = objectentries;\n\nfor (let [key, value] of jane) {\n  console.log(`${key}: ${value}`);\n}\n// first: jane\n// last: doe\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\né¤äºfor...ofå¾ªç¯ä»¥å¤ï¼æ©å±è¿ç®ç¬¦ï¼...ï¼ãè§£æèµå¼åarray.fromæ¹æ³åé¨è°ç¨çï¼é½æ¯éåå¨æ¥å£ãè¿æå³çï¼å®ä»¬é½å¯ä»¥å° generator å½æ°è¿åç iterator å¯¹è±¡ï¼ä½ä¸ºåæ°ã\n\nfunction* numbers () {\n  yield 1\n  yield 2\n  return 3\n  yield 4\n}\n\n// æ©å±è¿ç®ç¬¦\n[...numbers()] // [1, 2]\n\n// array.from æ¹æ³\narray.from(numbers()) // [1, 2]\n\n// è§£æèµå¼\nlet [x, y] = numbers();\nx // 1\ny // 2\n\n// for...of å¾ªç¯\nfor (let n of numbers()) {\n  console.log(n)\n}\n// 1\n// 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n\n# generator.prototype.throw()\n\ngenerator å½æ°è¿åçéåå¨å¯¹è±¡ï¼é½æä¸ä¸ªthrowæ¹æ³ï¼å¯ä»¥å¨å½æ°ä½å¤æåºéè¯¯ï¼ç¶åå¨ generator å½æ°ä½åæè·ã\n\nvar g = function* () {\n  try {\n    yield;\n  } catch (e) {\n    console.log('åé¨æè·', e);\n  }\n};\n\nvar i = g();\ni.next();\n\ntry {\n  i.throw('a');\n  i.throw('b');\n} catch (e) {\n  console.log('å¤é¨æè·', e);\n}\n// åé¨æè· a\n// å¤é¨æè· b\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ä¸­ï¼éåå¨å¯¹è±¡iè¿ç»­æåºä¸¤ä¸ªéè¯¯ãç¬¬ä¸ä¸ªéè¯¯è¢« generator å½æ°ä½åçcatchè¯­å¥æè·ãiç¬¬äºæ¬¡æåºéè¯¯ï¼ç±äº generator å½æ°åé¨çcatchè¯­å¥å·²ç»æ§è¡è¿äºï¼ä¸ä¼åææå°è¿ä¸ªéè¯¯äºï¼æä»¥è¿ä¸ªéè¯¯å°±è¢«æåºäº generator å½æ°ä½ï¼è¢«å½æ°ä½å¤çcatchè¯­å¥æè·ã\n\nthrowæ¹æ³å¯ä»¥æ¥åä¸ä¸ªåæ°ï¼è¯¥åæ°ä¼è¢«catchè¯­å¥æ¥æ¶ï¼å»ºè®®æåºerrorå¯¹è±¡çå®ä¾ã\n\nvar g = function* () {\n  try {\n    yield;\n  } catch (e) {\n    console.log(e);\n  }\n};\n\nvar i = g();\ni.next();\ni.throw(new error('åºéäºï¼'));\n// error: åºéäºï¼(â¦)\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\næ³¨æï¼ä¸è¦æ··æ·éåå¨å¯¹è±¡çthrowæ¹æ³åå¨å±çthrowå½ä»¤ãä¸é¢ä»£ç çéè¯¯ï¼æ¯ç¨éåå¨å¯¹è±¡çthrowæ¹æ³æåºçï¼èä¸æ¯ç¨throwå½ä»¤æåºçãåèåªè½è¢«å½æ°ä½å¤çcatchè¯­å¥æè·ã\n\nvar g = function* () {\n  while (true) {\n    try {\n      yield;\n    } catch (e) {\n      if (e != 'a') throw e;\n      console.log('åé¨æè·', e);\n    }\n  }\n};\n\nvar i = g();\ni.next();\n\ntry {\n  throw new error('a');\n  throw new error('b');\n} catch (e) {\n  console.log('å¤é¨æè·', e);\n}\n// å¤é¨æè· [error: a]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nä¸é¢ä»£ç ä¹æä»¥åªæè·äºaï¼æ¯å ä¸ºå½æ°ä½å¤çcatchè¯­å¥åï¼æè·äºæåºçaéè¯¯ä»¥åï¼å°±ä¸ä¼åç»§ç»­tryä»£ç åéé¢å©ä½çè¯­å¥äºã\n\nå¦æ generator å½æ°åé¨æ²¡æé¨ç½²try...catchä»£ç åï¼é£ä¹throwæ¹æ³æåºçéè¯¯ï¼å°è¢«å¤é¨try...catchä»£ç åæè·ã\n\nvar g = function* () {\n  while (true) {\n    yield;\n    console.log('åé¨æè·', e);\n  }\n};\n\nvar i = g();\ni.next();\n\ntry {\n  i.throw('a');\n  i.throw('b');\n} catch (e) {\n  console.log('å¤é¨æè·', e);\n}\n// å¤é¨æè· a\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼generator å½æ°gåé¨æ²¡æé¨ç½²try...catchä»£ç åï¼æä»¥æåºçéè¯¯ç´æ¥è¢«å¤é¨catchä»£ç åæè·ã\n\nå¦æ generator å½æ°åé¨åå¤é¨ï¼é½æ²¡æé¨ç½²try...catchä»£ç åï¼é£ä¹ç¨åºå°æ¥éï¼ç´æ¥ä¸­æ­æ§è¡ã\n\nvar gen = function* gen(){\n  yield console.log('hello');\n  yield console.log('world');\n}\n\nvar g = gen();\ng.next();\ng.throw();\n// hello\n// uncaught undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼g.throwæåºéè¯¯ä»¥åï¼æ²¡æä»»ä½try...catchä»£ç åå¯ä»¥æè·è¿ä¸ªéè¯¯ï¼å¯¼è´ç¨åºæ¥éï¼ä¸­æ­æ§è¡ã\n\nthrowæ¹æ³æåºçéè¯¯è¦è¢«åé¨æè·ï¼åææ¯å¿é¡»è³å°æ§è¡è¿ä¸æ¬¡nextæ¹æ³ã\n\nfunction* gen() {\n  try {\n    yield 1;\n  } catch (e) {\n    console.log('åé¨æè·');\n  }\n}\n\nvar g = gen();\ng.throw(1);\n// uncaught 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼g.throw(1)æ§è¡æ¶ï¼nextæ¹æ³ä¸æ¬¡é½æ²¡ææ§è¡è¿ãè¿æ¶ï¼æåºçéè¯¯ä¸ä¼è¢«åé¨æè·ï¼èæ¯ç´æ¥å¨å¤é¨æåºï¼å¯¼è´ç¨åºåºéãè¿ç§è¡ä¸ºå¶å®å¾å¥½çè§£ï¼å ä¸ºç¬¬ä¸æ¬¡æ§è¡nextæ¹æ³ï¼ç­åäºå¯å¨æ§è¡ generator å½æ°çåé¨ä»£ç ï¼å¦å generator å½æ°è¿æ²¡æå¼å§æ§è¡ï¼è¿æ¶throwæ¹æ³æéåªå¯è½æåºå¨å½æ°å¤é¨ã\n\nthrowæ¹æ³è¢«æè·ä»¥åï¼ä¼éå¸¦æ§è¡ä¸ä¸æ¡yieldè¡¨è¾¾å¼ãä¹å°±æ¯è¯´ï¼ä¼éå¸¦æ§è¡ä¸æ¬¡nextæ¹æ³ã\n\nvar gen = function* gen(){\n  try {\n    yield console.log('a');\n  } catch (e) {\n    // ...\n  }\n  yield console.log('b');\n  yield console.log('c');\n}\n\nvar g = gen();\ng.next() // a\ng.throw() // b\ng.next() // c\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼g.throwæ¹æ³è¢«æè·ä»¥åï¼èªå¨æ§è¡äºä¸æ¬¡nextæ¹æ³ï¼æä»¥ä¼æå°bãå¦å¤ï¼ä¹å¯ä»¥çå°ï¼åªè¦ generator å½æ°åé¨é¨ç½²äºtry...catchä»£ç åï¼é£ä¹éåå¨çthrowæ¹æ³æåºçéè¯¯ï¼ä¸å½±åä¸ä¸æ¬¡éåã\n\nå¦å¤ï¼throwå½ä»¤ä¸g.throwæ¹æ³æ¯æ å³çï¼ä¸¤èäºä¸å½±åã\n\nvar gen = function* gen(){\n  yield console.log('hello');\n  yield console.log('world');\n}\n\nvar g = gen();\ng.next();\n\ntry {\n  throw new error();\n} catch (e) {\n  g.next();\n}\n// hello\n// world\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼throwå½ä»¤æåºçéè¯¯ä¸ä¼å½±åå°éåå¨çç¶æï¼æä»¥ä¸¤æ¬¡æ§è¡nextæ¹æ³ï¼é½è¿è¡äºæ­£ç¡®çæä½ã\n\nè¿ç§å½æ°ä½åæè·éè¯¯çæºå¶ï¼å¤§å¤§æ¹ä¾¿äºå¯¹éè¯¯çå¤çãå¤ä¸ªyieldè¡¨è¾¾å¼ï¼å¯ä»¥åªç¨ä¸ä¸ªtry...catchä»£ç åæ¥æè·éè¯¯ãå¦æä½¿ç¨åè°å½æ°çåæ³ï¼æ³è¦æè·å¤ä¸ªéè¯¯ï¼å°±ä¸å¾ä¸ä¸ºæ¯ä¸ªå½æ°åé¨åä¸ä¸ªéè¯¯å¤çè¯­å¥ï¼ç°å¨åªå¨ generator å½æ°åé¨åä¸æ¬¡catchè¯­å¥å°±å¯ä»¥äºã\n\ngenerator å½æ°ä½å¤æåºçéè¯¯ï¼å¯ä»¥å¨å½æ°ä½åæè·ï¼åè¿æ¥ï¼generator å½æ°ä½åæåºçéè¯¯ï¼ä¹å¯ä»¥è¢«å½æ°ä½å¤çcatchæè·ã\n\nfunction* foo() {\n  var x = yield 3;\n  var y = x.touppercase();\n  yield y;\n}\n\nvar it = foo();\n\nit.next(); // { value:3, done:false }\n\ntry {\n  it.next(42);\n} catch (err) {\n  console.log(err);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬äºä¸ªnextæ¹æ³åå½æ°ä½åä¼ å¥ä¸ä¸ªåæ° 42ï¼æ°å¼æ¯æ²¡ætouppercaseæ¹æ³çï¼æä»¥ä¼æåºä¸ä¸ª typeerror éè¯¯ï¼è¢«å½æ°ä½å¤çcatchæè·ã\n\nä¸æ¦ generator æ§è¡è¿ç¨ä¸­æåºéè¯¯ï¼ä¸æ²¡æè¢«åé¨æè·ï¼å°±ä¸ä¼åæ§è¡ä¸å»äºãå¦ææ­¤åè¿è°ç¨nextæ¹æ³ï¼å°è¿åä¸ä¸ªvalueå±æ§ç­äºundefinedãdoneå±æ§ç­äºtrueçå¯¹è±¡ï¼å³ javascript å¼æè®¤ä¸ºè¿ä¸ª generator å·²ç»è¿è¡ç»æäºã\n\nfunction* g() {\n  yield 1;\n  console.log('throwing an exception');\n  throw new error('generator broke!');\n  yield 2;\n  yield 3;\n}\n\nfunction log(generator) {\n  var v;\n  console.log('starting generator');\n  try {\n    v = generator.next();\n    console.log('ç¬¬ä¸æ¬¡è¿è¡nextæ¹æ³', v);\n  } catch (err) {\n    console.log('ææéè¯¯', v);\n  }\n  try {\n    v = generator.next();\n    console.log('ç¬¬äºæ¬¡è¿è¡nextæ¹æ³', v);\n  } catch (err) {\n    console.log('ææéè¯¯', v);\n  }\n  try {\n    v = generator.next();\n    console.log('ç¬¬ä¸æ¬¡è¿è¡nextæ¹æ³', v);\n  } catch (err) {\n    console.log('ææéè¯¯', v);\n  }\n  console.log('caller done');\n}\n\nlog(g());\n// starting generator\n// ç¬¬ä¸æ¬¡è¿è¡nextæ¹æ³ { value: 1, done: false }\n// throwing an exception\n// ææéè¯¯ { value: 1, done: false }\n// ç¬¬ä¸æ¬¡è¿è¡nextæ¹æ³ { value: undefined, done: true }\n// caller done\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n\n\nä¸é¢ä»£ç ä¸å±ä¸æ¬¡è¿è¡nextæ¹æ³ï¼ç¬¬äºæ¬¡è¿è¡çæ¶åä¼æåºéè¯¯ï¼ç¶åç¬¬ä¸æ¬¡è¿è¡çæ¶åï¼generator å½æ°å°±å·²ç»ç»æäºï¼ä¸åæ§è¡ä¸å»äºã\n\n\n# generator.prototype.return()\n\ngenerator å½æ°è¿åçéåå¨å¯¹è±¡ï¼è¿æä¸ä¸ª**returnæ¹æ³ï¼å¯ä»¥è¿åç»å®çå¼ï¼å¹¶ä¸ç»ç»éå generator å½æ°ã**\n\nfunction* gen() {\n  yield 1;\n  yield 2;\n  yield 3;\n}\n\nvar g = gen();\n\ng.next()        // { value: 1, done: false }\ng.return('foo') // { value: \"foo\", done: true }\ng.next()        // { value: undefined, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼éåå¨å¯¹è±¡gè°ç¨returnæ¹æ³åï¼è¿åå¼çvalueå±æ§å°±æ¯returnæ¹æ³çåæ°fooãå¹¶ä¸ï¼generator å½æ°çéåå°±ç»æ­¢äºï¼è¿åå¼çdoneå±æ§ä¸ºtrueï¼ä»¥ååè°ç¨nextæ¹æ³ï¼doneå±æ§æ»æ¯è¿åtrueã\n\nå¦æreturnæ¹æ³è°ç¨æ¶ï¼ä¸æä¾åæ°ï¼åè¿åå¼çvalueå±æ§ä¸ºundefinedã\n\nfunction* gen() {\n  yield 1;\n  yield 2;\n  yield 3;\n}\n\nvar g = gen();\n\ng.next()        // { value: 1, done: false }\ng.return() // { value: undefined, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¦æ generator å½æ°åé¨ætry...finallyä»£ç åï¼ä¸æ­£å¨æ§è¡tryä»£ç åï¼é£ä¹returnæ¹æ³ä¼å¯¼è´ç«å»è¿å¥finallyä»£ç åï¼æ§è¡å®ä»¥åï¼æ´ä¸ªå½æ°æä¼ç»æã\n\nfunction* numbers () {\n  yield 1;\n  try {\n    yield 2;\n    yield 3;\n  } finally {\n    yield 4;\n    yield 5;\n  }\n  yield 6;\n}\nvar g = numbers();\ng.next() // { value: 1, done: false }\ng.next() // { value: 2, done: false }\ng.return(7) // { value: 4, done: false }\ng.next() // { value: 5, done: false }\ng.next() // { value: 7, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼è°ç¨return()æ¹æ³åï¼å°±å¼å§æ§è¡finallyä»£ç åï¼ä¸æ§è¡tryéé¢å©ä¸çä»£ç äºï¼ç¶åç­å°finallyä»£ç åæ§è¡å®ï¼åè¿åreturn()æ¹æ³æå®çè¿åå¼ã\n\n\n# next()ãthrow()ãreturn() çå±åç¹\n\nnext()ãthrow()ãreturn()è¿ä¸ä¸ªæ¹æ³æ¬è´¨ä¸æ¯åä¸ä»¶äºï¼å¯ä»¥æ¾å¨ä¸èµ·çè§£ãå®ä»¬çä½ç¨é½æ¯è®© generator å½æ°æ¢å¤æ§è¡ï¼å¹¶ä¸ä½¿ç¨ä¸åçè¯­å¥æ¿æ¢yieldè¡¨è¾¾å¼ã\n\nnext()æ¯å°yieldè¡¨è¾¾å¼æ¿æ¢æä¸ä¸ªå¼ã\n\nconst g = function* (x, y) {\n  let result = yield x + y;\n  return result;\n};\n\nconst gen = g(1, 2);\ngen.next(); // object {value: 3, done: false}\n\ngen.next(1); // object {value: 1, done: true}\n// ç¸å½äºå° let result = yield x + y\n// æ¿æ¢æ let result = 1;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬äºä¸ªnext(1)æ¹æ³å°±ç¸å½äºå°yieldè¡¨è¾¾å¼æ¿æ¢æä¸ä¸ªå¼1ãå¦ænextæ¹æ³æ²¡æåæ°ï¼å°±ç¸å½äºæ¿æ¢æundefinedã\n\nthrow()æ¯å°yieldè¡¨è¾¾å¼æ¿æ¢æä¸ä¸ªthrowè¯­å¥ã\n\ngen.throw(new error('åºéäº')); // uncaught error: åºéäº\n// ç¸å½äºå° let result = yield x + y\n// æ¿æ¢æ let result = throw(new error('åºéäº'));\n\n\n1\n2\n3\n\n\nreturn()æ¯å°yieldè¡¨è¾¾å¼æ¿æ¢æä¸ä¸ªreturnè¯­å¥ã\n\ngen.return(2); // object {value: 2, done: true}\n// ç¸å½äºå° let result = yield x + y\n// æ¿æ¢æ let result = return 2;\n\n\n1\n2\n3\n\n\n\n# yield* è¡¨è¾¾å¼\n\nå¦æå¨ generator å½æ°åé¨ï¼è°ç¨å¦ä¸ä¸ª generator å½æ°ãéè¦å¨åèçå½æ°ä½åé¨ï¼èªå·±æå¨å®æéåã\n\nfunction* foo() {\n  yield 'a';\n  yield 'b';\n}\n\nfunction* bar() {\n  yield 'x';\n  // æå¨éå foo()\n  for (let i of foo()) {\n    console.log(i);\n  }\n  yield 'y';\n}\n\nfor (let v of bar()){\n  console.log(v);\n}\n// x\n// a\n// b\n// y\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nä¸é¢ä»£ç ä¸­ï¼fooåbaré½æ¯ generator å½æ°ï¼å¨baréé¢è°ç¨fooï¼å°±éè¦æå¨éåfooãå¦ææå¤ä¸ª generator å½æ°åµå¥ï¼åèµ·æ¥å°±éå¸¸éº»ç¦ã\n\nes6 æä¾äºyield*è¡¨è¾¾å¼ï¼ä½ä¸ºè§£å³åæ³ï¼ç¨æ¥å¨ä¸ä¸ª generator å½æ°éé¢æ§è¡å¦ä¸ä¸ª generator å½æ°ã\n\nfunction* bar() {\n  yield 'x';\n  yield* foo();\n  yield 'y';\n}\n\n// ç­åäº\nfunction* bar() {\n  yield 'x';\n  yield 'a';\n  yield 'b';\n  yield 'y';\n}\n\n// ç­åäº\nfunction* bar() {\n  yield 'x';\n  for (let v of foo()) {\n    yield v;\n  }\n  yield 'y';\n}\n\nfor (let v of bar()){\n  console.log(v);\n}\n// \"x\"\n// \"a\"\n// \"b\"\n// \"y\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n\n\nåæ¥çä¸ä¸ªå¯¹æ¯çä¾å­ã\n\nfunction* inner() {\n  yield 'hello!';\n}\n\nfunction* outer1() {\n  yield 'open';\n  yield inner();\n  yield 'close';\n}\n\nvar gen = outer1()\ngen.next().value // \"open\"\ngen.next().value // è¿åä¸ä¸ªéåå¨å¯¹è±¡\ngen.next().value // \"close\"\n\nfunction* outer2() {\n  yield 'open'\n  yield* inner()\n  yield 'close'\n}\n\nvar gen = outer2()\ngen.next().value // \"open\"\ngen.next().value // \"hello!\"\ngen.next().value // \"close\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nä¸é¢ä¾å­ä¸­ï¼outer2ä½¿ç¨äºyield*ï¼outer1æ²¡ä½¿ç¨ãç»æå°±æ¯ï¼outer1è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼outer2è¿åè¯¥éåå¨å¯¹è±¡çåé¨å¼ã\n\nä»è¯­æ³è§åº¦çï¼å¦æyieldè¡¨è¾¾å¼åé¢è·çæ¯ä¸ä¸ªéåå¨å¯¹è±¡ï¼éè¦å¨yieldè¡¨è¾¾å¼åé¢å ä¸æå·ï¼è¡¨æå®è¿åçæ¯ä¸ä¸ªéåå¨å¯¹è±¡ãè¿è¢«ç§°ä¸ºyield*è¡¨è¾¾å¼ã\n\nlet delegatediterator = (function* () {\n  yield 'hello!';\n  yield 'bye!';\n}());\n\nlet delegatingiterator = (function* () {\n  yield 'greetings!';\n  yield* delegatediterator;\n  yield 'ok, bye.';\n}());\n\nfor(let value of delegatingiterator) {\n  console.log(value);\n}\n// \"greetings!\n// \"hello!\"\n// \"bye!\"\n// \"ok, bye.\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä¸é¢ä»£ç ä¸­ï¼delegatingiteratoræ¯ä»£çèï¼delegatediteratoræ¯è¢«ä»£çèãç±äºyield* delegatediteratorè¯­å¥å¾å°çå¼ï¼æ¯ä¸ä¸ªéåå¨ï¼æä»¥è¦ç¨æå·è¡¨ç¤ºãè¿è¡ç»æå°±æ¯ä½¿ç¨ä¸ä¸ªéåå¨ï¼éåäºå¤ä¸ª generator å½æ°ï¼æéå½çææã\n\nyield*åé¢ç generator å½æ°ï¼æ²¡æreturnè¯­å¥æ¶ï¼ï¼ç­åäºå¨ generator å½æ°åé¨ï¼é¨ç½²ä¸ä¸ªfor...ofå¾ªç¯ã\n\nfunction* concat(iter1, iter2) {\n  yield* iter1;\n  yield* iter2;\n}\n\n// ç­åäº\n\nfunction* concat(iter1, iter2) {\n  for (var value of iter1) {\n    yield value;\n  }\n  for (var value of iter2) {\n    yield value;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç è¯´æï¼yield*åé¢ç generator å½æ°ï¼æ²¡æreturnè¯­å¥æ¶ï¼ï¼ä¸è¿æ¯for...ofçä¸ç§ç®åå½¢å¼ï¼å®å¨å¯ä»¥ç¨åèæ¿ä»£åèãåä¹ï¼å¨æreturnè¯­å¥æ¶ï¼åéè¦ç¨var value = yield* iteratorçå½¢å¼è·åreturnè¯­å¥çå¼ã\n\nå¦æyield*åé¢è·çä¸ä¸ªæ°ç»ï¼ç±äºæ°ç»åçæ¯æéåå¨ï¼å æ­¤å°±ä¼éåæ°ç»æåã\n\nfunction* gen(){\n  yield* [\"a\", \"b\", \"c\"];\n}\n\ngen().next() // { value:\"a\", done:false }\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼yieldå½ä»¤åé¢å¦æä¸å æå·ï¼è¿åçæ¯æ´ä¸ªæ°ç»ï¼å äºæå·å°±è¡¨ç¤ºè¿åçæ¯æ°ç»çéåå¨å¯¹è±¡ã\n\nå®éä¸ï¼ä»»ä½æ°æ®ç»æåªè¦æ iterator æ¥å£ï¼å°±å¯ä»¥è¢«yield*éåã\n\nlet read = (function* () {\n  yield 'hello';\n  yield* 'hello';\n})();\n\nread.next().value // \"hello\"\nread.next().value // \"h\"\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼yieldè¡¨è¾¾å¼è¿åæ´ä¸ªå­ç¬¦ä¸²ï¼yield*è¯­å¥è¿ååä¸ªå­ç¬¦ãå ä¸ºå­ç¬¦ä¸²å·æ iterator æ¥å£ï¼æä»¥è¢«yield*éåã\n\nå¦æè¢«ä»£çç generator å½æ°æreturnè¯­å¥ï¼é£ä¹å°±å¯ä»¥åä»£çå®ç generator å½æ°è¿åæ°æ®ã\n\nfunction* foo() {\n  yield 2;\n  yield 3;\n  return \"foo\";\n}\n\nfunction* bar() {\n  yield 1;\n  var v = yield* foo();\n  console.log(\"v: \" + v);\n  yield 4;\n}\n\nvar it = bar();\n\nit.next()\n// {value: 1, done: false}\nit.next()\n// {value: 2, done: false}\nit.next()\n// {value: 3, done: false}\nit.next();\n// \"v: foo\"\n// {value: 4, done: false}\nit.next()\n// {value: undefined, done: true}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nä¸é¢ä»£ç å¨ç¬¬åæ¬¡è°ç¨nextæ¹æ³çæ¶åï¼å±å¹ä¸ä¼æè¾åºï¼è¿æ¯å ä¸ºå½æ°fooçreturnè¯­å¥ï¼åå½æ°baræä¾äºè¿åå¼ã\n\nåçä¸ä¸ªä¾å­ã\n\nfunction* genfuncwithreturn() {\n  yield 'a';\n  yield 'b';\n  return 'the result';\n}\nfunction* logreturned(genobj) {\n  let result = yield* genobj;\n  console.log(result);\n}\n\n[...logreturned(genfuncwithreturn())]\n// the result\n// å¼ä¸º [ 'a', 'b' ]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼å­å¨ä¸¤æ¬¡éåãç¬¬ä¸æ¬¡æ¯æ©å±è¿ç®ç¬¦éåå½æ°logreturnedè¿åçéåå¨å¯¹è±¡ï¼ç¬¬äºæ¬¡æ¯yield*è¯­å¥éåå½æ°genfuncwithreturnè¿åçéåå¨å¯¹è±¡ãè¿ä¸¤æ¬¡éåçæææ¯å å çï¼æç»è¡¨ç°ä¸ºæ©å±è¿ç®ç¬¦éåå½æ°genfuncwithreturnè¿åçéåå¨å¯¹è±¡ãæä»¥ï¼æåçæ°æ®è¡¨è¾¾å¼å¾å°çå¼ç­äº[ 'a', 'b' ]ãä½æ¯ï¼å½æ°genfuncwithreturnçreturnè¯­å¥çè¿åå¼the resultï¼ä¼è¿åç»å½æ°logreturnedåé¨çresultåéï¼å æ­¤ä¼æç»ç«¯è¾åºã\n\nyield*å½ä»¤å¯ä»¥å¾æ¹ä¾¿å°ååºåµå¥æ°ç»çæææåã\n\nfunction* itertree(tree) {\n  if (array.isarray(tree)) {\n    for(let i=0; i < tree.length; i++) {\n      yield* itertree(tree[i]);\n    }\n  } else {\n    yield tree;\n  }\n}\n\nconst tree = [ 'a', ['b', 'c'], ['d', 'e'] ];\n\nfor(let x of itertree(tree)) {\n  console.log(x);\n}\n// a\n// b\n// c\n// d\n// e\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nç±äºæ©å±è¿ç®ç¬¦...é»è®¤è°ç¨ iterator æ¥å£ï¼æä»¥ä¸é¢è¿ä¸ªå½æ°ä¹å¯ä»¥ç¨äºåµå¥æ°ç»çå¹³éºã\n\n[...itertree(tree)] // [\"a\", \"b\", \"c\", \"d\", \"e\"]\n\n\n1\n\n\nä¸é¢æ¯ä¸ä¸ªç¨å¾®å¤æçä¾å­ï¼ä½¿ç¨yield*è¯­å¥éåå®å¨äºåæ ã\n\n// ä¸é¢æ¯äºåæ çæé å½æ°ï¼\n// ä¸ä¸ªåæ°åå«æ¯å·¦æ ãå½åèç¹åå³æ \nfunction tree(left, label, right) {\n  this.left = left;\n  this.label = label;\n  this.right = right;\n}\n\n// ä¸é¢æ¯ä¸­åºï¼inorderï¼éåå½æ°ã\n// ç±äºè¿åçæ¯ä¸ä¸ªéåå¨ï¼æä»¥è¦ç¨generatorå½æ°ã\n// å½æ°ä½åéç¨éå½ç®æ³ï¼æä»¥å·¦æ åå³æ è¦ç¨yield*éå\nfunction* inorder(t) {\n  if (t) {\n    yield* inorder(t.left);\n    yield t.label;\n    yield* inorder(t.right);\n  }\n}\n\n// ä¸é¢çæäºåæ \nfunction make(array) {\n  // å¤æ­æ¯å¦ä¸ºå¶èç¹\n  if (array.length == 1) return new tree(null, array[0], null);\n  return new tree(make(array[0]), array[1], make(array[2]));\n}\nlet tree = make([[['a'], 'b', ['c']], 'd', [['e'], 'f', ['g']]]);\n\n// éåäºåæ \nvar result = [];\nfor (let node of inorder(tree)) {\n  result.push(node);\n}\n\nresult\n// ['a', 'b', 'c', 'd', 'e', 'f', 'g']\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n\n\n\n# ä½ä¸ºå¯¹è±¡å±æ§ç generator å½æ°\n\nå¦æä¸ä¸ªå¯¹è±¡çå±æ§æ¯ generator å½æ°ï¼å¯ä»¥ç®åæä¸é¢çå½¢å¼ã\n\nlet obj = {\n  * mygeneratormethod() {\n    Â·Â·Â·\n  }\n};\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼mygeneratormethodå±æ§åé¢æä¸ä¸ªæå·ï¼è¡¨ç¤ºè¿ä¸ªå±æ§æ¯ä¸ä¸ª generator å½æ°ã\n\nå®çå®æ´å½¢å¼å¦ä¸ï¼ä¸ä¸é¢çåæ³æ¯ç­ä»·çã\n\nlet obj = {\n  mygeneratormethod: function* () {\n    // Â·Â·Â·\n  }\n};\n\n\n1\n2\n3\n4\n5\n\n\n\n# generator å½æ°çthis\n\ngenerator å½æ°æ»æ¯è¿åä¸ä¸ªéåå¨ï¼es6 è§å®è¿ä¸ªéåå¨æ¯ generator å½æ°çå®ä¾ï¼ä¹ç»§æ¿äº generator å½æ°çprototypeå¯¹è±¡ä¸çæ¹æ³ã\n\nfunction* g() {}\n\ng.prototype.hello = function () {\n  return 'hi!';\n};\n\nlet obj = g();\n\nobj instanceof g // true\nobj.hello() // 'hi!'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç è¡¨æï¼generator å½æ°gè¿åçéåå¨objï¼æ¯gçå®ä¾ï¼èä¸ç»§æ¿äºg.prototypeãä½æ¯ï¼å¦æægå½ä½æ®éçæé å½æ°ï¼å¹¶ä¸ä¼çæï¼å ä¸ºgè¿åçæ»æ¯éåå¨å¯¹è±¡ï¼èä¸æ¯thiså¯¹è±¡ã\n\nfunction* g() {\n  this.a = 11;\n}\n\nlet obj = g();\nobj.next();\nobj.a // undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼generator å½æ°gå¨thiså¯¹è±¡ä¸é¢æ·»å äºä¸ä¸ªå±æ§aï¼ä½æ¯objå¯¹è±¡æ¿ä¸å°è¿ä¸ªå±æ§ã\n\ngenerator å½æ°ä¹ä¸è½è·newå½ä»¤ä¸èµ·ç¨ï¼ä¼æ¥éã\n\nfunction* f() {\n  yield this.x = 2;\n  yield this.y = 3;\n}\n\nnew f()\n// typeerror: f is not a constructor\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼newå½ä»¤è·æé å½æ°fä¸èµ·ä½¿ç¨ï¼ç»ææ¥éï¼å ä¸ºfä¸æ¯æé å½æ°ã\n\né£ä¹ï¼ææ²¡æåæ³è®© generator å½æ°è¿åä¸ä¸ªæ­£å¸¸çå¯¹è±¡å®ä¾ï¼æ¢å¯ä»¥ç¨nextæ¹æ³ï¼åå¯ä»¥è·å¾æ­£å¸¸çthisï¼\n\nä¸é¢æ¯ä¸ä¸ªåéæ¹æ³ãé¦åï¼çæä¸ä¸ªç©ºå¯¹è±¡ï¼ä½¿ç¨callæ¹æ³ç»å® generator å½æ°åé¨çthisãè¿æ ·ï¼æé å½æ°è°ç¨ä»¥åï¼è¿ä¸ªç©ºå¯¹è±¡å°±æ¯ generator å½æ°çå®ä¾å¯¹è±¡äºã\n\nfunction* f() {\n  this.a = 1;\n  yield this.b = 2;\n  yield this.c = 3;\n}\nvar obj = {};\nvar f = f.call(obj);\n\nf.next();  // object {value: 2, done: false}\nf.next();  // object {value: 3, done: false}\nf.next();  // object {value: undefined, done: true}\n\nobj.a // 1\nobj.b // 2\nobj.c // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼é¦åæ¯fåé¨çthiså¯¹è±¡ç»å®objå¯¹è±¡ï¼ç¶åè°ç¨å®ï¼è¿åä¸ä¸ª iterator å¯¹è±¡ãè¿ä¸ªå¯¹è±¡æ§è¡ä¸æ¬¡nextæ¹æ³ï¼å ä¸ºfåé¨æä¸¤ä¸ªyieldè¡¨è¾¾å¼ï¼ï¼å®æ f åé¨ææä»£ç çè¿è¡ãè¿æ¶ï¼ææåé¨å±æ§é½ç»å®å¨objå¯¹è±¡ä¸äºï¼å æ­¤objå¯¹è±¡ä¹å°±æäºfçå®ä¾ã\n\nä¸é¢ä»£ç ä¸­ï¼æ§è¡çæ¯éåå¨å¯¹è±¡fï¼ä½æ¯çæçå¯¹è±¡å®ä¾æ¯objï¼ææ²¡æåæ³å°è¿ä¸¤ä¸ªå¯¹è±¡ç»ä¸å¢ï¼\n\nä¸ä¸ªåæ³å°±æ¯å°objæ¢æf.prototypeã\n\nfunction* f() {\n  this.a = 1;\n  yield this.b = 2;\n  yield this.c = 3;\n}\nvar f = f.call(f.prototype);\n\nf.next();  // object {value: 2, done: false}\nf.next();  // object {value: 3, done: false}\nf.next();  // object {value: undefined, done: true}\n\nf.a // 1\nf.b // 2\nf.c // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nåå°fæ¹ææé å½æ°ï¼å°±å¯ä»¥å¯¹å®æ§è¡newå½ä»¤äºã\n\nfunction* gen() {\n  this.a = 1;\n  yield this.b = 2;\n  yield this.c = 3;\n}\n\nfunction f() {\n  return gen.call(gen.prototype);\n}\n\nvar f = new f();\n\nf.next();  // object {value: 2, done: false}\nf.next();  // object {value: 3, done: false}\nf.next();  // object {value: undefined, done: true}\n\nf.a // 1\nf.b // 2\nf.c // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n# å«ä¹\n\n\n# generator ä¸ç¶ææº\n\ngenerator æ¯å®ç°ç¶ææºçæä½³ç»æãæ¯å¦ï¼ä¸é¢çclockå½æ°å°±æ¯ä¸ä¸ªç¶ææºã\n\nvar ticking = true;\nvar clock = function() {\n  if (ticking)\n    console.log('tick!');\n  else\n    console.log('tock!');\n  ticking = !ticking;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç çclockå½æ°ä¸å±æä¸¤ç§ç¶æï¼tickåtockï¼ï¼æ¯è¿è¡ä¸æ¬¡ï¼å°±æ¹åä¸æ¬¡ç¶æãè¿ä¸ªå½æ°å¦æç¨ generator å®ç°ï¼å°±æ¯ä¸é¢è¿æ ·ã\n\nvar clock = function* () {\n  while (true) {\n    console.log('tick!');\n    yield;\n    console.log('tock!');\n    yield;\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ç generator å®ç°ä¸ es5 å®ç°å¯¹æ¯ï¼å¯ä»¥çå°å°äºç¨æ¥ä¿å­ç¶æçå¤é¨åétickingï¼è¿æ ·å°±æ´ç®æ´ï¼æ´å®å¨ï¼ç¶æä¸ä¼è¢«éæ³ç¯¡æ¹ï¼ãæ´ç¬¦åå½æ°å¼ç¼ç¨çææ³ï¼å¨åæ³ä¸ä¹æ´ä¼éãgenerator ä¹æä»¥å¯ä»¥ä¸ç¨å¤é¨åéä¿å­ç¶æï¼æ¯å ä¸ºå®æ¬èº«å°±åå«äºä¸ä¸ªç¶æä¿¡æ¯ï¼å³ç®åæ¯å¦å¤äºæåæã\n\n\n# generator ä¸åç¨\n\nåç¨ï¼coroutineï¼æ¯ä¸ç§ç¨åºè¿è¡çæ¹å¼ï¼å¯ä»¥çè§£æâåä½ççº¿ç¨âæâåä½çå½æ°âãåç¨æ¢å¯ä»¥ç¨åçº¿ç¨å®ç°ï¼ä¹å¯ä»¥ç¨å¤çº¿ç¨å®ç°ãåèæ¯ä¸ç§ç¹æ®çå­ä¾ç¨ï¼åèæ¯ä¸ç§ç¹æ®ççº¿ç¨ã\n\nï¼1ï¼åç¨ä¸å­ä¾ç¨çå·®å¼\n\nä¼ ç»çâå­ä¾ç¨âï¼subroutineï¼éç¨å æ å¼âåè¿ååºâçæ§è¡æ¹å¼ï¼åªæå½è°ç¨çå­å½æ°å®å¨æ§è¡å®æ¯ï¼æä¼ç»ææ§è¡ç¶å½æ°ãåç¨ä¸å¶ä¸åï¼å¤ä¸ªçº¿ç¨ï¼åçº¿ç¨æåµä¸ï¼å³å¤ä¸ªå½æ°ï¼å¯ä»¥å¹¶è¡æ§è¡ï¼ä½æ¯åªæä¸ä¸ªçº¿ç¨ï¼æå½æ°ï¼å¤äºæ­£å¨è¿è¡çç¶æï¼å¶ä»çº¿ç¨ï¼æå½æ°ï¼é½å¤äºæåæï¼suspendedï¼ï¼çº¿ç¨ï¼æå½æ°ï¼ä¹é´å¯ä»¥äº¤æ¢æ§è¡æãä¹å°±æ¯è¯´ï¼ä¸ä¸ªçº¿ç¨ï¼æå½æ°ï¼æ§è¡å°ä¸åï¼å¯ä»¥æåæ§è¡ï¼å°æ§è¡æäº¤ç»å¦ä¸ä¸ªçº¿ç¨ï¼æå½æ°ï¼ï¼ç­å°ç¨åæ¶åæ§è¡æçæ¶åï¼åæ¢å¤æ§è¡ãè¿ç§å¯ä»¥å¹¶è¡æ§è¡ãäº¤æ¢æ§è¡æççº¿ç¨ï¼æå½æ°ï¼ï¼å°±ç§°ä¸ºåç¨ã\n\nä»å®ç°ä¸çï¼å¨åå­ä¸­ï¼å­ä¾ç¨åªä½¿ç¨ä¸ä¸ªæ ï¼stackï¼ï¼èåç¨æ¯åæ¶å­å¨å¤ä¸ªæ ï¼ä½åªæä¸ä¸ªæ æ¯å¨è¿è¡ç¶æï¼ä¹å°±æ¯è¯´ï¼åç¨æ¯ä»¥å¤å ç¨åå­ä¸ºä»£ä»·ï¼å®ç°å¤ä»»å¡çå¹¶è¡ã\n\nï¼2ï¼åç¨ä¸æ®éçº¿ç¨çå·®å¼\n\nä¸é¾çåºï¼åç¨éåç¨äºå¤ä»»å¡è¿è¡çç¯å¢ãå¨è¿ä¸ªæä¹ä¸ï¼å®ä¸æ®éççº¿ç¨å¾ç¸ä¼¼ï¼é½æèªå·±çæ§è¡ä¸ä¸æãå¯ä»¥åäº«å¨å±åéãå®ä»¬çä¸åä¹å¤å¨äºï¼åä¸æ¶é´å¯ä»¥æå¤ä¸ªçº¿ç¨å¤äºè¿è¡ç¶æï¼ä½æ¯è¿è¡çåç¨åªè½æä¸ä¸ªï¼å¶ä»åç¨é½å¤äºæåç¶æãæ­¤å¤ï¼æ®éççº¿ç¨æ¯æ¢åå¼çï¼å°åºåªä¸ªçº¿ç¨ä¼åå¾å°èµæºï¼å¿é¡»ç±è¿è¡ç¯å¢å³å®ï¼ä½æ¯åç¨æ¯åä½å¼çï¼æ§è¡æç±åç¨èªå·±åéã\n\nç±äº javascript æ¯åçº¿ç¨è¯­è¨ï¼åªè½ä¿æä¸ä¸ªè°ç¨æ ãå¼å¥åç¨ä»¥åï¼æ¯ä¸ªä»»å¡å¯ä»¥ä¿æèªå·±çè°ç¨æ ãè¿æ ·åçæå¤§å¥½å¤ï¼å°±æ¯æåºéè¯¯çæ¶åï¼å¯ä»¥æ¾å°åå§çè°ç¨æ ãä¸è³äºåå¼æ­¥æä½çåè°å½æ°é£æ ·ï¼ä¸æ¦åºéï¼åå§çè°ç¨æ æ©å°±ç»æã\n\ngenerator å½æ°æ¯ es6 å¯¹åç¨çå®ç°ï¼ä½å±äºä¸å®å¨å®ç°ãgenerator å½æ°è¢«ç§°ä¸ºâååç¨âï¼semi-coroutineï¼ï¼æææ¯åªæ generator å½æ°çè°ç¨èï¼æè½å°ç¨åºçæ§è¡æè¿ç» generator å½æ°ãå¦ææ¯å®å¨æ§è¡çåç¨ï¼ä»»ä½å½æ°é½å¯ä»¥è®©æåçåç¨ç»§ç»­æ§è¡ã\n\nå¦æå° generator å½æ°å½ä½åç¨ï¼å®å¨å¯ä»¥å°å¤ä¸ªéè¦äºç¸åä½çä»»å¡åæ generator å½æ°ï¼å®ä»¬ä¹é´ä½¿ç¨yieldè¡¨è¾¾å¼äº¤æ¢æ§å¶æã\n\n\n# generator ä¸ä¸ä¸æ\n\njavascript ä»£ç è¿è¡æ¶ï¼ä¼äº§çä¸ä¸ªå¨å±çä¸ä¸æç¯å¢ï¼contextï¼åç§°è¿è¡ç¯å¢ï¼ï¼åå«äºå½åææçåéåå¯¹è±¡ãç¶åï¼æ§è¡å½æ°ï¼æåçº§ä»£ç ï¼çæ¶åï¼åä¼å¨å½åä¸ä¸æç¯å¢çä¸å±ï¼äº§çä¸ä¸ªå½æ°è¿è¡çä¸ä¸æï¼åæå½åï¼activeï¼çä¸ä¸æï¼ç±æ­¤å½¢æä¸ä¸ªä¸ä¸æç¯å¢çå æ ï¼context stackï¼ã\n\nè¿ä¸ªå æ æ¯âåè¿ååºâçæ°æ®ç»æï¼æåäº§ççä¸ä¸æç¯å¢é¦åæ§è¡å®æï¼éåºå æ ï¼ç¶ååæ§è¡å®æå®ä¸å±çä¸ä¸æï¼ç´è³ææä»£ç æ§è¡å®æï¼å æ æ¸ç©ºã\n\ngenerator å½æ°ä¸æ¯è¿æ ·ï¼å®æ§è¡äº§ççä¸ä¸æç¯å¢ï¼ä¸æ¦éå°yieldå½ä»¤ï¼å°±ä¼ææ¶éåºå æ ï¼ä½æ¯å¹¶ä¸æ¶å¤±ï¼éé¢çææåéåå¯¹è±¡ä¼å»ç»å¨å½åç¶æãç­å°å¯¹å®æ§è¡nextå½ä»¤æ¶ï¼è¿ä¸ªä¸ä¸æç¯å¢åä¼éæ°å å¥è°ç¨æ ï¼å»ç»çåéåå¯¹è±¡æ¢å¤æ§è¡ã\n\nfunction* gen() {\n  yield 1;\n  return 2;\n}\n\nlet g = gen();\n\nconsole.log(\n  g.next().value,\n  g.next().value,\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬ä¸æ¬¡æ§è¡g.next()æ¶ï¼generator å½æ°gençä¸ä¸æä¼å å¥å æ ï¼å³å¼å§è¿è¡genåé¨çä»£ç ãç­éå°yield 1æ¶ï¼genä¸ä¸æéåºå æ ï¼åé¨ç¶æå»ç»ãç¬¬äºæ¬¡æ§è¡g.next()æ¶ï¼genä¸ä¸æéæ°å å¥å æ ï¼åæå½åçä¸ä¸æï¼éæ°æ¢å¤æ§è¡ã\n\n\n# åºç¨\n\ngenerator å¯ä»¥æåå½æ°æ§è¡ï¼è¿åä»»æè¡¨è¾¾å¼çå¼ãè¿ç§ç¹ç¹ä½¿å¾ generator æå¤ç§åºç¨åºæ¯ã\n\n\n# ï¼1ï¼å¼æ­¥æä½çåæ­¥åè¡¨è¾¾\n\ngenerator å½æ°çæåæ§è¡çææï¼æå³çå¯ä»¥æå¼æ­¥æä½åå¨yieldè¡¨è¾¾å¼éé¢ï¼ç­å°è°ç¨nextæ¹æ³æ¶åå¾åæ§è¡ãè¿å®éä¸ç­åäºä¸éè¦ååè°å½æ°äºï¼å ä¸ºå¼æ­¥æä½çåç»­æä½å¯ä»¥æ¾å¨yieldè¡¨è¾¾å¼ä¸é¢ï¼åæ­£è¦ç­å°è°ç¨nextæ¹æ³æ¶åæ§è¡ãæä»¥ï¼generator å½æ°çä¸ä¸ªéè¦å®éæä¹å°±æ¯ç¨æ¥å¤çå¼æ­¥æä½ï¼æ¹ååè°å½æ°ã\n\nfunction* loadui() {\n  showloadingscreen();\n  yield loaduidataasynchronously();\n  hideloadingscreen();\n}\nvar loader = loadui();\n// å è½½ui\nloader.next()\n\n// å¸è½½ui\nloader.next()\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬ä¸æ¬¡è°ç¨loaduiå½æ°æ¶ï¼è¯¥å½æ°ä¸ä¼æ§è¡ï¼ä»è¿åä¸ä¸ªéåå¨ãä¸ä¸æ¬¡å¯¹è¯¥éåå¨è°ç¨nextæ¹æ³ï¼åä¼æ¾ç¤ºloadingçé¢ï¼showloadingscreenï¼ï¼å¹¶ä¸å¼æ­¥å è½½æ°æ®ï¼loaduidataasynchronouslyï¼ãç­å°æ°æ®å è½½å®æï¼åä¸æ¬¡ä½¿ç¨nextæ¹æ³ï¼åä¼éèloadingçé¢ãå¯ä»¥çå°ï¼è¿ç§åæ³çå¥½å¤æ¯ææloadingçé¢çé»è¾ï¼é½è¢«å°è£å¨ä¸ä¸ªå½æ°ï¼æé¨å°±ç­éå¸¸æ¸æ°ã\n\najax æ¯å¸åçå¼æ­¥æä½ï¼éè¿ generator å½æ°é¨ç½² ajax æä½ï¼å¯ä»¥ç¨åæ­¥çæ¹å¼è¡¨è¾¾ã\n\nfunction* main() {\n  var result = yield request(\"http://some.url\");\n  var resp = json.parse(result);\n    console.log(resp.value);\n}\n\nfunction request(url) {\n  makeajaxcall(url, function(response){\n    it.next(response);\n  });\n}\n\nvar it = main();\nit.next();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç çmainå½æ°ï¼å°±æ¯éè¿ ajax æä½è·åæ°æ®ãå¯ä»¥çå°ï¼é¤äºå¤äºä¸ä¸ªyieldï¼å®å ä¹ä¸åæ­¥æä½çåæ³å®å¨ä¸æ ·ãæ³¨æï¼makeajaxcallå½æ°ä¸­çnextæ¹æ³ï¼å¿é¡»å ä¸responseåæ°ï¼å ä¸ºyieldè¡¨è¾¾å¼ï¼æ¬èº«æ¯æ²¡æå¼çï¼æ»æ¯ç­äºundefinedã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ï¼éè¿ generator å½æ°éè¡è¯»åææ¬æä»¶ã\n\nfunction* numbers() {\n  let file = new filereader(\"numbers.txt\");\n  try {\n    while(!file.eof) {\n      yield parseint(file.readline(), 10);\n    }\n  } finally {\n    file.close();\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç æå¼ææ¬æä»¶ï¼ä½¿ç¨yieldè¡¨è¾¾å¼å¯ä»¥æå¨éè¡è¯»åæä»¶ã\n\n\n# ï¼2ï¼æ§å¶æµç®¡ç\n\nå¦ææä¸ä¸ªå¤æ­¥æä½éå¸¸èæ¶ï¼éç¨åè°å½æ°ï¼å¯è½ä¼åæä¸é¢è¿æ ·ã\n\nstep1(function (value1) {\n  step2(value1, function(value2) {\n    step3(value2, function(value3) {\n      step4(value3, function(value4) {\n        // do something with value4\n      });\n    });\n  });\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\néç¨ promise æ¹åä¸é¢çä»£ç ã\n\npromise.resolve(step1)\n  .then(step2)\n  .then(step3)\n  .then(step4)\n  .then(function (value4) {\n    // do something with value4\n  }, function (error) {\n    // handle any error from step1 through step4\n  })\n  .done();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å·²ç»æåè°å½æ°ï¼æ¹æäºç´çº¿æ§è¡çå½¢å¼ï¼ä½æ¯å å¥äºå¤§é promise çè¯­æ³ãgenerator å½æ°å¯ä»¥è¿ä¸æ­¥æ¹åä»£ç è¿è¡æµç¨ã\n\nfunction* longrunningtask(value1) {\n  try {\n    var value2 = yield step1(value1);\n    var value3 = yield step2(value2);\n    var value4 = yield step3(value3);\n    var value5 = yield step4(value4);\n    // do something with value4\n  } catch (e) {\n    // handle any error from step1 through step4\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nç¶åï¼ä½¿ç¨ä¸ä¸ªå½æ°ï¼ææ¬¡åºèªå¨æ§è¡æææ­¥éª¤ã\n\nscheduler(longrunningtask(initialvalue));\n\nfunction scheduler(task) {\n  var taskobj = task.next(task.value);\n  // å¦ægeneratorå½æ°æªç»æï¼å°±ç»§ç»­è°ç¨\n  if (!taskobj.done) {\n    task.value = taskobj.value\n    scheduler(task);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\næ³¨æï¼ä¸é¢è¿ç§åæ³ï¼åªéååæ­¥æä½ï¼å³ææçtaské½å¿é¡»æ¯åæ­¥çï¼ä¸è½æå¼æ­¥æä½ãå ä¸ºè¿éçä»£ç ä¸å¾å°è¿åå¼ï¼å°±ç»§ç»­å¾ä¸æ§è¡ï¼æ²¡æå¤æ­å¼æ­¥æä½ä½æ¶å®æãå¦æè¦æ§å¶å¼æ­¥çæä½æµç¨ï¼è¯¦è§åé¢çãå¼æ­¥æä½ãä¸ç« ã\n\nä¸é¢ï¼å©ç¨for...ofå¾ªç¯ä¼èªå¨ä¾æ¬¡æ§è¡yieldå½ä»¤çç¹æ§ï¼æä¾ä¸ç§æ´ä¸è¬çæ§å¶æµç®¡ççæ¹æ³ã\n\nlet steps = [step1func, step2func, step3func];\n\nfunction* iteratesteps(steps){\n  for (var i=0; i< steps.length; i++){\n    var step = steps[i];\n    yield step();\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»stepså°è£äºä¸ä¸ªä»»å¡çå¤ä¸ªæ­¥éª¤ï¼generator å½æ°iteratestepsåæ¯ä¾æ¬¡ä¸ºè¿äºæ­¥éª¤å ä¸yieldå½ä»¤ã\n\nå°ä»»å¡åè§£ææ­¥éª¤ä¹åï¼è¿å¯ä»¥å°é¡¹ç®åè§£æå¤ä¸ªä¾æ¬¡æ§è¡çä»»å¡ã\n\nlet jobs = [job1, job2, job3];\n\nfunction* iteratejobs(jobs){\n  for (var i=0; i< jobs.length; i++){\n    var job = jobs[i];\n    yield* iteratesteps(job.steps);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»jobså°è£äºä¸ä¸ªé¡¹ç®çå¤ä¸ªä»»å¡ï¼generator å½æ°iteratejobsåæ¯ä¾æ¬¡ä¸ºè¿äºä»»å¡å ä¸yield*å½ä»¤ã\n\næåï¼å°±å¯ä»¥ç¨for...ofå¾ªç¯ä¸æ¬¡æ§ä¾æ¬¡æ§è¡ææä»»å¡çæææ­¥éª¤ã\n\nfor (var step of iteratejobs(jobs)){\n  console.log(step.id);\n}\n\n\n1\n2\n3\n\n\nåæ¬¡æéï¼ä¸é¢çåæ³åªè½ç¨äºæææ­¥éª¤é½æ¯åæ­¥æä½çæåµï¼ä¸è½æå¼æ­¥æä½çæ­¥éª¤ãå¦ææ³è¦ä¾æ¬¡æ§è¡å¼æ­¥çæ­¥éª¤ï¼å¿é¡»ä½¿ç¨åé¢çãå¼æ­¥æä½ãä¸ç« ä»ç»çæ¹æ³ã\n\nfor...ofçæ¬è´¨æ¯ä¸ä¸ªwhileå¾ªç¯ï¼æä»¥ä¸é¢çä»£ç å®è´¨ä¸æ§è¡çæ¯ä¸é¢çé»è¾ã\n\nvar it = iteratejobs(jobs);\nvar res = it.next();\n\nwhile (!res.done){\n  var result = res.value;\n  // ...\n  res = it.next();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# ï¼3ï¼é¨ç½² iterator æ¥å£\n\nå©ç¨ generator å½æ°ï¼å¯ä»¥å¨ä»»æå¯¹è±¡ä¸é¨ç½² iterator æ¥å£ã\n\nfunction* iterentries(obj) {\n  let keys = object.keys(obj);\n  for (let i=0; i < keys.length; i++) {\n    let key = keys[i];\n    yield [key, obj[key]];\n  }\n}\n\nlet myobj = { foo: 3, bar: 7 };\n\nfor (let [key, value] of iterentries(myobj)) {\n  console.log(key, value);\n}\n\n// foo 3\n// bar 7\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸è¿°ä»£ç ä¸­ï¼myobjæ¯ä¸ä¸ªæ®éå¯¹è±¡ï¼éè¿iterentrieså½æ°ï¼å°±æäº iterator æ¥å£ãä¹å°±æ¯è¯´ï¼å¯ä»¥å¨ä»»æå¯¹è±¡ä¸é¨ç½²nextæ¹æ³ã\n\nä¸é¢æ¯ä¸ä¸ªå¯¹æ°ç»é¨ç½² iterator æ¥å£çä¾å­ï¼å°½ç®¡æ°ç»åçå·æè¿ä¸ªæ¥å£ã\n\nfunction* makesimplegenerator(array){\n  var nextindex = 0;\n\n  while(nextindex < array.length){\n    yield array[nextindex++];\n  }\n}\n\nvar gen = makesimplegenerator(['yo', 'ya']);\n\ngen.next().value // 'yo'\ngen.next().value // 'ya'\ngen.next().done  // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# ï¼4ï¼ä½ä¸ºæ°æ®ç»æ\n\ngenerator å¯ä»¥çä½æ¯æ°æ®ç»æï¼æ´ç¡®åå°è¯´ï¼å¯ä»¥çä½æ¯ä¸ä¸ªæ°ç»ç»æï¼å ä¸º generator å½æ°å¯ä»¥è¿åä¸ç³»åçå¼ï¼è¿æå³çå®å¯ä»¥å¯¹ä»»æè¡¨è¾¾å¼ï¼æä¾ç±»ä¼¼æ°ç»çæ¥å£ã\n\nfunction* dostuff() {\n  yield fs.readfile.bind(null, 'hello.txt');\n  yield fs.readfile.bind(null, 'world.txt');\n  yield fs.readfile.bind(null, 'and-such.txt');\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç å°±æ¯ä¾æ¬¡è¿åä¸ä¸ªå½æ°ï¼ä½æ¯ç±äºä½¿ç¨äº generator å½æ°ï¼å¯¼è´å¯ä»¥åå¤çæ°ç»é£æ ·ï¼å¤çè¿ä¸ä¸ªè¿åçå½æ°ã\n\nfor (task of dostuff()) {\n  // taskæ¯ä¸ä¸ªå½æ°ï¼å¯ä»¥ååè°å½æ°é£æ ·ä½¿ç¨å®\n}\n\n\n1\n2\n3\n\n\nå®éä¸ï¼å¦æç¨ es5 è¡¨è¾¾ï¼å®å¨å¯ä»¥ç¨æ°ç»æ¨¡æ generator çè¿ç§ç¨æ³ã\n\nfunction dostuff() {\n  return [\n    fs.readfile.bind(null, 'hello.txt'),\n    fs.readfile.bind(null, 'world.txt'),\n    fs.readfile.bind(null, 'and-such.txt')\n  ];\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢çå½æ°ï¼å¯ä»¥ç¨ä¸æ¨¡ä¸æ ·çfor...ofå¾ªç¯å¤çï¼ä¸¤ç¸ä¸æ¯è¾ï¼å°±ä¸é¾çåº generator ä½¿å¾æ°æ®æèæä½ï¼å·å¤äºç±»ä¼¼æ°ç»çæ¥å£ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Generator å½æ°çå¼æ­¥åºç¨",frontmatter:{title:"Generator å½æ°çå¼æ­¥åºç¨",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/75af7031eb66847b",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/19.Generator%20%E5%87%BD%E6%95%B0%E7%9A%84%E5%BC%82%E6%AD%A5%E5%BA%94%E7%94%A8.html",relativePath:"ãES6 æç¨ãç¬è®°/19.Generator å½æ°çå¼æ­¥åºç¨.md",key:"v-1bbe4ea2",path:"/pages/75af7031eb66847b/",headers:[{level:2,title:"ä¼ ç»æ¹æ³",slug:"ä¼ ç»æ¹æ³",normalizedTitle:"ä¼ ç»æ¹æ³",charIndex:124},{level:2,title:"åºæ¬æ¦å¿µ",slug:"åºæ¬æ¦å¿µ",normalizedTitle:"åºæ¬æ¦å¿µ",charIndex:242},{level:3,title:"å¼æ­¥",slug:"å¼æ­¥",normalizedTitle:"å¼æ­¥",charIndex:15},{level:3,title:"åè°å½æ°",slug:"åè°å½æ°",normalizedTitle:"åè°å½æ°",charIndex:160},{level:3,title:"Promise",slug:"promise",normalizedTitle:"promise",charIndex:185},{level:2,title:"Generator å½æ°",slug:"generator-å½æ°",normalizedTitle:"generator å½æ°",charIndex:2},{level:3,title:"åç¨",slug:"åç¨",normalizedTitle:"åç¨",charIndex:2005},{level:3,title:"åç¨ç Generator å½æ°å®ç°",slug:"åç¨ç-generator-å½æ°å®ç°",normalizedTitle:"åç¨ç generator å½æ°å®ç°",charIndex:2520},{level:3,title:"Generator å½æ°çæ°æ®äº¤æ¢åéè¯¯å¤ç",slug:"generator-å½æ°çæ°æ®äº¤æ¢åéè¯¯å¤ç",normalizedTitle:"generator å½æ°çæ°æ®äº¤æ¢åéè¯¯å¤ç",charIndex:3165},{level:3,title:"å¼æ­¥ä»»å¡çå°è£",slug:"å¼æ­¥ä»»å¡çå°è£",normalizedTitle:"å¼æ­¥ä»»å¡çå°è£",charIndex:4008},{level:2,title:"Thunk å½æ°",slug:"thunk-å½æ°",normalizedTitle:"thunk å½æ°",charIndex:4684},{level:3,title:"åæ°çæ±å¼ç­ç¥",slug:"åæ°çæ±å¼ç­ç¥",normalizedTitle:"åæ°çæ±å¼ç­ç¥",charIndex:4731},{level:3,title:"Thunk å½æ°çå«ä¹",slug:"thunk-å½æ°çå«ä¹",normalizedTitle:"thunk å½æ°çå«ä¹",charIndex:5419},{level:3,title:"JavaScript è¯­è¨ç Thunk å½æ°",slug:"javascript-è¯­è¨ç-thunk-å½æ°",normalizedTitle:"javascript è¯­è¨ç thunk å½æ°",charIndex:5782},{level:3,title:"Thunkify æ¨¡å",slug:"thunkify-æ¨¡å",normalizedTitle:"thunkify æ¨¡å",charIndex:7024},{level:3,title:"Generator å½æ°çæµç¨ç®¡ç",slug:"generator-å½æ°çæµç¨ç®¡ç",normalizedTitle:"generator å½æ°çæµç¨ç®¡ç",charIndex:8158},{level:3,title:"Thunk å½æ°çèªå¨æµç¨ç®¡ç",slug:"thunk-å½æ°çèªå¨æµç¨ç®¡ç",normalizedTitle:"thunk å½æ°çèªå¨æµç¨ç®¡ç",charIndex:9450},{level:2,title:"co æ¨¡å",slug:"co-æ¨¡å",normalizedTitle:"co æ¨¡å",charIndex:10496},{level:3,title:"åºæ¬ç¨æ³",slug:"åºæ¬ç¨æ³",normalizedTitle:"åºæ¬ç¨æ³",charIndex:10506},{level:3,title:"co æ¨¡åçåç",slug:"co-æ¨¡åçåç",normalizedTitle:"co æ¨¡åçåç",charIndex:11065},{level:3,title:"åºäº Promise å¯¹è±¡çèªå¨æ§è¡",slug:"åºäº-promise-å¯¹è±¡çèªå¨æ§è¡",normalizedTitle:"åºäº promise å¯¹è±¡çèªå¨æ§è¡",charIndex:11456},{level:3,title:"co æ¨¡åçæºç ",slug:"co-æ¨¡åçæºç ",normalizedTitle:"co æ¨¡åçæºç ",charIndex:12551},{level:3,title:"å¤çå¹¶åçå¼æ­¥æä½",slug:"å¤çå¹¶åçå¼æ­¥æä½",normalizedTitle:"å¤çå¹¶åçå¼æ­¥æä½",charIndex:14322},{level:3,title:"å®ä¾ï¼å¤ç Stream",slug:"å®ä¾-å¤ç-stream",normalizedTitle:"å®ä¾ï¼å¤ç stream",charIndex:14981}],excerpt:'<h1 id="generator-å½æ°çå¼æ­¥åºç¨"><a class="header-anchor" href="#generator-å½æ°çå¼æ­¥åºç¨">#</a> Generator å½æ°çå¼æ­¥åºç¨</h1>\n<p>å¼æ­¥ç¼ç¨å¯¹ JavaScript è¯­è¨å¤ªéè¦ãJavaScript è¯­è¨çæ§è¡ç¯å¢æ¯âåçº¿ç¨âçï¼å¦ææ²¡æå¼æ­¥ç¼ç¨ï¼æ ¹æ¬æ²¡æ³ç¨ï¼éå¡æ­»ä¸å¯ãæ¬ç« ä¸»è¦ä»ç» Generator å½æ°å¦ä½å®æå¼æ­¥æä½ã</p>\n',headersStr:"ä¼ ç»æ¹æ³ åºæ¬æ¦å¿µ å¼æ­¥ åè°å½æ° Promise Generator å½æ° åç¨ åç¨ç Generator å½æ°å®ç° Generator å½æ°çæ°æ®äº¤æ¢åéè¯¯å¤ç å¼æ­¥ä»»å¡çå°è£ Thunk å½æ° åæ°çæ±å¼ç­ç¥ Thunk å½æ°çå«ä¹ JavaScript è¯­è¨ç Thunk å½æ° Thunkify æ¨¡å Generator å½æ°çæµç¨ç®¡ç Thunk å½æ°çèªå¨æµç¨ç®¡ç co æ¨¡å åºæ¬ç¨æ³ co æ¨¡åçåç åºäº Promise å¯¹è±¡çèªå¨æ§è¡ co æ¨¡åçæºç  å¤çå¹¶åçå¼æ­¥æä½ å®ä¾ï¼å¤ç Stream",content:"# Generator å½æ°çå¼æ­¥åºç¨\n\nå¼æ­¥ç¼ç¨å¯¹ JavaScript è¯­è¨å¤ªéè¦ãJavaScript è¯­è¨çæ§è¡ç¯å¢æ¯âåçº¿ç¨âçï¼å¦ææ²¡æå¼æ­¥ç¼ç¨ï¼æ ¹æ¬æ²¡æ³ç¨ï¼éå¡æ­»ä¸å¯ãæ¬ç« ä¸»è¦ä»ç» Generator å½æ°å¦ä½å®æå¼æ­¥æä½ã\n\n\n# ä¼ ç»æ¹æ³\n\nES6 è¯çä»¥åï¼å¼æ­¥ç¼ç¨çæ¹æ³ï¼å¤§æ¦æä¸é¢åç§ã\n\n * åè°å½æ°\n * äºä»¶çå¬\n * åå¸/è®¢é\n * Promise å¯¹è±¡\n\nGenerator å½æ°å° JavaScript å¼æ­¥ç¼ç¨å¸¦å¥äºä¸ä¸ªå¨æ°çé¶æ®µã\n\n\n# åºæ¬æ¦å¿µ\n\n\n# å¼æ­¥\n\næè°\"å¼æ­¥\"ï¼ç®åè¯´å°±æ¯ä¸ä¸ªä»»å¡ä¸æ¯è¿ç»­å®æçï¼å¯ä»¥çè§£æè¯¥ä»»å¡è¢«äººä¸ºåæä¸¤æ®µï¼åæ§è¡ç¬¬ä¸æ®µï¼ç¶åè½¬èæ§è¡å¶ä»ä»»å¡ï¼ç­åå¥½äºåå¤ï¼ååè¿å¤´æ§è¡ç¬¬äºæ®µã\n\næ¯å¦ï¼æä¸ä¸ªä»»å¡æ¯è¯»åæä»¶è¿è¡å¤çï¼ä»»å¡çç¬¬ä¸æ®µæ¯åæä½ç³»ç»ååºè¯·æ±ï¼è¦æ±è¯»åæä»¶ãç¶åï¼ç¨åºæ§è¡å¶ä»ä»»å¡ï¼ç­å°æä½ç³»ç»è¿åæä»¶ï¼åæ¥çæ§è¡ä»»å¡çç¬¬äºæ®µï¼å¤çæä»¶ï¼ãè¿ç§ä¸è¿ç»­çæ§è¡ï¼å°±å«åå¼æ­¥ã\n\nç¸åºå°ï¼è¿ç»­çæ§è¡å°±å«ååæ­¥ãç±äºæ¯è¿ç»­æ§è¡ï¼ä¸è½æå¥å¶ä»ä»»å¡ï¼æä»¥æä½ç³»ç»ä»ç¡¬çè¯»åæä»¶çè¿æ®µæ¶é´ï¼ç¨åºåªè½å¹²ç­çã\n\n\n# åè°å½æ°\n\nJavaScript è¯­è¨å¯¹å¼æ­¥ç¼ç¨çå®ç°ï¼å°±æ¯åè°å½æ°ãæè°åè°å½æ°ï¼å°±æ¯æä»»å¡çç¬¬äºæ®µåç¬åå¨ä¸ä¸ªå½æ°éé¢ï¼ç­å°éæ°æ§è¡è¿ä¸ªä»»å¡çæ¶åï¼å°±ç´æ¥è°ç¨è¿ä¸ªå½æ°ãåè°å½æ°çè±è¯­åå­callbackï¼ç´è¯è¿æ¥å°±æ¯\"éæ°è°ç¨\"ã\n\nè¯»åæä»¶è¿è¡å¤çï¼æ¯è¿æ ·åçã\n\nfs.readFile('/etc/passwd', 'utf-8', function (err, data) {\n  if (err) throw err;\n  console.log(data);\n});\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼readFileå½æ°çç¬¬ä¸ä¸ªåæ°ï¼å°±æ¯åè°å½æ°ï¼ä¹å°±æ¯ä»»å¡çç¬¬äºæ®µãç­å°æä½ç³»ç»è¿åäº/etc/passwdè¿ä¸ªæä»¶ä»¥åï¼åè°å½æ°æä¼æ§è¡ã\n\nä¸ä¸ªæè¶£çé®é¢æ¯ï¼ä¸ºä»ä¹ Node çº¦å®ï¼åè°å½æ°çç¬¬ä¸ä¸ªåæ°ï¼å¿é¡»æ¯éè¯¯å¯¹è±¡errï¼å¦ææ²¡æéè¯¯ï¼è¯¥åæ°å°±æ¯nullï¼ï¼\n\nåå æ¯æ§è¡åæä¸¤æ®µï¼ç¬¬ä¸æ®µæ§è¡å®ä»¥åï¼ä»»å¡æå¨çä¸ä¸æç¯å¢å°±å·²ç»ç»æäºãå¨è¿ä»¥åæåºçéè¯¯ï¼åæ¥çä¸ä¸æç¯å¢å·²ç»æ æ³ææï¼åªè½å½ä½åæ°ï¼ä¼ å¥ç¬¬äºæ®µã\n\n\n# Promise\n\nåè°å½æ°æ¬èº«å¹¶æ²¡æé®é¢ï¼å®çé®é¢åºç°å¨å¤ä¸ªåè°å½æ°åµå¥ãåå®è¯»åAæä»¶ä¹åï¼åè¯»åBæä»¶ï¼ä»£ç å¦ä¸ã\n\nfs.readFile(fileA, 'utf-8', function (err, data) {\n  fs.readFile(fileB, 'utf-8', function (err, data) {\n    // ...\n  });\n});\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¾æ³è±¡ï¼å¦æä¾æ¬¡è¯»åä¸¤ä¸ªä»¥ä¸çæä»¶ï¼å°±ä¼åºç°å¤éåµå¥ãä»£ç ä¸æ¯çºµååå±ï¼èæ¯æ¨ªååå±ï¼å¾å¿«å°±ä¼ä¹±æä¸å¢ï¼æ æ³ç®¡çãå ä¸ºå¤ä¸ªå¼æ­¥æä½å½¢æäºå¼ºè¦åï¼åªè¦æä¸ä¸ªæä½éè¦ä¿®æ¹ï¼å®çä¸å±åè°å½æ°åä¸å±åè°å½æ°ï¼å¯è½é½è¦è·çä¿®æ¹ãè¿ç§æåµå°±ç§°ä¸º\"åè°å½æ°å°ç±\"ï¼callback hellï¼ã\n\nPromise å¯¹è±¡å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢èæåºçãå®ä¸æ¯æ°çè¯­æ³åè½ï¼èæ¯ä¸ç§æ°çåæ³ï¼åè®¸å°åè°å½æ°çåµå¥ï¼æ¹æé¾å¼è°ç¨ãéç¨ Promiseï¼è¿ç»­è¯»åå¤ä¸ªæä»¶ï¼åæ³å¦ä¸ã\n\nvar readFile = require('fs-readfile-promise');\n\nreadFile(fileA)\n.then(function (data) {\n  console.log(data.toString());\n})\n.then(function () {\n  return readFile(fileB);\n})\n.then(function (data) {\n  console.log(data.toString());\n})\n.catch(function (err) {\n  console.log(err);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼æä½¿ç¨äºfs-readfile-promiseæ¨¡åï¼å®çä½ç¨å°±æ¯è¿åä¸ä¸ª Promise çæ¬çreadFileå½æ°ãPromise æä¾thenæ¹æ³å è½½åè°å½æ°ï¼catchæ¹æ³æææ§è¡è¿ç¨ä¸­æåºçéè¯¯ã\n\nå¯ä»¥çå°ï¼Promise çåæ³åªæ¯åè°å½æ°çæ¹è¿ï¼ä½¿ç¨thenæ¹æ³ä»¥åï¼å¼æ­¥ä»»å¡çä¸¤æ®µæ§è¡çå¾æ´æ¸æ¥äºï¼é¤æ­¤ä»¥å¤ï¼å¹¶æ æ°æã\n\nPromise çæå¤§é®é¢æ¯ä»£ç åä½ï¼åæ¥çä»»å¡è¢« Promise åè£äºä¸ä¸ï¼ä¸ç®¡ä»ä¹æä½ï¼ä¸ç¼çå»é½æ¯ä¸å thenï¼åæ¥çè¯­ä¹åå¾å¾ä¸æ¸æ¥ã\n\né£ä¹ï¼ææ²¡ææ´å¥½çåæ³å¢ï¼\n\n\n# Generator å½æ°\n\n\n# åç¨\n\nä¼ ç»çç¼ç¨è¯­è¨ï¼æ©æå¼æ­¥ç¼ç¨çè§£å³æ¹æ¡ï¼å¶å®æ¯å¤ä»»å¡çè§£å³æ¹æ¡ï¼ãå¶ä¸­æä¸ç§å«å\"åç¨\"ï¼coroutineï¼ï¼æææ¯å¤ä¸ªçº¿ç¨äºç¸åä½ï¼å®æå¼æ­¥ä»»å¡ã\n\nåç¨æç¹åå½æ°ï¼åæç¹åçº¿ç¨ãå®çè¿è¡æµç¨å¤§è´å¦ä¸ã\n\n * ç¬¬ä¸æ­¥ï¼åç¨Aå¼å§æ§è¡ã\n * ç¬¬äºæ­¥ï¼åç¨Aæ§è¡å°ä¸åï¼è¿å¥æåï¼æ§è¡æè½¬ç§»å°åç¨Bã\n * ç¬¬ä¸æ­¥ï¼ï¼ä¸æ®µæ¶é´åï¼åç¨Bäº¤è¿æ§è¡æã\n * ç¬¬åæ­¥ï¼åç¨Aæ¢å¤æ§è¡ã\n\nä¸é¢æµç¨çåç¨Aï¼å°±æ¯å¼æ­¥ä»»å¡ï¼å ä¸ºå®åæä¸¤æ®µï¼æå¤æ®µï¼æ§è¡ã\n\nä¸¾ä¾æ¥è¯´ï¼è¯»åæä»¶çåç¨åæ³å¦ä¸ã\n\nfunction* asyncJob() {\n  // ...å¶ä»ä»£ç \n  var f = yield readFile(fileA);\n  // ...å¶ä»ä»£ç \n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç çå½æ°asyncJobæ¯ä¸ä¸ªåç¨ï¼å®çå¥¥å¦å°±å¨å¶ä¸­çyieldå½ä»¤ãå®è¡¨ç¤ºæ§è¡å°æ­¤å¤ï¼æ§è¡æå°äº¤ç»å¶ä»åç¨ãä¹å°±æ¯è¯´ï¼yieldå½ä»¤æ¯å¼æ­¥ä¸¤ä¸ªé¶æ®µçåççº¿ã\n\nåç¨éå°yieldå½ä»¤å°±æåï¼ç­å°æ§è¡æè¿åï¼åä»æåçå°æ¹ç»§ç»­å¾åæ§è¡ãå®çæå¤§ä¼ç¹ï¼å°±æ¯ä»£ç çåæ³éå¸¸ååæ­¥æä½ï¼å¦æå»é¤yieldå½ä»¤ï¼ç®ç´ä¸æ¨¡ä¸æ ·ã\n\n\n# åç¨ç Generator å½æ°å®ç°\n\nGenerator å½æ°æ¯åç¨å¨ ES6 çå®ç°ï¼æå¤§ç¹ç¹å°±æ¯å¯ä»¥äº¤åºå½æ°çæ§è¡æï¼å³æåæ§è¡ï¼ã\n\næ´ä¸ª Generator å½æ°å°±æ¯ä¸ä¸ªå°è£çå¼æ­¥ä»»å¡ï¼æèè¯´æ¯å¼æ­¥ä»»å¡çå®¹å¨ãå¼æ­¥æä½éè¦æåçå°æ¹ï¼é½ç¨yieldè¯­å¥æ³¨æãGenerator å½æ°çæ§è¡æ¹æ³å¦ä¸ã\n\nfunction* gen(x) {\n  var y = yield x + 2;\n  return y;\n}\n\nvar g = gen(1);\ng.next() // { value: 3, done: false }\ng.next() // { value: undefined, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼è°ç¨ Generator å½æ°ï¼ä¼è¿åä¸ä¸ªåé¨æéï¼å³éåå¨ï¼gãè¿æ¯ Generator å½æ°ä¸åäºæ®éå½æ°çå¦ä¸ä¸ªå°æ¹ï¼å³æ§è¡å®ä¸ä¼è¿åç»æï¼è¿åçæ¯æéå¯¹è±¡ãè°ç¨æégçnextæ¹æ³ï¼ä¼ç§»å¨åé¨æéï¼å³æ§è¡å¼æ­¥ä»»å¡çç¬¬ä¸æ®µï¼ï¼æåç¬¬ä¸ä¸ªéå°çyieldè¯­å¥ï¼ä¸ä¾æ¯æ§è¡å°x + 2ä¸ºæ­¢ã\n\næ¢è¨ä¹ï¼nextæ¹æ³çä½ç¨æ¯åé¶æ®µæ§è¡Generatorå½æ°ãæ¯æ¬¡è°ç¨nextæ¹æ³ï¼ä¼è¿åä¸ä¸ªå¯¹è±¡ï¼è¡¨ç¤ºå½åé¶æ®µçä¿¡æ¯ï¼valueå±æ§ådoneå±æ§ï¼ãvalueå±æ§æ¯yieldè¯­å¥åé¢è¡¨è¾¾å¼çå¼ï¼è¡¨ç¤ºå½åé¶æ®µçå¼ï¼doneå±æ§æ¯ä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤º Generator å½æ°æ¯å¦æ§è¡å®æ¯ï¼å³æ¯å¦è¿æä¸ä¸ä¸ªé¶æ®µã\n\n\n# Generator å½æ°çæ°æ®äº¤æ¢åéè¯¯å¤ç\n\nGenerator å½æ°å¯ä»¥æåæ§è¡åæ¢å¤æ§è¡ï¼è¿æ¯å®è½å°è£å¼æ­¥ä»»å¡çæ ¹æ¬åå ãé¤æ­¤ä¹å¤ï¼å®è¿æä¸¤ä¸ªç¹æ§ï¼ä½¿å®å¯ä»¥ä½ä¸ºå¼æ­¥ç¼ç¨çå®æ´è§£å³æ¹æ¡ï¼å½æ°ä½åå¤çæ°æ®äº¤æ¢åéè¯¯å¤çæºå¶ã\n\nnextè¿åå¼ç value å±æ§ï¼æ¯ Generator å½æ°åå¤è¾åºæ°æ®ï¼nextæ¹æ³è¿å¯ä»¥æ¥ååæ°ï¼å Generator å½æ°ä½åè¾å¥æ°æ®ã\n\nfunction* gen(x){\n  var y = yield x + 2;\n  return y;\n}\n\nvar g = gen(1);\ng.next() // { value: 3, done: false }\ng.next(2) // { value: 2, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬ä¸ä¸ªnextæ¹æ³çvalueå±æ§ï¼è¿åè¡¨è¾¾å¼x + 2çå¼3ãç¬¬äºä¸ªnextæ¹æ³å¸¦æåæ°2ï¼è¿ä¸ªåæ°å¯ä»¥ä¼ å¥ Generator å½æ°ï¼ä½ä¸ºä¸ä¸ªé¶æ®µå¼æ­¥ä»»å¡çè¿åç»æï¼è¢«å½æ°ä½åçåéyæ¥æ¶ãå æ­¤ï¼è¿ä¸æ­¥çvalueå±æ§ï¼è¿åçå°±æ¯2ï¼åéyçå¼ï¼ã\n\nGenerator å½æ°åé¨è¿å¯ä»¥é¨ç½²éè¯¯å¤çä»£ç ï¼æè·å½æ°ä½å¤æåºçéè¯¯ã\n\nfunction* gen(x){\n  try {\n    var y = yield x + 2;\n  } catch (e){\n    console.log(e);\n  }\n  return y;\n}\n\nvar g = gen(1);\ng.next();\ng.throw('åºéäº');\n// åºéäº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç çæåä¸è¡ï¼Generator å½æ°ä½å¤ï¼ä½¿ç¨æéå¯¹è±¡çthrowæ¹æ³æåºçéè¯¯ï¼å¯ä»¥è¢«å½æ°ä½åçtry...catchä»£ç åæè·ãè¿æå³çï¼åºéçä»£ç ä¸å¤çéè¯¯çä»£ç ï¼å®ç°äºæ¶é´åç©ºé´ä¸çåç¦»ï¼è¿å¯¹äºå¼æ­¥ç¼ç¨æ çæ¯å¾éè¦çã\n\n\n# å¼æ­¥ä»»å¡çå°è£\n\nä¸é¢ççå¦ä½ä½¿ç¨ Generator å½æ°ï¼æ§è¡ä¸ä¸ªçå®çå¼æ­¥ä»»å¡ã\n\nvar fetch = require('node-fetch');\n\nfunction* gen(){\n  var url = 'https://api.github.com/users/github';\n  var result = yield fetch(url);\n  console.log(result.bio);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼Generator å½æ°å°è£äºä¸ä¸ªå¼æ­¥æä½ï¼è¯¥æä½åè¯»åä¸ä¸ªè¿ç¨æ¥å£ï¼ç¶åä» JSON æ ¼å¼çæ°æ®è§£æä¿¡æ¯ãå°±ååé¢è¯´è¿çï¼è¿æ®µä»£ç éå¸¸ååæ­¥æä½ï¼é¤äºå ä¸äºyieldå½ä»¤ã\n\næ§è¡è¿æ®µä»£ç çæ¹æ³å¦ä¸ã\n\nvar g = gen();\nvar result = g.next();\n\nresult.value.then(function(data){\n  return data.json();\n}).then(function(data){\n  g.next(data);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼é¦åæ§è¡ Generator å½æ°ï¼è·åéåå¨å¯¹è±¡ï¼ç¶åä½¿ç¨nextæ¹æ³ï¼ç¬¬äºè¡ï¼ï¼æ§è¡å¼æ­¥ä»»å¡çç¬¬ä¸é¶æ®µãç±äºFetchæ¨¡åè¿åçæ¯ä¸ä¸ª Promise å¯¹è±¡ï¼å æ­¤è¦ç¨thenæ¹æ³è°ç¨ä¸ä¸ä¸ªnextæ¹æ³ã\n\nå¯ä»¥çå°ï¼è½ç¶ Generator å½æ°å°å¼æ­¥æä½è¡¨ç¤ºå¾å¾ç®æ´ï¼ä½æ¯æµç¨ç®¡çå´ä¸æ¹ä¾¿ï¼å³ä½æ¶æ§è¡ç¬¬ä¸é¶æ®µãä½æ¶æ§è¡ç¬¬äºé¶æ®µï¼ã\n\n\n# Thunk å½æ°\n\nThunk å½æ°æ¯èªå¨æ§è¡ Generator å½æ°çä¸ç§æ¹æ³ã\n\n\n# åæ°çæ±å¼ç­ç¥\n\nThunk å½æ°æ©å¨ä¸ä¸ªä¸çºª 60 å¹´ä»£å°±è¯çäºã\n\né£æ¶ï¼ç¼ç¨è¯­è¨ååèµ·æ­¥ï¼è®¡ç®æºå­¦å®¶è¿å¨ç ç©¶ï¼ç¼è¯å¨æä¹åæ¯è¾å¥½ãä¸ä¸ªäºè®ºçç¦ç¹æ¯\"æ±å¼ç­ç¥\"ï¼å³å½æ°çåæ°å°åºåºè¯¥ä½æ¶æ±å¼ã\n\nvar x = 1;\n\nfunction f(m) {\n  return m * 2;\n}\n\nf(x + 5)\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç åå®ä¹å½æ°fï¼ç¶ååå®ä¼ å¥è¡¨è¾¾å¼x + 5ãè¯·é®ï¼è¿ä¸ªè¡¨è¾¾å¼åºè¯¥ä½æ¶æ±å¼ï¼\n\nä¸ç§æè§æ¯\"ä¼ å¼è°ç¨\"ï¼call by valueï¼ï¼å³å¨è¿å¥å½æ°ä½ä¹åï¼å°±è®¡ç®x + 5çå¼ï¼ç­äº 6ï¼ï¼åå°è¿ä¸ªå¼ä¼ å¥å½æ°fãC è¯­è¨å°±éç¨è¿ç§ç­ç¥ã\n\nf(x + 5)\n// ä¼ å¼è°ç¨æ¶ï¼ç­åäº\nf(6)\n\n\n1\n2\n3\n\n\nå¦ä¸ç§æè§æ¯âä¼ åè°ç¨âï¼call by nameï¼ï¼å³ç´æ¥å°è¡¨è¾¾å¼x + 5ä¼ å¥å½æ°ä½ï¼åªå¨ç¨å°å®çæ¶åæ±å¼ãHaskell è¯­è¨éç¨è¿ç§ç­ç¥ã\n\nf(x + 5)\n// ä¼ åè°ç¨æ¶ï¼ç­åäº\n(x + 5) * 2\n\n\n1\n2\n3\n\n\nä¼ å¼è°ç¨åä¼ åè°ç¨ï¼åªä¸ç§æ¯è¾å¥½ï¼\n\nåç­æ¯åæå©å¼ãä¼ å¼è°ç¨æ¯è¾ç®åï¼ä½æ¯å¯¹åæ°æ±å¼çæ¶åï¼å®éä¸è¿æ²¡ç¨å°è¿ä¸ªåæ°ï¼æå¯è½é ææ§è½æå¤±ã\n\nfunction f(a, b){\n  return b;\n}\n\nf(3 * x * x - 2 * x - 1, x);\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fçç¬¬ä¸ä¸ªåæ°æ¯ä¸ä¸ªå¤æçè¡¨è¾¾å¼ï¼ä½æ¯å½æ°ä½åæ ¹æ¬æ²¡ç¨å°ãå¯¹è¿ä¸ªåæ°æ±å¼ï¼å®éä¸æ¯ä¸å¿è¦çãå æ­¤ï¼æä¸äºè®¡ç®æºå­¦å®¶å¾åäº\"ä¼ åè°ç¨\"ï¼å³åªå¨æ§è¡æ¶æ±å¼ã\n\n\n# Thunk å½æ°çå«ä¹\n\nç¼è¯å¨çâä¼ åè°ç¨âå®ç°ï¼å¾å¾æ¯å°åæ°æ¾å°ä¸ä¸ªä¸´æ¶å½æ°ä¹ä¸­ï¼åå°è¿ä¸ªä¸´æ¶å½æ°ä¼ å¥å½æ°ä½ãè¿ä¸ªä¸´æ¶å½æ°å°±å«å Thunk å½æ°ã\n\nfunction f(m) {\n  return m * 2;\n}\n\nf(x + 5);\n\n// ç­åäº\n\nvar thunk = function () {\n  return x + 5;\n};\n\nfunction f(thunk) {\n  return thunk() * 2;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ° f çåæ°x + 5è¢«ä¸ä¸ªå½æ°æ¿æ¢äºãå¡æ¯ç¨å°ååæ°çå°æ¹ï¼å¯¹Thunkå½æ°æ±å¼å³å¯ã\n\nè¿å°±æ¯ Thunk å½æ°çå®ä¹ï¼å®æ¯âä¼ åè°ç¨âçä¸ç§å®ç°ç­ç¥ï¼ç¨æ¥æ¿æ¢æä¸ªè¡¨è¾¾å¼ã\n\n\n# JavaScript è¯­è¨ç Thunk å½æ°\n\nJavaScript è¯­è¨æ¯ä¼ å¼è°ç¨ï¼å®ç Thunk å½æ°å«ä¹ææä¸åãå¨ JavaScript è¯­è¨ä¸­ï¼Thunk å½æ°æ¿æ¢çä¸æ¯è¡¨è¾¾å¼ï¼èæ¯å¤åæ°å½æ°ï¼å°å¶æ¿æ¢æä¸ä¸ªåªæ¥ååè°å½æ°ä½ä¸ºåæ°çååæ°å½æ°ã\n\n// æ­£å¸¸çæ¬çreadFileï¼å¤åæ°çæ¬ï¼\nfs.readFile(fileName, callback);\n\n// Thunkçæ¬çreadFileï¼ååæ°çæ¬ï¼\nvar Thunk = function (fileName) {\n  return function (callback) {\n    return fs.readFile(fileName, callback);\n  };\n};\n\nvar readFileThunk = Thunk(fileName);\nreadFileThunk(callback);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼fsæ¨¡åçreadFileæ¹æ³æ¯ä¸ä¸ªå¤åæ°å½æ°ï¼ä¸¤ä¸ªåæ°åå«ä¸ºæä»¶åååè°å½æ°ãç»è¿è½¬æ¢å¨å¤çï¼å®åæäºä¸ä¸ªååæ°å½æ°ï¼åªæ¥ååè°å½æ°ä½ä¸ºåæ°ãè¿ä¸ªååæ°çæ¬ï¼å°±å«å Thunk å½æ°ã\n\nä»»ä½å½æ°ï¼åªè¦åæ°æåè°å½æ°ï¼å°±è½åæ Thunk å½æ°çå½¢å¼ãä¸é¢æ¯ä¸ä¸ªç®åç Thunk å½æ°è½¬æ¢å¨ã\n\n// ES5çæ¬\nvar Thunk = function(fn){\n  return function (){\n    var args = Array.prototype.slice.call(arguments);\n    return function (callback){\n      args.push(callback);\n      return fn.apply(this, args);\n    }\n  };\n};\n\n// ES6çæ¬\nconst Thunk = function(fn) {\n  return function (...args) {\n    return function (callback) {\n      return fn.call(this, ...args, callback);\n    }\n  };\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä½¿ç¨ä¸é¢çè½¬æ¢å¨ï¼çæfs.readFileç Thunk å½æ°ã\n\nvar readFileThunk = Thunk(fs.readFile);\nreadFileThunk(fileA)(callback);\n\n\n1\n2\n\n\nä¸é¢æ¯å¦ä¸ä¸ªå®æ´çä¾å­ã\n\nfunction f(a, cb) {\n  cb(a);\n}\nconst ft = Thunk(f);\n\nft(1)(console.log) // 1\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# Thunkify æ¨¡å\n\nçäº§ç¯å¢çè½¬æ¢å¨ï¼å»ºè®®ä½¿ç¨ Thunkify æ¨¡åã\n\né¦åæ¯å®è£ã\n\n$ npm install thunkify\n\n\n1\n\n\nä½¿ç¨æ¹å¼å¦ä¸ã\n\nvar thunkify = require('thunkify');\nvar fs = require('fs');\n\nvar read = thunkify(fs.readFile);\nread('package.json')(function(err, str){\n  // ...\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nThunkify çæºç ä¸ä¸ä¸èé£ä¸ªç®åçè½¬æ¢å¨éå¸¸åã\n\nfunction thunkify(fn) {\n  return function() {\n    var args = new Array(arguments.length);\n    var ctx = this;\n\n    for (var i = 0; i < args.length; ++i) {\n      args[i] = arguments[i];\n    }\n\n    return function (done) {\n      var called;\n\n      args.push(function () {\n        if (called) return;\n        called = true;\n        done.apply(null, arguments);\n      });\n\n      try {\n        fn.apply(ctx, args);\n      } catch (err) {\n        done(err);\n      }\n    }\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nå®çæºç ä¸»è¦å¤äºä¸ä¸ªæ£æ¥æºå¶ï¼åécalledç¡®ä¿åè°å½æ°åªè¿è¡ä¸æ¬¡ãè¿æ ·çè®¾è®¡ä¸ä¸æç Generator å½æ°ç¸å³ãè¯·çä¸é¢çä¾å­ã\n\nfunction f(a, b, callback){\n  var sum = a + b;\n  callback(sum);\n  callback(sum);\n}\n\nvar ft = thunkify(f);\nvar print = console.log.bind(console);\nft(1, 2)(print);\n// 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºthunkifyåªåè®¸åè°å½æ°æ§è¡ä¸æ¬¡ï¼æä»¥åªè¾åºä¸è¡ç»æã\n\n\n# Generator å½æ°çæµç¨ç®¡ç\n\nä½ å¯è½ä¼é®ï¼ Thunk å½æ°æä»ä¹ç¨ï¼åç­æ¯ä»¥åç¡®å®æ²¡ä»ä¹ç¨ï¼ä½æ¯ ES6 æäº Generator å½æ°ï¼Thunk å½æ°ç°å¨å¯ä»¥ç¨äº Generator å½æ°çèªå¨æµç¨ç®¡çã\n\nGenerator å½æ°å¯ä»¥èªå¨æ§è¡ã\n\nfunction* gen() {\n  // ...\n}\n\nvar g = gen();\nvar res = g.next();\n\nwhile(!res.done){\n  console.log(res.value);\n  res = g.next();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼Generator å½æ°genä¼èªå¨æ§è¡å®æææ­¥éª¤ã\n\nä½æ¯ï¼è¿ä¸éåå¼æ­¥æä½ãå¦æå¿é¡»ä¿è¯åä¸æ­¥æ§è¡å®ï¼æè½æ§è¡åä¸æ­¥ï¼ä¸é¢çèªå¨æ§è¡å°±ä¸å¯è¡ãè¿æ¶ï¼Thunk å½æ°å°±è½æ´¾ä¸ç¨å¤ãä»¥è¯»åæä»¶ä¸ºä¾ãä¸é¢ç Generator å½æ°å°è£äºä¸¤ä¸ªå¼æ­¥æä½ã\n\nvar fs = require('fs');\nvar thunkify = require('thunkify');\nvar readFileThunk = thunkify(fs.readFile);\n\nvar gen = function* (){\n  var r1 = yield readFileThunk('/etc/fstab');\n  console.log(r1.toString());\n  var r2 = yield readFileThunk('/etc/shells');\n  console.log(r2.toString());\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼yieldå½ä»¤ç¨äºå°ç¨åºçæ§è¡æç§»åº Generator å½æ°ï¼é£ä¹å°±éè¦ä¸ç§æ¹æ³ï¼å°æ§è¡æåäº¤è¿ç» Generator å½æ°ã\n\nè¿ç§æ¹æ³å°±æ¯ Thunk å½æ°ï¼å ä¸ºå®å¯ä»¥å¨åè°å½æ°éï¼å°æ§è¡æäº¤è¿ç» Generator å½æ°ãä¸ºäºä¾¿äºçè§£ï¼æä»¬åçå¦ä½æå¨æ§è¡ä¸é¢è¿ä¸ª Generator å½æ°ã\n\nvar g = gen();\n\nvar r1 = g.next();\nr1.value(function (err, data) {\n  if (err) throw err;\n  var r2 = g.next(data);\n  r2.value(function (err, data) {\n    if (err) throw err;\n    g.next(data);\n  });\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼åégæ¯ Generator å½æ°çåé¨æéï¼è¡¨ç¤ºç®åæ§è¡å°åªä¸æ­¥ãnextæ¹æ³è´è´£å°æéç§»å¨å°ä¸ä¸æ­¥ï¼å¹¶è¿åè¯¥æ­¥çä¿¡æ¯ï¼valueå±æ§ådoneå±æ§ï¼ã\n\nä»ç»æ¥çä¸é¢çä»£ç ï¼å¯ä»¥åç° Generator å½æ°çæ§è¡è¿ç¨ï¼å¶å®æ¯å°åä¸ä¸ªåè°å½æ°ï¼åå¤ä¼ å¥nextæ¹æ³çvalueå±æ§ãè¿ä½¿å¾æä»¬å¯ä»¥ç¨éå½æ¥èªå¨å®æè¿ä¸ªè¿ç¨ã\n\n\n# Thunk å½æ°çèªå¨æµç¨ç®¡ç\n\nThunk å½æ°çæ­£çå¨åï¼å¨äºå¯ä»¥èªå¨æ§è¡ Generator å½æ°ãä¸é¢å°±æ¯ä¸ä¸ªåºäº Thunk å½æ°ç Generator æ§è¡å¨ã\n\nfunction run(fn) {\n  var gen = fn();\n\n  function next(err, data) {\n    var result = gen.next(data);\n    if (result.done) return;\n    result.value(next);\n  }\n\n  next();\n}\n\nfunction* g() {\n  // ...\n}\n\nrun(g);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç çrunå½æ°ï¼å°±æ¯ä¸ä¸ª Generator å½æ°çèªå¨æ§è¡å¨ãåé¨çnextå½æ°å°±æ¯ Thunk çåè°å½æ°ãnextå½æ°åå°æéç§»å° Generator å½æ°çä¸ä¸æ­¥ï¼gen.nextæ¹æ³ï¼ï¼ç¶åå¤æ­ Generator å½æ°æ¯å¦ç»æï¼result.doneå±æ§ï¼ï¼å¦ææ²¡ç»æï¼å°±å°nextå½æ°åä¼ å¥ Thunk å½æ°ï¼result.valueå±æ§ï¼ï¼å¦åå°±ç´æ¥éåºã\n\næäºè¿ä¸ªæ§è¡å¨ï¼æ§è¡ Generator å½æ°æ¹ä¾¿å¤äºãä¸ç®¡åé¨æå¤å°ä¸ªå¼æ­¥æä½ï¼ç´æ¥æ Generator å½æ°ä¼ å¥runå½æ°å³å¯ãå½ç¶ï¼åææ¯æ¯ä¸ä¸ªå¼æ­¥æä½ï¼é½è¦æ¯ Thunk å½æ°ï¼ä¹å°±æ¯è¯´ï¼è·å¨yieldå½ä»¤åé¢çå¿é¡»æ¯ Thunk å½æ°ã\n\nvar g = function* (){\n  var f1 = yield readFileThunk('fileA');\n  var f2 = yield readFileThunk('fileB');\n  // ...\n  var fn = yield readFileThunk('fileN');\n};\n\nrun(g);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°gå°è£äºnä¸ªå¼æ­¥çè¯»åæä»¶æä½ï¼åªè¦æ§è¡runå½æ°ï¼è¿äºæä½å°±ä¼èªå¨å®æãè¿æ ·ä¸æ¥ï¼å¼æ­¥æä½ä¸ä»å¯ä»¥åå¾ååæ­¥æä½ï¼èä¸ä¸è¡ä»£ç å°±å¯ä»¥æ§è¡ã\n\nThunk å½æ°å¹¶ä¸æ¯ Generator å½æ°èªå¨æ§è¡çå¯ä¸æ¹æ¡ãå ä¸ºèªå¨æ§è¡çå³é®æ¯ï¼å¿é¡»æä¸ç§æºå¶ï¼èªå¨æ§å¶ Generator å½æ°çæµç¨ï¼æ¥æ¶åäº¤è¿ç¨åºçæ§è¡æãåè°å½æ°å¯ä»¥åå°è¿ä¸ç¹ï¼Promise å¯¹è±¡ä¹å¯ä»¥åå°è¿ä¸ç¹ã\n\n\n# co æ¨¡å\n\n\n# åºæ¬ç¨æ³\n\nco æ¨¡åæ¯èåç¨åºå TJ Holowaychuk äº 2013 å¹´ 6 æåå¸çä¸ä¸ªå°å·¥å·ï¼ç¨äº Generator å½æ°çèªå¨æ§è¡ã\n\nä¸é¢æ¯ä¸ä¸ª Generator å½æ°ï¼ç¨äºä¾æ¬¡è¯»åä¸¤ä¸ªæä»¶ã\n\nvar gen = function* () {\n  var f1 = yield readFile('/etc/fstab');\n  var f2 = yield readFile('/etc/shells');\n  console.log(f1.toString());\n  console.log(f2.toString());\n};\n\n\n1\n2\n3\n4\n5\n6\n\n\nco æ¨¡åå¯ä»¥è®©ä½ ä¸ç¨ç¼å Generator å½æ°çæ§è¡å¨ã\n\nvar co = require('co');\nco(gen);\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼Generator å½æ°åªè¦ä¼ å¥coå½æ°ï¼å°±ä¼èªå¨æ§è¡ã\n\ncoå½æ°è¿åä¸ä¸ªPromiseå¯¹è±¡ï¼å æ­¤å¯ä»¥ç¨thenæ¹æ³æ·»å åè°å½æ°ã\n\nco(gen).then(function (){\n  console.log('Generator å½æ°æ§è¡å®æ');\n});\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼ç­å° Generator å½æ°æ§è¡ç»æï¼å°±ä¼è¾åºä¸è¡æç¤ºã\n\n\n# co æ¨¡åçåç\n\nä¸ºä»ä¹ co å¯ä»¥èªå¨æ§è¡ Generator å½æ°ï¼\n\nåé¢è¯´è¿ï¼Generator å°±æ¯ä¸ä¸ªå¼æ­¥æä½çå®¹å¨ãå®çèªå¨æ§è¡éè¦ä¸ç§æºå¶ï¼å½å¼æ­¥æä½æäºç»æï¼è½å¤èªå¨äº¤åæ§è¡æã\n\nä¸¤ç§æ¹æ³å¯ä»¥åå°è¿ä¸ç¹ã\n\nï¼1ï¼åè°å½æ°ãå°å¼æ­¥æä½åè£æ Thunk å½æ°ï¼å¨åè°å½æ°éé¢äº¤åæ§è¡æã\n\nï¼2ï¼Promise å¯¹è±¡ãå°å¼æ­¥æä½åè£æ Promise å¯¹è±¡ï¼ç¨thenæ¹æ³äº¤åæ§è¡æã\n\nco æ¨¡åå¶å®å°±æ¯å°ä¸¤ç§èªå¨æ§è¡å¨ï¼Thunk å½æ°å Promise å¯¹è±¡ï¼ï¼åè£æä¸ä¸ªæ¨¡åãä½¿ç¨ co çåææ¡ä»¶æ¯ï¼Generator å½æ°çyieldå½ä»¤åé¢ï¼åªè½æ¯ Thunk å½æ°æ Promise å¯¹è±¡ãå¦ææ°ç»æå¯¹è±¡çæåï¼å¨é¨é½æ¯ Promise å¯¹è±¡ï¼ä¹å¯ä»¥ä½¿ç¨ coï¼è¯¦è§åæçä¾å­ã\n\nä¸ä¸èå·²ç»ä»ç»äºåºäº Thunk å½æ°çèªå¨æ§è¡å¨ãä¸é¢æ¥çï¼åºäº Promise å¯¹è±¡çèªå¨æ§è¡å¨ãè¿æ¯çè§£ co æ¨¡åå¿é¡»çã\n\n\n# åºäº Promise å¯¹è±¡çèªå¨æ§è¡\n\nè¿æ¯æ²¿ç¨ä¸é¢çä¾å­ãé¦åï¼æfsæ¨¡åçreadFileæ¹æ³åè£æä¸ä¸ª Promise å¯¹è±¡ã\n\nvar fs = require('fs');\n\nvar readFile = function (fileName){\n  return new Promise(function (resolve, reject){\n    fs.readFile(fileName, function(error, data){\n      if (error) return reject(error);\n      resolve(data);\n    });\n  });\n};\n\nvar gen = function* (){\n  var f1 = yield readFile('/etc/fstab');\n  var f2 = yield readFile('/etc/shells');\n  console.log(f1.toString());\n  console.log(f2.toString());\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nç¶åï¼æå¨æ§è¡ä¸é¢ç Generator å½æ°ã\n\nvar g = gen();\n\ng.next().value.then(function(data){\n  g.next(data).value.then(function(data){\n    g.next(data);\n  });\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næå¨æ§è¡å¶å®å°±æ¯ç¨thenæ¹æ³ï¼å±å±æ·»å åè°å½æ°ãçè§£äºè¿ä¸ç¹ï¼å°±å¯ä»¥ååºä¸ä¸ªèªå¨æ§è¡å¨ã\n\nfunction run(gen){\n  var g = gen();\n\n  function next(data){\n    var result = g.next(data);\n    if (result.done) return result.value;\n    result.value.then(function(data){\n      next(data);\n    });\n  }\n\n  next();\n}\n\nrun(gen);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼åªè¦ Generator å½æ°è¿æ²¡æ§è¡å°æåä¸æ­¥ï¼nextå½æ°å°±è°ç¨èªèº«ï¼ä»¥æ­¤å®ç°èªå¨æ§è¡ã\n\n\n# co æ¨¡åçæºç \n\nco å°±æ¯ä¸é¢é£ä¸ªèªå¨æ§è¡å¨çæ©å±ï¼å®çæºç åªæå åè¡ï¼éå¸¸ç®åã\n\né¦åï¼co å½æ°æ¥å Generator å½æ°ä½ä¸ºåæ°ï¼è¿åä¸ä¸ª Promise å¯¹è±¡ã\n\nfunction co(gen) {\n  var ctx = this;\n\n  return new Promise(function(resolve, reject) {\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¨è¿åç Promise å¯¹è±¡éé¢ï¼co åæ£æ¥åæ°genæ¯å¦ä¸º Generator å½æ°ãå¦ææ¯ï¼å°±æ§è¡è¯¥å½æ°ï¼å¾å°ä¸ä¸ªåé¨æéå¯¹è±¡ï¼å¦æä¸æ¯å°±è¿åï¼å¹¶å° Promise å¯¹è±¡çç¶ææ¹ä¸ºresolvedã\n\nfunction co(gen) {\n  var ctx = this;\n\n  return new Promise(function(resolve, reject) {\n    if (typeof gen === 'function') gen = gen.call(ctx);\n    if (!gen || typeof gen.next !== 'function') return resolve(gen);\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næ¥çï¼co å° Generator å½æ°çåé¨æéå¯¹è±¡çnextæ¹æ³ï¼åè£æonFulfilledå½æ°ãè¿ä¸»è¦æ¯ä¸ºäºè½å¤æææåºçéè¯¯ã\n\nfunction co(gen) {\n  var ctx = this;\n\n  return new Promise(function(resolve, reject) {\n    if (typeof gen === 'function') gen = gen.call(ctx);\n    if (!gen || typeof gen.next !== 'function') return resolve(gen);\n\n    onFulfilled();\n    function onFulfilled(res) {\n      var ret;\n      try {\n        ret = gen.next(res);\n      } catch (e) {\n        return reject(e);\n      }\n      next(ret);\n    }\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\næåï¼å°±æ¯å³é®çnextå½æ°ï¼å®ä¼åå¤è°ç¨èªèº«ã\n\nfunction next(ret) {\n  if (ret.done) return resolve(ret.value);\n  var value = toPromise.call(ctx, ret.value);\n  if (value && isPromise(value)) return value.then(onFulfilled, onRejected);\n  return onRejected(\n    new TypeError(\n      'You may only yield a function, promise, generator, array, or object, '\n      + 'but the following object was passed: \"'\n      + String(ret.value)\n      + '\"'\n    )\n  );\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼nextå½æ°çåé¨ä»£ç ï¼ä¸å±åªæåè¡å½ä»¤ã\n\nç¬¬ä¸è¡ï¼æ£æ¥å½åæ¯å¦ä¸º Generator å½æ°çæåä¸æ­¥ï¼å¦ææ¯å°±è¿åã\n\nç¬¬äºè¡ï¼ç¡®ä¿æ¯ä¸æ­¥çè¿åå¼ï¼æ¯ Promise å¯¹è±¡ã\n\nç¬¬ä¸è¡ï¼ä½¿ç¨thenæ¹æ³ï¼ä¸ºè¿åå¼å ä¸åè°å½æ°ï¼ç¶åéè¿onFulfilledå½æ°åæ¬¡è°ç¨nextå½æ°ã\n\nç¬¬åè¡ï¼å¨åæ°ä¸ç¬¦åè¦æ±çæåµä¸ï¼åæ°é Thunk å½æ°å Promise å¯¹è±¡ï¼ï¼å° Promise å¯¹è±¡çç¶ææ¹ä¸ºrejectedï¼ä»èç»æ­¢æ§è¡ã\n\n\n# å¤çå¹¶åçå¼æ­¥æä½\n\nco æ¯æå¹¶åçå¼æ­¥æä½ï¼å³åè®¸æäºæä½åæ¶è¿è¡ï¼ç­å°å®ä»¬å¨é¨å®æï¼æè¿è¡ä¸ä¸æ­¥ã\n\nè¿æ¶ï¼è¦æå¹¶åçæä½é½æ¾å¨æ°ç»æå¯¹è±¡éé¢ï¼è·å¨yieldè¯­å¥åé¢ã\n\n// æ°ç»çåæ³\nco(function* () {\n  var res = yield [\n    Promise.resolve(1),\n    Promise.resolve(2)\n  ];\n  console.log(res);\n}).catch(onerror);\n\n// å¯¹è±¡çåæ³\nco(function* () {\n  var res = yield {\n    1: Promise.resolve(1),\n    2: Promise.resolve(2),\n  };\n  console.log(res);\n}).catch(onerror);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nco(function* () {\n  var values = [n1, n2, n3];\n  yield values.map(somethingAsync);\n});\n\nfunction* somethingAsync(x) {\n  // do something async\n  return y\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢çä»£ç åè®¸å¹¶åä¸ä¸ªsomethingAsyncå¼æ­¥æä½ï¼ç­å°å®ä»¬å¨é¨å®æï¼æä¼è¿è¡ä¸ä¸æ­¥ã\n\n\n# å®ä¾ï¼å¤ç Stream\n\nNode æä¾ Stream æ¨¡å¼è¯»åæ°æ®ï¼ç¹ç¹æ¯ä¸æ¬¡åªå¤çæ°æ®çä¸é¨åï¼æ°æ®åæä¸ååä¾æ¬¡å¤çï¼å°±å¥½åâæ°æ®æµâä¸æ ·ãè¿å¯¹äºå¤çå¤§è§æ¨¡æ°æ®éå¸¸æå©ãStream æ¨¡å¼ä½¿ç¨ EventEmitter APIï¼ä¼éæ¾ä¸ä¸ªäºä»¶ã\n\n * dataäºä»¶ï¼ä¸ä¸åæ°æ®åå·²ç»åå¤å¥½äºã\n * endäºä»¶ï¼æ´ä¸ªâæ°æ®æµâå¤çå®äºã\n * erroräºä»¶ï¼åçéè¯¯ã\n\nä½¿ç¨Promise.race()å½æ°ï¼å¯ä»¥å¤æ­è¿ä¸ä¸ªäºä»¶ä¹ä¸­åªä¸ä¸ªæååçï¼åªæå½dataäºä»¶æååçæ¶ï¼æè¿å¥ä¸ä¸ä¸ªæ°æ®åçå¤çãä»èï¼æä»¬å¯ä»¥éè¿ä¸ä¸ªwhileå¾ªç¯ï¼å®ææææ°æ®çè¯»åã\n\nconst co = require('co');\nconst fs = require('fs');\n\nconst stream = fs.createReadStream('./les_miserables.txt');\nlet valjeanCount = 0;\n\nco(function*() {\n  while(true) {\n    const res = yield Promise.race([\n      new Promise(resolve => stream.once('data', resolve)),\n      new Promise(resolve => stream.once('end', resolve)),\n      new Promise((resolve, reject) => stream.once('error', reject))\n    ]);\n    if (!res) {\n      break;\n    }\n    stream.removeAllListeners('data');\n    stream.removeAllListeners('end');\n    stream.removeAllListeners('error');\n    valjeanCount += (res.toString().match(/valjean/ig) || []).length;\n  }\n  console.log('count:', valjeanCount); // count: 1120\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nä¸é¢ä»£ç éç¨ Stream æ¨¡å¼è¯»åãæ²æ¨ä¸çãçææ¬æä»¶ï¼å¯¹äºæ¯ä¸ªæ°æ®åé½ä½¿ç¨stream.onceæ¹æ³ï¼å¨dataãendãerrorä¸ä¸ªäºä»¶ä¸æ·»å ä¸æ¬¡æ§åè°å½æ°ãåéresåªæå¨dataäºä»¶åçæ¶ææå¼ï¼ç¶åç´¯å æ¯ä¸ªæ°æ®åä¹ä¸­valjeanè¿ä¸ªè¯åºç°çæ¬¡æ°ã",normalizedContent:"# generator å½æ°çå¼æ­¥åºç¨\n\nå¼æ­¥ç¼ç¨å¯¹ javascript è¯­è¨å¤ªéè¦ãjavascript è¯­è¨çæ§è¡ç¯å¢æ¯âåçº¿ç¨âçï¼å¦ææ²¡æå¼æ­¥ç¼ç¨ï¼æ ¹æ¬æ²¡æ³ç¨ï¼éå¡æ­»ä¸å¯ãæ¬ç« ä¸»è¦ä»ç» generator å½æ°å¦ä½å®æå¼æ­¥æä½ã\n\n\n# ä¼ ç»æ¹æ³\n\nes6 è¯çä»¥åï¼å¼æ­¥ç¼ç¨çæ¹æ³ï¼å¤§æ¦æä¸é¢åç§ã\n\n * åè°å½æ°\n * äºä»¶çå¬\n * åå¸/è®¢é\n * promise å¯¹è±¡\n\ngenerator å½æ°å° javascript å¼æ­¥ç¼ç¨å¸¦å¥äºä¸ä¸ªå¨æ°çé¶æ®µã\n\n\n# åºæ¬æ¦å¿µ\n\n\n# å¼æ­¥\n\næè°\"å¼æ­¥\"ï¼ç®åè¯´å°±æ¯ä¸ä¸ªä»»å¡ä¸æ¯è¿ç»­å®æçï¼å¯ä»¥çè§£æè¯¥ä»»å¡è¢«äººä¸ºåæä¸¤æ®µï¼åæ§è¡ç¬¬ä¸æ®µï¼ç¶åè½¬èæ§è¡å¶ä»ä»»å¡ï¼ç­åå¥½äºåå¤ï¼ååè¿å¤´æ§è¡ç¬¬äºæ®µã\n\næ¯å¦ï¼æä¸ä¸ªä»»å¡æ¯è¯»åæä»¶è¿è¡å¤çï¼ä»»å¡çç¬¬ä¸æ®µæ¯åæä½ç³»ç»ååºè¯·æ±ï¼è¦æ±è¯»åæä»¶ãç¶åï¼ç¨åºæ§è¡å¶ä»ä»»å¡ï¼ç­å°æä½ç³»ç»è¿åæä»¶ï¼åæ¥çæ§è¡ä»»å¡çç¬¬äºæ®µï¼å¤çæä»¶ï¼ãè¿ç§ä¸è¿ç»­çæ§è¡ï¼å°±å«åå¼æ­¥ã\n\nç¸åºå°ï¼è¿ç»­çæ§è¡å°±å«ååæ­¥ãç±äºæ¯è¿ç»­æ§è¡ï¼ä¸è½æå¥å¶ä»ä»»å¡ï¼æä»¥æä½ç³»ç»ä»ç¡¬çè¯»åæä»¶çè¿æ®µæ¶é´ï¼ç¨åºåªè½å¹²ç­çã\n\n\n# åè°å½æ°\n\njavascript è¯­è¨å¯¹å¼æ­¥ç¼ç¨çå®ç°ï¼å°±æ¯åè°å½æ°ãæè°åè°å½æ°ï¼å°±æ¯æä»»å¡çç¬¬äºæ®µåç¬åå¨ä¸ä¸ªå½æ°éé¢ï¼ç­å°éæ°æ§è¡è¿ä¸ªä»»å¡çæ¶åï¼å°±ç´æ¥è°ç¨è¿ä¸ªå½æ°ãåè°å½æ°çè±è¯­åå­callbackï¼ç´è¯è¿æ¥å°±æ¯\"éæ°è°ç¨\"ã\n\nè¯»åæä»¶è¿è¡å¤çï¼æ¯è¿æ ·åçã\n\nfs.readfile('/etc/passwd', 'utf-8', function (err, data) {\n  if (err) throw err;\n  console.log(data);\n});\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼readfileå½æ°çç¬¬ä¸ä¸ªåæ°ï¼å°±æ¯åè°å½æ°ï¼ä¹å°±æ¯ä»»å¡çç¬¬äºæ®µãç­å°æä½ç³»ç»è¿åäº/etc/passwdè¿ä¸ªæä»¶ä»¥åï¼åè°å½æ°æä¼æ§è¡ã\n\nä¸ä¸ªæè¶£çé®é¢æ¯ï¼ä¸ºä»ä¹ node çº¦å®ï¼åè°å½æ°çç¬¬ä¸ä¸ªåæ°ï¼å¿é¡»æ¯éè¯¯å¯¹è±¡errï¼å¦ææ²¡æéè¯¯ï¼è¯¥åæ°å°±æ¯nullï¼ï¼\n\nåå æ¯æ§è¡åæä¸¤æ®µï¼ç¬¬ä¸æ®µæ§è¡å®ä»¥åï¼ä»»å¡æå¨çä¸ä¸æç¯å¢å°±å·²ç»ç»æäºãå¨è¿ä»¥åæåºçéè¯¯ï¼åæ¥çä¸ä¸æç¯å¢å·²ç»æ æ³ææï¼åªè½å½ä½åæ°ï¼ä¼ å¥ç¬¬äºæ®µã\n\n\n# promise\n\nåè°å½æ°æ¬èº«å¹¶æ²¡æé®é¢ï¼å®çé®é¢åºç°å¨å¤ä¸ªåè°å½æ°åµå¥ãåå®è¯»åaæä»¶ä¹åï¼åè¯»åbæä»¶ï¼ä»£ç å¦ä¸ã\n\nfs.readfile(filea, 'utf-8', function (err, data) {\n  fs.readfile(fileb, 'utf-8', function (err, data) {\n    // ...\n  });\n});\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¾æ³è±¡ï¼å¦æä¾æ¬¡è¯»åä¸¤ä¸ªä»¥ä¸çæä»¶ï¼å°±ä¼åºç°å¤éåµå¥ãä»£ç ä¸æ¯çºµååå±ï¼èæ¯æ¨ªååå±ï¼å¾å¿«å°±ä¼ä¹±æä¸å¢ï¼æ æ³ç®¡çãå ä¸ºå¤ä¸ªå¼æ­¥æä½å½¢æäºå¼ºè¦åï¼åªè¦æä¸ä¸ªæä½éè¦ä¿®æ¹ï¼å®çä¸å±åè°å½æ°åä¸å±åè°å½æ°ï¼å¯è½é½è¦è·çä¿®æ¹ãè¿ç§æåµå°±ç§°ä¸º\"åè°å½æ°å°ç±\"ï¼callback hellï¼ã\n\npromise å¯¹è±¡å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢èæåºçãå®ä¸æ¯æ°çè¯­æ³åè½ï¼èæ¯ä¸ç§æ°çåæ³ï¼åè®¸å°åè°å½æ°çåµå¥ï¼æ¹æé¾å¼è°ç¨ãéç¨ promiseï¼è¿ç»­è¯»åå¤ä¸ªæä»¶ï¼åæ³å¦ä¸ã\n\nvar readfile = require('fs-readfile-promise');\n\nreadfile(filea)\n.then(function (data) {\n  console.log(data.tostring());\n})\n.then(function () {\n  return readfile(fileb);\n})\n.then(function (data) {\n  console.log(data.tostring());\n})\n.catch(function (err) {\n  console.log(err);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼æä½¿ç¨äºfs-readfile-promiseæ¨¡åï¼å®çä½ç¨å°±æ¯è¿åä¸ä¸ª promise çæ¬çreadfileå½æ°ãpromise æä¾thenæ¹æ³å è½½åè°å½æ°ï¼catchæ¹æ³æææ§è¡è¿ç¨ä¸­æåºçéè¯¯ã\n\nå¯ä»¥çå°ï¼promise çåæ³åªæ¯åè°å½æ°çæ¹è¿ï¼ä½¿ç¨thenæ¹æ³ä»¥åï¼å¼æ­¥ä»»å¡çä¸¤æ®µæ§è¡çå¾æ´æ¸æ¥äºï¼é¤æ­¤ä»¥å¤ï¼å¹¶æ æ°æã\n\npromise çæå¤§é®é¢æ¯ä»£ç åä½ï¼åæ¥çä»»å¡è¢« promise åè£äºä¸ä¸ï¼ä¸ç®¡ä»ä¹æä½ï¼ä¸ç¼çå»é½æ¯ä¸å thenï¼åæ¥çè¯­ä¹åå¾å¾ä¸æ¸æ¥ã\n\né£ä¹ï¼ææ²¡ææ´å¥½çåæ³å¢ï¼\n\n\n# generator å½æ°\n\n\n# åç¨\n\nä¼ ç»çç¼ç¨è¯­è¨ï¼æ©æå¼æ­¥ç¼ç¨çè§£å³æ¹æ¡ï¼å¶å®æ¯å¤ä»»å¡çè§£å³æ¹æ¡ï¼ãå¶ä¸­æä¸ç§å«å\"åç¨\"ï¼coroutineï¼ï¼æææ¯å¤ä¸ªçº¿ç¨äºç¸åä½ï¼å®æå¼æ­¥ä»»å¡ã\n\nåç¨æç¹åå½æ°ï¼åæç¹åçº¿ç¨ãå®çè¿è¡æµç¨å¤§è´å¦ä¸ã\n\n * ç¬¬ä¸æ­¥ï¼åç¨aå¼å§æ§è¡ã\n * ç¬¬äºæ­¥ï¼åç¨aæ§è¡å°ä¸åï¼è¿å¥æåï¼æ§è¡æè½¬ç§»å°åç¨bã\n * ç¬¬ä¸æ­¥ï¼ï¼ä¸æ®µæ¶é´åï¼åç¨bäº¤è¿æ§è¡æã\n * ç¬¬åæ­¥ï¼åç¨aæ¢å¤æ§è¡ã\n\nä¸é¢æµç¨çåç¨aï¼å°±æ¯å¼æ­¥ä»»å¡ï¼å ä¸ºå®åæä¸¤æ®µï¼æå¤æ®µï¼æ§è¡ã\n\nä¸¾ä¾æ¥è¯´ï¼è¯»åæä»¶çåç¨åæ³å¦ä¸ã\n\nfunction* asyncjob() {\n  // ...å¶ä»ä»£ç \n  var f = yield readfile(filea);\n  // ...å¶ä»ä»£ç \n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç çå½æ°asyncjobæ¯ä¸ä¸ªåç¨ï¼å®çå¥¥å¦å°±å¨å¶ä¸­çyieldå½ä»¤ãå®è¡¨ç¤ºæ§è¡å°æ­¤å¤ï¼æ§è¡æå°äº¤ç»å¶ä»åç¨ãä¹å°±æ¯è¯´ï¼yieldå½ä»¤æ¯å¼æ­¥ä¸¤ä¸ªé¶æ®µçåççº¿ã\n\nåç¨éå°yieldå½ä»¤å°±æåï¼ç­å°æ§è¡æè¿åï¼åä»æåçå°æ¹ç»§ç»­å¾åæ§è¡ãå®çæå¤§ä¼ç¹ï¼å°±æ¯ä»£ç çåæ³éå¸¸ååæ­¥æä½ï¼å¦æå»é¤yieldå½ä»¤ï¼ç®ç´ä¸æ¨¡ä¸æ ·ã\n\n\n# åç¨ç generator å½æ°å®ç°\n\ngenerator å½æ°æ¯åç¨å¨ es6 çå®ç°ï¼æå¤§ç¹ç¹å°±æ¯å¯ä»¥äº¤åºå½æ°çæ§è¡æï¼å³æåæ§è¡ï¼ã\n\næ´ä¸ª generator å½æ°å°±æ¯ä¸ä¸ªå°è£çå¼æ­¥ä»»å¡ï¼æèè¯´æ¯å¼æ­¥ä»»å¡çå®¹å¨ãå¼æ­¥æä½éè¦æåçå°æ¹ï¼é½ç¨yieldè¯­å¥æ³¨æãgenerator å½æ°çæ§è¡æ¹æ³å¦ä¸ã\n\nfunction* gen(x) {\n  var y = yield x + 2;\n  return y;\n}\n\nvar g = gen(1);\ng.next() // { value: 3, done: false }\ng.next() // { value: undefined, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼è°ç¨ generator å½æ°ï¼ä¼è¿åä¸ä¸ªåé¨æéï¼å³éåå¨ï¼gãè¿æ¯ generator å½æ°ä¸åäºæ®éå½æ°çå¦ä¸ä¸ªå°æ¹ï¼å³æ§è¡å®ä¸ä¼è¿åç»æï¼è¿åçæ¯æéå¯¹è±¡ãè°ç¨æégçnextæ¹æ³ï¼ä¼ç§»å¨åé¨æéï¼å³æ§è¡å¼æ­¥ä»»å¡çç¬¬ä¸æ®µï¼ï¼æåç¬¬ä¸ä¸ªéå°çyieldè¯­å¥ï¼ä¸ä¾æ¯æ§è¡å°x + 2ä¸ºæ­¢ã\n\næ¢è¨ä¹ï¼nextæ¹æ³çä½ç¨æ¯åé¶æ®µæ§è¡generatorå½æ°ãæ¯æ¬¡è°ç¨nextæ¹æ³ï¼ä¼è¿åä¸ä¸ªå¯¹è±¡ï¼è¡¨ç¤ºå½åé¶æ®µçä¿¡æ¯ï¼valueå±æ§ådoneå±æ§ï¼ãvalueå±æ§æ¯yieldè¯­å¥åé¢è¡¨è¾¾å¼çå¼ï¼è¡¨ç¤ºå½åé¶æ®µçå¼ï¼doneå±æ§æ¯ä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤º generator å½æ°æ¯å¦æ§è¡å®æ¯ï¼å³æ¯å¦è¿æä¸ä¸ä¸ªé¶æ®µã\n\n\n# generator å½æ°çæ°æ®äº¤æ¢åéè¯¯å¤ç\n\ngenerator å½æ°å¯ä»¥æåæ§è¡åæ¢å¤æ§è¡ï¼è¿æ¯å®è½å°è£å¼æ­¥ä»»å¡çæ ¹æ¬åå ãé¤æ­¤ä¹å¤ï¼å®è¿æä¸¤ä¸ªç¹æ§ï¼ä½¿å®å¯ä»¥ä½ä¸ºå¼æ­¥ç¼ç¨çå®æ´è§£å³æ¹æ¡ï¼å½æ°ä½åå¤çæ°æ®äº¤æ¢åéè¯¯å¤çæºå¶ã\n\nnextè¿åå¼ç value å±æ§ï¼æ¯ generator å½æ°åå¤è¾åºæ°æ®ï¼nextæ¹æ³è¿å¯ä»¥æ¥ååæ°ï¼å generator å½æ°ä½åè¾å¥æ°æ®ã\n\nfunction* gen(x){\n  var y = yield x + 2;\n  return y;\n}\n\nvar g = gen(1);\ng.next() // { value: 3, done: false }\ng.next(2) // { value: 2, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬ä¸ä¸ªnextæ¹æ³çvalueå±æ§ï¼è¿åè¡¨è¾¾å¼x + 2çå¼3ãç¬¬äºä¸ªnextæ¹æ³å¸¦æåæ°2ï¼è¿ä¸ªåæ°å¯ä»¥ä¼ å¥ generator å½æ°ï¼ä½ä¸ºä¸ä¸ªé¶æ®µå¼æ­¥ä»»å¡çè¿åç»æï¼è¢«å½æ°ä½åçåéyæ¥æ¶ãå æ­¤ï¼è¿ä¸æ­¥çvalueå±æ§ï¼è¿åçå°±æ¯2ï¼åéyçå¼ï¼ã\n\ngenerator å½æ°åé¨è¿å¯ä»¥é¨ç½²éè¯¯å¤çä»£ç ï¼æè·å½æ°ä½å¤æåºçéè¯¯ã\n\nfunction* gen(x){\n  try {\n    var y = yield x + 2;\n  } catch (e){\n    console.log(e);\n  }\n  return y;\n}\n\nvar g = gen(1);\ng.next();\ng.throw('åºéäº');\n// åºéäº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç çæåä¸è¡ï¼generator å½æ°ä½å¤ï¼ä½¿ç¨æéå¯¹è±¡çthrowæ¹æ³æåºçéè¯¯ï¼å¯ä»¥è¢«å½æ°ä½åçtry...catchä»£ç åæè·ãè¿æå³çï¼åºéçä»£ç ä¸å¤çéè¯¯çä»£ç ï¼å®ç°äºæ¶é´åç©ºé´ä¸çåç¦»ï¼è¿å¯¹äºå¼æ­¥ç¼ç¨æ çæ¯å¾éè¦çã\n\n\n# å¼æ­¥ä»»å¡çå°è£\n\nä¸é¢ççå¦ä½ä½¿ç¨ generator å½æ°ï¼æ§è¡ä¸ä¸ªçå®çå¼æ­¥ä»»å¡ã\n\nvar fetch = require('node-fetch');\n\nfunction* gen(){\n  var url = 'https://api.github.com/users/github';\n  var result = yield fetch(url);\n  console.log(result.bio);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼generator å½æ°å°è£äºä¸ä¸ªå¼æ­¥æä½ï¼è¯¥æä½åè¯»åä¸ä¸ªè¿ç¨æ¥å£ï¼ç¶åä» json æ ¼å¼çæ°æ®è§£æä¿¡æ¯ãå°±ååé¢è¯´è¿çï¼è¿æ®µä»£ç éå¸¸ååæ­¥æä½ï¼é¤äºå ä¸äºyieldå½ä»¤ã\n\næ§è¡è¿æ®µä»£ç çæ¹æ³å¦ä¸ã\n\nvar g = gen();\nvar result = g.next();\n\nresult.value.then(function(data){\n  return data.json();\n}).then(function(data){\n  g.next(data);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼é¦åæ§è¡ generator å½æ°ï¼è·åéåå¨å¯¹è±¡ï¼ç¶åä½¿ç¨nextæ¹æ³ï¼ç¬¬äºè¡ï¼ï¼æ§è¡å¼æ­¥ä»»å¡çç¬¬ä¸é¶æ®µãç±äºfetchæ¨¡åè¿åçæ¯ä¸ä¸ª promise å¯¹è±¡ï¼å æ­¤è¦ç¨thenæ¹æ³è°ç¨ä¸ä¸ä¸ªnextæ¹æ³ã\n\nå¯ä»¥çå°ï¼è½ç¶ generator å½æ°å°å¼æ­¥æä½è¡¨ç¤ºå¾å¾ç®æ´ï¼ä½æ¯æµç¨ç®¡çå´ä¸æ¹ä¾¿ï¼å³ä½æ¶æ§è¡ç¬¬ä¸é¶æ®µãä½æ¶æ§è¡ç¬¬äºé¶æ®µï¼ã\n\n\n# thunk å½æ°\n\nthunk å½æ°æ¯èªå¨æ§è¡ generator å½æ°çä¸ç§æ¹æ³ã\n\n\n# åæ°çæ±å¼ç­ç¥\n\nthunk å½æ°æ©å¨ä¸ä¸ªä¸çºª 60 å¹´ä»£å°±è¯çäºã\n\né£æ¶ï¼ç¼ç¨è¯­è¨ååèµ·æ­¥ï¼è®¡ç®æºå­¦å®¶è¿å¨ç ç©¶ï¼ç¼è¯å¨æä¹åæ¯è¾å¥½ãä¸ä¸ªäºè®ºçç¦ç¹æ¯\"æ±å¼ç­ç¥\"ï¼å³å½æ°çåæ°å°åºåºè¯¥ä½æ¶æ±å¼ã\n\nvar x = 1;\n\nfunction f(m) {\n  return m * 2;\n}\n\nf(x + 5)\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç åå®ä¹å½æ°fï¼ç¶ååå®ä¼ å¥è¡¨è¾¾å¼x + 5ãè¯·é®ï¼è¿ä¸ªè¡¨è¾¾å¼åºè¯¥ä½æ¶æ±å¼ï¼\n\nä¸ç§æè§æ¯\"ä¼ å¼è°ç¨\"ï¼call by valueï¼ï¼å³å¨è¿å¥å½æ°ä½ä¹åï¼å°±è®¡ç®x + 5çå¼ï¼ç­äº 6ï¼ï¼åå°è¿ä¸ªå¼ä¼ å¥å½æ°fãc è¯­è¨å°±éç¨è¿ç§ç­ç¥ã\n\nf(x + 5)\n// ä¼ å¼è°ç¨æ¶ï¼ç­åäº\nf(6)\n\n\n1\n2\n3\n\n\nå¦ä¸ç§æè§æ¯âä¼ åè°ç¨âï¼call by nameï¼ï¼å³ç´æ¥å°è¡¨è¾¾å¼x + 5ä¼ å¥å½æ°ä½ï¼åªå¨ç¨å°å®çæ¶åæ±å¼ãhaskell è¯­è¨éç¨è¿ç§ç­ç¥ã\n\nf(x + 5)\n// ä¼ åè°ç¨æ¶ï¼ç­åäº\n(x + 5) * 2\n\n\n1\n2\n3\n\n\nä¼ å¼è°ç¨åä¼ åè°ç¨ï¼åªä¸ç§æ¯è¾å¥½ï¼\n\nåç­æ¯åæå©å¼ãä¼ å¼è°ç¨æ¯è¾ç®åï¼ä½æ¯å¯¹åæ°æ±å¼çæ¶åï¼å®éä¸è¿æ²¡ç¨å°è¿ä¸ªåæ°ï¼æå¯è½é ææ§è½æå¤±ã\n\nfunction f(a, b){\n  return b;\n}\n\nf(3 * x * x - 2 * x - 1, x);\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fçç¬¬ä¸ä¸ªåæ°æ¯ä¸ä¸ªå¤æçè¡¨è¾¾å¼ï¼ä½æ¯å½æ°ä½åæ ¹æ¬æ²¡ç¨å°ãå¯¹è¿ä¸ªåæ°æ±å¼ï¼å®éä¸æ¯ä¸å¿è¦çãå æ­¤ï¼æä¸äºè®¡ç®æºå­¦å®¶å¾åäº\"ä¼ åè°ç¨\"ï¼å³åªå¨æ§è¡æ¶æ±å¼ã\n\n\n# thunk å½æ°çå«ä¹\n\nç¼è¯å¨çâä¼ åè°ç¨âå®ç°ï¼å¾å¾æ¯å°åæ°æ¾å°ä¸ä¸ªä¸´æ¶å½æ°ä¹ä¸­ï¼åå°è¿ä¸ªä¸´æ¶å½æ°ä¼ å¥å½æ°ä½ãè¿ä¸ªä¸´æ¶å½æ°å°±å«å thunk å½æ°ã\n\nfunction f(m) {\n  return m * 2;\n}\n\nf(x + 5);\n\n// ç­åäº\n\nvar thunk = function () {\n  return x + 5;\n};\n\nfunction f(thunk) {\n  return thunk() * 2;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ° f çåæ°x + 5è¢«ä¸ä¸ªå½æ°æ¿æ¢äºãå¡æ¯ç¨å°ååæ°çå°æ¹ï¼å¯¹thunkå½æ°æ±å¼å³å¯ã\n\nè¿å°±æ¯ thunk å½æ°çå®ä¹ï¼å®æ¯âä¼ åè°ç¨âçä¸ç§å®ç°ç­ç¥ï¼ç¨æ¥æ¿æ¢æä¸ªè¡¨è¾¾å¼ã\n\n\n# javascript è¯­è¨ç thunk å½æ°\n\njavascript è¯­è¨æ¯ä¼ å¼è°ç¨ï¼å®ç thunk å½æ°å«ä¹ææä¸åãå¨ javascript è¯­è¨ä¸­ï¼thunk å½æ°æ¿æ¢çä¸æ¯è¡¨è¾¾å¼ï¼èæ¯å¤åæ°å½æ°ï¼å°å¶æ¿æ¢æä¸ä¸ªåªæ¥ååè°å½æ°ä½ä¸ºåæ°çååæ°å½æ°ã\n\n// æ­£å¸¸çæ¬çreadfileï¼å¤åæ°çæ¬ï¼\nfs.readfile(filename, callback);\n\n// thunkçæ¬çreadfileï¼ååæ°çæ¬ï¼\nvar thunk = function (filename) {\n  return function (callback) {\n    return fs.readfile(filename, callback);\n  };\n};\n\nvar readfilethunk = thunk(filename);\nreadfilethunk(callback);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼fsæ¨¡åçreadfileæ¹æ³æ¯ä¸ä¸ªå¤åæ°å½æ°ï¼ä¸¤ä¸ªåæ°åå«ä¸ºæä»¶åååè°å½æ°ãç»è¿è½¬æ¢å¨å¤çï¼å®åæäºä¸ä¸ªååæ°å½æ°ï¼åªæ¥ååè°å½æ°ä½ä¸ºåæ°ãè¿ä¸ªååæ°çæ¬ï¼å°±å«å thunk å½æ°ã\n\nä»»ä½å½æ°ï¼åªè¦åæ°æåè°å½æ°ï¼å°±è½åæ thunk å½æ°çå½¢å¼ãä¸é¢æ¯ä¸ä¸ªç®åç thunk å½æ°è½¬æ¢å¨ã\n\n// es5çæ¬\nvar thunk = function(fn){\n  return function (){\n    var args = array.prototype.slice.call(arguments);\n    return function (callback){\n      args.push(callback);\n      return fn.apply(this, args);\n    }\n  };\n};\n\n// es6çæ¬\nconst thunk = function(fn) {\n  return function (...args) {\n    return function (callback) {\n      return fn.call(this, ...args, callback);\n    }\n  };\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä½¿ç¨ä¸é¢çè½¬æ¢å¨ï¼çæfs.readfileç thunk å½æ°ã\n\nvar readfilethunk = thunk(fs.readfile);\nreadfilethunk(filea)(callback);\n\n\n1\n2\n\n\nä¸é¢æ¯å¦ä¸ä¸ªå®æ´çä¾å­ã\n\nfunction f(a, cb) {\n  cb(a);\n}\nconst ft = thunk(f);\n\nft(1)(console.log) // 1\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# thunkify æ¨¡å\n\nçäº§ç¯å¢çè½¬æ¢å¨ï¼å»ºè®®ä½¿ç¨ thunkify æ¨¡åã\n\né¦åæ¯å®è£ã\n\n$ npm install thunkify\n\n\n1\n\n\nä½¿ç¨æ¹å¼å¦ä¸ã\n\nvar thunkify = require('thunkify');\nvar fs = require('fs');\n\nvar read = thunkify(fs.readfile);\nread('package.json')(function(err, str){\n  // ...\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nthunkify çæºç ä¸ä¸ä¸èé£ä¸ªç®åçè½¬æ¢å¨éå¸¸åã\n\nfunction thunkify(fn) {\n  return function() {\n    var args = new array(arguments.length);\n    var ctx = this;\n\n    for (var i = 0; i < args.length; ++i) {\n      args[i] = arguments[i];\n    }\n\n    return function (done) {\n      var called;\n\n      args.push(function () {\n        if (called) return;\n        called = true;\n        done.apply(null, arguments);\n      });\n\n      try {\n        fn.apply(ctx, args);\n      } catch (err) {\n        done(err);\n      }\n    }\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nå®çæºç ä¸»è¦å¤äºä¸ä¸ªæ£æ¥æºå¶ï¼åécalledç¡®ä¿åè°å½æ°åªè¿è¡ä¸æ¬¡ãè¿æ ·çè®¾è®¡ä¸ä¸æç generator å½æ°ç¸å³ãè¯·çä¸é¢çä¾å­ã\n\nfunction f(a, b, callback){\n  var sum = a + b;\n  callback(sum);\n  callback(sum);\n}\n\nvar ft = thunkify(f);\nvar print = console.log.bind(console);\nft(1, 2)(print);\n// 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºthunkifyåªåè®¸åè°å½æ°æ§è¡ä¸æ¬¡ï¼æä»¥åªè¾åºä¸è¡ç»æã\n\n\n# generator å½æ°çæµç¨ç®¡ç\n\nä½ å¯è½ä¼é®ï¼ thunk å½æ°æä»ä¹ç¨ï¼åç­æ¯ä»¥åç¡®å®æ²¡ä»ä¹ç¨ï¼ä½æ¯ es6 æäº generator å½æ°ï¼thunk å½æ°ç°å¨å¯ä»¥ç¨äº generator å½æ°çèªå¨æµç¨ç®¡çã\n\ngenerator å½æ°å¯ä»¥èªå¨æ§è¡ã\n\nfunction* gen() {\n  // ...\n}\n\nvar g = gen();\nvar res = g.next();\n\nwhile(!res.done){\n  console.log(res.value);\n  res = g.next();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼generator å½æ°genä¼èªå¨æ§è¡å®æææ­¥éª¤ã\n\nä½æ¯ï¼è¿ä¸éåå¼æ­¥æä½ãå¦æå¿é¡»ä¿è¯åä¸æ­¥æ§è¡å®ï¼æè½æ§è¡åä¸æ­¥ï¼ä¸é¢çèªå¨æ§è¡å°±ä¸å¯è¡ãè¿æ¶ï¼thunk å½æ°å°±è½æ´¾ä¸ç¨å¤ãä»¥è¯»åæä»¶ä¸ºä¾ãä¸é¢ç generator å½æ°å°è£äºä¸¤ä¸ªå¼æ­¥æä½ã\n\nvar fs = require('fs');\nvar thunkify = require('thunkify');\nvar readfilethunk = thunkify(fs.readfile);\n\nvar gen = function* (){\n  var r1 = yield readfilethunk('/etc/fstab');\n  console.log(r1.tostring());\n  var r2 = yield readfilethunk('/etc/shells');\n  console.log(r2.tostring());\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼yieldå½ä»¤ç¨äºå°ç¨åºçæ§è¡æç§»åº generator å½æ°ï¼é£ä¹å°±éè¦ä¸ç§æ¹æ³ï¼å°æ§è¡æåäº¤è¿ç» generator å½æ°ã\n\nè¿ç§æ¹æ³å°±æ¯ thunk å½æ°ï¼å ä¸ºå®å¯ä»¥å¨åè°å½æ°éï¼å°æ§è¡æäº¤è¿ç» generator å½æ°ãä¸ºäºä¾¿äºçè§£ï¼æä»¬åçå¦ä½æå¨æ§è¡ä¸é¢è¿ä¸ª generator å½æ°ã\n\nvar g = gen();\n\nvar r1 = g.next();\nr1.value(function (err, data) {\n  if (err) throw err;\n  var r2 = g.next(data);\n  r2.value(function (err, data) {\n    if (err) throw err;\n    g.next(data);\n  });\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼åégæ¯ generator å½æ°çåé¨æéï¼è¡¨ç¤ºç®åæ§è¡å°åªä¸æ­¥ãnextæ¹æ³è´è´£å°æéç§»å¨å°ä¸ä¸æ­¥ï¼å¹¶è¿åè¯¥æ­¥çä¿¡æ¯ï¼valueå±æ§ådoneå±æ§ï¼ã\n\nä»ç»æ¥çä¸é¢çä»£ç ï¼å¯ä»¥åç° generator å½æ°çæ§è¡è¿ç¨ï¼å¶å®æ¯å°åä¸ä¸ªåè°å½æ°ï¼åå¤ä¼ å¥nextæ¹æ³çvalueå±æ§ãè¿ä½¿å¾æä»¬å¯ä»¥ç¨éå½æ¥èªå¨å®æè¿ä¸ªè¿ç¨ã\n\n\n# thunk å½æ°çèªå¨æµç¨ç®¡ç\n\nthunk å½æ°çæ­£çå¨åï¼å¨äºå¯ä»¥èªå¨æ§è¡ generator å½æ°ãä¸é¢å°±æ¯ä¸ä¸ªåºäº thunk å½æ°ç generator æ§è¡å¨ã\n\nfunction run(fn) {\n  var gen = fn();\n\n  function next(err, data) {\n    var result = gen.next(data);\n    if (result.done) return;\n    result.value(next);\n  }\n\n  next();\n}\n\nfunction* g() {\n  // ...\n}\n\nrun(g);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç çrunå½æ°ï¼å°±æ¯ä¸ä¸ª generator å½æ°çèªå¨æ§è¡å¨ãåé¨çnextå½æ°å°±æ¯ thunk çåè°å½æ°ãnextå½æ°åå°æéç§»å° generator å½æ°çä¸ä¸æ­¥ï¼gen.nextæ¹æ³ï¼ï¼ç¶åå¤æ­ generator å½æ°æ¯å¦ç»æï¼result.doneå±æ§ï¼ï¼å¦ææ²¡ç»æï¼å°±å°nextå½æ°åä¼ å¥ thunk å½æ°ï¼result.valueå±æ§ï¼ï¼å¦åå°±ç´æ¥éåºã\n\næäºè¿ä¸ªæ§è¡å¨ï¼æ§è¡ generator å½æ°æ¹ä¾¿å¤äºãä¸ç®¡åé¨æå¤å°ä¸ªå¼æ­¥æä½ï¼ç´æ¥æ generator å½æ°ä¼ å¥runå½æ°å³å¯ãå½ç¶ï¼åææ¯æ¯ä¸ä¸ªå¼æ­¥æä½ï¼é½è¦æ¯ thunk å½æ°ï¼ä¹å°±æ¯è¯´ï¼è·å¨yieldå½ä»¤åé¢çå¿é¡»æ¯ thunk å½æ°ã\n\nvar g = function* (){\n  var f1 = yield readfilethunk('filea');\n  var f2 = yield readfilethunk('fileb');\n  // ...\n  var fn = yield readfilethunk('filen');\n};\n\nrun(g);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°gå°è£äºnä¸ªå¼æ­¥çè¯»åæä»¶æä½ï¼åªè¦æ§è¡runå½æ°ï¼è¿äºæä½å°±ä¼èªå¨å®æãè¿æ ·ä¸æ¥ï¼å¼æ­¥æä½ä¸ä»å¯ä»¥åå¾ååæ­¥æä½ï¼èä¸ä¸è¡ä»£ç å°±å¯ä»¥æ§è¡ã\n\nthunk å½æ°å¹¶ä¸æ¯ generator å½æ°èªå¨æ§è¡çå¯ä¸æ¹æ¡ãå ä¸ºèªå¨æ§è¡çå³é®æ¯ï¼å¿é¡»æä¸ç§æºå¶ï¼èªå¨æ§å¶ generator å½æ°çæµç¨ï¼æ¥æ¶åäº¤è¿ç¨åºçæ§è¡æãåè°å½æ°å¯ä»¥åå°è¿ä¸ç¹ï¼promise å¯¹è±¡ä¹å¯ä»¥åå°è¿ä¸ç¹ã\n\n\n# co æ¨¡å\n\n\n# åºæ¬ç¨æ³\n\nco æ¨¡åæ¯èåç¨åºå tj holowaychuk äº 2013 å¹´ 6 æåå¸çä¸ä¸ªå°å·¥å·ï¼ç¨äº generator å½æ°çèªå¨æ§è¡ã\n\nä¸é¢æ¯ä¸ä¸ª generator å½æ°ï¼ç¨äºä¾æ¬¡è¯»åä¸¤ä¸ªæä»¶ã\n\nvar gen = function* () {\n  var f1 = yield readfile('/etc/fstab');\n  var f2 = yield readfile('/etc/shells');\n  console.log(f1.tostring());\n  console.log(f2.tostring());\n};\n\n\n1\n2\n3\n4\n5\n6\n\n\nco æ¨¡åå¯ä»¥è®©ä½ ä¸ç¨ç¼å generator å½æ°çæ§è¡å¨ã\n\nvar co = require('co');\nco(gen);\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼generator å½æ°åªè¦ä¼ å¥coå½æ°ï¼å°±ä¼èªå¨æ§è¡ã\n\ncoå½æ°è¿åä¸ä¸ªpromiseå¯¹è±¡ï¼å æ­¤å¯ä»¥ç¨thenæ¹æ³æ·»å åè°å½æ°ã\n\nco(gen).then(function (){\n  console.log('generator å½æ°æ§è¡å®æ');\n});\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼ç­å° generator å½æ°æ§è¡ç»æï¼å°±ä¼è¾åºä¸è¡æç¤ºã\n\n\n# co æ¨¡åçåç\n\nä¸ºä»ä¹ co å¯ä»¥èªå¨æ§è¡ generator å½æ°ï¼\n\nåé¢è¯´è¿ï¼generator å°±æ¯ä¸ä¸ªå¼æ­¥æä½çå®¹å¨ãå®çèªå¨æ§è¡éè¦ä¸ç§æºå¶ï¼å½å¼æ­¥æä½æäºç»æï¼è½å¤èªå¨äº¤åæ§è¡æã\n\nä¸¤ç§æ¹æ³å¯ä»¥åå°è¿ä¸ç¹ã\n\nï¼1ï¼åè°å½æ°ãå°å¼æ­¥æä½åè£æ thunk å½æ°ï¼å¨åè°å½æ°éé¢äº¤åæ§è¡æã\n\nï¼2ï¼promise å¯¹è±¡ãå°å¼æ­¥æä½åè£æ promise å¯¹è±¡ï¼ç¨thenæ¹æ³äº¤åæ§è¡æã\n\nco æ¨¡åå¶å®å°±æ¯å°ä¸¤ç§èªå¨æ§è¡å¨ï¼thunk å½æ°å promise å¯¹è±¡ï¼ï¼åè£æä¸ä¸ªæ¨¡åãä½¿ç¨ co çåææ¡ä»¶æ¯ï¼generator å½æ°çyieldå½ä»¤åé¢ï¼åªè½æ¯ thunk å½æ°æ promise å¯¹è±¡ãå¦ææ°ç»æå¯¹è±¡çæåï¼å¨é¨é½æ¯ promise å¯¹è±¡ï¼ä¹å¯ä»¥ä½¿ç¨ coï¼è¯¦è§åæçä¾å­ã\n\nä¸ä¸èå·²ç»ä»ç»äºåºäº thunk å½æ°çèªå¨æ§è¡å¨ãä¸é¢æ¥çï¼åºäº promise å¯¹è±¡çèªå¨æ§è¡å¨ãè¿æ¯çè§£ co æ¨¡åå¿é¡»çã\n\n\n# åºäº promise å¯¹è±¡çèªå¨æ§è¡\n\nè¿æ¯æ²¿ç¨ä¸é¢çä¾å­ãé¦åï¼æfsæ¨¡åçreadfileæ¹æ³åè£æä¸ä¸ª promise å¯¹è±¡ã\n\nvar fs = require('fs');\n\nvar readfile = function (filename){\n  return new promise(function (resolve, reject){\n    fs.readfile(filename, function(error, data){\n      if (error) return reject(error);\n      resolve(data);\n    });\n  });\n};\n\nvar gen = function* (){\n  var f1 = yield readfile('/etc/fstab');\n  var f2 = yield readfile('/etc/shells');\n  console.log(f1.tostring());\n  console.log(f2.tostring());\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nç¶åï¼æå¨æ§è¡ä¸é¢ç generator å½æ°ã\n\nvar g = gen();\n\ng.next().value.then(function(data){\n  g.next(data).value.then(function(data){\n    g.next(data);\n  });\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næå¨æ§è¡å¶å®å°±æ¯ç¨thenæ¹æ³ï¼å±å±æ·»å åè°å½æ°ãçè§£äºè¿ä¸ç¹ï¼å°±å¯ä»¥ååºä¸ä¸ªèªå¨æ§è¡å¨ã\n\nfunction run(gen){\n  var g = gen();\n\n  function next(data){\n    var result = g.next(data);\n    if (result.done) return result.value;\n    result.value.then(function(data){\n      next(data);\n    });\n  }\n\n  next();\n}\n\nrun(gen);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼åªè¦ generator å½æ°è¿æ²¡æ§è¡å°æåä¸æ­¥ï¼nextå½æ°å°±è°ç¨èªèº«ï¼ä»¥æ­¤å®ç°èªå¨æ§è¡ã\n\n\n# co æ¨¡åçæºç \n\nco å°±æ¯ä¸é¢é£ä¸ªèªå¨æ§è¡å¨çæ©å±ï¼å®çæºç åªæå åè¡ï¼éå¸¸ç®åã\n\né¦åï¼co å½æ°æ¥å generator å½æ°ä½ä¸ºåæ°ï¼è¿åä¸ä¸ª promise å¯¹è±¡ã\n\nfunction co(gen) {\n  var ctx = this;\n\n  return new promise(function(resolve, reject) {\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¨è¿åç promise å¯¹è±¡éé¢ï¼co åæ£æ¥åæ°genæ¯å¦ä¸º generator å½æ°ãå¦ææ¯ï¼å°±æ§è¡è¯¥å½æ°ï¼å¾å°ä¸ä¸ªåé¨æéå¯¹è±¡ï¼å¦æä¸æ¯å°±è¿åï¼å¹¶å° promise å¯¹è±¡çç¶ææ¹ä¸ºresolvedã\n\nfunction co(gen) {\n  var ctx = this;\n\n  return new promise(function(resolve, reject) {\n    if (typeof gen === 'function') gen = gen.call(ctx);\n    if (!gen || typeof gen.next !== 'function') return resolve(gen);\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næ¥çï¼co å° generator å½æ°çåé¨æéå¯¹è±¡çnextæ¹æ³ï¼åè£æonfulfilledå½æ°ãè¿ä¸»è¦æ¯ä¸ºäºè½å¤æææåºçéè¯¯ã\n\nfunction co(gen) {\n  var ctx = this;\n\n  return new promise(function(resolve, reject) {\n    if (typeof gen === 'function') gen = gen.call(ctx);\n    if (!gen || typeof gen.next !== 'function') return resolve(gen);\n\n    onfulfilled();\n    function onfulfilled(res) {\n      var ret;\n      try {\n        ret = gen.next(res);\n      } catch (e) {\n        return reject(e);\n      }\n      next(ret);\n    }\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\næåï¼å°±æ¯å³é®çnextå½æ°ï¼å®ä¼åå¤è°ç¨èªèº«ã\n\nfunction next(ret) {\n  if (ret.done) return resolve(ret.value);\n  var value = topromise.call(ctx, ret.value);\n  if (value && ispromise(value)) return value.then(onfulfilled, onrejected);\n  return onrejected(\n    new typeerror(\n      'you may only yield a function, promise, generator, array, or object, '\n      + 'but the following object was passed: \"'\n      + string(ret.value)\n      + '\"'\n    )\n  );\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼nextå½æ°çåé¨ä»£ç ï¼ä¸å±åªæåè¡å½ä»¤ã\n\nç¬¬ä¸è¡ï¼æ£æ¥å½åæ¯å¦ä¸º generator å½æ°çæåä¸æ­¥ï¼å¦ææ¯å°±è¿åã\n\nç¬¬äºè¡ï¼ç¡®ä¿æ¯ä¸æ­¥çè¿åå¼ï¼æ¯ promise å¯¹è±¡ã\n\nç¬¬ä¸è¡ï¼ä½¿ç¨thenæ¹æ³ï¼ä¸ºè¿åå¼å ä¸åè°å½æ°ï¼ç¶åéè¿onfulfilledå½æ°åæ¬¡è°ç¨nextå½æ°ã\n\nç¬¬åè¡ï¼å¨åæ°ä¸ç¬¦åè¦æ±çæåµä¸ï¼åæ°é thunk å½æ°å promise å¯¹è±¡ï¼ï¼å° promise å¯¹è±¡çç¶ææ¹ä¸ºrejectedï¼ä»èç»æ­¢æ§è¡ã\n\n\n# å¤çå¹¶åçå¼æ­¥æä½\n\nco æ¯æå¹¶åçå¼æ­¥æä½ï¼å³åè®¸æäºæä½åæ¶è¿è¡ï¼ç­å°å®ä»¬å¨é¨å®æï¼æè¿è¡ä¸ä¸æ­¥ã\n\nè¿æ¶ï¼è¦æå¹¶åçæä½é½æ¾å¨æ°ç»æå¯¹è±¡éé¢ï¼è·å¨yieldè¯­å¥åé¢ã\n\n// æ°ç»çåæ³\nco(function* () {\n  var res = yield [\n    promise.resolve(1),\n    promise.resolve(2)\n  ];\n  console.log(res);\n}).catch(onerror);\n\n// å¯¹è±¡çåæ³\nco(function* () {\n  var res = yield {\n    1: promise.resolve(1),\n    2: promise.resolve(2),\n  };\n  console.log(res);\n}).catch(onerror);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nco(function* () {\n  var values = [n1, n2, n3];\n  yield values.map(somethingasync);\n});\n\nfunction* somethingasync(x) {\n  // do something async\n  return y\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢çä»£ç åè®¸å¹¶åä¸ä¸ªsomethingasyncå¼æ­¥æä½ï¼ç­å°å®ä»¬å¨é¨å®æï¼æä¼è¿è¡ä¸ä¸æ­¥ã\n\n\n# å®ä¾ï¼å¤ç stream\n\nnode æä¾ stream æ¨¡å¼è¯»åæ°æ®ï¼ç¹ç¹æ¯ä¸æ¬¡åªå¤çæ°æ®çä¸é¨åï¼æ°æ®åæä¸ååä¾æ¬¡å¤çï¼å°±å¥½åâæ°æ®æµâä¸æ ·ãè¿å¯¹äºå¤çå¤§è§æ¨¡æ°æ®éå¸¸æå©ãstream æ¨¡å¼ä½¿ç¨ eventemitter apiï¼ä¼éæ¾ä¸ä¸ªäºä»¶ã\n\n * dataäºä»¶ï¼ä¸ä¸åæ°æ®åå·²ç»åå¤å¥½äºã\n * endäºä»¶ï¼æ´ä¸ªâæ°æ®æµâå¤çå®äºã\n * erroräºä»¶ï¼åçéè¯¯ã\n\nä½¿ç¨promise.race()å½æ°ï¼å¯ä»¥å¤æ­è¿ä¸ä¸ªäºä»¶ä¹ä¸­åªä¸ä¸ªæååçï¼åªæå½dataäºä»¶æååçæ¶ï¼æè¿å¥ä¸ä¸ä¸ªæ°æ®åçå¤çãä»èï¼æä»¬å¯ä»¥éè¿ä¸ä¸ªwhileå¾ªç¯ï¼å®ææææ°æ®çè¯»åã\n\nconst co = require('co');\nconst fs = require('fs');\n\nconst stream = fs.createreadstream('./les_miserables.txt');\nlet valjeancount = 0;\n\nco(function*() {\n  while(true) {\n    const res = yield promise.race([\n      new promise(resolve => stream.once('data', resolve)),\n      new promise(resolve => stream.once('end', resolve)),\n      new promise((resolve, reject) => stream.once('error', reject))\n    ]);\n    if (!res) {\n      break;\n    }\n    stream.removealllisteners('data');\n    stream.removealllisteners('end');\n    stream.removealllisteners('error');\n    valjeancount += (res.tostring().match(/valjean/ig) || []).length;\n  }\n  console.log('count:', valjeancount); // count: 1120\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nä¸é¢ä»£ç éç¨ stream æ¨¡å¼è¯»åãæ²æ¨ä¸çãçææ¬æä»¶ï¼å¯¹äºæ¯ä¸ªæ°æ®åé½ä½¿ç¨stream.onceæ¹æ³ï¼å¨dataãendãerrorä¸ä¸ªäºä»¶ä¸æ·»å ä¸æ¬¡æ§åè°å½æ°ãåéresåªæå¨dataäºä»¶åçæ¶ææå¼ï¼ç¶åç´¯å æ¯ä¸ªæ°æ®åä¹ä¸­valjeanè¿ä¸ªè¯åºç°çæ¬¡æ°ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Reflect",frontmatter:{title:"Reflect",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/74de3e45e4491e95",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/15.Reflect.html",relativePath:"ãES6 æç¨ãç¬è®°/15.Reflect.md",key:"v-f6e3cecc",path:"/pages/74de3e45e4491e95/",headers:[{level:2,title:"æ¦è¿°",slug:"æ¦è¿°",normalizedTitle:"æ¦è¿°",charIndex:14},{level:2,title:"éææ¹æ³",slug:"éææ¹æ³",normalizedTitle:"éææ¹æ³",charIndex:2044},{level:3,title:"Reflect.get(target, name, receiver)",slug:"reflect-get-target-name-receiver",normalizedTitle:"reflect.get(target, name, receiver)",charIndex:2152},{level:3,title:"Reflect.set(target, name, value, receiver)",slug:"reflect-set-target-name-value-receiver",normalizedTitle:"reflect.set(target, name, value, receiver)",charIndex:1097},{level:3,title:"Reflect.has(obj, name)",slug:"reflect-has-obj-name",normalizedTitle:"reflect.has(obj, name)",charIndex:695},{level:3,title:"Reflect.deleteProperty(obj, name)",slug:"reflect-deleteproperty-obj-name",normalizedTitle:"reflect.deleteproperty(obj, name)",charIndex:718},{level:3,title:"Reflect.construct(target, args)",slug:"reflect-construct-target-args",normalizedTitle:"reflect.construct(target, args)",charIndex:2117},{level:3,title:"Reflect.getPrototypeOf(obj)",slug:"reflect-getprototypeof-obj",normalizedTitle:"reflect.getprototypeof(obj)",charIndex:6109},{level:3,title:"Reflect.setPrototypeOf(obj, newProto)",slug:"reflect-setprototypeof-obj-newproto",normalizedTitle:"reflect.setprototypeof(obj, newproto)",charIndex:6618},{level:3,title:"Reflect.apply(func, thisArg, args)",slug:"reflect-apply-func-thisarg-args",normalizedTitle:"reflect.apply(func, thisarg, args)",charIndex:7595},{level:3,title:"Reflect.defineProperty(target, propertyKey, attributes)",slug:"reflect-defineproperty-target-propertykey-attributes",normalizedTitle:"reflect.defineproperty(target, propertykey, attributes)",charIndex:8263},{level:3,title:"Reflect.getOwnPropertyDescriptor(target, propertyKey)",slug:"reflect-getownpropertydescriptor-target-propertykey",normalizedTitle:"reflect.getownpropertydescriptor(target, propertykey)",charIndex:9137},{level:3,title:"Reflect.isExtensible (target)",slug:"reflect-isextensible-target",normalizedTitle:"reflect.isextensible (target)",charIndex:9781},{level:3,title:"Reflect.preventExtensions(target)",slug:"reflect-preventextensions-target",normalizedTitle:"reflect.preventextensions(target)",charIndex:2411},{level:3,title:"Reflect.ownKeys (target)",slug:"reflect-ownkeys-target",normalizedTitle:"reflect.ownkeys (target)",charIndex:10676},{level:2,title:"å®ä¾ï¼ä½¿ç¨ Proxy å®ç°è§å¯èæ¨¡å¼",slug:"å®ä¾-ä½¿ç¨-proxy-å®ç°è§å¯èæ¨¡å¼",normalizedTitle:"å®ä¾ï¼ä½¿ç¨ proxy å®ç°è§å¯èæ¨¡å¼",charIndex:11188}],excerpt:'<h1 id="reflect"><a class="header-anchor" href="#reflect">#</a> Reflect</h1>\n<h2 id="æ¦è¿°"><a class="header-anchor" href="#æ¦è¿°">#</a> æ¦è¿°</h2>\n<p><code>Reflect</code>å¯¹è±¡ä¸<code>Proxy</code>å¯¹è±¡ä¸æ ·ï¼ä¹æ¯ ES6 ä¸ºäºæä½å¯¹è±¡èæä¾çæ° APIã<code>Reflect</code>å¯¹è±¡çè®¾è®¡ç®çæè¿æ ·å ä¸ªã</p>\n<p>ï¼1ï¼ **å°<code>Object</code>å¯¹è±¡çä¸äºææ¾å±äºè¯­è¨åé¨çæ¹æ³ï¼æ¯å¦<code>Object.defineProperty</code>ï¼ï¼æ¾å°<code>Reflect</code>å¯¹è±¡ä¸ã**ç°é¶æ®µï¼æäºæ¹æ³åæ¶å¨<code>Object</code>å<code>Reflect</code>å¯¹è±¡ä¸é¨ç½²ï¼æªæ¥çæ°æ¹æ³å°åªé¨ç½²å¨<code>Reflect</code>å¯¹è±¡ä¸ãä¹å°±æ¯è¯´ï¼ä»<code>Reflect</code>å¯¹è±¡ä¸å¯ä»¥æ¿å°è¯­è¨åé¨çæ¹æ³ã</p>\n',headersStr:"æ¦è¿° éææ¹æ³ Reflect.get(target, name, receiver) Reflect.set(target, name, value, receiver) Reflect.has(obj, name) Reflect.deleteProperty(obj, name) Reflect.construct(target, args) Reflect.getPrototypeOf(obj) Reflect.setPrototypeOf(obj, newProto) Reflect.apply(func, thisArg, args) Reflect.defineProperty(target, propertyKey, attributes) Reflect.getOwnPropertyDescriptor(target, propertyKey) Reflect.isExtensible (target) Reflect.preventExtensions(target) Reflect.ownKeys (target) å®ä¾ï¼ä½¿ç¨ Proxy å®ç°è§å¯èæ¨¡å¼",content:"# Reflect\n\n\n# æ¦è¿°\n\nReflectå¯¹è±¡ä¸Proxyå¯¹è±¡ä¸æ ·ï¼ä¹æ¯ ES6 ä¸ºäºæä½å¯¹è±¡èæä¾çæ° APIãReflectå¯¹è±¡çè®¾è®¡ç®çæè¿æ ·å ä¸ªã\n\nï¼1ï¼ **å°Objectå¯¹è±¡çä¸äºææ¾å±äºè¯­è¨åé¨çæ¹æ³ï¼æ¯å¦Object.definePropertyï¼ï¼æ¾å°Reflectå¯¹è±¡ä¸ã**ç°é¶æ®µï¼æäºæ¹æ³åæ¶å¨ObjectåReflectå¯¹è±¡ä¸é¨ç½²ï¼æªæ¥çæ°æ¹æ³å°åªé¨ç½²å¨Reflectå¯¹è±¡ä¸ãä¹å°±æ¯è¯´ï¼ä»Reflectå¯¹è±¡ä¸å¯ä»¥æ¿å°è¯­è¨åé¨çæ¹æ³ã ï¼2ï¼ ä¿®æ¹æäºObjectæ¹æ³çè¿åç»æï¼è®©å¶åå¾æ´åçãæ¯å¦ï¼Object.defineProperty(obj, name, desc)å¨æ æ³å®ä¹å±æ§æ¶ï¼ä¼æåºä¸ä¸ªéè¯¯ï¼èReflect.defineProperty(obj, name, desc)åä¼è¿åfalseã\n\n// èåæ³\ntry {\n  Object.defineProperty(target, property, attributes);\n  // success\n} catch (e) {\n  // failure\n}\n\n// æ°åæ³\nif (Reflect.defineProperty(target, property, attributes)) {\n  // success\n} else {\n  // failure\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nï¼3ï¼ è®©Objectæä½é½åæå½æ°è¡ä¸ºãæäºObjectæä½æ¯å½ä»¤å¼ï¼æ¯å¦name in objådelete obj[name]ï¼èReflect.has(obj, name)åReflect.deleteProperty(obj, name)è®©å®ä»¬åæäºå½æ°è¡ä¸ºã\n\n// èåæ³\n'assign' in Object // true\n\n// æ°åæ³\nReflect.has(Object, 'assign') // true\n\n\n1\n2\n3\n4\n5\n\n\nï¼4ï¼Reflectå¯¹è±¡çæ¹æ³ä¸Proxyå¯¹è±¡çæ¹æ³ä¸ä¸å¯¹åºï¼åªè¦æ¯Proxyå¯¹è±¡çæ¹æ³ï¼å°±è½å¨Reflectå¯¹è±¡ä¸æ¾å°å¯¹åºçæ¹æ³ãè¿å°±è®©Proxyå¯¹è±¡å¯ä»¥æ¹ä¾¿å°è°ç¨å¯¹åºçReflectæ¹æ³ï¼å®æé»è®¤è¡ä¸ºï¼ä½ä¸ºä¿®æ¹è¡ä¸ºçåºç¡ãä¹å°±æ¯è¯´ï¼ä¸ç®¡Proxyæä¹ä¿®æ¹é»è®¤è¡ä¸ºï¼ä½ æ»å¯ä»¥å¨Reflectä¸è·åé»è®¤è¡ä¸ºã\n\nProxy(target, {\n  set: function(target, name, value, receiver) {\n    var success = Reflect.set(target, name, value, receiver);\n    if (success) {\n      console.log('property ' + name + ' on ' + target + ' set to ' + value);\n    }\n    return success;\n  }\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼Proxyæ¹æ³æ¦æªtargetå¯¹è±¡çå±æ§èµå¼è¡ä¸ºãå®éç¨Reflect.setæ¹æ³å°å¼èµå¼ç»å¯¹è±¡çå±æ§ï¼ç¡®ä¿å®æåæçè¡ä¸ºï¼ç¶ååé¨ç½²é¢å¤çåè½ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nvar loggedObj = new Proxy(obj, {\n  get(target, name) {\n    console.log('get', target, name);\n    return Reflect.get(target, name);\n  },\n  deleteProperty(target, name) {\n    console.log('delete' + name);\n    return Reflect.deleteProperty(target, name);\n  },\n  has(target, name) {\n    console.log('has' + name);\n    return Reflect.has(target, name);\n  }\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¯ä¸ä¸ªProxyå¯¹è±¡çæ¦æªæä½ï¼getãdeleteãhasï¼ï¼åé¨é½è°ç¨å¯¹åºçReflectæ¹æ³ï¼ä¿è¯åçè¡ä¸ºè½å¤æ­£å¸¸æ§è¡ãæ·»å çå·¥ä½ï¼å°±æ¯å°æ¯ä¸ä¸ªæä½è¾åºä¸è¡æ¥å¿ã\n\næäºReflectå¯¹è±¡ä»¥åï¼å¾å¤æä½ä¼æ´æè¯»ã\n\n// èåæ³\nFunction.prototype.apply.call(Math.floor, undefined, [1.75]) // 1\n\n// æ°åæ³\nReflect.apply(Math.floor, undefined, [1.75]) // 1\n\n\n1\n2\n3\n4\n5\n\n\n\n# éææ¹æ³\n\nReflectå¯¹è±¡ä¸å±æ 13 ä¸ªéææ¹æ³ã\n\n * Reflect.apply(target, thisArg, args)\n * Reflect.construct(target, args)\n * Reflect.get(target, name, receiver)\n * Reflect.set(target, name, value, receiver)\n * Reflect.defineProperty(target, name, desc)\n * Reflect.deleteProperty(target, name)\n * Reflect.has(target, name)\n * Reflect.ownKeys(target)\n * Reflect.isExtensible(target)\n * Reflect.preventExtensions(target)\n * Reflect.getOwnPropertyDescriptor(target, name)\n * Reflect.getPrototypeOf(target)\n * Reflect.setPrototypeOf(target, prototype)\n\nä¸é¢è¿äºæ¹æ³çä½ç¨ï¼å¤§é¨åä¸Objectå¯¹è±¡çååæ¹æ³çä½ç¨é½æ¯ç¸åçï¼èä¸å®ä¸Proxyå¯¹è±¡çæ¹æ³æ¯ä¸ä¸å¯¹åºçãä¸é¢æ¯å¯¹å®ä»¬çè§£éã\n\n\n# Reflect.get(target, name, receiver)\n\nReflect.getæ¹æ³æ¥æ¾å¹¶è¿åtargetå¯¹è±¡çnameå±æ§ï¼å¦ææ²¡æè¯¥å±æ§ï¼åè¿åundefinedã\n\nvar myObject = {\n  foo: 1,\n  bar: 2,\n  get baz() {\n    return this.foo + this.bar;\n  },\n}\n\nReflect.get(myObject, 'foo') // 1\nReflect.get(myObject, 'bar') // 2\nReflect.get(myObject, 'baz') // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¦ænameå±æ§é¨ç½²äºè¯»åå½æ°ï¼getterï¼ï¼åè¯»åå½æ°çthisç»å®receiverã\n\nvar myObject = {\n  foo: 1,\n  bar: 2,\n  get baz() {\n    return this.foo + this.bar;\n  },\n};\n\nvar myReceiverObject = {\n  foo: 4,\n  bar: 4,\n};\n\nReflect.get(myObject, 'baz', myReceiverObject) // 8\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nå¦æç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼Reflect.getæ¹æ³ä¼æ¥éã\n\nReflect.get(1, 'foo') // æ¥é\nReflect.get(false, 'foo') // æ¥é\n\n\n1\n2\n\n\n\n# Reflect.set(target, name, value, receiver)\n\nReflect.setæ¹æ³è®¾ç½®targetå¯¹è±¡çnameå±æ§ç­äºvalueã\n\nvar myObject = {\n  foo: 1,\n  set bar(value) {\n    return this.foo = value;\n  },\n}\n\nmyObject.foo // 1\n\nReflect.set(myObject, 'foo', 2);\nmyObject.foo // 2\n\nReflect.set(myObject, 'bar', 3)\nmyObject.foo // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nå¦ænameå±æ§è®¾ç½®äºèµå¼å½æ°ï¼åèµå¼å½æ°çthisç»å®receiverã\n\nvar myObject = {\n  foo: 4,\n  set bar(value) {\n    return this.foo = value;\n  },\n};\n\nvar myReceiverObject = {\n  foo: 0,\n};\n\nReflect.set(myObject, 'bar', 1, myReceiverObject);\nmyObject.foo // 4\nmyReceiverObject.foo // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\næ³¨æï¼å¦æ Proxyå¯¹è±¡å Reflectå¯¹è±¡èåä½¿ç¨ï¼åèæ¦æªèµå¼æä½ï¼åèå®æèµå¼çé»è®¤è¡ä¸ºï¼èä¸ä¼ å¥äºreceiverï¼é£ä¹Reflect.setä¼è§¦åProxy.definePropertyæ¦æªã\n\nlet p = {\n  a: 'a'\n};\n\nlet handler = {\n  set(target, key, value, receiver) {\n    console.log('set');\n    Reflect.set(target, key, value, receiver)\n  },\n  defineProperty(target, key, attribute) {\n    console.log('defineProperty');\n    Reflect.defineProperty(target, key, attribute);\n  }\n};\n\nlet obj = new Proxy(p, handler);\nobj.a = 'A';\n// set\n// defineProperty\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ä¸­ï¼Proxy.setæ¦æªéé¢ä½¿ç¨äºReflect.setï¼èä¸ä¼ å¥äºreceiverï¼å¯¼è´è§¦åProxy.definePropertyæ¦æªãè¿æ¯å ä¸ºProxy.setçreceiveråæ°æ»æ¯æåå½åç Proxyå®ä¾ï¼å³ä¸ä¾çobjï¼ï¼èReflect.setä¸æ¦ä¼ å¥receiverï¼å°±ä¼å°å±æ§èµå¼å°receiverä¸é¢ï¼å³objï¼ï¼å¯¼è´è§¦ådefinePropertyæ¦æªãå¦æReflect.setæ²¡æä¼ å¥receiverï¼é£ä¹å°±ä¸ä¼è§¦ådefinePropertyæ¦æªã\n\nlet p = {\n  a: 'a'\n};\n\nlet handler = {\n  set(target, key, value, receiver) {\n    console.log('set');\n    Reflect.set(target, key, value)\n  },\n  defineProperty(target, key, attribute) {\n    console.log('defineProperty');\n    Reflect.defineProperty(target, key, attribute);\n  }\n};\n\nlet obj = new Proxy(p, handler);\nobj.a = 'A';\n// set\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nå¦æç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼Reflect.setä¼æ¥éã\n\nReflect.set(1, 'foo', {}) // æ¥é\nReflect.set(false, 'foo', {}) // æ¥é\n\n\n1\n2\n\n\n\n# Reflect.has(obj, name)\n\nReflect.hasæ¹æ³å¯¹åºname in objéé¢çinè¿ç®ç¬¦ã\n\nvar myObject = {\n  foo: 1,\n};\n\n// æ§åæ³\n'foo' in myObject // true\n\n// æ°åæ³\nReflect.has(myObject, 'foo') // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦æReflect.has()æ¹æ³çç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼ä¼æ¥éã\n\n\n# Reflect.deleteProperty(obj, name)\n\nReflect.deletePropertyæ¹æ³ç­åäºdelete obj[name]ï¼ç¨äºå é¤å¯¹è±¡çå±æ§ã\n\nconst myObj = { foo: 'bar' };\n\n// æ§åæ³\ndelete myObj.foo;\n\n// æ°åæ³\nReflect.deleteProperty(myObj, 'foo');\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¯¥æ¹æ³è¿åä¸ä¸ªå¸å°å¼ãå¦æå é¤æåï¼æèè¢«å é¤çå±æ§ä¸å­å¨ï¼è¿åtrueï¼å é¤å¤±è´¥ï¼è¢«å é¤çå±æ§ä¾ç¶å­å¨ï¼è¿åfalseã\n\nå¦æReflect.deleteProperty()æ¹æ³çç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼ä¼æ¥éã\n\n\n# Reflect.construct(target, args)\n\nReflect.constructæ¹æ³ç­åäºnew target(...args)ï¼è¿æä¾äºä¸ç§ä¸ä½¿ç¨newï¼æ¥è°ç¨æé å½æ°çæ¹æ³ã\n\nfunction Greeting(name) {\n  this.name = name;\n}\n\n// new çåæ³\nconst instance = new Greeting('å¼ ä¸');\n\n// Reflect.construct çåæ³\nconst instance = Reflect.construct(Greeting, ['å¼ ä¸']);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦æReflect.construct()æ¹æ³çç¬¬ä¸ä¸ªåæ°ä¸æ¯å½æ°ï¼ä¼æ¥éã\n\n\n# Reflect.getPrototypeOf(obj)\n\nReflect.getPrototypeOfæ¹æ³ç¨äºè¯»åå¯¹è±¡ç__proto__å±æ§ï¼å¯¹åºObject.getPrototypeOf(obj)ã\n\nconst myObj = new FancyThing();\n\n// æ§åæ³\nObject.getPrototypeOf(myObj) === FancyThing.prototype;\n\n// æ°åæ³\nReflect.getPrototypeOf(myObj) === FancyThing.prototype;\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nReflect.getPrototypeOfåObject.getPrototypeOfçä¸ä¸ªåºå«æ¯ï¼å¦æåæ°ä¸æ¯å¯¹è±¡ï¼Object.getPrototypeOfä¼å°è¿ä¸ªåæ°è½¬ä¸ºå¯¹è±¡ï¼ç¶ååè¿è¡ï¼èReflect.getPrototypeOfä¼æ¥éã\n\nObject.getPrototypeOf(1) // Number {[[PrimitiveValue]]: 0}\nReflect.getPrototypeOf(1) // æ¥é\n\n\n1\n2\n\n\n\n# Reflect.setPrototypeOf(obj, newProto)\n\nReflect.setPrototypeOfæ¹æ³ç¨äºè®¾ç½®ç®æ å¯¹è±¡çååï¼prototypeï¼ï¼å¯¹åºObject.setPrototypeOf(obj, newProto)æ¹æ³ãå®è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºæ¯å¦è®¾ç½®æåã\n\nconst myObj = {};\n\n// æ§åæ³\nObject.setPrototypeOf(myObj, Array.prototype);\n\n// æ°åæ³\nReflect.setPrototypeOf(myObj, Array.prototype);\n\nmyObj.length // 0\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦ææ æ³è®¾ç½®ç®æ å¯¹è±¡çååï¼æ¯å¦ï¼ç®æ å¯¹è±¡ç¦æ­¢æ©å±ï¼ï¼Reflect.setPrototypeOfæ¹æ³è¿åfalseã\n\nReflect.setPrototypeOf({}, null)\n// true\nReflect.setPrototypeOf(Object.freeze({}), null)\n// false\n\n\n1\n2\n3\n4\n\n\nå¦æç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼Object.setPrototypeOfä¼è¿åç¬¬ä¸ä¸ªåæ°æ¬èº«ï¼èReflect.setPrototypeOfä¼æ¥éã\n\nObject.setPrototypeOf(1, {})\n// 1\n\nReflect.setPrototypeOf(1, {})\n// TypeError: Reflect.setPrototypeOf called on non-object\n\n\n1\n2\n3\n4\n5\n\n\nå¦æç¬¬ä¸ä¸ªåæ°æ¯undefinedænullï¼Object.setPrototypeOfåReflect.setPrototypeOfé½ä¼æ¥éã\n\nObject.setPrototypeOf(null, {})\n// TypeError: Object.setPrototypeOf called on null or undefined\n\nReflect.setPrototypeOf(null, {})\n// TypeError: Reflect.setPrototypeOf called on non-object\n\n\n1\n2\n3\n4\n5\n\n\n\n# Reflect.apply(func, thisArg, args)\n\nReflect.applyæ¹æ³ç­åäºFunction.prototype.apply.call(func, thisArg, args)ï¼ç¨äºç»å®thiså¯¹è±¡åæ§è¡ç»å®å½æ°ã\n\nä¸è¬æ¥è¯´ï¼å¦æè¦ç»å®ä¸ä¸ªå½æ°çthiså¯¹è±¡ï¼å¯ä»¥è¿æ ·åfn.apply(obj, args)ï¼ä½æ¯å¦æå½æ°å®ä¹äºèªå·±çapplyæ¹æ³ï¼å°±åªè½åæFunction.prototype.apply.call(fn, obj, args)ï¼éç¨Reflectå¯¹è±¡å¯ä»¥ç®åè¿ç§æä½ã\n\nconst ages = [11, 33, 12, 54, 18, 96];\n\n// æ§åæ³\nconst youngest = Math.min.apply(Math, ages);\nconst oldest = Math.max.apply(Math, ages);\nconst type = Object.prototype.toString.call(youngest);\n\n// æ°åæ³\nconst youngest = Reflect.apply(Math.min, Math, ages);\nconst oldest = Reflect.apply(Math.max, Math, ages);\nconst type = Reflect.apply(Object.prototype.toString, youngest, []);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# Reflect.defineProperty(target, propertyKey, attributes)\n\nReflect.definePropertyæ¹æ³åºæ¬ç­åäºObject.definePropertyï¼ç¨æ¥ä¸ºå¯¹è±¡å®ä¹å±æ§ãæªæ¥ï¼åèä¼è¢«éæ¸åºé¤ï¼è¯·ä»ç°å¨å¼å§å°±ä½¿ç¨Reflect.definePropertyä»£æ¿å®ã\n\nfunction MyDate() {\n  /*â¦*/\n}\n\n// æ§åæ³\nObject.defineProperty(MyDate, 'now', {\n  value: () => Date.now()\n});\n\n// æ°åæ³\nReflect.defineProperty(MyDate, 'now', {\n  value: () => Date.now()\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nå¦æReflect.definePropertyçç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼å°±ä¼æåºéè¯¯ï¼æ¯å¦Reflect.defineProperty(1, 'foo')ã\n\nè¿ä¸ªæ¹æ³å¯ä»¥ä¸Proxy.definePropertyéåä½¿ç¨ã\n\nconst p = new Proxy({}, {\n  defineProperty(target, prop, descriptor) {\n    console.log(descriptor);\n    return Reflect.defineProperty(target, prop, descriptor);\n  }\n});\n\np.foo = 'bar';\n// {value: \"bar\", writable: true, enumerable: true, configurable: true}\n\np.foo // \"bar\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼Proxy.definePropertyå¯¹å±æ§èµå¼è®¾ç½®äºæ¦æªï¼ç¶åä½¿ç¨Reflect.definePropertyå®æäºèµå¼ã\n\n\n# Reflect.getOwnPropertyDescriptor(target, propertyKey)\n\nReflect.getOwnPropertyDescriptoråºæ¬ç­åäºObject.getOwnPropertyDescriptorï¼ç¨äºå¾å°æå®å±æ§çæè¿°å¯¹è±¡ï¼å°æ¥ä¼æ¿ä»£æåèã\n\nvar myObject = {};\nObject.defineProperty(myObject, 'hidden', {\n  value: true,\n  enumerable: false,\n});\n\n// æ§åæ³\nvar theDescriptor = Object.getOwnPropertyDescriptor(myObject, 'hidden');\n\n// æ°åæ³\nvar theDescriptor = Reflect.getOwnPropertyDescriptor(myObject, 'hidden');\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nReflect.getOwnPropertyDescriptoråObject.getOwnPropertyDescriptorçä¸ä¸ªåºå«æ¯ï¼å¦æç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼Object.getOwnPropertyDescriptor(1, 'foo')ä¸æ¥éï¼è¿åundefinedï¼èReflect.getOwnPropertyDescriptor(1, 'foo')ä¼æåºéè¯¯ï¼è¡¨ç¤ºåæ°éæ³ã\n\n\n# Reflect.isExtensible (target)\n\nReflect.isExtensibleæ¹æ³å¯¹åºObject.isExtensibleï¼è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºå½åå¯¹è±¡æ¯å¦å¯æ©å±ã\n\nconst myObject = {};\n\n// æ§åæ³\nObject.isExtensible(myObject) // true\n\n// æ°åæ³\nReflect.isExtensible(myObject) // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦æåæ°ä¸æ¯å¯¹è±¡ï¼Object.isExtensibleä¼è¿åfalseï¼å ä¸ºéå¯¹è±¡æ¬æ¥å°±æ¯ä¸å¯æ©å±çï¼èReflect.isExtensibleä¼æ¥éã\n\nObject.isExtensible(1) // false\nReflect.isExtensible(1) // æ¥é\n\n\n1\n2\n\n\n\n# Reflect.preventExtensions(target)\n\nReflect.preventExtensionså¯¹åºObject.preventExtensionsæ¹æ³ï¼ç¨äºè®©ä¸ä¸ªå¯¹è±¡åä¸ºä¸å¯æ©å±ãå®è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºæ¯å¦æä½æåã\n\nvar myObject = {};\n\n// æ§åæ³\nObject.preventExtensions(myObject) // Object {}\n\n// æ°åæ³\nReflect.preventExtensions(myObject) // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦æåæ°ä¸æ¯å¯¹è±¡ï¼Object.preventExtensionså¨ ES5 ç¯å¢æ¥éï¼å¨ ES6 ç¯å¢è¿åä¼ å¥çåæ°ï¼èReflect.preventExtensionsä¼æ¥éã\n\n// ES5 ç¯å¢\nObject.preventExtensions(1) // æ¥é\n\n// ES6 ç¯å¢\nObject.preventExtensions(1) // 1\n\n// æ°åæ³\nReflect.preventExtensions(1) // æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# Reflect.ownKeys (target)\n\nReflect.ownKeysæ¹æ³ç¨äºè¿åå¯¹è±¡çææå±æ§ï¼åºæ¬ç­åäºObject.getOwnPropertyNamesä¸Object.getOwnPropertySymbolsä¹åã\n\nvar myObject = {\n  foo: 1,\n  bar: 2,\n  [Symbol.for('baz')]: 3,\n  [Symbol.for('bing')]: 4,\n};\n\n// æ§åæ³\nObject.getOwnPropertyNames(myObject)\n// ['foo', 'bar']\n\nObject.getOwnPropertySymbols(myObject)\n//[Symbol(baz), Symbol(bing)]\n\n// æ°åæ³\nReflect.ownKeys(myObject)\n// ['foo', 'bar', Symbol(baz), Symbol(bing)]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nå¦æReflect.ownKeys()æ¹æ³çç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼ä¼æ¥éã\n\n\n# å®ä¾ï¼ä½¿ç¨ Proxy å®ç°è§å¯èæ¨¡å¼\n\nè§å¯èæ¨¡å¼ï¼Observer modeï¼æçæ¯å½æ°èªå¨è§å¯æ°æ®å¯¹è±¡ï¼ä¸æ¦å¯¹è±¡æååï¼å½æ°å°±ä¼èªå¨æ§è¡ã\n\nconst person = observable({\n  name: 'å¼ ä¸',\n  age: 20\n}); // è§å¯ç®æ \n\nfunction print() {\n  console.log(`${person.name}, ${person.age}`)\n} // è§å¯è\n\nobserve(print); // å¯å¨è§å¯\nperson.name = 'æå';\n// è¾åº\n// æå, 20\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°æ®å¯¹è±¡personæ¯è§å¯ç®æ ï¼å½æ°printæ¯è§å¯èãä¸æ¦æ°æ®å¯¹è±¡åçååï¼printå°±ä¼èªå¨æ§è¡ã\n\nä¸é¢ï¼ä½¿ç¨ Proxy åä¸ä¸ªè§å¯èæ¨¡å¼çæç®åå®ç°ï¼å³å®ç°observableåobserveè¿ä¸¤ä¸ªå½æ°ãæè·¯æ¯observableå½æ°è¿åä¸ä¸ªåå§å¯¹è±¡ç Proxy ä»£çï¼æ¦æªèµå¼æä½ï¼è§¦ååå½è§å¯èçåä¸ªå½æ°ã\n\nconst queuedObservers = new Set();\n\nconst observe = fn => queuedObservers.add(fn);\nconst observable = obj => new Proxy(obj, {set});\n\nfunction set(target, key, value, receiver) {\n  const result = Reflect.set(target, key, value, receiver);\n  queuedObservers.forEach(observer => observer());\n  return result;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼åå®ä¹äºä¸ä¸ªSetéåï¼ææè§å¯èå½æ°é½æ¾è¿è¿ä¸ªéåãç¶åï¼observableå½æ°è¿ååå§å¯¹è±¡çä»£çï¼æ¦æªèµå¼æä½ãæ¦æªå½æ°setä¹ä¸­ï¼ä¼èªå¨æ§è¡ææè§å¯èã",normalizedContent:"# reflect\n\n\n# æ¦è¿°\n\nreflectå¯¹è±¡ä¸proxyå¯¹è±¡ä¸æ ·ï¼ä¹æ¯ es6 ä¸ºäºæä½å¯¹è±¡èæä¾çæ° apiãreflectå¯¹è±¡çè®¾è®¡ç®çæè¿æ ·å ä¸ªã\n\nï¼1ï¼ **å°objectå¯¹è±¡çä¸äºææ¾å±äºè¯­è¨åé¨çæ¹æ³ï¼æ¯å¦object.definepropertyï¼ï¼æ¾å°reflectå¯¹è±¡ä¸ã**ç°é¶æ®µï¼æäºæ¹æ³åæ¶å¨objectåreflectå¯¹è±¡ä¸é¨ç½²ï¼æªæ¥çæ°æ¹æ³å°åªé¨ç½²å¨reflectå¯¹è±¡ä¸ãä¹å°±æ¯è¯´ï¼ä»reflectå¯¹è±¡ä¸å¯ä»¥æ¿å°è¯­è¨åé¨çæ¹æ³ã ï¼2ï¼ ä¿®æ¹æäºobjectæ¹æ³çè¿åç»æï¼è®©å¶åå¾æ´åçãæ¯å¦ï¼object.defineproperty(obj, name, desc)å¨æ æ³å®ä¹å±æ§æ¶ï¼ä¼æåºä¸ä¸ªéè¯¯ï¼èreflect.defineproperty(obj, name, desc)åä¼è¿åfalseã\n\n// èåæ³\ntry {\n  object.defineproperty(target, property, attributes);\n  // success\n} catch (e) {\n  // failure\n}\n\n// æ°åæ³\nif (reflect.defineproperty(target, property, attributes)) {\n  // success\n} else {\n  // failure\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nï¼3ï¼ è®©objectæä½é½åæå½æ°è¡ä¸ºãæäºobjectæä½æ¯å½ä»¤å¼ï¼æ¯å¦name in objådelete obj[name]ï¼èreflect.has(obj, name)åreflect.deleteproperty(obj, name)è®©å®ä»¬åæäºå½æ°è¡ä¸ºã\n\n// èåæ³\n'assign' in object // true\n\n// æ°åæ³\nreflect.has(object, 'assign') // true\n\n\n1\n2\n3\n4\n5\n\n\nï¼4ï¼reflectå¯¹è±¡çæ¹æ³ä¸proxyå¯¹è±¡çæ¹æ³ä¸ä¸å¯¹åºï¼åªè¦æ¯proxyå¯¹è±¡çæ¹æ³ï¼å°±è½å¨reflectå¯¹è±¡ä¸æ¾å°å¯¹åºçæ¹æ³ãè¿å°±è®©proxyå¯¹è±¡å¯ä»¥æ¹ä¾¿å°è°ç¨å¯¹åºçreflectæ¹æ³ï¼å®æé»è®¤è¡ä¸ºï¼ä½ä¸ºä¿®æ¹è¡ä¸ºçåºç¡ãä¹å°±æ¯è¯´ï¼ä¸ç®¡proxyæä¹ä¿®æ¹é»è®¤è¡ä¸ºï¼ä½ æ»å¯ä»¥å¨reflectä¸è·åé»è®¤è¡ä¸ºã\n\nproxy(target, {\n  set: function(target, name, value, receiver) {\n    var success = reflect.set(target, name, value, receiver);\n    if (success) {\n      console.log('property ' + name + ' on ' + target + ' set to ' + value);\n    }\n    return success;\n  }\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼proxyæ¹æ³æ¦æªtargetå¯¹è±¡çå±æ§èµå¼è¡ä¸ºãå®éç¨reflect.setæ¹æ³å°å¼èµå¼ç»å¯¹è±¡çå±æ§ï¼ç¡®ä¿å®æåæçè¡ä¸ºï¼ç¶ååé¨ç½²é¢å¤çåè½ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nvar loggedobj = new proxy(obj, {\n  get(target, name) {\n    console.log('get', target, name);\n    return reflect.get(target, name);\n  },\n  deleteproperty(target, name) {\n    console.log('delete' + name);\n    return reflect.deleteproperty(target, name);\n  },\n  has(target, name) {\n    console.log('has' + name);\n    return reflect.has(target, name);\n  }\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¯ä¸ä¸ªproxyå¯¹è±¡çæ¦æªæä½ï¼getãdeleteãhasï¼ï¼åé¨é½è°ç¨å¯¹åºçreflectæ¹æ³ï¼ä¿è¯åçè¡ä¸ºè½å¤æ­£å¸¸æ§è¡ãæ·»å çå·¥ä½ï¼å°±æ¯å°æ¯ä¸ä¸ªæä½è¾åºä¸è¡æ¥å¿ã\n\næäºreflectå¯¹è±¡ä»¥åï¼å¾å¤æä½ä¼æ´æè¯»ã\n\n// èåæ³\nfunction.prototype.apply.call(math.floor, undefined, [1.75]) // 1\n\n// æ°åæ³\nreflect.apply(math.floor, undefined, [1.75]) // 1\n\n\n1\n2\n3\n4\n5\n\n\n\n# éææ¹æ³\n\nreflectå¯¹è±¡ä¸å±æ 13 ä¸ªéææ¹æ³ã\n\n * reflect.apply(target, thisarg, args)\n * reflect.construct(target, args)\n * reflect.get(target, name, receiver)\n * reflect.set(target, name, value, receiver)\n * reflect.defineproperty(target, name, desc)\n * reflect.deleteproperty(target, name)\n * reflect.has(target, name)\n * reflect.ownkeys(target)\n * reflect.isextensible(target)\n * reflect.preventextensions(target)\n * reflect.getownpropertydescriptor(target, name)\n * reflect.getprototypeof(target)\n * reflect.setprototypeof(target, prototype)\n\nä¸é¢è¿äºæ¹æ³çä½ç¨ï¼å¤§é¨åä¸objectå¯¹è±¡çååæ¹æ³çä½ç¨é½æ¯ç¸åçï¼èä¸å®ä¸proxyå¯¹è±¡çæ¹æ³æ¯ä¸ä¸å¯¹åºçãä¸é¢æ¯å¯¹å®ä»¬çè§£éã\n\n\n# reflect.get(target, name, receiver)\n\nreflect.getæ¹æ³æ¥æ¾å¹¶è¿åtargetå¯¹è±¡çnameå±æ§ï¼å¦ææ²¡æè¯¥å±æ§ï¼åè¿åundefinedã\n\nvar myobject = {\n  foo: 1,\n  bar: 2,\n  get baz() {\n    return this.foo + this.bar;\n  },\n}\n\nreflect.get(myobject, 'foo') // 1\nreflect.get(myobject, 'bar') // 2\nreflect.get(myobject, 'baz') // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¦ænameå±æ§é¨ç½²äºè¯»åå½æ°ï¼getterï¼ï¼åè¯»åå½æ°çthisç»å®receiverã\n\nvar myobject = {\n  foo: 1,\n  bar: 2,\n  get baz() {\n    return this.foo + this.bar;\n  },\n};\n\nvar myreceiverobject = {\n  foo: 4,\n  bar: 4,\n};\n\nreflect.get(myobject, 'baz', myreceiverobject) // 8\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nå¦æç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼reflect.getæ¹æ³ä¼æ¥éã\n\nreflect.get(1, 'foo') // æ¥é\nreflect.get(false, 'foo') // æ¥é\n\n\n1\n2\n\n\n\n# reflect.set(target, name, value, receiver)\n\nreflect.setæ¹æ³è®¾ç½®targetå¯¹è±¡çnameå±æ§ç­äºvalueã\n\nvar myobject = {\n  foo: 1,\n  set bar(value) {\n    return this.foo = value;\n  },\n}\n\nmyobject.foo // 1\n\nreflect.set(myobject, 'foo', 2);\nmyobject.foo // 2\n\nreflect.set(myobject, 'bar', 3)\nmyobject.foo // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nå¦ænameå±æ§è®¾ç½®äºèµå¼å½æ°ï¼åèµå¼å½æ°çthisç»å®receiverã\n\nvar myobject = {\n  foo: 4,\n  set bar(value) {\n    return this.foo = value;\n  },\n};\n\nvar myreceiverobject = {\n  foo: 0,\n};\n\nreflect.set(myobject, 'bar', 1, myreceiverobject);\nmyobject.foo // 4\nmyreceiverobject.foo // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\næ³¨æï¼å¦æ proxyå¯¹è±¡å reflectå¯¹è±¡èåä½¿ç¨ï¼åèæ¦æªèµå¼æä½ï¼åèå®æèµå¼çé»è®¤è¡ä¸ºï¼èä¸ä¼ å¥äºreceiverï¼é£ä¹reflect.setä¼è§¦åproxy.definepropertyæ¦æªã\n\nlet p = {\n  a: 'a'\n};\n\nlet handler = {\n  set(target, key, value, receiver) {\n    console.log('set');\n    reflect.set(target, key, value, receiver)\n  },\n  defineproperty(target, key, attribute) {\n    console.log('defineproperty');\n    reflect.defineproperty(target, key, attribute);\n  }\n};\n\nlet obj = new proxy(p, handler);\nobj.a = 'a';\n// set\n// defineproperty\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ä¸­ï¼proxy.setæ¦æªéé¢ä½¿ç¨äºreflect.setï¼èä¸ä¼ å¥äºreceiverï¼å¯¼è´è§¦åproxy.definepropertyæ¦æªãè¿æ¯å ä¸ºproxy.setçreceiveråæ°æ»æ¯æåå½åç proxyå®ä¾ï¼å³ä¸ä¾çobjï¼ï¼èreflect.setä¸æ¦ä¼ å¥receiverï¼å°±ä¼å°å±æ§èµå¼å°receiverä¸é¢ï¼å³objï¼ï¼å¯¼è´è§¦ådefinepropertyæ¦æªãå¦æreflect.setæ²¡æä¼ å¥receiverï¼é£ä¹å°±ä¸ä¼è§¦ådefinepropertyæ¦æªã\n\nlet p = {\n  a: 'a'\n};\n\nlet handler = {\n  set(target, key, value, receiver) {\n    console.log('set');\n    reflect.set(target, key, value)\n  },\n  defineproperty(target, key, attribute) {\n    console.log('defineproperty');\n    reflect.defineproperty(target, key, attribute);\n  }\n};\n\nlet obj = new proxy(p, handler);\nobj.a = 'a';\n// set\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nå¦æç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼reflect.setä¼æ¥éã\n\nreflect.set(1, 'foo', {}) // æ¥é\nreflect.set(false, 'foo', {}) // æ¥é\n\n\n1\n2\n\n\n\n# reflect.has(obj, name)\n\nreflect.hasæ¹æ³å¯¹åºname in objéé¢çinè¿ç®ç¬¦ã\n\nvar myobject = {\n  foo: 1,\n};\n\n// æ§åæ³\n'foo' in myobject // true\n\n// æ°åæ³\nreflect.has(myobject, 'foo') // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦æreflect.has()æ¹æ³çç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼ä¼æ¥éã\n\n\n# reflect.deleteproperty(obj, name)\n\nreflect.deletepropertyæ¹æ³ç­åäºdelete obj[name]ï¼ç¨äºå é¤å¯¹è±¡çå±æ§ã\n\nconst myobj = { foo: 'bar' };\n\n// æ§åæ³\ndelete myobj.foo;\n\n// æ°åæ³\nreflect.deleteproperty(myobj, 'foo');\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¯¥æ¹æ³è¿åä¸ä¸ªå¸å°å¼ãå¦æå é¤æåï¼æèè¢«å é¤çå±æ§ä¸å­å¨ï¼è¿åtrueï¼å é¤å¤±è´¥ï¼è¢«å é¤çå±æ§ä¾ç¶å­å¨ï¼è¿åfalseã\n\nå¦æreflect.deleteproperty()æ¹æ³çç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼ä¼æ¥éã\n\n\n# reflect.construct(target, args)\n\nreflect.constructæ¹æ³ç­åäºnew target(...args)ï¼è¿æä¾äºä¸ç§ä¸ä½¿ç¨newï¼æ¥è°ç¨æé å½æ°çæ¹æ³ã\n\nfunction greeting(name) {\n  this.name = name;\n}\n\n// new çåæ³\nconst instance = new greeting('å¼ ä¸');\n\n// reflect.construct çåæ³\nconst instance = reflect.construct(greeting, ['å¼ ä¸']);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦æreflect.construct()æ¹æ³çç¬¬ä¸ä¸ªåæ°ä¸æ¯å½æ°ï¼ä¼æ¥éã\n\n\n# reflect.getprototypeof(obj)\n\nreflect.getprototypeofæ¹æ³ç¨äºè¯»åå¯¹è±¡ç__proto__å±æ§ï¼å¯¹åºobject.getprototypeof(obj)ã\n\nconst myobj = new fancything();\n\n// æ§åæ³\nobject.getprototypeof(myobj) === fancything.prototype;\n\n// æ°åæ³\nreflect.getprototypeof(myobj) === fancything.prototype;\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nreflect.getprototypeofåobject.getprototypeofçä¸ä¸ªåºå«æ¯ï¼å¦æåæ°ä¸æ¯å¯¹è±¡ï¼object.getprototypeofä¼å°è¿ä¸ªåæ°è½¬ä¸ºå¯¹è±¡ï¼ç¶ååè¿è¡ï¼èreflect.getprototypeofä¼æ¥éã\n\nobject.getprototypeof(1) // number {[[primitivevalue]]: 0}\nreflect.getprototypeof(1) // æ¥é\n\n\n1\n2\n\n\n\n# reflect.setprototypeof(obj, newproto)\n\nreflect.setprototypeofæ¹æ³ç¨äºè®¾ç½®ç®æ å¯¹è±¡çååï¼prototypeï¼ï¼å¯¹åºobject.setprototypeof(obj, newproto)æ¹æ³ãå®è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºæ¯å¦è®¾ç½®æåã\n\nconst myobj = {};\n\n// æ§åæ³\nobject.setprototypeof(myobj, array.prototype);\n\n// æ°åæ³\nreflect.setprototypeof(myobj, array.prototype);\n\nmyobj.length // 0\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦ææ æ³è®¾ç½®ç®æ å¯¹è±¡çååï¼æ¯å¦ï¼ç®æ å¯¹è±¡ç¦æ­¢æ©å±ï¼ï¼reflect.setprototypeofæ¹æ³è¿åfalseã\n\nreflect.setprototypeof({}, null)\n// true\nreflect.setprototypeof(object.freeze({}), null)\n// false\n\n\n1\n2\n3\n4\n\n\nå¦æç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼object.setprototypeofä¼è¿åç¬¬ä¸ä¸ªåæ°æ¬èº«ï¼èreflect.setprototypeofä¼æ¥éã\n\nobject.setprototypeof(1, {})\n// 1\n\nreflect.setprototypeof(1, {})\n// typeerror: reflect.setprototypeof called on non-object\n\n\n1\n2\n3\n4\n5\n\n\nå¦æç¬¬ä¸ä¸ªåæ°æ¯undefinedænullï¼object.setprototypeofåreflect.setprototypeofé½ä¼æ¥éã\n\nobject.setprototypeof(null, {})\n// typeerror: object.setprototypeof called on null or undefined\n\nreflect.setprototypeof(null, {})\n// typeerror: reflect.setprototypeof called on non-object\n\n\n1\n2\n3\n4\n5\n\n\n\n# reflect.apply(func, thisarg, args)\n\nreflect.applyæ¹æ³ç­åäºfunction.prototype.apply.call(func, thisarg, args)ï¼ç¨äºç»å®thiså¯¹è±¡åæ§è¡ç»å®å½æ°ã\n\nä¸è¬æ¥è¯´ï¼å¦æè¦ç»å®ä¸ä¸ªå½æ°çthiså¯¹è±¡ï¼å¯ä»¥è¿æ ·åfn.apply(obj, args)ï¼ä½æ¯å¦æå½æ°å®ä¹äºèªå·±çapplyæ¹æ³ï¼å°±åªè½åæfunction.prototype.apply.call(fn, obj, args)ï¼éç¨reflectå¯¹è±¡å¯ä»¥ç®åè¿ç§æä½ã\n\nconst ages = [11, 33, 12, 54, 18, 96];\n\n// æ§åæ³\nconst youngest = math.min.apply(math, ages);\nconst oldest = math.max.apply(math, ages);\nconst type = object.prototype.tostring.call(youngest);\n\n// æ°åæ³\nconst youngest = reflect.apply(math.min, math, ages);\nconst oldest = reflect.apply(math.max, math, ages);\nconst type = reflect.apply(object.prototype.tostring, youngest, []);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# reflect.defineproperty(target, propertykey, attributes)\n\nreflect.definepropertyæ¹æ³åºæ¬ç­åäºobject.definepropertyï¼ç¨æ¥ä¸ºå¯¹è±¡å®ä¹å±æ§ãæªæ¥ï¼åèä¼è¢«éæ¸åºé¤ï¼è¯·ä»ç°å¨å¼å§å°±ä½¿ç¨reflect.definepropertyä»£æ¿å®ã\n\nfunction mydate() {\n  /*â¦*/\n}\n\n// æ§åæ³\nobject.defineproperty(mydate, 'now', {\n  value: () => date.now()\n});\n\n// æ°åæ³\nreflect.defineproperty(mydate, 'now', {\n  value: () => date.now()\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nå¦æreflect.definepropertyçç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼å°±ä¼æåºéè¯¯ï¼æ¯å¦reflect.defineproperty(1, 'foo')ã\n\nè¿ä¸ªæ¹æ³å¯ä»¥ä¸proxy.definepropertyéåä½¿ç¨ã\n\nconst p = new proxy({}, {\n  defineproperty(target, prop, descriptor) {\n    console.log(descriptor);\n    return reflect.defineproperty(target, prop, descriptor);\n  }\n});\n\np.foo = 'bar';\n// {value: \"bar\", writable: true, enumerable: true, configurable: true}\n\np.foo // \"bar\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼proxy.definepropertyå¯¹å±æ§èµå¼è®¾ç½®äºæ¦æªï¼ç¶åä½¿ç¨reflect.definepropertyå®æäºèµå¼ã\n\n\n# reflect.getownpropertydescriptor(target, propertykey)\n\nreflect.getownpropertydescriptoråºæ¬ç­åäºobject.getownpropertydescriptorï¼ç¨äºå¾å°æå®å±æ§çæè¿°å¯¹è±¡ï¼å°æ¥ä¼æ¿ä»£æåèã\n\nvar myobject = {};\nobject.defineproperty(myobject, 'hidden', {\n  value: true,\n  enumerable: false,\n});\n\n// æ§åæ³\nvar thedescriptor = object.getownpropertydescriptor(myobject, 'hidden');\n\n// æ°åæ³\nvar thedescriptor = reflect.getownpropertydescriptor(myobject, 'hidden');\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nreflect.getownpropertydescriptoråobject.getownpropertydescriptorçä¸ä¸ªåºå«æ¯ï¼å¦æç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼object.getownpropertydescriptor(1, 'foo')ä¸æ¥éï¼è¿åundefinedï¼èreflect.getownpropertydescriptor(1, 'foo')ä¼æåºéè¯¯ï¼è¡¨ç¤ºåæ°éæ³ã\n\n\n# reflect.isextensible (target)\n\nreflect.isextensibleæ¹æ³å¯¹åºobject.isextensibleï¼è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºå½åå¯¹è±¡æ¯å¦å¯æ©å±ã\n\nconst myobject = {};\n\n// æ§åæ³\nobject.isextensible(myobject) // true\n\n// æ°åæ³\nreflect.isextensible(myobject) // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦æåæ°ä¸æ¯å¯¹è±¡ï¼object.isextensibleä¼è¿åfalseï¼å ä¸ºéå¯¹è±¡æ¬æ¥å°±æ¯ä¸å¯æ©å±çï¼èreflect.isextensibleä¼æ¥éã\n\nobject.isextensible(1) // false\nreflect.isextensible(1) // æ¥é\n\n\n1\n2\n\n\n\n# reflect.preventextensions(target)\n\nreflect.preventextensionså¯¹åºobject.preventextensionsæ¹æ³ï¼ç¨äºè®©ä¸ä¸ªå¯¹è±¡åä¸ºä¸å¯æ©å±ãå®è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºæ¯å¦æä½æåã\n\nvar myobject = {};\n\n// æ§åæ³\nobject.preventextensions(myobject) // object {}\n\n// æ°åæ³\nreflect.preventextensions(myobject) // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦æåæ°ä¸æ¯å¯¹è±¡ï¼object.preventextensionså¨ es5 ç¯å¢æ¥éï¼å¨ es6 ç¯å¢è¿åä¼ å¥çåæ°ï¼èreflect.preventextensionsä¼æ¥éã\n\n// es5 ç¯å¢\nobject.preventextensions(1) // æ¥é\n\n// es6 ç¯å¢\nobject.preventextensions(1) // 1\n\n// æ°åæ³\nreflect.preventextensions(1) // æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# reflect.ownkeys (target)\n\nreflect.ownkeysæ¹æ³ç¨äºè¿åå¯¹è±¡çææå±æ§ï¼åºæ¬ç­åäºobject.getownpropertynamesä¸object.getownpropertysymbolsä¹åã\n\nvar myobject = {\n  foo: 1,\n  bar: 2,\n  [symbol.for('baz')]: 3,\n  [symbol.for('bing')]: 4,\n};\n\n// æ§åæ³\nobject.getownpropertynames(myobject)\n// ['foo', 'bar']\n\nobject.getownpropertysymbols(myobject)\n//[symbol(baz), symbol(bing)]\n\n// æ°åæ³\nreflect.ownkeys(myobject)\n// ['foo', 'bar', symbol(baz), symbol(bing)]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nå¦æreflect.ownkeys()æ¹æ³çç¬¬ä¸ä¸ªåæ°ä¸æ¯å¯¹è±¡ï¼ä¼æ¥éã\n\n\n# å®ä¾ï¼ä½¿ç¨ proxy å®ç°è§å¯èæ¨¡å¼\n\nè§å¯èæ¨¡å¼ï¼observer modeï¼æçæ¯å½æ°èªå¨è§å¯æ°æ®å¯¹è±¡ï¼ä¸æ¦å¯¹è±¡æååï¼å½æ°å°±ä¼èªå¨æ§è¡ã\n\nconst person = observable({\n  name: 'å¼ ä¸',\n  age: 20\n}); // è§å¯ç®æ \n\nfunction print() {\n  console.log(`${person.name}, ${person.age}`)\n} // è§å¯è\n\nobserve(print); // å¯å¨è§å¯\nperson.name = 'æå';\n// è¾åº\n// æå, 20\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°æ®å¯¹è±¡personæ¯è§å¯ç®æ ï¼å½æ°printæ¯è§å¯èãä¸æ¦æ°æ®å¯¹è±¡åçååï¼printå°±ä¼èªå¨æ§è¡ã\n\nä¸é¢ï¼ä½¿ç¨ proxy åä¸ä¸ªè§å¯èæ¨¡å¼çæç®åå®ç°ï¼å³å®ç°observableåobserveè¿ä¸¤ä¸ªå½æ°ãæè·¯æ¯observableå½æ°è¿åä¸ä¸ªåå§å¯¹è±¡ç proxy ä»£çï¼æ¦æªèµå¼æä½ï¼è§¦ååå½è§å¯èçåä¸ªå½æ°ã\n\nconst queuedobservers = new set();\n\nconst observe = fn => queuedobservers.add(fn);\nconst observable = obj => new proxy(obj, {set});\n\nfunction set(target, key, value, receiver) {\n  const result = reflect.set(target, key, value, receiver);\n  queuedobservers.foreach(observer => observer());\n  return result;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼åå®ä¹äºä¸ä¸ªsetéåï¼ææè§å¯èå½æ°é½æ¾è¿è¿ä¸ªéåãç¶åï¼observableå½æ°è¿ååå§å¯¹è±¡çä»£çï¼æ¦æªèµå¼æä½ãæ¦æªå½æ°setä¹ä¸­ï¼ä¼èªå¨æ§è¡ææè§å¯èã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"async å½æ°",frontmatter:{title:"async å½æ°",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/3777253e65bac487",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/20.async%20%E5%87%BD%E6%95%B0.html",relativePath:"ãES6 æç¨ãç¬è®°/20.async å½æ°.md",key:"v-4685ff34",path:"/pages/3777253e65bac487/",headers:[{level:2,title:"å«ä¹",slug:"å«ä¹",normalizedTitle:"å«ä¹",charIndex:15},{level:2,title:"åºæ¬ç¨æ³",slug:"åºæ¬ç¨æ³",normalizedTitle:"åºæ¬ç¨æ³",charIndex:1536},{level:2,title:"è¯­æ³",slug:"è¯­æ³",normalizedTitle:"è¯­æ³",charIndex:89},{level:3,title:"è¿å Promise å¯¹è±¡",slug:"è¿å-promise-å¯¹è±¡",normalizedTitle:"è¿å promise å¯¹è±¡",charIndex:3185},{level:3,title:"Promise å¯¹è±¡çç¶æåå",slug:"promise-å¯¹è±¡çç¶æåå",normalizedTitle:"promise å¯¹è±¡çç¶æåå",charIndex:3633},{level:3,title:"await å½ä»¤",slug:"await-å½ä»¤",normalizedTitle:"await å½ä»¤",charIndex:4153},{level:3,title:"éè¯¯å¤ç",slug:"éè¯¯å¤ç",normalizedTitle:"éè¯¯å¤ç",charIndex:3173},{level:3,title:"ä½¿ç¨æ³¨æç¹",slug:"ä½¿ç¨æ³¨æç¹",normalizedTitle:"ä½¿ç¨æ³¨æç¹",charIndex:7702},{level:2,title:"async å½æ°çå®ç°åç",slug:"async-å½æ°çå®ç°åç",normalizedTitle:"async å½æ°çå®ç°åç",charIndex:6727},{level:2,title:"ä¸å¶ä»å¼æ­¥å¤çæ¹æ³çæ¯è¾",slug:"ä¸å¶ä»å¼æ­¥å¤çæ¹æ³çæ¯è¾",normalizedTitle:"ä¸å¶ä»å¼æ­¥å¤çæ¹æ³çæ¯è¾",charIndex:10914},{level:2,title:"å®ä¾ï¼æé¡ºåºå®æå¼æ­¥æä½",slug:"å®ä¾-æé¡ºåºå®æå¼æ­¥æä½",normalizedTitle:"å®ä¾ï¼æé¡ºåºå®æå¼æ­¥æä½",charIndex:12518},{level:2,title:"é¡¶å± await",slug:"é¡¶å±-await",normalizedTitle:"é¡¶å± await",charIndex:13770}],excerpt:'<h1 id="async-å½æ°"><a class="header-anchor" href="#async-å½æ°">#</a> async å½æ°</h1>\n<h2 id="å«ä¹"><a class="header-anchor" href="#å«ä¹">#</a> å«ä¹</h2>\n<p>ES2017 æ åå¼å¥äº async å½æ°ï¼ä½¿å¾å¼æ­¥æä½åå¾æ´å æ¹ä¾¿ã</p>\n<p>async å½æ°æ¯ä»ä¹ï¼ä¸å¥è¯ï¼å®å°±<strong>æ¯ Generator å½æ°çè¯­æ³ç³</strong>ã</p>\n<p>åææä¸ä¸ª Generator å½æ°ï¼ä¾æ¬¡è¯»åä¸¤ä¸ªæä»¶ã</p>\n',headersStr:"å«ä¹ åºæ¬ç¨æ³ è¯­æ³ è¿å Promise å¯¹è±¡ Promise å¯¹è±¡çç¶æåå await å½ä»¤ éè¯¯å¤ç ä½¿ç¨æ³¨æç¹ async å½æ°çå®ç°åç ä¸å¶ä»å¼æ­¥å¤çæ¹æ³çæ¯è¾ å®ä¾ï¼æé¡ºåºå®æå¼æ­¥æä½ é¡¶å± await",content:"# async å½æ°\n\n\n# å«ä¹\n\nES2017 æ åå¼å¥äº async å½æ°ï¼ä½¿å¾å¼æ­¥æä½åå¾æ´å æ¹ä¾¿ã\n\nasync å½æ°æ¯ä»ä¹ï¼ä¸å¥è¯ï¼å®å°±æ¯ Generator å½æ°çè¯­æ³ç³ã\n\nåææä¸ä¸ª Generator å½æ°ï¼ä¾æ¬¡è¯»åä¸¤ä¸ªæä»¶ã\n\nconst fs = require('fs');\n\nconst readFile = function (fileName) {\n  return new Promise(function (resolve, reject) {\n    fs.readFile(fileName, function(error, data) {\n      if (error) return reject(error);\n      resolve(data);\n    });\n  });\n};\n\nconst gen = function* () {\n  const f1 = yield readFile('/etc/fstab');\n  const f2 = yield readFile('/etc/shells');\n  console.log(f1.toString());\n  console.log(f2.toString());\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç çå½æ°genå¯ä»¥åæasyncå½æ°ï¼å°±æ¯ä¸é¢è¿æ ·ã\n\nconst asyncReadFile = async function () {\n  const f1 = await readFile('/etc/fstab');\n  const f2 = await readFile('/etc/shells');\n  console.log(f1.toString());\n  console.log(f2.toString());\n};\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸æ¯è¾å°±ä¼åç°ï¼asyncå½æ°å°±æ¯å° Generator å½æ°çæå·ï¼*ï¼æ¿æ¢æasyncï¼å°yieldæ¿æ¢æawaitï¼ä»æ­¤èå·²ã\n\nasyncå½æ°å¯¹ Generator å½æ°çæ¹è¿ï¼ä½ç°å¨ä»¥ä¸åç¹ã\n\nï¼1ï¼åç½®æ§è¡å¨ã\n\nGenerator å½æ°çæ§è¡å¿é¡»é æ§è¡å¨ï¼æä»¥ææäºcoæ¨¡åï¼èasyncå½æ°èªå¸¦æ§è¡å¨ãä¹å°±æ¯è¯´ï¼asyncå½æ°çæ§è¡ï¼ä¸æ®éå½æ°ä¸æ¨¡ä¸æ ·ï¼åªè¦ä¸è¡ã\n\nasyncReadFile();\n\n\n1\n\n\nä¸é¢çä»£ç è°ç¨äºasyncReadFileå½æ°ï¼ç¶åå®å°±ä¼èªå¨æ§è¡ï¼è¾åºæåç»æãè¿å®å¨ä¸å Generator å½æ°ï¼éè¦è°ç¨nextæ¹æ³ï¼æèç¨coæ¨¡åï¼æè½çæ­£æ§è¡ï¼å¾å°æåç»æã\n\nï¼2ï¼æ´å¥½çè¯­ä¹ã\n\nasyncåawaitï¼æ¯èµ·æå·åyieldï¼è¯­ä¹æ´æ¸æ¥äºãasyncè¡¨ç¤ºå½æ°éæå¼æ­¥æä½ï¼awaitè¡¨ç¤ºç´§è·å¨åé¢çè¡¨è¾¾å¼éè¦ç­å¾ç»æã\n\nï¼3ï¼æ´å¹¿çéç¨æ§ã\n\ncoæ¨¡åçº¦å®ï¼yieldå½ä»¤åé¢åªè½æ¯ Thunk å½æ°æ Promise å¯¹è±¡ï¼èasyncå½æ°çawaitå½ä»¤åé¢ï¼å¯ä»¥æ¯ Promise å¯¹è±¡ååå§ç±»åçå¼ï¼æ°å¼ãå­ç¬¦ä¸²åå¸å°å¼ï¼ä½è¿æ¶ä¼èªå¨è½¬æç«å³ resolved ç Promise å¯¹è±¡ï¼ã\n\nï¼4ï¼è¿åå¼æ¯ Promiseã\n\nasyncå½æ°çè¿åå¼æ¯ Promise å¯¹è±¡ï¼è¿æ¯ Generator å½æ°çè¿åå¼æ¯ Iterator å¯¹è±¡æ¹ä¾¿å¤äºãä½ å¯ä»¥ç¨thenæ¹æ³æå®ä¸ä¸æ­¥çæä½ã\n\nè¿ä¸æ­¥è¯´ï¼asyncå½æ°å®å¨å¯ä»¥çä½å¤ä¸ªå¼æ­¥æä½ï¼åè£æçä¸ä¸ª Promise å¯¹è±¡ï¼èawaitå½ä»¤å°±æ¯åé¨thenå½ä»¤çè¯­æ³ç³ã\n\n\n# åºæ¬ç¨æ³\n\nasyncå½æ°è¿åä¸ä¸ª Promise å¯¹è±¡ï¼å¯ä»¥ä½¿ç¨thenæ¹æ³æ·»å åè°å½æ°ãå½å½æ°æ§è¡çæ¶åï¼ä¸æ¦éå°awaitå°±ä¼åè¿åï¼ç­å°å¼æ­¥æä½å®æï¼åæ¥çæ§è¡å½æ°ä½ååé¢çè¯­å¥ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nasync function getStockPriceByName(name) {\n  const symbol = await getStockSymbol(name);\n  const stockPrice = await getStockPrice(symbol);\n  return stockPrice;\n}\n\ngetStockPriceByName('goog').then(function (result) {\n  console.log(result);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç æ¯ä¸ä¸ªè·åè¡ç¥¨æ¥ä»·çå½æ°ï¼å½æ°åé¢çasyncå³é®å­ï¼è¡¨æè¯¥å½æ°åé¨æå¼æ­¥æä½ãè°ç¨è¯¥å½æ°æ¶ï¼ä¼ç«å³è¿åä¸ä¸ªPromiseå¯¹è±¡ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ï¼æå®å¤å°æ¯«ç§åè¾åºä¸ä¸ªå¼ã\n\nfunction timeout(ms) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n}\n\nasync function asyncPrint(value, ms) {\n  await timeout(ms);\n  console.log(value);\n}\n\nasyncPrint('hello world', 50);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç æå® 50 æ¯«ç§ä»¥åï¼è¾åºhello worldã\n\nç±äºasyncå½æ°è¿åçæ¯ Promise å¯¹è±¡ï¼å¯ä»¥ä½ä¸ºawaitå½ä»¤çåæ°ãæä»¥ï¼ä¸é¢çä¾å­ä¹å¯ä»¥åæä¸é¢çå½¢å¼ã\n\nasync function timeout(ms) {\n  await new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n}\n\nasync function asyncPrint(value, ms) {\n  await timeout(ms);\n  console.log(value);\n}\n\nasyncPrint('hello world', 50);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nasync å½æ°æå¤ç§ä½¿ç¨å½¢å¼ã\n\n// å½æ°å£°æ\nasync function foo() {}\n\n// å½æ°è¡¨è¾¾å¼\nconst foo = async function () {};\n\n// å¯¹è±¡çæ¹æ³\nlet obj = { async foo() {} };\nobj.foo().then(...)\n\n// Class çæ¹æ³\nclass Storage {\n  constructor() {\n    this.cachePromise = caches.open('avatars');\n  }\n\n  async getAvatar(name) {\n    const cache = await this.cachePromise;\n    return cache.match(`/avatars/${name}.jpg`);\n  }\n}\n\nconst storage = new Storage();\nstorage.getAvatar('jake').then(â¦);\n\n// ç®­å¤´å½æ°\nconst foo = async () => {};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n\n\n\n# è¯­æ³\n\nasyncå½æ°çè¯­æ³è§åæ»ä½ä¸æ¯è¾ç®åï¼é¾ç¹æ¯éè¯¯å¤çæºå¶ã\n\n\n# è¿å Promise å¯¹è±¡\n\nasyncå½æ°è¿åä¸ä¸ª Promise å¯¹è±¡ã\n\nasyncå½æ°åé¨returnè¯­å¥è¿åçå¼ï¼ä¼æä¸ºthenæ¹æ³åè°å½æ°çåæ°ã\n\nasync function f() {\n  return 'hello world';\n}\n\nf().then(v => console.log(v))\n// \"hello world\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fåé¨returnå½ä»¤è¿åçå¼ï¼ä¼è¢«thenæ¹æ³åè°å½æ°æ¥æ¶å°ã\n\nasyncå½æ°åé¨æåºéè¯¯ï¼ä¼å¯¼è´è¿åç Promise å¯¹è±¡åä¸ºrejectç¶æãæåºçéè¯¯å¯¹è±¡ä¼è¢«catchæ¹æ³åè°å½æ°æ¥æ¶å°ã\n\nasync function f() {\n  throw new Error('åºéäº');\n}\n\nf().then(\n  v => console.log(v),\n  e => console.log(e)\n)\n// Error: åºéäº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# Promise å¯¹è±¡çç¶æåå\n\nasyncå½æ°è¿åç Promise å¯¹è±¡ï¼å¿é¡»ç­å°åé¨ææawaitå½ä»¤åé¢ç Promise å¯¹è±¡æ§è¡å®ï¼æä¼åçç¶ææ¹åï¼é¤ééå°returnè¯­å¥æèæåºéè¯¯ãä¹å°±æ¯è¯´ï¼åªæasyncå½æ°åé¨çå¼æ­¥æä½æ§è¡å®ï¼æä¼æ§è¡thenæ¹æ³æå®çåè°å½æ°ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nasync function getTitle(url) {\n  let response = await fetch(url);\n  let html = await response.text();\n  return html.match(/<title>([\\s\\S]+)<\\/title>/i)[1];\n}\ngetTitle('https://tc39.github.io/ecma262/').then(console.log)\n// \"ECMAScript 2017 Language Specification\"\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°getTitleåé¨æä¸ä¸ªæä½ï¼æåç½é¡µãååºææ¬ãå¹éé¡µé¢æ é¢ãåªæè¿ä¸ä¸ªæä½å¨é¨å®æï¼æä¼æ§è¡thenæ¹æ³éé¢çconsole.logã\n\n\n# await å½ä»¤\n\næ­£å¸¸æåµä¸ï¼awaitå½ä»¤åé¢æ¯ä¸ä¸ª Promise å¯¹è±¡ï¼è¿åè¯¥å¯¹è±¡çç»æãå¦æä¸æ¯ Promise å¯¹è±¡ï¼å°±ç´æ¥è¿åå¯¹åºçå¼ã\n\nasync function f() {\n  // ç­åäº\n  // return 123;\n  return await 123;\n}\n\nf().then(v => console.log(v))\n// 123\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼awaitå½ä»¤çåæ°æ¯æ°å¼123ï¼è¿æ¶ç­åäºreturn 123ã\n\nå¦ä¸ç§æåµæ¯ï¼awaitå½ä»¤åé¢æ¯ä¸ä¸ªthenableå¯¹è±¡ï¼å³å®ä¹thenæ¹æ³çå¯¹è±¡ï¼ï¼é£ä¹awaitä¼å°å¶ç­åäº Promise å¯¹è±¡ã\n\nclass Sleep {\n  constructor(timeout) {\n    this.timeout = timeout;\n  }\n  then(resolve, reject) {\n    const startTime = Date.now();\n    setTimeout(\n      () => resolve(Date.now() - startTime),\n      this.timeout\n    );\n  }\n}\n\n(async () => {\n  const sleepTime = await new Sleep(1000);\n  console.log(sleepTime);\n})();\n// 1000\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä¸é¢ä»£ç ä¸­ï¼awaitå½ä»¤åé¢æ¯ä¸ä¸ªSleepå¯¹è±¡çå®ä¾ãè¿ä¸ªå®ä¾ä¸æ¯ Promise å¯¹è±¡ï¼ä½æ¯å ä¸ºå®ä¹äºthenæ¹æ³ï¼awaitä¼å°å¶è§ä¸ºPromiseå¤çã\n\nè¿ä¸ªä¾å­è¿æ¼ç¤ºäºå¦ä½å®ç°ä¼ç ææãJavaScript ä¸ç´æ²¡æä¼ç çè¯­æ³ï¼ä½æ¯åå©awaitå½ä»¤å°±å¯ä»¥è®©ç¨åºåé¡¿æå®çæ¶é´ãä¸é¢ç»åºäºä¸ä¸ªç®åçsleepå®ç°ã\n\nfunction sleep(interval) {\n  return new Promise(resolve => {\n    setTimeout(resolve, interval);\n  })\n}\n\n// ç¨æ³\nasync function one2FiveInAsync() {\n  for(let i = 1; i <= 5; i++) {\n    console.log(i);\n    await sleep(1000);\n  }\n}\n\none2FiveInAsync();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nawaitå½ä»¤åé¢ç Promise å¯¹è±¡å¦æåä¸ºrejectç¶æï¼årejectçåæ°ä¼è¢«catchæ¹æ³çåè°å½æ°æ¥æ¶å°ã\n\nasync function f() {\n  await Promise.reject('åºéäº');\n}\n\nf()\n.then(v => console.log(v))\n.catch(e => console.log(e))\n// åºéäº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næ³¨æï¼ä¸é¢ä»£ç ä¸­ï¼awaitè¯­å¥åé¢æ²¡æreturnï¼ä½æ¯rejectæ¹æ³çåæ°ä¾ç¶ä¼ å¥äºcatchæ¹æ³çåè°å½æ°ãè¿éå¦æå¨awaitåé¢å ä¸returnï¼æææ¯ä¸æ ·çã\n\nä»»ä½ä¸ä¸ªawaitè¯­å¥åé¢ç Promise å¯¹è±¡åä¸ºrejectç¶æï¼é£ä¹æ´ä¸ªasyncå½æ°é½ä¼ä¸­æ­æ§è¡ã\n\nasync function f() {\n  await Promise.reject('åºéäº');\n  await Promise.resolve('hello world'); // ä¸ä¼æ§è¡\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬äºä¸ªawaitè¯­å¥æ¯ä¸ä¼æ§è¡çï¼å ä¸ºç¬¬ä¸ä¸ªawaitè¯­å¥ç¶æåæäºrejectã\n\nææ¶ï¼æä»¬å¸æå³ä½¿åä¸ä¸ªå¼æ­¥æä½å¤±è´¥ï¼ä¹ä¸è¦ä¸­æ­åé¢çå¼æ­¥æä½ãè¿æ¶å¯ä»¥å°ç¬¬ä¸ä¸ªawaitæ¾å¨try...catchç»æéé¢ï¼è¿æ ·ä¸ç®¡è¿ä¸ªå¼æ­¥æä½æ¯å¦æåï¼ç¬¬äºä¸ªawaité½ä¼æ§è¡ã\n\nasync function f() {\n  try {\n    await Promise.reject('åºéäº');\n  } catch(e) {\n  }\n  return await Promise.resolve('hello world');\n}\n\nf()\n.then(v => console.log(v))\n// hello world\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¦ä¸ç§æ¹æ³æ¯awaitåé¢ç Promise å¯¹è±¡åè·ä¸ä¸ªcatchæ¹æ³ï¼å¤çåé¢å¯è½åºç°çéè¯¯ã\n\nasync function f() {\n  await Promise.reject('åºéäº')\n    .catch(e => console.log(e));\n  return await Promise.resolve('hello world');\n}\n\nf()\n.then(v => console.log(v))\n// åºéäº\n// hello world\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# éè¯¯å¤ç\n\nå¦æawaitåé¢çå¼æ­¥æä½åºéï¼é£ä¹ç­åäºasyncå½æ°è¿åç Promise å¯¹è±¡è¢«rejectã\n\nasync function f() {\n  await new Promise(function (resolve, reject) {\n    throw new Error('åºéäº');\n  });\n}\n\nf()\n.then(v => console.log(v))\n.catch(e => console.log(e))\n// Errorï¼åºéäº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼asyncå½æ°fæ§è¡åï¼awaitåé¢ç Promise å¯¹è±¡ä¼æåºä¸ä¸ªéè¯¯å¯¹è±¡ï¼å¯¼è´catchæ¹æ³çåè°å½æ°è¢«è°ç¨ï¼å®çåæ°å°±æ¯æåºçéè¯¯å¯¹è±¡ãå·ä½çæ§è¡æºå¶ï¼å¯ä»¥åèåæçâasync å½æ°çå®ç°åçâã\n\né²æ­¢åºéçæ¹æ³ï¼ä¹æ¯å°å¶æ¾å¨try...catchä»£ç åä¹ä¸­ã\n\nasync function f() {\n  try {\n    await new Promise(function (resolve, reject) {\n      throw new Error('åºéäº');\n    });\n  } catch(e) {\n  }\n  return await('hello world');\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦ææå¤ä¸ªawaitå½ä»¤ï¼å¯ä»¥ç»ä¸æ¾å¨try...catchç»æä¸­ã\n\nasync function main() {\n  try {\n    const val1 = await firstStep();\n    const val2 = await secondStep(val1);\n    const val3 = await thirdStep(val1, val2);\n\n    console.log('Final: ', val3);\n  }\n  catch (err) {\n    console.error(err);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢çä¾å­ä½¿ç¨try...catchç»æï¼å®ç°å¤æ¬¡éå¤å°è¯ã\n\nconst superagent = require('superagent');\nconst NUM_RETRIES = 3;\n\nasync function test() {\n  let i;\n  for (i = 0; i < NUM_RETRIES; ++i) {\n    try {\n      await superagent.get('http://google.com/this-throws-an-error');\n      break;\n    } catch(err) {}\n  }\n  console.log(i); // 3\n}\n\ntest();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æawaitæä½æåï¼å°±ä¼ä½¿ç¨breakè¯­å¥éåºå¾ªç¯ï¼å¦æå¤±è´¥ï¼ä¼è¢«catchè¯­å¥ææï¼ç¶åè¿å¥ä¸ä¸è½®å¾ªç¯ã\n\n\n# ä½¿ç¨æ³¨æç¹\n\nç¬¬ä¸ç¹ï¼åé¢å·²ç»è¯´è¿ï¼awaitå½ä»¤åé¢çPromiseå¯¹è±¡ï¼è¿è¡ç»æå¯è½æ¯rejectedï¼æä»¥æå¥½æawaitå½ä»¤æ¾å¨try...catchä»£ç åä¸­ã\n\nasync function myFunction() {\n  try {\n    await somethingThatReturnsAPromise();\n  } catch (err) {\n    console.log(err);\n  }\n}\n\n// å¦ä¸ç§åæ³\n\nasync function myFunction() {\n  await somethingThatReturnsAPromise()\n  .catch(function (err) {\n    console.log(err);\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nç¬¬äºç¹ï¼å¤ä¸ªawaitå½ä»¤åé¢çå¼æ­¥æä½ï¼å¦æä¸å­å¨ç»§åå³ç³»ï¼æå¥½è®©å®ä»¬åæ¶è§¦åï¼å¹¶åï¼ã\n\nlet foo = await getFoo();\nlet bar = await getBar();\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼getFooågetBaræ¯ä¸¤ä¸ªç¬ç«çå¼æ­¥æä½ï¼å³äºä¸ä¾èµï¼ï¼è¢«åæç»§åå³ç³»ãè¿æ ·æ¯è¾èæ¶ï¼å ä¸ºåªægetFooå®æä»¥åï¼æä¼æ§è¡getBarï¼å®å¨å¯ä»¥è®©å®ä»¬åæ¶è§¦åã\n\n// åæ³ä¸\nlet [foo, bar] = await Promise.all([getFoo(), getBar()]);\n\n// åæ³äº\nlet fooPromise = getFoo();\nlet barPromise = getBar();\nlet foo = await fooPromise;\nlet bar = await barPromise;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä¸¤ç§åæ³ï¼getFooågetBaré½æ¯åæ¶è§¦åï¼è¿æ ·å°±ä¼ç¼©ç­ç¨åºçæ§è¡æ¶é´ã\n\nç¬¬ä¸ç¹ï¼awaitå½ä»¤åªè½ç¨å¨asyncå½æ°ä¹ä¸­ï¼å¦æç¨å¨æ®éå½æ°ï¼å°±ä¼æ¥éã\n\nasync function dbFuc(db) {\n  let docs = [{}, {}, {}];\n\n  // æ¥é\n  docs.forEach(function (doc) {\n    await db.post(doc);\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¼æ¥éï¼å ä¸ºawaitç¨å¨æ®éå½æ°ä¹ä¸­äºãä½æ¯ï¼å¦æå°forEachæ¹æ³çåæ°æ¹æasyncå½æ°ï¼ä¹æé®é¢ã\n\nfunction dbFuc(db) { //è¿éä¸éè¦ async\n  let docs = [{}, {}, {}];\n\n  // å¯è½å¾å°éè¯¯ç»æ\n  docs.forEach(async function (doc) {\n    await db.post(doc);\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç å¯è½ä¸ä¼æ­£å¸¸å·¥ä½ï¼åå æ¯è¿æ¶ä¸ä¸ªdb.postæä½å°æ¯å¹¶åæ§è¡ï¼ä¹å°±æ¯åæ¶æ§è¡ï¼èä¸æ¯ç»§åæ§è¡ãæ­£ç¡®çåæ³æ¯éç¨forå¾ªç¯ã\n\nasync function dbFuc(db) {\n  let docs = [{}, {}, {}];\n\n  for (let doc of docs) {\n    await db.post(doc);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦æç¡®å®å¸æå¤ä¸ªè¯·æ±å¹¶åæ§è¡ï¼å¯ä»¥ä½¿ç¨Promise.allæ¹æ³ãå½ä¸ä¸ªè¯·æ±é½ä¼resolvedæ¶ï¼ä¸é¢ä¸¤ç§åæ³ææç¸åã\n\nasync function dbFuc(db) {\n  let docs = [{}, {}, {}];\n  let promises = docs.map((doc) => db.post(doc));\n\n  let results = await Promise.all(promises);\n  console.log(results);\n}\n\n// æèä½¿ç¨ä¸é¢çåæ³\n\nasync function dbFuc(db) {\n  let docs = [{}, {}, {}];\n  let promises = docs.map((doc) => db.post(doc));\n\n  let results = [];\n  for (let promise of promises) {\n    results.push(await promise);\n  }\n  console.log(results);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nç¬¬åç¹ï¼async å½æ°å¯ä»¥ä¿çè¿è¡å æ ã\n\nconst a = () => {\n  b().then(() => c());\n};\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°aåé¨è¿è¡äºä¸ä¸ªå¼æ­¥ä»»å¡b()ãå½b()è¿è¡çæ¶åï¼å½æ°a()ä¸ä¼ä¸­æ­ï¼èæ¯ç»§ç»­æ§è¡ãç­å°b()è¿è¡ç»æï¼å¯è½a()æ©å°±è¿è¡ç»æäºï¼b()æå¨çä¸ä¸æç¯å¢å·²ç»æ¶å¤±äºãå¦æb()æc()æ¥éï¼éè¯¯å æ å°ä¸åæ¬a()ã\n\nç°å¨å°è¿ä¸ªä¾å­æ¹æasyncå½æ°ã\n\nconst a = async () => {\n  await b();\n  c();\n};\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼b()è¿è¡çæ¶åï¼a()æ¯æåæ§è¡ï¼ä¸ä¸æç¯å¢é½ä¿å­çãä¸æ¦b()æc()æ¥éï¼éè¯¯å æ å°åæ¬a()ã\n\n\n# async å½æ°çå®ç°åç\n\nasync å½æ°çå®ç°åç**ï¼å°±æ¯å° Generator å½æ°åèªå¨æ§è¡å¨ï¼åè£å¨ä¸ä¸ªå½æ°é**ã\n\nasync function fn(args) {\n  // ...\n}\n\n// ç­åäº\n\nfunction fn(args) {\n  return spawn(function* () {\n    // ...\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nææçasyncå½æ°é½å¯ä»¥åæä¸é¢çç¬¬äºç§å½¢å¼ï¼å¶ä¸­çspawnå½æ°å°±æ¯èªå¨æ§è¡å¨ã\n\nä¸é¢ç»åºspawnå½æ°çå®ç°ï¼åºæ¬å°±æ¯åæèªå¨æ§è¡å¨çç¿»çã\n\nfunction spawn(genF) {\n  return new Promise(function(resolve, reject) {\n    const gen = genF();\n    function step(nextF) {\n      let next;\n      try {\n        next = nextF();\n      } catch(e) {\n        return reject(e);\n      }\n      if(next.done) {\n        return resolve(next.value);\n      }\n      Promise.resolve(next.value).then(function(v) {\n        step(function() { return gen.next(v); });\n      }, function(e) {\n        step(function() { return gen.throw(e); });\n      });\n    }\n    step(function() { return gen.next(undefined); });\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\n\n# ä¸å¶ä»å¼æ­¥å¤çæ¹æ³çæ¯è¾\n\næä»¬éè¿ä¸ä¸ªä¾å­ï¼æ¥ç async å½æ°ä¸ PromiseãGenerator å½æ°çæ¯è¾ã\n\nåå®æä¸ª DOM åç´ ä¸é¢ï¼é¨ç½²äºä¸ç³»åçå¨ç»ï¼åä¸ä¸ªå¨ç»ç»æï¼æè½å¼å§åä¸ä¸ªãå¦æå½ä¸­æä¸ä¸ªå¨ç»åºéï¼å°±ä¸åå¾ä¸æ§è¡ï¼è¿åä¸ä¸ä¸ªæåæ§è¡çå¨ç»çè¿åå¼ã\n\né¦åæ¯ Promise çåæ³ã\n\nfunction chainAnimationsPromise(elem, animations) {\n\n  // åéretç¨æ¥ä¿å­ä¸ä¸ä¸ªå¨ç»çè¿åå¼\n  let ret = null;\n\n  // æ°å»ºä¸ä¸ªç©ºçPromise\n  let p = Promise.resolve();\n\n  // ä½¿ç¨thenæ¹æ³ï¼æ·»å ææå¨ç»\n  for(let anim of animations) {\n    p = p.then(function(val) {\n      ret = val;\n      return anim(elem);\n    });\n  }\n\n  // è¿åä¸ä¸ªé¨ç½²äºéè¯¯æææºå¶çPromise\n  return p.catch(function(e) {\n    /* å¿½ç¥éè¯¯ï¼ç»§ç»­æ§è¡ */\n  }).then(function() {\n    return ret;\n  });\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nè½ç¶ Promise çåæ³æ¯åè°å½æ°çåæ³å¤§å¤§æ¹è¿ï¼ä½æ¯ä¸ç¼çä¸å»ï¼ä»£ç å®å¨é½æ¯ Promise ç APIï¼thenãcatchç­ç­ï¼ï¼æä½æ¬èº«çè¯­ä¹åèä¸å®¹æçåºæ¥ã\n\næ¥çæ¯ Generator å½æ°çåæ³ã\n\nfunction chainAnimationsGenerator(elem, animations) {\n\n  return spawn(function*() {\n    let ret = null;\n    try {\n      for(let anim of animations) {\n        ret = yield anim(elem);\n      }\n    } catch(e) {\n      /* å¿½ç¥éè¯¯ï¼ç»§ç»­æ§è¡ */\n    }\n    return ret;\n  });\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä½¿ç¨ Generator å½æ°éåäºæ¯ä¸ªå¨ç»ï¼è¯­ä¹æ¯ Promise åæ³æ´æ¸æ°ï¼ç¨æ·å®ä¹çæä½å¨é¨é½åºç°å¨spawnå½æ°çåé¨ãè¿ä¸ªåæ³çé®é¢å¨äºï¼å¿é¡»æä¸ä¸ªä»»å¡è¿è¡å¨ï¼èªå¨æ§è¡ Generator å½æ°ï¼ä¸é¢ä»£ç çspawnå½æ°å°±æ¯èªå¨æ§è¡å¨ï¼å®è¿åä¸ä¸ª Promise å¯¹è±¡ï¼èä¸å¿é¡»ä¿è¯yieldè¯­å¥åé¢çè¡¨è¾¾å¼ï¼å¿é¡»è¿åä¸ä¸ª Promiseã\n\næåæ¯ async å½æ°çåæ³ã\n\nasync function chainAnimationsAsync(elem, animations) {\n  let ret = null;\n  try {\n    for(let anim of animations) {\n      ret = await anim(elem);\n    }\n  } catch(e) {\n    /* å¿½ç¥éè¯¯ï¼ç»§ç»­æ§è¡ */\n  }\n  return ret;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¯ä»¥çå° Async å½æ°çå®ç°æç®æ´ï¼æç¬¦åè¯­ä¹ï¼å ä¹æ²¡æè¯­ä¹ä¸ç¸å³çä»£ç ãå®å° Generator åæ³ä¸­çèªå¨æ§è¡å¨ï¼æ¹å¨è¯­è¨å±é¢æä¾ï¼ä¸æ´é²ç»ç¨æ·ï¼å æ­¤ä»£ç éæå°ãå¦æä½¿ç¨ Generator åæ³ï¼èªå¨æ§è¡å¨éè¦ç¨æ·èªå·±æä¾ã\n\n\n# å®ä¾ï¼æé¡ºåºå®æå¼æ­¥æä½\n\nå®éå¼åä¸­ï¼ç»å¸¸éå°ä¸ç»å¼æ­¥æä½ï¼éè¦æç§é¡ºåºå®æãæ¯å¦ï¼ä¾æ¬¡è¿ç¨è¯»åä¸ç» URLï¼ç¶åæç§è¯»åçé¡ºåºè¾åºç»æã\n\nPromise çåæ³å¦ä¸ã\n\nfunction logInOrder(urls) {\n  // è¿ç¨è¯»åææURL\n  const textPromises = urls.map(url => {\n    return fetch(url).then(response => response.text());\n  });\n\n  // ææ¬¡åºè¾åº\n  textPromises.reduce((chain, textPromise) => {\n    return chain.then(() => textPromise)\n      .then(text => console.log(text));\n  }, Promise.resolve());\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä½¿ç¨fetchæ¹æ³ï¼åæ¶è¿ç¨è¯»åä¸ç» URLãæ¯ä¸ªfetchæä½é½è¿åä¸ä¸ª Promise å¯¹è±¡ï¼æ¾å¥textPromisesæ°ç»ãç¶åï¼reduceæ¹æ³ä¾æ¬¡å¤çæ¯ä¸ª Promise å¯¹è±¡ï¼ç¶åä½¿ç¨thenï¼å°ææ Promise å¯¹è±¡è¿èµ·æ¥ï¼å æ­¤å°±å¯ä»¥ä¾æ¬¡è¾åºç»æã\n\nè¿ç§åæ³ä¸å¤ªç´è§ï¼å¯è¯»æ§æ¯è¾å·®ãä¸é¢æ¯ async å½æ°å®ç°ã\n\nasync function logInOrder(urls) {\n  for (const url of urls) {\n    const response = await fetch(url);\n    console.log(await response.text());\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ç¡®å®å¤§å¤§ç®åï¼é®é¢æ¯ææè¿ç¨æä½é½æ¯ç»§åãåªæåä¸ä¸ª URL è¿åç»æï¼æä¼å»è¯»åä¸ä¸ä¸ª URLï¼è¿æ ·åæçå¾å·®ï¼éå¸¸æµªè´¹æ¶é´ãæä»¬éè¦çæ¯å¹¶åååºè¿ç¨è¯·æ±ã\n\nasync function logInOrder(urls) {\n  // å¹¶åè¯»åè¿ç¨URL\n  const textPromises = urls.map(async url => {\n    const response = await fetch(url);\n    return response.text();\n  });\n\n  // ææ¬¡åºè¾åº\n  for (const textPromise of textPromises) {\n    console.log(await textPromise);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼è½ç¶mapæ¹æ³çåæ°æ¯asyncå½æ°ï¼ä½å®æ¯å¹¶åæ§è¡çï¼å ä¸ºåªæasyncå½æ°åé¨æ¯ç»§åæ§è¡ï¼å¤é¨ä¸åå½±åãåé¢çfor..ofå¾ªç¯åé¨ä½¿ç¨äºawaitï¼å æ­¤å®ç°äºæé¡ºåºè¾åºã\n\n\n# é¡¶å± await\n\næ ¹æ®è¯­æ³è§æ ¼ï¼awaitå½ä»¤åªè½åºç°å¨ async å½æ°åé¨ï¼å¦åé½ä¼æ¥éã\n\n// æ¥é\nconst data = await fetch('https://api.example.com');\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼awaitå½ä»¤ç¬ç«ä½¿ç¨ï¼æ²¡ææ¾å¨ async å½æ°éé¢ï¼å°±ä¼æ¥éã\n\nç®åï¼æä¸ä¸ªè¯­æ³ææ¡ï¼åè®¸å¨æ¨¡åçé¡¶å±ç¬ç«ä½¿ç¨awaitå½ä»¤ãè¿ä¸ªææ¡çç®çï¼æ¯åç¨awaitè§£å³æ¨¡åå¼æ­¥å è½½çé®é¢ã\n\n// awaiting.js\nlet output;\nasync function main() {\n  const dynamic = await import(someMission);\n  const data = await fetch(url);\n  output = someProcess(dynamic.default, data);\n}\nmain();\nexport { output };\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¨¡åawaiting.jsçè¾åºå¼outputï¼åå³äºå¼æ­¥æä½ãæä»¬æå¼æ­¥æä½åè£å¨ä¸ä¸ª async å½æ°éé¢ï¼ç¶åè°ç¨è¿ä¸ªå½æ°ï¼åªæç­éé¢çå¼æ­¥æä½é½æ§è¡ï¼åéoutputæä¼æå¼ï¼å¦åå°±è¿åundefinedã\n\nä¸é¢çä»£ç ä¹å¯ä»¥åæç«å³æ§è¡å½æ°çå½¢å¼ã\n\n// awaiting.js\nlet output;\n(async function main() {\n  const dynamic = await import(someMission);\n  const data = await fetch(url);\n  output = someProcess(dynamic.default, data);\n})();\nexport { output };\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢æ¯å è½½è¿ä¸ªæ¨¡åçåæ³ã\n\n// usage.js\nimport { output } from \"./awaiting.js\";\n\nfunction outputPlusValue(value) { return output + value }\n\nconsole.log(outputPlusValue(100));\nsetTimeout(() => console.log(outputPlusValue(100), 1000);\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼outputPlusValue()çæ§è¡ç»æï¼å®å¨åå³äºæ§è¡çæ¶é´ãå¦æawaiting.jséé¢çå¼æ­¥æä½æ²¡æ§è¡å®ï¼å è½½è¿æ¥çoutputçå¼å°±æ¯undefinedã\n\nç®åçè§£å³æ¹æ³ï¼å°±æ¯è®©åå§æ¨¡åè¾åºä¸ä¸ª Promise å¯¹è±¡ï¼ä»è¿ä¸ª Promise å¯¹è±¡å¤æ­å¼æ­¥æä½ææ²¡æç»æã\n\n// awaiting.js\nlet output;\nexport default (async function main() {\n  const dynamic = await import(someMission);\n  const data = await fetch(url);\n  output = someProcess(dynamic.default, data);\n})();\nexport { output };\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼awaiting.jsé¤äºè¾åºoutputï¼è¿é»è®¤è¾åºä¸ä¸ª Promise å¯¹è±¡ï¼async å½æ°ç«å³æ§è¡åï¼è¿åä¸ä¸ª Promise å¯¹è±¡ï¼ï¼ä»è¿ä¸ªå¯¹è±¡å¤æ­å¼æ­¥æä½æ¯å¦ç»æã\n\nä¸é¢æ¯å è½½è¿ä¸ªæ¨¡åçæ°çåæ³ã\n\n// usage.js\nimport promise, { output } from \"./awaiting.js\";\n\nfunction outputPlusValue(value) { return output + value }\n\npromise.then(() => {\n  console.log(outputPlusValue(100));\n  setTimeout(() => console.log(outputPlusValue(100), 1000);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å°awaiting.jså¯¹è±¡çè¾åºï¼æ¾å¨promise.then()éé¢ï¼è¿æ ·å°±è½ä¿è¯å¼æ­¥æä½å®æä»¥åï¼æå»è¯»åoutputã\n\nè¿ç§åæ³æ¯è¾éº»ç¦ï¼ç­äºè¦æ±æ¨¡åçä½¿ç¨èéµå®ä¸ä¸ªé¢å¤çä½¿ç¨åè®®ï¼æç§ç¹æ®çæ¹æ³ä½¿ç¨è¿ä¸ªæ¨¡åãä¸æ¦ä½ å¿äºè¦ç¨ Promise å è½½ï¼åªä½¿ç¨æ­£å¸¸çå è½½æ¹æ³ï¼ä¾èµè¿ä¸ªæ¨¡åçä»£ç å°±å¯è½åºéãèä¸ï¼å¦æä¸é¢çusage.jsåæå¯¹å¤çè¾åºï¼ç­äºè¿ä¸ªä¾èµé¾çæææ¨¡åé½è¦ä½¿ç¨ Promise å è½½ã\n\né¡¶å±çawaitå½ä»¤ï¼å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢ãå®ä¿è¯åªæå¼æ­¥æä½å®æï¼æ¨¡åæä¼è¾åºå¼ã\n\n// awaiting.js\nconst dynamic = import(someMission);\nconst data = fetch(url);\nexport const output = someProcess((await dynamic).default, await data);\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸¤ä¸ªå¼æ­¥æä½å¨è¾åºçæ¶åï¼é½å ä¸äºawaitå½ä»¤ãåªæç­å°å¼æ­¥æä½å®æï¼è¿ä¸ªæ¨¡åæä¼è¾åºå¼ã\n\nå è½½è¿ä¸ªæ¨¡åçåæ³å¦ä¸ã\n\n// usage.js\nimport { output } from \"./awaiting.js\";\nfunction outputPlusValue(value) { return output + value }\n\nconsole.log(outputPlusValue(100));\nsetTimeout(() => console.log(outputPlusValue(100), 1000);\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çåæ³ï¼ä¸æ®éçæ¨¡åå è½½å®å¨ä¸æ ·ãä¹å°±æ¯è¯´ï¼æ¨¡åçä½¿ç¨èå®å¨ä¸ç¨å³å¿ï¼ä¾èµæ¨¡åçåé¨ææ²¡æå¼æ­¥æä½ï¼æ­£å¸¸å è½½å³å¯ã\n\nè¿æ¶ï¼æ¨¡åçå è½½ä¼ç­å¾ä¾èµæ¨¡åï¼ä¸ä¾æ¯awaiting.jsï¼çå¼æ­¥æä½å®æï¼ææ§è¡åé¢çä»£ç ï¼æç¹åæåå¨é£éãæä»¥ï¼å®æ»æ¯ä¼å¾å°æ­£ç¡®çoutputï¼ä¸ä¼å ä¸ºå è½½æ¶æºçä¸åï¼èå¾å°ä¸ä¸æ ·çå¼ã\n\nä¸é¢æ¯é¡¶å±awaitçä¸äºä½¿ç¨åºæ¯ã\n\n// import() æ¹æ³å è½½\nconst strings = await import(`/i18n/${navigator.language}`);\n\n// æ°æ®åºæä½\nconst connection = await dbConnector();\n\n// ä¾èµåæ»\nlet jQuery;\ntry {\n  jQuery = await import('https://cdn-a.com/jQuery');\n} catch {\n  jQuery = await import('https://cdn-b.com/jQuery');\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\næ³¨æï¼å¦æå è½½å¤ä¸ªåå«é¡¶å±awaitå½ä»¤çæ¨¡åï¼å è½½å½ä»¤æ¯åæ­¥æ§è¡çã\n\n// x.js\nconsole.log(\"X1\");\nawait new Promise(r => setTimeout(r, 1000));\nconsole.log(\"X2\");\n\n// y.js\nconsole.log(\"Y\");\n\n// z.js\nimport \"./x.js\";\nimport \"./y.js\";\nconsole.log(\"Z\");\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç æä¸ä¸ªæ¨¡åï¼æåçz.jså è½½x.jsåy.jsï¼æå°ç»ææ¯X1ãYãX2ãZãè¿è¯´æï¼z.jså¹¶æ²¡æç­å¾x.jså è½½å®æï¼åå»å è½½y.jsã\n\né¡¶å±çawaitå½ä»¤æç¹åï¼äº¤åºä»£ç çæ§è¡æç»å¶ä»çæ¨¡åå è½½ï¼ç­å¼æ­¥æä½å®æåï¼åæ¿åæ§è¡æï¼ç»§ç»­åä¸æ§è¡ã",normalizedContent:"# async å½æ°\n\n\n# å«ä¹\n\nes2017 æ åå¼å¥äº async å½æ°ï¼ä½¿å¾å¼æ­¥æä½åå¾æ´å æ¹ä¾¿ã\n\nasync å½æ°æ¯ä»ä¹ï¼ä¸å¥è¯ï¼å®å°±æ¯ generator å½æ°çè¯­æ³ç³ã\n\nåææä¸ä¸ª generator å½æ°ï¼ä¾æ¬¡è¯»åä¸¤ä¸ªæä»¶ã\n\nconst fs = require('fs');\n\nconst readfile = function (filename) {\n  return new promise(function (resolve, reject) {\n    fs.readfile(filename, function(error, data) {\n      if (error) return reject(error);\n      resolve(data);\n    });\n  });\n};\n\nconst gen = function* () {\n  const f1 = yield readfile('/etc/fstab');\n  const f2 = yield readfile('/etc/shells');\n  console.log(f1.tostring());\n  console.log(f2.tostring());\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç çå½æ°genå¯ä»¥åæasyncå½æ°ï¼å°±æ¯ä¸é¢è¿æ ·ã\n\nconst asyncreadfile = async function () {\n  const f1 = await readfile('/etc/fstab');\n  const f2 = await readfile('/etc/shells');\n  console.log(f1.tostring());\n  console.log(f2.tostring());\n};\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸æ¯è¾å°±ä¼åç°ï¼asyncå½æ°å°±æ¯å° generator å½æ°çæå·ï¼*ï¼æ¿æ¢æasyncï¼å°yieldæ¿æ¢æawaitï¼ä»æ­¤èå·²ã\n\nasyncå½æ°å¯¹ generator å½æ°çæ¹è¿ï¼ä½ç°å¨ä»¥ä¸åç¹ã\n\nï¼1ï¼åç½®æ§è¡å¨ã\n\ngenerator å½æ°çæ§è¡å¿é¡»é æ§è¡å¨ï¼æä»¥ææäºcoæ¨¡åï¼èasyncå½æ°èªå¸¦æ§è¡å¨ãä¹å°±æ¯è¯´ï¼asyncå½æ°çæ§è¡ï¼ä¸æ®éå½æ°ä¸æ¨¡ä¸æ ·ï¼åªè¦ä¸è¡ã\n\nasyncreadfile();\n\n\n1\n\n\nä¸é¢çä»£ç è°ç¨äºasyncreadfileå½æ°ï¼ç¶åå®å°±ä¼èªå¨æ§è¡ï¼è¾åºæåç»æãè¿å®å¨ä¸å generator å½æ°ï¼éè¦è°ç¨nextæ¹æ³ï¼æèç¨coæ¨¡åï¼æè½çæ­£æ§è¡ï¼å¾å°æåç»æã\n\nï¼2ï¼æ´å¥½çè¯­ä¹ã\n\nasyncåawaitï¼æ¯èµ·æå·åyieldï¼è¯­ä¹æ´æ¸æ¥äºãasyncè¡¨ç¤ºå½æ°éæå¼æ­¥æä½ï¼awaitè¡¨ç¤ºç´§è·å¨åé¢çè¡¨è¾¾å¼éè¦ç­å¾ç»æã\n\nï¼3ï¼æ´å¹¿çéç¨æ§ã\n\ncoæ¨¡åçº¦å®ï¼yieldå½ä»¤åé¢åªè½æ¯ thunk å½æ°æ promise å¯¹è±¡ï¼èasyncå½æ°çawaitå½ä»¤åé¢ï¼å¯ä»¥æ¯ promise å¯¹è±¡ååå§ç±»åçå¼ï¼æ°å¼ãå­ç¬¦ä¸²åå¸å°å¼ï¼ä½è¿æ¶ä¼èªå¨è½¬æç«å³ resolved ç promise å¯¹è±¡ï¼ã\n\nï¼4ï¼è¿åå¼æ¯ promiseã\n\nasyncå½æ°çè¿åå¼æ¯ promise å¯¹è±¡ï¼è¿æ¯ generator å½æ°çè¿åå¼æ¯ iterator å¯¹è±¡æ¹ä¾¿å¤äºãä½ å¯ä»¥ç¨thenæ¹æ³æå®ä¸ä¸æ­¥çæä½ã\n\nè¿ä¸æ­¥è¯´ï¼asyncå½æ°å®å¨å¯ä»¥çä½å¤ä¸ªå¼æ­¥æä½ï¼åè£æçä¸ä¸ª promise å¯¹è±¡ï¼èawaitå½ä»¤å°±æ¯åé¨thenå½ä»¤çè¯­æ³ç³ã\n\n\n# åºæ¬ç¨æ³\n\nasyncå½æ°è¿åä¸ä¸ª promise å¯¹è±¡ï¼å¯ä»¥ä½¿ç¨thenæ¹æ³æ·»å åè°å½æ°ãå½å½æ°æ§è¡çæ¶åï¼ä¸æ¦éå°awaitå°±ä¼åè¿åï¼ç­å°å¼æ­¥æä½å®æï¼åæ¥çæ§è¡å½æ°ä½ååé¢çè¯­å¥ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nasync function getstockpricebyname(name) {\n  const symbol = await getstocksymbol(name);\n  const stockprice = await getstockprice(symbol);\n  return stockprice;\n}\n\ngetstockpricebyname('goog').then(function (result) {\n  console.log(result);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç æ¯ä¸ä¸ªè·åè¡ç¥¨æ¥ä»·çå½æ°ï¼å½æ°åé¢çasyncå³é®å­ï¼è¡¨æè¯¥å½æ°åé¨æå¼æ­¥æä½ãè°ç¨è¯¥å½æ°æ¶ï¼ä¼ç«å³è¿åä¸ä¸ªpromiseå¯¹è±¡ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ï¼æå®å¤å°æ¯«ç§åè¾åºä¸ä¸ªå¼ã\n\nfunction timeout(ms) {\n  return new promise((resolve) => {\n    settimeout(resolve, ms);\n  });\n}\n\nasync function asyncprint(value, ms) {\n  await timeout(ms);\n  console.log(value);\n}\n\nasyncprint('hello world', 50);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç æå® 50 æ¯«ç§ä»¥åï¼è¾åºhello worldã\n\nç±äºasyncå½æ°è¿åçæ¯ promise å¯¹è±¡ï¼å¯ä»¥ä½ä¸ºawaitå½ä»¤çåæ°ãæä»¥ï¼ä¸é¢çä¾å­ä¹å¯ä»¥åæä¸é¢çå½¢å¼ã\n\nasync function timeout(ms) {\n  await new promise((resolve) => {\n    settimeout(resolve, ms);\n  });\n}\n\nasync function asyncprint(value, ms) {\n  await timeout(ms);\n  console.log(value);\n}\n\nasyncprint('hello world', 50);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nasync å½æ°æå¤ç§ä½¿ç¨å½¢å¼ã\n\n// å½æ°å£°æ\nasync function foo() {}\n\n// å½æ°è¡¨è¾¾å¼\nconst foo = async function () {};\n\n// å¯¹è±¡çæ¹æ³\nlet obj = { async foo() {} };\nobj.foo().then(...)\n\n// class çæ¹æ³\nclass storage {\n  constructor() {\n    this.cachepromise = caches.open('avatars');\n  }\n\n  async getavatar(name) {\n    const cache = await this.cachepromise;\n    return cache.match(`/avatars/${name}.jpg`);\n  }\n}\n\nconst storage = new storage();\nstorage.getavatar('jake').then(â¦);\n\n// ç®­å¤´å½æ°\nconst foo = async () => {};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n\n\n\n# è¯­æ³\n\nasyncå½æ°çè¯­æ³è§åæ»ä½ä¸æ¯è¾ç®åï¼é¾ç¹æ¯éè¯¯å¤çæºå¶ã\n\n\n# è¿å promise å¯¹è±¡\n\nasyncå½æ°è¿åä¸ä¸ª promise å¯¹è±¡ã\n\nasyncå½æ°åé¨returnè¯­å¥è¿åçå¼ï¼ä¼æä¸ºthenæ¹æ³åè°å½æ°çåæ°ã\n\nasync function f() {\n  return 'hello world';\n}\n\nf().then(v => console.log(v))\n// \"hello world\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fåé¨returnå½ä»¤è¿åçå¼ï¼ä¼è¢«thenæ¹æ³åè°å½æ°æ¥æ¶å°ã\n\nasyncå½æ°åé¨æåºéè¯¯ï¼ä¼å¯¼è´è¿åç promise å¯¹è±¡åä¸ºrejectç¶æãæåºçéè¯¯å¯¹è±¡ä¼è¢«catchæ¹æ³åè°å½æ°æ¥æ¶å°ã\n\nasync function f() {\n  throw new error('åºéäº');\n}\n\nf().then(\n  v => console.log(v),\n  e => console.log(e)\n)\n// error: åºéäº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# promise å¯¹è±¡çç¶æåå\n\nasyncå½æ°è¿åç promise å¯¹è±¡ï¼å¿é¡»ç­å°åé¨ææawaitå½ä»¤åé¢ç promise å¯¹è±¡æ§è¡å®ï¼æä¼åçç¶ææ¹åï¼é¤ééå°returnè¯­å¥æèæåºéè¯¯ãä¹å°±æ¯è¯´ï¼åªæasyncå½æ°åé¨çå¼æ­¥æä½æ§è¡å®ï¼æä¼æ§è¡thenæ¹æ³æå®çåè°å½æ°ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nasync function gettitle(url) {\n  let response = await fetch(url);\n  let html = await response.text();\n  return html.match(/<title>([\\s\\s]+)<\\/title>/i)[1];\n}\ngettitle('https://tc39.github.io/ecma262/').then(console.log)\n// \"ecmascript 2017 language specification\"\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°gettitleåé¨æä¸ä¸ªæä½ï¼æåç½é¡µãååºææ¬ãå¹éé¡µé¢æ é¢ãåªæè¿ä¸ä¸ªæä½å¨é¨å®æï¼æä¼æ§è¡thenæ¹æ³éé¢çconsole.logã\n\n\n# await å½ä»¤\n\næ­£å¸¸æåµä¸ï¼awaitå½ä»¤åé¢æ¯ä¸ä¸ª promise å¯¹è±¡ï¼è¿åè¯¥å¯¹è±¡çç»æãå¦æä¸æ¯ promise å¯¹è±¡ï¼å°±ç´æ¥è¿åå¯¹åºçå¼ã\n\nasync function f() {\n  // ç­åäº\n  // return 123;\n  return await 123;\n}\n\nf().then(v => console.log(v))\n// 123\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼awaitå½ä»¤çåæ°æ¯æ°å¼123ï¼è¿æ¶ç­åäºreturn 123ã\n\nå¦ä¸ç§æåµæ¯ï¼awaitå½ä»¤åé¢æ¯ä¸ä¸ªthenableå¯¹è±¡ï¼å³å®ä¹thenæ¹æ³çå¯¹è±¡ï¼ï¼é£ä¹awaitä¼å°å¶ç­åäº promise å¯¹è±¡ã\n\nclass sleep {\n  constructor(timeout) {\n    this.timeout = timeout;\n  }\n  then(resolve, reject) {\n    const starttime = date.now();\n    settimeout(\n      () => resolve(date.now() - starttime),\n      this.timeout\n    );\n  }\n}\n\n(async () => {\n  const sleeptime = await new sleep(1000);\n  console.log(sleeptime);\n})();\n// 1000\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä¸é¢ä»£ç ä¸­ï¼awaitå½ä»¤åé¢æ¯ä¸ä¸ªsleepå¯¹è±¡çå®ä¾ãè¿ä¸ªå®ä¾ä¸æ¯ promise å¯¹è±¡ï¼ä½æ¯å ä¸ºå®ä¹äºthenæ¹æ³ï¼awaitä¼å°å¶è§ä¸ºpromiseå¤çã\n\nè¿ä¸ªä¾å­è¿æ¼ç¤ºäºå¦ä½å®ç°ä¼ç ææãjavascript ä¸ç´æ²¡æä¼ç çè¯­æ³ï¼ä½æ¯åå©awaitå½ä»¤å°±å¯ä»¥è®©ç¨åºåé¡¿æå®çæ¶é´ãä¸é¢ç»åºäºä¸ä¸ªç®åçsleepå®ç°ã\n\nfunction sleep(interval) {\n  return new promise(resolve => {\n    settimeout(resolve, interval);\n  })\n}\n\n// ç¨æ³\nasync function one2fiveinasync() {\n  for(let i = 1; i <= 5; i++) {\n    console.log(i);\n    await sleep(1000);\n  }\n}\n\none2fiveinasync();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nawaitå½ä»¤åé¢ç promise å¯¹è±¡å¦æåä¸ºrejectç¶æï¼årejectçåæ°ä¼è¢«catchæ¹æ³çåè°å½æ°æ¥æ¶å°ã\n\nasync function f() {\n  await promise.reject('åºéäº');\n}\n\nf()\n.then(v => console.log(v))\n.catch(e => console.log(e))\n// åºéäº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næ³¨æï¼ä¸é¢ä»£ç ä¸­ï¼awaitè¯­å¥åé¢æ²¡æreturnï¼ä½æ¯rejectæ¹æ³çåæ°ä¾ç¶ä¼ å¥äºcatchæ¹æ³çåè°å½æ°ãè¿éå¦æå¨awaitåé¢å ä¸returnï¼æææ¯ä¸æ ·çã\n\nä»»ä½ä¸ä¸ªawaitè¯­å¥åé¢ç promise å¯¹è±¡åä¸ºrejectç¶æï¼é£ä¹æ´ä¸ªasyncå½æ°é½ä¼ä¸­æ­æ§è¡ã\n\nasync function f() {\n  await promise.reject('åºéäº');\n  await promise.resolve('hello world'); // ä¸ä¼æ§è¡\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬äºä¸ªawaitè¯­å¥æ¯ä¸ä¼æ§è¡çï¼å ä¸ºç¬¬ä¸ä¸ªawaitè¯­å¥ç¶æåæäºrejectã\n\nææ¶ï¼æä»¬å¸æå³ä½¿åä¸ä¸ªå¼æ­¥æä½å¤±è´¥ï¼ä¹ä¸è¦ä¸­æ­åé¢çå¼æ­¥æä½ãè¿æ¶å¯ä»¥å°ç¬¬ä¸ä¸ªawaitæ¾å¨try...catchç»æéé¢ï¼è¿æ ·ä¸ç®¡è¿ä¸ªå¼æ­¥æä½æ¯å¦æåï¼ç¬¬äºä¸ªawaité½ä¼æ§è¡ã\n\nasync function f() {\n  try {\n    await promise.reject('åºéäº');\n  } catch(e) {\n  }\n  return await promise.resolve('hello world');\n}\n\nf()\n.then(v => console.log(v))\n// hello world\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¦ä¸ç§æ¹æ³æ¯awaitåé¢ç promise å¯¹è±¡åè·ä¸ä¸ªcatchæ¹æ³ï¼å¤çåé¢å¯è½åºç°çéè¯¯ã\n\nasync function f() {\n  await promise.reject('åºéäº')\n    .catch(e => console.log(e));\n  return await promise.resolve('hello world');\n}\n\nf()\n.then(v => console.log(v))\n// åºéäº\n// hello world\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# éè¯¯å¤ç\n\nå¦æawaitåé¢çå¼æ­¥æä½åºéï¼é£ä¹ç­åäºasyncå½æ°è¿åç promise å¯¹è±¡è¢«rejectã\n\nasync function f() {\n  await new promise(function (resolve, reject) {\n    throw new error('åºéäº');\n  });\n}\n\nf()\n.then(v => console.log(v))\n.catch(e => console.log(e))\n// errorï¼åºéäº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼asyncå½æ°fæ§è¡åï¼awaitåé¢ç promise å¯¹è±¡ä¼æåºä¸ä¸ªéè¯¯å¯¹è±¡ï¼å¯¼è´catchæ¹æ³çåè°å½æ°è¢«è°ç¨ï¼å®çåæ°å°±æ¯æåºçéè¯¯å¯¹è±¡ãå·ä½çæ§è¡æºå¶ï¼å¯ä»¥åèåæçâasync å½æ°çå®ç°åçâã\n\né²æ­¢åºéçæ¹æ³ï¼ä¹æ¯å°å¶æ¾å¨try...catchä»£ç åä¹ä¸­ã\n\nasync function f() {\n  try {\n    await new promise(function (resolve, reject) {\n      throw new error('åºéäº');\n    });\n  } catch(e) {\n  }\n  return await('hello world');\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦ææå¤ä¸ªawaitå½ä»¤ï¼å¯ä»¥ç»ä¸æ¾å¨try...catchç»æä¸­ã\n\nasync function main() {\n  try {\n    const val1 = await firststep();\n    const val2 = await secondstep(val1);\n    const val3 = await thirdstep(val1, val2);\n\n    console.log('final: ', val3);\n  }\n  catch (err) {\n    console.error(err);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢çä¾å­ä½¿ç¨try...catchç»æï¼å®ç°å¤æ¬¡éå¤å°è¯ã\n\nconst superagent = require('superagent');\nconst num_retries = 3;\n\nasync function test() {\n  let i;\n  for (i = 0; i < num_retries; ++i) {\n    try {\n      await superagent.get('http://google.com/this-throws-an-error');\n      break;\n    } catch(err) {}\n  }\n  console.log(i); // 3\n}\n\ntest();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æawaitæä½æåï¼å°±ä¼ä½¿ç¨breakè¯­å¥éåºå¾ªç¯ï¼å¦æå¤±è´¥ï¼ä¼è¢«catchè¯­å¥ææï¼ç¶åè¿å¥ä¸ä¸è½®å¾ªç¯ã\n\n\n# ä½¿ç¨æ³¨æç¹\n\nç¬¬ä¸ç¹ï¼åé¢å·²ç»è¯´è¿ï¼awaitå½ä»¤åé¢çpromiseå¯¹è±¡ï¼è¿è¡ç»æå¯è½æ¯rejectedï¼æä»¥æå¥½æawaitå½ä»¤æ¾å¨try...catchä»£ç åä¸­ã\n\nasync function myfunction() {\n  try {\n    await somethingthatreturnsapromise();\n  } catch (err) {\n    console.log(err);\n  }\n}\n\n// å¦ä¸ç§åæ³\n\nasync function myfunction() {\n  await somethingthatreturnsapromise()\n  .catch(function (err) {\n    console.log(err);\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nç¬¬äºç¹ï¼å¤ä¸ªawaitå½ä»¤åé¢çå¼æ­¥æä½ï¼å¦æä¸å­å¨ç»§åå³ç³»ï¼æå¥½è®©å®ä»¬åæ¶è§¦åï¼å¹¶åï¼ã\n\nlet foo = await getfoo();\nlet bar = await getbar();\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼getfooågetbaræ¯ä¸¤ä¸ªç¬ç«çå¼æ­¥æä½ï¼å³äºä¸ä¾èµï¼ï¼è¢«åæç»§åå³ç³»ãè¿æ ·æ¯è¾èæ¶ï¼å ä¸ºåªægetfooå®æä»¥åï¼æä¼æ§è¡getbarï¼å®å¨å¯ä»¥è®©å®ä»¬åæ¶è§¦åã\n\n// åæ³ä¸\nlet [foo, bar] = await promise.all([getfoo(), getbar()]);\n\n// åæ³äº\nlet foopromise = getfoo();\nlet barpromise = getbar();\nlet foo = await foopromise;\nlet bar = await barpromise;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä¸¤ç§åæ³ï¼getfooågetbaré½æ¯åæ¶è§¦åï¼è¿æ ·å°±ä¼ç¼©ç­ç¨åºçæ§è¡æ¶é´ã\n\nç¬¬ä¸ç¹ï¼awaitå½ä»¤åªè½ç¨å¨asyncå½æ°ä¹ä¸­ï¼å¦æç¨å¨æ®éå½æ°ï¼å°±ä¼æ¥éã\n\nasync function dbfuc(db) {\n  let docs = [{}, {}, {}];\n\n  // æ¥é\n  docs.foreach(function (doc) {\n    await db.post(doc);\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¼æ¥éï¼å ä¸ºawaitç¨å¨æ®éå½æ°ä¹ä¸­äºãä½æ¯ï¼å¦æå°foreachæ¹æ³çåæ°æ¹æasyncå½æ°ï¼ä¹æé®é¢ã\n\nfunction dbfuc(db) { //è¿éä¸éè¦ async\n  let docs = [{}, {}, {}];\n\n  // å¯è½å¾å°éè¯¯ç»æ\n  docs.foreach(async function (doc) {\n    await db.post(doc);\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç å¯è½ä¸ä¼æ­£å¸¸å·¥ä½ï¼åå æ¯è¿æ¶ä¸ä¸ªdb.postæä½å°æ¯å¹¶åæ§è¡ï¼ä¹å°±æ¯åæ¶æ§è¡ï¼èä¸æ¯ç»§åæ§è¡ãæ­£ç¡®çåæ³æ¯éç¨forå¾ªç¯ã\n\nasync function dbfuc(db) {\n  let docs = [{}, {}, {}];\n\n  for (let doc of docs) {\n    await db.post(doc);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦æç¡®å®å¸æå¤ä¸ªè¯·æ±å¹¶åæ§è¡ï¼å¯ä»¥ä½¿ç¨promise.allæ¹æ³ãå½ä¸ä¸ªè¯·æ±é½ä¼resolvedæ¶ï¼ä¸é¢ä¸¤ç§åæ³ææç¸åã\n\nasync function dbfuc(db) {\n  let docs = [{}, {}, {}];\n  let promises = docs.map((doc) => db.post(doc));\n\n  let results = await promise.all(promises);\n  console.log(results);\n}\n\n// æèä½¿ç¨ä¸é¢çåæ³\n\nasync function dbfuc(db) {\n  let docs = [{}, {}, {}];\n  let promises = docs.map((doc) => db.post(doc));\n\n  let results = [];\n  for (let promise of promises) {\n    results.push(await promise);\n  }\n  console.log(results);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nç¬¬åç¹ï¼async å½æ°å¯ä»¥ä¿çè¿è¡å æ ã\n\nconst a = () => {\n  b().then(() => c());\n};\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°aåé¨è¿è¡äºä¸ä¸ªå¼æ­¥ä»»å¡b()ãå½b()è¿è¡çæ¶åï¼å½æ°a()ä¸ä¼ä¸­æ­ï¼èæ¯ç»§ç»­æ§è¡ãç­å°b()è¿è¡ç»æï¼å¯è½a()æ©å°±è¿è¡ç»æäºï¼b()æå¨çä¸ä¸æç¯å¢å·²ç»æ¶å¤±äºãå¦æb()æc()æ¥éï¼éè¯¯å æ å°ä¸åæ¬a()ã\n\nç°å¨å°è¿ä¸ªä¾å­æ¹æasyncå½æ°ã\n\nconst a = async () => {\n  await b();\n  c();\n};\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼b()è¿è¡çæ¶åï¼a()æ¯æåæ§è¡ï¼ä¸ä¸æç¯å¢é½ä¿å­çãä¸æ¦b()æc()æ¥éï¼éè¯¯å æ å°åæ¬a()ã\n\n\n# async å½æ°çå®ç°åç\n\nasync å½æ°çå®ç°åç**ï¼å°±æ¯å° generator å½æ°åèªå¨æ§è¡å¨ï¼åè£å¨ä¸ä¸ªå½æ°é**ã\n\nasync function fn(args) {\n  // ...\n}\n\n// ç­åäº\n\nfunction fn(args) {\n  return spawn(function* () {\n    // ...\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nææçasyncå½æ°é½å¯ä»¥åæä¸é¢çç¬¬äºç§å½¢å¼ï¼å¶ä¸­çspawnå½æ°å°±æ¯èªå¨æ§è¡å¨ã\n\nä¸é¢ç»åºspawnå½æ°çå®ç°ï¼åºæ¬å°±æ¯åæèªå¨æ§è¡å¨çç¿»çã\n\nfunction spawn(genf) {\n  return new promise(function(resolve, reject) {\n    const gen = genf();\n    function step(nextf) {\n      let next;\n      try {\n        next = nextf();\n      } catch(e) {\n        return reject(e);\n      }\n      if(next.done) {\n        return resolve(next.value);\n      }\n      promise.resolve(next.value).then(function(v) {\n        step(function() { return gen.next(v); });\n      }, function(e) {\n        step(function() { return gen.throw(e); });\n      });\n    }\n    step(function() { return gen.next(undefined); });\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\n\n# ä¸å¶ä»å¼æ­¥å¤çæ¹æ³çæ¯è¾\n\næä»¬éè¿ä¸ä¸ªä¾å­ï¼æ¥ç async å½æ°ä¸ promiseãgenerator å½æ°çæ¯è¾ã\n\nåå®æä¸ª dom åç´ ä¸é¢ï¼é¨ç½²äºä¸ç³»åçå¨ç»ï¼åä¸ä¸ªå¨ç»ç»æï¼æè½å¼å§åä¸ä¸ªãå¦æå½ä¸­æä¸ä¸ªå¨ç»åºéï¼å°±ä¸åå¾ä¸æ§è¡ï¼è¿åä¸ä¸ä¸ªæåæ§è¡çå¨ç»çè¿åå¼ã\n\né¦åæ¯ promise çåæ³ã\n\nfunction chainanimationspromise(elem, animations) {\n\n  // åéretç¨æ¥ä¿å­ä¸ä¸ä¸ªå¨ç»çè¿åå¼\n  let ret = null;\n\n  // æ°å»ºä¸ä¸ªç©ºçpromise\n  let p = promise.resolve();\n\n  // ä½¿ç¨thenæ¹æ³ï¼æ·»å ææå¨ç»\n  for(let anim of animations) {\n    p = p.then(function(val) {\n      ret = val;\n      return anim(elem);\n    });\n  }\n\n  // è¿åä¸ä¸ªé¨ç½²äºéè¯¯æææºå¶çpromise\n  return p.catch(function(e) {\n    /* å¿½ç¥éè¯¯ï¼ç»§ç»­æ§è¡ */\n  }).then(function() {\n    return ret;\n  });\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nè½ç¶ promise çåæ³æ¯åè°å½æ°çåæ³å¤§å¤§æ¹è¿ï¼ä½æ¯ä¸ç¼çä¸å»ï¼ä»£ç å®å¨é½æ¯ promise ç apiï¼thenãcatchç­ç­ï¼ï¼æä½æ¬èº«çè¯­ä¹åèä¸å®¹æçåºæ¥ã\n\næ¥çæ¯ generator å½æ°çåæ³ã\n\nfunction chainanimationsgenerator(elem, animations) {\n\n  return spawn(function*() {\n    let ret = null;\n    try {\n      for(let anim of animations) {\n        ret = yield anim(elem);\n      }\n    } catch(e) {\n      /* å¿½ç¥éè¯¯ï¼ç»§ç»­æ§è¡ */\n    }\n    return ret;\n  });\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä½¿ç¨ generator å½æ°éåäºæ¯ä¸ªå¨ç»ï¼è¯­ä¹æ¯ promise åæ³æ´æ¸æ°ï¼ç¨æ·å®ä¹çæä½å¨é¨é½åºç°å¨spawnå½æ°çåé¨ãè¿ä¸ªåæ³çé®é¢å¨äºï¼å¿é¡»æä¸ä¸ªä»»å¡è¿è¡å¨ï¼èªå¨æ§è¡ generator å½æ°ï¼ä¸é¢ä»£ç çspawnå½æ°å°±æ¯èªå¨æ§è¡å¨ï¼å®è¿åä¸ä¸ª promise å¯¹è±¡ï¼èä¸å¿é¡»ä¿è¯yieldè¯­å¥åé¢çè¡¨è¾¾å¼ï¼å¿é¡»è¿åä¸ä¸ª promiseã\n\næåæ¯ async å½æ°çåæ³ã\n\nasync function chainanimationsasync(elem, animations) {\n  let ret = null;\n  try {\n    for(let anim of animations) {\n      ret = await anim(elem);\n    }\n  } catch(e) {\n    /* å¿½ç¥éè¯¯ï¼ç»§ç»­æ§è¡ */\n  }\n  return ret;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¯ä»¥çå° async å½æ°çå®ç°æç®æ´ï¼æç¬¦åè¯­ä¹ï¼å ä¹æ²¡æè¯­ä¹ä¸ç¸å³çä»£ç ãå®å° generator åæ³ä¸­çèªå¨æ§è¡å¨ï¼æ¹å¨è¯­è¨å±é¢æä¾ï¼ä¸æ´é²ç»ç¨æ·ï¼å æ­¤ä»£ç éæå°ãå¦æä½¿ç¨ generator åæ³ï¼èªå¨æ§è¡å¨éè¦ç¨æ·èªå·±æä¾ã\n\n\n# å®ä¾ï¼æé¡ºåºå®æå¼æ­¥æä½\n\nå®éå¼åä¸­ï¼ç»å¸¸éå°ä¸ç»å¼æ­¥æä½ï¼éè¦æç§é¡ºåºå®æãæ¯å¦ï¼ä¾æ¬¡è¿ç¨è¯»åä¸ç» urlï¼ç¶åæç§è¯»åçé¡ºåºè¾åºç»æã\n\npromise çåæ³å¦ä¸ã\n\nfunction loginorder(urls) {\n  // è¿ç¨è¯»åææurl\n  const textpromises = urls.map(url => {\n    return fetch(url).then(response => response.text());\n  });\n\n  // ææ¬¡åºè¾åº\n  textpromises.reduce((chain, textpromise) => {\n    return chain.then(() => textpromise)\n      .then(text => console.log(text));\n  }, promise.resolve());\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä½¿ç¨fetchæ¹æ³ï¼åæ¶è¿ç¨è¯»åä¸ç» urlãæ¯ä¸ªfetchæä½é½è¿åä¸ä¸ª promise å¯¹è±¡ï¼æ¾å¥textpromisesæ°ç»ãç¶åï¼reduceæ¹æ³ä¾æ¬¡å¤çæ¯ä¸ª promise å¯¹è±¡ï¼ç¶åä½¿ç¨thenï¼å°ææ promise å¯¹è±¡è¿èµ·æ¥ï¼å æ­¤å°±å¯ä»¥ä¾æ¬¡è¾åºç»æã\n\nè¿ç§åæ³ä¸å¤ªç´è§ï¼å¯è¯»æ§æ¯è¾å·®ãä¸é¢æ¯ async å½æ°å®ç°ã\n\nasync function loginorder(urls) {\n  for (const url of urls) {\n    const response = await fetch(url);\n    console.log(await response.text());\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ç¡®å®å¤§å¤§ç®åï¼é®é¢æ¯ææè¿ç¨æä½é½æ¯ç»§åãåªæåä¸ä¸ª url è¿åç»æï¼æä¼å»è¯»åä¸ä¸ä¸ª urlï¼è¿æ ·åæçå¾å·®ï¼éå¸¸æµªè´¹æ¶é´ãæä»¬éè¦çæ¯å¹¶åååºè¿ç¨è¯·æ±ã\n\nasync function loginorder(urls) {\n  // å¹¶åè¯»åè¿ç¨url\n  const textpromises = urls.map(async url => {\n    const response = await fetch(url);\n    return response.text();\n  });\n\n  // ææ¬¡åºè¾åº\n  for (const textpromise of textpromises) {\n    console.log(await textpromise);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼è½ç¶mapæ¹æ³çåæ°æ¯asyncå½æ°ï¼ä½å®æ¯å¹¶åæ§è¡çï¼å ä¸ºåªæasyncå½æ°åé¨æ¯ç»§åæ§è¡ï¼å¤é¨ä¸åå½±åãåé¢çfor..ofå¾ªç¯åé¨ä½¿ç¨äºawaitï¼å æ­¤å®ç°äºæé¡ºåºè¾åºã\n\n\n# é¡¶å± await\n\næ ¹æ®è¯­æ³è§æ ¼ï¼awaitå½ä»¤åªè½åºç°å¨ async å½æ°åé¨ï¼å¦åé½ä¼æ¥éã\n\n// æ¥é\nconst data = await fetch('https://api.example.com');\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼awaitå½ä»¤ç¬ç«ä½¿ç¨ï¼æ²¡ææ¾å¨ async å½æ°éé¢ï¼å°±ä¼æ¥éã\n\nç®åï¼æä¸ä¸ªè¯­æ³ææ¡ï¼åè®¸å¨æ¨¡åçé¡¶å±ç¬ç«ä½¿ç¨awaitå½ä»¤ãè¿ä¸ªææ¡çç®çï¼æ¯åç¨awaitè§£å³æ¨¡åå¼æ­¥å è½½çé®é¢ã\n\n// awaiting.js\nlet output;\nasync function main() {\n  const dynamic = await import(somemission);\n  const data = await fetch(url);\n  output = someprocess(dynamic.default, data);\n}\nmain();\nexport { output };\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¨¡åawaiting.jsçè¾åºå¼outputï¼åå³äºå¼æ­¥æä½ãæä»¬æå¼æ­¥æä½åè£å¨ä¸ä¸ª async å½æ°éé¢ï¼ç¶åè°ç¨è¿ä¸ªå½æ°ï¼åªæç­éé¢çå¼æ­¥æä½é½æ§è¡ï¼åéoutputæä¼æå¼ï¼å¦åå°±è¿åundefinedã\n\nä¸é¢çä»£ç ä¹å¯ä»¥åæç«å³æ§è¡å½æ°çå½¢å¼ã\n\n// awaiting.js\nlet output;\n(async function main() {\n  const dynamic = await import(somemission);\n  const data = await fetch(url);\n  output = someprocess(dynamic.default, data);\n})();\nexport { output };\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢æ¯å è½½è¿ä¸ªæ¨¡åçåæ³ã\n\n// usage.js\nimport { output } from \"./awaiting.js\";\n\nfunction outputplusvalue(value) { return output + value }\n\nconsole.log(outputplusvalue(100));\nsettimeout(() => console.log(outputplusvalue(100), 1000);\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼outputplusvalue()çæ§è¡ç»æï¼å®å¨åå³äºæ§è¡çæ¶é´ãå¦æawaiting.jséé¢çå¼æ­¥æä½æ²¡æ§è¡å®ï¼å è½½è¿æ¥çoutputçå¼å°±æ¯undefinedã\n\nç®åçè§£å³æ¹æ³ï¼å°±æ¯è®©åå§æ¨¡åè¾åºä¸ä¸ª promise å¯¹è±¡ï¼ä»è¿ä¸ª promise å¯¹è±¡å¤æ­å¼æ­¥æä½ææ²¡æç»æã\n\n// awaiting.js\nlet output;\nexport default (async function main() {\n  const dynamic = await import(somemission);\n  const data = await fetch(url);\n  output = someprocess(dynamic.default, data);\n})();\nexport { output };\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼awaiting.jsé¤äºè¾åºoutputï¼è¿é»è®¤è¾åºä¸ä¸ª promise å¯¹è±¡ï¼async å½æ°ç«å³æ§è¡åï¼è¿åä¸ä¸ª promise å¯¹è±¡ï¼ï¼ä»è¿ä¸ªå¯¹è±¡å¤æ­å¼æ­¥æä½æ¯å¦ç»æã\n\nä¸é¢æ¯å è½½è¿ä¸ªæ¨¡åçæ°çåæ³ã\n\n// usage.js\nimport promise, { output } from \"./awaiting.js\";\n\nfunction outputplusvalue(value) { return output + value }\n\npromise.then(() => {\n  console.log(outputplusvalue(100));\n  settimeout(() => console.log(outputplusvalue(100), 1000);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å°awaiting.jså¯¹è±¡çè¾åºï¼æ¾å¨promise.then()éé¢ï¼è¿æ ·å°±è½ä¿è¯å¼æ­¥æä½å®æä»¥åï¼æå»è¯»åoutputã\n\nè¿ç§åæ³æ¯è¾éº»ç¦ï¼ç­äºè¦æ±æ¨¡åçä½¿ç¨èéµå®ä¸ä¸ªé¢å¤çä½¿ç¨åè®®ï¼æç§ç¹æ®çæ¹æ³ä½¿ç¨è¿ä¸ªæ¨¡åãä¸æ¦ä½ å¿äºè¦ç¨ promise å è½½ï¼åªä½¿ç¨æ­£å¸¸çå è½½æ¹æ³ï¼ä¾èµè¿ä¸ªæ¨¡åçä»£ç å°±å¯è½åºéãèä¸ï¼å¦æä¸é¢çusage.jsåæå¯¹å¤çè¾åºï¼ç­äºè¿ä¸ªä¾èµé¾çæææ¨¡åé½è¦ä½¿ç¨ promise å è½½ã\n\né¡¶å±çawaitå½ä»¤ï¼å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢ãå®ä¿è¯åªæå¼æ­¥æä½å®æï¼æ¨¡åæä¼è¾åºå¼ã\n\n// awaiting.js\nconst dynamic = import(somemission);\nconst data = fetch(url);\nexport const output = someprocess((await dynamic).default, await data);\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸¤ä¸ªå¼æ­¥æä½å¨è¾åºçæ¶åï¼é½å ä¸äºawaitå½ä»¤ãåªæç­å°å¼æ­¥æä½å®æï¼è¿ä¸ªæ¨¡åæä¼è¾åºå¼ã\n\nå è½½è¿ä¸ªæ¨¡åçåæ³å¦ä¸ã\n\n// usage.js\nimport { output } from \"./awaiting.js\";\nfunction outputplusvalue(value) { return output + value }\n\nconsole.log(outputplusvalue(100));\nsettimeout(() => console.log(outputplusvalue(100), 1000);\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çåæ³ï¼ä¸æ®éçæ¨¡åå è½½å®å¨ä¸æ ·ãä¹å°±æ¯è¯´ï¼æ¨¡åçä½¿ç¨èå®å¨ä¸ç¨å³å¿ï¼ä¾èµæ¨¡åçåé¨ææ²¡æå¼æ­¥æä½ï¼æ­£å¸¸å è½½å³å¯ã\n\nè¿æ¶ï¼æ¨¡åçå è½½ä¼ç­å¾ä¾èµæ¨¡åï¼ä¸ä¾æ¯awaiting.jsï¼çå¼æ­¥æä½å®æï¼ææ§è¡åé¢çä»£ç ï¼æç¹åæåå¨é£éãæä»¥ï¼å®æ»æ¯ä¼å¾å°æ­£ç¡®çoutputï¼ä¸ä¼å ä¸ºå è½½æ¶æºçä¸åï¼èå¾å°ä¸ä¸æ ·çå¼ã\n\nä¸é¢æ¯é¡¶å±awaitçä¸äºä½¿ç¨åºæ¯ã\n\n// import() æ¹æ³å è½½\nconst strings = await import(`/i18n/${navigator.language}`);\n\n// æ°æ®åºæä½\nconst connection = await dbconnector();\n\n// ä¾èµåæ»\nlet jquery;\ntry {\n  jquery = await import('https://cdn-a.com/jquery');\n} catch {\n  jquery = await import('https://cdn-b.com/jquery');\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\næ³¨æï¼å¦æå è½½å¤ä¸ªåå«é¡¶å±awaitå½ä»¤çæ¨¡åï¼å è½½å½ä»¤æ¯åæ­¥æ§è¡çã\n\n// x.js\nconsole.log(\"x1\");\nawait new promise(r => settimeout(r, 1000));\nconsole.log(\"x2\");\n\n// y.js\nconsole.log(\"y\");\n\n// z.js\nimport \"./x.js\";\nimport \"./y.js\";\nconsole.log(\"z\");\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç æä¸ä¸ªæ¨¡åï¼æåçz.jså è½½x.jsåy.jsï¼æå°ç»ææ¯x1ãyãx2ãzãè¿è¯´æï¼z.jså¹¶æ²¡æç­å¾x.jså è½½å®æï¼åå»å è½½y.jsã\n\né¡¶å±çawaitå½ä»¤æç¹åï¼äº¤åºä»£ç çæ§è¡æç»å¶ä»çæ¨¡åå è½½ï¼ç­å¼æ­¥æä½å®æåï¼åæ¿åæ§è¡æï¼ç»§ç»­åä¸æ§è¡ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Class çç»§æ¿",frontmatter:{title:"Class çç»§æ¿",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/83f8c3a0cd87dd83",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/22.Class%20%E7%9A%84%E7%BB%A7%E6%89%BF.html",relativePath:"ãES6 æç¨ãç¬è®°/22.Class çç»§æ¿.md",key:"v-44d2c0fc",path:"/pages/83f8c3a0cd87dd83/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:16},{level:2,title:"Object.getPrototypeOf()",slug:"object-getprototypeof",normalizedTitle:"object.getprototypeof()",charIndex:2131},{level:2,title:"super å³é®å­",slug:"super-å³é®å­",normalizedTitle:"super å³é®å­",charIndex:2286},{level:2,title:"ç±»ç prototype å±æ§å__proto__å±æ§",slug:"ç±»ç-prototype-å±æ§å-proto-å±æ§",normalizedTitle:"ç±»ç prototype å±æ§å__proto__å±æ§",charIndex:6501},{level:3,title:"å®ä¾ç __proto__ å±æ§",slug:"å®ä¾ç-proto-å±æ§",normalizedTitle:"å®ä¾ç <strong>proto</strong> å±æ§",charIndex:null},{level:2,title:"åçæé å½æ°çç»§æ¿",slug:"åçæé å½æ°çç»§æ¿",normalizedTitle:"åçæé å½æ°çç»§æ¿",charIndex:8813},{level:2,title:"Mixin æ¨¡å¼çå®ç°",slug:"mixin-æ¨¡å¼çå®ç°",normalizedTitle:"mixin æ¨¡å¼çå®ç°",charIndex:12041}],excerpt:'<h1 id="class-çç»§æ¿"><a class="header-anchor" href="#class-çç»§æ¿">#</a> Class çç»§æ¿</h1>\n<h2 id="ç®ä»"><a class="header-anchor" href="#ç®ä»">#</a> ç®ä»</h2>\n<p>Class å¯ä»¥éè¿<code>extends</code>å³é®å­å®ç°ç»§æ¿ï¼è¿æ¯ ES5 çéè¿ä¿®æ¹ååé¾å®ç°ç»§æ¿ï¼è¦æ¸æ°åæ¹ä¾¿å¾å¤ã</p>\n\x3c!--beforebegin--\x3e<div class="language-javascript line-numbers-mode">\x3c!--afterbegin--\x3e<pre v-pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ColorPoint</span> <span class="token keyword">extends</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div>\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e',headersStr:"ç®ä» Object.getPrototypeOf() super å³é®å­ ç±»ç prototype å±æ§å__proto__å±æ§ å®ä¾ç __proto__ å±æ§ åçæé å½æ°çç»§æ¿ Mixin æ¨¡å¼çå®ç°",content:"# Class çç»§æ¿\n\n\n# ç®ä»\n\nClass å¯ä»¥éè¿extendså³é®å­å®ç°ç»§æ¿ï¼è¿æ¯ ES5 çéè¿ä¿®æ¹ååé¾å®ç°ç»§æ¿ï¼è¦æ¸æ°åæ¹ä¾¿å¾å¤ã\n\nclass Point {\n}\n\nclass ColorPoint extends Point {\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç å®ä¹äºä¸ä¸ªColorPointç±»ï¼è¯¥ç±»éè¿extendså³é®å­ï¼ç»§æ¿äºPointç±»çææå±æ§åæ¹æ³ãä½æ¯ç±äºæ²¡æé¨ç½²ä»»ä½ä»£ç ï¼æä»¥è¿ä¸¤ä¸ªç±»å®å¨ä¸æ ·ï¼ç­äºå¤å¶äºä¸ä¸ªPointç±»ãä¸é¢ï¼æä»¬å¨ColorPointåé¨å ä¸ä»£ç ã\n\nclass ColorPoint extends Point {\n  constructor(x, y, color) {\n    super(x, y); // è°ç¨ç¶ç±»çconstructor(x, y)\n    this.color = color;\n  }\n\n  toString() {\n    return this.color + ' ' + super.toString(); // è°ç¨ç¶ç±»çtoString()\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼constructoræ¹æ³åtoStringæ¹æ³ä¹ä¸­ï¼é½åºç°äºsuperå³é®å­ï¼å®å¨è¿éè¡¨ç¤ºç¶ç±»çæé å½æ°ï¼ç¨æ¥æ°å»ºç¶ç±»çthiså¯¹è±¡ã\n\n**å­ç±»å¿é¡»å¨constructoræ¹æ³ä¸­è°ç¨superæ¹æ³ï¼å¦åæ°å»ºå®ä¾æ¶ä¼æ¥éã**è¿æ¯å ä¸ºå­ç±»èªå·±çthiså¯¹è±¡ï¼å¿é¡»åéè¿ç¶ç±»çæé å½æ°å®æå¡é ï¼å¾å°ä¸ç¶ç±»åæ ·çå®ä¾å±æ§åæ¹æ³ï¼ç¶ååå¯¹å¶è¿è¡å å·¥ï¼å ä¸å­ç±»èªå·±çå®ä¾å±æ§åæ¹æ³ãå¦æä¸è°ç¨superæ¹æ³ï¼å­ç±»å°±å¾ä¸å°thiså¯¹è±¡ã\n\nclass Point { /* ... */ }\n\nclass ColorPoint extends Point {\n  constructor() {\n  }\n}\n\nlet cp = new ColorPoint(); // ReferenceError\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼ColorPointç»§æ¿äºç¶ç±»Pointï¼ä½æ¯å®çæé å½æ°æ²¡æè°ç¨superæ¹æ³ï¼å¯¼è´æ°å»ºå®ä¾æ¶æ¥éã\n\nES5 çç»§æ¿ï¼å®è´¨æ¯ååé å­ç±»çå®ä¾å¯¹è±¡thisï¼ç¶ååå°ç¶ç±»çæ¹æ³æ·»å å°thisä¸é¢ï¼Parent.apply(this)ï¼ãES6 çç»§æ¿æºå¶å®å¨ä¸åï¼å®è´¨æ¯åå°ç¶ç±»å®ä¾å¯¹è±¡çå±æ§åæ¹æ³ï¼å å°thisä¸é¢ï¼æä»¥å¿é¡»åè°ç¨superæ¹æ³ï¼ï¼ç¶ååç¨å­ç±»çæé å½æ°ä¿®æ¹thisã\n\nå¦æå­ç±»æ²¡æå®ä¹constructoræ¹æ³ï¼è¿ä¸ªæ¹æ³ä¼è¢«é»è®¤æ·»å ï¼ä»£ç å¦ä¸ãä¹å°±æ¯è¯´ï¼ä¸ç®¡ææ²¡ææ¾å¼å®ä¹ï¼ä»»ä½ä¸ä¸ªå­ç±»é½æconstructoræ¹æ³ã\n\nclass ColorPoint extends Point {\n}\n\n// ç­åäº\nclass ColorPoint extends Point {\n  constructor(...args) {\n    super(...args);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦ä¸ä¸ªéè¦æ³¨æçå°æ¹æ¯ï¼**å¨å­ç±»çæé å½æ°ä¸­ï¼åªæè°ç¨superä¹åï¼æå¯ä»¥ä½¿ç¨thiså³é®å­ï¼å¦åä¼æ¥éã**è¿æ¯å ä¸ºå­ç±»å®ä¾çæå»ºï¼åºäºç¶ç±»å®ä¾ï¼åªæsuperæ¹æ³æè½è°ç¨ç¶ç±»å®ä¾ã\n\nclass Point {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n}\n\nclass ColorPoint extends Point {\n  constructor(x, y, color) {\n    this.color = color; // ReferenceError\n    super(x, y);\n    this.color = color; // æ­£ç¡®\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç±»çconstructoræ¹æ³æ²¡æè°ç¨superä¹åï¼å°±ä½¿ç¨thiså³é®å­ï¼ç»ææ¥éï¼èæ¾å¨superæ¹æ³ä¹åå°±æ¯æ­£ç¡®çã\n\nä¸é¢æ¯çæå­ç±»å®ä¾çä»£ç ã\n\nlet cp = new ColorPoint(25, 8, 'green');\n\ncp instanceof ColorPoint // true\ncp instanceof Point // true\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼å®ä¾å¯¹è±¡cpåæ¶æ¯ColorPointåPointä¸¤ä¸ªç±»çå®ä¾ï¼è¿ä¸ ES5 çè¡ä¸ºå®å¨ä¸è´ã\n\næåï¼ç¶ç±»çéææ¹æ³ï¼ä¹ä¼è¢«å­ç±»ç»§æ¿ã\n\nclass A {\n  static hello() {\n    console.log('hello world');\n  }\n}\n\nclass B extends A {\n}\n\nB.hello()  // hello world\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼hello()æ¯Aç±»çéææ¹æ³ï¼Bç»§æ¿Aï¼ä¹ç»§æ¿äºAçéææ¹æ³ã\n\n\n# Object.getPrototypeOf()\n\nObject.getPrototypeOfæ¹æ³å¯ä»¥ç¨æ¥ä»å­ç±»ä¸è·åç¶ç±»ã\n\nObject.getPrototypeOf(ColorPoint) === Point\n// true\n\n\n1\n2\n\n\nå æ­¤ï¼å¯ä»¥ä½¿ç¨è¿ä¸ªæ¹æ³å¤æ­ï¼ä¸ä¸ªç±»æ¯å¦ç»§æ¿äºå¦ä¸ä¸ªç±»ã\n\n\n# super å³é®å­\n\nsuperè¿ä¸ªå³é®å­ï¼æ¢å¯ä»¥å½ä½å½æ°ä½¿ç¨ï¼ä¹å¯ä»¥å½ä½å¯¹è±¡ä½¿ç¨ãå¨è¿ä¸¤ç§æåµä¸ï¼å®çç¨æ³å®å¨ä¸åã\n\nç¬¬ä¸ç§æåµï¼superä½ä¸ºå½æ°è°ç¨æ¶ï¼ä»£è¡¨ç¶ç±»çæé å½æ°ãES6 è¦æ±ï¼å­ç±»çæé å½æ°å¿é¡»æ§è¡ä¸æ¬¡superå½æ°ã\n\nclass A {}\n\nclass B extends A {\n  constructor() {\n    super();\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç±»Bçæé å½æ°ä¹ä¸­çsuper()ï¼ä»£è¡¨è°ç¨ç¶ç±»çæé å½æ°ãè¿æ¯å¿é¡»çï¼å¦å JavaScript å¼æä¼æ¥éã\n\næ³¨æï¼superè½ç¶ä»£è¡¨äºç¶ç±»Açæé å½æ°ï¼ä½æ¯è¿åçæ¯å­ç±»Bçå®ä¾ï¼å³superåé¨çthisæçæ¯Bçå®ä¾ï¼å æ­¤super()å¨è¿éç¸å½äºA.prototype.constructor.call(this)ã\n\nclass A {\n  constructor() {\n    console.log(new.target.name);\n  }\n}\nclass B extends A {\n  constructor() {\n    super();\n  }\n}\nnew A() // A\nnew B() // B\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼new.targetæåå½åæ­£å¨æ§è¡çå½æ°ãå¯ä»¥çå°ï¼å¨super()æ§è¡æ¶ï¼å®æåçæ¯å­ç±»Bçæé å½æ°ï¼èä¸æ¯ç¶ç±»Açæé å½æ°ãä¹å°±æ¯è¯´ï¼super()åé¨çthisæåçæ¯Bã\n\nä½ä¸ºå½æ°æ¶ï¼super()åªè½ç¨å¨å­ç±»çæé å½æ°ä¹ä¸­ï¼ç¨å¨å¶ä»å°æ¹å°±ä¼æ¥éã\n\nclass A {}\n\nclass B extends A {\n  m() {\n    super(); // æ¥é\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼super()ç¨å¨Bç±»çmæ¹æ³ä¹ä¸­ï¼å°±ä¼é æè¯­æ³éè¯¯ã\n\nç¬¬äºç§æåµï¼superä½ä¸ºå¯¹è±¡æ¶ï¼å¨æ®éæ¹æ³ä¸­ï¼æåç¶ç±»çååå¯¹è±¡ï¼å¨éææ¹æ³ä¸­ï¼æåç¶ç±»ã\n\nclass A {\n  p() {\n    return 2;\n  }\n}\n\nclass B extends A {\n  constructor() {\n    super();\n    console.log(super.p()); // 2\n  }\n}\n\nlet b = new B();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç±»Bå½ä¸­çsuper.p()ï¼å°±æ¯å°superå½ä½ä¸ä¸ªå¯¹è±¡ä½¿ç¨ãè¿æ¶ï¼superå¨æ®éæ¹æ³ä¹ä¸­ï¼æåA.prototypeï¼æä»¥super.p()å°±ç¸å½äºA.prototype.p()ã\n\nè¿ééè¦æ³¨æï¼ç±äºsuperæåç¶ç±»çååå¯¹è±¡ï¼æä»¥å®ä¹å¨ç¶ç±»å®ä¾ä¸çæ¹æ³æå±æ§ï¼æ¯æ æ³éè¿superè°ç¨çã\n\nclass A {\n  constructor() {\n    this.p = 2; // è¿æ¯å®äºå¨å®ä¾ä¸çå±æ§\n  }\n}\n\nclass B extends A {\n  get m() {\n    return super.p;\n  }\n}\n\nlet b = new B();\nb.m // undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼pæ¯ç¶ç±»Aå®ä¾çå±æ§ï¼super.på°±å¼ç¨ä¸å°å®ã\n\nå¦æå±æ§å®ä¹å¨ç¶ç±»çååå¯¹è±¡ä¸ï¼superå°±å¯ä»¥åå°ã\n\nclass A {}\nA.prototype.x = 2;\n\nclass B extends A {\n  constructor() {\n    super();\n    console.log(super.x) // 2\n  }\n}\n\nlet b = new B();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼å±æ§xæ¯å®ä¹å¨A.prototypeä¸é¢çï¼æä»¥super.xå¯ä»¥åå°å®çå¼ã\n\nES6 è§å®ï¼å¨å­ç±»æ®éæ¹æ³ä¸­éè¿superè°ç¨ç¶ç±»çæ¹æ³æ¶ï¼æ¹æ³åé¨çthisæåå½åçå­ç±»å®ä¾ã\n\nclass A {\n  constructor() {\n    this.x = 1;\n  }\n  print() {\n    console.log(this.x);\n  }\n}\n\nclass B extends A {\n  constructor() {\n    super();\n    this.x = 2;\n  }\n  m() {\n    super.print();\n  }\n}\n\nlet b = new B();\nb.m() // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nä¸é¢ä»£ç ä¸­ï¼super.print()è½ç¶è°ç¨çæ¯A.prototype.print()ï¼ä½æ¯A.prototype.print()åé¨çthisæåå­ç±»Bçå®ä¾ï¼å¯¼è´è¾åºçæ¯2ï¼èä¸æ¯1ãä¹å°±æ¯è¯´ï¼å®éä¸æ§è¡çæ¯super.print.call(this)ã\n\nç±äºthisæåå­ç±»å®ä¾ï¼æä»¥å¦æéè¿superå¯¹æä¸ªå±æ§èµå¼ï¼è¿æ¶superå°±æ¯thisï¼èµå¼çå±æ§ä¼åæå­ç±»å®ä¾çå±æ§ã\n\nclass A {\n  constructor() {\n    this.x = 1;\n  }\n}\n\nclass B extends A {\n  constructor() {\n    super();\n    this.x = 2;\n    super.x = 3;\n    console.log(super.x); // undefined\n    console.log(this.x); // 3\n  }\n}\n\nlet b = new B();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼super.xèµå¼ä¸º3ï¼è¿æ¶ç­åäºå¯¹this.xèµå¼ä¸º3ãèå½è¯»åsuper.xçæ¶åï¼è¯»çæ¯A.prototype.xï¼æä»¥è¿åundefinedã\n\nå¦æsuperä½ä¸ºå¯¹è±¡ï¼ç¨å¨éææ¹æ³ä¹ä¸­ï¼è¿æ¶superå°æåç¶ç±»ï¼èä¸æ¯ç¶ç±»çååå¯¹è±¡ã\n\nclass Parent {\n  static myMethod(msg) {\n    console.log('static', msg);\n  }\n\n  myMethod(msg) {\n    console.log('instance', msg);\n  }\n}\n\nclass Child extends Parent {\n  static myMethod(msg) {\n    super.myMethod(msg);\n  }\n\n  myMethod(msg) {\n    super.myMethod(msg);\n  }\n}\n\nChild.myMethod(1); // static 1\n\nvar child = new Child();\nchild.myMethod(2); // instance 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nä¸é¢ä»£ç ä¸­ï¼superå¨éææ¹æ³ä¹ä¸­æåç¶ç±»ï¼å¨æ®éæ¹æ³ä¹ä¸­æåç¶ç±»çååå¯¹è±¡ã\n\nå¦å¤ï¼å¨å­ç±»çéææ¹æ³ä¸­éè¿superè°ç¨ç¶ç±»çæ¹æ³æ¶ï¼æ¹æ³åé¨çthisæåå½åçå­ç±»ï¼èä¸æ¯å­ç±»çå®ä¾ã\n\nclass A {\n  constructor() {\n    this.x = 1;\n  }\n  static print() {\n    console.log(this.x);\n  }\n}\n\nclass B extends A {\n  constructor() {\n    super();\n    this.x = 2;\n  }\n  static m() {\n    super.print();\n  }\n}\n\nB.x = 3;\nB.m() // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nä¸é¢ä»£ç ä¸­ï¼éææ¹æ³B.méé¢ï¼super.printæåç¶ç±»çéææ¹æ³ãè¿ä¸ªæ¹æ³éé¢çthisæåçæ¯Bï¼èä¸æ¯Bçå®ä¾ã\n\næ³¨æï¼ä½¿ç¨superçæ¶åï¼å¿é¡»æ¾å¼æå®æ¯ä½ä¸ºå½æ°ãè¿æ¯ä½ä¸ºå¯¹è±¡ä½¿ç¨ï¼å¦åä¼æ¥éã\n\nclass A {}\n\nclass B extends A {\n  constructor() {\n    super();\n    console.log(super); // æ¥é\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼console.log(super)å½ä¸­çsuperï¼æ æ³çåºæ¯ä½ä¸ºå½æ°ä½¿ç¨ï¼è¿æ¯ä½ä¸ºå¯¹è±¡ä½¿ç¨ï¼æä»¥ JavaScript å¼æè§£æä»£ç çæ¶åå°±ä¼æ¥éãè¿æ¶ï¼å¦æè½æ¸æ°å°è¡¨æsuperçæ°æ®ç±»åï¼å°±ä¸ä¼æ¥éã\n\nclass A {}\n\nclass B extends A {\n  constructor() {\n    super();\n    console.log(super.valueOf() instanceof B); // true\n  }\n}\n\nlet b = new B();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼super.valueOf()è¡¨æsuperæ¯ä¸ä¸ªå¯¹è±¡ï¼å æ­¤å°±ä¸ä¼æ¥éãåæ¶ï¼ç±äºsuperä½¿å¾thisæåBçå®ä¾ï¼æä»¥super.valueOf()è¿åçæ¯ä¸ä¸ªBçå®ä¾ã\n\næåï¼ç±äºå¯¹è±¡æ»æ¯ç»§æ¿å¶ä»å¯¹è±¡çï¼æä»¥å¯ä»¥å¨ä»»æä¸ä¸ªå¯¹è±¡ä¸­ï¼ä½¿ç¨superå³é®å­ã\n\nvar obj = {\n  toString() {\n    return \"MyObject: \" + super.toString();\n  }\n};\n\nobj.toString(); // MyObject: [object Object]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# ç±»ç prototype å±æ§å__proto__å±æ§\n\nå¤§å¤æ°æµè§å¨ç ES5 å®ç°ä¹ä¸­ï¼æ¯ä¸ä¸ªå¯¹è±¡é½æ__proto__å±æ§ï¼æåå¯¹åºçæé å½æ°çprototypeå±æ§ãClass ä½ä¸ºæé å½æ°çè¯­æ³ç³ï¼åæ¶æprototypeå±æ§å__proto__å±æ§ï¼å æ­¤åæ¶å­å¨ä¸¤æ¡ç»§æ¿é¾ã\n\nï¼1ï¼å­ç±»ç__proto__å±æ§ï¼è¡¨ç¤ºæé å½æ°çç»§æ¿ï¼æ»æ¯æåç¶ç±»ã\n\nï¼2ï¼å­ç±»prototypeå±æ§ç__proto__å±æ§ï¼è¡¨ç¤ºæ¹æ³çç»§æ¿ï¼æ»æ¯æåç¶ç±»çprototypeå±æ§ã\n\nclass A {\n}\n\nclass B extends A {\n}\n\nB.__proto__ === A // true\nB.prototype.__proto__ === A.prototype // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç±»Bç__proto__å±æ§æåç¶ç±»Aï¼å­ç±»Bçprototypeå±æ§ç__proto__å±æ§æåç¶ç±»Açprototypeå±æ§ã\n\nè¿æ ·çç»ææ¯å ä¸ºï¼ç±»çç»§æ¿æ¯æç§ä¸é¢çæ¨¡å¼å®ç°çã\n\nclass A {\n}\n\nclass B {\n}\n\n// B çå®ä¾ç»§æ¿ A çå®ä¾\nObject.setPrototypeOf(B.prototype, A.prototype);\n\n// B ç»§æ¿ A çéæå±æ§\nObject.setPrototypeOf(B, A);\n\nconst b = new B();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nãå¯¹è±¡çæ©å±ãä¸ç« ç»åºè¿Object.setPrototypeOfæ¹æ³çå®ç°ã\n\nObject.setPrototypeOf = function (obj, proto) {\n  obj.__proto__ = proto;\n  return obj;\n}\n\n\n1\n2\n3\n4\n\n\nå æ­¤ï¼å°±å¾å°äºä¸é¢çç»æã\n\nObject.setPrototypeOf(B.prototype, A.prototype);\n// ç­åäº\nB.prototype.__proto__ = A.prototype;\n\nObject.setPrototypeOf(B, A);\n// ç­åäº\nB.__proto__ = A;\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¿ä¸¤æ¡ç»§æ¿é¾ï¼å¯ä»¥è¿æ ·çè§£ï¼ä½ä¸ºä¸ä¸ªå¯¹è±¡ï¼å­ç±»ï¼Bï¼çååï¼__proto__å±æ§ï¼æ¯ç¶ç±»ï¼Aï¼ï¼ä½ä¸ºä¸ä¸ªæé å½æ°ï¼å­ç±»ï¼Bï¼çååå¯¹è±¡ï¼prototypeå±æ§ï¼æ¯ç¶ç±»çååå¯¹è±¡ï¼prototypeå±æ§ï¼çå®ä¾ã\n\nB.prototype = Object.create(A.prototype);\n// ç­åäº\nB.prototype.__proto__ = A.prototype;\n\n\n1\n2\n3\n\n\nextendså³é®å­åé¢å¯ä»¥è·å¤ç§ç±»åçå¼ã\n\nclass B extends A {\n}\n\n\n1\n2\n\n\nä¸é¢ä»£ç çAï¼åªè¦æ¯ä¸ä¸ªæprototypeå±æ§çå½æ°ï¼å°±è½è¢«Bç»§æ¿ãç±äºå½æ°é½æprototypeå±æ§ï¼é¤äºFunction.prototypeå½æ°ï¼ï¼å æ­¤Aå¯ä»¥æ¯ä»»æå½æ°ã\n\nä¸é¢ï¼è®¨è®ºä¸¤ç§æåµãç¬¬ä¸ç§ï¼å­ç±»ç»§æ¿Objectç±»ã\n\nclass A extends Object {\n}\n\nA.__proto__ === Object // true\nA.prototype.__proto__ === Object.prototype // true\n\n\n1\n2\n3\n4\n5\n\n\nè¿ç§æåµä¸ï¼Aå¶å®å°±æ¯æé å½æ°Objectçå¤å¶ï¼Açå®ä¾å°±æ¯Objectçå®ä¾ã\n\nç¬¬äºç§æåµï¼ä¸å­å¨ä»»ä½ç»§æ¿ã\n\nclass A {\n}\n\nA.__proto__ === Function.prototype // true\nA.prototype.__proto__ === Object.prototype // true\n\n\n1\n2\n3\n4\n5\n\n\nè¿ç§æåµä¸ï¼Aä½ä¸ºä¸ä¸ªåºç±»ï¼å³ä¸å­å¨ä»»ä½ç»§æ¿ï¼ï¼å°±æ¯ä¸ä¸ªæ®éå½æ°ï¼æä»¥ç´æ¥ç»§æ¿Function.prototypeãä½æ¯ï¼Aè°ç¨åè¿åä¸ä¸ªç©ºå¯¹è±¡ï¼å³Objectå®ä¾ï¼ï¼æä»¥A.prototype.__proto__æåæé å½æ°ï¼Objectï¼çprototypeå±æ§ã\n\n\n# å®ä¾ç __proto__ å±æ§\n\nå­ç±»å®ä¾ç__proto__å±æ§ç__proto__å±æ§ï¼æåç¶ç±»å®ä¾ç__proto__å±æ§ãä¹å°±æ¯è¯´ï¼å­ç±»çååçååï¼æ¯ç¶ç±»çååã\n\nvar p1 = new Point(2, 3);\nvar p2 = new ColorPoint(2, 3, 'red');\n\np2.__proto__ === p1.__proto__ // false\np2.__proto__.__proto__ === p1.__proto__ // true\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼ColorPointç»§æ¿äºPointï¼å¯¼è´åèååçååæ¯åèçååã\n\nå æ­¤ï¼éè¿å­ç±»å®ä¾ç__proto__.__proto__å±æ§ï¼å¯ä»¥ä¿®æ¹ç¶ç±»å®ä¾çè¡ä¸ºã\n\np2.__proto__.__proto__.printName = function () {\n  console.log('Ha');\n};\n\np1.printName() // \"Ha\"\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç å¨ColorPointçå®ä¾p2ä¸åPointç±»æ·»å æ¹æ³ï¼ç»æå½±åå°äºPointçå®ä¾p1ã\n\n\n# åçæé å½æ°çç»§æ¿\n\nåçæé å½æ°æ¯æè¯­è¨åç½®çæé å½æ°ï¼éå¸¸ç¨æ¥çææ°æ®ç»æãECMAScript çåçæé å½æ°å¤§è´æä¸é¢è¿äºã\n\n * Boolean()\n * Number()\n * String()\n * Array()\n * Date()\n * Function()\n * RegExp()\n * Error()\n * Object()\n\nä»¥åï¼è¿äºåçæé å½æ°æ¯æ æ³ç»§æ¿çï¼æ¯å¦ï¼ä¸è½èªå·±å®ä¹ä¸ä¸ªArrayçå­ç±»ã\n\nfunction MyArray() {\n  Array.apply(this, arguments);\n}\n\nMyArray.prototype = Object.create(Array.prototype, {\n  constructor: {\n    value: MyArray,\n    writable: true,\n    configurable: true,\n    enumerable: true\n  }\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç å®ä¹äºä¸ä¸ªç»§æ¿ Array çMyArrayç±»ãä½æ¯ï¼è¿ä¸ªç±»çè¡ä¸ºä¸Arrayå®å¨ä¸ä¸è´ã\n\nvar colors = new MyArray();\ncolors[0] = \"red\";\ncolors.length  // 0\n\ncolors.length = 0;\ncolors[0]  // \"red\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¹æä»¥ä¼åçè¿ç§æåµï¼æ¯å ä¸ºå­ç±»æ æ³è·å¾åçæé å½æ°çåé¨å±æ§ï¼éè¿Array.apply()æèåéç»ååå¯¹è±¡é½ä¸è¡ãåçæé å½æ°ä¼å¿½ç¥applyæ¹æ³ä¼ å¥çthisï¼ä¹å°±æ¯è¯´ï¼åçæé å½æ°çthisæ æ³ç»å®ï¼å¯¼è´æ¿ä¸å°åé¨å±æ§ã\n\nES5 æ¯åæ°å»ºå­ç±»çå®ä¾å¯¹è±¡thisï¼åå°ç¶ç±»çå±æ§æ·»å å°å­ç±»ä¸ï¼ç±äºç¶ç±»çåé¨å±æ§æ æ³è·åï¼å¯¼è´æ æ³ç»§æ¿åççæé å½æ°ãæ¯å¦ï¼Arrayæé å½æ°æä¸ä¸ªåé¨å±æ§[[DefineOwnProperty]]ï¼ç¨æ¥å®ä¹æ°å±æ§æ¶ï¼æ´æ°lengthå±æ§ï¼è¿ä¸ªåé¨å±æ§æ æ³å¨å­ç±»è·åï¼å¯¼è´å­ç±»çlengthå±æ§è¡ä¸ºä¸æ­£å¸¸ã\n\nä¸é¢çä¾å­ä¸­ï¼æä»¬æ³è®©ä¸ä¸ªæ®éå¯¹è±¡ç»§æ¿Errorå¯¹è±¡ã\n\nvar e = {};\n\nObject.getOwnPropertyNames(Error.call(e))\n// [ 'stack' ]\n\nObject.getOwnPropertyNames(e)\n// []\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼æä»¬æ³éè¿Error.call(e)è¿ç§åæ³ï¼è®©æ®éå¯¹è±¡eå·æErrorå¯¹è±¡çå®ä¾å±æ§ãä½æ¯ï¼Error.call()å®å¨å¿½ç¥ä¼ å¥çç¬¬ä¸ä¸ªåæ°ï¼èæ¯è¿åä¸ä¸ªæ°å¯¹è±¡ï¼eæ¬èº«æ²¡æä»»ä½ååãè¿è¯æäºError.call(e)è¿ç§åæ³ï¼æ æ³ç»§æ¿åçæé å½æ°ã\n\nES6 åè®¸ç»§æ¿åçæé å½æ°å®ä¹å­ç±»ï¼å ä¸º ES6 æ¯åæ°å»ºç¶ç±»çå®ä¾å¯¹è±¡thisï¼ç¶ååç¨å­ç±»çæé å½æ°ä¿®é¥°thisï¼ä½¿å¾ç¶ç±»çææè¡ä¸ºé½å¯ä»¥ç»§æ¿ãä¸é¢æ¯ä¸ä¸ªç»§æ¿Arrayçä¾å­ã\n\nclass MyArray extends Array {\n  constructor(...args) {\n    super(...args);\n  }\n}\n\nvar arr = new MyArray();\narr[0] = 12;\narr.length // 1\n\narr.length = 0;\narr[0] // undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç å®ä¹äºä¸ä¸ªMyArrayç±»ï¼ç»§æ¿äºArrayæé å½æ°ï¼å æ­¤å°±å¯ä»¥ä»MyArrayçææ°ç»çå®ä¾ãè¿æå³çï¼ES6 å¯ä»¥èªå®ä¹åçæ°æ®ç»æï¼æ¯å¦ArrayãStringç­ï¼çå­ç±»ï¼è¿æ¯ ES5 æ æ³åå°çã\n\nä¸é¢è¿ä¸ªä¾å­ä¹è¯´æï¼extendså³é®å­ä¸ä»å¯ä»¥ç¨æ¥ç»§æ¿ç±»ï¼è¿å¯ä»¥ç¨æ¥ç»§æ¿åççæé å½æ°ãå æ­¤å¯ä»¥å¨åçæ°æ®ç»æçåºç¡ä¸ï¼å®ä¹èªå·±çæ°æ®ç»æãä¸é¢å°±æ¯å®ä¹äºä¸ä¸ªå¸¦çæ¬åè½çæ°ç»ã\n\nclass VersionedArray extends Array {\n  constructor() {\n    super();\n    this.history = [[]];\n  }\n  commit() {\n    this.history.push(this.slice());\n  }\n  revert() {\n    this.splice(0, this.length, ...this.history[this.history.length - 1]);\n  }\n}\n\nvar x = new VersionedArray();\n\nx.push(1);\nx.push(2);\nx // [1, 2]\nx.history // [[]]\n\nx.commit();\nx.history // [[], [1, 2]]\n\nx.push(3);\nx // [1, 2, 3]\nx.history // [[], [1, 2]]\n\nx.revert();\nx // [1, 2]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nä¸é¢ä»£ç ä¸­ï¼VersionedArrayä¼éè¿commitæ¹æ³ï¼å°èªå·±çå½åç¶æçæä¸ä¸ªçæ¬å¿«ç§ï¼å­å¥historyå±æ§ãrevertæ¹æ³ç¨æ¥å°æ°ç»éç½®ä¸ºææ°ä¸æ¬¡ä¿å­ççæ¬ãé¤æ­¤ä¹å¤ï¼VersionedArrayä¾ç¶æ¯ä¸ä¸ªæ®éæ°ç»ï¼ææåççæ°ç»æ¹æ³é½å¯ä»¥å¨å®ä¸é¢è°ç¨ã\n\nä¸é¢æ¯ä¸ä¸ªèªå®ä¹Errorå­ç±»çä¾å­ï¼å¯ä»¥ç¨æ¥å®å¶æ¥éæ¶çè¡ä¸ºã\n\nclass ExtendableError extends Error {\n  constructor(message) {\n    super();\n    this.message = message;\n    this.stack = (new Error()).stack;\n    this.name = this.constructor.name;\n  }\n}\n\nclass MyError extends ExtendableError {\n  constructor(m) {\n    super(m);\n  }\n}\n\nvar myerror = new MyError('ll');\nmyerror.message // \"ll\"\nmyerror instanceof Error // true\nmyerror.name // \"MyError\"\nmyerror.stack\n// Error\n//     at MyError.ExtendableError\n//     ...\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\næ³¨æï¼ç»§æ¿Objectçå­ç±»ï¼æä¸ä¸ªè¡ä¸ºå·®å¼ã\n\nclass NewObj extends Object{\n  constructor(){\n    super(...arguments);\n  }\n}\nvar o = new NewObj({attr: true});\no.attr === true  // false\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼NewObjç»§æ¿äºObjectï¼ä½æ¯æ æ³éè¿superæ¹æ³åç¶ç±»Objectä¼ åãè¿æ¯å ä¸º ES6 æ¹åäºObjectæé å½æ°çè¡ä¸ºï¼ä¸æ¦åç°Objectæ¹æ³ä¸æ¯éè¿new Object()è¿ç§å½¢å¼è°ç¨ï¼ES6 è§å®Objectæé å½æ°ä¼å¿½ç¥åæ°ã\n\n\n# Mixin æ¨¡å¼çå®ç°\n\nMixin æçæ¯å¤ä¸ªå¯¹è±¡åæä¸ä¸ªæ°çå¯¹è±¡ï¼æ°å¯¹è±¡å·æåä¸ªç»ææåçæ¥å£ãå®çæç®åå®ç°å¦ä¸ã\n\nconst a = {\n  a: 'a'\n};\nconst b = {\n  b: 'b'\n};\nconst c = {...a, ...b}; // {a: 'a', b: 'b'}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼cå¯¹è±¡æ¯aå¯¹è±¡åbå¯¹è±¡çåæï¼å·æä¸¤èçæ¥å£ã\n\nä¸é¢æ¯ä¸ä¸ªæ´å®å¤çå®ç°ï¼å°å¤ä¸ªç±»çæ¥å£âæ··å¥âï¼mix inï¼å¦ä¸ä¸ªç±»ã\n\nfunction mix(...mixins) {\n  class Mix {\n    constructor() {\n      for (let mixin of mixins) {\n        copyProperties(this, new mixin()); // æ·è´å®ä¾å±æ§\n      }\n    }\n  }\n\n  for (let mixin of mixins) {\n    copyProperties(Mix, mixin); // æ·è´éæå±æ§\n    copyProperties(Mix.prototype, mixin.prototype); // æ·è´ååå±æ§\n  }\n\n  return Mix;\n}\n\nfunction copyProperties(target, source) {\n  for (let key of Reflect.ownKeys(source)) {\n    if ( key !== 'constructor'\n      && key !== 'prototype'\n      && key !== 'name'\n    ) {\n      let desc = Object.getOwnPropertyDescriptor(source, key);\n      Object.defineProperty(target, key, desc);\n    }\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n\nä¸é¢ä»£ç çmixå½æ°ï¼å¯ä»¥å°å¤ä¸ªå¯¹è±¡åæä¸ºä¸ä¸ªç±»ãä½¿ç¨çæ¶åï¼åªè¦ç»§æ¿è¿ä¸ªç±»å³å¯ã\n\nclass DistributedEdit extends mix(Loggable, Serializable) {\n  // ...\n}\n\n\n1\n2\n3\n",normalizedContent:"# class çç»§æ¿\n\n\n# ç®ä»\n\nclass å¯ä»¥éè¿extendså³é®å­å®ç°ç»§æ¿ï¼è¿æ¯ es5 çéè¿ä¿®æ¹ååé¾å®ç°ç»§æ¿ï¼è¦æ¸æ°åæ¹ä¾¿å¾å¤ã\n\nclass point {\n}\n\nclass colorpoint extends point {\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç å®ä¹äºä¸ä¸ªcolorpointç±»ï¼è¯¥ç±»éè¿extendså³é®å­ï¼ç»§æ¿äºpointç±»çææå±æ§åæ¹æ³ãä½æ¯ç±äºæ²¡æé¨ç½²ä»»ä½ä»£ç ï¼æä»¥è¿ä¸¤ä¸ªç±»å®å¨ä¸æ ·ï¼ç­äºå¤å¶äºä¸ä¸ªpointç±»ãä¸é¢ï¼æä»¬å¨colorpointåé¨å ä¸ä»£ç ã\n\nclass colorpoint extends point {\n  constructor(x, y, color) {\n    super(x, y); // è°ç¨ç¶ç±»çconstructor(x, y)\n    this.color = color;\n  }\n\n  tostring() {\n    return this.color + ' ' + super.tostring(); // è°ç¨ç¶ç±»çtostring()\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼constructoræ¹æ³åtostringæ¹æ³ä¹ä¸­ï¼é½åºç°äºsuperå³é®å­ï¼å®å¨è¿éè¡¨ç¤ºç¶ç±»çæé å½æ°ï¼ç¨æ¥æ°å»ºç¶ç±»çthiså¯¹è±¡ã\n\n**å­ç±»å¿é¡»å¨constructoræ¹æ³ä¸­è°ç¨superæ¹æ³ï¼å¦åæ°å»ºå®ä¾æ¶ä¼æ¥éã**è¿æ¯å ä¸ºå­ç±»èªå·±çthiså¯¹è±¡ï¼å¿é¡»åéè¿ç¶ç±»çæé å½æ°å®æå¡é ï¼å¾å°ä¸ç¶ç±»åæ ·çå®ä¾å±æ§åæ¹æ³ï¼ç¶ååå¯¹å¶è¿è¡å å·¥ï¼å ä¸å­ç±»èªå·±çå®ä¾å±æ§åæ¹æ³ãå¦æä¸è°ç¨superæ¹æ³ï¼å­ç±»å°±å¾ä¸å°thiså¯¹è±¡ã\n\nclass point { /* ... */ }\n\nclass colorpoint extends point {\n  constructor() {\n  }\n}\n\nlet cp = new colorpoint(); // referenceerror\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼colorpointç»§æ¿äºç¶ç±»pointï¼ä½æ¯å®çæé å½æ°æ²¡æè°ç¨superæ¹æ³ï¼å¯¼è´æ°å»ºå®ä¾æ¶æ¥éã\n\nes5 çç»§æ¿ï¼å®è´¨æ¯ååé å­ç±»çå®ä¾å¯¹è±¡thisï¼ç¶ååå°ç¶ç±»çæ¹æ³æ·»å å°thisä¸é¢ï¼parent.apply(this)ï¼ães6 çç»§æ¿æºå¶å®å¨ä¸åï¼å®è´¨æ¯åå°ç¶ç±»å®ä¾å¯¹è±¡çå±æ§åæ¹æ³ï¼å å°thisä¸é¢ï¼æä»¥å¿é¡»åè°ç¨superæ¹æ³ï¼ï¼ç¶ååç¨å­ç±»çæé å½æ°ä¿®æ¹thisã\n\nå¦æå­ç±»æ²¡æå®ä¹constructoræ¹æ³ï¼è¿ä¸ªæ¹æ³ä¼è¢«é»è®¤æ·»å ï¼ä»£ç å¦ä¸ãä¹å°±æ¯è¯´ï¼ä¸ç®¡ææ²¡ææ¾å¼å®ä¹ï¼ä»»ä½ä¸ä¸ªå­ç±»é½æconstructoræ¹æ³ã\n\nclass colorpoint extends point {\n}\n\n// ç­åäº\nclass colorpoint extends point {\n  constructor(...args) {\n    super(...args);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦ä¸ä¸ªéè¦æ³¨æçå°æ¹æ¯ï¼**å¨å­ç±»çæé å½æ°ä¸­ï¼åªæè°ç¨superä¹åï¼æå¯ä»¥ä½¿ç¨thiså³é®å­ï¼å¦åä¼æ¥éã**è¿æ¯å ä¸ºå­ç±»å®ä¾çæå»ºï¼åºäºç¶ç±»å®ä¾ï¼åªæsuperæ¹æ³æè½è°ç¨ç¶ç±»å®ä¾ã\n\nclass point {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n}\n\nclass colorpoint extends point {\n  constructor(x, y, color) {\n    this.color = color; // referenceerror\n    super(x, y);\n    this.color = color; // æ­£ç¡®\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç±»çconstructoræ¹æ³æ²¡æè°ç¨superä¹åï¼å°±ä½¿ç¨thiså³é®å­ï¼ç»ææ¥éï¼èæ¾å¨superæ¹æ³ä¹åå°±æ¯æ­£ç¡®çã\n\nä¸é¢æ¯çæå­ç±»å®ä¾çä»£ç ã\n\nlet cp = new colorpoint(25, 8, 'green');\n\ncp instanceof colorpoint // true\ncp instanceof point // true\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼å®ä¾å¯¹è±¡cpåæ¶æ¯colorpointåpointä¸¤ä¸ªç±»çå®ä¾ï¼è¿ä¸ es5 çè¡ä¸ºå®å¨ä¸è´ã\n\næåï¼ç¶ç±»çéææ¹æ³ï¼ä¹ä¼è¢«å­ç±»ç»§æ¿ã\n\nclass a {\n  static hello() {\n    console.log('hello world');\n  }\n}\n\nclass b extends a {\n}\n\nb.hello()  // hello world\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼hello()æ¯aç±»çéææ¹æ³ï¼bç»§æ¿aï¼ä¹ç»§æ¿äºaçéææ¹æ³ã\n\n\n# object.getprototypeof()\n\nobject.getprototypeofæ¹æ³å¯ä»¥ç¨æ¥ä»å­ç±»ä¸è·åç¶ç±»ã\n\nobject.getprototypeof(colorpoint) === point\n// true\n\n\n1\n2\n\n\nå æ­¤ï¼å¯ä»¥ä½¿ç¨è¿ä¸ªæ¹æ³å¤æ­ï¼ä¸ä¸ªç±»æ¯å¦ç»§æ¿äºå¦ä¸ä¸ªç±»ã\n\n\n# super å³é®å­\n\nsuperè¿ä¸ªå³é®å­ï¼æ¢å¯ä»¥å½ä½å½æ°ä½¿ç¨ï¼ä¹å¯ä»¥å½ä½å¯¹è±¡ä½¿ç¨ãå¨è¿ä¸¤ç§æåµä¸ï¼å®çç¨æ³å®å¨ä¸åã\n\nç¬¬ä¸ç§æåµï¼superä½ä¸ºå½æ°è°ç¨æ¶ï¼ä»£è¡¨ç¶ç±»çæé å½æ°ães6 è¦æ±ï¼å­ç±»çæé å½æ°å¿é¡»æ§è¡ä¸æ¬¡superå½æ°ã\n\nclass a {}\n\nclass b extends a {\n  constructor() {\n    super();\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç±»bçæé å½æ°ä¹ä¸­çsuper()ï¼ä»£è¡¨è°ç¨ç¶ç±»çæé å½æ°ãè¿æ¯å¿é¡»çï¼å¦å javascript å¼æä¼æ¥éã\n\næ³¨æï¼superè½ç¶ä»£è¡¨äºç¶ç±»açæé å½æ°ï¼ä½æ¯è¿åçæ¯å­ç±»bçå®ä¾ï¼å³superåé¨çthisæçæ¯bçå®ä¾ï¼å æ­¤super()å¨è¿éç¸å½äºa.prototype.constructor.call(this)ã\n\nclass a {\n  constructor() {\n    console.log(new.target.name);\n  }\n}\nclass b extends a {\n  constructor() {\n    super();\n  }\n}\nnew a() // a\nnew b() // b\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼new.targetæåå½åæ­£å¨æ§è¡çå½æ°ãå¯ä»¥çå°ï¼å¨super()æ§è¡æ¶ï¼å®æåçæ¯å­ç±»bçæé å½æ°ï¼èä¸æ¯ç¶ç±»açæé å½æ°ãä¹å°±æ¯è¯´ï¼super()åé¨çthisæåçæ¯bã\n\nä½ä¸ºå½æ°æ¶ï¼super()åªè½ç¨å¨å­ç±»çæé å½æ°ä¹ä¸­ï¼ç¨å¨å¶ä»å°æ¹å°±ä¼æ¥éã\n\nclass a {}\n\nclass b extends a {\n  m() {\n    super(); // æ¥é\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼super()ç¨å¨bç±»çmæ¹æ³ä¹ä¸­ï¼å°±ä¼é æè¯­æ³éè¯¯ã\n\nç¬¬äºç§æåµï¼superä½ä¸ºå¯¹è±¡æ¶ï¼å¨æ®éæ¹æ³ä¸­ï¼æåç¶ç±»çååå¯¹è±¡ï¼å¨éææ¹æ³ä¸­ï¼æåç¶ç±»ã\n\nclass a {\n  p() {\n    return 2;\n  }\n}\n\nclass b extends a {\n  constructor() {\n    super();\n    console.log(super.p()); // 2\n  }\n}\n\nlet b = new b();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç±»bå½ä¸­çsuper.p()ï¼å°±æ¯å°superå½ä½ä¸ä¸ªå¯¹è±¡ä½¿ç¨ãè¿æ¶ï¼superå¨æ®éæ¹æ³ä¹ä¸­ï¼æåa.prototypeï¼æä»¥super.p()å°±ç¸å½äºa.prototype.p()ã\n\nè¿ééè¦æ³¨æï¼ç±äºsuperæåç¶ç±»çååå¯¹è±¡ï¼æä»¥å®ä¹å¨ç¶ç±»å®ä¾ä¸çæ¹æ³æå±æ§ï¼æ¯æ æ³éè¿superè°ç¨çã\n\nclass a {\n  constructor() {\n    this.p = 2; // è¿æ¯å®äºå¨å®ä¾ä¸çå±æ§\n  }\n}\n\nclass b extends a {\n  get m() {\n    return super.p;\n  }\n}\n\nlet b = new b();\nb.m // undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼pæ¯ç¶ç±»aå®ä¾çå±æ§ï¼super.på°±å¼ç¨ä¸å°å®ã\n\nå¦æå±æ§å®ä¹å¨ç¶ç±»çååå¯¹è±¡ä¸ï¼superå°±å¯ä»¥åå°ã\n\nclass a {}\na.prototype.x = 2;\n\nclass b extends a {\n  constructor() {\n    super();\n    console.log(super.x) // 2\n  }\n}\n\nlet b = new b();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼å±æ§xæ¯å®ä¹å¨a.prototypeä¸é¢çï¼æä»¥super.xå¯ä»¥åå°å®çå¼ã\n\nes6 è§å®ï¼å¨å­ç±»æ®éæ¹æ³ä¸­éè¿superè°ç¨ç¶ç±»çæ¹æ³æ¶ï¼æ¹æ³åé¨çthisæåå½åçå­ç±»å®ä¾ã\n\nclass a {\n  constructor() {\n    this.x = 1;\n  }\n  print() {\n    console.log(this.x);\n  }\n}\n\nclass b extends a {\n  constructor() {\n    super();\n    this.x = 2;\n  }\n  m() {\n    super.print();\n  }\n}\n\nlet b = new b();\nb.m() // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nä¸é¢ä»£ç ä¸­ï¼super.print()è½ç¶è°ç¨çæ¯a.prototype.print()ï¼ä½æ¯a.prototype.print()åé¨çthisæåå­ç±»bçå®ä¾ï¼å¯¼è´è¾åºçæ¯2ï¼èä¸æ¯1ãä¹å°±æ¯è¯´ï¼å®éä¸æ§è¡çæ¯super.print.call(this)ã\n\nç±äºthisæåå­ç±»å®ä¾ï¼æä»¥å¦æéè¿superå¯¹æä¸ªå±æ§èµå¼ï¼è¿æ¶superå°±æ¯thisï¼èµå¼çå±æ§ä¼åæå­ç±»å®ä¾çå±æ§ã\n\nclass a {\n  constructor() {\n    this.x = 1;\n  }\n}\n\nclass b extends a {\n  constructor() {\n    super();\n    this.x = 2;\n    super.x = 3;\n    console.log(super.x); // undefined\n    console.log(this.x); // 3\n  }\n}\n\nlet b = new b();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼super.xèµå¼ä¸º3ï¼è¿æ¶ç­åäºå¯¹this.xèµå¼ä¸º3ãèå½è¯»åsuper.xçæ¶åï¼è¯»çæ¯a.prototype.xï¼æä»¥è¿åundefinedã\n\nå¦æsuperä½ä¸ºå¯¹è±¡ï¼ç¨å¨éææ¹æ³ä¹ä¸­ï¼è¿æ¶superå°æåç¶ç±»ï¼èä¸æ¯ç¶ç±»çååå¯¹è±¡ã\n\nclass parent {\n  static mymethod(msg) {\n    console.log('static', msg);\n  }\n\n  mymethod(msg) {\n    console.log('instance', msg);\n  }\n}\n\nclass child extends parent {\n  static mymethod(msg) {\n    super.mymethod(msg);\n  }\n\n  mymethod(msg) {\n    super.mymethod(msg);\n  }\n}\n\nchild.mymethod(1); // static 1\n\nvar child = new child();\nchild.mymethod(2); // instance 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nä¸é¢ä»£ç ä¸­ï¼superå¨éææ¹æ³ä¹ä¸­æåç¶ç±»ï¼å¨æ®éæ¹æ³ä¹ä¸­æåç¶ç±»çååå¯¹è±¡ã\n\nå¦å¤ï¼å¨å­ç±»çéææ¹æ³ä¸­éè¿superè°ç¨ç¶ç±»çæ¹æ³æ¶ï¼æ¹æ³åé¨çthisæåå½åçå­ç±»ï¼èä¸æ¯å­ç±»çå®ä¾ã\n\nclass a {\n  constructor() {\n    this.x = 1;\n  }\n  static print() {\n    console.log(this.x);\n  }\n}\n\nclass b extends a {\n  constructor() {\n    super();\n    this.x = 2;\n  }\n  static m() {\n    super.print();\n  }\n}\n\nb.x = 3;\nb.m() // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nä¸é¢ä»£ç ä¸­ï¼éææ¹æ³b.méé¢ï¼super.printæåç¶ç±»çéææ¹æ³ãè¿ä¸ªæ¹æ³éé¢çthisæåçæ¯bï¼èä¸æ¯bçå®ä¾ã\n\næ³¨æï¼ä½¿ç¨superçæ¶åï¼å¿é¡»æ¾å¼æå®æ¯ä½ä¸ºå½æ°ãè¿æ¯ä½ä¸ºå¯¹è±¡ä½¿ç¨ï¼å¦åä¼æ¥éã\n\nclass a {}\n\nclass b extends a {\n  constructor() {\n    super();\n    console.log(super); // æ¥é\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼console.log(super)å½ä¸­çsuperï¼æ æ³çåºæ¯ä½ä¸ºå½æ°ä½¿ç¨ï¼è¿æ¯ä½ä¸ºå¯¹è±¡ä½¿ç¨ï¼æä»¥ javascript å¼æè§£æä»£ç çæ¶åå°±ä¼æ¥éãè¿æ¶ï¼å¦æè½æ¸æ°å°è¡¨æsuperçæ°æ®ç±»åï¼å°±ä¸ä¼æ¥éã\n\nclass a {}\n\nclass b extends a {\n  constructor() {\n    super();\n    console.log(super.valueof() instanceof b); // true\n  }\n}\n\nlet b = new b();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼super.valueof()è¡¨æsuperæ¯ä¸ä¸ªå¯¹è±¡ï¼å æ­¤å°±ä¸ä¼æ¥éãåæ¶ï¼ç±äºsuperä½¿å¾thisæåbçå®ä¾ï¼æä»¥super.valueof()è¿åçæ¯ä¸ä¸ªbçå®ä¾ã\n\næåï¼ç±äºå¯¹è±¡æ»æ¯ç»§æ¿å¶ä»å¯¹è±¡çï¼æä»¥å¯ä»¥å¨ä»»æä¸ä¸ªå¯¹è±¡ä¸­ï¼ä½¿ç¨superå³é®å­ã\n\nvar obj = {\n  tostring() {\n    return \"myobject: \" + super.tostring();\n  }\n};\n\nobj.tostring(); // myobject: [object object]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# ç±»ç prototype å±æ§å__proto__å±æ§\n\nå¤§å¤æ°æµè§å¨ç es5 å®ç°ä¹ä¸­ï¼æ¯ä¸ä¸ªå¯¹è±¡é½æ__proto__å±æ§ï¼æåå¯¹åºçæé å½æ°çprototypeå±æ§ãclass ä½ä¸ºæé å½æ°çè¯­æ³ç³ï¼åæ¶æprototypeå±æ§å__proto__å±æ§ï¼å æ­¤åæ¶å­å¨ä¸¤æ¡ç»§æ¿é¾ã\n\nï¼1ï¼å­ç±»ç__proto__å±æ§ï¼è¡¨ç¤ºæé å½æ°çç»§æ¿ï¼æ»æ¯æåç¶ç±»ã\n\nï¼2ï¼å­ç±»prototypeå±æ§ç__proto__å±æ§ï¼è¡¨ç¤ºæ¹æ³çç»§æ¿ï¼æ»æ¯æåç¶ç±»çprototypeå±æ§ã\n\nclass a {\n}\n\nclass b extends a {\n}\n\nb.__proto__ === a // true\nb.prototype.__proto__ === a.prototype // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç±»bç__proto__å±æ§æåç¶ç±»aï¼å­ç±»bçprototypeå±æ§ç__proto__å±æ§æåç¶ç±»açprototypeå±æ§ã\n\nè¿æ ·çç»ææ¯å ä¸ºï¼ç±»çç»§æ¿æ¯æç§ä¸é¢çæ¨¡å¼å®ç°çã\n\nclass a {\n}\n\nclass b {\n}\n\n// b çå®ä¾ç»§æ¿ a çå®ä¾\nobject.setprototypeof(b.prototype, a.prototype);\n\n// b ç»§æ¿ a çéæå±æ§\nobject.setprototypeof(b, a);\n\nconst b = new b();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nãå¯¹è±¡çæ©å±ãä¸ç« ç»åºè¿object.setprototypeofæ¹æ³çå®ç°ã\n\nobject.setprototypeof = function (obj, proto) {\n  obj.__proto__ = proto;\n  return obj;\n}\n\n\n1\n2\n3\n4\n\n\nå æ­¤ï¼å°±å¾å°äºä¸é¢çç»æã\n\nobject.setprototypeof(b.prototype, a.prototype);\n// ç­åäº\nb.prototype.__proto__ = a.prototype;\n\nobject.setprototypeof(b, a);\n// ç­åäº\nb.__proto__ = a;\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¿ä¸¤æ¡ç»§æ¿é¾ï¼å¯ä»¥è¿æ ·çè§£ï¼ä½ä¸ºä¸ä¸ªå¯¹è±¡ï¼å­ç±»ï¼bï¼çååï¼__proto__å±æ§ï¼æ¯ç¶ç±»ï¼aï¼ï¼ä½ä¸ºä¸ä¸ªæé å½æ°ï¼å­ç±»ï¼bï¼çååå¯¹è±¡ï¼prototypeå±æ§ï¼æ¯ç¶ç±»çååå¯¹è±¡ï¼prototypeå±æ§ï¼çå®ä¾ã\n\nb.prototype = object.create(a.prototype);\n// ç­åäº\nb.prototype.__proto__ = a.prototype;\n\n\n1\n2\n3\n\n\nextendså³é®å­åé¢å¯ä»¥è·å¤ç§ç±»åçå¼ã\n\nclass b extends a {\n}\n\n\n1\n2\n\n\nä¸é¢ä»£ç çaï¼åªè¦æ¯ä¸ä¸ªæprototypeå±æ§çå½æ°ï¼å°±è½è¢«bç»§æ¿ãç±äºå½æ°é½æprototypeå±æ§ï¼é¤äºfunction.prototypeå½æ°ï¼ï¼å æ­¤aå¯ä»¥æ¯ä»»æå½æ°ã\n\nä¸é¢ï¼è®¨è®ºä¸¤ç§æåµãç¬¬ä¸ç§ï¼å­ç±»ç»§æ¿objectç±»ã\n\nclass a extends object {\n}\n\na.__proto__ === object // true\na.prototype.__proto__ === object.prototype // true\n\n\n1\n2\n3\n4\n5\n\n\nè¿ç§æåµä¸ï¼aå¶å®å°±æ¯æé å½æ°objectçå¤å¶ï¼açå®ä¾å°±æ¯objectçå®ä¾ã\n\nç¬¬äºç§æåµï¼ä¸å­å¨ä»»ä½ç»§æ¿ã\n\nclass a {\n}\n\na.__proto__ === function.prototype // true\na.prototype.__proto__ === object.prototype // true\n\n\n1\n2\n3\n4\n5\n\n\nè¿ç§æåµä¸ï¼aä½ä¸ºä¸ä¸ªåºç±»ï¼å³ä¸å­å¨ä»»ä½ç»§æ¿ï¼ï¼å°±æ¯ä¸ä¸ªæ®éå½æ°ï¼æä»¥ç´æ¥ç»§æ¿function.prototypeãä½æ¯ï¼aè°ç¨åè¿åä¸ä¸ªç©ºå¯¹è±¡ï¼å³objectå®ä¾ï¼ï¼æä»¥a.prototype.__proto__æåæé å½æ°ï¼objectï¼çprototypeå±æ§ã\n\n\n# å®ä¾ç __proto__ å±æ§\n\nå­ç±»å®ä¾ç__proto__å±æ§ç__proto__å±æ§ï¼æåç¶ç±»å®ä¾ç__proto__å±æ§ãä¹å°±æ¯è¯´ï¼å­ç±»çååçååï¼æ¯ç¶ç±»çååã\n\nvar p1 = new point(2, 3);\nvar p2 = new colorpoint(2, 3, 'red');\n\np2.__proto__ === p1.__proto__ // false\np2.__proto__.__proto__ === p1.__proto__ // true\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼colorpointç»§æ¿äºpointï¼å¯¼è´åèååçååæ¯åèçååã\n\nå æ­¤ï¼éè¿å­ç±»å®ä¾ç__proto__.__proto__å±æ§ï¼å¯ä»¥ä¿®æ¹ç¶ç±»å®ä¾çè¡ä¸ºã\n\np2.__proto__.__proto__.printname = function () {\n  console.log('ha');\n};\n\np1.printname() // \"ha\"\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç å¨colorpointçå®ä¾p2ä¸åpointç±»æ·»å æ¹æ³ï¼ç»æå½±åå°äºpointçå®ä¾p1ã\n\n\n# åçæé å½æ°çç»§æ¿\n\nåçæé å½æ°æ¯æè¯­è¨åç½®çæé å½æ°ï¼éå¸¸ç¨æ¥çææ°æ®ç»æãecmascript çåçæé å½æ°å¤§è´æä¸é¢è¿äºã\n\n * boolean()\n * number()\n * string()\n * array()\n * date()\n * function()\n * regexp()\n * error()\n * object()\n\nä»¥åï¼è¿äºåçæé å½æ°æ¯æ æ³ç»§æ¿çï¼æ¯å¦ï¼ä¸è½èªå·±å®ä¹ä¸ä¸ªarrayçå­ç±»ã\n\nfunction myarray() {\n  array.apply(this, arguments);\n}\n\nmyarray.prototype = object.create(array.prototype, {\n  constructor: {\n    value: myarray,\n    writable: true,\n    configurable: true,\n    enumerable: true\n  }\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç å®ä¹äºä¸ä¸ªç»§æ¿ array çmyarrayç±»ãä½æ¯ï¼è¿ä¸ªç±»çè¡ä¸ºä¸arrayå®å¨ä¸ä¸è´ã\n\nvar colors = new myarray();\ncolors[0] = \"red\";\ncolors.length  // 0\n\ncolors.length = 0;\ncolors[0]  // \"red\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¹æä»¥ä¼åçè¿ç§æåµï¼æ¯å ä¸ºå­ç±»æ æ³è·å¾åçæé å½æ°çåé¨å±æ§ï¼éè¿array.apply()æèåéç»ååå¯¹è±¡é½ä¸è¡ãåçæé å½æ°ä¼å¿½ç¥applyæ¹æ³ä¼ å¥çthisï¼ä¹å°±æ¯è¯´ï¼åçæé å½æ°çthisæ æ³ç»å®ï¼å¯¼è´æ¿ä¸å°åé¨å±æ§ã\n\nes5 æ¯åæ°å»ºå­ç±»çå®ä¾å¯¹è±¡thisï¼åå°ç¶ç±»çå±æ§æ·»å å°å­ç±»ä¸ï¼ç±äºç¶ç±»çåé¨å±æ§æ æ³è·åï¼å¯¼è´æ æ³ç»§æ¿åççæé å½æ°ãæ¯å¦ï¼arrayæé å½æ°æä¸ä¸ªåé¨å±æ§[[defineownproperty]]ï¼ç¨æ¥å®ä¹æ°å±æ§æ¶ï¼æ´æ°lengthå±æ§ï¼è¿ä¸ªåé¨å±æ§æ æ³å¨å­ç±»è·åï¼å¯¼è´å­ç±»çlengthå±æ§è¡ä¸ºä¸æ­£å¸¸ã\n\nä¸é¢çä¾å­ä¸­ï¼æä»¬æ³è®©ä¸ä¸ªæ®éå¯¹è±¡ç»§æ¿errorå¯¹è±¡ã\n\nvar e = {};\n\nobject.getownpropertynames(error.call(e))\n// [ 'stack' ]\n\nobject.getownpropertynames(e)\n// []\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼æä»¬æ³éè¿error.call(e)è¿ç§åæ³ï¼è®©æ®éå¯¹è±¡eå·æerrorå¯¹è±¡çå®ä¾å±æ§ãä½æ¯ï¼error.call()å®å¨å¿½ç¥ä¼ å¥çç¬¬ä¸ä¸ªåæ°ï¼èæ¯è¿åä¸ä¸ªæ°å¯¹è±¡ï¼eæ¬èº«æ²¡æä»»ä½ååãè¿è¯æäºerror.call(e)è¿ç§åæ³ï¼æ æ³ç»§æ¿åçæé å½æ°ã\n\nes6 åè®¸ç»§æ¿åçæé å½æ°å®ä¹å­ç±»ï¼å ä¸º es6 æ¯åæ°å»ºç¶ç±»çå®ä¾å¯¹è±¡thisï¼ç¶ååç¨å­ç±»çæé å½æ°ä¿®é¥°thisï¼ä½¿å¾ç¶ç±»çææè¡ä¸ºé½å¯ä»¥ç»§æ¿ãä¸é¢æ¯ä¸ä¸ªç»§æ¿arrayçä¾å­ã\n\nclass myarray extends array {\n  constructor(...args) {\n    super(...args);\n  }\n}\n\nvar arr = new myarray();\narr[0] = 12;\narr.length // 1\n\narr.length = 0;\narr[0] // undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç å®ä¹äºä¸ä¸ªmyarrayç±»ï¼ç»§æ¿äºarrayæé å½æ°ï¼å æ­¤å°±å¯ä»¥ä»myarrayçææ°ç»çå®ä¾ãè¿æå³çï¼es6 å¯ä»¥èªå®ä¹åçæ°æ®ç»æï¼æ¯å¦arrayãstringç­ï¼çå­ç±»ï¼è¿æ¯ es5 æ æ³åå°çã\n\nä¸é¢è¿ä¸ªä¾å­ä¹è¯´æï¼extendså³é®å­ä¸ä»å¯ä»¥ç¨æ¥ç»§æ¿ç±»ï¼è¿å¯ä»¥ç¨æ¥ç»§æ¿åççæé å½æ°ãå æ­¤å¯ä»¥å¨åçæ°æ®ç»æçåºç¡ä¸ï¼å®ä¹èªå·±çæ°æ®ç»æãä¸é¢å°±æ¯å®ä¹äºä¸ä¸ªå¸¦çæ¬åè½çæ°ç»ã\n\nclass versionedarray extends array {\n  constructor() {\n    super();\n    this.history = [[]];\n  }\n  commit() {\n    this.history.push(this.slice());\n  }\n  revert() {\n    this.splice(0, this.length, ...this.history[this.history.length - 1]);\n  }\n}\n\nvar x = new versionedarray();\n\nx.push(1);\nx.push(2);\nx // [1, 2]\nx.history // [[]]\n\nx.commit();\nx.history // [[], [1, 2]]\n\nx.push(3);\nx // [1, 2, 3]\nx.history // [[], [1, 2]]\n\nx.revert();\nx // [1, 2]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nä¸é¢ä»£ç ä¸­ï¼versionedarrayä¼éè¿commitæ¹æ³ï¼å°èªå·±çå½åç¶æçæä¸ä¸ªçæ¬å¿«ç§ï¼å­å¥historyå±æ§ãrevertæ¹æ³ç¨æ¥å°æ°ç»éç½®ä¸ºææ°ä¸æ¬¡ä¿å­ççæ¬ãé¤æ­¤ä¹å¤ï¼versionedarrayä¾ç¶æ¯ä¸ä¸ªæ®éæ°ç»ï¼ææåççæ°ç»æ¹æ³é½å¯ä»¥å¨å®ä¸é¢è°ç¨ã\n\nä¸é¢æ¯ä¸ä¸ªèªå®ä¹errorå­ç±»çä¾å­ï¼å¯ä»¥ç¨æ¥å®å¶æ¥éæ¶çè¡ä¸ºã\n\nclass extendableerror extends error {\n  constructor(message) {\n    super();\n    this.message = message;\n    this.stack = (new error()).stack;\n    this.name = this.constructor.name;\n  }\n}\n\nclass myerror extends extendableerror {\n  constructor(m) {\n    super(m);\n  }\n}\n\nvar myerror = new myerror('ll');\nmyerror.message // \"ll\"\nmyerror instanceof error // true\nmyerror.name // \"myerror\"\nmyerror.stack\n// error\n//     at myerror.extendableerror\n//     ...\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\næ³¨æï¼ç»§æ¿objectçå­ç±»ï¼æä¸ä¸ªè¡ä¸ºå·®å¼ã\n\nclass newobj extends object{\n  constructor(){\n    super(...arguments);\n  }\n}\nvar o = new newobj({attr: true});\no.attr === true  // false\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼newobjç»§æ¿äºobjectï¼ä½æ¯æ æ³éè¿superæ¹æ³åç¶ç±»objectä¼ åãè¿æ¯å ä¸º es6 æ¹åäºobjectæé å½æ°çè¡ä¸ºï¼ä¸æ¦åç°objectæ¹æ³ä¸æ¯éè¿new object()è¿ç§å½¢å¼è°ç¨ï¼es6 è§å®objectæé å½æ°ä¼å¿½ç¥åæ°ã\n\n\n# mixin æ¨¡å¼çå®ç°\n\nmixin æçæ¯å¤ä¸ªå¯¹è±¡åæä¸ä¸ªæ°çå¯¹è±¡ï¼æ°å¯¹è±¡å·æåä¸ªç»ææåçæ¥å£ãå®çæç®åå®ç°å¦ä¸ã\n\nconst a = {\n  a: 'a'\n};\nconst b = {\n  b: 'b'\n};\nconst c = {...a, ...b}; // {a: 'a', b: 'b'}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼cå¯¹è±¡æ¯aå¯¹è±¡åbå¯¹è±¡çåæï¼å·æä¸¤èçæ¥å£ã\n\nä¸é¢æ¯ä¸ä¸ªæ´å®å¤çå®ç°ï¼å°å¤ä¸ªç±»çæ¥å£âæ··å¥âï¼mix inï¼å¦ä¸ä¸ªç±»ã\n\nfunction mix(...mixins) {\n  class mix {\n    constructor() {\n      for (let mixin of mixins) {\n        copyproperties(this, new mixin()); // æ·è´å®ä¾å±æ§\n      }\n    }\n  }\n\n  for (let mixin of mixins) {\n    copyproperties(mix, mixin); // æ·è´éæå±æ§\n    copyproperties(mix.prototype, mixin.prototype); // æ·è´ååå±æ§\n  }\n\n  return mix;\n}\n\nfunction copyproperties(target, source) {\n  for (let key of reflect.ownkeys(source)) {\n    if ( key !== 'constructor'\n      && key !== 'prototype'\n      && key !== 'name'\n    ) {\n      let desc = object.getownpropertydescriptor(source, key);\n      object.defineproperty(target, key, desc);\n    }\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n\nä¸é¢ä»£ç çmixå½æ°ï¼å¯ä»¥å°å¤ä¸ªå¯¹è±¡åæä¸ºä¸ä¸ªç±»ãä½¿ç¨çæ¶åï¼åªè¦ç»§æ¿è¿ä¸ªç±»å³å¯ã\n\nclass distributededit extends mix(loggable, serializable) {\n  // ...\n}\n\n\n1\n2\n3\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Class çåºæ¬è¯­æ³",frontmatter:{title:"Class çåºæ¬è¯­æ³",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/e831e1593c82bbe0",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/21.Class%20%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95.html",relativePath:"ãES6 æç¨ãç¬è®°/21.Class çåºæ¬è¯­æ³.md",key:"v-73e6fcbe",path:"/pages/e831e1593c82bbe0/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:18},{level:3,title:"ç±»çç±æ¥",slug:"ç±»çç±æ¥",normalizedTitle:"ç±»çç±æ¥",charIndex:25},{level:3,title:"constructor æ¹æ³",slug:"constructor-æ¹æ³",normalizedTitle:"constructor æ¹æ³",charIndex:2634},{level:3,title:"ç±»çå®ä¾",slug:"ç±»çå®ä¾",normalizedTitle:"ç±»çå®ä¾",charIndex:1522},{level:3,title:"åå¼å½æ°ï¼getterï¼åå­å¼å½æ°ï¼setterï¼",slug:"åå¼å½æ°-getter-åå­å¼å½æ°-setter",normalizedTitle:"åå¼å½æ°ï¼getterï¼åå­å¼å½æ°ï¼setterï¼",charIndex:4982},{level:3,title:"å±æ§è¡¨è¾¾å¼",slug:"å±æ§è¡¨è¾¾å¼",normalizedTitle:"å±æ§è¡¨è¾¾å¼",charIndex:5891},{level:3,title:"Class è¡¨è¾¾å¼",slug:"class-è¡¨è¾¾å¼",normalizedTitle:"class è¡¨è¾¾å¼",charIndex:6101},{level:3,title:"æ³¨æç¹",slug:"æ³¨æç¹",normalizedTitle:"æ³¨æç¹",charIndex:6764},{level:2,title:"éææ¹æ³",slug:"éææ¹æ³",normalizedTitle:"éææ¹æ³",charIndex:9310},{level:2,title:"å®ä¾å±æ§çæ°åæ³",slug:"å®ä¾å±æ§çæ°åæ³",normalizedTitle:"å®ä¾å±æ§çæ°åæ³",charIndex:10519},{level:2,title:"éæå±æ§",slug:"éæå±æ§",normalizedTitle:"éæå±æ§",charIndex:11358},{level:2,title:"ç§ææ¹æ³åç§æå±æ§",slug:"ç§ææ¹æ³åç§æå±æ§",normalizedTitle:"ç§ææ¹æ³åç§æå±æ§",charIndex:11976},{level:3,title:"ç°æçè§£å³æ¹æ¡",slug:"ç°æçè§£å³æ¹æ¡",normalizedTitle:"ç°æçè§£å³æ¹æ¡",charIndex:11990},{level:3,title:"ç§æå±æ§çææ¡",slug:"ç§æå±æ§çææ¡",normalizedTitle:"ç§æå±æ§çææ¡",charIndex:13124},{level:2,title:"new.target å±æ§",slug:"new-target-å±æ§",normalizedTitle:"new.target å±æ§",charIndex:15392}],excerpt:'<h1 id="class-çåºæ¬è¯­æ³"><a class="header-anchor" href="#class-çåºæ¬è¯­æ³">#</a> Class çåºæ¬è¯­æ³</h1>\n<h2 id="ç®ä»"><a class="header-anchor" href="#ç®ä»">#</a> ç®ä»</h2>\n<h3 id="ç±»çç±æ¥"><a class="header-anchor" href="#ç±»çç±æ¥">#</a> ç±»çç±æ¥</h3>\n<p>JavaScript è¯­è¨ä¸­ï¼çæå®ä¾å¯¹è±¡çä¼ ç»æ¹æ³æ¯éè¿æé å½æ°ãä¸é¢æ¯ä¸ä¸ªä¾å­ã</p>\n\x3c!--beforebegin--\x3e<div class="language-javascript line-numbers-mode">\x3c!--afterbegin--\x3e<pre v-pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Point</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token class-name">Point</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">toString</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token string">\'(\'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token string">\', \'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">+</span> <span class="token string">\')\'</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div>\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e',headersStr:"ç®ä» ç±»çç±æ¥ constructor æ¹æ³ ç±»çå®ä¾ åå¼å½æ°ï¼getterï¼åå­å¼å½æ°ï¼setterï¼ å±æ§è¡¨è¾¾å¼ Class è¡¨è¾¾å¼ æ³¨æç¹ éææ¹æ³ å®ä¾å±æ§çæ°åæ³ éæå±æ§ ç§ææ¹æ³åç§æå±æ§ ç°æçè§£å³æ¹æ¡ ç§æå±æ§çææ¡ new.target å±æ§",content:"# Class çåºæ¬è¯­æ³\n\n\n# ç®ä»\n\n\n# ç±»çç±æ¥\n\nJavaScript è¯­è¨ä¸­ï¼çæå®ä¾å¯¹è±¡çä¼ ç»æ¹æ³æ¯éè¿æé å½æ°ãä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nfunction Point(x, y) {\n  this.x = x;\n  this.y = y;\n}\n\nPoint.prototype.toString = function () {\n  return '(' + this.x + ', ' + this.y + ')';\n};\n\nvar p = new Point(1, 2);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢è¿ç§åæ³è·ä¼ ç»çé¢åå¯¹è±¡è¯­è¨ï¼æ¯å¦ C++ å Javaï¼å·®å¼å¾å¤§ï¼å¾å®¹æè®©æ°å­¦ä¹ è¿é¨è¯­è¨çç¨åºåæå°å°æã\n\nES6 æä¾äºæ´æ¥è¿ä¼ ç»è¯­è¨çåæ³ï¼å¼å¥äº Classï¼ç±»ï¼è¿ä¸ªæ¦å¿µï¼ä½ä¸ºå¯¹è±¡çæ¨¡æ¿ãéè¿classå³é®å­ï¼å¯ä»¥å®ä¹ç±»ã\n\nåºæ¬ä¸ï¼ES6 çclasså¯ä»¥çä½åªæ¯ä¸ä¸ªè¯­æ³ç³ï¼å®çç»å¤§é¨ååè½ï¼ES5 é½å¯ä»¥åå°ï¼æ°çclassåæ³åªæ¯è®©å¯¹è±¡ååçåæ³æ´å æ¸æ°ãæ´åé¢åå¯¹è±¡ç¼ç¨çè¯­æ³èå·²ãä¸é¢çä»£ç ç¨ ES6 çclassæ¹åï¼å°±æ¯ä¸é¢è¿æ ·ã\n\nclass Point {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n\n  toString() {\n    return '(' + this.x + ', ' + this.y + ')';\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å®ä¹äºä¸ä¸ªâç±»âï¼å¯ä»¥çå°éé¢æä¸ä¸ªconstructoræ¹æ³ï¼è¿å°±æ¯æé æ¹æ³ï¼èthiså³é®å­åä»£è¡¨å®ä¾å¯¹è±¡ãä¹å°±æ¯è¯´ï¼ES5 çæé å½æ°Pointï¼å¯¹åº ES6 çPointç±»çæé æ¹æ³ã\n\nPointç±»é¤äºæé æ¹æ³ï¼è¿å®ä¹äºä¸ä¸ªtoStringæ¹æ³ãæ³¨æï¼å®ä¹âç±»âçæ¹æ³çæ¶åï¼åé¢ä¸éè¦å ä¸functionè¿ä¸ªå³é®å­ï¼ç´æ¥æå½æ°å®ä¹æ¾è¿å»äºå°±å¯ä»¥äºãå¦å¤ï¼æ¹æ³ä¹é´ä¸éè¦éå·åéï¼å äºä¼æ¥éã\n\nES6 çç±»ï¼å®å¨å¯ä»¥çä½æé å½æ°çå¦ä¸ç§åæ³ã\n\nclass Point {\n  // ...\n}\n\ntypeof Point // \"function\"\nPoint === Point.prototype.constructor // true\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç è¡¨æï¼ç±»çæ°æ®ç±»åå°±æ¯å½æ°ï¼ç±»æ¬èº«å°±æåæé å½æ°ã\n\nä½¿ç¨çæ¶åï¼ä¹æ¯ç´æ¥å¯¹ç±»ä½¿ç¨newå½ä»¤ï¼è·æé å½æ°çç¨æ³å®å¨ä¸è´ã\n\nclass Bar {\n  doStuff() {\n    console.log('stuff');\n  }\n}\n\nvar b = new Bar();\nb.doStuff() // \"stuff\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næé å½æ°çprototypeå±æ§ï¼å¨ ES6 çâç±»âä¸é¢ç»§ç»­å­å¨ãäºå®ä¸ï¼ç±»çæææ¹æ³é½å®ä¹å¨ç±»çprototypeå±æ§ä¸é¢ã\n\nclass Point {\n  constructor() {\n    // ...\n  }\n\n  toString() {\n    // ...\n  }\n\n  toValue() {\n    // ...\n  }\n}\n\n// ç­åäº\n\nPoint.prototype = {\n  constructor() {},\n  toString() {},\n  toValue() {},\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nå¨ç±»çå®ä¾ä¸é¢è°ç¨æ¹æ³ï¼å¶å®å°±æ¯è°ç¨ååä¸çæ¹æ³ã\n\nclass B {}\nlet b = new B();\n\nb.constructor === B.prototype.constructor // true\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼bæ¯Bç±»çå®ä¾ï¼å®çconstructoræ¹æ³å°±æ¯Bç±»ååçconstructoræ¹æ³ã\n\nç±äºç±»çæ¹æ³é½å®ä¹å¨prototypeå¯¹è±¡ä¸é¢ï¼æä»¥ç±»çæ°æ¹æ³å¯ä»¥æ·»å å¨prototypeå¯¹è±¡ä¸é¢ãObject.assignæ¹æ³å¯ä»¥å¾æ¹ä¾¿å°ä¸æ¬¡åç±»æ·»å å¤ä¸ªæ¹æ³ã\n\nclass Point {\n  constructor(){\n    // ...\n  }\n}\n\nObject.assign(Point.prototype, {\n  toString(){},\n  toValue(){}\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nprototypeå¯¹è±¡çconstructorå±æ§ï¼ç´æ¥æåâç±»âçæ¬èº«ï¼è¿ä¸ ES5 çè¡ä¸ºæ¯ä¸è´çã\n\nPoint.prototype.constructor === Point // true\n\n\n1\n\n\nå¦å¤ï¼ç±»çåé¨ææå®ä¹çæ¹æ³ï¼é½æ¯ä¸å¯æä¸¾çï¼non-enumerableï¼ã\n\nclass Point {\n  constructor(x, y) {\n    // ...\n  }\n\n  toString() {\n    // ...\n  }\n}\n\nObject.keys(Point.prototype)\n// []\nObject.getOwnPropertyNames(Point.prototype)\n// [\"constructor\",\"toString\"]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼toStringæ¹æ³æ¯Pointç±»åé¨å®ä¹çæ¹æ³ï¼å®æ¯ä¸å¯æä¸¾çãè¿ä¸ç¹ä¸ ES5 çè¡ä¸ºä¸ä¸è´ã\n\nvar Point = function (x, y) {\n  // ...\n};\n\nPoint.prototype.toString = function() {\n  // ...\n};\n\nObject.keys(Point.prototype)\n// [\"toString\"]\nObject.getOwnPropertyNames(Point.prototype)\n// [\"constructor\",\"toString\"]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç éç¨ ES5 çåæ³ï¼toStringæ¹æ³å°±æ¯å¯æä¸¾çã\n\n\n# constructor æ¹æ³\n\nconstructoræ¹æ³æ¯ç±»çé»è®¤æ¹æ³ï¼éè¿newå½ä»¤çæå¯¹è±¡å®ä¾æ¶ï¼èªå¨è°ç¨è¯¥æ¹æ³ãä¸ä¸ªç±»å¿é¡»æconstructoræ¹æ³ï¼å¦ææ²¡ææ¾å¼å®ä¹ï¼ä¸ä¸ªç©ºçconstructoræ¹æ³ä¼è¢«é»è®¤æ·»å ã\n\nclass Point {\n}\n\n// ç­åäº\nclass Point {\n  constructor() {}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼å®ä¹äºä¸ä¸ªç©ºçç±»Pointï¼JavaScript å¼æä¼èªå¨ä¸ºå®æ·»å ä¸ä¸ªç©ºçconstructoræ¹æ³ã\n\nconstructoræ¹æ³é»è®¤è¿åå®ä¾å¯¹è±¡ï¼å³thisï¼ï¼å®å¨å¯ä»¥æå®è¿åå¦å¤ä¸ä¸ªå¯¹è±¡ã\n\nclass Foo {\n  constructor() {\n    return Object.create(null);\n  }\n}\n\nnew Foo() instanceof Foo\n// false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼constructorå½æ°è¿åä¸ä¸ªå¨æ°çå¯¹è±¡ï¼ç»æå¯¼è´å®ä¾å¯¹è±¡ä¸æ¯Fooç±»çå®ä¾ã\n\nç±»å¿é¡»ä½¿ç¨newè°ç¨ï¼å¦åä¼æ¥éãè¿æ¯å®è·æ®éæé å½æ°çä¸ä¸ªä¸»è¦åºå«ï¼åèä¸ç¨newä¹å¯ä»¥æ§è¡ã\n\nclass Foo {\n  constructor() {\n    return Object.create(null);\n  }\n}\n\nFoo()\n// TypeError: Class constructor Foo cannot be invoked without 'new'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# ç±»çå®ä¾\n\nçæç±»çå®ä¾çåæ³ï¼ä¸ ES5 å®å¨ä¸æ ·ï¼ä¹æ¯ä½¿ç¨newå½ä»¤ãåé¢è¯´è¿ï¼å¦æå¿è®°å ä¸newï¼åå½æ°é£æ ·è°ç¨Classï¼å°ä¼æ¥éã\n\nclass Point {\n  // ...\n}\n\n// æ¥é\nvar point = Point(2, 3);\n\n// æ­£ç¡®\nvar point = new Point(2, 3);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸ ES5 ä¸æ ·ï¼å®ä¾çå±æ§é¤éæ¾å¼å®ä¹å¨å¶æ¬èº«ï¼å³å®ä¹å¨thiså¯¹è±¡ä¸ï¼ï¼å¦åé½æ¯å®ä¹å¨ååä¸ï¼å³å®ä¹å¨classä¸ï¼ã\n\n//å®ä¹ç±»\nclass Point {\n\n  constructor(x, y) { // constructorå±æ§å®ä¹å¨ååä¸\n    this.x = x; // xå±æ§å®ä¹å¨å®ä¾ä¸\n    this.y = y; // yå±æ§å®ä¹å¨å®ä¾ä¸\n  }\n\n  toString() { // toStringå±æ§å®ä¹å¨ååä¸\n    return '(' + this.x + ', ' + this.y + ')';\n  }\n\n}\n\nvar point = new Point(2, 3);\n\npoint.toString() // (2, 3)\n\npoint.hasOwnProperty('x') // true\npoint.hasOwnProperty('y') // true\npoint.hasOwnProperty('toString') // false\npoint.__proto__.hasOwnProperty('toString') // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\nä¸é¢ä»£ç ä¸­ï¼xåyé½æ¯å®ä¾å¯¹è±¡pointèªèº«çå±æ§ï¼å ä¸ºå®ä¹å¨thisåéä¸ï¼ï¼æä»¥hasOwnPropertyæ¹æ³è¿åtrueï¼ètoStringæ¯ååå¯¹è±¡çå±æ§ï¼å ä¸ºå®ä¹å¨Pointç±»ä¸ï¼ï¼æä»¥hasOwnPropertyæ¹æ³è¿åfalseãè¿äºé½ä¸ ES5 çè¡ä¸ºä¿æä¸è´ã\n\nä¸ ES5 ä¸æ ·ï¼ç±»çææå®ä¾å±äº«ä¸ä¸ªååå¯¹è±¡ã\n\nvar p1 = new Point(2,3);\nvar p2 = new Point(3,2);\n\np1.__proto__ === p2.__proto__\n//true\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼p1åp2é½æ¯Pointçå®ä¾ï¼å®ä»¬çååé½æ¯Point.prototypeï¼æä»¥__proto__å±æ§æ¯ç¸ç­çã\n\nè¿ä¹æå³çï¼å¯ä»¥éè¿å®ä¾ç__proto__å±æ§ä¸ºâç±»âæ·»å æ¹æ³ã\n\n> __proto__ å¹¶ä¸æ¯è¯­è¨æ¬èº«çç¹æ§ï¼è¿æ¯åå¤§ååå·ä½å®ç°æ¶æ·»å çç§æå±æ§ï¼è½ç¶ç®åå¾å¤ç°ä»£æµè§å¨ç JS å¼æä¸­é½æä¾äºè¿ä¸ªç§æå±æ§ï¼ä½ä¾æ§ä¸å»ºè®®å¨çäº§ä¸­ä½¿ç¨è¯¥å±æ§ï¼é¿åå¯¹ç¯å¢äº§çä¾èµãçäº§ç¯å¢ä¸­ï¼æä»¬å¯ä»¥ä½¿ç¨ Object.getPrototypeOf æ¹æ³æ¥è·åå®ä¾å¯¹è±¡çååï¼ç¶ååæ¥ä¸ºååæ·»å æ¹æ³/å±æ§ã\n\nvar p1 = new Point(2,3);\nvar p2 = new Point(3,2);\n\np1.__proto__.printName = function () { return 'Oops' };\n\np1.printName() // \"Oops\"\np2.printName() // \"Oops\"\n\nvar p3 = new Point(4,2);\np3.printName() // \"Oops\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å¨p1çååä¸æ·»å äºä¸ä¸ªprintNameæ¹æ³ï¼ç±äºp1çååå°±æ¯p2çååï¼å æ­¤p2ä¹å¯ä»¥è°ç¨è¿ä¸ªæ¹æ³ãèä¸ï¼æ­¤åæ°å»ºçå®ä¾p3ä¹å¯ä»¥è°ç¨è¿ä¸ªæ¹æ³ãè¿æå³çï¼ä½¿ç¨å®ä¾ç__proto__å±æ§æ¹åååï¼å¿é¡»ç¸å½è°¨æï¼ä¸æ¨èä½¿ç¨ï¼å ä¸ºè¿ä¼æ¹åâç±»âçåå§å®ä¹ï¼å½±åå°ææå®ä¾ã\n\n\n# åå¼å½æ°ï¼getterï¼åå­å¼å½æ°ï¼setterï¼\n\nä¸ ES5 ä¸æ ·ï¼å¨âç±»âçåé¨å¯ä»¥ä½¿ç¨getåsetå³é®å­ï¼å¯¹æä¸ªå±æ§è®¾ç½®å­å¼å½æ°ååå¼å½æ°ï¼æ¦æªè¯¥å±æ§çå­åè¡ä¸ºã\n\nclass MyClass {\n  constructor() {\n    // ...\n  }\n  get prop() {\n    return 'getter';\n  }\n  set prop(value) {\n    console.log('setter: '+value);\n  }\n}\n\nlet inst = new MyClass();\n\ninst.prop = 123;\n// setter: 123\n\ninst.prop\n// 'getter'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ä¸­ï¼propå±æ§æå¯¹åºçå­å¼å½æ°ååå¼å½æ°ï¼å æ­¤èµå¼åè¯»åè¡ä¸ºé½è¢«èªå®ä¹äºã\n\nå­å¼å½æ°ååå¼å½æ°æ¯è®¾ç½®å¨å±æ§ç Descriptor å¯¹è±¡ä¸çã\n\nclass CustomHTMLElement {\n  constructor(element) {\n    this.element = element;\n  }\n\n  get html() {\n    return this.element.innerHTML;\n  }\n\n  set html(value) {\n    this.element.innerHTML = value;\n  }\n}\n\nvar descriptor = Object.getOwnPropertyDescriptor(\n  CustomHTMLElement.prototype, \"html\"\n);\n\n\"get\" in descriptor  // true\n\"set\" in descriptor  // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¸é¢ä»£ç ä¸­ï¼å­å¼å½æ°ååå¼å½æ°æ¯å®ä¹å¨htmlå±æ§çæè¿°å¯¹è±¡ä¸é¢ï¼è¿ä¸ ES5 å®å¨ä¸è´ã\n\n\n# å±æ§è¡¨è¾¾å¼\n\nç±»çå±æ§åï¼å¯ä»¥éç¨è¡¨è¾¾å¼ã\n\nlet methodName = 'getArea';\n\nclass Square {\n  constructor(length) {\n    // ...\n  }\n\n  [methodName]() {\n    // ...\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼Squareç±»çæ¹æ³ågetAreaï¼æ¯ä»è¡¨è¾¾å¼å¾å°çã\n\n\n# Class è¡¨è¾¾å¼\n\nä¸å½æ°ä¸æ ·ï¼ç±»ä¹å¯ä»¥ä½¿ç¨è¡¨è¾¾å¼çå½¢å¼å®ä¹ã\n\nconst MyClass = class Me {\n  getClassName() {\n    return Me.name;\n  }\n};\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä½¿ç¨è¡¨è¾¾å¼å®ä¹äºä¸ä¸ªç±»ãéè¦æ³¨æçæ¯ï¼è¿ä¸ªç±»çåå­æ¯Meï¼ä½æ¯Meåªå¨ Class çåé¨å¯ç¨ï¼æä»£å½åç±»ãå¨ Class å¤é¨ï¼è¿ä¸ªç±»åªè½ç¨MyClasså¼ç¨ã\n\nlet inst = new MyClass();\ninst.getClassName() // Me\nMe.name // ReferenceError: Me is not defined\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼Meåªå¨ Class åé¨æå®ä¹ã\n\nå¦æç±»çåé¨æ²¡ç¨å°çè¯ï¼å¯ä»¥çç¥Meï¼ä¹å°±æ¯å¯ä»¥åæä¸é¢çå½¢å¼ã\n\nconst MyClass = class { /* ... */ };\n\n\n1\n\n\néç¨ Class è¡¨è¾¾å¼ï¼å¯ä»¥ååºç«å³æ§è¡ç Classã\n\nlet person = new class {\n  constructor(name) {\n    this.name = name;\n  }\n\n  sayName() {\n    console.log(this.name);\n  }\n}('å¼ ä¸');\n\nperson.sayName(); // \"å¼ ä¸\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼personæ¯ä¸ä¸ªç«å³æ§è¡çç±»çå®ä¾ã\n\n\n# æ³¨æç¹\n\nï¼1ï¼ä¸¥æ ¼æ¨¡å¼\n\nç±»åæ¨¡åçåé¨ï¼é»è®¤å°±æ¯ä¸¥æ ¼æ¨¡å¼ï¼æä»¥ä¸éè¦ä½¿ç¨use strictæå®è¿è¡æ¨¡å¼ãåªè¦ä½ çä»£ç åå¨ç±»ææ¨¡åä¹ä¸­ï¼å°±åªæä¸¥æ ¼æ¨¡å¼å¯ç¨ãèèå°æªæ¥ææçä»£ç ï¼å¶å®é½æ¯è¿è¡å¨æ¨¡åä¹ä¸­ï¼æä»¥ ES6 å®éä¸ææ´ä¸ªè¯­è¨åçº§å°äºä¸¥æ ¼æ¨¡å¼ã\n\nï¼2ï¼ä¸å­å¨æå\n\nç±»ä¸å­å¨åéæåï¼hoistï¼ï¼è¿ä¸ç¹ä¸ ES5 å®å¨ä¸åã\n\nnew Foo(); // ReferenceError\nclass Foo {}\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼Fooç±»ä½¿ç¨å¨åï¼å®ä¹å¨åï¼è¿æ ·ä¼æ¥éï¼å ä¸º ES6 ä¸ä¼æç±»çå£°ææåå°ä»£ç å¤´é¨ãè¿ç§è§å®çåå ä¸ä¸æè¦æå°çç»§æ¿æå³ï¼å¿é¡»ä¿è¯å­ç±»å¨ç¶ç±»ä¹åå®ä¹ã\n\n{\n  let Foo = class {};\n  class Bar extends Foo {\n  }\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çä»£ç ä¸ä¼æ¥éï¼å ä¸ºBarç»§æ¿Fooçæ¶åï¼Fooå·²ç»æå®ä¹äºãä½æ¯ï¼å¦æå­å¨classçæåï¼ä¸é¢ä»£ç å°±ä¼æ¥éï¼å ä¸ºclassä¼è¢«æåå°ä»£ç å¤´é¨ï¼èletå½ä»¤æ¯ä¸æåçï¼æä»¥å¯¼è´Barç»§æ¿Fooçæ¶åï¼Fooè¿æ²¡æå®ä¹ã\n\nï¼3ï¼name å±æ§\n\nç±äºæ¬è´¨ä¸ï¼ES6 çç±»åªæ¯ ES5 çæé å½æ°çä¸å±åè£ï¼æä»¥å½æ°çè®¸å¤ç¹æ§é½è¢«Classç»§æ¿ï¼åæ¬nameå±æ§ã\n\nclass Point {}\nPoint.name // \"Point\"\n\n\n1\n2\n\n\nnameå±æ§æ»æ¯è¿åç´§è·å¨classå³é®å­åé¢çç±»åã\n\nï¼4ï¼Generator æ¹æ³\n\nå¦ææä¸ªæ¹æ³ä¹åå ä¸æå·ï¼*ï¼ï¼å°±è¡¨ç¤ºè¯¥æ¹æ³æ¯ä¸ä¸ª Generator å½æ°ã\n\nclass Foo {\n  constructor(...args) {\n    this.args = args;\n  }\n  * [Symbol.iterator]() {\n    for (let arg of this.args) {\n      yield arg;\n    }\n  }\n}\n\nfor (let x of new Foo('hello', 'world')) {\n  console.log(x);\n}\n// hello\n// world\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼Fooç±»çSymbol.iteratoræ¹æ³åæä¸ä¸ªæå·ï¼è¡¨ç¤ºè¯¥æ¹æ³æ¯ä¸ä¸ª Generator å½æ°ãSymbol.iteratoræ¹æ³è¿åä¸ä¸ªFooç±»çé»è®¤éåå¨ï¼for...ofå¾ªç¯ä¼èªå¨è°ç¨è¿ä¸ªéåå¨ã\n\nï¼5ï¼this çæå\n\nç±»çæ¹æ³åé¨å¦æå«æthisï¼å®é»è®¤æåç±»çå®ä¾ãä½æ¯ï¼å¿é¡»éå¸¸å°å¿ï¼ä¸æ¦åç¬ä½¿ç¨è¯¥æ¹æ³ï¼å¾å¯è½æ¥éã\n\nclass Logger {\n  printName(name = 'there') {\n    this.print(`Hello ${name}`);\n  }\n\n  print(text) {\n    console.log(text);\n  }\n}\n\nconst logger = new Logger();\nconst { printName } = logger;\nprintName(); // TypeError: Cannot read property 'print' of undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼printNameæ¹æ³ä¸­çthisï¼é»è®¤æåLoggerç±»çå®ä¾ãä½æ¯ï¼å¦æå°è¿ä¸ªæ¹æ³æååºæ¥åç¬ä½¿ç¨ï¼thisä¼æåè¯¥æ¹æ³è¿è¡æ¶æå¨çç¯å¢ï¼ç±äº class åé¨æ¯ä¸¥æ ¼æ¨¡å¼ï¼æä»¥ this å®éæåçæ¯undefinedï¼ï¼ä»èå¯¼è´æ¾ä¸å°printæ¹æ³èæ¥éã\n\nä¸ä¸ªæ¯è¾ç®åçè§£å³æ¹æ³æ¯ï¼å¨æé æ¹æ³ä¸­ç»å®thisï¼è¿æ ·å°±ä¸ä¼æ¾ä¸å°printæ¹æ³äºã\n\nclass Logger {\n  constructor() {\n    this.printName = this.printName.bind(this);\n  }\n\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦ä¸ç§è§£å³æ¹æ³æ¯ä½¿ç¨ç®­å¤´å½æ°ã\n\nclass Obj {\n  constructor() {\n    this.getThis = () => this;\n  }\n}\n\nconst myObj = new Obj();\nmyObj.getThis() === myObj // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nç®­å¤´å½æ°åé¨çthisæ»æ¯æåå®ä¹æ¶æå¨çå¯¹è±¡ãä¸é¢ä»£ç ä¸­ï¼ç®­å¤´å½æ°ä½äºæé å½æ°åé¨ï¼å®çå®ä¹çæçæ¶åï¼æ¯å¨æé å½æ°æ§è¡çæ¶åãè¿æ¶ï¼ç®­å¤´å½æ°æå¨çè¿è¡ç¯å¢ï¼è¯å®æ¯å®ä¾å¯¹è±¡ï¼æä»¥thisä¼æ»æ¯æåå®ä¾å¯¹è±¡ã\n\nè¿æä¸ç§è§£å³æ¹æ³æ¯ä½¿ç¨Proxyï¼è·åæ¹æ³çæ¶åï¼èªå¨ç»å®thisã\n\nfunction selfish (target) {\n  const cache = new WeakMap();\n  const handler = {\n    get (target, key) {\n      const value = Reflect.get(target, key);\n      if (typeof value !== 'function') {\n        return value;\n      }\n      if (!cache.has(value)) {\n        cache.set(value, value.bind(target));\n      }\n      return cache.get(value);\n    }\n  };\n  const proxy = new Proxy(target, handler);\n  return proxy;\n}\n\nconst logger = selfish(new Logger());\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n# éææ¹æ³\n\nç±»ç¸å½äºå®ä¾çååï¼ææå¨ç±»ä¸­å®ä¹çæ¹æ³ï¼é½ä¼è¢«å®ä¾ç»§æ¿ãå¦æå¨ä¸ä¸ªæ¹æ³åï¼å ä¸staticå³é®å­ï¼å°±è¡¨ç¤ºè¯¥æ¹æ³ä¸ä¼è¢«å®ä¾ç»§æ¿ï¼èæ¯ç´æ¥éè¿ç±»æ¥è°ç¨ï¼è¿å°±ç§°ä¸ºâéææ¹æ³âã\n\nclass Foo {\n  static classMethod() {\n    return 'hello';\n  }\n}\n\nFoo.classMethod() // 'hello'\n\nvar foo = new Foo();\nfoo.classMethod()\n// TypeError: foo.classMethod is not a function\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼Fooç±»çclassMethodæ¹æ³åæstaticå³é®å­ï¼è¡¨æè¯¥æ¹æ³æ¯ä¸ä¸ªéææ¹æ³ï¼å¯ä»¥ç´æ¥å¨Fooç±»ä¸è°ç¨ï¼Foo.classMethod()ï¼ï¼èä¸æ¯å¨Fooç±»çå®ä¾ä¸è°ç¨ãå¦æå¨å®ä¾ä¸è°ç¨éææ¹æ³ï¼ä¼æåºä¸ä¸ªéè¯¯ï¼è¡¨ç¤ºä¸å­å¨è¯¥æ¹æ³ã\n\næ³¨æï¼å¦æéææ¹æ³åå«thiså³é®å­ï¼è¿ä¸ªthisæçæ¯ç±»ï¼èä¸æ¯å®ä¾ã\n\nclass Foo {\n  static bar() {\n    this.baz();\n  }\n  static baz() {\n    console.log('hello');\n  }\n  baz() {\n    console.log('world');\n  }\n}\n\nFoo.bar() // hello\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼éææ¹æ³barè°ç¨äºthis.bazï¼è¿éçthisæçæ¯Fooç±»ï¼èä¸æ¯Fooçå®ä¾ï¼ç­åäºè°ç¨Foo.bazãå¦å¤ï¼ä»è¿ä¸ªä¾å­è¿å¯ä»¥çåºï¼éææ¹æ³å¯ä»¥ä¸ééææ¹æ³éåã\n\nç¶ç±»çéææ¹æ³ï¼å¯ä»¥è¢«å­ç±»ç»§æ¿ã\n\nclass Foo {\n  static classMethod() {\n    return 'hello';\n  }\n}\n\nclass Bar extends Foo {\n}\n\nBar.classMethod() // 'hello'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¶ç±»Fooæä¸ä¸ªéææ¹æ³ï¼å­ç±»Barå¯ä»¥è°ç¨è¿ä¸ªæ¹æ³ã\n\néææ¹æ³ä¹æ¯å¯ä»¥ä»superå¯¹è±¡ä¸è°ç¨çã\n\nclass Foo {\n  static classMethod() {\n    return 'hello';\n  }\n}\n\nclass Bar extends Foo {\n  static classMethod() {\n    return super.classMethod() + ', too';\n  }\n}\n\nBar.classMethod() // \"hello, too\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# å®ä¾å±æ§çæ°åæ³\n\nå®ä¾å±æ§é¤äºå®ä¹å¨constructor()æ¹æ³éé¢çthisä¸é¢ï¼ä¹å¯ä»¥å®ä¹å¨ç±»çæé¡¶å±ã\n\nclass IncreasingCounter {\n  constructor() {\n    this._count = 0;\n  }\n  get value() {\n    console.log('Getting the current value!');\n    return this._count;\n  }\n  increment() {\n    this._count++;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼å®ä¾å±æ§this._countå®ä¹å¨constructor()æ¹æ³éé¢ãå¦ä¸ç§åæ³æ¯ï¼è¿ä¸ªå±æ§ä¹å¯ä»¥å®ä¹å¨ç±»çæé¡¶å±ï¼å¶ä»é½ä¸åã\n\nclass IncreasingCounter {\n  _count = 0;\n  get value() {\n    console.log('Getting the current value!');\n    return this._count;\n  }\n  increment() {\n    this._count++;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼å®ä¾å±æ§_countä¸åå¼å½æ°value()åincrement()æ¹æ³ï¼å¤äºåä¸ä¸ªå±çº§ãè¿æ¶ï¼ä¸éè¦å¨å®ä¾å±æ§åé¢å ä¸thisã\n\nè¿ç§æ°åæ³çå¥½å¤æ¯ï¼ææå®ä¾å¯¹è±¡èªèº«çå±æ§é½å®ä¹å¨ç±»çå¤´é¨ï¼çä¸å»æ¯è¾æ´é½ï¼ä¸ç¼å°±è½çåºè¿ä¸ªç±»æåªäºå®ä¾å±æ§ã\n\nclass foo {\n  bar = 'hello';\n  baz = 'world';\n\n  constructor() {\n    // ...\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢çä»£ç ï¼ä¸ç¼å°±è½çåºï¼fooç±»æä¸¤ä¸ªå®ä¾å±æ§ï¼ä¸ç®äºç¶ãå¦å¤ï¼åèµ·æ¥ä¹æ¯è¾ç®æ´ã\n\n\n# éæå±æ§\n\néæå±æ§æçæ¯ Class æ¬èº«çå±æ§ï¼å³Class.propNameï¼èä¸æ¯å®ä¹å¨å®ä¾å¯¹è±¡ï¼thisï¼ä¸çå±æ§ã\n\nclass Foo {\n}\n\nFoo.prop = 1;\nFoo.prop // 1\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çåæ³ä¸ºFooç±»å®ä¹äºä¸ä¸ªéæå±æ§propã\n\nç®åï¼åªæè¿ç§åæ³å¯è¡ï¼å ä¸º ES6 æç¡®è§å®ï¼Class åé¨åªæéææ¹æ³ï¼æ²¡æéæå±æ§ãç°å¨æä¸ä¸ªææ¡æä¾äºç±»çéæå±æ§ï¼åæ³æ¯å¨å®ä¾å±æ§çåé¢ï¼å ä¸staticå³é®å­ã\n\nclass MyClass {\n  static myStaticProp = 42;\n\n  constructor() {\n    console.log(MyClass.myStaticProp); // 42\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¿ä¸ªæ°åæ³å¤§å¤§æ¹ä¾¿äºéæå±æ§çè¡¨è¾¾ã\n\n// èåæ³\nclass Foo {\n  // ...\n}\nFoo.prop = 1;\n\n// æ°åæ³\nclass Foo {\n  static prop = 1;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼èåæ³çéæå±æ§å®ä¹å¨ç±»çå¤é¨ãæ´ä¸ªç±»çæä»¥åï¼åçæéæå±æ§ãè¿æ ·è®©äººå¾å®¹æå¿½ç¥è¿ä¸ªéæå±æ§ï¼ä¹ä¸ç¬¦åç¸å³ä»£ç åºè¯¥æ¾å¨ä¸èµ·çä»£ç ç»ç»ååãå¦å¤ï¼æ°åæ³æ¯æ¾å¼å£°æï¼declarativeï¼ï¼èä¸æ¯èµå¼å¤çï¼è¯­ä¹æ´å¥½ã\n\n\n# ç§ææ¹æ³åç§æå±æ§\n\n\n# ç°æçè§£å³æ¹æ¡\n\nç§ææ¹æ³åç§æå±æ§ï¼æ¯åªè½å¨ç±»çåé¨è®¿é®çæ¹æ³åå±æ§ï¼å¤é¨ä¸è½è®¿é®ãè¿æ¯å¸¸è§éæ±ï¼æå©äºä»£ç çå°è£ï¼ä½ ES6 ä¸æä¾ï¼åªè½éè¿åéæ¹æ³æ¨¡æå®ç°ã\n\nä¸ç§åæ³æ¯å¨å½åä¸å ä»¥åºå«ã\n\nclass Widget {\n\n  // å¬ææ¹æ³\n  foo (baz) {\n    this._bar(baz);\n  }\n\n  // ç§ææ¹æ³\n  _bar(baz) {\n    return this.snaf = baz;\n  }\n\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼_baræ¹æ³åé¢çä¸åçº¿ï¼è¡¨ç¤ºè¿æ¯ä¸ä¸ªåªéäºåé¨ä½¿ç¨çç§ææ¹æ³ãä½æ¯ï¼è¿ç§å½åæ¯ä¸ä¿é©çï¼å¨ç±»çå¤é¨ï¼è¿æ¯å¯ä»¥è°ç¨å°è¿ä¸ªæ¹æ³ã\n\nå¦ä¸ç§æ¹æ³å°±æ¯ç´¢æ§å°ç§ææ¹æ³ç§»åºæ¨¡åï¼å ä¸ºæ¨¡ååé¨çæææ¹æ³é½æ¯å¯¹å¤å¯è§çã\n\nclass Widget {\n  foo (baz) {\n    bar.call(this, baz);\n  }\n\n  // ...\n}\n\nfunction bar(baz) {\n  return this.snaf = baz;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼fooæ¯å¬å¼æ¹æ³ï¼åé¨è°ç¨äºbar.call(this, baz)ãè¿ä½¿å¾barå®éä¸æä¸ºäºå½åæ¨¡åçç§ææ¹æ³ã\n\nè¿æä¸ç§æ¹æ³æ¯å©ç¨Symbolå¼çå¯ä¸æ§ï¼å°ç§ææ¹æ³çåå­å½åä¸ºä¸ä¸ªSymbolå¼ã\n\nconst bar = Symbol('bar');\nconst snaf = Symbol('snaf');\n\nexport default class myClass{\n\n  // å¬ææ¹æ³\n  foo(baz) {\n    this[bar](baz);\n  }\n\n  // ç§ææ¹æ³\n  [bar](baz) {\n    return this[snaf] = baz;\n  }\n\n  // ...\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼baråsnafé½æ¯Symbolå¼ï¼ä¸è¬æåµä¸æ æ³è·åå°å®ä»¬ï¼å æ­¤è¾¾å°äºç§ææ¹æ³åç§æå±æ§çææãä½æ¯ä¹ä¸æ¯ç»å¯¹ä¸è¡ï¼Reflect.ownKeys()ä¾ç¶å¯ä»¥æ¿å°å®ä»¬ã\n\nconst inst = new myClass();\n\nReflect.ownKeys(myClass.prototype)\n// [ 'constructor', 'foo', Symbol(bar) ]\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼Symbol å¼çå±æ§åä¾ç¶å¯ä»¥ä»ç±»çå¤é¨æ¿å°ã\n\n\n# ç§æå±æ§çææ¡\n\nç®åï¼æä¸ä¸ªææ¡ï¼ä¸ºclasså äºç§æå±æ§ãæ¹æ³æ¯å¨å±æ§åä¹åï¼ä½¿ç¨#è¡¨ç¤ºã\n\nclass IncreasingCounter {\n  #count = 0;\n  get value() {\n    console.log('Getting the current value!');\n    return this.#count;\n  }\n  increment() {\n    this.#count++;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼#countå°±æ¯ç§æå±æ§ï¼åªè½å¨ç±»çåé¨ä½¿ç¨ï¼this.#countï¼ãå¦æå¨ç±»çå¤é¨ä½¿ç¨ï¼å°±ä¼æ¥éã\n\nconst counter = new IncreasingCounter();\ncounter.#count // æ¥é\ncounter.#count = 42 // æ¥é\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç å¨ç±»çå¤é¨ï¼è¯»åç§æå±æ§ï¼å°±ä¼æ¥éã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nclass Point {\n  #x;\n\n  constructor(x = 0) {\n    this.#x = +x;\n  }\n\n  get x() {\n    return this.#x;\n  }\n\n  set x(value) {\n    this.#x = +value;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼#xå°±æ¯ç§æå±æ§ï¼å¨Pointç±»ä¹å¤æ¯è¯»åä¸å°è¿ä¸ªå±æ§çãç±äºäºå·#æ¯å±æ§åçä¸é¨åï¼ä½¿ç¨æ¶å¿é¡»å¸¦æ#ä¸èµ·ä½¿ç¨ï¼æä»¥#xåxæ¯ä¸¤ä¸ªä¸åçå±æ§ã\n\nä¹æä»¥è¦å¼å¥ä¸ä¸ªæ°çåç¼#è¡¨ç¤ºç§æå±æ§ï¼èæ²¡æéç¨privateå³é®å­ï¼æ¯å ä¸º JavaScript æ¯ä¸é¨å¨æè¯­è¨ï¼æ²¡æç±»åå£°æï¼ä½¿ç¨ç¬ç«çç¬¦å·ä¼¼ä¹æ¯å¯ä¸çæ¯è¾æ¹ä¾¿å¯é çæ¹æ³ï¼è½å¤åç¡®å°åºåä¸ç§å±æ§æ¯å¦ä¸ºç§æå±æ§ãå¦å¤ï¼Ruby è¯­è¨ä½¿ç¨@è¡¨ç¤ºç§æå±æ§ï¼ES6 æ²¡æç¨è¿ä¸ªç¬¦å·èä½¿ç¨#ï¼æ¯å ä¸º@å·²ç»è¢«çç»äº Decoratorã\n\nè¿ç§åæ³ä¸ä»å¯ä»¥åç§æå±æ§ï¼è¿å¯ä»¥ç¨æ¥åç§ææ¹æ³ã\n\nclass Foo {\n  #a;\n  #b;\n  constructor(a, b) {\n    this.#a = a;\n    this.#b = b;\n  }\n  #sum() {\n    return #a + #b;\n  }\n  printSum() {\n    console.log(this.#sum());\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼#sum()å°±æ¯ä¸ä¸ªç§ææ¹æ³ã\n\nå¦å¤ï¼ç§æå±æ§ä¹å¯ä»¥è®¾ç½® getter å setter æ¹æ³ã\n\nclass Counter {\n  #xValue = 0;\n\n  constructor() {\n    super();\n    // ...\n  }\n\n  get #x() { return #xValue; }\n  set #x(value) {\n    this.#xValue = value;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼#xæ¯ä¸ä¸ªç§æå±æ§ï¼å®çè¯»åé½éè¿get #x()åset #x()æ¥å®æã\n\nç§æå±æ§ä¸éäºä»thiså¼ç¨ï¼åªè¦æ¯å¨ç±»çåé¨ï¼å®ä¾ä¹å¯ä»¥å¼ç¨ç§æå±æ§ã\n\nclass Foo {\n  #privateValue = 42;\n  static getPrivateValue(foo) {\n    return foo.#privateValue;\n  }\n}\n\nFoo.getPrivateValue(new Foo()); // 42\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç åè®¸ä»å®ä¾fooä¸é¢å¼ç¨ç§æå±æ§ã\n\nç§æå±æ§åç§ææ¹æ³åé¢ï¼ä¹å¯ä»¥å ä¸staticå³é®å­ï¼è¡¨ç¤ºè¿æ¯ä¸ä¸ªéæçç§æå±æ§æç§ææ¹æ³ã\n\nclass FakeMath {\n  static PI = 22 / 7;\n  static #totallyRandomNumber = 4;\n\n  static #computeRandomNumber() {\n    return FakeMath.#totallyRandomNumber;\n  }\n\n  static random() {\n    console.log('I heard you like random numbersâ¦')\n    return FakeMath.#computeRandomNumber();\n  }\n}\n\nFakeMath.PI // 3.142857142857143\nFakeMath.random()\n// I heard you like random numbersâ¦\n// 4\nFakeMath.#totallyRandomNumber // æ¥é\nFakeMath.#computeRandomNumber() // æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¸é¢ä»£ç ä¸­ï¼#totallyRandomNumberæ¯ç§æå±æ§ï¼#computeRandomNumber()æ¯ç§ææ¹æ³ï¼åªè½å¨FakeMathè¿ä¸ªç±»çåé¨è°ç¨ï¼å¤é¨è°ç¨å°±ä¼æ¥éã\n\n\n# new.target å±æ§\n\nnewæ¯ä»æé å½æ°çæå®ä¾å¯¹è±¡çå½ä»¤ãES6 ä¸ºnewå½ä»¤å¼å¥äºä¸ä¸ªnew.targetå±æ§ï¼è¯¥å±æ§ä¸è¬ç¨å¨æé å½æ°ä¹ä¸­ï¼è¿ånewå½ä»¤ä½ç¨äºçé£ä¸ªæé å½æ°ãå¦ææé å½æ°ä¸æ¯éè¿newå½ä»¤æReflect.construct()è°ç¨çï¼new.targetä¼è¿åundefinedï¼å æ­¤è¿ä¸ªå±æ§å¯ä»¥ç¨æ¥ç¡®å®æé å½æ°æ¯æä¹è°ç¨çã\n\nfunction Person(name) {\n  if (new.target !== undefined) {\n    this.name = name;\n  } else {\n    throw new Error('å¿é¡»ä½¿ç¨ new å½ä»¤çæå®ä¾');\n  }\n}\n\n// å¦ä¸ç§åæ³\nfunction Person(name) {\n  if (new.target === Person) {\n    this.name = name;\n  } else {\n    throw new Error('å¿é¡»ä½¿ç¨ new å½ä»¤çæå®ä¾');\n  }\n}\n\nvar person = new Person('å¼ ä¸'); // æ­£ç¡®\nvar notAPerson = Person.call(person, 'å¼ ä¸');  // æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ç¡®ä¿æé å½æ°åªè½éè¿newå½ä»¤è°ç¨ã\n\nClass åé¨è°ç¨new.targetï¼è¿åå½å Classã\n\nclass Rectangle {\n  constructor(length, width) {\n    console.log(new.target === Rectangle);\n    this.length = length;\n    this.width = width;\n  }\n}\n\nvar obj = new Rectangle(3, 4); // è¾åº true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\néè¦æ³¨æçæ¯ï¼å­ç±»ç»§æ¿ç¶ç±»æ¶ï¼new.targetä¼è¿åå­ç±»ã\n\nclass Rectangle {\n  constructor(length, width) {\n    console.log(new.target === Rectangle);\n    // ...\n  }\n}\n\nclass Square extends Rectangle {\n  constructor(length) {\n    super(length, width);\n  }\n}\n\nvar obj = new Square(3); // è¾åº false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼new.targetä¼è¿åå­ç±»ã\n\nå©ç¨è¿ä¸ªç¹ç¹ï¼å¯ä»¥ååºä¸è½ç¬ç«ä½¿ç¨ãå¿é¡»ç»§æ¿åæè½ä½¿ç¨çç±»ã\n\nclass Shape {\n  constructor() {\n    if (new.target === Shape) {\n      throw new Error('æ¬ç±»ä¸è½å®ä¾å');\n    }\n  }\n}\n\nclass Rectangle extends Shape {\n  constructor(length, width) {\n    super();\n    // ...\n  }\n}\n\nvar x = new Shape();  // æ¥é\nvar y = new Rectangle(3, 4);  // æ­£ç¡®\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼Shapeç±»ä¸è½è¢«å®ä¾åï¼åªè½ç¨äºç»§æ¿ã\n\næ³¨æï¼å¨å½æ°å¤é¨ï¼ä½¿ç¨new.targetä¼æ¥éã",normalizedContent:"# class çåºæ¬è¯­æ³\n\n\n# ç®ä»\n\n\n# ç±»çç±æ¥\n\njavascript è¯­è¨ä¸­ï¼çæå®ä¾å¯¹è±¡çä¼ ç»æ¹æ³æ¯éè¿æé å½æ°ãä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nfunction point(x, y) {\n  this.x = x;\n  this.y = y;\n}\n\npoint.prototype.tostring = function () {\n  return '(' + this.x + ', ' + this.y + ')';\n};\n\nvar p = new point(1, 2);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢è¿ç§åæ³è·ä¼ ç»çé¢åå¯¹è±¡è¯­è¨ï¼æ¯å¦ c++ å javaï¼å·®å¼å¾å¤§ï¼å¾å®¹æè®©æ°å­¦ä¹ è¿é¨è¯­è¨çç¨åºåæå°å°æã\n\nes6 æä¾äºæ´æ¥è¿ä¼ ç»è¯­è¨çåæ³ï¼å¼å¥äº classï¼ç±»ï¼è¿ä¸ªæ¦å¿µï¼ä½ä¸ºå¯¹è±¡çæ¨¡æ¿ãéè¿classå³é®å­ï¼å¯ä»¥å®ä¹ç±»ã\n\nåºæ¬ä¸ï¼es6 çclasså¯ä»¥çä½åªæ¯ä¸ä¸ªè¯­æ³ç³ï¼å®çç»å¤§é¨ååè½ï¼es5 é½å¯ä»¥åå°ï¼æ°çclassåæ³åªæ¯è®©å¯¹è±¡ååçåæ³æ´å æ¸æ°ãæ´åé¢åå¯¹è±¡ç¼ç¨çè¯­æ³èå·²ãä¸é¢çä»£ç ç¨ es6 çclassæ¹åï¼å°±æ¯ä¸é¢è¿æ ·ã\n\nclass point {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n\n  tostring() {\n    return '(' + this.x + ', ' + this.y + ')';\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å®ä¹äºä¸ä¸ªâç±»âï¼å¯ä»¥çå°éé¢æä¸ä¸ªconstructoræ¹æ³ï¼è¿å°±æ¯æé æ¹æ³ï¼èthiså³é®å­åä»£è¡¨å®ä¾å¯¹è±¡ãä¹å°±æ¯è¯´ï¼es5 çæé å½æ°pointï¼å¯¹åº es6 çpointç±»çæé æ¹æ³ã\n\npointç±»é¤äºæé æ¹æ³ï¼è¿å®ä¹äºä¸ä¸ªtostringæ¹æ³ãæ³¨æï¼å®ä¹âç±»âçæ¹æ³çæ¶åï¼åé¢ä¸éè¦å ä¸functionè¿ä¸ªå³é®å­ï¼ç´æ¥æå½æ°å®ä¹æ¾è¿å»äºå°±å¯ä»¥äºãå¦å¤ï¼æ¹æ³ä¹é´ä¸éè¦éå·åéï¼å äºä¼æ¥éã\n\nes6 çç±»ï¼å®å¨å¯ä»¥çä½æé å½æ°çå¦ä¸ç§åæ³ã\n\nclass point {\n  // ...\n}\n\ntypeof point // \"function\"\npoint === point.prototype.constructor // true\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç è¡¨æï¼ç±»çæ°æ®ç±»åå°±æ¯å½æ°ï¼ç±»æ¬èº«å°±æåæé å½æ°ã\n\nä½¿ç¨çæ¶åï¼ä¹æ¯ç´æ¥å¯¹ç±»ä½¿ç¨newå½ä»¤ï¼è·æé å½æ°çç¨æ³å®å¨ä¸è´ã\n\nclass bar {\n  dostuff() {\n    console.log('stuff');\n  }\n}\n\nvar b = new bar();\nb.dostuff() // \"stuff\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næé å½æ°çprototypeå±æ§ï¼å¨ es6 çâç±»âä¸é¢ç»§ç»­å­å¨ãäºå®ä¸ï¼ç±»çæææ¹æ³é½å®ä¹å¨ç±»çprototypeå±æ§ä¸é¢ã\n\nclass point {\n  constructor() {\n    // ...\n  }\n\n  tostring() {\n    // ...\n  }\n\n  tovalue() {\n    // ...\n  }\n}\n\n// ç­åäº\n\npoint.prototype = {\n  constructor() {},\n  tostring() {},\n  tovalue() {},\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nå¨ç±»çå®ä¾ä¸é¢è°ç¨æ¹æ³ï¼å¶å®å°±æ¯è°ç¨ååä¸çæ¹æ³ã\n\nclass b {}\nlet b = new b();\n\nb.constructor === b.prototype.constructor // true\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼bæ¯bç±»çå®ä¾ï¼å®çconstructoræ¹æ³å°±æ¯bç±»ååçconstructoræ¹æ³ã\n\nç±äºç±»çæ¹æ³é½å®ä¹å¨prototypeå¯¹è±¡ä¸é¢ï¼æä»¥ç±»çæ°æ¹æ³å¯ä»¥æ·»å å¨prototypeå¯¹è±¡ä¸é¢ãobject.assignæ¹æ³å¯ä»¥å¾æ¹ä¾¿å°ä¸æ¬¡åç±»æ·»å å¤ä¸ªæ¹æ³ã\n\nclass point {\n  constructor(){\n    // ...\n  }\n}\n\nobject.assign(point.prototype, {\n  tostring(){},\n  tovalue(){}\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nprototypeå¯¹è±¡çconstructorå±æ§ï¼ç´æ¥æåâç±»âçæ¬èº«ï¼è¿ä¸ es5 çè¡ä¸ºæ¯ä¸è´çã\n\npoint.prototype.constructor === point // true\n\n\n1\n\n\nå¦å¤ï¼ç±»çåé¨ææå®ä¹çæ¹æ³ï¼é½æ¯ä¸å¯æä¸¾çï¼non-enumerableï¼ã\n\nclass point {\n  constructor(x, y) {\n    // ...\n  }\n\n  tostring() {\n    // ...\n  }\n}\n\nobject.keys(point.prototype)\n// []\nobject.getownpropertynames(point.prototype)\n// [\"constructor\",\"tostring\"]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼tostringæ¹æ³æ¯pointç±»åé¨å®ä¹çæ¹æ³ï¼å®æ¯ä¸å¯æä¸¾çãè¿ä¸ç¹ä¸ es5 çè¡ä¸ºä¸ä¸è´ã\n\nvar point = function (x, y) {\n  // ...\n};\n\npoint.prototype.tostring = function() {\n  // ...\n};\n\nobject.keys(point.prototype)\n// [\"tostring\"]\nobject.getownpropertynames(point.prototype)\n// [\"constructor\",\"tostring\"]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç éç¨ es5 çåæ³ï¼tostringæ¹æ³å°±æ¯å¯æä¸¾çã\n\n\n# constructor æ¹æ³\n\nconstructoræ¹æ³æ¯ç±»çé»è®¤æ¹æ³ï¼éè¿newå½ä»¤çæå¯¹è±¡å®ä¾æ¶ï¼èªå¨è°ç¨è¯¥æ¹æ³ãä¸ä¸ªç±»å¿é¡»æconstructoræ¹æ³ï¼å¦ææ²¡ææ¾å¼å®ä¹ï¼ä¸ä¸ªç©ºçconstructoræ¹æ³ä¼è¢«é»è®¤æ·»å ã\n\nclass point {\n}\n\n// ç­åäº\nclass point {\n  constructor() {}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼å®ä¹äºä¸ä¸ªç©ºçç±»pointï¼javascript å¼æä¼èªå¨ä¸ºå®æ·»å ä¸ä¸ªç©ºçconstructoræ¹æ³ã\n\nconstructoræ¹æ³é»è®¤è¿åå®ä¾å¯¹è±¡ï¼å³thisï¼ï¼å®å¨å¯ä»¥æå®è¿åå¦å¤ä¸ä¸ªå¯¹è±¡ã\n\nclass foo {\n  constructor() {\n    return object.create(null);\n  }\n}\n\nnew foo() instanceof foo\n// false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼constructorå½æ°è¿åä¸ä¸ªå¨æ°çå¯¹è±¡ï¼ç»æå¯¼è´å®ä¾å¯¹è±¡ä¸æ¯fooç±»çå®ä¾ã\n\nç±»å¿é¡»ä½¿ç¨newè°ç¨ï¼å¦åä¼æ¥éãè¿æ¯å®è·æ®éæé å½æ°çä¸ä¸ªä¸»è¦åºå«ï¼åèä¸ç¨newä¹å¯ä»¥æ§è¡ã\n\nclass foo {\n  constructor() {\n    return object.create(null);\n  }\n}\n\nfoo()\n// typeerror: class constructor foo cannot be invoked without 'new'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# ç±»çå®ä¾\n\nçæç±»çå®ä¾çåæ³ï¼ä¸ es5 å®å¨ä¸æ ·ï¼ä¹æ¯ä½¿ç¨newå½ä»¤ãåé¢è¯´è¿ï¼å¦æå¿è®°å ä¸newï¼åå½æ°é£æ ·è°ç¨classï¼å°ä¼æ¥éã\n\nclass point {\n  // ...\n}\n\n// æ¥é\nvar point = point(2, 3);\n\n// æ­£ç¡®\nvar point = new point(2, 3);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸ es5 ä¸æ ·ï¼å®ä¾çå±æ§é¤éæ¾å¼å®ä¹å¨å¶æ¬èº«ï¼å³å®ä¹å¨thiså¯¹è±¡ä¸ï¼ï¼å¦åé½æ¯å®ä¹å¨ååä¸ï¼å³å®ä¹å¨classä¸ï¼ã\n\n//å®ä¹ç±»\nclass point {\n\n  constructor(x, y) { // constructorå±æ§å®ä¹å¨ååä¸\n    this.x = x; // xå±æ§å®ä¹å¨å®ä¾ä¸\n    this.y = y; // yå±æ§å®ä¹å¨å®ä¾ä¸\n  }\n\n  tostring() { // tostringå±æ§å®ä¹å¨ååä¸\n    return '(' + this.x + ', ' + this.y + ')';\n  }\n\n}\n\nvar point = new point(2, 3);\n\npoint.tostring() // (2, 3)\n\npoint.hasownproperty('x') // true\npoint.hasownproperty('y') // true\npoint.hasownproperty('tostring') // false\npoint.__proto__.hasownproperty('tostring') // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\nä¸é¢ä»£ç ä¸­ï¼xåyé½æ¯å®ä¾å¯¹è±¡pointèªèº«çå±æ§ï¼å ä¸ºå®ä¹å¨thisåéä¸ï¼ï¼æä»¥hasownpropertyæ¹æ³è¿åtrueï¼ètostringæ¯ååå¯¹è±¡çå±æ§ï¼å ä¸ºå®ä¹å¨pointç±»ä¸ï¼ï¼æä»¥hasownpropertyæ¹æ³è¿åfalseãè¿äºé½ä¸ es5 çè¡ä¸ºä¿æä¸è´ã\n\nä¸ es5 ä¸æ ·ï¼ç±»çææå®ä¾å±äº«ä¸ä¸ªååå¯¹è±¡ã\n\nvar p1 = new point(2,3);\nvar p2 = new point(3,2);\n\np1.__proto__ === p2.__proto__\n//true\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼p1åp2é½æ¯pointçå®ä¾ï¼å®ä»¬çååé½æ¯point.prototypeï¼æä»¥__proto__å±æ§æ¯ç¸ç­çã\n\nè¿ä¹æå³çï¼å¯ä»¥éè¿å®ä¾ç__proto__å±æ§ä¸ºâç±»âæ·»å æ¹æ³ã\n\n> __proto__ å¹¶ä¸æ¯è¯­è¨æ¬èº«çç¹æ§ï¼è¿æ¯åå¤§ååå·ä½å®ç°æ¶æ·»å çç§æå±æ§ï¼è½ç¶ç®åå¾å¤ç°ä»£æµè§å¨ç js å¼æä¸­é½æä¾äºè¿ä¸ªç§æå±æ§ï¼ä½ä¾æ§ä¸å»ºè®®å¨çäº§ä¸­ä½¿ç¨è¯¥å±æ§ï¼é¿åå¯¹ç¯å¢äº§çä¾èµãçäº§ç¯å¢ä¸­ï¼æä»¬å¯ä»¥ä½¿ç¨ object.getprototypeof æ¹æ³æ¥è·åå®ä¾å¯¹è±¡çååï¼ç¶ååæ¥ä¸ºååæ·»å æ¹æ³/å±æ§ã\n\nvar p1 = new point(2,3);\nvar p2 = new point(3,2);\n\np1.__proto__.printname = function () { return 'oops' };\n\np1.printname() // \"oops\"\np2.printname() // \"oops\"\n\nvar p3 = new point(4,2);\np3.printname() // \"oops\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç å¨p1çååä¸æ·»å äºä¸ä¸ªprintnameæ¹æ³ï¼ç±äºp1çååå°±æ¯p2çååï¼å æ­¤p2ä¹å¯ä»¥è°ç¨è¿ä¸ªæ¹æ³ãèä¸ï¼æ­¤åæ°å»ºçå®ä¾p3ä¹å¯ä»¥è°ç¨è¿ä¸ªæ¹æ³ãè¿æå³çï¼ä½¿ç¨å®ä¾ç__proto__å±æ§æ¹åååï¼å¿é¡»ç¸å½è°¨æï¼ä¸æ¨èä½¿ç¨ï¼å ä¸ºè¿ä¼æ¹åâç±»âçåå§å®ä¹ï¼å½±åå°ææå®ä¾ã\n\n\n# åå¼å½æ°ï¼getterï¼åå­å¼å½æ°ï¼setterï¼\n\nä¸ es5 ä¸æ ·ï¼å¨âç±»âçåé¨å¯ä»¥ä½¿ç¨getåsetå³é®å­ï¼å¯¹æä¸ªå±æ§è®¾ç½®å­å¼å½æ°ååå¼å½æ°ï¼æ¦æªè¯¥å±æ§çå­åè¡ä¸ºã\n\nclass myclass {\n  constructor() {\n    // ...\n  }\n  get prop() {\n    return 'getter';\n  }\n  set prop(value) {\n    console.log('setter: '+value);\n  }\n}\n\nlet inst = new myclass();\n\ninst.prop = 123;\n// setter: 123\n\ninst.prop\n// 'getter'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ä¸­ï¼propå±æ§æå¯¹åºçå­å¼å½æ°ååå¼å½æ°ï¼å æ­¤èµå¼åè¯»åè¡ä¸ºé½è¢«èªå®ä¹äºã\n\nå­å¼å½æ°ååå¼å½æ°æ¯è®¾ç½®å¨å±æ§ç descriptor å¯¹è±¡ä¸çã\n\nclass customhtmlelement {\n  constructor(element) {\n    this.element = element;\n  }\n\n  get html() {\n    return this.element.innerhtml;\n  }\n\n  set html(value) {\n    this.element.innerhtml = value;\n  }\n}\n\nvar descriptor = object.getownpropertydescriptor(\n  customhtmlelement.prototype, \"html\"\n);\n\n\"get\" in descriptor  // true\n\"set\" in descriptor  // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¸é¢ä»£ç ä¸­ï¼å­å¼å½æ°ååå¼å½æ°æ¯å®ä¹å¨htmlå±æ§çæè¿°å¯¹è±¡ä¸é¢ï¼è¿ä¸ es5 å®å¨ä¸è´ã\n\n\n# å±æ§è¡¨è¾¾å¼\n\nç±»çå±æ§åï¼å¯ä»¥éç¨è¡¨è¾¾å¼ã\n\nlet methodname = 'getarea';\n\nclass square {\n  constructor(length) {\n    // ...\n  }\n\n  [methodname]() {\n    // ...\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼squareç±»çæ¹æ³ågetareaï¼æ¯ä»è¡¨è¾¾å¼å¾å°çã\n\n\n# class è¡¨è¾¾å¼\n\nä¸å½æ°ä¸æ ·ï¼ç±»ä¹å¯ä»¥ä½¿ç¨è¡¨è¾¾å¼çå½¢å¼å®ä¹ã\n\nconst myclass = class me {\n  getclassname() {\n    return me.name;\n  }\n};\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä½¿ç¨è¡¨è¾¾å¼å®ä¹äºä¸ä¸ªç±»ãéè¦æ³¨æçæ¯ï¼è¿ä¸ªç±»çåå­æ¯meï¼ä½æ¯meåªå¨ class çåé¨å¯ç¨ï¼æä»£å½åç±»ãå¨ class å¤é¨ï¼è¿ä¸ªç±»åªè½ç¨myclasså¼ç¨ã\n\nlet inst = new myclass();\ninst.getclassname() // me\nme.name // referenceerror: me is not defined\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼meåªå¨ class åé¨æå®ä¹ã\n\nå¦æç±»çåé¨æ²¡ç¨å°çè¯ï¼å¯ä»¥çç¥meï¼ä¹å°±æ¯å¯ä»¥åæä¸é¢çå½¢å¼ã\n\nconst myclass = class { /* ... */ };\n\n\n1\n\n\néç¨ class è¡¨è¾¾å¼ï¼å¯ä»¥ååºç«å³æ§è¡ç classã\n\nlet person = new class {\n  constructor(name) {\n    this.name = name;\n  }\n\n  sayname() {\n    console.log(this.name);\n  }\n}('å¼ ä¸');\n\nperson.sayname(); // \"å¼ ä¸\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼personæ¯ä¸ä¸ªç«å³æ§è¡çç±»çå®ä¾ã\n\n\n# æ³¨æç¹\n\nï¼1ï¼ä¸¥æ ¼æ¨¡å¼\n\nç±»åæ¨¡åçåé¨ï¼é»è®¤å°±æ¯ä¸¥æ ¼æ¨¡å¼ï¼æä»¥ä¸éè¦ä½¿ç¨use strictæå®è¿è¡æ¨¡å¼ãåªè¦ä½ çä»£ç åå¨ç±»ææ¨¡åä¹ä¸­ï¼å°±åªæä¸¥æ ¼æ¨¡å¼å¯ç¨ãèèå°æªæ¥ææçä»£ç ï¼å¶å®é½æ¯è¿è¡å¨æ¨¡åä¹ä¸­ï¼æä»¥ es6 å®éä¸ææ´ä¸ªè¯­è¨åçº§å°äºä¸¥æ ¼æ¨¡å¼ã\n\nï¼2ï¼ä¸å­å¨æå\n\nç±»ä¸å­å¨åéæåï¼hoistï¼ï¼è¿ä¸ç¹ä¸ es5 å®å¨ä¸åã\n\nnew foo(); // referenceerror\nclass foo {}\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼fooç±»ä½¿ç¨å¨åï¼å®ä¹å¨åï¼è¿æ ·ä¼æ¥éï¼å ä¸º es6 ä¸ä¼æç±»çå£°ææåå°ä»£ç å¤´é¨ãè¿ç§è§å®çåå ä¸ä¸æè¦æå°çç»§æ¿æå³ï¼å¿é¡»ä¿è¯å­ç±»å¨ç¶ç±»ä¹åå®ä¹ã\n\n{\n  let foo = class {};\n  class bar extends foo {\n  }\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çä»£ç ä¸ä¼æ¥éï¼å ä¸ºbarç»§æ¿fooçæ¶åï¼fooå·²ç»æå®ä¹äºãä½æ¯ï¼å¦æå­å¨classçæåï¼ä¸é¢ä»£ç å°±ä¼æ¥éï¼å ä¸ºclassä¼è¢«æåå°ä»£ç å¤´é¨ï¼èletå½ä»¤æ¯ä¸æåçï¼æä»¥å¯¼è´barç»§æ¿fooçæ¶åï¼fooè¿æ²¡æå®ä¹ã\n\nï¼3ï¼name å±æ§\n\nç±äºæ¬è´¨ä¸ï¼es6 çç±»åªæ¯ es5 çæé å½æ°çä¸å±åè£ï¼æä»¥å½æ°çè®¸å¤ç¹æ§é½è¢«classç»§æ¿ï¼åæ¬nameå±æ§ã\n\nclass point {}\npoint.name // \"point\"\n\n\n1\n2\n\n\nnameå±æ§æ»æ¯è¿åç´§è·å¨classå³é®å­åé¢çç±»åã\n\nï¼4ï¼generator æ¹æ³\n\nå¦ææä¸ªæ¹æ³ä¹åå ä¸æå·ï¼*ï¼ï¼å°±è¡¨ç¤ºè¯¥æ¹æ³æ¯ä¸ä¸ª generator å½æ°ã\n\nclass foo {\n  constructor(...args) {\n    this.args = args;\n  }\n  * [symbol.iterator]() {\n    for (let arg of this.args) {\n      yield arg;\n    }\n  }\n}\n\nfor (let x of new foo('hello', 'world')) {\n  console.log(x);\n}\n// hello\n// world\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼fooç±»çsymbol.iteratoræ¹æ³åæä¸ä¸ªæå·ï¼è¡¨ç¤ºè¯¥æ¹æ³æ¯ä¸ä¸ª generator å½æ°ãsymbol.iteratoræ¹æ³è¿åä¸ä¸ªfooç±»çé»è®¤éåå¨ï¼for...ofå¾ªç¯ä¼èªå¨è°ç¨è¿ä¸ªéåå¨ã\n\nï¼5ï¼this çæå\n\nç±»çæ¹æ³åé¨å¦æå«æthisï¼å®é»è®¤æåç±»çå®ä¾ãä½æ¯ï¼å¿é¡»éå¸¸å°å¿ï¼ä¸æ¦åç¬ä½¿ç¨è¯¥æ¹æ³ï¼å¾å¯è½æ¥éã\n\nclass logger {\n  printname(name = 'there') {\n    this.print(`hello ${name}`);\n  }\n\n  print(text) {\n    console.log(text);\n  }\n}\n\nconst logger = new logger();\nconst { printname } = logger;\nprintname(); // typeerror: cannot read property 'print' of undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼printnameæ¹æ³ä¸­çthisï¼é»è®¤æåloggerç±»çå®ä¾ãä½æ¯ï¼å¦æå°è¿ä¸ªæ¹æ³æååºæ¥åç¬ä½¿ç¨ï¼thisä¼æåè¯¥æ¹æ³è¿è¡æ¶æå¨çç¯å¢ï¼ç±äº class åé¨æ¯ä¸¥æ ¼æ¨¡å¼ï¼æä»¥ this å®éæåçæ¯undefinedï¼ï¼ä»èå¯¼è´æ¾ä¸å°printæ¹æ³èæ¥éã\n\nä¸ä¸ªæ¯è¾ç®åçè§£å³æ¹æ³æ¯ï¼å¨æé æ¹æ³ä¸­ç»å®thisï¼è¿æ ·å°±ä¸ä¼æ¾ä¸å°printæ¹æ³äºã\n\nclass logger {\n  constructor() {\n    this.printname = this.printname.bind(this);\n  }\n\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦ä¸ç§è§£å³æ¹æ³æ¯ä½¿ç¨ç®­å¤´å½æ°ã\n\nclass obj {\n  constructor() {\n    this.getthis = () => this;\n  }\n}\n\nconst myobj = new obj();\nmyobj.getthis() === myobj // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nç®­å¤´å½æ°åé¨çthisæ»æ¯æåå®ä¹æ¶æå¨çå¯¹è±¡ãä¸é¢ä»£ç ä¸­ï¼ç®­å¤´å½æ°ä½äºæé å½æ°åé¨ï¼å®çå®ä¹çæçæ¶åï¼æ¯å¨æé å½æ°æ§è¡çæ¶åãè¿æ¶ï¼ç®­å¤´å½æ°æå¨çè¿è¡ç¯å¢ï¼è¯å®æ¯å®ä¾å¯¹è±¡ï¼æä»¥thisä¼æ»æ¯æåå®ä¾å¯¹è±¡ã\n\nè¿æä¸ç§è§£å³æ¹æ³æ¯ä½¿ç¨proxyï¼è·åæ¹æ³çæ¶åï¼èªå¨ç»å®thisã\n\nfunction selfish (target) {\n  const cache = new weakmap();\n  const handler = {\n    get (target, key) {\n      const value = reflect.get(target, key);\n      if (typeof value !== 'function') {\n        return value;\n      }\n      if (!cache.has(value)) {\n        cache.set(value, value.bind(target));\n      }\n      return cache.get(value);\n    }\n  };\n  const proxy = new proxy(target, handler);\n  return proxy;\n}\n\nconst logger = selfish(new logger());\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n# éææ¹æ³\n\nç±»ç¸å½äºå®ä¾çååï¼ææå¨ç±»ä¸­å®ä¹çæ¹æ³ï¼é½ä¼è¢«å®ä¾ç»§æ¿ãå¦æå¨ä¸ä¸ªæ¹æ³åï¼å ä¸staticå³é®å­ï¼å°±è¡¨ç¤ºè¯¥æ¹æ³ä¸ä¼è¢«å®ä¾ç»§æ¿ï¼èæ¯ç´æ¥éè¿ç±»æ¥è°ç¨ï¼è¿å°±ç§°ä¸ºâéææ¹æ³âã\n\nclass foo {\n  static classmethod() {\n    return 'hello';\n  }\n}\n\nfoo.classmethod() // 'hello'\n\nvar foo = new foo();\nfoo.classmethod()\n// typeerror: foo.classmethod is not a function\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼fooç±»çclassmethodæ¹æ³åæstaticå³é®å­ï¼è¡¨æè¯¥æ¹æ³æ¯ä¸ä¸ªéææ¹æ³ï¼å¯ä»¥ç´æ¥å¨fooç±»ä¸è°ç¨ï¼foo.classmethod()ï¼ï¼èä¸æ¯å¨fooç±»çå®ä¾ä¸è°ç¨ãå¦æå¨å®ä¾ä¸è°ç¨éææ¹æ³ï¼ä¼æåºä¸ä¸ªéè¯¯ï¼è¡¨ç¤ºä¸å­å¨è¯¥æ¹æ³ã\n\næ³¨æï¼å¦æéææ¹æ³åå«thiså³é®å­ï¼è¿ä¸ªthisæçæ¯ç±»ï¼èä¸æ¯å®ä¾ã\n\nclass foo {\n  static bar() {\n    this.baz();\n  }\n  static baz() {\n    console.log('hello');\n  }\n  baz() {\n    console.log('world');\n  }\n}\n\nfoo.bar() // hello\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼éææ¹æ³barè°ç¨äºthis.bazï¼è¿éçthisæçæ¯fooç±»ï¼èä¸æ¯fooçå®ä¾ï¼ç­åäºè°ç¨foo.bazãå¦å¤ï¼ä»è¿ä¸ªä¾å­è¿å¯ä»¥çåºï¼éææ¹æ³å¯ä»¥ä¸ééææ¹æ³éåã\n\nç¶ç±»çéææ¹æ³ï¼å¯ä»¥è¢«å­ç±»ç»§æ¿ã\n\nclass foo {\n  static classmethod() {\n    return 'hello';\n  }\n}\n\nclass bar extends foo {\n}\n\nbar.classmethod() // 'hello'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¶ç±»fooæä¸ä¸ªéææ¹æ³ï¼å­ç±»barå¯ä»¥è°ç¨è¿ä¸ªæ¹æ³ã\n\néææ¹æ³ä¹æ¯å¯ä»¥ä»superå¯¹è±¡ä¸è°ç¨çã\n\nclass foo {\n  static classmethod() {\n    return 'hello';\n  }\n}\n\nclass bar extends foo {\n  static classmethod() {\n    return super.classmethod() + ', too';\n  }\n}\n\nbar.classmethod() // \"hello, too\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# å®ä¾å±æ§çæ°åæ³\n\nå®ä¾å±æ§é¤äºå®ä¹å¨constructor()æ¹æ³éé¢çthisä¸é¢ï¼ä¹å¯ä»¥å®ä¹å¨ç±»çæé¡¶å±ã\n\nclass increasingcounter {\n  constructor() {\n    this._count = 0;\n  }\n  get value() {\n    console.log('getting the current value!');\n    return this._count;\n  }\n  increment() {\n    this._count++;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼å®ä¾å±æ§this._countå®ä¹å¨constructor()æ¹æ³éé¢ãå¦ä¸ç§åæ³æ¯ï¼è¿ä¸ªå±æ§ä¹å¯ä»¥å®ä¹å¨ç±»çæé¡¶å±ï¼å¶ä»é½ä¸åã\n\nclass increasingcounter {\n  _count = 0;\n  get value() {\n    console.log('getting the current value!');\n    return this._count;\n  }\n  increment() {\n    this._count++;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼å®ä¾å±æ§_countä¸åå¼å½æ°value()åincrement()æ¹æ³ï¼å¤äºåä¸ä¸ªå±çº§ãè¿æ¶ï¼ä¸éè¦å¨å®ä¾å±æ§åé¢å ä¸thisã\n\nè¿ç§æ°åæ³çå¥½å¤æ¯ï¼ææå®ä¾å¯¹è±¡èªèº«çå±æ§é½å®ä¹å¨ç±»çå¤´é¨ï¼çä¸å»æ¯è¾æ´é½ï¼ä¸ç¼å°±è½çåºè¿ä¸ªç±»æåªäºå®ä¾å±æ§ã\n\nclass foo {\n  bar = 'hello';\n  baz = 'world';\n\n  constructor() {\n    // ...\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢çä»£ç ï¼ä¸ç¼å°±è½çåºï¼fooç±»æä¸¤ä¸ªå®ä¾å±æ§ï¼ä¸ç®äºç¶ãå¦å¤ï¼åèµ·æ¥ä¹æ¯è¾ç®æ´ã\n\n\n# éæå±æ§\n\néæå±æ§æçæ¯ class æ¬èº«çå±æ§ï¼å³class.propnameï¼èä¸æ¯å®ä¹å¨å®ä¾å¯¹è±¡ï¼thisï¼ä¸çå±æ§ã\n\nclass foo {\n}\n\nfoo.prop = 1;\nfoo.prop // 1\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çåæ³ä¸ºfooç±»å®ä¹äºä¸ä¸ªéæå±æ§propã\n\nç®åï¼åªæè¿ç§åæ³å¯è¡ï¼å ä¸º es6 æç¡®è§å®ï¼class åé¨åªæéææ¹æ³ï¼æ²¡æéæå±æ§ãç°å¨æä¸ä¸ªææ¡æä¾äºç±»çéæå±æ§ï¼åæ³æ¯å¨å®ä¾å±æ§çåé¢ï¼å ä¸staticå³é®å­ã\n\nclass myclass {\n  static mystaticprop = 42;\n\n  constructor() {\n    console.log(myclass.mystaticprop); // 42\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¿ä¸ªæ°åæ³å¤§å¤§æ¹ä¾¿äºéæå±æ§çè¡¨è¾¾ã\n\n// èåæ³\nclass foo {\n  // ...\n}\nfoo.prop = 1;\n\n// æ°åæ³\nclass foo {\n  static prop = 1;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼èåæ³çéæå±æ§å®ä¹å¨ç±»çå¤é¨ãæ´ä¸ªç±»çæä»¥åï¼åçæéæå±æ§ãè¿æ ·è®©äººå¾å®¹æå¿½ç¥è¿ä¸ªéæå±æ§ï¼ä¹ä¸ç¬¦åç¸å³ä»£ç åºè¯¥æ¾å¨ä¸èµ·çä»£ç ç»ç»ååãå¦å¤ï¼æ°åæ³æ¯æ¾å¼å£°æï¼declarativeï¼ï¼èä¸æ¯èµå¼å¤çï¼è¯­ä¹æ´å¥½ã\n\n\n# ç§ææ¹æ³åç§æå±æ§\n\n\n# ç°æçè§£å³æ¹æ¡\n\nç§ææ¹æ³åç§æå±æ§ï¼æ¯åªè½å¨ç±»çåé¨è®¿é®çæ¹æ³åå±æ§ï¼å¤é¨ä¸è½è®¿é®ãè¿æ¯å¸¸è§éæ±ï¼æå©äºä»£ç çå°è£ï¼ä½ es6 ä¸æä¾ï¼åªè½éè¿åéæ¹æ³æ¨¡æå®ç°ã\n\nä¸ç§åæ³æ¯å¨å½åä¸å ä»¥åºå«ã\n\nclass widget {\n\n  // å¬ææ¹æ³\n  foo (baz) {\n    this._bar(baz);\n  }\n\n  // ç§ææ¹æ³\n  _bar(baz) {\n    return this.snaf = baz;\n  }\n\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼_baræ¹æ³åé¢çä¸åçº¿ï¼è¡¨ç¤ºè¿æ¯ä¸ä¸ªåªéäºåé¨ä½¿ç¨çç§ææ¹æ³ãä½æ¯ï¼è¿ç§å½åæ¯ä¸ä¿é©çï¼å¨ç±»çå¤é¨ï¼è¿æ¯å¯ä»¥è°ç¨å°è¿ä¸ªæ¹æ³ã\n\nå¦ä¸ç§æ¹æ³å°±æ¯ç´¢æ§å°ç§ææ¹æ³ç§»åºæ¨¡åï¼å ä¸ºæ¨¡ååé¨çæææ¹æ³é½æ¯å¯¹å¤å¯è§çã\n\nclass widget {\n  foo (baz) {\n    bar.call(this, baz);\n  }\n\n  // ...\n}\n\nfunction bar(baz) {\n  return this.snaf = baz;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼fooæ¯å¬å¼æ¹æ³ï¼åé¨è°ç¨äºbar.call(this, baz)ãè¿ä½¿å¾barå®éä¸æä¸ºäºå½åæ¨¡åçç§ææ¹æ³ã\n\nè¿æä¸ç§æ¹æ³æ¯å©ç¨symbolå¼çå¯ä¸æ§ï¼å°ç§ææ¹æ³çåå­å½åä¸ºä¸ä¸ªsymbolå¼ã\n\nconst bar = symbol('bar');\nconst snaf = symbol('snaf');\n\nexport default class myclass{\n\n  // å¬ææ¹æ³\n  foo(baz) {\n    this[bar](baz);\n  }\n\n  // ç§ææ¹æ³\n  [bar](baz) {\n    return this[snaf] = baz;\n  }\n\n  // ...\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼baråsnafé½æ¯symbolå¼ï¼ä¸è¬æåµä¸æ æ³è·åå°å®ä»¬ï¼å æ­¤è¾¾å°äºç§ææ¹æ³åç§æå±æ§çææãä½æ¯ä¹ä¸æ¯ç»å¯¹ä¸è¡ï¼reflect.ownkeys()ä¾ç¶å¯ä»¥æ¿å°å®ä»¬ã\n\nconst inst = new myclass();\n\nreflect.ownkeys(myclass.prototype)\n// [ 'constructor', 'foo', symbol(bar) ]\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼symbol å¼çå±æ§åä¾ç¶å¯ä»¥ä»ç±»çå¤é¨æ¿å°ã\n\n\n# ç§æå±æ§çææ¡\n\nç®åï¼æä¸ä¸ªææ¡ï¼ä¸ºclasså äºç§æå±æ§ãæ¹æ³æ¯å¨å±æ§åä¹åï¼ä½¿ç¨#è¡¨ç¤ºã\n\nclass increasingcounter {\n  #count = 0;\n  get value() {\n    console.log('getting the current value!');\n    return this.#count;\n  }\n  increment() {\n    this.#count++;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼#countå°±æ¯ç§æå±æ§ï¼åªè½å¨ç±»çåé¨ä½¿ç¨ï¼this.#countï¼ãå¦æå¨ç±»çå¤é¨ä½¿ç¨ï¼å°±ä¼æ¥éã\n\nconst counter = new increasingcounter();\ncounter.#count // æ¥é\ncounter.#count = 42 // æ¥é\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç å¨ç±»çå¤é¨ï¼è¯»åç§æå±æ§ï¼å°±ä¼æ¥éã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nclass point {\n  #x;\n\n  constructor(x = 0) {\n    this.#x = +x;\n  }\n\n  get x() {\n    return this.#x;\n  }\n\n  set x(value) {\n    this.#x = +value;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼#xå°±æ¯ç§æå±æ§ï¼å¨pointç±»ä¹å¤æ¯è¯»åä¸å°è¿ä¸ªå±æ§çãç±äºäºå·#æ¯å±æ§åçä¸é¨åï¼ä½¿ç¨æ¶å¿é¡»å¸¦æ#ä¸èµ·ä½¿ç¨ï¼æä»¥#xåxæ¯ä¸¤ä¸ªä¸åçå±æ§ã\n\nä¹æä»¥è¦å¼å¥ä¸ä¸ªæ°çåç¼#è¡¨ç¤ºç§æå±æ§ï¼èæ²¡æéç¨privateå³é®å­ï¼æ¯å ä¸º javascript æ¯ä¸é¨å¨æè¯­è¨ï¼æ²¡æç±»åå£°æï¼ä½¿ç¨ç¬ç«çç¬¦å·ä¼¼ä¹æ¯å¯ä¸çæ¯è¾æ¹ä¾¿å¯é çæ¹æ³ï¼è½å¤åç¡®å°åºåä¸ç§å±æ§æ¯å¦ä¸ºç§æå±æ§ãå¦å¤ï¼ruby è¯­è¨ä½¿ç¨@è¡¨ç¤ºç§æå±æ§ï¼es6 æ²¡æç¨è¿ä¸ªç¬¦å·èä½¿ç¨#ï¼æ¯å ä¸º@å·²ç»è¢«çç»äº decoratorã\n\nè¿ç§åæ³ä¸ä»å¯ä»¥åç§æå±æ§ï¼è¿å¯ä»¥ç¨æ¥åç§ææ¹æ³ã\n\nclass foo {\n  #a;\n  #b;\n  constructor(a, b) {\n    this.#a = a;\n    this.#b = b;\n  }\n  #sum() {\n    return #a + #b;\n  }\n  printsum() {\n    console.log(this.#sum());\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼#sum()å°±æ¯ä¸ä¸ªç§ææ¹æ³ã\n\nå¦å¤ï¼ç§æå±æ§ä¹å¯ä»¥è®¾ç½® getter å setter æ¹æ³ã\n\nclass counter {\n  #xvalue = 0;\n\n  constructor() {\n    super();\n    // ...\n  }\n\n  get #x() { return #xvalue; }\n  set #x(value) {\n    this.#xvalue = value;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼#xæ¯ä¸ä¸ªç§æå±æ§ï¼å®çè¯»åé½éè¿get #x()åset #x()æ¥å®æã\n\nç§æå±æ§ä¸éäºä»thiså¼ç¨ï¼åªè¦æ¯å¨ç±»çåé¨ï¼å®ä¾ä¹å¯ä»¥å¼ç¨ç§æå±æ§ã\n\nclass foo {\n  #privatevalue = 42;\n  static getprivatevalue(foo) {\n    return foo.#privatevalue;\n  }\n}\n\nfoo.getprivatevalue(new foo()); // 42\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç åè®¸ä»å®ä¾fooä¸é¢å¼ç¨ç§æå±æ§ã\n\nç§æå±æ§åç§ææ¹æ³åé¢ï¼ä¹å¯ä»¥å ä¸staticå³é®å­ï¼è¡¨ç¤ºè¿æ¯ä¸ä¸ªéæçç§æå±æ§æç§ææ¹æ³ã\n\nclass fakemath {\n  static pi = 22 / 7;\n  static #totallyrandomnumber = 4;\n\n  static #computerandomnumber() {\n    return fakemath.#totallyrandomnumber;\n  }\n\n  static random() {\n    console.log('i heard you like random numbersâ¦')\n    return fakemath.#computerandomnumber();\n  }\n}\n\nfakemath.pi // 3.142857142857143\nfakemath.random()\n// i heard you like random numbersâ¦\n// 4\nfakemath.#totallyrandomnumber // æ¥é\nfakemath.#computerandomnumber() // æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¸é¢ä»£ç ä¸­ï¼#totallyrandomnumberæ¯ç§æå±æ§ï¼#computerandomnumber()æ¯ç§ææ¹æ³ï¼åªè½å¨fakemathè¿ä¸ªç±»çåé¨è°ç¨ï¼å¤é¨è°ç¨å°±ä¼æ¥éã\n\n\n# new.target å±æ§\n\nnewæ¯ä»æé å½æ°çæå®ä¾å¯¹è±¡çå½ä»¤ães6 ä¸ºnewå½ä»¤å¼å¥äºä¸ä¸ªnew.targetå±æ§ï¼è¯¥å±æ§ä¸è¬ç¨å¨æé å½æ°ä¹ä¸­ï¼è¿ånewå½ä»¤ä½ç¨äºçé£ä¸ªæé å½æ°ãå¦ææé å½æ°ä¸æ¯éè¿newå½ä»¤æreflect.construct()è°ç¨çï¼new.targetä¼è¿åundefinedï¼å æ­¤è¿ä¸ªå±æ§å¯ä»¥ç¨æ¥ç¡®å®æé å½æ°æ¯æä¹è°ç¨çã\n\nfunction person(name) {\n  if (new.target !== undefined) {\n    this.name = name;\n  } else {\n    throw new error('å¿é¡»ä½¿ç¨ new å½ä»¤çæå®ä¾');\n  }\n}\n\n// å¦ä¸ç§åæ³\nfunction person(name) {\n  if (new.target === person) {\n    this.name = name;\n  } else {\n    throw new error('å¿é¡»ä½¿ç¨ new å½ä»¤çæå®ä¾');\n  }\n}\n\nvar person = new person('å¼ ä¸'); // æ­£ç¡®\nvar notaperson = person.call(person, 'å¼ ä¸');  // æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ç¡®ä¿æé å½æ°åªè½éè¿newå½ä»¤è°ç¨ã\n\nclass åé¨è°ç¨new.targetï¼è¿åå½å classã\n\nclass rectangle {\n  constructor(length, width) {\n    console.log(new.target === rectangle);\n    this.length = length;\n    this.width = width;\n  }\n}\n\nvar obj = new rectangle(3, 4); // è¾åº true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\néè¦æ³¨æçæ¯ï¼å­ç±»ç»§æ¿ç¶ç±»æ¶ï¼new.targetä¼è¿åå­ç±»ã\n\nclass rectangle {\n  constructor(length, width) {\n    console.log(new.target === rectangle);\n    // ...\n  }\n}\n\nclass square extends rectangle {\n  constructor(length) {\n    super(length, width);\n  }\n}\n\nvar obj = new square(3); // è¾åº false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼new.targetä¼è¿åå­ç±»ã\n\nå©ç¨è¿ä¸ªç¹ç¹ï¼å¯ä»¥ååºä¸è½ç¬ç«ä½¿ç¨ãå¿é¡»ç»§æ¿åæè½ä½¿ç¨çç±»ã\n\nclass shape {\n  constructor() {\n    if (new.target === shape) {\n      throw new error('æ¬ç±»ä¸è½å®ä¾å');\n    }\n  }\n}\n\nclass rectangle extends shape {\n  constructor(length, width) {\n    super();\n    // ...\n  }\n}\n\nvar x = new shape();  // æ¥é\nvar y = new rectangle(3, 4);  // æ­£ç¡®\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼shapeç±»ä¸è½è¢«å®ä¾åï¼åªè½ç¨äºç»§æ¿ã\n\næ³¨æï¼å¨å½æ°å¤é¨ï¼ä½¿ç¨new.targetä¼æ¥éã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Module çè¯­æ³",frontmatter:{title:"Module çè¯­æ³",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/efe2fb04eb8ac5fb",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/23.Module%20%E7%9A%84%E8%AF%AD%E6%B3%95.html",relativePath:"ãES6 æç¨ãç¬è®°/23.Module çè¯­æ³.md",key:"v-ad45f6fa",path:"/pages/efe2fb04eb8ac5fb/",headers:[{level:2,title:"æ¦è¿°",slug:"æ¦è¿°",normalizedTitle:"æ¦è¿°",charIndex:17},{level:2,title:"ä¸¥æ ¼æ¨¡å¼",slug:"ä¸¥æ ¼æ¨¡å¼",normalizedTitle:"ä¸¥æ ¼æ¨¡å¼",charIndex:1328},{level:2,title:"export å½ä»¤",slug:"export-å½ä»¤",normalizedTitle:"export å½ä»¤",charIndex:1904},{level:2,title:"import å½ä»¤",slug:"import-å½ä»¤",normalizedTitle:"import å½ä»¤",charIndex:3872},{level:2,title:"æ¨¡åçæ´ä½å è½½-(æå·*)",slug:"æ¨¡åçæ´ä½å è½½-æå·",normalizedTitle:"æ¨¡åçæ´ä½å è½½-(æå·*)",charIndex:5996},{level:2,title:"export default å½ä»¤",slug:"export-default-å½ä»¤",normalizedTitle:"export default å½ä»¤",charIndex:6797},{level:2,title:"export ä¸ import çå¤ååæ³",slug:"export-ä¸-import-çå¤ååæ³",normalizedTitle:"export ä¸ import çå¤ååæ³",charIndex:9298},{level:2,title:"æ¨¡åçç»§æ¿",slug:"æ¨¡åçç»§æ¿",normalizedTitle:"æ¨¡åçç»§æ¿",charIndex:10367},{level:2,title:"è·¨æ¨¡åå¸¸é",slug:"è·¨æ¨¡åå¸¸é",normalizedTitle:"è·¨æ¨¡åå¸¸é",charIndex:10989},{level:2,title:"import()",slug:"import",normalizedTitle:"import()",charIndex:11948},{level:3,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:11961},{level:3,title:"éç¨åºå",slug:"éç¨åºå",normalizedTitle:"éç¨åºå",charIndex:13119},{level:3,title:"æ³¨æç¹",slug:"æ³¨æç¹",normalizedTitle:"æ³¨æç¹",charIndex:13710}],excerpt:'<h1 id="module-çè¯­æ³"><a class="header-anchor" href="#module-çè¯­æ³">#</a> Module çè¯­æ³</h1>\n<h2 id="æ¦è¿°"><a class="header-anchor" href="#æ¦è¿°">#</a> æ¦è¿°</h2>\n<p>åå²ä¸ï¼JavaScript ä¸ç´æ²¡ææ¨¡åï¼moduleï¼ä½ç³»ï¼æ æ³å°ä¸ä¸ªå¤§ç¨åºæåæäºç¸ä¾èµçå°æä»¶ï¼åç¨ç®åçæ¹æ³æ¼è£èµ·æ¥ãå¶ä»è¯­è¨é½æè¿é¡¹åè½ï¼æ¯å¦ Ruby ç<code>require</code>ãPython ç<code>import</code>ï¼çè³å°±è¿ CSS é½æ<code>@import</code>ï¼ä½æ¯ JavaScript ä»»ä½è¿æ¹é¢çæ¯æé½æ²¡æï¼è¿å¯¹å¼åå¤§åçãå¤æçé¡¹ç®å½¢æäºå·¨å¤§éç¢ã</p>\n',headersStr:"æ¦è¿° ä¸¥æ ¼æ¨¡å¼ export å½ä»¤ import å½ä»¤ æ¨¡åçæ´ä½å è½½-(æå·*) export default å½ä»¤ export ä¸ import çå¤ååæ³ æ¨¡åçç»§æ¿ è·¨æ¨¡åå¸¸é import() ç®ä» éç¨åºå æ³¨æç¹",content:"# Module çè¯­æ³\n\n\n# æ¦è¿°\n\nåå²ä¸ï¼JavaScript ä¸ç´æ²¡ææ¨¡åï¼moduleï¼ä½ç³»ï¼æ æ³å°ä¸ä¸ªå¤§ç¨åºæåæäºç¸ä¾èµçå°æä»¶ï¼åç¨ç®åçæ¹æ³æ¼è£èµ·æ¥ãå¶ä»è¯­è¨é½æè¿é¡¹åè½ï¼æ¯å¦ Ruby çrequireãPython çimportï¼çè³å°±è¿ CSS é½æ@importï¼ä½æ¯ JavaScript ä»»ä½è¿æ¹é¢çæ¯æé½æ²¡æï¼è¿å¯¹å¼åå¤§åçãå¤æçé¡¹ç®å½¢æäºå·¨å¤§éç¢ã å¨ ES6 ä¹åï¼ç¤¾åºå¶å®äºä¸äºæ¨¡åå è½½æ¹æ¡ï¼æä¸»è¦çæ CommonJS å AMD ä¸¤ç§ãåèç¨äºæå¡å¨ï¼åèç¨äºæµè§å¨ãES6 å¨è¯­è¨æ åçå±é¢ä¸ï¼å®ç°äºæ¨¡ååè½ï¼èä¸å®ç°å¾ç¸å½ç®åï¼å®å¨å¯ä»¥åä»£ CommonJS å AMD è§èï¼æä¸ºæµè§å¨åæå¡å¨éç¨çæ¨¡åè§£å³æ¹æ¡ã\n\nES6 æ¨¡åçè®¾è®¡ææ³æ¯å°½éçéæåï¼ä½¿å¾ç¼è¯æ¶å°±è½ç¡®å®æ¨¡åçä¾èµå³ç³»ï¼ä»¥åè¾å¥åè¾åºçåéãCommonJS å AMD æ¨¡åï¼é½åªè½å¨è¿è¡æ¶ç¡®å®è¿äºä¸è¥¿ãæ¯å¦ï¼CommonJS æ¨¡åå°±æ¯å¯¹è±¡ï¼è¾å¥æ¶å¿é¡»æ¥æ¾å¯¹è±¡å±æ§ã\n\n// CommonJSæ¨¡å\nlet { stat, exists, readFile } = require('fs');\n\n// ç­åäº\nlet _fs = require('fs');\nlet stat = _fs.stat;\nlet exists = _fs.exists;\nlet readfile = _fs.readfile;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç çå®è´¨æ¯æ´ä½å è½½fsæ¨¡åï¼å³å è½½fsçæææ¹æ³ï¼ï¼çæä¸ä¸ªå¯¹è±¡ï¼_fsï¼ï¼ç¶ååä»è¿ä¸ªå¯¹è±¡ä¸é¢è¯»å 3 ä¸ªæ¹æ³ãè¿ç§å è½½ç§°ä¸ºâè¿è¡æ¶å è½½âï¼å ä¸ºåªæè¿è¡æ¶æè½å¾å°è¿ä¸ªå¯¹è±¡ï¼å¯¼è´å®å¨æ²¡åæ³å¨ç¼è¯æ¶åâéæä¼åâã\n\nES6 æ¨¡åä¸æ¯å¯¹è±¡ï¼èæ¯éè¿exportå½ä»¤æ¾å¼æå®è¾åºçä»£ç ï¼åéè¿importå½ä»¤è¾å¥ã\n\n// ES6æ¨¡å\nimport { stat, exists, readFile } from 'fs';\n\n\n1\n2\n\n\nä¸é¢ä»£ç çå®è´¨æ¯ä»fsæ¨¡åå è½½ 3 ä¸ªæ¹æ³ï¼å¶ä»æ¹æ³ä¸å è½½ãè¿ç§å è½½ç§°ä¸ºâç¼è¯æ¶å è½½âæèéæå è½½ï¼**å³ ES6 å¯ä»¥å¨ç¼è¯æ¶å°±å®ææ¨¡åå è½½ï¼**æçè¦æ¯ CommonJS æ¨¡åçå è½½æ¹å¼é«ãå½ç¶ï¼è¿ä¹å¯¼è´äºæ²¡æ³å¼ç¨ ES6 æ¨¡åæ¬èº«ï¼å ä¸ºå®ä¸æ¯å¯¹è±¡ã\n\nç±äº ES6 æ¨¡åæ¯ç¼è¯æ¶å è½½ï¼ä½¿å¾éæåææä¸ºå¯è½ãæäºå®ï¼å°±è½è¿ä¸æ­¥æå®½ JavaScript çè¯­æ³ï¼æ¯å¦å¼å¥å®ï¼macroï¼åç±»åæ£éªï¼type systemï¼è¿äºåªè½é éæåæå®ç°çåè½ã\n\né¤äºéæå è½½å¸¦æ¥çåç§å¥½å¤ï¼ES6 æ¨¡åè¿æä»¥ä¸å¥½å¤ã\n\n * ä¸åéè¦UMDæ¨¡åæ ¼å¼äºï¼å°æ¥æå¡å¨åæµè§å¨é½ä¼æ¯æ ES6 æ¨¡åæ ¼å¼ãç®åï¼éè¿åç§å·¥å·åºï¼å¶å®å·²ç»åå°äºè¿ä¸ç¹ã\n * å°æ¥æµè§å¨çæ° API å°±è½ç¨æ¨¡åæ ¼å¼æä¾ï¼ä¸åå¿é¡»åæå¨å±åéæènavigatorå¯¹è±¡çå±æ§ã\n * ä¸åéè¦å¯¹è±¡ä½ä¸ºå½åç©ºé´ï¼æ¯å¦Mathå¯¹è±¡ï¼ï¼æªæ¥è¿äºåè½å¯ä»¥éè¿æ¨¡åæä¾ã\n\næ¬ç« ä»ç» ES6 æ¨¡åçè¯­æ³ï¼ä¸ä¸ç« ä»ç»å¦ä½å¨æµè§å¨å Node ä¹ä¸­ï¼å è½½ ES6 æ¨¡åã\n\n\n# ä¸¥æ ¼æ¨¡å¼\n\nES6 çæ¨¡åèªå¨éç¨ä¸¥æ ¼æ¨¡å¼ï¼ä¸ç®¡ä½ ææ²¡æå¨æ¨¡åå¤´é¨å ä¸\"use strict\";ã\n\nä¸¥æ ¼æ¨¡å¼ä¸»è¦æä»¥ä¸éå¶ã\n\n * åéå¿é¡»å£°æååä½¿ç¨\n * å½æ°çåæ°ä¸è½æååå±æ§ï¼å¦åæ¥é\n * ä¸è½ä½¿ç¨withè¯­å¥\n * ä¸è½å¯¹åªè¯»å±æ§èµå¼ï¼å¦åæ¥é\n * ä¸è½ä½¿ç¨åç¼ 0 è¡¨ç¤ºå«è¿å¶æ°ï¼å¦åæ¥é\n * ä¸è½å é¤ä¸å¯å é¤çå±æ§ï¼å¦åæ¥é\n * ä¸è½å é¤åédelete propï¼ä¼æ¥éï¼åªè½å é¤å±æ§delete global[prop]\n * evalä¸ä¼å¨å®çå¤å±ä½ç¨åå¼å¥åé\n * evalåargumentsä¸è½è¢«éæ°èµå¼\n * argumentsä¸ä¼èªå¨åæ å½æ°åæ°çåå\n * ä¸è½ä½¿ç¨arguments.callee\n * ä¸è½ä½¿ç¨arguments.caller\n * ç¦æ­¢thisæåå¨å±å¯¹è±¡\n * ä¸è½ä½¿ç¨fn.calleråfn.argumentsè·åå½æ°è°ç¨çå æ \n * å¢å äºä¿çå­ï¼æ¯å¦protectedãstaticåinterfaceï¼\n\nä¸é¢è¿äºéå¶ï¼æ¨¡åé½å¿é¡»éµå®ãç±äºä¸¥æ ¼æ¨¡å¼æ¯ ES5 å¼å¥çï¼ä¸å±äº ES6ï¼æä»¥è¯·åéç¸å³ ES5 ä¹¦ç±ï¼æ¬ä¹¦ä¸åè¯¦ç»ä»ç»äºã\n\nå¶ä¸­ï¼å°¤å¶éè¦æ³¨æthisçéå¶ãES6 æ¨¡åä¹ä¸­ï¼é¡¶å±çthisæåundefinedï¼å³ä¸åºè¯¥å¨é¡¶å±ä»£ç ä½¿ç¨thisã\n\n\n# export å½ä»¤\n\næ¨¡ååè½ä¸»è¦ç±ä¸¤ä¸ªå½ä»¤ææï¼exportåimportãexportå½ä»¤ç¨äºè§å®æ¨¡åçå¯¹å¤æ¥å£ï¼importå½ä»¤ç¨äºè¾å¥å¶ä»æ¨¡åæä¾çåè½ã\n\nä¸ä¸ªæ¨¡åå°±æ¯ä¸ä¸ªç¬ç«çæä»¶ãè¯¥æä»¶åé¨çææåéï¼å¤é¨æ æ³è·åãå¦æä½ å¸æå¤é¨è½å¤è¯»åæ¨¡ååé¨çæä¸ªåéï¼å°±å¿é¡»ä½¿ç¨exportå³é®å­è¾åºè¯¥åéãä¸é¢æ¯ä¸ä¸ª JS æä»¶ï¼éé¢ä½¿ç¨exportå½ä»¤è¾åºåéã\n\n// profile.js\nexport var firstName = 'Michael';\nexport var lastName = 'Jackson';\nexport var year = 1958;\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç æ¯profile.jsæä»¶ï¼ä¿å­äºç¨æ·ä¿¡æ¯ãES6 å°å¶è§ä¸ºä¸ä¸ªæ¨¡åï¼éé¢ç¨exportå½ä»¤å¯¹å¤é¨è¾åºäºä¸ä¸ªåéã\n\nexportçåæ³ï¼é¤äºåä¸é¢è¿æ ·ï¼è¿æå¦å¤ä¸ç§ã\n\n// profile.js\nvar firstName = 'Michael';\nvar lastName = 'Jackson';\nvar year = 1958;\n\nexport { firstName, lastName, year };\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç å¨exportå½ä»¤åé¢ï¼ä½¿ç¨å¤§æ¬å·æå®æè¦è¾åºçä¸ç»åéãå®ä¸åä¸ç§åæ³ï¼ç´æ¥æ¾ç½®å¨varè¯­å¥åï¼æ¯ç­ä»·çï¼ä½æ¯åºè¯¥ä¼åèèä½¿ç¨è¿ç§åæ³ãå ä¸ºè¿æ ·å°±å¯ä»¥å¨èæ¬å°¾é¨ï¼ä¸ç¼çæ¸æ¥è¾åºäºåªäºåéã\n\nexportå½ä»¤é¤äºè¾åºåéï¼è¿å¯ä»¥è¾åºå½æ°æç±»ï¼classï¼ã\n\nexport function multiply(x, y) {\n  return x * y;\n};\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç å¯¹å¤è¾åºä¸ä¸ªå½æ°multiplyã\n\néå¸¸æåµä¸ï¼exportè¾åºçåéå°±æ¯æ¬æ¥çåå­ï¼ä½æ¯å¯ä»¥ä½¿ç¨aså³é®å­éå½åã\n\nfunction v1() { ... }\nfunction v2() { ... }\n\nexport {\n  v1 as streamV1,\n  v2 as streamV2,\n  v2 as streamLatestVersion\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä½¿ç¨aså³é®å­ï¼éå½åäºå½æ°v1åv2çå¯¹å¤æ¥å£ãéå½ååï¼v2å¯ä»¥ç¨ä¸åçåå­è¾åºä¸¤æ¬¡ã\n\néè¦ç¹å«æ³¨æçæ¯ï¼exportå½ä»¤è§å®çæ¯å¯¹å¤çæ¥å£ï¼å¿é¡»ä¸æ¨¡ååé¨çåéå»ºç«ä¸ä¸å¯¹åºå³ç³»ã\n\n// æ¥é\nexport 1;\n\n// æ¥é\nvar m = 1;\nexport m;\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä¸¤ç§åæ³é½ä¼æ¥éï¼å ä¸ºæ²¡ææä¾å¯¹å¤çæ¥å£ãç¬¬ä¸ç§åæ³ç´æ¥è¾åº 1ï¼ç¬¬äºç§åæ³éè¿åémï¼è¿æ¯ç´æ¥è¾åº 1ã1åªæ¯ä¸ä¸ªå¼ï¼ä¸æ¯æ¥å£ãæ­£ç¡®çåæ³æ¯ä¸é¢è¿æ ·ã\n\n// åæ³ä¸\nexport var m = 1;\n\n// åæ³äº\nvar m = 1;\nexport {m};\n\n// åæ³ä¸\nvar n = 1;\nexport {n as m};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä¸ç§åæ³é½æ¯æ­£ç¡®çï¼è§å®äºå¯¹å¤çæ¥å£mãå¶ä»èæ¬å¯ä»¥éè¿è¿ä¸ªæ¥å£ï¼åå°å¼1ãå®ä»¬çå®è´¨æ¯ï¼å¨æ¥å£åä¸æ¨¡ååé¨åéä¹é´ï¼å»ºç«äºä¸ä¸å¯¹åºçå³ç³»ã\n\nåæ ·çï¼functionåclassçè¾åºï¼ä¹å¿é¡»éµå®è¿æ ·çåæ³ã\n\n// æ¥é\nfunction f() {}\nexport f;\n\n// æ­£ç¡®\nexport function f() {};\n\n// æ­£ç¡®\nfunction f() {}\nexport {f};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¦å¤ï¼exportè¯­å¥è¾åºçæ¥å£ï¼ä¸å¶å¯¹åºçå¼æ¯å¨æç»å®å³ç³»ï¼å³éè¿è¯¥æ¥å£ï¼å¯ä»¥åå°æ¨¡ååé¨å®æ¶çå¼ã\n\nexport var foo = 'bar';\nsetTimeout(() => foo = 'baz', 500);\n\n\n1\n2\n\n\nä¸é¢ä»£ç è¾åºåéfooï¼å¼ä¸ºbarï¼500 æ¯«ç§ä¹ååæbazã\n\nè¿ä¸ç¹ä¸ CommonJS è§èå®å¨ä¸åãCommonJS æ¨¡åè¾åºçæ¯å¼çç¼å­ï¼ä¸å­å¨å¨ææ´æ°ï¼è¯¦è§ä¸æãModule çå è½½å®ç°ãä¸èã\n\næåï¼exportå½ä»¤å¯ä»¥åºç°å¨æ¨¡åçä»»ä½ä½ç½®ï¼åªè¦å¤äºæ¨¡åé¡¶å±å°±å¯ä»¥ãå¦æå¤äºåçº§ä½ç¨ååï¼å°±ä¼æ¥éï¼ä¸ä¸èçimportå½ä»¤ä¹æ¯å¦æ­¤ãè¿æ¯å ä¸ºå¤äºæ¡ä»¶ä»£ç åä¹ä¸­ï¼å°±æ²¡æ³åéæä¼åäºï¼è¿èäº ES6 æ¨¡åçè®¾è®¡åè¡·ã\n\nfunction foo() {\n  export default 'bar' // SyntaxError\n}\nfoo()\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼exportè¯­å¥æ¾å¨å½æ°ä¹ä¸­ï¼ç»ææ¥éã\n\n\n# import å½ä»¤\n\nä½¿ç¨exportå½ä»¤å®ä¹äºæ¨¡åçå¯¹å¤æ¥å£ä»¥åï¼å¶ä» JS æä»¶å°±å¯ä»¥éè¿importå½ä»¤å è½½è¿ä¸ªæ¨¡åã\n\n// main.js\nimport { firstName, lastName, year } from './profile.js';\n\nfunction setName(element) {\n  element.textContent = firstName + ' ' + lastName;\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çimportå½ä»¤ï¼ç¨äºå è½½profile.jsæä»¶ï¼å¹¶ä»ä¸­è¾å¥åéãimportå½ä»¤æ¥åä¸å¯¹å¤§æ¬å·ï¼éé¢æå®è¦ä»å¶ä»æ¨¡åå¯¼å¥çåéåãå¤§æ¬å·éé¢çåéåï¼å¿é¡»ä¸è¢«å¯¼å¥æ¨¡åï¼profile.jsï¼å¯¹å¤æ¥å£çåç§°ç¸åã\n\nå¦ææ³ä¸ºè¾å¥çåééæ°åä¸ä¸ªåå­**ï¼importå½ä»¤è¦ä½¿ç¨aså³é®å­ï¼å°è¾å¥çåééå½åã**\n\nimport { lastName as surname } from './profile.js';\n\n\n1\n\n\nimportå½ä»¤è¾å¥çåéé½æ¯åªè¯»çï¼å ä¸ºå®çæ¬è´¨æ¯è¾å¥æ¥å£ãä¹å°±æ¯è¯´ï¼ä¸åè®¸å¨å è½½æ¨¡åçèæ¬éé¢ï¼æ¹åæ¥å£ã\n\nimport {a} from './xxx.js'\n\na = {}; // Syntax Error : 'a' is read-only;\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼èæ¬å è½½äºåéaï¼å¯¹å¶éæ°èµå¼å°±ä¼æ¥éï¼å ä¸ºaæ¯ä¸ä¸ªåªè¯»çæ¥å£ãä½æ¯**ï¼å¦æaæ¯ä¸ä¸ªå¯¹è±¡ï¼æ¹åaçå±æ§æ¯åè®¸ç**ã\n\nimport {a} from './xxx.js'\n\na.foo = 'hello'; // åæ³æä½\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼açå±æ§å¯ä»¥æåæ¹åï¼å¹¶ä¸å¶ä»æ¨¡åä¹å¯ä»¥è¯»å°æ¹ååçå¼ãä¸è¿ï¼è¿ç§åæ³å¾é¾æ¥éï¼å»ºè®®å¡æ¯è¾å¥çåéï¼é½å½ä½å®å¨åªè¯»ï¼ä¸è¦è½»ææ¹åå®çå±æ§ã\n\nimportåé¢çfromæå®æ¨¡åæä»¶çä½ç½®ï¼å¯ä»¥æ¯ç¸å¯¹è·¯å¾ï¼ä¹å¯ä»¥æ¯ç»å¯¹è·¯å¾ï¼.jsåç¼å¯ä»¥çç¥ãå¦æåªæ¯æ¨¡ååï¼ä¸å¸¦æè·¯å¾ï¼é£ä¹å¿é¡»æéç½®æä»¶ï¼åè¯ JavaScript å¼æè¯¥æ¨¡åçä½ç½®ã\n\nimport {myMethod} from 'util';\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼utilæ¯æ¨¡åæä»¶åï¼ç±äºä¸å¸¦æè·¯å¾ï¼å¿é¡»éè¿éç½®ï¼åè¯å¼ææä¹åå°è¿ä¸ªæ¨¡åã\n\næ³¨æï¼importå½ä»¤å·ææåææï¼ä¼æåå°æ´ä¸ªæ¨¡åçå¤´é¨ï¼é¦åæ§è¡ã\n\nfoo();\n\nimport { foo } from 'my_module';\n\n\n1\n2\n3\n\n\nä¸é¢çä»£ç ä¸ä¼æ¥éï¼å ä¸ºimportçæ§è¡æ©äºfooçè°ç¨ãè¿ç§è¡ä¸ºçæ¬è´¨æ¯ï¼importå½ä»¤æ¯ç¼è¯é¶æ®µæ§è¡çï¼å¨ä»£ç è¿è¡ä¹åã\n\nç±äºimportæ¯éææ§è¡ï¼æä»¥ä¸è½ä½¿ç¨è¡¨è¾¾å¼ååéï¼è¿äºåªæå¨è¿è¡æ¶æè½å¾å°ç»æçè¯­æ³ç»æã\n\n// æ¥é\nimport { 'f' + 'oo' } from 'my_module';\n\n// æ¥é\nlet module = 'my_module';\nimport { foo } from module;\n\n// æ¥é\nif (x === 1) {\n  import { foo } from 'module1';\n} else {\n  import { foo } from 'module2';\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä¸ç§åæ³é½ä¼æ¥éï¼å ä¸ºå®ä»¬ç¨å°äºè¡¨è¾¾å¼ãåéåifç»æãå¨éæåæé¶æ®µï¼è¿äºè¯­æ³é½æ¯æ²¡æ³å¾å°å¼çã\n\næåï¼importè¯­å¥ä¼æ§è¡æå è½½çæ¨¡åï¼å æ­¤å¯ä»¥æä¸é¢çåæ³ã\n\nimport 'lodash';\n\n\n1\n\n\nä¸é¢ä»£ç ä»ä»æ§è¡lodashæ¨¡åï¼ä½æ¯ä¸è¾å¥ä»»ä½å¼ã\n\nå¦æå¤æ¬¡éå¤æ§è¡åä¸å¥importè¯­å¥ï¼é£ä¹åªä¼æ§è¡ä¸æ¬¡ï¼èä¸ä¼æ§è¡å¤æ¬¡ã\n\nimport 'lodash';\nimport 'lodash';\n\n\n1\n2\n\n\nä¸é¢ä»£ç å è½½äºä¸¤æ¬¡lodashï¼ä½æ¯åªä¼æ§è¡ä¸æ¬¡ã\n\nimport { foo } from 'my_module';\nimport { bar } from 'my_module';\n\n// ç­åäº\nimport { foo, bar } from 'my_module';\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼è½ç¶fooåbarå¨ä¸¤ä¸ªè¯­å¥ä¸­å è½½ï¼ä½æ¯å®ä»¬å¯¹åºçæ¯åä¸ä¸ªmy_moduleå®ä¾ãä¹å°±æ¯è¯´ï¼importè¯­å¥æ¯ Singleton æ¨¡å¼ã\n\nç®åé¶æ®µï¼éè¿ Babel è½¬ç ï¼CommonJS æ¨¡åçrequireå½ä»¤å ES6 æ¨¡åçimportå½ä»¤ï¼å¯ä»¥åå¨åä¸ä¸ªæ¨¡åéé¢ï¼ä½æ¯æå¥½ä¸è¦è¿æ ·åãå ä¸ºimportå¨éæè§£æé¶æ®µæ§è¡ï¼æä»¥å®æ¯ä¸ä¸ªæ¨¡åä¹ä¸­ææ©æ§è¡çãä¸é¢çä»£ç å¯è½ä¸ä¼å¾å°é¢æç»æã\n\nrequire('core-js/modules/es6.symbol');\nrequire('core-js/modules/es6.promise');\nimport React from 'React';\n\n\n1\n2\n3\n\n\n\n# æ¨¡åçæ´ä½å è½½-(æå·*)\n\né¤äºæå®å è½½æä¸ªè¾åºå¼ï¼è¿å¯ä»¥ä½¿ç¨æ´ä½å è½½ï¼å³ç¨æå·ï¼*ï¼æå®ä¸ä¸ªå¯¹è±¡ï¼ææè¾åºå¼é½å è½½å¨è¿ä¸ªå¯¹è±¡ä¸é¢ã\n\nä¸é¢æ¯ä¸ä¸ªcircle.jsæä»¶ï¼å®è¾åºä¸¤ä¸ªæ¹æ³areaåcircumferenceã\n\n// circle.js\n\nexport function area(radius) {\n  return Math.PI * radius * radius;\n}\n\nexport function circumference(radius) {\n  return 2 * Math.PI * radius;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nç°å¨ï¼å è½½è¿ä¸ªæ¨¡åã\n\n// main.js\n\nimport { area, circumference } from './circle';\n\nconsole.log('åé¢ç§¯ï¼' + area(4));\nconsole.log('åå¨é¿ï¼' + circumference(14));\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢åæ³æ¯éä¸æå®è¦å è½½çæ¹æ³ï¼æ´ä½å è½½çåæ³å¦ä¸ã\n\nimport * as circle from './circle';\n\nconsole.log('åé¢ç§¯ï¼' + circle.area(4));\nconsole.log('åå¨é¿ï¼' + circle.circumference(14));\n\n\n1\n2\n3\n4\n\n\næ³¨æï¼æ¨¡åæ´ä½å è½½æå¨çé£ä¸ªå¯¹è±¡ï¼ä¸ä¾æ¯circleï¼ï¼åºè¯¥æ¯å¯ä»¥éæåæçï¼æä»¥ä¸åè®¸è¿è¡æ¶æ¹åãä¸é¢çåæ³é½æ¯ä¸åè®¸çã\n\nimport * as circle from './circle';\n\n// ä¸é¢ä¸¤è¡é½æ¯ä¸åè®¸ç\ncircle.foo = 'hello';\ncircle.area = function () {};\n\n\n1\n2\n3\n4\n5\n\n\n\n# export default å½ä»¤\n\nä»åé¢çä¾å­å¯ä»¥çåºï¼ä½¿ç¨importå½ä»¤çæ¶åï¼ç¨æ·éè¦ç¥éæè¦å è½½çåéåæå½æ°åï¼å¦åæ æ³å è½½ãä½æ¯ï¼ç¨æ·è¯å®å¸æå¿«éä¸æï¼æªå¿æ¿æéè¯»ææ¡£ï¼å»äºè§£æ¨¡åæåªäºå±æ§åæ¹æ³ã\n\nä¸ºäºç»ç¨æ·æä¾æ¹ä¾¿ï¼è®©ä»ä»¬ä¸ç¨éè¯»ææ¡£å°±è½å è½½æ¨¡åï¼å°±è¦ç¨å°**export defaultå½ä»¤ï¼ä¸ºæ¨¡åæå®é»è®¤è¾åºã**\n\n// export-default.js\nexport default function () {\n  console.log('foo');\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç æ¯ä¸ä¸ªæ¨¡åæä»¶export-default.jsï¼å®çé»è®¤è¾åºæ¯ä¸ä¸ªå½æ°ã\n\nå¶ä»æ¨¡åå è½½è¯¥æ¨¡åæ¶ï¼importå½ä»¤å¯ä»¥ä¸ºè¯¥å¿åå½æ°æå®ä»»æåå­ã\n\n// import-default.js\nimport customName from './export-default';\ncustomName(); // 'foo'\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç çimportå½ä»¤ï¼å¯ä»¥ç¨ä»»æåç§°æåexport-default.jsè¾åºçæ¹æ³ï¼è¿æ¶å°±ä¸éè¦ç¥éåæ¨¡åè¾åºçå½æ°åãéè¦æ³¨æçæ¯ï¼è¿æ¶importå½ä»¤åé¢ï¼ä¸ä½¿ç¨å¤§æ¬å·ã\n\nexport defaultå½ä»¤ç¨å¨éå¿åå½æ°åï¼ä¹æ¯å¯ä»¥çã\n\n// export-default.js\nexport default function foo() {\n  console.log('foo');\n}\n\n// æèåæ\n\nfunction foo() {\n  console.log('foo');\n}\n\nexport default foo;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼fooå½æ°çå½æ°åfooï¼å¨æ¨¡åå¤é¨æ¯æ æçãå è½½çæ¶åï¼è§åå¿åå½æ°å è½½ã\n\nä¸é¢æ¯è¾ä¸ä¸é»è®¤è¾åºåæ­£å¸¸è¾åºã\n\n// ç¬¬ä¸ç»\nexport default function crc32() { // è¾åº\n  // ...\n}\n\nimport crc32 from 'crc32'; // è¾å¥\n\n// ç¬¬äºç»\nexport function crc32() { // è¾åº\n  // ...\n};\n\nimport {crc32} from 'crc32'; // è¾å¥\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç çä¸¤ç»åæ³ï¼ç¬¬ä¸ç»æ¯ä½¿ç¨export defaultæ¶ï¼å¯¹åºçimportè¯­å¥ä¸éè¦ä½¿ç¨å¤§æ¬å·ï¼ç¬¬äºç»æ¯ä¸ä½¿ç¨export defaultæ¶ï¼å¯¹åºçimportè¯­å¥éè¦ä½¿ç¨å¤§æ¬å·ã\n\nexport defaultå½ä»¤ç¨äºæå®æ¨¡åçé»è®¤è¾åºãæ¾ç¶ï¼ä¸ä¸ªæ¨¡ååªè½æä¸ä¸ªé»è®¤è¾åºï¼å æ­¤export defaultå½ä»¤åªè½ä½¿ç¨ä¸æ¬¡ãæä»¥ï¼importå½ä»¤åé¢æä¸ç¨å å¤§æ¬å·ï¼å ä¸ºåªå¯è½å¯ä¸å¯¹åºexport defaultå½ä»¤ã\n\n**æ¬è´¨ä¸ï¼export defaultå°±æ¯è¾åºä¸ä¸ªå«ådefaultçåéææ¹æ³ï¼**ç¶åç³»ç»åè®¸ä½ ä¸ºå®åä»»æåå­ãæä»¥ï¼ä¸é¢çåæ³æ¯ææçã\n\n// modules.js\nfunction add(x, y) {\n  return x * y;\n}\nexport {add as default};\n// ç­åäº\n// export default add;\n\n// app.js\nimport { default as foo } from 'modules';\n// ç­åäº\n// import foo from 'modules';\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\næ­£æ¯å ä¸ºexport defaultå½ä»¤å¶å®åªæ¯è¾åºä¸ä¸ªå«ådefaultçåéï¼æä»¥å®åé¢ä¸è½è·åéå£°æè¯­å¥ã\n\n// æ­£ç¡®\nexport var a = 1;\n\n// æ­£ç¡®\nvar a = 1;\nexport default a;\n\n// éè¯¯\nexport default var a = 1;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼export default açå«ä¹æ¯å°åéaçå¼èµç»åédefaultãæä»¥ï¼æåä¸ç§åæ³ä¼æ¥éã\n\nåæ ·å°ï¼å ä¸ºexport defaultå½ä»¤çæ¬è´¨æ¯å°åé¢çå¼ï¼èµç»defaultåéï¼æä»¥å¯ä»¥ç´æ¥å°ä¸ä¸ªå¼åå¨export defaultä¹åã\n\n// æ­£ç¡®\nexport default 42;\n\n// æ¥é\nexport 42;\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼åä¸å¥æ¥éæ¯å ä¸ºæ²¡ææå®å¯¹å¤çæ¥å£ï¼èåä¸å¥æå®å¯¹å¤æ¥å£ä¸ºdefaultã\n\næäºexport defaultå½ä»¤ï¼è¾å¥æ¨¡åæ¶å°±éå¸¸ç´è§äºï¼ä»¥è¾å¥ lodash æ¨¡åä¸ºä¾ã\n\nimport _ from 'lodash';\n\n\n1\n\n\nå¦ææ³å¨ä¸æ¡importè¯­å¥ä¸­ï¼åæ¶è¾å¥é»è®¤æ¹æ³åå¶ä»æ¥å£ï¼å¯ä»¥åæä¸é¢è¿æ ·ã\n\nimport _, { each, forEach } from 'lodash';\n\n\n1\n\n\nå¯¹åºä¸é¢ä»£ç çexportè¯­å¥å¦ä¸ã\n\nexport default function (obj) {\n  // Â·Â·Â·\n}\n\nexport function each(obj, iterator, context) {\n  // Â·Â·Â·\n}\n\nexport { each as forEach };\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç çæåä¸è¡çæææ¯ï¼æ´é²åºforEachæ¥å£ï¼é»è®¤æåeachæ¥å£ï¼å³forEachåeachæååä¸ä¸ªæ¹æ³ã\n\nexport defaultä¹å¯ä»¥ç¨æ¥è¾åºç±»ã\n\n// MyClass.js\nexport default class { ... }\n\n// main.js\nimport MyClass from 'MyClass';\nlet o = new MyClass();\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# export ä¸ import çå¤ååæ³\n\nå¦æå¨ä¸ä¸ªæ¨¡åä¹ä¸­ï¼åè¾å¥åè¾åºåä¸ä¸ªæ¨¡åï¼importè¯­å¥å¯ä»¥ä¸exportè¯­å¥åå¨ä¸èµ·ã\n\nexport { foo, bar } from 'my_module';\n\n// å¯ä»¥ç®åçè§£ä¸º\nimport { foo, bar } from 'my_module';\nexport { foo, bar };\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼exportåimportè¯­å¥å¯ä»¥ç»åå¨ä¸èµ·ï¼åæä¸è¡ãä½éè¦æ³¨æçæ¯ï¼åæä¸è¡ä»¥åï¼fooåbarå®éä¸å¹¶æ²¡æè¢«å¯¼å¥å½åæ¨¡åï¼åªæ¯ç¸å½äºå¯¹å¤è½¬åäºè¿ä¸¤ä¸ªæ¥å£ï¼å¯¼è´å½åæ¨¡åä¸è½ç´æ¥ä½¿ç¨fooåbarã\n\næ¨¡åçæ¥å£æ¹ååæ´ä½è¾åºï¼ä¹å¯ä»¥éç¨è¿ç§åæ³ã\n\n// æ¥å£æ¹å\nexport { foo as myFoo } from 'my_module';\n\n// æ´ä½è¾åº\nexport * from 'my_module';\n\n\n1\n2\n3\n4\n5\n\n\né»è®¤æ¥å£çåæ³å¦ä¸ã\n\nexport { default } from 'foo';\n\n\n1\n\n\nå·åæ¥å£æ¹ä¸ºé»è®¤æ¥å£çåæ³å¦ä¸ã\n\nexport { es6 as default } from './someModule';\n\n// ç­åäº\nimport { es6 } from './someModule';\nexport default es6;\n\n\n1\n2\n3\n4\n5\n\n\nåæ ·å°ï¼é»è®¤æ¥å£ä¹å¯ä»¥æ¹åä¸ºå·åæ¥å£ã\n\nexport { default as es6 } from './someModule';\n\n\n1\n\n\nä¸é¢ä¸ç§importè¯­å¥ï¼æ²¡æå¯¹åºçå¤ååæ³ã\n\nimport * as someIdentifier from \"someModule\";\nimport someIdentifier from \"someModule\";\nimport someIdentifier, { namedIdentifier } from \"someModule\";\n\n\n1\n2\n3\n\n\nä¸ºäºåå°å½¢å¼çå¯¹ç§°ï¼ç°å¨æææ¡ï¼æåºè¡¥ä¸è¿ä¸ç§å¤ååæ³ã\n\nexport * as someIdentifier from \"someModule\";\nexport someIdentifier from \"someModule\";\nexport someIdentifier, { namedIdentifier } from \"someModule\";\n\n\n1\n2\n3\n\n\n\n# æ¨¡åçç»§æ¿\n\næ¨¡åä¹é´ä¹å¯ä»¥ç»§æ¿ã\n\nåè®¾æä¸ä¸ªcircleplusæ¨¡åï¼ç»§æ¿äºcircleæ¨¡åã\n\n// circleplus.js\n\nexport * from 'circle';\nexport var e = 2.71828182846;\nexport default function(x) {\n  return Math.exp(x);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­çexport *ï¼è¡¨ç¤ºåè¾åºcircleæ¨¡åçææå±æ§åæ¹æ³ãæ³¨æï¼export *å½ä»¤ä¼å¿½ç¥circleæ¨¡åçdefaultæ¹æ³ãç¶åï¼ä¸é¢ä»£ç åè¾åºäºèªå®ä¹çeåéåé»è®¤æ¹æ³ã\n\nè¿æ¶ï¼ä¹å¯ä»¥å°circleçå±æ§ææ¹æ³ï¼æ¹åååè¾åºã\n\n// circleplus.js\n\nexport { area as circleArea } from 'circle';\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼åªè¾åºcircleæ¨¡åçareaæ¹æ³ï¼ä¸å°å¶æ¹åä¸ºcircleAreaã\n\nå è½½ä¸é¢æ¨¡åçåæ³å¦ä¸ã\n\n// main.js\n\nimport * as math from 'circleplus';\nimport exp from 'circleplus';\nconsole.log(exp(math.e));\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­çimport expè¡¨ç¤ºï¼å°circleplusæ¨¡åçé»è®¤æ¹æ³å è½½ä¸ºexpæ¹æ³ã\n\n\n# è·¨æ¨¡åå¸¸é\n\næ¬ä¹¦ä»ç»constå½ä»¤çæ¶åè¯´è¿ï¼constå£°æçå¸¸éåªå¨å½åä»£ç åææãå¦ææ³è®¾ç½®è·¨æ¨¡åçå¸¸éï¼å³è·¨å¤ä¸ªæä»¶ï¼ï¼æèè¯´ä¸ä¸ªå¼è¦è¢«å¤ä¸ªæ¨¡åå±äº«ï¼å¯ä»¥éç¨ä¸é¢çåæ³ã\n\n// constants.js æ¨¡å\nexport const A = 1;\nexport const B = 3;\nexport const C = 4;\n\n// test1.js æ¨¡å\nimport * as constants from './constants';\nconsole.log(constants.A); // 1\nconsole.log(constants.B); // 3\n\n// test2.js æ¨¡å\nimport {A, B} from './constants';\nconsole.log(A); // 1\nconsole.log(B); // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nå¦æè¦ä½¿ç¨çå¸¸ééå¸¸å¤ï¼å¯ä»¥å»ºä¸ä¸ªä¸é¨çconstantsç®å½ï¼å°åç§å¸¸éåå¨ä¸åçæä»¶éé¢ï¼ä¿å­å¨è¯¥ç®å½ä¸ã\n\n// constants/db.js\nexport const db = {\n  url: 'http://my.couchdbserver.local:5984',\n  admin_username: 'admin',\n  admin_password: 'admin password'\n};\n\n// constants/user.js\nexport const users = ['root', 'admin', 'staff', 'ceo', 'chief', 'moderator'];\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nç¶åï¼å°è¿äºæä»¶è¾åºçå¸¸éï¼åå¹¶å¨index.jséé¢ã\n\n// constants/index.js\nexport {db} from './db';\nexport {users} from './users';\n\n\n1\n2\n3\n\n\nä½¿ç¨çæ¶åï¼ç´æ¥å è½½index.jså°±å¯ä»¥äºã\n\n// script.js\nimport {db, users} from './constants/index';\n\n\n1\n2\n\n\n\n# import()\n\n\n# ç®ä»\n\nåé¢ä»ç»è¿ï¼importå½ä»¤ä¼è¢« JavaScript å¼æéæåæï¼åäºæ¨¡ååçå¶ä»è¯­å¥æ§è¡ï¼importå½ä»¤å«åâè¿æ¥â binding å¶å®æ´åéï¼ãæä»¥ï¼ä¸é¢çä»£ç ä¼æ¥éã\n\n// æ¥é\nif (x === 2) {\n  import MyModual from './myModual';\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼å¼æå¤çimportè¯­å¥æ¯å¨ç¼è¯æ¶ï¼è¿æ¶ä¸ä¼å»åæææ§è¡ifè¯­å¥ï¼æä»¥importè¯­å¥æ¾å¨ifä»£ç åä¹ä¸­æ¯«æ æä¹ï¼å æ­¤ä¼æ¥å¥æ³éè¯¯ï¼èä¸æ¯æ§è¡æ¶éè¯¯ãä¹å°±æ¯è¯´ï¼importåexportå½ä»¤åªè½å¨æ¨¡åçé¡¶å±ï¼ä¸è½å¨ä»£ç åä¹ä¸­ï¼æ¯å¦ï¼å¨ifä»£ç åä¹ä¸­ï¼æå¨å½æ°ä¹ä¸­ï¼ã\n\nè¿æ ·çè®¾è®¡ï¼åºç¶æå©äºç¼è¯å¨æé«æçï¼ä½ä¹å¯¼è´æ æ³å¨è¿è¡æ¶å è½½æ¨¡åãå¨è¯­æ³ä¸ï¼æ¡ä»¶å è½½å°±ä¸å¯è½å®ç°ãå¦æimportå½ä»¤è¦åä»£ Node çrequireæ¹æ³ï¼è¿å°±å½¢æäºä¸ä¸ªéç¢ãå ä¸ºrequireæ¯è¿è¡æ¶å è½½æ¨¡åï¼importå½ä»¤æ æ³åä»£requireçå¨æå è½½åè½ã\n\nconst path = './' + fileName;\nconst myModual = require(path);\n\n\n1\n2\n\n\nä¸é¢çè¯­å¥å°±æ¯å¨æå è½½ï¼requireå°åºå è½½åªä¸ä¸ªæ¨¡åï¼åªæè¿è¡æ¶æç¥éãimportå½ä»¤åä¸å°è¿ä¸ç¹ã\n\nES2020ææ¡ å¼å¥import()å½æ°ï¼æ¯æå¨æå è½½æ¨¡åã\n\nimport(specifier)\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼importå½æ°çåæ°specifierï¼æå®æè¦å è½½çæ¨¡åçä½ç½®ãimportå½ä»¤è½å¤æ¥åä»ä¹åæ°ï¼import()å½æ°å°±è½æ¥åä»ä¹åæ°ï¼ä¸¤èåºå«ä¸»è¦æ¯åèä¸ºå¨æå è½½ã\n\nimport()è¿åä¸ä¸ª Promise å¯¹è±¡ãä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nconst main = document.querySelector('main');\n\nimport(`./section-modules/${someVariable}.js`)\n  .then(module => {\n    module.loadPageInto(main);\n  })\n  .catch(err => {\n    main.textContent = err.message;\n  });\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nimport()å½æ°å¯ä»¥ç¨å¨ä»»ä½å°æ¹ï¼ä¸ä»ä»æ¯æ¨¡åï¼éæ¨¡åçèæ¬ä¹å¯ä»¥ä½¿ç¨ãå®æ¯è¿è¡æ¶æ§è¡ï¼ä¹å°±æ¯è¯´ï¼ä»ä¹æ¶åè¿è¡å°è¿ä¸å¥ï¼å°±ä¼å è½½æå®çæ¨¡åãå¦å¤ï¼import()å½æ°ä¸æå è½½çæ¨¡åæ²¡æéæè¿æ¥å³ç³»ï¼è¿ç¹ä¹æ¯ä¸importè¯­å¥ä¸ç¸åãimport()ç±»ä¼¼äº Node çrequireæ¹æ³ï¼åºå«ä¸»è¦æ¯åèæ¯å¼æ­¥å è½½ï¼åèæ¯åæ­¥å è½½ã\n\n\n# éç¨åºå\n\nä¸é¢æ¯import()çä¸äºéç¨åºåã\n\nï¼1ï¼æéå è½½ã\n\nimport()å¯ä»¥å¨éè¦çæ¶åï¼åå è½½æä¸ªæ¨¡åã\n\nbutton.addEventListener('click', event => {\n  import('./dialogBox.js')\n  .then(dialogBox => {\n    dialogBox.open();\n  })\n  .catch(error => {\n    /* Error handling */\n  })\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼import()æ¹æ³æ¾å¨clickäºä»¶ççå¬å½æ°ä¹ä¸­ï¼åªæç¨æ·ç¹å»äºæé®ï¼æä¼å è½½è¿ä¸ªæ¨¡åã\n\nï¼2ï¼æ¡ä»¶å è½½\n\nimport()å¯ä»¥æ¾å¨ifä»£ç åï¼æ ¹æ®ä¸åçæåµï¼å è½½ä¸åçæ¨¡åã\n\nif (condition) {\n  import('moduleA').then(...);\n} else {\n  import('moduleB').then(...);\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦ææ»¡è¶³æ¡ä»¶ï¼å°±å è½½æ¨¡å Aï¼å¦åå è½½æ¨¡å Bã\n\nï¼3ï¼å¨æçæ¨¡åè·¯å¾\n\nimport()åè®¸æ¨¡åè·¯å¾å¨æçæã\n\nimport(f())\n.then(...);\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼æ ¹æ®å½æ°fçè¿åç»æï¼å è½½ä¸åçæ¨¡åã\n\n\n# æ³¨æç¹\n\nimport()å è½½æ¨¡åæåä»¥åï¼è¿ä¸ªæ¨¡åä¼ä½ä¸ºä¸ä¸ªå¯¹è±¡ï¼å½ä½thenæ¹æ³çåæ°ãå æ­¤ï¼å¯ä»¥ä½¿ç¨å¯¹è±¡è§£æèµå¼çè¯­æ³ï¼è·åè¾åºæ¥å£ã\n\nimport('./myModule.js')\n.then(({export1, export2}) => {\n  // ...Â·\n});\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼export1åexport2é½æ¯myModule.jsçè¾åºæ¥å£ï¼å¯ä»¥è§£æè·å¾ã\n\nå¦ææ¨¡åædefaultè¾åºæ¥å£ï¼å¯ä»¥ç¨åæ°ç´æ¥è·å¾ã\n\nimport('./myModule.js')\n.then(myModule => {\n  console.log(myModule.default);\n});\n\n\n1\n2\n3\n4\n\n\nä¸é¢çä»£ç ä¹å¯ä»¥ä½¿ç¨å·åè¾å¥çå½¢å¼ã\n\nimport('./myModule.js')\n.then(({default: theDefault}) => {\n  console.log(theDefault);\n});\n\n\n1\n2\n3\n4\n\n\nå¦ææ³åæ¶å è½½å¤ä¸ªæ¨¡åï¼å¯ä»¥éç¨ä¸é¢çåæ³ã\n\nPromise.all([\n  import('./module1.js'),\n  import('./module2.js'),\n  import('./module3.js'),\n])\n.then(([module1, module2, module3]) => {\n   Â·Â·Â·\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nimport()ä¹å¯ä»¥ç¨å¨ async å½æ°ä¹ä¸­ã\n\nasync function main() {\n  const myModule = await import('./myModule.js');\n  const {export1, export2} = await import('./myModule.js');\n  const [module1, module2, module3] =\n    await Promise.all([\n      import('./module1.js'),\n      import('./module2.js'),\n      import('./module3.js'),\n    ]);\n}\nmain();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n",normalizedContent:"# module çè¯­æ³\n\n\n# æ¦è¿°\n\nåå²ä¸ï¼javascript ä¸ç´æ²¡ææ¨¡åï¼moduleï¼ä½ç³»ï¼æ æ³å°ä¸ä¸ªå¤§ç¨åºæåæäºç¸ä¾èµçå°æä»¶ï¼åç¨ç®åçæ¹æ³æ¼è£èµ·æ¥ãå¶ä»è¯­è¨é½æè¿é¡¹åè½ï¼æ¯å¦ ruby çrequireãpython çimportï¼çè³å°±è¿ css é½æ@importï¼ä½æ¯ javascript ä»»ä½è¿æ¹é¢çæ¯æé½æ²¡æï¼è¿å¯¹å¼åå¤§åçãå¤æçé¡¹ç®å½¢æäºå·¨å¤§éç¢ã å¨ es6 ä¹åï¼ç¤¾åºå¶å®äºä¸äºæ¨¡åå è½½æ¹æ¡ï¼æä¸»è¦çæ commonjs å amd ä¸¤ç§ãåèç¨äºæå¡å¨ï¼åèç¨äºæµè§å¨ães6 å¨è¯­è¨æ åçå±é¢ä¸ï¼å®ç°äºæ¨¡ååè½ï¼èä¸å®ç°å¾ç¸å½ç®åï¼å®å¨å¯ä»¥åä»£ commonjs å amd è§èï¼æä¸ºæµè§å¨åæå¡å¨éç¨çæ¨¡åè§£å³æ¹æ¡ã\n\nes6 æ¨¡åçè®¾è®¡ææ³æ¯å°½éçéæåï¼ä½¿å¾ç¼è¯æ¶å°±è½ç¡®å®æ¨¡åçä¾èµå³ç³»ï¼ä»¥åè¾å¥åè¾åºçåéãcommonjs å amd æ¨¡åï¼é½åªè½å¨è¿è¡æ¶ç¡®å®è¿äºä¸è¥¿ãæ¯å¦ï¼commonjs æ¨¡åå°±æ¯å¯¹è±¡ï¼è¾å¥æ¶å¿é¡»æ¥æ¾å¯¹è±¡å±æ§ã\n\n// commonjsæ¨¡å\nlet { stat, exists, readfile } = require('fs');\n\n// ç­åäº\nlet _fs = require('fs');\nlet stat = _fs.stat;\nlet exists = _fs.exists;\nlet readfile = _fs.readfile;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç çå®è´¨æ¯æ´ä½å è½½fsæ¨¡åï¼å³å è½½fsçæææ¹æ³ï¼ï¼çæä¸ä¸ªå¯¹è±¡ï¼_fsï¼ï¼ç¶ååä»è¿ä¸ªå¯¹è±¡ä¸é¢è¯»å 3 ä¸ªæ¹æ³ãè¿ç§å è½½ç§°ä¸ºâè¿è¡æ¶å è½½âï¼å ä¸ºåªæè¿è¡æ¶æè½å¾å°è¿ä¸ªå¯¹è±¡ï¼å¯¼è´å®å¨æ²¡åæ³å¨ç¼è¯æ¶åâéæä¼åâã\n\nes6 æ¨¡åä¸æ¯å¯¹è±¡ï¼èæ¯éè¿exportå½ä»¤æ¾å¼æå®è¾åºçä»£ç ï¼åéè¿importå½ä»¤è¾å¥ã\n\n// es6æ¨¡å\nimport { stat, exists, readfile } from 'fs';\n\n\n1\n2\n\n\nä¸é¢ä»£ç çå®è´¨æ¯ä»fsæ¨¡åå è½½ 3 ä¸ªæ¹æ³ï¼å¶ä»æ¹æ³ä¸å è½½ãè¿ç§å è½½ç§°ä¸ºâç¼è¯æ¶å è½½âæèéæå è½½ï¼**å³ es6 å¯ä»¥å¨ç¼è¯æ¶å°±å®ææ¨¡åå è½½ï¼**æçè¦æ¯ commonjs æ¨¡åçå è½½æ¹å¼é«ãå½ç¶ï¼è¿ä¹å¯¼è´äºæ²¡æ³å¼ç¨ es6 æ¨¡åæ¬èº«ï¼å ä¸ºå®ä¸æ¯å¯¹è±¡ã\n\nç±äº es6 æ¨¡åæ¯ç¼è¯æ¶å è½½ï¼ä½¿å¾éæåææä¸ºå¯è½ãæäºå®ï¼å°±è½è¿ä¸æ­¥æå®½ javascript çè¯­æ³ï¼æ¯å¦å¼å¥å®ï¼macroï¼åç±»åæ£éªï¼type systemï¼è¿äºåªè½é éæåæå®ç°çåè½ã\n\né¤äºéæå è½½å¸¦æ¥çåç§å¥½å¤ï¼es6 æ¨¡åè¿æä»¥ä¸å¥½å¤ã\n\n * ä¸åéè¦umdæ¨¡åæ ¼å¼äºï¼å°æ¥æå¡å¨åæµè§å¨é½ä¼æ¯æ es6 æ¨¡åæ ¼å¼ãç®åï¼éè¿åç§å·¥å·åºï¼å¶å®å·²ç»åå°äºè¿ä¸ç¹ã\n * å°æ¥æµè§å¨çæ° api å°±è½ç¨æ¨¡åæ ¼å¼æä¾ï¼ä¸åå¿é¡»åæå¨å±åéæènavigatorå¯¹è±¡çå±æ§ã\n * ä¸åéè¦å¯¹è±¡ä½ä¸ºå½åç©ºé´ï¼æ¯å¦mathå¯¹è±¡ï¼ï¼æªæ¥è¿äºåè½å¯ä»¥éè¿æ¨¡åæä¾ã\n\næ¬ç« ä»ç» es6 æ¨¡åçè¯­æ³ï¼ä¸ä¸ç« ä»ç»å¦ä½å¨æµè§å¨å node ä¹ä¸­ï¼å è½½ es6 æ¨¡åã\n\n\n# ä¸¥æ ¼æ¨¡å¼\n\nes6 çæ¨¡åèªå¨éç¨ä¸¥æ ¼æ¨¡å¼ï¼ä¸ç®¡ä½ ææ²¡æå¨æ¨¡åå¤´é¨å ä¸\"use strict\";ã\n\nä¸¥æ ¼æ¨¡å¼ä¸»è¦æä»¥ä¸éå¶ã\n\n * åéå¿é¡»å£°æååä½¿ç¨\n * å½æ°çåæ°ä¸è½æååå±æ§ï¼å¦åæ¥é\n * ä¸è½ä½¿ç¨withè¯­å¥\n * ä¸è½å¯¹åªè¯»å±æ§èµå¼ï¼å¦åæ¥é\n * ä¸è½ä½¿ç¨åç¼ 0 è¡¨ç¤ºå«è¿å¶æ°ï¼å¦åæ¥é\n * ä¸è½å é¤ä¸å¯å é¤çå±æ§ï¼å¦åæ¥é\n * ä¸è½å é¤åédelete propï¼ä¼æ¥éï¼åªè½å é¤å±æ§delete global[prop]\n * evalä¸ä¼å¨å®çå¤å±ä½ç¨åå¼å¥åé\n * evalåargumentsä¸è½è¢«éæ°èµå¼\n * argumentsä¸ä¼èªå¨åæ å½æ°åæ°çåå\n * ä¸è½ä½¿ç¨arguments.callee\n * ä¸è½ä½¿ç¨arguments.caller\n * ç¦æ­¢thisæåå¨å±å¯¹è±¡\n * ä¸è½ä½¿ç¨fn.calleråfn.argumentsè·åå½æ°è°ç¨çå æ \n * å¢å äºä¿çå­ï¼æ¯å¦protectedãstaticåinterfaceï¼\n\nä¸é¢è¿äºéå¶ï¼æ¨¡åé½å¿é¡»éµå®ãç±äºä¸¥æ ¼æ¨¡å¼æ¯ es5 å¼å¥çï¼ä¸å±äº es6ï¼æä»¥è¯·åéç¸å³ es5 ä¹¦ç±ï¼æ¬ä¹¦ä¸åè¯¦ç»ä»ç»äºã\n\nå¶ä¸­ï¼å°¤å¶éè¦æ³¨æthisçéå¶ães6 æ¨¡åä¹ä¸­ï¼é¡¶å±çthisæåundefinedï¼å³ä¸åºè¯¥å¨é¡¶å±ä»£ç ä½¿ç¨thisã\n\n\n# export å½ä»¤\n\næ¨¡ååè½ä¸»è¦ç±ä¸¤ä¸ªå½ä»¤ææï¼exportåimportãexportå½ä»¤ç¨äºè§å®æ¨¡åçå¯¹å¤æ¥å£ï¼importå½ä»¤ç¨äºè¾å¥å¶ä»æ¨¡åæä¾çåè½ã\n\nä¸ä¸ªæ¨¡åå°±æ¯ä¸ä¸ªç¬ç«çæä»¶ãè¯¥æä»¶åé¨çææåéï¼å¤é¨æ æ³è·åãå¦æä½ å¸æå¤é¨è½å¤è¯»åæ¨¡ååé¨çæä¸ªåéï¼å°±å¿é¡»ä½¿ç¨exportå³é®å­è¾åºè¯¥åéãä¸é¢æ¯ä¸ä¸ª js æä»¶ï¼éé¢ä½¿ç¨exportå½ä»¤è¾åºåéã\n\n// profile.js\nexport var firstname = 'michael';\nexport var lastname = 'jackson';\nexport var year = 1958;\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç æ¯profile.jsæä»¶ï¼ä¿å­äºç¨æ·ä¿¡æ¯ães6 å°å¶è§ä¸ºä¸ä¸ªæ¨¡åï¼éé¢ç¨exportå½ä»¤å¯¹å¤é¨è¾åºäºä¸ä¸ªåéã\n\nexportçåæ³ï¼é¤äºåä¸é¢è¿æ ·ï¼è¿æå¦å¤ä¸ç§ã\n\n// profile.js\nvar firstname = 'michael';\nvar lastname = 'jackson';\nvar year = 1958;\n\nexport { firstname, lastname, year };\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç å¨exportå½ä»¤åé¢ï¼ä½¿ç¨å¤§æ¬å·æå®æè¦è¾åºçä¸ç»åéãå®ä¸åä¸ç§åæ³ï¼ç´æ¥æ¾ç½®å¨varè¯­å¥åï¼æ¯ç­ä»·çï¼ä½æ¯åºè¯¥ä¼åèèä½¿ç¨è¿ç§åæ³ãå ä¸ºè¿æ ·å°±å¯ä»¥å¨èæ¬å°¾é¨ï¼ä¸ç¼çæ¸æ¥è¾åºäºåªäºåéã\n\nexportå½ä»¤é¤äºè¾åºåéï¼è¿å¯ä»¥è¾åºå½æ°æç±»ï¼classï¼ã\n\nexport function multiply(x, y) {\n  return x * y;\n};\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç å¯¹å¤è¾åºä¸ä¸ªå½æ°multiplyã\n\néå¸¸æåµä¸ï¼exportè¾åºçåéå°±æ¯æ¬æ¥çåå­ï¼ä½æ¯å¯ä»¥ä½¿ç¨aså³é®å­éå½åã\n\nfunction v1() { ... }\nfunction v2() { ... }\n\nexport {\n  v1 as streamv1,\n  v2 as streamv2,\n  v2 as streamlatestversion\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä½¿ç¨aså³é®å­ï¼éå½åäºå½æ°v1åv2çå¯¹å¤æ¥å£ãéå½ååï¼v2å¯ä»¥ç¨ä¸åçåå­è¾åºä¸¤æ¬¡ã\n\néè¦ç¹å«æ³¨æçæ¯ï¼exportå½ä»¤è§å®çæ¯å¯¹å¤çæ¥å£ï¼å¿é¡»ä¸æ¨¡ååé¨çåéå»ºç«ä¸ä¸å¯¹åºå³ç³»ã\n\n// æ¥é\nexport 1;\n\n// æ¥é\nvar m = 1;\nexport m;\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä¸¤ç§åæ³é½ä¼æ¥éï¼å ä¸ºæ²¡ææä¾å¯¹å¤çæ¥å£ãç¬¬ä¸ç§åæ³ç´æ¥è¾åº 1ï¼ç¬¬äºç§åæ³éè¿åémï¼è¿æ¯ç´æ¥è¾åº 1ã1åªæ¯ä¸ä¸ªå¼ï¼ä¸æ¯æ¥å£ãæ­£ç¡®çåæ³æ¯ä¸é¢è¿æ ·ã\n\n// åæ³ä¸\nexport var m = 1;\n\n// åæ³äº\nvar m = 1;\nexport {m};\n\n// åæ³ä¸\nvar n = 1;\nexport {n as m};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä¸ç§åæ³é½æ¯æ­£ç¡®çï¼è§å®äºå¯¹å¤çæ¥å£mãå¶ä»èæ¬å¯ä»¥éè¿è¿ä¸ªæ¥å£ï¼åå°å¼1ãå®ä»¬çå®è´¨æ¯ï¼å¨æ¥å£åä¸æ¨¡ååé¨åéä¹é´ï¼å»ºç«äºä¸ä¸å¯¹åºçå³ç³»ã\n\nåæ ·çï¼functionåclassçè¾åºï¼ä¹å¿é¡»éµå®è¿æ ·çåæ³ã\n\n// æ¥é\nfunction f() {}\nexport f;\n\n// æ­£ç¡®\nexport function f() {};\n\n// æ­£ç¡®\nfunction f() {}\nexport {f};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¦å¤ï¼exportè¯­å¥è¾åºçæ¥å£ï¼ä¸å¶å¯¹åºçå¼æ¯å¨æç»å®å³ç³»ï¼å³éè¿è¯¥æ¥å£ï¼å¯ä»¥åå°æ¨¡ååé¨å®æ¶çå¼ã\n\nexport var foo = 'bar';\nsettimeout(() => foo = 'baz', 500);\n\n\n1\n2\n\n\nä¸é¢ä»£ç è¾åºåéfooï¼å¼ä¸ºbarï¼500 æ¯«ç§ä¹ååæbazã\n\nè¿ä¸ç¹ä¸ commonjs è§èå®å¨ä¸åãcommonjs æ¨¡åè¾åºçæ¯å¼çç¼å­ï¼ä¸å­å¨å¨ææ´æ°ï¼è¯¦è§ä¸æãmodule çå è½½å®ç°ãä¸èã\n\næåï¼exportå½ä»¤å¯ä»¥åºç°å¨æ¨¡åçä»»ä½ä½ç½®ï¼åªè¦å¤äºæ¨¡åé¡¶å±å°±å¯ä»¥ãå¦æå¤äºåçº§ä½ç¨ååï¼å°±ä¼æ¥éï¼ä¸ä¸èçimportå½ä»¤ä¹æ¯å¦æ­¤ãè¿æ¯å ä¸ºå¤äºæ¡ä»¶ä»£ç åä¹ä¸­ï¼å°±æ²¡æ³åéæä¼åäºï¼è¿èäº es6 æ¨¡åçè®¾è®¡åè¡·ã\n\nfunction foo() {\n  export default 'bar' // syntaxerror\n}\nfoo()\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼exportè¯­å¥æ¾å¨å½æ°ä¹ä¸­ï¼ç»ææ¥éã\n\n\n# import å½ä»¤\n\nä½¿ç¨exportå½ä»¤å®ä¹äºæ¨¡åçå¯¹å¤æ¥å£ä»¥åï¼å¶ä» js æä»¶å°±å¯ä»¥éè¿importå½ä»¤å è½½è¿ä¸ªæ¨¡åã\n\n// main.js\nimport { firstname, lastname, year } from './profile.js';\n\nfunction setname(element) {\n  element.textcontent = firstname + ' ' + lastname;\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çimportå½ä»¤ï¼ç¨äºå è½½profile.jsæä»¶ï¼å¹¶ä»ä¸­è¾å¥åéãimportå½ä»¤æ¥åä¸å¯¹å¤§æ¬å·ï¼éé¢æå®è¦ä»å¶ä»æ¨¡åå¯¼å¥çåéåãå¤§æ¬å·éé¢çåéåï¼å¿é¡»ä¸è¢«å¯¼å¥æ¨¡åï¼profile.jsï¼å¯¹å¤æ¥å£çåç§°ç¸åã\n\nå¦ææ³ä¸ºè¾å¥çåééæ°åä¸ä¸ªåå­**ï¼importå½ä»¤è¦ä½¿ç¨aså³é®å­ï¼å°è¾å¥çåééå½åã**\n\nimport { lastname as surname } from './profile.js';\n\n\n1\n\n\nimportå½ä»¤è¾å¥çåéé½æ¯åªè¯»çï¼å ä¸ºå®çæ¬è´¨æ¯è¾å¥æ¥å£ãä¹å°±æ¯è¯´ï¼ä¸åè®¸å¨å è½½æ¨¡åçèæ¬éé¢ï¼æ¹åæ¥å£ã\n\nimport {a} from './xxx.js'\n\na = {}; // syntax error : 'a' is read-only;\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼èæ¬å è½½äºåéaï¼å¯¹å¶éæ°èµå¼å°±ä¼æ¥éï¼å ä¸ºaæ¯ä¸ä¸ªåªè¯»çæ¥å£ãä½æ¯**ï¼å¦æaæ¯ä¸ä¸ªå¯¹è±¡ï¼æ¹åaçå±æ§æ¯åè®¸ç**ã\n\nimport {a} from './xxx.js'\n\na.foo = 'hello'; // åæ³æä½\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼açå±æ§å¯ä»¥æåæ¹åï¼å¹¶ä¸å¶ä»æ¨¡åä¹å¯ä»¥è¯»å°æ¹ååçå¼ãä¸è¿ï¼è¿ç§åæ³å¾é¾æ¥éï¼å»ºè®®å¡æ¯è¾å¥çåéï¼é½å½ä½å®å¨åªè¯»ï¼ä¸è¦è½»ææ¹åå®çå±æ§ã\n\nimportåé¢çfromæå®æ¨¡åæä»¶çä½ç½®ï¼å¯ä»¥æ¯ç¸å¯¹è·¯å¾ï¼ä¹å¯ä»¥æ¯ç»å¯¹è·¯å¾ï¼.jsåç¼å¯ä»¥çç¥ãå¦æåªæ¯æ¨¡ååï¼ä¸å¸¦æè·¯å¾ï¼é£ä¹å¿é¡»æéç½®æä»¶ï¼åè¯ javascript å¼æè¯¥æ¨¡åçä½ç½®ã\n\nimport {mymethod} from 'util';\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼utilæ¯æ¨¡åæä»¶åï¼ç±äºä¸å¸¦æè·¯å¾ï¼å¿é¡»éè¿éç½®ï¼åè¯å¼ææä¹åå°è¿ä¸ªæ¨¡åã\n\næ³¨æï¼importå½ä»¤å·ææåææï¼ä¼æåå°æ´ä¸ªæ¨¡åçå¤´é¨ï¼é¦åæ§è¡ã\n\nfoo();\n\nimport { foo } from 'my_module';\n\n\n1\n2\n3\n\n\nä¸é¢çä»£ç ä¸ä¼æ¥éï¼å ä¸ºimportçæ§è¡æ©äºfooçè°ç¨ãè¿ç§è¡ä¸ºçæ¬è´¨æ¯ï¼importå½ä»¤æ¯ç¼è¯é¶æ®µæ§è¡çï¼å¨ä»£ç è¿è¡ä¹åã\n\nç±äºimportæ¯éææ§è¡ï¼æä»¥ä¸è½ä½¿ç¨è¡¨è¾¾å¼ååéï¼è¿äºåªæå¨è¿è¡æ¶æè½å¾å°ç»æçè¯­æ³ç»æã\n\n// æ¥é\nimport { 'f' + 'oo' } from 'my_module';\n\n// æ¥é\nlet module = 'my_module';\nimport { foo } from module;\n\n// æ¥é\nif (x === 1) {\n  import { foo } from 'module1';\n} else {\n  import { foo } from 'module2';\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä¸ç§åæ³é½ä¼æ¥éï¼å ä¸ºå®ä»¬ç¨å°äºè¡¨è¾¾å¼ãåéåifç»æãå¨éæåæé¶æ®µï¼è¿äºè¯­æ³é½æ¯æ²¡æ³å¾å°å¼çã\n\næåï¼importè¯­å¥ä¼æ§è¡æå è½½çæ¨¡åï¼å æ­¤å¯ä»¥æä¸é¢çåæ³ã\n\nimport 'lodash';\n\n\n1\n\n\nä¸é¢ä»£ç ä»ä»æ§è¡lodashæ¨¡åï¼ä½æ¯ä¸è¾å¥ä»»ä½å¼ã\n\nå¦æå¤æ¬¡éå¤æ§è¡åä¸å¥importè¯­å¥ï¼é£ä¹åªä¼æ§è¡ä¸æ¬¡ï¼èä¸ä¼æ§è¡å¤æ¬¡ã\n\nimport 'lodash';\nimport 'lodash';\n\n\n1\n2\n\n\nä¸é¢ä»£ç å è½½äºä¸¤æ¬¡lodashï¼ä½æ¯åªä¼æ§è¡ä¸æ¬¡ã\n\nimport { foo } from 'my_module';\nimport { bar } from 'my_module';\n\n// ç­åäº\nimport { foo, bar } from 'my_module';\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼è½ç¶fooåbarå¨ä¸¤ä¸ªè¯­å¥ä¸­å è½½ï¼ä½æ¯å®ä»¬å¯¹åºçæ¯åä¸ä¸ªmy_moduleå®ä¾ãä¹å°±æ¯è¯´ï¼importè¯­å¥æ¯ singleton æ¨¡å¼ã\n\nç®åé¶æ®µï¼éè¿ babel è½¬ç ï¼commonjs æ¨¡åçrequireå½ä»¤å es6 æ¨¡åçimportå½ä»¤ï¼å¯ä»¥åå¨åä¸ä¸ªæ¨¡åéé¢ï¼ä½æ¯æå¥½ä¸è¦è¿æ ·åãå ä¸ºimportå¨éæè§£æé¶æ®µæ§è¡ï¼æä»¥å®æ¯ä¸ä¸ªæ¨¡åä¹ä¸­ææ©æ§è¡çãä¸é¢çä»£ç å¯è½ä¸ä¼å¾å°é¢æç»æã\n\nrequire('core-js/modules/es6.symbol');\nrequire('core-js/modules/es6.promise');\nimport react from 'react';\n\n\n1\n2\n3\n\n\n\n# æ¨¡åçæ´ä½å è½½-(æå·*)\n\né¤äºæå®å è½½æä¸ªè¾åºå¼ï¼è¿å¯ä»¥ä½¿ç¨æ´ä½å è½½ï¼å³ç¨æå·ï¼*ï¼æå®ä¸ä¸ªå¯¹è±¡ï¼ææè¾åºå¼é½å è½½å¨è¿ä¸ªå¯¹è±¡ä¸é¢ã\n\nä¸é¢æ¯ä¸ä¸ªcircle.jsæä»¶ï¼å®è¾åºä¸¤ä¸ªæ¹æ³areaåcircumferenceã\n\n// circle.js\n\nexport function area(radius) {\n  return math.pi * radius * radius;\n}\n\nexport function circumference(radius) {\n  return 2 * math.pi * radius;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nç°å¨ï¼å è½½è¿ä¸ªæ¨¡åã\n\n// main.js\n\nimport { area, circumference } from './circle';\n\nconsole.log('åé¢ç§¯ï¼' + area(4));\nconsole.log('åå¨é¿ï¼' + circumference(14));\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢åæ³æ¯éä¸æå®è¦å è½½çæ¹æ³ï¼æ´ä½å è½½çåæ³å¦ä¸ã\n\nimport * as circle from './circle';\n\nconsole.log('åé¢ç§¯ï¼' + circle.area(4));\nconsole.log('åå¨é¿ï¼' + circle.circumference(14));\n\n\n1\n2\n3\n4\n\n\næ³¨æï¼æ¨¡åæ´ä½å è½½æå¨çé£ä¸ªå¯¹è±¡ï¼ä¸ä¾æ¯circleï¼ï¼åºè¯¥æ¯å¯ä»¥éæåæçï¼æä»¥ä¸åè®¸è¿è¡æ¶æ¹åãä¸é¢çåæ³é½æ¯ä¸åè®¸çã\n\nimport * as circle from './circle';\n\n// ä¸é¢ä¸¤è¡é½æ¯ä¸åè®¸ç\ncircle.foo = 'hello';\ncircle.area = function () {};\n\n\n1\n2\n3\n4\n5\n\n\n\n# export default å½ä»¤\n\nä»åé¢çä¾å­å¯ä»¥çåºï¼ä½¿ç¨importå½ä»¤çæ¶åï¼ç¨æ·éè¦ç¥éæè¦å è½½çåéåæå½æ°åï¼å¦åæ æ³å è½½ãä½æ¯ï¼ç¨æ·è¯å®å¸æå¿«éä¸æï¼æªå¿æ¿æéè¯»ææ¡£ï¼å»äºè§£æ¨¡åæåªäºå±æ§åæ¹æ³ã\n\nä¸ºäºç»ç¨æ·æä¾æ¹ä¾¿ï¼è®©ä»ä»¬ä¸ç¨éè¯»ææ¡£å°±è½å è½½æ¨¡åï¼å°±è¦ç¨å°**export defaultå½ä»¤ï¼ä¸ºæ¨¡åæå®é»è®¤è¾åºã**\n\n// export-default.js\nexport default function () {\n  console.log('foo');\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç æ¯ä¸ä¸ªæ¨¡åæä»¶export-default.jsï¼å®çé»è®¤è¾åºæ¯ä¸ä¸ªå½æ°ã\n\nå¶ä»æ¨¡åå è½½è¯¥æ¨¡åæ¶ï¼importå½ä»¤å¯ä»¥ä¸ºè¯¥å¿åå½æ°æå®ä»»æåå­ã\n\n// import-default.js\nimport customname from './export-default';\ncustomname(); // 'foo'\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç çimportå½ä»¤ï¼å¯ä»¥ç¨ä»»æåç§°æåexport-default.jsè¾åºçæ¹æ³ï¼è¿æ¶å°±ä¸éè¦ç¥éåæ¨¡åè¾åºçå½æ°åãéè¦æ³¨æçæ¯ï¼è¿æ¶importå½ä»¤åé¢ï¼ä¸ä½¿ç¨å¤§æ¬å·ã\n\nexport defaultå½ä»¤ç¨å¨éå¿åå½æ°åï¼ä¹æ¯å¯ä»¥çã\n\n// export-default.js\nexport default function foo() {\n  console.log('foo');\n}\n\n// æèåæ\n\nfunction foo() {\n  console.log('foo');\n}\n\nexport default foo;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼fooå½æ°çå½æ°åfooï¼å¨æ¨¡åå¤é¨æ¯æ æçãå è½½çæ¶åï¼è§åå¿åå½æ°å è½½ã\n\nä¸é¢æ¯è¾ä¸ä¸é»è®¤è¾åºåæ­£å¸¸è¾åºã\n\n// ç¬¬ä¸ç»\nexport default function crc32() { // è¾åº\n  // ...\n}\n\nimport crc32 from 'crc32'; // è¾å¥\n\n// ç¬¬äºç»\nexport function crc32() { // è¾åº\n  // ...\n};\n\nimport {crc32} from 'crc32'; // è¾å¥\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç çä¸¤ç»åæ³ï¼ç¬¬ä¸ç»æ¯ä½¿ç¨export defaultæ¶ï¼å¯¹åºçimportè¯­å¥ä¸éè¦ä½¿ç¨å¤§æ¬å·ï¼ç¬¬äºç»æ¯ä¸ä½¿ç¨export defaultæ¶ï¼å¯¹åºçimportè¯­å¥éè¦ä½¿ç¨å¤§æ¬å·ã\n\nexport defaultå½ä»¤ç¨äºæå®æ¨¡åçé»è®¤è¾åºãæ¾ç¶ï¼ä¸ä¸ªæ¨¡ååªè½æä¸ä¸ªé»è®¤è¾åºï¼å æ­¤export defaultå½ä»¤åªè½ä½¿ç¨ä¸æ¬¡ãæä»¥ï¼importå½ä»¤åé¢æä¸ç¨å å¤§æ¬å·ï¼å ä¸ºåªå¯è½å¯ä¸å¯¹åºexport defaultå½ä»¤ã\n\n**æ¬è´¨ä¸ï¼export defaultå°±æ¯è¾åºä¸ä¸ªå«ådefaultçåéææ¹æ³ï¼**ç¶åç³»ç»åè®¸ä½ ä¸ºå®åä»»æåå­ãæä»¥ï¼ä¸é¢çåæ³æ¯ææçã\n\n// modules.js\nfunction add(x, y) {\n  return x * y;\n}\nexport {add as default};\n// ç­åäº\n// export default add;\n\n// app.js\nimport { default as foo } from 'modules';\n// ç­åäº\n// import foo from 'modules';\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\næ­£æ¯å ä¸ºexport defaultå½ä»¤å¶å®åªæ¯è¾åºä¸ä¸ªå«ådefaultçåéï¼æä»¥å®åé¢ä¸è½è·åéå£°æè¯­å¥ã\n\n// æ­£ç¡®\nexport var a = 1;\n\n// æ­£ç¡®\nvar a = 1;\nexport default a;\n\n// éè¯¯\nexport default var a = 1;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼export default açå«ä¹æ¯å°åéaçå¼èµç»åédefaultãæä»¥ï¼æåä¸ç§åæ³ä¼æ¥éã\n\nåæ ·å°ï¼å ä¸ºexport defaultå½ä»¤çæ¬è´¨æ¯å°åé¢çå¼ï¼èµç»defaultåéï¼æä»¥å¯ä»¥ç´æ¥å°ä¸ä¸ªå¼åå¨export defaultä¹åã\n\n// æ­£ç¡®\nexport default 42;\n\n// æ¥é\nexport 42;\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼åä¸å¥æ¥éæ¯å ä¸ºæ²¡ææå®å¯¹å¤çæ¥å£ï¼èåä¸å¥æå®å¯¹å¤æ¥å£ä¸ºdefaultã\n\næäºexport defaultå½ä»¤ï¼è¾å¥æ¨¡åæ¶å°±éå¸¸ç´è§äºï¼ä»¥è¾å¥ lodash æ¨¡åä¸ºä¾ã\n\nimport _ from 'lodash';\n\n\n1\n\n\nå¦ææ³å¨ä¸æ¡importè¯­å¥ä¸­ï¼åæ¶è¾å¥é»è®¤æ¹æ³åå¶ä»æ¥å£ï¼å¯ä»¥åæä¸é¢è¿æ ·ã\n\nimport _, { each, foreach } from 'lodash';\n\n\n1\n\n\nå¯¹åºä¸é¢ä»£ç çexportè¯­å¥å¦ä¸ã\n\nexport default function (obj) {\n  // Â·Â·Â·\n}\n\nexport function each(obj, iterator, context) {\n  // Â·Â·Â·\n}\n\nexport { each as foreach };\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç çæåä¸è¡çæææ¯ï¼æ´é²åºforeachæ¥å£ï¼é»è®¤æåeachæ¥å£ï¼å³foreachåeachæååä¸ä¸ªæ¹æ³ã\n\nexport defaultä¹å¯ä»¥ç¨æ¥è¾åºç±»ã\n\n// myclass.js\nexport default class { ... }\n\n// main.js\nimport myclass from 'myclass';\nlet o = new myclass();\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# export ä¸ import çå¤ååæ³\n\nå¦æå¨ä¸ä¸ªæ¨¡åä¹ä¸­ï¼åè¾å¥åè¾åºåä¸ä¸ªæ¨¡åï¼importè¯­å¥å¯ä»¥ä¸exportè¯­å¥åå¨ä¸èµ·ã\n\nexport { foo, bar } from 'my_module';\n\n// å¯ä»¥ç®åçè§£ä¸º\nimport { foo, bar } from 'my_module';\nexport { foo, bar };\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼exportåimportè¯­å¥å¯ä»¥ç»åå¨ä¸èµ·ï¼åæä¸è¡ãä½éè¦æ³¨æçæ¯ï¼åæä¸è¡ä»¥åï¼fooåbarå®éä¸å¹¶æ²¡æè¢«å¯¼å¥å½åæ¨¡åï¼åªæ¯ç¸å½äºå¯¹å¤è½¬åäºè¿ä¸¤ä¸ªæ¥å£ï¼å¯¼è´å½åæ¨¡åä¸è½ç´æ¥ä½¿ç¨fooåbarã\n\næ¨¡åçæ¥å£æ¹ååæ´ä½è¾åºï¼ä¹å¯ä»¥éç¨è¿ç§åæ³ã\n\n// æ¥å£æ¹å\nexport { foo as myfoo } from 'my_module';\n\n// æ´ä½è¾åº\nexport * from 'my_module';\n\n\n1\n2\n3\n4\n5\n\n\né»è®¤æ¥å£çåæ³å¦ä¸ã\n\nexport { default } from 'foo';\n\n\n1\n\n\nå·åæ¥å£æ¹ä¸ºé»è®¤æ¥å£çåæ³å¦ä¸ã\n\nexport { es6 as default } from './somemodule';\n\n// ç­åäº\nimport { es6 } from './somemodule';\nexport default es6;\n\n\n1\n2\n3\n4\n5\n\n\nåæ ·å°ï¼é»è®¤æ¥å£ä¹å¯ä»¥æ¹åä¸ºå·åæ¥å£ã\n\nexport { default as es6 } from './somemodule';\n\n\n1\n\n\nä¸é¢ä¸ç§importè¯­å¥ï¼æ²¡æå¯¹åºçå¤ååæ³ã\n\nimport * as someidentifier from \"somemodule\";\nimport someidentifier from \"somemodule\";\nimport someidentifier, { namedidentifier } from \"somemodule\";\n\n\n1\n2\n3\n\n\nä¸ºäºåå°å½¢å¼çå¯¹ç§°ï¼ç°å¨æææ¡ï¼æåºè¡¥ä¸è¿ä¸ç§å¤ååæ³ã\n\nexport * as someidentifier from \"somemodule\";\nexport someidentifier from \"somemodule\";\nexport someidentifier, { namedidentifier } from \"somemodule\";\n\n\n1\n2\n3\n\n\n\n# æ¨¡åçç»§æ¿\n\næ¨¡åä¹é´ä¹å¯ä»¥ç»§æ¿ã\n\nåè®¾æä¸ä¸ªcircleplusæ¨¡åï¼ç»§æ¿äºcircleæ¨¡åã\n\n// circleplus.js\n\nexport * from 'circle';\nexport var e = 2.71828182846;\nexport default function(x) {\n  return math.exp(x);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­çexport *ï¼è¡¨ç¤ºåè¾åºcircleæ¨¡åçææå±æ§åæ¹æ³ãæ³¨æï¼export *å½ä»¤ä¼å¿½ç¥circleæ¨¡åçdefaultæ¹æ³ãç¶åï¼ä¸é¢ä»£ç åè¾åºäºèªå®ä¹çeåéåé»è®¤æ¹æ³ã\n\nè¿æ¶ï¼ä¹å¯ä»¥å°circleçå±æ§ææ¹æ³ï¼æ¹åååè¾åºã\n\n// circleplus.js\n\nexport { area as circlearea } from 'circle';\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼åªè¾åºcircleæ¨¡åçareaæ¹æ³ï¼ä¸å°å¶æ¹åä¸ºcircleareaã\n\nå è½½ä¸é¢æ¨¡åçåæ³å¦ä¸ã\n\n// main.js\n\nimport * as math from 'circleplus';\nimport exp from 'circleplus';\nconsole.log(exp(math.e));\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­çimport expè¡¨ç¤ºï¼å°circleplusæ¨¡åçé»è®¤æ¹æ³å è½½ä¸ºexpæ¹æ³ã\n\n\n# è·¨æ¨¡åå¸¸é\n\næ¬ä¹¦ä»ç»constå½ä»¤çæ¶åè¯´è¿ï¼constå£°æçå¸¸éåªå¨å½åä»£ç åææãå¦ææ³è®¾ç½®è·¨æ¨¡åçå¸¸éï¼å³è·¨å¤ä¸ªæä»¶ï¼ï¼æèè¯´ä¸ä¸ªå¼è¦è¢«å¤ä¸ªæ¨¡åå±äº«ï¼å¯ä»¥éç¨ä¸é¢çåæ³ã\n\n// constants.js æ¨¡å\nexport const a = 1;\nexport const b = 3;\nexport const c = 4;\n\n// test1.js æ¨¡å\nimport * as constants from './constants';\nconsole.log(constants.a); // 1\nconsole.log(constants.b); // 3\n\n// test2.js æ¨¡å\nimport {a, b} from './constants';\nconsole.log(a); // 1\nconsole.log(b); // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nå¦æè¦ä½¿ç¨çå¸¸ééå¸¸å¤ï¼å¯ä»¥å»ºä¸ä¸ªä¸é¨çconstantsç®å½ï¼å°åç§å¸¸éåå¨ä¸åçæä»¶éé¢ï¼ä¿å­å¨è¯¥ç®å½ä¸ã\n\n// constants/db.js\nexport const db = {\n  url: 'http://my.couchdbserver.local:5984',\n  admin_username: 'admin',\n  admin_password: 'admin password'\n};\n\n// constants/user.js\nexport const users = ['root', 'admin', 'staff', 'ceo', 'chief', 'moderator'];\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nç¶åï¼å°è¿äºæä»¶è¾åºçå¸¸éï¼åå¹¶å¨index.jséé¢ã\n\n// constants/index.js\nexport {db} from './db';\nexport {users} from './users';\n\n\n1\n2\n3\n\n\nä½¿ç¨çæ¶åï¼ç´æ¥å è½½index.jså°±å¯ä»¥äºã\n\n// script.js\nimport {db, users} from './constants/index';\n\n\n1\n2\n\n\n\n# import()\n\n\n# ç®ä»\n\nåé¢ä»ç»è¿ï¼importå½ä»¤ä¼è¢« javascript å¼æéæåæï¼åäºæ¨¡ååçå¶ä»è¯­å¥æ§è¡ï¼importå½ä»¤å«åâè¿æ¥â binding å¶å®æ´åéï¼ãæä»¥ï¼ä¸é¢çä»£ç ä¼æ¥éã\n\n// æ¥é\nif (x === 2) {\n  import mymodual from './mymodual';\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼å¼æå¤çimportè¯­å¥æ¯å¨ç¼è¯æ¶ï¼è¿æ¶ä¸ä¼å»åæææ§è¡ifè¯­å¥ï¼æä»¥importè¯­å¥æ¾å¨ifä»£ç åä¹ä¸­æ¯«æ æä¹ï¼å æ­¤ä¼æ¥å¥æ³éè¯¯ï¼èä¸æ¯æ§è¡æ¶éè¯¯ãä¹å°±æ¯è¯´ï¼importåexportå½ä»¤åªè½å¨æ¨¡åçé¡¶å±ï¼ä¸è½å¨ä»£ç åä¹ä¸­ï¼æ¯å¦ï¼å¨ifä»£ç åä¹ä¸­ï¼æå¨å½æ°ä¹ä¸­ï¼ã\n\nè¿æ ·çè®¾è®¡ï¼åºç¶æå©äºç¼è¯å¨æé«æçï¼ä½ä¹å¯¼è´æ æ³å¨è¿è¡æ¶å è½½æ¨¡åãå¨è¯­æ³ä¸ï¼æ¡ä»¶å è½½å°±ä¸å¯è½å®ç°ãå¦æimportå½ä»¤è¦åä»£ node çrequireæ¹æ³ï¼è¿å°±å½¢æäºä¸ä¸ªéç¢ãå ä¸ºrequireæ¯è¿è¡æ¶å è½½æ¨¡åï¼importå½ä»¤æ æ³åä»£requireçå¨æå è½½åè½ã\n\nconst path = './' + filename;\nconst mymodual = require(path);\n\n\n1\n2\n\n\nä¸é¢çè¯­å¥å°±æ¯å¨æå è½½ï¼requireå°åºå è½½åªä¸ä¸ªæ¨¡åï¼åªæè¿è¡æ¶æç¥éãimportå½ä»¤åä¸å°è¿ä¸ç¹ã\n\nes2020ææ¡ å¼å¥import()å½æ°ï¼æ¯æå¨æå è½½æ¨¡åã\n\nimport(specifier)\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼importå½æ°çåæ°specifierï¼æå®æè¦å è½½çæ¨¡åçä½ç½®ãimportå½ä»¤è½å¤æ¥åä»ä¹åæ°ï¼import()å½æ°å°±è½æ¥åä»ä¹åæ°ï¼ä¸¤èåºå«ä¸»è¦æ¯åèä¸ºå¨æå è½½ã\n\nimport()è¿åä¸ä¸ª promise å¯¹è±¡ãä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nconst main = document.queryselector('main');\n\nimport(`./section-modules/${somevariable}.js`)\n  .then(module => {\n    module.loadpageinto(main);\n  })\n  .catch(err => {\n    main.textcontent = err.message;\n  });\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nimport()å½æ°å¯ä»¥ç¨å¨ä»»ä½å°æ¹ï¼ä¸ä»ä»æ¯æ¨¡åï¼éæ¨¡åçèæ¬ä¹å¯ä»¥ä½¿ç¨ãå®æ¯è¿è¡æ¶æ§è¡ï¼ä¹å°±æ¯è¯´ï¼ä»ä¹æ¶åè¿è¡å°è¿ä¸å¥ï¼å°±ä¼å è½½æå®çæ¨¡åãå¦å¤ï¼import()å½æ°ä¸æå è½½çæ¨¡åæ²¡æéæè¿æ¥å³ç³»ï¼è¿ç¹ä¹æ¯ä¸importè¯­å¥ä¸ç¸åãimport()ç±»ä¼¼äº node çrequireæ¹æ³ï¼åºå«ä¸»è¦æ¯åèæ¯å¼æ­¥å è½½ï¼åèæ¯åæ­¥å è½½ã\n\n\n# éç¨åºå\n\nä¸é¢æ¯import()çä¸äºéç¨åºåã\n\nï¼1ï¼æéå è½½ã\n\nimport()å¯ä»¥å¨éè¦çæ¶åï¼åå è½½æä¸ªæ¨¡åã\n\nbutton.addeventlistener('click', event => {\n  import('./dialogbox.js')\n  .then(dialogbox => {\n    dialogbox.open();\n  })\n  .catch(error => {\n    /* error handling */\n  })\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼import()æ¹æ³æ¾å¨clickäºä»¶ççå¬å½æ°ä¹ä¸­ï¼åªæç¨æ·ç¹å»äºæé®ï¼æä¼å è½½è¿ä¸ªæ¨¡åã\n\nï¼2ï¼æ¡ä»¶å è½½\n\nimport()å¯ä»¥æ¾å¨ifä»£ç åï¼æ ¹æ®ä¸åçæåµï¼å è½½ä¸åçæ¨¡åã\n\nif (condition) {\n  import('modulea').then(...);\n} else {\n  import('moduleb').then(...);\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦ææ»¡è¶³æ¡ä»¶ï¼å°±å è½½æ¨¡å aï¼å¦åå è½½æ¨¡å bã\n\nï¼3ï¼å¨æçæ¨¡åè·¯å¾\n\nimport()åè®¸æ¨¡åè·¯å¾å¨æçæã\n\nimport(f())\n.then(...);\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼æ ¹æ®å½æ°fçè¿åç»æï¼å è½½ä¸åçæ¨¡åã\n\n\n# æ³¨æç¹\n\nimport()å è½½æ¨¡åæåä»¥åï¼è¿ä¸ªæ¨¡åä¼ä½ä¸ºä¸ä¸ªå¯¹è±¡ï¼å½ä½thenæ¹æ³çåæ°ãå æ­¤ï¼å¯ä»¥ä½¿ç¨å¯¹è±¡è§£æèµå¼çè¯­æ³ï¼è·åè¾åºæ¥å£ã\n\nimport('./mymodule.js')\n.then(({export1, export2}) => {\n  // ...Â·\n});\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼export1åexport2é½æ¯mymodule.jsçè¾åºæ¥å£ï¼å¯ä»¥è§£æè·å¾ã\n\nå¦ææ¨¡åædefaultè¾åºæ¥å£ï¼å¯ä»¥ç¨åæ°ç´æ¥è·å¾ã\n\nimport('./mymodule.js')\n.then(mymodule => {\n  console.log(mymodule.default);\n});\n\n\n1\n2\n3\n4\n\n\nä¸é¢çä»£ç ä¹å¯ä»¥ä½¿ç¨å·åè¾å¥çå½¢å¼ã\n\nimport('./mymodule.js')\n.then(({default: thedefault}) => {\n  console.log(thedefault);\n});\n\n\n1\n2\n3\n4\n\n\nå¦ææ³åæ¶å è½½å¤ä¸ªæ¨¡åï¼å¯ä»¥éç¨ä¸é¢çåæ³ã\n\npromise.all([\n  import('./module1.js'),\n  import('./module2.js'),\n  import('./module3.js'),\n])\n.then(([module1, module2, module3]) => {\n   Â·Â·Â·\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nimport()ä¹å¯ä»¥ç¨å¨ async å½æ°ä¹ä¸­ã\n\nasync function main() {\n  const mymodule = await import('./mymodule.js');\n  const {export1, export2} = await import('./mymodule.js');\n  const [module1, module2, module3] =\n    await promise.all([\n      import('./module1.js'),\n      import('./module2.js'),\n      import('./module3.js'),\n    ]);\n}\nmain();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Module çå è½½å®ç°",frontmatter:{title:"Module çå è½½å®ç°",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/a79ca2e64ceae213",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/24.Module%20%E7%9A%84%E5%8A%A0%E8%BD%BD%E5%AE%9E%E7%8E%B0.html",relativePath:"ãES6 æç¨ãç¬è®°/24.Module çå è½½å®ç°.md",key:"v-25827231",path:"/pages/a79ca2e64ceae213/",headers:[{level:2,title:"æµè§å¨å è½½",slug:"æµè§å¨å è½½",normalizedTitle:"æµè§å¨å è½½",charIndex:90},{level:3,title:"ä¼ ç»æ¹æ³",slug:"ä¼ ç»æ¹æ³",normalizedTitle:"ä¼ ç»æ¹æ³",charIndex:100},{level:3,title:"å è½½è§å",slug:"å è½½è§å",normalizedTitle:"å è½½è§å",charIndex:990},{level:2,title:"ES6 æ¨¡åä¸ CommonJS æ¨¡åçå·®å¼",slug:"es6-æ¨¡åä¸-commonjs-æ¨¡åçå·®å¼",normalizedTitle:"es6 æ¨¡åä¸ commonjs æ¨¡åçå·®å¼",charIndex:2460},{level:2,title:"Node.js å è½½",slug:"node-js-å è½½",normalizedTitle:"node.js å è½½",charIndex:2487},{level:3,title:"æ¦è¿°",slug:"æ¦è¿°",normalizedTitle:"æ¦è¿°",charIndex:5283},{level:3,title:"main å­æ®µ",slug:"main-å­æ®µ",normalizedTitle:"main å­æ®µ",charIndex:6048},{level:3,title:"exports å­æ®µ",slug:"exports-å­æ®µ",normalizedTitle:"exports å­æ®µ",charIndex:6676},{level:3,title:"ES6 æ¨¡åå è½½ CommonJS æ¨¡å",slug:"es6-æ¨¡åå è½½-commonjs-æ¨¡å",normalizedTitle:"es6 æ¨¡åå è½½ commonjs æ¨¡å",charIndex:8575},{level:3,title:"CommonJS æ¨¡åå è½½ ES6 æ¨¡å",slug:"commonjs-æ¨¡åå è½½-es6-æ¨¡å",normalizedTitle:"commonjs æ¨¡åå è½½ es6 æ¨¡å",charIndex:9699},{level:3,title:"Node.js çåç½®æ¨¡å",slug:"node-js-çåç½®æ¨¡å",normalizedTitle:"node.js çåç½®æ¨¡å",charIndex:9868},{level:3,title:"å è½½è·¯å¾",slug:"å è½½è·¯å¾",normalizedTitle:"å è½½è·¯å¾",charIndex:10193},{level:3,title:"åé¨åé",slug:"åé¨åé",normalizedTitle:"åé¨åé",charIndex:2982},{level:2,title:"å¾ªç¯å è½½",slug:"å¾ªç¯å è½½",normalizedTitle:"å¾ªç¯å è½½",charIndex:79},{level:3,title:"CommonJS æ¨¡åçå è½½åç",slug:"commonjs-æ¨¡åçå è½½åç",normalizedTitle:"commonjs æ¨¡åçå è½½åç",charIndex:11337},{level:3,title:"CommonJS æ¨¡åçå¾ªç¯å è½½",slug:"commonjs-æ¨¡åçå¾ªç¯å è½½",normalizedTitle:"commonjs æ¨¡åçå¾ªç¯å è½½",charIndex:11795},{level:3,title:"ES6 æ¨¡åçå¾ªç¯å è½½",slug:"es6-æ¨¡åçå¾ªç¯å è½½",normalizedTitle:"es6 æ¨¡åçå¾ªç¯å è½½",charIndex:13477}],excerpt:'<h1 id="module-çå è½½å®ç°"><a class="header-anchor" href="#module-çå è½½å®ç°">#</a> Module çå è½½å®ç°</h1>\n<p>ä¸ä¸ç« ä»ç»äºæ¨¡åçè¯­æ³ï¼æ¬ç« ä»ç»å¦ä½å¨æµè§å¨å Node.js ä¹ä¸­å è½½ ES6 æ¨¡åï¼ä»¥åå®éå¼åä¸­ç»å¸¸éå°çä¸äºé®é¢ï¼æ¯å¦å¾ªç¯å è½½ï¼ã</p>\n',headersStr:"æµè§å¨å è½½ ä¼ ç»æ¹æ³ å è½½è§å ES6 æ¨¡åä¸ CommonJS æ¨¡åçå·®å¼ Node.js å è½½ æ¦è¿° main å­æ®µ exports å­æ®µ ES6 æ¨¡åå è½½ CommonJS æ¨¡å CommonJS æ¨¡åå è½½ ES6 æ¨¡å Node.js çåç½®æ¨¡å å è½½è·¯å¾ åé¨åé å¾ªç¯å è½½ CommonJS æ¨¡åçå è½½åç CommonJS æ¨¡åçå¾ªç¯å è½½ ES6 æ¨¡åçå¾ªç¯å è½½",content:'# Module çå è½½å®ç°\n\nä¸ä¸ç« ä»ç»äºæ¨¡åçè¯­æ³ï¼æ¬ç« ä»ç»å¦ä½å¨æµè§å¨å Node.js ä¹ä¸­å è½½ ES6 æ¨¡åï¼ä»¥åå®éå¼åä¸­ç»å¸¸éå°çä¸äºé®é¢ï¼æ¯å¦å¾ªç¯å è½½ï¼ã\n\n\n# æµè§å¨å è½½\n\n\n# ä¼ ç»æ¹æ³\n\nHTML ç½é¡µä¸­ï¼æµè§å¨éè¿<script>æ ç­¾å è½½ JavaScript èæ¬ã\n\n\x3c!-- é¡µé¢ååµçèæ¬ --\x3e\n<script type="application/javascript">\n  // module code\n<\/script>\n\n\x3c!-- å¤é¨èæ¬ --\x3e\n<script type="application/javascript" src="path/to/myModule.js">\n<\/script>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºæµè§å¨èæ¬çé»è®¤è¯­è¨æ¯ JavaScriptï¼å æ­¤type="application/javascript"å¯ä»¥çç¥ã\n\né»è®¤æåµä¸ï¼æµè§å¨æ¯åæ­¥å è½½ JavaScript èæ¬ï¼å³æ¸²æå¼æéå°<script>æ ç­¾å°±ä¼åä¸æ¥ï¼ç­å°æ§è¡å®èæ¬ï¼åç»§ç»­åä¸æ¸²æãå¦ææ¯å¤é¨èæ¬ï¼è¿å¿é¡»å å¥èæ¬ä¸è½½çæ¶é´ã\n\nå¦æèæ¬ä½ç§¯å¾å¤§ï¼ä¸è½½åæ§è¡çæ¶é´å°±ä¼å¾é¿ï¼å æ­¤é ææµè§å¨å µå¡ï¼ç¨æ·ä¼æè§å°æµè§å¨âå¡æ­»âäºï¼æ²¡æä»»ä½ååºãè¿æ¾ç¶æ¯å¾ä¸å¥½çä½éªï¼æä»¥æµè§å¨åè®¸èæ¬å¼æ­¥å è½½ï¼ä¸é¢å°±æ¯ä¸¤ç§å¼æ­¥å è½½çè¯­æ³ã\n\n<script src="path/to/myModule.js" defer><\/script>\n<script src="path/to/myModule.js" async><\/script>\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼<script>æ ç­¾æå¼deferæasyncå±æ§ï¼èæ¬å°±ä¼å¼æ­¥å è½½ãæ¸²æå¼æéå°è¿ä¸è¡å½ä»¤ï¼å°±ä¼å¼å§ä¸è½½å¤é¨èæ¬ï¼ä½ä¸ä¼ç­å®ä¸è½½åæ§è¡ï¼èæ¯ç´æ¥æ§è¡åé¢çå½ä»¤ã\n\ndeferä¸asyncçåºå«æ¯ï¼deferè¦ç­å°æ´ä¸ªé¡µé¢å¨åå­ä¸­æ­£å¸¸æ¸²æç»æï¼DOM ç»æå®å¨çæï¼ä»¥åå¶ä»èæ¬æ§è¡å®æï¼ï¼æä¼æ§è¡ï¼asyncä¸æ¦ä¸è½½å®ï¼æ¸²æå¼æå°±ä¼ä¸­æ­æ¸²æï¼æ§è¡è¿ä¸ªèæ¬ä»¥åï¼åç»§ç»­æ¸²æãä¸å¥è¯ï¼deferæ¯âæ¸²æå®åæ§è¡âï¼asyncæ¯âä¸è½½å®å°±æ§è¡âãå¦å¤ï¼å¦ææå¤ä¸ªdeferèæ¬ï¼ä¼æç§å®ä»¬å¨é¡µé¢åºç°çé¡ºåºå è½½ï¼èå¤ä¸ªasyncèæ¬æ¯ä¸è½ä¿è¯å è½½é¡ºåºçã\n\n\n# å è½½è§å\n\næµè§å¨å è½½ ES6 æ¨¡åï¼ä¹ä½¿ç¨<script>æ ç­¾ï¼ä½æ¯è¦å å¥type="module"å±æ§ã\n\n<script type="module" src="./foo.js"><\/script>\n\n\n1\n\n\nä¸é¢ä»£ç å¨ç½é¡µä¸­æå¥ä¸ä¸ªæ¨¡åfoo.jsï¼ç±äºtypeå±æ§è®¾ä¸ºmoduleï¼æä»¥æµè§å¨ç¥éè¿æ¯ä¸ä¸ª ES6 æ¨¡åã\n\næµè§å¨å¯¹äºå¸¦ætype="module"ç<script>ï¼é½æ¯å¼æ­¥å è½½ï¼ä¸ä¼é æå µå¡æµè§å¨ï¼å³ç­å°æ´ä¸ªé¡µé¢æ¸²æå®ï¼åæ§è¡æ¨¡åèæ¬ï¼ç­åäºæå¼äº<script>æ ç­¾çdeferå±æ§ã\n\n<script type="module" src="./foo.js"><\/script>\n\x3c!-- ç­åäº --\x3e\n<script type="module" src="./foo.js" defer><\/script>\n\n\n1\n2\n3\n\n\nå¦æç½é¡µæå¤ä¸ª<script type="module">ï¼å®ä»¬ä¼æç§å¨é¡µé¢åºç°çé¡ºåºä¾æ¬¡æ§è¡ã\n\n<script>æ ç­¾çasyncå±æ§ä¹å¯ä»¥æå¼ï¼è¿æ¶åªè¦å è½½å®æï¼æ¸²æå¼æå°±ä¼ä¸­æ­æ¸²æç«å³æ§è¡ãæ§è¡å®æåï¼åæ¢å¤æ¸²æã\n\n<script type="module" src="./foo.js" async><\/script>\n\n\n1\n\n\nä¸æ¦ä½¿ç¨äºasyncå±æ§ï¼<script type="module">å°±ä¸ä¼æç§å¨é¡µé¢åºç°çé¡ºåºæ§è¡ï¼èæ¯åªè¦è¯¥æ¨¡åå è½½å®æï¼å°±æ§è¡è¯¥æ¨¡åã\n\nES6 æ¨¡åä¹åè®¸ååµå¨ç½é¡µä¸­ï¼è¯­æ³è¡ä¸ºä¸å è½½å¤é¨èæ¬å®å¨ä¸è´ã\n\n<script type="module">\n  import utils from "./utils.js";\n\n  // other code\n<\/script>\n\n\n1\n2\n3\n4\n5\n\n\nä¸¾ä¾æ¥è¯´ï¼jQuery å°±æ¯ææ¨¡åå è½½ã\n\n<script type="module">\n  import $ from "./jquery/src/jquery.js";\n  $(\'#message\').text(\'Hi from jQuery!\');\n<\/script>\n\n\n1\n2\n3\n4\n\n\nå¯¹äºå¤é¨çæ¨¡åèæ¬ï¼ä¸ä¾æ¯foo.jsï¼ï¼æå ç¹éè¦æ³¨æã\n\n * ä»£ç æ¯å¨æ¨¡åä½ç¨åä¹ä¸­è¿è¡ï¼èä¸æ¯å¨å¨å±ä½ç¨åè¿è¡ãæ¨¡ååé¨çé¡¶å±åéï¼å¤é¨ä¸å¯è§ã\n * æ¨¡åèæ¬èªå¨éç¨ä¸¥æ ¼æ¨¡å¼ï¼ä¸ç®¡ææ²¡æå£°æuse strictã\n * æ¨¡åä¹ä¸­ï¼å¯ä»¥ä½¿ç¨importå½ä»¤å è½½å¶ä»æ¨¡åï¼.jsåç¼ä¸å¯çç¥ï¼éè¦æä¾ç»å¯¹ URL æç¸å¯¹ URLï¼ï¼ä¹å¯ä»¥ä½¿ç¨exportå½ä»¤è¾åºå¯¹å¤æ¥å£ã\n * æ¨¡åä¹ä¸­ï¼é¡¶å±çthiså³é®å­è¿åundefinedï¼èä¸æ¯æåwindowãä¹å°±æ¯è¯´ï¼å¨æ¨¡åé¡¶å±ä½¿ç¨thiså³é®å­ï¼æ¯æ æä¹çã\n * åä¸ä¸ªæ¨¡åå¦æå è½½å¤æ¬¡ï¼å°åªæ§è¡ä¸æ¬¡ã\n\nä¸é¢æ¯ä¸ä¸ªç¤ºä¾æ¨¡åã\n\nimport utils from \'https://example.com/js/utils.js\';\n\nconst x = 1;\n\nconsole.log(x === window.x); //false\nconsole.log(this === undefined); // true\n\n\n1\n2\n3\n4\n5\n6\n\n\nå©ç¨é¡¶å±çthisç­äºundefinedè¿ä¸ªè¯­æ³ç¹ï¼å¯ä»¥ä¾¦æµå½åä»£ç æ¯å¦å¨ ES6 æ¨¡åä¹ä¸­ã\n\nconst isNotModuleScript = this !== undefined;\n\n\n1\n\n\n\n# ES6 æ¨¡åä¸ CommonJS æ¨¡åçå·®å¼\n\nè®¨è®º Node.js å è½½ ES6 æ¨¡åä¹åï¼å¿é¡»äºè§£ ES6 æ¨¡åä¸ CommonJS æ¨¡åå®å¨ä¸åã\n\nå®ä»¬æä¸¤ä¸ªéå¤§å·®å¼ã\n\n * CommonJS æ¨¡åè¾åºçæ¯ä¸ä¸ªå¼çæ·è´ï¼ES6 æ¨¡åè¾åºçæ¯å¼çå¼ç¨ã\n * CommonJS æ¨¡åæ¯è¿è¡æ¶å è½½ï¼ES6 æ¨¡åæ¯ç¼è¯æ¶è¾åºæ¥å£ã\n\nç¬¬äºä¸ªå·®å¼æ¯å ä¸º CommonJS å è½½çæ¯ä¸ä¸ªå¯¹è±¡ï¼å³module.exportså±æ§ï¼ï¼è¯¥å¯¹è±¡åªæå¨èæ¬è¿è¡å®æä¼çæãè ES6 æ¨¡åä¸æ¯å¯¹è±¡ï¼å®çå¯¹å¤æ¥å£åªæ¯ä¸ç§éæå®ä¹ï¼å¨ä»£ç éæè§£æé¶æ®µå°±ä¼çæã\n\nä¸é¢éç¹è§£éç¬¬ä¸ä¸ªå·®å¼ã\n\nCommonJS æ¨¡åè¾åºçæ¯å¼çæ·è´ï¼ä¹å°±æ¯è¯´ï¼ä¸æ¦è¾åºä¸ä¸ªå¼ï¼æ¨¡ååé¨çååå°±å½±åä¸å°è¿ä¸ªå¼ãè¯·çä¸é¢è¿ä¸ªæ¨¡åæä»¶lib.jsçä¾å­ã\n\n// lib.js\nvar counter = 3;\nfunction incCounter() {\n  counter++;\n}\nmodule.exports = {\n  counter: counter,\n  incCounter: incCounter,\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç è¾åºåé¨åécounteråæ¹åè¿ä¸ªåéçåé¨æ¹æ³incCounterãç¶åï¼å¨main.jséé¢å è½½è¿ä¸ªæ¨¡åã\n\n// main.js\nvar mod = require(\'./lib\');\n\nconsole.log(mod.counter);  // 3\nmod.incCounter();\nconsole.log(mod.counter); // 3\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç è¯´æï¼lib.jsæ¨¡åå è½½ä»¥åï¼å®çåé¨ååå°±å½±åä¸å°è¾åºçmod.counteräºãè¿æ¯å ä¸ºmod.counteræ¯ä¸ä¸ªåå§ç±»åçå¼ï¼ä¼è¢«ç¼å­ãé¤éåæä¸ä¸ªå½æ°ï¼æè½å¾å°åé¨åå¨åçå¼ã\n\n// lib.js\nvar counter = 3;\nfunction incCounter() {\n  counter++;\n}\nmodule.exports = {\n  get counter() {\n    return counter\n  },\n  incCounter: incCounter,\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼è¾åºçcounterå±æ§å®éä¸æ¯ä¸ä¸ªåå¼å¨å½æ°ãç°å¨åæ§è¡main.jsï¼å°±å¯ä»¥æ­£ç¡®è¯»ååé¨åécounterçåå¨äºã\n\n$ node main.js\n3\n4\n\n\n1\n2\n3\n\n\nES6 æ¨¡åçè¿è¡æºå¶ä¸ CommonJS ä¸ä¸æ ·ãJS å¼æå¯¹èæ¬éæåæçæ¶åï¼éå°æ¨¡åå è½½å½ä»¤importï¼å°±ä¼çæä¸ä¸ªåªè¯»å¼ç¨ãç­å°èæ¬çæ­£æ§è¡æ¶ï¼åæ ¹æ®è¿ä¸ªåªè¯»å¼ç¨ï¼å°è¢«å è½½çé£ä¸ªæ¨¡åéé¢å»åå¼ãæ¢å¥è¯è¯´ï¼ES6 çimportæç¹å Unix ç³»ç»çâç¬¦å·è¿æ¥âï¼åå§å¼åäºï¼importå è½½çå¼ä¹ä¼è·çåãå æ­¤ï¼ES6 æ¨¡åæ¯å¨æå¼ç¨ï¼å¹¶ä¸ä¸ä¼ç¼å­å¼ï¼æ¨¡åéé¢çåéç»å®å¶æå¨çæ¨¡åã\n\nè¿æ¯ä¸¾ä¸é¢çä¾å­ã\n\n// lib.js\nexport let counter = 3;\nexport function incCounter() {\n  counter++;\n}\n\n// main.js\nimport { counter, incCounter } from \'./lib\';\nconsole.log(counter); // 3\nincCounter();\nconsole.log(counter); // 4\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç è¯´æï¼ES6 æ¨¡åè¾å¥çåécounteræ¯æ´»çï¼å®å¨ååºå¶æå¨æ¨¡ålib.jsåé¨çååã\n\nåä¸¾ä¸ä¸ªåºç°å¨exportä¸èä¸­çä¾å­ã\n\n// m1.js\nexport var foo = \'bar\';\nsetTimeout(() => foo = \'baz\', 500);\n\n// m2.js\nimport {foo} from \'./m1.js\';\nconsole.log(foo);\nsetTimeout(() => console.log(foo), 500);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼m1.jsçåéfooï¼å¨åå è½½æ¶ç­äºbarï¼è¿äº 500 æ¯«ç§ï¼ååä¸ºç­äºbazã\n\nè®©æä»¬ççï¼m2.jsè½å¦æ­£ç¡®è¯»åè¿ä¸ªååã\n\n$ babel-node m2.js\n\nbar\nbaz\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç è¡¨æï¼ES6 æ¨¡åä¸ä¼ç¼å­è¿è¡ç»æï¼èæ¯å¨æå°å»è¢«å è½½çæ¨¡ååå¼ï¼å¹¶ä¸åéæ»æ¯ç»å®å¶æå¨çæ¨¡åã\n\nç±äº ES6 è¾å¥çæ¨¡ååéï¼åªæ¯ä¸ä¸ªâç¬¦å·è¿æ¥âï¼æä»¥è¿ä¸ªåéæ¯åªè¯»çï¼å¯¹å®è¿è¡éæ°èµå¼ä¼æ¥éã\n\n// lib.js\nexport let obj = {};\n\n// main.js\nimport { obj } from \'./lib\';\n\nobj.prop = 123; // OK\nobj = {}; // TypeError\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼main.jsä»lib.jsè¾å¥åéobjï¼å¯ä»¥å¯¹objæ·»å å±æ§ï¼ä½æ¯éæ°èµå¼å°±ä¼æ¥éãå ä¸ºåéobjæåçå°åæ¯åªè¯»çï¼ä¸è½éæ°èµå¼ï¼è¿å°±å¥½æ¯main.jsåé äºä¸ä¸ªåä¸ºobjçconståéã\n\næåï¼exportéè¿æ¥å£ï¼è¾åºçæ¯åä¸ä¸ªå¼ãä¸åçèæ¬å è½½è¿ä¸ªæ¥å£ï¼å¾å°çé½æ¯åæ ·çå®ä¾ã\n\n// mod.js\nfunction C() {\n  this.sum = 0;\n  this.add = function () {\n    this.sum += 1;\n  };\n  this.show = function () {\n    console.log(this.sum);\n  };\n}\n\nexport let c = new C();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢çèæ¬mod.jsï¼è¾åºçæ¯ä¸ä¸ªCçå®ä¾ãä¸åçèæ¬å è½½è¿ä¸ªæ¨¡åï¼å¾å°çé½æ¯åä¸ä¸ªå®ä¾ã\n\n// x.js\nimport {c} from \'./mod\';\nc.add();\n\n// y.js\nimport {c} from \'./mod\';\nc.show();\n\n// main.js\nimport \'./x\';\nimport \'./y\';\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nç°å¨æ§è¡main.jsï¼è¾åºçæ¯1ã\n\n$ babel-node main.js\n1\n\n\n1\n2\n\n\nè¿å°±è¯æäºx.jsåy.jså è½½çé½æ¯Cçåä¸ä¸ªå®ä¾ã\n\n\n# Node.js å è½½\n\n\n# æ¦è¿°\n\nNode.js å¯¹ ES6 æ¨¡åçå¤çæ¯è¾éº»ç¦ï¼å ä¸ºå®æèªå·±ç CommonJS æ¨¡åæ ¼å¼ï¼ä¸ ES6 æ¨¡åæ ¼å¼æ¯ä¸å¼å®¹çãç®åçè§£å³æ¹æ¡æ¯ï¼å°ä¸¤èåå¼ï¼ES6 æ¨¡åå CommonJS éç¨åèªçå è½½æ¹æ¡ãä» v13.2 çæ¬å¼å§ï¼Node.js å·²ç»é»è®¤æå¼äº ES6 æ¨¡åæ¯æã\n\nNode.js è¦æ± ES6 æ¨¡åéç¨.mjsåç¼æä»¶åãä¹å°±æ¯è¯´ï¼åªè¦èæ¬æä»¶éé¢ä½¿ç¨importæèexportå½ä»¤ï¼é£ä¹å°±å¿é¡»éç¨.mjsåç¼åãNode.js éå°.mjsæä»¶ï¼å°±è®¤ä¸ºå®æ¯ ES6 æ¨¡åï¼é»è®¤å¯ç¨ä¸¥æ ¼æ¨¡å¼ï¼ä¸å¿å¨æ¯ä¸ªæ¨¡åæä»¶é¡¶é¨æå®"use strict"ã\n\nå¦æä¸å¸æå°åç¼åæ¹æ.mjsï¼å¯ä»¥å¨é¡¹ç®çpackage.jsonæä»¶ä¸­ï¼æå®typeå­æ®µä¸ºmoduleã\n\n{\n   "type": "module"\n}\n\n\n1\n2\n3\n\n\nä¸æ¦è®¾ç½®äºä»¥åï¼è¯¥ç®å½éé¢ç JS èæ¬ï¼å°±è¢«è§£éç¨ ES6 æ¨¡åã\n\n# è§£éæ ES6 æ¨¡å\n$ node my-app.js\n\n\n1\n2\n\n\nå¦æè¿æ¶è¿è¦ä½¿ç¨ CommonJS æ¨¡åï¼é£ä¹éè¦å° CommonJS èæ¬çåç¼åé½æ¹æ.cjsãå¦ææ²¡ætypeå­æ®µï¼æètypeå­æ®µä¸ºcommonjsï¼å.jsèæ¬ä¼è¢«è§£éæ CommonJS æ¨¡åã\n\næ»ç»ä¸ºä¸å¥è¯ï¼.mjsæä»¶æ»æ¯ä»¥ ES6 æ¨¡åå è½½ï¼.cjsæä»¶æ»æ¯ä»¥ CommonJS æ¨¡åå è½½ï¼.jsæä»¶çå è½½åå³äºpackage.jsonéé¢typeå­æ®µçè®¾ç½®ã\n\næ³¨æï¼ES6 æ¨¡åä¸ CommonJS æ¨¡åå°½éä¸è¦æ··ç¨ãrequireå½ä»¤ä¸è½å è½½.mjsæä»¶ï¼ä¼æ¥éï¼åªæimportå½ä»¤æå¯ä»¥å è½½.mjsæä»¶ãåè¿æ¥ï¼.mjsæä»¶éé¢ä¹ä¸è½ä½¿ç¨requireå½ä»¤ï¼å¿é¡»ä½¿ç¨importã\n\n\n# main å­æ®µ\n\npackage.jsonæä»¶æä¸¤ä¸ªå­æ®µå¯ä»¥æå®æ¨¡åçå¥å£æä»¶ï¼mainåexportsãæ¯è¾ç®åçæ¨¡åï¼å¯ä»¥åªä½¿ç¨mainå­æ®µï¼æå®æ¨¡åå è½½çå¥å£æä»¶ã\n\n// ./node_modules/es-module-package/package.json\n{\n  "type": "module",\n  "main": "./src/index.js"\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç æå®é¡¹ç®çå¥å£èæ¬ä¸º./src/index.jsï¼å®çæ ¼å¼ä¸º ES6 æ¨¡åãå¦ææ²¡ætypeå­æ®µï¼index.jså°±ä¼è¢«è§£éä¸º CommonJS æ¨¡åã\n\nç¶åï¼importå½ä»¤å°±å¯ä»¥å è½½è¿ä¸ªæ¨¡åã\n\n// ./my-app.mjs\n\nimport { something } from \'es-module-package\';\n// å®éå è½½çæ¯ ./node_modules/es-module-package/src/index.js\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼è¿è¡è¯¥èæ¬ä»¥åï¼Node.js å°±ä¼å°./node_modulesç®å½ä¸é¢ï¼å¯»æ¾es-module-packageæ¨¡åï¼ç¶åæ ¹æ®è¯¥æ¨¡åpackage.jsonçmainå­æ®µå»æ§è¡å¥å£æä»¶ã\n\nè¿æ¶ï¼å¦æç¨ CommonJS æ¨¡åçrequire()å½ä»¤å»å è½½es-module-packageæ¨¡åä¼æ¥éï¼å ä¸º CommonJS æ¨¡åä¸è½å¤çexportå½ä»¤ã\n\n\n# exports å­æ®µ\n\nexportså­æ®µçä¼åçº§é«äºmainå­æ®µãå®æå¤ç§ç¨æ³ã\n\nï¼1ï¼å­ç®å½å«å\n\npackage.jsonæä»¶çexportså­æ®µå¯ä»¥æå®èæ¬æå­ç®å½çå«åã\n\n// ./node_modules/es-module-package/package.json\n{\n  "exports": {\n    "./submodule": "./src/submodule.js"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢çä»£ç æå®src/submodule.jså«åä¸ºsubmoduleï¼ç¶åå°±å¯ä»¥ä»å«åå è½½è¿ä¸ªæä»¶ã\n\nimport submodule from \'es-module-package/submodule\';\n// å è½½ ./node_modules/es-module-package/src/submodule.js\n\n\n1\n2\n\n\nä¸é¢æ¯å­ç®å½å«åçä¾å­ã\n\n// ./node_modules/es-module-package/package.json\n{\n  "exports": {\n    "./features/": "./src/features/"\n  }\n}\n\nimport feature from \'es-module-package/features/x.js\';\n// å è½½ ./node_modules/es-module-package/src/features/x.js\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦ææ²¡ææå®å«åï¼å°±ä¸è½ç¨âæ¨¡å+èæ¬åâè¿ç§å½¢å¼å è½½èæ¬ã\n\n// æ¥é\nimport submodule from \'es-module-package/private-module.js\';\n\n// ä¸æ¥é\nimport submodule from \'./node_modules/es-module-package/private-module.js\';\n\n\n1\n2\n3\n4\n5\n\n\nï¼2ï¼main çå«å\n\nexportså­æ®µçå«åå¦ææ¯.ï¼å°±ä»£è¡¨æ¨¡åçä¸»å¥å£ï¼ä¼åçº§é«äºmainå­æ®µï¼å¹¶ä¸å¯ä»¥ç´æ¥ç®åæexportså­æ®µçå¼ã\n\n{\n  "exports": {\n    ".": "./main.js"\n  }\n}\n\n// ç­åäº\n{\n  "exports": "./main.js"\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nç±äºexportså­æ®µåªææ¯æ ES6 ç Node.js æè®¤è¯ï¼æä»¥å¯ä»¥ç¨æ¥å¼å®¹æ§çæ¬ç Node.jsã\n\n{\n  "main": "./main-legacy.cjs",\n  "exports": {\n    ".": "./main-modern.cjs"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼èçæ¬ç Node.js ï¼ä¸æ¯æ ES6 æ¨¡åï¼çå¥å£æä»¶æ¯main-legacy.cjsï¼æ°çæ¬ç Node.js çå¥å£æä»¶æ¯main-modern.cjsã\n\nï¼3ï¼æ¡ä»¶å è½½\n\nå©ç¨.è¿ä¸ªå«åï¼å¯ä»¥ä¸º ES6 æ¨¡åå CommonJS æå®ä¸åçå¥å£ãç®åï¼è¿ä¸ªåè½éè¦å¨ Node.js è¿è¡çæ¶åï¼æå¼--experimental-conditional-exportsæ å¿ã\n\n{\n  "type": "module",\n  "exports": {\n    ".": {\n      "require": "./main.cjs",\n      "default": "./main.js"\n    }\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å«å.çrequireæ¡ä»¶æå®require()å½ä»¤çå¥å£æä»¶ï¼å³ CommonJS çå¥å£ï¼ï¼defaultæ¡ä»¶æå®å¶ä»æåµçå¥å£ï¼å³ ES6 çå¥å£ï¼ã\n\nä¸é¢çåæ³å¯ä»¥ç®åå¦ä¸ã\n\n{\n  "exports": {\n    "require": "./main.cjs",\n    "default": "./main.js"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\næ³¨æï¼å¦æåæ¶è¿æå¶ä»å«åï¼å°±ä¸è½éç¨ç®åï¼å¦åææ¥éã\n\n{\n  // æ¥é\n  "exports": {\n    "./feature": "./lib/feature.js",\n    "require": "./main.cjs",\n    "default": "./main.js"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# ES6 æ¨¡åå è½½ CommonJS æ¨¡å\n\nç®åï¼ä¸ä¸ªæ¨¡ååæ¶æ¯æ ES6 å CommonJS ä¸¤ç§æ ¼å¼çå¸¸è§æ¹æ³æ¯ï¼package.jsonæä»¶çmainå­æ®µæå® CommonJS å¥å£ï¼ç» Node.js ä½¿ç¨ï¼moduleå­æ®µæå® ES6 æ¨¡åå¥å£ï¼ç»æåå·¥å·ä½¿ç¨ï¼å ä¸º Node.js ä¸è®¤è¯moduleå­æ®µã\n\næäºä¸ä¸èçæ¡ä»¶å è½½ä»¥åï¼Node.js æ¬èº«å°±å¯ä»¥åæ¶å¤çä¸¤ç§æ¨¡åã\n\n// ./node_modules/pkg/package.json\n{\n  "type": "module",\n  "main": "./index.cjs",\n  "exports": {\n    "require": "./index.cjs",\n    "default": "./wrapper.mjs"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç æå®äº CommonJS å¥å£æä»¶index.cjsï¼ä¸é¢æ¯è¿ä¸ªæä»¶çä»£ç ã\n\n// ./node_modules/pkg/index.cjs\nexports.name = \'value\';\n\n\n1\n2\n\n\nç¶åï¼ES6 æ¨¡åå¯ä»¥å è½½è¿ä¸ªæä»¶ã\n\n// ./node_modules/pkg/wrapper.mjs\nimport cjsModule from \'./index.cjs\';\nexport const name = cjsModule.name;\n\n\n1\n2\n3\n\n\næ³¨æï¼importå½ä»¤å è½½ CommonJS æ¨¡åï¼åªè½æ´ä½å è½½ï¼ä¸è½åªå è½½åä¸çè¾åºé¡¹ã\n\n// æ­£ç¡®\nimport packageMain from \'commonjs-package\';\n\n// æ¥é\nimport { method } from \'commonjs-package\';\n\n\n1\n2\n3\n4\n5\n\n\nè¿æä¸ç§åéçå è½½æ¹æ³ï¼å°±æ¯ä½¿ç¨ Node.js åç½®çmodule.createRequire()æ¹æ³ã\n\n// cjs.cjs\nmodule.exports = \'cjs\';\n\n// esm.mjs\nimport { createRequire } from \'module\';\n\nconst require = createRequire(import.meta.url);\n\nconst cjs = require(\'./cjs.cjs\');\ncjs === \'cjs\'; // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼ES6 æ¨¡åéè¿module.createRequire()æ¹æ³å¯ä»¥å è½½ CommonJS æ¨¡å\n\n\n# CommonJS æ¨¡åå è½½ ES6 æ¨¡å\n\nCommonJS çrequireå½ä»¤ä¸è½å è½½ ES6 æ¨¡åï¼ä¼æ¥éï¼åªè½ä½¿ç¨import()è¿ä¸ªæ¹æ³å è½½ã\n\n(async () => {\n  await import(\'./my-app.mjs\');\n})();\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç å¯ä»¥å¨ CommonJS æ¨¡åä¸­è¿è¡ã\n\n\n# Node.js çåç½®æ¨¡å\n\nNode.js çåç½®æ¨¡åå¯ä»¥æ´ä½å è½½ï¼ä¹å¯ä»¥å è½½æå®çè¾åºé¡¹ã\n\n// æ´ä½å è½½\nimport EventEmitter from \'events\';\nconst e = new EventEmitter();\n\n// å è½½æå®çè¾åºé¡¹\nimport { readFile } from \'fs\';\nreadFile(\'./foo.txt\', (err, source) => {\n  if (err) {\n    console.error(err);\n  } else {\n    console.log(source);\n  }\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# å è½½è·¯å¾\n\nES6 æ¨¡åçå è½½è·¯å¾å¿é¡»ç»åºèæ¬çå®æ´è·¯å¾ï¼ä¸è½çç¥èæ¬çåç¼åãimportå½ä»¤åpackage.jsonæä»¶çmainå­æ®µå¦æçç¥èæ¬çåç¼åï¼ä¼æ¥éã\n\n// ES6 æ¨¡åä¸­å°æ¥é\nimport { something } from \'./index\';\n\n\n1\n2\n\n\nä¸ºäºä¸æµè§å¨çimportå è½½è§åç¸åï¼Node.js ç.mjsæä»¶æ¯æ URL è·¯å¾ã\n\nimport \'./foo.mjs?query=1\'; // å è½½ ./foo ä¼ å¥åæ° ?query=1\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼èæ¬è·¯å¾å¸¦æåæ°?query=1ï¼Node ä¼æ URL è§åè§£è¯»ãåä¸ä¸ªèæ¬åªè¦åæ°ä¸åï¼å°±ä¼è¢«å è½½å¤æ¬¡ï¼å¹¶ä¸ä¿å­æä¸åçç¼å­ãç±äºè¿ä¸ªåå ï¼åªè¦æä»¶åä¸­å«æ:ã%ã#ã?ç­ç¹æ®å­ç¬¦ï¼æå¥½å¯¹è¿äºå­ç¬¦è¿è¡è½¬ä¹ã\n\nç®åï¼Node.js çimportå½ä»¤åªæ¯æå è½½æ¬å°æ¨¡åï¼file:åè®®ï¼ådata:åè®®ï¼ä¸æ¯æå è½½è¿ç¨æ¨¡åãå¦å¤ï¼èæ¬è·¯å¾åªæ¯æç¸å¯¹è·¯å¾ï¼ä¸æ¯æç»å¯¹è·¯å¾ï¼å³ä»¥/æ//å¼å¤´çè·¯å¾ï¼ã\n\næåï¼Node çimportå½ä»¤æ¯å¼æ­¥å è½½ï¼è¿ä¸ç¹ä¸æµè§å¨çå¤çæ¹æ³ç¸åã\n\n\n# åé¨åé\n\nES6 æ¨¡ååºè¯¥æ¯éç¨çï¼åä¸ä¸ªæ¨¡åä¸ç¨ä¿®æ¹ï¼å°±å¯ä»¥ç¨å¨æµè§å¨ç¯å¢åæå¡å¨ç¯å¢ãä¸ºäºè¾¾å°è¿ä¸ªç®æ ï¼Node è§å® ES6 æ¨¡åä¹ä¸­ä¸è½ä½¿ç¨ CommonJS æ¨¡åçç¹æçä¸äºåé¨åéã\n\né¦åï¼å°±æ¯thiså³é®å­ãES6 æ¨¡åä¹ä¸­ï¼é¡¶å±çthisæåundefinedï¼CommonJS æ¨¡åçé¡¶å±thisæåå½åæ¨¡åï¼è¿æ¯ä¸¤èçä¸ä¸ªéå¤§å·®å¼ã\n\nå¶æ¬¡ï¼ä»¥ä¸è¿äºé¡¶å±åéå¨ ES6 æ¨¡åä¹ä¸­é½æ¯ä¸å­å¨çã\n\n * arguments\n * require\n * module\n * exports\n * __filename\n * __dirname\n\n\n# å¾ªç¯å è½½\n\nâå¾ªç¯å è½½âï¼circular dependencyï¼æçæ¯ï¼aèæ¬çæ§è¡ä¾èµbèæ¬ï¼èbèæ¬çæ§è¡åä¾èµaèæ¬ã\n\n// a.js\nvar b = require(\'b\');\n\n// b.js\nvar a = require(\'a\');\n\n\n1\n2\n3\n4\n5\n\n\néå¸¸ï¼âå¾ªç¯å è½½âè¡¨ç¤ºå­å¨å¼ºè¦åï¼å¦æå¤çä¸å¥½ï¼è¿å¯è½å¯¼è´éå½å è½½ï¼ä½¿å¾ç¨åºæ æ³æ§è¡ï¼å æ­¤åºè¯¥é¿ååºç°ã\n\nä½æ¯å®éä¸ï¼è¿æ¯å¾é¾é¿åçï¼å°¤å¶æ¯ä¾èµå³ç³»å¤æçå¤§é¡¹ç®ï¼å¾å®¹æåºç°aä¾èµbï¼bä¾èµcï¼cåä¾èµaè¿æ ·çæåµãè¿æå³çï¼æ¨¡åå è½½æºå¶å¿é¡»èèâå¾ªç¯å è½½âçæåµã\n\nå¯¹äº JavaScript è¯­è¨æ¥è¯´ï¼ç®åæå¸¸è§çä¸¤ç§æ¨¡åæ ¼å¼ CommonJS å ES6ï¼å¤çâå¾ªç¯å è½½âçæ¹æ³æ¯ä¸ä¸æ ·çï¼è¿åçç»æä¹ä¸ä¸æ ·ã\n\n\n# CommonJS æ¨¡åçå è½½åç\n\nä»ç» ES6 å¦ä½å¤çâå¾ªç¯å è½½âä¹åï¼åä»ç»ç®åææµè¡ç CommonJS æ¨¡åæ ¼å¼çå è½½åçã\n\nCommonJS çä¸ä¸ªæ¨¡åï¼å°±æ¯ä¸ä¸ªèæ¬æä»¶ãrequireå½ä»¤ç¬¬ä¸æ¬¡å è½½è¯¥èæ¬ï¼å°±ä¼æ§è¡æ´ä¸ªèæ¬ï¼ç¶åå¨åå­çæä¸ä¸ªå¯¹è±¡ã\n\n{\n  id: \'...\',\n  exports: { ... },\n  loaded: true,\n  ...\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç å°±æ¯ Node åé¨å è½½æ¨¡ååçæçä¸ä¸ªå¯¹è±¡ãè¯¥å¯¹è±¡çidå±æ§æ¯æ¨¡ååï¼exportså±æ§æ¯æ¨¡åè¾åºçåä¸ªæ¥å£ï¼loadedå±æ§æ¯ä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºè¯¥æ¨¡åçèæ¬æ¯å¦æ§è¡å®æ¯ãå¶ä»è¿æå¾å¤å±æ§ï¼è¿éé½çç¥äºã\n\nä»¥åéè¦ç¨å°è¿ä¸ªæ¨¡åçæ¶åï¼å°±ä¼å°exportså±æ§ä¸é¢åå¼ãå³ä½¿åæ¬¡æ§è¡requireå½ä»¤ï¼ä¹ä¸ä¼åæ¬¡æ§è¡è¯¥æ¨¡åï¼èæ¯å°ç¼å­ä¹ä¸­åå¼ãä¹å°±æ¯è¯´ï¼CommonJS æ¨¡åæ è®ºå è½½å¤å°æ¬¡ï¼é½åªä¼å¨ç¬¬ä¸æ¬¡å è½½æ¶è¿è¡ä¸æ¬¡ï¼ä»¥ååå è½½ï¼å°±è¿åç¬¬ä¸æ¬¡è¿è¡çç»æï¼é¤éæå¨æ¸é¤ç³»ç»ç¼å­ã\n\n\n# CommonJS æ¨¡åçå¾ªç¯å è½½\n\nCommonJS æ¨¡åçéè¦ç¹æ§æ¯å è½½æ¶æ§è¡ï¼å³èæ¬ä»£ç å¨requireçæ¶åï¼å°±ä¼å¨é¨æ§è¡ãä¸æ¦åºç°æä¸ªæ¨¡åè¢«"å¾ªç¯å è½½"ï¼å°±åªè¾åºå·²ç»æ§è¡çé¨åï¼è¿æªæ§è¡çé¨åä¸ä¼è¾åºã\n\nè®©æä»¬æ¥çï¼Node å®æ¹ææ¡£éé¢çä¾å­ãèæ¬æä»¶a.jsä»£ç å¦ä¸ã\n\nexports.done = false;\nvar b = require(\'./b.js\');\nconsole.log(\'å¨ a.js ä¹ä¸­ï¼b.done = %j\', b.done);\nexports.done = true;\nconsole.log(\'a.js æ§è¡å®æ¯\');\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¹ä¸­ï¼a.jsèæ¬åè¾åºä¸ä¸ªdoneåéï¼ç¶åå è½½å¦ä¸ä¸ªèæ¬æä»¶b.jsãæ³¨æï¼æ­¤æ¶a.jsä»£ç å°±åå¨è¿éï¼ç­å¾b.jsæ§è¡å®æ¯ï¼åå¾ä¸æ§è¡ã\n\nåçb.jsçä»£ç ã\n\nexports.done = false;\nvar a = require(\'./a.js\');\nconsole.log(\'å¨ b.js ä¹ä¸­ï¼a.done = %j\', a.done);\nexports.done = true;\nconsole.log(\'b.js æ§è¡å®æ¯\');\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¹ä¸­ï¼b.jsæ§è¡å°ç¬¬äºè¡ï¼å°±ä¼å»å è½½a.jsï¼è¿æ¶ï¼å°±åçäºâå¾ªç¯å è½½âãç³»ç»ä¼å»a.jsæ¨¡åå¯¹åºå¯¹è±¡çexportså±æ§åå¼ï¼å¯æ¯å ä¸ºa.jsè¿æ²¡ææ§è¡å®ï¼ä»exportså±æ§åªè½ååå·²ç»æ§è¡çé¨åï¼èä¸æ¯æåçå¼ã\n\na.jså·²ç»æ§è¡çé¨åï¼åªæä¸è¡ã\n\nexports.done = false;\n\n\n1\n\n\nå æ­¤ï¼å¯¹äºb.jsæ¥è¯´ï¼å®ä»a.jsåªè¾å¥ä¸ä¸ªåédoneï¼å¼ä¸ºfalseã\n\nç¶åï¼b.jsæ¥çå¾ä¸æ§è¡ï¼ç­å°å¨é¨æ§è¡å®æ¯ï¼åææ§è¡æäº¤è¿ç»a.jsãäºæ¯ï¼a.jsæ¥çå¾ä¸æ§è¡ï¼ç´å°æ§è¡å®æ¯ãæä»¬åä¸ä¸ªèæ¬main.jsï¼éªè¯è¿ä¸ªè¿ç¨ã\n\nvar a = require(\'./a.js\');\nvar b = require(\'./b.js\');\nconsole.log(\'å¨ main.js ä¹ä¸­, a.done=%j, b.done=%j\', a.done, b.done);\n\n\n1\n2\n3\n\n\næ§è¡main.jsï¼è¿è¡ç»æå¦ä¸ã\n\n$ node main.js\n\nå¨ b.js ä¹ä¸­ï¼a.done = false\nb.js æ§è¡å®æ¯\nå¨ a.js ä¹ä¸­ï¼b.done = true\na.js æ§è¡å®æ¯\nå¨ main.js ä¹ä¸­, a.done=true, b.done=true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢çä»£ç è¯æäºä¸¤ä»¶äºãä¸æ¯ï¼å¨b.jsä¹ä¸­ï¼a.jsæ²¡ææ§è¡å®æ¯ï¼åªæ§è¡äºç¬¬ä¸è¡ãäºæ¯ï¼main.jsæ§è¡å°ç¬¬äºè¡æ¶ï¼ä¸ä¼åæ¬¡æ§è¡b.jsï¼èæ¯è¾åºç¼å­çb.jsçæ§è¡ç»æï¼å³å®çç¬¬åè¡ã\n\nexports.done = true;\n\n\n1\n\n\næ»ä¹ï¼CommonJS è¾å¥çæ¯è¢«è¾åºå¼çæ·è´ï¼ä¸æ¯å¼ç¨ã\n\nå¦å¤ï¼ç±äº CommonJS æ¨¡åéå°å¾ªç¯å è½½æ¶ï¼è¿åçæ¯å½åå·²ç»æ§è¡çé¨åçå¼ï¼èä¸æ¯ä»£ç å¨é¨æ§è¡åçå¼ï¼ä¸¤èå¯è½ä¼æå·®å¼ãæä»¥ï¼è¾å¥åéçæ¶åï¼å¿é¡»éå¸¸å°å¿ã\n\nvar a = require(\'a\'); // å®å¨çåæ³\nvar foo = require(\'a\').foo; // å±é©çåæ³\n\nexports.good = function (arg) {\n  return a.foo(\'good\', arg); // ä½¿ç¨çæ¯ a.foo çææ°å¼\n};\n\nexports.bad = function (arg) {\n  return foo(\'bad\', arg); // ä½¿ç¨çæ¯ä¸ä¸ªé¨åå è½½æ¶çå¼\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æåçå¾ªç¯å è½½ï¼require(\'a\').fooçå¼å¾å¯è½åé¢ä¼è¢«æ¹åï¼æ¹ç¨require(\'a\')ä¼æ´ä¿é©ä¸ç¹ã\n\n\n# ES6 æ¨¡åçå¾ªç¯å è½½\n\nES6 å¤çâå¾ªç¯å è½½âä¸ CommonJS ææ¬è´¨çä¸åãES6 æ¨¡åæ¯å¨æå¼ç¨ï¼å¦æä½¿ç¨importä»ä¸ä¸ªæ¨¡åå è½½åéï¼å³import foo from \'foo\'ï¼ï¼é£äºåéä¸ä¼è¢«ç¼å­ï¼èæ¯æä¸ºä¸ä¸ªæåè¢«å è½½æ¨¡åçå¼ç¨ï¼éè¦å¼åèèªå·±ä¿è¯ï¼çæ­£åå¼çæ¶åè½å¤åå°å¼ã\n\nè¯·çä¸é¢è¿ä¸ªä¾å­ã\n\n// a.mjs\nimport {bar} from \'./b\';\nconsole.log(\'a.mjs\');\nconsole.log(bar);\nexport let foo = \'foo\';\n\n// b.mjs\nimport {foo} from \'./a\';\nconsole.log(\'b.mjs\');\nconsole.log(foo);\nexport let bar = \'bar\';\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼a.mjså è½½b.mjsï¼b.mjsåå è½½a.mjsï¼ææå¾ªç¯å è½½ãæ§è¡a.mjsï¼ç»æå¦ä¸ã\n\n$ node --experimental-modules a.mjs\nb.mjs\nReferenceError: foo is not defined\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼æ§è¡a.mjsä»¥åä¼æ¥éï¼fooåéæªå®ä¹ï¼è¿æ¯ä¸ºä»ä¹ï¼\n\nè®©æä»¬ä¸è¡è¡æ¥çï¼ES6 å¾ªç¯å è½½æ¯æä¹å¤ççãé¦åï¼æ§è¡a.mjsä»¥åï¼å¼æåç°å®å è½½äºb.mjsï¼å æ­¤ä¼ä¼åæ§è¡b.mjsï¼ç¶ååæ§è¡a.mjsãæ¥çï¼æ§è¡b.mjsçæ¶åï¼å·²ç¥å®ä»a.mjsè¾å¥äºfooæ¥å£ï¼è¿æ¶ä¸ä¼å»æ§è¡a.mjsï¼èæ¯è®¤ä¸ºè¿ä¸ªæ¥å£å·²ç»å­å¨äºï¼ç»§ç»­å¾ä¸æ§è¡ãæ§è¡å°ç¬¬ä¸è¡console.log(foo)çæ¶åï¼æåç°è¿ä¸ªæ¥å£æ ¹æ¬æ²¡å®ä¹ï¼å æ­¤æ¥éã\n\nè§£å³è¿ä¸ªé®é¢çæ¹æ³ï¼å°±æ¯è®©b.mjsè¿è¡çæ¶åï¼fooå·²ç»æå®ä¹äºãè¿å¯ä»¥éè¿å°fooåæå½æ°æ¥è§£å³ã\n\n// a.mjs\nimport {bar} from \'./b\';\nconsole.log(\'a.mjs\');\nconsole.log(bar());\nfunction foo() { return \'foo\' }\nexport {foo};\n\n// b.mjs\nimport {foo} from \'./a\';\nconsole.log(\'b.mjs\');\nconsole.log(foo());\nfunction bar() { return \'bar\' }\nexport {bar};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nè¿æ¶åæ§è¡a.mjså°±å¯ä»¥å¾å°é¢æç»æã\n\n$ node --experimental-modules a.mjs\nb.mjs\nfoo\na.mjs\nbar\n\n\n1\n2\n3\n4\n5\n\n\nè¿æ¯å ä¸ºå½æ°å·ææåä½ç¨ï¼å¨æ§è¡import {bar} from \'./b\'æ¶ï¼å½æ°fooå°±å·²ç»æå®ä¹äºï¼æä»¥b.mjså è½½çæ¶åä¸ä¼æ¥éãè¿ä¹æå³çï¼å¦ææå½æ°fooæ¹åæå½æ°è¡¨è¾¾å¼ï¼ä¹ä¼æ¥éã\n\n// a.mjs\nimport {bar} from \'./b\';\nconsole.log(\'a.mjs\');\nconsole.log(bar());\nconst foo = () => \'foo\';\nexport {foo};\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çç¬¬åè¡ï¼æ¹æäºå½æ°è¡¨è¾¾å¼ï¼å°±ä¸å·ææåä½ç¨ï¼æ§è¡å°±ä¼æ¥éã\n\næä»¬åæ¥ç ES6 æ¨¡åå è½½å¨SystemJSç»åºçä¸ä¸ªä¾å­ã\n\n// even.js\nimport { odd } from \'./odd\'\nexport var counter = 0;\nexport function even(n) {\n  counter++;\n  return n === 0 || odd(n - 1);\n}\n\n// odd.js\nimport { even } from \'./even\';\nexport function odd(n) {\n  return n !== 0 && even(n - 1);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼even.jséé¢çå½æ°evenæä¸ä¸ªåæ°nï¼åªè¦ä¸ç­äº 0ï¼å°±ä¼åå» 1ï¼ä¼ å¥å è½½çodd()ãodd.jsä¹ä¼åç±»ä¼¼æä½ã\n\nè¿è¡ä¸é¢è¿æ®µä»£ç ï¼ç»æå¦ä¸ã\n\n$ babel-node\n> import * as m from \'./even.js\';\n> m.even(10);\ntrue\n> m.counter\n6\n> m.even(20)\ntrue\n> m.counter\n17\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°nä» 10 åä¸º 0 çè¿ç¨ä¸­ï¼even()ä¸å±ä¼æ§è¡ 6 æ¬¡ï¼æä»¥åécounterç­äº 6ãç¬¬äºæ¬¡è°ç¨even()æ¶ï¼åæ°nä» 20 åä¸º 0ï¼even()ä¸å±ä¼æ§è¡ 11 æ¬¡ï¼å ä¸åé¢ç 6 æ¬¡ï¼æä»¥åécounterç­äº 17ã\n\nè¿ä¸ªä¾å­è¦æ¯æ¹åæ CommonJSï¼å°±æ ¹æ¬æ æ³æ§è¡ï¼ä¼æ¥éã\n\n// even.js\nvar odd = require(\'./odd\');\nvar counter = 0;\nexports.counter = counter;\nexports.even = function (n) {\n  counter++;\n  return n == 0 || odd(n - 1);\n}\n\n// odd.js\nvar even = require(\'./even\').even;\nmodule.exports = function (n) {\n  return n != 0 && even(n - 1);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼even.jså è½½odd.jsï¼èodd.jsåå»å è½½even.jsï¼å½¢æâå¾ªç¯å è½½âãè¿æ¶ï¼æ§è¡å¼æå°±ä¼è¾åºeven.jså·²ç»æ§è¡çé¨åï¼ä¸å­å¨ä»»ä½ç»æï¼ï¼æä»¥å¨odd.jsä¹ä¸­ï¼åéevenç­äºundefinedï¼ç­å°åé¢è°ç¨even(n - 1)å°±ä¼æ¥éã\n\n$ node\n> var m = require(\'./even\');\n> m.even(10)\nTypeError: even is not a function\n\n\n1\n2\n3\n4\n',normalizedContent:'# module çå è½½å®ç°\n\nä¸ä¸ç« ä»ç»äºæ¨¡åçè¯­æ³ï¼æ¬ç« ä»ç»å¦ä½å¨æµè§å¨å node.js ä¹ä¸­å è½½ es6 æ¨¡åï¼ä»¥åå®éå¼åä¸­ç»å¸¸éå°çä¸äºé®é¢ï¼æ¯å¦å¾ªç¯å è½½ï¼ã\n\n\n# æµè§å¨å è½½\n\n\n# ä¼ ç»æ¹æ³\n\nhtml ç½é¡µä¸­ï¼æµè§å¨éè¿<script>æ ç­¾å è½½ javascript èæ¬ã\n\n\x3c!-- é¡µé¢ååµçèæ¬ --\x3e\n<script type="application/javascript">\n  // module code\n<\/script>\n\n\x3c!-- å¤é¨èæ¬ --\x3e\n<script type="application/javascript" src="path/to/mymodule.js">\n<\/script>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºæµè§å¨èæ¬çé»è®¤è¯­è¨æ¯ javascriptï¼å æ­¤type="application/javascript"å¯ä»¥çç¥ã\n\né»è®¤æåµä¸ï¼æµè§å¨æ¯åæ­¥å è½½ javascript èæ¬ï¼å³æ¸²æå¼æéå°<script>æ ç­¾å°±ä¼åä¸æ¥ï¼ç­å°æ§è¡å®èæ¬ï¼åç»§ç»­åä¸æ¸²æãå¦ææ¯å¤é¨èæ¬ï¼è¿å¿é¡»å å¥èæ¬ä¸è½½çæ¶é´ã\n\nå¦æèæ¬ä½ç§¯å¾å¤§ï¼ä¸è½½åæ§è¡çæ¶é´å°±ä¼å¾é¿ï¼å æ­¤é ææµè§å¨å µå¡ï¼ç¨æ·ä¼æè§å°æµè§å¨âå¡æ­»âäºï¼æ²¡æä»»ä½ååºãè¿æ¾ç¶æ¯å¾ä¸å¥½çä½éªï¼æä»¥æµè§å¨åè®¸èæ¬å¼æ­¥å è½½ï¼ä¸é¢å°±æ¯ä¸¤ç§å¼æ­¥å è½½çè¯­æ³ã\n\n<script src="path/to/mymodule.js" defer><\/script>\n<script src="path/to/mymodule.js" async><\/script>\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼<script>æ ç­¾æå¼deferæasyncå±æ§ï¼èæ¬å°±ä¼å¼æ­¥å è½½ãæ¸²æå¼æéå°è¿ä¸è¡å½ä»¤ï¼å°±ä¼å¼å§ä¸è½½å¤é¨èæ¬ï¼ä½ä¸ä¼ç­å®ä¸è½½åæ§è¡ï¼èæ¯ç´æ¥æ§è¡åé¢çå½ä»¤ã\n\ndeferä¸asyncçåºå«æ¯ï¼deferè¦ç­å°æ´ä¸ªé¡µé¢å¨åå­ä¸­æ­£å¸¸æ¸²æç»æï¼dom ç»æå®å¨çæï¼ä»¥åå¶ä»èæ¬æ§è¡å®æï¼ï¼æä¼æ§è¡ï¼asyncä¸æ¦ä¸è½½å®ï¼æ¸²æå¼æå°±ä¼ä¸­æ­æ¸²æï¼æ§è¡è¿ä¸ªèæ¬ä»¥åï¼åç»§ç»­æ¸²æãä¸å¥è¯ï¼deferæ¯âæ¸²æå®åæ§è¡âï¼asyncæ¯âä¸è½½å®å°±æ§è¡âãå¦å¤ï¼å¦ææå¤ä¸ªdeferèæ¬ï¼ä¼æç§å®ä»¬å¨é¡µé¢åºç°çé¡ºåºå è½½ï¼èå¤ä¸ªasyncèæ¬æ¯ä¸è½ä¿è¯å è½½é¡ºåºçã\n\n\n# å è½½è§å\n\næµè§å¨å è½½ es6 æ¨¡åï¼ä¹ä½¿ç¨<script>æ ç­¾ï¼ä½æ¯è¦å å¥type="module"å±æ§ã\n\n<script type="module" src="./foo.js"><\/script>\n\n\n1\n\n\nä¸é¢ä»£ç å¨ç½é¡µä¸­æå¥ä¸ä¸ªæ¨¡åfoo.jsï¼ç±äºtypeå±æ§è®¾ä¸ºmoduleï¼æä»¥æµè§å¨ç¥éè¿æ¯ä¸ä¸ª es6 æ¨¡åã\n\næµè§å¨å¯¹äºå¸¦ætype="module"ç<script>ï¼é½æ¯å¼æ­¥å è½½ï¼ä¸ä¼é æå µå¡æµè§å¨ï¼å³ç­å°æ´ä¸ªé¡µé¢æ¸²æå®ï¼åæ§è¡æ¨¡åèæ¬ï¼ç­åäºæå¼äº<script>æ ç­¾çdeferå±æ§ã\n\n<script type="module" src="./foo.js"><\/script>\n\x3c!-- ç­åäº --\x3e\n<script type="module" src="./foo.js" defer><\/script>\n\n\n1\n2\n3\n\n\nå¦æç½é¡µæå¤ä¸ª<script type="module">ï¼å®ä»¬ä¼æç§å¨é¡µé¢åºç°çé¡ºåºä¾æ¬¡æ§è¡ã\n\n<script>æ ç­¾çasyncå±æ§ä¹å¯ä»¥æå¼ï¼è¿æ¶åªè¦å è½½å®æï¼æ¸²æå¼æå°±ä¼ä¸­æ­æ¸²æç«å³æ§è¡ãæ§è¡å®æåï¼åæ¢å¤æ¸²æã\n\n<script type="module" src="./foo.js" async><\/script>\n\n\n1\n\n\nä¸æ¦ä½¿ç¨äºasyncå±æ§ï¼<script type="module">å°±ä¸ä¼æç§å¨é¡µé¢åºç°çé¡ºåºæ§è¡ï¼èæ¯åªè¦è¯¥æ¨¡åå è½½å®æï¼å°±æ§è¡è¯¥æ¨¡åã\n\nes6 æ¨¡åä¹åè®¸ååµå¨ç½é¡µä¸­ï¼è¯­æ³è¡ä¸ºä¸å è½½å¤é¨èæ¬å®å¨ä¸è´ã\n\n<script type="module">\n  import utils from "./utils.js";\n\n  // other code\n<\/script>\n\n\n1\n2\n3\n4\n5\n\n\nä¸¾ä¾æ¥è¯´ï¼jquery å°±æ¯ææ¨¡åå è½½ã\n\n<script type="module">\n  import $ from "./jquery/src/jquery.js";\n  $(\'#message\').text(\'hi from jquery!\');\n<\/script>\n\n\n1\n2\n3\n4\n\n\nå¯¹äºå¤é¨çæ¨¡åèæ¬ï¼ä¸ä¾æ¯foo.jsï¼ï¼æå ç¹éè¦æ³¨æã\n\n * ä»£ç æ¯å¨æ¨¡åä½ç¨åä¹ä¸­è¿è¡ï¼èä¸æ¯å¨å¨å±ä½ç¨åè¿è¡ãæ¨¡ååé¨çé¡¶å±åéï¼å¤é¨ä¸å¯è§ã\n * æ¨¡åèæ¬èªå¨éç¨ä¸¥æ ¼æ¨¡å¼ï¼ä¸ç®¡ææ²¡æå£°æuse strictã\n * æ¨¡åä¹ä¸­ï¼å¯ä»¥ä½¿ç¨importå½ä»¤å è½½å¶ä»æ¨¡åï¼.jsåç¼ä¸å¯çç¥ï¼éè¦æä¾ç»å¯¹ url æç¸å¯¹ urlï¼ï¼ä¹å¯ä»¥ä½¿ç¨exportå½ä»¤è¾åºå¯¹å¤æ¥å£ã\n * æ¨¡åä¹ä¸­ï¼é¡¶å±çthiså³é®å­è¿åundefinedï¼èä¸æ¯æåwindowãä¹å°±æ¯è¯´ï¼å¨æ¨¡åé¡¶å±ä½¿ç¨thiså³é®å­ï¼æ¯æ æä¹çã\n * åä¸ä¸ªæ¨¡åå¦æå è½½å¤æ¬¡ï¼å°åªæ§è¡ä¸æ¬¡ã\n\nä¸é¢æ¯ä¸ä¸ªç¤ºä¾æ¨¡åã\n\nimport utils from \'https://example.com/js/utils.js\';\n\nconst x = 1;\n\nconsole.log(x === window.x); //false\nconsole.log(this === undefined); // true\n\n\n1\n2\n3\n4\n5\n6\n\n\nå©ç¨é¡¶å±çthisç­äºundefinedè¿ä¸ªè¯­æ³ç¹ï¼å¯ä»¥ä¾¦æµå½åä»£ç æ¯å¦å¨ es6 æ¨¡åä¹ä¸­ã\n\nconst isnotmodulescript = this !== undefined;\n\n\n1\n\n\n\n# es6 æ¨¡åä¸ commonjs æ¨¡åçå·®å¼\n\nè®¨è®º node.js å è½½ es6 æ¨¡åä¹åï¼å¿é¡»äºè§£ es6 æ¨¡åä¸ commonjs æ¨¡åå®å¨ä¸åã\n\nå®ä»¬æä¸¤ä¸ªéå¤§å·®å¼ã\n\n * commonjs æ¨¡åè¾åºçæ¯ä¸ä¸ªå¼çæ·è´ï¼es6 æ¨¡åè¾åºçæ¯å¼çå¼ç¨ã\n * commonjs æ¨¡åæ¯è¿è¡æ¶å è½½ï¼es6 æ¨¡åæ¯ç¼è¯æ¶è¾åºæ¥å£ã\n\nç¬¬äºä¸ªå·®å¼æ¯å ä¸º commonjs å è½½çæ¯ä¸ä¸ªå¯¹è±¡ï¼å³module.exportså±æ§ï¼ï¼è¯¥å¯¹è±¡åªæå¨èæ¬è¿è¡å®æä¼çæãè es6 æ¨¡åä¸æ¯å¯¹è±¡ï¼å®çå¯¹å¤æ¥å£åªæ¯ä¸ç§éæå®ä¹ï¼å¨ä»£ç éæè§£æé¶æ®µå°±ä¼çæã\n\nä¸é¢éç¹è§£éç¬¬ä¸ä¸ªå·®å¼ã\n\ncommonjs æ¨¡åè¾åºçæ¯å¼çæ·è´ï¼ä¹å°±æ¯è¯´ï¼ä¸æ¦è¾åºä¸ä¸ªå¼ï¼æ¨¡ååé¨çååå°±å½±åä¸å°è¿ä¸ªå¼ãè¯·çä¸é¢è¿ä¸ªæ¨¡åæä»¶lib.jsçä¾å­ã\n\n// lib.js\nvar counter = 3;\nfunction inccounter() {\n  counter++;\n}\nmodule.exports = {\n  counter: counter,\n  inccounter: inccounter,\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç è¾åºåé¨åécounteråæ¹åè¿ä¸ªåéçåé¨æ¹æ³inccounterãç¶åï¼å¨main.jséé¢å è½½è¿ä¸ªæ¨¡åã\n\n// main.js\nvar mod = require(\'./lib\');\n\nconsole.log(mod.counter);  // 3\nmod.inccounter();\nconsole.log(mod.counter); // 3\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç è¯´æï¼lib.jsæ¨¡åå è½½ä»¥åï¼å®çåé¨ååå°±å½±åä¸å°è¾åºçmod.counteräºãè¿æ¯å ä¸ºmod.counteræ¯ä¸ä¸ªåå§ç±»åçå¼ï¼ä¼è¢«ç¼å­ãé¤éåæä¸ä¸ªå½æ°ï¼æè½å¾å°åé¨åå¨åçå¼ã\n\n// lib.js\nvar counter = 3;\nfunction inccounter() {\n  counter++;\n}\nmodule.exports = {\n  get counter() {\n    return counter\n  },\n  inccounter: inccounter,\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼è¾åºçcounterå±æ§å®éä¸æ¯ä¸ä¸ªåå¼å¨å½æ°ãç°å¨åæ§è¡main.jsï¼å°±å¯ä»¥æ­£ç¡®è¯»ååé¨åécounterçåå¨äºã\n\n$ node main.js\n3\n4\n\n\n1\n2\n3\n\n\nes6 æ¨¡åçè¿è¡æºå¶ä¸ commonjs ä¸ä¸æ ·ãjs å¼æå¯¹èæ¬éæåæçæ¶åï¼éå°æ¨¡åå è½½å½ä»¤importï¼å°±ä¼çæä¸ä¸ªåªè¯»å¼ç¨ãç­å°èæ¬çæ­£æ§è¡æ¶ï¼åæ ¹æ®è¿ä¸ªåªè¯»å¼ç¨ï¼å°è¢«å è½½çé£ä¸ªæ¨¡åéé¢å»åå¼ãæ¢å¥è¯è¯´ï¼es6 çimportæç¹å unix ç³»ç»çâç¬¦å·è¿æ¥âï¼åå§å¼åäºï¼importå è½½çå¼ä¹ä¼è·çåãå æ­¤ï¼es6 æ¨¡åæ¯å¨æå¼ç¨ï¼å¹¶ä¸ä¸ä¼ç¼å­å¼ï¼æ¨¡åéé¢çåéç»å®å¶æå¨çæ¨¡åã\n\nè¿æ¯ä¸¾ä¸é¢çä¾å­ã\n\n// lib.js\nexport let counter = 3;\nexport function inccounter() {\n  counter++;\n}\n\n// main.js\nimport { counter, inccounter } from \'./lib\';\nconsole.log(counter); // 3\ninccounter();\nconsole.log(counter); // 4\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç è¯´æï¼es6 æ¨¡åè¾å¥çåécounteræ¯æ´»çï¼å®å¨ååºå¶æå¨æ¨¡ålib.jsåé¨çååã\n\nåä¸¾ä¸ä¸ªåºç°å¨exportä¸èä¸­çä¾å­ã\n\n// m1.js\nexport var foo = \'bar\';\nsettimeout(() => foo = \'baz\', 500);\n\n// m2.js\nimport {foo} from \'./m1.js\';\nconsole.log(foo);\nsettimeout(() => console.log(foo), 500);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼m1.jsçåéfooï¼å¨åå è½½æ¶ç­äºbarï¼è¿äº 500 æ¯«ç§ï¼ååä¸ºç­äºbazã\n\nè®©æä»¬ççï¼m2.jsè½å¦æ­£ç¡®è¯»åè¿ä¸ªååã\n\n$ babel-node m2.js\n\nbar\nbaz\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç è¡¨æï¼es6 æ¨¡åä¸ä¼ç¼å­è¿è¡ç»æï¼èæ¯å¨æå°å»è¢«å è½½çæ¨¡ååå¼ï¼å¹¶ä¸åéæ»æ¯ç»å®å¶æå¨çæ¨¡åã\n\nç±äº es6 è¾å¥çæ¨¡ååéï¼åªæ¯ä¸ä¸ªâç¬¦å·è¿æ¥âï¼æä»¥è¿ä¸ªåéæ¯åªè¯»çï¼å¯¹å®è¿è¡éæ°èµå¼ä¼æ¥éã\n\n// lib.js\nexport let obj = {};\n\n// main.js\nimport { obj } from \'./lib\';\n\nobj.prop = 123; // ok\nobj = {}; // typeerror\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼main.jsä»lib.jsè¾å¥åéobjï¼å¯ä»¥å¯¹objæ·»å å±æ§ï¼ä½æ¯éæ°èµå¼å°±ä¼æ¥éãå ä¸ºåéobjæåçå°åæ¯åªè¯»çï¼ä¸è½éæ°èµå¼ï¼è¿å°±å¥½æ¯main.jsåé äºä¸ä¸ªåä¸ºobjçconståéã\n\næåï¼exportéè¿æ¥å£ï¼è¾åºçæ¯åä¸ä¸ªå¼ãä¸åçèæ¬å è½½è¿ä¸ªæ¥å£ï¼å¾å°çé½æ¯åæ ·çå®ä¾ã\n\n// mod.js\nfunction c() {\n  this.sum = 0;\n  this.add = function () {\n    this.sum += 1;\n  };\n  this.show = function () {\n    console.log(this.sum);\n  };\n}\n\nexport let c = new c();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢çèæ¬mod.jsï¼è¾åºçæ¯ä¸ä¸ªcçå®ä¾ãä¸åçèæ¬å è½½è¿ä¸ªæ¨¡åï¼å¾å°çé½æ¯åä¸ä¸ªå®ä¾ã\n\n// x.js\nimport {c} from \'./mod\';\nc.add();\n\n// y.js\nimport {c} from \'./mod\';\nc.show();\n\n// main.js\nimport \'./x\';\nimport \'./y\';\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nç°å¨æ§è¡main.jsï¼è¾åºçæ¯1ã\n\n$ babel-node main.js\n1\n\n\n1\n2\n\n\nè¿å°±è¯æäºx.jsåy.jså è½½çé½æ¯cçåä¸ä¸ªå®ä¾ã\n\n\n# node.js å è½½\n\n\n# æ¦è¿°\n\nnode.js å¯¹ es6 æ¨¡åçå¤çæ¯è¾éº»ç¦ï¼å ä¸ºå®æèªå·±ç commonjs æ¨¡åæ ¼å¼ï¼ä¸ es6 æ¨¡åæ ¼å¼æ¯ä¸å¼å®¹çãç®åçè§£å³æ¹æ¡æ¯ï¼å°ä¸¤èåå¼ï¼es6 æ¨¡åå commonjs éç¨åèªçå è½½æ¹æ¡ãä» v13.2 çæ¬å¼å§ï¼node.js å·²ç»é»è®¤æå¼äº es6 æ¨¡åæ¯æã\n\nnode.js è¦æ± es6 æ¨¡åéç¨.mjsåç¼æä»¶åãä¹å°±æ¯è¯´ï¼åªè¦èæ¬æä»¶éé¢ä½¿ç¨importæèexportå½ä»¤ï¼é£ä¹å°±å¿é¡»éç¨.mjsåç¼åãnode.js éå°.mjsæä»¶ï¼å°±è®¤ä¸ºå®æ¯ es6 æ¨¡åï¼é»è®¤å¯ç¨ä¸¥æ ¼æ¨¡å¼ï¼ä¸å¿å¨æ¯ä¸ªæ¨¡åæä»¶é¡¶é¨æå®"use strict"ã\n\nå¦æä¸å¸æå°åç¼åæ¹æ.mjsï¼å¯ä»¥å¨é¡¹ç®çpackage.jsonæä»¶ä¸­ï¼æå®typeå­æ®µä¸ºmoduleã\n\n{\n   "type": "module"\n}\n\n\n1\n2\n3\n\n\nä¸æ¦è®¾ç½®äºä»¥åï¼è¯¥ç®å½éé¢ç js èæ¬ï¼å°±è¢«è§£éç¨ es6 æ¨¡åã\n\n# è§£éæ es6 æ¨¡å\n$ node my-app.js\n\n\n1\n2\n\n\nå¦æè¿æ¶è¿è¦ä½¿ç¨ commonjs æ¨¡åï¼é£ä¹éè¦å° commonjs èæ¬çåç¼åé½æ¹æ.cjsãå¦ææ²¡ætypeå­æ®µï¼æètypeå­æ®µä¸ºcommonjsï¼å.jsèæ¬ä¼è¢«è§£éæ commonjs æ¨¡åã\n\næ»ç»ä¸ºä¸å¥è¯ï¼.mjsæä»¶æ»æ¯ä»¥ es6 æ¨¡åå è½½ï¼.cjsæä»¶æ»æ¯ä»¥ commonjs æ¨¡åå è½½ï¼.jsæä»¶çå è½½åå³äºpackage.jsonéé¢typeå­æ®µçè®¾ç½®ã\n\næ³¨æï¼es6 æ¨¡åä¸ commonjs æ¨¡åå°½éä¸è¦æ··ç¨ãrequireå½ä»¤ä¸è½å è½½.mjsæä»¶ï¼ä¼æ¥éï¼åªæimportå½ä»¤æå¯ä»¥å è½½.mjsæä»¶ãåè¿æ¥ï¼.mjsæä»¶éé¢ä¹ä¸è½ä½¿ç¨requireå½ä»¤ï¼å¿é¡»ä½¿ç¨importã\n\n\n# main å­æ®µ\n\npackage.jsonæä»¶æä¸¤ä¸ªå­æ®µå¯ä»¥æå®æ¨¡åçå¥å£æä»¶ï¼mainåexportsãæ¯è¾ç®åçæ¨¡åï¼å¯ä»¥åªä½¿ç¨mainå­æ®µï¼æå®æ¨¡åå è½½çå¥å£æä»¶ã\n\n// ./node_modules/es-module-package/package.json\n{\n  "type": "module",\n  "main": "./src/index.js"\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç æå®é¡¹ç®çå¥å£èæ¬ä¸º./src/index.jsï¼å®çæ ¼å¼ä¸º es6 æ¨¡åãå¦ææ²¡ætypeå­æ®µï¼index.jså°±ä¼è¢«è§£éä¸º commonjs æ¨¡åã\n\nç¶åï¼importå½ä»¤å°±å¯ä»¥å è½½è¿ä¸ªæ¨¡åã\n\n// ./my-app.mjs\n\nimport { something } from \'es-module-package\';\n// å®éå è½½çæ¯ ./node_modules/es-module-package/src/index.js\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼è¿è¡è¯¥èæ¬ä»¥åï¼node.js å°±ä¼å°./node_modulesç®å½ä¸é¢ï¼å¯»æ¾es-module-packageæ¨¡åï¼ç¶åæ ¹æ®è¯¥æ¨¡åpackage.jsonçmainå­æ®µå»æ§è¡å¥å£æä»¶ã\n\nè¿æ¶ï¼å¦æç¨ commonjs æ¨¡åçrequire()å½ä»¤å»å è½½es-module-packageæ¨¡åä¼æ¥éï¼å ä¸º commonjs æ¨¡åä¸è½å¤çexportå½ä»¤ã\n\n\n# exports å­æ®µ\n\nexportså­æ®µçä¼åçº§é«äºmainå­æ®µãå®æå¤ç§ç¨æ³ã\n\nï¼1ï¼å­ç®å½å«å\n\npackage.jsonæä»¶çexportså­æ®µå¯ä»¥æå®èæ¬æå­ç®å½çå«åã\n\n// ./node_modules/es-module-package/package.json\n{\n  "exports": {\n    "./submodule": "./src/submodule.js"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢çä»£ç æå®src/submodule.jså«åä¸ºsubmoduleï¼ç¶åå°±å¯ä»¥ä»å«åå è½½è¿ä¸ªæä»¶ã\n\nimport submodule from \'es-module-package/submodule\';\n// å è½½ ./node_modules/es-module-package/src/submodule.js\n\n\n1\n2\n\n\nä¸é¢æ¯å­ç®å½å«åçä¾å­ã\n\n// ./node_modules/es-module-package/package.json\n{\n  "exports": {\n    "./features/": "./src/features/"\n  }\n}\n\nimport feature from \'es-module-package/features/x.js\';\n// å è½½ ./node_modules/es-module-package/src/features/x.js\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nå¦ææ²¡ææå®å«åï¼å°±ä¸è½ç¨âæ¨¡å+èæ¬åâè¿ç§å½¢å¼å è½½èæ¬ã\n\n// æ¥é\nimport submodule from \'es-module-package/private-module.js\';\n\n// ä¸æ¥é\nimport submodule from \'./node_modules/es-module-package/private-module.js\';\n\n\n1\n2\n3\n4\n5\n\n\nï¼2ï¼main çå«å\n\nexportså­æ®µçå«åå¦ææ¯.ï¼å°±ä»£è¡¨æ¨¡åçä¸»å¥å£ï¼ä¼åçº§é«äºmainå­æ®µï¼å¹¶ä¸å¯ä»¥ç´æ¥ç®åæexportså­æ®µçå¼ã\n\n{\n  "exports": {\n    ".": "./main.js"\n  }\n}\n\n// ç­åäº\n{\n  "exports": "./main.js"\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nç±äºexportså­æ®µåªææ¯æ es6 ç node.js æè®¤è¯ï¼æä»¥å¯ä»¥ç¨æ¥å¼å®¹æ§çæ¬ç node.jsã\n\n{\n  "main": "./main-legacy.cjs",\n  "exports": {\n    ".": "./main-modern.cjs"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼èçæ¬ç node.js ï¼ä¸æ¯æ es6 æ¨¡åï¼çå¥å£æä»¶æ¯main-legacy.cjsï¼æ°çæ¬ç node.js çå¥å£æä»¶æ¯main-modern.cjsã\n\nï¼3ï¼æ¡ä»¶å è½½\n\nå©ç¨.è¿ä¸ªå«åï¼å¯ä»¥ä¸º es6 æ¨¡åå commonjs æå®ä¸åçå¥å£ãç®åï¼è¿ä¸ªåè½éè¦å¨ node.js è¿è¡çæ¶åï¼æå¼--experimental-conditional-exportsæ å¿ã\n\n{\n  "type": "module",\n  "exports": {\n    ".": {\n      "require": "./main.cjs",\n      "default": "./main.js"\n    }\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å«å.çrequireæ¡ä»¶æå®require()å½ä»¤çå¥å£æä»¶ï¼å³ commonjs çå¥å£ï¼ï¼defaultæ¡ä»¶æå®å¶ä»æåµçå¥å£ï¼å³ es6 çå¥å£ï¼ã\n\nä¸é¢çåæ³å¯ä»¥ç®åå¦ä¸ã\n\n{\n  "exports": {\n    "require": "./main.cjs",\n    "default": "./main.js"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\næ³¨æï¼å¦æåæ¶è¿æå¶ä»å«åï¼å°±ä¸è½éç¨ç®åï¼å¦åææ¥éã\n\n{\n  // æ¥é\n  "exports": {\n    "./feature": "./lib/feature.js",\n    "require": "./main.cjs",\n    "default": "./main.js"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# es6 æ¨¡åå è½½ commonjs æ¨¡å\n\nç®åï¼ä¸ä¸ªæ¨¡ååæ¶æ¯æ es6 å commonjs ä¸¤ç§æ ¼å¼çå¸¸è§æ¹æ³æ¯ï¼package.jsonæä»¶çmainå­æ®µæå® commonjs å¥å£ï¼ç» node.js ä½¿ç¨ï¼moduleå­æ®µæå® es6 æ¨¡åå¥å£ï¼ç»æåå·¥å·ä½¿ç¨ï¼å ä¸º node.js ä¸è®¤è¯moduleå­æ®µã\n\næäºä¸ä¸èçæ¡ä»¶å è½½ä»¥åï¼node.js æ¬èº«å°±å¯ä»¥åæ¶å¤çä¸¤ç§æ¨¡åã\n\n// ./node_modules/pkg/package.json\n{\n  "type": "module",\n  "main": "./index.cjs",\n  "exports": {\n    "require": "./index.cjs",\n    "default": "./wrapper.mjs"\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç æå®äº commonjs å¥å£æä»¶index.cjsï¼ä¸é¢æ¯è¿ä¸ªæä»¶çä»£ç ã\n\n// ./node_modules/pkg/index.cjs\nexports.name = \'value\';\n\n\n1\n2\n\n\nç¶åï¼es6 æ¨¡åå¯ä»¥å è½½è¿ä¸ªæä»¶ã\n\n// ./node_modules/pkg/wrapper.mjs\nimport cjsmodule from \'./index.cjs\';\nexport const name = cjsmodule.name;\n\n\n1\n2\n3\n\n\næ³¨æï¼importå½ä»¤å è½½ commonjs æ¨¡åï¼åªè½æ´ä½å è½½ï¼ä¸è½åªå è½½åä¸çè¾åºé¡¹ã\n\n// æ­£ç¡®\nimport packagemain from \'commonjs-package\';\n\n// æ¥é\nimport { method } from \'commonjs-package\';\n\n\n1\n2\n3\n4\n5\n\n\nè¿æä¸ç§åéçå è½½æ¹æ³ï¼å°±æ¯ä½¿ç¨ node.js åç½®çmodule.createrequire()æ¹æ³ã\n\n// cjs.cjs\nmodule.exports = \'cjs\';\n\n// esm.mjs\nimport { createrequire } from \'module\';\n\nconst require = createrequire(import.meta.url);\n\nconst cjs = require(\'./cjs.cjs\');\ncjs === \'cjs\'; // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼es6 æ¨¡åéè¿module.createrequire()æ¹æ³å¯ä»¥å è½½ commonjs æ¨¡å\n\n\n# commonjs æ¨¡åå è½½ es6 æ¨¡å\n\ncommonjs çrequireå½ä»¤ä¸è½å è½½ es6 æ¨¡åï¼ä¼æ¥éï¼åªè½ä½¿ç¨import()è¿ä¸ªæ¹æ³å è½½ã\n\n(async () => {\n  await import(\'./my-app.mjs\');\n})();\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç å¯ä»¥å¨ commonjs æ¨¡åä¸­è¿è¡ã\n\n\n# node.js çåç½®æ¨¡å\n\nnode.js çåç½®æ¨¡åå¯ä»¥æ´ä½å è½½ï¼ä¹å¯ä»¥å è½½æå®çè¾åºé¡¹ã\n\n// æ´ä½å è½½\nimport eventemitter from \'events\';\nconst e = new eventemitter();\n\n// å è½½æå®çè¾åºé¡¹\nimport { readfile } from \'fs\';\nreadfile(\'./foo.txt\', (err, source) => {\n  if (err) {\n    console.error(err);\n  } else {\n    console.log(source);\n  }\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# å è½½è·¯å¾\n\nes6 æ¨¡åçå è½½è·¯å¾å¿é¡»ç»åºèæ¬çå®æ´è·¯å¾ï¼ä¸è½çç¥èæ¬çåç¼åãimportå½ä»¤åpackage.jsonæä»¶çmainå­æ®µå¦æçç¥èæ¬çåç¼åï¼ä¼æ¥éã\n\n// es6 æ¨¡åä¸­å°æ¥é\nimport { something } from \'./index\';\n\n\n1\n2\n\n\nä¸ºäºä¸æµè§å¨çimportå è½½è§åç¸åï¼node.js ç.mjsæä»¶æ¯æ url è·¯å¾ã\n\nimport \'./foo.mjs?query=1\'; // å è½½ ./foo ä¼ å¥åæ° ?query=1\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼èæ¬è·¯å¾å¸¦æåæ°?query=1ï¼node ä¼æ url è§åè§£è¯»ãåä¸ä¸ªèæ¬åªè¦åæ°ä¸åï¼å°±ä¼è¢«å è½½å¤æ¬¡ï¼å¹¶ä¸ä¿å­æä¸åçç¼å­ãç±äºè¿ä¸ªåå ï¼åªè¦æä»¶åä¸­å«æ:ã%ã#ã?ç­ç¹æ®å­ç¬¦ï¼æå¥½å¯¹è¿äºå­ç¬¦è¿è¡è½¬ä¹ã\n\nç®åï¼node.js çimportå½ä»¤åªæ¯æå è½½æ¬å°æ¨¡åï¼file:åè®®ï¼ådata:åè®®ï¼ä¸æ¯æå è½½è¿ç¨æ¨¡åãå¦å¤ï¼èæ¬è·¯å¾åªæ¯æç¸å¯¹è·¯å¾ï¼ä¸æ¯æç»å¯¹è·¯å¾ï¼å³ä»¥/æ//å¼å¤´çè·¯å¾ï¼ã\n\næåï¼node çimportå½ä»¤æ¯å¼æ­¥å è½½ï¼è¿ä¸ç¹ä¸æµè§å¨çå¤çæ¹æ³ç¸åã\n\n\n# åé¨åé\n\nes6 æ¨¡ååºè¯¥æ¯éç¨çï¼åä¸ä¸ªæ¨¡åä¸ç¨ä¿®æ¹ï¼å°±å¯ä»¥ç¨å¨æµè§å¨ç¯å¢åæå¡å¨ç¯å¢ãä¸ºäºè¾¾å°è¿ä¸ªç®æ ï¼node è§å® es6 æ¨¡åä¹ä¸­ä¸è½ä½¿ç¨ commonjs æ¨¡åçç¹æçä¸äºåé¨åéã\n\né¦åï¼å°±æ¯thiså³é®å­ães6 æ¨¡åä¹ä¸­ï¼é¡¶å±çthisæåundefinedï¼commonjs æ¨¡åçé¡¶å±thisæåå½åæ¨¡åï¼è¿æ¯ä¸¤èçä¸ä¸ªéå¤§å·®å¼ã\n\nå¶æ¬¡ï¼ä»¥ä¸è¿äºé¡¶å±åéå¨ es6 æ¨¡åä¹ä¸­é½æ¯ä¸å­å¨çã\n\n * arguments\n * require\n * module\n * exports\n * __filename\n * __dirname\n\n\n# å¾ªç¯å è½½\n\nâå¾ªç¯å è½½âï¼circular dependencyï¼æçæ¯ï¼aèæ¬çæ§è¡ä¾èµbèæ¬ï¼èbèæ¬çæ§è¡åä¾èµaèæ¬ã\n\n// a.js\nvar b = require(\'b\');\n\n// b.js\nvar a = require(\'a\');\n\n\n1\n2\n3\n4\n5\n\n\néå¸¸ï¼âå¾ªç¯å è½½âè¡¨ç¤ºå­å¨å¼ºè¦åï¼å¦æå¤çä¸å¥½ï¼è¿å¯è½å¯¼è´éå½å è½½ï¼ä½¿å¾ç¨åºæ æ³æ§è¡ï¼å æ­¤åºè¯¥é¿ååºç°ã\n\nä½æ¯å®éä¸ï¼è¿æ¯å¾é¾é¿åçï¼å°¤å¶æ¯ä¾èµå³ç³»å¤æçå¤§é¡¹ç®ï¼å¾å®¹æåºç°aä¾èµbï¼bä¾èµcï¼cåä¾èµaè¿æ ·çæåµãè¿æå³çï¼æ¨¡åå è½½æºå¶å¿é¡»èèâå¾ªç¯å è½½âçæåµã\n\nå¯¹äº javascript è¯­è¨æ¥è¯´ï¼ç®åæå¸¸è§çä¸¤ç§æ¨¡åæ ¼å¼ commonjs å es6ï¼å¤çâå¾ªç¯å è½½âçæ¹æ³æ¯ä¸ä¸æ ·çï¼è¿åçç»æä¹ä¸ä¸æ ·ã\n\n\n# commonjs æ¨¡åçå è½½åç\n\nä»ç» es6 å¦ä½å¤çâå¾ªç¯å è½½âä¹åï¼åä»ç»ç®åææµè¡ç commonjs æ¨¡åæ ¼å¼çå è½½åçã\n\ncommonjs çä¸ä¸ªæ¨¡åï¼å°±æ¯ä¸ä¸ªèæ¬æä»¶ãrequireå½ä»¤ç¬¬ä¸æ¬¡å è½½è¯¥èæ¬ï¼å°±ä¼æ§è¡æ´ä¸ªèæ¬ï¼ç¶åå¨åå­çæä¸ä¸ªå¯¹è±¡ã\n\n{\n  id: \'...\',\n  exports: { ... },\n  loaded: true,\n  ...\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç å°±æ¯ node åé¨å è½½æ¨¡ååçæçä¸ä¸ªå¯¹è±¡ãè¯¥å¯¹è±¡çidå±æ§æ¯æ¨¡ååï¼exportså±æ§æ¯æ¨¡åè¾åºçåä¸ªæ¥å£ï¼loadedå±æ§æ¯ä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºè¯¥æ¨¡åçèæ¬æ¯å¦æ§è¡å®æ¯ãå¶ä»è¿æå¾å¤å±æ§ï¼è¿éé½çç¥äºã\n\nä»¥åéè¦ç¨å°è¿ä¸ªæ¨¡åçæ¶åï¼å°±ä¼å°exportså±æ§ä¸é¢åå¼ãå³ä½¿åæ¬¡æ§è¡requireå½ä»¤ï¼ä¹ä¸ä¼åæ¬¡æ§è¡è¯¥æ¨¡åï¼èæ¯å°ç¼å­ä¹ä¸­åå¼ãä¹å°±æ¯è¯´ï¼commonjs æ¨¡åæ è®ºå è½½å¤å°æ¬¡ï¼é½åªä¼å¨ç¬¬ä¸æ¬¡å è½½æ¶è¿è¡ä¸æ¬¡ï¼ä»¥ååå è½½ï¼å°±è¿åç¬¬ä¸æ¬¡è¿è¡çç»æï¼é¤éæå¨æ¸é¤ç³»ç»ç¼å­ã\n\n\n# commonjs æ¨¡åçå¾ªç¯å è½½\n\ncommonjs æ¨¡åçéè¦ç¹æ§æ¯å è½½æ¶æ§è¡ï¼å³èæ¬ä»£ç å¨requireçæ¶åï¼å°±ä¼å¨é¨æ§è¡ãä¸æ¦åºç°æä¸ªæ¨¡åè¢«"å¾ªç¯å è½½"ï¼å°±åªè¾åºå·²ç»æ§è¡çé¨åï¼è¿æªæ§è¡çé¨åä¸ä¼è¾åºã\n\nè®©æä»¬æ¥çï¼node å®æ¹ææ¡£éé¢çä¾å­ãèæ¬æä»¶a.jsä»£ç å¦ä¸ã\n\nexports.done = false;\nvar b = require(\'./b.js\');\nconsole.log(\'å¨ a.js ä¹ä¸­ï¼b.done = %j\', b.done);\nexports.done = true;\nconsole.log(\'a.js æ§è¡å®æ¯\');\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¹ä¸­ï¼a.jsèæ¬åè¾åºä¸ä¸ªdoneåéï¼ç¶åå è½½å¦ä¸ä¸ªèæ¬æä»¶b.jsãæ³¨æï¼æ­¤æ¶a.jsä»£ç å°±åå¨è¿éï¼ç­å¾b.jsæ§è¡å®æ¯ï¼åå¾ä¸æ§è¡ã\n\nåçb.jsçä»£ç ã\n\nexports.done = false;\nvar a = require(\'./a.js\');\nconsole.log(\'å¨ b.js ä¹ä¸­ï¼a.done = %j\', a.done);\nexports.done = true;\nconsole.log(\'b.js æ§è¡å®æ¯\');\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¹ä¸­ï¼b.jsæ§è¡å°ç¬¬äºè¡ï¼å°±ä¼å»å è½½a.jsï¼è¿æ¶ï¼å°±åçäºâå¾ªç¯å è½½âãç³»ç»ä¼å»a.jsæ¨¡åå¯¹åºå¯¹è±¡çexportså±æ§åå¼ï¼å¯æ¯å ä¸ºa.jsè¿æ²¡ææ§è¡å®ï¼ä»exportså±æ§åªè½ååå·²ç»æ§è¡çé¨åï¼èä¸æ¯æåçå¼ã\n\na.jså·²ç»æ§è¡çé¨åï¼åªæä¸è¡ã\n\nexports.done = false;\n\n\n1\n\n\nå æ­¤ï¼å¯¹äºb.jsæ¥è¯´ï¼å®ä»a.jsåªè¾å¥ä¸ä¸ªåédoneï¼å¼ä¸ºfalseã\n\nç¶åï¼b.jsæ¥çå¾ä¸æ§è¡ï¼ç­å°å¨é¨æ§è¡å®æ¯ï¼åææ§è¡æäº¤è¿ç»a.jsãäºæ¯ï¼a.jsæ¥çå¾ä¸æ§è¡ï¼ç´å°æ§è¡å®æ¯ãæä»¬åä¸ä¸ªèæ¬main.jsï¼éªè¯è¿ä¸ªè¿ç¨ã\n\nvar a = require(\'./a.js\');\nvar b = require(\'./b.js\');\nconsole.log(\'å¨ main.js ä¹ä¸­, a.done=%j, b.done=%j\', a.done, b.done);\n\n\n1\n2\n3\n\n\næ§è¡main.jsï¼è¿è¡ç»æå¦ä¸ã\n\n$ node main.js\n\nå¨ b.js ä¹ä¸­ï¼a.done = false\nb.js æ§è¡å®æ¯\nå¨ a.js ä¹ä¸­ï¼b.done = true\na.js æ§è¡å®æ¯\nå¨ main.js ä¹ä¸­, a.done=true, b.done=true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢çä»£ç è¯æäºä¸¤ä»¶äºãä¸æ¯ï¼å¨b.jsä¹ä¸­ï¼a.jsæ²¡ææ§è¡å®æ¯ï¼åªæ§è¡äºç¬¬ä¸è¡ãäºæ¯ï¼main.jsæ§è¡å°ç¬¬äºè¡æ¶ï¼ä¸ä¼åæ¬¡æ§è¡b.jsï¼èæ¯è¾åºç¼å­çb.jsçæ§è¡ç»æï¼å³å®çç¬¬åè¡ã\n\nexports.done = true;\n\n\n1\n\n\næ»ä¹ï¼commonjs è¾å¥çæ¯è¢«è¾åºå¼çæ·è´ï¼ä¸æ¯å¼ç¨ã\n\nå¦å¤ï¼ç±äº commonjs æ¨¡åéå°å¾ªç¯å è½½æ¶ï¼è¿åçæ¯å½åå·²ç»æ§è¡çé¨åçå¼ï¼èä¸æ¯ä»£ç å¨é¨æ§è¡åçå¼ï¼ä¸¤èå¯è½ä¼æå·®å¼ãæä»¥ï¼è¾å¥åéçæ¶åï¼å¿é¡»éå¸¸å°å¿ã\n\nvar a = require(\'a\'); // å®å¨çåæ³\nvar foo = require(\'a\').foo; // å±é©çåæ³\n\nexports.good = function (arg) {\n  return a.foo(\'good\', arg); // ä½¿ç¨çæ¯ a.foo çææ°å¼\n};\n\nexports.bad = function (arg) {\n  return foo(\'bad\', arg); // ä½¿ç¨çæ¯ä¸ä¸ªé¨åå è½½æ¶çå¼\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æåçå¾ªç¯å è½½ï¼require(\'a\').fooçå¼å¾å¯è½åé¢ä¼è¢«æ¹åï¼æ¹ç¨require(\'a\')ä¼æ´ä¿é©ä¸ç¹ã\n\n\n# es6 æ¨¡åçå¾ªç¯å è½½\n\nes6 å¤çâå¾ªç¯å è½½âä¸ commonjs ææ¬è´¨çä¸åães6 æ¨¡åæ¯å¨æå¼ç¨ï¼å¦æä½¿ç¨importä»ä¸ä¸ªæ¨¡åå è½½åéï¼å³import foo from \'foo\'ï¼ï¼é£äºåéä¸ä¼è¢«ç¼å­ï¼èæ¯æä¸ºä¸ä¸ªæåè¢«å è½½æ¨¡åçå¼ç¨ï¼éè¦å¼åèèªå·±ä¿è¯ï¼çæ­£åå¼çæ¶åè½å¤åå°å¼ã\n\nè¯·çä¸é¢è¿ä¸ªä¾å­ã\n\n// a.mjs\nimport {bar} from \'./b\';\nconsole.log(\'a.mjs\');\nconsole.log(bar);\nexport let foo = \'foo\';\n\n// b.mjs\nimport {foo} from \'./a\';\nconsole.log(\'b.mjs\');\nconsole.log(foo);\nexport let bar = \'bar\';\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼a.mjså è½½b.mjsï¼b.mjsåå è½½a.mjsï¼ææå¾ªç¯å è½½ãæ§è¡a.mjsï¼ç»æå¦ä¸ã\n\n$ node --experimental-modules a.mjs\nb.mjs\nreferenceerror: foo is not defined\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼æ§è¡a.mjsä»¥åä¼æ¥éï¼fooåéæªå®ä¹ï¼è¿æ¯ä¸ºä»ä¹ï¼\n\nè®©æä»¬ä¸è¡è¡æ¥çï¼es6 å¾ªç¯å è½½æ¯æä¹å¤ççãé¦åï¼æ§è¡a.mjsä»¥åï¼å¼æåç°å®å è½½äºb.mjsï¼å æ­¤ä¼ä¼åæ§è¡b.mjsï¼ç¶ååæ§è¡a.mjsãæ¥çï¼æ§è¡b.mjsçæ¶åï¼å·²ç¥å®ä»a.mjsè¾å¥äºfooæ¥å£ï¼è¿æ¶ä¸ä¼å»æ§è¡a.mjsï¼èæ¯è®¤ä¸ºè¿ä¸ªæ¥å£å·²ç»å­å¨äºï¼ç»§ç»­å¾ä¸æ§è¡ãæ§è¡å°ç¬¬ä¸è¡console.log(foo)çæ¶åï¼æåç°è¿ä¸ªæ¥å£æ ¹æ¬æ²¡å®ä¹ï¼å æ­¤æ¥éã\n\nè§£å³è¿ä¸ªé®é¢çæ¹æ³ï¼å°±æ¯è®©b.mjsè¿è¡çæ¶åï¼fooå·²ç»æå®ä¹äºãè¿å¯ä»¥éè¿å°fooåæå½æ°æ¥è§£å³ã\n\n// a.mjs\nimport {bar} from \'./b\';\nconsole.log(\'a.mjs\');\nconsole.log(bar());\nfunction foo() { return \'foo\' }\nexport {foo};\n\n// b.mjs\nimport {foo} from \'./a\';\nconsole.log(\'b.mjs\');\nconsole.log(foo());\nfunction bar() { return \'bar\' }\nexport {bar};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nè¿æ¶åæ§è¡a.mjså°±å¯ä»¥å¾å°é¢æç»æã\n\n$ node --experimental-modules a.mjs\nb.mjs\nfoo\na.mjs\nbar\n\n\n1\n2\n3\n4\n5\n\n\nè¿æ¯å ä¸ºå½æ°å·ææåä½ç¨ï¼å¨æ§è¡import {bar} from \'./b\'æ¶ï¼å½æ°fooå°±å·²ç»æå®ä¹äºï¼æä»¥b.mjså è½½çæ¶åä¸ä¼æ¥éãè¿ä¹æå³çï¼å¦ææå½æ°fooæ¹åæå½æ°è¡¨è¾¾å¼ï¼ä¹ä¼æ¥éã\n\n// a.mjs\nimport {bar} from \'./b\';\nconsole.log(\'a.mjs\');\nconsole.log(bar());\nconst foo = () => \'foo\';\nexport {foo};\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çç¬¬åè¡ï¼æ¹æäºå½æ°è¡¨è¾¾å¼ï¼å°±ä¸å·ææåä½ç¨ï¼æ§è¡å°±ä¼æ¥éã\n\næä»¬åæ¥ç es6 æ¨¡åå è½½å¨systemjsç»åºçä¸ä¸ªä¾å­ã\n\n// even.js\nimport { odd } from \'./odd\'\nexport var counter = 0;\nexport function even(n) {\n  counter++;\n  return n === 0 || odd(n - 1);\n}\n\n// odd.js\nimport { even } from \'./even\';\nexport function odd(n) {\n  return n !== 0 && even(n - 1);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼even.jséé¢çå½æ°evenæä¸ä¸ªåæ°nï¼åªè¦ä¸ç­äº 0ï¼å°±ä¼åå» 1ï¼ä¼ å¥å è½½çodd()ãodd.jsä¹ä¼åç±»ä¼¼æä½ã\n\nè¿è¡ä¸é¢è¿æ®µä»£ç ï¼ç»æå¦ä¸ã\n\n$ babel-node\n> import * as m from \'./even.js\';\n> m.even(10);\ntrue\n> m.counter\n6\n> m.even(20)\ntrue\n> m.counter\n17\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼åæ°nä» 10 åä¸º 0 çè¿ç¨ä¸­ï¼even()ä¸å±ä¼æ§è¡ 6 æ¬¡ï¼æä»¥åécounterç­äº 6ãç¬¬äºæ¬¡è°ç¨even()æ¶ï¼åæ°nä» 20 åä¸º 0ï¼even()ä¸å±ä¼æ§è¡ 11 æ¬¡ï¼å ä¸åé¢ç 6 æ¬¡ï¼æä»¥åécounterç­äº 17ã\n\nè¿ä¸ªä¾å­è¦æ¯æ¹åæ commonjsï¼å°±æ ¹æ¬æ æ³æ§è¡ï¼ä¼æ¥éã\n\n// even.js\nvar odd = require(\'./odd\');\nvar counter = 0;\nexports.counter = counter;\nexports.even = function (n) {\n  counter++;\n  return n == 0 || odd(n - 1);\n}\n\n// odd.js\nvar even = require(\'./even\').even;\nmodule.exports = function (n) {\n  return n != 0 && even(n - 1);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼even.jså è½½odd.jsï¼èodd.jsåå»å è½½even.jsï¼å½¢æâå¾ªç¯å è½½âãè¿æ¶ï¼æ§è¡å¼æå°±ä¼è¾åºeven.jså·²ç»æ§è¡çé¨åï¼ä¸å­å¨ä»»ä½ç»æï¼ï¼æä»¥å¨odd.jsä¹ä¸­ï¼åéevenç­äºundefinedï¼ç­å°åé¢è°ç¨even(n - 1)å°±ä¼æ¥éã\n\n$ node\n> var m = require(\'./even\');\n> m.even(10)\ntypeerror: even is not a function\n\n\n1\n2\n3\n4\n',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ç¼ç¨é£æ ¼",frontmatter:{title:"ç¼ç¨é£æ ¼",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/984bf549204bb266",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/25.%E7%BC%96%E7%A8%8B%E9%A3%8E%E6%A0%BC.html",relativePath:"ãES6 æç¨ãç¬è®°/25.ç¼ç¨é£æ ¼.md",key:"v-092c0610",path:"/pages/984bf549204bb266/",headers:[{level:2,title:"åçº§ä½ç¨å",slug:"åçº§ä½ç¨å",normalizedTitle:"åçº§ä½ç¨å",charIndex:141},{level:2,title:"å­ç¬¦ä¸²",slug:"å­ç¬¦ä¸²",normalizedTitle:"å­ç¬¦ä¸²",charIndex:1251},{level:2,title:"è§£æèµå¼",slug:"è§£æèµå¼",normalizedTitle:"è§£æèµå¼",charIndex:1465},{level:2,title:"å¯¹è±¡",slug:"å¯¹è±¡",normalizedTitle:"å¯¹è±¡",charIndex:1640},{level:2,title:"æ°ç»",slug:"æ°ç»",normalizedTitle:"æ°ç»",charIndex:1473},{level:2,title:"å½æ°",slug:"å½æ°",normalizedTitle:"å½æ°",charIndex:787},{level:2,title:"Map ç»æ",slug:"map-ç»æ",normalizedTitle:"map ç»æ",charIndex:5039},{level:2,title:"Class",slug:"class",normalizedTitle:"class",charIndex:5384},{level:2,title:"æ¨¡å",slug:"æ¨¡å",normalizedTitle:"æ¨¡å",charIndex:6272},{level:2,title:"ESLint çä½¿ç¨",slug:"eslint-çä½¿ç¨",normalizedTitle:"eslint çä½¿ç¨",charIndex:7372}],excerpt:'<h1 id="ç¼ç¨é£æ ¼"><a class="header-anchor" href="#ç¼ç¨é£æ ¼">#</a> ç¼ç¨é£æ ¼</h1>\n<p>æ¬ç« æ¢è®¨å¦ä½å° ES6 çæ°è¯­æ³ï¼è¿ç¨å°ç¼ç å®è·µä¹ä¸­ï¼ä¸ä¼ ç»ç JavaScript è¯­æ³ç»åå¨ä¸èµ·ï¼ååºåççãæäºéè¯»åç»´æ¤çä»£ç ã</p>\n<p>å¤å®¶å¬å¸åç»ç»å·²ç»å¬å¼äºå®ä»¬çé£æ ¼è§èï¼ä¸é¢çåå®¹ä¸»è¦åèäº <a href="https://github.com/airbnb/javascript" target="_blank" rel="noopener noreferrer">Airbnb<OutboundLink/></a> å¬å¸ç JavaScript é£æ ¼è§èã</p>\n',headersStr:"åçº§ä½ç¨å å­ç¬¦ä¸² è§£æèµå¼ å¯¹è±¡ æ°ç» å½æ° Map ç»æ Class æ¨¡å ESLint çä½¿ç¨",content:"# ç¼ç¨é£æ ¼\n\næ¬ç« æ¢è®¨å¦ä½å° ES6 çæ°è¯­æ³ï¼è¿ç¨å°ç¼ç å®è·µä¹ä¸­ï¼ä¸ä¼ ç»ç JavaScript è¯­æ³ç»åå¨ä¸èµ·ï¼ååºåççãæäºéè¯»åç»´æ¤çä»£ç ã\n\nå¤å®¶å¬å¸åç»ç»å·²ç»å¬å¼äºå®ä»¬çé£æ ¼è§èï¼ä¸é¢çåå®¹ä¸»è¦åèäº Airbnb å¬å¸ç JavaScript é£æ ¼è§èã\n\n\n# åçº§ä½ç¨å\n\nï¼1ï¼let åä»£ var\n\nES6 æåºäºä¸¤ä¸ªæ°çå£°æåéçå½ä»¤ï¼letåconstãå¶ä¸­ï¼letå®å¨å¯ä»¥åä»£varï¼å ä¸ºä¸¤èè¯­ä¹ç¸åï¼èä¸letæ²¡æå¯ä½ç¨ã\n\n'use strict';\n\nif (true) {\n  let x = 'hello';\n}\n\nfor (let i = 0; i < 10; i++) {\n  console.log(i);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç å¦æç¨varæ¿ä»£letï¼å®éä¸å°±å£°æäºä¸¤ä¸ªå¨å±åéï¼è¿æ¾ç¶ä¸æ¯æ¬æãåéåºè¯¥åªå¨å¶å£°æçä»£ç ååææï¼varå½ä»¤åä¸å°è¿ä¸ç¹ã\n\nvarå½ä»¤å­å¨åéæåæç¨ï¼letå½ä»¤æ²¡æè¿ä¸ªé®é¢ã\n\n'use strict';\n\nif (true) {\n  console.log(x); // ReferenceError\n  let x = 'hello';\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç å¦æä½¿ç¨varæ¿ä»£letï¼console.logé£ä¸è¡å°±ä¸ä¼æ¥éï¼èæ¯ä¼è¾åºundefinedï¼å ä¸ºåéå£°ææåå°ä»£ç åçå¤´é¨ãè¿è¿åäºåéåå£°æåä½¿ç¨çååã\n\næä»¥ï¼å»ºè®®ä¸åä½¿ç¨varå½ä»¤ï¼èæ¯ä½¿ç¨letå½ä»¤åä»£ã\n\nï¼2ï¼å¨å±å¸¸éåçº¿ç¨å®å¨\n\nå¨letåconstä¹é´ï¼å»ºè®®ä¼åä½¿ç¨constï¼å°¤å¶æ¯å¨å¨å±ç¯å¢ï¼ä¸åºè¯¥è®¾ç½®åéï¼åªåºè®¾ç½®å¸¸éã\n\nconstä¼äºletæå ä¸ªåå ãä¸ä¸ªæ¯constå¯ä»¥æééè¯»ç¨åºçäººï¼è¿ä¸ªåéä¸åºè¯¥æ¹åï¼å¦ä¸ä¸ªæ¯constæ¯è¾ç¬¦åå½æ°å¼ç¼ç¨ææ³ï¼è¿ç®ä¸æ¹åå¼ï¼åªæ¯æ°å»ºå¼ï¼èä¸è¿æ ·ä¹æå©äºå°æ¥çåå¸å¼è¿ç®ï¼æåä¸ä¸ªåå æ¯ JavaScript ç¼è¯å¨ä¼å¯¹constè¿è¡ä¼åï¼æä»¥å¤ä½¿ç¨constï¼æå©äºæé«ç¨åºçè¿è¡æçï¼ä¹å°±æ¯è¯´letåconstçæ¬è´¨åºå«ï¼å¶å®æ¯ç¼è¯å¨åé¨çå¤çä¸åã\n\n// bad\nvar a = 1, b = 2, c = 3;\n\n// good\nconst a = 1;\nconst b = 2;\nconst c = 3;\n\n// best\nconst [a, b, c] = [1, 2, 3];\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nconstå£°æå¸¸éè¿æä¸¤ä¸ªå¥½å¤ï¼ä¸æ¯éè¯»ä»£ç çäººç«å»ä¼æè¯å°ä¸åºè¯¥ä¿®æ¹è¿ä¸ªå¼ï¼äºæ¯é²æ­¢äºæ æé´ä¿®æ¹åéå¼æå¯¼è´çéè¯¯ã\n\nææçå½æ°é½åºè¯¥è®¾ç½®ä¸ºå¸¸éã\n\né¿è¿æ¥çï¼JavaScript å¯è½ä¼æå¤çº¿ç¨çå®ç°ï¼æ¯å¦ Intel å¬å¸ç River Trail é£ä¸ç±»çé¡¹ç®ï¼ï¼è¿æ¶letè¡¨ç¤ºçåéï¼åªåºåºç°å¨åçº¿ç¨è¿è¡çä»£ç ä¸­ï¼ä¸è½æ¯å¤çº¿ç¨å±äº«çï¼è¿æ ·æå©äºä¿è¯çº¿ç¨å®å¨ã\n\n\n# å­ç¬¦ä¸²\n\néæå­ç¬¦ä¸²ä¸å¾ä½¿ç¨åå¼å·æåå¼å·ï¼ä¸ä½¿ç¨åå¼å·ãå¨æå­ç¬¦ä¸²ä½¿ç¨åå¼å·ã\n\n// bad\nconst a = \"foobar\";\nconst b = 'foo' + a + 'bar';\n\n// acceptable\nconst c = `foobar`;\n\n// good\nconst a = 'foobar';\nconst b = `foo${a}bar`;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# è§£æèµå¼\n\nä½¿ç¨æ°ç»æåå¯¹åéèµå¼æ¶ï¼ä¼åä½¿ç¨è§£æèµå¼ã\n\nconst arr = [1, 2, 3, 4];\n\n// bad\nconst first = arr[0];\nconst second = arr[1];\n\n// good\nconst [first, second] = arr;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå½æ°çåæ°å¦ææ¯å¯¹è±¡çæåï¼ä¼åä½¿ç¨è§£æèµå¼ã\n\n// bad\nfunction getFullName(user) {\n  const firstName = user.firstName;\n  const lastName = user.lastName;\n}\n\n// good\nfunction getFullName(obj) {\n  const { firstName, lastName } = obj;\n}\n\n// best\nfunction getFullName({ firstName, lastName }) {\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nå¦æå½æ°è¿åå¤ä¸ªå¼ï¼ä¼åä½¿ç¨å¯¹è±¡çè§£æèµå¼ï¼èä¸æ¯æ°ç»çè§£æèµå¼ãè¿æ ·ä¾¿äºä»¥åæ·»å è¿åå¼ï¼ä»¥åæ´æ¹è¿åå¼çé¡ºåºã\n\n// bad\nfunction processInput(input) {\n  return [left, right, top, bottom];\n}\n\n// good\nfunction processInput(input) {\n  return { left, right, top, bottom };\n}\n\nconst { left, right } = processInput(input);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# å¯¹è±¡\n\nåè¡å®ä¹çå¯¹è±¡ï¼æåä¸ä¸ªæåä¸ä»¥éå·ç»å°¾ãå¤è¡å®ä¹çå¯¹è±¡ï¼æåä¸ä¸ªæåä»¥éå·ç»å°¾ã\n\n// bad\nconst a = { k1: v1, k2: v2, };\nconst b = {\n  k1: v1,\n  k2: v2\n};\n\n// good\nconst a = { k1: v1, k2: v2 };\nconst b = {\n  k1: v1,\n  k2: v2,\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nå¯¹è±¡å°½ééæåï¼ä¸æ¦å®ä¹ï¼å°±ä¸å¾éææ·»å æ°çå±æ§ãå¦ææ·»å å±æ§ä¸å¯é¿åï¼è¦ä½¿ç¨Object.assignæ¹æ³ã\n\n// bad\nconst a = {};\na.x = 3;\n\n// if reshape unavoidable\nconst a = {};\nObject.assign(a, { x: 3 });\n\n// good\nconst a = { x: null };\na.x = 3;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¦æå¯¹è±¡çå±æ§åæ¯å¨æçï¼å¯ä»¥å¨åé å¯¹è±¡çæ¶åï¼ä½¿ç¨å±æ§è¡¨è¾¾å¼å®ä¹ã\n\n// bad\nconst obj = {\n  id: 5,\n  name: 'San Francisco',\n};\nobj[getKey('enabled')] = true;\n\n// good\nconst obj = {\n  id: 5,\n  name: 'San Francisco',\n  [getKey('enabled')]: true,\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯¹è±¡objçæåä¸ä¸ªå±æ§åï¼éè¦è®¡ç®å¾å°ãè¿æ¶æå¥½éç¨å±æ§è¡¨è¾¾å¼ï¼å¨æ°å»ºobjçæ¶åï¼å°è¯¥å±æ§ä¸å¶ä»å±æ§å®ä¹å¨ä¸èµ·ãè¿æ ·ä¸æ¥ï¼ææå±æ§å°±å¨ä¸ä¸ªå°æ¹å®ä¹äºã\n\nå¦å¤ï¼å¯¹è±¡çå±æ§åæ¹æ³ï¼å°½ééç¨ç®æ´è¡¨è¾¾æ³ï¼è¿æ ·æäºæè¿°åä¹¦åã\n\nvar ref = 'some value';\n\n// bad\nconst atom = {\n  ref: ref,\n\n  value: 1,\n\n  addValue: function (value) {\n    return atom.value + value;\n  },\n};\n\n// good\nconst atom = {\n  ref,\n\n  value: 1,\n\n  addValue(value) {\n    return atom.value + value;\n  },\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\n\n# æ°ç»\n\nä½¿ç¨æ©å±è¿ç®ç¬¦ï¼...ï¼æ·è´æ°ç»ã\n\n// bad\nconst len = items.length;\nconst itemsCopy = [];\nlet i;\n\nfor (i = 0; i < len; i++) {\n  itemsCopy[i] = items[i];\n}\n\n// good\nconst itemsCopy = [...items];\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä½¿ç¨ Array.from æ¹æ³ï¼å°ç±»ä¼¼æ°ç»çå¯¹è±¡è½¬ä¸ºæ°ç»ã\n\nconst foo = document.querySelectorAll('.foo');\nconst nodes = Array.from(foo);\n\n\n1\n2\n\n\n\n# å½æ°\n\nç«å³æ§è¡å½æ°å¯ä»¥åæç®­å¤´å½æ°çå½¢å¼ã\n\n(() => {\n  console.log('Welcome to the Internet.');\n})();\n\n\n1\n2\n3\n\n\né£äºä½¿ç¨å¿åå½æ°å½ä½åæ°çåºåï¼å°½éç¨ç®­å¤´å½æ°ä»£æ¿ãå ä¸ºè¿æ ·æ´ç®æ´ï¼èä¸ç»å®äº thisã\n\n// bad\n[1, 2, 3].map(function (x) {\n  return x * x;\n});\n\n// good\n[1, 2, 3].map((x) => {\n  return x * x;\n});\n\n// best\n[1, 2, 3].map(x => x * x);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nç®­å¤´å½æ°åä»£Function.prototype.bindï¼ä¸åºåç¨ self/_this/that ç»å® thisã\n\n// bad\nconst self = this;\nconst boundMethod = function(...params) {\n  return method.apply(self, params);\n}\n\n// acceptable\nconst boundMethod = method.bind(this);\n\n// best\nconst boundMethod = (...params) => method.apply(this, params);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nç®åçãåè¡çãä¸ä¼å¤ç¨çå½æ°ï¼å»ºè®®éç¨ç®­å¤´å½æ°ãå¦æå½æ°ä½è¾ä¸ºå¤æï¼è¡æ°è¾å¤ï¼è¿æ¯åºè¯¥éç¨ä¼ ç»çå½æ°åæ³ã\n\nææéç½®é¡¹é½åºè¯¥éä¸­å¨ä¸ä¸ªå¯¹è±¡ï¼æ¾å¨æåä¸ä¸ªåæ°ï¼å¸å°å¼ä¸å¯ä»¥ç´æ¥ä½ä¸ºåæ°ã\n\n// bad\nfunction divide(a, b, option = false ) {\n}\n\n// good\nfunction divide(a, b, { option = false } = {}) {\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸è¦å¨å½æ°ä½åä½¿ç¨ arguments åéï¼ä½¿ç¨ rest è¿ç®ç¬¦ï¼...ï¼ä»£æ¿ãå ä¸º rest è¿ç®ç¬¦æ¾å¼è¡¨æä½ æ³è¦è·ååæ°ï¼èä¸ arguments æ¯ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ï¼è rest è¿ç®ç¬¦å¯ä»¥æä¾ä¸ä¸ªçæ­£çæ°ç»ã\n\n// bad\nfunction concatenateAll() {\n  const args = Array.prototype.slice.call(arguments);\n  return args.join('');\n}\n\n// good\nfunction concatenateAll(...args) {\n  return args.join('');\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä½¿ç¨é»è®¤å¼è¯­æ³è®¾ç½®å½æ°åæ°çé»è®¤å¼ã\n\n// bad\nfunction handleThings(opts) {\n  opts = opts || {};\n}\n\n// good\nfunction handleThings(opts = {}) {\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# Map ç»æ\n\næ³¨æåºå Object å Mapï¼åªææ¨¡æç°å®ä¸ççå®ä½å¯¹è±¡æ¶ï¼æä½¿ç¨ Objectãå¦æåªæ¯éè¦key: valueçæ°æ®ç»æï¼ä½¿ç¨ Map ç»æãå ä¸º Map æåå»ºçéåæºå¶ã\n\nlet map = new Map(arr);\n\nfor (let key of map.keys()) {\n  console.log(key);\n}\n\nfor (let value of map.values()) {\n  console.log(value);\n}\n\nfor (let item of map.entries()) {\n  console.log(item[0], item[1]);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# Class\n\næ»æ¯ç¨ Classï¼åä»£éè¦ prototype çæä½ãå ä¸º Class çåæ³æ´ç®æ´ï¼æ´æäºçè§£ã\n\n// bad\nfunction Queue(contents = []) {\n  this._queue = [...contents];\n}\nQueue.prototype.pop = function() {\n  const value = this._queue[0];\n  this._queue.splice(0, 1);\n  return value;\n}\n\n// good\nclass Queue {\n  constructor(contents = []) {\n    this._queue = [...contents];\n  }\n  pop() {\n    const value = this._queue[0];\n    this._queue.splice(0, 1);\n    return value;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nä½¿ç¨extendså®ç°ç»§æ¿ï¼å ä¸ºè¿æ ·æ´ç®åï¼ä¸ä¼æç ´åinstanceofè¿ç®çå±é©ã\n\n// bad\nconst inherits = require('inherits');\nfunction PeekableQueue(contents) {\n  Queue.apply(this, contents);\n}\ninherits(PeekableQueue, Queue);\nPeekableQueue.prototype.peek = function() {\n  return this._queue[0];\n}\n\n// good\nclass PeekableQueue extends Queue {\n  peek() {\n    return this._queue[0];\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n# æ¨¡å\n\né¦åï¼Module è¯­æ³æ¯ JavaScript æ¨¡åçæ ååæ³ï¼åæä½¿ç¨è¿ç§åæ³ãä½¿ç¨importåä»£requireã\n\n// bad\nconst moduleA = require('moduleA');\nconst func1 = moduleA.func1;\nconst func2 = moduleA.func2;\n\n// good\nimport { func1, func2 } from 'moduleA';\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä½¿ç¨exportåä»£module.exportsã\n\n// commonJSçåæ³\nvar React = require('react');\n\nvar Breadcrumbs = React.createClass({\n  render() {\n    return <nav />;\n  }\n});\n\nmodule.exports = Breadcrumbs;\n\n// ES6çåæ³\nimport React from 'react';\n\nclass Breadcrumbs extends React.Component {\n  render() {\n    return <nav />;\n  }\n};\n\nexport default Breadcrumbs;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nå¦ææ¨¡ååªæä¸ä¸ªè¾åºå¼ï¼å°±ä½¿ç¨export defaultï¼å¦ææ¨¡åæå¤ä¸ªè¾åºå¼ï¼å°±ä¸ä½¿ç¨export defaultï¼export defaultä¸æ®éçexportä¸è¦åæ¶ä½¿ç¨ã\n\nä¸è¦å¨æ¨¡åè¾å¥ä¸­ä½¿ç¨ééç¬¦ãå ä¸ºè¿æ ·å¯ä»¥ç¡®ä¿ä½ çæ¨¡åä¹ä¸­ï¼æä¸ä¸ªé»è®¤è¾åºï¼export defaultï¼ã\n\n// bad\nimport * as myObject from './importModule';\n\n// good\nimport myObject from './importModule';\n\n\n1\n2\n3\n4\n5\n\n\nå¦ææ¨¡åé»è®¤è¾åºä¸ä¸ªå½æ°ï¼å½æ°åçé¦å­æ¯åºè¯¥å°åã\n\nfunction makeStyleGuide() {\n}\n\nexport default makeStyleGuide;\n\n\n1\n2\n3\n4\n\n\nå¦ææ¨¡åé»è®¤è¾åºä¸ä¸ªå¯¹è±¡ï¼å¯¹è±¡åçé¦å­æ¯åºè¯¥å¤§åã\n\nconst StyleGuide = {\n  es6: {\n  }\n};\n\nexport default StyleGuide;\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# ESLint çä½¿ç¨\n\nESLint æ¯ä¸ä¸ªè¯­æ³è§ååä»£ç é£æ ¼çæ£æ¥å·¥å·ï¼å¯ä»¥ç¨æ¥ä¿è¯ååºè¯­æ³æ­£ç¡®ãé£æ ¼ç»ä¸çä»£ç ã\n\né¦åï¼å®è£ ESLintã\n\n$ npm i -g eslint\n\n\n1\n\n\nç¶åï¼å®è£ Airbnb è¯­æ³è§åï¼ä»¥å importãa11yãreact æä»¶ã\n\n$ npm i -g eslint-config-airbnb\n$ npm i -g eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react\n\n\n1\n2\n\n\næåï¼å¨é¡¹ç®çæ ¹ç®å½ä¸æ°å»ºä¸ä¸ª.eslintrcæä»¶ï¼éç½® ESLintã\n\n{\n  \"extends\": \"eslint-config-airbnb\"\n}\n\n\n1\n2\n3\n\n\nç°å¨å°±å¯ä»¥æ£æ¥ï¼å½åé¡¹ç®çä»£ç æ¯å¦ç¬¦åé¢è®¾çè§åã\n\nindex.jsæä»¶çä»£ç å¦ä¸ã\n\nvar unusued = 'I have no purpose!';\n\nfunction greet() {\n    var message = 'Hello, World!';\n    alert(message);\n}\n\ngreet();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä½¿ç¨ ESLint æ£æ¥è¿ä¸ªæä»¶ï¼å°±ä¼æ¥åºéè¯¯ã\n\n$ eslint index.js\nindex.js\n  1:1  error  Unexpected var, use let or const instead          no-var\n  1:5  error  unusued is defined but never used                 no-unused-vars\n  4:5  error  Expected indentation of 2 characters but found 4  indent\n  4:5  error  Unexpected var, use let or const instead          no-var\n  5:5  error  Expected indentation of 2 characters but found 4  indent\n\nâ 5 problems (5 errors, 0 warnings)\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç è¯´æï¼åæä»¶æäºä¸ªéè¯¯ï¼å¶ä¸­ä¸¤ä¸ªæ¯ä¸åºè¯¥ä½¿ç¨varå½ä»¤ï¼èè¦ä½¿ç¨letæconstï¼ä¸ä¸ªæ¯å®ä¹äºåéï¼å´æ²¡æä½¿ç¨ï¼å¦å¤ä¸¤ä¸ªæ¯è¡é¦ç¼©è¿ä¸º 4 ä¸ªç©ºæ ¼ï¼èä¸æ¯è§å®ç 2 ä¸ªç©ºæ ¼ã",normalizedContent:"# ç¼ç¨é£æ ¼\n\næ¬ç« æ¢è®¨å¦ä½å° es6 çæ°è¯­æ³ï¼è¿ç¨å°ç¼ç å®è·µä¹ä¸­ï¼ä¸ä¼ ç»ç javascript è¯­æ³ç»åå¨ä¸èµ·ï¼ååºåççãæäºéè¯»åç»´æ¤çä»£ç ã\n\nå¤å®¶å¬å¸åç»ç»å·²ç»å¬å¼äºå®ä»¬çé£æ ¼è§èï¼ä¸é¢çåå®¹ä¸»è¦åèäº airbnb å¬å¸ç javascript é£æ ¼è§èã\n\n\n# åçº§ä½ç¨å\n\nï¼1ï¼let åä»£ var\n\nes6 æåºäºä¸¤ä¸ªæ°çå£°æåéçå½ä»¤ï¼letåconstãå¶ä¸­ï¼letå®å¨å¯ä»¥åä»£varï¼å ä¸ºä¸¤èè¯­ä¹ç¸åï¼èä¸letæ²¡æå¯ä½ç¨ã\n\n'use strict';\n\nif (true) {\n  let x = 'hello';\n}\n\nfor (let i = 0; i < 10; i++) {\n  console.log(i);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç å¦æç¨varæ¿ä»£letï¼å®éä¸å°±å£°æäºä¸¤ä¸ªå¨å±åéï¼è¿æ¾ç¶ä¸æ¯æ¬æãåéåºè¯¥åªå¨å¶å£°æçä»£ç ååææï¼varå½ä»¤åä¸å°è¿ä¸ç¹ã\n\nvarå½ä»¤å­å¨åéæåæç¨ï¼letå½ä»¤æ²¡æè¿ä¸ªé®é¢ã\n\n'use strict';\n\nif (true) {\n  console.log(x); // referenceerror\n  let x = 'hello';\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç å¦æä½¿ç¨varæ¿ä»£letï¼console.logé£ä¸è¡å°±ä¸ä¼æ¥éï¼èæ¯ä¼è¾åºundefinedï¼å ä¸ºåéå£°ææåå°ä»£ç åçå¤´é¨ãè¿è¿åäºåéåå£°æåä½¿ç¨çååã\n\næä»¥ï¼å»ºè®®ä¸åä½¿ç¨varå½ä»¤ï¼èæ¯ä½¿ç¨letå½ä»¤åä»£ã\n\nï¼2ï¼å¨å±å¸¸éåçº¿ç¨å®å¨\n\nå¨letåconstä¹é´ï¼å»ºè®®ä¼åä½¿ç¨constï¼å°¤å¶æ¯å¨å¨å±ç¯å¢ï¼ä¸åºè¯¥è®¾ç½®åéï¼åªåºè®¾ç½®å¸¸éã\n\nconstä¼äºletæå ä¸ªåå ãä¸ä¸ªæ¯constå¯ä»¥æééè¯»ç¨åºçäººï¼è¿ä¸ªåéä¸åºè¯¥æ¹åï¼å¦ä¸ä¸ªæ¯constæ¯è¾ç¬¦åå½æ°å¼ç¼ç¨ææ³ï¼è¿ç®ä¸æ¹åå¼ï¼åªæ¯æ°å»ºå¼ï¼èä¸è¿æ ·ä¹æå©äºå°æ¥çåå¸å¼è¿ç®ï¼æåä¸ä¸ªåå æ¯ javascript ç¼è¯å¨ä¼å¯¹constè¿è¡ä¼åï¼æä»¥å¤ä½¿ç¨constï¼æå©äºæé«ç¨åºçè¿è¡æçï¼ä¹å°±æ¯è¯´letåconstçæ¬è´¨åºå«ï¼å¶å®æ¯ç¼è¯å¨åé¨çå¤çä¸åã\n\n// bad\nvar a = 1, b = 2, c = 3;\n\n// good\nconst a = 1;\nconst b = 2;\nconst c = 3;\n\n// best\nconst [a, b, c] = [1, 2, 3];\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nconstå£°æå¸¸éè¿æä¸¤ä¸ªå¥½å¤ï¼ä¸æ¯éè¯»ä»£ç çäººç«å»ä¼æè¯å°ä¸åºè¯¥ä¿®æ¹è¿ä¸ªå¼ï¼äºæ¯é²æ­¢äºæ æé´ä¿®æ¹åéå¼æå¯¼è´çéè¯¯ã\n\nææçå½æ°é½åºè¯¥è®¾ç½®ä¸ºå¸¸éã\n\né¿è¿æ¥çï¼javascript å¯è½ä¼æå¤çº¿ç¨çå®ç°ï¼æ¯å¦ intel å¬å¸ç river trail é£ä¸ç±»çé¡¹ç®ï¼ï¼è¿æ¶letè¡¨ç¤ºçåéï¼åªåºåºç°å¨åçº¿ç¨è¿è¡çä»£ç ä¸­ï¼ä¸è½æ¯å¤çº¿ç¨å±äº«çï¼è¿æ ·æå©äºä¿è¯çº¿ç¨å®å¨ã\n\n\n# å­ç¬¦ä¸²\n\néæå­ç¬¦ä¸²ä¸å¾ä½¿ç¨åå¼å·æåå¼å·ï¼ä¸ä½¿ç¨åå¼å·ãå¨æå­ç¬¦ä¸²ä½¿ç¨åå¼å·ã\n\n// bad\nconst a = \"foobar\";\nconst b = 'foo' + a + 'bar';\n\n// acceptable\nconst c = `foobar`;\n\n// good\nconst a = 'foobar';\nconst b = `foo${a}bar`;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# è§£æèµå¼\n\nä½¿ç¨æ°ç»æåå¯¹åéèµå¼æ¶ï¼ä¼åä½¿ç¨è§£æèµå¼ã\n\nconst arr = [1, 2, 3, 4];\n\n// bad\nconst first = arr[0];\nconst second = arr[1];\n\n// good\nconst [first, second] = arr;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå½æ°çåæ°å¦ææ¯å¯¹è±¡çæåï¼ä¼åä½¿ç¨è§£æèµå¼ã\n\n// bad\nfunction getfullname(user) {\n  const firstname = user.firstname;\n  const lastname = user.lastname;\n}\n\n// good\nfunction getfullname(obj) {\n  const { firstname, lastname } = obj;\n}\n\n// best\nfunction getfullname({ firstname, lastname }) {\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nå¦æå½æ°è¿åå¤ä¸ªå¼ï¼ä¼åä½¿ç¨å¯¹è±¡çè§£æèµå¼ï¼èä¸æ¯æ°ç»çè§£æèµå¼ãè¿æ ·ä¾¿äºä»¥åæ·»å è¿åå¼ï¼ä»¥åæ´æ¹è¿åå¼çé¡ºåºã\n\n// bad\nfunction processinput(input) {\n  return [left, right, top, bottom];\n}\n\n// good\nfunction processinput(input) {\n  return { left, right, top, bottom };\n}\n\nconst { left, right } = processinput(input);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# å¯¹è±¡\n\nåè¡å®ä¹çå¯¹è±¡ï¼æåä¸ä¸ªæåä¸ä»¥éå·ç»å°¾ãå¤è¡å®ä¹çå¯¹è±¡ï¼æåä¸ä¸ªæåä»¥éå·ç»å°¾ã\n\n// bad\nconst a = { k1: v1, k2: v2, };\nconst b = {\n  k1: v1,\n  k2: v2\n};\n\n// good\nconst a = { k1: v1, k2: v2 };\nconst b = {\n  k1: v1,\n  k2: v2,\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nå¯¹è±¡å°½ééæåï¼ä¸æ¦å®ä¹ï¼å°±ä¸å¾éææ·»å æ°çå±æ§ãå¦ææ·»å å±æ§ä¸å¯é¿åï¼è¦ä½¿ç¨object.assignæ¹æ³ã\n\n// bad\nconst a = {};\na.x = 3;\n\n// if reshape unavoidable\nconst a = {};\nobject.assign(a, { x: 3 });\n\n// good\nconst a = { x: null };\na.x = 3;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¦æå¯¹è±¡çå±æ§åæ¯å¨æçï¼å¯ä»¥å¨åé å¯¹è±¡çæ¶åï¼ä½¿ç¨å±æ§è¡¨è¾¾å¼å®ä¹ã\n\n// bad\nconst obj = {\n  id: 5,\n  name: 'san francisco',\n};\nobj[getkey('enabled')] = true;\n\n// good\nconst obj = {\n  id: 5,\n  name: 'san francisco',\n  [getkey('enabled')]: true,\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯¹è±¡objçæåä¸ä¸ªå±æ§åï¼éè¦è®¡ç®å¾å°ãè¿æ¶æå¥½éç¨å±æ§è¡¨è¾¾å¼ï¼å¨æ°å»ºobjçæ¶åï¼å°è¯¥å±æ§ä¸å¶ä»å±æ§å®ä¹å¨ä¸èµ·ãè¿æ ·ä¸æ¥ï¼ææå±æ§å°±å¨ä¸ä¸ªå°æ¹å®ä¹äºã\n\nå¦å¤ï¼å¯¹è±¡çå±æ§åæ¹æ³ï¼å°½ééç¨ç®æ´è¡¨è¾¾æ³ï¼è¿æ ·æäºæè¿°åä¹¦åã\n\nvar ref = 'some value';\n\n// bad\nconst atom = {\n  ref: ref,\n\n  value: 1,\n\n  addvalue: function (value) {\n    return atom.value + value;\n  },\n};\n\n// good\nconst atom = {\n  ref,\n\n  value: 1,\n\n  addvalue(value) {\n    return atom.value + value;\n  },\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\n\n# æ°ç»\n\nä½¿ç¨æ©å±è¿ç®ç¬¦ï¼...ï¼æ·è´æ°ç»ã\n\n// bad\nconst len = items.length;\nconst itemscopy = [];\nlet i;\n\nfor (i = 0; i < len; i++) {\n  itemscopy[i] = items[i];\n}\n\n// good\nconst itemscopy = [...items];\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä½¿ç¨ array.from æ¹æ³ï¼å°ç±»ä¼¼æ°ç»çå¯¹è±¡è½¬ä¸ºæ°ç»ã\n\nconst foo = document.queryselectorall('.foo');\nconst nodes = array.from(foo);\n\n\n1\n2\n\n\n\n# å½æ°\n\nç«å³æ§è¡å½æ°å¯ä»¥åæç®­å¤´å½æ°çå½¢å¼ã\n\n(() => {\n  console.log('welcome to the internet.');\n})();\n\n\n1\n2\n3\n\n\né£äºä½¿ç¨å¿åå½æ°å½ä½åæ°çåºåï¼å°½éç¨ç®­å¤´å½æ°ä»£æ¿ãå ä¸ºè¿æ ·æ´ç®æ´ï¼èä¸ç»å®äº thisã\n\n// bad\n[1, 2, 3].map(function (x) {\n  return x * x;\n});\n\n// good\n[1, 2, 3].map((x) => {\n  return x * x;\n});\n\n// best\n[1, 2, 3].map(x => x * x);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nç®­å¤´å½æ°åä»£function.prototype.bindï¼ä¸åºåç¨ self/_this/that ç»å® thisã\n\n// bad\nconst self = this;\nconst boundmethod = function(...params) {\n  return method.apply(self, params);\n}\n\n// acceptable\nconst boundmethod = method.bind(this);\n\n// best\nconst boundmethod = (...params) => method.apply(this, params);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nç®åçãåè¡çãä¸ä¼å¤ç¨çå½æ°ï¼å»ºè®®éç¨ç®­å¤´å½æ°ãå¦æå½æ°ä½è¾ä¸ºå¤æï¼è¡æ°è¾å¤ï¼è¿æ¯åºè¯¥éç¨ä¼ ç»çå½æ°åæ³ã\n\nææéç½®é¡¹é½åºè¯¥éä¸­å¨ä¸ä¸ªå¯¹è±¡ï¼æ¾å¨æåä¸ä¸ªåæ°ï¼å¸å°å¼ä¸å¯ä»¥ç´æ¥ä½ä¸ºåæ°ã\n\n// bad\nfunction divide(a, b, option = false ) {\n}\n\n// good\nfunction divide(a, b, { option = false } = {}) {\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸è¦å¨å½æ°ä½åä½¿ç¨ arguments åéï¼ä½¿ç¨ rest è¿ç®ç¬¦ï¼...ï¼ä»£æ¿ãå ä¸º rest è¿ç®ç¬¦æ¾å¼è¡¨æä½ æ³è¦è·ååæ°ï¼èä¸ arguments æ¯ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ï¼è rest è¿ç®ç¬¦å¯ä»¥æä¾ä¸ä¸ªçæ­£çæ°ç»ã\n\n// bad\nfunction concatenateall() {\n  const args = array.prototype.slice.call(arguments);\n  return args.join('');\n}\n\n// good\nfunction concatenateall(...args) {\n  return args.join('');\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä½¿ç¨é»è®¤å¼è¯­æ³è®¾ç½®å½æ°åæ°çé»è®¤å¼ã\n\n// bad\nfunction handlethings(opts) {\n  opts = opts || {};\n}\n\n// good\nfunction handlethings(opts = {}) {\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# map ç»æ\n\næ³¨æåºå object å mapï¼åªææ¨¡æç°å®ä¸ççå®ä½å¯¹è±¡æ¶ï¼æä½¿ç¨ objectãå¦æåªæ¯éè¦key: valueçæ°æ®ç»æï¼ä½¿ç¨ map ç»æãå ä¸º map æåå»ºçéåæºå¶ã\n\nlet map = new map(arr);\n\nfor (let key of map.keys()) {\n  console.log(key);\n}\n\nfor (let value of map.values()) {\n  console.log(value);\n}\n\nfor (let item of map.entries()) {\n  console.log(item[0], item[1]);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# class\n\næ»æ¯ç¨ classï¼åä»£éè¦ prototype çæä½ãå ä¸º class çåæ³æ´ç®æ´ï¼æ´æäºçè§£ã\n\n// bad\nfunction queue(contents = []) {\n  this._queue = [...contents];\n}\nqueue.prototype.pop = function() {\n  const value = this._queue[0];\n  this._queue.splice(0, 1);\n  return value;\n}\n\n// good\nclass queue {\n  constructor(contents = []) {\n    this._queue = [...contents];\n  }\n  pop() {\n    const value = this._queue[0];\n    this._queue.splice(0, 1);\n    return value;\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nä½¿ç¨extendså®ç°ç»§æ¿ï¼å ä¸ºè¿æ ·æ´ç®åï¼ä¸ä¼æç ´åinstanceofè¿ç®çå±é©ã\n\n// bad\nconst inherits = require('inherits');\nfunction peekablequeue(contents) {\n  queue.apply(this, contents);\n}\ninherits(peekablequeue, queue);\npeekablequeue.prototype.peek = function() {\n  return this._queue[0];\n}\n\n// good\nclass peekablequeue extends queue {\n  peek() {\n    return this._queue[0];\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n# æ¨¡å\n\né¦åï¼module è¯­æ³æ¯ javascript æ¨¡åçæ ååæ³ï¼åæä½¿ç¨è¿ç§åæ³ãä½¿ç¨importåä»£requireã\n\n// bad\nconst modulea = require('modulea');\nconst func1 = modulea.func1;\nconst func2 = modulea.func2;\n\n// good\nimport { func1, func2 } from 'modulea';\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä½¿ç¨exportåä»£module.exportsã\n\n// commonjsçåæ³\nvar react = require('react');\n\nvar breadcrumbs = react.createclass({\n  render() {\n    return <nav />;\n  }\n});\n\nmodule.exports = breadcrumbs;\n\n// es6çåæ³\nimport react from 'react';\n\nclass breadcrumbs extends react.component {\n  render() {\n    return <nav />;\n  }\n};\n\nexport default breadcrumbs;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nå¦ææ¨¡ååªæä¸ä¸ªè¾åºå¼ï¼å°±ä½¿ç¨export defaultï¼å¦ææ¨¡åæå¤ä¸ªè¾åºå¼ï¼å°±ä¸ä½¿ç¨export defaultï¼export defaultä¸æ®éçexportä¸è¦åæ¶ä½¿ç¨ã\n\nä¸è¦å¨æ¨¡åè¾å¥ä¸­ä½¿ç¨ééç¬¦ãå ä¸ºè¿æ ·å¯ä»¥ç¡®ä¿ä½ çæ¨¡åä¹ä¸­ï¼æä¸ä¸ªé»è®¤è¾åºï¼export defaultï¼ã\n\n// bad\nimport * as myobject from './importmodule';\n\n// good\nimport myobject from './importmodule';\n\n\n1\n2\n3\n4\n5\n\n\nå¦ææ¨¡åé»è®¤è¾åºä¸ä¸ªå½æ°ï¼å½æ°åçé¦å­æ¯åºè¯¥å°åã\n\nfunction makestyleguide() {\n}\n\nexport default makestyleguide;\n\n\n1\n2\n3\n4\n\n\nå¦ææ¨¡åé»è®¤è¾åºä¸ä¸ªå¯¹è±¡ï¼å¯¹è±¡åçé¦å­æ¯åºè¯¥å¤§åã\n\nconst styleguide = {\n  es6: {\n  }\n};\n\nexport default styleguide;\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# eslint çä½¿ç¨\n\neslint æ¯ä¸ä¸ªè¯­æ³è§ååä»£ç é£æ ¼çæ£æ¥å·¥å·ï¼å¯ä»¥ç¨æ¥ä¿è¯ååºè¯­æ³æ­£ç¡®ãé£æ ¼ç»ä¸çä»£ç ã\n\né¦åï¼å®è£ eslintã\n\n$ npm i -g eslint\n\n\n1\n\n\nç¶åï¼å®è£ airbnb è¯­æ³è§åï¼ä»¥å importãa11yãreact æä»¶ã\n\n$ npm i -g eslint-config-airbnb\n$ npm i -g eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react\n\n\n1\n2\n\n\næåï¼å¨é¡¹ç®çæ ¹ç®å½ä¸æ°å»ºä¸ä¸ª.eslintrcæä»¶ï¼éç½® eslintã\n\n{\n  \"extends\": \"eslint-config-airbnb\"\n}\n\n\n1\n2\n3\n\n\nç°å¨å°±å¯ä»¥æ£æ¥ï¼å½åé¡¹ç®çä»£ç æ¯å¦ç¬¦åé¢è®¾çè§åã\n\nindex.jsæä»¶çä»£ç å¦ä¸ã\n\nvar unusued = 'i have no purpose!';\n\nfunction greet() {\n    var message = 'hello, world!';\n    alert(message);\n}\n\ngreet();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä½¿ç¨ eslint æ£æ¥è¿ä¸ªæä»¶ï¼å°±ä¼æ¥åºéè¯¯ã\n\n$ eslint index.js\nindex.js\n  1:1  error  unexpected var, use let or const instead          no-var\n  1:5  error  unusued is defined but never used                 no-unused-vars\n  4:5  error  expected indentation of 2 characters but found 4  indent\n  4:5  error  unexpected var, use let or const instead          no-var\n  5:5  error  expected indentation of 2 characters but found 4  indent\n\nâ 5 problems (5 errors, 0 warnings)\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç è¯´æï¼åæä»¶æäºä¸ªéè¯¯ï¼å¶ä¸­ä¸¤ä¸ªæ¯ä¸åºè¯¥ä½¿ç¨varå½ä»¤ï¼èè¦ä½¿ç¨letæconstï¼ä¸ä¸ªæ¯å®ä¹äºåéï¼å´æ²¡æä½¿ç¨ï¼å¦å¤ä¸¤ä¸ªæ¯è¡é¦ç¼©è¿ä¸º 4 ä¸ªç©ºæ ¼ï¼èä¸æ¯è§å®ç 2 ä¸ªç©ºæ ¼ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"å¼æ­¥éåå¨",frontmatter:{title:"å¼æ­¥éåå¨",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/16121351be68691b",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/27.%E5%BC%82%E6%AD%A5%E9%81%8D%E5%8E%86%E5%99%A8.html",relativePath:"ãES6 æç¨ãç¬è®°/27.å¼æ­¥éåå¨.md",key:"v-31cb3fe6",path:"/pages/16121351be68691b/",headers:[{level:2,title:"åæ­¥éåå¨çé®é¢",slug:"åæ­¥éåå¨çé®é¢",normalizedTitle:"åæ­¥éåå¨çé®é¢",charIndex:12},{level:2,title:"å¼æ­¥éåçæ¥å£",slug:"å¼æ­¥éåçæ¥å£",normalizedTitle:"å¼æ­¥éåçæ¥å£",charIndex:1708},{level:2,title:"for await...of",slug:"for-await-of",normalizedTitle:"for await...of",charIndex:3920},{level:2,title:"å¼æ­¥ Generator å½æ°",slug:"å¼æ­¥-generator-å½æ°",normalizedTitle:"å¼æ­¥ generator å½æ°",charIndex:5704},{level:2,title:"yield* è¯­å¥",slug:"yield-è¯­å¥",normalizedTitle:"yield* è¯­å¥",charIndex:10679}],excerpt:'<h1 id="å¼æ­¥éåå¨"><a class="header-anchor" href="#å¼æ­¥éåå¨">#</a> å¼æ­¥éåå¨</h1>\n<h2 id="åæ­¥éåå¨çé®é¢"><a class="header-anchor" href="#åæ­¥éåå¨çé®é¢">#</a> åæ­¥éåå¨çé®é¢</h2>\n<p>ãéåå¨ãä¸ç« è¯´è¿ï¼Iterator æ¥å£æ¯ä¸ç§æ°æ®éåçåè®®ï¼åªè¦è°ç¨éåå¨å¯¹è±¡ç<code>next</code>æ¹æ³ï¼å°±ä¼å¾å°ä¸ä¸ªå¯¹è±¡ï¼è¡¨ç¤ºå½åéåæéæå¨çé£ä¸ªä½ç½®çä¿¡æ¯ã<code>next</code>æ¹æ³è¿åçå¯¹è±¡çç»ææ¯<code>{value, done}</code>ï¼å¶ä¸­<code>value</code>è¡¨ç¤ºå½åçæ°æ®çå¼ï¼<code>done</code>æ¯ä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºéåæ¯å¦ç»æã</p>\n',headersStr:"åæ­¥éåå¨çé®é¢ å¼æ­¥éåçæ¥å£ for await...of å¼æ­¥ Generator å½æ° yield* è¯­å¥",content:"# å¼æ­¥éåå¨\n\n\n# åæ­¥éåå¨çé®é¢\n\nãéåå¨ãä¸ç« è¯´è¿ï¼Iterator æ¥å£æ¯ä¸ç§æ°æ®éåçåè®®ï¼åªè¦è°ç¨éåå¨å¯¹è±¡çnextæ¹æ³ï¼å°±ä¼å¾å°ä¸ä¸ªå¯¹è±¡ï¼è¡¨ç¤ºå½åéåæéæå¨çé£ä¸ªä½ç½®çä¿¡æ¯ãnextæ¹æ³è¿åçå¯¹è±¡çç»ææ¯{value, done}ï¼å¶ä¸­valueè¡¨ç¤ºå½åçæ°æ®çå¼ï¼doneæ¯ä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºéåæ¯å¦ç»æã\n\nfunction idMaker() {\n  let index = 0;\n\n  return {\n    next: function() {\n      return { value: index++, done: false };\n    }\n  };\n}\n\nconst it = idMaker();\n\nit.next().value // 0\nit.next().value // 1\nit.next().value // 2\n// ...\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼åéitæ¯ä¸ä¸ªéåå¨ï¼iteratorï¼ãæ¯æ¬¡è°ç¨it.next()æ¹æ³ï¼å°±è¿åä¸ä¸ªå¯¹è±¡ï¼è¡¨ç¤ºå½åéåä½ç½®çä¿¡æ¯ã\n\nè¿ééå«çä¸ä¸ªè§å®ï¼it.next()æ¹æ³å¿é¡»æ¯åæ­¥çï¼åªè¦è°ç¨å°±å¿é¡»ç«å»è¿åå¼ãä¹å°±æ¯è¯´ï¼ä¸æ¦æ§è¡it.next()æ¹æ³ï¼å°±å¿é¡»åæ­¥å°å¾å°valueådoneè¿ä¸¤ä¸ªå±æ§ãå¦æéåæéæ­£å¥½æååæ­¥æä½ï¼å½ç¶æ²¡æé®é¢ï¼ä½å¯¹äºå¼æ­¥æä½ï¼å°±ä¸å¤ªåéäºã\n\nfunction idMaker() {\n  let index = 0;\n\n  return {\n    next: function() {\n      return new Promise(function (resolve, reject) {\n        setTimeout(() => {\n          resolve({ value: index++, done: false });\n        }, 1000);\n      });\n    }\n  };\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼next()æ¹æ³è¿åçæ¯ä¸ä¸ª Promise å¯¹è±¡ï¼è¿æ ·å°±ä¸è¡ï¼ä¸ç¬¦å Iterator åè®®ï¼åªè¦ä»£ç éé¢åå«å¼æ­¥æä½é½ä¸è¡ãä¹å°±æ¯è¯´ï¼Iterator åè®®éé¢next()æ¹æ³åªè½åå«åæ­¥æä½ã\n\nç®åçè§£å³æ¹æ³æ¯ï¼å°å¼æ­¥æä½åè£æ Thunk å½æ°æè Promise å¯¹è±¡ï¼å³next()æ¹æ³è¿åå¼çvalueå±æ§æ¯ä¸ä¸ª Thunk å½æ°æè Promise å¯¹è±¡ï¼ç­å¾ä»¥åè¿åçæ­£çå¼ï¼èdoneå±æ§åè¿æ¯åæ­¥äº§ççã\n\nfunction idMaker() {\n  let index = 0;\n\n  return {\n    next: function() {\n      return {\n        value: new Promise(resolve => setTimeout(() => resolve(index++), 1000)),\n        done: false\n      };\n    }\n  };\n}\n\nconst it = idMaker();\n\nit.next().value.then(o => console.log(o)) // 1\nit.next().value.then(o => console.log(o)) // 2\nit.next().value.then(o => console.log(o)) // 3\n// ...\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ä¸­ï¼valueå±æ§çè¿åå¼æ¯ä¸ä¸ª Promise å¯¹è±¡ï¼ç¨æ¥æ¾ç½®å¼æ­¥æä½ãä½æ¯è¿æ ·åå¾éº»ç¦ï¼ä¸å¤ªç¬¦åç´è§ï¼è¯­ä¹ä¹æ¯è¾ç»ã\n\nES2018 å¼å¥äºâå¼æ­¥éåå¨âï¼Async Iteratorï¼ï¼ä¸ºå¼æ­¥æä½æä¾åççéåå¨æ¥å£ï¼å³valueådoneè¿ä¸¤ä¸ªå±æ§é½æ¯å¼æ­¥äº§çã\n\n\n# å¼æ­¥éåçæ¥å£\n\nå¼æ­¥éåå¨çæå¤§çè¯­æ³ç¹ç¹ï¼å°±æ¯è°ç¨éåå¨çnextæ¹æ³ï¼è¿åçæ¯ä¸ä¸ª Promise å¯¹è±¡ã\n\nasyncIterator\n  .next()\n  .then(\n    ({ value, done }) => /* ... */\n  );\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼asyncIteratoræ¯ä¸ä¸ªå¼æ­¥éåå¨ï¼è°ç¨nextæ¹æ³ä»¥åï¼è¿åä¸ä¸ª Promise å¯¹è±¡ãå æ­¤ï¼å¯ä»¥ä½¿ç¨thenæ¹æ³æå®ï¼è¿ä¸ª Promise å¯¹è±¡çç¶æåä¸ºresolveä»¥åçåè°å½æ°ãåè°å½æ°çåæ°ï¼åæ¯ä¸ä¸ªå·ævalueådoneä¸¤ä¸ªå±æ§çå¯¹è±¡ï¼è¿ä¸ªè·åæ­¥éåå¨æ¯ä¸æ ·çã\n\næä»¬ç¥éï¼ä¸ä¸ªå¯¹è±¡çåæ­¥éåå¨çæ¥å£ï¼é¨ç½²å¨Symbol.iteratorå±æ§ä¸é¢ãåæ ·å°ï¼å¯¹è±¡çå¼æ­¥éåå¨æ¥å£ï¼é¨ç½²å¨Symbol.asyncIteratorå±æ§ä¸é¢ãä¸ç®¡æ¯ä»ä¹æ ·çå¯¹è±¡ï¼åªè¦å®çSymbol.asyncIteratorå±æ§æå¼ï¼å°±è¡¨ç¤ºåºè¯¥å¯¹å®è¿è¡å¼æ­¥éåã\n\nä¸é¢æ¯ä¸ä¸ªå¼æ­¥éåå¨çä¾å­ã\n\nconst asyncIterable = createAsyncIterable(['a', 'b']);\nconst asyncIterator = asyncIterable[Symbol.asyncIterator]();\n\nasyncIterator\n.next()\n.then(iterResult1 => {\n  console.log(iterResult1); // { value: 'a', done: false }\n  return asyncIterator.next();\n})\n.then(iterResult2 => {\n  console.log(iterResult2); // { value: 'b', done: false }\n  return asyncIterator.next();\n})\n.then(iterResult3 => {\n  console.log(iterResult3); // { value: undefined, done: true }\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼å¼æ­¥éåå¨å¶å®è¿åäºä¸¤æ¬¡å¼ãç¬¬ä¸æ¬¡è°ç¨çæ¶åï¼è¿åä¸ä¸ª Promise å¯¹è±¡ï¼ç­å° Promise å¯¹è±¡resolveäºï¼åè¿åä¸ä¸ªè¡¨ç¤ºå½åæ°æ®æåä¿¡æ¯çå¯¹è±¡ãè¿å°±æ¯è¯´ï¼å¼æ­¥éåå¨ä¸åæ­¥éåå¨æç»è¡ä¸ºæ¯ä¸è´çï¼åªæ¯ä¼åè¿å Promise å¯¹è±¡ï¼ä½ä¸ºä¸­ä»ã\n\nç±äºå¼æ­¥éåå¨çnextæ¹æ³ï¼è¿åçæ¯ä¸ä¸ª Promise å¯¹è±¡ãå æ­¤ï¼å¯ä»¥æå®æ¾å¨awaitå½ä»¤åé¢ã\n\nasync function f() {\n  const asyncIterable = createAsyncIterable(['a', 'b']);\n  const asyncIterator = asyncIterable[Symbol.asyncIterator]();\n  console.log(await asyncIterator.next());\n  // { value: 'a', done: false }\n  console.log(await asyncIterator.next());\n  // { value: 'b', done: false }\n  console.log(await asyncIterator.next());\n  // { value: undefined, done: true }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼nextæ¹æ³ç¨awaitå¤çä»¥åï¼å°±ä¸å¿ä½¿ç¨thenæ¹æ³äºãæ´ä¸ªæµç¨å·²ç»å¾æ¥è¿åæ­¥å¤çäºã\n\næ³¨æï¼å¼æ­¥éåå¨çnextæ¹æ³æ¯å¯ä»¥è¿ç»­è°ç¨çï¼ä¸å¿ç­å°ä¸ä¸æ­¥äº§çç Promise å¯¹è±¡resolveä»¥ååè°ç¨ãè¿ç§æåµä¸ï¼nextæ¹æ³ä¼ç´¯ç§¯èµ·æ¥ï¼èªå¨æç§æ¯ä¸æ­¥çé¡ºåºè¿è¡ä¸å»ãä¸é¢æ¯ä¸ä¸ªä¾å­ï¼æææçnextæ¹æ³æ¾å¨Promise.allæ¹æ³éé¢ã\n\nconst asyncIterable = createAsyncIterable(['a', 'b']);\nconst asyncIterator = asyncIterable[Symbol.asyncIterator]();\nconst [{value: v1}, {value: v2}] = await Promise.all([\n  asyncIterator.next(), asyncIterator.next()\n]);\n\nconsole.log(v1, v2); // a b\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦ä¸ç§ç¨æ³æ¯ä¸æ¬¡æ§è°ç¨ææçnextæ¹æ³ï¼ç¶åawaitæåä¸æ­¥æä½ã\n\nasync function runner() {\n  const writer = openFile('someFile.txt');\n  writer.next('hello');\n  writer.next('world');\n  await writer.return();\n}\n\nrunner();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# for await...of\n\nåé¢ä»ç»è¿ï¼for...ofå¾ªç¯ç¨äºéååæ­¥ç Iterator æ¥å£ãæ°å¼å¥çfor await...ofå¾ªç¯ï¼åæ¯ç¨äºéåå¼æ­¥ç Iterator æ¥å£ã\n\nasync function f() {\n  for await (const x of createAsyncIterable(['a', 'b'])) {\n    console.log(x);\n  }\n}\n// a\n// b\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼createAsyncIterable()è¿åä¸ä¸ªæ¥æå¼æ­¥éåå¨æ¥å£çå¯¹è±¡ï¼for...ofå¾ªç¯èªå¨è°ç¨è¿ä¸ªå¯¹è±¡çå¼æ­¥éåå¨çnextæ¹æ³ï¼ä¼å¾å°ä¸ä¸ª Promise å¯¹è±¡ãawaitç¨æ¥å¤çè¿ä¸ª Promise å¯¹è±¡ï¼ä¸æ¦resolveï¼å°±æå¾å°çå¼ï¼xï¼ä¼ å¥for...ofçå¾ªç¯ä½ã\n\nfor await...ofå¾ªç¯çä¸ä¸ªç¨éï¼æ¯é¨ç½²äº asyncIterable æä½çå¼æ­¥æ¥å£ï¼å¯ä»¥ç´æ¥æ¾å¥è¿ä¸ªå¾ªç¯ã\n\nlet body = '';\n\nasync function f() {\n  for await(const data of req) body += data;\n  const parsed = JSON.parse(body);\n  console.log('got', parsed);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼reqæ¯ä¸ä¸ª asyncIterable å¯¹è±¡ï¼ç¨æ¥å¼æ­¥è¯»åæ°æ®ãå¯ä»¥çå°ï¼ä½¿ç¨for await...ofå¾ªç¯ä»¥åï¼ä»£ç ä¼éå¸¸ç®æ´ã\n\nå¦ænextæ¹æ³è¿åç Promise å¯¹è±¡è¢«rejectï¼for await...ofå°±ä¼æ¥éï¼è¦ç¨try...catchææã\n\nasync function () {\n  try {\n    for await (const x of createRejectingIterable()) {\n      console.log(x);\n    }\n  } catch (e) {\n    console.error(e);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\næ³¨æï¼for await...ofå¾ªç¯ä¹å¯ä»¥ç¨äºåæ­¥éåå¨ã\n\n(async function () {\n  for await (const x of ['a', 'b']) {\n    console.log(x);\n  }\n})();\n// a\n// b\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nNode v10 æ¯æå¼æ­¥éåå¨ï¼Stream å°±é¨ç½²äºè¿ä¸ªæ¥å£ãä¸é¢æ¯è¯»åæä»¶çä¼ ç»åæ³ä¸å¼æ­¥éåå¨åæ³çå·®å¼ã\n\n// ä¼ ç»åæ³\nfunction main(inputFilePath) {\n  const readStream = fs.createReadStream(\n    inputFilePath,\n    { encoding: 'utf8', highWaterMark: 1024 }\n  );\n  readStream.on('data', (chunk) => {\n    console.log('>>> '+chunk);\n  });\n  readStream.on('end', () => {\n    console.log('### DONE ###');\n  });\n}\n\n// å¼æ­¥éåå¨åæ³\nasync function main(inputFilePath) {\n  const readStream = fs.createReadStream(\n    inputFilePath,\n    { encoding: 'utf8', highWaterMark: 1024 }\n  );\n\n  for await (const chunk of readStream) {\n    console.log('>>> '+chunk);\n  }\n  console.log('### DONE ###');\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\n\n# å¼æ­¥ Generator å½æ°\n\nå°±å Generator å½æ°è¿åä¸ä¸ªåæ­¥éåå¨å¯¹è±¡ä¸æ ·ï¼å¼æ­¥ Generator å½æ°çä½ç¨ï¼æ¯è¿åä¸ä¸ªå¼æ­¥éåå¨å¯¹è±¡ã\n\nå¨è¯­æ³ä¸ï¼å¼æ­¥ Generator å½æ°å°±æ¯asyncå½æ°ä¸ Generator å½æ°çç»åã\n\nasync function* gen() {\n  yield 'hello';\n}\nconst genObj = gen();\ngenObj.next().then(x => console.log(x));\n// { value: 'hello', done: false }\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼genæ¯ä¸ä¸ªå¼æ­¥ Generator å½æ°ï¼æ§è¡åè¿åä¸ä¸ªå¼æ­¥ Iterator å¯¹è±¡ãå¯¹è¯¥å¯¹è±¡è°ç¨nextæ¹æ³ï¼è¿åä¸ä¸ª Promise å¯¹è±¡ã\n\nå¼æ­¥éåå¨çè®¾è®¡ç®çä¹ä¸ï¼å°±æ¯ Generator å½æ°å¤çåæ­¥æä½åå¼æ­¥æä½æ¶ï¼è½å¤ä½¿ç¨åä¸å¥æ¥å£ã\n\n// åæ­¥ Generator å½æ°\nfunction* map(iterable, func) {\n  const iter = iterable[Symbol.iterator]();\n  while (true) {\n    const {value, done} = iter.next();\n    if (done) break;\n    yield func(value);\n  }\n}\n\n// å¼æ­¥ Generator å½æ°\nasync function* map(iterable, func) {\n  const iter = iterable[Symbol.asyncIterator]();\n  while (true) {\n    const {value, done} = await iter.next();\n    if (done) break;\n    yield func(value);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ä¸­ï¼mapæ¯ä¸ä¸ª Generator å½æ°ï¼ç¬¬ä¸ä¸ªåæ°æ¯å¯éåå¯¹è±¡iterableï¼ç¬¬äºä¸ªåæ°æ¯ä¸ä¸ªåè°å½æ°funcãmapçä½ç¨æ¯å°iterableæ¯ä¸æ­¥è¿åçå¼ï¼ä½¿ç¨funcè¿è¡å¤çãä¸é¢æä¸¤ä¸ªçæ¬çmapï¼åä¸ä¸ªå¤çåæ­¥éåå¨ï¼åä¸ä¸ªå¤çå¼æ­¥éåå¨ï¼å¯ä»¥çå°ä¸¤ä¸ªçæ¬çåæ³åºæ¬ä¸æ¯ä¸è´çã\n\nä¸é¢æ¯å¦ä¸ä¸ªå¼æ­¥ Generator å½æ°çä¾å­ã\n\nasync function* readLines(path) {\n  let file = await fileOpen(path);\n\n  try {\n    while (!file.EOF) {\n      yield await file.readLine();\n    }\n  } finally {\n    await file.close();\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼å¼æ­¥æä½åé¢ä½¿ç¨awaitå³é®å­æ æï¼å³awaitåé¢çæä½ï¼åºè¯¥è¿å Promise å¯¹è±¡ãå¡æ¯ä½¿ç¨yieldå³é®å­çå°æ¹ï¼å°±æ¯nextæ¹æ³åä¸æ¥çå°æ¹ï¼å®åé¢çè¡¨è¾¾å¼çå¼ï¼å³await file.readLine()çå¼ï¼ï¼ä¼ä½ä¸ºnext()è¿åå¯¹è±¡çvalueå±æ§ï¼è¿ä¸ç¹æ¯ä¸åæ­¥ Generator å½æ°ä¸è´çã\n\nå¼æ­¥ Generator å½æ°åé¨ï¼è½å¤åæ¶ä½¿ç¨awaitåyieldå½ä»¤ãå¯ä»¥è¿æ ·çè§£ï¼awaitå½ä»¤ç¨äºå°å¤é¨æä½äº§ççå¼è¾å¥å½æ°åé¨ï¼yieldå½ä»¤ç¨äºå°å½æ°åé¨çå¼è¾åºã\n\nä¸é¢ä»£ç å®ä¹çå¼æ­¥ Generator å½æ°çç¨æ³å¦ä¸ã\n\n(async function () {\n  for await (const line of readLines(filePath)) {\n    console.log(line);\n  }\n})()\n\n\n1\n2\n3\n4\n5\n\n\nå¼æ­¥ Generator å½æ°å¯ä»¥ä¸for await...ofå¾ªç¯ç»åèµ·æ¥ä½¿ç¨ã\n\nasync function* prefixLines(asyncIterable) {\n  for await (const line of asyncIterable) {\n    yield '> ' + line;\n  }\n}\n\n\n1\n2\n3\n4\n5\n\n\nå¼æ­¥ Generator å½æ°çè¿åå¼æ¯ä¸ä¸ªå¼æ­¥ Iteratorï¼å³æ¯æ¬¡è°ç¨å®çnextæ¹æ³ï¼ä¼è¿åä¸ä¸ª Promise å¯¹è±¡ï¼ä¹å°±æ¯è¯´ï¼è·å¨yieldå½ä»¤åé¢çï¼åºè¯¥æ¯ä¸ä¸ª Promise å¯¹è±¡ãå¦æåä¸é¢é£ä¸ªä¾å­é£æ ·ï¼yieldå½ä»¤åé¢æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼ä¼è¢«èªå¨åè£æä¸ä¸ª Promise å¯¹è±¡ã\n\nfunction fetchRandom() {\n  const url = 'https://www.random.org/decimal-fractions/'\n    + '?num=1&dec=10&col=1&format=plain&rnd=new';\n  return fetch(url);\n}\n\nasync function* asyncGenerator() {\n  console.log('Start');\n  const result = await fetchRandom(); // (A)\n  yield 'Result: ' + await result.text(); // (B)\n  console.log('Done');\n}\n\nconst ag = asyncGenerator();\nag.next().then(({value, done}) => {\n  console.log(value);\n})\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼agæ¯asyncGeneratorå½æ°è¿åçå¼æ­¥éåå¨å¯¹è±¡ãè°ç¨ag.next()ä»¥åï¼ä¸é¢ä»£ç çæ§è¡é¡ºåºå¦ä¸ã\n\n 1. ag.next()ç«å»è¿åä¸ä¸ª Promise å¯¹è±¡ã\n 2. asyncGeneratorå½æ°å¼å§æ§è¡ï¼æå°åºStartã\n 3. awaitå½ä»¤è¿åä¸ä¸ª Promise å¯¹è±¡ï¼asyncGeneratorå½æ°åå¨è¿éã\n 4. A å¤åæ fulfilled ç¶æï¼äº§ççå¼æ¾å¥resultåéï¼asyncGeneratorå½æ°ç»§ç»­å¾ä¸æ§è¡ã\n 5. å½æ°å¨ B å¤çyieldæåæ§è¡ï¼ä¸æ¦yieldå½ä»¤åå°å¼ï¼ag.next()è¿åçé£ä¸ª Promise å¯¹è±¡åæ fulfilled ç¶æã\n 6. ag.next()åé¢çthenæ¹æ³æå®çåè°å½æ°å¼å§æ§è¡ãè¯¥åè°å½æ°çåæ°æ¯ä¸ä¸ªå¯¹è±¡{value, done}ï¼å¶ä¸­valueçå¼æ¯yieldå½ä»¤åé¢çé£ä¸ªè¡¨è¾¾å¼çå¼ï¼doneçå¼æ¯falseã\n\nA å B ä¸¤è¡çä½ç¨ç±»ä¼¼äºä¸é¢çä»£ç ã\n\nreturn new Promise((resolve, reject) => {\n  fetchRandom()\n  .then(result => result.text())\n  .then(result => {\n     resolve({\n       value: 'Result: ' + result,\n       done: false,\n     });\n  });\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¦æå¼æ­¥ Generator å½æ°æåºéè¯¯ï¼ä¼å¯¼è´ Promise å¯¹è±¡çç¶æåä¸ºrejectï¼ç¶åæåºçéè¯¯è¢«catchæ¹æ³æè·ã\n\nasync function* asyncGenerator() {\n  throw new Error('Problem!');\n}\n\nasyncGenerator()\n.next()\n.catch(err => console.log(err)); // Error: Problem!\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næ³¨æï¼æ®éç async å½æ°è¿åçæ¯ä¸ä¸ª Promise å¯¹è±¡ï¼èå¼æ­¥ Generator å½æ°è¿åçæ¯ä¸ä¸ªå¼æ­¥ Iterator å¯¹è±¡ãå¯ä»¥è¿æ ·çè§£ï¼async å½æ°åå¼æ­¥ Generator å½æ°ï¼æ¯å°è£å¼æ­¥æä½çä¸¤ç§æ¹æ³ï¼é½ç¨æ¥è¾¾å°åä¸ç§ç®çãåºå«å¨äºï¼åèèªå¸¦æ§è¡å¨ï¼åèéè¿for await...ofæ§è¡ï¼æèèªå·±ç¼åæ§è¡å¨ãä¸é¢å°±æ¯ä¸ä¸ªå¼æ­¥ Generator å½æ°çæ§è¡å¨ã\n\nasync function takeAsync(asyncIterable, count = Infinity) {\n  const result = [];\n  const iterator = asyncIterable[Symbol.asyncIterator]();\n  while (result.length < count) {\n    const {value, done} = await iterator.next();\n    if (done) break;\n    result.push(value);\n  }\n  return result;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼å¼æ­¥ Generator å½æ°äº§ççå¼æ­¥éåå¨ï¼ä¼éè¿whileå¾ªç¯èªå¨æ§è¡ï¼æ¯å½await iterator.next()å®æï¼å°±ä¼è¿å¥ä¸ä¸è½®å¾ªç¯ãä¸æ¦doneå±æ§åä¸ºtrueï¼å°±ä¼è·³åºå¾ªç¯ï¼å¼æ­¥éåå¨æ§è¡ç»æã\n\nä¸é¢æ¯è¿ä¸ªèªå¨æ§è¡å¨çä¸ä¸ªä½¿ç¨å®ä¾ã\n\nasync function f() {\n  async function* gen() {\n    yield 'a';\n    yield 'b';\n    yield 'c';\n  }\n\n  return await takeAsync(gen());\n}\n\nf().then(function (result) {\n  console.log(result); // ['a', 'b', 'c']\n})\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nå¼æ­¥ Generator å½æ°åºç°ä»¥åï¼JavaScript å°±æäºåç§å½æ°å½¢å¼ï¼æ®éå½æ°ãasync å½æ°ãGenerator å½æ°åå¼æ­¥ Generator å½æ°ãè¯·æ³¨æåºåæ¯ç§å½æ°çä¸åä¹å¤ãåºæ¬ä¸ï¼å¦ææ¯ä¸ç³»åæç§é¡ºåºæ§è¡çå¼æ­¥æä½ï¼æ¯å¦è¯»åæä»¶ï¼ç¶ååå¥æ°åå®¹ï¼åå­å¥ç¡¬çï¼ï¼å¯ä»¥ä½¿ç¨ async å½æ°ï¼å¦ææ¯ä¸ç³»åäº§çç¸åæ°æ®ç»æçå¼æ­¥æä½ï¼æ¯å¦ä¸è¡ä¸è¡è¯»åæä»¶ï¼ï¼å¯ä»¥ä½¿ç¨å¼æ­¥ Generator å½æ°ã\n\nå¼æ­¥ Generator å½æ°ä¹å¯ä»¥éè¿nextæ¹æ³çåæ°ï¼æ¥æ¶å¤é¨ä¼ å¥çæ°æ®ã\n\nconst writer = openFile('someFile.txt');\nwriter.next('hello'); // ç«å³æ§è¡\nwriter.next('world'); // ç«å³æ§è¡\nawait writer.return(); // ç­å¾åå¥ç»æ\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼openFileæ¯ä¸ä¸ªå¼æ­¥ Generator å½æ°ãnextæ¹æ³çåæ°ï¼åè¯¥å½æ°åé¨çæä½ä¼ å¥æ°æ®ãæ¯æ¬¡nextæ¹æ³é½æ¯åæ­¥æ§è¡çï¼æåçawaitå½ä»¤ç¨äºç­å¾æ´ä¸ªåå¥æä½ç»æã\n\næåï¼åæ­¥çæ°æ®ç»æï¼ä¹å¯ä»¥ä½¿ç¨å¼æ­¥ Generator å½æ°ã\n\nasync function* createAsyncIterable(syncIterable) {\n  for (const elem of syncIterable) {\n    yield elem;\n  }\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºæ²¡æå¼æ­¥æä½ï¼æä»¥ä¹å°±æ²¡æä½¿ç¨awaitå³é®å­ã\n\n\n# yield* è¯­å¥\n\nyield*è¯­å¥ä¹å¯ä»¥è·ä¸ä¸ªå¼æ­¥éåå¨ã\n\nasync function* gen1() {\n  yield 'a';\n  yield 'b';\n  return 2;\n}\n\nasync function* gen2() {\n  // result æç»ä¼ç­äº 2\n  const result = yield* gen1();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼gen2å½æ°éé¢çresultåéï¼æåçå¼æ¯2ã\n\nä¸åæ­¥ Generator å½æ°ä¸æ ·ï¼for await...ofå¾ªç¯ä¼å±å¼yield*ã\n\n(async function () {\n  for await (const x of gen2()) {\n    console.log(x);\n  }\n})();\n// a\n// b\n\n\n1\n2\n3\n4\n5\n6\n7\n",normalizedContent:"# å¼æ­¥éåå¨\n\n\n# åæ­¥éåå¨çé®é¢\n\nãéåå¨ãä¸ç« è¯´è¿ï¼iterator æ¥å£æ¯ä¸ç§æ°æ®éåçåè®®ï¼åªè¦è°ç¨éåå¨å¯¹è±¡çnextæ¹æ³ï¼å°±ä¼å¾å°ä¸ä¸ªå¯¹è±¡ï¼è¡¨ç¤ºå½åéåæéæå¨çé£ä¸ªä½ç½®çä¿¡æ¯ãnextæ¹æ³è¿åçå¯¹è±¡çç»ææ¯{value, done}ï¼å¶ä¸­valueè¡¨ç¤ºå½åçæ°æ®çå¼ï¼doneæ¯ä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºéåæ¯å¦ç»æã\n\nfunction idmaker() {\n  let index = 0;\n\n  return {\n    next: function() {\n      return { value: index++, done: false };\n    }\n  };\n}\n\nconst it = idmaker();\n\nit.next().value // 0\nit.next().value // 1\nit.next().value // 2\n// ...\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼åéitæ¯ä¸ä¸ªéåå¨ï¼iteratorï¼ãæ¯æ¬¡è°ç¨it.next()æ¹æ³ï¼å°±è¿åä¸ä¸ªå¯¹è±¡ï¼è¡¨ç¤ºå½åéåä½ç½®çä¿¡æ¯ã\n\nè¿ééå«çä¸ä¸ªè§å®ï¼it.next()æ¹æ³å¿é¡»æ¯åæ­¥çï¼åªè¦è°ç¨å°±å¿é¡»ç«å»è¿åå¼ãä¹å°±æ¯è¯´ï¼ä¸æ¦æ§è¡it.next()æ¹æ³ï¼å°±å¿é¡»åæ­¥å°å¾å°valueådoneè¿ä¸¤ä¸ªå±æ§ãå¦æéåæéæ­£å¥½æååæ­¥æä½ï¼å½ç¶æ²¡æé®é¢ï¼ä½å¯¹äºå¼æ­¥æä½ï¼å°±ä¸å¤ªåéäºã\n\nfunction idmaker() {\n  let index = 0;\n\n  return {\n    next: function() {\n      return new promise(function (resolve, reject) {\n        settimeout(() => {\n          resolve({ value: index++, done: false });\n        }, 1000);\n      });\n    }\n  };\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼next()æ¹æ³è¿åçæ¯ä¸ä¸ª promise å¯¹è±¡ï¼è¿æ ·å°±ä¸è¡ï¼ä¸ç¬¦å iterator åè®®ï¼åªè¦ä»£ç éé¢åå«å¼æ­¥æä½é½ä¸è¡ãä¹å°±æ¯è¯´ï¼iterator åè®®éé¢next()æ¹æ³åªè½åå«åæ­¥æä½ã\n\nç®åçè§£å³æ¹æ³æ¯ï¼å°å¼æ­¥æä½åè£æ thunk å½æ°æè promise å¯¹è±¡ï¼å³next()æ¹æ³è¿åå¼çvalueå±æ§æ¯ä¸ä¸ª thunk å½æ°æè promise å¯¹è±¡ï¼ç­å¾ä»¥åè¿åçæ­£çå¼ï¼èdoneå±æ§åè¿æ¯åæ­¥äº§ççã\n\nfunction idmaker() {\n  let index = 0;\n\n  return {\n    next: function() {\n      return {\n        value: new promise(resolve => settimeout(() => resolve(index++), 1000)),\n        done: false\n      };\n    }\n  };\n}\n\nconst it = idmaker();\n\nit.next().value.then(o => console.log(o)) // 1\nit.next().value.then(o => console.log(o)) // 2\nit.next().value.then(o => console.log(o)) // 3\n// ...\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ä¸­ï¼valueå±æ§çè¿åå¼æ¯ä¸ä¸ª promise å¯¹è±¡ï¼ç¨æ¥æ¾ç½®å¼æ­¥æä½ãä½æ¯è¿æ ·åå¾éº»ç¦ï¼ä¸å¤ªç¬¦åç´è§ï¼è¯­ä¹ä¹æ¯è¾ç»ã\n\nes2018 å¼å¥äºâå¼æ­¥éåå¨âï¼async iteratorï¼ï¼ä¸ºå¼æ­¥æä½æä¾åççéåå¨æ¥å£ï¼å³valueådoneè¿ä¸¤ä¸ªå±æ§é½æ¯å¼æ­¥äº§çã\n\n\n# å¼æ­¥éåçæ¥å£\n\nå¼æ­¥éåå¨çæå¤§çè¯­æ³ç¹ç¹ï¼å°±æ¯è°ç¨éåå¨çnextæ¹æ³ï¼è¿åçæ¯ä¸ä¸ª promise å¯¹è±¡ã\n\nasynciterator\n  .next()\n  .then(\n    ({ value, done }) => /* ... */\n  );\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼asynciteratoræ¯ä¸ä¸ªå¼æ­¥éåå¨ï¼è°ç¨nextæ¹æ³ä»¥åï¼è¿åä¸ä¸ª promise å¯¹è±¡ãå æ­¤ï¼å¯ä»¥ä½¿ç¨thenæ¹æ³æå®ï¼è¿ä¸ª promise å¯¹è±¡çç¶æåä¸ºresolveä»¥åçåè°å½æ°ãåè°å½æ°çåæ°ï¼åæ¯ä¸ä¸ªå·ævalueådoneä¸¤ä¸ªå±æ§çå¯¹è±¡ï¼è¿ä¸ªè·åæ­¥éåå¨æ¯ä¸æ ·çã\n\næä»¬ç¥éï¼ä¸ä¸ªå¯¹è±¡çåæ­¥éåå¨çæ¥å£ï¼é¨ç½²å¨symbol.iteratorå±æ§ä¸é¢ãåæ ·å°ï¼å¯¹è±¡çå¼æ­¥éåå¨æ¥å£ï¼é¨ç½²å¨symbol.asynciteratorå±æ§ä¸é¢ãä¸ç®¡æ¯ä»ä¹æ ·çå¯¹è±¡ï¼åªè¦å®çsymbol.asynciteratorå±æ§æå¼ï¼å°±è¡¨ç¤ºåºè¯¥å¯¹å®è¿è¡å¼æ­¥éåã\n\nä¸é¢æ¯ä¸ä¸ªå¼æ­¥éåå¨çä¾å­ã\n\nconst asynciterable = createasynciterable(['a', 'b']);\nconst asynciterator = asynciterable[symbol.asynciterator]();\n\nasynciterator\n.next()\n.then(iterresult1 => {\n  console.log(iterresult1); // { value: 'a', done: false }\n  return asynciterator.next();\n})\n.then(iterresult2 => {\n  console.log(iterresult2); // { value: 'b', done: false }\n  return asynciterator.next();\n})\n.then(iterresult3 => {\n  console.log(iterresult3); // { value: undefined, done: true }\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼å¼æ­¥éåå¨å¶å®è¿åäºä¸¤æ¬¡å¼ãç¬¬ä¸æ¬¡è°ç¨çæ¶åï¼è¿åä¸ä¸ª promise å¯¹è±¡ï¼ç­å° promise å¯¹è±¡resolveäºï¼åè¿åä¸ä¸ªè¡¨ç¤ºå½åæ°æ®æåä¿¡æ¯çå¯¹è±¡ãè¿å°±æ¯è¯´ï¼å¼æ­¥éåå¨ä¸åæ­¥éåå¨æç»è¡ä¸ºæ¯ä¸è´çï¼åªæ¯ä¼åè¿å promise å¯¹è±¡ï¼ä½ä¸ºä¸­ä»ã\n\nç±äºå¼æ­¥éåå¨çnextæ¹æ³ï¼è¿åçæ¯ä¸ä¸ª promise å¯¹è±¡ãå æ­¤ï¼å¯ä»¥æå®æ¾å¨awaitå½ä»¤åé¢ã\n\nasync function f() {\n  const asynciterable = createasynciterable(['a', 'b']);\n  const asynciterator = asynciterable[symbol.asynciterator]();\n  console.log(await asynciterator.next());\n  // { value: 'a', done: false }\n  console.log(await asynciterator.next());\n  // { value: 'b', done: false }\n  console.log(await asynciterator.next());\n  // { value: undefined, done: true }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼nextæ¹æ³ç¨awaitå¤çä»¥åï¼å°±ä¸å¿ä½¿ç¨thenæ¹æ³äºãæ´ä¸ªæµç¨å·²ç»å¾æ¥è¿åæ­¥å¤çäºã\n\næ³¨æï¼å¼æ­¥éåå¨çnextæ¹æ³æ¯å¯ä»¥è¿ç»­è°ç¨çï¼ä¸å¿ç­å°ä¸ä¸æ­¥äº§çç promise å¯¹è±¡resolveä»¥ååè°ç¨ãè¿ç§æåµä¸ï¼nextæ¹æ³ä¼ç´¯ç§¯èµ·æ¥ï¼èªå¨æç§æ¯ä¸æ­¥çé¡ºåºè¿è¡ä¸å»ãä¸é¢æ¯ä¸ä¸ªä¾å­ï¼æææçnextæ¹æ³æ¾å¨promise.allæ¹æ³éé¢ã\n\nconst asynciterable = createasynciterable(['a', 'b']);\nconst asynciterator = asynciterable[symbol.asynciterator]();\nconst [{value: v1}, {value: v2}] = await promise.all([\n  asynciterator.next(), asynciterator.next()\n]);\n\nconsole.log(v1, v2); // a b\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦ä¸ç§ç¨æ³æ¯ä¸æ¬¡æ§è°ç¨ææçnextæ¹æ³ï¼ç¶åawaitæåä¸æ­¥æä½ã\n\nasync function runner() {\n  const writer = openfile('somefile.txt');\n  writer.next('hello');\n  writer.next('world');\n  await writer.return();\n}\n\nrunner();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# for await...of\n\nåé¢ä»ç»è¿ï¼for...ofå¾ªç¯ç¨äºéååæ­¥ç iterator æ¥å£ãæ°å¼å¥çfor await...ofå¾ªç¯ï¼åæ¯ç¨äºéåå¼æ­¥ç iterator æ¥å£ã\n\nasync function f() {\n  for await (const x of createasynciterable(['a', 'b'])) {\n    console.log(x);\n  }\n}\n// a\n// b\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼createasynciterable()è¿åä¸ä¸ªæ¥æå¼æ­¥éåå¨æ¥å£çå¯¹è±¡ï¼for...ofå¾ªç¯èªå¨è°ç¨è¿ä¸ªå¯¹è±¡çå¼æ­¥éåå¨çnextæ¹æ³ï¼ä¼å¾å°ä¸ä¸ª promise å¯¹è±¡ãawaitç¨æ¥å¤çè¿ä¸ª promise å¯¹è±¡ï¼ä¸æ¦resolveï¼å°±æå¾å°çå¼ï¼xï¼ä¼ å¥for...ofçå¾ªç¯ä½ã\n\nfor await...ofå¾ªç¯çä¸ä¸ªç¨éï¼æ¯é¨ç½²äº asynciterable æä½çå¼æ­¥æ¥å£ï¼å¯ä»¥ç´æ¥æ¾å¥è¿ä¸ªå¾ªç¯ã\n\nlet body = '';\n\nasync function f() {\n  for await(const data of req) body += data;\n  const parsed = json.parse(body);\n  console.log('got', parsed);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼reqæ¯ä¸ä¸ª asynciterable å¯¹è±¡ï¼ç¨æ¥å¼æ­¥è¯»åæ°æ®ãå¯ä»¥çå°ï¼ä½¿ç¨for await...ofå¾ªç¯ä»¥åï¼ä»£ç ä¼éå¸¸ç®æ´ã\n\nå¦ænextæ¹æ³è¿åç promise å¯¹è±¡è¢«rejectï¼for await...ofå°±ä¼æ¥éï¼è¦ç¨try...catchææã\n\nasync function () {\n  try {\n    for await (const x of createrejectingiterable()) {\n      console.log(x);\n    }\n  } catch (e) {\n    console.error(e);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\næ³¨æï¼for await...ofå¾ªç¯ä¹å¯ä»¥ç¨äºåæ­¥éåå¨ã\n\n(async function () {\n  for await (const x of ['a', 'b']) {\n    console.log(x);\n  }\n})();\n// a\n// b\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nnode v10 æ¯æå¼æ­¥éåå¨ï¼stream å°±é¨ç½²äºè¿ä¸ªæ¥å£ãä¸é¢æ¯è¯»åæä»¶çä¼ ç»åæ³ä¸å¼æ­¥éåå¨åæ³çå·®å¼ã\n\n// ä¼ ç»åæ³\nfunction main(inputfilepath) {\n  const readstream = fs.createreadstream(\n    inputfilepath,\n    { encoding: 'utf8', highwatermark: 1024 }\n  );\n  readstream.on('data', (chunk) => {\n    console.log('>>> '+chunk);\n  });\n  readstream.on('end', () => {\n    console.log('### done ###');\n  });\n}\n\n// å¼æ­¥éåå¨åæ³\nasync function main(inputfilepath) {\n  const readstream = fs.createreadstream(\n    inputfilepath,\n    { encoding: 'utf8', highwatermark: 1024 }\n  );\n\n  for await (const chunk of readstream) {\n    console.log('>>> '+chunk);\n  }\n  console.log('### done ###');\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\n\n# å¼æ­¥ generator å½æ°\n\nå°±å generator å½æ°è¿åä¸ä¸ªåæ­¥éåå¨å¯¹è±¡ä¸æ ·ï¼å¼æ­¥ generator å½æ°çä½ç¨ï¼æ¯è¿åä¸ä¸ªå¼æ­¥éåå¨å¯¹è±¡ã\n\nå¨è¯­æ³ä¸ï¼å¼æ­¥ generator å½æ°å°±æ¯asyncå½æ°ä¸ generator å½æ°çç»åã\n\nasync function* gen() {\n  yield 'hello';\n}\nconst genobj = gen();\ngenobj.next().then(x => console.log(x));\n// { value: 'hello', done: false }\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼genæ¯ä¸ä¸ªå¼æ­¥ generator å½æ°ï¼æ§è¡åè¿åä¸ä¸ªå¼æ­¥ iterator å¯¹è±¡ãå¯¹è¯¥å¯¹è±¡è°ç¨nextæ¹æ³ï¼è¿åä¸ä¸ª promise å¯¹è±¡ã\n\nå¼æ­¥éåå¨çè®¾è®¡ç®çä¹ä¸ï¼å°±æ¯ generator å½æ°å¤çåæ­¥æä½åå¼æ­¥æä½æ¶ï¼è½å¤ä½¿ç¨åä¸å¥æ¥å£ã\n\n// åæ­¥ generator å½æ°\nfunction* map(iterable, func) {\n  const iter = iterable[symbol.iterator]();\n  while (true) {\n    const {value, done} = iter.next();\n    if (done) break;\n    yield func(value);\n  }\n}\n\n// å¼æ­¥ generator å½æ°\nasync function* map(iterable, func) {\n  const iter = iterable[symbol.asynciterator]();\n  while (true) {\n    const {value, done} = await iter.next();\n    if (done) break;\n    yield func(value);\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç ä¸­ï¼mapæ¯ä¸ä¸ª generator å½æ°ï¼ç¬¬ä¸ä¸ªåæ°æ¯å¯éåå¯¹è±¡iterableï¼ç¬¬äºä¸ªåæ°æ¯ä¸ä¸ªåè°å½æ°funcãmapçä½ç¨æ¯å°iterableæ¯ä¸æ­¥è¿åçå¼ï¼ä½¿ç¨funcè¿è¡å¤çãä¸é¢æä¸¤ä¸ªçæ¬çmapï¼åä¸ä¸ªå¤çåæ­¥éåå¨ï¼åä¸ä¸ªå¤çå¼æ­¥éåå¨ï¼å¯ä»¥çå°ä¸¤ä¸ªçæ¬çåæ³åºæ¬ä¸æ¯ä¸è´çã\n\nä¸é¢æ¯å¦ä¸ä¸ªå¼æ­¥ generator å½æ°çä¾å­ã\n\nasync function* readlines(path) {\n  let file = await fileopen(path);\n\n  try {\n    while (!file.eof) {\n      yield await file.readline();\n    }\n  } finally {\n    await file.close();\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼å¼æ­¥æä½åé¢ä½¿ç¨awaitå³é®å­æ æï¼å³awaitåé¢çæä½ï¼åºè¯¥è¿å promise å¯¹è±¡ãå¡æ¯ä½¿ç¨yieldå³é®å­çå°æ¹ï¼å°±æ¯nextæ¹æ³åä¸æ¥çå°æ¹ï¼å®åé¢çè¡¨è¾¾å¼çå¼ï¼å³await file.readline()çå¼ï¼ï¼ä¼ä½ä¸ºnext()è¿åå¯¹è±¡çvalueå±æ§ï¼è¿ä¸ç¹æ¯ä¸åæ­¥ generator å½æ°ä¸è´çã\n\nå¼æ­¥ generator å½æ°åé¨ï¼è½å¤åæ¶ä½¿ç¨awaitåyieldå½ä»¤ãå¯ä»¥è¿æ ·çè§£ï¼awaitå½ä»¤ç¨äºå°å¤é¨æä½äº§ççå¼è¾å¥å½æ°åé¨ï¼yieldå½ä»¤ç¨äºå°å½æ°åé¨çå¼è¾åºã\n\nä¸é¢ä»£ç å®ä¹çå¼æ­¥ generator å½æ°çç¨æ³å¦ä¸ã\n\n(async function () {\n  for await (const line of readlines(filepath)) {\n    console.log(line);\n  }\n})()\n\n\n1\n2\n3\n4\n5\n\n\nå¼æ­¥ generator å½æ°å¯ä»¥ä¸for await...ofå¾ªç¯ç»åèµ·æ¥ä½¿ç¨ã\n\nasync function* prefixlines(asynciterable) {\n  for await (const line of asynciterable) {\n    yield '> ' + line;\n  }\n}\n\n\n1\n2\n3\n4\n5\n\n\nå¼æ­¥ generator å½æ°çè¿åå¼æ¯ä¸ä¸ªå¼æ­¥ iteratorï¼å³æ¯æ¬¡è°ç¨å®çnextæ¹æ³ï¼ä¼è¿åä¸ä¸ª promise å¯¹è±¡ï¼ä¹å°±æ¯è¯´ï¼è·å¨yieldå½ä»¤åé¢çï¼åºè¯¥æ¯ä¸ä¸ª promise å¯¹è±¡ãå¦æåä¸é¢é£ä¸ªä¾å­é£æ ·ï¼yieldå½ä»¤åé¢æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼ä¼è¢«èªå¨åè£æä¸ä¸ª promise å¯¹è±¡ã\n\nfunction fetchrandom() {\n  const url = 'https://www.random.org/decimal-fractions/'\n    + '?num=1&dec=10&col=1&format=plain&rnd=new';\n  return fetch(url);\n}\n\nasync function* asyncgenerator() {\n  console.log('start');\n  const result = await fetchrandom(); // (a)\n  yield 'result: ' + await result.text(); // (b)\n  console.log('done');\n}\n\nconst ag = asyncgenerator();\nag.next().then(({value, done}) => {\n  console.log(value);\n})\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼agæ¯asyncgeneratorå½æ°è¿åçå¼æ­¥éåå¨å¯¹è±¡ãè°ç¨ag.next()ä»¥åï¼ä¸é¢ä»£ç çæ§è¡é¡ºåºå¦ä¸ã\n\n 1. ag.next()ç«å»è¿åä¸ä¸ª promise å¯¹è±¡ã\n 2. asyncgeneratorå½æ°å¼å§æ§è¡ï¼æå°åºstartã\n 3. awaitå½ä»¤è¿åä¸ä¸ª promise å¯¹è±¡ï¼asyncgeneratorå½æ°åå¨è¿éã\n 4. a å¤åæ fulfilled ç¶æï¼äº§ççå¼æ¾å¥resultåéï¼asyncgeneratorå½æ°ç»§ç»­å¾ä¸æ§è¡ã\n 5. å½æ°å¨ b å¤çyieldæåæ§è¡ï¼ä¸æ¦yieldå½ä»¤åå°å¼ï¼ag.next()è¿åçé£ä¸ª promise å¯¹è±¡åæ fulfilled ç¶æã\n 6. ag.next()åé¢çthenæ¹æ³æå®çåè°å½æ°å¼å§æ§è¡ãè¯¥åè°å½æ°çåæ°æ¯ä¸ä¸ªå¯¹è±¡{value, done}ï¼å¶ä¸­valueçå¼æ¯yieldå½ä»¤åé¢çé£ä¸ªè¡¨è¾¾å¼çå¼ï¼doneçå¼æ¯falseã\n\na å b ä¸¤è¡çä½ç¨ç±»ä¼¼äºä¸é¢çä»£ç ã\n\nreturn new promise((resolve, reject) => {\n  fetchrandom()\n  .then(result => result.text())\n  .then(result => {\n     resolve({\n       value: 'result: ' + result,\n       done: false,\n     });\n  });\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¦æå¼æ­¥ generator å½æ°æåºéè¯¯ï¼ä¼å¯¼è´ promise å¯¹è±¡çç¶æåä¸ºrejectï¼ç¶åæåºçéè¯¯è¢«catchæ¹æ³æè·ã\n\nasync function* asyncgenerator() {\n  throw new error('problem!');\n}\n\nasyncgenerator()\n.next()\n.catch(err => console.log(err)); // error: problem!\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næ³¨æï¼æ®éç async å½æ°è¿åçæ¯ä¸ä¸ª promise å¯¹è±¡ï¼èå¼æ­¥ generator å½æ°è¿åçæ¯ä¸ä¸ªå¼æ­¥ iterator å¯¹è±¡ãå¯ä»¥è¿æ ·çè§£ï¼async å½æ°åå¼æ­¥ generator å½æ°ï¼æ¯å°è£å¼æ­¥æä½çä¸¤ç§æ¹æ³ï¼é½ç¨æ¥è¾¾å°åä¸ç§ç®çãåºå«å¨äºï¼åèèªå¸¦æ§è¡å¨ï¼åèéè¿for await...ofæ§è¡ï¼æèèªå·±ç¼åæ§è¡å¨ãä¸é¢å°±æ¯ä¸ä¸ªå¼æ­¥ generator å½æ°çæ§è¡å¨ã\n\nasync function takeasync(asynciterable, count = infinity) {\n  const result = [];\n  const iterator = asynciterable[symbol.asynciterator]();\n  while (result.length < count) {\n    const {value, done} = await iterator.next();\n    if (done) break;\n    result.push(value);\n  }\n  return result;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼å¼æ­¥ generator å½æ°äº§ççå¼æ­¥éåå¨ï¼ä¼éè¿whileå¾ªç¯èªå¨æ§è¡ï¼æ¯å½await iterator.next()å®æï¼å°±ä¼è¿å¥ä¸ä¸è½®å¾ªç¯ãä¸æ¦doneå±æ§åä¸ºtrueï¼å°±ä¼è·³åºå¾ªç¯ï¼å¼æ­¥éåå¨æ§è¡ç»æã\n\nä¸é¢æ¯è¿ä¸ªèªå¨æ§è¡å¨çä¸ä¸ªä½¿ç¨å®ä¾ã\n\nasync function f() {\n  async function* gen() {\n    yield 'a';\n    yield 'b';\n    yield 'c';\n  }\n\n  return await takeasync(gen());\n}\n\nf().then(function (result) {\n  console.log(result); // ['a', 'b', 'c']\n})\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nå¼æ­¥ generator å½æ°åºç°ä»¥åï¼javascript å°±æäºåç§å½æ°å½¢å¼ï¼æ®éå½æ°ãasync å½æ°ãgenerator å½æ°åå¼æ­¥ generator å½æ°ãè¯·æ³¨æåºåæ¯ç§å½æ°çä¸åä¹å¤ãåºæ¬ä¸ï¼å¦ææ¯ä¸ç³»åæç§é¡ºåºæ§è¡çå¼æ­¥æä½ï¼æ¯å¦è¯»åæä»¶ï¼ç¶ååå¥æ°åå®¹ï¼åå­å¥ç¡¬çï¼ï¼å¯ä»¥ä½¿ç¨ async å½æ°ï¼å¦ææ¯ä¸ç³»åäº§çç¸åæ°æ®ç»æçå¼æ­¥æä½ï¼æ¯å¦ä¸è¡ä¸è¡è¯»åæä»¶ï¼ï¼å¯ä»¥ä½¿ç¨å¼æ­¥ generator å½æ°ã\n\nå¼æ­¥ generator å½æ°ä¹å¯ä»¥éè¿nextæ¹æ³çåæ°ï¼æ¥æ¶å¤é¨ä¼ å¥çæ°æ®ã\n\nconst writer = openfile('somefile.txt');\nwriter.next('hello'); // ç«å³æ§è¡\nwriter.next('world'); // ç«å³æ§è¡\nawait writer.return(); // ç­å¾åå¥ç»æ\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼openfileæ¯ä¸ä¸ªå¼æ­¥ generator å½æ°ãnextæ¹æ³çåæ°ï¼åè¯¥å½æ°åé¨çæä½ä¼ å¥æ°æ®ãæ¯æ¬¡nextæ¹æ³é½æ¯åæ­¥æ§è¡çï¼æåçawaitå½ä»¤ç¨äºç­å¾æ´ä¸ªåå¥æä½ç»æã\n\næåï¼åæ­¥çæ°æ®ç»æï¼ä¹å¯ä»¥ä½¿ç¨å¼æ­¥ generator å½æ°ã\n\nasync function* createasynciterable(synciterable) {\n  for (const elem of synciterable) {\n    yield elem;\n  }\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼ç±äºæ²¡æå¼æ­¥æä½ï¼æä»¥ä¹å°±æ²¡æä½¿ç¨awaitå³é®å­ã\n\n\n# yield* è¯­å¥\n\nyield*è¯­å¥ä¹å¯ä»¥è·ä¸ä¸ªå¼æ­¥éåå¨ã\n\nasync function* gen1() {\n  yield 'a';\n  yield 'b';\n  return 2;\n}\n\nasync function* gen2() {\n  // result æç»ä¼ç­äº 2\n  const result = yield* gen1();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼gen2å½æ°éé¢çresultåéï¼æåçå¼æ¯2ã\n\nä¸åæ­¥ generator å½æ°ä¸æ ·ï¼for await...ofå¾ªç¯ä¼å±å¼yield*ã\n\n(async function () {\n  for await (const x of gen2()) {\n    console.log(x);\n  }\n})();\n// a\n// b\n\n\n1\n2\n3\n4\n5\n6\n7\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ArrayBuffer",frontmatter:{title:"ArrayBuffer",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/a2ba314746bfdbdd",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/28.ArrayBuffer.html",relativePath:"ãES6 æç¨ãç¬è®°/28.ArrayBuffer.md",key:"v-6145bf5a",path:"/pages/a2ba314746bfdbdd/",headers:[{level:2,title:"ArrayBuffer å¯¹è±¡",slug:"arraybuffer-å¯¹è±¡",normalizedTitle:"arraybuffer å¯¹è±¡",charIndex:1609},{level:3,title:"æ¦è¿°",slug:"æ¦è¿°",normalizedTitle:"æ¦è¿°",charIndex:1628},{level:3,title:"ArrayBuffer.prototype.byteLength",slug:"arraybuffer-prototype-bytelength",normalizedTitle:"arraybuffer.prototype.bytelength",charIndex:2801},{level:3,title:"ArrayBuffer.prototype.slice()",slug:"arraybuffer-prototype-slice",normalizedTitle:"arraybuffer.prototype.slice()",charIndex:3078},{level:3,title:"ArrayBuffer.isView()",slug:"arraybuffer-isview",normalizedTitle:"arraybuffer.isview()",charIndex:3529},{level:2,title:"TypedArray è§å¾",slug:"typedarray-è§å¾",normalizedTitle:"typedarray è§å¾",charIndex:3804},{level:3,title:"æ¦è¿°",slug:"æ¦è¿°-2",normalizedTitle:"æ¦è¿°",charIndex:1628},{level:3,title:"æé å½æ°",slug:"æé å½æ°",normalizedTitle:"æé å½æ°",charIndex:1739},{level:3,title:"æ°ç»æ¹æ³",slug:"æ°ç»æ¹æ³",normalizedTitle:"æ°ç»æ¹æ³",charIndex:7066},{level:3,title:"å­èåº",slug:"å­èåº",normalizedTitle:"å­èåº",charIndex:849},{level:3,title:"BYTESPERELEMENT å±æ§",slug:"bytes-per-element-å±æ§",normalizedTitle:"bytesperelement å±æ§",charIndex:null},{level:3,title:"ArrayBuffer ä¸å­ç¬¦ä¸²çäºç¸è½¬æ¢",slug:"arraybuffer-ä¸å­ç¬¦ä¸²çäºç¸è½¬æ¢",normalizedTitle:"arraybuffer ä¸å­ç¬¦ä¸²çäºç¸è½¬æ¢",charIndex:11652},{level:3,title:"æº¢åº",slug:"æº¢åº",normalizedTitle:"æº¢åº",charIndex:1175},{level:3,title:"TypedArray.prototype.buffer",slug:"typedarray-prototype-buffer",normalizedTitle:"typedarray.prototype.buffer",charIndex:14118},{level:3,title:"TypedArray.prototype.byteLengthï¼TypedArray.prototype.byteOffset",slug:"typedarray-prototype-bytelength-typedarray-prototype-byteoffset",normalizedTitle:"typedarray.prototype.bytelengthï¼typedarray.prototype.byteoffset",charIndex:14329},{level:3,title:"TypedArray.prototype.length",slug:"typedarray-prototype-length",normalizedTitle:"typedarray.prototype.length",charIndex:14785},{level:3,title:"TypedArray.prototype.set()",slug:"typedarray-prototype-set",normalizedTitle:"typedarray.prototype.set()",charIndex:14973},{level:3,title:"TypedArray.prototype.subarray()",slug:"typedarray-prototype-subarray",normalizedTitle:"typedarray.prototype.subarray()",charIndex:15355},{level:3,title:"TypedArray.prototype.slice()",slug:"typedarray-prototype-slice",normalizedTitle:"typedarray.prototype.slice()",charIndex:15657},{level:3,title:"TypedArray.of()",slug:"typedarray-of",normalizedTitle:"typedarray.of()",charIndex:15951},{level:3,title:"TypedArray.from()",slug:"typedarray-from",normalizedTitle:"typedarray.from()",charIndex:16322},{level:2,title:"å¤åè§å¾",slug:"å¤åè§å¾",normalizedTitle:"å¤åè§å¾",charIndex:16924},{level:2,title:"DataView è§å¾",slug:"dataview-è§å¾",normalizedTitle:"dataview è§å¾",charIndex:17436},{level:2,title:"äºè¿å¶æ°ç»çåºç¨",slug:"äºè¿å¶æ°ç»çåºç¨",normalizedTitle:"äºè¿å¶æ°ç»çåºç¨",charIndex:19853},{level:3,title:"AJAX",slug:"ajax",normalizedTitle:"ajax",charIndex:19904},{level:3,title:"Canvas",slug:"canvas",normalizedTitle:"canvas",charIndex:1541},{level:3,title:"WebSocket",slug:"websocket",normalizedTitle:"websocket",charIndex:1576},{level:3,title:"Fetch API",slug:"fetch-api",normalizedTitle:"fetch api",charIndex:1551},{level:3,title:"File API",slug:"file-api",normalizedTitle:"file api",charIndex:1564},{level:2,title:"SharedArrayBuffer",slug:"sharedarraybuffer",normalizedTitle:"sharedarraybuffer",charIndex:24086},{level:2,title:"Atomics å¯¹è±¡",slug:"atomics-å¯¹è±¡",normalizedTitle:"atomics å¯¹è±¡",charIndex:26147}],excerpt:'<h1 id="arraybuffer"><a class="header-anchor" href="#arraybuffer">#</a> ArrayBuffer</h1>\n<p><code>ArrayBuffer</code>å¯¹è±¡ã<code>TypedArray</code>è§å¾å<code>DataView</code>è§å¾æ¯ JavaScript æä½äºè¿å¶æ°æ®çä¸ä¸ªæ¥å£ãè¿äºå¯¹è±¡æ©å°±å­å¨ï¼å±äºç¬ç«çè§æ ¼ï¼2011 å¹´ 2 æåå¸ï¼ï¼ES6 å°å®ä»¬çº³å¥äº ECMAScript è§æ ¼ï¼å¹¶ä¸å¢å äºæ°çæ¹æ³ãå®ä»¬é½æ¯ä»¥æ°ç»çè¯­æ³å¤çäºè¿å¶æ°æ®ï¼æä»¥ç»ç§°ä¸ºäºè¿å¶æ°ç»ã</p>\n',headersStr:"ArrayBuffer å¯¹è±¡ æ¦è¿° ArrayBuffer.prototype.byteLength ArrayBuffer.prototype.slice() ArrayBuffer.isView() TypedArray è§å¾ æ¦è¿° æé å½æ° æ°ç»æ¹æ³ å­èåº BYTESPERELEMENT å±æ§ ArrayBuffer ä¸å­ç¬¦ä¸²çäºç¸è½¬æ¢ æº¢åº TypedArray.prototype.buffer TypedArray.prototype.byteLengthï¼TypedArray.prototype.byteOffset TypedArray.prototype.length TypedArray.prototype.set() TypedArray.prototype.subarray() TypedArray.prototype.slice() TypedArray.of() TypedArray.from() å¤åè§å¾ DataView è§å¾ äºè¿å¶æ°ç»çåºç¨ AJAX Canvas WebSocket Fetch API File API SharedArrayBuffer Atomics å¯¹è±¡",content:"# ArrayBuffer\n\nArrayBufferå¯¹è±¡ãTypedArrayè§å¾åDataViewè§å¾æ¯ JavaScript æä½äºè¿å¶æ°æ®çä¸ä¸ªæ¥å£ãè¿äºå¯¹è±¡æ©å°±å­å¨ï¼å±äºç¬ç«çè§æ ¼ï¼2011 å¹´ 2 æåå¸ï¼ï¼ES6 å°å®ä»¬çº³å¥äº ECMAScript è§æ ¼ï¼å¹¶ä¸å¢å äºæ°çæ¹æ³ãå®ä»¬é½æ¯ä»¥æ°ç»çè¯­æ³å¤çäºè¿å¶æ°æ®ï¼æä»¥ç»ç§°ä¸ºäºè¿å¶æ°ç»ã è¿ä¸ªæ¥å£çåå§è®¾è®¡ç®çï¼ä¸ WebGL é¡¹ç®æå³ãæè° WebGLï¼å°±æ¯ææµè§å¨ä¸æ¾å¡ä¹é´çéä¿¡æ¥å£ï¼ä¸ºäºæ»¡è¶³ JavaScript ä¸æ¾å¡ä¹é´å¤§éçãå®æ¶çæ°æ®äº¤æ¢ï¼å®ä»¬ä¹é´çæ°æ®éä¿¡å¿é¡»æ¯äºè¿å¶çï¼èä¸è½æ¯ä¼ ç»çææ¬æ ¼å¼ãææ¬æ ¼å¼ä¼ éä¸ä¸ª 32 ä½æ´æ°ï¼ä¸¤ç«¯ç JavaScript èæ¬ä¸æ¾å¡é½è¦è¿è¡æ ¼å¼è½¬åï¼å°éå¸¸èæ¶ãè¿æ¶è¦æ¯å­å¨ä¸ç§æºå¶ï¼å¯ä»¥å C è¯­è¨é£æ ·ï¼ç´æ¥æä½å­èï¼å° 4 ä¸ªå­èç 32 ä½æ´æ°ï¼ä»¥äºè¿å¶å½¢å¼åå°ä¸å¨å°éå¥æ¾å¡ï¼èæ¬çæ§è½å°±ä¼å¤§å¹æåã\n\näºè¿å¶æ°ç»å°±æ¯å¨è¿ç§èæ¯ä¸è¯ççãå®å¾å C è¯­è¨çæ°ç»ï¼åè®¸å¼åèä»¥æ°ç»ä¸æ çå½¢å¼ï¼ç´æ¥æä½åå­ï¼å¤§å¤§å¢å¼ºäº JavaScript å¤çäºè¿å¶æ°æ®çè½åï¼ä½¿å¾å¼åèæå¯è½éè¿ JavaScript ä¸æä½ç³»ç»çåçæ¥å£è¿è¡äºè¿å¶éä¿¡ã\n\näºè¿å¶æ°ç»ç±ä¸ç±»å¯¹è±¡ç»æã\n\nï¼1ï¼ArrayBufferå¯¹è±¡ï¼ä»£è¡¨åå­ä¹ä¸­çä¸æ®µäºè¿å¶æ°æ®ï¼å¯ä»¥éè¿âè§å¾âè¿è¡æä½ãâè§å¾âé¨ç½²äºæ°ç»æ¥å£ï¼è¿æå³çï¼å¯ä»¥ç¨æ°ç»çæ¹æ³æä½åå­ã\n\nï¼2ï¼TypedArrayè§å¾ï¼å±åæ¬ 9 ç§ç±»åçè§å¾ï¼æ¯å¦Uint8Arrayï¼æ ç¬¦å· 8 ä½æ´æ°ï¼æ°ç»è§å¾, Int16Arrayï¼16 ä½æ´æ°ï¼æ°ç»è§å¾, Float32Arrayï¼32 ä½æµ®ç¹æ°ï¼æ°ç»è§å¾ç­ç­ã\n\nï¼3ï¼DataViewè§å¾ï¼å¯ä»¥èªå®ä¹å¤åæ ¼å¼çè§å¾ï¼æ¯å¦ç¬¬ä¸ä¸ªå­èæ¯ Uint8ï¼æ ç¬¦å· 8 ä½æ´æ°ï¼ãç¬¬äºãä¸ä¸ªå­èæ¯ Int16ï¼16 ä½æ´æ°ï¼ãç¬¬åä¸ªå­èå¼å§æ¯ Float32ï¼32 ä½æµ®ç¹æ°ï¼ç­ç­ï¼æ­¤å¤è¿å¯ä»¥èªå®ä¹å­èåºã\n\nç®åè¯´ï¼ArrayBufferå¯¹è±¡ä»£è¡¨åå§çäºè¿å¶æ°æ®ï¼TypedArrayè§å¾ç¨æ¥è¯»åç®åç±»åçäºè¿å¶æ°æ®ï¼DataViewè§å¾ç¨æ¥è¯»åå¤æç±»åçäºè¿å¶æ°æ®ã\n\nTypedArrayè§å¾æ¯æçæ°æ®ç±»åä¸å±æ 9 ç§ï¼DataViewè§å¾æ¯æé¤Uint8Cä»¥å¤çå¶ä» 8 ç§ï¼ã\n\næ°æ®ç±»å      å­èé¿åº¦   å«ä¹                  å¯¹åºç C è¯­è¨ç±»å\nInt8      1      8 ä½å¸¦ç¬¦å·æ´æ°            signed char\nUint8     1      8 ä½ä¸å¸¦ç¬¦å·æ´æ°           unsigned char\nUint8C    1      8 ä½ä¸å¸¦ç¬¦å·æ´æ°ï¼èªå¨è¿æ»¤æº¢åºï¼   unsigned char\nInt16     2      16 ä½å¸¦ç¬¦å·æ´æ°           short\nUint16    2      16 ä½ä¸å¸¦ç¬¦å·æ´æ°          unsigned short\nInt32     4      32 ä½å¸¦ç¬¦å·æ´æ°           int\nUint32    4      32 ä½ä¸å¸¦ç¬¦å·çæ´æ°         unsigned int\nFloat32   4      32 ä½æµ®ç¹æ°             float\nFloat64   8      64 ä½æµ®ç¹æ°             double\n\næ³¨æï¼äºè¿å¶æ°ç»å¹¶ä¸æ¯çæ­£çæ°ç»ï¼èæ¯ç±»ä¼¼æ°ç»çå¯¹è±¡ã\n\nå¾å¤æµè§å¨æä½ç APIï¼ç¨å°äºäºè¿å¶æ°ç»æä½äºè¿å¶æ°æ®ï¼ä¸é¢æ¯å¶ä¸­çå ä¸ªã\n\n * Canvas\n * Fetch API\n * File API\n * WebSockets\n * XMLHttpRequest\n\n\n# ArrayBuffer å¯¹è±¡\n\n\n# æ¦è¿°\n\nArrayBufferå¯¹è±¡ä»£è¡¨å¨å­äºè¿å¶æ°æ®çä¸æ®µåå­ï¼å®ä¸è½ç´æ¥è¯»åï¼åªè½éè¿è§å¾ï¼TypedArrayè§å¾åDataViewè§å¾)æ¥è¯»åï¼è§å¾çä½ç¨æ¯ä»¥æå®æ ¼å¼è§£è¯»äºè¿å¶æ°æ®ã\n\nArrayBufferä¹æ¯ä¸ä¸ªæé å½æ°ï¼å¯ä»¥åéä¸æ®µå¯ä»¥å­æ¾æ°æ®çè¿ç»­åå­åºåã\n\nconst buf = new ArrayBuffer(32);\n\n\n1\n\n\nä¸é¢ä»£ç çæäºä¸æ®µ 32 å­èçåå­åºåï¼æ¯ä¸ªå­èçå¼é»è®¤é½æ¯ 0ãå¯ä»¥çå°ï¼ArrayBufferæé å½æ°çåæ°æ¯æéè¦çåå­å¤§å°ï¼åä½å­èï¼ã\n\nä¸ºäºè¯»åè¿æ®µåå®¹ï¼éè¦ä¸ºå®æå®è§å¾ãDataViewè§å¾çåå»ºï¼éè¦æä¾ArrayBufferå¯¹è±¡å®ä¾ä½ä¸ºåæ°ã\n\nconst buf = new ArrayBuffer(32);\nconst dataView = new DataView(buf);\ndataView.getUint8(0) // 0\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç å¯¹ä¸æ®µ 32 å­èçåå­ï¼å»ºç«DataViewè§å¾ï¼ç¶åä»¥ä¸å¸¦ç¬¦å·ç 8 ä½æ´æ°æ ¼å¼ï¼ä»å¤´è¯»å 8 ä½äºè¿å¶æ°æ®ï¼ç»æå¾å° 0ï¼å ä¸ºåå§åå­çArrayBufferå¯¹è±¡ï¼é»è®¤ææä½é½æ¯ 0ã\n\nå¦ä¸ç§TypedArrayè§å¾ï¼ä¸DataViewè§å¾çä¸ä¸ªåºå«æ¯ï¼å®ä¸æ¯ä¸ä¸ªæé å½æ°ï¼èæ¯ä¸ç»æé å½æ°ï¼ä»£è¡¨ä¸åçæ°æ®æ ¼å¼ã\n\nconst buffer = new ArrayBuffer(12);\n\nconst x1 = new Int32Array(buffer);\nx1[0] = 1;\nconst x2 = new Uint8Array(buffer);\nx2[0]  = 2;\n\nx1[0] // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç å¯¹åä¸æ®µåå­ï¼åå«å»ºç«ä¸¤ç§è§å¾ï¼32 ä½å¸¦ç¬¦å·æ´æ°ï¼Int32Arrayæé å½æ°ï¼å 8 ä½ä¸å¸¦ç¬¦å·æ´æ°ï¼Uint8Arrayæé å½æ°ï¼ãç±äºä¸¤ä¸ªè§å¾å¯¹åºçæ¯åä¸æ®µåå­ï¼ä¸ä¸ªè§å¾ä¿®æ¹åºå±åå­ï¼ä¼å½±åå°å¦ä¸ä¸ªè§å¾ã\n\nTypedArrayè§å¾çæé å½æ°ï¼é¤äºæ¥åArrayBufferå®ä¾ä½ä¸ºåæ°ï¼è¿å¯ä»¥æ¥åæ®éæ°ç»ä½ä¸ºåæ°ï¼ç´æ¥åéåå­çæåºå±çArrayBufferå®ä¾ï¼å¹¶åæ¶å®æå¯¹è¿æ®µåå­çèµå¼ã\n\nconst typedArray = new Uint8Array([0,1,2]);\ntypedArray.length // 3\n\ntypedArray[0] = 5;\ntypedArray // [5, 1, 2]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä½¿ç¨TypedArrayè§å¾çUint8Arrayæé å½æ°ï¼æ°å»ºä¸ä¸ªä¸å¸¦ç¬¦å·ç 8 ä½æ´æ°è§å¾ãå¯ä»¥çå°ï¼Uint8Arrayç´æ¥ä½¿ç¨æ®éæ°ç»ä½ä¸ºåæ°ï¼å¯¹åºå±åå­çèµå¼åæ¶å®æã\n\n\n# ArrayBuffer.prototype.byteLength\n\nArrayBufferå®ä¾çbyteLengthå±æ§ï¼è¿åæåéçåå­åºåçå­èé¿åº¦ã\n\nconst buffer = new ArrayBuffer(32);\nbuffer.byteLength\n// 32\n\n\n1\n2\n3\n\n\nå¦æè¦åéçåå­åºåå¾å¤§ï¼æå¯è½åéå¤±è´¥ï¼å ä¸ºæ²¡æé£ä¹å¤çè¿ç»­ç©ºä½åå­ï¼ï¼æä»¥æå¿è¦æ£æ¥æ¯å¦åéæåã\n\nif (buffer.byteLength === n) {\n  // æå\n} else {\n  // å¤±è´¥\n}\n\n\n1\n2\n3\n4\n5\n\n\n\n# ArrayBuffer.prototype.slice()\n\nArrayBufferå®ä¾æä¸ä¸ªsliceæ¹æ³ï¼åè®¸å°åå­åºåçä¸é¨åï¼æ·è´çæä¸ä¸ªæ°çArrayBufferå¯¹è±¡ã\n\nconst buffer = new ArrayBuffer(8);\nconst newBuffer = buffer.slice(0, 3);\n\n\n1\n2\n\n\nä¸é¢ä»£ç æ·è´bufferå¯¹è±¡çå 3 ä¸ªå­èï¼ä» 0 å¼å§ï¼å°ç¬¬ 3 ä¸ªå­èåé¢ç»æï¼ï¼çæä¸ä¸ªæ°çArrayBufferå¯¹è±¡ãsliceæ¹æ³å¶å®åå«ä¸¤æ­¥ï¼ç¬¬ä¸æ­¥æ¯ååéä¸æ®µæ°åå­ï¼ç¬¬äºæ­¥æ¯å°åæ¥é£ä¸ªArrayBufferå¯¹è±¡æ·è´è¿å»ã\n\nsliceæ¹æ³æ¥åä¸¤ä¸ªåæ°ï¼ç¬¬ä¸ä¸ªåæ°è¡¨ç¤ºæ·è´å¼å§çå­èåºå·ï¼å«è¯¥å­èï¼ï¼ç¬¬äºä¸ªåæ°è¡¨ç¤ºæ·è´æªæ­¢çå­èåºå·ï¼ä¸å«è¯¥å­èï¼ãå¦æçç¥ç¬¬äºä¸ªåæ°ï¼åé»è®¤å°åArrayBufferå¯¹è±¡çç»å°¾ã\n\né¤äºsliceæ¹æ³ï¼ArrayBufferå¯¹è±¡ä¸æä¾ä»»ä½ç´æ¥è¯»ååå­çæ¹æ³ï¼åªåè®¸å¨å¶ä¸æ¹å»ºç«è§å¾ï¼ç¶åéè¿è§å¾è¯»åã\n\n\n# ArrayBuffer.isView()\n\nArrayBufferæä¸ä¸ªéææ¹æ³isViewï¼è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºåæ°æ¯å¦ä¸ºArrayBufferçè§å¾å®ä¾ãè¿ä¸ªæ¹æ³å¤§è´ç¸å½äºå¤æ­åæ°ï¼æ¯å¦ä¸ºTypedArrayå®ä¾æDataViewå®ä¾ã\n\nconst buffer = new ArrayBuffer(8);\nArrayBuffer.isView(buffer) // false\n\nconst v = new Int32Array(buffer);\nArrayBuffer.isView(v) // true\n\n\n1\n2\n3\n4\n5\n\n\n\n# TypedArray è§å¾\n\n\n# æ¦è¿°\n\nArrayBufferå¯¹è±¡ä½ä¸ºåå­åºåï¼å¯ä»¥å­æ¾å¤ç§ç±»åçæ°æ®ãåä¸æ®µåå­ï¼ä¸åæ°æ®æä¸åçè§£è¯»æ¹å¼ï¼è¿å°±å«åâè§å¾âï¼viewï¼ãArrayBufferæä¸¤ç§è§å¾ï¼ä¸ç§æ¯TypedArrayè§å¾ï¼å¦ä¸ç§æ¯DataViewè§å¾ãåèçæ°ç»æåé½æ¯åä¸ä¸ªæ°æ®ç±»åï¼åèçæ°ç»æåå¯ä»¥æ¯ä¸åçæ°æ®ç±»åã\n\nç®åï¼TypedArrayè§å¾ä¸å±åæ¬ 9 ç§ç±»åï¼æ¯ä¸ç§è§å¾é½æ¯ä¸ç§æé å½æ°ã\n\n * Int8Arrayï¼8 ä½æç¬¦å·æ´æ°ï¼é¿åº¦ 1 ä¸ªå­èã\n * Uint8Arrayï¼8 ä½æ ç¬¦å·æ´æ°ï¼é¿åº¦ 1 ä¸ªå­èã\n * Uint8ClampedArrayï¼8 ä½æ ç¬¦å·æ´æ°ï¼é¿åº¦ 1 ä¸ªå­èï¼æº¢åºå¤çä¸åã\n * Int16Arrayï¼16 ä½æç¬¦å·æ´æ°ï¼é¿åº¦ 2 ä¸ªå­èã\n * Uint16Arrayï¼16 ä½æ ç¬¦å·æ´æ°ï¼é¿åº¦ 2 ä¸ªå­èã\n * Int32Arrayï¼32 ä½æç¬¦å·æ´æ°ï¼é¿åº¦ 4 ä¸ªå­èã\n * Uint32Arrayï¼32 ä½æ ç¬¦å·æ´æ°ï¼é¿åº¦ 4 ä¸ªå­èã\n * Float32Arrayï¼32 ä½æµ®ç¹æ°ï¼é¿åº¦ 4 ä¸ªå­èã\n * Float64Arrayï¼64 ä½æµ®ç¹æ°ï¼é¿åº¦ 8 ä¸ªå­èã\n\nè¿ 9 ä¸ªæé å½æ°çæçæ°ç»ï¼ç»ç§°ä¸ºTypedArrayè§å¾ãå®ä»¬å¾åæ®éæ°ç»ï¼é½ælengthå±æ§ï¼é½è½ç¨æ¹æ¬å·è¿ç®ç¬¦ï¼[]ï¼è·ååä¸ªåç´ ï¼æææ°ç»çæ¹æ³ï¼å¨å®ä»¬ä¸é¢é½è½ä½¿ç¨ãæ®éæ°ç»ä¸ TypedArray æ°ç»çå·®å¼ä¸»è¦å¨ä»¥ä¸æ¹é¢ã\n\n * TypedArray æ°ç»çæææåï¼é½æ¯åä¸ç§ç±»åã\n * TypedArray æ°ç»çæåæ¯è¿ç»­çï¼ä¸ä¼æç©ºä½ã\n * TypedArray æ°ç»æåçé»è®¤å¼ä¸º 0ãæ¯å¦ï¼new Array(10)è¿åä¸ä¸ªæ®éæ°ç»ï¼éé¢æ²¡æä»»ä½æåï¼åªæ¯ 10 ä¸ªç©ºä½ï¼new Uint8Array(10)è¿åä¸ä¸ª TypedArray æ°ç»ï¼éé¢ 10 ä¸ªæåé½æ¯ 0ã\n * TypedArray æ°ç»åªæ¯ä¸å±è§å¾ï¼æ¬èº«ä¸å¨å­æ°æ®ï¼å®çæ°æ®é½å¨å­å¨åºå±çArrayBufferå¯¹è±¡ä¹ä¸­ï¼è¦è·ååºå±å¯¹è±¡å¿é¡»ä½¿ç¨bufferå±æ§ã\n\n\n# æé å½æ°\n\nTypedArray æ°ç»æä¾ 9 ç§æé å½æ°ï¼ç¨æ¥çæç¸åºç±»åçæ°ç»å®ä¾ã\n\næé å½æ°æå¤ç§ç¨æ³ã\n\nï¼1ï¼TypedArray(buffer, byteOffset=0, length?)\n\nåä¸ä¸ªArrayBufferå¯¹è±¡ä¹ä¸ï¼å¯ä»¥æ ¹æ®ä¸åçæ°æ®ç±»åï¼å»ºç«å¤ä¸ªè§å¾ã\n\n// åå»ºä¸ä¸ª8å­èçArrayBuffer\nconst b = new ArrayBuffer(8);\n\n// åå»ºä¸ä¸ªæåbçInt32è§å¾ï¼å¼å§äºå­è0ï¼ç´å°ç¼å²åºçæ«å°¾\nconst v1 = new Int32Array(b);\n\n// åå»ºä¸ä¸ªæåbçUint8è§å¾ï¼å¼å§äºå­è2ï¼ç´å°ç¼å²åºçæ«å°¾\nconst v2 = new Uint8Array(b, 2);\n\n// åå»ºä¸ä¸ªæåbçInt16è§å¾ï¼å¼å§äºå­è2ï¼é¿åº¦ä¸º2\nconst v3 = new Int16Array(b, 2, 2);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç å¨ä¸æ®µé¿åº¦ä¸º 8 ä¸ªå­èçåå­ï¼bï¼ä¹ä¸ï¼çæäºä¸ä¸ªè§å¾ï¼v1ãv2åv3ã\n\nè§å¾çæé å½æ°å¯ä»¥æ¥åä¸ä¸ªåæ°ï¼\n\n * ç¬¬ä¸ä¸ªåæ°ï¼å¿éï¼ï¼è§å¾å¯¹åºçåºå±ArrayBufferå¯¹è±¡ã\n * ç¬¬äºä¸ªåæ°ï¼å¯éï¼ï¼è§å¾å¼å§çå­èåºå·ï¼é»è®¤ä» 0 å¼å§ã\n * ç¬¬ä¸ä¸ªåæ°ï¼å¯éï¼ï¼è§å¾åå«çæ°æ®ä¸ªæ°ï¼é»è®¤ç´å°æ¬æ®µåå­åºåç»æã\n\nå æ­¤ï¼v1ãv2åv3æ¯éå çï¼v1[0]æ¯ä¸ä¸ª 32 ä½æ´æ°ï¼æåå­è 0 ï½å­è 3ï¼v2[0]æ¯ä¸ä¸ª 8 ä½æ ç¬¦å·æ´æ°ï¼æåå­è 2ï¼v3[0]æ¯ä¸ä¸ª 16 ä½æ´æ°ï¼æåå­è 2 ï½å­è 3ãåªè¦ä»»ä½ä¸ä¸ªè§å¾å¯¹åå­ææä¿®æ¹ï¼å°±ä¼å¨å¦å¤ä¸¤ä¸ªè§å¾ä¸ååºåºæ¥ã\n\næ³¨æï¼byteOffsetå¿é¡»ä¸æè¦å»ºç«çæ°æ®ç±»åä¸è´ï¼å¦åä¼æ¥éã\n\nconst buffer = new ArrayBuffer(8);\nconst i16 = new Int16Array(buffer, 1);\n// Uncaught RangeError: start offset of Int16Array should be a multiple of 2\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°çæä¸ä¸ª 8 ä¸ªå­èçArrayBufferå¯¹è±¡ï¼ç¶åå¨è¿ä¸ªå¯¹è±¡çç¬¬ä¸ä¸ªå­èï¼å»ºç«å¸¦ç¬¦å·ç 16 ä½æ´æ°è§å¾ï¼ç»ææ¥éãå ä¸ºï¼å¸¦ç¬¦å·ç 16 ä½æ´æ°éè¦ä¸¤ä¸ªå­èï¼æä»¥byteOffsetåæ°å¿é¡»è½å¤è¢« 2 æ´é¤ã\n\nå¦ææ³ä»ä»»æå­èå¼å§è§£è¯»ArrayBufferå¯¹è±¡ï¼å¿é¡»ä½¿ç¨DataViewè§å¾ï¼å ä¸ºTypedArrayè§å¾åªæä¾ 9 ç§åºå®çè§£è¯»æ ¼å¼ã\n\nï¼2ï¼TypedArray(length)\n\nè§å¾è¿å¯ä»¥ä¸éè¿ArrayBufferå¯¹è±¡ï¼ç´æ¥åéåå­èçæã\n\nconst f64a = new Float64Array(8);\nf64a[0] = 10;\nf64a[1] = 20;\nf64a[2] = f64a[0] + f64a[1];\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç çæä¸ä¸ª 8 ä¸ªæåçFloat64Arrayæ°ç»ï¼å± 64 å­èï¼ï¼ç¶åä¾æ¬¡å¯¹æ¯ä¸ªæåèµå¼ãè¿æ¶ï¼è§å¾æé å½æ°çåæ°å°±æ¯æåçä¸ªæ°ãå¯ä»¥çå°ï¼è§å¾æ°ç»çèµå¼æä½ä¸æ®éæ°ç»çæä½æ¯«æ ä¸¤æ ·ã\n\nï¼3ï¼TypedArray(typedArray)\n\nTypedArray æ°ç»çæé å½æ°ï¼å¯ä»¥æ¥åå¦ä¸ä¸ªTypedArrayå®ä¾ä½ä¸ºåæ°ã\n\nconst typedArray = new Int8Array(new Uint8Array(4));\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼Int8Arrayæé å½æ°æ¥åä¸ä¸ªUint8Arrayå®ä¾ä½ä¸ºåæ°ã\n\næ³¨æï¼æ­¤æ¶çæçæ°æ°ç»ï¼åªæ¯å¤å¶äºåæ°æ°ç»çå¼ï¼å¯¹åºçåºå±åå­æ¯ä¸ä¸æ ·çãæ°æ°ç»ä¼å¼è¾ä¸æ®µæ°çåå­å¨å­æ°æ®ï¼ä¸ä¼å¨åæ°ç»çåå­ä¹ä¸å»ºç«è§å¾ã\n\nconst x = new Int8Array([1, 1]);\nconst y = new Int8Array(x);\nx[0] // 1\ny[0] // 1\n\nx[0] = 2;\ny[0] // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»yæ¯ä»¥æ°ç»xä¸ºæ¨¡æ¿èçæçï¼å½xåå¨çæ¶åï¼yå¹¶æ²¡æåå¨ã\n\nå¦ææ³åºäºåä¸æ®µåå­ï¼æé ä¸åçè§å¾ï¼å¯ä»¥éç¨ä¸é¢çåæ³ã\n\nconst x = new Int8Array([1, 1]);\nconst y = new Int8Array(x.buffer);\nx[0] // 1\ny[0] // 1\n\nx[0] = 2;\ny[0] // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nï¼4ï¼TypedArray(arrayLikeObject)\n\næé å½æ°çåæ°ä¹å¯ä»¥æ¯ä¸ä¸ªæ®éæ°ç»ï¼ç¶åç´æ¥çæTypedArrayå®ä¾ã\n\nconst typedArray = new Uint8Array([1, 2, 3, 4]);\n\n\n1\n\n\næ³¨æï¼è¿æ¶TypedArrayè§å¾ä¼éæ°å¼è¾åå­ï¼ä¸ä¼å¨åæ°ç»çåå­ä¸å»ºç«è§å¾ã\n\nä¸é¢ä»£ç ä»ä¸ä¸ªæ®éçæ°ç»ï¼çæä¸ä¸ª 8 ä½æ ç¬¦å·æ´æ°çTypedArrayå®ä¾ã\n\nTypedArray æ°ç»ä¹å¯ä»¥è½¬æ¢åæ®éæ°ç»ã\n\nconst normalArray = [...typedArray];\n// or\nconst normalArray = Array.from(typedArray);\n// or\nconst normalArray = Array.prototype.slice.call(typedArray);\n\n\n1\n2\n3\n4\n5\n\n\n\n# æ°ç»æ¹æ³\n\næ®éæ°ç»çæä½æ¹æ³åå±æ§ï¼å¯¹ TypedArray æ°ç»å®å¨éç¨ã\n\n * TypedArray.prototype.copyWithin(target, start[, end = this.length])\n * TypedArray.prototype.entries()\n * TypedArray.prototype.every(callbackfn, thisArg?)\n * TypedArray.prototype.fill(value, start=0, end=this.length)\n * TypedArray.prototype.filter(callbackfn, thisArg?)\n * TypedArray.prototype.find(predicate, thisArg?)\n * TypedArray.prototype.findIndex(predicate, thisArg?)\n * TypedArray.prototype.forEach(callbackfn, thisArg?)\n * TypedArray.prototype.indexOf(searchElement, fromIndex=0)\n * TypedArray.prototype.join(separator)\n * TypedArray.prototype.keys()\n * TypedArray.prototype.lastIndexOf(searchElement, fromIndex?)\n * TypedArray.prototype.map(callbackfn, thisArg?)\n * TypedArray.prototype.reduce(callbackfn, initialValue?)\n * TypedArray.prototype.reduceRight(callbackfn, initialValue?)\n * TypedArray.prototype.reverse()\n * TypedArray.prototype.slice(start=0, end=this.length)\n * TypedArray.prototype.some(callbackfn, thisArg?)\n * TypedArray.prototype.sort(comparefn)\n * TypedArray.prototype.toLocaleString(reserved1?, reserved2?)\n * TypedArray.prototype.toString()\n * TypedArray.prototype.values()\n\nä¸é¢æææ¹æ³çç¨æ³ï¼è¯·åéæ°ç»æ¹æ³çä»ç»ï¼è¿éä¸åéå¤äºã\n\næ³¨æï¼TypedArray æ°ç»æ²¡æconcatæ¹æ³ãå¦ææ³è¦åå¹¶å¤ä¸ª TypedArray æ°ç»ï¼å¯ä»¥ç¨ä¸é¢è¿ä¸ªå½æ°ã\n\nfunction concatenate(resultConstructor, ...arrays) {\n  let totalLength = 0;\n  for (let arr of arrays) {\n    totalLength += arr.length;\n  }\n  let result = new resultConstructor(totalLength);\n  let offset = 0;\n  for (let arr of arrays) {\n    result.set(arr, offset);\n    offset += arr.length;\n  }\n  return result;\n}\n\nconcatenate(Uint8Array, Uint8Array.of(1, 2), Uint8Array.of(3, 4))\n// Uint8Array [1, 2, 3, 4]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nå¦å¤ï¼TypedArray æ°ç»ä¸æ®éæ°ç»ä¸æ ·ï¼é¨ç½²äº Iterator æ¥å£ï¼æä»¥å¯ä»¥è¢«éåã\n\nlet ui8 = Uint8Array.of(0, 1, 2);\nfor (let byte of ui8) {\n  console.log(byte);\n}\n// 0\n// 1\n// 2\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# å­èåº\n\nå­èåºæçæ¯æ°å¼å¨åå­ä¸­çè¡¨ç¤ºæ¹å¼ã\n\nconst buffer = new ArrayBuffer(16);\nconst int32View = new Int32Array(buffer);\n\nfor (let i = 0; i < int32View.length; i++) {\n  int32View[i] = i * 2;\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çæä¸ä¸ª 16 å­èçArrayBufferå¯¹è±¡ï¼ç¶åå¨å®çåºç¡ä¸ï¼å»ºç«äºä¸ä¸ª 32 ä½æ´æ°çè§å¾ãç±äºæ¯ä¸ª 32 ä½æ´æ°å æ® 4 ä¸ªå­èï¼æä»¥ä¸å±å¯ä»¥åå¥ 4 ä¸ªæ´æ°ï¼ä¾æ¬¡ä¸º 0ï¼2ï¼4ï¼6ã\n\nå¦æå¨è¿æ®µæ°æ®ä¸æ¥çå»ºç«ä¸ä¸ª 16 ä½æ´æ°çè§å¾ï¼åå¯ä»¥è¯»åºå®å¨ä¸ä¸æ ·çç»æã\n\nconst int16View = new Int16Array(buffer);\n\nfor (let i = 0; i < int16View.length; i++) {\n  console.log(\"Entry \" + i + \": \" + int16View[i]);\n}\n// Entry 0: 0\n// Entry 1: 0\n// Entry 2: 2\n// Entry 3: 0\n// Entry 4: 4\n// Entry 5: 0\n// Entry 6: 6\n// Entry 7: 0\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nç±äºæ¯ä¸ª 16 ä½æ´æ°å æ® 2 ä¸ªå­èï¼æä»¥æ´ä¸ªArrayBufferå¯¹è±¡ç°å¨åæ 8 æ®µãç¶åï¼ç±äº x86 ä½ç³»çè®¡ç®æºé½éç¨å°ç«¯å­èåºï¼little endianï¼ï¼ç¸å¯¹éè¦çå­èæå¨åé¢çåå­å°åï¼ç¸å¯¹ä¸éè¦å­èæå¨åé¢çåå­å°åï¼æä»¥å°±å¾å°äºä¸é¢çç»æã\n\næ¯å¦ï¼ä¸ä¸ªå æ®åä¸ªå­èç 16 è¿å¶æ°0x12345678ï¼å³å®å¶å¤§å°çæéè¦çå­èæ¯â12âï¼æä¸éè¦çæ¯â78âãå°ç«¯å­èåºå°æä¸éè¦çå­èæå¨åé¢ï¼å¨å­é¡ºåºå°±æ¯78563412ï¼å¤§ç«¯å­èåºåå®å¨ç¸åï¼å°æéè¦çå­èæå¨åé¢ï¼å¨å­é¡ºåºå°±æ¯12345678ãç®åï¼ææä¸ªäººçµèå ä¹é½æ¯å°ç«¯å­èåºï¼æä»¥ TypedArray æ°ç»åé¨ä¹éç¨å°ç«¯å­èåºè¯»åæ°æ®ï¼æèæ´åç¡®çè¯´ï¼æç§æ¬æºæä½ç³»ç»è®¾å®çå­èåºè¯»åæ°æ®ã\n\nè¿å¹¶ä¸æå³å¤§ç«¯å­èåºä¸éè¦ï¼äºå®ä¸ï¼å¾å¤ç½ç»è®¾å¤åç¹å®çæä½ç³»ç»éç¨çæ¯å¤§ç«¯å­èåºãè¿å°±å¸¦æ¥ä¸ä¸ªä¸¥éçé®é¢ï¼å¦æä¸æ®µæ°æ®æ¯å¤§ç«¯å­èåºï¼TypedArray æ°ç»å°æ æ³æ­£ç¡®è§£æï¼å ä¸ºå®åªè½å¤çå°ç«¯å­èåºï¼ä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼JavaScript å¼å¥DataViewå¯¹è±¡ï¼å¯ä»¥è®¾å®å­èåºï¼ä¸æä¼è¯¦ç»ä»ç»ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\n// åå®ææ®µbufferåå«å¦ä¸å­è [0x02, 0x01, 0x03, 0x07]\nconst buffer = new ArrayBuffer(4);\nconst v1 = new Uint8Array(buffer);\nv1[0] = 2;\nv1[1] = 1;\nv1[2] = 3;\nv1[3] = 7;\n\nconst uInt16View = new Uint16Array(buffer);\n\n// è®¡ç®æºéç¨å°ç«¯å­èåº\n// æä»¥å¤´ä¸¤ä¸ªå­èç­äº258\nif (uInt16View[0] === 258) {\n  console.log('OK'); // \"OK\"\n}\n\n// èµå¼è¿ç®\nuInt16View[0] = 255;    // å­èåä¸º[0xFF, 0x00, 0x03, 0x07]\nuInt16View[0] = 0xff05; // å­èåä¸º[0x05, 0xFF, 0x03, 0x07]\nuInt16View[1] = 0x0210; // å­èåä¸º[0x05, 0xFF, 0x10, 0x02]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¸é¢çå½æ°å¯ä»¥ç¨æ¥å¤æ­ï¼å½åè§å¾æ¯å°ç«¯å­èåºï¼è¿æ¯å¤§ç«¯å­èåºã\n\nconst BIG_ENDIAN = Symbol('BIG_ENDIAN');\nconst LITTLE_ENDIAN = Symbol('LITTLE_ENDIAN');\n\nfunction getPlatformEndianness() {\n  let arr32 = Uint32Array.of(0x12345678);\n  let arr8 = new Uint8Array(arr32.buffer);\n  switch ((arr8[0]*0x1000000) + (arr8[1]*0x10000) + (arr8[2]*0x100) + (arr8[3])) {\n    case 0x12345678:\n      return BIG_ENDIAN;\n    case 0x78563412:\n      return LITTLE_ENDIAN;\n    default:\n      throw new Error('Unknown endianness');\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\næ»ä¹ï¼ä¸æ®éæ°ç»ç¸æ¯ï¼TypedArray æ°ç»çæå¤§ä¼ç¹å°±æ¯å¯ä»¥ç´æ¥æä½åå­ï¼ä¸éè¦æ°æ®ç±»åè½¬æ¢ï¼æä»¥éåº¦å¿«å¾å¤ã\n\n\n# BYTES_PER_ELEMENT å±æ§\n\næ¯ä¸ç§è§å¾çæé å½æ°ï¼é½æä¸ä¸ªBYTES_PER_ELEMENTå±æ§ï¼è¡¨ç¤ºè¿ç§æ°æ®ç±»åå æ®çå­èæ°ã\n\nInt8Array.BYTES_PER_ELEMENT // 1\nUint8Array.BYTES_PER_ELEMENT // 1\nUint8ClampedArray.BYTES_PER_ELEMENT // 1\nInt16Array.BYTES_PER_ELEMENT // 2\nUint16Array.BYTES_PER_ELEMENT // 2\nInt32Array.BYTES_PER_ELEMENT // 4\nUint32Array.BYTES_PER_ELEMENT // 4\nFloat32Array.BYTES_PER_ELEMENT // 4\nFloat64Array.BYTES_PER_ELEMENT // 8\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nè¿ä¸ªå±æ§å¨TypedArrayå®ä¾ä¸ä¹è½è·åï¼å³æTypedArray.prototype.BYTES_PER_ELEMENTã\n\n\n# ArrayBuffer ä¸å­ç¬¦ä¸²çäºç¸è½¬æ¢\n\nArrayBuffer åå­ç¬¦ä¸²çç¸äºè½¬æ¢ï¼ä½¿ç¨åç TextEncoder å TextDecoder æ¹æ³ãä¸ºäºä¾¿äºè¯´æç¨æ³ï¼ä¸é¢çä»£ç é½æç§ TypeScript çç¨æ³ï¼ç»åºäºç±»åç­¾åã\n\n/**\n * Convert ArrayBuffer/TypedArray to String via TextDecoder\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/TextDecoder\n */\nfunction ab2str(\n  input: ArrayBuffer | Uint8Array | Int8Array | Uint16Array | Int16Array | Uint32Array | Int32Array,\n  outputEncoding: string = 'utf8',\n): string {\n  const decoder = new TextDecoder(outputEncoding)\n  return decoder.decode(input)\n}\n\n/**\n * Convert String to ArrayBuffer via TextEncoder\n *\n * @see https://developer.mozilla.org/zh-CN/docs/Web/API/TextEncoder\n */\nfunction str2ab(input: string): ArrayBuffer {\n  const view = str2Uint8Array(input)\n  return view.buffer\n}\n\n/** Convert String to Uint8Array */\nfunction str2Uint8Array(input: string): Uint8Array {\n  const encoder = new TextEncoder()\n  const view = encoder.encode(input)\n  return view\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nä¸é¢ä»£ç ä¸­ï¼ab2str()çç¬¬äºä¸ªåæ°outputEncodingç»åºäºè¾åºç¼ç çç¼ç ï¼ä¸è¬ä¿æé»è®¤å¼ï¼utf-8ï¼ï¼å¶ä»å¯éå¼åè§å®æ¹ææ¡£æ Node.js ææ¡£ã\n\n\n# æº¢åº\n\nä¸åçè§å¾ç±»åï¼æè½å®¹çº³çæ°å¼èå´æ¯ç¡®å®çãè¶åºè¿ä¸ªèå´ï¼å°±ä¼åºç°æº¢åºãæ¯å¦ï¼8 ä½è§å¾åªè½å®¹çº³ä¸ä¸ª 8 ä½çäºè¿å¶å¼ï¼å¦ææ¾å¥ä¸ä¸ª 9 ä½çå¼ï¼å°±ä¼æº¢åºã\n\nTypedArray æ°ç»çæº¢åºå¤çè§åï¼ç®åæ¥è¯´ï¼å°±æ¯æå¼æº¢åºçä½ï¼ç¶åæç§è§å¾ç±»åè¿è¡è§£éã\n\nconst uint8 = new Uint8Array(1);\n\nuint8[0] = 256;\nuint8[0] // 0\n\nuint8[0] = -1;\nuint8[0] // 255\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼uint8æ¯ä¸ä¸ª 8 ä½è§å¾ï¼è 256 çäºè¿å¶å½¢å¼æ¯ä¸ä¸ª 9 ä½çå¼100000000ï¼è¿æ¶å°±ä¼åçæº¢åºãæ ¹æ®è§åï¼åªä¼ä¿çå 8 ä½ï¼å³00000000ãuint8è§å¾çè§£éè§åæ¯æ ç¬¦å·ç 8 ä½æ´æ°ï¼æä»¥00000000å°±æ¯0ã\n\nè´æ°å¨è®¡ç®æºåé¨éç¨â2 çè¡¥ç âè¡¨ç¤ºï¼ä¹å°±æ¯è¯´ï¼å°å¯¹åºçæ­£æ°å¼è¿è¡å¦è¿ç®ï¼ç¶åå 1ãæ¯å¦ï¼-1å¯¹åºçæ­£å¼æ¯1ï¼è¿è¡å¦è¿ç®ä»¥åï¼å¾å°11111110ï¼åå ä¸1å°±æ¯è¡¥ç å½¢å¼11111111ãuint8æç§æ ç¬¦å·ç 8 ä½æ´æ°è§£é11111111ï¼è¿åç»æå°±æ¯255ã\n\nä¸ä¸ªç®åè½¬æ¢è§åï¼å¯ä»¥è¿æ ·è¡¨ç¤ºã\n\n * æ­£åæº¢åºï¼overflowï¼ï¼å½è¾å¥å¼å¤§äºå½åæ°æ®ç±»åçæå¤§å¼ï¼ç»æç­äºå½åæ°æ®ç±»åçæå°å¼å ä¸ä½å¼ï¼ååå» 1ã\n * è´åæº¢åºï¼underflowï¼ï¼å½è¾å¥å¼å°äºå½åæ°æ®ç±»åçæå°å¼ï¼ç»æç­äºå½åæ°æ®ç±»åçæå¤§å¼åå»ä½å¼çç»å¯¹å¼ï¼åå ä¸ 1ã\n\nä¸é¢çâä½å¼âå°±æ¯æ¨¡è¿ç®çç»æï¼å³ JavaScript éé¢ç%è¿ç®ç¬¦çç»æã\n\n12 % 4 // 0\n12 % 5 // 2\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼12 é¤ä»¥ 4 æ¯æ²¡æä½å¼çï¼èé¤ä»¥ 5 ä¼å¾å°ä½å¼ 2ã\n\nè¯·çä¸é¢çä¾å­ã\n\nconst int8 = new Int8Array(1);\n\nint8[0] = 128;\nint8[0] // -128\n\nint8[0] = -129;\nint8[0] // 127\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä¾å­ä¸­ï¼int8æ¯ä¸ä¸ªå¸¦ç¬¦å·ç 8 ä½æ´æ°è§å¾ï¼å®çæå¤§å¼æ¯ 127ï¼æå°å¼æ¯-128ãè¾å¥å¼ä¸º128æ¶ï¼ç¸å½äºæ­£åæº¢åº1ï¼æ ¹æ®âæå°å¼å ä¸ä½å¼ï¼128 é¤ä»¥ 127 çä½å¼æ¯ 1ï¼ï¼ååå» 1âçè§åï¼å°±ä¼è¿å-128ï¼è¾å¥å¼ä¸º-129æ¶ï¼ç¸å½äºè´åæº¢åº1ï¼æ ¹æ®âæå¤§å¼åå»ä½å¼çç»å¯¹å¼ï¼-129 é¤ä»¥-128 çä½å¼çç»å¯¹å¼æ¯ 1ï¼ï¼åå ä¸ 1âçè§åï¼å°±ä¼è¿å127ã\n\nUint8ClampedArrayè§å¾çæº¢åºè§åï¼ä¸ä¸é¢çè§åä¸åãå®è§å®ï¼å¡æ¯åçæ­£åæº¢åºï¼è¯¥å¼ä¸å¾ç­äºå½åæ°æ®ç±»åçæå¤§å¼ï¼å³ 255ï¼å¦æåçè´åæº¢åºï¼è¯¥å¼ä¸å¾ç­äºå½åæ°æ®ç±»åçæå°å¼ï¼å³ 0ã\n\nconst uint8c = new Uint8ClampedArray(1);\n\nuint8c[0] = 256;\nuint8c[0] // 255\n\nuint8c[0] = -1;\nuint8c[0] // 0\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä¾å­ä¸­ï¼uint8Cæ¯ä¸ä¸ªUint8ClampedArrayè§å¾ï¼æ­£åæº¢åºæ¶é½è¿å 255ï¼è´åæº¢åºé½è¿å 0ã\n\n\n# TypedArray.prototype.buffer\n\nTypedArrayå®ä¾çbufferå±æ§ï¼è¿åæ´æ®µåå­åºåå¯¹åºçArrayBufferå¯¹è±¡ãè¯¥å±æ§ä¸ºåªè¯»å±æ§ã\n\nconst a = new Float32Array(64);\nconst b = new Uint8Array(a.buffer);\n\n\n1\n2\n\n\nä¸é¢ä»£ç çaè§å¾å¯¹è±¡åbè§å¾å¯¹è±¡ï¼å¯¹åºåä¸ä¸ªArrayBufferå¯¹è±¡ï¼å³åä¸æ®µåå­ã\n\n\n# TypedArray.prototype.byteLengthï¼TypedArray.prototype.byteOffset\n\nbyteLengthå±æ§è¿å TypedArray æ°ç»å æ®çåå­é¿åº¦ï¼åä½ä¸ºå­èãbyteOffsetå±æ§è¿å TypedArray æ°ç»ä»åºå±ArrayBufferå¯¹è±¡çåªä¸ªå­èå¼å§ãè¿ä¸¤ä¸ªå±æ§é½æ¯åªè¯»å±æ§ã\n\nconst b = new ArrayBuffer(8);\n\nconst v1 = new Int32Array(b);\nconst v2 = new Uint8Array(b, 2);\nconst v3 = new Int16Array(b, 2, 2);\n\nv1.byteLength // 8\nv2.byteLength // 6\nv3.byteLength // 4\n\nv1.byteOffset // 0\nv2.byteOffset // 2\nv3.byteOffset // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# TypedArray.prototype.length\n\nlengthå±æ§è¡¨ç¤º TypedArray æ°ç»å«æå¤å°ä¸ªæåãæ³¨æå° length å±æ§å byteLength å±æ§åºåï¼åèæ¯æåé¿åº¦ï¼åèæ¯å­èé¿åº¦ã\n\nconst a = new Int16Array(8);\n\na.length // 8\na.byteLength // 16\n\n\n1\n2\n3\n4\n\n\n\n# TypedArray.prototype.set()\n\nTypedArray æ°ç»çsetæ¹æ³ç¨äºå¤å¶æ°ç»ï¼æ®éæ°ç»æ TypedArray æ°ç»ï¼ï¼ä¹å°±æ¯å°ä¸æ®µåå®¹å®å¨å¤å¶å°å¦ä¸æ®µåå­ã\n\nconst a = new Uint8Array(8);\nconst b = new Uint8Array(8);\n\nb.set(a);\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç å¤å¶aæ°ç»çåå®¹å°bæ°ç»ï¼å®æ¯æ´æ®µåå­çå¤å¶ï¼æ¯ä¸ä¸ªä¸ªæ·è´æåçé£ç§å¤å¶å¿«å¾å¤ã\n\nsetæ¹æ³è¿å¯ä»¥æ¥åç¬¬äºä¸ªåæ°ï¼è¡¨ç¤ºä»bå¯¹è±¡çåªä¸ä¸ªæåå¼å§å¤å¶aå¯¹è±¡ã\n\nconst a = new Uint16Array(8);\nconst b = new Uint16Array(10);\n\nb.set(a, 2)\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç çbæ°ç»æ¯aæ°ç»å¤ä¸¤ä¸ªæåï¼æä»¥ä»b[2]å¼å§å¤å¶ã\n\n\n# TypedArray.prototype.subarray()\n\nsubarrayæ¹æ³æ¯å¯¹äº TypedArray æ°ç»çä¸é¨åï¼åå»ºç«ä¸ä¸ªæ°çè§å¾ã\n\nconst a = new Uint16Array(8);\nconst b = a.subarray(2,3);\n\na.byteLength // 16\nb.byteLength // 2\n\n\n1\n2\n3\n4\n5\n\n\nsubarrayæ¹æ³çç¬¬ä¸ä¸ªåæ°æ¯èµ·å§çæååºå·ï¼ç¬¬äºä¸ªåæ°æ¯ç»æçæååºå·ï¼ä¸å«è¯¥æåï¼ï¼å¦æçç¥ååå«å©ä½çå¨é¨æåãæä»¥ï¼ä¸é¢ä»£ç ça.subarray(2,3)ï¼æå³ç b åªåå«a[2]ä¸ä¸ªæåï¼å­èé¿åº¦ä¸º 2ã\n\n\n# TypedArray.prototype.slice()\n\nTypeArray å®ä¾çsliceæ¹æ³ï¼å¯ä»¥è¿åä¸ä¸ªæå®ä½ç½®çæ°çTypedArrayå®ä¾ã\n\nlet ui8 = Uint8Array.of(0, 1, 2);\nui8.slice(-1)\n// Uint8Array [ 2 ]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼ui8æ¯ 8 ä½æ ç¬¦å·æ´æ°æ°ç»è§å¾çä¸ä¸ªå®ä¾ãå®çsliceæ¹æ³å¯ä»¥ä»å½åè§å¾ä¹ä¸­ï¼è¿åä¸ä¸ªæ°çè§å¾å®ä¾ã\n\nsliceæ¹æ³çåæ°ï¼è¡¨ç¤ºåæ°ç»çå·ä½ä½ç½®ï¼å¼å§çææ°æ°ç»ãè´å¼è¡¨ç¤ºéåçä½ç½®ï¼å³-1 ä¸ºåæ°ç¬¬ä¸ä¸ªä½ç½®ï¼-2 è¡¨ç¤ºåæ°ç¬¬äºä¸ªä½ç½®ï¼ä»¥æ­¤ç±»æ¨ã\n\n\n# TypedArray.of()\n\nTypedArray æ°ç»çæææé å½æ°ï¼é½æä¸ä¸ªéææ¹æ³ofï¼ç¨äºå°åæ°è½¬ä¸ºä¸ä¸ªTypedArrayå®ä¾ã\n\nFloat32Array.of(0.151, -8, 3.7)\n// Float32Array [ 0.151, -8, 3.7 ]\n\n\n1\n2\n\n\nä¸é¢ä¸ç§æ¹æ³é½ä¼çæåæ ·ä¸ä¸ª TypedArray æ°ç»ã\n\n// æ¹æ³ä¸\nlet tarr = new Uint8Array([1,2,3]);\n\n// æ¹æ³äº\nlet tarr = Uint8Array.of(1,2,3);\n\n// æ¹æ³ä¸\nlet tarr = new Uint8Array(3);\ntarr[0] = 1;\ntarr[1] = 2;\ntarr[2] = 3;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# TypedArray.from()\n\néææ¹æ³fromæ¥åä¸ä¸ªå¯éåçæ°æ®ç»æï¼æ¯å¦æ°ç»ï¼ä½ä¸ºåæ°ï¼è¿åä¸ä¸ªåºäºè¿ä¸ªç»æçTypedArrayå®ä¾ã\n\nUint16Array.from([0, 1, 2])\n// Uint16Array [ 0, 1, 2 ]\n\n\n1\n2\n\n\nè¿ä¸ªæ¹æ³è¿å¯ä»¥å°ä¸ç§TypedArrayå®ä¾ï¼è½¬ä¸ºå¦ä¸ç§ã\n\nconst ui16 = Uint16Array.from(Uint8Array.of(0, 1, 2));\nui16 instanceof Uint16Array // true\n\n\n1\n2\n\n\nfromæ¹æ³è¿å¯ä»¥æ¥åä¸ä¸ªå½æ°ï¼ä½ä¸ºç¬¬äºä¸ªåæ°ï¼ç¨æ¥å¯¹æ¯ä¸ªåç´ è¿è¡éåï¼åè½ç±»ä¼¼mapæ¹æ³ã\n\nInt8Array.of(127, 126, 125).map(x => 2 * x)\n// Int8Array [ -2, -4, -6 ]\n\nInt16Array.from(Int8Array.of(127, 126, 125), x => 2 * x)\n// Int16Array [ 254, 252, 250 ]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çä¾å­ä¸­ï¼fromæ¹æ³æ²¡æåçæº¢åºï¼è¿è¯´æéåä¸æ¯éå¯¹åæ¥ç 8 ä½æ´æ°æ°ç»ãä¹å°±æ¯è¯´ï¼fromä¼å°ç¬¬ä¸ä¸ªåæ°æå®ç TypedArray æ°ç»ï¼æ·è´å°å¦ä¸æ®µåå­ä¹ä¸­ï¼å¤çä¹ååå°ç»æè½¬ææå®çæ°ç»æ ¼å¼ã\n\n\n# å¤åè§å¾\n\nç±äºè§å¾çæé å½æ°å¯ä»¥æå®èµ·å§ä½ç½®åé¿åº¦ï¼æä»¥å¨åä¸æ®µåå­ä¹ä¸­ï¼å¯ä»¥ä¾æ¬¡å­æ¾ä¸åç±»åçæ°æ®ï¼è¿å«åâå¤åè§å¾âã\n\nconst buffer = new ArrayBuffer(24);\n\nconst idView = new Uint32Array(buffer, 0, 1);\nconst usernameView = new Uint8Array(buffer, 4, 16);\nconst amountDueView = new Float32Array(buffer, 20, 1);\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç å°ä¸ä¸ª 24 å­èé¿åº¦çArrayBufferå¯¹è±¡ï¼åæä¸ä¸ªé¨åï¼\n\n * å­è 0 å°å­è 3ï¼1 ä¸ª 32 ä½æ ç¬¦å·æ´æ°\n * å­è 4 å°å­è 19ï¼16 ä¸ª 8 ä½æ´æ°\n * å­è 20 å°å­è 23ï¼1 ä¸ª 32 ä½æµ®ç¹æ°\n\nè¿ç§æ°æ®ç»æå¯ä»¥ç¨å¦ä¸ç C è¯­è¨æè¿°ï¼\n\nstruct someStruct {\n  unsigned long id;\n  char username[16];\n  float amountDue;\n};\n\n\n1\n2\n3\n4\n5\n\n\n\n# DataView è§å¾\n\nå¦æä¸æ®µæ°æ®åæ¬å¤ç§ç±»åï¼æ¯å¦æå¡å¨ä¼ æ¥ç HTTP æ°æ®ï¼ï¼è¿æ¶é¤äºå»ºç«ArrayBufferå¯¹è±¡çå¤åè§å¾ä»¥å¤ï¼è¿å¯ä»¥éè¿DataViewè§å¾è¿è¡æä½ã\n\nDataViewè§å¾æä¾æ´å¤æä½éé¡¹ï¼èä¸æ¯æè®¾å®å­èåºãæ¬æ¥ï¼å¨è®¾è®¡ç®çä¸ï¼ArrayBufferå¯¹è±¡çåç§TypedArrayè§å¾ï¼æ¯ç¨æ¥åç½å¡ãå£°å¡ä¹ç±»çæ¬æºè®¾å¤ä¼ éæ°æ®ï¼æä»¥ä½¿ç¨æ¬æºçå­èåºå°±å¯ä»¥äºï¼èDataViewè§å¾çè®¾è®¡ç®çï¼æ¯ç¨æ¥å¤çç½ç»è®¾å¤ä¼ æ¥çæ°æ®ï¼æä»¥å¤§ç«¯å­èåºæå°ç«¯å­èåºæ¯å¯ä»¥èªè¡è®¾å®çã\n\nDataViewè§å¾æ¬èº«ä¹æ¯æé å½æ°ï¼æ¥åä¸ä¸ªArrayBufferå¯¹è±¡ä½ä¸ºåæ°ï¼çæè§å¾ã\n\nDataView(ArrayBuffer buffer [, å­èèµ·å§ä½ç½® [, é¿åº¦]]);\n\n\n1\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nconst buffer = new ArrayBuffer(24);\nconst dv = new DataView(buffer);\n\n\n1\n2\n\n\nDataViewå®ä¾æä»¥ä¸å±æ§ï¼å«ä¹ä¸TypedArrayå®ä¾çååæ¹æ³ç¸åã\n\n * DataView.prototype.bufferï¼è¿åå¯¹åºç ArrayBuffer å¯¹è±¡\n * DataView.prototype.byteLengthï¼è¿åå æ®çåå­å­èé¿åº¦\n * DataView.prototype.byteOffsetï¼è¿åå½åè§å¾ä»å¯¹åºç ArrayBuffer å¯¹è±¡çåªä¸ªå­èå¼å§\n\nDataViewå®ä¾æä¾ 8 ä¸ªæ¹æ³è¯»ååå­ã\n\n * getInt8ï¼è¯»å 1 ä¸ªå­èï¼è¿åä¸ä¸ª 8 ä½æ´æ°ã\n * getUint8ï¼è¯»å 1 ä¸ªå­èï¼è¿åä¸ä¸ªæ ç¬¦å·ç 8 ä½æ´æ°ã\n * getInt16ï¼è¯»å 2 ä¸ªå­èï¼è¿åä¸ä¸ª 16 ä½æ´æ°ã\n * getUint16ï¼è¯»å 2 ä¸ªå­èï¼è¿åä¸ä¸ªæ ç¬¦å·ç 16 ä½æ´æ°ã\n * getInt32ï¼è¯»å 4 ä¸ªå­èï¼è¿åä¸ä¸ª 32 ä½æ´æ°ã\n * getUint32ï¼è¯»å 4 ä¸ªå­èï¼è¿åä¸ä¸ªæ ç¬¦å·ç 32 ä½æ´æ°ã\n * getFloat32ï¼è¯»å 4 ä¸ªå­èï¼è¿åä¸ä¸ª 32 ä½æµ®ç¹æ°ã\n * getFloat64ï¼è¯»å 8 ä¸ªå­èï¼è¿åä¸ä¸ª 64 ä½æµ®ç¹æ°ã\n\nè¿ä¸ç³»ågetæ¹æ³çåæ°é½æ¯ä¸ä¸ªå­èåºå·ï¼ä¸è½æ¯è´æ°ï¼å¦åä¼æ¥éï¼ï¼è¡¨ç¤ºä»åªä¸ªå­èå¼å§è¯»åã\n\nconst buffer = new ArrayBuffer(24);\nconst dv = new DataView(buffer);\n\n// ä»ç¬¬1ä¸ªå­èè¯»åä¸ä¸ª8ä½æ ç¬¦å·æ´æ°\nconst v1 = dv.getUint8(0);\n\n// ä»ç¬¬2ä¸ªå­èè¯»åä¸ä¸ª16ä½æ ç¬¦å·æ´æ°\nconst v2 = dv.getUint16(1);\n\n// ä»ç¬¬4ä¸ªå­èè¯»åä¸ä¸ª16ä½æ ç¬¦å·æ´æ°\nconst v3 = dv.getUint16(3);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç è¯»åäºArrayBufferå¯¹è±¡çå 5 ä¸ªå­èï¼å¶ä¸­æä¸ä¸ª 8 ä½æ´æ°åä¸¤ä¸ªåå­ä½æ´æ°ã\n\nå¦æä¸æ¬¡è¯»åä¸¤ä¸ªæä¸¤ä¸ªä»¥ä¸å­èï¼å°±å¿é¡»æç¡®æ°æ®çå­å¨æ¹å¼ï¼å°åºæ¯å°ç«¯å­èåºè¿æ¯å¤§ç«¯å­èåºãé»è®¤æåµä¸ï¼DataViewçgetæ¹æ³ä½¿ç¨å¤§ç«¯å­èåºè§£è¯»æ°æ®ï¼å¦æéè¦ä½¿ç¨å°ç«¯å­èåºè§£è¯»ï¼å¿é¡»å¨getæ¹æ³çç¬¬äºä¸ªåæ°æå®trueã\n\n// å°ç«¯å­èåº\nconst v1 = dv.getUint16(1, true);\n\n// å¤§ç«¯å­èåº\nconst v2 = dv.getUint16(3, false);\n\n// å¤§ç«¯å­èåº\nconst v3 = dv.getUint16(3);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nDataView è§å¾æä¾ 8 ä¸ªæ¹æ³åå¥åå­ã\n\n * setInt8ï¼åå¥ 1 ä¸ªå­èç 8 ä½æ´æ°ã\n * setUint8ï¼åå¥ 1 ä¸ªå­èç 8 ä½æ ç¬¦å·æ´æ°ã\n * setInt16ï¼åå¥ 2 ä¸ªå­èç 16 ä½æ´æ°ã\n * setUint16ï¼åå¥ 2 ä¸ªå­èç 16 ä½æ ç¬¦å·æ´æ°ã\n * setInt32ï¼åå¥ 4 ä¸ªå­èç 32 ä½æ´æ°ã\n * setUint32ï¼åå¥ 4 ä¸ªå­èç 32 ä½æ ç¬¦å·æ´æ°ã\n * setFloat32ï¼åå¥ 4 ä¸ªå­èç 32 ä½æµ®ç¹æ°ã\n * setFloat64ï¼åå¥ 8 ä¸ªå­èç 64 ä½æµ®ç¹æ°ã\n\nè¿ä¸ç³»åsetæ¹æ³ï¼æ¥åä¸¤ä¸ªåæ°ï¼ç¬¬ä¸ä¸ªåæ°æ¯å­èåºå·ï¼è¡¨ç¤ºä»åªä¸ªå­èå¼å§åå¥ï¼ç¬¬äºä¸ªåæ°ä¸ºåå¥çæ°æ®ãå¯¹äºé£äºåå¥ä¸¤ä¸ªæä¸¤ä¸ªä»¥ä¸å­èçæ¹æ³ï¼éè¦æå®ç¬¬ä¸ä¸ªåæ°ï¼falseæèundefinedè¡¨ç¤ºä½¿ç¨å¤§ç«¯å­èåºåå¥ï¼trueè¡¨ç¤ºä½¿ç¨å°ç«¯å­èåºåå¥ã\n\n// å¨ç¬¬1ä¸ªå­èï¼ä»¥å¤§ç«¯å­èåºåå¥å¼ä¸º25ç32ä½æ´æ°\ndv.setInt32(0, 25, false);\n\n// å¨ç¬¬5ä¸ªå­èï¼ä»¥å¤§ç«¯å­èåºåå¥å¼ä¸º25ç32ä½æ´æ°\ndv.setInt32(4, 25);\n\n// å¨ç¬¬9ä¸ªå­èï¼ä»¥å°ç«¯å­èåºåå¥å¼ä¸º2.5ç32ä½æµ®ç¹æ°\ndv.setFloat32(8, 2.5, true);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¦æä¸ç¡®å®æ­£å¨ä½¿ç¨çè®¡ç®æºçå­èåºï¼å¯ä»¥éç¨ä¸é¢çå¤æ­æ¹å¼ã\n\nconst littleEndian = (function() {\n  const buffer = new ArrayBuffer(2);\n  new DataView(buffer).setInt16(0, 256, true);\n  return new Int16Array(buffer)[0] === 256;\n})();\n\n\n1\n2\n3\n4\n5\n\n\nå¦æè¿åtrueï¼å°±æ¯å°ç«¯å­èåºï¼å¦æè¿åfalseï¼å°±æ¯å¤§ç«¯å­èåºã\n\n\n# äºè¿å¶æ°ç»çåºç¨\n\nå¤§éç Web API ç¨å°äºArrayBufferå¯¹è±¡åå®çè§å¾å¯¹è±¡ã\n\n\n# AJAX\n\nä¼ ç»ä¸ï¼æå¡å¨éè¿ AJAX æä½åªè½è¿åææ¬æ°æ®ï¼å³responseTypeå±æ§é»è®¤ä¸ºtextãXMLHttpRequestç¬¬äºçXHR2åè®¸æå¡å¨è¿åäºè¿å¶æ°æ®ï¼è¿æ¶åæä¸¤ç§æåµãå¦ææç¡®ç¥éè¿åçäºè¿å¶æ°æ®ç±»åï¼å¯ä»¥æè¿åç±»åï¼responseTypeï¼è®¾ä¸ºarraybufferï¼å¦æä¸ç¥éï¼å°±è®¾ä¸ºblobã\n\nlet xhr = new XMLHttpRequest();\nxhr.open('GET', someUrl);\nxhr.responseType = 'arraybuffer';\n\nxhr.onload = function () {\n  let arrayBuffer = xhr.response;\n  // Â·Â·Â·\n};\n\nxhr.send();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¦æç¥éä¼ åæ¥çæ¯ 32 ä½æ´æ°ï¼å¯ä»¥åä¸é¢è¿æ ·å¤çã\n\nxhr.onreadystatechange = function () {\n  if (req.readyState === 4 ) {\n    const arrayResponse = xhr.response;\n    const dataView = new DataView(arrayResponse);\n    const ints = new Uint32Array(dataView.byteLength / 4);\n\n    xhrDiv.style.backgroundColor = \"#00FF00\";\n    xhrDiv.innerText = \"Array is \" + ints.length + \"uints long\";\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# Canvas\n\nç½é¡µCanvasåç´ è¾åºçäºè¿å¶åç´ æ°æ®ï¼å°±æ¯ TypedArray æ°ç»ã\n\nconst canvas = document.getElementById('myCanvas');\nconst ctx = canvas.getContext('2d');\n\nconst imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\nconst uint8ClampedArray = imageData.data;\n\n\n1\n2\n3\n4\n5\n\n\néè¦æ³¨æçæ¯ï¼ä¸é¢ä»£ç çuint8ClampedArrayè½ç¶æ¯ä¸ä¸ª TypedArray æ°ç»ï¼ä½æ¯å®çè§å¾ç±»åæ¯ä¸ç§éå¯¹Canvasåç´ çä¸æç±»åUint8ClampedArrayãè¿ä¸ªè§å¾ç±»åçç¹ç¹ï¼å°±æ¯ä¸é¨éå¯¹é¢è²ï¼ææ¯ä¸ªå­èè§£è¯»ä¸ºæ ç¬¦å·ç 8 ä½æ´æ°ï¼å³åªè½åå¼ 0 ï½ 255ï¼èä¸åçè¿ç®çæ¶åèªå¨è¿æ»¤é«ä½æº¢åºãè¿ä¸ºå¾åå¤çå¸¦æ¥äºå·¨å¤§çæ¹ä¾¿ã\n\nä¸¾ä¾æ¥è¯´ï¼å¦ææåç´ çé¢è²å¼è®¾ä¸ºUint8Arrayç±»åï¼é£ä¹ä¹ä»¥ä¸ä¸ª gamma å¼çæ¶åï¼å°±å¿é¡»è¿æ ·è®¡ç®ï¼\n\nu8[i] = Math.min(255, Math.max(0, u8[i] * gamma));\n\n\n1\n\n\nå ä¸ºUint8Arrayç±»åå¯¹äºå¤§äº 255 çè¿ç®ç»æï¼æ¯å¦0xFF+1ï¼ï¼ä¼èªå¨åä¸º0x00ï¼æä»¥å¾åå¤çå¿é¡»è¦åä¸é¢è¿æ ·ç®ãè¿æ ·åå¾éº»ç¦ï¼èä¸å½±åæ§è½ãå¦æå°é¢è²å¼è®¾ä¸ºUint8ClampedArrayç±»åï¼è®¡ç®å°±ç®åè®¸å¤ã\n\npixels[i] *= gamma;\n\n\n1\n\n\nUint8ClampedArrayç±»åç¡®ä¿å°å°äº 0 çå¼è®¾ä¸º 0ï¼å°å¤§äº 255 çå¼è®¾ä¸º 255ãæ³¨æï¼IE 10 ä¸æ¯æè¯¥ç±»åã\n\n\n# WebSocket\n\nWebSocketå¯ä»¥éè¿ArrayBufferï¼åéææ¥æ¶äºè¿å¶æ°æ®ã\n\nlet socket = new WebSocket('ws://127.0.0.1:8081');\nsocket.binaryType = 'arraybuffer';\n\n// Wait until socket is open\nsocket.addEventListener('open', function (event) {\n  // Send binary data\n  const typedArray = new Uint8Array(4);\n  socket.send(typedArray.buffer);\n});\n\n// Receive binary data\nsocket.addEventListener('message', function (event) {\n  const arrayBuffer = event.data;\n  // Â·Â·Â·\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# Fetch API\n\nFetch API ååçæ°æ®ï¼å°±æ¯ArrayBufferå¯¹è±¡ã\n\nfetch(url)\n.then(function(response){\n  return response.arrayBuffer()\n})\n.then(function(arrayBuffer){\n  // ...\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# File API\n\nå¦æç¥éä¸ä¸ªæä»¶çäºè¿å¶æ°æ®ç±»åï¼ä¹å¯ä»¥å°è¿ä¸ªæä»¶è¯»åä¸ºArrayBufferå¯¹è±¡ã\n\nconst fileInput = document.getElementById('fileInput');\nconst file = fileInput.files[0];\nconst reader = new FileReader();\nreader.readAsArrayBuffer(file);\nreader.onload = function () {\n  const arrayBuffer = reader.result;\n  // Â·Â·Â·\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»¥å¤ç bmp æä»¶ä¸ºä¾ãåå®fileåéæ¯ä¸ä¸ªæå bmp æä»¶çæä»¶å¯¹è±¡ï¼é¦åè¯»åæä»¶ã\n\nconst reader = new FileReader();\nreader.addEventListener(\"load\", processimage, false);\nreader.readAsArrayBuffer(file);\n\n\n1\n2\n3\n\n\nç¶åï¼å®ä¹å¤çå¾åçåè°å½æ°ï¼åå¨äºè¿å¶æ°æ®ä¹ä¸å»ºç«ä¸ä¸ªDataViewè§å¾ï¼åå»ºç«ä¸ä¸ªbitmapå¯¹è±¡ï¼ç¨äºå­æ¾å¤çåçæ°æ®ï¼æåå°å¾åå±ç¤ºå¨Canvasåç´ ä¹ä¸­ã\n\nfunction processimage(e) {\n  const buffer = e.target.result;\n  const datav = new DataView(buffer);\n  const bitmap = {};\n  // å·ä½çå¤çæ­¥éª¤\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nå·ä½å¤çå¾åæ°æ®æ¶ï¼åå¤ç bmp çæä»¶å¤´ãå·ä½æ¯ä¸ªæä»¶å¤´çæ ¼å¼åå®ä¹ï¼è¯·åéæå³èµæã\n\nbitmap.fileheader = {};\nbitmap.fileheader.bfType = datav.getUint16(0, true);\nbitmap.fileheader.bfSize = datav.getUint32(2, true);\nbitmap.fileheader.bfReserved1 = datav.getUint16(6, true);\nbitmap.fileheader.bfReserved2 = datav.getUint16(8, true);\nbitmap.fileheader.bfOffBits = datav.getUint32(10, true);\n\n\n1\n2\n3\n4\n5\n6\n\n\næ¥çå¤çå¾ååä¿¡æ¯é¨åã\n\nbitmap.infoheader = {};\nbitmap.infoheader.biSize = datav.getUint32(14, true);\nbitmap.infoheader.biWidth = datav.getUint32(18, true);\nbitmap.infoheader.biHeight = datav.getUint32(22, true);\nbitmap.infoheader.biPlanes = datav.getUint16(26, true);\nbitmap.infoheader.biBitCount = datav.getUint16(28, true);\nbitmap.infoheader.biCompression = datav.getUint32(30, true);\nbitmap.infoheader.biSizeImage = datav.getUint32(34, true);\nbitmap.infoheader.biXPelsPerMeter = datav.getUint32(38, true);\nbitmap.infoheader.biYPelsPerMeter = datav.getUint32(42, true);\nbitmap.infoheader.biClrUsed = datav.getUint32(46, true);\nbitmap.infoheader.biClrImportant = datav.getUint32(50, true);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\næåå¤çå¾åæ¬èº«çåç´ ä¿¡æ¯ã\n\nconst start = bitmap.fileheader.bfOffBits;\nbitmap.pixels = new Uint8Array(buffer, start);\n\n\n1\n2\n\n\nè³æ­¤ï¼å¾åæä»¶çæ°æ®å¨é¨å¤çå®æãä¸ä¸æ­¥ï¼å¯ä»¥æ ¹æ®éè¦ï¼è¿è¡å¾ååå½¢ï¼æèè½¬æ¢æ ¼å¼ï¼æèå±ç¤ºå¨Canvasç½é¡µåç´ ä¹ä¸­ã\n\n\n# SharedArrayBuffer\n\nJavaScript æ¯åçº¿ç¨çï¼Web worker å¼å¥äºå¤çº¿ç¨ï¼ä¸»çº¿ç¨ç¨æ¥ä¸ç¨æ·äºå¨ï¼Worker çº¿ç¨ç¨æ¥æ¿æè®¡ç®ä»»å¡ãæ¯ä¸ªçº¿ç¨çæ°æ®é½æ¯éç¦»çï¼éè¿postMessage()éä¿¡ãä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\n// ä¸»çº¿ç¨\nconst w = new Worker('myworker.js');\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸»çº¿ç¨æ°å»ºäºä¸ä¸ª Worker çº¿ç¨ãè¯¥çº¿ç¨ä¸ä¸»çº¿ç¨ä¹é´ä¼æä¸ä¸ªéä¿¡æ¸ éï¼ä¸»çº¿ç¨éè¿w.postMessageå Worker çº¿ç¨åæ¶æ¯ï¼åæ¶éè¿messageäºä»¶çå¬ Worker çº¿ç¨çååºã\n\n// ä¸»çº¿ç¨\nw.postMessage('hi');\nw.onmessage = function (ev) {\n  console.log(ev.data);\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸»çº¿ç¨ååä¸ä¸ªæ¶æ¯hiï¼ç¶åå¨çå¬å° Worker çº¿ç¨çååºåï¼å°±å°å¶æå°åºæ¥ã\n\nWorker çº¿ç¨ä¹æ¯éè¿çå¬messageäºä»¶ï¼æ¥è·åä¸»çº¿ç¨åæ¥çæ¶æ¯ï¼å¹¶ä½åºååºã\n\n// Worker çº¿ç¨\nonmessage = function (ev) {\n  console.log(ev.data);\n  postMessage('ho');\n}\n\n\n1\n2\n3\n4\n5\n\n\nçº¿ç¨ä¹é´çæ°æ®äº¤æ¢å¯ä»¥æ¯åç§æ ¼å¼ï¼ä¸ä»ä»æ¯å­ç¬¦ä¸²ï¼ä¹å¯ä»¥æ¯äºè¿å¶æ°æ®ãè¿ç§äº¤æ¢éç¨çæ¯å¤å¶æºå¶ï¼å³ä¸ä¸ªè¿ç¨å°éè¦åäº«çæ°æ®å¤å¶ä¸ä»½ï¼éè¿postMessageæ¹æ³äº¤ç»å¦ä¸ä¸ªè¿ç¨ãå¦ææ°æ®éæ¯è¾å¤§ï¼è¿ç§éä¿¡çæçæ¾ç¶æ¯è¾ä½ãå¾å®¹ææ³å°ï¼è¿æ¶å¯ä»¥çåºä¸ååå­åºåï¼ç±ä¸»çº¿ç¨ä¸ Worker çº¿ç¨å±äº«ï¼ä¸¤æ¹é½å¯ä»¥è¯»åï¼é£ä¹å°±ä¼å¤§å¤§æé«æçï¼åä½èµ·æ¥ä¹ä¼æ¯è¾ç®åï¼ä¸åpostMessageé£ä¹éº»ç¦ï¼ã\n\nES2017 å¼å¥SharedArrayBufferï¼åè®¸ Worker çº¿ç¨ä¸ä¸»çº¿ç¨å±äº«åä¸ååå­ãSharedArrayBufferç API ä¸ArrayBufferä¸æ¨¡ä¸æ ·ï¼å¯ä¸çåºå«æ¯åèæ æ³å±äº«æ°æ®ã\n\n// ä¸»çº¿ç¨\n\n// æ°å»º 1KB å±äº«åå­\nconst sharedBuffer = new SharedArrayBuffer(1024);\n\n// ä¸»çº¿ç¨å°å±äº«åå­çå°ååéåºå»\nw.postMessage(sharedBuffer);\n\n// å¨å±äº«åå­ä¸å»ºç«è§å¾ï¼ä¾åå¥æ°æ®\nconst sharedArray = new Int32Array(sharedBuffer);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼postMessageæ¹æ³çåæ°æ¯SharedArrayBufferå¯¹è±¡ã\n\nWorker çº¿ç¨ä»äºä»¶çdataå±æ§ä¸é¢åå°æ°æ®ã\n\n// Worker çº¿ç¨\nonmessage = function (ev) {\n  // ä¸»çº¿ç¨å±äº«çæ°æ®ï¼å°±æ¯ 1KB çå±äº«åå­\n  const sharedBuffer = ev.data;\n\n  // å¨å±äº«åå­ä¸å»ºç«è§å¾ï¼æ¹ä¾¿è¯»å\n  const sharedArray = new Int32Array(sharedBuffer);\n\n  // ...\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå±äº«åå­ä¹å¯ä»¥å¨ Worker çº¿ç¨åå»ºï¼åç»ä¸»çº¿ç¨ã\n\nSharedArrayBufferä¸ArrayBufferä¸æ ·ï¼æ¬èº«æ¯æ æ³è¯»åçï¼å¿é¡»å¨ä¸é¢å»ºç«è§å¾ï¼ç¶åéè¿è§å¾è¯»åã\n\n// åé 10 ä¸ä¸ª 32 ä½æ´æ°å æ®çåå­ç©ºé´\nconst sab = new SharedArrayBuffer(Int32Array.BYTES_PER_ELEMENT * 100000);\n\n// å»ºç« 32 ä½æ´æ°è§å¾\nconst ia = new Int32Array(sab);  // ia.length == 100000\n\n// æ°å»ºä¸ä¸ªè´¨æ°çæå¨\nconst primes = new PrimeGenerator();\n\n// å° 10 ä¸ä¸ªè´¨æ°ï¼åå¥è¿æ®µåå­ç©ºé´\nfor ( let i=0 ; i < ia.length ; i++ )\n  ia[i] = primes.next();\n\n// å Worker çº¿ç¨åéè¿æ®µå±äº«åå­\nw.postMessage(ia);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nWorker çº¿ç¨æ¶å°æ°æ®åçå¤çå¦ä¸ã\n\n// Worker çº¿ç¨\nlet ia;\nonmessage = function (ev) {\n  ia = ev.data;\n  console.log(ia.length); // 100000\n  console.log(ia[37]); // è¾åº 163ï¼å ä¸ºè¿æ¯ç¬¬38ä¸ªè´¨æ°\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# Atomics å¯¹è±¡\n\nå¤çº¿ç¨å±äº«åå­ï¼æå¤§çé®é¢å°±æ¯å¦ä½é²æ­¢ä¸¤ä¸ªçº¿ç¨åæ¶ä¿®æ¹æä¸ªå°åï¼æèè¯´ï¼å½ä¸ä¸ªçº¿ç¨ä¿®æ¹å±äº«åå­ä»¥åï¼å¿é¡»æä¸ä¸ªæºå¶è®©å¶ä»çº¿ç¨åæ­¥ãSharedArrayBuffer API æä¾Atomicså¯¹è±¡ï¼ä¿è¯ææå±äº«åå­çæä½é½æ¯âåå­æ§âçï¼å¹¶ä¸å¯ä»¥å¨ææçº¿ç¨ååæ­¥ã\n\nä»ä¹å«âåå­æ§æä½âå¢ï¼ç°ä»£ç¼ç¨è¯­è¨ä¸­ï¼ä¸æ¡æ®éçå½ä»¤è¢«ç¼è¯å¨å¤çä»¥åï¼ä¼åæå¤æ¡æºå¨æä»¤ãå¦ææ¯åçº¿ç¨è¿è¡ï¼è¿æ¯æ²¡æé®é¢çï¼å¤çº¿ç¨ç¯å¢å¹¶ä¸å±äº«åå­æ¶ï¼å°±ä¼åºé®é¢ï¼å ä¸ºè¿ä¸ç»æºå¨æä»¤çè¿è¡æé´ï¼å¯è½ä¼æå¥å¶ä»çº¿ç¨çæä»¤ï¼ä»èå¯¼è´è¿è¡ç»æåºéãè¯·çä¸é¢çä¾å­ã\n\n// ä¸»çº¿ç¨\nia[42] = 314159;  // ååçå¼ 191\nia[37] = 123456;  // ååçå¼ 163\n\n// Worker çº¿ç¨\nconsole.log(ia[37]);\nconsole.log(ia[42]);\n// å¯è½çç»æ\n// 123456\n// 191\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸»çº¿ç¨çåå§é¡ºåºæ¯åå¯¹ 42 å·ä½ç½®èµå¼ï¼åå¯¹ 37 å·ä½ç½®èµå¼ãä½æ¯ï¼ç¼è¯å¨å CPU ä¸ºäºä¼åï¼å¯è½ä¼æ¹åè¿ä¸¤ä¸ªæä½çæ§è¡é¡ºåºï¼å ä¸ºå®ä»¬ä¹é´äºä¸ä¾èµï¼ï¼åå¯¹ 37 å·ä½ç½®èµå¼ï¼åå¯¹ 42 å·ä½ç½®èµå¼ãèæ§è¡å°ä¸åçæ¶åï¼Worker çº¿ç¨å¯è½å°±ä¼æ¥è¯»åæ°æ®ï¼å¯¼è´æå°åº123456å191ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\n// ä¸»çº¿ç¨\nconst sab = new SharedArrayBuffer(Int32Array.BYTES_PER_ELEMENT * 100000);\nconst ia = new Int32Array(sab);\n\nfor (let i = 0; i < ia.length; i++) {\n  ia[i] = primes.next(); // å°è´¨æ°æ¾å¥ ia\n}\n\n// worker çº¿ç¨\nia[112]++; // éè¯¯\nAtomics.add(ia, 112, 1); // æ­£ç¡®\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼Worker çº¿ç¨ç´æ¥æ¹åå±äº«åå­ia[112]++æ¯ä¸æ­£ç¡®çãå ä¸ºè¿è¡è¯­å¥ä¼è¢«ç¼è¯æå¤æ¡æºå¨æä»¤ï¼è¿äºæä»¤ä¹é´æ æ³ä¿è¯ä¸ä¼æå¥å¶ä»è¿ç¨çæä»¤ãè¯·è®¾æ³å¦æä¸¤ä¸ªçº¿ç¨åæ¶ia[112]++ï¼å¾å¯è½å®ä»¬å¾å°çç»æé½æ¯ä¸æ­£ç¡®çã\n\nAtomicså¯¹è±¡å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢èæåºï¼å®å¯ä»¥ä¿è¯ä¸ä¸ªæä½æå¯¹åºçå¤æ¡æºå¨æä»¤ï¼ä¸å®æ¯ä½ä¸ºä¸ä¸ªæ´ä½è¿è¡çï¼ä¸­é´ä¸ä¼è¢«ææ­ãä¹å°±æ¯è¯´ï¼å®ææ¶åçæä½é½å¯ä»¥çä½æ¯åå­æ§çåæä½ï¼è¿å¯ä»¥é¿åçº¿ç¨ç«äºï¼æé«å¤çº¿ç¨å±äº«åå­æ¶çæä½å®å¨ãæä»¥ï¼ia[112]++è¦æ¹åæAtomics.add(ia, 112, 1)ã\n\nAtomicså¯¹è±¡æä¾å¤ç§æ¹æ³ã\n\nï¼1ï¼Atomics.store()ï¼Atomics.load()\n\nstore()æ¹æ³ç¨æ¥åå±äº«åå­åå¥æ°æ®ï¼load()æ¹æ³ç¨æ¥ä»å±äº«åå­è¯»åºæ°æ®ãæ¯èµ·ç´æ¥çè¯»åæä½ï¼å®ä»¬çå¥½å¤æ¯ä¿è¯äºè¯»åæä½çåå­æ§ã\n\næ­¤å¤ï¼å®ä»¬è¿ç¨æ¥è§£å³ä¸ä¸ªé®é¢ï¼å¤ä¸ªçº¿ç¨ä½¿ç¨å±äº«åå­çæä¸ªä½ç½®ä½ä¸ºå¼å³ï¼flagï¼ï¼ä¸æ¦è¯¥ä½ç½®çå¼åäºï¼å°±æ§è¡ç¹å®æä½ãè¿æ¶ï¼å¿é¡»ä¿è¯è¯¥ä½ç½®çèµå¼æä½ï¼ä¸å®æ¯å¨å®åé¢çææå¯è½ä¼æ¹ååå­çæä½ç»æåæ§è¡ï¼èè¯¥ä½ç½®çåå¼æä½ï¼ä¸å®æ¯å¨å®åé¢ææå¯è½ä¼è¯»åè¯¥ä½ç½®çæä½å¼å§ä¹åæ§è¡ãstoreæ¹æ³åloadæ¹æ³å°±è½åå°è¿ä¸ç¹ï¼ç¼è¯å¨ä¸ä¼ä¸ºäºä¼åï¼èæä¹±æºå¨æä»¤çæ§è¡é¡ºåºã\n\nAtomics.load(array, index)\nAtomics.store(array, index, value)\n\n\n1\n2\n\n\nstoreæ¹æ³æ¥åä¸ä¸ªåæ°ï¼SharedBuffer çè§å¾ãä½ç½®ç´¢å¼åå¼ï¼è¿åsharedArray[index]çå¼ãloadæ¹æ³åªæ¥åä¸¤ä¸ªåæ°ï¼SharedBuffer çè§å¾åä½ç½®ç´¢å¼ï¼ä¹æ¯è¿åsharedArray[index]çå¼ã\n\n// ä¸»çº¿ç¨ main.js\nia[42] = 314159;  // ååçå¼ 191\nAtomics.store(ia, 37, 123456);  // ååçå¼æ¯ 163\n\n// Worker çº¿ç¨ worker.js\nwhile (Atomics.load(ia, 37) == 163);\nconsole.log(ia[37]);  // 123456\nconsole.log(ia[42]);  // 314159\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸»çº¿ç¨çAtomics.storeå 42 å·ä½ç½®çèµå¼ï¼ä¸å®æ¯æ©äº 37 ä½ç½®çèµå¼ãåªè¦ 37 å·ä½ç½®ç­äº 163ï¼Worker çº¿ç¨å°±ä¸ä¼ç»æ­¢å¾ªç¯ï¼èå¯¹ 37 å·ä½ç½®å 42 å·ä½ç½®çåå¼ï¼ä¸å®æ¯å¨Atomics.loadæä½ä¹åã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\n// ä¸»çº¿ç¨\nconst worker = new Worker('worker.js');\nconst length = 10;\nconst size = Int32Array.BYTES_PER_ELEMENT * length;\n// æ°å»ºä¸æ®µå±äº«åå­\nconst sharedBuffer = new SharedArrayBuffer(size);\nconst sharedArray = new Int32Array(sharedBuffer);\nfor (let i = 0; i < 10; i++) {\n  // åå±äº«åå­åå¥ 10 ä¸ªæ´æ°\n  Atomics.store(sharedArray, i, 0);\n}\nworker.postMessage(sharedBuffer);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸»çº¿ç¨ç¨Atomics.store()æ¹æ³åå¥æ°æ®ãä¸é¢æ¯ Worker çº¿ç¨ç¨Atomics.load()æ¹æ³è¯»åæ°æ®ã\n\n// worker.js\nself.addEventListener('message', (event) => {\n  const sharedArray = new Int32Array(event.data);\n  for (let i = 0; i < 10; i++) {\n    const arrayValue = Atomics.load(sharedArray, i);\n    console.log(`The item at array index ${i} is ${arrayValue}`);\n  }\n}, false);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nï¼2ï¼Atomics.exchange()\n\nWorker çº¿ç¨å¦æè¦åå¥æ°æ®ï¼å¯ä»¥ä½¿ç¨ä¸é¢çAtomics.store()æ¹æ³ï¼ä¹å¯ä»¥ä½¿ç¨Atomics.exchange()æ¹æ³ãå®ä»¬çåºå«æ¯ï¼Atomics.store()è¿ååå¥çå¼ï¼èAtomics.exchange()è¿åè¢«æ¿æ¢çå¼ã\n\n// Worker çº¿ç¨\nself.addEventListener('message', (event) => {\n  const sharedArray = new Int32Array(event.data);\n  for (let i = 0; i < 10; i++) {\n    if (i % 2 === 0) {\n      const storedValue = Atomics.store(sharedArray, i, 1);\n      console.log(`The item at array index ${i} is now ${storedValue}`);\n    } else {\n      const exchangedValue = Atomics.exchange(sharedArray, i, 2);\n      console.log(`The item at array index ${i} was ${exchangedValue}, now 2`);\n    }\n  }\n}, false);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç å°å±äº«åå­çå¶æ°ä½ç½®çå¼æ¹æ1ï¼å¥æ°ä½ç½®çå¼æ¹æ2ã\n\nï¼3ï¼Atomics.wait()ï¼Atomics.wake()\n\nä½¿ç¨whileå¾ªç¯ç­å¾ä¸»çº¿ç¨çéç¥ï¼ä¸æ¯å¾é«æï¼å¦æç¨å¨ä¸»çº¿ç¨ï¼å°±ä¼é æå¡é¡¿ï¼Atomicså¯¹è±¡æä¾äºwait()åwake()ä¸¤ä¸ªæ¹æ³ç¨äºç­å¾éç¥ãè¿ä¸¤ä¸ªæ¹æ³ç¸å½äºéåå­ï¼å³å¨ä¸ä¸ªçº¿ç¨è¿è¡æä½æ¶ï¼è®©å¶ä»çº¿ç¨ä¼ç ï¼å»ºç«éï¼ï¼ç­å°æä½ç»æï¼åå¤éé£äºä¼ç ççº¿ç¨ï¼è§£é¤éï¼ã\n\n// Worker çº¿ç¨\nself.addEventListener('message', (event) => {\n  const sharedArray = new Int32Array(event.data);\n  const arrayIndex = 0;\n  const expectedStoredValue = 50;\n  Atomics.wait(sharedArray, arrayIndex, expectedStoredValue);\n  console.log(Atomics.load(sharedArray, arrayIndex));\n}, false);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼Atomics.wait()æ¹æ³ç­åäºåè¯ Worker çº¿ç¨ï¼åªè¦æ»¡è¶³ç»å®æ¡ä»¶ï¼sharedArrayç0å·ä½ç½®ç­äº50ï¼ï¼å°±å¨è¿ä¸è¡ Worker çº¿ç¨è¿å¥ä¼ç ã\n\nä¸»çº¿ç¨ä¸æ¦æ´æ¹äºæå®ä½ç½®çå¼ï¼å°±å¯ä»¥å¤é Worker çº¿ç¨ã\n\n// ä¸»çº¿ç¨\nconst newArrayValue = 100;\nAtomics.store(sharedArray, 0, newArrayValue);\nconst arrayIndex = 0;\nconst queuePos = 1;\nAtomics.wake(sharedArray, arrayIndex, queuePos);\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼sharedArrayç0å·ä½ç½®æ¹ä¸º100ï¼ç¶åå°±æ§è¡Atomics.wake()æ¹æ³ï¼å¤éå¨sharedArrayç0å·ä½ç½®ä¼ç éåéçä¸ä¸ªçº¿ç¨ã\n\nAtomics.wait()æ¹æ³çä½¿ç¨æ ¼å¼å¦ä¸ã\n\nAtomics.wait(sharedArray, index, value, timeout)\n\n\n1\n\n\nå®çåä¸ªåæ°å«ä¹å¦ä¸ã\n\n * sharedArrayï¼å±äº«åå­çè§å¾æ°ç»ã\n * indexï¼è§å¾æ°æ®çä½ç½®ï¼ä»0å¼å§ï¼ã\n * valueï¼è¯¥ä½ç½®çé¢æå¼ãä¸æ¦å®éå¼ç­äºé¢æå¼ï¼å°±è¿å¥ä¼ç ã\n * timeoutï¼æ´æ°ï¼è¡¨ç¤ºè¿äºè¿ä¸ªæ¶é´ä»¥åï¼å°±èªå¨å¤éï¼åä½æ¯«ç§ãè¯¥åæ°å¯éï¼é»è®¤å¼æ¯Infinityï¼å³æ éæçä¼ç ï¼åªæéè¿Atomics.wake()æ¹æ³æè½å¤éã\n\nAtomics.wait()çè¿åå¼æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼å±æä¸ç§å¯è½çå¼ãå¦æsharedArray[index]ä¸ç­äºvalueï¼å°±è¿åå­ç¬¦ä¸²not-equalï¼å¦åå°±è¿å¥ä¼ç ãå¦æAtomics.wake()æ¹æ³å¤éï¼å°±è¿åå­ç¬¦ä¸²okï¼å¦æå ä¸ºè¶æ¶å¤éï¼å°±è¿åå­ç¬¦ä¸²timed-outã\n\nAtomics.wake()æ¹æ³çä½¿ç¨æ ¼å¼å¦ä¸ã\n\nAtomics.wake(sharedArray, index, count)\n\n\n1\n\n\nå®çä¸ä¸ªåæ°å«ä¹å¦ä¸ã\n\n * sharedArrayï¼å±äº«åå­çè§å¾æ°ç»ã\n * indexï¼è§å¾æ°æ®çä½ç½®ï¼ä»0å¼å§ï¼ã\n * countï¼éè¦å¤éç Worker çº¿ç¨çæ°éï¼é»è®¤ä¸ºInfinityã\n\nAtomics.wake()æ¹æ³ä¸æ¦å¤éä¼ç ç Worker çº¿ç¨ï¼å°±ä¼è®©å®ç»§ç»­å¾ä¸è¿è¡ã\n\nè¯·çä¸ä¸ªä¾å­ã\n\n// ä¸»çº¿ç¨\nconsole.log(ia[37]);  // 163\nAtomics.store(ia, 37, 123456);\nAtomics.wake(ia, 37, 1);\n\n// Worker çº¿ç¨\nAtomics.wait(ia, 37, 163);\nconsole.log(ia[37]);  // 123456\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼è§å¾æ°ç»iaçç¬¬ 37 å·ä½ç½®ï¼åæ¥çå¼æ¯163ãWorker çº¿ç¨ä½¿ç¨Atomics.wait()æ¹æ³ï¼æå®åªè¦ia[37]ç­äº163ï¼å°±è¿å¥ä¼ç ç¶æãä¸»çº¿ç¨ä½¿ç¨Atomics.store()æ¹æ³ï¼å°123456åå¥ia[37]ï¼ç¶åä½¿ç¨Atomics.wake()æ¹æ³å¤é Worker çº¿ç¨ã\n\nå¦å¤ï¼åºäºwaitåwakeè¿ä¸¤ä¸ªæ¹æ³çéåå­å®ç°ï¼å¯ä»¥ç Lars T Hansen ç js-lock-and-condition è¿ä¸ªåºã\n\næ³¨æï¼æµè§å¨çä¸»çº¿ç¨ä¸å®è®¾ç½®ä¼ç ï¼è¿ä¼å¯¼è´ç¨æ·å¤±å»ååºãèä¸ï¼ä¸»çº¿ç¨å®éä¸ä¼æç»è¿å¥ä¼ç ã\n\nï¼4ï¼è¿ç®æ¹æ³\n\nå±äº«åå­ä¸é¢çæäºè¿ç®æ¯ä¸è½è¢«ææ­çï¼å³ä¸è½å¨è¿ç®è¿ç¨ä¸­ï¼è®©å¶ä»çº¿ç¨æ¹ååå­ä¸é¢çå¼ãAtomics å¯¹è±¡æä¾äºä¸äºè¿ç®æ¹æ³ï¼é²æ­¢æ°æ®è¢«æ¹åã\n\nAtomics.add(sharedArray, index, value)\n\n\n1\n\n\nAtomics.addç¨äºå°valueå å°sharedArray[index]ï¼è¿åsharedArray[index]æ§çå¼ã\n\nAtomics.sub(sharedArray, index, value)\n\n\n1\n\n\nAtomics.subç¨äºå°valueä»sharedArray[index]åå»ï¼è¿åsharedArray[index]æ§çå¼ã\n\nAtomics.and(sharedArray, index, value)\n\n\n1\n\n\nAtomics.andç¨äºå°valueä¸sharedArray[index]è¿è¡ä½è¿ç®andï¼æ¾å¥sharedArray[index]ï¼å¹¶è¿åæ§çå¼ã\n\nAtomics.or(sharedArray, index, value)\n\n\n1\n\n\nAtomics.orç¨äºå°valueä¸sharedArray[index]è¿è¡ä½è¿ç®orï¼æ¾å¥sharedArray[index]ï¼å¹¶è¿åæ§çå¼ã\n\nAtomics.xor(sharedArray, index, value)\n\n\n1\n\n\nAtomic.xorç¨äºå°vauleä¸sharedArray[index]è¿è¡ä½è¿ç®xorï¼æ¾å¥sharedArray[index]ï¼å¹¶è¿åæ§çå¼ã\n\nï¼5ï¼å¶ä»æ¹æ³\n\nAtomicså¯¹è±¡è¿æä»¥ä¸æ¹æ³ã\n\n * Atomics.compareExchange(sharedArray, index, oldval, newval)ï¼å¦æsharedArray[index]ç­äºoldvalï¼å°±åå¥newvalï¼è¿åoldvalã\n * Atomics.isLockFree(size)ï¼è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºAtomicså¯¹è±¡æ¯å¦å¯ä»¥å¤çæä¸ªsizeçåå­éå®ãå¦æè¿åfalseï¼åºç¨ç¨åºå°±éè¦èªå·±æ¥å®ç°éå®ã\n\nAtomics.compareExchangeçä¸ä¸ªç¨éæ¯ï¼ä» SharedArrayBuffer è¯»åä¸ä¸ªå¼ï¼ç¶åå¯¹è¯¥å¼è¿è¡æä¸ªæä½ï¼æä½ç»æä»¥åï¼æ£æ¥ä¸ä¸ SharedArrayBuffer éé¢åæ¥é£ä¸ªå¼æ¯å¦åçååï¼å³è¢«å¶ä»çº¿ç¨æ¹åè¿ï¼ãå¦ææ²¡ææ¹åè¿ï¼å°±å°å®åååæ¥çä½ç½®ï¼å¦åè¯»åæ°çå¼ï¼åéå¤´è¿è¡ä¸æ¬¡æä½ã",normalizedContent:"# arraybuffer\n\narraybufferå¯¹è±¡ãtypedarrayè§å¾ådataviewè§å¾æ¯ javascript æä½äºè¿å¶æ°æ®çä¸ä¸ªæ¥å£ãè¿äºå¯¹è±¡æ©å°±å­å¨ï¼å±äºç¬ç«çè§æ ¼ï¼2011 å¹´ 2 æåå¸ï¼ï¼es6 å°å®ä»¬çº³å¥äº ecmascript è§æ ¼ï¼å¹¶ä¸å¢å äºæ°çæ¹æ³ãå®ä»¬é½æ¯ä»¥æ°ç»çè¯­æ³å¤çäºè¿å¶æ°æ®ï¼æä»¥ç»ç§°ä¸ºäºè¿å¶æ°ç»ã è¿ä¸ªæ¥å£çåå§è®¾è®¡ç®çï¼ä¸ webgl é¡¹ç®æå³ãæè° webglï¼å°±æ¯ææµè§å¨ä¸æ¾å¡ä¹é´çéä¿¡æ¥å£ï¼ä¸ºäºæ»¡è¶³ javascript ä¸æ¾å¡ä¹é´å¤§éçãå®æ¶çæ°æ®äº¤æ¢ï¼å®ä»¬ä¹é´çæ°æ®éä¿¡å¿é¡»æ¯äºè¿å¶çï¼èä¸è½æ¯ä¼ ç»çææ¬æ ¼å¼ãææ¬æ ¼å¼ä¼ éä¸ä¸ª 32 ä½æ´æ°ï¼ä¸¤ç«¯ç javascript èæ¬ä¸æ¾å¡é½è¦è¿è¡æ ¼å¼è½¬åï¼å°éå¸¸èæ¶ãè¿æ¶è¦æ¯å­å¨ä¸ç§æºå¶ï¼å¯ä»¥å c è¯­è¨é£æ ·ï¼ç´æ¥æä½å­èï¼å° 4 ä¸ªå­èç 32 ä½æ´æ°ï¼ä»¥äºè¿å¶å½¢å¼åå°ä¸å¨å°éå¥æ¾å¡ï¼èæ¬çæ§è½å°±ä¼å¤§å¹æåã\n\näºè¿å¶æ°ç»å°±æ¯å¨è¿ç§èæ¯ä¸è¯ççãå®å¾å c è¯­è¨çæ°ç»ï¼åè®¸å¼åèä»¥æ°ç»ä¸æ çå½¢å¼ï¼ç´æ¥æä½åå­ï¼å¤§å¤§å¢å¼ºäº javascript å¤çäºè¿å¶æ°æ®çè½åï¼ä½¿å¾å¼åèæå¯è½éè¿ javascript ä¸æä½ç³»ç»çåçæ¥å£è¿è¡äºè¿å¶éä¿¡ã\n\näºè¿å¶æ°ç»ç±ä¸ç±»å¯¹è±¡ç»æã\n\nï¼1ï¼arraybufferå¯¹è±¡ï¼ä»£è¡¨åå­ä¹ä¸­çä¸æ®µäºè¿å¶æ°æ®ï¼å¯ä»¥éè¿âè§å¾âè¿è¡æä½ãâè§å¾âé¨ç½²äºæ°ç»æ¥å£ï¼è¿æå³çï¼å¯ä»¥ç¨æ°ç»çæ¹æ³æä½åå­ã\n\nï¼2ï¼typedarrayè§å¾ï¼å±åæ¬ 9 ç§ç±»åçè§å¾ï¼æ¯å¦uint8arrayï¼æ ç¬¦å· 8 ä½æ´æ°ï¼æ°ç»è§å¾, int16arrayï¼16 ä½æ´æ°ï¼æ°ç»è§å¾, float32arrayï¼32 ä½æµ®ç¹æ°ï¼æ°ç»è§å¾ç­ç­ã\n\nï¼3ï¼dataviewè§å¾ï¼å¯ä»¥èªå®ä¹å¤åæ ¼å¼çè§å¾ï¼æ¯å¦ç¬¬ä¸ä¸ªå­èæ¯ uint8ï¼æ ç¬¦å· 8 ä½æ´æ°ï¼ãç¬¬äºãä¸ä¸ªå­èæ¯ int16ï¼16 ä½æ´æ°ï¼ãç¬¬åä¸ªå­èå¼å§æ¯ float32ï¼32 ä½æµ®ç¹æ°ï¼ç­ç­ï¼æ­¤å¤è¿å¯ä»¥èªå®ä¹å­èåºã\n\nç®åè¯´ï¼arraybufferå¯¹è±¡ä»£è¡¨åå§çäºè¿å¶æ°æ®ï¼typedarrayè§å¾ç¨æ¥è¯»åç®åç±»åçäºè¿å¶æ°æ®ï¼dataviewè§å¾ç¨æ¥è¯»åå¤æç±»åçäºè¿å¶æ°æ®ã\n\ntypedarrayè§å¾æ¯æçæ°æ®ç±»åä¸å±æ 9 ç§ï¼dataviewè§å¾æ¯æé¤uint8cä»¥å¤çå¶ä» 8 ç§ï¼ã\n\næ°æ®ç±»å      å­èé¿åº¦   å«ä¹                  å¯¹åºç c è¯­è¨ç±»å\nint8      1      8 ä½å¸¦ç¬¦å·æ´æ°            signed char\nuint8     1      8 ä½ä¸å¸¦ç¬¦å·æ´æ°           unsigned char\nuint8c    1      8 ä½ä¸å¸¦ç¬¦å·æ´æ°ï¼èªå¨è¿æ»¤æº¢åºï¼   unsigned char\nint16     2      16 ä½å¸¦ç¬¦å·æ´æ°           short\nuint16    2      16 ä½ä¸å¸¦ç¬¦å·æ´æ°          unsigned short\nint32     4      32 ä½å¸¦ç¬¦å·æ´æ°           int\nuint32    4      32 ä½ä¸å¸¦ç¬¦å·çæ´æ°         unsigned int\nfloat32   4      32 ä½æµ®ç¹æ°             float\nfloat64   8      64 ä½æµ®ç¹æ°             double\n\næ³¨æï¼äºè¿å¶æ°ç»å¹¶ä¸æ¯çæ­£çæ°ç»ï¼èæ¯ç±»ä¼¼æ°ç»çå¯¹è±¡ã\n\nå¾å¤æµè§å¨æä½ç apiï¼ç¨å°äºäºè¿å¶æ°ç»æä½äºè¿å¶æ°æ®ï¼ä¸é¢æ¯å¶ä¸­çå ä¸ªã\n\n * canvas\n * fetch api\n * file api\n * websockets\n * xmlhttprequest\n\n\n# arraybuffer å¯¹è±¡\n\n\n# æ¦è¿°\n\narraybufferå¯¹è±¡ä»£è¡¨å¨å­äºè¿å¶æ°æ®çä¸æ®µåå­ï¼å®ä¸è½ç´æ¥è¯»åï¼åªè½éè¿è§å¾ï¼typedarrayè§å¾ådataviewè§å¾)æ¥è¯»åï¼è§å¾çä½ç¨æ¯ä»¥æå®æ ¼å¼è§£è¯»äºè¿å¶æ°æ®ã\n\narraybufferä¹æ¯ä¸ä¸ªæé å½æ°ï¼å¯ä»¥åéä¸æ®µå¯ä»¥å­æ¾æ°æ®çè¿ç»­åå­åºåã\n\nconst buf = new arraybuffer(32);\n\n\n1\n\n\nä¸é¢ä»£ç çæäºä¸æ®µ 32 å­èçåå­åºåï¼æ¯ä¸ªå­èçå¼é»è®¤é½æ¯ 0ãå¯ä»¥çå°ï¼arraybufferæé å½æ°çåæ°æ¯æéè¦çåå­å¤§å°ï¼åä½å­èï¼ã\n\nä¸ºäºè¯»åè¿æ®µåå®¹ï¼éè¦ä¸ºå®æå®è§å¾ãdataviewè§å¾çåå»ºï¼éè¦æä¾arraybufferå¯¹è±¡å®ä¾ä½ä¸ºåæ°ã\n\nconst buf = new arraybuffer(32);\nconst dataview = new dataview(buf);\ndataview.getuint8(0) // 0\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç å¯¹ä¸æ®µ 32 å­èçåå­ï¼å»ºç«dataviewè§å¾ï¼ç¶åä»¥ä¸å¸¦ç¬¦å·ç 8 ä½æ´æ°æ ¼å¼ï¼ä»å¤´è¯»å 8 ä½äºè¿å¶æ°æ®ï¼ç»æå¾å° 0ï¼å ä¸ºåå§åå­çarraybufferå¯¹è±¡ï¼é»è®¤ææä½é½æ¯ 0ã\n\nå¦ä¸ç§typedarrayè§å¾ï¼ä¸dataviewè§å¾çä¸ä¸ªåºå«æ¯ï¼å®ä¸æ¯ä¸ä¸ªæé å½æ°ï¼èæ¯ä¸ç»æé å½æ°ï¼ä»£è¡¨ä¸åçæ°æ®æ ¼å¼ã\n\nconst buffer = new arraybuffer(12);\n\nconst x1 = new int32array(buffer);\nx1[0] = 1;\nconst x2 = new uint8array(buffer);\nx2[0]  = 2;\n\nx1[0] // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç å¯¹åä¸æ®µåå­ï¼åå«å»ºç«ä¸¤ç§è§å¾ï¼32 ä½å¸¦ç¬¦å·æ´æ°ï¼int32arrayæé å½æ°ï¼å 8 ä½ä¸å¸¦ç¬¦å·æ´æ°ï¼uint8arrayæé å½æ°ï¼ãç±äºä¸¤ä¸ªè§å¾å¯¹åºçæ¯åä¸æ®µåå­ï¼ä¸ä¸ªè§å¾ä¿®æ¹åºå±åå­ï¼ä¼å½±åå°å¦ä¸ä¸ªè§å¾ã\n\ntypedarrayè§å¾çæé å½æ°ï¼é¤äºæ¥åarraybufferå®ä¾ä½ä¸ºåæ°ï¼è¿å¯ä»¥æ¥åæ®éæ°ç»ä½ä¸ºåæ°ï¼ç´æ¥åéåå­çæåºå±çarraybufferå®ä¾ï¼å¹¶åæ¶å®æå¯¹è¿æ®µåå­çèµå¼ã\n\nconst typedarray = new uint8array([0,1,2]);\ntypedarray.length // 3\n\ntypedarray[0] = 5;\ntypedarray // [5, 1, 2]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä½¿ç¨typedarrayè§å¾çuint8arrayæé å½æ°ï¼æ°å»ºä¸ä¸ªä¸å¸¦ç¬¦å·ç 8 ä½æ´æ°è§å¾ãå¯ä»¥çå°ï¼uint8arrayç´æ¥ä½¿ç¨æ®éæ°ç»ä½ä¸ºåæ°ï¼å¯¹åºå±åå­çèµå¼åæ¶å®æã\n\n\n# arraybuffer.prototype.bytelength\n\narraybufferå®ä¾çbytelengthå±æ§ï¼è¿åæåéçåå­åºåçå­èé¿åº¦ã\n\nconst buffer = new arraybuffer(32);\nbuffer.bytelength\n// 32\n\n\n1\n2\n3\n\n\nå¦æè¦åéçåå­åºåå¾å¤§ï¼æå¯è½åéå¤±è´¥ï¼å ä¸ºæ²¡æé£ä¹å¤çè¿ç»­ç©ºä½åå­ï¼ï¼æä»¥æå¿è¦æ£æ¥æ¯å¦åéæåã\n\nif (buffer.bytelength === n) {\n  // æå\n} else {\n  // å¤±è´¥\n}\n\n\n1\n2\n3\n4\n5\n\n\n\n# arraybuffer.prototype.slice()\n\narraybufferå®ä¾æä¸ä¸ªsliceæ¹æ³ï¼åè®¸å°åå­åºåçä¸é¨åï¼æ·è´çæä¸ä¸ªæ°çarraybufferå¯¹è±¡ã\n\nconst buffer = new arraybuffer(8);\nconst newbuffer = buffer.slice(0, 3);\n\n\n1\n2\n\n\nä¸é¢ä»£ç æ·è´bufferå¯¹è±¡çå 3 ä¸ªå­èï¼ä» 0 å¼å§ï¼å°ç¬¬ 3 ä¸ªå­èåé¢ç»æï¼ï¼çæä¸ä¸ªæ°çarraybufferå¯¹è±¡ãsliceæ¹æ³å¶å®åå«ä¸¤æ­¥ï¼ç¬¬ä¸æ­¥æ¯ååéä¸æ®µæ°åå­ï¼ç¬¬äºæ­¥æ¯å°åæ¥é£ä¸ªarraybufferå¯¹è±¡æ·è´è¿å»ã\n\nsliceæ¹æ³æ¥åä¸¤ä¸ªåæ°ï¼ç¬¬ä¸ä¸ªåæ°è¡¨ç¤ºæ·è´å¼å§çå­èåºå·ï¼å«è¯¥å­èï¼ï¼ç¬¬äºä¸ªåæ°è¡¨ç¤ºæ·è´æªæ­¢çå­èåºå·ï¼ä¸å«è¯¥å­èï¼ãå¦æçç¥ç¬¬äºä¸ªåæ°ï¼åé»è®¤å°åarraybufferå¯¹è±¡çç»å°¾ã\n\né¤äºsliceæ¹æ³ï¼arraybufferå¯¹è±¡ä¸æä¾ä»»ä½ç´æ¥è¯»ååå­çæ¹æ³ï¼åªåè®¸å¨å¶ä¸æ¹å»ºç«è§å¾ï¼ç¶åéè¿è§å¾è¯»åã\n\n\n# arraybuffer.isview()\n\narraybufferæä¸ä¸ªéææ¹æ³isviewï¼è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºåæ°æ¯å¦ä¸ºarraybufferçè§å¾å®ä¾ãè¿ä¸ªæ¹æ³å¤§è´ç¸å½äºå¤æ­åæ°ï¼æ¯å¦ä¸ºtypedarrayå®ä¾ædataviewå®ä¾ã\n\nconst buffer = new arraybuffer(8);\narraybuffer.isview(buffer) // false\n\nconst v = new int32array(buffer);\narraybuffer.isview(v) // true\n\n\n1\n2\n3\n4\n5\n\n\n\n# typedarray è§å¾\n\n\n# æ¦è¿°\n\narraybufferå¯¹è±¡ä½ä¸ºåå­åºåï¼å¯ä»¥å­æ¾å¤ç§ç±»åçæ°æ®ãåä¸æ®µåå­ï¼ä¸åæ°æ®æä¸åçè§£è¯»æ¹å¼ï¼è¿å°±å«åâè§å¾âï¼viewï¼ãarraybufferæä¸¤ç§è§å¾ï¼ä¸ç§æ¯typedarrayè§å¾ï¼å¦ä¸ç§æ¯dataviewè§å¾ãåèçæ°ç»æåé½æ¯åä¸ä¸ªæ°æ®ç±»åï¼åèçæ°ç»æåå¯ä»¥æ¯ä¸åçæ°æ®ç±»åã\n\nç®åï¼typedarrayè§å¾ä¸å±åæ¬ 9 ç§ç±»åï¼æ¯ä¸ç§è§å¾é½æ¯ä¸ç§æé å½æ°ã\n\n * int8arrayï¼8 ä½æç¬¦å·æ´æ°ï¼é¿åº¦ 1 ä¸ªå­èã\n * uint8arrayï¼8 ä½æ ç¬¦å·æ´æ°ï¼é¿åº¦ 1 ä¸ªå­èã\n * uint8clampedarrayï¼8 ä½æ ç¬¦å·æ´æ°ï¼é¿åº¦ 1 ä¸ªå­èï¼æº¢åºå¤çä¸åã\n * int16arrayï¼16 ä½æç¬¦å·æ´æ°ï¼é¿åº¦ 2 ä¸ªå­èã\n * uint16arrayï¼16 ä½æ ç¬¦å·æ´æ°ï¼é¿åº¦ 2 ä¸ªå­èã\n * int32arrayï¼32 ä½æç¬¦å·æ´æ°ï¼é¿åº¦ 4 ä¸ªå­èã\n * uint32arrayï¼32 ä½æ ç¬¦å·æ´æ°ï¼é¿åº¦ 4 ä¸ªå­èã\n * float32arrayï¼32 ä½æµ®ç¹æ°ï¼é¿åº¦ 4 ä¸ªå­èã\n * float64arrayï¼64 ä½æµ®ç¹æ°ï¼é¿åº¦ 8 ä¸ªå­èã\n\nè¿ 9 ä¸ªæé å½æ°çæçæ°ç»ï¼ç»ç§°ä¸ºtypedarrayè§å¾ãå®ä»¬å¾åæ®éæ°ç»ï¼é½ælengthå±æ§ï¼é½è½ç¨æ¹æ¬å·è¿ç®ç¬¦ï¼[]ï¼è·ååä¸ªåç´ ï¼æææ°ç»çæ¹æ³ï¼å¨å®ä»¬ä¸é¢é½è½ä½¿ç¨ãæ®éæ°ç»ä¸ typedarray æ°ç»çå·®å¼ä¸»è¦å¨ä»¥ä¸æ¹é¢ã\n\n * typedarray æ°ç»çæææåï¼é½æ¯åä¸ç§ç±»åã\n * typedarray æ°ç»çæåæ¯è¿ç»­çï¼ä¸ä¼æç©ºä½ã\n * typedarray æ°ç»æåçé»è®¤å¼ä¸º 0ãæ¯å¦ï¼new array(10)è¿åä¸ä¸ªæ®éæ°ç»ï¼éé¢æ²¡æä»»ä½æåï¼åªæ¯ 10 ä¸ªç©ºä½ï¼new uint8array(10)è¿åä¸ä¸ª typedarray æ°ç»ï¼éé¢ 10 ä¸ªæåé½æ¯ 0ã\n * typedarray æ°ç»åªæ¯ä¸å±è§å¾ï¼æ¬èº«ä¸å¨å­æ°æ®ï¼å®çæ°æ®é½å¨å­å¨åºå±çarraybufferå¯¹è±¡ä¹ä¸­ï¼è¦è·ååºå±å¯¹è±¡å¿é¡»ä½¿ç¨bufferå±æ§ã\n\n\n# æé å½æ°\n\ntypedarray æ°ç»æä¾ 9 ç§æé å½æ°ï¼ç¨æ¥çæç¸åºç±»åçæ°ç»å®ä¾ã\n\næé å½æ°æå¤ç§ç¨æ³ã\n\nï¼1ï¼typedarray(buffer, byteoffset=0, length?)\n\nåä¸ä¸ªarraybufferå¯¹è±¡ä¹ä¸ï¼å¯ä»¥æ ¹æ®ä¸åçæ°æ®ç±»åï¼å»ºç«å¤ä¸ªè§å¾ã\n\n// åå»ºä¸ä¸ª8å­èçarraybuffer\nconst b = new arraybuffer(8);\n\n// åå»ºä¸ä¸ªæåbçint32è§å¾ï¼å¼å§äºå­è0ï¼ç´å°ç¼å²åºçæ«å°¾\nconst v1 = new int32array(b);\n\n// åå»ºä¸ä¸ªæåbçuint8è§å¾ï¼å¼å§äºå­è2ï¼ç´å°ç¼å²åºçæ«å°¾\nconst v2 = new uint8array(b, 2);\n\n// åå»ºä¸ä¸ªæåbçint16è§å¾ï¼å¼å§äºå­è2ï¼é¿åº¦ä¸º2\nconst v3 = new int16array(b, 2, 2);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç å¨ä¸æ®µé¿åº¦ä¸º 8 ä¸ªå­èçåå­ï¼bï¼ä¹ä¸ï¼çæäºä¸ä¸ªè§å¾ï¼v1ãv2åv3ã\n\nè§å¾çæé å½æ°å¯ä»¥æ¥åä¸ä¸ªåæ°ï¼\n\n * ç¬¬ä¸ä¸ªåæ°ï¼å¿éï¼ï¼è§å¾å¯¹åºçåºå±arraybufferå¯¹è±¡ã\n * ç¬¬äºä¸ªåæ°ï¼å¯éï¼ï¼è§å¾å¼å§çå­èåºå·ï¼é»è®¤ä» 0 å¼å§ã\n * ç¬¬ä¸ä¸ªåæ°ï¼å¯éï¼ï¼è§å¾åå«çæ°æ®ä¸ªæ°ï¼é»è®¤ç´å°æ¬æ®µåå­åºåç»æã\n\nå æ­¤ï¼v1ãv2åv3æ¯éå çï¼v1[0]æ¯ä¸ä¸ª 32 ä½æ´æ°ï¼æåå­è 0 ï½å­è 3ï¼v2[0]æ¯ä¸ä¸ª 8 ä½æ ç¬¦å·æ´æ°ï¼æåå­è 2ï¼v3[0]æ¯ä¸ä¸ª 16 ä½æ´æ°ï¼æåå­è 2 ï½å­è 3ãåªè¦ä»»ä½ä¸ä¸ªè§å¾å¯¹åå­ææä¿®æ¹ï¼å°±ä¼å¨å¦å¤ä¸¤ä¸ªè§å¾ä¸ååºåºæ¥ã\n\næ³¨æï¼byteoffsetå¿é¡»ä¸æè¦å»ºç«çæ°æ®ç±»åä¸è´ï¼å¦åä¼æ¥éã\n\nconst buffer = new arraybuffer(8);\nconst i16 = new int16array(buffer, 1);\n// uncaught rangeerror: start offset of int16array should be a multiple of 2\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°çæä¸ä¸ª 8 ä¸ªå­èçarraybufferå¯¹è±¡ï¼ç¶åå¨è¿ä¸ªå¯¹è±¡çç¬¬ä¸ä¸ªå­èï¼å»ºç«å¸¦ç¬¦å·ç 16 ä½æ´æ°è§å¾ï¼ç»ææ¥éãå ä¸ºï¼å¸¦ç¬¦å·ç 16 ä½æ´æ°éè¦ä¸¤ä¸ªå­èï¼æä»¥byteoffsetåæ°å¿é¡»è½å¤è¢« 2 æ´é¤ã\n\nå¦ææ³ä»ä»»æå­èå¼å§è§£è¯»arraybufferå¯¹è±¡ï¼å¿é¡»ä½¿ç¨dataviewè§å¾ï¼å ä¸ºtypedarrayè§å¾åªæä¾ 9 ç§åºå®çè§£è¯»æ ¼å¼ã\n\nï¼2ï¼typedarray(length)\n\nè§å¾è¿å¯ä»¥ä¸éè¿arraybufferå¯¹è±¡ï¼ç´æ¥åéåå­èçæã\n\nconst f64a = new float64array(8);\nf64a[0] = 10;\nf64a[1] = 20;\nf64a[2] = f64a[0] + f64a[1];\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç çæä¸ä¸ª 8 ä¸ªæåçfloat64arrayæ°ç»ï¼å± 64 å­èï¼ï¼ç¶åä¾æ¬¡å¯¹æ¯ä¸ªæåèµå¼ãè¿æ¶ï¼è§å¾æé å½æ°çåæ°å°±æ¯æåçä¸ªæ°ãå¯ä»¥çå°ï¼è§å¾æ°ç»çèµå¼æä½ä¸æ®éæ°ç»çæä½æ¯«æ ä¸¤æ ·ã\n\nï¼3ï¼typedarray(typedarray)\n\ntypedarray æ°ç»çæé å½æ°ï¼å¯ä»¥æ¥åå¦ä¸ä¸ªtypedarrayå®ä¾ä½ä¸ºåæ°ã\n\nconst typedarray = new int8array(new uint8array(4));\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼int8arrayæé å½æ°æ¥åä¸ä¸ªuint8arrayå®ä¾ä½ä¸ºåæ°ã\n\næ³¨æï¼æ­¤æ¶çæçæ°æ°ç»ï¼åªæ¯å¤å¶äºåæ°æ°ç»çå¼ï¼å¯¹åºçåºå±åå­æ¯ä¸ä¸æ ·çãæ°æ°ç»ä¼å¼è¾ä¸æ®µæ°çåå­å¨å­æ°æ®ï¼ä¸ä¼å¨åæ°ç»çåå­ä¹ä¸å»ºç«è§å¾ã\n\nconst x = new int8array([1, 1]);\nconst y = new int8array(x);\nx[0] // 1\ny[0] // 1\n\nx[0] = 2;\ny[0] // 1\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»yæ¯ä»¥æ°ç»xä¸ºæ¨¡æ¿èçæçï¼å½xåå¨çæ¶åï¼yå¹¶æ²¡æåå¨ã\n\nå¦ææ³åºäºåä¸æ®µåå­ï¼æé ä¸åçè§å¾ï¼å¯ä»¥éç¨ä¸é¢çåæ³ã\n\nconst x = new int8array([1, 1]);\nconst y = new int8array(x.buffer);\nx[0] // 1\ny[0] // 1\n\nx[0] = 2;\ny[0] // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nï¼4ï¼typedarray(arraylikeobject)\n\næé å½æ°çåæ°ä¹å¯ä»¥æ¯ä¸ä¸ªæ®éæ°ç»ï¼ç¶åç´æ¥çætypedarrayå®ä¾ã\n\nconst typedarray = new uint8array([1, 2, 3, 4]);\n\n\n1\n\n\næ³¨æï¼è¿æ¶typedarrayè§å¾ä¼éæ°å¼è¾åå­ï¼ä¸ä¼å¨åæ°ç»çåå­ä¸å»ºç«è§å¾ã\n\nä¸é¢ä»£ç ä»ä¸ä¸ªæ®éçæ°ç»ï¼çæä¸ä¸ª 8 ä½æ ç¬¦å·æ´æ°çtypedarrayå®ä¾ã\n\ntypedarray æ°ç»ä¹å¯ä»¥è½¬æ¢åæ®éæ°ç»ã\n\nconst normalarray = [...typedarray];\n// or\nconst normalarray = array.from(typedarray);\n// or\nconst normalarray = array.prototype.slice.call(typedarray);\n\n\n1\n2\n3\n4\n5\n\n\n\n# æ°ç»æ¹æ³\n\næ®éæ°ç»çæä½æ¹æ³åå±æ§ï¼å¯¹ typedarray æ°ç»å®å¨éç¨ã\n\n * typedarray.prototype.copywithin(target, start[, end = this.length])\n * typedarray.prototype.entries()\n * typedarray.prototype.every(callbackfn, thisarg?)\n * typedarray.prototype.fill(value, start=0, end=this.length)\n * typedarray.prototype.filter(callbackfn, thisarg?)\n * typedarray.prototype.find(predicate, thisarg?)\n * typedarray.prototype.findindex(predicate, thisarg?)\n * typedarray.prototype.foreach(callbackfn, thisarg?)\n * typedarray.prototype.indexof(searchelement, fromindex=0)\n * typedarray.prototype.join(separator)\n * typedarray.prototype.keys()\n * typedarray.prototype.lastindexof(searchelement, fromindex?)\n * typedarray.prototype.map(callbackfn, thisarg?)\n * typedarray.prototype.reduce(callbackfn, initialvalue?)\n * typedarray.prototype.reduceright(callbackfn, initialvalue?)\n * typedarray.prototype.reverse()\n * typedarray.prototype.slice(start=0, end=this.length)\n * typedarray.prototype.some(callbackfn, thisarg?)\n * typedarray.prototype.sort(comparefn)\n * typedarray.prototype.tolocalestring(reserved1?, reserved2?)\n * typedarray.prototype.tostring()\n * typedarray.prototype.values()\n\nä¸é¢æææ¹æ³çç¨æ³ï¼è¯·åéæ°ç»æ¹æ³çä»ç»ï¼è¿éä¸åéå¤äºã\n\næ³¨æï¼typedarray æ°ç»æ²¡æconcatæ¹æ³ãå¦ææ³è¦åå¹¶å¤ä¸ª typedarray æ°ç»ï¼å¯ä»¥ç¨ä¸é¢è¿ä¸ªå½æ°ã\n\nfunction concatenate(resultconstructor, ...arrays) {\n  let totallength = 0;\n  for (let arr of arrays) {\n    totallength += arr.length;\n  }\n  let result = new resultconstructor(totallength);\n  let offset = 0;\n  for (let arr of arrays) {\n    result.set(arr, offset);\n    offset += arr.length;\n  }\n  return result;\n}\n\nconcatenate(uint8array, uint8array.of(1, 2), uint8array.of(3, 4))\n// uint8array [1, 2, 3, 4]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nå¦å¤ï¼typedarray æ°ç»ä¸æ®éæ°ç»ä¸æ ·ï¼é¨ç½²äº iterator æ¥å£ï¼æä»¥å¯ä»¥è¢«éåã\n\nlet ui8 = uint8array.of(0, 1, 2);\nfor (let byte of ui8) {\n  console.log(byte);\n}\n// 0\n// 1\n// 2\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# å­èåº\n\nå­èåºæçæ¯æ°å¼å¨åå­ä¸­çè¡¨ç¤ºæ¹å¼ã\n\nconst buffer = new arraybuffer(16);\nconst int32view = new int32array(buffer);\n\nfor (let i = 0; i < int32view.length; i++) {\n  int32view[i] = i * 2;\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çæä¸ä¸ª 16 å­èçarraybufferå¯¹è±¡ï¼ç¶åå¨å®çåºç¡ä¸ï¼å»ºç«äºä¸ä¸ª 32 ä½æ´æ°çè§å¾ãç±äºæ¯ä¸ª 32 ä½æ´æ°å æ® 4 ä¸ªå­èï¼æä»¥ä¸å±å¯ä»¥åå¥ 4 ä¸ªæ´æ°ï¼ä¾æ¬¡ä¸º 0ï¼2ï¼4ï¼6ã\n\nå¦æå¨è¿æ®µæ°æ®ä¸æ¥çå»ºç«ä¸ä¸ª 16 ä½æ´æ°çè§å¾ï¼åå¯ä»¥è¯»åºå®å¨ä¸ä¸æ ·çç»æã\n\nconst int16view = new int16array(buffer);\n\nfor (let i = 0; i < int16view.length; i++) {\n  console.log(\"entry \" + i + \": \" + int16view[i]);\n}\n// entry 0: 0\n// entry 1: 0\n// entry 2: 2\n// entry 3: 0\n// entry 4: 4\n// entry 5: 0\n// entry 6: 6\n// entry 7: 0\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nç±äºæ¯ä¸ª 16 ä½æ´æ°å æ® 2 ä¸ªå­èï¼æä»¥æ´ä¸ªarraybufferå¯¹è±¡ç°å¨åæ 8 æ®µãç¶åï¼ç±äº x86 ä½ç³»çè®¡ç®æºé½éç¨å°ç«¯å­èåºï¼little endianï¼ï¼ç¸å¯¹éè¦çå­èæå¨åé¢çåå­å°åï¼ç¸å¯¹ä¸éè¦å­èæå¨åé¢çåå­å°åï¼æä»¥å°±å¾å°äºä¸é¢çç»æã\n\næ¯å¦ï¼ä¸ä¸ªå æ®åä¸ªå­èç 16 è¿å¶æ°0x12345678ï¼å³å®å¶å¤§å°çæéè¦çå­èæ¯â12âï¼æä¸éè¦çæ¯â78âãå°ç«¯å­èåºå°æä¸éè¦çå­èæå¨åé¢ï¼å¨å­é¡ºåºå°±æ¯78563412ï¼å¤§ç«¯å­èåºåå®å¨ç¸åï¼å°æéè¦çå­èæå¨åé¢ï¼å¨å­é¡ºåºå°±æ¯12345678ãç®åï¼ææä¸ªäººçµèå ä¹é½æ¯å°ç«¯å­èåºï¼æä»¥ typedarray æ°ç»åé¨ä¹éç¨å°ç«¯å­èåºè¯»åæ°æ®ï¼æèæ´åç¡®çè¯´ï¼æç§æ¬æºæä½ç³»ç»è®¾å®çå­èåºè¯»åæ°æ®ã\n\nè¿å¹¶ä¸æå³å¤§ç«¯å­èåºä¸éè¦ï¼äºå®ä¸ï¼å¾å¤ç½ç»è®¾å¤åç¹å®çæä½ç³»ç»éç¨çæ¯å¤§ç«¯å­èåºãè¿å°±å¸¦æ¥ä¸ä¸ªä¸¥éçé®é¢ï¼å¦æä¸æ®µæ°æ®æ¯å¤§ç«¯å­èåºï¼typedarray æ°ç»å°æ æ³æ­£ç¡®è§£æï¼å ä¸ºå®åªè½å¤çå°ç«¯å­èåºï¼ä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼javascript å¼å¥dataviewå¯¹è±¡ï¼å¯ä»¥è®¾å®å­èåºï¼ä¸æä¼è¯¦ç»ä»ç»ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\n// åå®ææ®µbufferåå«å¦ä¸å­è [0x02, 0x01, 0x03, 0x07]\nconst buffer = new arraybuffer(4);\nconst v1 = new uint8array(buffer);\nv1[0] = 2;\nv1[1] = 1;\nv1[2] = 3;\nv1[3] = 7;\n\nconst uint16view = new uint16array(buffer);\n\n// è®¡ç®æºéç¨å°ç«¯å­èåº\n// æä»¥å¤´ä¸¤ä¸ªå­èç­äº258\nif (uint16view[0] === 258) {\n  console.log('ok'); // \"ok\"\n}\n\n// èµå¼è¿ç®\nuint16view[0] = 255;    // å­èåä¸º[0xff, 0x00, 0x03, 0x07]\nuint16view[0] = 0xff05; // å­èåä¸º[0x05, 0xff, 0x03, 0x07]\nuint16view[1] = 0x0210; // å­èåä¸º[0x05, 0xff, 0x10, 0x02]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¸é¢çå½æ°å¯ä»¥ç¨æ¥å¤æ­ï¼å½åè§å¾æ¯å°ç«¯å­èåºï¼è¿æ¯å¤§ç«¯å­èåºã\n\nconst big_endian = symbol('big_endian');\nconst little_endian = symbol('little_endian');\n\nfunction getplatformendianness() {\n  let arr32 = uint32array.of(0x12345678);\n  let arr8 = new uint8array(arr32.buffer);\n  switch ((arr8[0]*0x1000000) + (arr8[1]*0x10000) + (arr8[2]*0x100) + (arr8[3])) {\n    case 0x12345678:\n      return big_endian;\n    case 0x78563412:\n      return little_endian;\n    default:\n      throw new error('unknown endianness');\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\næ»ä¹ï¼ä¸æ®éæ°ç»ç¸æ¯ï¼typedarray æ°ç»çæå¤§ä¼ç¹å°±æ¯å¯ä»¥ç´æ¥æä½åå­ï¼ä¸éè¦æ°æ®ç±»åè½¬æ¢ï¼æä»¥éåº¦å¿«å¾å¤ã\n\n\n# bytes_per_element å±æ§\n\næ¯ä¸ç§è§å¾çæé å½æ°ï¼é½æä¸ä¸ªbytes_per_elementå±æ§ï¼è¡¨ç¤ºè¿ç§æ°æ®ç±»åå æ®çå­èæ°ã\n\nint8array.bytes_per_element // 1\nuint8array.bytes_per_element // 1\nuint8clampedarray.bytes_per_element // 1\nint16array.bytes_per_element // 2\nuint16array.bytes_per_element // 2\nint32array.bytes_per_element // 4\nuint32array.bytes_per_element // 4\nfloat32array.bytes_per_element // 4\nfloat64array.bytes_per_element // 8\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nè¿ä¸ªå±æ§å¨typedarrayå®ä¾ä¸ä¹è½è·åï¼å³ætypedarray.prototype.bytes_per_elementã\n\n\n# arraybuffer ä¸å­ç¬¦ä¸²çäºç¸è½¬æ¢\n\narraybuffer åå­ç¬¦ä¸²çç¸äºè½¬æ¢ï¼ä½¿ç¨åç textencoder å textdecoder æ¹æ³ãä¸ºäºä¾¿äºè¯´æç¨æ³ï¼ä¸é¢çä»£ç é½æç§ typescript çç¨æ³ï¼ç»åºäºç±»åç­¾åã\n\n/**\n * convert arraybuffer/typedarray to string via textdecoder\n *\n * @see https://developer.mozilla.org/en-us/docs/web/api/textdecoder\n */\nfunction ab2str(\n  input: arraybuffer | uint8array | int8array | uint16array | int16array | uint32array | int32array,\n  outputencoding: string = 'utf8',\n): string {\n  const decoder = new textdecoder(outputencoding)\n  return decoder.decode(input)\n}\n\n/**\n * convert string to arraybuffer via textencoder\n *\n * @see https://developer.mozilla.org/zh-cn/docs/web/api/textencoder\n */\nfunction str2ab(input: string): arraybuffer {\n  const view = str2uint8array(input)\n  return view.buffer\n}\n\n/** convert string to uint8array */\nfunction str2uint8array(input: string): uint8array {\n  const encoder = new textencoder()\n  const view = encoder.encode(input)\n  return view\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nä¸é¢ä»£ç ä¸­ï¼ab2str()çç¬¬äºä¸ªåæ°outputencodingç»åºäºè¾åºç¼ç çç¼ç ï¼ä¸è¬ä¿æé»è®¤å¼ï¼utf-8ï¼ï¼å¶ä»å¯éå¼åè§å®æ¹ææ¡£æ node.js ææ¡£ã\n\n\n# æº¢åº\n\nä¸åçè§å¾ç±»åï¼æè½å®¹çº³çæ°å¼èå´æ¯ç¡®å®çãè¶åºè¿ä¸ªèå´ï¼å°±ä¼åºç°æº¢åºãæ¯å¦ï¼8 ä½è§å¾åªè½å®¹çº³ä¸ä¸ª 8 ä½çäºè¿å¶å¼ï¼å¦ææ¾å¥ä¸ä¸ª 9 ä½çå¼ï¼å°±ä¼æº¢åºã\n\ntypedarray æ°ç»çæº¢åºå¤çè§åï¼ç®åæ¥è¯´ï¼å°±æ¯æå¼æº¢åºçä½ï¼ç¶åæç§è§å¾ç±»åè¿è¡è§£éã\n\nconst uint8 = new uint8array(1);\n\nuint8[0] = 256;\nuint8[0] // 0\n\nuint8[0] = -1;\nuint8[0] // 255\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼uint8æ¯ä¸ä¸ª 8 ä½è§å¾ï¼è 256 çäºè¿å¶å½¢å¼æ¯ä¸ä¸ª 9 ä½çå¼100000000ï¼è¿æ¶å°±ä¼åçæº¢åºãæ ¹æ®è§åï¼åªä¼ä¿çå 8 ä½ï¼å³00000000ãuint8è§å¾çè§£éè§åæ¯æ ç¬¦å·ç 8 ä½æ´æ°ï¼æä»¥00000000å°±æ¯0ã\n\nè´æ°å¨è®¡ç®æºåé¨éç¨â2 çè¡¥ç âè¡¨ç¤ºï¼ä¹å°±æ¯è¯´ï¼å°å¯¹åºçæ­£æ°å¼è¿è¡å¦è¿ç®ï¼ç¶åå 1ãæ¯å¦ï¼-1å¯¹åºçæ­£å¼æ¯1ï¼è¿è¡å¦è¿ç®ä»¥åï¼å¾å°11111110ï¼åå ä¸1å°±æ¯è¡¥ç å½¢å¼11111111ãuint8æç§æ ç¬¦å·ç 8 ä½æ´æ°è§£é11111111ï¼è¿åç»æå°±æ¯255ã\n\nä¸ä¸ªç®åè½¬æ¢è§åï¼å¯ä»¥è¿æ ·è¡¨ç¤ºã\n\n * æ­£åæº¢åºï¼overflowï¼ï¼å½è¾å¥å¼å¤§äºå½åæ°æ®ç±»åçæå¤§å¼ï¼ç»æç­äºå½åæ°æ®ç±»åçæå°å¼å ä¸ä½å¼ï¼ååå» 1ã\n * è´åæº¢åºï¼underflowï¼ï¼å½è¾å¥å¼å°äºå½åæ°æ®ç±»åçæå°å¼ï¼ç»æç­äºå½åæ°æ®ç±»åçæå¤§å¼åå»ä½å¼çç»å¯¹å¼ï¼åå ä¸ 1ã\n\nä¸é¢çâä½å¼âå°±æ¯æ¨¡è¿ç®çç»æï¼å³ javascript éé¢ç%è¿ç®ç¬¦çç»æã\n\n12 % 4 // 0\n12 % 5 // 2\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼12 é¤ä»¥ 4 æ¯æ²¡æä½å¼çï¼èé¤ä»¥ 5 ä¼å¾å°ä½å¼ 2ã\n\nè¯·çä¸é¢çä¾å­ã\n\nconst int8 = new int8array(1);\n\nint8[0] = 128;\nint8[0] // -128\n\nint8[0] = -129;\nint8[0] // 127\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä¾å­ä¸­ï¼int8æ¯ä¸ä¸ªå¸¦ç¬¦å·ç 8 ä½æ´æ°è§å¾ï¼å®çæå¤§å¼æ¯ 127ï¼æå°å¼æ¯-128ãè¾å¥å¼ä¸º128æ¶ï¼ç¸å½äºæ­£åæº¢åº1ï¼æ ¹æ®âæå°å¼å ä¸ä½å¼ï¼128 é¤ä»¥ 127 çä½å¼æ¯ 1ï¼ï¼ååå» 1âçè§åï¼å°±ä¼è¿å-128ï¼è¾å¥å¼ä¸º-129æ¶ï¼ç¸å½äºè´åæº¢åº1ï¼æ ¹æ®âæå¤§å¼åå»ä½å¼çç»å¯¹å¼ï¼-129 é¤ä»¥-128 çä½å¼çç»å¯¹å¼æ¯ 1ï¼ï¼åå ä¸ 1âçè§åï¼å°±ä¼è¿å127ã\n\nuint8clampedarrayè§å¾çæº¢åºè§åï¼ä¸ä¸é¢çè§åä¸åãå®è§å®ï¼å¡æ¯åçæ­£åæº¢åºï¼è¯¥å¼ä¸å¾ç­äºå½åæ°æ®ç±»åçæå¤§å¼ï¼å³ 255ï¼å¦æåçè´åæº¢åºï¼è¯¥å¼ä¸å¾ç­äºå½åæ°æ®ç±»åçæå°å¼ï¼å³ 0ã\n\nconst uint8c = new uint8clampedarray(1);\n\nuint8c[0] = 256;\nuint8c[0] // 255\n\nuint8c[0] = -1;\nuint8c[0] // 0\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä¾å­ä¸­ï¼uint8cæ¯ä¸ä¸ªuint8clampedarrayè§å¾ï¼æ­£åæº¢åºæ¶é½è¿å 255ï¼è´åæº¢åºé½è¿å 0ã\n\n\n# typedarray.prototype.buffer\n\ntypedarrayå®ä¾çbufferå±æ§ï¼è¿åæ´æ®µåå­åºåå¯¹åºçarraybufferå¯¹è±¡ãè¯¥å±æ§ä¸ºåªè¯»å±æ§ã\n\nconst a = new float32array(64);\nconst b = new uint8array(a.buffer);\n\n\n1\n2\n\n\nä¸é¢ä»£ç çaè§å¾å¯¹è±¡åbè§å¾å¯¹è±¡ï¼å¯¹åºåä¸ä¸ªarraybufferå¯¹è±¡ï¼å³åä¸æ®µåå­ã\n\n\n# typedarray.prototype.bytelengthï¼typedarray.prototype.byteoffset\n\nbytelengthå±æ§è¿å typedarray æ°ç»å æ®çåå­é¿åº¦ï¼åä½ä¸ºå­èãbyteoffsetå±æ§è¿å typedarray æ°ç»ä»åºå±arraybufferå¯¹è±¡çåªä¸ªå­èå¼å§ãè¿ä¸¤ä¸ªå±æ§é½æ¯åªè¯»å±æ§ã\n\nconst b = new arraybuffer(8);\n\nconst v1 = new int32array(b);\nconst v2 = new uint8array(b, 2);\nconst v3 = new int16array(b, 2, 2);\n\nv1.bytelength // 8\nv2.bytelength // 6\nv3.bytelength // 4\n\nv1.byteoffset // 0\nv2.byteoffset // 2\nv3.byteoffset // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# typedarray.prototype.length\n\nlengthå±æ§è¡¨ç¤º typedarray æ°ç»å«æå¤å°ä¸ªæåãæ³¨æå° length å±æ§å bytelength å±æ§åºåï¼åèæ¯æåé¿åº¦ï¼åèæ¯å­èé¿åº¦ã\n\nconst a = new int16array(8);\n\na.length // 8\na.bytelength // 16\n\n\n1\n2\n3\n4\n\n\n\n# typedarray.prototype.set()\n\ntypedarray æ°ç»çsetæ¹æ³ç¨äºå¤å¶æ°ç»ï¼æ®éæ°ç»æ typedarray æ°ç»ï¼ï¼ä¹å°±æ¯å°ä¸æ®µåå®¹å®å¨å¤å¶å°å¦ä¸æ®µåå­ã\n\nconst a = new uint8array(8);\nconst b = new uint8array(8);\n\nb.set(a);\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç å¤å¶aæ°ç»çåå®¹å°bæ°ç»ï¼å®æ¯æ´æ®µåå­çå¤å¶ï¼æ¯ä¸ä¸ªä¸ªæ·è´æåçé£ç§å¤å¶å¿«å¾å¤ã\n\nsetæ¹æ³è¿å¯ä»¥æ¥åç¬¬äºä¸ªåæ°ï¼è¡¨ç¤ºä»bå¯¹è±¡çåªä¸ä¸ªæåå¼å§å¤å¶aå¯¹è±¡ã\n\nconst a = new uint16array(8);\nconst b = new uint16array(10);\n\nb.set(a, 2)\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç çbæ°ç»æ¯aæ°ç»å¤ä¸¤ä¸ªæåï¼æä»¥ä»b[2]å¼å§å¤å¶ã\n\n\n# typedarray.prototype.subarray()\n\nsubarrayæ¹æ³æ¯å¯¹äº typedarray æ°ç»çä¸é¨åï¼åå»ºç«ä¸ä¸ªæ°çè§å¾ã\n\nconst a = new uint16array(8);\nconst b = a.subarray(2,3);\n\na.bytelength // 16\nb.bytelength // 2\n\n\n1\n2\n3\n4\n5\n\n\nsubarrayæ¹æ³çç¬¬ä¸ä¸ªåæ°æ¯èµ·å§çæååºå·ï¼ç¬¬äºä¸ªåæ°æ¯ç»æçæååºå·ï¼ä¸å«è¯¥æåï¼ï¼å¦æçç¥ååå«å©ä½çå¨é¨æåãæä»¥ï¼ä¸é¢ä»£ç ça.subarray(2,3)ï¼æå³ç b åªåå«a[2]ä¸ä¸ªæåï¼å­èé¿åº¦ä¸º 2ã\n\n\n# typedarray.prototype.slice()\n\ntypearray å®ä¾çsliceæ¹æ³ï¼å¯ä»¥è¿åä¸ä¸ªæå®ä½ç½®çæ°çtypedarrayå®ä¾ã\n\nlet ui8 = uint8array.of(0, 1, 2);\nui8.slice(-1)\n// uint8array [ 2 ]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼ui8æ¯ 8 ä½æ ç¬¦å·æ´æ°æ°ç»è§å¾çä¸ä¸ªå®ä¾ãå®çsliceæ¹æ³å¯ä»¥ä»å½åè§å¾ä¹ä¸­ï¼è¿åä¸ä¸ªæ°çè§å¾å®ä¾ã\n\nsliceæ¹æ³çåæ°ï¼è¡¨ç¤ºåæ°ç»çå·ä½ä½ç½®ï¼å¼å§çææ°æ°ç»ãè´å¼è¡¨ç¤ºéåçä½ç½®ï¼å³-1 ä¸ºåæ°ç¬¬ä¸ä¸ªä½ç½®ï¼-2 è¡¨ç¤ºåæ°ç¬¬äºä¸ªä½ç½®ï¼ä»¥æ­¤ç±»æ¨ã\n\n\n# typedarray.of()\n\ntypedarray æ°ç»çæææé å½æ°ï¼é½æä¸ä¸ªéææ¹æ³ofï¼ç¨äºå°åæ°è½¬ä¸ºä¸ä¸ªtypedarrayå®ä¾ã\n\nfloat32array.of(0.151, -8, 3.7)\n// float32array [ 0.151, -8, 3.7 ]\n\n\n1\n2\n\n\nä¸é¢ä¸ç§æ¹æ³é½ä¼çæåæ ·ä¸ä¸ª typedarray æ°ç»ã\n\n// æ¹æ³ä¸\nlet tarr = new uint8array([1,2,3]);\n\n// æ¹æ³äº\nlet tarr = uint8array.of(1,2,3);\n\n// æ¹æ³ä¸\nlet tarr = new uint8array(3);\ntarr[0] = 1;\ntarr[1] = 2;\ntarr[2] = 3;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# typedarray.from()\n\néææ¹æ³fromæ¥åä¸ä¸ªå¯éåçæ°æ®ç»æï¼æ¯å¦æ°ç»ï¼ä½ä¸ºåæ°ï¼è¿åä¸ä¸ªåºäºè¿ä¸ªç»æçtypedarrayå®ä¾ã\n\nuint16array.from([0, 1, 2])\n// uint16array [ 0, 1, 2 ]\n\n\n1\n2\n\n\nè¿ä¸ªæ¹æ³è¿å¯ä»¥å°ä¸ç§typedarrayå®ä¾ï¼è½¬ä¸ºå¦ä¸ç§ã\n\nconst ui16 = uint16array.from(uint8array.of(0, 1, 2));\nui16 instanceof uint16array // true\n\n\n1\n2\n\n\nfromæ¹æ³è¿å¯ä»¥æ¥åä¸ä¸ªå½æ°ï¼ä½ä¸ºç¬¬äºä¸ªåæ°ï¼ç¨æ¥å¯¹æ¯ä¸ªåç´ è¿è¡éåï¼åè½ç±»ä¼¼mapæ¹æ³ã\n\nint8array.of(127, 126, 125).map(x => 2 * x)\n// int8array [ -2, -4, -6 ]\n\nint16array.from(int8array.of(127, 126, 125), x => 2 * x)\n// int16array [ 254, 252, 250 ]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çä¾å­ä¸­ï¼fromæ¹æ³æ²¡æåçæº¢åºï¼è¿è¯´æéåä¸æ¯éå¯¹åæ¥ç 8 ä½æ´æ°æ°ç»ãä¹å°±æ¯è¯´ï¼fromä¼å°ç¬¬ä¸ä¸ªåæ°æå®ç typedarray æ°ç»ï¼æ·è´å°å¦ä¸æ®µåå­ä¹ä¸­ï¼å¤çä¹ååå°ç»æè½¬ææå®çæ°ç»æ ¼å¼ã\n\n\n# å¤åè§å¾\n\nç±äºè§å¾çæé å½æ°å¯ä»¥æå®èµ·å§ä½ç½®åé¿åº¦ï¼æä»¥å¨åä¸æ®µåå­ä¹ä¸­ï¼å¯ä»¥ä¾æ¬¡å­æ¾ä¸åç±»åçæ°æ®ï¼è¿å«åâå¤åè§å¾âã\n\nconst buffer = new arraybuffer(24);\n\nconst idview = new uint32array(buffer, 0, 1);\nconst usernameview = new uint8array(buffer, 4, 16);\nconst amountdueview = new float32array(buffer, 20, 1);\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç å°ä¸ä¸ª 24 å­èé¿åº¦çarraybufferå¯¹è±¡ï¼åæä¸ä¸ªé¨åï¼\n\n * å­è 0 å°å­è 3ï¼1 ä¸ª 32 ä½æ ç¬¦å·æ´æ°\n * å­è 4 å°å­è 19ï¼16 ä¸ª 8 ä½æ´æ°\n * å­è 20 å°å­è 23ï¼1 ä¸ª 32 ä½æµ®ç¹æ°\n\nè¿ç§æ°æ®ç»æå¯ä»¥ç¨å¦ä¸ç c è¯­è¨æè¿°ï¼\n\nstruct somestruct {\n  unsigned long id;\n  char username[16];\n  float amountdue;\n};\n\n\n1\n2\n3\n4\n5\n\n\n\n# dataview è§å¾\n\nå¦æä¸æ®µæ°æ®åæ¬å¤ç§ç±»åï¼æ¯å¦æå¡å¨ä¼ æ¥ç http æ°æ®ï¼ï¼è¿æ¶é¤äºå»ºç«arraybufferå¯¹è±¡çå¤åè§å¾ä»¥å¤ï¼è¿å¯ä»¥éè¿dataviewè§å¾è¿è¡æä½ã\n\ndataviewè§å¾æä¾æ´å¤æä½éé¡¹ï¼èä¸æ¯æè®¾å®å­èåºãæ¬æ¥ï¼å¨è®¾è®¡ç®çä¸ï¼arraybufferå¯¹è±¡çåç§typedarrayè§å¾ï¼æ¯ç¨æ¥åç½å¡ãå£°å¡ä¹ç±»çæ¬æºè®¾å¤ä¼ éæ°æ®ï¼æä»¥ä½¿ç¨æ¬æºçå­èåºå°±å¯ä»¥äºï¼èdataviewè§å¾çè®¾è®¡ç®çï¼æ¯ç¨æ¥å¤çç½ç»è®¾å¤ä¼ æ¥çæ°æ®ï¼æä»¥å¤§ç«¯å­èåºæå°ç«¯å­èåºæ¯å¯ä»¥èªè¡è®¾å®çã\n\ndataviewè§å¾æ¬èº«ä¹æ¯æé å½æ°ï¼æ¥åä¸ä¸ªarraybufferå¯¹è±¡ä½ä¸ºåæ°ï¼çæè§å¾ã\n\ndataview(arraybuffer buffer [, å­èèµ·å§ä½ç½® [, é¿åº¦]]);\n\n\n1\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nconst buffer = new arraybuffer(24);\nconst dv = new dataview(buffer);\n\n\n1\n2\n\n\ndataviewå®ä¾æä»¥ä¸å±æ§ï¼å«ä¹ä¸typedarrayå®ä¾çååæ¹æ³ç¸åã\n\n * dataview.prototype.bufferï¼è¿åå¯¹åºç arraybuffer å¯¹è±¡\n * dataview.prototype.bytelengthï¼è¿åå æ®çåå­å­èé¿åº¦\n * dataview.prototype.byteoffsetï¼è¿åå½åè§å¾ä»å¯¹åºç arraybuffer å¯¹è±¡çåªä¸ªå­èå¼å§\n\ndataviewå®ä¾æä¾ 8 ä¸ªæ¹æ³è¯»ååå­ã\n\n * getint8ï¼è¯»å 1 ä¸ªå­èï¼è¿åä¸ä¸ª 8 ä½æ´æ°ã\n * getuint8ï¼è¯»å 1 ä¸ªå­èï¼è¿åä¸ä¸ªæ ç¬¦å·ç 8 ä½æ´æ°ã\n * getint16ï¼è¯»å 2 ä¸ªå­èï¼è¿åä¸ä¸ª 16 ä½æ´æ°ã\n * getuint16ï¼è¯»å 2 ä¸ªå­èï¼è¿åä¸ä¸ªæ ç¬¦å·ç 16 ä½æ´æ°ã\n * getint32ï¼è¯»å 4 ä¸ªå­èï¼è¿åä¸ä¸ª 32 ä½æ´æ°ã\n * getuint32ï¼è¯»å 4 ä¸ªå­èï¼è¿åä¸ä¸ªæ ç¬¦å·ç 32 ä½æ´æ°ã\n * getfloat32ï¼è¯»å 4 ä¸ªå­èï¼è¿åä¸ä¸ª 32 ä½æµ®ç¹æ°ã\n * getfloat64ï¼è¯»å 8 ä¸ªå­èï¼è¿åä¸ä¸ª 64 ä½æµ®ç¹æ°ã\n\nè¿ä¸ç³»ågetæ¹æ³çåæ°é½æ¯ä¸ä¸ªå­èåºå·ï¼ä¸è½æ¯è´æ°ï¼å¦åä¼æ¥éï¼ï¼è¡¨ç¤ºä»åªä¸ªå­èå¼å§è¯»åã\n\nconst buffer = new arraybuffer(24);\nconst dv = new dataview(buffer);\n\n// ä»ç¬¬1ä¸ªå­èè¯»åä¸ä¸ª8ä½æ ç¬¦å·æ´æ°\nconst v1 = dv.getuint8(0);\n\n// ä»ç¬¬2ä¸ªå­èè¯»åä¸ä¸ª16ä½æ ç¬¦å·æ´æ°\nconst v2 = dv.getuint16(1);\n\n// ä»ç¬¬4ä¸ªå­èè¯»åä¸ä¸ª16ä½æ ç¬¦å·æ´æ°\nconst v3 = dv.getuint16(3);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç è¯»åäºarraybufferå¯¹è±¡çå 5 ä¸ªå­èï¼å¶ä¸­æä¸ä¸ª 8 ä½æ´æ°åä¸¤ä¸ªåå­ä½æ´æ°ã\n\nå¦æä¸æ¬¡è¯»åä¸¤ä¸ªæä¸¤ä¸ªä»¥ä¸å­èï¼å°±å¿é¡»æç¡®æ°æ®çå­å¨æ¹å¼ï¼å°åºæ¯å°ç«¯å­èåºè¿æ¯å¤§ç«¯å­èåºãé»è®¤æåµä¸ï¼dataviewçgetæ¹æ³ä½¿ç¨å¤§ç«¯å­èåºè§£è¯»æ°æ®ï¼å¦æéè¦ä½¿ç¨å°ç«¯å­èåºè§£è¯»ï¼å¿é¡»å¨getæ¹æ³çç¬¬äºä¸ªåæ°æå®trueã\n\n// å°ç«¯å­èåº\nconst v1 = dv.getuint16(1, true);\n\n// å¤§ç«¯å­èåº\nconst v2 = dv.getuint16(3, false);\n\n// å¤§ç«¯å­èåº\nconst v3 = dv.getuint16(3);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\ndataview è§å¾æä¾ 8 ä¸ªæ¹æ³åå¥åå­ã\n\n * setint8ï¼åå¥ 1 ä¸ªå­èç 8 ä½æ´æ°ã\n * setuint8ï¼åå¥ 1 ä¸ªå­èç 8 ä½æ ç¬¦å·æ´æ°ã\n * setint16ï¼åå¥ 2 ä¸ªå­èç 16 ä½æ´æ°ã\n * setuint16ï¼åå¥ 2 ä¸ªå­èç 16 ä½æ ç¬¦å·æ´æ°ã\n * setint32ï¼åå¥ 4 ä¸ªå­èç 32 ä½æ´æ°ã\n * setuint32ï¼åå¥ 4 ä¸ªå­èç 32 ä½æ ç¬¦å·æ´æ°ã\n * setfloat32ï¼åå¥ 4 ä¸ªå­èç 32 ä½æµ®ç¹æ°ã\n * setfloat64ï¼åå¥ 8 ä¸ªå­èç 64 ä½æµ®ç¹æ°ã\n\nè¿ä¸ç³»åsetæ¹æ³ï¼æ¥åä¸¤ä¸ªåæ°ï¼ç¬¬ä¸ä¸ªåæ°æ¯å­èåºå·ï¼è¡¨ç¤ºä»åªä¸ªå­èå¼å§åå¥ï¼ç¬¬äºä¸ªåæ°ä¸ºåå¥çæ°æ®ãå¯¹äºé£äºåå¥ä¸¤ä¸ªæä¸¤ä¸ªä»¥ä¸å­èçæ¹æ³ï¼éè¦æå®ç¬¬ä¸ä¸ªåæ°ï¼falseæèundefinedè¡¨ç¤ºä½¿ç¨å¤§ç«¯å­èåºåå¥ï¼trueè¡¨ç¤ºä½¿ç¨å°ç«¯å­èåºåå¥ã\n\n// å¨ç¬¬1ä¸ªå­èï¼ä»¥å¤§ç«¯å­èåºåå¥å¼ä¸º25ç32ä½æ´æ°\ndv.setint32(0, 25, false);\n\n// å¨ç¬¬5ä¸ªå­èï¼ä»¥å¤§ç«¯å­èåºåå¥å¼ä¸º25ç32ä½æ´æ°\ndv.setint32(4, 25);\n\n// å¨ç¬¬9ä¸ªå­èï¼ä»¥å°ç«¯å­èåºåå¥å¼ä¸º2.5ç32ä½æµ®ç¹æ°\ndv.setfloat32(8, 2.5, true);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¦æä¸ç¡®å®æ­£å¨ä½¿ç¨çè®¡ç®æºçå­èåºï¼å¯ä»¥éç¨ä¸é¢çå¤æ­æ¹å¼ã\n\nconst littleendian = (function() {\n  const buffer = new arraybuffer(2);\n  new dataview(buffer).setint16(0, 256, true);\n  return new int16array(buffer)[0] === 256;\n})();\n\n\n1\n2\n3\n4\n5\n\n\nå¦æè¿åtrueï¼å°±æ¯å°ç«¯å­èåºï¼å¦æè¿åfalseï¼å°±æ¯å¤§ç«¯å­èåºã\n\n\n# äºè¿å¶æ°ç»çåºç¨\n\nå¤§éç web api ç¨å°äºarraybufferå¯¹è±¡åå®çè§å¾å¯¹è±¡ã\n\n\n# ajax\n\nä¼ ç»ä¸ï¼æå¡å¨éè¿ ajax æä½åªè½è¿åææ¬æ°æ®ï¼å³responsetypeå±æ§é»è®¤ä¸ºtextãxmlhttprequestç¬¬äºçxhr2åè®¸æå¡å¨è¿åäºè¿å¶æ°æ®ï¼è¿æ¶åæä¸¤ç§æåµãå¦ææç¡®ç¥éè¿åçäºè¿å¶æ°æ®ç±»åï¼å¯ä»¥æè¿åç±»åï¼responsetypeï¼è®¾ä¸ºarraybufferï¼å¦æä¸ç¥éï¼å°±è®¾ä¸ºblobã\n\nlet xhr = new xmlhttprequest();\nxhr.open('get', someurl);\nxhr.responsetype = 'arraybuffer';\n\nxhr.onload = function () {\n  let arraybuffer = xhr.response;\n  // Â·Â·Â·\n};\n\nxhr.send();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¦æç¥éä¼ åæ¥çæ¯ 32 ä½æ´æ°ï¼å¯ä»¥åä¸é¢è¿æ ·å¤çã\n\nxhr.onreadystatechange = function () {\n  if (req.readystate === 4 ) {\n    const arrayresponse = xhr.response;\n    const dataview = new dataview(arrayresponse);\n    const ints = new uint32array(dataview.bytelength / 4);\n\n    xhrdiv.style.backgroundcolor = \"#00ff00\";\n    xhrdiv.innertext = \"array is \" + ints.length + \"uints long\";\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n# canvas\n\nç½é¡µcanvasåç´ è¾åºçäºè¿å¶åç´ æ°æ®ï¼å°±æ¯ typedarray æ°ç»ã\n\nconst canvas = document.getelementbyid('mycanvas');\nconst ctx = canvas.getcontext('2d');\n\nconst imagedata = ctx.getimagedata(0, 0, canvas.width, canvas.height);\nconst uint8clampedarray = imagedata.data;\n\n\n1\n2\n3\n4\n5\n\n\néè¦æ³¨æçæ¯ï¼ä¸é¢ä»£ç çuint8clampedarrayè½ç¶æ¯ä¸ä¸ª typedarray æ°ç»ï¼ä½æ¯å®çè§å¾ç±»åæ¯ä¸ç§éå¯¹canvasåç´ çä¸æç±»åuint8clampedarrayãè¿ä¸ªè§å¾ç±»åçç¹ç¹ï¼å°±æ¯ä¸é¨éå¯¹é¢è²ï¼ææ¯ä¸ªå­èè§£è¯»ä¸ºæ ç¬¦å·ç 8 ä½æ´æ°ï¼å³åªè½åå¼ 0 ï½ 255ï¼èä¸åçè¿ç®çæ¶åèªå¨è¿æ»¤é«ä½æº¢åºãè¿ä¸ºå¾åå¤çå¸¦æ¥äºå·¨å¤§çæ¹ä¾¿ã\n\nä¸¾ä¾æ¥è¯´ï¼å¦ææåç´ çé¢è²å¼è®¾ä¸ºuint8arrayç±»åï¼é£ä¹ä¹ä»¥ä¸ä¸ª gamma å¼çæ¶åï¼å°±å¿é¡»è¿æ ·è®¡ç®ï¼\n\nu8[i] = math.min(255, math.max(0, u8[i] * gamma));\n\n\n1\n\n\nå ä¸ºuint8arrayç±»åå¯¹äºå¤§äº 255 çè¿ç®ç»æï¼æ¯å¦0xff+1ï¼ï¼ä¼èªå¨åä¸º0x00ï¼æä»¥å¾åå¤çå¿é¡»è¦åä¸é¢è¿æ ·ç®ãè¿æ ·åå¾éº»ç¦ï¼èä¸å½±åæ§è½ãå¦æå°é¢è²å¼è®¾ä¸ºuint8clampedarrayç±»åï¼è®¡ç®å°±ç®åè®¸å¤ã\n\npixels[i] *= gamma;\n\n\n1\n\n\nuint8clampedarrayç±»åç¡®ä¿å°å°äº 0 çå¼è®¾ä¸º 0ï¼å°å¤§äº 255 çå¼è®¾ä¸º 255ãæ³¨æï¼ie 10 ä¸æ¯æè¯¥ç±»åã\n\n\n# websocket\n\nwebsocketå¯ä»¥éè¿arraybufferï¼åéææ¥æ¶äºè¿å¶æ°æ®ã\n\nlet socket = new websocket('ws://127.0.0.1:8081');\nsocket.binarytype = 'arraybuffer';\n\n// wait until socket is open\nsocket.addeventlistener('open', function (event) {\n  // send binary data\n  const typedarray = new uint8array(4);\n  socket.send(typedarray.buffer);\n});\n\n// receive binary data\nsocket.addeventlistener('message', function (event) {\n  const arraybuffer = event.data;\n  // Â·Â·Â·\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# fetch api\n\nfetch api ååçæ°æ®ï¼å°±æ¯arraybufferå¯¹è±¡ã\n\nfetch(url)\n.then(function(response){\n  return response.arraybuffer()\n})\n.then(function(arraybuffer){\n  // ...\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# file api\n\nå¦æç¥éä¸ä¸ªæä»¶çäºè¿å¶æ°æ®ç±»åï¼ä¹å¯ä»¥å°è¿ä¸ªæä»¶è¯»åä¸ºarraybufferå¯¹è±¡ã\n\nconst fileinput = document.getelementbyid('fileinput');\nconst file = fileinput.files[0];\nconst reader = new filereader();\nreader.readasarraybuffer(file);\nreader.onload = function () {\n  const arraybuffer = reader.result;\n  // Â·Â·Â·\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»¥å¤ç bmp æä»¶ä¸ºä¾ãåå®fileåéæ¯ä¸ä¸ªæå bmp æä»¶çæä»¶å¯¹è±¡ï¼é¦åè¯»åæä»¶ã\n\nconst reader = new filereader();\nreader.addeventlistener(\"load\", processimage, false);\nreader.readasarraybuffer(file);\n\n\n1\n2\n3\n\n\nç¶åï¼å®ä¹å¤çå¾åçåè°å½æ°ï¼åå¨äºè¿å¶æ°æ®ä¹ä¸å»ºç«ä¸ä¸ªdataviewè§å¾ï¼åå»ºç«ä¸ä¸ªbitmapå¯¹è±¡ï¼ç¨äºå­æ¾å¤çåçæ°æ®ï¼æåå°å¾åå±ç¤ºå¨canvasåç´ ä¹ä¸­ã\n\nfunction processimage(e) {\n  const buffer = e.target.result;\n  const datav = new dataview(buffer);\n  const bitmap = {};\n  // å·ä½çå¤çæ­¥éª¤\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nå·ä½å¤çå¾åæ°æ®æ¶ï¼åå¤ç bmp çæä»¶å¤´ãå·ä½æ¯ä¸ªæä»¶å¤´çæ ¼å¼åå®ä¹ï¼è¯·åéæå³èµæã\n\nbitmap.fileheader = {};\nbitmap.fileheader.bftype = datav.getuint16(0, true);\nbitmap.fileheader.bfsize = datav.getuint32(2, true);\nbitmap.fileheader.bfreserved1 = datav.getuint16(6, true);\nbitmap.fileheader.bfreserved2 = datav.getuint16(8, true);\nbitmap.fileheader.bfoffbits = datav.getuint32(10, true);\n\n\n1\n2\n3\n4\n5\n6\n\n\næ¥çå¤çå¾ååä¿¡æ¯é¨åã\n\nbitmap.infoheader = {};\nbitmap.infoheader.bisize = datav.getuint32(14, true);\nbitmap.infoheader.biwidth = datav.getuint32(18, true);\nbitmap.infoheader.biheight = datav.getuint32(22, true);\nbitmap.infoheader.biplanes = datav.getuint16(26, true);\nbitmap.infoheader.bibitcount = datav.getuint16(28, true);\nbitmap.infoheader.bicompression = datav.getuint32(30, true);\nbitmap.infoheader.bisizeimage = datav.getuint32(34, true);\nbitmap.infoheader.bixpelspermeter = datav.getuint32(38, true);\nbitmap.infoheader.biypelspermeter = datav.getuint32(42, true);\nbitmap.infoheader.biclrused = datav.getuint32(46, true);\nbitmap.infoheader.biclrimportant = datav.getuint32(50, true);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\næåå¤çå¾åæ¬èº«çåç´ ä¿¡æ¯ã\n\nconst start = bitmap.fileheader.bfoffbits;\nbitmap.pixels = new uint8array(buffer, start);\n\n\n1\n2\n\n\nè³æ­¤ï¼å¾åæä»¶çæ°æ®å¨é¨å¤çå®æãä¸ä¸æ­¥ï¼å¯ä»¥æ ¹æ®éè¦ï¼è¿è¡å¾ååå½¢ï¼æèè½¬æ¢æ ¼å¼ï¼æèå±ç¤ºå¨canvasç½é¡µåç´ ä¹ä¸­ã\n\n\n# sharedarraybuffer\n\njavascript æ¯åçº¿ç¨çï¼web worker å¼å¥äºå¤çº¿ç¨ï¼ä¸»çº¿ç¨ç¨æ¥ä¸ç¨æ·äºå¨ï¼worker çº¿ç¨ç¨æ¥æ¿æè®¡ç®ä»»å¡ãæ¯ä¸ªçº¿ç¨çæ°æ®é½æ¯éç¦»çï¼éè¿postmessage()éä¿¡ãä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\n// ä¸»çº¿ç¨\nconst w = new worker('myworker.js');\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸»çº¿ç¨æ°å»ºäºä¸ä¸ª worker çº¿ç¨ãè¯¥çº¿ç¨ä¸ä¸»çº¿ç¨ä¹é´ä¼æä¸ä¸ªéä¿¡æ¸ éï¼ä¸»çº¿ç¨éè¿w.postmessageå worker çº¿ç¨åæ¶æ¯ï¼åæ¶éè¿messageäºä»¶çå¬ worker çº¿ç¨çååºã\n\n// ä¸»çº¿ç¨\nw.postmessage('hi');\nw.onmessage = function (ev) {\n  console.log(ev.data);\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸»çº¿ç¨ååä¸ä¸ªæ¶æ¯hiï¼ç¶åå¨çå¬å° worker çº¿ç¨çååºåï¼å°±å°å¶æå°åºæ¥ã\n\nworker çº¿ç¨ä¹æ¯éè¿çå¬messageäºä»¶ï¼æ¥è·åä¸»çº¿ç¨åæ¥çæ¶æ¯ï¼å¹¶ä½åºååºã\n\n// worker çº¿ç¨\nonmessage = function (ev) {\n  console.log(ev.data);\n  postmessage('ho');\n}\n\n\n1\n2\n3\n4\n5\n\n\nçº¿ç¨ä¹é´çæ°æ®äº¤æ¢å¯ä»¥æ¯åç§æ ¼å¼ï¼ä¸ä»ä»æ¯å­ç¬¦ä¸²ï¼ä¹å¯ä»¥æ¯äºè¿å¶æ°æ®ãè¿ç§äº¤æ¢éç¨çæ¯å¤å¶æºå¶ï¼å³ä¸ä¸ªè¿ç¨å°éè¦åäº«çæ°æ®å¤å¶ä¸ä»½ï¼éè¿postmessageæ¹æ³äº¤ç»å¦ä¸ä¸ªè¿ç¨ãå¦ææ°æ®éæ¯è¾å¤§ï¼è¿ç§éä¿¡çæçæ¾ç¶æ¯è¾ä½ãå¾å®¹ææ³å°ï¼è¿æ¶å¯ä»¥çåºä¸ååå­åºåï¼ç±ä¸»çº¿ç¨ä¸ worker çº¿ç¨å±äº«ï¼ä¸¤æ¹é½å¯ä»¥è¯»åï¼é£ä¹å°±ä¼å¤§å¤§æé«æçï¼åä½èµ·æ¥ä¹ä¼æ¯è¾ç®åï¼ä¸åpostmessageé£ä¹éº»ç¦ï¼ã\n\nes2017 å¼å¥sharedarraybufferï¼åè®¸ worker çº¿ç¨ä¸ä¸»çº¿ç¨å±äº«åä¸ååå­ãsharedarraybufferç api ä¸arraybufferä¸æ¨¡ä¸æ ·ï¼å¯ä¸çåºå«æ¯åèæ æ³å±äº«æ°æ®ã\n\n// ä¸»çº¿ç¨\n\n// æ°å»º 1kb å±äº«åå­\nconst sharedbuffer = new sharedarraybuffer(1024);\n\n// ä¸»çº¿ç¨å°å±äº«åå­çå°ååéåºå»\nw.postmessage(sharedbuffer);\n\n// å¨å±äº«åå­ä¸å»ºç«è§å¾ï¼ä¾åå¥æ°æ®\nconst sharedarray = new int32array(sharedbuffer);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼postmessageæ¹æ³çåæ°æ¯sharedarraybufferå¯¹è±¡ã\n\nworker çº¿ç¨ä»äºä»¶çdataå±æ§ä¸é¢åå°æ°æ®ã\n\n// worker çº¿ç¨\nonmessage = function (ev) {\n  // ä¸»çº¿ç¨å±äº«çæ°æ®ï¼å°±æ¯ 1kb çå±äº«åå­\n  const sharedbuffer = ev.data;\n\n  // å¨å±äº«åå­ä¸å»ºç«è§å¾ï¼æ¹ä¾¿è¯»å\n  const sharedarray = new int32array(sharedbuffer);\n\n  // ...\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå±äº«åå­ä¹å¯ä»¥å¨ worker çº¿ç¨åå»ºï¼åç»ä¸»çº¿ç¨ã\n\nsharedarraybufferä¸arraybufferä¸æ ·ï¼æ¬èº«æ¯æ æ³è¯»åçï¼å¿é¡»å¨ä¸é¢å»ºç«è§å¾ï¼ç¶åéè¿è§å¾è¯»åã\n\n// åé 10 ä¸ä¸ª 32 ä½æ´æ°å æ®çåå­ç©ºé´\nconst sab = new sharedarraybuffer(int32array.bytes_per_element * 100000);\n\n// å»ºç« 32 ä½æ´æ°è§å¾\nconst ia = new int32array(sab);  // ia.length == 100000\n\n// æ°å»ºä¸ä¸ªè´¨æ°çæå¨\nconst primes = new primegenerator();\n\n// å° 10 ä¸ä¸ªè´¨æ°ï¼åå¥è¿æ®µåå­ç©ºé´\nfor ( let i=0 ; i < ia.length ; i++ )\n  ia[i] = primes.next();\n\n// å worker çº¿ç¨åéè¿æ®µå±äº«åå­\nw.postmessage(ia);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nworker çº¿ç¨æ¶å°æ°æ®åçå¤çå¦ä¸ã\n\n// worker çº¿ç¨\nlet ia;\nonmessage = function (ev) {\n  ia = ev.data;\n  console.log(ia.length); // 100000\n  console.log(ia[37]); // è¾åº 163ï¼å ä¸ºè¿æ¯ç¬¬38ä¸ªè´¨æ°\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# atomics å¯¹è±¡\n\nå¤çº¿ç¨å±äº«åå­ï¼æå¤§çé®é¢å°±æ¯å¦ä½é²æ­¢ä¸¤ä¸ªçº¿ç¨åæ¶ä¿®æ¹æä¸ªå°åï¼æèè¯´ï¼å½ä¸ä¸ªçº¿ç¨ä¿®æ¹å±äº«åå­ä»¥åï¼å¿é¡»æä¸ä¸ªæºå¶è®©å¶ä»çº¿ç¨åæ­¥ãsharedarraybuffer api æä¾atomicså¯¹è±¡ï¼ä¿è¯ææå±äº«åå­çæä½é½æ¯âåå­æ§âçï¼å¹¶ä¸å¯ä»¥å¨ææçº¿ç¨ååæ­¥ã\n\nä»ä¹å«âåå­æ§æä½âå¢ï¼ç°ä»£ç¼ç¨è¯­è¨ä¸­ï¼ä¸æ¡æ®éçå½ä»¤è¢«ç¼è¯å¨å¤çä»¥åï¼ä¼åæå¤æ¡æºå¨æä»¤ãå¦ææ¯åçº¿ç¨è¿è¡ï¼è¿æ¯æ²¡æé®é¢çï¼å¤çº¿ç¨ç¯å¢å¹¶ä¸å±äº«åå­æ¶ï¼å°±ä¼åºé®é¢ï¼å ä¸ºè¿ä¸ç»æºå¨æä»¤çè¿è¡æé´ï¼å¯è½ä¼æå¥å¶ä»çº¿ç¨çæä»¤ï¼ä»èå¯¼è´è¿è¡ç»æåºéãè¯·çä¸é¢çä¾å­ã\n\n// ä¸»çº¿ç¨\nia[42] = 314159;  // ååçå¼ 191\nia[37] = 123456;  // ååçå¼ 163\n\n// worker çº¿ç¨\nconsole.log(ia[37]);\nconsole.log(ia[42]);\n// å¯è½çç»æ\n// 123456\n// 191\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸»çº¿ç¨çåå§é¡ºåºæ¯åå¯¹ 42 å·ä½ç½®èµå¼ï¼åå¯¹ 37 å·ä½ç½®èµå¼ãä½æ¯ï¼ç¼è¯å¨å cpu ä¸ºäºä¼åï¼å¯è½ä¼æ¹åè¿ä¸¤ä¸ªæä½çæ§è¡é¡ºåºï¼å ä¸ºå®ä»¬ä¹é´äºä¸ä¾èµï¼ï¼åå¯¹ 37 å·ä½ç½®èµå¼ï¼åå¯¹ 42 å·ä½ç½®èµå¼ãèæ§è¡å°ä¸åçæ¶åï¼worker çº¿ç¨å¯è½å°±ä¼æ¥è¯»åæ°æ®ï¼å¯¼è´æå°åº123456å191ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\n// ä¸»çº¿ç¨\nconst sab = new sharedarraybuffer(int32array.bytes_per_element * 100000);\nconst ia = new int32array(sab);\n\nfor (let i = 0; i < ia.length; i++) {\n  ia[i] = primes.next(); // å°è´¨æ°æ¾å¥ ia\n}\n\n// worker çº¿ç¨\nia[112]++; // éè¯¯\natomics.add(ia, 112, 1); // æ­£ç¡®\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼worker çº¿ç¨ç´æ¥æ¹åå±äº«åå­ia[112]++æ¯ä¸æ­£ç¡®çãå ä¸ºè¿è¡è¯­å¥ä¼è¢«ç¼è¯æå¤æ¡æºå¨æä»¤ï¼è¿äºæä»¤ä¹é´æ æ³ä¿è¯ä¸ä¼æå¥å¶ä»è¿ç¨çæä»¤ãè¯·è®¾æ³å¦æä¸¤ä¸ªçº¿ç¨åæ¶ia[112]++ï¼å¾å¯è½å®ä»¬å¾å°çç»æé½æ¯ä¸æ­£ç¡®çã\n\natomicså¯¹è±¡å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢èæåºï¼å®å¯ä»¥ä¿è¯ä¸ä¸ªæä½æå¯¹åºçå¤æ¡æºå¨æä»¤ï¼ä¸å®æ¯ä½ä¸ºä¸ä¸ªæ´ä½è¿è¡çï¼ä¸­é´ä¸ä¼è¢«ææ­ãä¹å°±æ¯è¯´ï¼å®ææ¶åçæä½é½å¯ä»¥çä½æ¯åå­æ§çåæä½ï¼è¿å¯ä»¥é¿åçº¿ç¨ç«äºï¼æé«å¤çº¿ç¨å±äº«åå­æ¶çæä½å®å¨ãæä»¥ï¼ia[112]++è¦æ¹åæatomics.add(ia, 112, 1)ã\n\natomicså¯¹è±¡æä¾å¤ç§æ¹æ³ã\n\nï¼1ï¼atomics.store()ï¼atomics.load()\n\nstore()æ¹æ³ç¨æ¥åå±äº«åå­åå¥æ°æ®ï¼load()æ¹æ³ç¨æ¥ä»å±äº«åå­è¯»åºæ°æ®ãæ¯èµ·ç´æ¥çè¯»åæä½ï¼å®ä»¬çå¥½å¤æ¯ä¿è¯äºè¯»åæä½çåå­æ§ã\n\næ­¤å¤ï¼å®ä»¬è¿ç¨æ¥è§£å³ä¸ä¸ªé®é¢ï¼å¤ä¸ªçº¿ç¨ä½¿ç¨å±äº«åå­çæä¸ªä½ç½®ä½ä¸ºå¼å³ï¼flagï¼ï¼ä¸æ¦è¯¥ä½ç½®çå¼åäºï¼å°±æ§è¡ç¹å®æä½ãè¿æ¶ï¼å¿é¡»ä¿è¯è¯¥ä½ç½®çèµå¼æä½ï¼ä¸å®æ¯å¨å®åé¢çææå¯è½ä¼æ¹ååå­çæä½ç»æåæ§è¡ï¼èè¯¥ä½ç½®çåå¼æä½ï¼ä¸å®æ¯å¨å®åé¢ææå¯è½ä¼è¯»åè¯¥ä½ç½®çæä½å¼å§ä¹åæ§è¡ãstoreæ¹æ³åloadæ¹æ³å°±è½åå°è¿ä¸ç¹ï¼ç¼è¯å¨ä¸ä¼ä¸ºäºä¼åï¼èæä¹±æºå¨æä»¤çæ§è¡é¡ºåºã\n\natomics.load(array, index)\natomics.store(array, index, value)\n\n\n1\n2\n\n\nstoreæ¹æ³æ¥åä¸ä¸ªåæ°ï¼sharedbuffer çè§å¾ãä½ç½®ç´¢å¼åå¼ï¼è¿åsharedarray[index]çå¼ãloadæ¹æ³åªæ¥åä¸¤ä¸ªåæ°ï¼sharedbuffer çè§å¾åä½ç½®ç´¢å¼ï¼ä¹æ¯è¿åsharedarray[index]çå¼ã\n\n// ä¸»çº¿ç¨ main.js\nia[42] = 314159;  // ååçå¼ 191\natomics.store(ia, 37, 123456);  // ååçå¼æ¯ 163\n\n// worker çº¿ç¨ worker.js\nwhile (atomics.load(ia, 37) == 163);\nconsole.log(ia[37]);  // 123456\nconsole.log(ia[42]);  // 314159\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸»çº¿ç¨çatomics.storeå 42 å·ä½ç½®çèµå¼ï¼ä¸å®æ¯æ©äº 37 ä½ç½®çèµå¼ãåªè¦ 37 å·ä½ç½®ç­äº 163ï¼worker çº¿ç¨å°±ä¸ä¼ç»æ­¢å¾ªç¯ï¼èå¯¹ 37 å·ä½ç½®å 42 å·ä½ç½®çåå¼ï¼ä¸å®æ¯å¨atomics.loadæä½ä¹åã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\n// ä¸»çº¿ç¨\nconst worker = new worker('worker.js');\nconst length = 10;\nconst size = int32array.bytes_per_element * length;\n// æ°å»ºä¸æ®µå±äº«åå­\nconst sharedbuffer = new sharedarraybuffer(size);\nconst sharedarray = new int32array(sharedbuffer);\nfor (let i = 0; i < 10; i++) {\n  // åå±äº«åå­åå¥ 10 ä¸ªæ´æ°\n  atomics.store(sharedarray, i, 0);\n}\nworker.postmessage(sharedbuffer);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸»çº¿ç¨ç¨atomics.store()æ¹æ³åå¥æ°æ®ãä¸é¢æ¯ worker çº¿ç¨ç¨atomics.load()æ¹æ³è¯»åæ°æ®ã\n\n// worker.js\nself.addeventlistener('message', (event) => {\n  const sharedarray = new int32array(event.data);\n  for (let i = 0; i < 10; i++) {\n    const arrayvalue = atomics.load(sharedarray, i);\n    console.log(`the item at array index ${i} is ${arrayvalue}`);\n  }\n}, false);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nï¼2ï¼atomics.exchange()\n\nworker çº¿ç¨å¦æè¦åå¥æ°æ®ï¼å¯ä»¥ä½¿ç¨ä¸é¢çatomics.store()æ¹æ³ï¼ä¹å¯ä»¥ä½¿ç¨atomics.exchange()æ¹æ³ãå®ä»¬çåºå«æ¯ï¼atomics.store()è¿ååå¥çå¼ï¼èatomics.exchange()è¿åè¢«æ¿æ¢çå¼ã\n\n// worker çº¿ç¨\nself.addeventlistener('message', (event) => {\n  const sharedarray = new int32array(event.data);\n  for (let i = 0; i < 10; i++) {\n    if (i % 2 === 0) {\n      const storedvalue = atomics.store(sharedarray, i, 1);\n      console.log(`the item at array index ${i} is now ${storedvalue}`);\n    } else {\n      const exchangedvalue = atomics.exchange(sharedarray, i, 2);\n      console.log(`the item at array index ${i} was ${exchangedvalue}, now 2`);\n    }\n  }\n}, false);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç å°å±äº«åå­çå¶æ°ä½ç½®çå¼æ¹æ1ï¼å¥æ°ä½ç½®çå¼æ¹æ2ã\n\nï¼3ï¼atomics.wait()ï¼atomics.wake()\n\nä½¿ç¨whileå¾ªç¯ç­å¾ä¸»çº¿ç¨çéç¥ï¼ä¸æ¯å¾é«æï¼å¦æç¨å¨ä¸»çº¿ç¨ï¼å°±ä¼é æå¡é¡¿ï¼atomicså¯¹è±¡æä¾äºwait()åwake()ä¸¤ä¸ªæ¹æ³ç¨äºç­å¾éç¥ãè¿ä¸¤ä¸ªæ¹æ³ç¸å½äºéåå­ï¼å³å¨ä¸ä¸ªçº¿ç¨è¿è¡æä½æ¶ï¼è®©å¶ä»çº¿ç¨ä¼ç ï¼å»ºç«éï¼ï¼ç­å°æä½ç»æï¼åå¤éé£äºä¼ç ççº¿ç¨ï¼è§£é¤éï¼ã\n\n// worker çº¿ç¨\nself.addeventlistener('message', (event) => {\n  const sharedarray = new int32array(event.data);\n  const arrayindex = 0;\n  const expectedstoredvalue = 50;\n  atomics.wait(sharedarray, arrayindex, expectedstoredvalue);\n  console.log(atomics.load(sharedarray, arrayindex));\n}, false);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼atomics.wait()æ¹æ³ç­åäºåè¯ worker çº¿ç¨ï¼åªè¦æ»¡è¶³ç»å®æ¡ä»¶ï¼sharedarrayç0å·ä½ç½®ç­äº50ï¼ï¼å°±å¨è¿ä¸è¡ worker çº¿ç¨è¿å¥ä¼ç ã\n\nä¸»çº¿ç¨ä¸æ¦æ´æ¹äºæå®ä½ç½®çå¼ï¼å°±å¯ä»¥å¤é worker çº¿ç¨ã\n\n// ä¸»çº¿ç¨\nconst newarrayvalue = 100;\natomics.store(sharedarray, 0, newarrayvalue);\nconst arrayindex = 0;\nconst queuepos = 1;\natomics.wake(sharedarray, arrayindex, queuepos);\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼sharedarrayç0å·ä½ç½®æ¹ä¸º100ï¼ç¶åå°±æ§è¡atomics.wake()æ¹æ³ï¼å¤éå¨sharedarrayç0å·ä½ç½®ä¼ç éåéçä¸ä¸ªçº¿ç¨ã\n\natomics.wait()æ¹æ³çä½¿ç¨æ ¼å¼å¦ä¸ã\n\natomics.wait(sharedarray, index, value, timeout)\n\n\n1\n\n\nå®çåä¸ªåæ°å«ä¹å¦ä¸ã\n\n * sharedarrayï¼å±äº«åå­çè§å¾æ°ç»ã\n * indexï¼è§å¾æ°æ®çä½ç½®ï¼ä»0å¼å§ï¼ã\n * valueï¼è¯¥ä½ç½®çé¢æå¼ãä¸æ¦å®éå¼ç­äºé¢æå¼ï¼å°±è¿å¥ä¼ç ã\n * timeoutï¼æ´æ°ï¼è¡¨ç¤ºè¿äºè¿ä¸ªæ¶é´ä»¥åï¼å°±èªå¨å¤éï¼åä½æ¯«ç§ãè¯¥åæ°å¯éï¼é»è®¤å¼æ¯infinityï¼å³æ éæçä¼ç ï¼åªæéè¿atomics.wake()æ¹æ³æè½å¤éã\n\natomics.wait()çè¿åå¼æ¯ä¸ä¸ªå­ç¬¦ä¸²ï¼å±æä¸ç§å¯è½çå¼ãå¦æsharedarray[index]ä¸ç­äºvalueï¼å°±è¿åå­ç¬¦ä¸²not-equalï¼å¦åå°±è¿å¥ä¼ç ãå¦æatomics.wake()æ¹æ³å¤éï¼å°±è¿åå­ç¬¦ä¸²okï¼å¦æå ä¸ºè¶æ¶å¤éï¼å°±è¿åå­ç¬¦ä¸²timed-outã\n\natomics.wake()æ¹æ³çä½¿ç¨æ ¼å¼å¦ä¸ã\n\natomics.wake(sharedarray, index, count)\n\n\n1\n\n\nå®çä¸ä¸ªåæ°å«ä¹å¦ä¸ã\n\n * sharedarrayï¼å±äº«åå­çè§å¾æ°ç»ã\n * indexï¼è§å¾æ°æ®çä½ç½®ï¼ä»0å¼å§ï¼ã\n * countï¼éè¦å¤éç worker çº¿ç¨çæ°éï¼é»è®¤ä¸ºinfinityã\n\natomics.wake()æ¹æ³ä¸æ¦å¤éä¼ç ç worker çº¿ç¨ï¼å°±ä¼è®©å®ç»§ç»­å¾ä¸è¿è¡ã\n\nè¯·çä¸ä¸ªä¾å­ã\n\n// ä¸»çº¿ç¨\nconsole.log(ia[37]);  // 163\natomics.store(ia, 37, 123456);\natomics.wake(ia, 37, 1);\n\n// worker çº¿ç¨\natomics.wait(ia, 37, 163);\nconsole.log(ia[37]);  // 123456\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼è§å¾æ°ç»iaçç¬¬ 37 å·ä½ç½®ï¼åæ¥çå¼æ¯163ãworker çº¿ç¨ä½¿ç¨atomics.wait()æ¹æ³ï¼æå®åªè¦ia[37]ç­äº163ï¼å°±è¿å¥ä¼ç ç¶æãä¸»çº¿ç¨ä½¿ç¨atomics.store()æ¹æ³ï¼å°123456åå¥ia[37]ï¼ç¶åä½¿ç¨atomics.wake()æ¹æ³å¤é worker çº¿ç¨ã\n\nå¦å¤ï¼åºäºwaitåwakeè¿ä¸¤ä¸ªæ¹æ³çéåå­å®ç°ï¼å¯ä»¥ç lars t hansen ç js-lock-and-condition è¿ä¸ªåºã\n\næ³¨æï¼æµè§å¨çä¸»çº¿ç¨ä¸å®è®¾ç½®ä¼ç ï¼è¿ä¼å¯¼è´ç¨æ·å¤±å»ååºãèä¸ï¼ä¸»çº¿ç¨å®éä¸ä¼æç»è¿å¥ä¼ç ã\n\nï¼4ï¼è¿ç®æ¹æ³\n\nå±äº«åå­ä¸é¢çæäºè¿ç®æ¯ä¸è½è¢«ææ­çï¼å³ä¸è½å¨è¿ç®è¿ç¨ä¸­ï¼è®©å¶ä»çº¿ç¨æ¹ååå­ä¸é¢çå¼ãatomics å¯¹è±¡æä¾äºä¸äºè¿ç®æ¹æ³ï¼é²æ­¢æ°æ®è¢«æ¹åã\n\natomics.add(sharedarray, index, value)\n\n\n1\n\n\natomics.addç¨äºå°valueå å°sharedarray[index]ï¼è¿åsharedarray[index]æ§çå¼ã\n\natomics.sub(sharedarray, index, value)\n\n\n1\n\n\natomics.subç¨äºå°valueä»sharedarray[index]åå»ï¼è¿åsharedarray[index]æ§çå¼ã\n\natomics.and(sharedarray, index, value)\n\n\n1\n\n\natomics.andç¨äºå°valueä¸sharedarray[index]è¿è¡ä½è¿ç®andï¼æ¾å¥sharedarray[index]ï¼å¹¶è¿åæ§çå¼ã\n\natomics.or(sharedarray, index, value)\n\n\n1\n\n\natomics.orç¨äºå°valueä¸sharedarray[index]è¿è¡ä½è¿ç®orï¼æ¾å¥sharedarray[index]ï¼å¹¶è¿åæ§çå¼ã\n\natomics.xor(sharedarray, index, value)\n\n\n1\n\n\natomic.xorç¨äºå°vauleä¸sharedarray[index]è¿è¡ä½è¿ç®xorï¼æ¾å¥sharedarray[index]ï¼å¹¶è¿åæ§çå¼ã\n\nï¼5ï¼å¶ä»æ¹æ³\n\natomicså¯¹è±¡è¿æä»¥ä¸æ¹æ³ã\n\n * atomics.compareexchange(sharedarray, index, oldval, newval)ï¼å¦æsharedarray[index]ç­äºoldvalï¼å°±åå¥newvalï¼è¿åoldvalã\n * atomics.islockfree(size)ï¼è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºatomicså¯¹è±¡æ¯å¦å¯ä»¥å¤çæä¸ªsizeçåå­éå®ãå¦æè¿åfalseï¼åºç¨ç¨åºå°±éè¦èªå·±æ¥å®ç°éå®ã\n\natomics.compareexchangeçä¸ä¸ªç¨éæ¯ï¼ä» sharedarraybuffer è¯»åä¸ä¸ªå¼ï¼ç¶åå¯¹è¯¥å¼è¿è¡æä¸ªæä½ï¼æä½ç»æä»¥åï¼æ£æ¥ä¸ä¸ sharedarraybuffer éé¢åæ¥é£ä¸ªå¼æ¯å¦åçååï¼å³è¢«å¶ä»çº¿ç¨æ¹åè¿ï¼ãå¦ææ²¡ææ¹åè¿ï¼å°±å°å®åååæ¥çä½ç½®ï¼å¦åè¯»åæ°çå¼ï¼åéå¤´è¿è¡ä¸æ¬¡æä½ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"ææ°ææ¡",frontmatter:{title:"ææ°ææ¡",date:"2020-02-09T16:00:30.000Z",permalink:"/pages/7188882b8d65af1b",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/29.%E6%9C%80%E6%96%B0%E6%8F%90%E6%A1%88.html",relativePath:"ãES6 æç¨ãç¬è®°/29.ææ°ææ¡.md",key:"v-733dba34",path:"/pages/7188882b8d65af1b/",headers:[{level:2,title:"do è¡¨è¾¾å¼",slug:"do-è¡¨è¾¾å¼",normalizedTitle:"do è¡¨è¾¾å¼",charIndex:37},{level:2,title:"throw è¡¨è¾¾å¼",slug:"throw-è¡¨è¾¾å¼",normalizedTitle:"throw è¡¨è¾¾å¼",charIndex:1009},{level:2,title:"å½æ°çé¨åæ§è¡",slug:"å½æ°çé¨åæ§è¡",normalizedTitle:"å½æ°çé¨åæ§è¡",charIndex:1983},{level:3,title:"è¯­æ³",slug:"è¯­æ³",normalizedTitle:"è¯­æ³",charIndex:724},{level:3,title:"æ³¨æç¹",slug:"æ³¨æç¹",normalizedTitle:"æ³¨æç¹",charIndex:2862},{level:2,title:"ç®¡éè¿ç®ç¬¦",slug:"ç®¡éè¿ç®ç¬¦",normalizedTitle:"ç®¡éè¿ç®ç¬¦",charIndex:3777},{level:2,title:"æ°å¼åéç¬¦",slug:"æ°å¼åéç¬¦",normalizedTitle:"æ°å¼åéç¬¦",charIndex:5042},{level:2,title:"Math.signbit()",slug:"math-signbit",normalizedTitle:"math.signbit()",charIndex:6012},{level:2,title:"ååå·è¿ç®ç¬¦",slug:"ååå·è¿ç®ç¬¦",normalizedTitle:"ååå·è¿ç®ç¬¦",charIndex:6558},{level:2,title:"Realm API",slug:"realm-api",normalizedTitle:"realm api",charIndex:7418},{level:2,title:"#!å½ä»¤",slug:"å½ä»¤",normalizedTitle:"#!å½ä»¤",charIndex:9349},{level:2,title:"import.meta",slug:"import-meta",normalizedTitle:"import.meta",charIndex:9834}],excerpt:'<h1 id="ææ°ææ¡"><a class="header-anchor" href="#ææ°ææ¡">#</a> ææ°ææ¡</h1>\n<p>æ¬ç« ä»ç»ä¸äºå°æªè¿å¥æ åãä½å¾æå¸æçææ°ææ¡ã</p>\n<h2 id="do-è¡¨è¾¾å¼"><a class="header-anchor" href="#do-è¡¨è¾¾å¼">#</a> do è¡¨è¾¾å¼</h2>\n<p>æ¬è´¨ä¸ï¼åçº§ä½ç¨åæ¯ä¸ä¸ªè¯­å¥ï¼å°å¤ä¸ªæä½å°è£å¨ä¸èµ·ï¼æ²¡æè¿åå¼ã</p>\n\x3c!--beforebegin--\x3e<div class="language-javascript line-numbers-mode">\x3c!--afterbegin--\x3e<pre v-pre class="language-javascript"><code><span class="token punctuation">{</span>\n  <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  t <span class="token operator">=</span> t <span class="token operator">*</span> t <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div>\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e',headersStr:"do è¡¨è¾¾å¼ throw è¡¨è¾¾å¼ å½æ°çé¨åæ§è¡ è¯­æ³ æ³¨æç¹ ç®¡éè¿ç®ç¬¦ æ°å¼åéç¬¦ Math.signbit() ååå·è¿ç®ç¬¦ Realm API #!å½ä»¤ import.meta",content:"# ææ°ææ¡\n\næ¬ç« ä»ç»ä¸äºå°æªè¿å¥æ åãä½å¾æå¸æçææ°ææ¡ã\n\n\n# do è¡¨è¾¾å¼\n\næ¬è´¨ä¸ï¼åçº§ä½ç¨åæ¯ä¸ä¸ªè¯­å¥ï¼å°å¤ä¸ªæä½å°è£å¨ä¸èµ·ï¼æ²¡æè¿åå¼ã\n\n{\n  let t = f();\n  t = t * t + 1;\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼åçº§ä½ç¨åå°ä¸¤ä¸ªè¯­å¥å°è£å¨ä¸èµ·ãä½æ¯ï¼å¨åçº§ä½ç¨åä»¥å¤ï¼æ²¡æåæ³å¾å°tçå¼ï¼å ä¸ºåçº§ä½ç¨åä¸è¿åå¼ï¼é¤étæ¯å¨å±åéã\n\nç°å¨æä¸ä¸ªææ¡ï¼ä½¿å¾åçº§ä½ç¨åå¯ä»¥åä¸ºè¡¨è¾¾å¼ï¼ä¹å°±æ¯è¯´å¯ä»¥è¿åå¼ï¼åæ³å°±æ¯å¨åçº§ä½ç¨åä¹åå ä¸doï¼ä½¿å®åä¸ºdoè¡¨è¾¾å¼ï¼ç¶åå°±ä¼è¿ååé¨æåæ§è¡çè¡¨è¾¾å¼çå¼ã\n\nlet x = do {\n  let t = f();\n  t * t + 1;\n};\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼åéxä¼å¾å°æ´ä¸ªåçº§ä½ç¨åçè¿åå¼ï¼t * t + 1ï¼ã\n\ndoè¡¨è¾¾å¼çé»è¾éå¸¸ç®åï¼å°è£çæ¯ä»ä¹ï¼å°±ä¼è¿åä»ä¹ã\n\n// ç­åäº <è¡¨è¾¾å¼>\ndo { <è¡¨è¾¾å¼>; }\n\n// ç­åäº <è¯­å¥>\ndo { <è¯­å¥> }\n\n\n1\n2\n3\n4\n5\n\n\ndoè¡¨è¾¾å¼çå¥½å¤æ¯å¯ä»¥å°è£å¤ä¸ªè¯­å¥ï¼è®©ç¨åºæ´å æ¨¡ååï¼å°±åä¹é«ç§¯æ¨é£æ ·ä¸ååæ¼è£èµ·æ¥ã\n\nlet x = do {\n  if (foo()) { f() }\n  else if (bar()) { g() }\n  else { h() }\n};\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç çæ¬è´¨ï¼å°±æ¯æ ¹æ®å½æ°fooçæ§è¡ç»æï¼è°ç¨ä¸åçå½æ°ï¼å°è¿åç»æèµç»åéxãä½¿ç¨doè¡¨è¾¾å¼ï¼å°±å°è¿ä¸ªæä½çæå¾è¡¨è¾¾å¾éå¸¸ç®æ´æ¸æ°ãèä¸ï¼doåçº§ä½ç¨åæä¾äºåç¬çä½ç¨åï¼åé¨æä½å¯ä»¥ä¸å¨å±ä½ç¨åéç»ã\n\nå¼å¾ä¸æçæ¯ï¼doè¡¨è¾¾å¼å¨ JSX è¯­æ³ä¸­éå¸¸å¥½ç¨ã\n\nreturn (\n  <nav>\n    <Home />\n    {\n      do {\n        if (loggedIn) {\n          <LogoutButton />\n        } else {\n          <LoginButton />\n        }\n      }\n    }\n  </nav>\n)\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æä¸ç¨doè¡¨è¾¾å¼ï¼å°±åªè½ç¨ä¸åå¤æ­è¿ç®ç¬¦ï¼?:ï¼ãé£æ ·çè¯ï¼ä¸æ¦å¤æ­é»è¾å¤æï¼ä»£ç å°±ä¼åå¾å¾ä¸æè¯»ã\n\n\n# throw è¡¨è¾¾å¼\n\nJavaScript è¯­æ³è§å®throwæ¯ä¸ä¸ªå½ä»¤ï¼ç¨æ¥æåºéè¯¯ï¼ä¸è½ç¨äºè¡¨è¾¾å¼ä¹ä¸­ã\n\n// æ¥é\nconsole.log(throw new Error());\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼console.logçåæ°å¿é¡»æ¯ä¸ä¸ªè¡¨è¾¾å¼ï¼å¦ææ¯ä¸ä¸ªthrowè¯­å¥å°±ä¼æ¥éã\n\nç°å¨æä¸ä¸ªææ¡ï¼åè®¸throwç¨äºè¡¨è¾¾å¼ã\n\n// åæ°çé»è®¤å¼\nfunction save(filename = throw new TypeError(\"Argument required\")) {\n}\n\n// ç®­å¤´å½æ°çè¿åå¼\nlint(ast, {\n  with: () => throw new Error(\"avoid using 'with' statements.\")\n});\n\n// æ¡ä»¶è¡¨è¾¾å¼\nfunction getEncoder(encoding) {\n  const encoder = encoding === \"utf8\" ?\n    new UTF8Encoder() :\n    encoding === \"utf16le\" ?\n      new UTF16Encoder(false) :\n      encoding === \"utf16be\" ?\n        new UTF16Encoder(true) :\n        throw new Error(\"Unsupported encoding\");\n}\n\n// é»è¾è¡¨è¾¾å¼\nclass Product {\n  get id() {\n    return this._id;\n  }\n  set id(value) {\n    this._id = value || throw new Error(\"Invalid value\");\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nä¸é¢ä»£ç ä¸­ï¼throwé½åºç°å¨è¡¨è¾¾å¼éé¢ã\n\nè¯­æ³ä¸ï¼throwè¡¨è¾¾å¼éé¢çthrowä¸åæ¯ä¸ä¸ªå½ä»¤ï¼èæ¯ä¸ä¸ªè¿ç®ç¬¦ãä¸ºäºé¿åä¸throwå½ä»¤æ··æ·ï¼è§å®throwåºç°å¨è¡é¦ï¼ä¸å¾è§£éä¸ºthrowè¯­å¥ï¼èä¸æ¯throwè¡¨è¾¾å¼ã\n\n\n# å½æ°çé¨åæ§è¡\n\n\n# è¯­æ³\n\nå¤åæ°çå½æ°ææ¶éè¦ç»å®å¶ä¸­çä¸ä¸ªæå¤ä¸ªåæ°ï¼ç¶åè¿åä¸ä¸ªæ°å½æ°ã\n\nfunction add(x, y) { return x + y; }\nfunction add7(x) { return x + 7; }\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼add7å½æ°å¶å®æ¯addå½æ°çä¸ä¸ªç¹æ®çæ¬ï¼éè¿å°ä¸ä¸ªåæ°ç»å®ä¸º7ï¼å°±å¯ä»¥ä»addå¾å°add7ã\n\n// bind æ¹æ³\nconst add7 = add.bind(null, 7);\n\n// ç®­å¤´å½æ°\nconst add7 = x => add(x, 7);\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä¸¤ç§åæ³é½æäºåä½ãå¶ä¸­ï¼bindæ¹æ³çå±éæ´å ææ¾ï¼å®å¿é¡»æä¾thisï¼å¹¶ä¸åªè½ä»åå°åä¸ä¸ªä¸ªç»å®åæ°ï¼æ æ³åªç»å®éå¤´é¨çåæ°ã\n\nç°å¨æä¸ä¸ªææ¡ï¼ä½¿å¾ç»å®åæ°å¹¶è¿åä¸ä¸ªæ°å½æ°æ´å å®¹æãè¿å«åå½æ°çé¨åæ§è¡ï¼partial applicationï¼ã\n\nconst add = (x, y) => x + y;\nconst addOne = add(1, ?);\n\nconst maxGreaterThanZero = Math.max(0, ...);\n\n\n1\n2\n3\n4\n\n\næ ¹æ®æ°ææ¡ï¼?æ¯åä¸ªåæ°çå ä½ç¬¦ï¼...æ¯å¤ä¸ªåæ°çå ä½ç¬¦ãä»¥ä¸çå½¢å¼é½å±äºå½æ°çé¨åæ§è¡ã\n\nf(x, ?)\nf(x, ...)\nf(?, x)\nf(..., x)\nf(?, x, ?)\nf(..., x, ...)\n\n\n1\n2\n3\n4\n5\n6\n\n\n?å...åªè½åºç°å¨å½æ°çè°ç¨ä¹ä¸­ï¼å¹¶ä¸ä¼è¿åä¸ä¸ªæ°å½æ°ã\n\nconst g = f(?, 1, ...);\n// ç­åäº\nconst g = (x, ...y) => f(x, 1, ...y);\n\n\n1\n2\n3\n\n\nå½æ°çé¨åæ§è¡ï¼ä¹å¯ä»¥ç¨äºå¯¹è±¡çæ¹æ³ã\n\nlet obj = {\n  f(x, y) { return x + y; },\n};\n\nconst g = obj.f(?, 3);\ng(1) // 4\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# æ³¨æç¹\n\nå½æ°çé¨åæ§è¡æä¸äºç¹å«æ³¨æçå°æ¹ã\n\nï¼1ï¼å½æ°çé¨åæ§è¡æ¯åºäºåå½æ°çãå¦æåå½æ°åçååï¼é¨åæ§è¡çæçæ°å½æ°ä¹ä¼ç«å³åæ è¿ç§ååã\n\nlet f = (x, y) => x + y;\n\nconst g = f(?, 3);\ng(1); // 4\n\n// æ¿æ¢å½æ° f\nf = (x, y) => x * y;\n\ng(1); // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å®ä¹äºå½æ°çé¨åæ§è¡ä»¥åï¼æ´æ¢åå½æ°ä¼ç«å³å½±åå°æ°å½æ°ã\n\nï¼2ï¼å¦æé¢åæä¾çé£ä¸ªå¼æ¯ä¸ä¸ªè¡¨è¾¾å¼ï¼é£ä¹è¿ä¸ªè¡¨è¾¾å¼å¹¶ä¸ä¼å¨å®ä¹æ¶æ±å¼ï¼èæ¯å¨æ¯æ¬¡è°ç¨æ¶æ±å¼ã\n\nlet a = 3;\nconst f = (x, y) => x + y;\n\nconst g = f(?, a);\ng(1); // 4\n\n// æ¹å a çå¼\na = 10;\ng(1); // 11\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼é¢åæä¾çåæ°æ¯åéaï¼é£ä¹æ¯æ¬¡è°ç¨å½æ°gçæ¶åï¼æä¼å¯¹aè¿è¡æ±å¼ã\n\nï¼3ï¼å¦ææ°å½æ°çåæ°å¤äºå ä½ç¬¦çæ°éï¼é£ä¹å¤ä½çåæ°å°è¢«å¿½ç¥ã\n\nconst f = (x, ...y) => [x, ...y];\nconst g = f(?, 1);\ng(2, 3, 4); // [2, 1]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°gåªæä¸ä¸ªå ä½ç¬¦ï¼ä¹å°±æå³çå®åªè½æ¥åä¸ä¸ªåæ°ï¼å¤ä½çåæ°é½ä¼è¢«å¿½ç¥ã\n\nåæä¸é¢è¿æ ·ï¼å¤ä½çåæ°å°±æ²¡æé®é¢ã\n\nconst f = (x, ...y) => [x, ...y];\nconst g = f(?, 1, ...);\ng(2, 3, 4); // [2, 1, 3, 4];\n\n\n1\n2\n3\n\n\nï¼4ï¼...åªä¼è¢«ééä¸æ¬¡ï¼å¦æå½æ°çé¨åæ§è¡ä½¿ç¨äºå¤ä¸ª...ï¼é£ä¹æ¯ä¸ª...çå¼é½å°ç¸åã\n\nconst f = (...x) => x;\nconst g = f(..., 9, ...);\ng(1, 2, 3); // [1, 2, 3, 9, 1, 2, 3]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼gå®ä¹äºä¸¤ä¸ª...å ä½ç¬¦ï¼çæ­£æ§è¡çæ¶åï¼å®ä»¬çå¼æ¯ä¸æ ·çã\n\n\n# ç®¡éè¿ç®ç¬¦\n\nUnix æä½ç³»ç»æä¸ä¸ªç®¡éæºå¶ï¼pipelineï¼ï¼å¯ä»¥æåä¸ä¸ªæä½çå¼ä¼ ç»åä¸ä¸ªæä½ãè¿ä¸ªæºå¶éå¸¸æç¨ï¼ä½¿å¾ç®åçæä½å¯ä»¥ç»åæä¸ºå¤æçæä½ãè®¸å¤è¯­è¨é½æç®¡éçå®ç°ï¼ç°å¨æä¸ä¸ªææ¡ï¼è®© JavaScript ä¹æ¥æç®¡éæºå¶ã\n\nJavaScript çç®¡éæ¯ä¸ä¸ªè¿ç®ç¬¦ï¼åä½|>ãå®çå·¦è¾¹æ¯ä¸ä¸ªè¡¨è¾¾å¼ï¼å³è¾¹æ¯ä¸ä¸ªå½æ°ãç®¡éè¿ç®ç¬¦æå·¦è¾¹è¡¨è¾¾å¼çå¼ï¼ä¼ å¥å³è¾¹çå½æ°è¿è¡æ±å¼ã\n\nx |> f\n// ç­åäº\nf(x)\n\n\n1\n2\n3\n\n\nç®¡éè¿ç®ç¬¦æå¤§çå¥½å¤ï¼å°±æ¯å¯ä»¥æåµå¥çå½æ°ï¼åæä»å·¦å°å³çé¾å¼è¡¨è¾¾å¼ã\n\nfunction doubleSay (str) {\n  return str + \", \" + str;\n}\n\nfunction capitalize (str) {\n  return str[0].toUpperCase() + str.substring(1);\n}\n\nfunction exclaim (str) {\n  return str + '!';\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢æ¯ä¸ä¸ªç®åçå½æ°ãå¦æè¦åµå¥æ§è¡ï¼ä¼ ç»çåæ³åç®¡éçåæ³åå«å¦ä¸ã\n\n// ä¼ ç»çåæ³\nexclaim(capitalize(doubleSay('hello')))\n// \"Hello, hello!\"\n\n// ç®¡éçåæ³\n'hello'\n  |> doubleSay\n  |> capitalize\n  |> exclaim\n// \"Hello, hello!\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nç®¡éè¿ç®ç¬¦åªè½ä¼ éä¸ä¸ªå¼ï¼è¿æå³çå®å³è¾¹çå½æ°å¿é¡»æ¯ä¸ä¸ªååæ°å½æ°ãå¦ææ¯å¤åæ°å½æ°ï¼å°±å¿é¡»è¿è¡æ¯éåï¼æ¹æååæ°ççæ¬ã\n\nfunction double (x) { return x + x; }\nfunction add (x, y) { return x + y; }\n\nlet person = { score: 25 };\nperson.score\n  |> double\n  |> (_ => add(7, _))\n// 57\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼addå½æ°éè¦ä¸¤ä¸ªåæ°ãä½æ¯ï¼ç®¡éè¿ç®ç¬¦åªè½ä¼ å¥ä¸ä¸ªå¼ï¼å æ­¤éè¦äºåæä¾å¦ä¸ä¸ªåæ°ï¼å¹¶å°å¶æ¹æååæ°çç®­å¤´å½æ°_ => add(7, _)ãè¿ä¸ªå½æ°éé¢çä¸åçº¿å¹¶æ²¡æç¹å«çå«ä¹ï¼å¯ä»¥ç¨å¶ä»ç¬¦å·ä»£æ¿ï¼ä½¿ç¨ä¸åçº¿åªæ¯å ä¸ºï¼å®è½å¤å½¢è±¡å°è¡¨ç¤ºè¿éæ¯å ä½ç¬¦ã\n\nç®¡éè¿ç®ç¬¦å¯¹äºawaitå½æ°ä¹éç¨ã\n\nx |> await f\n// ç­åäº\nawait f(x)\n\nconst userAge = userId |> await fetchUserById |> getAgeFromUser;\n// ç­åäº\nconst userAge = getAgeFromUser(await fetchUserById(userId));\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# æ°å¼åéç¬¦\n\næ¬§ç¾è¯­è¨ä¸­ï¼è¾é¿çæ°å¼åè®¸æ¯ä¸ä½æ·»å ä¸ä¸ªåéç¬¦ï¼éå¸¸æ¯ä¸ä¸ªéå·ï¼ï¼å¢å æ°å¼çå¯è¯»æ§ãæ¯å¦ï¼1000å¯ä»¥åä½1,000ã\n\nç°å¨æä¸ä¸ªææ¡ï¼åè®¸ JavaScript çæ°å¼ä½¿ç¨ä¸åçº¿ï¼_ï¼ä½ä¸ºåéç¬¦ã\n\nlet budget = 1_000_000_000_000;\nbudget === 10 ** 12 // true\n\n\n1\n2\n\n\nJavaScript çæ°å¼åéç¬¦æ²¡ææå®é´éçä½æ°ï¼ä¹å°±æ¯è¯´ï¼å¯ä»¥æ¯ä¸ä½æ·»å ä¸ä¸ªåéç¬¦ï¼ä¹å¯ä»¥æ¯ä¸ä½ãæ¯ä¸¤ä½ãæ¯åä½æ·»å ä¸ä¸ªã\n\n123_00 === 12_300 // true\n\n12345_00 === 123_4500 // true\n12345_00 === 1_234_500 // true\n\n\n1\n2\n3\n4\n\n\nå°æ°åç§å­¦è®¡æ°æ³ä¹å¯ä»¥ä½¿ç¨æ°å¼åéç¬¦ã\n\n// å°æ°\n0.000_001\n// ç§å­¦è®¡æ°æ³\n1e10_000\n\n\n1\n2\n3\n4\n\n\næ°å¼åéç¬¦æå ä¸ªä½¿ç¨æ³¨æç¹ã\n\n * ä¸è½å¨æ°å¼çæåé¢ï¼leadingï¼ææåé¢ï¼trailingï¼ã\n * ä¸è½ä¸¤ä¸ªæä¸¤ä¸ªä»¥ä¸çåéç¬¦è¿å¨ä¸èµ·ã\n * å°æ°ç¹çååä¸è½æåéç¬¦ã\n * ç§å­¦è®¡æ°æ³éé¢ï¼è¡¨ç¤ºææ°çeæEååä¸è½æåéç¬¦ã\n\nä¸é¢çåæ³é½ä¼æ¥éã\n\n// å¨é¨æ¥é\n3_.141\n3._141\n1_e12\n1e_12\n123__456\n_1464301\n1464301_\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\né¤äºåè¿å¶ï¼å¶ä»è¿å¶çæ°å¼ä¹å¯ä»¥ä½¿ç¨åéç¬¦ã\n\n// äºè¿å¶\n0b1010_0001_1000_0101\n// åå­è¿å¶\n0xA0_B0_C0\n\n\n1\n2\n3\n4\n\n\næ³¨æï¼åéç¬¦ä¸è½ç´§è·çè¿å¶çåç¼0bã0Bã0oã0Oã0xã0Xã\n\n// æ¥é\n0_b111111000\n0b_111111000\n\n\n1\n2\n3\n\n\nä¸é¢ä¸ä¸ªå°å­ç¬¦ä¸²è½¬ææ°å¼çå½æ°ï¼ä¸æ¯ææ°å¼åéç¬¦ãä¸»è¦åå æ¯ææ¡çè®¾è®¡èè®¤ä¸ºï¼æ°å¼åéç¬¦ä¸»è¦æ¯ä¸ºäºç¼ç æ¶ä¹¦åæ°å¼çæ¹ä¾¿ï¼èä¸æ¯ä¸ºäºå¤çå¤é¨è¾å¥çæ°æ®ã\n\n * Number()\n * parseInt()\n * parseFloat()\n\nNumber('123_456') // NaN\nparseInt('123_456') // 123\n\n\n1\n2\n\n\n\n# Math.signbit()\n\nMath.sign()ç¨æ¥å¤æ­ä¸ä¸ªå¼çæ­£è´ï¼ä½æ¯å¦æåæ°æ¯-0ï¼å®ä¼è¿å-0ã\n\nMath.sign(-0) // -0\n\n\n1\n\n\nè¿å¯¼è´å¯¹äºå¤æ­ç¬¦å·ä½çæ­£è´ï¼Math.sign()ä¸æ¯å¾æç¨ãJavaScript åé¨ä½¿ç¨ 64 ä½æµ®ç¹æ°ï¼å½éæ å IEEE 754ï¼è¡¨ç¤ºæ°å¼ï¼IEEE 754 è§å®ç¬¬ä¸ä½æ¯ç¬¦å·ä½ï¼0è¡¨ç¤ºæ­£æ°ï¼1è¡¨ç¤ºè´æ°ãæä»¥ä¼æä¸¤ç§é¶ï¼+0æ¯ç¬¦å·ä½ä¸º0æ¶çé¶å¼ï¼-0æ¯ç¬¦å·ä½ä¸º1æ¶çé¶å¼ãå®éç¼ç¨ä¸­ï¼å¤æ­ä¸ä¸ªå¼æ¯+0è¿æ¯-0éå¸¸éº»ç¦ï¼å ä¸ºå®ä»¬æ¯ç¸ç­çã\n\n+0 === -0 // true\n\n\n1\n\n\nç®åï¼æä¸ä¸ªææ¡ï¼å¼å¥äºMath.signbit()æ¹æ³å¤æ­ä¸ä¸ªæ°çç¬¦å·ä½æ¯å¦è®¾ç½®äºã\n\nMath.signbit(2) //false\nMath.signbit(-2) //true\nMath.signbit(0) //false\nMath.signbit(-0) //true\n\n\n1\n2\n3\n4\n\n\nå¯ä»¥çå°ï¼è¯¥æ¹æ³æ­£ç¡®è¿åäº-0çç¬¦å·ä½æ¯è®¾ç½®äºçã\n\nè¯¥æ¹æ³çç®æ³å¦ä¸ã\n\n * å¦æåæ°æ¯NaNï¼è¿åfalse\n * å¦æåæ°æ¯-0ï¼è¿åtrue\n * å¦æåæ°æ¯è´å¼ï¼è¿åtrue\n * å¶ä»æåµè¿åfalse\n\n\n# ååå·è¿ç®ç¬¦\n\nç®­å¤´å½æ°å¯ä»¥ç»å®thiså¯¹è±¡ï¼å¤§å¤§åå°äºæ¾å¼ç»å®thiså¯¹è±¡çåæ³ï¼callãapplyãbindï¼ãä½æ¯ï¼ç®­å¤´å½æ°å¹¶ä¸éç¨äºææåºåï¼æä»¥ç°å¨æä¸ä¸ªææ¡ï¼æåºäºâå½æ°ç»å®âï¼function bindï¼è¿ç®ç¬¦ï¼ç¨æ¥åä»£callãapplyãbindè°ç¨ã\n\nå½æ°ç»å®è¿ç®ç¬¦æ¯å¹¶æçä¸¤ä¸ªåå·ï¼::ï¼ï¼ååå·å·¦è¾¹æ¯ä¸ä¸ªå¯¹è±¡ï¼å³è¾¹æ¯ä¸ä¸ªå½æ°ãè¯¥è¿ç®ç¬¦ä¼èªå¨å°å·¦è¾¹çå¯¹è±¡ï¼ä½ä¸ºä¸ä¸æç¯å¢ï¼å³thiså¯¹è±¡ï¼ï¼ç»å®å°å³è¾¹çå½æ°ä¸é¢ã\n\nfoo::bar;\n// ç­åäº\nbar.bind(foo);\n\nfoo::bar(...arguments);\n// ç­åäº\nbar.apply(foo, arguments);\n\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\nfunction hasOwn(obj, key) {\n  return obj::hasOwnProperty(key);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå¦æååå·å·¦è¾¹ä¸ºç©ºï¼å³è¾¹æ¯ä¸ä¸ªå¯¹è±¡çæ¹æ³ï¼åç­äºå°è¯¥æ¹æ³ç»å®å¨è¯¥å¯¹è±¡ä¸é¢ã\n\nvar method = obj::obj.foo;\n// ç­åäº\nvar method = ::obj.foo;\n\nlet log = ::console.log;\n// ç­åäº\nvar log = console.log.bind(console);\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦æååå·è¿ç®ç¬¦çè¿ç®ç»æï¼è¿æ¯ä¸ä¸ªå¯¹è±¡ï¼å°±å¯ä»¥éç¨é¾å¼åæ³ã\n\nimport { map, takeWhile, forEach } from \"iterlib\";\n\ngetPlayers()\n::map(x => x.character())\n::takeWhile(x => x.strength > 100)\n::forEach(x => console.log(x));\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# Realm API\n\nRealm API æä¾æ²ç®±åè½ï¼sandboxï¼ï¼åè®¸éç¦»ä»£ç ï¼é²æ­¢é£äºè¢«éç¦»çä»£ç æ¿å°å¨å±å¯¹è±¡ã\n\nä»¥åï¼ç»å¸¸ä½¿ç¨<iframe>ä½ä¸ºæ²ç®±ã\n\nconst globalOne = window;\nlet iframe = document.createElement('iframe');\ndocument.body.appendChild(iframe);\nconst globalTwo = iframe.contentWindow;\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼<iframe>çå¨å±å¯¹è±¡æ¯ç¬ç«çï¼iframe.contentWindowï¼ãRealm API å¯ä»¥åä»£è¿ä¸ªåè½ã\n\nconst globalOne = window;\nconst globalTwo = new Realm().global;\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼Realm APIåç¬æä¾äºä¸ä¸ªå¨å±å¯¹è±¡new Realm().globalã\n\nRealm API æä¾ä¸ä¸ªRealm()æé å½æ°ï¼ç¨æ¥çæä¸ä¸ª Realm å¯¹è±¡ãè¯¥å¯¹è±¡çglobalå±æ§æåä¸ä¸ªæ°çé¡¶å±å¯¹è±¡ï¼è¿ä¸ªé¡¶å±å¯¹è±¡è·åå§çé¡¶å±å¯¹è±¡ç±»ä¼¼ã\n\nconst globalOne = window;\nconst globalTwo = new Realm().global;\n\nglobalOne.evaluate('1 + 2') // 3\nglobalTwo.evaluate('1 + 2') // 3\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼Realm çæçé¡¶å±å¯¹è±¡çevaluate()æ¹æ³ï¼å¯ä»¥è¿è¡ä»£ç ã\n\nä¸é¢çä»£ç å¯ä»¥è¯æï¼Realm é¡¶å±å¯¹è±¡ä¸åå§é¡¶å±å¯¹è±¡æ¯ä¸¤ä¸ªå¯¹è±¡ã\n\nlet a1 = globalOne.evaluate('[1,2,3]');\nlet a2 = globalTwo.evaluate('[1,2,3]');\na1.prototype === a2.prototype; // false\na1 instanceof globalTwo.Array; // false\na2 instanceof globalOne.Array; // false\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼Realm æ²ç®±éé¢çæ°ç»çååå¯¹è±¡ï¼è·åå§ç¯å¢éé¢çæ°ç»æ¯ä¸ä¸æ ·çã\n\nRealm æ²ç®±éé¢åªè½è¿è¡ ECMAScript è¯­æ³æä¾ç APIï¼ä¸è½è¿è¡å®¿ä¸»ç¯å¢æä¾ç APIã\n\nglobalTwo.evaluate('console.log(1)')\n// throw an error: console is undefined\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼Realm æ²ç®±éé¢æ²¡æconsoleå¯¹è±¡ï¼å¯¼è´æ¥éãå ä¸ºconsoleä¸æ¯è¯­æ³æ åï¼æ¯å®¿ä¸»ç¯å¢æä¾çã\n\nå¦æè¦è§£å³è¿ä¸ªé®é¢ï¼å¯ä»¥ä½¿ç¨ä¸é¢çä»£ç ã\n\nglobalTwo.console = globalOne.console;\n\n\n1\n\n\nRealm()æé å½æ°å¯ä»¥æ¥åä¸ä¸ªåæ°å¯¹è±¡ï¼è¯¥åæ°å¯¹è±¡çintrinsicså±æ§å¯ä»¥æå® Realm æ²ç®±ç»§æ¿åå§é¡¶å±å¯¹è±¡çæ¹æ³ã\n\nconst r1 = new Realm();\nr1.global === this;\nr1.global.JSON === JSON; // false\n\nconst r2 = new Realm({ intrinsics: 'inherit' });\nr2.global === this; // false\nr2.global.JSON === JSON; // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼æ­£å¸¸æåµä¸ï¼æ²ç®±çJSONæ¹æ³ä¸åäºåå§çJSONå¯¹è±¡ãä½æ¯ï¼Realm()æé å½æ°æ¥å{ intrinsics: 'inherit' }ä½ä¸ºåæ°ä»¥åï¼å°±ä¼ç»§æ¿åå§é¡¶å±å¯¹è±¡çæ¹æ³ã\n\nç¨æ·å¯ä»¥èªå·±å®ä¹Realmçå­ç±»ï¼ç¨æ¥å®å¶èªå·±çæ²ç®±ã\n\nclass FakeWindow extends Realm {\n  init() {\n    super.init();\n    let global = this.global;\n\n    global.document = new FakeDocument(...);\n    global.alert = new Proxy(fakeAlert, { ... });\n    // ...\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼FakeWindowæ¨¡æäºä¸ä¸ªåçé¡¶å±å¯¹è±¡windowã\n\n\n# #!å½ä»¤\n\nUnix çå½ä»¤è¡èæ¬é½æ¯æ#!å½ä»¤ï¼åç§°ä¸º Shebang æ Hashbangãè¿ä¸ªå½ä»¤æ¾å¨èæ¬çç¬¬ä¸è¡ï¼ç¨æ¥æå®èæ¬çæ§è¡å¨ã\n\næ¯å¦ Bash èæ¬çç¬¬ä¸è¡ã\n\n#!/bin/sh\n\n\n1\n\n\nPython èæ¬çç¬¬ä¸è¡ã\n\n#!/usr/bin/env python\n\n\n1\n\n\nç°å¨æä¸ä¸ªææ¡ï¼ä¸º JavaScript èæ¬å¼å¥äº#!å½ä»¤ï¼åå¨èæ¬æä»¶æèæ¨¡åæä»¶çç¬¬ä¸è¡ã\n\n// åå¨èæ¬æä»¶ç¬¬ä¸è¡\n#!/usr/bin/env node\n'use strict';\nconsole.log(1);\n\n// åå¨æ¨¡åæä»¶ç¬¬ä¸è¡\n#!/usr/bin/env node\nexport {};\nconsole.log(1);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\næäºè¿ä¸è¡ä»¥åï¼Unix å½ä»¤è¡å°±å¯ä»¥ç´æ¥æ§è¡èæ¬ã\n\n# ä»¥åæ§è¡èæ¬çæ¹å¼\n$ node hello.js\n\n# hashbang çæ¹å¼\n$ hello.js\n\n\n1\n2\n3\n4\n5\n\n\nå¯¹äº JavaScript å¼ææ¥è¯´ï¼ä¼æ#!çè§£ææ³¨éï¼å¿½ç¥æè¿ä¸è¡ã\n\n\n# import.meta\n\nå¼åèä½¿ç¨ä¸ä¸ªæ¨¡åæ¶ï¼ææ¶éè¦ç¥éæ¨¡æ¿æ¬èº«çä¸äºä¿¡æ¯ï¼æ¯å¦æ¨¡åçè·¯å¾ï¼ãç°å¨æä¸ä¸ªææ¡ï¼ä¸º import å½ä»¤æ·»å äºä¸ä¸ªåå±æ§import.betaï¼è¿åå½åæ¨¡åçåä¿¡æ¯ã\n\nimport.metaåªè½å¨æ¨¡ååé¨ä½¿ç¨ï¼å¦æå¨æ¨¡åå¤é¨ä½¿ç¨ä¼æ¥éã\n\nè¿ä¸ªå±æ§è¿åä¸ä¸ªå¯¹è±¡ï¼è¯¥å¯¹è±¡çåç§å±æ§å°±æ¯å½åè¿è¡çèæ¬çåä¿¡æ¯ãå·ä½åå«åªäºå±æ§ï¼æ åæ²¡æè§å®ï¼ç±åä¸ªè¿è¡ç¯å¢èªè¡å³å®ãä¸è¬æ¥è¯´ï¼import.metaè³å°ä¼æä¸é¢ä¸¤ä¸ªå±æ§ã\n\nï¼1ï¼import.meta.url\n\nimport.meta.urlè¿åå½åæ¨¡åç URL è·¯å¾ãä¸¾ä¾æ¥è¯´ï¼å½åæ¨¡åä¸»æä»¶çè·¯å¾æ¯https://foo.com/main.jsï¼import.meta.urlå°±è¿åè¿ä¸ªè·¯å¾ãå¦ææ¨¡åéé¢è¿æä¸ä¸ªæ°æ®æä»¶data.txtï¼é£ä¹å°±å¯ä»¥ç¨ä¸é¢çä»£ç ï¼è·åè¿ä¸ªæ°æ®æä»¶çè·¯å¾ã\n\nnew URL('data.txt', import.meta.url)\n\n\n1\n\n\næ³¨æï¼Node.js ç¯å¢ä¸­ï¼import.meta.urlè¿åçæ»æ¯æ¬å°è·¯å¾ï¼å³æ¯file:URLåè®®çå­ç¬¦ä¸²ï¼æ¯å¦file:///home/user/foo.jsã\n\nï¼2ï¼import.meta.scriptElement\n\nimport.meta.scriptElementæ¯æµè§å¨ç¹æçåå±æ§ï¼è¿åå è½½æ¨¡åçé£ä¸ª<script>åç´ ï¼ç¸å½äºdocument.currentScriptå±æ§ã\n\n// HTML ä»£ç ä¸º\n// <script type=\"module\" src=\"my-module.js\" data-foo=\"abc\"><\/script>\n\n// my-module.js åé¨æ§è¡ä¸é¢çä»£ç \nimport.meta.scriptElement.dataset.foo\n// \"abc\"\n\n\n1\n2\n3\n4\n5\n6\n",normalizedContent:"# ææ°ææ¡\n\næ¬ç« ä»ç»ä¸äºå°æªè¿å¥æ åãä½å¾æå¸æçææ°ææ¡ã\n\n\n# do è¡¨è¾¾å¼\n\næ¬è´¨ä¸ï¼åçº§ä½ç¨åæ¯ä¸ä¸ªè¯­å¥ï¼å°å¤ä¸ªæä½å°è£å¨ä¸èµ·ï¼æ²¡æè¿åå¼ã\n\n{\n  let t = f();\n  t = t * t + 1;\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼åçº§ä½ç¨åå°ä¸¤ä¸ªè¯­å¥å°è£å¨ä¸èµ·ãä½æ¯ï¼å¨åçº§ä½ç¨åä»¥å¤ï¼æ²¡æåæ³å¾å°tçå¼ï¼å ä¸ºåçº§ä½ç¨åä¸è¿åå¼ï¼é¤étæ¯å¨å±åéã\n\nç°å¨æä¸ä¸ªææ¡ï¼ä½¿å¾åçº§ä½ç¨åå¯ä»¥åä¸ºè¡¨è¾¾å¼ï¼ä¹å°±æ¯è¯´å¯ä»¥è¿åå¼ï¼åæ³å°±æ¯å¨åçº§ä½ç¨åä¹åå ä¸doï¼ä½¿å®åä¸ºdoè¡¨è¾¾å¼ï¼ç¶åå°±ä¼è¿ååé¨æåæ§è¡çè¡¨è¾¾å¼çå¼ã\n\nlet x = do {\n  let t = f();\n  t * t + 1;\n};\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼åéxä¼å¾å°æ´ä¸ªåçº§ä½ç¨åçè¿åå¼ï¼t * t + 1ï¼ã\n\ndoè¡¨è¾¾å¼çé»è¾éå¸¸ç®åï¼å°è£çæ¯ä»ä¹ï¼å°±ä¼è¿åä»ä¹ã\n\n// ç­åäº <è¡¨è¾¾å¼>\ndo { <è¡¨è¾¾å¼>; }\n\n// ç­åäº <è¯­å¥>\ndo { <è¯­å¥> }\n\n\n1\n2\n3\n4\n5\n\n\ndoè¡¨è¾¾å¼çå¥½å¤æ¯å¯ä»¥å°è£å¤ä¸ªè¯­å¥ï¼è®©ç¨åºæ´å æ¨¡ååï¼å°±åä¹é«ç§¯æ¨é£æ ·ä¸ååæ¼è£èµ·æ¥ã\n\nlet x = do {\n  if (foo()) { f() }\n  else if (bar()) { g() }\n  else { h() }\n};\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç çæ¬è´¨ï¼å°±æ¯æ ¹æ®å½æ°fooçæ§è¡ç»æï¼è°ç¨ä¸åçå½æ°ï¼å°è¿åç»æèµç»åéxãä½¿ç¨doè¡¨è¾¾å¼ï¼å°±å°è¿ä¸ªæä½çæå¾è¡¨è¾¾å¾éå¸¸ç®æ´æ¸æ°ãèä¸ï¼doåçº§ä½ç¨åæä¾äºåç¬çä½ç¨åï¼åé¨æä½å¯ä»¥ä¸å¨å±ä½ç¨åéç»ã\n\nå¼å¾ä¸æçæ¯ï¼doè¡¨è¾¾å¼å¨ jsx è¯­æ³ä¸­éå¸¸å¥½ç¨ã\n\nreturn (\n  <nav>\n    <home />\n    {\n      do {\n        if (loggedin) {\n          <logoutbutton />\n        } else {\n          <loginbutton />\n        }\n      }\n    }\n  </nav>\n)\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æä¸ç¨doè¡¨è¾¾å¼ï¼å°±åªè½ç¨ä¸åå¤æ­è¿ç®ç¬¦ï¼?:ï¼ãé£æ ·çè¯ï¼ä¸æ¦å¤æ­é»è¾å¤æï¼ä»£ç å°±ä¼åå¾å¾ä¸æè¯»ã\n\n\n# throw è¡¨è¾¾å¼\n\njavascript è¯­æ³è§å®throwæ¯ä¸ä¸ªå½ä»¤ï¼ç¨æ¥æåºéè¯¯ï¼ä¸è½ç¨äºè¡¨è¾¾å¼ä¹ä¸­ã\n\n// æ¥é\nconsole.log(throw new error());\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼console.logçåæ°å¿é¡»æ¯ä¸ä¸ªè¡¨è¾¾å¼ï¼å¦ææ¯ä¸ä¸ªthrowè¯­å¥å°±ä¼æ¥éã\n\nç°å¨æä¸ä¸ªææ¡ï¼åè®¸throwç¨äºè¡¨è¾¾å¼ã\n\n// åæ°çé»è®¤å¼\nfunction save(filename = throw new typeerror(\"argument required\")) {\n}\n\n// ç®­å¤´å½æ°çè¿åå¼\nlint(ast, {\n  with: () => throw new error(\"avoid using 'with' statements.\")\n});\n\n// æ¡ä»¶è¡¨è¾¾å¼\nfunction getencoder(encoding) {\n  const encoder = encoding === \"utf8\" ?\n    new utf8encoder() :\n    encoding === \"utf16le\" ?\n      new utf16encoder(false) :\n      encoding === \"utf16be\" ?\n        new utf16encoder(true) :\n        throw new error(\"unsupported encoding\");\n}\n\n// é»è¾è¡¨è¾¾å¼\nclass product {\n  get id() {\n    return this._id;\n  }\n  set id(value) {\n    this._id = value || throw new error(\"invalid value\");\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nä¸é¢ä»£ç ä¸­ï¼throwé½åºç°å¨è¡¨è¾¾å¼éé¢ã\n\nè¯­æ³ä¸ï¼throwè¡¨è¾¾å¼éé¢çthrowä¸åæ¯ä¸ä¸ªå½ä»¤ï¼èæ¯ä¸ä¸ªè¿ç®ç¬¦ãä¸ºäºé¿åä¸throwå½ä»¤æ··æ·ï¼è§å®throwåºç°å¨è¡é¦ï¼ä¸å¾è§£éä¸ºthrowè¯­å¥ï¼èä¸æ¯throwè¡¨è¾¾å¼ã\n\n\n# å½æ°çé¨åæ§è¡\n\n\n# è¯­æ³\n\nå¤åæ°çå½æ°ææ¶éè¦ç»å®å¶ä¸­çä¸ä¸ªæå¤ä¸ªåæ°ï¼ç¶åè¿åä¸ä¸ªæ°å½æ°ã\n\nfunction add(x, y) { return x + y; }\nfunction add7(x) { return x + 7; }\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼add7å½æ°å¶å®æ¯addå½æ°çä¸ä¸ªç¹æ®çæ¬ï¼éè¿å°ä¸ä¸ªåæ°ç»å®ä¸º7ï¼å°±å¯ä»¥ä»addå¾å°add7ã\n\n// bind æ¹æ³\nconst add7 = add.bind(null, 7);\n\n// ç®­å¤´å½æ°\nconst add7 = x => add(x, 7);\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä¸¤ç§åæ³é½æäºåä½ãå¶ä¸­ï¼bindæ¹æ³çå±éæ´å ææ¾ï¼å®å¿é¡»æä¾thisï¼å¹¶ä¸åªè½ä»åå°åä¸ä¸ªä¸ªç»å®åæ°ï¼æ æ³åªç»å®éå¤´é¨çåæ°ã\n\nç°å¨æä¸ä¸ªææ¡ï¼ä½¿å¾ç»å®åæ°å¹¶è¿åä¸ä¸ªæ°å½æ°æ´å å®¹æãè¿å«åå½æ°çé¨åæ§è¡ï¼partial applicationï¼ã\n\nconst add = (x, y) => x + y;\nconst addone = add(1, ?);\n\nconst maxgreaterthanzero = math.max(0, ...);\n\n\n1\n2\n3\n4\n\n\næ ¹æ®æ°ææ¡ï¼?æ¯åä¸ªåæ°çå ä½ç¬¦ï¼...æ¯å¤ä¸ªåæ°çå ä½ç¬¦ãä»¥ä¸çå½¢å¼é½å±äºå½æ°çé¨åæ§è¡ã\n\nf(x, ?)\nf(x, ...)\nf(?, x)\nf(..., x)\nf(?, x, ?)\nf(..., x, ...)\n\n\n1\n2\n3\n4\n5\n6\n\n\n?å...åªè½åºç°å¨å½æ°çè°ç¨ä¹ä¸­ï¼å¹¶ä¸ä¼è¿åä¸ä¸ªæ°å½æ°ã\n\nconst g = f(?, 1, ...);\n// ç­åäº\nconst g = (x, ...y) => f(x, 1, ...y);\n\n\n1\n2\n3\n\n\nå½æ°çé¨åæ§è¡ï¼ä¹å¯ä»¥ç¨äºå¯¹è±¡çæ¹æ³ã\n\nlet obj = {\n  f(x, y) { return x + y; },\n};\n\nconst g = obj.f(?, 3);\ng(1) // 4\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# æ³¨æç¹\n\nå½æ°çé¨åæ§è¡æä¸äºç¹å«æ³¨æçå°æ¹ã\n\nï¼1ï¼å½æ°çé¨åæ§è¡æ¯åºäºåå½æ°çãå¦æåå½æ°åçååï¼é¨åæ§è¡çæçæ°å½æ°ä¹ä¼ç«å³åæ è¿ç§ååã\n\nlet f = (x, y) => x + y;\n\nconst g = f(?, 3);\ng(1); // 4\n\n// æ¿æ¢å½æ° f\nf = (x, y) => x * y;\n\ng(1); // 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å®ä¹äºå½æ°çé¨åæ§è¡ä»¥åï¼æ´æ¢åå½æ°ä¼ç«å³å½±åå°æ°å½æ°ã\n\nï¼2ï¼å¦æé¢åæä¾çé£ä¸ªå¼æ¯ä¸ä¸ªè¡¨è¾¾å¼ï¼é£ä¹è¿ä¸ªè¡¨è¾¾å¼å¹¶ä¸ä¼å¨å®ä¹æ¶æ±å¼ï¼èæ¯å¨æ¯æ¬¡è°ç¨æ¶æ±å¼ã\n\nlet a = 3;\nconst f = (x, y) => x + y;\n\nconst g = f(?, a);\ng(1); // 4\n\n// æ¹å a çå¼\na = 10;\ng(1); // 11\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼é¢åæä¾çåæ°æ¯åéaï¼é£ä¹æ¯æ¬¡è°ç¨å½æ°gçæ¶åï¼æä¼å¯¹aè¿è¡æ±å¼ã\n\nï¼3ï¼å¦ææ°å½æ°çåæ°å¤äºå ä½ç¬¦çæ°éï¼é£ä¹å¤ä½çåæ°å°è¢«å¿½ç¥ã\n\nconst f = (x, ...y) => [x, ...y];\nconst g = f(?, 1);\ng(2, 3, 4); // [2, 1]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°gåªæä¸ä¸ªå ä½ç¬¦ï¼ä¹å°±æå³çå®åªè½æ¥åä¸ä¸ªåæ°ï¼å¤ä½çåæ°é½ä¼è¢«å¿½ç¥ã\n\nåæä¸é¢è¿æ ·ï¼å¤ä½çåæ°å°±æ²¡æé®é¢ã\n\nconst f = (x, ...y) => [x, ...y];\nconst g = f(?, 1, ...);\ng(2, 3, 4); // [2, 1, 3, 4];\n\n\n1\n2\n3\n\n\nï¼4ï¼...åªä¼è¢«ééä¸æ¬¡ï¼å¦æå½æ°çé¨åæ§è¡ä½¿ç¨äºå¤ä¸ª...ï¼é£ä¹æ¯ä¸ª...çå¼é½å°ç¸åã\n\nconst f = (...x) => x;\nconst g = f(..., 9, ...);\ng(1, 2, 3); // [1, 2, 3, 9, 1, 2, 3]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼gå®ä¹äºä¸¤ä¸ª...å ä½ç¬¦ï¼çæ­£æ§è¡çæ¶åï¼å®ä»¬çå¼æ¯ä¸æ ·çã\n\n\n# ç®¡éè¿ç®ç¬¦\n\nunix æä½ç³»ç»æä¸ä¸ªç®¡éæºå¶ï¼pipelineï¼ï¼å¯ä»¥æåä¸ä¸ªæä½çå¼ä¼ ç»åä¸ä¸ªæä½ãè¿ä¸ªæºå¶éå¸¸æç¨ï¼ä½¿å¾ç®åçæä½å¯ä»¥ç»åæä¸ºå¤æçæä½ãè®¸å¤è¯­è¨é½æç®¡éçå®ç°ï¼ç°å¨æä¸ä¸ªææ¡ï¼è®© javascript ä¹æ¥æç®¡éæºå¶ã\n\njavascript çç®¡éæ¯ä¸ä¸ªè¿ç®ç¬¦ï¼åä½|>ãå®çå·¦è¾¹æ¯ä¸ä¸ªè¡¨è¾¾å¼ï¼å³è¾¹æ¯ä¸ä¸ªå½æ°ãç®¡éè¿ç®ç¬¦æå·¦è¾¹è¡¨è¾¾å¼çå¼ï¼ä¼ å¥å³è¾¹çå½æ°è¿è¡æ±å¼ã\n\nx |> f\n// ç­åäº\nf(x)\n\n\n1\n2\n3\n\n\nç®¡éè¿ç®ç¬¦æå¤§çå¥½å¤ï¼å°±æ¯å¯ä»¥æåµå¥çå½æ°ï¼åæä»å·¦å°å³çé¾å¼è¡¨è¾¾å¼ã\n\nfunction doublesay (str) {\n  return str + \", \" + str;\n}\n\nfunction capitalize (str) {\n  return str[0].touppercase() + str.substring(1);\n}\n\nfunction exclaim (str) {\n  return str + '!';\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢æ¯ä¸ä¸ªç®åçå½æ°ãå¦æè¦åµå¥æ§è¡ï¼ä¼ ç»çåæ³åç®¡éçåæ³åå«å¦ä¸ã\n\n// ä¼ ç»çåæ³\nexclaim(capitalize(doublesay('hello')))\n// \"hello, hello!\"\n\n// ç®¡éçåæ³\n'hello'\n  |> doublesay\n  |> capitalize\n  |> exclaim\n// \"hello, hello!\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nç®¡éè¿ç®ç¬¦åªè½ä¼ éä¸ä¸ªå¼ï¼è¿æå³çå®å³è¾¹çå½æ°å¿é¡»æ¯ä¸ä¸ªååæ°å½æ°ãå¦ææ¯å¤åæ°å½æ°ï¼å°±å¿é¡»è¿è¡æ¯éåï¼æ¹æååæ°ççæ¬ã\n\nfunction double (x) { return x + x; }\nfunction add (x, y) { return x + y; }\n\nlet person = { score: 25 };\nperson.score\n  |> double\n  |> (_ => add(7, _))\n// 57\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼addå½æ°éè¦ä¸¤ä¸ªåæ°ãä½æ¯ï¼ç®¡éè¿ç®ç¬¦åªè½ä¼ å¥ä¸ä¸ªå¼ï¼å æ­¤éè¦äºåæä¾å¦ä¸ä¸ªåæ°ï¼å¹¶å°å¶æ¹æååæ°çç®­å¤´å½æ°_ => add(7, _)ãè¿ä¸ªå½æ°éé¢çä¸åçº¿å¹¶æ²¡æç¹å«çå«ä¹ï¼å¯ä»¥ç¨å¶ä»ç¬¦å·ä»£æ¿ï¼ä½¿ç¨ä¸åçº¿åªæ¯å ä¸ºï¼å®è½å¤å½¢è±¡å°è¡¨ç¤ºè¿éæ¯å ä½ç¬¦ã\n\nç®¡éè¿ç®ç¬¦å¯¹äºawaitå½æ°ä¹éç¨ã\n\nx |> await f\n// ç­åäº\nawait f(x)\n\nconst userage = userid |> await fetchuserbyid |> getagefromuser;\n// ç­åäº\nconst userage = getagefromuser(await fetchuserbyid(userid));\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# æ°å¼åéç¬¦\n\næ¬§ç¾è¯­è¨ä¸­ï¼è¾é¿çæ°å¼åè®¸æ¯ä¸ä½æ·»å ä¸ä¸ªåéç¬¦ï¼éå¸¸æ¯ä¸ä¸ªéå·ï¼ï¼å¢å æ°å¼çå¯è¯»æ§ãæ¯å¦ï¼1000å¯ä»¥åä½1,000ã\n\nç°å¨æä¸ä¸ªææ¡ï¼åè®¸ javascript çæ°å¼ä½¿ç¨ä¸åçº¿ï¼_ï¼ä½ä¸ºåéç¬¦ã\n\nlet budget = 1_000_000_000_000;\nbudget === 10 ** 12 // true\n\n\n1\n2\n\n\njavascript çæ°å¼åéç¬¦æ²¡ææå®é´éçä½æ°ï¼ä¹å°±æ¯è¯´ï¼å¯ä»¥æ¯ä¸ä½æ·»å ä¸ä¸ªåéç¬¦ï¼ä¹å¯ä»¥æ¯ä¸ä½ãæ¯ä¸¤ä½ãæ¯åä½æ·»å ä¸ä¸ªã\n\n123_00 === 12_300 // true\n\n12345_00 === 123_4500 // true\n12345_00 === 1_234_500 // true\n\n\n1\n2\n3\n4\n\n\nå°æ°åç§å­¦è®¡æ°æ³ä¹å¯ä»¥ä½¿ç¨æ°å¼åéç¬¦ã\n\n// å°æ°\n0.000_001\n// ç§å­¦è®¡æ°æ³\n1e10_000\n\n\n1\n2\n3\n4\n\n\næ°å¼åéç¬¦æå ä¸ªä½¿ç¨æ³¨æç¹ã\n\n * ä¸è½å¨æ°å¼çæåé¢ï¼leadingï¼ææåé¢ï¼trailingï¼ã\n * ä¸è½ä¸¤ä¸ªæä¸¤ä¸ªä»¥ä¸çåéç¬¦è¿å¨ä¸èµ·ã\n * å°æ°ç¹çååä¸è½æåéç¬¦ã\n * ç§å­¦è®¡æ°æ³éé¢ï¼è¡¨ç¤ºææ°çeæeååä¸è½æåéç¬¦ã\n\nä¸é¢çåæ³é½ä¼æ¥éã\n\n// å¨é¨æ¥é\n3_.141\n3._141\n1_e12\n1e_12\n123__456\n_1464301\n1464301_\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\né¤äºåè¿å¶ï¼å¶ä»è¿å¶çæ°å¼ä¹å¯ä»¥ä½¿ç¨åéç¬¦ã\n\n// äºè¿å¶\n0b1010_0001_1000_0101\n// åå­è¿å¶\n0xa0_b0_c0\n\n\n1\n2\n3\n4\n\n\næ³¨æï¼åéç¬¦ä¸è½ç´§è·çè¿å¶çåç¼0bã0bã0oã0oã0xã0xã\n\n// æ¥é\n0_b111111000\n0b_111111000\n\n\n1\n2\n3\n\n\nä¸é¢ä¸ä¸ªå°å­ç¬¦ä¸²è½¬ææ°å¼çå½æ°ï¼ä¸æ¯ææ°å¼åéç¬¦ãä¸»è¦åå æ¯ææ¡çè®¾è®¡èè®¤ä¸ºï¼æ°å¼åéç¬¦ä¸»è¦æ¯ä¸ºäºç¼ç æ¶ä¹¦åæ°å¼çæ¹ä¾¿ï¼èä¸æ¯ä¸ºäºå¤çå¤é¨è¾å¥çæ°æ®ã\n\n * number()\n * parseint()\n * parsefloat()\n\nnumber('123_456') // nan\nparseint('123_456') // 123\n\n\n1\n2\n\n\n\n# math.signbit()\n\nmath.sign()ç¨æ¥å¤æ­ä¸ä¸ªå¼çæ­£è´ï¼ä½æ¯å¦æåæ°æ¯-0ï¼å®ä¼è¿å-0ã\n\nmath.sign(-0) // -0\n\n\n1\n\n\nè¿å¯¼è´å¯¹äºå¤æ­ç¬¦å·ä½çæ­£è´ï¼math.sign()ä¸æ¯å¾æç¨ãjavascript åé¨ä½¿ç¨ 64 ä½æµ®ç¹æ°ï¼å½éæ å ieee 754ï¼è¡¨ç¤ºæ°å¼ï¼ieee 754 è§å®ç¬¬ä¸ä½æ¯ç¬¦å·ä½ï¼0è¡¨ç¤ºæ­£æ°ï¼1è¡¨ç¤ºè´æ°ãæä»¥ä¼æä¸¤ç§é¶ï¼+0æ¯ç¬¦å·ä½ä¸º0æ¶çé¶å¼ï¼-0æ¯ç¬¦å·ä½ä¸º1æ¶çé¶å¼ãå®éç¼ç¨ä¸­ï¼å¤æ­ä¸ä¸ªå¼æ¯+0è¿æ¯-0éå¸¸éº»ç¦ï¼å ä¸ºå®ä»¬æ¯ç¸ç­çã\n\n+0 === -0 // true\n\n\n1\n\n\nç®åï¼æä¸ä¸ªææ¡ï¼å¼å¥äºmath.signbit()æ¹æ³å¤æ­ä¸ä¸ªæ°çç¬¦å·ä½æ¯å¦è®¾ç½®äºã\n\nmath.signbit(2) //false\nmath.signbit(-2) //true\nmath.signbit(0) //false\nmath.signbit(-0) //true\n\n\n1\n2\n3\n4\n\n\nå¯ä»¥çå°ï¼è¯¥æ¹æ³æ­£ç¡®è¿åäº-0çç¬¦å·ä½æ¯è®¾ç½®äºçã\n\nè¯¥æ¹æ³çç®æ³å¦ä¸ã\n\n * å¦æåæ°æ¯nanï¼è¿åfalse\n * å¦æåæ°æ¯-0ï¼è¿åtrue\n * å¦æåæ°æ¯è´å¼ï¼è¿åtrue\n * å¶ä»æåµè¿åfalse\n\n\n# ååå·è¿ç®ç¬¦\n\nç®­å¤´å½æ°å¯ä»¥ç»å®thiså¯¹è±¡ï¼å¤§å¤§åå°äºæ¾å¼ç»å®thiså¯¹è±¡çåæ³ï¼callãapplyãbindï¼ãä½æ¯ï¼ç®­å¤´å½æ°å¹¶ä¸éç¨äºææåºåï¼æä»¥ç°å¨æä¸ä¸ªææ¡ï¼æåºäºâå½æ°ç»å®âï¼function bindï¼è¿ç®ç¬¦ï¼ç¨æ¥åä»£callãapplyãbindè°ç¨ã\n\nå½æ°ç»å®è¿ç®ç¬¦æ¯å¹¶æçä¸¤ä¸ªåå·ï¼::ï¼ï¼ååå·å·¦è¾¹æ¯ä¸ä¸ªå¯¹è±¡ï¼å³è¾¹æ¯ä¸ä¸ªå½æ°ãè¯¥è¿ç®ç¬¦ä¼èªå¨å°å·¦è¾¹çå¯¹è±¡ï¼ä½ä¸ºä¸ä¸æç¯å¢ï¼å³thiså¯¹è±¡ï¼ï¼ç»å®å°å³è¾¹çå½æ°ä¸é¢ã\n\nfoo::bar;\n// ç­åäº\nbar.bind(foo);\n\nfoo::bar(...arguments);\n// ç­åäº\nbar.apply(foo, arguments);\n\nconst hasownproperty = object.prototype.hasownproperty;\nfunction hasown(obj, key) {\n  return obj::hasownproperty(key);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå¦æååå·å·¦è¾¹ä¸ºç©ºï¼å³è¾¹æ¯ä¸ä¸ªå¯¹è±¡çæ¹æ³ï¼åç­äºå°è¯¥æ¹æ³ç»å®å¨è¯¥å¯¹è±¡ä¸é¢ã\n\nvar method = obj::obj.foo;\n// ç­åäº\nvar method = ::obj.foo;\n\nlet log = ::console.log;\n// ç­åäº\nvar log = console.log.bind(console);\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¦æååå·è¿ç®ç¬¦çè¿ç®ç»æï¼è¿æ¯ä¸ä¸ªå¯¹è±¡ï¼å°±å¯ä»¥éç¨é¾å¼åæ³ã\n\nimport { map, takewhile, foreach } from \"iterlib\";\n\ngetplayers()\n::map(x => x.character())\n::takewhile(x => x.strength > 100)\n::foreach(x => console.log(x));\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# realm api\n\nrealm api æä¾æ²ç®±åè½ï¼sandboxï¼ï¼åè®¸éç¦»ä»£ç ï¼é²æ­¢é£äºè¢«éç¦»çä»£ç æ¿å°å¨å±å¯¹è±¡ã\n\nä»¥åï¼ç»å¸¸ä½¿ç¨<iframe>ä½ä¸ºæ²ç®±ã\n\nconst globalone = window;\nlet iframe = document.createelement('iframe');\ndocument.body.appendchild(iframe);\nconst globaltwo = iframe.contentwindow;\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼<iframe>çå¨å±å¯¹è±¡æ¯ç¬ç«çï¼iframe.contentwindowï¼ãrealm api å¯ä»¥åä»£è¿ä¸ªåè½ã\n\nconst globalone = window;\nconst globaltwo = new realm().global;\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼realm apiåç¬æä¾äºä¸ä¸ªå¨å±å¯¹è±¡new realm().globalã\n\nrealm api æä¾ä¸ä¸ªrealm()æé å½æ°ï¼ç¨æ¥çæä¸ä¸ª realm å¯¹è±¡ãè¯¥å¯¹è±¡çglobalå±æ§æåä¸ä¸ªæ°çé¡¶å±å¯¹è±¡ï¼è¿ä¸ªé¡¶å±å¯¹è±¡è·åå§çé¡¶å±å¯¹è±¡ç±»ä¼¼ã\n\nconst globalone = window;\nconst globaltwo = new realm().global;\n\nglobalone.evaluate('1 + 2') // 3\nglobaltwo.evaluate('1 + 2') // 3\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼realm çæçé¡¶å±å¯¹è±¡çevaluate()æ¹æ³ï¼å¯ä»¥è¿è¡ä»£ç ã\n\nä¸é¢çä»£ç å¯ä»¥è¯æï¼realm é¡¶å±å¯¹è±¡ä¸åå§é¡¶å±å¯¹è±¡æ¯ä¸¤ä¸ªå¯¹è±¡ã\n\nlet a1 = globalone.evaluate('[1,2,3]');\nlet a2 = globaltwo.evaluate('[1,2,3]');\na1.prototype === a2.prototype; // false\na1 instanceof globaltwo.array; // false\na2 instanceof globalone.array; // false\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼realm æ²ç®±éé¢çæ°ç»çååå¯¹è±¡ï¼è·åå§ç¯å¢éé¢çæ°ç»æ¯ä¸ä¸æ ·çã\n\nrealm æ²ç®±éé¢åªè½è¿è¡ ecmascript è¯­æ³æä¾ç apiï¼ä¸è½è¿è¡å®¿ä¸»ç¯å¢æä¾ç apiã\n\nglobaltwo.evaluate('console.log(1)')\n// throw an error: console is undefined\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼realm æ²ç®±éé¢æ²¡æconsoleå¯¹è±¡ï¼å¯¼è´æ¥éãå ä¸ºconsoleä¸æ¯è¯­æ³æ åï¼æ¯å®¿ä¸»ç¯å¢æä¾çã\n\nå¦æè¦è§£å³è¿ä¸ªé®é¢ï¼å¯ä»¥ä½¿ç¨ä¸é¢çä»£ç ã\n\nglobaltwo.console = globalone.console;\n\n\n1\n\n\nrealm()æé å½æ°å¯ä»¥æ¥åä¸ä¸ªåæ°å¯¹è±¡ï¼è¯¥åæ°å¯¹è±¡çintrinsicså±æ§å¯ä»¥æå® realm æ²ç®±ç»§æ¿åå§é¡¶å±å¯¹è±¡çæ¹æ³ã\n\nconst r1 = new realm();\nr1.global === this;\nr1.global.json === json; // false\n\nconst r2 = new realm({ intrinsics: 'inherit' });\nr2.global === this; // false\nr2.global.json === json; // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼æ­£å¸¸æåµä¸ï¼æ²ç®±çjsonæ¹æ³ä¸åäºåå§çjsonå¯¹è±¡ãä½æ¯ï¼realm()æé å½æ°æ¥å{ intrinsics: 'inherit' }ä½ä¸ºåæ°ä»¥åï¼å°±ä¼ç»§æ¿åå§é¡¶å±å¯¹è±¡çæ¹æ³ã\n\nç¨æ·å¯ä»¥èªå·±å®ä¹realmçå­ç±»ï¼ç¨æ¥å®å¶èªå·±çæ²ç®±ã\n\nclass fakewindow extends realm {\n  init() {\n    super.init();\n    let global = this.global;\n\n    global.document = new fakedocument(...);\n    global.alert = new proxy(fakealert, { ... });\n    // ...\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼fakewindowæ¨¡æäºä¸ä¸ªåçé¡¶å±å¯¹è±¡windowã\n\n\n# #!å½ä»¤\n\nunix çå½ä»¤è¡èæ¬é½æ¯æ#!å½ä»¤ï¼åç§°ä¸º shebang æ hashbangãè¿ä¸ªå½ä»¤æ¾å¨èæ¬çç¬¬ä¸è¡ï¼ç¨æ¥æå®èæ¬çæ§è¡å¨ã\n\næ¯å¦ bash èæ¬çç¬¬ä¸è¡ã\n\n#!/bin/sh\n\n\n1\n\n\npython èæ¬çç¬¬ä¸è¡ã\n\n#!/usr/bin/env python\n\n\n1\n\n\nç°å¨æä¸ä¸ªææ¡ï¼ä¸º javascript èæ¬å¼å¥äº#!å½ä»¤ï¼åå¨èæ¬æä»¶æèæ¨¡åæä»¶çç¬¬ä¸è¡ã\n\n// åå¨èæ¬æä»¶ç¬¬ä¸è¡\n#!/usr/bin/env node\n'use strict';\nconsole.log(1);\n\n// åå¨æ¨¡åæä»¶ç¬¬ä¸è¡\n#!/usr/bin/env node\nexport {};\nconsole.log(1);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\næäºè¿ä¸è¡ä»¥åï¼unix å½ä»¤è¡å°±å¯ä»¥ç´æ¥æ§è¡èæ¬ã\n\n# ä»¥åæ§è¡èæ¬çæ¹å¼\n$ node hello.js\n\n# hashbang çæ¹å¼\n$ hello.js\n\n\n1\n2\n3\n4\n5\n\n\nå¯¹äº javascript å¼ææ¥è¯´ï¼ä¼æ#!çè§£ææ³¨éï¼å¿½ç¥æè¿ä¸è¡ã\n\n\n# import.meta\n\nå¼åèä½¿ç¨ä¸ä¸ªæ¨¡åæ¶ï¼ææ¶éè¦ç¥éæ¨¡æ¿æ¬èº«çä¸äºä¿¡æ¯ï¼æ¯å¦æ¨¡åçè·¯å¾ï¼ãç°å¨æä¸ä¸ªææ¡ï¼ä¸º import å½ä»¤æ·»å äºä¸ä¸ªåå±æ§import.betaï¼è¿åå½åæ¨¡åçåä¿¡æ¯ã\n\nimport.metaåªè½å¨æ¨¡ååé¨ä½¿ç¨ï¼å¦æå¨æ¨¡åå¤é¨ä½¿ç¨ä¼æ¥éã\n\nè¿ä¸ªå±æ§è¿åä¸ä¸ªå¯¹è±¡ï¼è¯¥å¯¹è±¡çåç§å±æ§å°±æ¯å½åè¿è¡çèæ¬çåä¿¡æ¯ãå·ä½åå«åªäºå±æ§ï¼æ åæ²¡æè§å®ï¼ç±åä¸ªè¿è¡ç¯å¢èªè¡å³å®ãä¸è¬æ¥è¯´ï¼import.metaè³å°ä¼æä¸é¢ä¸¤ä¸ªå±æ§ã\n\nï¼1ï¼import.meta.url\n\nimport.meta.urlè¿åå½åæ¨¡åç url è·¯å¾ãä¸¾ä¾æ¥è¯´ï¼å½åæ¨¡åä¸»æä»¶çè·¯å¾æ¯https://foo.com/main.jsï¼import.meta.urlå°±è¿åè¿ä¸ªè·¯å¾ãå¦ææ¨¡åéé¢è¿æä¸ä¸ªæ°æ®æä»¶data.txtï¼é£ä¹å°±å¯ä»¥ç¨ä¸é¢çä»£ç ï¼è·åè¿ä¸ªæ°æ®æä»¶çè·¯å¾ã\n\nnew url('data.txt', import.meta.url)\n\n\n1\n\n\næ³¨æï¼node.js ç¯å¢ä¸­ï¼import.meta.urlè¿åçæ»æ¯æ¬å°è·¯å¾ï¼å³æ¯file:urlåè®®çå­ç¬¦ä¸²ï¼æ¯å¦file:///home/user/foo.jsã\n\nï¼2ï¼import.meta.scriptelement\n\nimport.meta.scriptelementæ¯æµè§å¨ç¹æçåå±æ§ï¼è¿åå è½½æ¨¡åçé£ä¸ª<script>åç´ ï¼ç¸å½äºdocument.currentscriptå±æ§ã\n\n// html ä»£ç ä¸º\n// <script type=\"module\" src=\"my-module.js\" data-foo=\"abc\"><\/script>\n\n// my-module.js åé¨æ§è¡ä¸é¢çä»£ç \nimport.meta.scriptelement.dataset.foo\n// \"abc\"\n\n\n1\n2\n3\n4\n5\n6\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"è£é¥°å¨",frontmatter:{title:"è£é¥°å¨",date:"2020-02-09T16:00:30.000Z",permalink:"/pages/e97bc1e5626b082c",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/30.%E8%A3%85%E9%A5%B0%E5%99%A8.html",relativePath:"ãES6 æç¨ãç¬è®°/30.è£é¥°å¨.md",key:"v-3b44ff9b",path:"/pages/e97bc1e5626b082c/",headers:[{level:2,title:"ç±»çè£é¥°",slug:"ç±»çè£é¥°",normalizedTitle:"ç±»çè£é¥°",charIndex:436},{level:2,title:"æ¹æ³çè£é¥°",slug:"æ¹æ³çè£é¥°",normalizedTitle:"æ¹æ³çè£é¥°",charIndex:2627},{level:2,title:"ä¸ºä»ä¹è£é¥°å¨ä¸è½ç¨äºå½æ°ï¼",slug:"ä¸ºä»ä¹è£é¥°å¨ä¸è½ç¨äºå½æ°",normalizedTitle:"ä¸ºä»ä¹è£é¥°å¨ä¸è½ç¨äºå½æ°ï¼",charIndex:5164},{level:2,title:"core-decorators.js",slug:"core-decorators-js",normalizedTitle:"core-decorators.js",charIndex:6159},{level:2,title:"ä½¿ç¨è£é¥°å¨å®ç°èªå¨åå¸äºä»¶",slug:"ä½¿ç¨è£é¥°å¨å®ç°èªå¨åå¸äºä»¶",normalizedTitle:"ä½¿ç¨è£é¥°å¨å®ç°èªå¨åå¸äºä»¶",charIndex:8524},{level:2,title:"Mixin",slug:"mixin",normalizedTitle:"mixin",charIndex:9811},{level:2,title:"Trait",slug:"trait",normalizedTitle:"trait",charIndex:12076}],excerpt:'<h1 id="è£é¥°å¨"><a class="header-anchor" href="#è£é¥°å¨">#</a> è£é¥°å¨</h1>\n<p>[è¯´æ] Decorator ææ¡ç»è¿äºå¤§å¹ä¿®æ¹ï¼ç®åè¿æ²¡æå®æ¡ï¼ä¸ç¥éè¯­æ³ä¼ä¸ä¼ååãä¸é¢çåå®¹å®å¨ä¾æ®ä»¥åçææ¡ï¼å·²ç»æç¹è¿æ¶äºãç­å¾å®æ¡ä»¥åï¼éè¦å®å¨éåã</p>\n<p>è£é¥°å¨ï¼Decoratorï¼æ¯ä¸ç§ä¸ç±»ï¼classï¼ç¸å³çè¯­æ³ï¼ç¨æ¥æ³¨éæä¿®æ¹ç±»åç±»æ¹æ³ãè®¸å¤é¢åå¯¹è±¡çè¯­è¨é½æè¿é¡¹åè½ï¼ç®åæä¸ä¸ª<a href="https://github.com/tc39/proposal-decorators" target="_blank" rel="noopener noreferrer">ææ¡<OutboundLink/></a>å°å¶å¼å¥äº ECMAScriptã</p>\n',headersStr:"ç±»çè£é¥° æ¹æ³çè£é¥° ä¸ºä»ä¹è£é¥°å¨ä¸è½ç¨äºå½æ°ï¼ core-decorators.js ä½¿ç¨è£é¥°å¨å®ç°èªå¨åå¸äºä»¶ Mixin Trait",content:"# è£é¥°å¨\n\n[è¯´æ] Decorator ææ¡ç»è¿äºå¤§å¹ä¿®æ¹ï¼ç®åè¿æ²¡æå®æ¡ï¼ä¸ç¥éè¯­æ³ä¼ä¸ä¼ååãä¸é¢çåå®¹å®å¨ä¾æ®ä»¥åçææ¡ï¼å·²ç»æç¹è¿æ¶äºãç­å¾å®æ¡ä»¥åï¼éè¦å®å¨éåã\n\nè£é¥°å¨ï¼Decoratorï¼æ¯ä¸ç§ä¸ç±»ï¼classï¼ç¸å³çè¯­æ³ï¼ç¨æ¥æ³¨éæä¿®æ¹ç±»åç±»æ¹æ³ãè®¸å¤é¢åå¯¹è±¡çè¯­è¨é½æè¿é¡¹åè½ï¼ç®åæä¸ä¸ªææ¡å°å¶å¼å¥äº ECMAScriptã è£é¥°å¨æ¯ä¸ç§å½æ°ï¼åæ@ + å½æ°åãå®å¯ä»¥æ¾å¨ç±»åç±»æ¹æ³çå®ä¹åé¢ã\n\n@frozen class Foo {\n  @configurable(false)\n  @enumerable(true)\n  method() {}\n\n  @throttle(500)\n  expensiveMethod() {}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸å±ä½¿ç¨äºåä¸ªè£é¥°å¨ï¼ä¸ä¸ªç¨å¨ç±»æ¬èº«ï¼å¦å¤ä¸ä¸ªç¨å¨ç±»æ¹æ³ãå®ä»¬ä¸ä»å¢å äºä»£ç çå¯è¯»æ§ï¼æ¸æ°å°è¡¨è¾¾äºæå¾ï¼èä¸æä¾ä¸ç§æ¹ä¾¿çææ®µï¼å¢å æä¿®æ¹ç±»çåè½ã\n\n\n# ç±»çè£é¥°\n\nè£é¥°å¨å¯ä»¥ç¨æ¥è£é¥°æ´ä¸ªç±»ã\n\n@testable\nclass MyTestableClass {\n  // ...\n}\n\nfunction testable(target) {\n  target.isTestable = true;\n}\n\nMyTestableClass.isTestable // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼@testableå°±æ¯ä¸ä¸ªè£é¥°å¨ãå®ä¿®æ¹äºMyTestableClassè¿ä¸ªç±»çè¡ä¸ºï¼ä¸ºå®å ä¸äºéæå±æ§isTestableãtestableå½æ°çåæ°targetæ¯MyTestableClassç±»æ¬èº«ã\n\nåºæ¬ä¸ï¼è£é¥°å¨çè¡ä¸ºå°±æ¯ä¸é¢è¿æ ·ã\n\n@decorator\nclass A {}\n\n// ç­åäº\n\nclass A {}\nA = decorator(A) || A;\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¹å°±æ¯è¯´ï¼è£é¥°å¨æ¯ä¸ä¸ªå¯¹ç±»è¿è¡å¤ççå½æ°ãè£é¥°å¨å½æ°çç¬¬ä¸ä¸ªåæ°ï¼å°±æ¯æè¦è£é¥°çç®æ ç±»ã\n\nfunction testable(target) {\n  // ...\n}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼testableå½æ°çåæ°targetï¼å°±æ¯ä¼è¢«è£é¥°çç±»ã\n\nå¦æè§å¾ä¸ä¸ªåæ°ä¸å¤ç¨ï¼å¯ä»¥å¨è£é¥°å¨å¤é¢åå°è£ä¸å±å½æ°ã\n\nfunction testable(isTestable) {\n  return function(target) {\n    target.isTestable = isTestable;\n  }\n}\n\n@testable(true)\nclass MyTestableClass {}\nMyTestableClass.isTestable // true\n\n@testable(false)\nclass MyClass {}\nMyClass.isTestable // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼è£é¥°å¨testableå¯ä»¥æ¥ååæ°ï¼è¿å°±ç­äºå¯ä»¥ä¿®æ¹è£é¥°å¨çè¡ä¸ºã\n\næ³¨æï¼è£é¥°å¨å¯¹ç±»çè¡ä¸ºçæ¹åï¼æ¯ä»£ç ç¼è¯æ¶åççï¼èä¸æ¯å¨è¿è¡æ¶ãè¿æå³çï¼è£é¥°å¨è½å¨ç¼è¯é¶æ®µè¿è¡ä»£ç ãä¹å°±æ¯è¯´ï¼è£é¥°å¨æ¬è´¨å°±æ¯ç¼è¯æ¶æ§è¡çå½æ°ã\n\nåé¢çä¾å­æ¯ä¸ºç±»æ·»å ä¸ä¸ªéæå±æ§ï¼å¦ææ³æ·»å å®ä¾å±æ§ï¼å¯ä»¥éè¿ç®æ ç±»çprototypeå¯¹è±¡æä½ã\n\nfunction testable(target) {\n  target.prototype.isTestable = true;\n}\n\n@testable\nclass MyTestableClass {}\n\nlet obj = new MyTestableClass();\nobj.isTestable // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼è£é¥°å¨å½æ°testableæ¯å¨ç®æ ç±»çprototypeå¯¹è±¡ä¸æ·»å å±æ§ï¼å æ­¤å°±å¯ä»¥å¨å®ä¾ä¸è°ç¨ã\n\nä¸é¢æ¯å¦å¤ä¸ä¸ªä¾å­ã\n\n// mixins.js\nexport function mixins(...list) {\n  return function (target) {\n    Object.assign(target.prototype, ...list)\n  }\n}\n\n// main.js\nimport { mixins } from './mixins'\n\nconst Foo = {\n  foo() { console.log('foo') }\n};\n\n@mixins(Foo)\nclass MyClass {}\n\nlet obj = new MyClass();\nobj.foo() // 'foo'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç éè¿è£é¥°å¨mixinsï¼æFooå¯¹è±¡çæ¹æ³æ·»å å°äºMyClassçå®ä¾ä¸é¢ãå¯ä»¥ç¨Object.assign()æ¨¡æè¿ä¸ªåè½ã\n\nconst Foo = {\n  foo() { console.log('foo') }\n};\n\nclass MyClass {}\n\nObject.assign(MyClass.prototype, Foo);\n\nlet obj = new MyClass();\nobj.foo() // 'foo'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå®éå¼åä¸­ï¼React ä¸ Redux åºç»åä½¿ç¨æ¶ï¼å¸¸å¸¸éè¦åæä¸é¢è¿æ ·ã\n\nclass MyReactComponent extends React.Component {}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MyReactComponent);\n\n\n1\n2\n3\n\n\næäºè£é¥°å¨ï¼å°±å¯ä»¥æ¹åä¸é¢çä»£ç ã\n\n@connect(mapStateToProps, mapDispatchToProps)\nexport default class MyReactComponent extends React.Component {}\n\n\n1\n2\n\n\nç¸å¯¹æ¥è¯´ï¼åä¸ç§åæ³çä¸å»æ´å®¹æçè§£ã\n\n\n# æ¹æ³çè£é¥°\n\nè£é¥°å¨ä¸ä»å¯ä»¥è£é¥°ç±»ï¼è¿å¯ä»¥è£é¥°ç±»çå±æ§ã\n\nclass Person {\n  @readonly\n  name() { return `${this.first} ${this.last}` }\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼è£é¥°å¨readonlyç¨æ¥è£é¥°âç±»âçnameæ¹æ³ã\n\nè£é¥°å¨å½æ°readonlyä¸å±å¯ä»¥æ¥åä¸ä¸ªåæ°ã\n\nfunction readonly(target, name, descriptor){\n  // descriptorå¯¹è±¡åæ¥çå¼å¦ä¸\n  // {\n  //   value: specifiedFunction,\n  //   enumerable: false,\n  //   configurable: true,\n  //   writable: true\n  // };\n  descriptor.writable = false;\n  return descriptor;\n}\n\nreadonly(Person.prototype, 'name', descriptor);\n// ç±»ä¼¼äº\nObject.defineProperty(Person.prototype, 'name', descriptor);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nè£é¥°å¨ç¬¬ä¸ä¸ªåæ°æ¯ç±»çååå¯¹è±¡ï¼ä¸ä¾æ¯Person.prototypeï¼è£é¥°å¨çæ¬ææ¯è¦âè£é¥°âç±»çå®ä¾ï¼ä½æ¯è¿ä¸ªæ¶åå®ä¾è¿æ²¡çæï¼æä»¥åªè½å»è£é¥°ååï¼è¿ä¸åäºç±»çè£é¥°ï¼é£ç§æåµæ¶targetåæ°æçæ¯ç±»æ¬èº«ï¼ï¼ç¬¬äºä¸ªåæ°æ¯æè¦è£é¥°çå±æ§åï¼ç¬¬ä¸ä¸ªåæ°æ¯è¯¥å±æ§çæè¿°å¯¹è±¡ã\n\nå¦å¤ï¼ä¸é¢ä»£ç è¯´æï¼è£é¥°å¨ï¼readonlyï¼ä¼ä¿®æ¹å±æ§çæè¿°å¯¹è±¡ï¼descriptorï¼ï¼ç¶åè¢«ä¿®æ¹çæè¿°å¯¹è±¡åç¨æ¥å®ä¹å±æ§ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ï¼ä¿®æ¹å±æ§æè¿°å¯¹è±¡çenumerableå±æ§ï¼ä½¿å¾è¯¥å±æ§ä¸å¯éåã\n\nclass Person {\n  @nonenumerable\n  get kidCount() { return this.children.length; }\n}\n\nfunction nonenumerable(target, name, descriptor) {\n  descriptor.enumerable = false;\n  return descriptor;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ç@logè£é¥°å¨ï¼å¯ä»¥èµ·å°è¾åºæ¥å¿çä½ç¨ã\n\nclass Math {\n  @log\n  add(a, b) {\n    return a + b;\n  }\n}\n\nfunction log(target, name, descriptor) {\n  var oldValue = descriptor.value;\n\n  descriptor.value = function() {\n    console.log(`Calling ${name} with`, arguments);\n    return oldValue.apply(this, arguments);\n  };\n\n  return descriptor;\n}\n\nconst math = new Math();\n\n// passed parameters should get logged now\nmath.add(2, 4);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\nä¸é¢ä»£ç ä¸­ï¼@logè£é¥°å¨çä½ç¨å°±æ¯å¨æ§è¡åå§çæä½ä¹åï¼æ§è¡ä¸æ¬¡console.logï¼ä»èè¾¾å°è¾åºæ¥å¿çç®çã\n\nè£é¥°å¨ææ³¨éçä½ç¨ã\n\n@testable\nclass Person {\n  @readonly\n  @nonenumerable\n  name() { return `${this.first} ${this.last}` }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä»ä¸é¢ä»£ç ä¸­ï¼æä»¬ä¸ç¼å°±è½çåºï¼Personç±»æ¯å¯æµè¯çï¼ènameæ¹æ³æ¯åªè¯»åä¸å¯æä¸¾çã\n\nä¸é¢æ¯ä½¿ç¨ Decorator åæ³çç»ä»¶ï¼çä¸å»ä¸ç®äºç¶ã\n\n@Component({\n  tag: 'my-component',\n  styleUrl: 'my-component.scss'\n})\nexport class MyComponent {\n  @Prop() first: string;\n  @Prop() last: string;\n  @State() isVisible: boolean = true;\n\n  render() {\n    return (\n      <p>Hello, my name is {this.first} {this.last}</p>\n    );\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå¦æåä¸ä¸ªæ¹æ³æå¤ä¸ªè£é¥°å¨ï¼ä¼åå¥æ´è±ä¸æ ·ï¼åä»å¤å°åè¿å¥ï¼ç¶åç±ååå¤æ§è¡ã\n\nfunction dec(id){\n  console.log('evaluated', id);\n  return (target, property, descriptor) => console.log('executed', id);\n}\n\nclass Example {\n    @dec(1)\n    @dec(2)\n    method(){}\n}\n// evaluated 1\n// evaluated 2\n// executed 2\n// executed 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼å¤å±è£é¥°å¨@dec(1)åè¿å¥ï¼ä½æ¯åå±è£é¥°å¨@dec(2)åæ§è¡ã\n\né¤äºæ³¨éï¼è£é¥°å¨è¿è½ç¨æ¥ç±»åæ£æ¥ãæä»¥ï¼å¯¹äºç±»æ¥è¯´ï¼è¿é¡¹åè½ç¸å½æç¨ãä»é¿ææ¥çï¼å®å°æ¯ JavaScript ä»£ç éæåæçéè¦å·¥å·ã\n\n\n# ä¸ºä»ä¹è£é¥°å¨ä¸è½ç¨äºå½æ°ï¼\n\nè£é¥°å¨åªè½ç¨äºç±»åç±»çæ¹æ³ï¼ä¸è½ç¨äºå½æ°ï¼å ä¸ºå­å¨å½æ°æåã\n\nvar counter = 0;\n\nvar add = function () {\n  counter++;\n};\n\n@add\nfunction foo() {\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢çä»£ç ï¼æå¾æ¯æ§è¡åcounterç­äº 1ï¼ä½æ¯å®éä¸ç»ææ¯counterç­äº 0ãå ä¸ºå½æ°æåï¼ä½¿å¾å®éæ§è¡çä»£ç æ¯ä¸é¢è¿æ ·ã\n\n@add\nfunction foo() {\n}\n\nvar counter;\nvar add;\n\ncounter = 0;\n\nadd = function () {\n  counter++;\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nvar readOnly = require(\"some-decorator\");\n\n@readOnly\nfunction foo() {\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¹æé®é¢ï¼å ä¸ºå®éæ§è¡æ¯ä¸é¢è¿æ ·ã\n\nvar readOnly;\n\n@readOnly\nfunction foo() {\n}\n\nreadOnly = require(\"some-decorator\");\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næ»ä¹ï¼ç±äºå­å¨å½æ°æåï¼ä½¿å¾è£é¥°å¨ä¸è½ç¨äºå½æ°ãç±»æ¯ä¸ä¼æåçï¼æä»¥å°±æ²¡æè¿æ¹é¢çé®é¢ã\n\nå¦ä¸æ¹é¢ï¼å¦æä¸å®è¦è£é¥°å½æ°ï¼å¯ä»¥éç¨é«é¶å½æ°çå½¢å¼ç´æ¥æ§è¡ã\n\nfunction doSomething(name) {\n  console.log('Hello, ' + name);\n}\n\nfunction loggingDecorator(wrapped) {\n  return function() {\n    console.log('Starting');\n    const result = wrapped.apply(this, arguments);\n    console.log('Finished');\n    return result;\n  }\n}\n\nconst wrapped = loggingDecorator(doSomething);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# core-decorators.js\n\ncore-decorators.jsæ¯ä¸ä¸ªç¬¬ä¸æ¹æ¨¡åï¼æä¾äºå ä¸ªå¸¸è§çè£é¥°å¨ï¼éè¿å®å¯ä»¥æ´å¥½å°çè§£è£é¥°å¨ã\n\nï¼1ï¼@autobind\n\nautobindè£é¥°å¨ä½¿å¾æ¹æ³ä¸­çthiså¯¹è±¡ï¼ç»å®åå§å¯¹è±¡ã\n\nimport { autobind } from 'core-decorators';\n\nclass Person {\n  @autobind\n  getPerson() {\n    return this;\n  }\n}\n\nlet person = new Person();\nlet getPerson = person.getPerson;\n\ngetPerson() === person;\n// true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nï¼2ï¼@readonly\n\nreadonlyè£é¥°å¨ä½¿å¾å±æ§ææ¹æ³ä¸å¯åã\n\nimport { readonly } from 'core-decorators';\n\nclass Meal {\n  @readonly\n  entree = 'steak';\n}\n\nvar dinner = new Meal();\ndinner.entree = 'salmon';\n// Cannot assign to read only property 'entree' of [object Object]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nï¼3ï¼@override\n\noverrideè£é¥°å¨æ£æ¥å­ç±»çæ¹æ³ï¼æ¯å¦æ­£ç¡®è¦çäºç¶ç±»çååæ¹æ³ï¼å¦æä¸æ­£ç¡®ä¼æ¥éã\n\nimport { override } from 'core-decorators';\n\nclass Parent {\n  speak(first, second) {}\n}\n\nclass Child extends Parent {\n  @override\n  speak() {}\n  // SyntaxError: Child#speak() does not properly override Parent#speak(first, second)\n}\n\n// or\n\nclass Child extends Parent {\n  @override\n  speaks() {}\n  // SyntaxError: No descriptor matching Child#speaks() was found on the prototype chain.\n  //\n  //   Did you mean \"speak\"?\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nï¼4ï¼@deprecate (å«å@deprecated)\n\ndeprecateædeprecatedè£é¥°å¨å¨æ§å¶å°æ¾ç¤ºä¸æ¡è­¦åï¼è¡¨ç¤ºè¯¥æ¹æ³å°åºé¤ã\n\nimport { deprecate } from 'core-decorators';\n\nclass Person {\n  @deprecate\n  facepalm() {}\n\n  @deprecate('We stopped facepalming')\n  facepalmHard() {}\n\n  @deprecate('We stopped facepalming', { url: 'http://knowyourmeme.com/memes/facepalm' })\n  facepalmHarder() {}\n}\n\nlet person = new Person();\n\nperson.facepalm();\n// DEPRECATION Person#facepalm: This function will be removed in future versions.\n\nperson.facepalmHard();\n// DEPRECATION Person#facepalmHard: We stopped facepalming\n\nperson.facepalmHarder();\n// DEPRECATION Person#facepalmHarder: We stopped facepalming\n//\n//     See http://knowyourmeme.com/memes/facepalm for more details.\n//\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nï¼5ï¼@suppressWarnings\n\nsuppressWarningsè£é¥°å¨æå¶deprecatedè£é¥°å¨å¯¼è´çconsole.warn()è°ç¨ãä½æ¯ï¼å¼æ­¥ä»£ç ååºçè°ç¨é¤å¤ã\n\nimport { suppressWarnings } from 'core-decorators';\n\nclass Person {\n  @deprecated\n  facepalm() {}\n\n  @suppressWarnings\n  facepalmWithoutWarning() {\n    this.facepalm();\n  }\n}\n\nlet person = new Person();\n\nperson.facepalmWithoutWarning();\n// no warning is logged\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n# ä½¿ç¨è£é¥°å¨å®ç°èªå¨åå¸äºä»¶\n\næä»¬å¯ä»¥ä½¿ç¨è£é¥°å¨ï¼ä½¿å¾å¯¹è±¡çæ¹æ³è¢«è°ç¨æ¶ï¼èªå¨ååºä¸ä¸ªäºä»¶ã\n\nconst postal = require(\"postal/lib/postal.lodash\");\n\nexport default function publish(topic, channel) {\n  const channelName = channel || '/';\n  const msgChannel = postal.channel(channelName);\n  msgChannel.subscribe(topic, v => {\n    console.log('é¢é: ', channelName);\n    console.log('äºä»¶: ', topic);\n    console.log('æ°æ®: ', v);\n  });\n\n  return function(target, name, descriptor) {\n    const fn = descriptor.value;\n\n    descriptor.value = function() {\n      let value = fn.apply(this, arguments);\n      msgChannel.publish(topic, value);\n    };\n  };\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¸é¢ä»£ç å®ä¹äºä¸ä¸ªåä¸ºpublishçè£é¥°å¨ï¼å®éè¿æ¹ådescriptor.valueï¼ä½¿å¾åæ¹æ³è¢«è°ç¨æ¶ï¼ä¼èªå¨ååºä¸ä¸ªäºä»¶ãå®ä½¿ç¨çäºä»¶âåå¸/è®¢éâåºæ¯Postal.jsã\n\nå®çç¨æ³å¦ä¸ã\n\n// index.js\nimport publish from './publish';\n\nclass FooComponent {\n  @publish('foo.some.message', 'component')\n  someMethod() {\n    return { my: 'data' };\n  }\n  @publish('foo.some.other')\n  anotherMethod() {\n    // ...\n  }\n}\n\nlet foo = new FooComponent();\n\nfoo.someMethod();\nfoo.anotherMethod();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä»¥åï¼åªè¦è°ç¨someMethodæèanotherMethodï¼å°±ä¼èªå¨ååºä¸ä¸ªäºä»¶ã\n\n$ bash-node index.js\né¢é:  component\näºä»¶:  foo.some.message\næ°æ®:  { my: 'data' }\n\né¢é:  /\näºä»¶:  foo.some.other\næ°æ®:  undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# Mixin\n\nå¨è£é¥°å¨çåºç¡ä¸ï¼å¯ä»¥å®ç°Mixinæ¨¡å¼ãæè°Mixinæ¨¡å¼ï¼å°±æ¯å¯¹è±¡ç»§æ¿çä¸ç§æ¿ä»£æ¹æ¡ï¼ä¸­æè¯ä¸ºâæ··å¥âï¼mix inï¼ï¼æä¸ºå¨ä¸ä¸ªå¯¹è±¡ä¹ä¸­æ··å¥å¦å¤ä¸ä¸ªå¯¹è±¡çæ¹æ³ã\n\nè¯·çä¸é¢çä¾å­ã\n\nconst Foo = {\n  foo() { console.log('foo') }\n};\n\nclass MyClass {}\n\nObject.assign(MyClass.prototype, Foo);\n\nlet obj = new MyClass();\nobj.foo() // 'foo'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¹ä¸­ï¼å¯¹è±¡Fooæä¸ä¸ªfooæ¹æ³ï¼éè¿Object.assignæ¹æ³ï¼å¯ä»¥å°fooæ¹æ³âæ··å¥âMyClassç±»ï¼å¯¼è´MyClassçå®ä¾objå¯¹è±¡é½å·æfooæ¹æ³ãè¿å°±æ¯âæ··å¥âæ¨¡å¼çä¸ä¸ªç®åå®ç°ã\n\nä¸é¢ï¼æä»¬é¨ç½²ä¸ä¸ªéç¨èæ¬mixins.jsï¼å° Mixin åæä¸ä¸ªè£é¥°å¨ã\n\nexport function mixins(...list) {\n  return function (target) {\n    Object.assign(target.prototype, ...list);\n  };\n}\n\n\n1\n2\n3\n4\n5\n\n\nç¶åï¼å°±å¯ä»¥ä½¿ç¨ä¸é¢è¿ä¸ªè£é¥°å¨ï¼ä¸ºç±»âæ··å¥âåç§æ¹æ³ã\n\nimport { mixins } from './mixins';\n\nconst Foo = {\n  foo() { console.log('foo') }\n};\n\n@mixins(Foo)\nclass MyClass {}\n\nlet obj = new MyClass();\nobj.foo() // \"foo\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\néè¿mixinsè¿ä¸ªè£é¥°å¨ï¼å®ç°äºå¨MyClassç±»ä¸é¢âæ··å¥âFooå¯¹è±¡çfooæ¹æ³ã\n\nä¸è¿ï¼ä¸é¢çæ¹æ³ä¼æ¹åMyClassç±»çprototypeå¯¹è±¡ï¼å¦æä¸åæ¬¢è¿ä¸ç¹ï¼ä¹å¯ä»¥éè¿ç±»çç»§æ¿å®ç° Mixinã\n\nclass MyClass extends MyBaseClass {\n  /* ... */\n}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼MyClassç»§æ¿äºMyBaseClassãå¦ææä»¬æ³å¨MyClasséé¢âæ··å¥âä¸ä¸ªfooæ¹æ³ï¼ä¸ä¸ªåæ³æ¯å¨MyClassåMyBaseClassä¹é´æå¥ä¸ä¸ªæ··å¥ç±»ï¼è¿ä¸ªç±»å·æfooæ¹æ³ï¼å¹¶ä¸ç»§æ¿äºMyBaseClassçæææ¹æ³ï¼ç¶åMyClassåç»§æ¿è¿ä¸ªç±»ã\n\nlet MyMixin = (superclass) => class extends superclass {\n  foo() {\n    console.log('foo from MyMixin');\n  }\n};\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼MyMixinæ¯ä¸ä¸ªæ··å¥ç±»çæå¨ï¼æ¥åsuperclassä½ä¸ºåæ°ï¼ç¶åè¿åä¸ä¸ªç»§æ¿superclassçå­ç±»ï¼è¯¥å­ç±»åå«ä¸ä¸ªfooæ¹æ³ã\n\næ¥çï¼ç®æ ç±»åå»ç»§æ¿è¿ä¸ªæ··å¥ç±»ï¼å°±è¾¾å°äºâæ··å¥âfooæ¹æ³çç®çã\n\nclass MyClass extends MyMixin(MyBaseClass) {\n  /* ... */\n}\n\nlet c = new MyClass();\nc.foo(); // \"foo from MyMixin\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¦æéè¦âæ··å¥âå¤ä¸ªæ¹æ³ï¼å°±çæå¤ä¸ªæ··å¥ç±»ã\n\nclass MyClass extends Mixin1(Mixin2(MyBaseClass)) {\n  /* ... */\n}\n\n\n1\n2\n3\n\n\nè¿ç§åæ³çä¸ä¸ªå¥½å¤ï¼æ¯å¯ä»¥è°ç¨superï¼å æ­¤å¯ä»¥é¿åå¨âæ··å¥âè¿ç¨ä¸­è¦çç¶ç±»çååæ¹æ³ã\n\nlet Mixin1 = (superclass) => class extends superclass {\n  foo() {\n    console.log('foo from Mixin1');\n    if (super.foo) super.foo();\n  }\n};\n\nlet Mixin2 = (superclass) => class extends superclass {\n  foo() {\n    console.log('foo from Mixin2');\n    if (super.foo) super.foo();\n  }\n};\n\nclass S {\n  foo() {\n    console.log('foo from S');\n  }\n}\n\nclass C extends Mixin1(Mixin2(S)) {\n  foo() {\n    console.log('foo from C');\n    super.foo();\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¯ä¸æ¬¡æ··å¥åçæ¶ï¼é½è°ç¨äºç¶ç±»çsuper.fooæ¹æ³ï¼å¯¼è´ç¶ç±»çååæ¹æ³æ²¡æè¢«è¦çï¼è¡ä¸ºè¢«ä¿çäºä¸æ¥ã\n\nnew C().foo()\n// foo from C\n// foo from Mixin1\n// foo from Mixin2\n// foo from S\n\n\n1\n2\n3\n4\n5\n\n\n\n# Trait\n\nTrait ä¹æ¯ä¸ç§è£é¥°å¨ï¼ææä¸ Mixin ç±»ä¼¼ï¼ä½æ¯æä¾æ´å¤åè½ï¼æ¯å¦é²æ­¢ååæ¹æ³çå²çªãæé¤æ··å¥æäºæ¹æ³ãä¸ºæ··å¥çæ¹æ³èµ·å«åç­ç­ã\n\nä¸é¢éç¨traits-decoratorè¿ä¸ªç¬¬ä¸æ¹æ¨¡åä½ä¸ºä¾å­ãè¿ä¸ªæ¨¡åæä¾çtraitsè£é¥°å¨ï¼ä¸ä»å¯ä»¥æ¥åå¯¹è±¡ï¼è¿å¯ä»¥æ¥å ES6 ç±»ä½ä¸ºåæ°ã\n\nimport { traits } from 'traits-decorator';\n\nclass TFoo {\n  foo() { console.log('foo') }\n}\n\nconst TBar = {\n  bar() { console.log('bar') }\n};\n\n@traits(TFoo, TBar)\nclass MyClass { }\n\nlet obj = new MyClass();\nobj.foo() // foo\nobj.bar() // bar\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼éè¿traitsè£é¥°å¨ï¼å¨MyClassç±»ä¸é¢âæ··å¥âäºTFooç±»çfooæ¹æ³åTBarå¯¹è±¡çbaræ¹æ³ã\n\nTrait ä¸åè®¸âæ··å¥âååæ¹æ³ã\n\nimport { traits } from 'traits-decorator';\n\nclass TFoo {\n  foo() { console.log('foo') }\n}\n\nconst TBar = {\n  bar() { console.log('bar') },\n  foo() { console.log('foo') }\n};\n\n@traits(TFoo, TBar)\nclass MyClass { }\n// æ¥é\n// throw new Error('Method named: ' + methodName + ' is defined twice.');\n//        ^\n// Error: Method named: foo is defined twice.\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼TFooåTBaré½æfooæ¹æ³ï¼ç»ætraitsè£é¥°å¨æ¥éã\n\nä¸ç§è§£å³æ¹æ³æ¯æé¤TBarçfooæ¹æ³ã\n\nimport { traits, excludes } from 'traits-decorator';\n\nclass TFoo {\n  foo() { console.log('foo') }\n}\n\nconst TBar = {\n  bar() { console.log('bar') },\n  foo() { console.log('foo') }\n};\n\n@traits(TFoo, TBar::excludes('foo'))\nclass MyClass { }\n\nlet obj = new MyClass();\nobj.foo() // foo\nobj.bar() // bar\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä½¿ç¨ç»å®è¿ç®ç¬¦ï¼::ï¼å¨TBarä¸æé¤fooæ¹æ³ï¼æ··å¥æ¶å°±ä¸ä¼æ¥éäºã\n\nå¦ä¸ç§æ¹æ³æ¯ä¸ºTBarçfooæ¹æ³èµ·ä¸ä¸ªå«åã\n\nimport { traits, alias } from 'traits-decorator';\n\nclass TFoo {\n  foo() { console.log('foo') }\n}\n\nconst TBar = {\n  bar() { console.log('bar') },\n  foo() { console.log('foo') }\n};\n\n@traits(TFoo, TBar::alias({foo: 'aliasFoo'}))\nclass MyClass { }\n\nlet obj = new MyClass();\nobj.foo() // foo\nobj.aliasFoo() // foo\nobj.bar() // bar\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä¸é¢ä»£ç ä¸ºTBarçfooæ¹æ³èµ·äºå«åaliasFooï¼äºæ¯MyClassä¹å¯ä»¥æ··å¥TBarçfooæ¹æ³äºã\n\naliasåexcludesæ¹æ³ï¼å¯ä»¥ç»åèµ·æ¥ä½¿ç¨ã\n\n@traits(TExample::excludes('foo','bar')::alias({baz:'exampleBaz'}))\nclass MyClass {}\n\n\n1\n2\n\n\nä¸é¢ä»£ç æé¤äºTExampleçfooæ¹æ³åbaræ¹æ³ï¼ä¸ºbazæ¹æ³èµ·äºå«åexampleBazã\n\nasæ¹æ³åä¸ºä¸é¢çä»£ç æä¾äºå¦ä¸ç§åæ³ã\n\n@traits(TExample::as({excludes:['foo', 'bar'], alias: {baz: 'exampleBaz'}}))\nclass MyClass {}\n\n\n1\n2\n",normalizedContent:"# è£é¥°å¨\n\n[è¯´æ] decorator ææ¡ç»è¿äºå¤§å¹ä¿®æ¹ï¼ç®åè¿æ²¡æå®æ¡ï¼ä¸ç¥éè¯­æ³ä¼ä¸ä¼ååãä¸é¢çåå®¹å®å¨ä¾æ®ä»¥åçææ¡ï¼å·²ç»æç¹è¿æ¶äºãç­å¾å®æ¡ä»¥åï¼éè¦å®å¨éåã\n\nè£é¥°å¨ï¼decoratorï¼æ¯ä¸ç§ä¸ç±»ï¼classï¼ç¸å³çè¯­æ³ï¼ç¨æ¥æ³¨éæä¿®æ¹ç±»åç±»æ¹æ³ãè®¸å¤é¢åå¯¹è±¡çè¯­è¨é½æè¿é¡¹åè½ï¼ç®åæä¸ä¸ªææ¡å°å¶å¼å¥äº ecmascriptã è£é¥°å¨æ¯ä¸ç§å½æ°ï¼åæ@ + å½æ°åãå®å¯ä»¥æ¾å¨ç±»åç±»æ¹æ³çå®ä¹åé¢ã\n\n@frozen class foo {\n  @configurable(false)\n  @enumerable(true)\n  method() {}\n\n  @throttle(500)\n  expensivemethod() {}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸å±ä½¿ç¨äºåä¸ªè£é¥°å¨ï¼ä¸ä¸ªç¨å¨ç±»æ¬èº«ï¼å¦å¤ä¸ä¸ªç¨å¨ç±»æ¹æ³ãå®ä»¬ä¸ä»å¢å äºä»£ç çå¯è¯»æ§ï¼æ¸æ°å°è¡¨è¾¾äºæå¾ï¼èä¸æä¾ä¸ç§æ¹ä¾¿çææ®µï¼å¢å æä¿®æ¹ç±»çåè½ã\n\n\n# ç±»çè£é¥°\n\nè£é¥°å¨å¯ä»¥ç¨æ¥è£é¥°æ´ä¸ªç±»ã\n\n@testable\nclass mytestableclass {\n  // ...\n}\n\nfunction testable(target) {\n  target.istestable = true;\n}\n\nmytestableclass.istestable // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼@testableå°±æ¯ä¸ä¸ªè£é¥°å¨ãå®ä¿®æ¹äºmytestableclassè¿ä¸ªç±»çè¡ä¸ºï¼ä¸ºå®å ä¸äºéæå±æ§istestableãtestableå½æ°çåæ°targetæ¯mytestableclassç±»æ¬èº«ã\n\nåºæ¬ä¸ï¼è£é¥°å¨çè¡ä¸ºå°±æ¯ä¸é¢è¿æ ·ã\n\n@decorator\nclass a {}\n\n// ç­åäº\n\nclass a {}\na = decorator(a) || a;\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¹å°±æ¯è¯´ï¼è£é¥°å¨æ¯ä¸ä¸ªå¯¹ç±»è¿è¡å¤ççå½æ°ãè£é¥°å¨å½æ°çç¬¬ä¸ä¸ªåæ°ï¼å°±æ¯æè¦è£é¥°çç®æ ç±»ã\n\nfunction testable(target) {\n  // ...\n}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼testableå½æ°çåæ°targetï¼å°±æ¯ä¼è¢«è£é¥°çç±»ã\n\nå¦æè§å¾ä¸ä¸ªåæ°ä¸å¤ç¨ï¼å¯ä»¥å¨è£é¥°å¨å¤é¢åå°è£ä¸å±å½æ°ã\n\nfunction testable(istestable) {\n  return function(target) {\n    target.istestable = istestable;\n  }\n}\n\n@testable(true)\nclass mytestableclass {}\nmytestableclass.istestable // true\n\n@testable(false)\nclass myclass {}\nmyclass.istestable // false\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼è£é¥°å¨testableå¯ä»¥æ¥ååæ°ï¼è¿å°±ç­äºå¯ä»¥ä¿®æ¹è£é¥°å¨çè¡ä¸ºã\n\næ³¨æï¼è£é¥°å¨å¯¹ç±»çè¡ä¸ºçæ¹åï¼æ¯ä»£ç ç¼è¯æ¶åççï¼èä¸æ¯å¨è¿è¡æ¶ãè¿æå³çï¼è£é¥°å¨è½å¨ç¼è¯é¶æ®µè¿è¡ä»£ç ãä¹å°±æ¯è¯´ï¼è£é¥°å¨æ¬è´¨å°±æ¯ç¼è¯æ¶æ§è¡çå½æ°ã\n\nåé¢çä¾å­æ¯ä¸ºç±»æ·»å ä¸ä¸ªéæå±æ§ï¼å¦ææ³æ·»å å®ä¾å±æ§ï¼å¯ä»¥éè¿ç®æ ç±»çprototypeå¯¹è±¡æä½ã\n\nfunction testable(target) {\n  target.prototype.istestable = true;\n}\n\n@testable\nclass mytestableclass {}\n\nlet obj = new mytestableclass();\nobj.istestable // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼è£é¥°å¨å½æ°testableæ¯å¨ç®æ ç±»çprototypeå¯¹è±¡ä¸æ·»å å±æ§ï¼å æ­¤å°±å¯ä»¥å¨å®ä¾ä¸è°ç¨ã\n\nä¸é¢æ¯å¦å¤ä¸ä¸ªä¾å­ã\n\n// mixins.js\nexport function mixins(...list) {\n  return function (target) {\n    object.assign(target.prototype, ...list)\n  }\n}\n\n// main.js\nimport { mixins } from './mixins'\n\nconst foo = {\n  foo() { console.log('foo') }\n};\n\n@mixins(foo)\nclass myclass {}\n\nlet obj = new myclass();\nobj.foo() // 'foo'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nä¸é¢ä»£ç éè¿è£é¥°å¨mixinsï¼æfooå¯¹è±¡çæ¹æ³æ·»å å°äºmyclassçå®ä¾ä¸é¢ãå¯ä»¥ç¨object.assign()æ¨¡æè¿ä¸ªåè½ã\n\nconst foo = {\n  foo() { console.log('foo') }\n};\n\nclass myclass {}\n\nobject.assign(myclass.prototype, foo);\n\nlet obj = new myclass();\nobj.foo() // 'foo'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå®éå¼åä¸­ï¼react ä¸ redux åºç»åä½¿ç¨æ¶ï¼å¸¸å¸¸éè¦åæä¸é¢è¿æ ·ã\n\nclass myreactcomponent extends react.component {}\n\nexport default connect(mapstatetoprops, mapdispatchtoprops)(myreactcomponent);\n\n\n1\n2\n3\n\n\næäºè£é¥°å¨ï¼å°±å¯ä»¥æ¹åä¸é¢çä»£ç ã\n\n@connect(mapstatetoprops, mapdispatchtoprops)\nexport default class myreactcomponent extends react.component {}\n\n\n1\n2\n\n\nç¸å¯¹æ¥è¯´ï¼åä¸ç§åæ³çä¸å»æ´å®¹æçè§£ã\n\n\n# æ¹æ³çè£é¥°\n\nè£é¥°å¨ä¸ä»å¯ä»¥è£é¥°ç±»ï¼è¿å¯ä»¥è£é¥°ç±»çå±æ§ã\n\nclass person {\n  @readonly\n  name() { return `${this.first} ${this.last}` }\n}\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼è£é¥°å¨readonlyç¨æ¥è£é¥°âç±»âçnameæ¹æ³ã\n\nè£é¥°å¨å½æ°readonlyä¸å±å¯ä»¥æ¥åä¸ä¸ªåæ°ã\n\nfunction readonly(target, name, descriptor){\n  // descriptorå¯¹è±¡åæ¥çå¼å¦ä¸\n  // {\n  //   value: specifiedfunction,\n  //   enumerable: false,\n  //   configurable: true,\n  //   writable: true\n  // };\n  descriptor.writable = false;\n  return descriptor;\n}\n\nreadonly(person.prototype, 'name', descriptor);\n// ç±»ä¼¼äº\nobject.defineproperty(person.prototype, 'name', descriptor);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nè£é¥°å¨ç¬¬ä¸ä¸ªåæ°æ¯ç±»çååå¯¹è±¡ï¼ä¸ä¾æ¯person.prototypeï¼è£é¥°å¨çæ¬ææ¯è¦âè£é¥°âç±»çå®ä¾ï¼ä½æ¯è¿ä¸ªæ¶åå®ä¾è¿æ²¡çæï¼æä»¥åªè½å»è£é¥°ååï¼è¿ä¸åäºç±»çè£é¥°ï¼é£ç§æåµæ¶targetåæ°æçæ¯ç±»æ¬èº«ï¼ï¼ç¬¬äºä¸ªåæ°æ¯æè¦è£é¥°çå±æ§åï¼ç¬¬ä¸ä¸ªåæ°æ¯è¯¥å±æ§çæè¿°å¯¹è±¡ã\n\nå¦å¤ï¼ä¸é¢ä»£ç è¯´æï¼è£é¥°å¨ï¼readonlyï¼ä¼ä¿®æ¹å±æ§çæè¿°å¯¹è±¡ï¼descriptorï¼ï¼ç¶åè¢«ä¿®æ¹çæè¿°å¯¹è±¡åç¨æ¥å®ä¹å±æ§ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ï¼ä¿®æ¹å±æ§æè¿°å¯¹è±¡çenumerableå±æ§ï¼ä½¿å¾è¯¥å±æ§ä¸å¯éåã\n\nclass person {\n  @nonenumerable\n  get kidcount() { return this.children.length; }\n}\n\nfunction nonenumerable(target, name, descriptor) {\n  descriptor.enumerable = false;\n  return descriptor;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ç@logè£é¥°å¨ï¼å¯ä»¥èµ·å°è¾åºæ¥å¿çä½ç¨ã\n\nclass math {\n  @log\n  add(a, b) {\n    return a + b;\n  }\n}\n\nfunction log(target, name, descriptor) {\n  var oldvalue = descriptor.value;\n\n  descriptor.value = function() {\n    console.log(`calling ${name} with`, arguments);\n    return oldvalue.apply(this, arguments);\n  };\n\n  return descriptor;\n}\n\nconst math = new math();\n\n// passed parameters should get logged now\nmath.add(2, 4);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\nä¸é¢ä»£ç ä¸­ï¼@logè£é¥°å¨çä½ç¨å°±æ¯å¨æ§è¡åå§çæä½ä¹åï¼æ§è¡ä¸æ¬¡console.logï¼ä»èè¾¾å°è¾åºæ¥å¿çç®çã\n\nè£é¥°å¨ææ³¨éçä½ç¨ã\n\n@testable\nclass person {\n  @readonly\n  @nonenumerable\n  name() { return `${this.first} ${this.last}` }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä»ä¸é¢ä»£ç ä¸­ï¼æä»¬ä¸ç¼å°±è½çåºï¼personç±»æ¯å¯æµè¯çï¼ènameæ¹æ³æ¯åªè¯»åä¸å¯æä¸¾çã\n\nä¸é¢æ¯ä½¿ç¨ decorator åæ³çç»ä»¶ï¼çä¸å»ä¸ç®äºç¶ã\n\n@component({\n  tag: 'my-component',\n  styleurl: 'my-component.scss'\n})\nexport class mycomponent {\n  @prop() first: string;\n  @prop() last: string;\n  @state() isvisible: boolean = true;\n\n  render() {\n    return (\n      <p>hello, my name is {this.first} {this.last}</p>\n    );\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå¦æåä¸ä¸ªæ¹æ³æå¤ä¸ªè£é¥°å¨ï¼ä¼åå¥æ´è±ä¸æ ·ï¼åä»å¤å°åè¿å¥ï¼ç¶åç±ååå¤æ§è¡ã\n\nfunction dec(id){\n  console.log('evaluated', id);\n  return (target, property, descriptor) => console.log('executed', id);\n}\n\nclass example {\n    @dec(1)\n    @dec(2)\n    method(){}\n}\n// evaluated 1\n// evaluated 2\n// executed 2\n// executed 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼å¤å±è£é¥°å¨@dec(1)åè¿å¥ï¼ä½æ¯åå±è£é¥°å¨@dec(2)åæ§è¡ã\n\né¤äºæ³¨éï¼è£é¥°å¨è¿è½ç¨æ¥ç±»åæ£æ¥ãæä»¥ï¼å¯¹äºç±»æ¥è¯´ï¼è¿é¡¹åè½ç¸å½æç¨ãä»é¿ææ¥çï¼å®å°æ¯ javascript ä»£ç éæåæçéè¦å·¥å·ã\n\n\n# ä¸ºä»ä¹è£é¥°å¨ä¸è½ç¨äºå½æ°ï¼\n\nè£é¥°å¨åªè½ç¨äºç±»åç±»çæ¹æ³ï¼ä¸è½ç¨äºå½æ°ï¼å ä¸ºå­å¨å½æ°æåã\n\nvar counter = 0;\n\nvar add = function () {\n  counter++;\n};\n\n@add\nfunction foo() {\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢çä»£ç ï¼æå¾æ¯æ§è¡åcounterç­äº 1ï¼ä½æ¯å®éä¸ç»ææ¯counterç­äº 0ãå ä¸ºå½æ°æåï¼ä½¿å¾å®éæ§è¡çä»£ç æ¯ä¸é¢è¿æ ·ã\n\n@add\nfunction foo() {\n}\n\nvar counter;\nvar add;\n\ncounter = 0;\n\nadd = function () {\n  counter++;\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nvar readonly = require(\"some-decorator\");\n\n@readonly\nfunction foo() {\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¹æé®é¢ï¼å ä¸ºå®éæ§è¡æ¯ä¸é¢è¿æ ·ã\n\nvar readonly;\n\n@readonly\nfunction foo() {\n}\n\nreadonly = require(\"some-decorator\");\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\næ»ä¹ï¼ç±äºå­å¨å½æ°æåï¼ä½¿å¾è£é¥°å¨ä¸è½ç¨äºå½æ°ãç±»æ¯ä¸ä¼æåçï¼æä»¥å°±æ²¡æè¿æ¹é¢çé®é¢ã\n\nå¦ä¸æ¹é¢ï¼å¦æä¸å®è¦è£é¥°å½æ°ï¼å¯ä»¥éç¨é«é¶å½æ°çå½¢å¼ç´æ¥æ§è¡ã\n\nfunction dosomething(name) {\n  console.log('hello, ' + name);\n}\n\nfunction loggingdecorator(wrapped) {\n  return function() {\n    console.log('starting');\n    const result = wrapped.apply(this, arguments);\n    console.log('finished');\n    return result;\n  }\n}\n\nconst wrapped = loggingdecorator(dosomething);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# core-decorators.js\n\ncore-decorators.jsæ¯ä¸ä¸ªç¬¬ä¸æ¹æ¨¡åï¼æä¾äºå ä¸ªå¸¸è§çè£é¥°å¨ï¼éè¿å®å¯ä»¥æ´å¥½å°çè§£è£é¥°å¨ã\n\nï¼1ï¼@autobind\n\nautobindè£é¥°å¨ä½¿å¾æ¹æ³ä¸­çthiså¯¹è±¡ï¼ç»å®åå§å¯¹è±¡ã\n\nimport { autobind } from 'core-decorators';\n\nclass person {\n  @autobind\n  getperson() {\n    return this;\n  }\n}\n\nlet person = new person();\nlet getperson = person.getperson;\n\ngetperson() === person;\n// true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nï¼2ï¼@readonly\n\nreadonlyè£é¥°å¨ä½¿å¾å±æ§ææ¹æ³ä¸å¯åã\n\nimport { readonly } from 'core-decorators';\n\nclass meal {\n  @readonly\n  entree = 'steak';\n}\n\nvar dinner = new meal();\ndinner.entree = 'salmon';\n// cannot assign to read only property 'entree' of [object object]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nï¼3ï¼@override\n\noverrideè£é¥°å¨æ£æ¥å­ç±»çæ¹æ³ï¼æ¯å¦æ­£ç¡®è¦çäºç¶ç±»çååæ¹æ³ï¼å¦æä¸æ­£ç¡®ä¼æ¥éã\n\nimport { override } from 'core-decorators';\n\nclass parent {\n  speak(first, second) {}\n}\n\nclass child extends parent {\n  @override\n  speak() {}\n  // syntaxerror: child#speak() does not properly override parent#speak(first, second)\n}\n\n// or\n\nclass child extends parent {\n  @override\n  speaks() {}\n  // syntaxerror: no descriptor matching child#speaks() was found on the prototype chain.\n  //\n  //   did you mean \"speak\"?\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nï¼4ï¼@deprecate (å«å@deprecated)\n\ndeprecateædeprecatedè£é¥°å¨å¨æ§å¶å°æ¾ç¤ºä¸æ¡è­¦åï¼è¡¨ç¤ºè¯¥æ¹æ³å°åºé¤ã\n\nimport { deprecate } from 'core-decorators';\n\nclass person {\n  @deprecate\n  facepalm() {}\n\n  @deprecate('we stopped facepalming')\n  facepalmhard() {}\n\n  @deprecate('we stopped facepalming', { url: 'http://knowyourmeme.com/memes/facepalm' })\n  facepalmharder() {}\n}\n\nlet person = new person();\n\nperson.facepalm();\n// deprecation person#facepalm: this function will be removed in future versions.\n\nperson.facepalmhard();\n// deprecation person#facepalmhard: we stopped facepalming\n\nperson.facepalmharder();\n// deprecation person#facepalmharder: we stopped facepalming\n//\n//     see http://knowyourmeme.com/memes/facepalm for more details.\n//\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nï¼5ï¼@suppresswarnings\n\nsuppresswarningsè£é¥°å¨æå¶deprecatedè£é¥°å¨å¯¼è´çconsole.warn()è°ç¨ãä½æ¯ï¼å¼æ­¥ä»£ç ååºçè°ç¨é¤å¤ã\n\nimport { suppresswarnings } from 'core-decorators';\n\nclass person {\n  @deprecated\n  facepalm() {}\n\n  @suppresswarnings\n  facepalmwithoutwarning() {\n    this.facepalm();\n  }\n}\n\nlet person = new person();\n\nperson.facepalmwithoutwarning();\n// no warning is logged\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n# ä½¿ç¨è£é¥°å¨å®ç°èªå¨åå¸äºä»¶\n\næä»¬å¯ä»¥ä½¿ç¨è£é¥°å¨ï¼ä½¿å¾å¯¹è±¡çæ¹æ³è¢«è°ç¨æ¶ï¼èªå¨ååºä¸ä¸ªäºä»¶ã\n\nconst postal = require(\"postal/lib/postal.lodash\");\n\nexport default function publish(topic, channel) {\n  const channelname = channel || '/';\n  const msgchannel = postal.channel(channelname);\n  msgchannel.subscribe(topic, v => {\n    console.log('é¢é: ', channelname);\n    console.log('äºä»¶: ', topic);\n    console.log('æ°æ®: ', v);\n  });\n\n  return function(target, name, descriptor) {\n    const fn = descriptor.value;\n\n    descriptor.value = function() {\n      let value = fn.apply(this, arguments);\n      msgchannel.publish(topic, value);\n    };\n  };\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¸é¢ä»£ç å®ä¹äºä¸ä¸ªåä¸ºpublishçè£é¥°å¨ï¼å®éè¿æ¹ådescriptor.valueï¼ä½¿å¾åæ¹æ³è¢«è°ç¨æ¶ï¼ä¼èªå¨ååºä¸ä¸ªäºä»¶ãå®ä½¿ç¨çäºä»¶âåå¸/è®¢éâåºæ¯postal.jsã\n\nå®çç¨æ³å¦ä¸ã\n\n// index.js\nimport publish from './publish';\n\nclass foocomponent {\n  @publish('foo.some.message', 'component')\n  somemethod() {\n    return { my: 'data' };\n  }\n  @publish('foo.some.other')\n  anothermethod() {\n    // ...\n  }\n}\n\nlet foo = new foocomponent();\n\nfoo.somemethod();\nfoo.anothermethod();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä»¥åï¼åªè¦è°ç¨somemethodæèanothermethodï¼å°±ä¼èªå¨ååºä¸ä¸ªäºä»¶ã\n\n$ bash-node index.js\né¢é:  component\näºä»¶:  foo.some.message\næ°æ®:  { my: 'data' }\n\né¢é:  /\näºä»¶:  foo.some.other\næ°æ®:  undefined\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# mixin\n\nå¨è£é¥°å¨çåºç¡ä¸ï¼å¯ä»¥å®ç°mixinæ¨¡å¼ãæè°mixinæ¨¡å¼ï¼å°±æ¯å¯¹è±¡ç»§æ¿çä¸ç§æ¿ä»£æ¹æ¡ï¼ä¸­æè¯ä¸ºâæ··å¥âï¼mix inï¼ï¼æä¸ºå¨ä¸ä¸ªå¯¹è±¡ä¹ä¸­æ··å¥å¦å¤ä¸ä¸ªå¯¹è±¡çæ¹æ³ã\n\nè¯·çä¸é¢çä¾å­ã\n\nconst foo = {\n  foo() { console.log('foo') }\n};\n\nclass myclass {}\n\nobject.assign(myclass.prototype, foo);\n\nlet obj = new myclass();\nobj.foo() // 'foo'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¹ä¸­ï¼å¯¹è±¡fooæä¸ä¸ªfooæ¹æ³ï¼éè¿object.assignæ¹æ³ï¼å¯ä»¥å°fooæ¹æ³âæ··å¥âmyclassç±»ï¼å¯¼è´myclassçå®ä¾objå¯¹è±¡é½å·æfooæ¹æ³ãè¿å°±æ¯âæ··å¥âæ¨¡å¼çä¸ä¸ªç®åå®ç°ã\n\nä¸é¢ï¼æä»¬é¨ç½²ä¸ä¸ªéç¨èæ¬mixins.jsï¼å° mixin åæä¸ä¸ªè£é¥°å¨ã\n\nexport function mixins(...list) {\n  return function (target) {\n    object.assign(target.prototype, ...list);\n  };\n}\n\n\n1\n2\n3\n4\n5\n\n\nç¶åï¼å°±å¯ä»¥ä½¿ç¨ä¸é¢è¿ä¸ªè£é¥°å¨ï¼ä¸ºç±»âæ··å¥âåç§æ¹æ³ã\n\nimport { mixins } from './mixins';\n\nconst foo = {\n  foo() { console.log('foo') }\n};\n\n@mixins(foo)\nclass myclass {}\n\nlet obj = new myclass();\nobj.foo() // \"foo\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\néè¿mixinsè¿ä¸ªè£é¥°å¨ï¼å®ç°äºå¨myclassç±»ä¸é¢âæ··å¥âfooå¯¹è±¡çfooæ¹æ³ã\n\nä¸è¿ï¼ä¸é¢çæ¹æ³ä¼æ¹åmyclassç±»çprototypeå¯¹è±¡ï¼å¦æä¸åæ¬¢è¿ä¸ç¹ï¼ä¹å¯ä»¥éè¿ç±»çç»§æ¿å®ç° mixinã\n\nclass myclass extends mybaseclass {\n  /* ... */\n}\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼myclassç»§æ¿äºmybaseclassãå¦ææä»¬æ³å¨myclasséé¢âæ··å¥âä¸ä¸ªfooæ¹æ³ï¼ä¸ä¸ªåæ³æ¯å¨myclassåmybaseclassä¹é´æå¥ä¸ä¸ªæ··å¥ç±»ï¼è¿ä¸ªç±»å·æfooæ¹æ³ï¼å¹¶ä¸ç»§æ¿äºmybaseclassçæææ¹æ³ï¼ç¶åmyclassåç»§æ¿è¿ä¸ªç±»ã\n\nlet mymixin = (superclass) => class extends superclass {\n  foo() {\n    console.log('foo from mymixin');\n  }\n};\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼mymixinæ¯ä¸ä¸ªæ··å¥ç±»çæå¨ï¼æ¥åsuperclassä½ä¸ºåæ°ï¼ç¶åè¿åä¸ä¸ªç»§æ¿superclassçå­ç±»ï¼è¯¥å­ç±»åå«ä¸ä¸ªfooæ¹æ³ã\n\næ¥çï¼ç®æ ç±»åå»ç»§æ¿è¿ä¸ªæ··å¥ç±»ï¼å°±è¾¾å°äºâæ··å¥âfooæ¹æ³çç®çã\n\nclass myclass extends mymixin(mybaseclass) {\n  /* ... */\n}\n\nlet c = new myclass();\nc.foo(); // \"foo from mymixin\"\n\n\n1\n2\n3\n4\n5\n6\n\n\nå¦æéè¦âæ··å¥âå¤ä¸ªæ¹æ³ï¼å°±çæå¤ä¸ªæ··å¥ç±»ã\n\nclass myclass extends mixin1(mixin2(mybaseclass)) {\n  /* ... */\n}\n\n\n1\n2\n3\n\n\nè¿ç§åæ³çä¸ä¸ªå¥½å¤ï¼æ¯å¯ä»¥è°ç¨superï¼å æ­¤å¯ä»¥é¿åå¨âæ··å¥âè¿ç¨ä¸­è¦çç¶ç±»çååæ¹æ³ã\n\nlet mixin1 = (superclass) => class extends superclass {\n  foo() {\n    console.log('foo from mixin1');\n    if (super.foo) super.foo();\n  }\n};\n\nlet mixin2 = (superclass) => class extends superclass {\n  foo() {\n    console.log('foo from mixin2');\n    if (super.foo) super.foo();\n  }\n};\n\nclass s {\n  foo() {\n    console.log('foo from s');\n  }\n}\n\nclass c extends mixin1(mixin2(s)) {\n  foo() {\n    console.log('foo from c');\n    super.foo();\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nä¸é¢ä»£ç ä¸­ï¼æ¯ä¸æ¬¡æ··å¥åçæ¶ï¼é½è°ç¨äºç¶ç±»çsuper.fooæ¹æ³ï¼å¯¼è´ç¶ç±»çååæ¹æ³æ²¡æè¢«è¦çï¼è¡ä¸ºè¢«ä¿çäºä¸æ¥ã\n\nnew c().foo()\n// foo from c\n// foo from mixin1\n// foo from mixin2\n// foo from s\n\n\n1\n2\n3\n4\n5\n\n\n\n# trait\n\ntrait ä¹æ¯ä¸ç§è£é¥°å¨ï¼ææä¸ mixin ç±»ä¼¼ï¼ä½æ¯æä¾æ´å¤åè½ï¼æ¯å¦é²æ­¢ååæ¹æ³çå²çªãæé¤æ··å¥æäºæ¹æ³ãä¸ºæ··å¥çæ¹æ³èµ·å«åç­ç­ã\n\nä¸é¢éç¨traits-decoratorè¿ä¸ªç¬¬ä¸æ¹æ¨¡åä½ä¸ºä¾å­ãè¿ä¸ªæ¨¡åæä¾çtraitsè£é¥°å¨ï¼ä¸ä»å¯ä»¥æ¥åå¯¹è±¡ï¼è¿å¯ä»¥æ¥å es6 ç±»ä½ä¸ºåæ°ã\n\nimport { traits } from 'traits-decorator';\n\nclass tfoo {\n  foo() { console.log('foo') }\n}\n\nconst tbar = {\n  bar() { console.log('bar') }\n};\n\n@traits(tfoo, tbar)\nclass myclass { }\n\nlet obj = new myclass();\nobj.foo() // foo\nobj.bar() // bar\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼éè¿traitsè£é¥°å¨ï¼å¨myclassç±»ä¸é¢âæ··å¥âäºtfooç±»çfooæ¹æ³åtbarå¯¹è±¡çbaræ¹æ³ã\n\ntrait ä¸åè®¸âæ··å¥âååæ¹æ³ã\n\nimport { traits } from 'traits-decorator';\n\nclass tfoo {\n  foo() { console.log('foo') }\n}\n\nconst tbar = {\n  bar() { console.log('bar') },\n  foo() { console.log('foo') }\n};\n\n@traits(tfoo, tbar)\nclass myclass { }\n// æ¥é\n// throw new error('method named: ' + methodname + ' is defined twice.');\n//        ^\n// error: method named: foo is defined twice.\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼tfooåtbaré½æfooæ¹æ³ï¼ç»ætraitsè£é¥°å¨æ¥éã\n\nä¸ç§è§£å³æ¹æ³æ¯æé¤tbarçfooæ¹æ³ã\n\nimport { traits, excludes } from 'traits-decorator';\n\nclass tfoo {\n  foo() { console.log('foo') }\n}\n\nconst tbar = {\n  bar() { console.log('bar') },\n  foo() { console.log('foo') }\n};\n\n@traits(tfoo, tbar::excludes('foo'))\nclass myclass { }\n\nlet obj = new myclass();\nobj.foo() // foo\nobj.bar() // bar\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä½¿ç¨ç»å®è¿ç®ç¬¦ï¼::ï¼å¨tbarä¸æé¤fooæ¹æ³ï¼æ··å¥æ¶å°±ä¸ä¼æ¥éäºã\n\nå¦ä¸ç§æ¹æ³æ¯ä¸ºtbarçfooæ¹æ³èµ·ä¸ä¸ªå«åã\n\nimport { traits, alias } from 'traits-decorator';\n\nclass tfoo {\n  foo() { console.log('foo') }\n}\n\nconst tbar = {\n  bar() { console.log('bar') },\n  foo() { console.log('foo') }\n};\n\n@traits(tfoo, tbar::alias({foo: 'aliasfoo'}))\nclass myclass { }\n\nlet obj = new myclass();\nobj.foo() // foo\nobj.aliasfoo() // foo\nobj.bar() // bar\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä¸é¢ä»£ç ä¸ºtbarçfooæ¹æ³èµ·äºå«åaliasfooï¼äºæ¯myclassä¹å¯ä»¥æ··å¥tbarçfooæ¹æ³äºã\n\naliasåexcludesæ¹æ³ï¼å¯ä»¥ç»åèµ·æ¥ä½¿ç¨ã\n\n@traits(texample::excludes('foo','bar')::alias({baz:'examplebaz'}))\nclass myclass {}\n\n\n1\n2\n\n\nä¸é¢ä»£ç æé¤äºtexampleçfooæ¹æ³åbaræ¹æ³ï¼ä¸ºbazæ¹æ³èµ·äºå«åexamplebazã\n\nasæ¹æ³åä¸ºä¸é¢çä»£ç æä¾äºå¦ä¸ç§åæ³ã\n\n@traits(texample::as({excludes:['foo', 'bar'], alias: {baz: 'examplebaz'}}))\nclass myclass {}\n\n\n1\n2\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"è¯»æ ECMAScript è§æ ¼",frontmatter:{title:"è¯»æ ECMAScript è§æ ¼",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/32c35f7651d6e58e",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/26.%E8%AF%BB%E6%87%82%20ECMAScript%20%E8%A7%84%E6%A0%BC.html",relativePath:"ãES6 æç¨ãç¬è®°/26.è¯»æ ECMAScript è§æ ¼.md",key:"v-4248c6f3",path:"/pages/32c35f7651d6e58e/",headers:[{level:2,title:"æ¦è¿°",slug:"æ¦è¿°",normalizedTitle:"æ¦è¿°",charIndex:23},{level:2,title:"æ¯è¯­",slug:"æ¯è¯­",normalizedTitle:"æ¯è¯­",charIndex:819},{level:3,title:"æ½è±¡æä½",slug:"æ½è±¡æä½",normalizedTitle:"æ½è±¡æä½",charIndex:718},{level:3,title:"Record å field",slug:"record-å-field",normalizedTitle:"record å field",charIndex:1122},{level:3,title:"[[Notation]]",slug:"notation",normalizedTitle:"[[notation]]",charIndex:1264},{level:3,title:"Completion Record",slug:"completion-record",normalizedTitle:"completion record",charIndex:1668},{level:2,title:"æ½è±¡æä½çæ åæµç¨",slug:"æ½è±¡æä½çæ åæµç¨",normalizedTitle:"æ½è±¡æä½çæ åæµç¨",charIndex:2e3},{level:2,title:"ç¸ç­è¿ç®ç¬¦",slug:"ç¸ç­è¿ç®ç¬¦",normalizedTitle:"ç¸ç­è¿ç®ç¬¦",charIndex:2930},{level:2,title:"æ°ç»çç©ºä½",slug:"æ°ç»çç©ºä½",normalizedTitle:"æ°ç»çç©ºä½",charIndex:4941},{level:2,title:"æ°ç»ç map æ¹æ³",slug:"æ°ç»ç-map-æ¹æ³",normalizedTitle:"æ°ç»ç map æ¹æ³",charIndex:6543}],excerpt:'<h1 id="è¯»æ-ecmascript-è§æ ¼"><a class="header-anchor" href="#è¯»æ-ecmascript-è§æ ¼">#</a> è¯»æ ECMAScript è§æ ¼</h1>\n<h2 id="æ¦è¿°"><a class="header-anchor" href="#æ¦è¿°">#</a> æ¦è¿°</h2>\n<p>è§æ ¼æä»¶æ¯è®¡ç®æºè¯­è¨çå®æ¹æ åï¼è¯¦ç»æè¿°è¯­æ³è§ååå®ç°æ¹æ³ã</p>\n<p>ä¸è¬æ¥è¯´ï¼æ²¡æå¿è¦éè¯»è§æ ¼ï¼é¤éä½ è¦åç¼è¯å¨ãå ä¸ºè§æ ¼åå¾éå¸¸æ½è±¡åç²¾ç¼ï¼åç¼ºä¹å®ä¾ï¼ä¸å®¹æçè§£ï¼èä¸å¯¹äºè§£å³å®éçåºç¨é®é¢ï¼å¸®å©ä¸å¤§ãä½æ¯ï¼å¦æä½ éå°çé¾çè¯­æ³é®é¢ï¼å®å¨æ¾ä¸å°ç­æ¡ï¼è¿æ¶å¯ä»¥å»æ¥çè§æ ¼æä»¶ï¼äºè§£è¯­è¨æ åæ¯æä¹è¯´çãè§æ ¼æ¯è§£å³é®é¢çâæåä¸æâã</p>\n',headersStr:"æ¦è¿° æ¯è¯­ æ½è±¡æä½ Record å field [[Notation]] Completion Record æ½è±¡æä½çæ åæµç¨ ç¸ç­è¿ç®ç¬¦ æ°ç»çç©ºä½ æ°ç»ç map æ¹æ³",content:'# è¯»æ ECMAScript è§æ ¼\n\n\n# æ¦è¿°\n\nè§æ ¼æä»¶æ¯è®¡ç®æºè¯­è¨çå®æ¹æ åï¼è¯¦ç»æè¿°è¯­æ³è§ååå®ç°æ¹æ³ã\n\nä¸è¬æ¥è¯´ï¼æ²¡æå¿è¦éè¯»è§æ ¼ï¼é¤éä½ è¦åç¼è¯å¨ãå ä¸ºè§æ ¼åå¾éå¸¸æ½è±¡åç²¾ç¼ï¼åç¼ºä¹å®ä¾ï¼ä¸å®¹æçè§£ï¼èä¸å¯¹äºè§£å³å®éçåºç¨é®é¢ï¼å¸®å©ä¸å¤§ãä½æ¯ï¼å¦æä½ éå°çé¾çè¯­æ³é®é¢ï¼å®å¨æ¾ä¸å°ç­æ¡ï¼è¿æ¶å¯ä»¥å»æ¥çè§æ ¼æä»¶ï¼äºè§£è¯­è¨æ åæ¯æä¹è¯´çãè§æ ¼æ¯è§£å³é®é¢çâæåä¸æâã è¿å¯¹ JavaScript è¯­è¨å¾æå¿è¦ãå ä¸ºå®çä½¿ç¨åºæ¯å¤æï¼è¯­æ³è§åä¸ç»ä¸ï¼ä¾å¤å¾å¤ï¼åç§è¿è¡ç¯å¢çè¡ä¸ºä¸ä¸è´ï¼å¯¼è´å¥æªçè¯­æ³é®é¢å±åºä¸ç©·ï¼ä»»ä½è¯­æ³ä¹¦é½ä¸å¯è½åæ¬æææåµãæ¥çè§æ ¼ï¼ä¸å¤±ä¸ºä¸ç§è§£å³è¯­æ³é®é¢çæå¯é ãææå¨çç»ææ¹æ³ã\n\næ¬ç« ä»ç»å¦ä½è¯»æ ECMAScript 6 çè§æ ¼æä»¶ã\n\nECMAScript 6 çè§æ ¼ï¼å¯ä»¥å¨ ECMA å½éæ åç»ç»çå®æ¹ç½ç«ï¼www.ecma-international.org/ecma-262/6.0/ï¼åè´¹ä¸è½½åå¨çº¿éè¯»ã\n\nè¿ä¸ªè§æ ¼æä»¶ç¸å½åºå¤§ï¼ä¸å±æ 26 ç« ï¼A4 æå°çè¯ï¼è¶³è¶³æ 545 é¡µãå®çç¹ç¹å°±æ¯è§å®å¾éå¸¸ç»è´ï¼æ¯ä¸ä¸ªè¯­æ³è¡ä¸ºãæ¯ä¸ä¸ªå½æ°çå®ç°é½åäºè¯¦å°½çæ¸æ°çæè¿°ãåºæ¬ä¸ï¼ç¼è¯å¨ä½èåªè¦ææ¯ä¸æ­¥ç¿»è¯æä»£ç å°±å¯ä»¥äºãè¿å¾å¤§ç¨åº¦ä¸ï¼ä¿è¯äºææ ES6 å®ç°é½æä¸è´çè¡ä¸ºã\n\nECMAScript 6 è§æ ¼ç 26 ç« ä¹ä¸­ï¼ç¬¬ 1 ç« å°ç¬¬ 3 ç« æ¯å¯¹æä»¶æ¬èº«çä»ç»ï¼ä¸è¯­è¨å³ç³»ä¸å¤§ãç¬¬ 4 ç« æ¯å¯¹è¿é¨è¯­è¨æ»ä½è®¾è®¡çæè¿°ï¼æå´è¶£çè¯»èå¯ä»¥è¯»ä¸ä¸ãç¬¬ 5 ç« å°ç¬¬ 8 ç« æ¯è¯­è¨å®è§å±é¢çæè¿°ãç¬¬ 5 ç« æ¯è§æ ¼çåè¯è§£éååæ³çä»ç»ï¼ç¬¬ 6 ç« ä»ç»æ°æ®ç±»åï¼ç¬¬ 7 ç« ä»ç»è¯­è¨åé¨ç¨å°çæ½è±¡æä½ï¼ç¬¬ 8 ç« ä»ç»ä»£ç å¦ä½è¿è¡ãç¬¬ 9 ç« å°ç¬¬ 26 ç« ä»ç»å·ä½çè¯­æ³ã\n\nå¯¹äºä¸è¬ç¨æ·æ¥è¯´ï¼é¤äºç¬¬ 4 ç« ï¼å¶ä»ç« èé½æ¶åæä¸æ¹é¢çç»èï¼ä¸ç¨éè¯»ï¼åªè¦å¨ç¨å°çæ¶åï¼æ¥éç¸å³ç« èå³å¯ã\n\n\n# æ¯è¯­\n\nES6 è§æ ¼ä½¿ç¨äºä¸äºä¸é¨çæ¯è¯­ï¼äºè§£è¿äºæ¯è¯­ï¼å¯ä»¥å¸®å©ä½ è¯»æè§æ ¼ãæ¬èä»ç»å¶ä¸­çå ä¸ªã\n\n\n# æ½è±¡æä½\n\næè°âæ½è±¡æä½âï¼abstract operationsï¼å°±æ¯å¼æçä¸äºåé¨æ¹æ³ï¼å¤é¨ä¸è½è°ç¨ãè§æ ¼å®ä¹äºä¸ç³»åçæ½è±¡æä½ï¼è§å®äºå®ä»¬çè¡ä¸ºï¼çç»åç§å¼æèªå·±å»å®ç°ã\n\nä¸¾ä¾æ¥è¯´ï¼Boolean(value)çç®æ³ï¼ç¬¬ä¸æ­¥æ¯è¿æ ·çã\n\n>  1. Let b be ToBoolean(value).\n\nè¿éçToBooleanå°±æ¯ä¸ä¸ªæ½è±¡æä½ï¼æ¯å¼æåé¨æ±åºå¸å°å¼çç®æ³ã\n\nè®¸å¤å½æ°çç®æ³é½ä¼å¤æ¬¡ç¨å°åæ ·çæ­¥éª¤ï¼æä»¥ ES6 è§æ ¼å°å®ä»¬æ½åºæ¥ï¼å®ä¹æâæ½è±¡æä½âï¼æ¹ä¾¿æè¿°ã\n\n\n# Record å field\n\nES6 è§æ ¼å°é®å¼å¯¹ï¼key-value mapï¼çæ°æ®ç»æç§°ä¸º Recordï¼å¶ä¸­çæ¯ä¸ç»é®å¼å¯¹ç§°ä¸º fieldãè¿å°±æ¯è¯´ï¼ä¸ä¸ª Record ç±å¤ä¸ª field ç»æï¼èæ¯ä¸ª field é½åå«ä¸ä¸ªé®åï¼keyï¼åä¸ä¸ªé®å¼ï¼valueï¼ã\n\n\n# [[Notation]]\n\nES6 è§æ ¼å¤§éä½¿ç¨[[Notation]]è¿ç§ä¹¦åæ³ï¼æ¯å¦[[Value]]ã[[Writable]]ã[[Get]]ã[[Set]]ç­ç­ãå®ç¨æ¥æä»£ field çé®åã\n\nä¸¾ä¾æ¥è¯´ï¼objæ¯ä¸ä¸ª Recordï¼å®æä¸ä¸ªPrototypeå±æ§ãES6 è§æ ¼ä¸ä¼åobj.Prototypeï¼èæ¯åobj.[[Prototype]]ãä¸è¬æ¥è¯´ï¼ä½¿ç¨[[Notation]]è¿ç§ä¹¦åæ³çå±æ§ï¼é½æ¯å¯¹è±¡çåé¨å±æ§ã\n\nææç JavaScript å½æ°é½æä¸ä¸ªåé¨å±æ§[[Call]]ï¼ç¨æ¥è¿è¡è¯¥å½æ°ã\n\nF.[[Call]](V, argumentsList)\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼Fæ¯ä¸ä¸ªå½æ°å¯¹è±¡ï¼[[Call]]æ¯å®çåé¨æ¹æ³ï¼F.[[call]]()è¡¨ç¤ºè¿è¡è¯¥å½æ°ï¼Vè¡¨ç¤º[[Call]]è¿è¡æ¶thisçå¼ï¼argumentsListåæ¯è°ç¨æ¶ä¼ å¥å½æ°çåæ°ã\n\n\n# Completion Record\n\næ¯ä¸ä¸ªè¯­å¥é½ä¼è¿åä¸ä¸ª Completion Recordï¼è¡¨ç¤ºè¿è¡ç»æãæ¯ä¸ª Completion Record æä¸ä¸ª[[Type]]å±æ§ï¼è¡¨ç¤ºè¿è¡ç»æçç±»åã\n\n[[Type]]å±æ§æäºç§å¯è½çå¼ã\n\n * normal\n * return\n * throw\n * break\n * continue\n\nå¦æ[[Type]]çå¼æ¯normalï¼å°±ç§°ä¸º normal completionï¼è¡¨ç¤ºè¿è¡æ­£å¸¸ãå¶ä»çå¼ï¼é½ç§°ä¸º abrupt completionãå¶ä¸­ï¼å¼åèåªéè¦å³æ³¨[[Type]]ä¸ºthrowçæåµï¼å³è¿è¡åºéï¼breakãcontinueãreturnè¿ä¸ä¸ªå¼é½åªåºç°å¨ç¹å®åºæ¯ï¼å¯ä»¥ä¸ç¨èèã\n\n\n# æ½è±¡æä½çæ åæµç¨\n\næ½è±¡æä½çè¿è¡æµç¨ï¼ä¸è¬æ¯ä¸é¢è¿æ ·ã\n\n>  1. Let resultCompletionRecord be AbstractOp().\n>  2. If resultCompletionRecord is an abrupt completion, return resultCompletionRecord.\n>  3. Let result be resultCompletionRecord.[[Value]].\n>  4. return result.\n\nä¸é¢çç¬¬ä¸æ­¥æ¯è°ç¨æ½è±¡æä½AbstractOp()ï¼å¾å°resultCompletionRecordï¼è¿æ¯ä¸ä¸ª Completion Recordãç¬¬äºæ­¥ï¼å¦æè¿ä¸ª Record å±äº abrupt completionï¼å°±å°resultCompletionRecordè¿åç»ç¨æ·ãå¦ææ­¤å¤æ²¡æè¿åï¼å°±è¡¨ç¤ºè¿è¡ç»ææ­£å¸¸ï¼æå¾çå¼å­æ¾å¨resultCompletionRecord.[[Value]]å±æ§ãç¬¬ä¸æ­¥ï¼å°è¿ä¸ªå¼è®°ä¸ºresultãç¬¬åæ­¥ï¼å°resultè¿åç»ç¨æ·ã\n\nES6 è§æ ¼å°è¿ä¸ªæ åæµç¨ï¼ä½¿ç¨ç®åçæ¹å¼è¡¨è¾¾ã\n\n>  1. Let result be AbstractOp().\n>  2. ReturnIfAbrupt(result).\n>  3. return result.\n\nè¿ä¸ªç®åæ¹å¼éé¢çReturnIfAbrupt(result)ï¼å°±ä»£è¡¨äºä¸é¢çç¬¬äºæ­¥åç¬¬ä¸æ­¥ï¼å³å¦æææ¥éï¼å°±è¿åéè¯¯ï¼å¦åååºå¼ã\n\nçè³è¿æè¿ä¸æ­¥çç®åæ ¼å¼ã\n\n>  1. Let result be ? AbstractOp().\n>  2. return result.\n\nä¸é¢æµç¨ç?ï¼å°±ä»£è¡¨AbstractOp()å¯è½ä¼æ¥éãä¸æ¦æ¥éï¼å°±è¿åéè¯¯ï¼å¦åååºå¼ã\n\né¤äº?ï¼ES 6 è§æ ¼è¿ä½¿ç¨å¦ä¸ä¸ªç®åç¬¦å·!ã\n\n>  1. Let result be ! AbstractOp().\n>  2. return result.\n\nä¸é¢æµç¨ç!ï¼ä»£è¡¨AbstractOp()ä¸ä¼æ¥éï¼è¿åçä¸å®æ¯ normal completionï¼æ»æ¯å¯ä»¥ååºå¼ã\n\n\n# ç¸ç­è¿ç®ç¬¦\n\nä¸é¢éè¿ä¸äºä¾å­ï¼ä»ç»å¦ä½ä½¿ç¨è¿ä»½è§æ ¼ã\n\nç¸ç­è¿ç®ç¬¦ï¼==ï¼æ¯ä¸ä¸ªå¾è®©äººå¤´ççè¿ç®ç¬¦ï¼å®çè¯­æ³è¡ä¸ºå¤åï¼ä¸ç¬¦åç´è§ãè¿ä¸ªå°èå°±ççè§æ ¼æä¹è§å®å®çè¡ä¸ºã\n\nè¯·çä¸é¢è¿ä¸ªè¡¨è¾¾å¼ï¼è¯·é®å®çå¼æ¯å¤å°ã\n\n0 == null\n\n\n1\n\n\nå¦æä½ ä¸ç¡®å®ç­æ¡ï¼æèæ³ç¥éè¯­è¨åé¨æä¹å¤çï¼å°±å¯ä»¥å»æ¥çè§æ ¼ï¼7.2.12 å°èæ¯å¯¹ç¸ç­è¿ç®ç¬¦ï¼==ï¼çæè¿°ã\n\nè§æ ¼å¯¹æ¯ä¸ç§è¯­æ³è¡ä¸ºçæè¿°ï¼é½åæä¸¤é¨åï¼åæ¯æ»ä½çè¡ä¸ºæè¿°ï¼ç¶åæ¯å®ç°çç®æ³ç»èãç¸ç­è¿ç®ç¬¦çæ»ä½æè¿°ï¼åªæä¸å¥è¯ã\n\n> âThe comparison x == y, where x and y are values, produces true or false.â\n\nä¸é¢è¿å¥è¯çæææ¯ï¼ç¸ç­è¿ç®ç¬¦ç¨äºæ¯è¾ä¸¤ä¸ªå¼ï¼è¿åtrueæfalseã\n\nä¸é¢æ¯ç®æ³ç»èã\n\n>  1.  ReturnIfAbrupt(x).\n>  2.  ReturnIfAbrupt(y).\n>  3.  If Type(x) is the same as Type(y), then\n>      1. Return the result of performing Strict Equality Comparison x === y.\n>  4.  If x is null and y is undefined, return true.\n>  5.  If x is undefined and y is null, return true.\n>  6.  If Type(x) is Number and Type(y) is String, return the result of the comparison x == ToNumber(y).\n>  7.  If Type(x) is String and Type(y) is Number, return the result of the comparison ToNumber(x) == y.\n>  8.  If Type(x) is Boolean, return the result of the comparison ToNumber(x) == y.\n>  9.  If Type(y) is Boolean, return the result of the comparison x == ToNumber(y).\n>  10. If Type(x) is either String, Number, or Symbol and Type(y) is Object, then return the result of the comparison x == ToPrimitive(y).\n>  11. If Type(x) is Object and Type(y) is either String, Number, or Symbol, then return the result of the comparison ToPrimitive(x) == y.\n>  12. Return false.\n\nä¸é¢è¿æ®µç®æ³ï¼ä¸å±æ 12 æ­¥ï¼ç¿»è¯å¦ä¸ã\n\n>  1.  å¦æxä¸æ¯æ­£å¸¸å¼ï¼æ¯å¦æåºä¸ä¸ªéè¯¯ï¼ï¼ä¸­æ­æ§è¡ã\n>  2.  å¦æyä¸æ¯æ­£å¸¸å¼ï¼ä¸­æ­æ§è¡ã\n>  3.  å¦æType(x)ä¸Type(y)ç¸åï¼æ§è¡ä¸¥æ ¼ç¸ç­è¿ç®x === yã\n>  4.  å¦æxæ¯nullï¼yæ¯undefinedï¼è¿åtrueã\n>  5.  å¦æxæ¯undefinedï¼yæ¯nullï¼è¿åtrueã\n>  6.  å¦æType(x)æ¯æ°å¼ï¼Type(y)æ¯å­ç¬¦ä¸²ï¼è¿åx == ToNumber(y)çç»æã\n>  7.  å¦æType(x)æ¯å­ç¬¦ä¸²ï¼Type(y)æ¯æ°å¼ï¼è¿åToNumber(x) == yçç»æã\n>  8.  å¦æType(x)æ¯å¸å°å¼ï¼è¿åToNumber(x) == yçç»æã\n>  9.  å¦æType(y)æ¯å¸å°å¼ï¼è¿åx == ToNumber(y)çç»æã\n>  10. å¦æType(x)æ¯å­ç¬¦ä¸²ææ°å¼æSymbolå¼ï¼Type(y)æ¯å¯¹è±¡ï¼è¿åx == ToPrimitive(y)çç»æã\n>  11. å¦æType(x)æ¯å¯¹è±¡ï¼Type(y)æ¯å­ç¬¦ä¸²ææ°å¼æSymbolå¼ï¼è¿åToPrimitive(x) == yçç»æã\n>  12. è¿åfalseã\n\nç±äº0çç±»åæ¯æ°å¼ï¼nullçç±»åæ¯ Nullï¼è¿æ¯è§æ ¼4.3.13 å°èçè§å®ï¼æ¯åé¨ Type è¿ç®çç»æï¼è·typeofè¿ç®ç¬¦æ å³ï¼ãå æ­¤ä¸é¢çå 11 æ­¥é½å¾ä¸å°ç»æï¼è¦å°ç¬¬ 12 æ­¥æè½å¾å°falseã\n\n0 == null // false\n\n\n1\n\n\n\n# æ°ç»çç©ºä½\n\nä¸é¢åçå¦ä¸ä¸ªä¾å­ã\n\nconst a1 = [undefined, undefined, undefined];\nconst a2 = [, , ,];\n\na1.length // 3\na2.length // 3\n\na1[0] // undefined\na2[0] // undefined\n\na1[0] === a2[0] // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»a1çæåæ¯ä¸ä¸ªundefinedï¼æ°ç»a2çæåæ¯ä¸ä¸ªç©ºä½ãè¿ä¸¤ä¸ªæ°ç»å¾ç¸ä¼¼ï¼é¿åº¦é½æ¯ 3ï¼æ¯ä¸ªä½ç½®çæåè¯»ååºæ¥é½æ¯undefinedã\n\nä½æ¯ï¼å®ä»¬å®éä¸å­å¨éå¤§å·®å¼ã\n\n0 in a1 // true\n0 in a2 // false\n\na1.hasOwnProperty(0) // true\na2.hasOwnProperty(0) // false\n\nObject.keys(a1) // ["0", "1", "2"]\nObject.keys(a2) // []\n\na1.map(n => 1) // [1, 1, 1]\na2.map(n => 1) // [, , ,]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸å±ååºäºåç§è¿ç®ï¼æ°ç»a1åa2çç»æé½ä¸ä¸æ ·ãåä¸ç§è¿ç®ï¼inè¿ç®ç¬¦ãæ°ç»çhasOwnPropertyæ¹æ³ãObject.keysæ¹æ³ï¼é½è¯´æï¼æ°ç»a2åä¸å°å±æ§åãæåä¸ç§è¿ç®ï¼æ°ç»çmapæ¹æ³ï¼è¯´æï¼æ°ç»a2æ²¡æåçéåã\n\nä¸ºä»ä¹a1ä¸a2æåçè¡ä¸ºä¸ä¸è´ï¼æ°ç»çæåæ¯undefinedæç©ºä½ï¼å°åºæä»ä¹ä¸åï¼\n\nè§æ ¼ç12.2.5 å°èãæ°ç»çåå§åãç»åºäºç­æ¡ã\n\n> âArray elements may be elided at the beginning, middle or end of the element list. Whenever a comma in the element list is not preceded by an AssignmentExpression (i.e., a comma at the beginning or after another comma), the missing array element contributes to the length of the Array and increases the index of subsequent elements. Elided array elements are not defined. If an element is elided at the end of an array, that element does not contribute to the length of the Array.â\n\nç¿»è¯å¦ä¸ã\n\n> "æ°ç»æåå¯ä»¥çç¥ãåªè¦éå·åé¢æ²¡æä»»ä½è¡¨è¾¾å¼ï¼æ°ç»çlengthå±æ§å°±ä¼å  1ï¼å¹¶ä¸ç¸åºå¢å å¶åæåçä½ç½®ç´¢å¼ãè¢«çç¥çæåä¸ä¼è¢«å®ä¹ãå¦æè¢«çç¥çæåæ¯æ°ç»æåä¸ä¸ªæåï¼åä¸ä¼å¯¼è´æ°ç»lengthå±æ§å¢å ãâ\n\nä¸é¢çè§æ ¼è¯´å¾å¾æ¸æ¥ï¼æ°ç»çç©ºä½ä¼åæ å¨lengthå±æ§ï¼ä¹å°±æ¯è¯´ç©ºä½æèªå·±çä½ç½®ï¼ä½æ¯è¿ä¸ªä½ç½®çå¼æ¯æªå®ä¹ï¼å³è¿ä¸ªå¼æ¯ä¸å­å¨çãå¦æä¸å®è¦è¯»åï¼ç»æå°±æ¯undefinedï¼å ä¸ºundefinedå¨ JavaScript è¯­è¨ä¸­è¡¨ç¤ºä¸å­å¨ï¼ã\n\nè¿å°±è§£éäºä¸ºä»ä¹inè¿ç®ç¬¦ãæ°ç»çhasOwnPropertyæ¹æ³ãObject.keysæ¹æ³ï¼é½åä¸å°ç©ºä½çå±æ§åãå ä¸ºè¿ä¸ªå±æ§åæ ¹æ¬å°±ä¸å­å¨ï¼è§æ ¼éé¢æ²¡è¯´è¦ä¸ºç©ºä½åéå±æ§å(ä½ç½®ç´¢å¼ï¼ï¼åªè¯´è¦ä¸ºä¸ä¸ä¸ªåç´ çä½ç½®ç´¢å¼å  1ã\n\nè³äºä¸ºä»ä¹æ°ç»çmapæ¹æ³ä¼è·³è¿ç©ºä½ï¼è¯·çä¸ä¸èã\n\n\n# æ°ç»ç map æ¹æ³\n\nè§æ ¼ç22.1.3.15 å°èå®ä¹äºæ°ç»çmapæ¹æ³ãè¯¥å°èåæ¯æ»ä½æè¿°mapæ¹æ³çè¡ä¸ºï¼éé¢æ²¡ææå°æ°ç»ç©ºä½ã\n\nåé¢çç®æ³æè¿°æ¯è¿æ ·çã\n\n>  1.  Let O be ToObject(this value).\n>  2.  ReturnIfAbrupt(O).\n>  3.  Let len be ToLength(Get(O, "length")).\n>  4.  ReturnIfAbrupt(len).\n>  5.  If IsCallable(callbackfn) is false, throw a TypeError exception.\n>  6.  If thisArg was supplied, let T be thisArg; else let T be undefined.\n>  7.  Let A be ArraySpeciesCreate(O, len).\n>  8.  ReturnIfAbrupt(A).\n>  9.  Let k be 0.\n>  10. Repeat, while k < len\n>      1. Let Pk be ToString(k).\n>      2. Let kPresent be HasProperty(O, Pk).\n>      3. ReturnIfAbrupt(kPresent).\n>      4. If kPresent is true, then\n>         1. Let kValue be Get(O, Pk).\n>         2. ReturnIfAbrupt(kValue).\n>         3. Let mappedValue be Call(callbackfn, T, Â«kValue, k, OÂ»).\n>         4. ReturnIfAbrupt(mappedValue).\n>         5. Let status be CreateDataPropertyOrThrow (A, Pk, mappedValue).\n>         6. ReturnIfAbrupt(status).\n>      5. Increase k by 1.\n>  11. Return A.\n\nç¿»è¯å¦ä¸ã\n\n>  1.  å¾å°å½åæ°ç»çthiså¯¹è±¡\n>  2.  å¦ææ¥éå°±è¿å\n>  3.  æ±åºå½åæ°ç»çlengthå±æ§\n>  4.  å¦ææ¥éå°±è¿å\n>  5.  å¦æ map æ¹æ³çåæ°callbackfnä¸å¯æ§è¡ï¼å°±æ¥é\n>  6.  å¦æ map æ¹æ³çåæ°ä¹ä¸­ï¼æå®äºthisï¼å°±è®©Tç­äºè¯¥åæ°ï¼å¦åTä¸ºundefined\n>  7.  çæä¸ä¸ªæ°çæ°ç»Aï¼è·å½åæ°ç»çlengthå±æ§ä¿æä¸è´\n>  8.  å¦ææ¥éå°±è¿å\n>  9.  è®¾å®kç­äº 0\n>  10. åªè¦kå°äºå½åæ°ç»çlengthå±æ§ï¼å°±éå¤ä¸é¢æ­¥éª¤\n>      1. è®¾å®Pkç­äºToString(k)ï¼å³å°Kè½¬ä¸ºå­ç¬¦ä¸²\n>      2. è®¾å®kPresentç­äºHasProperty(O, Pk)ï¼å³æ±å½åæ°ç»ææ²¡ææå®å±æ§\n>      3. å¦ææ¥éå°±è¿å\n>      4. å¦ækPresentç­äºtrueï¼åè¿è¡ä¸é¢æ­¥éª¤\n>         1. è®¾å®kValueç­äºGet(O, Pk)ï¼ååºå½åæ°ç»çæå®å±æ§\n>         2. å¦ææ¥éå°±è¿å\n>         3. è®¾å®mappedValueç­äºCall(callbackfn, T, Â«kValue, k, OÂ»)ï¼å³æ§è¡åè°å½æ°\n>         4. å¦ææ¥éå°±è¿å\n>         5. è®¾å®statusç­äºCreateDataPropertyOrThrow (A, Pk, mappedValue)ï¼å³å°åè°å½æ°çå¼æ¾å¥Aæ°ç»çæå®ä½ç½®\n>         6. å¦ææ¥éå°±è¿å\n>      5. kå¢å  1\n>  11. è¿åA\n\nä»ç»æ¥çä¸é¢çç®æ³ï¼å¯ä»¥åç°ï¼å½å¤çä¸ä¸ªå¨æ¯ç©ºä½çæ°ç»æ¶ï¼åé¢æ­¥éª¤é½æ²¡æé®é¢ãè¿å¥ç¬¬ 10 æ­¥ä¸­ç¬¬ 2 æ­¥æ¶ï¼kPresentä¼æ¥éï¼å ä¸ºç©ºä½å¯¹åºçå±æ§åï¼å¯¹äºæ°ç»æ¥è¯´æ¯ä¸å­å¨çï¼å æ­¤å°±ä¼è¿åï¼ä¸ä¼è¿è¡åé¢çæ­¥éª¤ã\n\nconst arr = [, , ,];\narr.map(n => {\n  console.log(n);\n  return 1;\n}) // [, , ,]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼arræ¯ä¸ä¸ªå¨æ¯ç©ºä½çæ°ç»ï¼mapæ¹æ³éåæåæ¶ï¼åç°æ¯ç©ºä½ï¼å°±ç´æ¥è·³è¿ï¼ä¸ä¼è¿å¥åè°å½æ°ãå æ­¤ï¼åè°å½æ°éé¢çconsole.logè¯­å¥æ ¹æ¬ä¸ä¼æ§è¡ï¼æ´ä¸ªmapæ¹æ³è¿åä¸ä¸ªå¨æ¯ç©ºä½çæ°æ°ç»ã\n\nV8 å¼æå¯¹mapæ¹æ³çå®ç°å¦ä¸ï¼å¯ä»¥çå°è·è§æ ¼çç®æ³æè¿°å®å¨ä¸è´ã\n\nfunction ArrayMap(f, receiver) {\n  CHECK_OBJECT_COERCIBLE(this, "Array.prototype.map");\n\n  // Pull out the length so that modifications to the length in the\n  // loop will not affect the looping and side effects are visible.\n  var array = TO_OBJECT(this);\n  var length = TO_LENGTH_OR_UINT32(array.length);\n  return InnerArrayMap(f, receiver, array, length);\n}\n\nfunction InnerArrayMap(f, receiver, array, length) {\n  if (!IS_CALLABLE(f)) throw MakeTypeError(kCalledNonCallable, f);\n\n  var accumulator = new InternalArray(length);\n  var is_array = IS_ARRAY(array);\n  var stepping = DEBUG_IS_STEPPING(f);\n  for (var i = 0; i < length; i++) {\n    if (HAS_INDEX(array, i, is_array)) {\n      var element = array[i];\n      // Prepare break slots for debugger step in.\n      if (stepping) %DebugPrepareStepInIfStepping(f);\n      accumulator[i] = %_Call(f, receiver, element, i, array);\n    }\n  }\n  var result = new GlobalArray();\n  %MoveArrayContents(accumulator, result);\n  return result;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n',normalizedContent:'# è¯»æ ecmascript è§æ ¼\n\n\n# æ¦è¿°\n\nè§æ ¼æä»¶æ¯è®¡ç®æºè¯­è¨çå®æ¹æ åï¼è¯¦ç»æè¿°è¯­æ³è§ååå®ç°æ¹æ³ã\n\nä¸è¬æ¥è¯´ï¼æ²¡æå¿è¦éè¯»è§æ ¼ï¼é¤éä½ è¦åç¼è¯å¨ãå ä¸ºè§æ ¼åå¾éå¸¸æ½è±¡åç²¾ç¼ï¼åç¼ºä¹å®ä¾ï¼ä¸å®¹æçè§£ï¼èä¸å¯¹äºè§£å³å®éçåºç¨é®é¢ï¼å¸®å©ä¸å¤§ãä½æ¯ï¼å¦æä½ éå°çé¾çè¯­æ³é®é¢ï¼å®å¨æ¾ä¸å°ç­æ¡ï¼è¿æ¶å¯ä»¥å»æ¥çè§æ ¼æä»¶ï¼äºè§£è¯­è¨æ åæ¯æä¹è¯´çãè§æ ¼æ¯è§£å³é®é¢çâæåä¸æâã è¿å¯¹ javascript è¯­è¨å¾æå¿è¦ãå ä¸ºå®çä½¿ç¨åºæ¯å¤æï¼è¯­æ³è§åä¸ç»ä¸ï¼ä¾å¤å¾å¤ï¼åç§è¿è¡ç¯å¢çè¡ä¸ºä¸ä¸è´ï¼å¯¼è´å¥æªçè¯­æ³é®é¢å±åºä¸ç©·ï¼ä»»ä½è¯­æ³ä¹¦é½ä¸å¯è½åæ¬æææåµãæ¥çè§æ ¼ï¼ä¸å¤±ä¸ºä¸ç§è§£å³è¯­æ³é®é¢çæå¯é ãææå¨çç»ææ¹æ³ã\n\næ¬ç« ä»ç»å¦ä½è¯»æ ecmascript 6 çè§æ ¼æä»¶ã\n\necmascript 6 çè§æ ¼ï¼å¯ä»¥å¨ ecma å½éæ åç»ç»çå®æ¹ç½ç«ï¼www.ecma-international.org/ecma-262/6.0/ï¼åè´¹ä¸è½½åå¨çº¿éè¯»ã\n\nè¿ä¸ªè§æ ¼æä»¶ç¸å½åºå¤§ï¼ä¸å±æ 26 ç« ï¼a4 æå°çè¯ï¼è¶³è¶³æ 545 é¡µãå®çç¹ç¹å°±æ¯è§å®å¾éå¸¸ç»è´ï¼æ¯ä¸ä¸ªè¯­æ³è¡ä¸ºãæ¯ä¸ä¸ªå½æ°çå®ç°é½åäºè¯¦å°½çæ¸æ°çæè¿°ãåºæ¬ä¸ï¼ç¼è¯å¨ä½èåªè¦ææ¯ä¸æ­¥ç¿»è¯æä»£ç å°±å¯ä»¥äºãè¿å¾å¤§ç¨åº¦ä¸ï¼ä¿è¯äºææ es6 å®ç°é½æä¸è´çè¡ä¸ºã\n\necmascript 6 è§æ ¼ç 26 ç« ä¹ä¸­ï¼ç¬¬ 1 ç« å°ç¬¬ 3 ç« æ¯å¯¹æä»¶æ¬èº«çä»ç»ï¼ä¸è¯­è¨å³ç³»ä¸å¤§ãç¬¬ 4 ç« æ¯å¯¹è¿é¨è¯­è¨æ»ä½è®¾è®¡çæè¿°ï¼æå´è¶£çè¯»èå¯ä»¥è¯»ä¸ä¸ãç¬¬ 5 ç« å°ç¬¬ 8 ç« æ¯è¯­è¨å®è§å±é¢çæè¿°ãç¬¬ 5 ç« æ¯è§æ ¼çåè¯è§£éååæ³çä»ç»ï¼ç¬¬ 6 ç« ä»ç»æ°æ®ç±»åï¼ç¬¬ 7 ç« ä»ç»è¯­è¨åé¨ç¨å°çæ½è±¡æä½ï¼ç¬¬ 8 ç« ä»ç»ä»£ç å¦ä½è¿è¡ãç¬¬ 9 ç« å°ç¬¬ 26 ç« ä»ç»å·ä½çè¯­æ³ã\n\nå¯¹äºä¸è¬ç¨æ·æ¥è¯´ï¼é¤äºç¬¬ 4 ç« ï¼å¶ä»ç« èé½æ¶åæä¸æ¹é¢çç»èï¼ä¸ç¨éè¯»ï¼åªè¦å¨ç¨å°çæ¶åï¼æ¥éç¸å³ç« èå³å¯ã\n\n\n# æ¯è¯­\n\nes6 è§æ ¼ä½¿ç¨äºä¸äºä¸é¨çæ¯è¯­ï¼äºè§£è¿äºæ¯è¯­ï¼å¯ä»¥å¸®å©ä½ è¯»æè§æ ¼ãæ¬èä»ç»å¶ä¸­çå ä¸ªã\n\n\n# æ½è±¡æä½\n\næè°âæ½è±¡æä½âï¼abstract operationsï¼å°±æ¯å¼æçä¸äºåé¨æ¹æ³ï¼å¤é¨ä¸è½è°ç¨ãè§æ ¼å®ä¹äºä¸ç³»åçæ½è±¡æä½ï¼è§å®äºå®ä»¬çè¡ä¸ºï¼çç»åç§å¼æèªå·±å»å®ç°ã\n\nä¸¾ä¾æ¥è¯´ï¼boolean(value)çç®æ³ï¼ç¬¬ä¸æ­¥æ¯è¿æ ·çã\n\n>  1. let b be toboolean(value).\n\nè¿éçtobooleanå°±æ¯ä¸ä¸ªæ½è±¡æä½ï¼æ¯å¼æåé¨æ±åºå¸å°å¼çç®æ³ã\n\nè®¸å¤å½æ°çç®æ³é½ä¼å¤æ¬¡ç¨å°åæ ·çæ­¥éª¤ï¼æä»¥ es6 è§æ ¼å°å®ä»¬æ½åºæ¥ï¼å®ä¹æâæ½è±¡æä½âï¼æ¹ä¾¿æè¿°ã\n\n\n# record å field\n\nes6 è§æ ¼å°é®å¼å¯¹ï¼key-value mapï¼çæ°æ®ç»æç§°ä¸º recordï¼å¶ä¸­çæ¯ä¸ç»é®å¼å¯¹ç§°ä¸º fieldãè¿å°±æ¯è¯´ï¼ä¸ä¸ª record ç±å¤ä¸ª field ç»æï¼èæ¯ä¸ª field é½åå«ä¸ä¸ªé®åï¼keyï¼åä¸ä¸ªé®å¼ï¼valueï¼ã\n\n\n# [[notation]]\n\nes6 è§æ ¼å¤§éä½¿ç¨[[notation]]è¿ç§ä¹¦åæ³ï¼æ¯å¦[[value]]ã[[writable]]ã[[get]]ã[[set]]ç­ç­ãå®ç¨æ¥æä»£ field çé®åã\n\nä¸¾ä¾æ¥è¯´ï¼objæ¯ä¸ä¸ª recordï¼å®æä¸ä¸ªprototypeå±æ§ães6 è§æ ¼ä¸ä¼åobj.prototypeï¼èæ¯åobj.[[prototype]]ãä¸è¬æ¥è¯´ï¼ä½¿ç¨[[notation]]è¿ç§ä¹¦åæ³çå±æ§ï¼é½æ¯å¯¹è±¡çåé¨å±æ§ã\n\nææç javascript å½æ°é½æä¸ä¸ªåé¨å±æ§[[call]]ï¼ç¨æ¥è¿è¡è¯¥å½æ°ã\n\nf.[[call]](v, argumentslist)\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼fæ¯ä¸ä¸ªå½æ°å¯¹è±¡ï¼[[call]]æ¯å®çåé¨æ¹æ³ï¼f.[[call]]()è¡¨ç¤ºè¿è¡è¯¥å½æ°ï¼vè¡¨ç¤º[[call]]è¿è¡æ¶thisçå¼ï¼argumentsliståæ¯è°ç¨æ¶ä¼ å¥å½æ°çåæ°ã\n\n\n# completion record\n\næ¯ä¸ä¸ªè¯­å¥é½ä¼è¿åä¸ä¸ª completion recordï¼è¡¨ç¤ºè¿è¡ç»æãæ¯ä¸ª completion record æä¸ä¸ª[[type]]å±æ§ï¼è¡¨ç¤ºè¿è¡ç»æçç±»åã\n\n[[type]]å±æ§æäºç§å¯è½çå¼ã\n\n * normal\n * return\n * throw\n * break\n * continue\n\nå¦æ[[type]]çå¼æ¯normalï¼å°±ç§°ä¸º normal completionï¼è¡¨ç¤ºè¿è¡æ­£å¸¸ãå¶ä»çå¼ï¼é½ç§°ä¸º abrupt completionãå¶ä¸­ï¼å¼åèåªéè¦å³æ³¨[[type]]ä¸ºthrowçæåµï¼å³è¿è¡åºéï¼breakãcontinueãreturnè¿ä¸ä¸ªå¼é½åªåºç°å¨ç¹å®åºæ¯ï¼å¯ä»¥ä¸ç¨èèã\n\n\n# æ½è±¡æä½çæ åæµç¨\n\næ½è±¡æä½çè¿è¡æµç¨ï¼ä¸è¬æ¯ä¸é¢è¿æ ·ã\n\n>  1. let resultcompletionrecord be abstractop().\n>  2. if resultcompletionrecord is an abrupt completion, return resultcompletionrecord.\n>  3. let result be resultcompletionrecord.[[value]].\n>  4. return result.\n\nä¸é¢çç¬¬ä¸æ­¥æ¯è°ç¨æ½è±¡æä½abstractop()ï¼å¾å°resultcompletionrecordï¼è¿æ¯ä¸ä¸ª completion recordãç¬¬äºæ­¥ï¼å¦æè¿ä¸ª record å±äº abrupt completionï¼å°±å°resultcompletionrecordè¿åç»ç¨æ·ãå¦ææ­¤å¤æ²¡æè¿åï¼å°±è¡¨ç¤ºè¿è¡ç»ææ­£å¸¸ï¼æå¾çå¼å­æ¾å¨resultcompletionrecord.[[value]]å±æ§ãç¬¬ä¸æ­¥ï¼å°è¿ä¸ªå¼è®°ä¸ºresultãç¬¬åæ­¥ï¼å°resultè¿åç»ç¨æ·ã\n\nes6 è§æ ¼å°è¿ä¸ªæ åæµç¨ï¼ä½¿ç¨ç®åçæ¹å¼è¡¨è¾¾ã\n\n>  1. let result be abstractop().\n>  2. returnifabrupt(result).\n>  3. return result.\n\nè¿ä¸ªç®åæ¹å¼éé¢çreturnifabrupt(result)ï¼å°±ä»£è¡¨äºä¸é¢çç¬¬äºæ­¥åç¬¬ä¸æ­¥ï¼å³å¦æææ¥éï¼å°±è¿åéè¯¯ï¼å¦åååºå¼ã\n\nçè³è¿æè¿ä¸æ­¥çç®åæ ¼å¼ã\n\n>  1. let result be ? abstractop().\n>  2. return result.\n\nä¸é¢æµç¨ç?ï¼å°±ä»£è¡¨abstractop()å¯è½ä¼æ¥éãä¸æ¦æ¥éï¼å°±è¿åéè¯¯ï¼å¦åååºå¼ã\n\né¤äº?ï¼es 6 è§æ ¼è¿ä½¿ç¨å¦ä¸ä¸ªç®åç¬¦å·!ã\n\n>  1. let result be ! abstractop().\n>  2. return result.\n\nä¸é¢æµç¨ç!ï¼ä»£è¡¨abstractop()ä¸ä¼æ¥éï¼è¿åçä¸å®æ¯ normal completionï¼æ»æ¯å¯ä»¥ååºå¼ã\n\n\n# ç¸ç­è¿ç®ç¬¦\n\nä¸é¢éè¿ä¸äºä¾å­ï¼ä»ç»å¦ä½ä½¿ç¨è¿ä»½è§æ ¼ã\n\nç¸ç­è¿ç®ç¬¦ï¼==ï¼æ¯ä¸ä¸ªå¾è®©äººå¤´ççè¿ç®ç¬¦ï¼å®çè¯­æ³è¡ä¸ºå¤åï¼ä¸ç¬¦åç´è§ãè¿ä¸ªå°èå°±ççè§æ ¼æä¹è§å®å®çè¡ä¸ºã\n\nè¯·çä¸é¢è¿ä¸ªè¡¨è¾¾å¼ï¼è¯·é®å®çå¼æ¯å¤å°ã\n\n0 == null\n\n\n1\n\n\nå¦æä½ ä¸ç¡®å®ç­æ¡ï¼æèæ³ç¥éè¯­è¨åé¨æä¹å¤çï¼å°±å¯ä»¥å»æ¥çè§æ ¼ï¼7.2.12 å°èæ¯å¯¹ç¸ç­è¿ç®ç¬¦ï¼==ï¼çæè¿°ã\n\nè§æ ¼å¯¹æ¯ä¸ç§è¯­æ³è¡ä¸ºçæè¿°ï¼é½åæä¸¤é¨åï¼åæ¯æ»ä½çè¡ä¸ºæè¿°ï¼ç¶åæ¯å®ç°çç®æ³ç»èãç¸ç­è¿ç®ç¬¦çæ»ä½æè¿°ï¼åªæä¸å¥è¯ã\n\n> âthe comparison x == y, where x and y are values, produces true or false.â\n\nä¸é¢è¿å¥è¯çæææ¯ï¼ç¸ç­è¿ç®ç¬¦ç¨äºæ¯è¾ä¸¤ä¸ªå¼ï¼è¿åtrueæfalseã\n\nä¸é¢æ¯ç®æ³ç»èã\n\n>  1.  returnifabrupt(x).\n>  2.  returnifabrupt(y).\n>  3.  if type(x) is the same as type(y), then\n>      1. return the result of performing strict equality comparison x === y.\n>  4.  if x is null and y is undefined, return true.\n>  5.  if x is undefined and y is null, return true.\n>  6.  if type(x) is number and type(y) is string, return the result of the comparison x == tonumber(y).\n>  7.  if type(x) is string and type(y) is number, return the result of the comparison tonumber(x) == y.\n>  8.  if type(x) is boolean, return the result of the comparison tonumber(x) == y.\n>  9.  if type(y) is boolean, return the result of the comparison x == tonumber(y).\n>  10. if type(x) is either string, number, or symbol and type(y) is object, then return the result of the comparison x == toprimitive(y).\n>  11. if type(x) is object and type(y) is either string, number, or symbol, then return the result of the comparison toprimitive(x) == y.\n>  12. return false.\n\nä¸é¢è¿æ®µç®æ³ï¼ä¸å±æ 12 æ­¥ï¼ç¿»è¯å¦ä¸ã\n\n>  1.  å¦æxä¸æ¯æ­£å¸¸å¼ï¼æ¯å¦æåºä¸ä¸ªéè¯¯ï¼ï¼ä¸­æ­æ§è¡ã\n>  2.  å¦æyä¸æ¯æ­£å¸¸å¼ï¼ä¸­æ­æ§è¡ã\n>  3.  å¦ætype(x)ä¸type(y)ç¸åï¼æ§è¡ä¸¥æ ¼ç¸ç­è¿ç®x === yã\n>  4.  å¦æxæ¯nullï¼yæ¯undefinedï¼è¿åtrueã\n>  5.  å¦æxæ¯undefinedï¼yæ¯nullï¼è¿åtrueã\n>  6.  å¦ætype(x)æ¯æ°å¼ï¼type(y)æ¯å­ç¬¦ä¸²ï¼è¿åx == tonumber(y)çç»æã\n>  7.  å¦ætype(x)æ¯å­ç¬¦ä¸²ï¼type(y)æ¯æ°å¼ï¼è¿åtonumber(x) == yçç»æã\n>  8.  å¦ætype(x)æ¯å¸å°å¼ï¼è¿åtonumber(x) == yçç»æã\n>  9.  å¦ætype(y)æ¯å¸å°å¼ï¼è¿åx == tonumber(y)çç»æã\n>  10. å¦ætype(x)æ¯å­ç¬¦ä¸²ææ°å¼æsymbolå¼ï¼type(y)æ¯å¯¹è±¡ï¼è¿åx == toprimitive(y)çç»æã\n>  11. å¦ætype(x)æ¯å¯¹è±¡ï¼type(y)æ¯å­ç¬¦ä¸²ææ°å¼æsymbolå¼ï¼è¿åtoprimitive(x) == yçç»æã\n>  12. è¿åfalseã\n\nç±äº0çç±»åæ¯æ°å¼ï¼nullçç±»åæ¯ nullï¼è¿æ¯è§æ ¼4.3.13 å°èçè§å®ï¼æ¯åé¨ type è¿ç®çç»æï¼è·typeofè¿ç®ç¬¦æ å³ï¼ãå æ­¤ä¸é¢çå 11 æ­¥é½å¾ä¸å°ç»æï¼è¦å°ç¬¬ 12 æ­¥æè½å¾å°falseã\n\n0 == null // false\n\n\n1\n\n\n\n# æ°ç»çç©ºä½\n\nä¸é¢åçå¦ä¸ä¸ªä¾å­ã\n\nconst a1 = [undefined, undefined, undefined];\nconst a2 = [, , ,];\n\na1.length // 3\na2.length // 3\n\na1[0] // undefined\na2[0] // undefined\n\na1[0] === a2[0] // true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»a1çæåæ¯ä¸ä¸ªundefinedï¼æ°ç»a2çæåæ¯ä¸ä¸ªç©ºä½ãè¿ä¸¤ä¸ªæ°ç»å¾ç¸ä¼¼ï¼é¿åº¦é½æ¯ 3ï¼æ¯ä¸ªä½ç½®çæåè¯»ååºæ¥é½æ¯undefinedã\n\nä½æ¯ï¼å®ä»¬å®éä¸å­å¨éå¤§å·®å¼ã\n\n0 in a1 // true\n0 in a2 // false\n\na1.hasownproperty(0) // true\na2.hasownproperty(0) // false\n\nobject.keys(a1) // ["0", "1", "2"]\nobject.keys(a2) // []\n\na1.map(n => 1) // [1, 1, 1]\na2.map(n => 1) // [, , ,]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸å±ååºäºåç§è¿ç®ï¼æ°ç»a1åa2çç»æé½ä¸ä¸æ ·ãåä¸ç§è¿ç®ï¼inè¿ç®ç¬¦ãæ°ç»çhasownpropertyæ¹æ³ãobject.keysæ¹æ³ï¼é½è¯´æï¼æ°ç»a2åä¸å°å±æ§åãæåä¸ç§è¿ç®ï¼æ°ç»çmapæ¹æ³ï¼è¯´æï¼æ°ç»a2æ²¡æåçéåã\n\nä¸ºä»ä¹a1ä¸a2æåçè¡ä¸ºä¸ä¸è´ï¼æ°ç»çæåæ¯undefinedæç©ºä½ï¼å°åºæä»ä¹ä¸åï¼\n\nè§æ ¼ç12.2.5 å°èãæ°ç»çåå§åãç»åºäºç­æ¡ã\n\n> âarray elements may be elided at the beginning, middle or end of the element list. whenever a comma in the element list is not preceded by an assignmentexpression (i.e., a comma at the beginning or after another comma), the missing array element contributes to the length of the array and increases the index of subsequent elements. elided array elements are not defined. if an element is elided at the end of an array, that element does not contribute to the length of the array.â\n\nç¿»è¯å¦ä¸ã\n\n> "æ°ç»æåå¯ä»¥çç¥ãåªè¦éå·åé¢æ²¡æä»»ä½è¡¨è¾¾å¼ï¼æ°ç»çlengthå±æ§å°±ä¼å  1ï¼å¹¶ä¸ç¸åºå¢å å¶åæåçä½ç½®ç´¢å¼ãè¢«çç¥çæåä¸ä¼è¢«å®ä¹ãå¦æè¢«çç¥çæåæ¯æ°ç»æåä¸ä¸ªæåï¼åä¸ä¼å¯¼è´æ°ç»lengthå±æ§å¢å ãâ\n\nä¸é¢çè§æ ¼è¯´å¾å¾æ¸æ¥ï¼æ°ç»çç©ºä½ä¼åæ å¨lengthå±æ§ï¼ä¹å°±æ¯è¯´ç©ºä½æèªå·±çä½ç½®ï¼ä½æ¯è¿ä¸ªä½ç½®çå¼æ¯æªå®ä¹ï¼å³è¿ä¸ªå¼æ¯ä¸å­å¨çãå¦æä¸å®è¦è¯»åï¼ç»æå°±æ¯undefinedï¼å ä¸ºundefinedå¨ javascript è¯­è¨ä¸­è¡¨ç¤ºä¸å­å¨ï¼ã\n\nè¿å°±è§£éäºä¸ºä»ä¹inè¿ç®ç¬¦ãæ°ç»çhasownpropertyæ¹æ³ãobject.keysæ¹æ³ï¼é½åä¸å°ç©ºä½çå±æ§åãå ä¸ºè¿ä¸ªå±æ§åæ ¹æ¬å°±ä¸å­å¨ï¼è§æ ¼éé¢æ²¡è¯´è¦ä¸ºç©ºä½åéå±æ§å(ä½ç½®ç´¢å¼ï¼ï¼åªè¯´è¦ä¸ºä¸ä¸ä¸ªåç´ çä½ç½®ç´¢å¼å  1ã\n\nè³äºä¸ºä»ä¹æ°ç»çmapæ¹æ³ä¼è·³è¿ç©ºä½ï¼è¯·çä¸ä¸èã\n\n\n# æ°ç»ç map æ¹æ³\n\nè§æ ¼ç22.1.3.15 å°èå®ä¹äºæ°ç»çmapæ¹æ³ãè¯¥å°èåæ¯æ»ä½æè¿°mapæ¹æ³çè¡ä¸ºï¼éé¢æ²¡ææå°æ°ç»ç©ºä½ã\n\nåé¢çç®æ³æè¿°æ¯è¿æ ·çã\n\n>  1.  let o be toobject(this value).\n>  2.  returnifabrupt(o).\n>  3.  let len be tolength(get(o, "length")).\n>  4.  returnifabrupt(len).\n>  5.  if iscallable(callbackfn) is false, throw a typeerror exception.\n>  6.  if thisarg was supplied, let t be thisarg; else let t be undefined.\n>  7.  let a be arrayspeciescreate(o, len).\n>  8.  returnifabrupt(a).\n>  9.  let k be 0.\n>  10. repeat, while k < len\n>      1. let pk be tostring(k).\n>      2. let kpresent be hasproperty(o, pk).\n>      3. returnifabrupt(kpresent).\n>      4. if kpresent is true, then\n>         1. let kvalue be get(o, pk).\n>         2. returnifabrupt(kvalue).\n>         3. let mappedvalue be call(callbackfn, t, Â«kvalue, k, oÂ»).\n>         4. returnifabrupt(mappedvalue).\n>         5. let status be createdatapropertyorthrow (a, pk, mappedvalue).\n>         6. returnifabrupt(status).\n>      5. increase k by 1.\n>  11. return a.\n\nç¿»è¯å¦ä¸ã\n\n>  1.  å¾å°å½åæ°ç»çthiså¯¹è±¡\n>  2.  å¦ææ¥éå°±è¿å\n>  3.  æ±åºå½åæ°ç»çlengthå±æ§\n>  4.  å¦ææ¥éå°±è¿å\n>  5.  å¦æ map æ¹æ³çåæ°callbackfnä¸å¯æ§è¡ï¼å°±æ¥é\n>  6.  å¦æ map æ¹æ³çåæ°ä¹ä¸­ï¼æå®äºthisï¼å°±è®©tç­äºè¯¥åæ°ï¼å¦åtä¸ºundefined\n>  7.  çæä¸ä¸ªæ°çæ°ç»aï¼è·å½åæ°ç»çlengthå±æ§ä¿æä¸è´\n>  8.  å¦ææ¥éå°±è¿å\n>  9.  è®¾å®kç­äº 0\n>  10. åªè¦kå°äºå½åæ°ç»çlengthå±æ§ï¼å°±éå¤ä¸é¢æ­¥éª¤\n>      1. è®¾å®pkç­äºtostring(k)ï¼å³å°kè½¬ä¸ºå­ç¬¦ä¸²\n>      2. è®¾å®kpresentç­äºhasproperty(o, pk)ï¼å³æ±å½åæ°ç»ææ²¡ææå®å±æ§\n>      3. å¦ææ¥éå°±è¿å\n>      4. å¦ækpresentç­äºtrueï¼åè¿è¡ä¸é¢æ­¥éª¤\n>         1. è®¾å®kvalueç­äºget(o, pk)ï¼ååºå½åæ°ç»çæå®å±æ§\n>         2. å¦ææ¥éå°±è¿å\n>         3. è®¾å®mappedvalueç­äºcall(callbackfn, t, Â«kvalue, k, oÂ»)ï¼å³æ§è¡åè°å½æ°\n>         4. å¦ææ¥éå°±è¿å\n>         5. è®¾å®statusç­äºcreatedatapropertyorthrow (a, pk, mappedvalue)ï¼å³å°åè°å½æ°çå¼æ¾å¥aæ°ç»çæå®ä½ç½®\n>         6. å¦ææ¥éå°±è¿å\n>      5. kå¢å  1\n>  11. è¿åa\n\nä»ç»æ¥çä¸é¢çç®æ³ï¼å¯ä»¥åç°ï¼å½å¤çä¸ä¸ªå¨æ¯ç©ºä½çæ°ç»æ¶ï¼åé¢æ­¥éª¤é½æ²¡æé®é¢ãè¿å¥ç¬¬ 10 æ­¥ä¸­ç¬¬ 2 æ­¥æ¶ï¼kpresentä¼æ¥éï¼å ä¸ºç©ºä½å¯¹åºçå±æ§åï¼å¯¹äºæ°ç»æ¥è¯´æ¯ä¸å­å¨çï¼å æ­¤å°±ä¼è¿åï¼ä¸ä¼è¿è¡åé¢çæ­¥éª¤ã\n\nconst arr = [, , ,];\narr.map(n => {\n  console.log(n);\n  return 1;\n}) // [, , ,]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼arræ¯ä¸ä¸ªå¨æ¯ç©ºä½çæ°ç»ï¼mapæ¹æ³éåæåæ¶ï¼åç°æ¯ç©ºä½ï¼å°±ç´æ¥è·³è¿ï¼ä¸ä¼è¿å¥åè°å½æ°ãå æ­¤ï¼åè°å½æ°éé¢çconsole.logè¯­å¥æ ¹æ¬ä¸ä¼æ§è¡ï¼æ´ä¸ªmapæ¹æ³è¿åä¸ä¸ªå¨æ¯ç©ºä½çæ°æ°ç»ã\n\nv8 å¼æå¯¹mapæ¹æ³çå®ç°å¦ä¸ï¼å¯ä»¥çå°è·è§æ ¼çç®æ³æè¿°å®å¨ä¸è´ã\n\nfunction arraymap(f, receiver) {\n  check_object_coercible(this, "array.prototype.map");\n\n  // pull out the length so that modifications to the length in the\n  // loop will not affect the looping and side effects are visible.\n  var array = to_object(this);\n  var length = to_length_or_uint32(array.length);\n  return innerarraymap(f, receiver, array, length);\n}\n\nfunction innerarraymap(f, receiver, array, length) {\n  if (!is_callable(f)) throw maketypeerror(kcallednoncallable, f);\n\n  var accumulator = new internalarray(length);\n  var is_array = is_array(array);\n  var stepping = debug_is_stepping(f);\n  for (var i = 0; i < length; i++) {\n    if (has_index(array, i, is_array)) {\n      var element = array[i];\n      // prepare break slots for debugger step in.\n      if (stepping) %debugpreparestepinifstepping(f);\n      accumulator[i] = %_call(f, receiver, element, i, array);\n    }\n  }\n  var result = new globalarray();\n  %movearraycontents(accumulator, result);\n  return result;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"å½æ°å¼ç¼ç¨",frontmatter:{title:"å½æ°å¼ç¼ç¨",date:"2020-02-09T16:00:30.000Z",permalink:"/pages/1cf50330655efc69",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/31.%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B.html",relativePath:"ãES6 æç¨ãç¬è®°/31.å½æ°å¼ç¼ç¨.md",key:"v-0bfabf3c",path:"/pages/1cf50330655efc69/",headers:[{level:2,title:"æ¯éå",slug:"æ¯éå",normalizedTitle:"æ¯éå",charIndex:206},{level:2,title:"å½æ°åæ",slug:"å½æ°åæ",normalizedTitle:"å½æ°åæ",charIndex:608},{level:2,title:"åæ°åç½®",slug:"åæ°åç½®",normalizedTitle:"åæ°åç½®",charIndex:865},{level:2,title:"æ§è¡è¾¹ç",slug:"æ§è¡è¾¹ç",normalizedTitle:"æ§è¡è¾¹ç",charIndex:1317},{level:2,title:"éåæä½",slug:"éåæä½",normalizedTitle:"éåæä½",charIndex:1852},{level:2,title:"åå¹¶æä½",slug:"åå¹¶æä½",normalizedTitle:"åå¹¶æä½",charIndex:2317},{level:2,title:"éå¯¹æä½",slug:"éå¯¹æä½",normalizedTitle:"éå¯¹æä½",charIndex:2660},{level:2,title:"åèé¾æ¥",slug:"åèé¾æ¥",normalizedTitle:"åèé¾æ¥",charIndex:3461}],excerpt:'<h1 id="å½æ°å¼ç¼ç¨"><a class="header-anchor" href="#å½æ°å¼ç¼ç¨">#</a> å½æ°å¼ç¼ç¨</h1>\n<p>JavaScript è¯­è¨ä»ä¸è¯çï¼å°±å·æå½æ°å¼ç¼ç¨ççå°ãå®å°å½æ°ä½ä¸ºä¸ç§ç¬ç«çæ°æ®ç±»åï¼ä¸å¶ä»æ°æ®ç±»åå¤äºå®å¨å¹³ç­çå°ä½ãå¨ JavaScript è¯­è¨ä¸­ï¼ä½ å¯ä»¥éç¨é¢åå¯¹è±¡ç¼ç¨ï¼ä¹å¯ä»¥éç¨å½æ°å¼ç¼ç¨ãæäººçè³è¯´ï¼JavaScript æ¯æå²ä»¥æ¥ç¬¬ä¸ç§è¢«å¤§è§æ¨¡éç¨çå½æ°å¼ç¼ç¨è¯­è¨ã</p>\n',headersStr:"æ¯éå å½æ°åæ åæ°åç½® æ§è¡è¾¹ç éåæä½ åå¹¶æä½ éå¯¹æä½ åèé¾æ¥",content:"# å½æ°å¼ç¼ç¨\n\nJavaScript è¯­è¨ä»ä¸è¯çï¼å°±å·æå½æ°å¼ç¼ç¨ççå°ãå®å°å½æ°ä½ä¸ºä¸ç§ç¬ç«çæ°æ®ç±»åï¼ä¸å¶ä»æ°æ®ç±»åå¤äºå®å¨å¹³ç­çå°ä½ãå¨ JavaScript è¯­è¨ä¸­ï¼ä½ å¯ä»¥éç¨é¢åå¯¹è±¡ç¼ç¨ï¼ä¹å¯ä»¥éç¨å½æ°å¼ç¼ç¨ãæäººçè³è¯´ï¼JavaScript æ¯æå²ä»¥æ¥ç¬¬ä¸ç§è¢«å¤§è§æ¨¡éç¨çå½æ°å¼ç¼ç¨è¯­è¨ã ES6 çç§ç§æ°å¢åè½ï¼ä½¿å¾å½æ°å¼ç¼ç¨åå¾æ´æ¹ä¾¿ãæ´å¼ºå¤§ãæ¬ç« ä»ç» ES6 å¦ä½è¿è¡å½æ°å¼ç¼ç¨ã\n\n\n# æ¯éå\n\næ¯éåï¼curryingï¼æçæ¯å°ä¸ä¸ªå¤åæ°çå½æ°æåæä¸ç³»åå½æ°ï¼æ¯ä¸ªæååçå½æ°é½åªæ¥åä¸ä¸ªåæ°ï¼unaryï¼ã\n\nfunction add (a, b) {\n  return a + b;\n}\n\nadd(1, 1) // 2\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°addæ¥åä¸¤ä¸ªåæ°aåbã\n\næ¯éåå°±æ¯å°ä¸é¢çå½æ°æåæä¸¤ä¸ªå½æ°ï¼æ¯ä¸ªå½æ°é½åªæ¥åä¸ä¸ªåæ°ã\n\nfunction add (a) {\n  return function (b) {\n    return a + b;\n  }\n}\n// æèéç¨ç®­å¤´å½æ°åæ³\nconst add = x => y => x + y;\n\nconst f = add(1);\nf(1) // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°addåªæ¥åä¸ä¸ªåæ°aï¼è¿åä¸ä¸ªå½æ°fãå½æ°fä¹åªæ¥åä¸ä¸ªåæ°bã\n\n\n# å½æ°åæ\n\nå½æ°åæï¼function compositionï¼æçæ¯ï¼å°å¤ä¸ªå½æ°åæä¸ä¸ªå½æ°ã\n\nconst compose = f => g => x => f(g(x));\n\nconst f = compose (x => x * 4) (x => x + 3);\nf(2) // 20\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼composeå°±æ¯ä¸ä¸ªå½æ°åæå¨ï¼ç¨äºå°ä¸¤ä¸ªå½æ°åæä¸ä¸ªå½æ°ã\n\nå¯ä»¥åç°ï¼æ¯éåä¸å½æ°åææçå¯åçèç³»ãåèç¨äºå°ä¸ä¸ªå½æ°ææå¤ä¸ªå½æ°ï¼åèç¨äºå°å¤ä¸ªå½æ°åå¹¶æä¸ä¸ªå½æ°ã\n\n\n# åæ°åç½®\n\nåæ°åç½®ï¼flipï¼æçæ¯æ¹åå½æ°åä¸¤ä¸ªåæ°çé¡ºåºã\n\nvar divide = (a, b) => a / b;\nvar flip = f.flip(divide);\n\nflip(10, 5) // 0.5\nflip(1, 10) // 10\n\nvar three = (a, b, c) => [a, b, c];\nvar flip = f.flip(three);\nflip(1, 2, 3); // => [2, 1, 3]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦ææç§æ­£å¸¸çåæ°é¡ºåºï¼10 é¤ä»¥ 5 ç­äº 2ãä½æ¯ï¼åæ°åç½®ä»¥åå¾å°çæ°å½æ°ï¼ç»æå°±æ¯ 5 é¤ä»¥ 10ï¼ç»æå¾å° 0.5ãå¦æåå½æ°æ 3 ä¸ªåæ°ï¼ååªé¢ ååä¸¤ä¸ªåæ°çä½ç½®ã\n\nåæ°åç½®çä»£ç éå¸¸ç®åã\n\nlet f = {};\nf.flip =\n  fn =>\n    (a, b, ...args) => fn(b, a, ...args.reverse());\n\n\n1\n2\n3\n4\n\n\n\n# æ§è¡è¾¹ç\n\næ§è¡è¾¹çï¼untilï¼æçæ¯å½æ°æ§è¡å°æ»¡è¶³æ¡ä»¶ä¸ºæ­¢ã\n\nlet condition = x => x > 100;\nlet inc = x => x + 1;\nlet until = f.until(condition, inc);\n\nuntil(0) // 101\n\ncondition = x => x === 5;\nuntil = f.until(condition, inc);\n\nuntil(3) // 5\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬ä¸æ®µçæ¡ä»¶æ¯æ§è¡å°xå¤§äº 100 ä¸ºæ­¢ï¼æä»¥xåå¼ä¸º 0 æ¶ï¼ä¼ä¸ç´æ§è¡å° 101ãç¬¬äºæ®µçæ¡ä»¶æ¯æ§è¡å°ç­äº 5 ä¸ºæ­¢ï¼æä»¥xæåçå¼æ¯ 5ã\n\næ§è¡è¾¹ççå®ç°å¦ä¸ã\n\nlet f = {};\nf.until = (condition, f) =>\n  (...args) => {\n    var r = f.apply(null, args);\n    return condition(r) ? r : f.until(condition, f)(r);\n  };\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çå³é®å°±æ¯ï¼å¦ææ»¡è¶³æ¡ä»¶å°±è¿åç»æï¼å¦åä¸æ­éå½æ§è¡ã\n\n\n# éåæä½\n\néåï¼listï¼æä½åæ¬ä»¥ä¸å ç§ã\n\n * headï¼ ååºéåçç¬¬ä¸ä¸ªéç©ºæåã\n * lastï¼ ååºæééåçæåä¸ä¸ªéç©ºæåã\n * tailï¼ ååºé¤äºâéåå¤´âä»¥å¤çå¶ä»éç©ºæåã\n * initï¼ ååºé¤äºâéåå°¾âä»¥å¤çå¶ä»éç©ºæåã\n\nä¸é¢æ¯ä¾å­ã\n\nf.head(5, 27, 3, 1) // 5\nf.last(5, 27, 3, 1) // 1\nf.tail(5, 27, 3, 1) // [27, 3, 1]\nf.init(5, 27, 3, 1) // [5, 27, 3]\n\n\n1\n2\n3\n4\n\n\nè¿äºæ¹æ³çå®ç°å¦ä¸ã\n\nlet f = {};\nf.head = (...xs) => xs[0];\nf.last = (...xs) => xs.slice(-1);\nf.tail = (...xs) => Array.prototype.slice.call(xs, 1);\nf.init = (...xs) => xs.slice(0, -1);\n\n\n1\n2\n3\n4\n5\n\n\n\n# åå¹¶æä½\n\nåå¹¶æä½åä¸ºconcatåconcatMapä¸¤ç§ãåèå°±æ¯å°å¤ä¸ªæ°ç»åæä¸ä¸ªï¼åèåæ¯åå¤çä¸ä¸åæ°ï¼ç¶ååå°å¤çç»æåæä¸ä¸ªæ°ç»ã\n\nf.concat([5], [27], [3]) // [5, 27, 3]\nf.concatMap(x => 'hi ' + x, 1, [[2]], 3) // ['hi 1', 'hi 2', 'hi 3']\n\n\n1\n2\n\n\nè¿ä¸¤ç§æ¹æ³çå®ç°ä»£ç å¦ä¸ã\n\nlet f = {};\nf.concat =\n  (...xs) => xs.reduce((a, b) => a.concat(b));\nf.concatMap =\n  (f, ...xs) => f.concat(xs.map(f));\n\n\n1\n2\n3\n4\n5\n\n\n\n# éå¯¹æä½\n\néå¯¹æä½åä¸ºzipåzipWithä¸¤ç§æ¹æ³ãzipæä½å°ä¸¤ä¸ªéåçæåï¼ä¸ä¸éå¯¹ï¼åæä¸ä¸ªæ°çéåãå¦æä¸¤ä¸ªéåä¸ç­é¿ï¼è¾é¿çé£ä¸ªéåå¤åºæ¥çæåï¼ä¼è¢«å¿½ç¥ãzipWithæä½çç¬¬ä¸ä¸ªåæ°æ¯ä¸ä¸ªå½æ°ï¼ç¶åä¼å°åé¢çéåæåä¸ä¸éå¯¹ï¼è¾å¥è¯¥å½æ°ï¼è¿åå¼å°±ç»æä¸ä¸ªæ°çéåã\n\nä¸é¢æ¯ä¾å­ã\n\nlet a = [0, 1, 2];\nlet b = [3, 4, 5];\nlet c = [6, 7, 8];\n\nf.zip(a, b) // [[0, 3], [1, 4], [2, 5]]\nf.zipWith((a, b) => a + b, a, b, c) // [9, 12, 15]\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼zipWithæ¹æ³çç¬¬ä¸ä¸ªåæ°æ¯ä¸ä¸ªæ±åå½æ°ï¼å®å°åé¢ä¸ä¸ªéåçæåï¼ä¸ä¸éå¯¹è¿è¡ç¸å ã\n\nè¿ä¸¤ä¸ªæ¹æ³çå®ç°å¦ä¸ã\n\nlet f = {};\n\nf.zip = (...xs) => {\n  let r = [];\n  let nple = [];\n  let length = Math.min.apply(null, xs.map(x => x.length));\n\n  for (var i = 0; i < length; i++) {\n    xs.forEach(\n      x => nple.push(x[i])\n    );\n\n    r.push(nple);\n    nple = [];\n  }\n\n  return r;\n};\n\nf.zipWith = (op, ...xs) =>\n  f.zip.apply(null, xs).map(\n    (x) => x.reduce(op)\n  );\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\n\n# åèé¾æ¥\n\n * Mateo Gianolio, Haskell in ES6: Part 1",normalizedContent:"# å½æ°å¼ç¼ç¨\n\njavascript è¯­è¨ä»ä¸è¯çï¼å°±å·æå½æ°å¼ç¼ç¨ççå°ãå®å°å½æ°ä½ä¸ºä¸ç§ç¬ç«çæ°æ®ç±»åï¼ä¸å¶ä»æ°æ®ç±»åå¤äºå®å¨å¹³ç­çå°ä½ãå¨ javascript è¯­è¨ä¸­ï¼ä½ å¯ä»¥éç¨é¢åå¯¹è±¡ç¼ç¨ï¼ä¹å¯ä»¥éç¨å½æ°å¼ç¼ç¨ãæäººçè³è¯´ï¼javascript æ¯æå²ä»¥æ¥ç¬¬ä¸ç§è¢«å¤§è§æ¨¡éç¨çå½æ°å¼ç¼ç¨è¯­è¨ã es6 çç§ç§æ°å¢åè½ï¼ä½¿å¾å½æ°å¼ç¼ç¨åå¾æ´æ¹ä¾¿ãæ´å¼ºå¤§ãæ¬ç« ä»ç» es6 å¦ä½è¿è¡å½æ°å¼ç¼ç¨ã\n\n\n# æ¯éå\n\næ¯éåï¼curryingï¼æçæ¯å°ä¸ä¸ªå¤åæ°çå½æ°æåæä¸ç³»åå½æ°ï¼æ¯ä¸ªæååçå½æ°é½åªæ¥åä¸ä¸ªåæ°ï¼unaryï¼ã\n\nfunction add (a, b) {\n  return a + b;\n}\n\nadd(1, 1) // 2\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°addæ¥åä¸¤ä¸ªåæ°aåbã\n\næ¯éåå°±æ¯å°ä¸é¢çå½æ°æåæä¸¤ä¸ªå½æ°ï¼æ¯ä¸ªå½æ°é½åªæ¥åä¸ä¸ªåæ°ã\n\nfunction add (a) {\n  return function (b) {\n    return a + b;\n  }\n}\n// æèéç¨ç®­å¤´å½æ°åæ³\nconst add = x => y => x + y;\n\nconst f = add(1);\nf(1) // 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°addåªæ¥åä¸ä¸ªåæ°aï¼è¿åä¸ä¸ªå½æ°fãå½æ°fä¹åªæ¥åä¸ä¸ªåæ°bã\n\n\n# å½æ°åæ\n\nå½æ°åæï¼function compositionï¼æçæ¯ï¼å°å¤ä¸ªå½æ°åæä¸ä¸ªå½æ°ã\n\nconst compose = f => g => x => f(g(x));\n\nconst f = compose (x => x * 4) (x => x + 3);\nf(2) // 20\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼composeå°±æ¯ä¸ä¸ªå½æ°åæå¨ï¼ç¨äºå°ä¸¤ä¸ªå½æ°åæä¸ä¸ªå½æ°ã\n\nå¯ä»¥åç°ï¼æ¯éåä¸å½æ°åææçå¯åçèç³»ãåèç¨äºå°ä¸ä¸ªå½æ°ææå¤ä¸ªå½æ°ï¼åèç¨äºå°å¤ä¸ªå½æ°åå¹¶æä¸ä¸ªå½æ°ã\n\n\n# åæ°åç½®\n\nåæ°åç½®ï¼flipï¼æçæ¯æ¹åå½æ°åä¸¤ä¸ªåæ°çé¡ºåºã\n\nvar divide = (a, b) => a / b;\nvar flip = f.flip(divide);\n\nflip(10, 5) // 0.5\nflip(1, 10) // 10\n\nvar three = (a, b, c) => [a, b, c];\nvar flip = f.flip(three);\nflip(1, 2, 3); // => [2, 1, 3]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦ææç§æ­£å¸¸çåæ°é¡ºåºï¼10 é¤ä»¥ 5 ç­äº 2ãä½æ¯ï¼åæ°åç½®ä»¥åå¾å°çæ°å½æ°ï¼ç»æå°±æ¯ 5 é¤ä»¥ 10ï¼ç»æå¾å° 0.5ãå¦æåå½æ°æ 3 ä¸ªåæ°ï¼ååªé¢ ååä¸¤ä¸ªåæ°çä½ç½®ã\n\nåæ°åç½®çä»£ç éå¸¸ç®åã\n\nlet f = {};\nf.flip =\n  fn =>\n    (a, b, ...args) => fn(b, a, ...args.reverse());\n\n\n1\n2\n3\n4\n\n\n\n# æ§è¡è¾¹ç\n\næ§è¡è¾¹çï¼untilï¼æçæ¯å½æ°æ§è¡å°æ»¡è¶³æ¡ä»¶ä¸ºæ­¢ã\n\nlet condition = x => x > 100;\nlet inc = x => x + 1;\nlet until = f.until(condition, inc);\n\nuntil(0) // 101\n\ncondition = x => x === 5;\nuntil = f.until(condition, inc);\n\nuntil(3) // 5\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬ä¸æ®µçæ¡ä»¶æ¯æ§è¡å°xå¤§äº 100 ä¸ºæ­¢ï¼æä»¥xåå¼ä¸º 0 æ¶ï¼ä¼ä¸ç´æ§è¡å° 101ãç¬¬äºæ®µçæ¡ä»¶æ¯æ§è¡å°ç­äº 5 ä¸ºæ­¢ï¼æä»¥xæåçå¼æ¯ 5ã\n\næ§è¡è¾¹ççå®ç°å¦ä¸ã\n\nlet f = {};\nf.until = (condition, f) =>\n  (...args) => {\n    var r = f.apply(null, args);\n    return condition(r) ? r : f.until(condition, f)(r);\n  };\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çå³é®å°±æ¯ï¼å¦ææ»¡è¶³æ¡ä»¶å°±è¿åç»æï¼å¦åä¸æ­éå½æ§è¡ã\n\n\n# éåæä½\n\néåï¼listï¼æä½åæ¬ä»¥ä¸å ç§ã\n\n * headï¼ ååºéåçç¬¬ä¸ä¸ªéç©ºæåã\n * lastï¼ ååºæééåçæåä¸ä¸ªéç©ºæåã\n * tailï¼ ååºé¤äºâéåå¤´âä»¥å¤çå¶ä»éç©ºæåã\n * initï¼ ååºé¤äºâéåå°¾âä»¥å¤çå¶ä»éç©ºæåã\n\nä¸é¢æ¯ä¾å­ã\n\nf.head(5, 27, 3, 1) // 5\nf.last(5, 27, 3, 1) // 1\nf.tail(5, 27, 3, 1) // [27, 3, 1]\nf.init(5, 27, 3, 1) // [5, 27, 3]\n\n\n1\n2\n3\n4\n\n\nè¿äºæ¹æ³çå®ç°å¦ä¸ã\n\nlet f = {};\nf.head = (...xs) => xs[0];\nf.last = (...xs) => xs.slice(-1);\nf.tail = (...xs) => array.prototype.slice.call(xs, 1);\nf.init = (...xs) => xs.slice(0, -1);\n\n\n1\n2\n3\n4\n5\n\n\n\n# åå¹¶æä½\n\nåå¹¶æä½åä¸ºconcatåconcatmapä¸¤ç§ãåèå°±æ¯å°å¤ä¸ªæ°ç»åæä¸ä¸ªï¼åèåæ¯åå¤çä¸ä¸åæ°ï¼ç¶ååå°å¤çç»æåæä¸ä¸ªæ°ç»ã\n\nf.concat([5], [27], [3]) // [5, 27, 3]\nf.concatmap(x => 'hi ' + x, 1, [[2]], 3) // ['hi 1', 'hi 2', 'hi 3']\n\n\n1\n2\n\n\nè¿ä¸¤ç§æ¹æ³çå®ç°ä»£ç å¦ä¸ã\n\nlet f = {};\nf.concat =\n  (...xs) => xs.reduce((a, b) => a.concat(b));\nf.concatmap =\n  (f, ...xs) => f.concat(xs.map(f));\n\n\n1\n2\n3\n4\n5\n\n\n\n# éå¯¹æä½\n\néå¯¹æä½åä¸ºzipåzipwithä¸¤ç§æ¹æ³ãzipæä½å°ä¸¤ä¸ªéåçæåï¼ä¸ä¸éå¯¹ï¼åæä¸ä¸ªæ°çéåãå¦æä¸¤ä¸ªéåä¸ç­é¿ï¼è¾é¿çé£ä¸ªéåå¤åºæ¥çæåï¼ä¼è¢«å¿½ç¥ãzipwithæä½çç¬¬ä¸ä¸ªåæ°æ¯ä¸ä¸ªå½æ°ï¼ç¶åä¼å°åé¢çéåæåä¸ä¸éå¯¹ï¼è¾å¥è¯¥å½æ°ï¼è¿åå¼å°±ç»æä¸ä¸ªæ°çéåã\n\nä¸é¢æ¯ä¾å­ã\n\nlet a = [0, 1, 2];\nlet b = [3, 4, 5];\nlet c = [6, 7, 8];\n\nf.zip(a, b) // [[0, 3], [1, 4], [2, 5]]\nf.zipwith((a, b) => a + b, a, b, c) // [9, 12, 15]\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼zipwithæ¹æ³çç¬¬ä¸ä¸ªåæ°æ¯ä¸ä¸ªæ±åå½æ°ï¼å®å°åé¢ä¸ä¸ªéåçæåï¼ä¸ä¸éå¯¹è¿è¡ç¸å ã\n\nè¿ä¸¤ä¸ªæ¹æ³çå®ç°å¦ä¸ã\n\nlet f = {};\n\nf.zip = (...xs) => {\n  let r = [];\n  let nple = [];\n  let length = math.min.apply(null, xs.map(x => x.length));\n\n  for (var i = 0; i < length; i++) {\n    xs.foreach(\n      x => nple.push(x[i])\n    );\n\n    r.push(nple);\n    nple = [];\n  }\n\n  return r;\n};\n\nf.zipwith = (op, ...xs) =>\n  f.zip.apply(null, xs).map(\n    (x) => x.reduce(op)\n  );\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\n\n# åèé¾æ¥\n\n * mateo gianolio, haskell in es6: part 1",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Mixin",frontmatter:{title:"Mixin",date:"2020-02-09T16:00:30.000Z",permalink:"/pages/6a8e2dc558da1b39",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/32.Mixin.html",relativePath:"ãES6 æç¨ãç¬è®°/32.Mixin.md",key:"v-8b56fb8c",path:"/pages/6a8e2dc558da1b39/",headers:[{level:2,title:"å«ä¹",slug:"å«ä¹",normalizedTitle:"å«ä¹",charIndex:835},{level:2,title:"Trait",slug:"trait",normalizedTitle:"trait",charIndex:2127}],excerpt:'<h1 id="mixin"><a class="header-anchor" href="#mixin">#</a> Mixin</h1>\n<p>JavaScript è¯­è¨çè®¾è®¡æ¯åä¸ç»§æ¿ï¼å³å­ç±»åªè½ç»§æ¿ä¸ä¸ªç¶ç±»ï¼ä¸åè®¸ç»§æ¿å¤ä¸ªç¶ç±»ãè¿ç§è®¾è®¡ä¿è¯äºå¯¹è±¡ç»§æ¿çå±æ¬¡ç»ææ¯æ ç¶çï¼èä¸æ¯å¤æç<a href="https://en.wikipedia.org/wiki/Multiple_inheritance#The_diamond_problem" target="_blank" rel="noopener noreferrer">ç½ç¶ç»æ<OutboundLink/></a>ã</p>\n',headersStr:"å«ä¹ Trait",content:"# Mixin\n\nJavaScript è¯­è¨çè®¾è®¡æ¯åä¸ç»§æ¿ï¼å³å­ç±»åªè½ç»§æ¿ä¸ä¸ªç¶ç±»ï¼ä¸åè®¸ç»§æ¿å¤ä¸ªç¶ç±»ãè¿ç§è®¾è®¡ä¿è¯äºå¯¹è±¡ç»§æ¿çå±æ¬¡ç»ææ¯æ ç¶çï¼èä¸æ¯å¤æçç½ç¶ç»æã ä½æ¯ï¼è¿å¤§å¤§éä½äºç¼ç¨ççµæ´»æ§ãå ä¸ºå®éå¼åä¸­ï¼ææ¶ä¸å¯é¿åï¼å­ç±»éè¦ç»§æ¿å¤ä¸ªç¶ç±»ãä¸¾ä¾æ¥è¯´ï¼âç«âå¯ä»¥ç»§æ¿âåºä¹³ç±»å¨ç©âï¼ä¹å¯ä»¥ç»§æ¿âå® ç©âã\n\nåç§åä¸ç»§æ¿çç¼ç¨è¯­è¨ï¼æä¸åçå¤éç»§æ¿è§£å³æ¹æ¡ãæ¯å¦ï¼Java è¯­è¨ä¹æ¯å­ç±»åªè½ç»§æ¿ä¸ä¸ªç¶ç±»ï¼ä½æ¯è¿åè®¸ç»§æ¿å¤ä¸ªçé¢ï¼interfaceï¼ï¼è¿æ ·å°±é´æ¥å®ç°äºå¤éç»§æ¿ãInterface ä¸ç¶ç±»ä¸æ ·ï¼ä¹æ¯ä¸ä¸ªç±»ï¼åªä¸è¿å®åªå®ä¹æ¥å£ï¼method signatureï¼ï¼ä¸å®ä¹å®ç°ï¼å æ­¤åè¢«ç§°ä¸ºâæ½è±¡ç±»âãå¡æ¯ç»§æ¿äº Interface çæ¹æ³ï¼é½å¿é¡»èªå·±å®ä¹å®ç°ï¼å¦åå°±ä¼æ¥éãè¿æ ·å°±é¿åäºå¤éç»§æ¿çæå¤§é®é¢ï¼å¤ä¸ªç¶ç±»çååæ¹æ³çç¢°æï¼naming collisionï¼ã\n\nJavaScript è¯­è¨æ²¡æéç¨ Interface çæ¹æ¡ï¼èæ¯éè¿ä»£çï¼delegationï¼å®ç°äºä»å¶ä»ç±»å¼å¥æ¹æ³ã\n\nvar Enumerable_first = function () {\n  this.first = function () {\n    return this[0];\n  };\n};\n\nvar list = [\"foo\", \"bar\", \"baz\"];\nEnumerable_first.call(list); // explicit delegation\nlist.first() // \"foo\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼listæ¯ä¸ä¸ªæ°ç»ï¼æ¬èº«å¹¶æ²¡æfirstæ¹æ³ãéè¿callæ¹æ³ï¼å¯ä»¥æEnumerable_firstéé¢çæ¹æ³ï¼ç»å®å°listï¼ä»èlistå°±å·æfirstæ¹æ³ãè¿å°±å«åâä»£çâï¼delegationï¼ï¼listå¯¹è±¡ä»£çäºEnumerable_firstçfirstæ¹æ³ã\n\n\n# å«ä¹\n\nMixin è¿ä¸ªåå­æ¥èªäºå°æ·æ·ï¼å¨åºæ¬å£å³çå°æ·æ·ä¸é¢æ··å¥å¶ä»å£å³ï¼è¿å°±å«å Mix-inã\n\nå®åè®¸åä¸ä¸ªç±»éé¢æ³¨å¥ä¸äºä»£ç ï¼ä½¿å¾ä¸ä¸ªç±»çåè½è½å¤âæ··å¥âå¦ä¸ä¸ªç±»ãå®è´¨ä¸æ¯å¤éç»§æ¿çä¸ç§è§£å³æ¹æ¡ï¼ä½æ¯é¿åäºå¤éç»§æ¿çå¤ææ§ï¼èä¸æå©äºä»£ç å¤ç¨ã\n\nMixin å°±æ¯ä¸ä¸ªæ­£å¸¸çç±»ï¼ä¸ä»å®ä¹äºæ¥å£ï¼è¿å®ä¹äºæ¥å£çå®ç°ã\n\nå­ç±»éè¿å¨thiså¯¹è±¡ä¸é¢ç»å®æ¹æ³ï¼è¾¾å°å¤éç»§æ¿çç®çã\n\nå¾å¤åºæä¾äº Mixin åè½ãä¸é¢ä»¥ Lodash ä¸ºä¾ã\n\nfunction vowels(string) {\n  return /[aeiou]/i.test(this.value);\n}\n\nvar obj = { value: 'hello' };\n_.mixin(obj, {vowels: vowels})\nobj.vowels() // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç éè¿ Lodash åºç_.mixinæ¹æ³ï¼è®©objå¯¹è±¡ç»§æ¿äºvowelsæ¹æ³ã\n\nUnderscore çç±»ä¼¼æ¹æ³æ¯_.extendã\n\nvar Person = function (fName, lName) {\n  this.firstName = fName;\n  this.lastName = lName;\n}\n\nvar sam = new Person('Sam', 'Lowry');\n\nvar NameMixin = {\n  fullName: function () {\n    return this.firstName + ' ' + this.lastName;\n  },\n  rename: function(first, last) {\n    this.firstName = first;\n    this.lastName = last;\n    return this;\n  }\n};\n_.extend(Person.prototype, NameMixin);\nsam.rename('Samwise', 'Gamgee');\nsam.fullName() // \"Samwise Gamgee\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¸é¢ä»£ç éè¿_.extendæ¹æ³ï¼å¨samå¯¹è±¡ä¸é¢ï¼åç¡®è¯´æ¯å®çååå¯¹è±¡Person.prototypeä¸é¢ï¼ï¼æ··å¥äºNameMixinç±»ã\n\nextendæ¹æ³çå®ç°éå¸¸ç®åã\n\nfunction extend(destination, source) {\n  for (var k in source) {\n    if (source.hasOwnProperty(k)) {\n      destination[k] = source[k];\n    }\n  }\n  return destination;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç å°sourceå¯¹è±¡çæææ¹æ³ï¼æ·»å å°destinationå¯¹è±¡ã\n\n\n# Trait\n\nTrait æ¯å¦å¤ä¸ç§å¤éç»§æ¿çè§£å³æ¹æ¡ãå®ä¸ Mixin å¾ç¸ä¼¼ï¼ä½æ¯æä¸äºç»å¾®çå·®å«ã\n\n * Mixin å¯ä»¥åå«ç¶æï¼stateï¼ï¼Trait ä¸åå«ï¼å³ Trait éé¢çæ¹æ³é½æ¯äºä¸ç¸å¹²ï¼å¯ä»¥çº¿æ§åå«çãæ¯å¦ï¼Trait1åå«æ¹æ³AåBï¼Trait2ç»§æ¿äºTrait1ï¼åæ¶è¿åå«ä¸ä¸ªèªå·±çæ¹æ³Cï¼å®éä¸å°±ç­åäºç´æ¥åå«æ¹æ³AãBãCã\n * å¯¹äºååæ¹æ³çç¢°æï¼Mixin åå«äºè§£å³è§åï¼Trait åæ¯æ¥éã",normalizedContent:"# mixin\n\njavascript è¯­è¨çè®¾è®¡æ¯åä¸ç»§æ¿ï¼å³å­ç±»åªè½ç»§æ¿ä¸ä¸ªç¶ç±»ï¼ä¸åè®¸ç»§æ¿å¤ä¸ªç¶ç±»ãè¿ç§è®¾è®¡ä¿è¯äºå¯¹è±¡ç»§æ¿çå±æ¬¡ç»ææ¯æ ç¶çï¼èä¸æ¯å¤æçç½ç¶ç»æã ä½æ¯ï¼è¿å¤§å¤§éä½äºç¼ç¨ççµæ´»æ§ãå ä¸ºå®éå¼åä¸­ï¼ææ¶ä¸å¯é¿åï¼å­ç±»éè¦ç»§æ¿å¤ä¸ªç¶ç±»ãä¸¾ä¾æ¥è¯´ï¼âç«âå¯ä»¥ç»§æ¿âåºä¹³ç±»å¨ç©âï¼ä¹å¯ä»¥ç»§æ¿âå® ç©âã\n\nåç§åä¸ç»§æ¿çç¼ç¨è¯­è¨ï¼æä¸åçå¤éç»§æ¿è§£å³æ¹æ¡ãæ¯å¦ï¼java è¯­è¨ä¹æ¯å­ç±»åªè½ç»§æ¿ä¸ä¸ªç¶ç±»ï¼ä½æ¯è¿åè®¸ç»§æ¿å¤ä¸ªçé¢ï¼interfaceï¼ï¼è¿æ ·å°±é´æ¥å®ç°äºå¤éç»§æ¿ãinterface ä¸ç¶ç±»ä¸æ ·ï¼ä¹æ¯ä¸ä¸ªç±»ï¼åªä¸è¿å®åªå®ä¹æ¥å£ï¼method signatureï¼ï¼ä¸å®ä¹å®ç°ï¼å æ­¤åè¢«ç§°ä¸ºâæ½è±¡ç±»âãå¡æ¯ç»§æ¿äº interface çæ¹æ³ï¼é½å¿é¡»èªå·±å®ä¹å®ç°ï¼å¦åå°±ä¼æ¥éãè¿æ ·å°±é¿åäºå¤éç»§æ¿çæå¤§é®é¢ï¼å¤ä¸ªç¶ç±»çååæ¹æ³çç¢°æï¼naming collisionï¼ã\n\njavascript è¯­è¨æ²¡æéç¨ interface çæ¹æ¡ï¼èæ¯éè¿ä»£çï¼delegationï¼å®ç°äºä»å¶ä»ç±»å¼å¥æ¹æ³ã\n\nvar enumerable_first = function () {\n  this.first = function () {\n    return this[0];\n  };\n};\n\nvar list = [\"foo\", \"bar\", \"baz\"];\nenumerable_first.call(list); // explicit delegation\nlist.first() // \"foo\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼listæ¯ä¸ä¸ªæ°ç»ï¼æ¬èº«å¹¶æ²¡æfirstæ¹æ³ãéè¿callæ¹æ³ï¼å¯ä»¥æenumerable_firstéé¢çæ¹æ³ï¼ç»å®å°listï¼ä»èlistå°±å·æfirstæ¹æ³ãè¿å°±å«åâä»£çâï¼delegationï¼ï¼listå¯¹è±¡ä»£çäºenumerable_firstçfirstæ¹æ³ã\n\n\n# å«ä¹\n\nmixin è¿ä¸ªåå­æ¥èªäºå°æ·æ·ï¼å¨åºæ¬å£å³çå°æ·æ·ä¸é¢æ··å¥å¶ä»å£å³ï¼è¿å°±å«å mix-inã\n\nå®åè®¸åä¸ä¸ªç±»éé¢æ³¨å¥ä¸äºä»£ç ï¼ä½¿å¾ä¸ä¸ªç±»çåè½è½å¤âæ··å¥âå¦ä¸ä¸ªç±»ãå®è´¨ä¸æ¯å¤éç»§æ¿çä¸ç§è§£å³æ¹æ¡ï¼ä½æ¯é¿åäºå¤éç»§æ¿çå¤ææ§ï¼èä¸æå©äºä»£ç å¤ç¨ã\n\nmixin å°±æ¯ä¸ä¸ªæ­£å¸¸çç±»ï¼ä¸ä»å®ä¹äºæ¥å£ï¼è¿å®ä¹äºæ¥å£çå®ç°ã\n\nå­ç±»éè¿å¨thiså¯¹è±¡ä¸é¢ç»å®æ¹æ³ï¼è¾¾å°å¤éç»§æ¿çç®çã\n\nå¾å¤åºæä¾äº mixin åè½ãä¸é¢ä»¥ lodash ä¸ºä¾ã\n\nfunction vowels(string) {\n  return /[aeiou]/i.test(this.value);\n}\n\nvar obj = { value: 'hello' };\n_.mixin(obj, {vowels: vowels})\nobj.vowels() // true\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç éè¿ lodash åºç_.mixinæ¹æ³ï¼è®©objå¯¹è±¡ç»§æ¿äºvowelsæ¹æ³ã\n\nunderscore çç±»ä¼¼æ¹æ³æ¯_.extendã\n\nvar person = function (fname, lname) {\n  this.firstname = fname;\n  this.lastname = lname;\n}\n\nvar sam = new person('sam', 'lowry');\n\nvar namemixin = {\n  fullname: function () {\n    return this.firstname + ' ' + this.lastname;\n  },\n  rename: function(first, last) {\n    this.firstname = first;\n    this.lastname = last;\n    return this;\n  }\n};\n_.extend(person.prototype, namemixin);\nsam.rename('samwise', 'gamgee');\nsam.fullname() // \"samwise gamgee\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¸é¢ä»£ç éè¿_.extendæ¹æ³ï¼å¨samå¯¹è±¡ä¸é¢ï¼åç¡®è¯´æ¯å®çååå¯¹è±¡person.prototypeä¸é¢ï¼ï¼æ··å¥äºnamemixinç±»ã\n\nextendæ¹æ³çå®ç°éå¸¸ç®åã\n\nfunction extend(destination, source) {\n  for (var k in source) {\n    if (source.hasownproperty(k)) {\n      destination[k] = source[k];\n    }\n  }\n  return destination;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç å°sourceå¯¹è±¡çæææ¹æ³ï¼æ·»å å°destinationå¯¹è±¡ã\n\n\n# trait\n\ntrait æ¯å¦å¤ä¸ç§å¤éç»§æ¿çè§£å³æ¹æ¡ãå®ä¸ mixin å¾ç¸ä¼¼ï¼ä½æ¯æä¸äºç»å¾®çå·®å«ã\n\n * mixin å¯ä»¥åå«ç¶æï¼stateï¼ï¼trait ä¸åå«ï¼å³ trait éé¢çæ¹æ³é½æ¯äºä¸ç¸å¹²ï¼å¯ä»¥çº¿æ§åå«çãæ¯å¦ï¼trait1åå«æ¹æ³aåbï¼trait2ç»§æ¿äºtrait1ï¼åæ¶è¿åå«ä¸ä¸ªèªå·±çæ¹æ³cï¼å®éä¸å°±ç­åäºç´æ¥åå«æ¹æ³aãbãcã\n * å¯¹äºååæ¹æ³çç¢°æï¼mixin åå«äºè§£å³è§åï¼trait åæ¯æ¥éã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"SIMD",frontmatter:{title:"SIMD",date:"2020-02-09T16:00:30.000Z",permalink:"/pages/8e8f80f69b775a56",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/33.SIMD.html",relativePath:"ãES6 æç¨ãç¬è®°/33.SIMD.md",key:"v-07dc7dde",path:"/pages/8e8f80f69b775a56/",headers:[{level:2,title:"æ¦è¿°",slug:"æ¦è¿°",normalizedTitle:"æ¦è¿°",charIndex:11},{level:2,title:"æ°æ®ç±»å",slug:"æ°æ®ç±»å",normalizedTitle:"æ°æ®ç±»å",charIndex:1231},{level:2,title:"éææ¹æ³ï¼æ°å­¦è¿ç®",slug:"éææ¹æ³-æ°å­¦è¿ç®",normalizedTitle:"éææ¹æ³ï¼æ°å­¦è¿ç®",charIndex:2023},{level:3,title:"SIMD.%type%.abs()ï¼SIMD.%type%.neg()",slug:"simd-type-abs-simd-type-neg",normalizedTitle:"simd.%type%.abs()ï¼simd.%type%.neg()",charIndex:2064},{level:3,title:"SIMD.%type%.add()ï¼SIMD.%type%.addSaturate()",slug:"simd-type-add-simd-type-addsaturate",normalizedTitle:"simd.%type%.add()ï¼simd.%type%.addsaturate()",charIndex:2504},{level:3,title:"SIMD.%type%.sub()ï¼SIMD.%type%.subSaturate()",slug:"simd-type-sub-simd-type-subsaturate",normalizedTitle:"simd.%type%.sub()ï¼simd.%type%.subsaturate()",charIndex:3410},{level:3,title:"SIMD.%type%.mul()ï¼SIMD.%type%.div()ï¼SIMD.%type%.sqrt()",slug:"simd-type-mul-simd-type-div-simd-type-sqrt",normalizedTitle:"simd.%type%.mul()ï¼simd.%type%.div()ï¼simd.%type%.sqrt()",charIndex:4166},{level:3,title:"SIMD.%FloatType%.reciprocalApproximation()ï¼SIMD.%type%.reciprocalSqrtApproximation()",slug:"simd-floattype-reciprocalapproximation-simd-type-reciprocalsqrtapproximation",normalizedTitle:"simd.%floattype%.reciprocalapproximation()ï¼simd.%type%.reciprocalsqrtapproximation()",charIndex:4756},{level:3,title:"SIMD.%IntegerType%.shiftLeftByScalar()",slug:"simd-integertype-shiftleftbyscalar",normalizedTitle:"simd.%integertype%.shiftleftbyscalar()",charIndex:5323},{level:3,title:"SIMD.%IntegerType%.shiftRightByScalar()",slug:"simd-integertype-shiftrightbyscalar",normalizedTitle:"simd.%integertype%.shiftrightbyscalar()",charIndex:5717},{level:2,title:"éææ¹æ³ï¼ééå¤ç",slug:"éææ¹æ³-ééå¤ç",normalizedTitle:"éææ¹æ³ï¼ééå¤ç",charIndex:6275},{level:3,title:"SIMD.%type%.check()",slug:"simd-type-check",normalizedTitle:"simd.%type%.check()",charIndex:6289},{level:3,title:"SIMD.%type%.extractLane()ï¼SIMD.%type%.replaceLane()",slug:"simd-type-extractlane-simd-type-replacelane",normalizedTitle:"simd.%type%.extractlane()ï¼simd.%type%.replacelane()",charIndex:6577},{level:3,title:"SIMD.%type%.load()",slug:"simd-type-load",normalizedTitle:"simd.%type%.load()",charIndex:6948},{level:3,title:"SIMD.%type%.store()",slug:"simd-type-store",normalizedTitle:"simd.%type%.store()",charIndex:7721},{level:3,title:"SIMD.%type%.splat()",slug:"simd-type-splat",normalizedTitle:"simd.%type%.splat()",charIndex:8433},{level:3,title:"SIMD.%type%.swizzle()",slug:"simd-type-swizzle",normalizedTitle:"simd.%type%.swizzle()",charIndex:8654},{level:3,title:"SIMD.%type%.shuffle()",slug:"simd-type-shuffle",normalizedTitle:"simd.%type%.shuffle()",charIndex:9366},{level:2,title:"éææ¹æ³ï¼æ¯è¾è¿ç®",slug:"éææ¹æ³-æ¯è¾è¿ç®",normalizedTitle:"éææ¹æ³ï¼æ¯è¾è¿ç®",charIndex:9657},{level:3,title:"SIMD.%type%.equal()ï¼SIMD.%type%.notEqual()",slug:"simd-type-equal-simd-type-notequal",normalizedTitle:"simd.%type%.equal()ï¼simd.%type%.notequal()",charIndex:9671},{level:3,title:"SIMD.%type%.greaterThan()ï¼SIMD.%type%.greaterThanOrEqual()",slug:"simd-type-greaterthan-simd-type-greaterthanorequal",normalizedTitle:"simd.%type%.greaterthan()ï¼simd.%type%.greaterthanorequal()",charIndex:10071},{level:3,title:"SIMD.%type%.lessThan()ï¼SIMD.%type%.lessThanOrEqual()",slug:"simd-type-lessthan-simd-type-lessthanorequal",normalizedTitle:"simd.%type%.lessthan()ï¼simd.%type%.lessthanorequal()",charIndex:10507},{level:3,title:"SIMD.%type%.select()",slug:"simd-type-select",normalizedTitle:"simd.%type%.select()",charIndex:10928},{level:3,title:"SIMD.%BooleanType%.allTrue()ï¼SIMD.%BooleanType%.anyTrue()",slug:"simd-booleantype-alltrue-simd-booleantype-anytrue",normalizedTitle:"simd.%booleantype%.alltrue()ï¼simd.%booleantype%.anytrue()",charIndex:11633},{level:3,title:"SIMD.%type%.min()ï¼SIMD.%type%.minNum()",slug:"simd-type-min-simd-type-minnum",normalizedTitle:"simd.%type%.min()ï¼simd.%type%.minnum()",charIndex:12502},{level:3,title:"SIMD.%type%.max()ï¼SIMD.%type%.maxNum()",slug:"simd-type-max-simd-type-maxnum",normalizedTitle:"simd.%type%.max()ï¼simd.%type%.maxnum()",charIndex:13214},{level:2,title:"éææ¹æ³ï¼ä½è¿ç®",slug:"éææ¹æ³-ä½è¿ç®",normalizedTitle:"éææ¹æ³ï¼ä½è¿ç®",charIndex:13814},{level:3,title:"SIMD.%type%.and()ï¼SIMD.%type%.or()ï¼SIMD.%type%.xor()ï¼SIMD.%type%.not()",slug:"simd-type-and-simd-type-or-simd-type-xor-simd-type-not",normalizedTitle:"simd.%type%.and()ï¼simd.%type%.or()ï¼simd.%type%.xor()ï¼simd.%type%.not()",charIndex:13827},{level:2,title:"éææ¹æ³ï¼æ°æ®ç±»åè½¬æ¢",slug:"éææ¹æ³-æ°æ®ç±»åè½¬æ¢",normalizedTitle:"éææ¹æ³ï¼æ°æ®ç±»åè½¬æ¢",charIndex:14798},{level:2,title:"å®ä¾æ¹æ³",slug:"å®ä¾æ¹æ³",normalizedTitle:"å®ä¾æ¹æ³",charIndex:15804},{level:3,title:"SIMD.%type%.prototype.toString()",slug:"simd-type-prototype-tostring",normalizedTitle:"simd.%type%.prototype.tostring()",charIndex:15813},{level:2,title:"å®ä¾ï¼æ±å¹³åå¼",slug:"å®ä¾-æ±å¹³åå¼",normalizedTitle:"å®ä¾ï¼æ±å¹³åå¼",charIndex:15977}],excerpt:'<h1 id="simd"><a class="header-anchor" href="#simd">#</a> SIMD</h1>\n<h2 id="æ¦è¿°"><a class="header-anchor" href="#æ¦è¿°">#</a> æ¦è¿°</h2>\n<p>SIMDï¼åé³<code>/sim-dee/</code>ï¼æ¯âSingle Instruction/Multiple Dataâçç¼©åï¼æä¸ºâåæä»¤ï¼å¤æ°æ®âãå®æ¯ JavaScript æä½ CPU å¯¹åºæä»¤çæ¥å£ï¼ä½ å¯ä»¥çåè¿æ¯ä¸ç§ä¸åçè¿ç®æ§è¡æ¨¡å¼ãä¸å®ç¸å¯¹çæ¯ SISDï¼âSingle Instruction/Single Dataâï¼ï¼å³âåæä»¤ï¼åæ°æ®âã</p>\n',headersStr:"æ¦è¿° æ°æ®ç±»å éææ¹æ³ï¼æ°å­¦è¿ç® SIMD.%type%.abs()ï¼SIMD.%type%.neg() SIMD.%type%.add()ï¼SIMD.%type%.addSaturate() SIMD.%type%.sub()ï¼SIMD.%type%.subSaturate() SIMD.%type%.mul()ï¼SIMD.%type%.div()ï¼SIMD.%type%.sqrt() SIMD.%FloatType%.reciprocalApproximation()ï¼SIMD.%type%.reciprocalSqrtApproximation() SIMD.%IntegerType%.shiftLeftByScalar() SIMD.%IntegerType%.shiftRightByScalar() éææ¹æ³ï¼ééå¤ç SIMD.%type%.check() SIMD.%type%.extractLane()ï¼SIMD.%type%.replaceLane() SIMD.%type%.load() SIMD.%type%.store() SIMD.%type%.splat() SIMD.%type%.swizzle() SIMD.%type%.shuffle() éææ¹æ³ï¼æ¯è¾è¿ç® SIMD.%type%.equal()ï¼SIMD.%type%.notEqual() SIMD.%type%.greaterThan()ï¼SIMD.%type%.greaterThanOrEqual() SIMD.%type%.lessThan()ï¼SIMD.%type%.lessThanOrEqual() SIMD.%type%.select() SIMD.%BooleanType%.allTrue()ï¼SIMD.%BooleanType%.anyTrue() SIMD.%type%.min()ï¼SIMD.%type%.minNum() SIMD.%type%.max()ï¼SIMD.%type%.maxNum() éææ¹æ³ï¼ä½è¿ç® SIMD.%type%.and()ï¼SIMD.%type%.or()ï¼SIMD.%type%.xor()ï¼SIMD.%type%.not() éææ¹æ³ï¼æ°æ®ç±»åè½¬æ¢ å®ä¾æ¹æ³ SIMD.%type%.prototype.toString() å®ä¾ï¼æ±å¹³åå¼",content:"# SIMD\n\n\n# æ¦è¿°\n\nSIMDï¼åé³/sim-dee/ï¼æ¯âSingle Instruction/Multiple Dataâçç¼©åï¼æä¸ºâåæä»¤ï¼å¤æ°æ®âãå®æ¯ JavaScript æä½ CPU å¯¹åºæä»¤çæ¥å£ï¼ä½ å¯ä»¥çåè¿æ¯ä¸ç§ä¸åçè¿ç®æ§è¡æ¨¡å¼ãä¸å®ç¸å¯¹çæ¯ SISDï¼âSingle Instruction/Single Dataâï¼ï¼å³âåæä»¤ï¼åæ°æ®âã SIMD çå«ä¹æ¯ä½¿ç¨ä¸ä¸ªæä»¤ï¼å®æå¤ä¸ªæ°æ®çè¿ç®ï¼SISD çå«ä¹æ¯ä½¿ç¨ä¸ä¸ªæä»¤ï¼å®æåä¸ªæ°æ®çè¿ç®ï¼è¿æ¯ JavaScript çé»è®¤è¿ç®æ¨¡å¼ãæ¾èæè§ï¼SIMD çæ§è¡æçè¦é«äº SISDï¼æä»¥è¢«å¹¿æ³ç¨äº 3D å¾å½¢è¿ç®ãç©çæ¨¡æç­è¿ç®éè¶å¤§çé¡¹ç®ä¹ä¸­ã\n\nä¸ºäºçè§£ SIMDï¼è¯·çä¸é¢çä¾å­ã\n\nvar a = [1, 2, 3, 4];\nvar b = [5, 6, 7, 8];\nvar c = [];\n\nc[0] = a[0] + b[0];\nc[1] = a[1] + b[1];\nc[2] = a[2] + b[2];\nc[3] = a[3] + b[3];\nc // Array[6, 8, 10, 12]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»aåbçå¯¹åºæåç¸å ï¼ç»ææ¾å¥æ°ç»cãå®çè¿ç®æ¨¡å¼æ¯ä¾æ¬¡å¤çæ¯ä¸ªæ°ç»æåï¼ä¸å±æåä¸ªæ°ç»æåï¼æä»¥éè¦è¿ç® 4 æ¬¡ã\n\nå¦æéç¨ SIMD æ¨¡å¼ï¼åªè¦è¿ç®ä¸æ¬¡å°±å¤äºã\n\nvar a = SIMD.Float32x4(1, 2, 3, 4);\nvar b = SIMD.Float32x4(5, 6, 7, 8);\nvar c = SIMD.Float32x4.add(a, b); // Float32x4[6, 8, 10, 12]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¹ä¸­ï¼æ°ç»aåbçåä¸ªæåçåèªç¸å ï¼åªç¨ä¸æ¡æä»¤å°±å®æäºãå æ­¤ï¼éåº¦æ¯ä¸ä¸ç§åæ³æé«äº 4 åã\n\nä¸æ¬¡ SIMD è¿ç®ï¼å¯ä»¥å¤çå¤ä¸ªæ°æ®ï¼è¿äºæ°æ®è¢«ç§°ä¸ºâééâï¼laneï¼ãä¸é¢ä»£ç ä¸­ï¼ä¸æ¬¡è¿ç®äºåä¸ªæ°æ®ï¼å æ­¤å°±æ¯åä¸ªééã\n\nSIMD éå¸¸ç¨äºç¢éè¿ç®ã\n\nv + w = â©v1, â¦, vnâª+ â©w1, â¦, wnâª\n      = â©v1+w1, â¦, vn+wnâª\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼våwæ¯ä¸¤ä¸ªå¤åç¢éãå®ä»¬çå è¿ç®ï¼å¨ SIMD ä¸æ¯ä¸ä¸ªæä»¤ãèä¸æ¯ n ä¸ªæä»¤å®æçï¼è¿å°±å¤§å¤§æé«äºæçãè¿å¯¹äº 3D å¨ç»ãå¾åå¤çãä¿¡å·å¤çãæ°å¼å¤çãå å¯ç­è¿ç®æ¯éå¸¸éè¦çãæ¯å¦ï¼Canvas çgetImageData()ä¼å°å¾åæä»¶è¯»æä¸ä¸ªäºè¿å¶æ°ç»ï¼SIMD å°±å¾éåå¯¹äºè¿ç§æ°ç»çå¤çã\n\næ»çæ¥è¯´ï¼SIMD æ¯æ°æ®å¹¶è¡å¤çï¼parallelismï¼çä¸ç§ææ®µï¼å¯ä»¥å éä¸äºè¿ç®å¯éåæä½çéåº¦ãå°æ¥ä¸ WebAssembly ç»åä»¥åï¼å¯ä»¥è®© JavaScript è¾¾å°äºè¿å¶ä»£ç çè¿è¡éåº¦ã\n\n\n# æ°æ®ç±»å\n\nSIMD æä¾ 12 ç§æ°æ®ç±»åï¼æ»é¿åº¦é½æ¯ 128 ä¸ªäºè¿å¶ä½ã\n\n * Float32x4ï¼åä¸ª 32 ä½æµ®ç¹æ°\n * Float64x2ï¼ä¸¤ä¸ª 64 ä½æµ®ç¹æ°\n * Int32x4ï¼åä¸ª 32 ä½æ´æ°\n * Int16x8ï¼å«ä¸ª 16 ä½æ´æ°\n * Int8x16ï¼åå­ä¸ª 8 ä½æ´æ°\n * Uint32x4ï¼åä¸ªæ ç¬¦å·ç 32 ä½æ´æ°\n * Uint16x8ï¼å«ä¸ªæ ç¬¦å·ç 16 ä½æ´æ°\n * Uint8x16ï¼åå­ä¸ªæ ç¬¦å·ç 8 ä½æ´æ°\n * Bool32x4ï¼åä¸ª 32 ä½å¸å°å¼\n * Bool16x8ï¼å«ä¸ª 16 ä½å¸å°å¼\n * Bool8x16ï¼åå­ä¸ª 8 ä½å¸å°å¼\n * Bool64x2ï¼ä¸¤ä¸ª 64 ä½å¸å°å¼\n\næ¯ç§æ°æ®ç±»åè¢«xç¬¦å·åéæä¸¤é¨åï¼åé¢çé¨åè¡¨ç¤ºééæ°ï¼åé¢çé¨åè¡¨ç¤ºæ¯ä¸ªééçå®½åº¦åç±»åãæ¯å¦ï¼Float32x4å°±è¡¨ç¤ºè¿ä¸ªå¼æ 4 ä¸ªééï¼æ¯ä¸ªééæ¯ä¸ä¸ª 32 ä½æµ®ç¹æ°ã\n\næ¯ä¸ªééä¹ä¸­ï¼å¯ä»¥æ¾ç½®åç§æ°æ®ã\n\n * æµ®ç¹æ°ï¼floatï¼æ¯å¦ 1.0ï¼\n * å¸¦ç¬¦å·çæ´æ°ï¼Intï¼æ¯å¦-1ï¼\n * æ ç¬¦å·çæ´æ°ï¼Uintï¼æ¯å¦ 1ï¼\n * å¸å°å¼ï¼Boolï¼åå«trueåfalseä¸¤ç§å¼ï¼\n\næ¯ç§ SIMD çæ°æ®ç±»åé½æ¯ä¸ä¸ªå½æ°æ¹æ³ï¼å¯ä»¥ä¼ å¥åæ°ï¼çæå¯¹åºçå¼ã\n\nvar a = SIMD.Float32x4(1.0, 2.0, 3.0, 4.0);\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼åéaå°±æ¯ä¸ä¸ª 128 ä½ãåå«åä¸ª 32 ä½æµ®ç¹æ°ï¼å³åä¸ªééï¼çå¼ã\n\næ³¨æï¼è¿äºæ°æ®ç±»åæ¹æ³é½ä¸æ¯æé å½æ°ï¼åé¢ä¸è½å newï¼å¦åä¼æ¥éã\n\nvar v = new SIMD.Float32x4(0, 1, 2, 3);\n// TypeError: SIMD.Float32x4 is not a constructor\n\n\n1\n2\n\n\n\n# éææ¹æ³ï¼æ°å­¦è¿ç®\n\næ¯ç§æ°æ®ç±»åé½æä¸ç³»åè¿ç®ç¬¦ï¼æ¯æåºæ¬çæ°å­¦è¿ç®ã\n\n\n# SIMD.%type%.abs()ï¼SIMD.%type%.neg()\n\nabsæ¹æ³æ¥åä¸ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼å°å®çæ¯ä¸ªééé½è½¬æç»å¯¹å¼ï¼ä½ä¸ºä¸ä¸ªæ°ç SIMD å¼è¿åã\n\nvar a = SIMD.Float32x4(-1, -2, 0, NaN);\nSIMD.Float32x4.abs(a)\n// Float32x4[1, 2, 0, NaN]\n\n\n1\n2\n3\n\n\nnegæ¹æ³æ¥åä¸ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼å°å®çæ¯ä¸ªééé½è½¬æè´å¼ï¼ä½ä¸ºä¸ä¸ªæ°ç SIMD å¼è¿åã\n\nvar a = SIMD.Float32x4(-1, -2, 3, 0);\nSIMD.Float32x4.neg(a)\n// Float32x4[1, 2, -3, -0]\n\nvar b = SIMD.Float64x2(NaN, Infinity);\nSIMD.Float64x2.neg(b)\n// Float64x2[NaN, -Infinity]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# SIMD.%type%.add()ï¼SIMD.%type%.addSaturate()\n\naddæ¹æ³æ¥åä¸¤ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼å°å®ä»¬çæ¯ä¸ªééç¸å ï¼ä½ä¸ºä¸ä¸ªæ°ç SIMD å¼è¿åã\n\nvar a = SIMD.Float32x4(1.0, 2.0, 3.0, 4.0);\nvar b = SIMD.Float32x4(5.0, 10.0, 15.0, 20.0);\nvar c = SIMD.Float32x4.add(a, b);\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼ç»è¿å æ³è¿ç®ï¼æ°ç SIMD å¼ä¸º(6.0, 12.0, 18.0. 24.0)ã\n\naddSaturateæ¹æ³è·addæ¹æ³çä½ç¨ç¸åï¼é½æ¯ä¸¤ä¸ªééç¸å ï¼ä½æ¯æº¢åºçå¤çä¸ä¸è´ãå¯¹äºaddæ¹æ³ï¼å¦æä¸¤ä¸ªå¼ç¸å åçæº¢åºï¼æº¢åºçäºè¿å¶ä½ä¼è¢«ä¸¢å¼; addSaturateæ¹æ³åæ¯è¿åè¯¥æ°æ®ç±»åçæå¤§å¼ã\n\nvar a = SIMD.Uint16x8(65533, 65534, 65535, 65535, 1, 1, 1, 1);\nvar b = SIMD.Uint16x8(1, 1, 1, 5000, 1, 1, 1, 1);\nSIMD.Uint16x8.addSaturate(a, b);\n// Uint16x8[65534, 65535, 65535, 65535, 2, 2, 2, 2]\n\nvar c = SIMD.Int16x8(32765, 32766, 32767, 32767, 1, 1, 1, 1);\nvar d = SIMD.Int16x8(1, 1, 1, 5000, 1, 1, 1, 1);\nSIMD.Int16x8.addSaturate(c, d);\n// Int16x8[32766, 32767, 32767, 32767, 2, 2, 2, 2]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼Uint16çæå¤§å¼æ¯ 65535ï¼Int16çæå¤§å¼æ¯ 32767ãä¸æ¦åçæº¢åºï¼å°±è¿åè¿ä¸¤ä¸ªå¼ã\n\næ³¨æï¼Uint32x4åInt32x4è¿ä¸¤ç§æ°æ®ç±»åæ²¡æaddSaturateæ¹æ³ã\n\n\n# SIMD.%type%.sub()ï¼SIMD.%type%.subSaturate()\n\nsubæ¹æ³æ¥åä¸¤ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼å°å®ä»¬çæ¯ä¸ªééç¸åï¼ä½ä¸ºä¸ä¸ªæ°ç SIMD å¼è¿åã\n\nvar a = SIMD.Float32x4(-1, -2, 3, 4);\nvar b = SIMD.Float32x4(3, 3, 3, 3);\nSIMD.Float32x4.sub(a, b)\n// Float32x4[-4, -5, 0, 1]\n\n\n1\n2\n3\n4\n\n\nsubSaturateæ¹æ³è·subæ¹æ³çä½ç¨ç¸åï¼é½æ¯ä¸¤ä¸ªééç¸åï¼ä½æ¯æº¢åºçå¤çä¸ä¸è´ãå¯¹äºsubæ¹æ³ï¼å¦æä¸¤ä¸ªå¼ç¸ååçæº¢åºï¼æº¢åºçäºè¿å¶ä½ä¼è¢«ä¸¢å¼; subSaturateæ¹æ³åæ¯è¿åè¯¥æ°æ®ç±»åçæå°å¼ã\n\nvar a = SIMD.Uint16x8(5, 1, 1, 1, 1, 1, 1, 1);\nvar b = SIMD.Uint16x8(10, 1, 1, 1, 1, 1, 1, 1);\nSIMD.Uint16x8.subSaturate(a, b)\n// Uint16x8[0, 0, 0, 0, 0, 0, 0, 0]\n\nvar c = SIMD.Int16x8(-100, 0, 0, 0, 0, 0, 0, 0);\nvar d = SIMD.Int16x8(32767, 0, 0, 0, 0, 0, 0, 0);\nSIMD.Int16x8.subSaturate(c, d)\n// Int16x8[-32768, 0, 0, 0, 0, 0, 0, 0, 0]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼Uint16çæå°å¼æ¯0ï¼Int16çæå°å¼æ¯-32678ãä¸æ¦è¿ç®åçæº¢åºï¼å°±è¿åæå°å¼ã\n\n\n# SIMD.%type%.mul()ï¼SIMD.%type%.div()ï¼SIMD.%type%.sqrt()\n\nmulæ¹æ³æ¥åä¸¤ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼å°å®ä»¬çæ¯ä¸ªééç¸ä¹ï¼ä½ä¸ºä¸ä¸ªæ°ç SIMD å¼è¿åã\n\nvar a = SIMD.Float32x4(-1, -2, 3, 4);\nvar b = SIMD.Float32x4(3, 3, 3, 3);\nSIMD.Float32x4.mul(a, b)\n// Float32x4[-3, -6, 9, 12]\n\n\n1\n2\n3\n4\n\n\ndivæ¹æ³æ¥åä¸¤ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼å°å®ä»¬çæ¯ä¸ªééç¸é¤ï¼ä½ä¸ºä¸ä¸ªæ°ç SIMD å¼è¿åã\n\nvar a = SIMD.Float32x4(2, 2, 2, 2);\nvar b = SIMD.Float32x4(4, 4, 4, 4);\nSIMD.Float32x4.div(a, b)\n// Float32x4[0.5, 0.5, 0.5, 0.5]\n\n\n1\n2\n3\n4\n\n\nsqrtæ¹æ³æ¥åä¸ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼æ±åºæ¯ä¸ªééçå¹³æ¹æ ¹ï¼ä½ä¸ºä¸ä¸ªæ°ç SIMD å¼è¿åã\n\nvar b = SIMD.Float64x2(4, 8);\nSIMD.Float64x2.sqrt(b)\n// Float64x2[2, 2.8284271247461903]\n\n\n1\n2\n3\n\n\n\n# SIMD.%FloatType%.reciprocalApproximation()ï¼SIMD.%type%.reciprocalSqrtApproximation()\n\nreciprocalApproximationæ¹æ³æ¥åä¸ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼æ±åºæ¯ä¸ªééçåæ°ï¼1 / xï¼ï¼ä½ä¸ºä¸ä¸ªæ°ç SIMD å¼è¿åã\n\nvar a = SIMD.Float32x4(1, 2, 3, 4);\nSIMD.Float32x4.reciprocalApproximation(a);\n// Float32x4[1, 0.5, 0.3333333432674408, 0.25]\n\n\n1\n2\n3\n\n\nreciprocalSqrtApproximationæ¹æ³æ¥åä¸ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼æ±åºæ¯ä¸ªééçå¹³æ¹æ ¹çåæ°ï¼1 / (x^0.5)ï¼ï¼ä½ä¸ºä¸ä¸ªæ°ç SIMD å¼è¿åã\n\nvar a = SIMD.Float32x4(1, 2, 3, 4);\nSIMD.Float32x4.reciprocalSqrtApproximation(a)\n// Float32x4[1, 0.7071067690849304, 0.5773502588272095, 0.5]\n\n\n1\n2\n3\n\n\næ³¨æï¼åªææµ®ç¹æ°çæ°æ®ç±»åææè¿ä¸¤ä¸ªæ¹æ³ã\n\n\n# SIMD.%IntegerType%.shiftLeftByScalar()\n\nshiftLeftByScalaræ¹æ³æ¥åä¸ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼ç¶åå°æ¯ä¸ªééçå¼å·¦ç§»æå®çä½æ°ï¼ä½ä¸ºä¸ä¸ªæ°ç SIMD å¼è¿åã\n\nvar a = SIMD.Int32x4(1, 2, 4, 8);\nSIMD.Int32x4.shiftLeftByScalar(a, 1);\n// Int32x4[2, 4, 8, 16]\n\n\n1\n2\n3\n\n\nå¦æå·¦ç§»åï¼æ°çå¼è¶åºäºå½åæ°æ®ç±»åçä½æ°ï¼æº¢åºçé¨åä¼è¢«ä¸¢å¼ã\n\nvar ix4 = SIMD.Int32x4(1, 2, 3, 4);\nvar jx4 = SIMD.Int32x4.shiftLeftByScalar(ix4, 32);\n// Int32x4[0, 0, 0, 0]\n\n\n1\n2\n3\n\n\næ³¨æï¼åªææ´æ°çæ°æ®ç±»åææè¿ä¸ªæ¹æ³ã\n\n\n# SIMD.%IntegerType%.shiftRightByScalar()\n\nshiftRightByScalaræ¹æ³æ¥åä¸ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼ç¶åå°æ¯ä¸ªééçå¼å³ç§»æå®çä½æ°ï¼è¿åä¸ä¸ªæ°ç SIMD å¼ã\n\nvar a = SIMD.Int32x4(1, 2, 4, -8);\nSIMD.Int32x4.shiftRightByScalar(a, 1);\n// Int32x4[0, 1, 2, -4]\n\n\n1\n2\n3\n\n\nå¦æåæ¥ééçå¼æ¯å¸¦ç¬¦å·çå¼ï¼åç¬¦å·ä½ä¿æä¸åï¼ä¸åå³ç§»å½±åãå¦ææ¯ä¸å¸¦ç¬¦å·ä½çå¼ï¼åå³ç§»åå¤´é¨ä¼è¡¥0ã\n\nvar a = SIMD.Uint32x4(1, 2, 4, -8);\nSIMD.Uint32x4.shiftRightByScalar(a, 1);\n// Uint32x4[0, 1, 2, 2147483644]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼-8å³ç§»ä¸ä½åæäº2147483644ï¼æ¯å ä¸ºå¯¹äº 32 ä½æ ç¬¦å·æ´æ°æ¥è¯´ï¼-8çäºè¿å¶å½¢å¼æ¯11111111111111111111111111111000ï¼å³ç§»ä¸ä½å°±åæäº01111111111111111111111111111100ï¼ç¸å½äº2147483644ã\n\næ³¨æï¼åªææ´æ°çæ°æ®ç±»åææè¿ä¸ªæ¹æ³ã\n\n\n# éææ¹æ³ï¼ééå¤ç\n\n\n# SIMD.%type%.check()\n\ncheckæ¹æ³ç¨äºæ£æ¥ä¸ä¸ªå¼æ¯å¦ä¸ºå½åç±»åç SIMD å¼ãå¦ææ¯çï¼å°±è¿åè¿ä¸ªå¼ï¼å¦åå°±æ¥éã\n\nvar a = SIMD.Float32x4(1, 2, 3, 9);\n\nSIMD.Float32x4.check(a);\n// Float32x4[1, 2, 3, 9]\n\nSIMD.Float32x4.check([1,2,3,4]) // æ¥é\nSIMD.Int32x4.check(a) // æ¥é\nSIMD.Int32x4.check('hello world') // æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# SIMD.%type%.extractLane()ï¼SIMD.%type%.replaceLane()\n\nextractLaneæ¹æ³ç¨äºè¿åç»å®ééçå¼ãå®æ¥åä¸¤ä¸ªåæ°ï¼åå«æ¯ SIMD å¼åééç¼å·ã\n\nvar t = SIMD.Float32x4(1, 2, 3, 4);\nSIMD.Float32x4.extractLane(t, 2) // 3\n\n\n1\n2\n\n\nreplaceLaneæ¹æ³ç¨äºæ¿æ¢æå®ééçå¼ï¼å¹¶è¿åä¸ä¸ªæ°ç SIMD å¼ãå®æ¥åä¸ä¸ªåæ°ï¼åå«æ¯åæ¥ç SIMD å¼ãééç¼å·åæ°çééå¼ã\n\nvar t = SIMD.Float32x4(1, 2, 3, 4);\nSIMD.Float32x4.replaceLane(t, 2, 42)\n// Float32x4[1, 2, 42, 4]\n\n\n1\n2\n3\n\n\n\n# SIMD.%type%.load()\n\nloadæ¹æ³ç¨äºä»äºè¿å¶æ°ç»è¯»å¥æ°æ®ï¼çæä¸ä¸ªæ°ç SIMD å¼ã\n\nvar a = new Int32Array([1,2,3,4,5,6,7,8]);\nSIMD.Int32x4.load(a, 0);\n// Int32x4[1, 2, 3, 4]\n\nvar b = new Int32Array([1,2,3,4,5,6,7,8]);\nSIMD.Int32x4.load(a, 2);\n// Int32x4[3, 4, 5, 6]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nloadæ¹æ³æ¥åä¸¤ä¸ªåæ°ï¼ä¸ä¸ªäºè¿å¶æ°ç»åå¼å§è¯»åçä½ç½®ï¼ä» 0 å¼å§ï¼ãå¦æä½ç½®ä¸åæ³ï¼æ¯å¦-1æèè¶åºäºè¿å¶æ°ç»çå¤§å°ï¼ï¼å°±ä¼æåºä¸ä¸ªéè¯¯ã\n\nè¿ä¸ªæ¹æ³è¿æä¸ä¸ªåç§load1()ãload2()ãload3()ï¼è¡¨ç¤ºä»æå®ä½ç½®å¼å§ï¼åªå è½½ä¸ä¸ªééãäºä¸ªééãä¸ä¸ªééçå¼ã\n\n// æ ¼å¼\nSIMD.Int32x4.load(tarray, index)\nSIMD.Int32x4.load1(tarray, index)\nSIMD.Int32x4.load2(tarray, index)\nSIMD.Int32x4.load3(tarray, index)\n\n// å®ä¾\nvar a = new Int32Array([1,2,3,4,5,6,7,8]);\nSIMD.Int32x4.load1(a, 0);\n// Int32x4[1, 0, 0, 0]\nSIMD.Int32x4.load2(a, 0);\n// Int32x4[1, 2, 0, 0]\nSIMD.Int32x4.load3(a, 0);\n// Int32x4[1, 2, 3,0]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# SIMD.%type%.store()\n\nstoreæ¹æ³ç¨äºå°ä¸ä¸ª SIMD å¼ï¼åå¥ä¸ä¸ªäºè¿å¶æ°ç»ãå®æ¥åä¸ä¸ªåæ°ï¼åå«æ¯äºè¿å¶æ°ç»ãå¼å§åå¥çæ°ç»ä½ç½®ãSIMD å¼ãå®è¿ååå¥å¼ä»¥åçäºè¿å¶æ°ç»ã\n\nvar t1 = new Int32Array(8);\nvar v1 = SIMD.Int32x4(1, 2, 3, 4);\nSIMD.Int32x4.store(t1, 0, v1)\n// Int32Array[1, 2, 3, 4, 0, 0, 0, 0]\n\nvar t2 = new Int32Array(8);\nvar v2 = SIMD.Int32x4(1, 2, 3, 4);\nSIMD.Int32x4.store(t2, 2, v2)\n// Int32Array[0, 0, 1, 2, 3, 4, 0, 0]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼t1æ¯ä¸ä¸ªäºè¿å¶æ°ç»ï¼v1æ¯ä¸ä¸ª SIMD å¼ï¼åªæåä¸ªééãæä»¥åå¥t1ä»¥åï¼åªæååä¸ªä½ç½®æå¼ï¼ååä¸ªä½ç½®é½æ¯ 0ãèt2æ¯ä» 2 å·ä½ç½®å¼å§åå¥ï¼æä»¥åä¸¤ä¸ªä½ç½®ååä¸¤ä¸ªä½ç½®é½æ¯ 0ã\n\nè¿ä¸ªæ¹æ³è¿æä¸ä¸ªåç§store1()ãstore2()åstore3()ï¼è¡¨ç¤ºåªåå¥ä¸ä¸ªééãäºä¸ªééåä¸ä¸ªééçå¼ã\n\nvar tarray = new Int32Array(8);\nvar value = SIMD.Int32x4(1, 2, 3, 4);\nSIMD.Int32x4.store1(tarray, 0, value);\n// Int32Array[1, 0, 0, 0, 0, 0, 0, 0]\n\n\n1\n2\n3\n4\n\n\n\n# SIMD.%type%.splat()\n\nsplatæ¹æ³è¿åä¸ä¸ªæ°ç SIMD å¼ï¼è¯¥å¼çææééé½ä¼è®¾æåä¸ä¸ªé¢åç»å®çå¼ã\n\nSIMD.Float32x4.splat(3);\n// Float32x4[3, 3, 3, 3]\nSIMD.Float64x2.splat(3);\n// Float64x2[3, 3]\n\n\n1\n2\n3\n4\n\n\nå¦æçç¥åæ°ï¼æææ´æ°åç SIMD å¼é½ä¼è®¾å®0ï¼æµ®ç¹åç SIMD å¼é½ä¼è®¾æNaNã\n\n\n# SIMD.%type%.swizzle()\n\nswizzleæ¹æ³è¿åä¸ä¸ªæ°ç SIMD å¼ï¼éæ°æååæç SIMD å¼çééé¡ºåºã\n\nvar t = SIMD.Float32x4(1, 2, 3, 4);\nSIMD.Float32x4.swizzle(t, 1, 2, 0, 3);\n// Float32x4[2,3,1,4]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼swizzleæ¹æ³çç¬¬ä¸ä¸ªåæ°æ¯åæç SIMD å¼ï¼åé¢çåæ°å¯¹åºå°è¦è¿åç SIMD å¼çåä¸ªééãå®çæææ¯æ°ç SIMD çåä¸ªééï¼ä¾æ¬¡æ¯åæ¥ SIMD å¼ç 1 å·ééã2 å·ééã0 å·ééã3 å·ééãç±äº SIMD å¼æå¤å¯ä»¥æ 16 ä¸ªééï¼æä»¥swizzleæ¹æ³é¤äºç¬¬ä¸ä¸ªåæ°ä»¥å¤ï¼æå¤è¿å¯ä»¥æ¥å 16 ä¸ªåæ°ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nvar a = SIMD.Float32x4(1.0, 2.0, 3.0, 4.0);\n// Float32x4[1.0, 2.0, 3.0, 4.0]\n\nvar b = SIMD.Float32x4.swizzle(a, 0, 0, 1, 1);\n// Float32x4[1.0, 1.0, 2.0, 2.0]\n\nvar c = SIMD.Float32x4.swizzle(a, 3, 3, 3, 3);\n// Float32x4[4.0, 4.0, 4.0, 4.0]\n\nvar d = SIMD.Float32x4.swizzle(a, 3, 2, 1, 0);\n// Float32x4[4.0, 3.0, 2.0, 1.0]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# SIMD.%type%.shuffle()\n\nshuffleæ¹æ³ä»ä¸¤ä¸ª SIMD å¼ä¹ä¸­ååºæå®ééï¼è¿åä¸ä¸ªæ°ç SIMD å¼ã\n\nvar a = SIMD.Float32x4(1, 2, 3, 4);\nvar b = SIMD.Float32x4(5, 6, 7, 8);\n\nSIMD.Float32x4.shuffle(a, b, 1, 5, 7, 2);\n// Float32x4[2, 6, 8, 3]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼aåbä¸å±æ 8 ä¸ªééï¼ä¾æ¬¡ç¼å·ä¸º 0 å° 7ãshuffleæ ¹æ®ç¼å·ï¼ååºç¸åºçééï¼è¿åä¸ä¸ªæ°ç SIMD å¼ã\n\n\n# éææ¹æ³ï¼æ¯è¾è¿ç®\n\n\n# SIMD.%type%.equal()ï¼SIMD.%type%.notEqual()\n\nequalæ¹æ³ç¨æ¥æ¯è¾ä¸¤ä¸ª SIMD å¼aåbçæ¯ä¸ä¸ªééï¼æ ¹æ®ä¸¤èæ¯å¦ç²¾ç¡®ç¸ç­ï¼a === bï¼ï¼å¾å°ä¸ä¸ªå¸å°å¼ãæåï¼ææééçæ¯è¾ç»æï¼ç»æä¸ä¸ªæ°ç SIMD å¼ï¼ä½ä¸ºæ©ç è¿åãnotEqualæ¹æ³åæ¯æ¯è¾ä¸¤ä¸ªééæ¯å¦ä¸ç¸ç­ï¼a !== bï¼ã\n\nvar a = SIMD.Float32x4(1, 2, 3, 9);\nvar b = SIMD.Float32x4(1, 4, 7, 9);\n\nSIMD.Float32x4.equal(a,b)\n// Bool32x4[true, false, false, true]\n\nSIMD.Float32x4.notEqual(a,b);\n// Bool32x4[false, true, true, false]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# SIMD.%type%.greaterThan()ï¼SIMD.%type%.greaterThanOrEqual()\n\ngreatThanæ¹æ³ç¨æ¥æ¯è¾ä¸¤ä¸ª SIMD å¼aåbçæ¯ä¸ä¸ªééï¼å¦æå¨è¯¥ééä¸­ï¼aè¾å¤§å°±å¾å°trueï¼å¦åå¾å°falseãæåï¼ææééçæ¯è¾ç»æï¼ç»æä¸ä¸ªæ°ç SIMD å¼ï¼ä½ä¸ºæ©ç è¿åãgreaterThanOrEqualåæ¯æ¯è¾aæ¯å¦å¤§äºç­äºbã\n\nvar a = SIMD.Float32x4(1, 6, 3, 11);\nvar b = SIMD.Float32x4(1, 4, 7, 9);\n\nSIMD.Float32x4.greaterThan(a, b)\n// Bool32x4[false, true, false, true]\n\nSIMD.Float32x4.greaterThanOrEqual(a, b)\n// Bool32x4[true, true, false, true]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# SIMD.%type%.lessThan()ï¼SIMD.%type%.lessThanOrEqual()\n\nlessThanæ¹æ³ç¨æ¥æ¯è¾ä¸¤ä¸ª SIMD å¼aåbçæ¯ä¸ä¸ªééï¼å¦æå¨è¯¥ééä¸­ï¼aè¾å°å°±å¾å°trueï¼å¦åå¾å°falseãæåï¼ææééçæ¯è¾ç»æï¼ä¼ç»æä¸ä¸ªæ°ç SIMD å¼ï¼ä½ä¸ºæ©ç è¿åãlessThanOrEqualæ¹æ³åæ¯æ¯è¾aæ¯å¦ç­äºbã\n\nvar a = SIMD.Float32x4(1, 2, 3, 11);\nvar b = SIMD.Float32x4(1, 4, 7, 9);\n\nSIMD.Float32x4.lessThan(a, b)\n// Bool32x4[false, true, true, false]\n\nSIMD.Float32x4.lessThanOrEqual(a, b)\n// Bool32x4[true, true, true, false]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# SIMD.%type%.select()\n\nselectæ¹æ³éè¿æ©ç çæä¸ä¸ªæ°ç SIMD å¼ãå®æ¥åä¸ä¸ªåæ°ï¼åå«æ¯æ©ç åä¸¤ä¸ª SIMD å¼ã\n\nvar a = SIMD.Float32x4(1, 2, 3, 4);\nvar b = SIMD.Float32x4(5, 6, 7, 8);\n\nvar mask = SIMD.Bool32x4(true, false, false, true);\n\nSIMD.Float32x4.select(mask, a, b);\n// Float32x4[1, 6, 7, 4]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼selectæ¹æ³æ¥åæ©ç åä¸¤ä¸ª SIMD å¼ä½ä¸ºåæ°ãå½æä¸ªééå¯¹åºçæ©ç ä¸ºtrueæ¶ï¼ä¼éæ©ç¬¬ä¸ä¸ª SIMD å¼çå¯¹åºééï¼å¦åéæ©ç¬¬äºä¸ª SIMD å¼çå¯¹åºééã\n\nè¿ä¸ªæ¹æ³éå¸¸ä¸æ¯è¾è¿ç®ç¬¦ç»åä½¿ç¨ã\n\nvar a = SIMD.Float32x4(0, 12, 3, 4);\nvar b = SIMD.Float32x4(0, 6, 7, 50);\n\nvar mask = SIMD.Float32x4.lessThan(a,b);\n// Bool32x4[false, false, true, true]\n\nvar result = SIMD.Float32x4.select(mask, a, b);\n// Float32x4[0, 6, 3, 4]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼åéè¿lessThanæ¹æ³çæä¸ä¸ªæ©ç ï¼ç¶åéè¿selectæ¹æ³çæä¸ä¸ªç±æ¯ä¸ªééçè¾å°å¼ç»æçæ°ç SIMD å¼ã\n\n\n# SIMD.%BooleanType%.allTrue()ï¼SIMD.%BooleanType%.anyTrue()\n\nallTrueæ¹æ³æ¥åä¸ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼ç¶åè¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºè¯¥ SIMD å¼çææééæ¯å¦é½ä¸ºtrueã\n\nvar a = SIMD.Bool32x4(true, true, true, true);\nvar b = SIMD.Bool32x4(true, false, true, true);\n\nSIMD.Bool32x4.allTrue(a); // true\nSIMD.Bool32x4.allTrue(b); // false\n\n\n1\n2\n3\n4\n5\n\n\nanyTrueæ¹æ³åæ¯åªè¦æä¸ä¸ªééä¸ºtrueï¼å°±è¿åtrueï¼å¦åè¿åfalseã\n\nvar a = SIMD.Bool32x4(false, false, false, false);\nvar b = SIMD.Bool32x4(false, false, true, false);\n\nSIMD.Bool32x4.anyTrue(a); // false\nSIMD.Bool32x4.anyTrue(b); // true\n\n\n1\n2\n3\n4\n5\n\n\næ³¨æï¼åªæåç§å¸å°å¼æ°æ®ç±»åï¼Bool32x4ãBool16x8ãBool8x16ãBool64x2ï¼ææè¿ä¸¤ä¸ªæ¹æ³ã\n\nè¿ä¸¤ä¸ªæ¹æ³éå¸¸ä¸æ¯è¾è¿ç®ç¬¦ç»åä½¿ç¨ã\n\nvar ax4    = SIMD.Float32x4(1.0, 2.0, 3.0, 4.0);\nvar bx4    = SIMD.Float32x4(0.0, 6.0, 7.0, 8.0);\nvar ix4    = SIMD.Float32x4.lessThan(ax4, bx4);\nvar b1     = SIMD.Int32x4.allTrue(ix4); // false\nvar b2     = SIMD.Int32x4.anyTrue(ix4); // true\n\n\n1\n2\n3\n4\n5\n\n\n\n# SIMD.%type%.min()ï¼SIMD.%type%.minNum()\n\nminæ¹æ³æ¥åä¸¤ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼å°ä¸¤èçå¯¹åºééçè¾å°å¼ï¼ç»æä¸ä¸ªæ°ç SIMD å¼è¿åã\n\nvar a = SIMD.Float32x4(-1, -2, 3, 5.2);\nvar b = SIMD.Float32x4(0, -4, 6, 5.5);\nSIMD.Float32x4.min(a, b);\n// Float32x4[-1, -4, 3, 5.2]\n\n\n1\n2\n3\n4\n\n\nå¦ææä¸ä¸ªééçå¼æ¯NaNï¼åä¼ä¼åè¿åNaNã\n\nvar c = SIMD.Float64x2(NaN, Infinity)\nvar d = SIMD.Float64x2(1337, 42);\nSIMD.Float64x2.min(c, d);\n// Float64x2[NaN, 42]\n\n\n1\n2\n3\n4\n\n\nminNumæ¹æ³ä¸minçä½ç¨ä¸æ¨¡ä¸æ ·ï¼å¯ä¸çåºå«æ¯å¦ææä¸ä¸ªééçå¼æ¯NaNï¼åä¼ä¼åè¿åå¦ä¸ä¸ªééçå¼ã\n\nvar ax4 = SIMD.Float32x4(1.0, 2.0, NaN, NaN);\nvar bx4 = SIMD.Float32x4(2.0, 1.0, 3.0, NaN);\nvar cx4 = SIMD.Float32x4.min(ax4, bx4);\n// Float32x4[1.0, 1.0, NaN, NaN]\nvar dx4 = SIMD.Float32x4.minNum(ax4, bx4);\n// Float32x4[1.0, 1.0, 3.0, NaN]\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# SIMD.%type%.max()ï¼SIMD.%type%.maxNum()\n\nmaxæ¹æ³æ¥åä¸¤ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼å°ä¸¤èçå¯¹åºééçè¾å¤§å¼ï¼ç»æä¸ä¸ªæ°ç SIMD å¼è¿åã\n\nvar a = SIMD.Float32x4(-1, -2, 3, 5.2);\nvar b = SIMD.Float32x4(0, -4, 6, 5.5);\nSIMD.Float32x4.max(a, b);\n// Float32x4[0, -2, 6, 5.5]\n\n\n1\n2\n3\n4\n\n\nå¦ææä¸ä¸ªééçå¼æ¯NaNï¼åä¼ä¼åè¿åNaNã\n\nvar c = SIMD.Float64x2(NaN, Infinity)\nvar d = SIMD.Float64x2(1337, 42);\nSIMD.Float64x2.max(c, d)\n// Float64x2[NaN, Infinity]\n\n\n1\n2\n3\n4\n\n\nmaxNumæ¹æ³ä¸maxçä½ç¨ä¸æ¨¡ä¸æ ·ï¼å¯ä¸çåºå«æ¯å¦ææä¸ä¸ªééçå¼æ¯NaNï¼åä¼ä¼åè¿åå¦ä¸ä¸ªééçå¼ã\n\nvar c = SIMD.Float64x2(NaN, Infinity)\nvar d = SIMD.Float64x2(1337, 42);\nSIMD.Float64x2.maxNum(c, d)\n// Float64x2[1337, Infinity]\n\n\n1\n2\n3\n4\n\n\n\n# éææ¹æ³ï¼ä½è¿ç®\n\n\n# SIMD.%type%.and()ï¼SIMD.%type%.or()ï¼SIMD.%type%.xor()ï¼SIMD.%type%.not()\n\nandæ¹æ³æ¥åä¸¤ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼è¿åä¸¤èå¯¹åºçééè¿è¡äºè¿å¶ANDè¿ç®ï¼&ï¼åå¾å°çæ°ç SIMD å¼ã\n\nvar a = SIMD.Int32x4(1, 2, 4, 8);\nvar b = SIMD.Int32x4(5, 5, 5, 5);\nSIMD.Int32x4.and(a, b)\n// Int32x4[1, 0, 4, 0]\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼ä»¥éé0ä¸ºä¾ï¼1çäºè¿å¶å½¢å¼æ¯0001ï¼5çäºè¿å¶å½¢å¼æ¯01001ï¼æä»¥è¿è¡ANDè¿ç®ä»¥åï¼å¾å°0001ã\n\noræ¹æ³æ¥åä¸¤ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼è¿åä¸¤èå¯¹åºçééè¿è¡äºè¿å¶ORè¿ç®ï¼|ï¼åå¾å°çæ°ç SIMD å¼ã\n\nvar a = SIMD.Int32x4(1, 2, 4, 8);\nvar b = SIMD.Int32x4(5, 5, 5, 5);\nSIMD.Int32x4.or(a, b)\n// Int32x4[5, 7, 5, 13]\n\n\n1\n2\n3\n4\n\n\nxoræ¹æ³æ¥åä¸¤ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼è¿åä¸¤èå¯¹åºçééè¿è¡äºè¿å¶âå¼æâè¿ç®ï¼^ï¼åå¾å°çæ°ç SIMD å¼ã\n\nvar a = SIMD.Int32x4(1, 2, 4, 8);\nvar b = SIMD.Int32x4(5, 5, 5, 5);\nSIMD.Int32x4.xor(a, b)\n// Int32x4[4, 7, 1, 13]\n\n\n1\n2\n3\n4\n\n\nnotæ¹æ³æ¥åä¸ä¸ª SIMD å¼ä½ä¸ºåæ°ï¼è¿åæ¯ä¸ªééè¿è¡äºè¿å¶âå¦âè¿ç®ï¼~ï¼åå¾å°çæ°ç SIMD å¼ã\n\nvar a = SIMD.Int32x4(1, 2, 4, 8);\nSIMD.Int32x4.not(a)\n// Int32x4[-2, -3, -5, -9]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼1çå¦è¿ç®ä¹æä»¥å¾å°-2ï¼æ¯å ä¸ºå¨è®¡ç®æºåé¨ï¼è´æ°éç¨â2 çè¡¥ç âè¿ç§å½¢å¼è¿è¡è¡¨ç¤ºãä¹å°±æ¯è¯´ï¼æ´æ°nçè´æ°å½¢å¼-nï¼æ¯å¯¹æ¯ä¸ä¸ªäºè¿å¶ä½ååä»¥åï¼åå ä¸ 1ãå æ­¤ï¼ç´æ¥ååå°±ç¸å½äºè´æ°å½¢å¼ååå» 1ï¼æ¯å¦1çè´æ°å½¢å¼æ¯-1ï¼ååå» 1ï¼å°±å¾å°äº-2ã\n\n\n# éææ¹æ³ï¼æ°æ®ç±»åè½¬æ¢\n\nSIMD æä¾ä»¥ä¸æ¹æ³ï¼ç¨æ¥å°ä¸ç§æ°æ®ç±»åè½¬ä¸ºå¦ä¸ç§æ°æ®ç±»åã\n\n * SIMD.%type%.fromFloat32x4()\n * SIMD.%type%.fromFloat32x4Bits()\n * SIMD.%type%.fromFloat64x2Bits()\n * SIMD.%type%.fromInt32x4()\n * SIMD.%type%.fromInt32x4Bits()\n * SIMD.%type%.fromInt16x8Bits()\n * SIMD.%type%.fromInt8x16Bits()\n * SIMD.%type%.fromUint32x4()\n * SIMD.%type%.fromUint32x4Bits()\n * SIMD.%type%.fromUint16x8Bits()\n * SIMD.%type%.fromUint8x16Bits()\n\nå¸¦æBitsåç¼çæ¹æ³ï¼ä¼åå°ä¸å¨å°å°äºè¿å¶ä½æ·è´å°æ°çæ°æ®ç±»åï¼ä¸å¸¦åç¼çæ¹æ³ï¼åä¼è¿è¡æ°æ®ç±»åè½¬æ¢ã\n\nvar t = SIMD.Float32x4(1.0, 2.0, 3.0, 4.0);\nSIMD.Int32x4.fromFloat32x4(t);\n// Int32x4[1, 2, 3, 4]\n\nSIMD.Int32x4.fromFloat32x4Bits(t);\n// Int32x4[1065353216, 1073741824, 1077936128, 1082130432]\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼fromFloat32x4æ¯å°æµ®ç¹æ°è½¬ä¸ºæ´æ°ï¼ç¶åå­å¥æ°çæ°æ®ç±»åï¼fromFloat32x4Bitsåæ¯å°äºè¿å¶ä½åå°ä¸å¨å°æ·è´è¿å¥æ°çæ°æ®ç±»åï¼ç¶åè¿è¡è§£è¯»ã\n\nBitsåç¼çæ¹æ³ï¼è¿å¯ä»¥ç¨äºééæ°ç®ä¸å¯¹ç­çæ·è´ã\n\nvar t = SIMD.Float32x4(1.0, 2.0, 3.0, 4.0);\nSIMD.Int16x8.fromFloat32x4Bits(t);\n// Int16x8[0, 16256, 0, 16384, 0, 16448, 0, 16512]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼åå§ SIMD å¼tæ¯ 4 ééçï¼èç®æ å¼æ¯ 8 ééçã\n\nå¦ææ°æ®è½¬æ¢æ¶ï¼åééçæ°æ®å¤§å°ï¼è¶è¿äºç®æ ééçæå¤§å®½åº¦ï¼å°±ä¼æ¥éã\n\n\n# å®ä¾æ¹æ³\n\n\n# SIMD.%type%.prototype.toString()\n\ntoStringæ¹æ³è¿åä¸ä¸ª SIMD å¼çå­ç¬¦ä¸²å½¢å¼ã\n\nvar a = SIMD.Float32x4(11, 22, 33, 44);\na.toString() // \"SIMD.Float32x4(11, 22, 33, 44)\"\n\n\n1\n2\n\n\n\n# å®ä¾ï¼æ±å¹³åå¼\n\næ­£å¸¸æ¨¡å¼ä¸ï¼è®¡ç®nä¸ªå¼çå¹³åå¼ï¼éè¦è¿ç®næ¬¡ã\n\nfunction average(list) {\n  var n = list.length;\n  var sum = 0.0;\n  for (var i = 0; i < n; i++) {\n    sum += list[i];\n  }\n  return sum / n;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä½¿ç¨ SIMDï¼å¯ä»¥å°è®¡ç®æ¬¡æ°åå°å°næ¬¡çååä¹ä¸ã\n\nfunction average(list) {\n  var n = list.length;\n  var sum = SIMD.Float32x4.splat(0.0);\n  for (var i = 0; i < n; i += 4) {\n    sum = SIMD.Float32x4.add(\n      sum,\n      SIMD.Float32x4.load(list, i)\n    );\n  }\n  var total = SIMD.Float32x4.extractLane(sum, 0) +\n              SIMD.Float32x4.extractLane(sum, 1) +\n              SIMD.Float32x4.extractLane(sum, 2) +\n              SIMD.Float32x4.extractLane(sum, 3);\n  return total / n;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç åæ¯æ¯éåä½ï¼å°ææçå¼è¯»å¥ä¸ä¸ª SIMDï¼ç¶åç«å»ç´¯å ãç¶åï¼å¾å°ç´¯å å¼åä¸ªééçæ»åï¼åé¤ä»¥nå°±å¯ä»¥äºã",normalizedContent:"# simd\n\n\n# æ¦è¿°\n\nsimdï¼åé³/sim-dee/ï¼æ¯âsingle instruction/multiple dataâçç¼©åï¼æä¸ºâåæä»¤ï¼å¤æ°æ®âãå®æ¯ javascript æä½ cpu å¯¹åºæä»¤çæ¥å£ï¼ä½ å¯ä»¥çåè¿æ¯ä¸ç§ä¸åçè¿ç®æ§è¡æ¨¡å¼ãä¸å®ç¸å¯¹çæ¯ sisdï¼âsingle instruction/single dataâï¼ï¼å³âåæä»¤ï¼åæ°æ®âã simd çå«ä¹æ¯ä½¿ç¨ä¸ä¸ªæä»¤ï¼å®æå¤ä¸ªæ°æ®çè¿ç®ï¼sisd çå«ä¹æ¯ä½¿ç¨ä¸ä¸ªæä»¤ï¼å®æåä¸ªæ°æ®çè¿ç®ï¼è¿æ¯ javascript çé»è®¤è¿ç®æ¨¡å¼ãæ¾èæè§ï¼simd çæ§è¡æçè¦é«äº sisdï¼æä»¥è¢«å¹¿æ³ç¨äº 3d å¾å½¢è¿ç®ãç©çæ¨¡æç­è¿ç®éè¶å¤§çé¡¹ç®ä¹ä¸­ã\n\nä¸ºäºçè§£ simdï¼è¯·çä¸é¢çä¾å­ã\n\nvar a = [1, 2, 3, 4];\nvar b = [5, 6, 7, 8];\nvar c = [];\n\nc[0] = a[0] + b[0];\nc[1] = a[1] + b[1];\nc[2] = a[2] + b[2];\nc[3] = a[3] + b[3];\nc // array[6, 8, 10, 12]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼æ°ç»aåbçå¯¹åºæåç¸å ï¼ç»ææ¾å¥æ°ç»cãå®çè¿ç®æ¨¡å¼æ¯ä¾æ¬¡å¤çæ¯ä¸ªæ°ç»æåï¼ä¸å±æåä¸ªæ°ç»æåï¼æä»¥éè¦è¿ç® 4 æ¬¡ã\n\nå¦æéç¨ simd æ¨¡å¼ï¼åªè¦è¿ç®ä¸æ¬¡å°±å¤äºã\n\nvar a = simd.float32x4(1, 2, 3, 4);\nvar b = simd.float32x4(5, 6, 7, 8);\nvar c = simd.float32x4.add(a, b); // float32x4[6, 8, 10, 12]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¹ä¸­ï¼æ°ç»aåbçåä¸ªæåçåèªç¸å ï¼åªç¨ä¸æ¡æä»¤å°±å®æäºãå æ­¤ï¼éåº¦æ¯ä¸ä¸ç§åæ³æé«äº 4 åã\n\nä¸æ¬¡ simd è¿ç®ï¼å¯ä»¥å¤çå¤ä¸ªæ°æ®ï¼è¿äºæ°æ®è¢«ç§°ä¸ºâééâï¼laneï¼ãä¸é¢ä»£ç ä¸­ï¼ä¸æ¬¡è¿ç®äºåä¸ªæ°æ®ï¼å æ­¤å°±æ¯åä¸ªééã\n\nsimd éå¸¸ç¨äºç¢éè¿ç®ã\n\nv + w = ãv1, â¦, vnã+ ãw1, â¦, wnã\n      = ãv1+w1, â¦, vn+wnã\n\n\n1\n2\n\n\nä¸é¢ä»£ç ä¸­ï¼våwæ¯ä¸¤ä¸ªå¤åç¢éãå®ä»¬çå è¿ç®ï¼å¨ simd ä¸æ¯ä¸ä¸ªæä»¤ãèä¸æ¯ n ä¸ªæä»¤å®æçï¼è¿å°±å¤§å¤§æé«äºæçãè¿å¯¹äº 3d å¨ç»ãå¾åå¤çãä¿¡å·å¤çãæ°å¼å¤çãå å¯ç­è¿ç®æ¯éå¸¸éè¦çãæ¯å¦ï¼canvas çgetimagedata()ä¼å°å¾åæä»¶è¯»æä¸ä¸ªäºè¿å¶æ°ç»ï¼simd å°±å¾éåå¯¹äºè¿ç§æ°ç»çå¤çã\n\næ»çæ¥è¯´ï¼simd æ¯æ°æ®å¹¶è¡å¤çï¼parallelismï¼çä¸ç§ææ®µï¼å¯ä»¥å éä¸äºè¿ç®å¯éåæä½çéåº¦ãå°æ¥ä¸ webassembly ç»åä»¥åï¼å¯ä»¥è®© javascript è¾¾å°äºè¿å¶ä»£ç çè¿è¡éåº¦ã\n\n\n# æ°æ®ç±»å\n\nsimd æä¾ 12 ç§æ°æ®ç±»åï¼æ»é¿åº¦é½æ¯ 128 ä¸ªäºè¿å¶ä½ã\n\n * float32x4ï¼åä¸ª 32 ä½æµ®ç¹æ°\n * float64x2ï¼ä¸¤ä¸ª 64 ä½æµ®ç¹æ°\n * int32x4ï¼åä¸ª 32 ä½æ´æ°\n * int16x8ï¼å«ä¸ª 16 ä½æ´æ°\n * int8x16ï¼åå­ä¸ª 8 ä½æ´æ°\n * uint32x4ï¼åä¸ªæ ç¬¦å·ç 32 ä½æ´æ°\n * uint16x8ï¼å«ä¸ªæ ç¬¦å·ç 16 ä½æ´æ°\n * uint8x16ï¼åå­ä¸ªæ ç¬¦å·ç 8 ä½æ´æ°\n * bool32x4ï¼åä¸ª 32 ä½å¸å°å¼\n * bool16x8ï¼å«ä¸ª 16 ä½å¸å°å¼\n * bool8x16ï¼åå­ä¸ª 8 ä½å¸å°å¼\n * bool64x2ï¼ä¸¤ä¸ª 64 ä½å¸å°å¼\n\næ¯ç§æ°æ®ç±»åè¢«xç¬¦å·åéæä¸¤é¨åï¼åé¢çé¨åè¡¨ç¤ºééæ°ï¼åé¢çé¨åè¡¨ç¤ºæ¯ä¸ªééçå®½åº¦åç±»åãæ¯å¦ï¼float32x4å°±è¡¨ç¤ºè¿ä¸ªå¼æ 4 ä¸ªééï¼æ¯ä¸ªééæ¯ä¸ä¸ª 32 ä½æµ®ç¹æ°ã\n\næ¯ä¸ªééä¹ä¸­ï¼å¯ä»¥æ¾ç½®åç§æ°æ®ã\n\n * æµ®ç¹æ°ï¼floatï¼æ¯å¦ 1.0ï¼\n * å¸¦ç¬¦å·çæ´æ°ï¼intï¼æ¯å¦-1ï¼\n * æ ç¬¦å·çæ´æ°ï¼uintï¼æ¯å¦ 1ï¼\n * å¸å°å¼ï¼boolï¼åå«trueåfalseä¸¤ç§å¼ï¼\n\næ¯ç§ simd çæ°æ®ç±»åé½æ¯ä¸ä¸ªå½æ°æ¹æ³ï¼å¯ä»¥ä¼ å¥åæ°ï¼çæå¯¹åºçå¼ã\n\nvar a = simd.float32x4(1.0, 2.0, 3.0, 4.0);\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼åéaå°±æ¯ä¸ä¸ª 128 ä½ãåå«åä¸ª 32 ä½æµ®ç¹æ°ï¼å³åä¸ªééï¼çå¼ã\n\næ³¨æï¼è¿äºæ°æ®ç±»åæ¹æ³é½ä¸æ¯æé å½æ°ï¼åé¢ä¸è½å newï¼å¦åä¼æ¥éã\n\nvar v = new simd.float32x4(0, 1, 2, 3);\n// typeerror: simd.float32x4 is not a constructor\n\n\n1\n2\n\n\n\n# éææ¹æ³ï¼æ°å­¦è¿ç®\n\næ¯ç§æ°æ®ç±»åé½æä¸ç³»åè¿ç®ç¬¦ï¼æ¯æåºæ¬çæ°å­¦è¿ç®ã\n\n\n# simd.%type%.abs()ï¼simd.%type%.neg()\n\nabsæ¹æ³æ¥åä¸ä¸ª simd å¼ä½ä¸ºåæ°ï¼å°å®çæ¯ä¸ªééé½è½¬æç»å¯¹å¼ï¼ä½ä¸ºä¸ä¸ªæ°ç simd å¼è¿åã\n\nvar a = simd.float32x4(-1, -2, 0, nan);\nsimd.float32x4.abs(a)\n// float32x4[1, 2, 0, nan]\n\n\n1\n2\n3\n\n\nnegæ¹æ³æ¥åä¸ä¸ª simd å¼ä½ä¸ºåæ°ï¼å°å®çæ¯ä¸ªééé½è½¬æè´å¼ï¼ä½ä¸ºä¸ä¸ªæ°ç simd å¼è¿åã\n\nvar a = simd.float32x4(-1, -2, 3, 0);\nsimd.float32x4.neg(a)\n// float32x4[1, 2, -3, -0]\n\nvar b = simd.float64x2(nan, infinity);\nsimd.float64x2.neg(b)\n// float64x2[nan, -infinity]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# simd.%type%.add()ï¼simd.%type%.addsaturate()\n\naddæ¹æ³æ¥åä¸¤ä¸ª simd å¼ä½ä¸ºåæ°ï¼å°å®ä»¬çæ¯ä¸ªééç¸å ï¼ä½ä¸ºä¸ä¸ªæ°ç simd å¼è¿åã\n\nvar a = simd.float32x4(1.0, 2.0, 3.0, 4.0);\nvar b = simd.float32x4(5.0, 10.0, 15.0, 20.0);\nvar c = simd.float32x4.add(a, b);\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼ç»è¿å æ³è¿ç®ï¼æ°ç simd å¼ä¸º(6.0, 12.0, 18.0. 24.0)ã\n\naddsaturateæ¹æ³è·addæ¹æ³çä½ç¨ç¸åï¼é½æ¯ä¸¤ä¸ªééç¸å ï¼ä½æ¯æº¢åºçå¤çä¸ä¸è´ãå¯¹äºaddæ¹æ³ï¼å¦æä¸¤ä¸ªå¼ç¸å åçæº¢åºï¼æº¢åºçäºè¿å¶ä½ä¼è¢«ä¸¢å¼; addsaturateæ¹æ³åæ¯è¿åè¯¥æ°æ®ç±»åçæå¤§å¼ã\n\nvar a = simd.uint16x8(65533, 65534, 65535, 65535, 1, 1, 1, 1);\nvar b = simd.uint16x8(1, 1, 1, 5000, 1, 1, 1, 1);\nsimd.uint16x8.addsaturate(a, b);\n// uint16x8[65534, 65535, 65535, 65535, 2, 2, 2, 2]\n\nvar c = simd.int16x8(32765, 32766, 32767, 32767, 1, 1, 1, 1);\nvar d = simd.int16x8(1, 1, 1, 5000, 1, 1, 1, 1);\nsimd.int16x8.addsaturate(c, d);\n// int16x8[32766, 32767, 32767, 32767, 2, 2, 2, 2]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼uint16çæå¤§å¼æ¯ 65535ï¼int16çæå¤§å¼æ¯ 32767ãä¸æ¦åçæº¢åºï¼å°±è¿åè¿ä¸¤ä¸ªå¼ã\n\næ³¨æï¼uint32x4åint32x4è¿ä¸¤ç§æ°æ®ç±»åæ²¡æaddsaturateæ¹æ³ã\n\n\n# simd.%type%.sub()ï¼simd.%type%.subsaturate()\n\nsubæ¹æ³æ¥åä¸¤ä¸ª simd å¼ä½ä¸ºåæ°ï¼å°å®ä»¬çæ¯ä¸ªééç¸åï¼ä½ä¸ºä¸ä¸ªæ°ç simd å¼è¿åã\n\nvar a = simd.float32x4(-1, -2, 3, 4);\nvar b = simd.float32x4(3, 3, 3, 3);\nsimd.float32x4.sub(a, b)\n// float32x4[-4, -5, 0, 1]\n\n\n1\n2\n3\n4\n\n\nsubsaturateæ¹æ³è·subæ¹æ³çä½ç¨ç¸åï¼é½æ¯ä¸¤ä¸ªééç¸åï¼ä½æ¯æº¢åºçå¤çä¸ä¸è´ãå¯¹äºsubæ¹æ³ï¼å¦æä¸¤ä¸ªå¼ç¸ååçæº¢åºï¼æº¢åºçäºè¿å¶ä½ä¼è¢«ä¸¢å¼; subsaturateæ¹æ³åæ¯è¿åè¯¥æ°æ®ç±»åçæå°å¼ã\n\nvar a = simd.uint16x8(5, 1, 1, 1, 1, 1, 1, 1);\nvar b = simd.uint16x8(10, 1, 1, 1, 1, 1, 1, 1);\nsimd.uint16x8.subsaturate(a, b)\n// uint16x8[0, 0, 0, 0, 0, 0, 0, 0]\n\nvar c = simd.int16x8(-100, 0, 0, 0, 0, 0, 0, 0);\nvar d = simd.int16x8(32767, 0, 0, 0, 0, 0, 0, 0);\nsimd.int16x8.subsaturate(c, d)\n// int16x8[-32768, 0, 0, 0, 0, 0, 0, 0, 0]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼uint16çæå°å¼æ¯0ï¼int16çæå°å¼æ¯-32678ãä¸æ¦è¿ç®åçæº¢åºï¼å°±è¿åæå°å¼ã\n\n\n# simd.%type%.mul()ï¼simd.%type%.div()ï¼simd.%type%.sqrt()\n\nmulæ¹æ³æ¥åä¸¤ä¸ª simd å¼ä½ä¸ºåæ°ï¼å°å®ä»¬çæ¯ä¸ªééç¸ä¹ï¼ä½ä¸ºä¸ä¸ªæ°ç simd å¼è¿åã\n\nvar a = simd.float32x4(-1, -2, 3, 4);\nvar b = simd.float32x4(3, 3, 3, 3);\nsimd.float32x4.mul(a, b)\n// float32x4[-3, -6, 9, 12]\n\n\n1\n2\n3\n4\n\n\ndivæ¹æ³æ¥åä¸¤ä¸ª simd å¼ä½ä¸ºåæ°ï¼å°å®ä»¬çæ¯ä¸ªééç¸é¤ï¼ä½ä¸ºä¸ä¸ªæ°ç simd å¼è¿åã\n\nvar a = simd.float32x4(2, 2, 2, 2);\nvar b = simd.float32x4(4, 4, 4, 4);\nsimd.float32x4.div(a, b)\n// float32x4[0.5, 0.5, 0.5, 0.5]\n\n\n1\n2\n3\n4\n\n\nsqrtæ¹æ³æ¥åä¸ä¸ª simd å¼ä½ä¸ºåæ°ï¼æ±åºæ¯ä¸ªééçå¹³æ¹æ ¹ï¼ä½ä¸ºä¸ä¸ªæ°ç simd å¼è¿åã\n\nvar b = simd.float64x2(4, 8);\nsimd.float64x2.sqrt(b)\n// float64x2[2, 2.8284271247461903]\n\n\n1\n2\n3\n\n\n\n# simd.%floattype%.reciprocalapproximation()ï¼simd.%type%.reciprocalsqrtapproximation()\n\nreciprocalapproximationæ¹æ³æ¥åä¸ä¸ª simd å¼ä½ä¸ºåæ°ï¼æ±åºæ¯ä¸ªééçåæ°ï¼1 / xï¼ï¼ä½ä¸ºä¸ä¸ªæ°ç simd å¼è¿åã\n\nvar a = simd.float32x4(1, 2, 3, 4);\nsimd.float32x4.reciprocalapproximation(a);\n// float32x4[1, 0.5, 0.3333333432674408, 0.25]\n\n\n1\n2\n3\n\n\nreciprocalsqrtapproximationæ¹æ³æ¥åä¸ä¸ª simd å¼ä½ä¸ºåæ°ï¼æ±åºæ¯ä¸ªééçå¹³æ¹æ ¹çåæ°ï¼1 / (x^0.5)ï¼ï¼ä½ä¸ºä¸ä¸ªæ°ç simd å¼è¿åã\n\nvar a = simd.float32x4(1, 2, 3, 4);\nsimd.float32x4.reciprocalsqrtapproximation(a)\n// float32x4[1, 0.7071067690849304, 0.5773502588272095, 0.5]\n\n\n1\n2\n3\n\n\næ³¨æï¼åªææµ®ç¹æ°çæ°æ®ç±»åææè¿ä¸¤ä¸ªæ¹æ³ã\n\n\n# simd.%integertype%.shiftleftbyscalar()\n\nshiftleftbyscalaræ¹æ³æ¥åä¸ä¸ª simd å¼ä½ä¸ºåæ°ï¼ç¶åå°æ¯ä¸ªééçå¼å·¦ç§»æå®çä½æ°ï¼ä½ä¸ºä¸ä¸ªæ°ç simd å¼è¿åã\n\nvar a = simd.int32x4(1, 2, 4, 8);\nsimd.int32x4.shiftleftbyscalar(a, 1);\n// int32x4[2, 4, 8, 16]\n\n\n1\n2\n3\n\n\nå¦æå·¦ç§»åï¼æ°çå¼è¶åºäºå½åæ°æ®ç±»åçä½æ°ï¼æº¢åºçé¨åä¼è¢«ä¸¢å¼ã\n\nvar ix4 = simd.int32x4(1, 2, 3, 4);\nvar jx4 = simd.int32x4.shiftleftbyscalar(ix4, 32);\n// int32x4[0, 0, 0, 0]\n\n\n1\n2\n3\n\n\næ³¨æï¼åªææ´æ°çæ°æ®ç±»åææè¿ä¸ªæ¹æ³ã\n\n\n# simd.%integertype%.shiftrightbyscalar()\n\nshiftrightbyscalaræ¹æ³æ¥åä¸ä¸ª simd å¼ä½ä¸ºåæ°ï¼ç¶åå°æ¯ä¸ªééçå¼å³ç§»æå®çä½æ°ï¼è¿åä¸ä¸ªæ°ç simd å¼ã\n\nvar a = simd.int32x4(1, 2, 4, -8);\nsimd.int32x4.shiftrightbyscalar(a, 1);\n// int32x4[0, 1, 2, -4]\n\n\n1\n2\n3\n\n\nå¦æåæ¥ééçå¼æ¯å¸¦ç¬¦å·çå¼ï¼åç¬¦å·ä½ä¿æä¸åï¼ä¸åå³ç§»å½±åãå¦ææ¯ä¸å¸¦ç¬¦å·ä½çå¼ï¼åå³ç§»åå¤´é¨ä¼è¡¥0ã\n\nvar a = simd.uint32x4(1, 2, 4, -8);\nsimd.uint32x4.shiftrightbyscalar(a, 1);\n// uint32x4[0, 1, 2, 2147483644]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼-8å³ç§»ä¸ä½åæäº2147483644ï¼æ¯å ä¸ºå¯¹äº 32 ä½æ ç¬¦å·æ´æ°æ¥è¯´ï¼-8çäºè¿å¶å½¢å¼æ¯11111111111111111111111111111000ï¼å³ç§»ä¸ä½å°±åæäº01111111111111111111111111111100ï¼ç¸å½äº2147483644ã\n\næ³¨æï¼åªææ´æ°çæ°æ®ç±»åææè¿ä¸ªæ¹æ³ã\n\n\n# éææ¹æ³ï¼ééå¤ç\n\n\n# simd.%type%.check()\n\ncheckæ¹æ³ç¨äºæ£æ¥ä¸ä¸ªå¼æ¯å¦ä¸ºå½åç±»åç simd å¼ãå¦ææ¯çï¼å°±è¿åè¿ä¸ªå¼ï¼å¦åå°±æ¥éã\n\nvar a = simd.float32x4(1, 2, 3, 9);\n\nsimd.float32x4.check(a);\n// float32x4[1, 2, 3, 9]\n\nsimd.float32x4.check([1,2,3,4]) // æ¥é\nsimd.int32x4.check(a) // æ¥é\nsimd.int32x4.check('hello world') // æ¥é\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# simd.%type%.extractlane()ï¼simd.%type%.replacelane()\n\nextractlaneæ¹æ³ç¨äºè¿åç»å®ééçå¼ãå®æ¥åä¸¤ä¸ªåæ°ï¼åå«æ¯ simd å¼åééç¼å·ã\n\nvar t = simd.float32x4(1, 2, 3, 4);\nsimd.float32x4.extractlane(t, 2) // 3\n\n\n1\n2\n\n\nreplacelaneæ¹æ³ç¨äºæ¿æ¢æå®ééçå¼ï¼å¹¶è¿åä¸ä¸ªæ°ç simd å¼ãå®æ¥åä¸ä¸ªåæ°ï¼åå«æ¯åæ¥ç simd å¼ãééç¼å·åæ°çééå¼ã\n\nvar t = simd.float32x4(1, 2, 3, 4);\nsimd.float32x4.replacelane(t, 2, 42)\n// float32x4[1, 2, 42, 4]\n\n\n1\n2\n3\n\n\n\n# simd.%type%.load()\n\nloadæ¹æ³ç¨äºä»äºè¿å¶æ°ç»è¯»å¥æ°æ®ï¼çæä¸ä¸ªæ°ç simd å¼ã\n\nvar a = new int32array([1,2,3,4,5,6,7,8]);\nsimd.int32x4.load(a, 0);\n// int32x4[1, 2, 3, 4]\n\nvar b = new int32array([1,2,3,4,5,6,7,8]);\nsimd.int32x4.load(a, 2);\n// int32x4[3, 4, 5, 6]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nloadæ¹æ³æ¥åä¸¤ä¸ªåæ°ï¼ä¸ä¸ªäºè¿å¶æ°ç»åå¼å§è¯»åçä½ç½®ï¼ä» 0 å¼å§ï¼ãå¦æä½ç½®ä¸åæ³ï¼æ¯å¦-1æèè¶åºäºè¿å¶æ°ç»çå¤§å°ï¼ï¼å°±ä¼æåºä¸ä¸ªéè¯¯ã\n\nè¿ä¸ªæ¹æ³è¿æä¸ä¸ªåç§load1()ãload2()ãload3()ï¼è¡¨ç¤ºä»æå®ä½ç½®å¼å§ï¼åªå è½½ä¸ä¸ªééãäºä¸ªééãä¸ä¸ªééçå¼ã\n\n// æ ¼å¼\nsimd.int32x4.load(tarray, index)\nsimd.int32x4.load1(tarray, index)\nsimd.int32x4.load2(tarray, index)\nsimd.int32x4.load3(tarray, index)\n\n// å®ä¾\nvar a = new int32array([1,2,3,4,5,6,7,8]);\nsimd.int32x4.load1(a, 0);\n// int32x4[1, 0, 0, 0]\nsimd.int32x4.load2(a, 0);\n// int32x4[1, 2, 0, 0]\nsimd.int32x4.load3(a, 0);\n// int32x4[1, 2, 3,0]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# simd.%type%.store()\n\nstoreæ¹æ³ç¨äºå°ä¸ä¸ª simd å¼ï¼åå¥ä¸ä¸ªäºè¿å¶æ°ç»ãå®æ¥åä¸ä¸ªåæ°ï¼åå«æ¯äºè¿å¶æ°ç»ãå¼å§åå¥çæ°ç»ä½ç½®ãsimd å¼ãå®è¿ååå¥å¼ä»¥åçäºè¿å¶æ°ç»ã\n\nvar t1 = new int32array(8);\nvar v1 = simd.int32x4(1, 2, 3, 4);\nsimd.int32x4.store(t1, 0, v1)\n// int32array[1, 2, 3, 4, 0, 0, 0, 0]\n\nvar t2 = new int32array(8);\nvar v2 = simd.int32x4(1, 2, 3, 4);\nsimd.int32x4.store(t2, 2, v2)\n// int32array[0, 0, 1, 2, 3, 4, 0, 0]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼t1æ¯ä¸ä¸ªäºè¿å¶æ°ç»ï¼v1æ¯ä¸ä¸ª simd å¼ï¼åªæåä¸ªééãæä»¥åå¥t1ä»¥åï¼åªæååä¸ªä½ç½®æå¼ï¼ååä¸ªä½ç½®é½æ¯ 0ãèt2æ¯ä» 2 å·ä½ç½®å¼å§åå¥ï¼æä»¥åä¸¤ä¸ªä½ç½®ååä¸¤ä¸ªä½ç½®é½æ¯ 0ã\n\nè¿ä¸ªæ¹æ³è¿æä¸ä¸ªåç§store1()ãstore2()åstore3()ï¼è¡¨ç¤ºåªåå¥ä¸ä¸ªééãäºä¸ªééåä¸ä¸ªééçå¼ã\n\nvar tarray = new int32array(8);\nvar value = simd.int32x4(1, 2, 3, 4);\nsimd.int32x4.store1(tarray, 0, value);\n// int32array[1, 0, 0, 0, 0, 0, 0, 0]\n\n\n1\n2\n3\n4\n\n\n\n# simd.%type%.splat()\n\nsplatæ¹æ³è¿åä¸ä¸ªæ°ç simd å¼ï¼è¯¥å¼çææééé½ä¼è®¾æåä¸ä¸ªé¢åç»å®çå¼ã\n\nsimd.float32x4.splat(3);\n// float32x4[3, 3, 3, 3]\nsimd.float64x2.splat(3);\n// float64x2[3, 3]\n\n\n1\n2\n3\n4\n\n\nå¦æçç¥åæ°ï¼æææ´æ°åç simd å¼é½ä¼è®¾å®0ï¼æµ®ç¹åç simd å¼é½ä¼è®¾ænanã\n\n\n# simd.%type%.swizzle()\n\nswizzleæ¹æ³è¿åä¸ä¸ªæ°ç simd å¼ï¼éæ°æååæç simd å¼çééé¡ºåºã\n\nvar t = simd.float32x4(1, 2, 3, 4);\nsimd.float32x4.swizzle(t, 1, 2, 0, 3);\n// float32x4[2,3,1,4]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼swizzleæ¹æ³çç¬¬ä¸ä¸ªåæ°æ¯åæç simd å¼ï¼åé¢çåæ°å¯¹åºå°è¦è¿åç simd å¼çåä¸ªééãå®çæææ¯æ°ç simd çåä¸ªééï¼ä¾æ¬¡æ¯åæ¥ simd å¼ç 1 å·ééã2 å·ééã0 å·ééã3 å·ééãç±äº simd å¼æå¤å¯ä»¥æ 16 ä¸ªééï¼æä»¥swizzleæ¹æ³é¤äºç¬¬ä¸ä¸ªåæ°ä»¥å¤ï¼æå¤è¿å¯ä»¥æ¥å 16 ä¸ªåæ°ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nvar a = simd.float32x4(1.0, 2.0, 3.0, 4.0);\n// float32x4[1.0, 2.0, 3.0, 4.0]\n\nvar b = simd.float32x4.swizzle(a, 0, 0, 1, 1);\n// float32x4[1.0, 1.0, 2.0, 2.0]\n\nvar c = simd.float32x4.swizzle(a, 3, 3, 3, 3);\n// float32x4[4.0, 4.0, 4.0, 4.0]\n\nvar d = simd.float32x4.swizzle(a, 3, 2, 1, 0);\n// float32x4[4.0, 3.0, 2.0, 1.0]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# simd.%type%.shuffle()\n\nshuffleæ¹æ³ä»ä¸¤ä¸ª simd å¼ä¹ä¸­ååºæå®ééï¼è¿åä¸ä¸ªæ°ç simd å¼ã\n\nvar a = simd.float32x4(1, 2, 3, 4);\nvar b = simd.float32x4(5, 6, 7, 8);\n\nsimd.float32x4.shuffle(a, b, 1, 5, 7, 2);\n// float32x4[2, 6, 8, 3]\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼aåbä¸å±æ 8 ä¸ªééï¼ä¾æ¬¡ç¼å·ä¸º 0 å° 7ãshuffleæ ¹æ®ç¼å·ï¼ååºç¸åºçééï¼è¿åä¸ä¸ªæ°ç simd å¼ã\n\n\n# éææ¹æ³ï¼æ¯è¾è¿ç®\n\n\n# simd.%type%.equal()ï¼simd.%type%.notequal()\n\nequalæ¹æ³ç¨æ¥æ¯è¾ä¸¤ä¸ª simd å¼aåbçæ¯ä¸ä¸ªééï¼æ ¹æ®ä¸¤èæ¯å¦ç²¾ç¡®ç¸ç­ï¼a === bï¼ï¼å¾å°ä¸ä¸ªå¸å°å¼ãæåï¼ææééçæ¯è¾ç»æï¼ç»æä¸ä¸ªæ°ç simd å¼ï¼ä½ä¸ºæ©ç è¿åãnotequalæ¹æ³åæ¯æ¯è¾ä¸¤ä¸ªééæ¯å¦ä¸ç¸ç­ï¼a !== bï¼ã\n\nvar a = simd.float32x4(1, 2, 3, 9);\nvar b = simd.float32x4(1, 4, 7, 9);\n\nsimd.float32x4.equal(a,b)\n// bool32x4[true, false, false, true]\n\nsimd.float32x4.notequal(a,b);\n// bool32x4[false, true, true, false]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# simd.%type%.greaterthan()ï¼simd.%type%.greaterthanorequal()\n\ngreatthanæ¹æ³ç¨æ¥æ¯è¾ä¸¤ä¸ª simd å¼aåbçæ¯ä¸ä¸ªééï¼å¦æå¨è¯¥ééä¸­ï¼aè¾å¤§å°±å¾å°trueï¼å¦åå¾å°falseãæåï¼ææééçæ¯è¾ç»æï¼ç»æä¸ä¸ªæ°ç simd å¼ï¼ä½ä¸ºæ©ç è¿åãgreaterthanorequalåæ¯æ¯è¾aæ¯å¦å¤§äºç­äºbã\n\nvar a = simd.float32x4(1, 6, 3, 11);\nvar b = simd.float32x4(1, 4, 7, 9);\n\nsimd.float32x4.greaterthan(a, b)\n// bool32x4[false, true, false, true]\n\nsimd.float32x4.greaterthanorequal(a, b)\n// bool32x4[true, true, false, true]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# simd.%type%.lessthan()ï¼simd.%type%.lessthanorequal()\n\nlessthanæ¹æ³ç¨æ¥æ¯è¾ä¸¤ä¸ª simd å¼aåbçæ¯ä¸ä¸ªééï¼å¦æå¨è¯¥ééä¸­ï¼aè¾å°å°±å¾å°trueï¼å¦åå¾å°falseãæåï¼ææééçæ¯è¾ç»æï¼ä¼ç»æä¸ä¸ªæ°ç simd å¼ï¼ä½ä¸ºæ©ç è¿åãlessthanorequalæ¹æ³åæ¯æ¯è¾aæ¯å¦ç­äºbã\n\nvar a = simd.float32x4(1, 2, 3, 11);\nvar b = simd.float32x4(1, 4, 7, 9);\n\nsimd.float32x4.lessthan(a, b)\n// bool32x4[false, true, true, false]\n\nsimd.float32x4.lessthanorequal(a, b)\n// bool32x4[true, true, true, false]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# simd.%type%.select()\n\nselectæ¹æ³éè¿æ©ç çæä¸ä¸ªæ°ç simd å¼ãå®æ¥åä¸ä¸ªåæ°ï¼åå«æ¯æ©ç åä¸¤ä¸ª simd å¼ã\n\nvar a = simd.float32x4(1, 2, 3, 4);\nvar b = simd.float32x4(5, 6, 7, 8);\n\nvar mask = simd.bool32x4(true, false, false, true);\n\nsimd.float32x4.select(mask, a, b);\n// float32x4[1, 6, 7, 4]\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼selectæ¹æ³æ¥åæ©ç åä¸¤ä¸ª simd å¼ä½ä¸ºåæ°ãå½æä¸ªééå¯¹åºçæ©ç ä¸ºtrueæ¶ï¼ä¼éæ©ç¬¬ä¸ä¸ª simd å¼çå¯¹åºééï¼å¦åéæ©ç¬¬äºä¸ª simd å¼çå¯¹åºééã\n\nè¿ä¸ªæ¹æ³éå¸¸ä¸æ¯è¾è¿ç®ç¬¦ç»åä½¿ç¨ã\n\nvar a = simd.float32x4(0, 12, 3, 4);\nvar b = simd.float32x4(0, 6, 7, 50);\n\nvar mask = simd.float32x4.lessthan(a,b);\n// bool32x4[false, false, true, true]\n\nvar result = simd.float32x4.select(mask, a, b);\n// float32x4[0, 6, 3, 4]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼åéè¿lessthanæ¹æ³çæä¸ä¸ªæ©ç ï¼ç¶åéè¿selectæ¹æ³çæä¸ä¸ªç±æ¯ä¸ªééçè¾å°å¼ç»æçæ°ç simd å¼ã\n\n\n# simd.%booleantype%.alltrue()ï¼simd.%booleantype%.anytrue()\n\nalltrueæ¹æ³æ¥åä¸ä¸ª simd å¼ä½ä¸ºåæ°ï¼ç¶åè¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºè¯¥ simd å¼çææééæ¯å¦é½ä¸ºtrueã\n\nvar a = simd.bool32x4(true, true, true, true);\nvar b = simd.bool32x4(true, false, true, true);\n\nsimd.bool32x4.alltrue(a); // true\nsimd.bool32x4.alltrue(b); // false\n\n\n1\n2\n3\n4\n5\n\n\nanytrueæ¹æ³åæ¯åªè¦æä¸ä¸ªééä¸ºtrueï¼å°±è¿åtrueï¼å¦åè¿åfalseã\n\nvar a = simd.bool32x4(false, false, false, false);\nvar b = simd.bool32x4(false, false, true, false);\n\nsimd.bool32x4.anytrue(a); // false\nsimd.bool32x4.anytrue(b); // true\n\n\n1\n2\n3\n4\n5\n\n\næ³¨æï¼åªæåç§å¸å°å¼æ°æ®ç±»åï¼bool32x4ãbool16x8ãbool8x16ãbool64x2ï¼ææè¿ä¸¤ä¸ªæ¹æ³ã\n\nè¿ä¸¤ä¸ªæ¹æ³éå¸¸ä¸æ¯è¾è¿ç®ç¬¦ç»åä½¿ç¨ã\n\nvar ax4    = simd.float32x4(1.0, 2.0, 3.0, 4.0);\nvar bx4    = simd.float32x4(0.0, 6.0, 7.0, 8.0);\nvar ix4    = simd.float32x4.lessthan(ax4, bx4);\nvar b1     = simd.int32x4.alltrue(ix4); // false\nvar b2     = simd.int32x4.anytrue(ix4); // true\n\n\n1\n2\n3\n4\n5\n\n\n\n# simd.%type%.min()ï¼simd.%type%.minnum()\n\nminæ¹æ³æ¥åä¸¤ä¸ª simd å¼ä½ä¸ºåæ°ï¼å°ä¸¤èçå¯¹åºééçè¾å°å¼ï¼ç»æä¸ä¸ªæ°ç simd å¼è¿åã\n\nvar a = simd.float32x4(-1, -2, 3, 5.2);\nvar b = simd.float32x4(0, -4, 6, 5.5);\nsimd.float32x4.min(a, b);\n// float32x4[-1, -4, 3, 5.2]\n\n\n1\n2\n3\n4\n\n\nå¦ææä¸ä¸ªééçå¼æ¯nanï¼åä¼ä¼åè¿ånanã\n\nvar c = simd.float64x2(nan, infinity)\nvar d = simd.float64x2(1337, 42);\nsimd.float64x2.min(c, d);\n// float64x2[nan, 42]\n\n\n1\n2\n3\n4\n\n\nminnumæ¹æ³ä¸minçä½ç¨ä¸æ¨¡ä¸æ ·ï¼å¯ä¸çåºå«æ¯å¦ææä¸ä¸ªééçå¼æ¯nanï¼åä¼ä¼åè¿åå¦ä¸ä¸ªééçå¼ã\n\nvar ax4 = simd.float32x4(1.0, 2.0, nan, nan);\nvar bx4 = simd.float32x4(2.0, 1.0, 3.0, nan);\nvar cx4 = simd.float32x4.min(ax4, bx4);\n// float32x4[1.0, 1.0, nan, nan]\nvar dx4 = simd.float32x4.minnum(ax4, bx4);\n// float32x4[1.0, 1.0, 3.0, nan]\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# simd.%type%.max()ï¼simd.%type%.maxnum()\n\nmaxæ¹æ³æ¥åä¸¤ä¸ª simd å¼ä½ä¸ºåæ°ï¼å°ä¸¤èçå¯¹åºééçè¾å¤§å¼ï¼ç»æä¸ä¸ªæ°ç simd å¼è¿åã\n\nvar a = simd.float32x4(-1, -2, 3, 5.2);\nvar b = simd.float32x4(0, -4, 6, 5.5);\nsimd.float32x4.max(a, b);\n// float32x4[0, -2, 6, 5.5]\n\n\n1\n2\n3\n4\n\n\nå¦ææä¸ä¸ªééçå¼æ¯nanï¼åä¼ä¼åè¿ånanã\n\nvar c = simd.float64x2(nan, infinity)\nvar d = simd.float64x2(1337, 42);\nsimd.float64x2.max(c, d)\n// float64x2[nan, infinity]\n\n\n1\n2\n3\n4\n\n\nmaxnumæ¹æ³ä¸maxçä½ç¨ä¸æ¨¡ä¸æ ·ï¼å¯ä¸çåºå«æ¯å¦ææä¸ä¸ªééçå¼æ¯nanï¼åä¼ä¼åè¿åå¦ä¸ä¸ªééçå¼ã\n\nvar c = simd.float64x2(nan, infinity)\nvar d = simd.float64x2(1337, 42);\nsimd.float64x2.maxnum(c, d)\n// float64x2[1337, infinity]\n\n\n1\n2\n3\n4\n\n\n\n# éææ¹æ³ï¼ä½è¿ç®\n\n\n# simd.%type%.and()ï¼simd.%type%.or()ï¼simd.%type%.xor()ï¼simd.%type%.not()\n\nandæ¹æ³æ¥åä¸¤ä¸ª simd å¼ä½ä¸ºåæ°ï¼è¿åä¸¤èå¯¹åºçééè¿è¡äºè¿å¶andè¿ç®ï¼&ï¼åå¾å°çæ°ç simd å¼ã\n\nvar a = simd.int32x4(1, 2, 4, 8);\nvar b = simd.int32x4(5, 5, 5, 5);\nsimd.int32x4.and(a, b)\n// int32x4[1, 0, 4, 0]\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼ä»¥éé0ä¸ºä¾ï¼1çäºè¿å¶å½¢å¼æ¯0001ï¼5çäºè¿å¶å½¢å¼æ¯01001ï¼æä»¥è¿è¡andè¿ç®ä»¥åï¼å¾å°0001ã\n\noræ¹æ³æ¥åä¸¤ä¸ª simd å¼ä½ä¸ºåæ°ï¼è¿åä¸¤èå¯¹åºçééè¿è¡äºè¿å¶orè¿ç®ï¼|ï¼åå¾å°çæ°ç simd å¼ã\n\nvar a = simd.int32x4(1, 2, 4, 8);\nvar b = simd.int32x4(5, 5, 5, 5);\nsimd.int32x4.or(a, b)\n// int32x4[5, 7, 5, 13]\n\n\n1\n2\n3\n4\n\n\nxoræ¹æ³æ¥åä¸¤ä¸ª simd å¼ä½ä¸ºåæ°ï¼è¿åä¸¤èå¯¹åºçééè¿è¡äºè¿å¶âå¼æâè¿ç®ï¼^ï¼åå¾å°çæ°ç simd å¼ã\n\nvar a = simd.int32x4(1, 2, 4, 8);\nvar b = simd.int32x4(5, 5, 5, 5);\nsimd.int32x4.xor(a, b)\n// int32x4[4, 7, 1, 13]\n\n\n1\n2\n3\n4\n\n\nnotæ¹æ³æ¥åä¸ä¸ª simd å¼ä½ä¸ºåæ°ï¼è¿åæ¯ä¸ªééè¿è¡äºè¿å¶âå¦âè¿ç®ï¼~ï¼åå¾å°çæ°ç simd å¼ã\n\nvar a = simd.int32x4(1, 2, 4, 8);\nsimd.int32x4.not(a)\n// int32x4[-2, -3, -5, -9]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼1çå¦è¿ç®ä¹æä»¥å¾å°-2ï¼æ¯å ä¸ºå¨è®¡ç®æºåé¨ï¼è´æ°éç¨â2 çè¡¥ç âè¿ç§å½¢å¼è¿è¡è¡¨ç¤ºãä¹å°±æ¯è¯´ï¼æ´æ°nçè´æ°å½¢å¼-nï¼æ¯å¯¹æ¯ä¸ä¸ªäºè¿å¶ä½ååä»¥åï¼åå ä¸ 1ãå æ­¤ï¼ç´æ¥ååå°±ç¸å½äºè´æ°å½¢å¼ååå» 1ï¼æ¯å¦1çè´æ°å½¢å¼æ¯-1ï¼ååå» 1ï¼å°±å¾å°äº-2ã\n\n\n# éææ¹æ³ï¼æ°æ®ç±»åè½¬æ¢\n\nsimd æä¾ä»¥ä¸æ¹æ³ï¼ç¨æ¥å°ä¸ç§æ°æ®ç±»åè½¬ä¸ºå¦ä¸ç§æ°æ®ç±»åã\n\n * simd.%type%.fromfloat32x4()\n * simd.%type%.fromfloat32x4bits()\n * simd.%type%.fromfloat64x2bits()\n * simd.%type%.fromint32x4()\n * simd.%type%.fromint32x4bits()\n * simd.%type%.fromint16x8bits()\n * simd.%type%.fromint8x16bits()\n * simd.%type%.fromuint32x4()\n * simd.%type%.fromuint32x4bits()\n * simd.%type%.fromuint16x8bits()\n * simd.%type%.fromuint8x16bits()\n\nå¸¦æbitsåç¼çæ¹æ³ï¼ä¼åå°ä¸å¨å°å°äºè¿å¶ä½æ·è´å°æ°çæ°æ®ç±»åï¼ä¸å¸¦åç¼çæ¹æ³ï¼åä¼è¿è¡æ°æ®ç±»åè½¬æ¢ã\n\nvar t = simd.float32x4(1.0, 2.0, 3.0, 4.0);\nsimd.int32x4.fromfloat32x4(t);\n// int32x4[1, 2, 3, 4]\n\nsimd.int32x4.fromfloat32x4bits(t);\n// int32x4[1065353216, 1073741824, 1077936128, 1082130432]\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼fromfloat32x4æ¯å°æµ®ç¹æ°è½¬ä¸ºæ´æ°ï¼ç¶åå­å¥æ°çæ°æ®ç±»åï¼fromfloat32x4bitsåæ¯å°äºè¿å¶ä½åå°ä¸å¨å°æ·è´è¿å¥æ°çæ°æ®ç±»åï¼ç¶åè¿è¡è§£è¯»ã\n\nbitsåç¼çæ¹æ³ï¼è¿å¯ä»¥ç¨äºééæ°ç®ä¸å¯¹ç­çæ·è´ã\n\nvar t = simd.float32x4(1.0, 2.0, 3.0, 4.0);\nsimd.int16x8.fromfloat32x4bits(t);\n// int16x8[0, 16256, 0, 16384, 0, 16448, 0, 16512]\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼åå§ simd å¼tæ¯ 4 ééçï¼èç®æ å¼æ¯ 8 ééçã\n\nå¦ææ°æ®è½¬æ¢æ¶ï¼åééçæ°æ®å¤§å°ï¼è¶è¿äºç®æ ééçæå¤§å®½åº¦ï¼å°±ä¼æ¥éã\n\n\n# å®ä¾æ¹æ³\n\n\n# simd.%type%.prototype.tostring()\n\ntostringæ¹æ³è¿åä¸ä¸ª simd å¼çå­ç¬¦ä¸²å½¢å¼ã\n\nvar a = simd.float32x4(11, 22, 33, 44);\na.tostring() // \"simd.float32x4(11, 22, 33, 44)\"\n\n\n1\n2\n\n\n\n# å®ä¾ï¼æ±å¹³åå¼\n\næ­£å¸¸æ¨¡å¼ä¸ï¼è®¡ç®nä¸ªå¼çå¹³åå¼ï¼éè¦è¿ç®næ¬¡ã\n\nfunction average(list) {\n  var n = list.length;\n  var sum = 0.0;\n  for (var i = 0; i < n; i++) {\n    sum += list[i];\n  }\n  return sum / n;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä½¿ç¨ simdï¼å¯ä»¥å°è®¡ç®æ¬¡æ°åå°å°næ¬¡çååä¹ä¸ã\n\nfunction average(list) {\n  var n = list.length;\n  var sum = simd.float32x4.splat(0.0);\n  for (var i = 0; i < n; i += 4) {\n    sum = simd.float32x4.add(\n      sum,\n      simd.float32x4.load(list, i)\n    );\n  }\n  var total = simd.float32x4.extractlane(sum, 0) +\n              simd.float32x4.extractlane(sum, 1) +\n              simd.float32x4.extractlane(sum, 2) +\n              simd.float32x4.extractlane(sum, 3);\n  return total / n;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç åæ¯æ¯éåä½ï¼å°ææçå¼è¯»å¥ä¸ä¸ª simdï¼ç¶åç«å»ç´¯å ãç¶åï¼å¾å°ç´¯å å¼åä¸ªééçæ»åï¼åé¤ä»¥nå°±å¯ä»¥äºã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"åèé¾æ¥",frontmatter:{title:"åèé¾æ¥",date:"2020-02-09T16:00:30.000Z",permalink:"/pages/ea6f3b870f6dab69",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/34.%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5.html",relativePath:"ãES6 æç¨ãç¬è®°/34.åèé¾æ¥.md",key:"v-21627c86",path:"/pages/ea6f3b870f6dab69/",headers:[{level:2,title:"å®æ¹æä»¶",slug:"å®æ¹æä»¶",normalizedTitle:"å®æ¹æä»¶",charIndex:11},{level:2,title:"ç»¼åä»ç»",slug:"ç»¼åä»ç»",normalizedTitle:"ç»¼åä»ç»",charIndex:570},{level:2,title:"let å const",slug:"let-å-const",normalizedTitle:"let å const",charIndex:1739},{level:2,title:"è§£æèµå¼",slug:"è§£æèµå¼",normalizedTitle:"è§£æèµå¼",charIndex:2258},{level:2,title:"å­ç¬¦ä¸²",slug:"å­ç¬¦ä¸²",normalizedTitle:"å­ç¬¦ä¸²",charIndex:2398},{level:2,title:"æ­£å",slug:"æ­£å",normalizedTitle:"æ­£å",charIndex:2769},{level:2,title:"æ°å¼",slug:"æ°å¼",normalizedTitle:"æ°å¼",charIndex:3150},{level:2,title:"æ°ç»",slug:"æ°ç»",normalizedTitle:"æ°ç»",charIndex:3345},{level:2,title:"å½æ°",slug:"å½æ°",normalizedTitle:"å½æ°",charIndex:2097},{level:2,title:"å¯¹è±¡",slug:"å¯¹è±¡",normalizedTitle:"å¯¹è±¡",charIndex:2149},{level:2,title:"Symbol",slug:"symbol",normalizedTitle:"symbol",charIndex:4956},{level:2,title:"Set å Map",slug:"set-å-map",normalizedTitle:"set å map",charIndex:5402},{level:2,title:"Proxy å Reflect",slug:"proxy-å-reflect",normalizedTitle:"proxy å reflect",charIndex:5747},{level:2,title:"Promise å¯¹è±¡",slug:"promise-å¯¹è±¡",normalizedTitle:"promise å¯¹è±¡",charIndex:6553},{level:2,title:"Iterator",slug:"iterator",normalizedTitle:"iterator",charIndex:7246},{level:2,title:"Generator",slug:"generator",normalizedTitle:"generator",charIndex:7525},{level:2,title:"å¼æ­¥æä½å Async å½æ°",slug:"å¼æ­¥æä½å-async-å½æ°",normalizedTitle:"å¼æ­¥æä½å async å½æ°",charIndex:8819},{level:2,title:"Class",slug:"class",normalizedTitle:"class",charIndex:9667},{level:2,title:"Decorator",slug:"decorator",normalizedTitle:"decorator",charIndex:10254},{level:2,title:"Module",slug:"module",normalizedTitle:"module",charIndex:10701},{level:2,title:"äºè¿å¶æ°ç»",slug:"äºè¿å¶æ°ç»",normalizedTitle:"äºè¿å¶æ°ç»",charIndex:11437},{level:2,title:"SIMD",slug:"simd",normalizedTitle:"simd",charIndex:11977},{level:2,title:"å·¥å·",slug:"å·¥å·",normalizedTitle:"å·¥å·",charIndex:12105}],headersStr:"å®æ¹æä»¶ ç»¼åä»ç» let å const è§£æèµå¼ å­ç¬¦ä¸² æ­£å æ°å¼ æ°ç» å½æ° å¯¹è±¡ Symbol Set å Map Proxy å Reflect Promise å¯¹è±¡ Iterator Generator å¼æ­¥æä½å Async å½æ° Class Decorator Module äºè¿å¶æ°ç» SIMD å·¥å·",content:"# åèé¾æ¥\n\n\n# å®æ¹æä»¶\n\n * ECMAScriptÂ® 2015 Language Specification: ECMAScript 2015 è§æ ¼\n * ECMAScriptÂ® 2016 Language Specification: ECMAScript 2016 è§æ ¼\n * ECMAScriptÂ® 2017 Language Specificationï¼ECMAScript 2017 è§æ ¼ï¼èæ¡ï¼\n * ECMAScript Current Proposals: ECMAScript å½åçææææ¡\n * ECMAScript Active Proposals: å·²ç»è¿å¥æ­£å¼æµç¨çææ¡\n * ECMAScript proposalsï¼ä»é¶æ®µ 0 å°é¶æ®µ 4 çææææ¡åè¡¨\n * TC39 meeting agendas: TC39 å§åä¼åå¹´çä¼è®®è®°å½\n * ECMAScript Daily: TC39 å§åä¼çå¨æ\n * The TC39 Process: ææ¡è¿å¥æ­£å¼è§æ ¼çæµç¨\n * TC39: A Process Sketch, Stages 0 and 1: Stage 0 å Stage 1 çå«ä¹\n * TC39 Process Sketch, Stage 2: Stage 2 çå«ä¹\n\n\n# ç»¼åä»ç»\n\n * Axel Rauschmayer, Exploring ES6: Upgrade to the next version of JavaScript: ES6 çä¸èï¼æ¬ä¹¦çè®¸å¤ä»£ç å®ä¾æ¥èªè¯¥ä¹¦\n * Sayanee Basu, Use ECMAScript 6 Today\n * Ariya Hidayat, Toward Modern Web Apps with ECMAScript 6\n * Dale Schouten, 10 Ecmascript-6 tricks you can perform right now\n * Colin Toh, Lightweight ES6 Features That Pack A Punch: ES6 çä¸äºâè½»éçº§âçç¹æ§ä»ç»\n * Domenic Denicola, ES6: The Awesome Parts\n * Nicholas C. Zakas, Understanding ECMAScript 6\n * Justin Drake, ECMAScript 6 in Node.JS\n * Ryan Dao, Summary of ECMAScript 6 major features\n * Luke Hoban, ES6 features: ES6 æ°è¯­æ³ç¹çç½å\n * Traceur-compiler, Language Features: Traceur ææ¡£ååºçä¸äº ES6 ä¾å­\n * Axel Rauschmayer, ECMAScript 6: whatâs next for JavaScript?: å³äº ES6 æ°å¢è¯­æ³çç»¼åä»ç»ï¼æå¾å¤ä¾å­\n * Axel Rauschmayer, Getting started with ECMAScript 6: ES6 è¯­æ³ç¹çç»¼åä»ç»\n * Toby Ho, ES6 in io.js\n * Guillermo Rauch, ECMAScript 6\n * Benjamin De Cock, Frontend Guidelines: ES6 æä½³å®è·µ\n * Jani Hartikainen, ES6: What are the benefits of the new features in practice?\n * kangax, JavaScript quiz. ES6 edition: ES6 å°æµè¯\n * Jeremy Fairbank, HTML5DevConf ES7 and Beyond!: ES7 æ°å¢è¯­æ³ç¹ä»ç»\n * Timothy Gu, How to Read the ECMAScript Specification: å¦ä½è¯»æ ES6 è§æ ¼\n\n\n# let å const\n\n * Kyle Simpson, For and against let: è®¨è®º let å½ä»¤çä½ç¨å\n * kangax, Why typeof is no longer âsafeâ: è®¨è®ºå¨åçº§ä½ç¨ååï¼let å½ä»¤çåéå£°æåèµå¼çè¡ä¸º\n * Axel Rauschmayer, Variables and scoping in ECMAScript 6: è®¨è®ºåçº§ä½ç¨åä¸ let å const çè¡ä¸º\n * Nicolas Bevacqua, ES6 Let, Const and the âTemporal Dead Zoneâ (TDZ) in Depth\n * acorn, Function statements in strict mode: åçº§ä½ç¨åå¯¹ä¸¥æ ¼æ¨¡å¼çå½æ°å£°æçå½±å\n * Axel Rauschmayer, ES proposal: global: é¡¶å±å¯¹è±¡global\n * Mathias Bynens, A horrifying globalThis polyfill in universal JavaScriptï¼å¦ä½å globalThis çå«çåº\n\n\n# è§£æèµå¼\n\n * Nick Fitzgerald, Destructuring Assignment in ECMAScript 6: è¯¦ç»ä»ç»è§£æèµå¼çç¨æ³\n * Nicholas C. Zakas, ECMAScript 6 destructuring gotcha\n\n\n# å­ç¬¦ä¸²\n\n * Nicholas C. Zakas, A critical review of ECMAScript 6 quasi-literals\n * Mozilla Developer Network, Template strings\n * Addy Osmani, Getting Literal With ES6 Template Strings: æ¨¡æ¿å­ç¬¦ä¸²çä»ç»\n * Blake Winton, ES6 Templates: æ¨¡æ¿å­ç¬¦ä¸²çä»ç»\n * Peter Jaszkowiak, How to write a template compiler in JavaScript: ä½¿ç¨æ¨¡æ¿å­ç¬¦ä¸²ï¼ç¼åä¸ä¸ªæ¨¡æ¿ç¼è¯å½æ°\n * Axel Rauschmayer, ES.stage3: string padding\n\n\n# æ­£å\n\n * Mathias Bynens, Unicode-aware regular expressions in ES6: è¯¦ç»ä»ç»æ­£åè¡¨è¾¾å¼ç u ä¿®é¥°ç¬¦\n * Axel Rauschmayer, New regular expression features in ECMAScript 6ï¼ES6 æ­£åç¹æ§çè¯¦ç»ä»ç»\n * Yang Guo, RegExp lookbehind assertionsï¼ä»ç»åè¡æ­è¨\n * Axel Rauschmayer, ES proposal: RegExp named capture groups: å·åç»å¹éçä»ç»\n * Mathias Bynens, ECMAScript regular expressions are getting better!: ä»ç» ES2018 æ·»å çå¤é¡¹æ­£åè¯­æ³\n\n\n# æ°å¼\n\n * Nicolas Bevacqua, ES6 Number Improvements in Depth\n * Axel Rauschmayer, ES proposal: arbitrary precision integers\n * Mathias Bynens, BigInt: arbitrary-precision integers in JavaScript\n\n\n# æ°ç»\n\n * Axel Rauschmayer, ECMAScript 6âs new array methods: å¯¹ ES6 æ°å¢çæ°ç»æ¹æ³çå¨é¢ä»ç»\n * TC39, Array.prototype.includes: æ°ç»ç includes æ¹æ³çè§æ ¼\n * Axel Rauschmayer, ECMAScript 6: holes in Arrays: æ°ç»çç©ºä½é®é¢\n\n\n# å½æ°\n\n * Nicholas C. Zakas, Understanding ECMAScript 6 arrow functions\n * Jack Franklin, Real Life ES6 - Arrow Functions\n * Axel Rauschmayer, Handling required parameters in ECMAScript 6\n * Dmitry Soshnikov, ES6 Notes: Default values of parameters: ä»ç»åæ°çé»è®¤å¼\n * Ragan Wald, Destructuring and Recursion in ES6: rest åæ°åæ©å±è¿ç®ç¬¦çè¯¦ç»ä»ç»\n * Axel Rauschmayer, The names of functions in ES6: å½æ°ç name å±æ§çè¯¦ç»ä»ç»\n * Kyle Simpson, Arrow This: ç®­å¤´å½æ°å¹¶æ²¡æèªå·±ç this\n * Derick Bailey, Do ES6 Arrow Functions Really Solve âthisâ In JavaScript?ï¼ä½¿ç¨ç®­å¤´å½æ°å¤ç this æåï¼å¿é¡»éå¸¸å°å¿\n * Mark McDonnell, Understanding recursion in functional JavaScript programming: å¦ä½èªå·±å®ç°å°¾éå½ä¼å\n * Nicholas C. Zakas, The ECMAScript 2016 change you probably don't know: ä½¿ç¨åæ°é»è®¤å¼æ¶ï¼ä¸è½å¨å½æ°åé¨æ¾å¼å¼å¯ä¸¥æ ¼æ¨¡å¼\n * Axel Rauschmayer, ES proposal: optional catch binding\n * Cynthia Lee, When you should use ES6 arrow functionsâââand when you shouldnât: è®¨è®ºç®­å¤´å½æ°çéç¨åºå\n * Eric Elliott, What is this?: ç®­å¤´å½æ°åé¨ç this çè§£éã\n\n\n# å¯¹è±¡\n\n * Addy Osmani, Data-binding Revolutions with Object.observe(): ä»ç» Object.observe()çæ¦å¿µ\n * Sella Rafaeli, Native JavaScript Data-Binding: å¦ä½ä½¿ç¨ Object.observe æ¹æ³ï¼å®ç°æ°æ®å¯¹è±¡ä¸ DOM å¯¹è±¡çååç»å®\n * Axel Rauschmayer, __proto__ in ECMAScript 6\n * Axel Rauschmayer, Enumerability in ECMAScript 6\n * Axel Rauschmayer, ES proposal: Object.getOwnPropertyDescriptors()\n * TC39, Object.getOwnPropertyDescriptors Proposal\n * David Titarenco, How Spread Syntax Breaks JavaScript: æ©å±è¿ç®ç¬¦çä¸äºä¸åççå°æ¹\n\n\n# Symbol\n\n * Axel Rauschmayer, Symbols in ECMAScript 6: Symbol ç®ä»\n * MDN, Symbol: Symbol ç±»åçè¯¦ç»ä»ç»\n * Jason Orendorff, ES6 In Depth: Symbols\n * Keith Cirkel, Metaprogramming in ES6: Symbols and why they're awesome: Symbol çæ·±å¥ä»ç»\n * Axel Rauschmayer, Customizing ES6 via well-known symbols\n * Derick Bailey, Creating A True Singleton In Node.js, With ES6 Symbols\n * Das Surma, How to read web specs Part IIa â Or: ECMAScript Symbols: ä»ç» Symbol çè§æ ¼\n\n\n# Set å Map\n\n * Mozilla Developer Network, WeakSetï¼ä»ç» WeakSet æ°æ®ç»æ\n * Dwayne Charrington, What Are Weakmaps In ES6?: WeakMap æ°æ®ç»æä»ç»\n * Axel Rauschmayer, ECMAScript 6: maps and sets: Set å Map ç»æçè¯¦ç»ä»ç»\n * Jason Orendorff, ES6 In Depth: Collectionsï¼Set å Map ç»æçè®¾è®¡ææ³\n * Axel Rauschmayer, Converting ES6 Maps to and from JSON: å¦ä½å° Map ä¸å¶ä»æ°æ®ç»æäºç¸è½¬æ¢\n\n\n# Proxy å Reflect\n\n * Nicholas C. Zakas, Creating defensive objects with ES6 proxies\n * Axel Rauschmayer, Meta programming with ECMAScript 6 proxies: Proxy è¯¦è§£\n * Daniel Zautner, Meta-programming JavaScript Using Proxies: ä½¿ç¨ Proxy å®ç°åç¼ç¨\n * Tom Van Cutsem, Harmony-reflect: Reflect å¯¹è±¡çè®¾è®¡ç®ç\n * Tom Van Cutsem, Proxy Traps: Proxy æ¦æªæä½ä¸è§\n * Tom Van Cutsem, Reflect API\n * Tom Van Cutsem, Proxy Handler API\n * Nicolas Bevacqua, ES6 Proxies in Depth\n * Nicolas Bevacqua, ES6 Proxy Traps in Depth\n * Nicolas Bevacqua, More ES6 Proxy Traps in Depth\n * Axel Rauschmayer, Pitfall: not all objects can be wrapped transparently by proxies\n * Bertalan Miklos, Writing a JavaScript Framework - Data Binding with ES6 Proxies: ä½¿ç¨ Proxy å®ç°è§å¯èæ¨¡å¼\n * Keith Cirkel, Metaprogramming in ES6: Part 2 - Reflect: Reflect API çè¯¦ç»ä»ç»\n\n\n# Promise å¯¹è±¡\n\n * Jake Archibald, JavaScript Promises: There and back again\n * Jake Archibald, Tasks, microtasks, queues and schedules\n * Tilde, rsvp.js\n * Sandeep Panda, An Overview of JavaScript Promises: ES6 Promise å¥é¨ä»ç»\n * Dave Atchley, ES6 Promises: Promise çè¯­æ³ä»ç»\n * Axel Rauschmayer, ECMAScript 6 promises (2/2): the API: å¯¹ ES6 Promise è§æ ¼åç¨æ³çè¯¦ç»ä»ç»\n * Jack Franklin, Embracing Promises in JavaScript: catch æ¹æ³çä¾å­\n * Ronald Chen, How to escape Promise Hell: å¦ä½ä½¿ç¨Promise.allæ¹æ³çä¸äºå¾å¥½çä¾å­\n * Jordan Harband, proposal-promise-try: Promise.try() æ¹æ³çææ¡\n * Sven Slootweg, What is Promise.try, and why does it matter?: Promise.try() æ¹æ³çä¼ç¹\n * Yehuda Katz, TC39: Promises, Promises: Promise.try() çç¨å¤\n\n\n# Iterator\n\n * Mozilla Developer Network, Iterators and generators\n * Mozilla Developer Network, The Iterator protocol\n * Jason Orendorff, ES6 In Depth: Iterators and the for-of loop: éåå¨ä¸ for...of å¾ªç¯çä»ç»\n * Axel Rauschmayer, Iterators and generators in ECMAScript 6: æ¢è®¨ Iterator å Generator çè®¾è®¡ç®ç\n * Axel Rauschmayer, Iterables and iterators in ECMAScript 6: Iterator çè¯¦ç»ä»ç»\n * Kyle Simpson, Iterating ES6 Numbers: å¨æ°å¼å¯¹è±¡ä¸é¨ç½²éåå¨\n\n\n# Generator\n\n * Matt Baker, Replacing callbacks with ES6 Generators\n * Steven Sanderson, Experiments with Koa and JavaScript Generators\n * jmar777, What's the Big Deal with Generators?\n * Marc Harter, Generators in Node.js: Common Misconceptions and Three Good Use Cases: è®¨è®º Generator å½æ°çä½ç¨\n * StackOverflow, ES6 yield : what happens to the arguments of the first call next()?: ç¬¬ä¸æ¬¡ä½¿ç¨ next æ¹æ³æ¶ä¸è½å¸¦æåæ°\n * Kyle Simpson, ES6 Generators: Complete Series: ç±æµå¥æ·±æ¢è®¨ Generator çç³»åæç« ï¼å±åç¯\n * Gajus Kuizinas, The Definitive Guide to the JavaScript Generators: å¯¹ Generator çç»¼åä»ç»\n * Jan Krems, Generators Are Like Arrays: è®¨è®º Generator å¯ä»¥è¢«å½ä½æ°æ®ç»æçå¾\n * Harold Cooper, Coroutine Event Loops in JavaScript: Generator ç¨äºå®ç°ç¶ææº\n * Ruslan Ismagilov, learn-generators: ç¼ç¨ç»ä¹ ï¼å± 6 éé¢\n * Steven Sanderson, Experiments with Koa and JavaScript Generators: Generator å¥é¨ä»ç»ï¼ä»¥ Koa æ¡æ¶ä¸ºä¾\n * Mahdi Dibaiee, ES7 Array and Generator comprehensionsï¼ES7 ç Generator æ¨å¯¼\n * Nicolas Bevacqua, ES6 Generators in Depth\n * Axel Rauschmayer, ES6 generators in depth: Generator è§æ ¼çè¯¦å°½è®²è§£\n * Derick Bailey, Using ES6 Generators To Short-Circuit Hierarchical Data Iterationï¼ä½¿ç¨ for...of å¾ªç¯å®æé¢å®çæä½æ­¥éª¤\n\n\n# å¼æ­¥æä½å Async å½æ°\n\n * Luke Hoban, Async Functions for ECMAScript: Async å½æ°çè®¾è®¡ææ³ï¼ä¸ PromiseãGernerator å½æ°çå³ç³»\n * Jafar Husain, Asynchronous Generators for ES7: Async å½æ°çæ·±å¥è®¨è®º\n * Nolan Lawson, Taming the asynchronous beast with ES7: async å½æ°éä¿çå®ä¾è®²è§£\n * Jafar Husain, Async Generators: å¯¹ async ä¸ Generator æ··åä½¿ç¨çä¸äºè®¨è®º\n * Daniel Brain, Understand promises before you start using async/await: è®¨è®º async/await ä¸ Promise çå³ç³»\n * Jake Archibald, Async functions - making promises friendly\n * Axel Rauschmayer, ES proposal: asynchronous iteration: å¼æ­¥éåå¨çè¯¦ç»ä»ç»\n * Dima Grossman, How to write async await without try-catch blocks in JavaScript: é¤äº try/catch ä»¥å¤ç async å½æ°åé¨ææéè¯¯çæ¹æ³\n * Mostafa Gaafa, 6 Reasons Why JavaScriptâs Async/Await Blows Promises Away: Async å½æ°ç6ä¸ªå¥½å¤\n * Mathias Bynens, Asynchronous stack traces: why await beats Promise#then(): async å½æ°å¯ä»¥ä¿çéè¯¯å æ \n\n\n# Class\n\n * Sebastian Porto, ES6 classes and JavaScript prototypes: ES6 Class çåæ³ä¸ ES5 Prototype çåæ³å¯¹æ¯\n * Jack Franklin, An introduction to ES6 classes: ES6 class çå¥é¨ä»ç»\n * Axel Rauschmayer, ECMAScript 6: new OOP features besides classes\n * Axel Rauschmayer, Classes in ECMAScript 6 (final semantics): Class è¯­æ³çè¯¦ç»ä»ç»åè®¾è®¡ææ³åæ\n * Eric Faust, ES6 In Depth: Subclassing: Class è¯­æ³çæ·±å¥ä»ç»\n * NicolÃ¡s Bevacqua, Binding Methods to Class Instance Objects: å¦ä½ç»å®ç±»çå®ä¾ä¸­ç this\n * Jamie Kyle, JavaScript's new #private class fieldsï¼ç§æå±æ§çä»ç»ã\n * Mathias Bynens, Public and private class fieldsï¼å®ä¾å±æ§çæ°åæ³çä»ç»ã\n\n\n# Decorator\n\n * Maximiliano Fierro, Declarative vs Imperative: Decorators å Mixin ä»ç»\n * Justin Fagnani, \"Real\" Mixins with JavaScript Classes: ä½¿ç¨ç±»çç»§æ¿å®ç° Mixin\n * Addy Osmani, Exploring ES2016 Decorators: Decorator çæ·±å¥ä»ç»\n * Sebastian McKenzie, Allow decorators for functions as well: ä¸ºä»ä¹ä¿®é¥°å¨ä¸è½ç¨äºå½æ°\n * Maximiliano Fierro, Traits with ES7 Decorators: Trait çç¨æ³ä»ç»\n * Jonathan Creamer: Using ES2016 Decorators to Publish on an Event Bus: ä½¿ç¨ä¿®é¥°å¨å®ç°èªå¨åå¸äºä»¶\n\n\n# Module\n\n * Jack Franklin, JavaScript Modules the ES6 Way: ES6 æ¨¡åå¥é¨\n * Axel Rauschmayer, ECMAScript 6 modules: the final syntax: ES6 æ¨¡åçä»ç»ï¼ä»¥åä¸ CommonJS è§æ ¼çè¯¦ç»æ¯è¾\n * Dave Herman, Static module resolution: ES6 æ¨¡åçéæåè®¾è®¡ææ³\n * Jason Orendorff, ES6 In Depth: Modules: ES6 æ¨¡åè®¾è®¡ææ³çä»ç»\n * Ben Newman, The Importance of import and export: ES6 æ¨¡åçè®¾è®¡ææ³\n * ESDiscuss, Why is \"export default var a = 1;\" invalid syntax?\n * Bradley Meck, ES6 Module Interoperability: ä»ç» Node å¦ä½å¤ç ES6 è¯­æ³å è½½ CommonJS æ¨¡å\n * Axel Rauschmayer, Making transpiled ES modules more spec-compliant: ES6 æ¨¡åç¼è¯æ CommonJS æ¨¡åçè¯¦ç»ä»ç»\n * Axel Rauschmayer, ES proposal: import() â dynamically importing ES modules: import() çç¨æ³\n * Node EPS, ES Module Interoperability: Node å¯¹ ES6 æ¨¡åçå¤çè§æ ¼\n\n\n# äºè¿å¶æ°ç»\n\n * Ilmari Heikkinen, Typed Arrays: Binary Data in the Browser\n * Khronos, Typed Array Specification\n * Ian Elliot, Reading A BMP File In JavaScript\n * Renato Mangini, How to convert ArrayBuffer to and from String\n * Axel Rauschmayer, Typed Arrays in ECMAScript 6\n * Axel Rauschmayer, ES proposal: Shared memory and atomics\n * Lin Clark, Avoiding race conditions in SharedArrayBuffers with Atomics: Atomics å¯¹è±¡ä½¿ç¨åºæ¯çè§£é\n * Lars T Hansen, Shared memory - a brief tutorial\n * James Milner, The Return of SharedArrayBuffers and Atomics\n\n\n# SIMD\n\n * TC39, SIMD.js Stage 2\n * MDN, SIMD\n * TC39, ECMAScript SIMD\n * Axel Rauschmayer, JavaScript gains support for SIMD\n\n\n# å·¥å·\n\n * Babel, Babel Handbook: Babel çç¨æ³ä»ç»\n * Google, traceur-compiler: Traceur ç¼è¯å¨\n * Casper Beyer, ECMAScript 6 Features and Tools\n * Stoyan Stefanov, Writing ES6 today with jstransform\n * ES6 Module Loader, ES6 Module Loader Polyfill: å¨æµè§å¨å node.js å è½½ ES6 æ¨¡åçä¸ä¸ªåºï¼ææ¡£éå¯¹ ES6 æ¨¡åæè¯¦ç»è§£é\n * Paul Miller, es6-shim: ä¸ä¸ªéå¯¹èå¼æµè§å¨ï¼æ¨¡æ ES6 é¨ååè½çå«çåºï¼shimï¼\n * army8735, JavaScript Downcast: å½äº§ç ES6 å° ES5 çè½¬ç å¨\n * esnext, ES6 Module Transpilerï¼åºäº node.js çå° ES6 æ¨¡åè½¬ä¸º ES5 ä»£ç çå½ä»¤è¡å·¥å·\n * Sebastian McKenzie, BabelJS: ES6 è½¬è¯å¨\n * SystemJS, SystemJS: å¨æµè§å¨ä¸­å è½½ AMDãCJSãES6 æ¨¡åçä¸ä¸ªå«çåº\n * Modernizr, HTML5 Cross Browser Polyfills: ES6 å«çåºæ¸å\n * Facebook, regenerator: å° Generator å½æ°è½¬ä¸º ES5 çè½¬ç å¨",normalizedContent:"# åèé¾æ¥\n\n\n# å®æ¹æä»¶\n\n * ecmascriptÂ® 2015 language specification: ecmascript 2015 è§æ ¼\n * ecmascriptÂ® 2016 language specification: ecmascript 2016 è§æ ¼\n * ecmascriptÂ® 2017 language specificationï¼ecmascript 2017 è§æ ¼ï¼èæ¡ï¼\n * ecmascript current proposals: ecmascript å½åçææææ¡\n * ecmascript active proposals: å·²ç»è¿å¥æ­£å¼æµç¨çææ¡\n * ecmascript proposalsï¼ä»é¶æ®µ 0 å°é¶æ®µ 4 çææææ¡åè¡¨\n * tc39 meeting agendas: tc39 å§åä¼åå¹´çä¼è®®è®°å½\n * ecmascript daily: tc39 å§åä¼çå¨æ\n * the tc39 process: ææ¡è¿å¥æ­£å¼è§æ ¼çæµç¨\n * tc39: a process sketch, stages 0 and 1: stage 0 å stage 1 çå«ä¹\n * tc39 process sketch, stage 2: stage 2 çå«ä¹\n\n\n# ç»¼åä»ç»\n\n * axel rauschmayer, exploring es6: upgrade to the next version of javascript: es6 çä¸èï¼æ¬ä¹¦çè®¸å¤ä»£ç å®ä¾æ¥èªè¯¥ä¹¦\n * sayanee basu, use ecmascript 6 today\n * ariya hidayat, toward modern web apps with ecmascript 6\n * dale schouten, 10 ecmascript-6 tricks you can perform right now\n * colin toh, lightweight es6 features that pack a punch: es6 çä¸äºâè½»éçº§âçç¹æ§ä»ç»\n * domenic denicola, es6: the awesome parts\n * nicholas c. zakas, understanding ecmascript 6\n * justin drake, ecmascript 6 in node.js\n * ryan dao, summary of ecmascript 6 major features\n * luke hoban, es6 features: es6 æ°è¯­æ³ç¹çç½å\n * traceur-compiler, language features: traceur ææ¡£ååºçä¸äº es6 ä¾å­\n * axel rauschmayer, ecmascript 6: whatâs next for javascript?: å³äº es6 æ°å¢è¯­æ³çç»¼åä»ç»ï¼æå¾å¤ä¾å­\n * axel rauschmayer, getting started with ecmascript 6: es6 è¯­æ³ç¹çç»¼åä»ç»\n * toby ho, es6 in io.js\n * guillermo rauch, ecmascript 6\n * benjamin de cock, frontend guidelines: es6 æä½³å®è·µ\n * jani hartikainen, es6: what are the benefits of the new features in practice?\n * kangax, javascript quiz. es6 edition: es6 å°æµè¯\n * jeremy fairbank, html5devconf es7 and beyond!: es7 æ°å¢è¯­æ³ç¹ä»ç»\n * timothy gu, how to read the ecmascript specification: å¦ä½è¯»æ es6 è§æ ¼\n\n\n# let å const\n\n * kyle simpson, for and against let: è®¨è®º let å½ä»¤çä½ç¨å\n * kangax, why typeof is no longer âsafeâ: è®¨è®ºå¨åçº§ä½ç¨ååï¼let å½ä»¤çåéå£°æåèµå¼çè¡ä¸º\n * axel rauschmayer, variables and scoping in ecmascript 6: è®¨è®ºåçº§ä½ç¨åä¸ let å const çè¡ä¸º\n * nicolas bevacqua, es6 let, const and the âtemporal dead zoneâ (tdz) in depth\n * acorn, function statements in strict mode: åçº§ä½ç¨åå¯¹ä¸¥æ ¼æ¨¡å¼çå½æ°å£°æçå½±å\n * axel rauschmayer, es proposal: global: é¡¶å±å¯¹è±¡global\n * mathias bynens, a horrifying globalthis polyfill in universal javascriptï¼å¦ä½å globalthis çå«çåº\n\n\n# è§£æèµå¼\n\n * nick fitzgerald, destructuring assignment in ecmascript 6: è¯¦ç»ä»ç»è§£æèµå¼çç¨æ³\n * nicholas c. zakas, ecmascript 6 destructuring gotcha\n\n\n# å­ç¬¦ä¸²\n\n * nicholas c. zakas, a critical review of ecmascript 6 quasi-literals\n * mozilla developer network, template strings\n * addy osmani, getting literal with es6 template strings: æ¨¡æ¿å­ç¬¦ä¸²çä»ç»\n * blake winton, es6 templates: æ¨¡æ¿å­ç¬¦ä¸²çä»ç»\n * peter jaszkowiak, how to write a template compiler in javascript: ä½¿ç¨æ¨¡æ¿å­ç¬¦ä¸²ï¼ç¼åä¸ä¸ªæ¨¡æ¿ç¼è¯å½æ°\n * axel rauschmayer, es.stage3: string padding\n\n\n# æ­£å\n\n * mathias bynens, unicode-aware regular expressions in es6: è¯¦ç»ä»ç»æ­£åè¡¨è¾¾å¼ç u ä¿®é¥°ç¬¦\n * axel rauschmayer, new regular expression features in ecmascript 6ï¼es6 æ­£åç¹æ§çè¯¦ç»ä»ç»\n * yang guo, regexp lookbehind assertionsï¼ä»ç»åè¡æ­è¨\n * axel rauschmayer, es proposal: regexp named capture groups: å·åç»å¹éçä»ç»\n * mathias bynens, ecmascript regular expressions are getting better!: ä»ç» es2018 æ·»å çå¤é¡¹æ­£åè¯­æ³\n\n\n# æ°å¼\n\n * nicolas bevacqua, es6 number improvements in depth\n * axel rauschmayer, es proposal: arbitrary precision integers\n * mathias bynens, bigint: arbitrary-precision integers in javascript\n\n\n# æ°ç»\n\n * axel rauschmayer, ecmascript 6âs new array methods: å¯¹ es6 æ°å¢çæ°ç»æ¹æ³çå¨é¢ä»ç»\n * tc39, array.prototype.includes: æ°ç»ç includes æ¹æ³çè§æ ¼\n * axel rauschmayer, ecmascript 6: holes in arrays: æ°ç»çç©ºä½é®é¢\n\n\n# å½æ°\n\n * nicholas c. zakas, understanding ecmascript 6 arrow functions\n * jack franklin, real life es6 - arrow functions\n * axel rauschmayer, handling required parameters in ecmascript 6\n * dmitry soshnikov, es6 notes: default values of parameters: ä»ç»åæ°çé»è®¤å¼\n * ragan wald, destructuring and recursion in es6: rest åæ°åæ©å±è¿ç®ç¬¦çè¯¦ç»ä»ç»\n * axel rauschmayer, the names of functions in es6: å½æ°ç name å±æ§çè¯¦ç»ä»ç»\n * kyle simpson, arrow this: ç®­å¤´å½æ°å¹¶æ²¡æèªå·±ç this\n * derick bailey, do es6 arrow functions really solve âthisâ in javascript?ï¼ä½¿ç¨ç®­å¤´å½æ°å¤ç this æåï¼å¿é¡»éå¸¸å°å¿\n * mark mcdonnell, understanding recursion in functional javascript programming: å¦ä½èªå·±å®ç°å°¾éå½ä¼å\n * nicholas c. zakas, the ecmascript 2016 change you probably don't know: ä½¿ç¨åæ°é»è®¤å¼æ¶ï¼ä¸è½å¨å½æ°åé¨æ¾å¼å¼å¯ä¸¥æ ¼æ¨¡å¼\n * axel rauschmayer, es proposal: optional catch binding\n * cynthia lee, when you should use es6 arrow functionsâââand when you shouldnât: è®¨è®ºç®­å¤´å½æ°çéç¨åºå\n * eric elliott, what is this?: ç®­å¤´å½æ°åé¨ç this çè§£éã\n\n\n# å¯¹è±¡\n\n * addy osmani, data-binding revolutions with object.observe(): ä»ç» object.observe()çæ¦å¿µ\n * sella rafaeli, native javascript data-binding: å¦ä½ä½¿ç¨ object.observe æ¹æ³ï¼å®ç°æ°æ®å¯¹è±¡ä¸ dom å¯¹è±¡çååç»å®\n * axel rauschmayer, __proto__ in ecmascript 6\n * axel rauschmayer, enumerability in ecmascript 6\n * axel rauschmayer, es proposal: object.getownpropertydescriptors()\n * tc39, object.getownpropertydescriptors proposal\n * david titarenco, how spread syntax breaks javascript: æ©å±è¿ç®ç¬¦çä¸äºä¸åççå°æ¹\n\n\n# symbol\n\n * axel rauschmayer, symbols in ecmascript 6: symbol ç®ä»\n * mdn, symbol: symbol ç±»åçè¯¦ç»ä»ç»\n * jason orendorff, es6 in depth: symbols\n * keith cirkel, metaprogramming in es6: symbols and why they're awesome: symbol çæ·±å¥ä»ç»\n * axel rauschmayer, customizing es6 via well-known symbols\n * derick bailey, creating a true singleton in node.js, with es6 symbols\n * das surma, how to read web specs part iia â or: ecmascript symbols: ä»ç» symbol çè§æ ¼\n\n\n# set å map\n\n * mozilla developer network, weaksetï¼ä»ç» weakset æ°æ®ç»æ\n * dwayne charrington, what are weakmaps in es6?: weakmap æ°æ®ç»æä»ç»\n * axel rauschmayer, ecmascript 6: maps and sets: set å map ç»æçè¯¦ç»ä»ç»\n * jason orendorff, es6 in depth: collectionsï¼set å map ç»æçè®¾è®¡ææ³\n * axel rauschmayer, converting es6 maps to and from json: å¦ä½å° map ä¸å¶ä»æ°æ®ç»æäºç¸è½¬æ¢\n\n\n# proxy å reflect\n\n * nicholas c. zakas, creating defensive objects with es6 proxies\n * axel rauschmayer, meta programming with ecmascript 6 proxies: proxy è¯¦è§£\n * daniel zautner, meta-programming javascript using proxies: ä½¿ç¨ proxy å®ç°åç¼ç¨\n * tom van cutsem, harmony-reflect: reflect å¯¹è±¡çè®¾è®¡ç®ç\n * tom van cutsem, proxy traps: proxy æ¦æªæä½ä¸è§\n * tom van cutsem, reflect api\n * tom van cutsem, proxy handler api\n * nicolas bevacqua, es6 proxies in depth\n * nicolas bevacqua, es6 proxy traps in depth\n * nicolas bevacqua, more es6 proxy traps in depth\n * axel rauschmayer, pitfall: not all objects can be wrapped transparently by proxies\n * bertalan miklos, writing a javascript framework - data binding with es6 proxies: ä½¿ç¨ proxy å®ç°è§å¯èæ¨¡å¼\n * keith cirkel, metaprogramming in es6: part 2 - reflect: reflect api çè¯¦ç»ä»ç»\n\n\n# promise å¯¹è±¡\n\n * jake archibald, javascript promises: there and back again\n * jake archibald, tasks, microtasks, queues and schedules\n * tilde, rsvp.js\n * sandeep panda, an overview of javascript promises: es6 promise å¥é¨ä»ç»\n * dave atchley, es6 promises: promise çè¯­æ³ä»ç»\n * axel rauschmayer, ecmascript 6 promises (2/2): the api: å¯¹ es6 promise è§æ ¼åç¨æ³çè¯¦ç»ä»ç»\n * jack franklin, embracing promises in javascript: catch æ¹æ³çä¾å­\n * ronald chen, how to escape promise hell: å¦ä½ä½¿ç¨promise.allæ¹æ³çä¸äºå¾å¥½çä¾å­\n * jordan harband, proposal-promise-try: promise.try() æ¹æ³çææ¡\n * sven slootweg, what is promise.try, and why does it matter?: promise.try() æ¹æ³çä¼ç¹\n * yehuda katz, tc39: promises, promises: promise.try() çç¨å¤\n\n\n# iterator\n\n * mozilla developer network, iterators and generators\n * mozilla developer network, the iterator protocol\n * jason orendorff, es6 in depth: iterators and the for-of loop: éåå¨ä¸ for...of å¾ªç¯çä»ç»\n * axel rauschmayer, iterators and generators in ecmascript 6: æ¢è®¨ iterator å generator çè®¾è®¡ç®ç\n * axel rauschmayer, iterables and iterators in ecmascript 6: iterator çè¯¦ç»ä»ç»\n * kyle simpson, iterating es6 numbers: å¨æ°å¼å¯¹è±¡ä¸é¨ç½²éåå¨\n\n\n# generator\n\n * matt baker, replacing callbacks with es6 generators\n * steven sanderson, experiments with koa and javascript generators\n * jmar777, what's the big deal with generators?\n * marc harter, generators in node.js: common misconceptions and three good use cases: è®¨è®º generator å½æ°çä½ç¨\n * stackoverflow, es6 yield : what happens to the arguments of the first call next()?: ç¬¬ä¸æ¬¡ä½¿ç¨ next æ¹æ³æ¶ä¸è½å¸¦æåæ°\n * kyle simpson, es6 generators: complete series: ç±æµå¥æ·±æ¢è®¨ generator çç³»åæç« ï¼å±åç¯\n * gajus kuizinas, the definitive guide to the javascript generators: å¯¹ generator çç»¼åä»ç»\n * jan krems, generators are like arrays: è®¨è®º generator å¯ä»¥è¢«å½ä½æ°æ®ç»æçå¾\n * harold cooper, coroutine event loops in javascript: generator ç¨äºå®ç°ç¶ææº\n * ruslan ismagilov, learn-generators: ç¼ç¨ç»ä¹ ï¼å± 6 éé¢\n * steven sanderson, experiments with koa and javascript generators: generator å¥é¨ä»ç»ï¼ä»¥ koa æ¡æ¶ä¸ºä¾\n * mahdi dibaiee, es7 array and generator comprehensionsï¼es7 ç generator æ¨å¯¼\n * nicolas bevacqua, es6 generators in depth\n * axel rauschmayer, es6 generators in depth: generator è§æ ¼çè¯¦å°½è®²è§£\n * derick bailey, using es6 generators to short-circuit hierarchical data iterationï¼ä½¿ç¨ for...of å¾ªç¯å®æé¢å®çæä½æ­¥éª¤\n\n\n# å¼æ­¥æä½å async å½æ°\n\n * luke hoban, async functions for ecmascript: async å½æ°çè®¾è®¡ææ³ï¼ä¸ promiseãgernerator å½æ°çå³ç³»\n * jafar husain, asynchronous generators for es7: async å½æ°çæ·±å¥è®¨è®º\n * nolan lawson, taming the asynchronous beast with es7: async å½æ°éä¿çå®ä¾è®²è§£\n * jafar husain, async generators: å¯¹ async ä¸ generator æ··åä½¿ç¨çä¸äºè®¨è®º\n * daniel brain, understand promises before you start using async/await: è®¨è®º async/await ä¸ promise çå³ç³»\n * jake archibald, async functions - making promises friendly\n * axel rauschmayer, es proposal: asynchronous iteration: å¼æ­¥éåå¨çè¯¦ç»ä»ç»\n * dima grossman, how to write async await without try-catch blocks in javascript: é¤äº try/catch ä»¥å¤ç async å½æ°åé¨ææéè¯¯çæ¹æ³\n * mostafa gaafa, 6 reasons why javascriptâs async/await blows promises away: async å½æ°ç6ä¸ªå¥½å¤\n * mathias bynens, asynchronous stack traces: why await beats promise#then(): async å½æ°å¯ä»¥ä¿çéè¯¯å æ \n\n\n# class\n\n * sebastian porto, es6 classes and javascript prototypes: es6 class çåæ³ä¸ es5 prototype çåæ³å¯¹æ¯\n * jack franklin, an introduction to es6 classes: es6 class çå¥é¨ä»ç»\n * axel rauschmayer, ecmascript 6: new oop features besides classes\n * axel rauschmayer, classes in ecmascript 6 (final semantics): class è¯­æ³çè¯¦ç»ä»ç»åè®¾è®¡ææ³åæ\n * eric faust, es6 in depth: subclassing: class è¯­æ³çæ·±å¥ä»ç»\n * nicolas bevacqua, binding methods to class instance objects: å¦ä½ç»å®ç±»çå®ä¾ä¸­ç this\n * jamie kyle, javascript's new #private class fieldsï¼ç§æå±æ§çä»ç»ã\n * mathias bynens, public and private class fieldsï¼å®ä¾å±æ§çæ°åæ³çä»ç»ã\n\n\n# decorator\n\n * maximiliano fierro, declarative vs imperative: decorators å mixin ä»ç»\n * justin fagnani, \"real\" mixins with javascript classes: ä½¿ç¨ç±»çç»§æ¿å®ç° mixin\n * addy osmani, exploring es2016 decorators: decorator çæ·±å¥ä»ç»\n * sebastian mckenzie, allow decorators for functions as well: ä¸ºä»ä¹ä¿®é¥°å¨ä¸è½ç¨äºå½æ°\n * maximiliano fierro, traits with es7 decorators: trait çç¨æ³ä»ç»\n * jonathan creamer: using es2016 decorators to publish on an event bus: ä½¿ç¨ä¿®é¥°å¨å®ç°èªå¨åå¸äºä»¶\n\n\n# module\n\n * jack franklin, javascript modules the es6 way: es6 æ¨¡åå¥é¨\n * axel rauschmayer, ecmascript 6 modules: the final syntax: es6 æ¨¡åçä»ç»ï¼ä»¥åä¸ commonjs è§æ ¼çè¯¦ç»æ¯è¾\n * dave herman, static module resolution: es6 æ¨¡åçéæåè®¾è®¡ææ³\n * jason orendorff, es6 in depth: modules: es6 æ¨¡åè®¾è®¡ææ³çä»ç»\n * ben newman, the importance of import and export: es6 æ¨¡åçè®¾è®¡ææ³\n * esdiscuss, why is \"export default var a = 1;\" invalid syntax?\n * bradley meck, es6 module interoperability: ä»ç» node å¦ä½å¤ç es6 è¯­æ³å è½½ commonjs æ¨¡å\n * axel rauschmayer, making transpiled es modules more spec-compliant: es6 æ¨¡åç¼è¯æ commonjs æ¨¡åçè¯¦ç»ä»ç»\n * axel rauschmayer, es proposal: import() â dynamically importing es modules: import() çç¨æ³\n * node eps, es module interoperability: node å¯¹ es6 æ¨¡åçå¤çè§æ ¼\n\n\n# äºè¿å¶æ°ç»\n\n * ilmari heikkinen, typed arrays: binary data in the browser\n * khronos, typed array specification\n * ian elliot, reading a bmp file in javascript\n * renato mangini, how to convert arraybuffer to and from string\n * axel rauschmayer, typed arrays in ecmascript 6\n * axel rauschmayer, es proposal: shared memory and atomics\n * lin clark, avoiding race conditions in sharedarraybuffers with atomics: atomics å¯¹è±¡ä½¿ç¨åºæ¯çè§£é\n * lars t hansen, shared memory - a brief tutorial\n * james milner, the return of sharedarraybuffers and atomics\n\n\n# simd\n\n * tc39, simd.js stage 2\n * mdn, simd\n * tc39, ecmascript simd\n * axel rauschmayer, javascript gains support for simd\n\n\n# å·¥å·\n\n * babel, babel handbook: babel çç¨æ³ä»ç»\n * google, traceur-compiler: traceur ç¼è¯å¨\n * casper beyer, ecmascript 6 features and tools\n * stoyan stefanov, writing es6 today with jstransform\n * es6 module loader, es6 module loader polyfill: å¨æµè§å¨å node.js å è½½ es6 æ¨¡åçä¸ä¸ªåºï¼ææ¡£éå¯¹ es6 æ¨¡åæè¯¦ç»è§£é\n * paul miller, es6-shim: ä¸ä¸ªéå¯¹èå¼æµè§å¨ï¼æ¨¡æ es6 é¨ååè½çå«çåºï¼shimï¼\n * army8735, javascript downcast: å½äº§ç es6 å° es5 çè½¬ç å¨\n * esnext, es6 module transpilerï¼åºäº node.js çå° es6 æ¨¡åè½¬ä¸º es5 ä»£ç çå½ä»¤è¡å·¥å·\n * sebastian mckenzie, babeljs: es6 è½¬è¯å¨\n * systemjs, systemjs: å¨æµè§å¨ä¸­å è½½ amdãcjsães6 æ¨¡åçä¸ä¸ªå«çåº\n * modernizr, html5 cross browser polyfills: es6 å«çåºæ¸å\n * facebook, regenerator: å° generator å½æ°è½¬ä¸º es5 çè½¬ç å¨",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"å¸¸ç¨Gitå½ä»¤æ¸å",frontmatter:{title:"å¸¸ç¨Gitå½ä»¤æ¸å",date:"2020-11-18T17:43:57.000Z",permalink:"/pages/8292d8/",categories:["ãGitãå­¦ä¹ ç¬è®°"],tags:["Git"]},regularPath:"/%E3%80%8AGit%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/10.%E6%89%8B%E5%86%8C/00.%E5%B8%B8%E7%94%A8Git%E5%91%BD%E4%BB%A4%E6%B8%85%E5%8D%95.html",relativePath:"ãGitãå­¦ä¹ ç¬è®°/10.æå/00.å¸¸ç¨Gitå½ä»¤æ¸å.md",key:"v-16bacf9d",path:"/pages/8292d8/",headers:[{level:2,title:"ä¸ãæ°å»ºä»£ç åº",slug:"ä¸ãæ°å»ºä»£ç åº",normalizedTitle:"ä¸ãæ°å»ºä»£ç åº",charIndex:187},{level:2,title:"äºãéç½®",slug:"äºãéç½®",normalizedTitle:"äºãéç½®",charIndex:334},{level:2,title:"ä¸ãå¢å /å é¤æä»¶",slug:"ä¸ãå¢å -å é¤æä»¶",normalizedTitle:"ä¸ãå¢å /å é¤æä»¶",charIndex:605},{level:2,title:"åãä»£ç æäº¤",slug:"åãä»£ç æäº¤",normalizedTitle:"åãä»£ç æäº¤",charIndex:1005},{level:2,title:"äºãåæ¯",slug:"äºãåæ¯",normalizedTitle:"äºãåæ¯",charIndex:1406},{level:2,title:"å­ãæ ç­¾",slug:"å­ãæ ç­¾",normalizedTitle:"å­ãæ ç­¾",charIndex:2199},{level:2,title:"ä¸ãæ¥çä¿¡æ¯",slug:"ä¸ãæ¥çä¿¡æ¯",normalizedTitle:"ä¸ãæ¥çä¿¡æ¯",charIndex:2616},{level:2,title:"å«ãè¿ç¨åæ­¥",slug:"å«ãè¿ç¨åæ­¥",normalizedTitle:"å«ãè¿ç¨åæ­¥",charIndex:3725},{level:2,title:"ä¹ãæ¤é",slug:"ä¹ãæ¤é",normalizedTitle:"ä¹ãæ¤é",charIndex:4147},{level:2,title:"åãå¸¸ç¨æä½ç»å",slug:"åãå¸¸ç¨æä½ç»å",normalizedTitle:"åãå¸¸ç¨æä½ç»å",charIndex:4799},{level:3,title:"1. ä¿®æ¹æ¬å°åæ¯ååè¿ç¨åæ¯å",slug:"_1-ä¿®æ¹æ¬å°åæ¯ååè¿ç¨åæ¯å",normalizedTitle:"1. ä¿®æ¹æ¬å°åæ¯ååè¿ç¨åæ¯å",charIndex:4812}],headersStr:"ä¸ãæ°å»ºä»£ç åº äºãéç½® ä¸ãå¢å /å é¤æä»¶ åãä»£ç æäº¤ äºãåæ¯ å­ãæ ç­¾ ä¸ãæ¥çä¿¡æ¯ å«ãè¿ç¨åæ­¥ ä¹ãæ¤é åãå¸¸ç¨æä½ç»å 1. ä¿®æ¹æ¬å°åæ¯ååè¿ç¨åæ¯å",content:'# å¸¸ç¨Gitå½ä»¤æ¸å\n\nä¸è¬æ¥è¯´ï¼æ¥å¸¸ä½¿ç¨åªè¦è®°ä½ä¸å¾6ä¸ªå½ä»¤ï¼å°±å¯ä»¥äºãä½æ¯çç»ä½¿ç¨ï¼ææè¦è®°ä½60ï½100ä¸ªå½ä»¤ã\n\n\n\nä¸é¢æ¯ææ´ççå¸¸ç¨ Git å½ä»¤æ¸åãå ä¸ªä¸ç¨åè¯çè¯åå¦ä¸ã\n\n>  * Workspaceï¼å·¥ä½åº\n>  * Index / Stageï¼æå­åº\n>  * Repositoryï¼ä»åºåºï¼ææ¬å°ä»åºï¼\n>  * Remoteï¼è¿ç¨ä»åº\n\n\n# ä¸ãæ°å»ºä»£ç åº\n\n# å¨å½åç®å½æ°å»ºä¸ä¸ªGitä»£ç åº\n$ git init\n\n# æ°å»ºä¸ä¸ªç®å½ï¼å°å¶åå§åä¸ºGitä»£ç åº\n$ git init [project-name]\n\n# ä¸è½½ä¸ä¸ªé¡¹ç®åå®çæ´ä¸ªä»£ç åå²\n$ git clone [url]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# äºãéç½®\n\nGitçè®¾ç½®æä»¶ä¸º.gitconfigï¼å®å¯ä»¥å¨ç¨æ·ä¸»ç®å½ä¸ï¼å¨å±éç½®ï¼ï¼ä¹å¯ä»¥å¨é¡¹ç®ç®å½ä¸ï¼é¡¹ç®éç½®ï¼ã\n\n# æ¾ç¤ºå½åçGitéç½®\n$ git config --list\n\n# ç¼è¾Gitéç½®æä»¶\n$ git config -e [--global]\n\n# è®¾ç½®æäº¤ä»£ç æ¶çç¨æ·ä¿¡æ¯\n$ git config [--global] user.name "[name]"\n$ git config [--global] user.email "[email address]"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# ä¸ãå¢å /å é¤æä»¶\n\n# æ·»å æå®æä»¶å°æå­åº\n$ git add [file1] [file2] ...\n\n# æ·»å æå®ç®å½å°æå­åºï¼åæ¬å­ç®å½\n$ git add [dir]\n\n# æ·»å å½åç®å½çæææä»¶å°æå­åº\n$ git add .\n\n# æ·»å æ¯ä¸ªåååï¼é½ä¼è¦æ±ç¡®è®¤\n# å¯¹äºåä¸ä¸ªæä»¶çå¤å¤ååï¼å¯ä»¥å®ç°åæ¬¡æäº¤\n$ git add -p\n\n# å é¤å·¥ä½åºæä»¶ï¼å¹¶ä¸å°è¿æ¬¡å é¤æ¾å¥æå­åº\n$ git rm [file1] [file2] ...\n\n# åæ­¢è¿½è¸ªæå®æä»¶ï¼ä½è¯¥æä»¶ä¼ä¿çå¨å·¥ä½åº\n$ git rm --cached [file]\n\n# æ¹åæä»¶ï¼å¹¶ä¸å°è¿ä¸ªæ¹åæ¾å¥æå­åº\n$ git mv [file-original] [file-renamed]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n\n# åãä»£ç æäº¤\n\n# æäº¤æå­åºå°ä»åºåº\n$ git commit -m [message]\n\n# æäº¤æå­åºçæå®æä»¶å°ä»åºåº\n$ git commit [file1] [file2] ... -m [message]\n\n# æäº¤å·¥ä½åºèªä¸æ¬¡commitä¹åçååï¼ç´æ¥å°ä»åºåº\n$ git commit -a\n\n# æäº¤æ¶æ¾ç¤ºæædiffä¿¡æ¯\n$ git commit -v\n\n# ä½¿ç¨ä¸æ¬¡æ°çcommitï¼æ¿ä»£ä¸ä¸æ¬¡æäº¤\n# å¦æä»£ç æ²¡æä»»ä½æ°ååï¼åç¨æ¥æ¹åä¸ä¸æ¬¡commitçæäº¤ä¿¡æ¯\n$ git commit --amend -m [message]\n\n# éåä¸ä¸æ¬¡commitï¼å¹¶åæ¬æå®æä»¶çæ°åå\n$ git commit --amend [file1] [file2] ...\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n# äºãåæ¯\n\n# ååºæææ¬å°åæ¯\n$ git branch\n\n# ååºææè¿ç¨åæ¯\n$ git branch -r\n\n# ååºæææ¬å°åæ¯åè¿ç¨åæ¯\n$ git branch -a\n\n# æ°å»ºä¸ä¸ªåæ¯ï¼ä½ä¾ç¶åçå¨å½ååæ¯\n$ git branch [branch-name]\n\n# æ°å»ºä¸ä¸ªåæ¯ï¼å¹¶åæ¢å°è¯¥åæ¯\n$ git checkout -b [branch]\n\n# æ°å»ºä¸ä¸ªåæ¯ï¼æåæå®commit\n$ git branch [branch] [commit]\n\n# æ°å»ºä¸ä¸ªåæ¯ï¼ä¸æå®çè¿ç¨åæ¯å»ºç«è¿½è¸ªå³ç³»\n$ git branch --track [branch] [remote-branch]\n\n# åæ¢å°æå®åæ¯ï¼å¹¶æ´æ°å·¥ä½åº\n$ git checkout [branch-name]\n\n# åæ¢å°ä¸ä¸ä¸ªåæ¯\n$ git checkout -\n\n# å»ºç«è¿½è¸ªå³ç³»ï¼å¨ç°æåæ¯ä¸æå®çè¿ç¨åæ¯ä¹é´\n$ git branch --set-upstream [branch] [remote-branch]\n\n# åå¹¶æå®åæ¯å°å½ååæ¯\n$ git merge [branch]\n\n# éæ©ä¸ä¸ªcommitï¼åå¹¶è¿å½ååæ¯\n$ git cherry-pick [commit]\n\n# å é¤åæ¯\n$ git branch -d [branch-name]\n\n# å é¤è¿ç¨åæ¯\n$ git push origin --delete [branch-name]\n$ git branch -dr [remote/branch]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n\n\n\n# å­ãæ ç­¾\n\n# ååºæætag\n$ git tag\n\n# æ°å»ºä¸ä¸ªtagå¨å½åcommit\n$ git tag [tag]\n\n# æ°å»ºä¸ä¸ªtagå¨æå®commit\n$ git tag [tag] [commit]\n\n# å é¤æ¬å°tag\n$ git tag -d [tag]\n\n# å é¤è¿ç¨tag\n$ git push origin :refs/tags/[tagName]\n\n# æ¥çtagä¿¡æ¯\n$ git show [tag]\n\n# æäº¤æå®tag\n$ git push [remote] [tag]\n\n# æäº¤æætag\n$ git push [remote] --tags\n\n# æ°å»ºä¸ä¸ªåæ¯ï¼æåæä¸ªtag\n$ git checkout -b [branch] [tag]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\n\n# ä¸ãæ¥çä¿¡æ¯\n\n# æ¾ç¤ºæåæ´çæä»¶\n$ git status\n\n# æ¾ç¤ºå½ååæ¯ççæ¬åå²\n$ git log\n\n# æ¾ç¤ºcommitåå²ï¼ä»¥åæ¯æ¬¡commitåçåæ´çæä»¶\n$ git log --stat\n\n# æç´¢æäº¤åå²ï¼æ ¹æ®å³é®è¯\n$ git log -S [keyword]\n\n# æ¾ç¤ºæä¸ªcommitä¹åçææåå¨ï¼æ¯ä¸ªcommitå æ®ä¸è¡\n$ git log [tag] HEAD --pretty=format:%s\n\n# æ¾ç¤ºæä¸ªcommitä¹åçææåå¨ï¼å¶"æäº¤è¯´æ"å¿é¡»ç¬¦åæç´¢æ¡ä»¶\n$ git log [tag] HEAD --grep feature\n\n# æ¾ç¤ºæä¸ªæä»¶ççæ¬åå²ï¼åæ¬æä»¶æ¹å\n$ git log --follow [file]\n$ git whatchanged [file]\n\n# æ¾ç¤ºæå®æä»¶ç¸å³çæ¯ä¸æ¬¡diff\n$ git log -p [file]\n\n# æ¾ç¤ºè¿å»5æ¬¡æäº¤\n$ git log -5 --pretty --oneline\n\n# æ¾ç¤ºæææäº¤è¿çç¨æ·ï¼ææäº¤æ¬¡æ°æåº\n$ git shortlog -sn\n\n# æ¾ç¤ºæå®æä»¶æ¯ä»ä¹äººå¨ä»ä¹æ¶é´ä¿®æ¹è¿\n$ git blame [file]\n\n# æ¾ç¤ºæå­åºåå·¥ä½åºçå·®å¼\n$ git diff\n\n# æ¾ç¤ºæå­åºåä¸ä¸ä¸ªcommitçå·®å¼\n$ git diff --cached [file]\n\n# æ¾ç¤ºå·¥ä½åºä¸å½ååæ¯ææ°commitä¹é´çå·®å¼\n$ git diff HEAD\n\n# æ¾ç¤ºä¸¤æ¬¡æäº¤ä¹é´çå·®å¼\n$ git diff [first-branch]...[second-branch]\n\n# æ¾ç¤ºä»å¤©ä½ åäºå¤å°è¡ä»£ç \n$ git diff --shortstat "@{0 day ago}"\n\n# æ¾ç¤ºææ¬¡æäº¤çåæ°æ®ååå®¹åå\n$ git show [commit]\n\n# æ¾ç¤ºææ¬¡æäº¤åçååçæä»¶\n$ git show --name-only [commit]\n\n# æ¾ç¤ºææ¬¡æäº¤æ¶ï¼æä¸ªæä»¶çåå®¹\n$ git show [commit]:[filename]\n\n# æ¾ç¤ºå½ååæ¯çæè¿å æ¬¡æäº¤\n$ git reflog\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n\n\n\n# å«ãè¿ç¨åæ­¥\n\n# ä¸è½½è¿ç¨ä»åºçææåå¨\n$ git fetch [remote]\n\n# æ¾ç¤ºææè¿ç¨ä»åº\n$ git remote -v\n\n# æ¾ç¤ºæä¸ªè¿ç¨ä»åºçä¿¡æ¯\n$ git remote show [remote]\n\n# å¢å ä¸ä¸ªæ°çè¿ç¨ä»åºï¼å¹¶å½å\n$ git remote add [shortname] [url]\n\n# ååè¿ç¨ä»åºçååï¼å¹¶ä¸æ¬å°åæ¯åå¹¶\n$ git pull [remote] [branch]\n\n# ä¸ä¼ æ¬å°æå®åæ¯å°è¿ç¨ä»åº\n$ git push [remote] [branch]\n\n# å¼ºè¡æ¨éå½ååæ¯å°è¿ç¨ä»åºï¼å³ä½¿æå²çª\n$ git push [remote] --force\n\n# æ¨éææåæ¯å°è¿ç¨ä»åº\n$ git push [remote] --all\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\n\n# ä¹ãæ¤é\n\n# æ¢å¤æå­åºçæå®æä»¶å°å·¥ä½åº\n$ git checkout [file]\n\n# æ¢å¤æä¸ªcommitçæå®æä»¶å°æå­åºåå·¥ä½åº\n$ git checkout [commit] [file]\n\n# æ¢å¤æå­åºçæææä»¶å°å·¥ä½åº\n$ git checkout .\n\n# éç½®æå­åºçæå®æä»¶ï¼ä¸ä¸ä¸æ¬¡commitä¿æä¸è´ï¼ä½å·¥ä½åºä¸å\n$ git reset [file]\n\n# éç½®æå­åºä¸å·¥ä½åºï¼ä¸ä¸ä¸æ¬¡commitä¿æä¸è´\n$ git reset --hard\n\n# éç½®å½ååæ¯çæéä¸ºæå®commitï¼åæ¶éç½®æå­åºï¼ä½å·¥ä½åºä¸å\n$ git reset [commit]\n\n# éç½®å½ååæ¯çHEADä¸ºæå®commitï¼åæ¶éç½®æå­åºåå·¥ä½åºï¼ä¸æå®commitä¸è´\n$ git reset --hard [commit]\n\n# éç½®å½åHEADä¸ºæå®commitï¼ä½ä¿ææå­åºåå·¥ä½åºä¸å\n$ git reset --keep [commit]\n\n# æ°å»ºä¸ä¸ªcommitï¼ç¨æ¥æ¤éæå®commit\n# åèçææååé½å°è¢«åèæµæ¶ï¼å¹¶ä¸åºç¨å°å½ååæ¯\n$ git revert [commit]\n\n# ææ¶å°æªæäº¤çååç§»é¤ï¼ç¨ååç§»å¥\n$ git stash\n$ git stash pop\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n\n\n\n# åãå¸¸ç¨æä½ç»å\n\n\n# 1. ä¿®æ¹æ¬å°åæ¯ååè¿ç¨åæ¯å\n\ngit branch -m old_branch new_branch # éå½åæ¬å°åæ¯\ngit push origin :old_branch # å é¤è¿ç¨æ§åæ¯ï¼åæ¯ååæåå·ï¼\ngit push --set-upstream origin new_branch # æ¨éæ°çåæ¯ï¼å¹¶è®¾ç½®æ¬å°åæ¯è·è¸ªæ°çè¿ç¨åæ¯\n\n\n1\n2\n3\n\n\nç¸å³æç« ï¼\n\nãå¦ä½æ¤é Git æä½ï¼ã\n\nãgit cherry-pick æç¨ã å¤å¶æåæ¯ä¸çé¨åæäº¤å°å¦ä¸ä¸ªåæ¯ä¸ï¼ç¸å¯¹äºå¯ä»¥éæ©æå®æäº¤ç rebase æä½ï¼ã\n\n> å½ä»¤æ¸åæ¥æºï¼https://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html',normalizedContent:'# å¸¸ç¨gitå½ä»¤æ¸å\n\nä¸è¬æ¥è¯´ï¼æ¥å¸¸ä½¿ç¨åªè¦è®°ä½ä¸å¾6ä¸ªå½ä»¤ï¼å°±å¯ä»¥äºãä½æ¯çç»ä½¿ç¨ï¼ææè¦è®°ä½60ï½100ä¸ªå½ä»¤ã\n\n\n\nä¸é¢æ¯ææ´ççå¸¸ç¨ git å½ä»¤æ¸åãå ä¸ªä¸ç¨åè¯çè¯åå¦ä¸ã\n\n>  * workspaceï¼å·¥ä½åº\n>  * index / stageï¼æå­åº\n>  * repositoryï¼ä»åºåºï¼ææ¬å°ä»åºï¼\n>  * remoteï¼è¿ç¨ä»åº\n\n\n# ä¸ãæ°å»ºä»£ç åº\n\n# å¨å½åç®å½æ°å»ºä¸ä¸ªgitä»£ç åº\n$ git init\n\n# æ°å»ºä¸ä¸ªç®å½ï¼å°å¶åå§åä¸ºgitä»£ç åº\n$ git init [project-name]\n\n# ä¸è½½ä¸ä¸ªé¡¹ç®åå®çæ´ä¸ªä»£ç åå²\n$ git clone [url]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# äºãéç½®\n\ngitçè®¾ç½®æä»¶ä¸º.gitconfigï¼å®å¯ä»¥å¨ç¨æ·ä¸»ç®å½ä¸ï¼å¨å±éç½®ï¼ï¼ä¹å¯ä»¥å¨é¡¹ç®ç®å½ä¸ï¼é¡¹ç®éç½®ï¼ã\n\n# æ¾ç¤ºå½åçgitéç½®\n$ git config --list\n\n# ç¼è¾gitéç½®æä»¶\n$ git config -e [--global]\n\n# è®¾ç½®æäº¤ä»£ç æ¶çç¨æ·ä¿¡æ¯\n$ git config [--global] user.name "[name]"\n$ git config [--global] user.email "[email address]"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# ä¸ãå¢å /å é¤æä»¶\n\n# æ·»å æå®æä»¶å°æå­åº\n$ git add [file1] [file2] ...\n\n# æ·»å æå®ç®å½å°æå­åºï¼åæ¬å­ç®å½\n$ git add [dir]\n\n# æ·»å å½åç®å½çæææä»¶å°æå­åº\n$ git add .\n\n# æ·»å æ¯ä¸ªåååï¼é½ä¼è¦æ±ç¡®è®¤\n# å¯¹äºåä¸ä¸ªæä»¶çå¤å¤ååï¼å¯ä»¥å®ç°åæ¬¡æäº¤\n$ git add -p\n\n# å é¤å·¥ä½åºæä»¶ï¼å¹¶ä¸å°è¿æ¬¡å é¤æ¾å¥æå­åº\n$ git rm [file1] [file2] ...\n\n# åæ­¢è¿½è¸ªæå®æä»¶ï¼ä½è¯¥æä»¶ä¼ä¿çå¨å·¥ä½åº\n$ git rm --cached [file]\n\n# æ¹åæä»¶ï¼å¹¶ä¸å°è¿ä¸ªæ¹åæ¾å¥æå­åº\n$ git mv [file-original] [file-renamed]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n\n# åãä»£ç æäº¤\n\n# æäº¤æå­åºå°ä»åºåº\n$ git commit -m [message]\n\n# æäº¤æå­åºçæå®æä»¶å°ä»åºåº\n$ git commit [file1] [file2] ... -m [message]\n\n# æäº¤å·¥ä½åºèªä¸æ¬¡commitä¹åçååï¼ç´æ¥å°ä»åºåº\n$ git commit -a\n\n# æäº¤æ¶æ¾ç¤ºæædiffä¿¡æ¯\n$ git commit -v\n\n# ä½¿ç¨ä¸æ¬¡æ°çcommitï¼æ¿ä»£ä¸ä¸æ¬¡æäº¤\n# å¦æä»£ç æ²¡æä»»ä½æ°ååï¼åç¨æ¥æ¹åä¸ä¸æ¬¡commitçæäº¤ä¿¡æ¯\n$ git commit --amend -m [message]\n\n# éåä¸ä¸æ¬¡commitï¼å¹¶åæ¬æå®æä»¶çæ°åå\n$ git commit --amend [file1] [file2] ...\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n# äºãåæ¯\n\n# ååºæææ¬å°åæ¯\n$ git branch\n\n# ååºææè¿ç¨åæ¯\n$ git branch -r\n\n# ååºæææ¬å°åæ¯åè¿ç¨åæ¯\n$ git branch -a\n\n# æ°å»ºä¸ä¸ªåæ¯ï¼ä½ä¾ç¶åçå¨å½ååæ¯\n$ git branch [branch-name]\n\n# æ°å»ºä¸ä¸ªåæ¯ï¼å¹¶åæ¢å°è¯¥åæ¯\n$ git checkout -b [branch]\n\n# æ°å»ºä¸ä¸ªåæ¯ï¼æåæå®commit\n$ git branch [branch] [commit]\n\n# æ°å»ºä¸ä¸ªåæ¯ï¼ä¸æå®çè¿ç¨åæ¯å»ºç«è¿½è¸ªå³ç³»\n$ git branch --track [branch] [remote-branch]\n\n# åæ¢å°æå®åæ¯ï¼å¹¶æ´æ°å·¥ä½åº\n$ git checkout [branch-name]\n\n# åæ¢å°ä¸ä¸ä¸ªåæ¯\n$ git checkout -\n\n# å»ºç«è¿½è¸ªå³ç³»ï¼å¨ç°æåæ¯ä¸æå®çè¿ç¨åæ¯ä¹é´\n$ git branch --set-upstream [branch] [remote-branch]\n\n# åå¹¶æå®åæ¯å°å½ååæ¯\n$ git merge [branch]\n\n# éæ©ä¸ä¸ªcommitï¼åå¹¶è¿å½ååæ¯\n$ git cherry-pick [commit]\n\n# å é¤åæ¯\n$ git branch -d [branch-name]\n\n# å é¤è¿ç¨åæ¯\n$ git push origin --delete [branch-name]\n$ git branch -dr [remote/branch]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n\n\n\n# å­ãæ ç­¾\n\n# ååºæætag\n$ git tag\n\n# æ°å»ºä¸ä¸ªtagå¨å½åcommit\n$ git tag [tag]\n\n# æ°å»ºä¸ä¸ªtagå¨æå®commit\n$ git tag [tag] [commit]\n\n# å é¤æ¬å°tag\n$ git tag -d [tag]\n\n# å é¤è¿ç¨tag\n$ git push origin :refs/tags/[tagname]\n\n# æ¥çtagä¿¡æ¯\n$ git show [tag]\n\n# æäº¤æå®tag\n$ git push [remote] [tag]\n\n# æäº¤æætag\n$ git push [remote] --tags\n\n# æ°å»ºä¸ä¸ªåæ¯ï¼æåæä¸ªtag\n$ git checkout -b [branch] [tag]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\n\n# ä¸ãæ¥çä¿¡æ¯\n\n# æ¾ç¤ºæåæ´çæä»¶\n$ git status\n\n# æ¾ç¤ºå½ååæ¯ççæ¬åå²\n$ git log\n\n# æ¾ç¤ºcommitåå²ï¼ä»¥åæ¯æ¬¡commitåçåæ´çæä»¶\n$ git log --stat\n\n# æç´¢æäº¤åå²ï¼æ ¹æ®å³é®è¯\n$ git log -s [keyword]\n\n# æ¾ç¤ºæä¸ªcommitä¹åçææåå¨ï¼æ¯ä¸ªcommitå æ®ä¸è¡\n$ git log [tag] head --pretty=format:%s\n\n# æ¾ç¤ºæä¸ªcommitä¹åçææåå¨ï¼å¶"æäº¤è¯´æ"å¿é¡»ç¬¦åæç´¢æ¡ä»¶\n$ git log [tag] head --grep feature\n\n# æ¾ç¤ºæä¸ªæä»¶ççæ¬åå²ï¼åæ¬æä»¶æ¹å\n$ git log --follow [file]\n$ git whatchanged [file]\n\n# æ¾ç¤ºæå®æä»¶ç¸å³çæ¯ä¸æ¬¡diff\n$ git log -p [file]\n\n# æ¾ç¤ºè¿å»5æ¬¡æäº¤\n$ git log -5 --pretty --oneline\n\n# æ¾ç¤ºæææäº¤è¿çç¨æ·ï¼ææäº¤æ¬¡æ°æåº\n$ git shortlog -sn\n\n# æ¾ç¤ºæå®æä»¶æ¯ä»ä¹äººå¨ä»ä¹æ¶é´ä¿®æ¹è¿\n$ git blame [file]\n\n# æ¾ç¤ºæå­åºåå·¥ä½åºçå·®å¼\n$ git diff\n\n# æ¾ç¤ºæå­åºåä¸ä¸ä¸ªcommitçå·®å¼\n$ git diff --cached [file]\n\n# æ¾ç¤ºå·¥ä½åºä¸å½ååæ¯ææ°commitä¹é´çå·®å¼\n$ git diff head\n\n# æ¾ç¤ºä¸¤æ¬¡æäº¤ä¹é´çå·®å¼\n$ git diff [first-branch]...[second-branch]\n\n# æ¾ç¤ºä»å¤©ä½ åäºå¤å°è¡ä»£ç \n$ git diff --shortstat "@{0 day ago}"\n\n# æ¾ç¤ºææ¬¡æäº¤çåæ°æ®ååå®¹åå\n$ git show [commit]\n\n# æ¾ç¤ºææ¬¡æäº¤åçååçæä»¶\n$ git show --name-only [commit]\n\n# æ¾ç¤ºææ¬¡æäº¤æ¶ï¼æä¸ªæä»¶çåå®¹\n$ git show [commit]:[filename]\n\n# æ¾ç¤ºå½ååæ¯çæè¿å æ¬¡æäº¤\n$ git reflog\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n\n\n\n# å«ãè¿ç¨åæ­¥\n\n# ä¸è½½è¿ç¨ä»åºçææåå¨\n$ git fetch [remote]\n\n# æ¾ç¤ºææè¿ç¨ä»åº\n$ git remote -v\n\n# æ¾ç¤ºæä¸ªè¿ç¨ä»åºçä¿¡æ¯\n$ git remote show [remote]\n\n# å¢å ä¸ä¸ªæ°çè¿ç¨ä»åºï¼å¹¶å½å\n$ git remote add [shortname] [url]\n\n# ååè¿ç¨ä»åºçååï¼å¹¶ä¸æ¬å°åæ¯åå¹¶\n$ git pull [remote] [branch]\n\n# ä¸ä¼ æ¬å°æå®åæ¯å°è¿ç¨ä»åº\n$ git push [remote] [branch]\n\n# å¼ºè¡æ¨éå½ååæ¯å°è¿ç¨ä»åºï¼å³ä½¿æå²çª\n$ git push [remote] --force\n\n# æ¨éææåæ¯å°è¿ç¨ä»åº\n$ git push [remote] --all\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\n\n# ä¹ãæ¤é\n\n# æ¢å¤æå­åºçæå®æä»¶å°å·¥ä½åº\n$ git checkout [file]\n\n# æ¢å¤æä¸ªcommitçæå®æä»¶å°æå­åºåå·¥ä½åº\n$ git checkout [commit] [file]\n\n# æ¢å¤æå­åºçæææä»¶å°å·¥ä½åº\n$ git checkout .\n\n# éç½®æå­åºçæå®æä»¶ï¼ä¸ä¸ä¸æ¬¡commitä¿æä¸è´ï¼ä½å·¥ä½åºä¸å\n$ git reset [file]\n\n# éç½®æå­åºä¸å·¥ä½åºï¼ä¸ä¸ä¸æ¬¡commitä¿æä¸è´\n$ git reset --hard\n\n# éç½®å½ååæ¯çæéä¸ºæå®commitï¼åæ¶éç½®æå­åºï¼ä½å·¥ä½åºä¸å\n$ git reset [commit]\n\n# éç½®å½ååæ¯çheadä¸ºæå®commitï¼åæ¶éç½®æå­åºåå·¥ä½åºï¼ä¸æå®commitä¸è´\n$ git reset --hard [commit]\n\n# éç½®å½åheadä¸ºæå®commitï¼ä½ä¿ææå­åºåå·¥ä½åºä¸å\n$ git reset --keep [commit]\n\n# æ°å»ºä¸ä¸ªcommitï¼ç¨æ¥æ¤éæå®commit\n# åèçææååé½å°è¢«åèæµæ¶ï¼å¹¶ä¸åºç¨å°å½ååæ¯\n$ git revert [commit]\n\n# ææ¶å°æªæäº¤çååç§»é¤ï¼ç¨ååç§»å¥\n$ git stash\n$ git stash pop\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n\n\n\n# åãå¸¸ç¨æä½ç»å\n\n\n# 1. ä¿®æ¹æ¬å°åæ¯ååè¿ç¨åæ¯å\n\ngit branch -m old_branch new_branch # éå½åæ¬å°åæ¯\ngit push origin :old_branch # å é¤è¿ç¨æ§åæ¯ï¼åæ¯ååæåå·ï¼\ngit push --set-upstream origin new_branch # æ¨éæ°çåæ¯ï¼å¹¶è®¾ç½®æ¬å°åæ¯è·è¸ªæ°çè¿ç¨åæ¯\n\n\n1\n2\n3\n\n\nç¸å³æç« ï¼\n\nãå¦ä½æ¤é git æä½ï¼ã\n\nãgit cherry-pick æç¨ã å¤å¶æåæ¯ä¸çé¨åæäº¤å°å¦ä¸ä¸ªåæ¯ä¸ï¼ç¸å¯¹äºå¯ä»¥éæ©æå®æäº¤ç rebase æä½ï¼ã\n\n> å½ä»¤æ¸åæ¥æºï¼https://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Gitå½ä»¤æç»´å¯¼å¾",frontmatter:{title:"Gitå½ä»¤æç»´å¯¼å¾",date:"2020-11-18T17:46:22.000Z",permalink:"/pages/4cbc21/",categories:["ãGitãå­¦ä¹ ç¬è®°"],tags:["Git"]},regularPath:"/%E3%80%8AGit%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/10.%E6%89%8B%E5%86%8C/06.Git%E5%91%BD%E4%BB%A4%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE.html",relativePath:"ãGitãå­¦ä¹ ç¬è®°/10.æå/06.Gitå½ä»¤æç»´å¯¼å¾.md",key:"v-720d8224",path:"/pages/4cbc21/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Gitååºåå¹¶",frontmatter:{title:"Gitååºåå¹¶",date:"2020-11-18T17:43:57.000Z",permalink:"/pages/c10281/",categories:["ãGitãå­¦ä¹ ç¬è®°"],tags:["Git"]},regularPath:"/%E3%80%8AGit%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/10.%E6%89%8B%E5%86%8C/03.Git%E5%8F%98%E5%9F%BA%E5%90%88%E5%B9%B6.html",relativePath:"ãGitãå­¦ä¹ ç¬è®°/10.æå/03.Gitååºåå¹¶.md",key:"v-52f1734b",path:"/pages/c10281/",headers:[{level:2,title:"è¯´æ",slug:"è¯´æ",normalizedTitle:"è¯´æ",charIndex:17},{level:3,title:"ååºè¦éµå®çåå",slug:"ååºè¦éµå®çåå",normalizedTitle:"ååºè¦éµå®çåå",charIndex:750},{level:3,title:"ååºçå®è´¨",slug:"ååºçå®è´¨",normalizedTitle:"ååºçå®è´¨",charIndex:815},{level:2,title:"åæè¯",slug:"åæè¯",normalizedTitle:"åæè¯",charIndex:531},{level:2,title:"å¼åæé´çrebaseæä½",slug:"å¼åæé´çrebaseæä½",normalizedTitle:"å¼åæé´çrebaseæä½",charIndex:1887},{level:3,title:"èæ¯",slug:"èæ¯",normalizedTitle:"èæ¯",charIndex:1905},{level:3,title:"æä½æ­¥éª¤",slug:"æä½æ­¥éª¤",normalizedTitle:"æä½æ­¥éª¤",charIndex:2159},{level:3,title:"git cherry-pick",slug:"git-cherry-pick",normalizedTitle:"git cherry-pick",charIndex:2524}],headersStr:"è¯´æ ååºè¦éµå®çåå ååºçå®è´¨ åæè¯ å¼åæé´çrebaseæä½ èæ¯ æä½æ­¥éª¤ git cherry-pick",content:"# rebaseåæ¯åå¹¶\n\n\n# è¯´æ\n\nä»¥ä¸ v2 æ¯æä¸ªéæ±çå¼ååæ¯ï¼ devæ¯æ»çå¼ååæ¯ï¼v2 æ¯åºäºdevåæ¯ç­¾åºçã\n\nå½å®æv2çå¼ååï¼éè¦æä»£ç åå¹¶å°devï¼æä»¬å¯ä»¥ä½¿ç¨rebaseè¿è¡åå¹¶ï¼\n\n# é¦åå° v2 pushå°è¿ç¨ä»åº\ngit add .\ngit commit -m 'xxx'\ngit push origin v2\n\n# åæ¢å° dev æåææ°ä»£ç \ngit checkout dev\ngit pull origin dev\n\n# åæ¢å° v2\ngit checkout v2\ngit rebase dev # å° v2 çææ[commit] ååºå°(åºç¨å°) dev\n\n# åæ¢å° dev\ngit checkout dev\ngit merge v2  # å° devåæ¯ å¿«è¿åå¹¶ ï¼æ­¤æ¶ (HEAD -> dev, v2) [commit] ä¸¤ä¸ªåæ¯æååä¸ä¸ªæäº¤ï¼\n\n# æ¥ç åv2ç[commit]è®°å½ æ¯å¦å¨devåæ¯çæåé¢ï¼ååºæåä¼æv2çæäº¤è®°å½åºç¨å°devåæ¯çæåé¢ï¼\ngit log\n\n\t# å¦æå°è¿ä¸æ­¥åç°æé®é¢ï¼å°è¯ä½¿ç¨ git --abortä¸­æ­¢ååºï¼å¦æè¿æ¯æé®é¢çå¯ä»¥å¨devåæ¯ä¸ä½¿ç¨ãåæè¯ãæä½ï¼ åå°v2åæ¯ä¸ä½¿ç¨ãåæè¯ãæä½ï¼å³å¯ä½¿ä¸¤ä¸ªåæ¯é½åéå° rebaseååº ä¹åçç¶æ\n\n# è¯è¿è¡é¡¹ç®æ¯å¦æé®é¢\nyarn start\n\ngit status # æ¥çç¶ææ¯å¦æé®é¢\ngit push origin dev # æ¨éå°è¿ç¨ä»åºç dev\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n\n\n# ååºè¦éµå®çåå\n\nå ä¸ªäººåæ¶å¨ä¸ä¸ªåæ¯ä¸è¿è¡å¼ååæäº¤æ¶ï¼ä½ ä¸è¦ä¸­éæ§è¡ååºï¼åªæå¨å¤§å®¶é½å®æå·¥ä½ä¹åæå¯ä»¥æ§è¡ååºã\n\n\n# ååºçå®è´¨\n\nååºæä½çå®è´¨æ¯ä¸¢å¼ä¸äºç°æçæäº¤ï¼ç¶åç¸åºå°æ°å»ºä¸äºåå®¹ä¸æ ·ä½å®éä¸ä¸åçæäº¤ã å æ­¤ï¼ååºæä½è¿åçåæ¯å°ä¸è¦åä½¿ç¨ã\n\n\n# åæè¯\n\n# æ¥çHEADæéåå¨è®°å½\ngit reflog\n# è®°å½ç¤ºä¾(å½ååæ¯æ¯v2):\n07c398f (HEAD -> v2, master) HEAD@{0}: checkout: moving from master to v2\n07c398f (HEAD -> v2, master) HEAD@{1}: rebase (finish): returning to refs/heads/master\n07c398f (HEAD -> v2, master) HEAD@{2}: rebase (start): checkout v2\n15a97d8 HEAD@{3}: reset: moving to 15a97d8\n07c398f (HEAD -> v2, master) HEAD@{4}: merge v2: Fast-forward\n15a97d8 HEAD@{5}: checkout: moving from v2 to master\n07c398f (HEAD -> v2, master) HEAD@{6}: rebase (finish): returning to refs/heads/v2\n07c398f (HEAD -> v2, master) HEAD@{7}: rebase (pick): C\n15a97d8 HEAD@{8}: rebase (start): checkout master # é¦æ¬¡rebase\nd278ecd HEAD@{9}: checkout: moving from master to v2 # rebaseåçç¶æ\n15a97d8 HEAD@{10}: commit: D\n\n# å¯è§ï¼ç¤ºä¾ä¸­æåç rebase æä½æ¯ HEAD@{8}ï¼æ³åéå°ååºåçç¶æéè®©æéæå HEAD@{9}\ngit reset --hard d278ecd  # éç½®å½ååæ¯çHEADä¸ºæå®[commit]ï¼åæ¶éç½®æå­åºåå·¥ä½åºï¼ä¸æå®[commit]ä¸è´\n\n# æ­¤æ¶æå° log æ¥çæ¯å¦åå°ä¹åçç¶æ\ngit log\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\næ³¨æï¼æ­¤æä½åªè½åéå½åçåæ¯ï¼å¦å¶ä»åæ¯ä¹è¦åéï¼éè¦åæ¢å°è¯¥åæ¯å¹¶æ§è¡ä¸é¢æä½ã\n\n\n# å¼åæé´çrebaseæä½\n\n\n# èæ¯\n\næä¸¤ä¸ªåæ¯ï¼\n\ndev\n*v2\n\n\n1\n2\n\n\n2.4-dev æ¯åºäºdevååºæ¥çã\n\næäº¤è®°å½å¦ä¸ï¼\n\n\t\tdev\na - b - c\n\t\tv2\n\n\n1\n2\n3\n\n\nå¼åæé´ï¼ä¸¤ä¸ªåæ¯åæ¶ææ°çcommit ï¼\n\n\t\t\t\tdev\na - b - c - d - e\n\t\t\\ - f - g\n\t\t\t\tv2\n\n\n1\n2\n3\n4\n\n\nå½åä½ æ­£å¨v2è¿è¡å¼åï¼devä¹åæ¶è¿è¡å¼åï¼å¹¶æéå¤§çæ¹åï¼ä½ éè¦ædevçæäº¤åæ­¥å°v2ã\n\néæ±ï¼ ædevä¸­æ°çæäº¤åæ­¥å°v2ï¼ä¸ä¸è½å½±ådevåæ¯ã\n\n\n# æä½æ­¥éª¤\n\n 1. åºäºææ°ç dev åä¸ä¸ªæ°çåæ¯ dev-copy\n    \n    > dev-copy å dev ä¸¤èç commit ID ä¸è´ã\n\n 2. å¨dev-copyä¸­æ§è¡rebaseï¼å° dev-copy çæäº¤ååºå° v2\n    \n    git rebase v2 # å° dev-copy çæäº¤[commit] ååºå°(åºç¨å°) v2\n    \n    \n    1\n    \n\n 3. å é¤åv2åæ¯ï¼å°dev-copyåæ¯åæ¹ä¸ºv2\n    \n    # å½åå¨ dev-copy åæ¯\n    git branch -d v2 # å é¤åæ¯\n    git branch -m dev-copy v2 # éå½å\n    \n    \n    1\n    2\n    3\n    \n\n\n# git cherry-pick\n\næ¥æºï¼ãgit cherry-pick æç¨ã\n\nç¨äºå°åä¸ªæå ä¸ª[commit]å¤å¶å°å¦ä¸ä¸ªåæ¯ã\n\n# åºæ¬åºç¨\n\ngit cherry-pick <commitHash> # å°commitHashåºç¨äºå½ååæ¯\n\n\n1\n\n\nä¸é¢å½ä»¤å°±ä¼å°æå®çæäº¤commitHashï¼åºç¨äºå½ååæ¯ãè¿ä¼å¨å½ååæ¯äº§çä¸ä¸ªæ°çæäº¤ï¼å½ç¶å®ä»¬çåå¸å¼ä¼ä¸ä¸æ ·ã\n\ngit cherry-pickå½ä»¤çåæ°ï¼ä¸ä¸å®æ¯æäº¤çåå¸å¼ï¼åæ¯åä¹æ¯å¯ä»¥çï¼è¡¨ç¤ºè½¬ç§»è¯¥åæ¯çææ°æäº¤ã\n\n# è½¬ç§»å¤ä¸ªæäº¤\n\nCherry pick æ¯æä¸æ¬¡è½¬ç§»å¤ä¸ªæäº¤ã\n\ngit cherry-pick <HashA> <HashB> # AåBæäº¤\n\n\n1\n\n\nä¸é¢çå½ä»¤å° A å B ä¸¤ä¸ªæäº¤åºç¨å°å½ååæ¯ãè¿ä¼å¨å½ååæ¯çæä¸¤ä¸ªå¯¹åºçæ°æäº¤ã\n\nå¦ææ³è¦è½¬ç§»ä¸ç³»åçè¿ç»­æäº¤ï¼å¯ä»¥ä½¿ç¨ä¸é¢çç®ä¾¿è¯­æ³ã\n\ngit cherry-pick A..B # Aå°Bæäº¤ï¼ä¸åå«A\n\n\n1\n\n\nä¸é¢çå½ä»¤å¯ä»¥è½¬ç§»ä» A å° B çæææäº¤ãå®ä»¬å¿é¡»æç§æ­£ç¡®çé¡ºåºæ¾ç½®ï¼æäº¤ A å¿é¡»æ©äºæäº¤ Bï¼å¦åå½ä»¤å°å¤±è´¥ï¼ä½ä¸ä¼æ¥éã\n\næ³¨æï¼ä½¿ç¨ä¸é¢çå½ä»¤ï¼æäº¤ A å°ä¸ä¼åå«å¨ Cherry pick ä¸­ãå¦æè¦åå«æäº¤ Aï¼å¯ä»¥ä½¿ç¨ä¸é¢çè¯­æ³ã\n\ngit cherry-pick A^..B # Aå°Bæäº¤ï¼åå«A\n\n\n1\n",normalizedContent:"# rebaseåæ¯åå¹¶\n\n\n# è¯´æ\n\nä»¥ä¸ v2 æ¯æä¸ªéæ±çå¼ååæ¯ï¼ devæ¯æ»çå¼ååæ¯ï¼v2 æ¯åºäºdevåæ¯ç­¾åºçã\n\nå½å®æv2çå¼ååï¼éè¦æä»£ç åå¹¶å°devï¼æä»¬å¯ä»¥ä½¿ç¨rebaseè¿è¡åå¹¶ï¼\n\n# é¦åå° v2 pushå°è¿ç¨ä»åº\ngit add .\ngit commit -m 'xxx'\ngit push origin v2\n\n# åæ¢å° dev æåææ°ä»£ç \ngit checkout dev\ngit pull origin dev\n\n# åæ¢å° v2\ngit checkout v2\ngit rebase dev # å° v2 çææ[commit] ååºå°(åºç¨å°) dev\n\n# åæ¢å° dev\ngit checkout dev\ngit merge v2  # å° devåæ¯ å¿«è¿åå¹¶ ï¼æ­¤æ¶ (head -> dev, v2) [commit] ä¸¤ä¸ªåæ¯æååä¸ä¸ªæäº¤ï¼\n\n# æ¥ç åv2ç[commit]è®°å½ æ¯å¦å¨devåæ¯çæåé¢ï¼ååºæåä¼æv2çæäº¤è®°å½åºç¨å°devåæ¯çæåé¢ï¼\ngit log\n\n\t# å¦æå°è¿ä¸æ­¥åç°æé®é¢ï¼å°è¯ä½¿ç¨ git --abortä¸­æ­¢ååºï¼å¦æè¿æ¯æé®é¢çå¯ä»¥å¨devåæ¯ä¸ä½¿ç¨ãåæè¯ãæä½ï¼ åå°v2åæ¯ä¸ä½¿ç¨ãåæè¯ãæä½ï¼å³å¯ä½¿ä¸¤ä¸ªåæ¯é½åéå° rebaseååº ä¹åçç¶æ\n\n# è¯è¿è¡é¡¹ç®æ¯å¦æé®é¢\nyarn start\n\ngit status # æ¥çç¶ææ¯å¦æé®é¢\ngit push origin dev # æ¨éå°è¿ç¨ä»åºç dev\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n\n\n# ååºè¦éµå®çåå\n\nå ä¸ªäººåæ¶å¨ä¸ä¸ªåæ¯ä¸è¿è¡å¼ååæäº¤æ¶ï¼ä½ ä¸è¦ä¸­éæ§è¡ååºï¼åªæå¨å¤§å®¶é½å®æå·¥ä½ä¹åæå¯ä»¥æ§è¡ååºã\n\n\n# ååºçå®è´¨\n\nååºæä½çå®è´¨æ¯ä¸¢å¼ä¸äºç°æçæäº¤ï¼ç¶åç¸åºå°æ°å»ºä¸äºåå®¹ä¸æ ·ä½å®éä¸ä¸åçæäº¤ã å æ­¤ï¼ååºæä½è¿åçåæ¯å°ä¸è¦åä½¿ç¨ã\n\n\n# åæè¯\n\n# æ¥çheadæéåå¨è®°å½\ngit reflog\n# è®°å½ç¤ºä¾(å½ååæ¯æ¯v2):\n07c398f (head -> v2, master) head@{0}: checkout: moving from master to v2\n07c398f (head -> v2, master) head@{1}: rebase (finish): returning to refs/heads/master\n07c398f (head -> v2, master) head@{2}: rebase (start): checkout v2\n15a97d8 head@{3}: reset: moving to 15a97d8\n07c398f (head -> v2, master) head@{4}: merge v2: fast-forward\n15a97d8 head@{5}: checkout: moving from v2 to master\n07c398f (head -> v2, master) head@{6}: rebase (finish): returning to refs/heads/v2\n07c398f (head -> v2, master) head@{7}: rebase (pick): c\n15a97d8 head@{8}: rebase (start): checkout master # é¦æ¬¡rebase\nd278ecd head@{9}: checkout: moving from master to v2 # rebaseåçç¶æ\n15a97d8 head@{10}: commit: d\n\n# å¯è§ï¼ç¤ºä¾ä¸­æåç rebase æä½æ¯ head@{8}ï¼æ³åéå°ååºåçç¶æéè®©æéæå head@{9}\ngit reset --hard d278ecd  # éç½®å½ååæ¯çheadä¸ºæå®[commit]ï¼åæ¶éç½®æå­åºåå·¥ä½åºï¼ä¸æå®[commit]ä¸è´\n\n# æ­¤æ¶æå° log æ¥çæ¯å¦åå°ä¹åçç¶æ\ngit log\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\næ³¨æï¼æ­¤æä½åªè½åéå½åçåæ¯ï¼å¦å¶ä»åæ¯ä¹è¦åéï¼éè¦åæ¢å°è¯¥åæ¯å¹¶æ§è¡ä¸é¢æä½ã\n\n\n# å¼åæé´çrebaseæä½\n\n\n# èæ¯\n\næä¸¤ä¸ªåæ¯ï¼\n\ndev\n*v2\n\n\n1\n2\n\n\n2.4-dev æ¯åºäºdevååºæ¥çã\n\næäº¤è®°å½å¦ä¸ï¼\n\n\t\tdev\na - b - c\n\t\tv2\n\n\n1\n2\n3\n\n\nå¼åæé´ï¼ä¸¤ä¸ªåæ¯åæ¶ææ°çcommit ï¼\n\n\t\t\t\tdev\na - b - c - d - e\n\t\t\\ - f - g\n\t\t\t\tv2\n\n\n1\n2\n3\n4\n\n\nå½åä½ æ­£å¨v2è¿è¡å¼åï¼devä¹åæ¶è¿è¡å¼åï¼å¹¶æéå¤§çæ¹åï¼ä½ éè¦ædevçæäº¤åæ­¥å°v2ã\n\néæ±ï¼ ædevä¸­æ°çæäº¤åæ­¥å°v2ï¼ä¸ä¸è½å½±ådevåæ¯ã\n\n\n# æä½æ­¥éª¤\n\n 1. åºäºææ°ç dev åä¸ä¸ªæ°çåæ¯ dev-copy\n    \n    > dev-copy å dev ä¸¤èç commit id ä¸è´ã\n\n 2. å¨dev-copyä¸­æ§è¡rebaseï¼å° dev-copy çæäº¤ååºå° v2\n    \n    git rebase v2 # å° dev-copy çæäº¤[commit] ååºå°(åºç¨å°) v2\n    \n    \n    1\n    \n\n 3. å é¤åv2åæ¯ï¼å°dev-copyåæ¯åæ¹ä¸ºv2\n    \n    # å½åå¨ dev-copy åæ¯\n    git branch -d v2 # å é¤åæ¯\n    git branch -m dev-copy v2 # éå½å\n    \n    \n    1\n    2\n    3\n    \n\n\n# git cherry-pick\n\næ¥æºï¼ãgit cherry-pick æç¨ã\n\nç¨äºå°åä¸ªæå ä¸ª[commit]å¤å¶å°å¦ä¸ä¸ªåæ¯ã\n\n# åºæ¬åºç¨\n\ngit cherry-pick <commithash> # å°commithashåºç¨äºå½ååæ¯\n\n\n1\n\n\nä¸é¢å½ä»¤å°±ä¼å°æå®çæäº¤commithashï¼åºç¨äºå½ååæ¯ãè¿ä¼å¨å½ååæ¯äº§çä¸ä¸ªæ°çæäº¤ï¼å½ç¶å®ä»¬çåå¸å¼ä¼ä¸ä¸æ ·ã\n\ngit cherry-pickå½ä»¤çåæ°ï¼ä¸ä¸å®æ¯æäº¤çåå¸å¼ï¼åæ¯åä¹æ¯å¯ä»¥çï¼è¡¨ç¤ºè½¬ç§»è¯¥åæ¯çææ°æäº¤ã\n\n# è½¬ç§»å¤ä¸ªæäº¤\n\ncherry pick æ¯æä¸æ¬¡è½¬ç§»å¤ä¸ªæäº¤ã\n\ngit cherry-pick <hasha> <hashb> # aåbæäº¤\n\n\n1\n\n\nä¸é¢çå½ä»¤å° a å b ä¸¤ä¸ªæäº¤åºç¨å°å½ååæ¯ãè¿ä¼å¨å½ååæ¯çæä¸¤ä¸ªå¯¹åºçæ°æäº¤ã\n\nå¦ææ³è¦è½¬ç§»ä¸ç³»åçè¿ç»­æäº¤ï¼å¯ä»¥ä½¿ç¨ä¸é¢çç®ä¾¿è¯­æ³ã\n\ngit cherry-pick a..b # aå°bæäº¤ï¼ä¸åå«a\n\n\n1\n\n\nä¸é¢çå½ä»¤å¯ä»¥è½¬ç§»ä» a å° b çæææäº¤ãå®ä»¬å¿é¡»æç§æ­£ç¡®çé¡ºåºæ¾ç½®ï¼æäº¤ a å¿é¡»æ©äºæäº¤ bï¼å¦åå½ä»¤å°å¤±è´¥ï¼ä½ä¸ä¼æ¥éã\n\næ³¨æï¼ä½¿ç¨ä¸é¢çå½ä»¤ï¼æäº¤ a å°ä¸ä¼åå«å¨ cherry pick ä¸­ãå¦æè¦åå«æäº¤ aï¼å¯ä»¥ä½¿ç¨ä¸é¢çè¯­æ³ã\n\ngit cherry-pick a^..b # aå°bæäº¤ï¼åå«a\n\n\n1\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"æ¹åç§å¤§è®¡ç®æºç½ç»",frontmatter:{title:"æ¹åç§å¤§è®¡ç®æºç½ç»",date:"2022-02-02T22:35:30.000Z",permalink:"/pages/4bdb82/",categories:["ãGitãå­¦ä¹ ç¬è®°","æå"],tags:[null]},regularPath:"/%E3%80%8AGit%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/10.%E6%89%8B%E5%86%8C/07.%E6%B9%96%E5%8D%97%E7%A7%91%E5%A4%A7%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.html",relativePath:"ãGitãå­¦ä¹ ç¬è®°/10.æå/07.æ¹åç§å¤§è®¡ç®æºç½ç».md",key:"v-449301a8",path:"/pages/4bdb82/",headers:[{level:2,title:"å ç¹ç½æ¦è¿°",slug:"å ç¹ç½æ¦è¿°",normalizedTitle:"å ç¹ç½æ¦è¿°",charIndex:13},{level:3,title:"1. ç½ç»ãäºèç½åå ç¹ç½",slug:"_1-ç½ç»ãäºèç½åå ç¹ç½",normalizedTitle:"1. ç½ç»ãäºèç½åå ç¹ç½",charIndex:23},{level:3,title:"2. å ç¹ç½æå¡æä¾èISP",slug:"_2-å ç¹ç½æå¡æä¾èisp",normalizedTitle:"2. å ç¹ç½æå¡æä¾èisp",charIndex:47},{level:3,title:"3. ä¸ç§äº¤æ¢æ¹å¼",slug:"_3-ä¸ç§äº¤æ¢æ¹å¼",normalizedTitle:"3. ä¸ç§äº¤æ¢æ¹å¼",charIndex:403},{level:3,title:"4. è®¡ç®æºç½ç»çæ§è½ææ ",slug:"_4-è®¡ç®æºç½ç»çæ§è½ææ ",normalizedTitle:"4. è®¡ç®æºç½ç»çæ§è½ææ ",charIndex:464},{level:3,title:"5. è®¡ç®æºç½ç»ä½ç³»ç»æ",slug:"_5-è®¡ç®æºç½ç»ä½ç³»ç»æ",normalizedTitle:"5. è®¡ç®æºç½ç»ä½ç³»ç»æ",charIndex:809}],headersStr:"å ç¹ç½æ¦è¿° 1. ç½ç»ãäºèç½åå ç¹ç½ 2. å ç¹ç½æå¡æä¾èISP 3. ä¸ç§äº¤æ¢æ¹å¼ 4. è®¡ç®æºç½ç»çæ§è½ææ  5. è®¡ç®æºç½ç»ä½ç³»ç»æ",content:"# ç¬¬ä¸ç«  æ¦è¿°\n\n\n# å ç¹ç½æ¦è¿°\n\n\n# 1. ç½ç»ãäºèç½åå ç¹ç½\n\n\n\n\n\n\n\n\n# 2. å ç¹ç½æå¡æä¾èISP\n\nISP å¯ä»¥ä»å ç¹ç½ç®¡çæºæç³è¯·å°æåçIPå°åï¼åæ¶æ¥æéä¿¡çº¿è·¯ï¼è·¯ç±å¨ç­èç½è®¾å¤ï¼ä»»ä½æºææèä¸ªäººåªè¦åISPç¼´çº³ä¸å®çç®¡çè´¹ç¨ï¼å°±å¯ä»¥å¾å°æéè¦çIPå°åï¼å ç¹ç½ä¸çä¸»æºå¿é¡»å¾éè¿IPå°åè¿è¡éä¿¡ï¼ï¼ä»èéè¿è¯¥ISPæ¥å¥å ç¹ç½ã\n\næå½ä¸»è¦çISPå°±æ¯ä¸å¤§è¿è¥å\n\n\n\n\n\n * ç¬¬ä¸å±ISPï¼æ¥æé«éé¾è·¯åäº¤æ¢è®¾å¤ï¼ç¬¬ä¸å±ISPä¹é´ç´æ¥äºèã\n\n * ç¬¬ä¸å±ISPï¼ä¸è¬çæ ¡å­ç½æä¼ä¸ç½ï¼ä»¥åä½å®ç¨æ·åæ çº¿ç§»å¨ç¨æ·ï¼é½æ¯ç¬¬ä¸å±ISPçç¨æ·ã\n\n * ç¸éè¾è¿çä¸¤å°ä¸»æºé´çéä¿¡å¯è½éè¦ç»è¿å¤ä¸ªISPï¼å¾ä¸­ä¸»æºAåä¸»æºBï¼\n\n * ä¸æ¦æä¸ªç¨æ·å¯ä»¥æ¥å¥å ç¹ç½ï¼é£ä¹ä»ä¹å¯ä»¥ç§°ä¸ºä¸ä¸ªISPï¼æéè¦åçå°±æ¯è´­ä¹°ä¸äºè°å¶è§£è°å¨æè·¯ç±å¨è¿æ ·çè®¾å¤ãè®©å¶ä»ç¨æ·è½å¤åä»ç¸è¿ã\n\n\n# 3. ä¸ç§äº¤æ¢æ¹å¼\n\n\n\n\n\n> switchå¨åºç¨ä¸­æ¯å¼å³çææï¼å¶å®çè§£ä¸ºä¸ç³»åå¼å³çè¿éæ´å®¹æçè§£\n\n\n\n\n\n\n# 4. è®¡ç®æºç½ç»çæ§è½ææ \n\n# éç\n\n\n\n\n\n# å¸¦å®½\n\n\n\n# ååé\n\n\n\néçãå¸¦å®½ãååéçåä½ä¸æ ·ï¼æä»¥å®ä»¬å±äºåä¸éçº²ï¼åªæ¯é¢åçå¯¹è±¡ä¸åã\n\n 1. éçæ²¡æå·ä½çé¢åå¯¹è±¡ ï¼åªæ¯è¡¨ç¤ºè¿ä¸éçº²çå®¢è§æ°å¼å¤§å°\n 2. å¸¦å®½è¡¨ç¤ºç¹å®éä¿¡çº¿è·¯çæé«éç\n 3. ååéè¡¨ç¤ºç¹å®éä¿¡çº¿è·¯çå®ééçï¼å¯ä»¥çè§£ä¸ºå¹³åéçï¼\n\n# æ¶å»¶\n\n\n\nåééçè·ç½å¡åééçï¼ä¿¡éå¸¦å®½ï¼æ¥å£éçé½æå³ç³»ï¼éµå¾ªæ¨æ¡¶åçï¼ä¹å°±æ¯ç±è¿ä¸é¡¹ä¸­çæå°å¼å³å®ã\n\n\n\n\n\n# æ¶å»¶å¸¦å®½ç§¯\n\n\n\néè¿ä¸é¢è®¡ç®æ¶å»¶å¬å¼ï¼å¯ä»¥å°æ¶å»¶å¸¦å®½ç§¯ååç»é¿åº¦å¯¹åºèµ·æ¥å»çè§£ã\n\nåç»é¿åº¦ = åééç * åéæ¶å»¶\n\næ¶å»¶å¸¦å®½ç§¯ = å¸¦å®½ * ä¼ æ­æ¶å»¶\n\n# å¾è¿æ¶é´\n\n\n\n# å©ç¨ç\n\n\n\n# ä¸¢åç\n\n\n\n\n\n\n# 5. è®¡ç®æºç½ç»ä½ç³»ç»æ\n\n\n\n\n\n# åå±å¿è¦æ§\n\n\n\n\n\n\n\n\n\n\n\n",normalizedContent:"# ç¬¬ä¸ç«  æ¦è¿°\n\n\n# å ç¹ç½æ¦è¿°\n\n\n# 1. ç½ç»ãäºèç½åå ç¹ç½\n\n\n\n\n\n\n\n\n# 2. å ç¹ç½æå¡æä¾èisp\n\nisp å¯ä»¥ä»å ç¹ç½ç®¡çæºæç³è¯·å°æåçipå°åï¼åæ¶æ¥æéä¿¡çº¿è·¯ï¼è·¯ç±å¨ç­èç½è®¾å¤ï¼ä»»ä½æºææèä¸ªäººåªè¦åispç¼´çº³ä¸å®çç®¡çè´¹ç¨ï¼å°±å¯ä»¥å¾å°æéè¦çipå°åï¼å ç¹ç½ä¸çä¸»æºå¿é¡»å¾éè¿ipå°åè¿è¡éä¿¡ï¼ï¼ä»èéè¿è¯¥ispæ¥å¥å ç¹ç½ã\n\næå½ä¸»è¦çispå°±æ¯ä¸å¤§è¿è¥å\n\n\n\n\n\n * ç¬¬ä¸å±ispï¼æ¥æé«éé¾è·¯åäº¤æ¢è®¾å¤ï¼ç¬¬ä¸å±ispä¹é´ç´æ¥äºèã\n\n * ç¬¬ä¸å±ispï¼ä¸è¬çæ ¡å­ç½æä¼ä¸ç½ï¼ä»¥åä½å®ç¨æ·åæ çº¿ç§»å¨ç¨æ·ï¼é½æ¯ç¬¬ä¸å±ispçç¨æ·ã\n\n * ç¸éè¾è¿çä¸¤å°ä¸»æºé´çéä¿¡å¯è½éè¦ç»è¿å¤ä¸ªispï¼å¾ä¸­ä¸»æºaåä¸»æºbï¼\n\n * ä¸æ¦æä¸ªç¨æ·å¯ä»¥æ¥å¥å ç¹ç½ï¼é£ä¹ä»ä¹å¯ä»¥ç§°ä¸ºä¸ä¸ªispï¼æéè¦åçå°±æ¯è´­ä¹°ä¸äºè°å¶è§£è°å¨æè·¯ç±å¨è¿æ ·çè®¾å¤ãè®©å¶ä»ç¨æ·è½å¤åä»ç¸è¿ã\n\n\n# 3. ä¸ç§äº¤æ¢æ¹å¼\n\n\n\n\n\n> switchå¨åºç¨ä¸­æ¯å¼å³çææï¼å¶å®çè§£ä¸ºä¸ç³»åå¼å³çè¿éæ´å®¹æçè§£\n\n\n\n\n\n\n# 4. è®¡ç®æºç½ç»çæ§è½ææ \n\n# éç\n\n\n\n\n\n# å¸¦å®½\n\n\n\n# ååé\n\n\n\néçãå¸¦å®½ãååéçåä½ä¸æ ·ï¼æä»¥å®ä»¬å±äºåä¸éçº²ï¼åªæ¯é¢åçå¯¹è±¡ä¸åã\n\n 1. éçæ²¡æå·ä½çé¢åå¯¹è±¡ ï¼åªæ¯è¡¨ç¤ºè¿ä¸éçº²çå®¢è§æ°å¼å¤§å°\n 2. å¸¦å®½è¡¨ç¤ºç¹å®éä¿¡çº¿è·¯çæé«éç\n 3. ååéè¡¨ç¤ºç¹å®éä¿¡çº¿è·¯çå®ééçï¼å¯ä»¥çè§£ä¸ºå¹³åéçï¼\n\n# æ¶å»¶\n\n\n\nåééçè·ç½å¡åééçï¼ä¿¡éå¸¦å®½ï¼æ¥å£éçé½æå³ç³»ï¼éµå¾ªæ¨æ¡¶åçï¼ä¹å°±æ¯ç±è¿ä¸é¡¹ä¸­çæå°å¼å³å®ã\n\n\n\n\n\n# æ¶å»¶å¸¦å®½ç§¯\n\n\n\néè¿ä¸é¢è®¡ç®æ¶å»¶å¬å¼ï¼å¯ä»¥å°æ¶å»¶å¸¦å®½ç§¯ååç»é¿åº¦å¯¹åºèµ·æ¥å»çè§£ã\n\nåç»é¿åº¦ = åééç * åéæ¶å»¶\n\næ¶å»¶å¸¦å®½ç§¯ = å¸¦å®½ * ä¼ æ­æ¶å»¶\n\n# å¾è¿æ¶é´\n\n\n\n# å©ç¨ç\n\n\n\n# ä¸¢åç\n\n\n\n\n\n\n# 5. è®¡ç®æºç½ç»ä½ç³»ç»æ\n\n\n\n\n\n# åå±å¿è¦æ§\n\n\n\n\n\n\n\n\n\n\n\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Gitåºç¡ä¸å½ä»¤",frontmatter:{title:"Gitåºç¡ä¸å½ä»¤",date:"2020-11-18T17:43:57.000Z",permalink:"/pages/635088/",categories:["ãGitãå­¦ä¹ ç¬è®°"],tags:["Git"]},regularPath:"/%E3%80%8AGit%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20.%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/10.Git%E5%9F%BA%E7%A1%80%E4%B8%8E%E5%91%BD%E4%BB%A4.html",relativePath:"ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/10.Gitåºç¡ä¸å½ä»¤.md",key:"v-364e812a",path:"/pages/635088/",headers:[{level:2,title:"Gitåºç¡",slug:"gitåºç¡",normalizedTitle:"gitåºç¡",charIndex:2},{level:3,title:"å¨å±éç½®",slug:"å¨å±éç½®",normalizedTitle:"å¨å±éç½®",charIndex:93},{level:3,title:"æ£æ¥éç½®ä¿¡æ¯",slug:"æ£æ¥éç½®ä¿¡æ¯",normalizedTitle:"æ£æ¥éç½®ä¿¡æ¯",charIndex:202},{level:3,title:"è·åå¸®å©",slug:"è·åå¸®å©",normalizedTitle:"è·åå¸®å©",charIndex:237},{level:3,title:"åå§åä»åº",slug:"åå§åä»åº",normalizedTitle:"åå§åä»åº",charIndex:398},{level:3,title:"åéè¿ç¨ä»åº",slug:"åéè¿ç¨ä»åº",normalizedTitle:"åéè¿ç¨ä»åº",charIndex:474},{level:3,title:"æ£æ¥æä»¶ç¶æ",slug:"æ£æ¥æä»¶ç¶æ",normalizedTitle:"æ£æ¥æä»¶ç¶æ",charIndex:623},{level:3,title:"å å¥æå­åº (è·è¸ªæä»¶)",slug:"å å¥æå­åº-è·è¸ªæä»¶",normalizedTitle:"å å¥æå­åº (è·è¸ªæä»¶)",charIndex:950},{level:3,title:"å¿½ç¥æä»¶",slug:"å¿½ç¥æä»¶",normalizedTitle:"å¿½ç¥æä»¶",charIndex:1119},{level:3,title:"æ¥çä¿®æ¹çå·ä½åå®¹",slug:"æ¥çä¿®æ¹çå·ä½åå®¹",normalizedTitle:"æ¥çä¿®æ¹çå·ä½åå®¹",charIndex:2105},{level:3,title:"æäº¤æ´æ°",slug:"æäº¤æ´æ°",normalizedTitle:"æäº¤æ´æ°",charIndex:2263},{level:3,title:"è·³è¿ä½¿ç¨æå­åºå",slug:"è·³è¿ä½¿ç¨æå­åºå",normalizedTitle:"è·³è¿ä½¿ç¨æå­åºå",charIndex:2406},{level:2,title:"Git åºç¡ - æ¥çæäº¤åå²",slug:"git-åºç¡-æ¥çæäº¤åå²",normalizedTitle:"git åºç¡ - æ¥çæäº¤åå²",charIndex:2506},{level:2,title:"Git åºç¡ - æ¤æ¶æä½",slug:"git-åºç¡-æ¤æ¶æä½",normalizedTitle:"git åºç¡ - æ¤æ¶æä½",charIndex:4022},{level:2,title:"Git åºç¡ - è¿ç¨ä»åºçä½¿ç¨",slug:"git-åºç¡-è¿ç¨ä»åºçä½¿ç¨",normalizedTitle:"git åºç¡ - è¿ç¨ä»åºçä½¿ç¨",charIndex:4228},{level:3,title:"æ¥çè¿ç¨ä»åº",slug:"æ¥çè¿ç¨ä»åº",normalizedTitle:"æ¥çè¿ç¨ä»åº",charIndex:4249},{level:3,title:"æ·»å è¿ç¨ä»åº",slug:"æ·»å è¿ç¨ä»åº",normalizedTitle:"æ·»å è¿ç¨ä»åº",charIndex:4323},{level:3,title:"ä»è¿ç¨ä»åºä¸­æåä¸æå",slug:"ä»è¿ç¨ä»åºä¸­æåä¸æå",normalizedTitle:"ä»è¿ç¨ä»åºä¸­æåä¸æå",charIndex:4370},{level:3,title:"æ¨éå°è¿ç¨ä»åº",slug:"æ¨éå°è¿ç¨ä»åº",normalizedTitle:"æ¨éå°è¿ç¨ä»åº",charIndex:1106},{level:3,title:"æ¥çæä¸ªè¿ç¨ä»åº",slug:"æ¥çæä¸ªè¿ç¨ä»åº",normalizedTitle:"æ¥çæä¸ªè¿ç¨ä»åº",charIndex:4825},{level:3,title:"è¿ç¨ä»åºçéå½åä¸ç§»é¤",slug:"è¿ç¨ä»åºçéå½åä¸ç§»é¤",normalizedTitle:"è¿ç¨ä»åºçéå½åä¸ç§»é¤",charIndex:4951},{level:2,title:"Git åºç¡ - ææ ç­¾",slug:"git-åºç¡-ææ ç­¾",normalizedTitle:"git åºç¡ - ææ ç­¾",charIndex:5049},{level:3,title:"ååºæ ç­¾",slug:"ååºæ ç­¾",normalizedTitle:"ååºæ ç­¾",charIndex:5066},{level:3,title:"åå»ºæ ç­¾",slug:"åå»ºæ ç­¾",normalizedTitle:"åå»ºæ ç­¾",charIndex:5164},{level:3,title:"éæ³¨æ ç­¾",slug:"éæ³¨æ ç­¾",normalizedTitle:"éæ³¨æ ç­¾",charIndex:5199},{level:3,title:"è½»éæ ç­¾",slug:"è½»éæ ç­¾",normalizedTitle:"è½»éæ ç­¾",charIndex:5181},{level:3,title:"åæææ ç­¾",slug:"åæææ ç­¾",normalizedTitle:"åæææ ç­¾",charIndex:5893},{level:3,title:"å±äº«æ ç­¾",slug:"å±äº«æ ç­¾",normalizedTitle:"å±äº«æ ç­¾",charIndex:6294},{level:3,title:"å é¤æ ç­¾",slug:"å é¤æ ç­¾",normalizedTitle:"å é¤æ ç­¾",charIndex:6527},{level:3,title:"æ£åºæ ç­¾",slug:"æ£åºæ ç­¾",normalizedTitle:"æ£åºæ ç­¾",charIndex:7014},{level:2,title:"Git å½ä»¤å«å",slug:"git-å½ä»¤å«å",normalizedTitle:"git å½ä»¤å«å",charIndex:8135}],headersStr:"Gitåºç¡ å¨å±éç½® æ£æ¥éç½®ä¿¡æ¯ è·åå¸®å© åå§åä»åº åéè¿ç¨ä»åº æ£æ¥æä»¶ç¶æ å å¥æå­åº (è·è¸ªæä»¶) å¿½ç¥æä»¶ æ¥çä¿®æ¹çå·ä½åå®¹ æäº¤æ´æ° è·³è¿ä½¿ç¨æå­åºå Git åºç¡ - æ¥çæäº¤åå² Git åºç¡ - æ¤æ¶æä½ Git åºç¡ - è¿ç¨ä»åºçä½¿ç¨ æ¥çè¿ç¨ä»åº æ·»å è¿ç¨ä»åº ä»è¿ç¨ä»åºä¸­æåä¸æå æ¨éå°è¿ç¨ä»åº æ¥çæä¸ªè¿ç¨ä»åº è¿ç¨ä»åºçéå½åä¸ç§»é¤ Git åºç¡ - ææ ç­¾ ååºæ ç­¾ åå»ºæ ç­¾ éæ³¨æ ç­¾ è½»éæ ç­¾ åæææ ç­¾ å±äº«æ ç­¾ å é¤æ ç­¾ æ£åºæ ç­¾ Git å½ä»¤å«å",content:"# Gitåºç¡ä¸å½ä»¤\n\nå®æ¹ææ¡£ï¼ä¸­æï¼ï¼https://git-scm.com/book/zh/v2\n\n> æ¬ææ¡£æ¯æ ¹æ®å®æ¹ææ¡£æ¥ç¼åçï¼ä»¥å®æ¹ææ¡£ä¸ºåã\n\n\n# Gitåºç¡\n\n\n# å¨å±éç½®\n\ngit config --global user.name 'your name'\ngit config --global user.email 'xxx@xx.com'\n\n\n1\n2\n\n\nèªæ¥å®¶é¨\n\n\n# æ£æ¥éç½®ä¿¡æ¯\n\ngit config --list\n\n\n1\n\n\n\n# è·åå¸®å©\n\n# è·åå¨å±å¸®å©æå\ngit help\n\n# è·åç¹å®å½ä»¤çè¯¦ç»çå¸®å©æå (ä¸¤ä¸ªå½ä»¤æ¯ç­ä»·ç)\ngit help <æä¸ªå½ä»¤>\ngit <æä¸ªå½ä»¤> --help # ä¸¤ä¸ªæ¨ªæ \n\n# è·åç¹å®å½ä»¤çç®æçå¸®å©æå\ngit <æä¸ªå½ä»¤> -h  # ä¸ä¸ªæ¨ªæ \n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# åå§åä»åº\n\n# æ¬å°ç®å½åå§åä»åº\ngit init\n\n\n1\n2\n\n\nå¦æä½ æ¯ä»è¿ç¨ä»åºcloneçé¡¹ç®ï¼åè¯¥é¡¹ç®æ¯å·²ç»åå§åå¥½çgitä»åº\n\n\n# åéè¿ç¨ä»åº\n\n# åé\ngit clone <url>\n\n# åéåæ¶ä¿®æ¹ç®å½å\ngit clone <url> <name>\n\n\n1\n2\n3\n4\n5\n\n\nåæ¬¡åéæä¸ªä»åºçæ¶åï¼å·¥ä½ç®å½ä¸­çæææä»¶é½å±äºå·²è·è¸ªæä»¶ï¼å¹¶å¤äºæªä¿®æ¹ç¶æï¼å ä¸º Git ååæ£åºäºå®ä»¬ï¼ èä½ å°æªç¼è¾è¿å®ä»¬\n\n\n# æ£æ¥æä»¶ç¶æ\n\n# æ¥çè¯¦ç»ç¶æè¯´æ\ngit status\n\n# æ¥çç®æç¶æè¯´æ\ngit status -s  # -s æ --short\n M README # å·²ä¿®æ¹ï¼ä½æªæå­ ï¼Mçä½ç½®é å³ï¼çº¢è²ï¼\nMM Rakefile # å·²ä¿®æ¹ï¼æå­ååä½äºä¿®æ¹ï¼ææå­åæªæå­ï¼\nA  lib/git.rb # æ°æ·»å å°æå­åºï¼æªæäº¤\nM  lib/simplegit.rb # å·²ä¿®æ¹ï¼å·²æå­ ï¼Mçä½ç½®é å·¦ï¼ç»¿è²ï¼\n?? LICENSE.txt # æ°æ·»å ï¼æªè·è¸ª\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n * gitç®å½ä¸­çæä»¶ç¶æåå«ï¼æ¯å¦è·è¸ªãæ¯å¦ä¿®æ¹ãæ¯å¦å·²å­å¥æå­åº\n\n * åæ°çä¸ä¸ªæ¨ªæ è¡¨ç¤ºç¼©åï¼ä¸¤ä¸ªæ¨ªæ è¡¨ç¤ºå¨ç§°ã\n\n\n# å å¥æå­åº (è·è¸ªæä»¶)\n\n# æä»¶å å¥æå­åºï¼è·è¸ªæå®æä»¶)\ngit add <files>\n\n\n1\n2\n\n\ngit add å½ä»¤ä½¿ç¨æä»¶æç®å½çè·¯å¾ä½ä¸ºåæ°ï¼å¦æåæ°æ¯ç®å½çè·¯å¾ï¼è¯¥å½ä»¤å°éå½å°è·è¸ªè¯¥ç®å½ä¸çæææä»¶ã\n\nadd å½ä»¤æ¯å°æä»¶å å¥å°æå­åºï¼commit å½ä»¤çæäº¤å°æ¬å°ä»åºï¼push å½ä»¤æ¯æ¨éå°è¿ç¨ä»åºã\n\n\n# å¿½ç¥æä»¶\n\næ·»å ä¸ä¸ªåä¸º .gitignore çæä»¶ï¼ååºè¦å¿½ç¥çæä»¶çæ¨¡å¼\n\n*.[oa]  # å¿½ç¥ä»¥ .o æ .a ç»å°¾çæä»¶ï¼ä¸è¬è¿ç±»æä»¶æ¯ç¼è¯è¿ç¨åºç°ï¼\n*~      # å¿½ç¥ä»¥ ~ ç»å°¾çæä»¶ï¼ä¸è¬æ¯ææ¬ç¼è¾è½¯ä»¶ä¿å­çå¯æ¬ï¼\n\n\n1\n2\n\n\næä»¶ .gitignore çæ ¼å¼è§èå¦ä¸ï¼\n\n * ææç©ºè¡æèä»¥ # å¼å¤´çè¡é½ä¼è¢« Git å¿½ç¥ï¼æ³¨éç¬¦å·ï¼ã\n\n * å¯ä»¥ä½¿ç¨æ åç glob æ¨¡å¼å¹éï¼å®ä¼éå½å°åºç¨å¨æ´ä¸ªå·¥ä½åºä¸­ã\n   \n   > glob æ¨¡å¼æ¯æ shell æä½¿ç¨çç®åäºçæ­£åè¡¨è¾¾å¼\n\n * å¹éæ¨¡å¼å¯ä»¥ä»¥ï¼/ï¼å¼å¤´é²æ­¢éå½ã\n\n * å¹éæ¨¡å¼å¯ä»¥ä»¥ï¼/ï¼ç»å°¾æå®ç®å½ã\n\n * è¦å¿½ç¥æå®æ¨¡å¼ä»¥å¤çæä»¶æç®å½ï¼å¯ä»¥å¨æ¨¡å¼åå ä¸å¹å·ï¼!ï¼ååã\n\n----------------------------------------\n\n * æå·ï¼*ï¼å¹éé¶ä¸ªæå¤ä¸ªä»»æå­ç¬¦\n * [abc] å¹éä»»ä½ä¸ä¸ªåå¨æ¹æ¬å·ä¸­çå­ç¬¦ ï¼è¿ä¸ªä¾å­è¦ä¹å¹éä¸ä¸ª aï¼è¦ä¹å¹éä¸ä¸ª bï¼è¦ä¹å¹éä¸ä¸ª cï¼\n * é®å·ï¼?ï¼åªå¹éä¸ä¸ªä»»æå­ç¬¦\n * [0-9] è¡¨ç¤ºå¹éææ 0 å° 9 çæ°å­ãå¨æ¹æ¬å·ä¸­ä½¿ç¨ç­åçº¿åéä¸¤ä¸ªå­ç¬¦ï¼ è¡¨ç¤ºææå¨è¿ä¸¤ä¸ªå­ç¬¦èå´åçé½å¯ä»¥å¹é\n * ä½¿ç¨ä¸¤ä¸ªæå·ï¼**ï¼è¡¨ç¤ºå¹éä»»æä¸­é´ç®å½ï¼æ¯å¦ a/**/z å¯ä»¥å¹é a/z ã a/b/z æ a/b/c/z ç­ã\n\n# å¿½ç¥ææç .a æä»¶\n*.a\n\n# ä½è·è¸ªææç lib.aï¼å³ä¾¿ä½ å¨åé¢å¿½ç¥äº .a æä»¶\n!lib.a\n\n# åªå¿½ç¥å½åç®å½ä¸ç TODO æä»¶ï¼èä¸å¿½ç¥ subdir/TODO\n/TODO\n\n# å¿½ç¥ä»»ä½ç®å½ä¸åä¸º build çæä»¶å¤¹\nbuild/\n\n# å¿½ç¥ doc/notes.txtï¼ä½ä¸å¿½ç¥ doc/server/arch.txt\ndoc/*.txt\n\n# å¿½ç¥ doc/ ç®å½åå¶ææå­ç®å½ä¸ç .pdf æä»¶\ndoc/**/*.pdf\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nGitHub æä¸ä¸ªååè¯¦ç»çéå¯¹æ°åç§é¡¹ç®åè¯­è¨ç .gitignore æä»¶åè¡¨ï¼ ä½ å¯ä»¥å¨ https://github.com/github/gitignore æ¾å°å®ã\n\n\n# æ¥çä¿®æ¹çå·ä½åå®¹\n\ngit diff # æ¯è¾ä¿®æ¹ä¹åè¿æ²¡ææå­èµ·æ¥çåååå®¹ã\n\ngit diff --staged # æ¥çå·²æå­çå°è¦æ·»å å°ä¸æ¬¡æäº¤éçåå®¹\n\n\n1\n2\n3\n\n\ngit status åªè½æ¥çæä»¶åå¨çç¶æï¼å¹¶ä¸è½æ¥çå·ä½ä¿®æ¹äºåªäºåå®¹ãä½¿ç¨git diffå¯ä»¥çå°å·ä½åå¨çåå®¹ã\n\n\n# æäº¤æ´æ°\n\ngit commit # æªå¸¦åæ°çä¼æå¼é»è®¤ææ¬ç¼è¾å¨è®©ä½ è¾å¥æäº¤è¯´æ\n\ngit commit -m 'æäº¤è¯´æ' # å¸¦-måæ°ç´æ¥è¾å¥æäº¤è¯´æ\n\n\n1\n2\n3\n\n\nä½¿ç¨git commitæäº¤æ´æ°ï¼å¨æ­¤ä¹åï¼å¡å¿ç¡®è®¤ææåå¨å·²ç»è¢«git addæ·»å å°æå­åºã\n\n\n# è·³è¿ä½¿ç¨æå­åºå\n\ngit commit -a -m 'æäº¤è¯´æ'\n\n\n1\n\n\næ·»å -aéé¡¹å¯ä»¥è·³è¿git add æ­¥éª¤ï¼æå·²ç»è·è¸ªè¿çæä»¶ä¸å¹¶æäº¤ã\n\næ³¨æï¼è¿ä¸ªæä½æ æ³æäº¤æªè·è¸ªçæä»¶ã\n\n\n# Git åºç¡ - æ¥çæäº¤åå²\n\ngit log\n\n\n1\n\n\nä¸ä¼ å¥ä»»ä½åæ°çé»è®¤æåµä¸ï¼git log ä¼ææ¶é´ååé¡ºåºååºææçæäº¤ï¼æè¿çæ´æ°æå¨æä¸é¢ã\n\næ­¤å½ä»¤æå°çæ°æ®ä¸­æä¸é¡¹æ¯ä¸é¿ä¸²ç SHA-1 æ ¡éªç ã\n\nå¸¦å¥-pæ--patchæ¥çæäº¤çå·ä½å·®å¼ï¼\n\ngit log -p -2 # -pæ¾ç¤ºå·®å¼  -2æ¾ç¤ºæè¿çæäº¤æ¬¡æ°\n\n\n1\n\n\n--stat æ¾ç¤ºæ¯æ¬¡æäº¤çå·®å¼ç»è®¡\n\ngit log --stat\n\n\n1\n\n\n--pretty è¿ä¸ªéé¡¹å¯ä»¥ä½¿ç¨ä¸åäºé»è®¤æ ¼å¼çæ¹å¼å±ç¤ºæäº¤åå²\n\nè¿ä¸ªéé¡¹æä¸äºåå»ºçå­éé¡¹ä¾ä½ ä½¿ç¨ã æ¯å¦ oneline ä¼å°æ¯ä¸ªæäº¤æ¾å¨ä¸è¡æ¾ç¤ºï¼å¨æµè§å¤§éçæäº¤æ¶éå¸¸æç¨ã å¦å¤è¿æ shortï¼full å fuller éé¡¹ï¼å®ä»¬å±ç¤ºä¿¡æ¯çæ ¼å¼åºæ¬ä¸è´ï¼ä½æ¯è¯¦å°½ç¨åº¦ä¸ä¸ï¼\n\n$ git log --pretty=oneline\nca82a6dff817ec66f44342007202690a93763949 changed the version number\n085bb3bcb608e1e8451d4b2432f8ecbe6306e7e7 removed unnecessary test\na11bef06a3f659402fe7563abf99ad00de2209e6 first commit\n\n\n1\n2\n3\n4\n\n\nææææçæ¯ format ï¼å¯ä»¥å®å¶è®°å½çæ¾ç¤ºæ ¼å¼ã è¿æ ·çè¾åºå¯¹åææååææ ¼å¤æç¨ââå ä¸ºä½ ç¥éè¾åºçæ ¼å¼ä¸ä¼éç Git çæ´æ°èåçæ¹åï¼\n\n$ git log --pretty=format:\"%h - %an, %ar : %s\"\nca82a6d - Scott Chacon, 6 years ago : changed the version number\n085bb3b - Scott Chacon, 6 years ago : removed unnecessary test\na11bef0 - Scott Chacon, 6 years ago : first commit\n\n\n1\n2\n3\n4\n\n\ngit log --pretty=format å¸¸ç¨çéé¡¹ ååºäº format æ¥åçå¸¸ç¨æ ¼å¼å ä½ç¬¦çåæ³åå¶ä»£è¡¨çæä¹ã\n\nå½ oneline æ format ä¸å¦ä¸ä¸ª log éé¡¹ --graph ç»åä½¿ç¨æ¶å°¤å¶æç¨ã è¿ä¸ªéé¡¹æ·»å äºä¸äº ASCII å­ç¬¦ä¸²æ¥å½¢è±¡å°å±ç¤ºä½ çåæ¯ãåå¹¶åå²ï¼\n\n$ git log --pretty=format:\"%h %s\" --graph\n* 2d3acf9 ignore errors from SIGCHLD on trap\n*  5e3ee11 Merge branch 'master' of git://github.com/dustin/grit\n|\\\n| * 420eac9 Added a method for getting the current branch.\n* | 30e367c timeout code and tests\n* | 5a09431 add timeout protection to grit\n* | e1193f8 support for heads with slashes in them\n|/\n* d6016bc require time for xmlschema\n*  11d191e Merge branch 'defunkt' into local\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# Git åºç¡ - æ¤æ¶æä½\n\nä½ æäº¤ååç°å¿è®°äºæå­æäºéè¦çä¿®æ¹ï¼å¯ä»¥åä¸é¢è¿æ ·æä½ï¼\n\n$ git commit -m 'initial commit'\n$ git add forgotten_file\n$ git commit --amend # éæ°æäº¤ï¼ä¸åªæä¸æ¬¡æäº¤è®°å½\n\n\n1\n2\n3\n\n\næç»ä½ åªä¼æä¸ä¸ªæäº¤ââç¬¬äºæ¬¡æäº¤å°ä»£æ¿ç¬¬ä¸æ¬¡æäº¤çç»æã\n\næ´å¤æ¤éæä½è¯·äºè§£ resetå½ä»¤ã\n\n\n# Git åºç¡ - è¿ç¨ä»åºçä½¿ç¨\n\n\n# æ¥çè¿ç¨ä»åº\n\ngit remote # ä»æ¾ç¤ºè¿ç¨ä»åºçåç§°\ngit remote -v # æ¾ç¤ºè¿ç¨ä»åºçåç§° + å°å\n\n\n1\n2\n\n\n\n# æ·»å è¿ç¨ä»åº\n\n git remote add <è¿ç¨ä»åºå> <url>\n\n\n1\n\n\n\n# ä»è¿ç¨ä»åºä¸­æåä¸æå\n\nå°±å¦åææè§ï¼ä»è¿ç¨ä»åºä¸­è·å¾æ°æ®ï¼å¯ä»¥æ§è¡ï¼\n\ngit fetch <remote>\n\n\n1\n\n\nè¿ä¸ªå½ä»¤ä¼è®¿é®è¿ç¨ä»åºï¼ä»ä¸­æåææä½ è¿æ²¡æçæ°æ®ã æ§è¡å®æåï¼ä½ å°ä¼æ¥æé£ä¸ªè¿ç¨ä»åºä¸­ææåæ¯çå¼ç¨ï¼å¯ä»¥éæ¶åå¹¶ææ¥çã\n\næ³¨æï¼ git fetch å½ä»¤åªä¼å°æ°æ®ä¸è½½å°ä½ çæ¬å°ä»åºââå®å¹¶ä¸ä¼èªå¨åå¹¶æä¿®æ¹ä½ å½åçå·¥ä½ã å½åå¤å¥½æ¶ä½ å¿é¡»æå¨å°å¶åå¹¶å¥ä½ çå·¥ä½ã\n\ngit pull\n\n\n1\n\n\nç¨ git pull å½ä»¤æ¥èªå¨æåååå¹¶è¯¥è¿ç¨åæ¯å°å½ååæ¯ã è¿æè®¸æ¯ä¸ªæ´å ç®åèæçå·¥ä½æµç¨ãé»è®¤æåµä¸ï¼git clone å½ä»¤ä¼èªå¨è®¾ç½®æ¬å° master åæ¯è·è¸ªåéçè¿ç¨ä»åºç master åæ¯ï¼æå¶å®åå­çé»è®¤åæ¯ï¼ã è¿è¡ git pull éå¸¸ä¼ä»æååéçæå¡å¨ä¸æåæ°æ®å¹¶èªå¨å°è¯åå¹¶å°å½åæå¨çåæ¯ã\n\n\n# æ¨éå°è¿ç¨ä»åº\n\ngit push <remote> <branch> # git push origin master\n\n\n1\n\n\n\n# æ¥çæä¸ªè¿ç¨ä»åº\n\n git remote show <remote> # git remote show origin\n\n\n1\n\n\næ¥çè¿ç¨ä»åºçè¯¦ç»ä¿¡æ¯ãè¿ä¸ªå½ä»¤ååºäºå½ä½ å¨ç¹å®çåæ¯ä¸æ§è¡ git push ä¼èªå¨å°æ¨éå°åªä¸ä¸ªè¿ç¨åæ¯\n\n\n# è¿ç¨ä»åºçéå½åä¸ç§»é¤\n\ngit remote rename <åå> <æ°å> # éå½å\ngit remote remove paul <remote># ç§»é¤è¿ç¨ä»åº\n\n\n1\n2\n\n\n\n# Git åºç¡ - ææ ç­¾\n\n\n# ååºæ ç­¾\n\ngit tag # å®æ´æ ç­¾åè¡¨\ngit tag -l \"v2.0*\" # åªæ¾ç¤ºåå« v2.0 çæ ç­¾ã æ³¨æå æå·(*)\n\n\n1\n2\n\n\n-l æ --list é½å¯ä»¥ã\n\n\n# åå»ºæ ç­¾\n\nGit æ¯æä¸¤ç§æ ç­¾ï¼è½»éæ ç­¾ï¼lightweightï¼ä¸éæ³¨æ ç­¾ï¼annotatedï¼ã\n\nè½»éæ ç­¾å¾åä¸ä¸ªä¸ä¼æ¹åçåæ¯ââå®åªæ¯æä¸ªç¹å®æäº¤çå¼ç¨ã\n\nèéæ³¨æ ç­¾æ¯å­å¨å¨ Git æ°æ®åºä¸­çä¸ä¸ªå®æ´å¯¹è±¡ï¼ å®ä»¬æ¯å¯ä»¥è¢«æ ¡éªçï¼å¶ä¸­åå«ææ ç­¾èçåå­ãçµå­é®ä»¶å°åãæ¥ææ¶é´ï¼ æ­¤å¤è¿æä¸ä¸ªæ ç­¾ä¿¡æ¯ï¼å¹¶ä¸å¯ä»¥ä½¿ç¨ GNU Privacy Guard ï¼GPGï¼ç­¾åå¹¶éªè¯ã éå¸¸ä¼å»ºè®®åå»ºéæ³¨æ ç­¾ï¼è¿æ ·ä½ å¯ä»¥æ¥æä»¥ä¸ææä¿¡æ¯ãä½æ¯å¦æä½ åªæ¯æ³ç¨ä¸ä¸ªä¸´æ¶çæ ç­¾ï¼ æèå ä¸ºæäºåå ä¸æ³è¦ä¿å­è¿äºä¿¡æ¯ï¼é£ä¹ä¹å¯ä»¥ç¨è½»éæ ç­¾ã\n\n\n# éæ³¨æ ç­¾\n\ngit tag -a v1.4 -m \"my version 1.4\" # -aè¡¨ç¤ºaddï¼ -m è¡¨ç¤ºéä»¶ä¿¡æ¯\n\n\n1\n\n\néè¿ä½¿ç¨ git show å½ä»¤å¯ä»¥çå°æ ç­¾ä¿¡æ¯åä¸ä¹å¯¹åºçæäº¤ä¿¡æ¯ï¼\n\ngit show v1.4\n\n\n1\n\n\n\n# è½»éæ ç­¾\n\nè½»éæ ç­¾æ¬è´¨ä¸æ¯å°æäº¤æ ¡éªåå­å¨å°ä¸ä¸ªæä»¶ä¸­ââæ²¡æä¿å­ä»»ä½å¶ä»ä¿¡æ¯ã åå»ºè½»éæ ç­¾ï¼ä¸éè¦ä½¿ç¨ -aã-s æ -m éé¡¹ï¼åªéè¦æä¾æ ç­¾åå­ï¼\n\ngit tag v1.4-lw # ä¸éè¦æ·»å éé¡¹\n\n\n1\n\n\nè¿æ¶ï¼å¦æå¨æ ç­¾ä¸è¿è¡ git showï¼ä½ ä¸ä¼çå°é¢å¤çæ ç­¾ä¿¡æ¯ã å½ä»¤åªä¼æ¾ç¤ºåºæäº¤ä¿¡æ¯ï¼\n\n$ git show v1.4-lw\ncommit ca82a6dff817ec66f44342007202690a93763949\nAuthor: Scott Chacon <schacon@gee-mail.com>\nDate:   Mon Mar 17 21:52:11 2008 -0700\n\n\n1\n2\n3\n4\n\n\n\n# åæææ ç­¾\n\nä½ ä¹å¯ä»¥å¯¹è¿å»çæäº¤ææ ç­¾ã åè®¾æäº¤åå²æ¯è¿æ ·çï¼\n\n$ git log --pretty=oneline\n166ae0c4d3f420721acbb115cc33848dfcc2121a started write support\n9fceb02d0ae598e95dc970b74767f19372d61af8 updated rakefile\n8a5cbc430f1a9c3d00faaeffd07798508422908a updated readme\n\n\n1\n2\n3\n4\n\n\nç°å¨ï¼åè®¾å¨ v1.2 æ¶ä½ å¿è®°ç»é¡¹ç®ææ ç­¾ï¼ä¹å°±æ¯å¨ âupdated rakefileâ æäº¤ã ä½ å¯ä»¥å¨ä¹åè¡¥ä¸æ ç­¾ã è¦å¨é£ä¸ªæäº¤ä¸ææ ç­¾ï¼ä½ éè¦å¨å½ä»¤çæ«å°¾æå®æäº¤çæ ¡éªåï¼æé¨åæ ¡éªåï¼ï¼\n\n$ git tag -a v1.2 9fceb02 # æçæ ç­¾å±äºéæ³¨æ ç­¾\n\n\n1\n\n\n\n# å±äº«æ ç­¾\n\ngit push å½ä»¤å¹¶ä¸ä¼ä¼ éæ ç­¾å°è¿ç¨ä»åºæå¡å¨ä¸ã å¨åå»ºå®æ ç­¾åä½ å¿é¡»æ¾å¼å°æ¨éæ ç­¾å°å±äº«æå¡å¨ä¸ã è¿ä¸ªè¿ç¨å°±åå±äº«è¿ç¨åæ¯ä¸æ ·ââä½ å¯ä»¥è¿è¡ git push origin <tagname>ã\n\ngit push origin v1.5 # æ¾å¼å°æ¨éæ ç­¾å°è¿ç¨ä»åº\ngit push origin --tags # ä¸æ¬¡æ§æ¨éææä¸å¨è¿ç¨ä»åºä¸çæ ç­¾\n\n\n1\n2\n\n\nç°å¨ï¼å½å¶ä»äººä»ä»åºä¸­åéææåï¼ä»ä»¬ä¹è½å¾å°ä½ çé£äºæ ç­¾ã\n\n\n# å é¤æ ç­¾\n\nè¦å é¤æä½ æ¬å°ä»åºä¸çæ ç­¾ï¼å¯ä»¥ä½¿ç¨å½ä»¤ git tag -d <tagname>ã ä¾å¦ï¼å¯ä»¥ä½¿ç¨ä»¥ä¸å½ä»¤å é¤ä¸ä¸ªè½»éæ ç­¾ï¼\n\n$ git tag -d v1.4-lw\nDeleted tag 'v1.4-lw' (was e7d5add)\n\n\n1\n2\n\n\næ³¨æä¸è¿°å½ä»¤å¹¶ä¸ä¼ä»ä»»ä½è¿ç¨ä»åºä¸­ç§»é¤è¿ä¸ªæ ç­¾ï¼ä½ å¿é¡»ç¨ git push <remote> :refs/tags/<tagname> æ¥æ´æ°ä½ çè¿ç¨ä»åºï¼\n\nç¬¬ä¸ç§åä½æ¯ git push <remote> :refs/tags/<tagname> ï¼\n\n$ git push origin :refs/tags/v1.4-lw\nTo /git@github.com:schacon/simplegit.git\n - [deleted]         v1.4-lw\n\n\n1\n2\n3\n\n\nä¸é¢è¿ç§æä½çå«ä¹æ¯ï¼å°åå·åé¢çç©ºå¼æ¨éå°è¿ç¨æ ç­¾åï¼ä»èé«æå°å é¤å®ã\n\nç¬¬äºç§æ´ç´è§çå é¤è¿ç¨æ ç­¾çæ¹å¼æ¯ï¼\n\n$ git push origin --delete <tagname>\n\n\n1\n\n\n\n# æ£åºæ ç­¾\n\nå¦æä½ æ³æ¥çæä¸ªæ ç­¾ææåçæä»¶çæ¬ï¼å¯ä»¥ä½¿ç¨ git checkout å½ä»¤ï¼ è½ç¶è¿ä¼ä½¿ä½ çä»åºå¤äºâåç¦»å¤´æéï¼detached HEADï¼âçç¶æââè¿ä¸ªç¶ææäºä¸å¥½çå¯ä½ç¨ï¼\n\n$ git checkout 2.0.0\nNote: checking out '2.0.0'.\n\nYou are in 'detached HEAD' state. You can look around, make experimental\nchanges and commit them, and you can discard any commits you make in this\nstate without impacting any branches by performing another checkout.\n\nIf you want to create a new branch to retain commits you create, you may\ndo so (now or later) by using -b with the checkout command again. Example:\n\n  git checkout -b <new-branch>\n\nHEAD is now at 99ada87... Merge pull request #89 from schacon/appendix-final\n\n$ git checkout 2.0-beta-0.1\nPrevious HEAD position was 99ada87... Merge pull request #89 from schacon/appendix-final\nHEAD is now at df3f601... add atlas.json and cover image\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nå¨âåç¦»å¤´æéâç¶æä¸ï¼å¦æä½ åäºæäºæ´æ¹ç¶åæäº¤å®ä»¬ï¼æ ç­¾ä¸ä¼åçååï¼ ä½ä½ çæ°æäº¤å°ä¸å±äºä»»ä½åæ¯ï¼å¹¶ä¸å°æ æ³è®¿é®ï¼é¤ééè¿ç¡®åçæäº¤åå¸æè½è®¿é®ã å æ­¤ï¼å¦æä½ éè¦è¿è¡æ´æ¹ï¼æ¯å¦ä½ è¦ä¿®å¤æ§çæ¬ä¸­çéè¯¯ï¼é£ä¹éå¸¸éè¦åå»ºä¸ä¸ªæ°åæ¯ï¼\n\n$ git checkout -b version2 v2.0.0\nSwitched to a new branch 'version2'\n\n\n1\n2\n\n\nå¦æå¨è¿ä¹ååè¿è¡äºä¸æ¬¡æäº¤ï¼version2 åæ¯å°±ä¼å ä¸ºè¿ä¸ªæ¹å¨ååç§»å¨ï¼ æ­¤æ¶å®å°±ä¼å v2.0.0 æ ç­¾ç¨å¾®æäºä¸åï¼è¿æ¶å°±è¦å½å¿äºã\n\n\n# Git å½ä»¤å«å\n\nGit å¹¶ä¸ä¼å¨ä½ è¾å¥é¨åå½ä»¤æ¶èªå¨æ¨æ­åºä½ æ³è¦çå½ä»¤ã å¦æä¸æ³æ¯æ¬¡é½è¾å¥å®æ´ç Git å½ä»¤ï¼å¯ä»¥éè¿ git config æä»¶æ¥è½»æ¾å°ä¸ºæ¯ä¸ä¸ªå½ä»¤è®¾ç½®ä¸ä¸ªå«åã è¿éæä¸äºä¾å­ä½ å¯ä»¥è¯è¯ï¼\n\n$ git config --global alias.co checkout\n$ git config --global alias.br branch\n$ git config --global alias.ci commit\n$ git config --global alias.st status\n\n\n1\n2\n3\n4\n\n\nè¿æå³çï¼å½è¦è¾å¥ git commit æ¶ï¼åªéè¦è¾å¥ git ciã\n\nå¨åå»ºä½ è®¤ä¸ºåºè¯¥å­å¨çå½ä»¤æ¶è¿ä¸ªææ¯ä¼å¾æç¨ã ä¾å¦ï¼ä¸ºäºè§£å³åæ¶æå­æä»¶çæç¨æ§é®é¢ï¼å¯ä»¥å Git ä¸­æ·»å ä½ èªå·±çåæ¶æå­å«åï¼\n\n$ git config --global alias.unstage 'reset HEAD --'\n\n\n1\n\n\nè¿ä¼ä½¿ä¸é¢çä¸¤ä¸ªå½ä»¤ç­ä»·ï¼\n\n$ git unstage fileA\n$ git reset HEAD -- fileA\n\n\n1\n2\n\n\nè¿æ ·çèµ·æ¥æ´æ¸æ¥ä¸äºã éå¸¸ä¹ä¼æ·»å ä¸ä¸ª last å½ä»¤ï¼åè¿æ ·ï¼\n\n$ git config --global alias.last 'log -1 HEAD'\n\n\n1\n\n\nè¿æ ·ï¼å¯ä»¥è½»æ¾å°çå°æåä¸æ¬¡æäº¤ï¼\n\n$ git last\ncommit 66938dae3329c7aebe598c2246a8e6af90d04646\nAuthor: Josh Goebel <dreamer3@example.com>\nDate:   Tue Aug 26 19:48:51 2008 +0800\n\n    test for current head\n\n    Signed-off-by: Scott Chacon <schacon@example.com>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¯ä»¥çåºï¼Git åªæ¯ç®åå°å°å«åæ¿æ¢ä¸ºå¯¹åºçå½ä»¤ã ç¶èï¼ä½ å¯è½æ³è¦æ§è¡å¤é¨å½ä»¤ï¼èä¸æ¯ä¸ä¸ª Git å­å½ä»¤ã å¦ææ¯é£æ ·çè¯ï¼å¯ä»¥å¨å½ä»¤åé¢å å¥ ! ç¬¦å·ã å¦æä½ èªå·±è¦åä¸äºä¸ Git ä»åºåä½çå·¥å·çè¯ï¼é£ä¼å¾æç¨ã æä»¬ç°å¨æ¼ç¤ºå° git visual å®ä¹ä¸º gitk çå«åï¼\n\n$ git config --global alias.visual '!gitk'\n\n\n1\n",normalizedContent:"# gitåºç¡ä¸å½ä»¤\n\nå®æ¹ææ¡£ï¼ä¸­æï¼ï¼https://git-scm.com/book/zh/v2\n\n> æ¬ææ¡£æ¯æ ¹æ®å®æ¹ææ¡£æ¥ç¼åçï¼ä»¥å®æ¹ææ¡£ä¸ºåã\n\n\n# gitåºç¡\n\n\n# å¨å±éç½®\n\ngit config --global user.name 'your name'\ngit config --global user.email 'xxx@xx.com'\n\n\n1\n2\n\n\nèªæ¥å®¶é¨\n\n\n# æ£æ¥éç½®ä¿¡æ¯\n\ngit config --list\n\n\n1\n\n\n\n# è·åå¸®å©\n\n# è·åå¨å±å¸®å©æå\ngit help\n\n# è·åç¹å®å½ä»¤çè¯¦ç»çå¸®å©æå (ä¸¤ä¸ªå½ä»¤æ¯ç­ä»·ç)\ngit help <æä¸ªå½ä»¤>\ngit <æä¸ªå½ä»¤> --help # ä¸¤ä¸ªæ¨ªæ \n\n# è·åç¹å®å½ä»¤çç®æçå¸®å©æå\ngit <æä¸ªå½ä»¤> -h  # ä¸ä¸ªæ¨ªæ \n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# åå§åä»åº\n\n# æ¬å°ç®å½åå§åä»åº\ngit init\n\n\n1\n2\n\n\nå¦æä½ æ¯ä»è¿ç¨ä»åºcloneçé¡¹ç®ï¼åè¯¥é¡¹ç®æ¯å·²ç»åå§åå¥½çgitä»åº\n\n\n# åéè¿ç¨ä»åº\n\n# åé\ngit clone <url>\n\n# åéåæ¶ä¿®æ¹ç®å½å\ngit clone <url> <name>\n\n\n1\n2\n3\n4\n5\n\n\nåæ¬¡åéæä¸ªä»åºçæ¶åï¼å·¥ä½ç®å½ä¸­çæææä»¶é½å±äºå·²è·è¸ªæä»¶ï¼å¹¶å¤äºæªä¿®æ¹ç¶æï¼å ä¸º git ååæ£åºäºå®ä»¬ï¼ èä½ å°æªç¼è¾è¿å®ä»¬\n\n\n# æ£æ¥æä»¶ç¶æ\n\n# æ¥çè¯¦ç»ç¶æè¯´æ\ngit status\n\n# æ¥çç®æç¶æè¯´æ\ngit status -s  # -s æ --short\n m readme # å·²ä¿®æ¹ï¼ä½æªæå­ ï¼mçä½ç½®é å³ï¼çº¢è²ï¼\nmm rakefile # å·²ä¿®æ¹ï¼æå­ååä½äºä¿®æ¹ï¼ææå­åæªæå­ï¼\na  lib/git.rb # æ°æ·»å å°æå­åºï¼æªæäº¤\nm  lib/simplegit.rb # å·²ä¿®æ¹ï¼å·²æå­ ï¼mçä½ç½®é å·¦ï¼ç»¿è²ï¼\n?? license.txt # æ°æ·»å ï¼æªè·è¸ª\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n * gitç®å½ä¸­çæä»¶ç¶æåå«ï¼æ¯å¦è·è¸ªãæ¯å¦ä¿®æ¹ãæ¯å¦å·²å­å¥æå­åº\n\n * åæ°çä¸ä¸ªæ¨ªæ è¡¨ç¤ºç¼©åï¼ä¸¤ä¸ªæ¨ªæ è¡¨ç¤ºå¨ç§°ã\n\n\n# å å¥æå­åº (è·è¸ªæä»¶)\n\n# æä»¶å å¥æå­åºï¼è·è¸ªæå®æä»¶)\ngit add <files>\n\n\n1\n2\n\n\ngit add å½ä»¤ä½¿ç¨æä»¶æç®å½çè·¯å¾ä½ä¸ºåæ°ï¼å¦æåæ°æ¯ç®å½çè·¯å¾ï¼è¯¥å½ä»¤å°éå½å°è·è¸ªè¯¥ç®å½ä¸çæææä»¶ã\n\nadd å½ä»¤æ¯å°æä»¶å å¥å°æå­åºï¼commit å½ä»¤çæäº¤å°æ¬å°ä»åºï¼push å½ä»¤æ¯æ¨éå°è¿ç¨ä»åºã\n\n\n# å¿½ç¥æä»¶\n\næ·»å ä¸ä¸ªåä¸º .gitignore çæä»¶ï¼ååºè¦å¿½ç¥çæä»¶çæ¨¡å¼\n\n*.[oa]  # å¿½ç¥ä»¥ .o æ .a ç»å°¾çæä»¶ï¼ä¸è¬è¿ç±»æä»¶æ¯ç¼è¯è¿ç¨åºç°ï¼\n*~      # å¿½ç¥ä»¥ ~ ç»å°¾çæä»¶ï¼ä¸è¬æ¯ææ¬ç¼è¾è½¯ä»¶ä¿å­çå¯æ¬ï¼\n\n\n1\n2\n\n\næä»¶ .gitignore çæ ¼å¼è§èå¦ä¸ï¼\n\n * ææç©ºè¡æèä»¥ # å¼å¤´çè¡é½ä¼è¢« git å¿½ç¥ï¼æ³¨éç¬¦å·ï¼ã\n\n * å¯ä»¥ä½¿ç¨æ åç glob æ¨¡å¼å¹éï¼å®ä¼éå½å°åºç¨å¨æ´ä¸ªå·¥ä½åºä¸­ã\n   \n   > glob æ¨¡å¼æ¯æ shell æä½¿ç¨çç®åäºçæ­£åè¡¨è¾¾å¼\n\n * å¹éæ¨¡å¼å¯ä»¥ä»¥ï¼/ï¼å¼å¤´é²æ­¢éå½ã\n\n * å¹éæ¨¡å¼å¯ä»¥ä»¥ï¼/ï¼ç»å°¾æå®ç®å½ã\n\n * è¦å¿½ç¥æå®æ¨¡å¼ä»¥å¤çæä»¶æç®å½ï¼å¯ä»¥å¨æ¨¡å¼åå ä¸å¹å·ï¼!ï¼ååã\n\n----------------------------------------\n\n * æå·ï¼*ï¼å¹éé¶ä¸ªæå¤ä¸ªä»»æå­ç¬¦\n * [abc] å¹éä»»ä½ä¸ä¸ªåå¨æ¹æ¬å·ä¸­çå­ç¬¦ ï¼è¿ä¸ªä¾å­è¦ä¹å¹éä¸ä¸ª aï¼è¦ä¹å¹éä¸ä¸ª bï¼è¦ä¹å¹éä¸ä¸ª cï¼\n * é®å·ï¼?ï¼åªå¹éä¸ä¸ªä»»æå­ç¬¦\n * [0-9] è¡¨ç¤ºå¹éææ 0 å° 9 çæ°å­ãå¨æ¹æ¬å·ä¸­ä½¿ç¨ç­åçº¿åéä¸¤ä¸ªå­ç¬¦ï¼ è¡¨ç¤ºææå¨è¿ä¸¤ä¸ªå­ç¬¦èå´åçé½å¯ä»¥å¹é\n * ä½¿ç¨ä¸¤ä¸ªæå·ï¼**ï¼è¡¨ç¤ºå¹éä»»æä¸­é´ç®å½ï¼æ¯å¦ a/**/z å¯ä»¥å¹é a/z ã a/b/z æ a/b/c/z ç­ã\n\n# å¿½ç¥ææç .a æä»¶\n*.a\n\n# ä½è·è¸ªææç lib.aï¼å³ä¾¿ä½ å¨åé¢å¿½ç¥äº .a æä»¶\n!lib.a\n\n# åªå¿½ç¥å½åç®å½ä¸ç todo æä»¶ï¼èä¸å¿½ç¥ subdir/todo\n/todo\n\n# å¿½ç¥ä»»ä½ç®å½ä¸åä¸º build çæä»¶å¤¹\nbuild/\n\n# å¿½ç¥ doc/notes.txtï¼ä½ä¸å¿½ç¥ doc/server/arch.txt\ndoc/*.txt\n\n# å¿½ç¥ doc/ ç®å½åå¶ææå­ç®å½ä¸ç .pdf æä»¶\ndoc/**/*.pdf\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\ngithub æä¸ä¸ªååè¯¦ç»çéå¯¹æ°åç§é¡¹ç®åè¯­è¨ç .gitignore æä»¶åè¡¨ï¼ ä½ å¯ä»¥å¨ https://github.com/github/gitignore æ¾å°å®ã\n\n\n# æ¥çä¿®æ¹çå·ä½åå®¹\n\ngit diff # æ¯è¾ä¿®æ¹ä¹åè¿æ²¡ææå­èµ·æ¥çåååå®¹ã\n\ngit diff --staged # æ¥çå·²æå­çå°è¦æ·»å å°ä¸æ¬¡æäº¤éçåå®¹\n\n\n1\n2\n3\n\n\ngit status åªè½æ¥çæä»¶åå¨çç¶æï¼å¹¶ä¸è½æ¥çå·ä½ä¿®æ¹äºåªäºåå®¹ãä½¿ç¨git diffå¯ä»¥çå°å·ä½åå¨çåå®¹ã\n\n\n# æäº¤æ´æ°\n\ngit commit # æªå¸¦åæ°çä¼æå¼é»è®¤ææ¬ç¼è¾å¨è®©ä½ è¾å¥æäº¤è¯´æ\n\ngit commit -m 'æäº¤è¯´æ' # å¸¦-måæ°ç´æ¥è¾å¥æäº¤è¯´æ\n\n\n1\n2\n3\n\n\nä½¿ç¨git commitæäº¤æ´æ°ï¼å¨æ­¤ä¹åï¼å¡å¿ç¡®è®¤ææåå¨å·²ç»è¢«git addæ·»å å°æå­åºã\n\n\n# è·³è¿ä½¿ç¨æå­åºå\n\ngit commit -a -m 'æäº¤è¯´æ'\n\n\n1\n\n\næ·»å -aéé¡¹å¯ä»¥è·³è¿git add æ­¥éª¤ï¼æå·²ç»è·è¸ªè¿çæä»¶ä¸å¹¶æäº¤ã\n\næ³¨æï¼è¿ä¸ªæä½æ æ³æäº¤æªè·è¸ªçæä»¶ã\n\n\n# git åºç¡ - æ¥çæäº¤åå²\n\ngit log\n\n\n1\n\n\nä¸ä¼ å¥ä»»ä½åæ°çé»è®¤æåµä¸ï¼git log ä¼ææ¶é´ååé¡ºåºååºææçæäº¤ï¼æè¿çæ´æ°æå¨æä¸é¢ã\n\næ­¤å½ä»¤æå°çæ°æ®ä¸­æä¸é¡¹æ¯ä¸é¿ä¸²ç sha-1 æ ¡éªç ã\n\nå¸¦å¥-pæ--patchæ¥çæäº¤çå·ä½å·®å¼ï¼\n\ngit log -p -2 # -pæ¾ç¤ºå·®å¼  -2æ¾ç¤ºæè¿çæäº¤æ¬¡æ°\n\n\n1\n\n\n--stat æ¾ç¤ºæ¯æ¬¡æäº¤çå·®å¼ç»è®¡\n\ngit log --stat\n\n\n1\n\n\n--pretty è¿ä¸ªéé¡¹å¯ä»¥ä½¿ç¨ä¸åäºé»è®¤æ ¼å¼çæ¹å¼å±ç¤ºæäº¤åå²\n\nè¿ä¸ªéé¡¹æä¸äºåå»ºçå­éé¡¹ä¾ä½ ä½¿ç¨ã æ¯å¦ oneline ä¼å°æ¯ä¸ªæäº¤æ¾å¨ä¸è¡æ¾ç¤ºï¼å¨æµè§å¤§éçæäº¤æ¶éå¸¸æç¨ã å¦å¤è¿æ shortï¼full å fuller éé¡¹ï¼å®ä»¬å±ç¤ºä¿¡æ¯çæ ¼å¼åºæ¬ä¸è´ï¼ä½æ¯è¯¦å°½ç¨åº¦ä¸ä¸ï¼\n\n$ git log --pretty=oneline\nca82a6dff817ec66f44342007202690a93763949 changed the version number\n085bb3bcb608e1e8451d4b2432f8ecbe6306e7e7 removed unnecessary test\na11bef06a3f659402fe7563abf99ad00de2209e6 first commit\n\n\n1\n2\n3\n4\n\n\nææææçæ¯ format ï¼å¯ä»¥å®å¶è®°å½çæ¾ç¤ºæ ¼å¼ã è¿æ ·çè¾åºå¯¹åææååææ ¼å¤æç¨ââå ä¸ºä½ ç¥éè¾åºçæ ¼å¼ä¸ä¼éç git çæ´æ°èåçæ¹åï¼\n\n$ git log --pretty=format:\"%h - %an, %ar : %s\"\nca82a6d - scott chacon, 6 years ago : changed the version number\n085bb3b - scott chacon, 6 years ago : removed unnecessary test\na11bef0 - scott chacon, 6 years ago : first commit\n\n\n1\n2\n3\n4\n\n\ngit log --pretty=format å¸¸ç¨çéé¡¹ ååºäº format æ¥åçå¸¸ç¨æ ¼å¼å ä½ç¬¦çåæ³åå¶ä»£è¡¨çæä¹ã\n\nå½ oneline æ format ä¸å¦ä¸ä¸ª log éé¡¹ --graph ç»åä½¿ç¨æ¶å°¤å¶æç¨ã è¿ä¸ªéé¡¹æ·»å äºä¸äº ascii å­ç¬¦ä¸²æ¥å½¢è±¡å°å±ç¤ºä½ çåæ¯ãåå¹¶åå²ï¼\n\n$ git log --pretty=format:\"%h %s\" --graph\n* 2d3acf9 ignore errors from sigchld on trap\n*  5e3ee11 merge branch 'master' of git://github.com/dustin/grit\n|\\\n| * 420eac9 added a method for getting the current branch.\n* | 30e367c timeout code and tests\n* | 5a09431 add timeout protection to grit\n* | e1193f8 support for heads with slashes in them\n|/\n* d6016bc require time for xmlschema\n*  11d191e merge branch 'defunkt' into local\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# git åºç¡ - æ¤æ¶æä½\n\nä½ æäº¤ååç°å¿è®°äºæå­æäºéè¦çä¿®æ¹ï¼å¯ä»¥åä¸é¢è¿æ ·æä½ï¼\n\n$ git commit -m 'initial commit'\n$ git add forgotten_file\n$ git commit --amend # éæ°æäº¤ï¼ä¸åªæä¸æ¬¡æäº¤è®°å½\n\n\n1\n2\n3\n\n\næç»ä½ åªä¼æä¸ä¸ªæäº¤ââç¬¬äºæ¬¡æäº¤å°ä»£æ¿ç¬¬ä¸æ¬¡æäº¤çç»æã\n\næ´å¤æ¤éæä½è¯·äºè§£ resetå½ä»¤ã\n\n\n# git åºç¡ - è¿ç¨ä»åºçä½¿ç¨\n\n\n# æ¥çè¿ç¨ä»åº\n\ngit remote # ä»æ¾ç¤ºè¿ç¨ä»åºçåç§°\ngit remote -v # æ¾ç¤ºè¿ç¨ä»åºçåç§° + å°å\n\n\n1\n2\n\n\n\n# æ·»å è¿ç¨ä»åº\n\n git remote add <è¿ç¨ä»åºå> <url>\n\n\n1\n\n\n\n# ä»è¿ç¨ä»åºä¸­æåä¸æå\n\nå°±å¦åææè§ï¼ä»è¿ç¨ä»åºä¸­è·å¾æ°æ®ï¼å¯ä»¥æ§è¡ï¼\n\ngit fetch <remote>\n\n\n1\n\n\nè¿ä¸ªå½ä»¤ä¼è®¿é®è¿ç¨ä»åºï¼ä»ä¸­æåææä½ è¿æ²¡æçæ°æ®ã æ§è¡å®æåï¼ä½ å°ä¼æ¥æé£ä¸ªè¿ç¨ä»åºä¸­ææåæ¯çå¼ç¨ï¼å¯ä»¥éæ¶åå¹¶ææ¥çã\n\næ³¨æï¼ git fetch å½ä»¤åªä¼å°æ°æ®ä¸è½½å°ä½ çæ¬å°ä»åºââå®å¹¶ä¸ä¼èªå¨åå¹¶æä¿®æ¹ä½ å½åçå·¥ä½ã å½åå¤å¥½æ¶ä½ å¿é¡»æå¨å°å¶åå¹¶å¥ä½ çå·¥ä½ã\n\ngit pull\n\n\n1\n\n\nç¨ git pull å½ä»¤æ¥èªå¨æåååå¹¶è¯¥è¿ç¨åæ¯å°å½ååæ¯ã è¿æè®¸æ¯ä¸ªæ´å ç®åèæçå·¥ä½æµç¨ãé»è®¤æåµä¸ï¼git clone å½ä»¤ä¼èªå¨è®¾ç½®æ¬å° master åæ¯è·è¸ªåéçè¿ç¨ä»åºç master åæ¯ï¼æå¶å®åå­çé»è®¤åæ¯ï¼ã è¿è¡ git pull éå¸¸ä¼ä»æååéçæå¡å¨ä¸æåæ°æ®å¹¶èªå¨å°è¯åå¹¶å°å½åæå¨çåæ¯ã\n\n\n# æ¨éå°è¿ç¨ä»åº\n\ngit push <remote> <branch> # git push origin master\n\n\n1\n\n\n\n# æ¥çæä¸ªè¿ç¨ä»åº\n\n git remote show <remote> # git remote show origin\n\n\n1\n\n\næ¥çè¿ç¨ä»åºçè¯¦ç»ä¿¡æ¯ãè¿ä¸ªå½ä»¤ååºäºå½ä½ å¨ç¹å®çåæ¯ä¸æ§è¡ git push ä¼èªå¨å°æ¨éå°åªä¸ä¸ªè¿ç¨åæ¯\n\n\n# è¿ç¨ä»åºçéå½åä¸ç§»é¤\n\ngit remote rename <åå> <æ°å> # éå½å\ngit remote remove paul <remote># ç§»é¤è¿ç¨ä»åº\n\n\n1\n2\n\n\n\n# git åºç¡ - ææ ç­¾\n\n\n# ååºæ ç­¾\n\ngit tag # å®æ´æ ç­¾åè¡¨\ngit tag -l \"v2.0*\" # åªæ¾ç¤ºåå« v2.0 çæ ç­¾ã æ³¨æå æå·(*)\n\n\n1\n2\n\n\n-l æ --list é½å¯ä»¥ã\n\n\n# åå»ºæ ç­¾\n\ngit æ¯æä¸¤ç§æ ç­¾ï¼è½»éæ ç­¾ï¼lightweightï¼ä¸éæ³¨æ ç­¾ï¼annotatedï¼ã\n\nè½»éæ ç­¾å¾åä¸ä¸ªä¸ä¼æ¹åçåæ¯ââå®åªæ¯æä¸ªç¹å®æäº¤çå¼ç¨ã\n\nèéæ³¨æ ç­¾æ¯å­å¨å¨ git æ°æ®åºä¸­çä¸ä¸ªå®æ´å¯¹è±¡ï¼ å®ä»¬æ¯å¯ä»¥è¢«æ ¡éªçï¼å¶ä¸­åå«ææ ç­¾èçåå­ãçµå­é®ä»¶å°åãæ¥ææ¶é´ï¼ æ­¤å¤è¿æä¸ä¸ªæ ç­¾ä¿¡æ¯ï¼å¹¶ä¸å¯ä»¥ä½¿ç¨ gnu privacy guard ï¼gpgï¼ç­¾åå¹¶éªè¯ã éå¸¸ä¼å»ºè®®åå»ºéæ³¨æ ç­¾ï¼è¿æ ·ä½ å¯ä»¥æ¥æä»¥ä¸ææä¿¡æ¯ãä½æ¯å¦æä½ åªæ¯æ³ç¨ä¸ä¸ªä¸´æ¶çæ ç­¾ï¼ æèå ä¸ºæäºåå ä¸æ³è¦ä¿å­è¿äºä¿¡æ¯ï¼é£ä¹ä¹å¯ä»¥ç¨è½»éæ ç­¾ã\n\n\n# éæ³¨æ ç­¾\n\ngit tag -a v1.4 -m \"my version 1.4\" # -aè¡¨ç¤ºaddï¼ -m è¡¨ç¤ºéä»¶ä¿¡æ¯\n\n\n1\n\n\néè¿ä½¿ç¨ git show å½ä»¤å¯ä»¥çå°æ ç­¾ä¿¡æ¯åä¸ä¹å¯¹åºçæäº¤ä¿¡æ¯ï¼\n\ngit show v1.4\n\n\n1\n\n\n\n# è½»éæ ç­¾\n\nè½»éæ ç­¾æ¬è´¨ä¸æ¯å°æäº¤æ ¡éªåå­å¨å°ä¸ä¸ªæä»¶ä¸­ââæ²¡æä¿å­ä»»ä½å¶ä»ä¿¡æ¯ã åå»ºè½»éæ ç­¾ï¼ä¸éè¦ä½¿ç¨ -aã-s æ -m éé¡¹ï¼åªéè¦æä¾æ ç­¾åå­ï¼\n\ngit tag v1.4-lw # ä¸éè¦æ·»å éé¡¹\n\n\n1\n\n\nè¿æ¶ï¼å¦æå¨æ ç­¾ä¸è¿è¡ git showï¼ä½ ä¸ä¼çå°é¢å¤çæ ç­¾ä¿¡æ¯ã å½ä»¤åªä¼æ¾ç¤ºåºæäº¤ä¿¡æ¯ï¼\n\n$ git show v1.4-lw\ncommit ca82a6dff817ec66f44342007202690a93763949\nauthor: scott chacon <schacon@gee-mail.com>\ndate:   mon mar 17 21:52:11 2008 -0700\n\n\n1\n2\n3\n4\n\n\n\n# åæææ ç­¾\n\nä½ ä¹å¯ä»¥å¯¹è¿å»çæäº¤ææ ç­¾ã åè®¾æäº¤åå²æ¯è¿æ ·çï¼\n\n$ git log --pretty=oneline\n166ae0c4d3f420721acbb115cc33848dfcc2121a started write support\n9fceb02d0ae598e95dc970b74767f19372d61af8 updated rakefile\n8a5cbc430f1a9c3d00faaeffd07798508422908a updated readme\n\n\n1\n2\n3\n4\n\n\nç°å¨ï¼åè®¾å¨ v1.2 æ¶ä½ å¿è®°ç»é¡¹ç®ææ ç­¾ï¼ä¹å°±æ¯å¨ âupdated rakefileâ æäº¤ã ä½ å¯ä»¥å¨ä¹åè¡¥ä¸æ ç­¾ã è¦å¨é£ä¸ªæäº¤ä¸ææ ç­¾ï¼ä½ éè¦å¨å½ä»¤çæ«å°¾æå®æäº¤çæ ¡éªåï¼æé¨åæ ¡éªåï¼ï¼\n\n$ git tag -a v1.2 9fceb02 # æçæ ç­¾å±äºéæ³¨æ ç­¾\n\n\n1\n\n\n\n# å±äº«æ ç­¾\n\ngit push å½ä»¤å¹¶ä¸ä¼ä¼ éæ ç­¾å°è¿ç¨ä»åºæå¡å¨ä¸ã å¨åå»ºå®æ ç­¾åä½ å¿é¡»æ¾å¼å°æ¨éæ ç­¾å°å±äº«æå¡å¨ä¸ã è¿ä¸ªè¿ç¨å°±åå±äº«è¿ç¨åæ¯ä¸æ ·ââä½ å¯ä»¥è¿è¡ git push origin <tagname>ã\n\ngit push origin v1.5 # æ¾å¼å°æ¨éæ ç­¾å°è¿ç¨ä»åº\ngit push origin --tags # ä¸æ¬¡æ§æ¨éææä¸å¨è¿ç¨ä»åºä¸çæ ç­¾\n\n\n1\n2\n\n\nç°å¨ï¼å½å¶ä»äººä»ä»åºä¸­åéææåï¼ä»ä»¬ä¹è½å¾å°ä½ çé£äºæ ç­¾ã\n\n\n# å é¤æ ç­¾\n\nè¦å é¤æä½ æ¬å°ä»åºä¸çæ ç­¾ï¼å¯ä»¥ä½¿ç¨å½ä»¤ git tag -d <tagname>ã ä¾å¦ï¼å¯ä»¥ä½¿ç¨ä»¥ä¸å½ä»¤å é¤ä¸ä¸ªè½»éæ ç­¾ï¼\n\n$ git tag -d v1.4-lw\ndeleted tag 'v1.4-lw' (was e7d5add)\n\n\n1\n2\n\n\næ³¨æä¸è¿°å½ä»¤å¹¶ä¸ä¼ä»ä»»ä½è¿ç¨ä»åºä¸­ç§»é¤è¿ä¸ªæ ç­¾ï¼ä½ å¿é¡»ç¨ git push <remote> :refs/tags/<tagname> æ¥æ´æ°ä½ çè¿ç¨ä»åºï¼\n\nç¬¬ä¸ç§åä½æ¯ git push <remote> :refs/tags/<tagname> ï¼\n\n$ git push origin :refs/tags/v1.4-lw\nto /git@github.com:schacon/simplegit.git\n - [deleted]         v1.4-lw\n\n\n1\n2\n3\n\n\nä¸é¢è¿ç§æä½çå«ä¹æ¯ï¼å°åå·åé¢çç©ºå¼æ¨éå°è¿ç¨æ ç­¾åï¼ä»èé«æå°å é¤å®ã\n\nç¬¬äºç§æ´ç´è§çå é¤è¿ç¨æ ç­¾çæ¹å¼æ¯ï¼\n\n$ git push origin --delete <tagname>\n\n\n1\n\n\n\n# æ£åºæ ç­¾\n\nå¦æä½ æ³æ¥çæä¸ªæ ç­¾ææåçæä»¶çæ¬ï¼å¯ä»¥ä½¿ç¨ git checkout å½ä»¤ï¼ è½ç¶è¿ä¼ä½¿ä½ çä»åºå¤äºâåç¦»å¤´æéï¼detached headï¼âçç¶æââè¿ä¸ªç¶ææäºä¸å¥½çå¯ä½ç¨ï¼\n\n$ git checkout 2.0.0\nnote: checking out '2.0.0'.\n\nyou are in 'detached head' state. you can look around, make experimental\nchanges and commit them, and you can discard any commits you make in this\nstate without impacting any branches by performing another checkout.\n\nif you want to create a new branch to retain commits you create, you may\ndo so (now or later) by using -b with the checkout command again. example:\n\n  git checkout -b <new-branch>\n\nhead is now at 99ada87... merge pull request #89 from schacon/appendix-final\n\n$ git checkout 2.0-beta-0.1\nprevious head position was 99ada87... merge pull request #89 from schacon/appendix-final\nhead is now at df3f601... add atlas.json and cover image\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nå¨âåç¦»å¤´æéâç¶æä¸ï¼å¦æä½ åäºæäºæ´æ¹ç¶åæäº¤å®ä»¬ï¼æ ç­¾ä¸ä¼åçååï¼ ä½ä½ çæ°æäº¤å°ä¸å±äºä»»ä½åæ¯ï¼å¹¶ä¸å°æ æ³è®¿é®ï¼é¤ééè¿ç¡®åçæäº¤åå¸æè½è®¿é®ã å æ­¤ï¼å¦æä½ éè¦è¿è¡æ´æ¹ï¼æ¯å¦ä½ è¦ä¿®å¤æ§çæ¬ä¸­çéè¯¯ï¼é£ä¹éå¸¸éè¦åå»ºä¸ä¸ªæ°åæ¯ï¼\n\n$ git checkout -b version2 v2.0.0\nswitched to a new branch 'version2'\n\n\n1\n2\n\n\nå¦æå¨è¿ä¹ååè¿è¡äºä¸æ¬¡æäº¤ï¼version2 åæ¯å°±ä¼å ä¸ºè¿ä¸ªæ¹å¨ååç§»å¨ï¼ æ­¤æ¶å®å°±ä¼å v2.0.0 æ ç­¾ç¨å¾®æäºä¸åï¼è¿æ¶å°±è¦å½å¿äºã\n\n\n# git å½ä»¤å«å\n\ngit å¹¶ä¸ä¼å¨ä½ è¾å¥é¨åå½ä»¤æ¶èªå¨æ¨æ­åºä½ æ³è¦çå½ä»¤ã å¦æä¸æ³æ¯æ¬¡é½è¾å¥å®æ´ç git å½ä»¤ï¼å¯ä»¥éè¿ git config æä»¶æ¥è½»æ¾å°ä¸ºæ¯ä¸ä¸ªå½ä»¤è®¾ç½®ä¸ä¸ªå«åã è¿éæä¸äºä¾å­ä½ å¯ä»¥è¯è¯ï¼\n\n$ git config --global alias.co checkout\n$ git config --global alias.br branch\n$ git config --global alias.ci commit\n$ git config --global alias.st status\n\n\n1\n2\n3\n4\n\n\nè¿æå³çï¼å½è¦è¾å¥ git commit æ¶ï¼åªéè¦è¾å¥ git ciã\n\nå¨åå»ºä½ è®¤ä¸ºåºè¯¥å­å¨çå½ä»¤æ¶è¿ä¸ªææ¯ä¼å¾æç¨ã ä¾å¦ï¼ä¸ºäºè§£å³åæ¶æå­æä»¶çæç¨æ§é®é¢ï¼å¯ä»¥å git ä¸­æ·»å ä½ èªå·±çåæ¶æå­å«åï¼\n\n$ git config --global alias.unstage 'reset head --'\n\n\n1\n\n\nè¿ä¼ä½¿ä¸é¢çä¸¤ä¸ªå½ä»¤ç­ä»·ï¼\n\n$ git unstage filea\n$ git reset head -- filea\n\n\n1\n2\n\n\nè¿æ ·çèµ·æ¥æ´æ¸æ¥ä¸äºã éå¸¸ä¹ä¼æ·»å ä¸ä¸ª last å½ä»¤ï¼åè¿æ ·ï¼\n\n$ git config --global alias.last 'log -1 head'\n\n\n1\n\n\nè¿æ ·ï¼å¯ä»¥è½»æ¾å°çå°æåä¸æ¬¡æäº¤ï¼\n\n$ git last\ncommit 66938dae3329c7aebe598c2246a8e6af90d04646\nauthor: josh goebel <dreamer3@example.com>\ndate:   tue aug 26 19:48:51 2008 +0800\n\n    test for current head\n\n    signed-off-by: scott chacon <schacon@example.com>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¯ä»¥çåºï¼git åªæ¯ç®åå°å°å«åæ¿æ¢ä¸ºå¯¹åºçå½ä»¤ã ç¶èï¼ä½ å¯è½æ³è¦æ§è¡å¤é¨å½ä»¤ï¼èä¸æ¯ä¸ä¸ª git å­å½ä»¤ã å¦ææ¯é£æ ·çè¯ï¼å¯ä»¥å¨å½ä»¤åé¢å å¥ ! ç¬¦å·ã å¦æä½ èªå·±è¦åä¸äºä¸ git ä»åºåä½çå·¥å·çè¯ï¼é£ä¼å¾æç¨ã æä»¬ç°å¨æ¼ç¤ºå° git visual å®ä¹ä¸º gitk çå«åï¼\n\n$ git config --global alias.visual '!gitk'\n\n\n1\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Gitå·¥å·-éååå²",frontmatter:{title:"Gitå·¥å·-éååå²",date:"2020-11-18T17:43:57.000Z",permalink:"/pages/1832fe/",categories:["ãGitãå­¦ä¹ ç¬è®°"],tags:["Git"]},regularPath:"/%E3%80%8AGit%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20.%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/100.Git%E5%B7%A5%E5%85%B7-%E9%87%8D%E5%86%99%E5%8E%86%E5%8F%B2.html",relativePath:"ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/100.Gitå·¥å·-éååå².md",key:"v-0dd61c07",path:"/pages/1832fe/",headers:[{level:2,title:"ä¿®æ¹æåä¸æ¬¡æäº¤",slug:"ä¿®æ¹æåä¸æ¬¡æäº¤",normalizedTitle:"ä¿®æ¹æåä¸æ¬¡æäº¤",charIndex:453},{level:3,title:"ä¿®æ¹æäº¤ä¿¡æ¯",slug:"ä¿®æ¹æäº¤ä¿¡æ¯",normalizedTitle:"ä¿®æ¹æäº¤ä¿¡æ¯",charIndex:519},{level:3,title:"ä¿®æ¹å®éåå®¹",slug:"ä¿®æ¹å®éåå®¹",normalizedTitle:"ä¿®æ¹å®éåå®¹",charIndex:700},{level:2,title:"ä¿®æ¹å¤ä¸ªæäº¤ä¿¡æ¯",slug:"ä¿®æ¹å¤ä¸ªæäº¤ä¿¡æ¯",normalizedTitle:"ä¿®æ¹å¤ä¸ªæäº¤ä¿¡æ¯",charIndex:1113},{level:2,title:"éæ°æåºæäº¤",slug:"éæ°æåºæäº¤",normalizedTitle:"éæ°æåºæäº¤",charIndex:4034},{level:2,title:"åç¼©æäº¤",slug:"åç¼©æäº¤",normalizedTitle:"åç¼©æäº¤",charIndex:4460},{level:2,title:"æåæäº¤",slug:"æåæäº¤",normalizedTitle:"æåæäº¤",charIndex:6218},{level:2,title:"æ ¸æ­¦å¨çº§éé¡¹ï¼filter-branch",slug:"æ ¸æ­¦å¨çº§éé¡¹-filter-branch",normalizedTitle:"æ ¸æ­¦å¨çº§éé¡¹ï¼filter-branch",charIndex:7244},{level:3,title:"ä»æ¯ä¸ä¸ªæäº¤ä¸­ç§»é¤ä¸ä¸ªæä»¶",slug:"ä»æ¯ä¸ä¸ªæäº¤ä¸­ç§»é¤ä¸ä¸ªæä»¶",normalizedTitle:"ä»æ¯ä¸ä¸ªæäº¤ä¸­ç§»é¤ä¸ä¸ªæä»¶",charIndex:7318},{level:3,title:"ä½¿ä¸ä¸ªå­ç®å½åä¸ºæ°çæ ¹ç®å½",slug:"ä½¿ä¸ä¸ªå­ç®å½åä¸ºæ°çæ ¹ç®å½",normalizedTitle:"ä½¿ä¸ä¸ªå­ç®å½åä¸ºæ°çæ ¹ç®å½",charIndex:8358},{level:3,title:"å¨å±ä¿®æ¹é®ç®±å°å",slug:"å¨å±ä¿®æ¹é®ç®±å°å",normalizedTitle:"å¨å±ä¿®æ¹é®ç®±å°å",charIndex:8684}],headersStr:"ä¿®æ¹æåä¸æ¬¡æäº¤ ä¿®æ¹æäº¤ä¿¡æ¯ ä¿®æ¹å®éåå®¹ ä¿®æ¹å¤ä¸ªæäº¤ä¿¡æ¯ éæ°æåºæäº¤ åç¼©æäº¤ æåæäº¤ æ ¸æ­¦å¨çº§éé¡¹ï¼filter-branch ä»æ¯ä¸ä¸ªæäº¤ä¸­ç§»é¤ä¸ä¸ªæä»¶ ä½¿ä¸ä¸ªå­ç®å½åä¸ºæ°çæ ¹ç®å½ å¨å±ä¿®æ¹é®ç®±å°å",content:"# Git å·¥å· - éååå²\n\nè®¸å¤æ¶åï¼å¨ä½¿ç¨ Git æ¶ï¼ä½ å¯è½æ³è¦ä¿®è®¢æäº¤åå²ã Git å¾æ£çä¸ç¹æ¯å®åè®¸ä½ å¨æåæ¶å»åå³å®ã ä½ å¯ä»¥å¨å°æå­åºåå®¹æäº¤åå³å®åªäºæä»¶è¿å¥æäº¤ï¼å¯ä»¥éè¿ git stash æ¥å³å®ä¸ä¸æäºåå®¹å·¥ä½ï¼ ä¹å¯ä»¥éåå·²ç»åççæäº¤å°±åå®ä»¬ä»¥å¦ä¸ç§æ¹å¼åççä¸æ ·ã è¿å¯è½æ¶åæ¹åæäº¤çé¡ºåºï¼æ¹åæäº¤ä¸­çä¿¡æ¯æä¿®æ¹æä»¶ï¼å°æäº¤åç¼©ææ¯æåï¼ æå®å¨å°ç§»é¤æäº¤ââå¨å°ä½ çå·¥ä½ææä¸ä»äººå±äº«ä¹åã\n\nå¨æ¬èä¸­ï¼ä½ å¯ä»¥å­¦å°å¦ä½å®æè¿äºå·¥ä½ï¼è¿æ ·å¨ä¸ä»äººåäº«ä½ çå·¥ä½æææ¶ä½ çæäº¤åå²å°å¦ä½ ææ¿å°å±ç¤ºåºæ¥ã\n\nNOTE   å¨æ»¡æä¹åä¸è¦æ¨éä½ çå·¥ä½GIT çåºæ¬ååä¹ä¸æ¯ï¼ç±äºåéä¸­æå¾å¤å·¥ä½æ¯æ¬å°çï¼å æ­¤ä½ å¯ä»¥ å¨æ¬å° éä¾¿éååå²è®°å½ã\n       ç¶èä¸æ¦æ¨éäºä½ çå·¥ä½ï¼é£å°±å®å¨æ¯å¦ä¸åäºäºï¼é¤éä½ æååççç±è¿è¡æ´æ¹ï¼å¦ååºè¯¥å°æ¨éçå·¥ä½è§ä¸ºæç»ç»æã\n       ç®èè¨ä¹ï¼å¨å¯¹å®æå°æ»¡æå¹¶åå¤ä¸ä»äººåäº«ä¹åï¼åºå½é¿åæ¨éä½ çå·¥ä½ã\n       \n\n\n# ä¿®æ¹æåä¸æ¬¡æäº¤\n\nä¿®æ¹ä½ æè¿ä¸æ¬¡æäº¤å¯è½æ¯ææä¿®æ¹åå²æäº¤çæä½ä¸­æå¸¸è§çä¸ä¸ªã å¯¹äºä½ çæè¿ä¸æ¬¡æäº¤ï¼ä½ å¾å¾æ³åä¸¤ä»¶äºæï¼ç®åå°ä¿®æ¹æäº¤ä¿¡æ¯ï¼ æèéè¿æ·»å ãç§»é¤æä¿®æ¹æä»¶æ¥æ´æ¹æäº¤å®éçåå®¹ã\n\n\n# ä¿®æ¹æäº¤ä¿¡æ¯\n\nå¦æï¼ä½ åªæ¯æ³ä¿®æ¹æè¿ä¸æ¬¡æäº¤çæäº¤ä¿¡æ¯ï¼é£ä¹å¾ç®åï¼\n\n$ git commit --amend\n\n\n1\n\n\nä¸é¢è¿æ¡å½ä»¤ä¼å°æåä¸æ¬¡çæäº¤ä¿¡æ¯è½½å¥å°ç¼è¾å¨ä¸­ä¾ä½ ä¿®æ¹ã å½ä¿å­å¹¶å³é­ç¼è¾å¨åï¼ç¼è¾å¨ä¼å°æ´æ°åçæäº¤ä¿¡æ¯åå¥æ°æäº¤ä¸­ï¼å®ä¼æä¸ºæ°çæåä¸æ¬¡æäº¤ã\n\n\n# ä¿®æ¹å®éåå®¹\n\nå¦ä¸æ¹é¢ï¼å¦æä½ æ³è¦ä¿®æ¹æåä¸æ¬¡æäº¤çå®éåå®¹ï¼é£ä¹æµç¨å¾ç¸ä¼¼ï¼é¦åä½åºä½ æ³è¦è¡¥ä¸çä¿®æ¹ï¼ æå­å®ä»¬ï¼ç¶åç¨ git commit --amend ä»¥æ°çæ¹è¿åçæäº¤æ¥ æ¿æ¢ ææ§æçæåä¸æ¬¡æäº¤ï¼\n\nä½¿ç¨è¿ä¸ªæå·§çæ¶åéè¦å°å¿ï¼å ä¸ºä¿®æ­£ä¼æ¹åæäº¤ç SHA-1 æ ¡éªåã å®ç±»ä¼¼äºä¸ä¸ªå°çååºââå¦æå·²ç»æ¨éäºæåä¸æ¬¡æäº¤å°±ä¸è¦ä¿®æ­£å®ã\n\nTIP   ä¿®è¡¥åçæäº¤å¯è½éè¦ä¿®è¡¥æäº¤ä¿¡æ¯å½ä½ å¨ä¿®è¡¥ä¸æ¬¡æäº¤æ¶ï¼å¯ä»¥åæ¶ä¿®æ¹æäº¤ä¿¡æ¯åæäº¤åå®¹ã\n      å¦æä½ ä¿®è¡¥äºæäº¤çåå®¹ï¼é£ä¹å ä¹è¯å®è¦æ´æ°æäº¤æ¶æ¯ä»¥åæ ä¿®æ¹åçåå®¹ãå¦ä¸æ¹é¢ï¼å¦æä½ çä¿®è¡¥æ¯çç¢çï¼å¦ä¿®æ¹äºä¸ä¸ªç¬è¯¯ææ·»å äºä¸ä¸ªå¿è®°æå­çæä»¶ï¼ï¼\n      é£ä¹ä¹åçæäº¤ä¿¡æ¯ä¸å¿ä¿®æ¹ï¼ä½ åªéä½åºæ´æ¹ï¼æå­å®ä»¬ï¼ç¶åéè¿ä»¥ä¸å½ä»¤é¿åä¸å¿è¦çç¼è¾å¨ç¯èå³å¯ï¼$ GIT\n      COMMIT --AMEND --NO-EDIT\n      \n\n\n# ä¿®æ¹å¤ä¸ªæäº¤ä¿¡æ¯\n\nä¸ºäºä¿®æ¹å¨æäº¤åå²ä¸­è¾è¿çæäº¤ï¼å¿é¡»ä½¿ç¨æ´å¤æçå·¥å·ã Git æ²¡æä¸ä¸ªæ¹ååå²å·¥å·ï¼ä½æ¯å¯ä»¥ä½¿ç¨ååºå·¥å·æ¥ååºä¸ç³»åæäº¤ï¼åºäºå®ä»¬åæ¥ç HEAD èä¸æ¯å°å¶ç§»å¨å°å¦ä¸ä¸ªæ°çä¸é¢ã éè¿äº¤äºå¼ååºå·¥å·ï¼å¯ä»¥å¨ä»»ä½æ³è¦ä¿®æ¹çæäº¤ååæ­¢ï¼ç¶åä¿®æ¹ä¿¡æ¯ãæ·»å æä»¶æåä»»ä½æ³åçäºæã å¯ä»¥éè¿ç» git rebase å¢å  -i éé¡¹æ¥äº¤äºå¼å°è¿è¡ååºã å¿é¡»æå®æ³è¦éåå¤ä¹è¿çåå²ï¼è¿å¯ä»¥éè¿åè¯å½ä»¤å°è¦ååºå°çæäº¤æ¥åå°ã\n\nä¾å¦ï¼å¦ææ³è¦ä¿®æ¹æè¿ä¸æ¬¡æäº¤ä¿¡æ¯ï¼æèé£ç»æäº¤ä¸­çä»»æä¸ä¸ªæäº¤ä¿¡æ¯ï¼ å°æ³è¦ä¿®æ¹çæè¿ä¸æ¬¡æäº¤çç¶æäº¤ä½ä¸ºåæ°ä¼ éç» git rebase -i å½ä»¤ï¼å³ HEAD~2^ æ HEAD~3ã è®°ä½ ~3 å¯è½æ¯è¾å®¹æï¼å ä¸ºä½ æ­£å°è¯ä¿®æ¹æåä¸æ¬¡æäº¤ï¼ä½æ¯æ³¨æå®éä¸æå®äºä»¥åçåæ¬¡æäº¤ï¼å³æ³è¦ä¿®æ¹æäº¤çç¶æäº¤ï¼\n\n$ git rebase -i HEAD~3\n\n\n1\n\n\nåæ¬¡è®°ä½è¿æ¯ä¸ä¸ªååºå½ä»¤ââå¨ HEAD~3..HEAD èå´åçæ¯ä¸ä¸ªä¿®æ¹äºæäº¤ä¿¡æ¯çæäº¤åå¶ ææåè£ é½ä¼è¢«éåã ä¸è¦æ¶åä»»ä½å·²ç»æ¨éå°ä¸­å¤®æå¡å¨çæäº¤ââè¿æ ·åä¼äº§çä¸æ¬¡åæ´çä¸¤ä¸ªçæ¬ï¼å èä½¿ä»äººå°æã\n\nè¿è¡è¿ä¸ªå½ä»¤ä¼å¨ææ¬ç¼è¾å¨ä¸ç»ä½ ä¸ä¸ªæäº¤çåè¡¨ï¼çèµ·æ¥åä¸é¢è¿æ ·ï¼\n\npick f7f3f6d changed my name a bit\npick 310154e updated README formatting and added blame\npick a5f4a0d added cat-file\n\n# Rebase 710f0f8..a5f4a0d onto 710f0f8\n#\n# Commands:\n# p, pick <commit> = use commit\n# r, reword <commit> = use commit, but edit the commit message\n# e, edit <commit> = use commit, but stop for amending\n# s, squash <commit> = use commit, but meld into previous commit\n# f, fixup <commit> = like \"squash\", but discard this commit's log message\n# x, exec <command> = run command (the rest of the line) using shell\n# b, break = stop here (continue rebase later with 'git rebase --continue')\n# d, drop <commit> = remove commit\n# l, label <label> = label current HEAD with a name\n# t, reset <label> = reset HEAD to a label\n# m, merge [-C <commit> | -c <commit>] <label> [# <oneline>]\n# .       create a merge commit using the original merge commit's\n# .       message (or the oneline, if no original merge commit was\n# .       specified). Use -c <commit> to reword the commit message.\n#\n# These lines can be re-ordered; they are executed from top to bottom.\n#\n# If you remove a line here THAT COMMIT WILL BE LOST.\n#\n# However, if you remove everything, the rebase will be aborted.\n#\n# Note that empty commits are commented out\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\néè¦éç¹æ³¨æçæ¯ç¸å¯¹äºæ­£å¸¸ä½¿ç¨ç log å½ä»¤ï¼è¿äºæäº¤æ¾ç¤ºçé¡ºåºæ¯ç¸åçã è¿è¡ä¸æ¬¡ log å½ä»¤ï¼ä¼çå°ç±»ä¼¼è¿æ ·çä¸è¥¿ï¼\n\n$ git log --pretty=format:\"%h %s\" HEAD~3..HEAD\na5f4a0d added cat-file\n310154e updated README formatting and added blame\nf7f3f6d changed my name a bit\n\n\n1\n2\n3\n4\n\n\næ³¨æå¶ä¸­çååºæ¾ç¤ºã äº¤äºå¼ååºç»ä½ ä¸ä¸ªå®å°ä¼è¿è¡çèæ¬ã å®å°ä¼ä»ä½ å¨å½ä»¤è¡ä¸­æå®çæäº¤ï¼HEAD~3ï¼å¼å§ï¼ä»ä¸å°ä¸çä¾æ¬¡éæ¼æ¯ä¸ä¸ªæäº¤å¼å¥çä¿®æ¹ã å®å°ææ§çèä¸æ¯ææ°çåå¨ä¸é¢ï¼å ä¸ºé£ä¼æ¯ç¬¬ä¸ä¸ªå°è¦éæ¼çã\n\nä½ éè¦ä¿®æ¹èæ¬æ¥è®©å®åçå¨ä½ æ³ä¿®æ¹çåæ´ä¸ã è¦è¾¾å°è¿ä¸ªç®çï¼ä½ åªè¦å°ä½ æ³ä¿®æ¹çæ¯ä¸æ¬¡æäº¤åé¢ç âpickâ æ¹ä¸º âeditâã ä¾å¦ï¼åªæ³ä¿®æ¹ç¬¬ä¸æ¬¡æäº¤ä¿¡æ¯ï¼å¯ä»¥åä¸é¢è¿æ ·ä¿®æ¹æä»¶ï¼\n\nedit f7f3f6d changed my name a bit\npick 310154e updated README formatting and added blame\npick a5f4a0d added cat-file\n\n\n1\n2\n3\n\n\nå½ä¿å­å¹¶éåºç¼è¾å¨æ¶ï¼Git å°ä½ å¸¦åå°åè¡¨ä¸­çæåä¸æ¬¡æäº¤ï¼æä½ éåå½ä»¤è¡å¹¶æç¤ºä»¥ä¸ä¿¡æ¯ï¼\n\n$ git rebase -i HEAD~3\nStopped at f7f3f6d... changed my name a bit\nYou can amend the commit now, with\n\n       git commit --amend\n\nOnce you're satisfied with your changes, run\n\n       git rebase --continue\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nè¿äºæä»¤åç¡®å°åè¯ä½ è¯¥åä»ä¹ã è¾å¥\n\n$ git commit --amend\n\n\n1\n\n\nä¿®æ¹æäº¤ä¿¡æ¯ï¼ç¶åéåºç¼è¾å¨ã ç¶åï¼è¿è¡\n\n$ git rebase --continue\n\n\n1\n\n\nè¿ä¸ªå½ä»¤å°ä¼èªå¨å°åºç¨å¦å¤ä¸¤ä¸ªæäº¤ï¼ç¶åå°±å®æäºã å¦æéè¦å°ä¸æ­¢ä¸å¤ç pick æ¹ä¸º editï¼éè¦å¨æ¯ä¸ä¸ªä¿®æ¹ä¸º edit çæäº¤ä¸éå¤è¿äºæ­¥éª¤ã æ¯ä¸æ¬¡ï¼Git å°ä¼åæ­¢ï¼è®©ä½ ä¿®æ­£æäº¤ï¼ç¶åç»§ç»­ç´å°å®æã\n\n\n# éæ°æåºæäº¤\n\nä¹å¯ä»¥ä½¿ç¨äº¤äºå¼ååºæ¥éæ°æåºæå®å¨ç§»é¤æäº¤ã å¦ææ³è¦ç§»é¤ âadded cat-fileâ æäº¤ç¶åä¿®æ¹å¦å¤ä¸¤ä¸ªæäº¤å¼å¥çé¡ºåºï¼å¯ä»¥å°ååºèæ¬ä»è¿æ ·ï¼\n\npick f7f3f6d changed my name a bit\npick 310154e updated README formatting and added blame\npick a5f4a0d added cat-file\n\n\n1\n2\n3\n\n\næ¹ä¸ºè¿æ ·ï¼\n\npick 310154e updated README formatting and added blame\npick f7f3f6d changed my name a bit\n\n\n1\n2\n\n\nå½ä¿å­å¹¶éåºç¼è¾å¨æ¶ï¼Git å°ä½ çåæ¯å¸¦åè¿äºæäº¤çç¶æäº¤ï¼åºç¨ 310154e ç¶ååºç¨ f7f3f6dï¼æååæ­¢ã äºå®ä¿®æ¹äºé£äºæäº¤çé¡ºåºå¹¶å®å¨å°ç§»é¤äº âadded cat-fileâ æäº¤ã\n\n\n# åç¼©æäº¤\n\néè¿äº¤äºå¼ååºå·¥å·ï¼ä¹å¯ä»¥å°ä¸è¿ä¸²æäº¤åç¼©æä¸ä¸ªåç¬çæäº¤ã å¨ååºä¿¡æ¯ä¸­èæ¬ç»åºäºæç¨çæä»¤ï¼\n\n#\n# Commands:\n# p, pick <commit> = use commit\n# r, reword <commit> = use commit, but edit the commit message\n# e, edit <commit> = use commit, but stop for amending\n# s, squash <commit> = use commit, but meld into previous commit\n# f, fixup <commit> = like \"squash\", but discard this commit's log message\n# x, exec <command> = run command (the rest of the line) using shell\n# b, break = stop here (continue rebase later with 'git rebase --continue')\n# d, drop <commit> = remove commit\n# l, label <label> = label current HEAD with a name\n# t, reset <label> = reset HEAD to a label\n# m, merge [-C <commit> | -c <commit>] <label> [# <oneline>]\n# .       create a merge commit using the original merge commit's\n# .       message (or the oneline, if no original merge commit was\n# .       specified). Use -c <commit> to reword the commit message.\n#\n# These lines can be re-ordered; they are executed from top to bottom.\n#\n# If you remove a line here THAT COMMIT WILL BE LOST.\n#\n# However, if you remove everything, the rebase will be aborted.\n#\n# Note that empty commits are commented out\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nå¦æï¼æå® âsquashâ èä¸æ¯ âpickâ æ âeditâï¼Git å°åºç¨ä¸¤èçä¿®æ¹å¹¶åå¹¶æäº¤ä¿¡æ¯å¨ä¸èµ·ã æä»¥ï¼å¦ææ³è¦è¿ä¸æ¬¡æäº¤åä¸ºä¸ä¸ªæäº¤ï¼å¯ä»¥è¿æ ·ä¿®æ¹èæ¬ï¼\n\npick f7f3f6d changed my name a bit\nsquash 310154e updated README formatting and added blame\nsquash a5f4a0d added cat-file\n\n\n1\n2\n3\n\n\nå½ä¿å­å¹¶éåºç¼è¾å¨æ¶ï¼Git åºç¨ææçä¸æ¬¡ä¿®æ¹ç¶åå°ä½ æ¾å°ç¼è¾å¨ä¸­æ¥åå¹¶ä¸æ¬¡æäº¤ä¿¡æ¯ï¼\n\n# This is a combination of 3 commits.\n# The first commit's message is:\nchanged my name a bit\n\n# This is the 2nd commit message:\n\nupdated README formatting and added blame\n\n# This is the 3rd commit message:\n\nadded cat-file\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå½ä½ ä¿å­ä¹åï¼ä½ å°±æ¥æäºä¸ä¸ªåå«åä¸æ¬¡æäº¤çå¨é¨åæ´çæäº¤ã\n\n\n# æåæäº¤\n\næåä¸ä¸ªæäº¤ä¼æ¤æ¶è¿ä¸ªæäº¤ï¼ç¶åå¤æ¬¡å°é¨åå°æå­ä¸æäº¤ç´å°å®æä½ æéæ¬¡æ°çæäº¤ã ä¾å¦ï¼åè®¾æ³è¦æåä¸æ¬¡æäº¤çä¸­é´é£æ¬¡æäº¤ã æ³è¦å°å®æåä¸ºä¸¤æ¬¡æäº¤ï¼ç¬¬ä¸ä¸ª âupdated README formattingâï¼ç¬¬äºä¸ª âadded blameâ æ¥ä»£æ¿åæ¥ç âupdated README formatting and added blameâã å¯ä»¥éè¿ä¿®æ¹ rebase -i çèæ¬æ¥åå°è¿ç¹ï¼å°è¦æåçæäº¤çæä»¤ä¿®æ¹ä¸º âeditâï¼\n\npick f7f3f6d changed my name a bit\nedit 310154e updated README formatting and added blame\npick a5f4a0d added cat-file\n\n\n1\n2\n3\n\n\nç¶åï¼å½èæ¬å¸¦ä½ è¿å¥å°å½ä»¤è¡æ¶ï¼éç½®é£ä¸ªæäº¤ï¼æ¿å°è¢«éç½®çä¿®æ¹ï¼ä»ä¸­åå»ºå æ¬¡æäº¤ã å½ä¿å­å¹¶éåºç¼è¾å¨æ¶ï¼Git å¸¦ä½ å°åè¡¨ä¸­ç¬¬ä¸ä¸ªæäº¤çç¶æäº¤ï¼åºç¨ç¬¬ä¸ä¸ªæäº¤ï¼f7f3f6dï¼ï¼ åºç¨ç¬¬äºä¸ªæäº¤ï¼310154eï¼ï¼ç¶åè®©ä½ è¿å¥å½ä»¤è¡ã é£éï¼å¯ä»¥éè¿ git reset HEAD^ åä¸æ¬¡éå¯¹é£ä¸ªæäº¤çæ··åéç½®ï¼å®éä¸å°ä¼æ¤æ¶é£æ¬¡æäº¤å¹¶å°ä¿®æ¹çæä»¶åæ¶æå­ã ç°å¨å¯ä»¥æå­å¹¶æäº¤æä»¶ç´å°æå ä¸ªæäº¤ï¼ç¶åå½å®ææ¶è¿è¡ git rebase --continueï¼\n\n$ git reset HEAD^\n$ git add README\n$ git commit -m 'updated README formatting'\n$ git add lib/simplegit.rb\n$ git commit -m 'added blame'\n$ git rebase --continue\n\n\n1\n2\n3\n4\n5\n6\n\n\nGit å¨èæ¬ä¸­åºç¨æåä¸æ¬¡æäº¤ï¼a5f4a0dï¼ï¼åå²è®°å½çèµ·æ¥åè¿æ ·ï¼\n\n$ git log -4 --pretty=format:\"%h %s\"\n1c002dd added cat-file\n9b29157 added blame\n35cfb2b updated README formatting\nf3cc40e changed my name a bit\n\n\n1\n2\n3\n4\n5\n\n\nåæ¬¡å¼ºè°ï¼è¿äºæ¹å¨äºææå¨åè¡¨ä¸­çæäº¤ç SHA-1 æ ¡éªåï¼æä»¥è¦ç¡®ä¿åè¡¨ä¸­çæäº¤è¿æ²¡ææ¨éå°å±äº«ä»åºä¸­ã\n\n\n# æ ¸æ­¦å¨çº§éé¡¹ï¼filter-branch\n\næå¦ä¸ä¸ªåå²æ¹åçéé¡¹ï¼å¦ææ³è¦éè¿èæ¬çæ¹å¼æ¹åå¤§éæäº¤çè¯å¯ä»¥ä½¿ç¨å®ââä¾å¦ï¼å¨å±ä¿®æ¹ä½ çé®ç®±å°åæä»æ¯ä¸ä¸ªæäº¤ä¸­ç§»é¤ä¸ä¸ªæä»¶ã è¿ä¸ªå½ä»¤æ¯ filter-branchï¼å®å¯ä»¥æ¹ååå²ä¸­å¤§éçæäº¤ï¼é¤éä½ çé¡¹ç®è¿æ²¡æå¬å¼å¹¶ä¸å¶ä»äººæ²¡æåºäºè¦æ¹åçå·¥ä½çæäº¤åçå·¥ä½ï¼å¦åä½ ä¸åºå½ä½¿ç¨å®ã ç¶èï¼å®å¯ä»¥å¾æç¨ã ä½ å°ä¼å­¦ä¹ å°å ä¸ªå¸¸ç¨çç¨éï¼è¿æ ·å°±å¾å°äºå®éåä½¿ç¨å°æ¹çæ³æ³ã\n\nCAUTION   GIT FILTER-BRANCH æå¾å¤é·é±ï¼ä¸åæ¨èä½¿ç¨å®æ¥éååå²ã è¯·èèä½¿ç¨\n          GIT-FILTER-REPOï¼å®æ¯ä¸ä¸ª PYTHON èæ¬ï¼ç¸æ¯å¤§å¤æ°ä½¿ç¨ FILTER-BRANCH\n          çåºç¨æ¥è¯´ï¼å®åå¾è¦æ´å¥½ãå®çææ¡£åæºç å¯è®¿é®\n          HTTPS://GITHUB.COM/NEWREN/GIT-FILTER-REPO è·åã\n          \n\n\n# ä»æ¯ä¸ä¸ªæäº¤ä¸­ç§»é¤ä¸ä¸ªæä»¶\n\nè¿ç»å¸¸åçã æäººç²å¿å°éè¿ git add . æäº¤äºä¸ä¸ªå·¨å¤§çäºè¿å¶æä»¶ï¼ä½ æ³è¦ä»ææå°æ¹å é¤ã å¯è½å¶ç¶å°æäº¤äºä¸ä¸ªåæ¬ä¸ä¸ªå¯ç çæä»¶ï¼ç¶èä½ æ³è¦å¼æºé¡¹ç®ã filter-branch æ¯ä¸ä¸ªå¯è½ä¼ç¨æ¥æ¦æ´æ´ä¸ªæäº¤åå²çå·¥å·ã ä¸ºäºä»æ´ä¸ªæäº¤åå²ä¸­ç§»é¤ä¸ä¸ªå«å passwords.txt çæä»¶ï¼å¯ä»¥ä½¿ç¨ --tree-filter éé¡¹ç» filter-branchï¼\n\n$ git filter-branch --tree-filter 'rm -f passwords.txt' HEAD\nRewrite 6b9b3cf04e7c5686a9cb838c3f36a8cb6a0fc2bd (21/21)\nRef 'refs/heads/master' was rewritten\n\n\n1\n2\n3\n\n\n--tree-filter éé¡¹å¨æ£åºé¡¹ç®çæ¯ä¸ä¸ªæäº¤åè¿è¡æå®çå½ä»¤ç¶åéæ°æäº¤ç»æã å¨æ¬ä¾ä¸­ï¼ä½ ä»æ¯ä¸ä¸ªå¿«ç§ä¸­ç§»é¤äºä¸ä¸ªå«ä½ passwords.txt çæä»¶ï¼æ è®ºå®æ¯å¦å­å¨ã å¦ææ³è¦ç§»é¤ææå¶ç¶æäº¤çç¼è¾å¨å¤ä»½æä»¶ï¼å¯ä»¥è¿è¡ç±»ä¼¼ git filter-branch --tree-filter 'rm -f *~' HEAD çå½ä»¤ã\n\næåå°å¯ä»¥çå° Git éåæ ä¸æäº¤ç¶åç§»å¨åæ¯æéã éå¸¸ä¸ä¸ªå¥½çæ³æ³æ¯å¨ä¸ä¸ªæµè¯åæ¯ä¸­åè¿ä»¶äºï¼ç¶åå½ä½ å³å®æç»ç»ææ¯çæ­£æ³è¦çï¼å¯ä»¥ç¡¬éç½® master åæ¯ã ä¸ºäºè®© filter-branch å¨ææåæ¯ä¸è¿è¡ï¼å¯ä»¥ç»å½ä»¤ä¼ é --all éé¡¹ã\n\n\n# ä½¿ä¸ä¸ªå­ç®å½åä¸ºæ°çæ ¹ç®å½\n\nåè®¾å·²ç»ä»å¦ä¸ä¸ªæºä»£ç æ§å¶ç³»ç»ä¸­å¯¼å¥ï¼å¹¶ä¸æå ä¸ªæ²¡æä¹çå­ç®å½ï¼trunkãtags ç­ç­ï¼ã å¦ææ³è¦è®© trunk å­ç®å½ä½ä¸ºæ¯ä¸ä¸ªæäº¤çæ°çé¡¹ç®æ ¹ç®å½ï¼filter-branch ä¹å¯ä»¥å¸®å©ä½ é£ä¹åï¼\n\n$ git filter-branch --subdirectory-filter trunk HEAD\nRewrite 856f0bf61e41a27326cdae8f09fe708d679f596f (12/12)\nRef 'refs/heads/master' was rewritten\n\n\n1\n2\n3\n\n\nç°å¨æ°é¡¹ç®æ ¹ç®å½æ¯ trunk å­ç®å½äºã Git ä¼èªå¨ç§»é¤ææä¸å½±åå­ç®å½çæäº¤ã\n\n\n# å¨å±ä¿®æ¹é®ç®±å°å\n\nå¦ä¸ä¸ªå¸¸è§çæå½¢æ¯å¨ä½ å¼å§å·¥ä½æ¶å¿è®°è¿è¡ git config æ¥è®¾ç½®ä½ çåå­ä¸é®ç®±å°åï¼ æèä½ æ³è¦å¼æºä¸ä¸ªé¡¹ç®å¹¶ä¸ä¿®æ¹ææä½ çå·¥ä½é®ç®±å°åä¸ºä½ çä¸ªäººé®ç®±å°åã ä»»ä½æå½¢ä¸ï¼ä½ ä¹å¯ä»¥éè¿ filter-branch æ¥ä¸æ¬¡æ§ä¿®æ¹å¤ä¸ªæäº¤ä¸­çé®ç®±å°åã éè¦å°å¿çæ¯åªä¿®æ¹ä½ èªå·±çé®ç®±å°åï¼æä»¥ä½ ä½¿ç¨ --commit-filterï¼\n\n$ git filter-branch --commit-filter '\n        if [ \"$GIT_AUTHOR_EMAIL\" = \"schacon@localhost\" ];\n        then\n                GIT_AUTHOR_NAME=\"Scott Chacon\";\n                GIT_AUTHOR_EMAIL=\"schacon@example.com\";\n                git commit-tree \"$@\";\n        else\n                git commit-tree \"$@\";\n        fi' HEAD\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nè¿ä¼éåå¹¶éåæ¯ä¸ä¸ªæäº¤æ¥åå«ä½ çæ°é®ç®±å°åã å ä¸ºæäº¤åå«äºå®ä»¬ç¶æäº¤ç SHA-1 æ ¡éªåï¼è¿ä¸ªå½ä»¤ä¼ä¿®æ¹ä½ çåå²ä¸­çæ¯ä¸ä¸ªæäº¤ç SHA-1 æ ¡éªåï¼ èä¸ä»ä»åªæ¯é£äºå¹éé®ç®±å°åçæäº¤ã",normalizedContent:"# git å·¥å· - éååå²\n\nè®¸å¤æ¶åï¼å¨ä½¿ç¨ git æ¶ï¼ä½ å¯è½æ³è¦ä¿®è®¢æäº¤åå²ã git å¾æ£çä¸ç¹æ¯å®åè®¸ä½ å¨æåæ¶å»åå³å®ã ä½ å¯ä»¥å¨å°æå­åºåå®¹æäº¤åå³å®åªäºæä»¶è¿å¥æäº¤ï¼å¯ä»¥éè¿ git stash æ¥å³å®ä¸ä¸æäºåå®¹å·¥ä½ï¼ ä¹å¯ä»¥éåå·²ç»åççæäº¤å°±åå®ä»¬ä»¥å¦ä¸ç§æ¹å¼åççä¸æ ·ã è¿å¯è½æ¶åæ¹åæäº¤çé¡ºåºï¼æ¹åæäº¤ä¸­çä¿¡æ¯æä¿®æ¹æä»¶ï¼å°æäº¤åç¼©ææ¯æåï¼ æå®å¨å°ç§»é¤æäº¤ââå¨å°ä½ çå·¥ä½ææä¸ä»äººå±äº«ä¹åã\n\nå¨æ¬èä¸­ï¼ä½ å¯ä»¥å­¦å°å¦ä½å®æè¿äºå·¥ä½ï¼è¿æ ·å¨ä¸ä»äººåäº«ä½ çå·¥ä½æææ¶ä½ çæäº¤åå²å°å¦ä½ ææ¿å°å±ç¤ºåºæ¥ã\n\nnote   å¨æ»¡æä¹åä¸è¦æ¨éä½ çå·¥ä½git çåºæ¬ååä¹ä¸æ¯ï¼ç±äºåéä¸­æå¾å¤å·¥ä½æ¯æ¬å°çï¼å æ­¤ä½ å¯ä»¥ å¨æ¬å° éä¾¿éååå²è®°å½ã\n       ç¶èä¸æ¦æ¨éäºä½ çå·¥ä½ï¼é£å°±å®å¨æ¯å¦ä¸åäºäºï¼é¤éä½ æååççç±è¿è¡æ´æ¹ï¼å¦ååºè¯¥å°æ¨éçå·¥ä½è§ä¸ºæç»ç»æã\n       ç®èè¨ä¹ï¼å¨å¯¹å®æå°æ»¡æå¹¶åå¤ä¸ä»äººåäº«ä¹åï¼åºå½é¿åæ¨éä½ çå·¥ä½ã\n       \n\n\n# ä¿®æ¹æåä¸æ¬¡æäº¤\n\nä¿®æ¹ä½ æè¿ä¸æ¬¡æäº¤å¯è½æ¯ææä¿®æ¹åå²æäº¤çæä½ä¸­æå¸¸è§çä¸ä¸ªã å¯¹äºä½ çæè¿ä¸æ¬¡æäº¤ï¼ä½ å¾å¾æ³åä¸¤ä»¶äºæï¼ç®åå°ä¿®æ¹æäº¤ä¿¡æ¯ï¼ æèéè¿æ·»å ãç§»é¤æä¿®æ¹æä»¶æ¥æ´æ¹æäº¤å®éçåå®¹ã\n\n\n# ä¿®æ¹æäº¤ä¿¡æ¯\n\nå¦æï¼ä½ åªæ¯æ³ä¿®æ¹æè¿ä¸æ¬¡æäº¤çæäº¤ä¿¡æ¯ï¼é£ä¹å¾ç®åï¼\n\n$ git commit --amend\n\n\n1\n\n\nä¸é¢è¿æ¡å½ä»¤ä¼å°æåä¸æ¬¡çæäº¤ä¿¡æ¯è½½å¥å°ç¼è¾å¨ä¸­ä¾ä½ ä¿®æ¹ã å½ä¿å­å¹¶å³é­ç¼è¾å¨åï¼ç¼è¾å¨ä¼å°æ´æ°åçæäº¤ä¿¡æ¯åå¥æ°æäº¤ä¸­ï¼å®ä¼æä¸ºæ°çæåä¸æ¬¡æäº¤ã\n\n\n# ä¿®æ¹å®éåå®¹\n\nå¦ä¸æ¹é¢ï¼å¦æä½ æ³è¦ä¿®æ¹æåä¸æ¬¡æäº¤çå®éåå®¹ï¼é£ä¹æµç¨å¾ç¸ä¼¼ï¼é¦åä½åºä½ æ³è¦è¡¥ä¸çä¿®æ¹ï¼ æå­å®ä»¬ï¼ç¶åç¨ git commit --amend ä»¥æ°çæ¹è¿åçæäº¤æ¥ æ¿æ¢ ææ§æçæåä¸æ¬¡æäº¤ï¼\n\nä½¿ç¨è¿ä¸ªæå·§çæ¶åéè¦å°å¿ï¼å ä¸ºä¿®æ­£ä¼æ¹åæäº¤ç sha-1 æ ¡éªåã å®ç±»ä¼¼äºä¸ä¸ªå°çååºââå¦æå·²ç»æ¨éäºæåä¸æ¬¡æäº¤å°±ä¸è¦ä¿®æ­£å®ã\n\ntip   ä¿®è¡¥åçæäº¤å¯è½éè¦ä¿®è¡¥æäº¤ä¿¡æ¯å½ä½ å¨ä¿®è¡¥ä¸æ¬¡æäº¤æ¶ï¼å¯ä»¥åæ¶ä¿®æ¹æäº¤ä¿¡æ¯åæäº¤åå®¹ã\n      å¦æä½ ä¿®è¡¥äºæäº¤çåå®¹ï¼é£ä¹å ä¹è¯å®è¦æ´æ°æäº¤æ¶æ¯ä»¥åæ ä¿®æ¹åçåå®¹ãå¦ä¸æ¹é¢ï¼å¦æä½ çä¿®è¡¥æ¯çç¢çï¼å¦ä¿®æ¹äºä¸ä¸ªç¬è¯¯ææ·»å äºä¸ä¸ªå¿è®°æå­çæä»¶ï¼ï¼\n      é£ä¹ä¹åçæäº¤ä¿¡æ¯ä¸å¿ä¿®æ¹ï¼ä½ åªéä½åºæ´æ¹ï¼æå­å®ä»¬ï¼ç¶åéè¿ä»¥ä¸å½ä»¤é¿åä¸å¿è¦çç¼è¾å¨ç¯èå³å¯ï¼$ git\n      commit --amend --no-edit\n      \n\n\n# ä¿®æ¹å¤ä¸ªæäº¤ä¿¡æ¯\n\nä¸ºäºä¿®æ¹å¨æäº¤åå²ä¸­è¾è¿çæäº¤ï¼å¿é¡»ä½¿ç¨æ´å¤æçå·¥å·ã git æ²¡æä¸ä¸ªæ¹ååå²å·¥å·ï¼ä½æ¯å¯ä»¥ä½¿ç¨ååºå·¥å·æ¥ååºä¸ç³»åæäº¤ï¼åºäºå®ä»¬åæ¥ç head èä¸æ¯å°å¶ç§»å¨å°å¦ä¸ä¸ªæ°çä¸é¢ã éè¿äº¤äºå¼ååºå·¥å·ï¼å¯ä»¥å¨ä»»ä½æ³è¦ä¿®æ¹çæäº¤ååæ­¢ï¼ç¶åä¿®æ¹ä¿¡æ¯ãæ·»å æä»¶æåä»»ä½æ³åçäºæã å¯ä»¥éè¿ç» git rebase å¢å  -i éé¡¹æ¥äº¤äºå¼å°è¿è¡ååºã å¿é¡»æå®æ³è¦éåå¤ä¹è¿çåå²ï¼è¿å¯ä»¥éè¿åè¯å½ä»¤å°è¦ååºå°çæäº¤æ¥åå°ã\n\nä¾å¦ï¼å¦ææ³è¦ä¿®æ¹æè¿ä¸æ¬¡æäº¤ä¿¡æ¯ï¼æèé£ç»æäº¤ä¸­çä»»æä¸ä¸ªæäº¤ä¿¡æ¯ï¼ å°æ³è¦ä¿®æ¹çæè¿ä¸æ¬¡æäº¤çç¶æäº¤ä½ä¸ºåæ°ä¼ éç» git rebase -i å½ä»¤ï¼å³ head~2^ æ head~3ã è®°ä½ ~3 å¯è½æ¯è¾å®¹æï¼å ä¸ºä½ æ­£å°è¯ä¿®æ¹æåä¸æ¬¡æäº¤ï¼ä½æ¯æ³¨æå®éä¸æå®äºä»¥åçåæ¬¡æäº¤ï¼å³æ³è¦ä¿®æ¹æäº¤çç¶æäº¤ï¼\n\n$ git rebase -i head~3\n\n\n1\n\n\nåæ¬¡è®°ä½è¿æ¯ä¸ä¸ªååºå½ä»¤ââå¨ head~3..head èå´åçæ¯ä¸ä¸ªä¿®æ¹äºæäº¤ä¿¡æ¯çæäº¤åå¶ ææåè£ é½ä¼è¢«éåã ä¸è¦æ¶åä»»ä½å·²ç»æ¨éå°ä¸­å¤®æå¡å¨çæäº¤ââè¿æ ·åä¼äº§çä¸æ¬¡åæ´çä¸¤ä¸ªçæ¬ï¼å èä½¿ä»äººå°æã\n\nè¿è¡è¿ä¸ªå½ä»¤ä¼å¨ææ¬ç¼è¾å¨ä¸ç»ä½ ä¸ä¸ªæäº¤çåè¡¨ï¼çèµ·æ¥åä¸é¢è¿æ ·ï¼\n\npick f7f3f6d changed my name a bit\npick 310154e updated readme formatting and added blame\npick a5f4a0d added cat-file\n\n# rebase 710f0f8..a5f4a0d onto 710f0f8\n#\n# commands:\n# p, pick <commit> = use commit\n# r, reword <commit> = use commit, but edit the commit message\n# e, edit <commit> = use commit, but stop for amending\n# s, squash <commit> = use commit, but meld into previous commit\n# f, fixup <commit> = like \"squash\", but discard this commit's log message\n# x, exec <command> = run command (the rest of the line) using shell\n# b, break = stop here (continue rebase later with 'git rebase --continue')\n# d, drop <commit> = remove commit\n# l, label <label> = label current head with a name\n# t, reset <label> = reset head to a label\n# m, merge [-c <commit> | -c <commit>] <label> [# <oneline>]\n# .       create a merge commit using the original merge commit's\n# .       message (or the oneline, if no original merge commit was\n# .       specified). use -c <commit> to reword the commit message.\n#\n# these lines can be re-ordered; they are executed from top to bottom.\n#\n# if you remove a line here that commit will be lost.\n#\n# however, if you remove everything, the rebase will be aborted.\n#\n# note that empty commits are commented out\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\néè¦éç¹æ³¨æçæ¯ç¸å¯¹äºæ­£å¸¸ä½¿ç¨ç log å½ä»¤ï¼è¿äºæäº¤æ¾ç¤ºçé¡ºåºæ¯ç¸åçã è¿è¡ä¸æ¬¡ log å½ä»¤ï¼ä¼çå°ç±»ä¼¼è¿æ ·çä¸è¥¿ï¼\n\n$ git log --pretty=format:\"%h %s\" head~3..head\na5f4a0d added cat-file\n310154e updated readme formatting and added blame\nf7f3f6d changed my name a bit\n\n\n1\n2\n3\n4\n\n\næ³¨æå¶ä¸­çååºæ¾ç¤ºã äº¤äºå¼ååºç»ä½ ä¸ä¸ªå®å°ä¼è¿è¡çèæ¬ã å®å°ä¼ä»ä½ å¨å½ä»¤è¡ä¸­æå®çæäº¤ï¼head~3ï¼å¼å§ï¼ä»ä¸å°ä¸çä¾æ¬¡éæ¼æ¯ä¸ä¸ªæäº¤å¼å¥çä¿®æ¹ã å®å°ææ§çèä¸æ¯ææ°çåå¨ä¸é¢ï¼å ä¸ºé£ä¼æ¯ç¬¬ä¸ä¸ªå°è¦éæ¼çã\n\nä½ éè¦ä¿®æ¹èæ¬æ¥è®©å®åçå¨ä½ æ³ä¿®æ¹çåæ´ä¸ã è¦è¾¾å°è¿ä¸ªç®çï¼ä½ åªè¦å°ä½ æ³ä¿®æ¹çæ¯ä¸æ¬¡æäº¤åé¢ç âpickâ æ¹ä¸º âeditâã ä¾å¦ï¼åªæ³ä¿®æ¹ç¬¬ä¸æ¬¡æäº¤ä¿¡æ¯ï¼å¯ä»¥åä¸é¢è¿æ ·ä¿®æ¹æä»¶ï¼\n\nedit f7f3f6d changed my name a bit\npick 310154e updated readme formatting and added blame\npick a5f4a0d added cat-file\n\n\n1\n2\n3\n\n\nå½ä¿å­å¹¶éåºç¼è¾å¨æ¶ï¼git å°ä½ å¸¦åå°åè¡¨ä¸­çæåä¸æ¬¡æäº¤ï¼æä½ éåå½ä»¤è¡å¹¶æç¤ºä»¥ä¸ä¿¡æ¯ï¼\n\n$ git rebase -i head~3\nstopped at f7f3f6d... changed my name a bit\nyou can amend the commit now, with\n\n       git commit --amend\n\nonce you're satisfied with your changes, run\n\n       git rebase --continue\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nè¿äºæä»¤åç¡®å°åè¯ä½ è¯¥åä»ä¹ã è¾å¥\n\n$ git commit --amend\n\n\n1\n\n\nä¿®æ¹æäº¤ä¿¡æ¯ï¼ç¶åéåºç¼è¾å¨ã ç¶åï¼è¿è¡\n\n$ git rebase --continue\n\n\n1\n\n\nè¿ä¸ªå½ä»¤å°ä¼èªå¨å°åºç¨å¦å¤ä¸¤ä¸ªæäº¤ï¼ç¶åå°±å®æäºã å¦æéè¦å°ä¸æ­¢ä¸å¤ç pick æ¹ä¸º editï¼éè¦å¨æ¯ä¸ä¸ªä¿®æ¹ä¸º edit çæäº¤ä¸éå¤è¿äºæ­¥éª¤ã æ¯ä¸æ¬¡ï¼git å°ä¼åæ­¢ï¼è®©ä½ ä¿®æ­£æäº¤ï¼ç¶åç»§ç»­ç´å°å®æã\n\n\n# éæ°æåºæäº¤\n\nä¹å¯ä»¥ä½¿ç¨äº¤äºå¼ååºæ¥éæ°æåºæå®å¨ç§»é¤æäº¤ã å¦ææ³è¦ç§»é¤ âadded cat-fileâ æäº¤ç¶åä¿®æ¹å¦å¤ä¸¤ä¸ªæäº¤å¼å¥çé¡ºåºï¼å¯ä»¥å°ååºèæ¬ä»è¿æ ·ï¼\n\npick f7f3f6d changed my name a bit\npick 310154e updated readme formatting and added blame\npick a5f4a0d added cat-file\n\n\n1\n2\n3\n\n\næ¹ä¸ºè¿æ ·ï¼\n\npick 310154e updated readme formatting and added blame\npick f7f3f6d changed my name a bit\n\n\n1\n2\n\n\nå½ä¿å­å¹¶éåºç¼è¾å¨æ¶ï¼git å°ä½ çåæ¯å¸¦åè¿äºæäº¤çç¶æäº¤ï¼åºç¨ 310154e ç¶ååºç¨ f7f3f6dï¼æååæ­¢ã äºå®ä¿®æ¹äºé£äºæäº¤çé¡ºåºå¹¶å®å¨å°ç§»é¤äº âadded cat-fileâ æäº¤ã\n\n\n# åç¼©æäº¤\n\néè¿äº¤äºå¼ååºå·¥å·ï¼ä¹å¯ä»¥å°ä¸è¿ä¸²æäº¤åç¼©æä¸ä¸ªåç¬çæäº¤ã å¨ååºä¿¡æ¯ä¸­èæ¬ç»åºäºæç¨çæä»¤ï¼\n\n#\n# commands:\n# p, pick <commit> = use commit\n# r, reword <commit> = use commit, but edit the commit message\n# e, edit <commit> = use commit, but stop for amending\n# s, squash <commit> = use commit, but meld into previous commit\n# f, fixup <commit> = like \"squash\", but discard this commit's log message\n# x, exec <command> = run command (the rest of the line) using shell\n# b, break = stop here (continue rebase later with 'git rebase --continue')\n# d, drop <commit> = remove commit\n# l, label <label> = label current head with a name\n# t, reset <label> = reset head to a label\n# m, merge [-c <commit> | -c <commit>] <label> [# <oneline>]\n# .       create a merge commit using the original merge commit's\n# .       message (or the oneline, if no original merge commit was\n# .       specified). use -c <commit> to reword the commit message.\n#\n# these lines can be re-ordered; they are executed from top to bottom.\n#\n# if you remove a line here that commit will be lost.\n#\n# however, if you remove everything, the rebase will be aborted.\n#\n# note that empty commits are commented out\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nå¦æï¼æå® âsquashâ èä¸æ¯ âpickâ æ âeditâï¼git å°åºç¨ä¸¤èçä¿®æ¹å¹¶åå¹¶æäº¤ä¿¡æ¯å¨ä¸èµ·ã æä»¥ï¼å¦ææ³è¦è¿ä¸æ¬¡æäº¤åä¸ºä¸ä¸ªæäº¤ï¼å¯ä»¥è¿æ ·ä¿®æ¹èæ¬ï¼\n\npick f7f3f6d changed my name a bit\nsquash 310154e updated readme formatting and added blame\nsquash a5f4a0d added cat-file\n\n\n1\n2\n3\n\n\nå½ä¿å­å¹¶éåºç¼è¾å¨æ¶ï¼git åºç¨ææçä¸æ¬¡ä¿®æ¹ç¶åå°ä½ æ¾å°ç¼è¾å¨ä¸­æ¥åå¹¶ä¸æ¬¡æäº¤ä¿¡æ¯ï¼\n\n# this is a combination of 3 commits.\n# the first commit's message is:\nchanged my name a bit\n\n# this is the 2nd commit message:\n\nupdated readme formatting and added blame\n\n# this is the 3rd commit message:\n\nadded cat-file\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå½ä½ ä¿å­ä¹åï¼ä½ å°±æ¥æäºä¸ä¸ªåå«åä¸æ¬¡æäº¤çå¨é¨åæ´çæäº¤ã\n\n\n# æåæäº¤\n\næåä¸ä¸ªæäº¤ä¼æ¤æ¶è¿ä¸ªæäº¤ï¼ç¶åå¤æ¬¡å°é¨åå°æå­ä¸æäº¤ç´å°å®æä½ æéæ¬¡æ°çæäº¤ã ä¾å¦ï¼åè®¾æ³è¦æåä¸æ¬¡æäº¤çä¸­é´é£æ¬¡æäº¤ã æ³è¦å°å®æåä¸ºä¸¤æ¬¡æäº¤ï¼ç¬¬ä¸ä¸ª âupdated readme formattingâï¼ç¬¬äºä¸ª âadded blameâ æ¥ä»£æ¿åæ¥ç âupdated readme formatting and added blameâã å¯ä»¥éè¿ä¿®æ¹ rebase -i çèæ¬æ¥åå°è¿ç¹ï¼å°è¦æåçæäº¤çæä»¤ä¿®æ¹ä¸º âeditâï¼\n\npick f7f3f6d changed my name a bit\nedit 310154e updated readme formatting and added blame\npick a5f4a0d added cat-file\n\n\n1\n2\n3\n\n\nç¶åï¼å½èæ¬å¸¦ä½ è¿å¥å°å½ä»¤è¡æ¶ï¼éç½®é£ä¸ªæäº¤ï¼æ¿å°è¢«éç½®çä¿®æ¹ï¼ä»ä¸­åå»ºå æ¬¡æäº¤ã å½ä¿å­å¹¶éåºç¼è¾å¨æ¶ï¼git å¸¦ä½ å°åè¡¨ä¸­ç¬¬ä¸ä¸ªæäº¤çç¶æäº¤ï¼åºç¨ç¬¬ä¸ä¸ªæäº¤ï¼f7f3f6dï¼ï¼ åºç¨ç¬¬äºä¸ªæäº¤ï¼310154eï¼ï¼ç¶åè®©ä½ è¿å¥å½ä»¤è¡ã é£éï¼å¯ä»¥éè¿ git reset head^ åä¸æ¬¡éå¯¹é£ä¸ªæäº¤çæ··åéç½®ï¼å®éä¸å°ä¼æ¤æ¶é£æ¬¡æäº¤å¹¶å°ä¿®æ¹çæä»¶åæ¶æå­ã ç°å¨å¯ä»¥æå­å¹¶æäº¤æä»¶ç´å°æå ä¸ªæäº¤ï¼ç¶åå½å®ææ¶è¿è¡ git rebase --continueï¼\n\n$ git reset head^\n$ git add readme\n$ git commit -m 'updated readme formatting'\n$ git add lib/simplegit.rb\n$ git commit -m 'added blame'\n$ git rebase --continue\n\n\n1\n2\n3\n4\n5\n6\n\n\ngit å¨èæ¬ä¸­åºç¨æåä¸æ¬¡æäº¤ï¼a5f4a0dï¼ï¼åå²è®°å½çèµ·æ¥åè¿æ ·ï¼\n\n$ git log -4 --pretty=format:\"%h %s\"\n1c002dd added cat-file\n9b29157 added blame\n35cfb2b updated readme formatting\nf3cc40e changed my name a bit\n\n\n1\n2\n3\n4\n5\n\n\nåæ¬¡å¼ºè°ï¼è¿äºæ¹å¨äºææå¨åè¡¨ä¸­çæäº¤ç sha-1 æ ¡éªåï¼æä»¥è¦ç¡®ä¿åè¡¨ä¸­çæäº¤è¿æ²¡ææ¨éå°å±äº«ä»åºä¸­ã\n\n\n# æ ¸æ­¦å¨çº§éé¡¹ï¼filter-branch\n\næå¦ä¸ä¸ªåå²æ¹åçéé¡¹ï¼å¦ææ³è¦éè¿èæ¬çæ¹å¼æ¹åå¤§éæäº¤çè¯å¯ä»¥ä½¿ç¨å®ââä¾å¦ï¼å¨å±ä¿®æ¹ä½ çé®ç®±å°åæä»æ¯ä¸ä¸ªæäº¤ä¸­ç§»é¤ä¸ä¸ªæä»¶ã è¿ä¸ªå½ä»¤æ¯ filter-branchï¼å®å¯ä»¥æ¹ååå²ä¸­å¤§éçæäº¤ï¼é¤éä½ çé¡¹ç®è¿æ²¡æå¬å¼å¹¶ä¸å¶ä»äººæ²¡æåºäºè¦æ¹åçå·¥ä½çæäº¤åçå·¥ä½ï¼å¦åä½ ä¸åºå½ä½¿ç¨å®ã ç¶èï¼å®å¯ä»¥å¾æç¨ã ä½ å°ä¼å­¦ä¹ å°å ä¸ªå¸¸ç¨çç¨éï¼è¿æ ·å°±å¾å°äºå®éåä½¿ç¨å°æ¹çæ³æ³ã\n\ncaution   git filter-branch æå¾å¤é·é±ï¼ä¸åæ¨èä½¿ç¨å®æ¥éååå²ã è¯·èèä½¿ç¨\n          git-filter-repoï¼å®æ¯ä¸ä¸ª python èæ¬ï¼ç¸æ¯å¤§å¤æ°ä½¿ç¨ filter-branch\n          çåºç¨æ¥è¯´ï¼å®åå¾è¦æ´å¥½ãå®çææ¡£åæºç å¯è®¿é®\n          https://github.com/newren/git-filter-repo è·åã\n          \n\n\n# ä»æ¯ä¸ä¸ªæäº¤ä¸­ç§»é¤ä¸ä¸ªæä»¶\n\nè¿ç»å¸¸åçã æäººç²å¿å°éè¿ git add . æäº¤äºä¸ä¸ªå·¨å¤§çäºè¿å¶æä»¶ï¼ä½ æ³è¦ä»ææå°æ¹å é¤ã å¯è½å¶ç¶å°æäº¤äºä¸ä¸ªåæ¬ä¸ä¸ªå¯ç çæä»¶ï¼ç¶èä½ æ³è¦å¼æºé¡¹ç®ã filter-branch æ¯ä¸ä¸ªå¯è½ä¼ç¨æ¥æ¦æ´æ´ä¸ªæäº¤åå²çå·¥å·ã ä¸ºäºä»æ´ä¸ªæäº¤åå²ä¸­ç§»é¤ä¸ä¸ªå«å passwords.txt çæä»¶ï¼å¯ä»¥ä½¿ç¨ --tree-filter éé¡¹ç» filter-branchï¼\n\n$ git filter-branch --tree-filter 'rm -f passwords.txt' head\nrewrite 6b9b3cf04e7c5686a9cb838c3f36a8cb6a0fc2bd (21/21)\nref 'refs/heads/master' was rewritten\n\n\n1\n2\n3\n\n\n--tree-filter éé¡¹å¨æ£åºé¡¹ç®çæ¯ä¸ä¸ªæäº¤åè¿è¡æå®çå½ä»¤ç¶åéæ°æäº¤ç»æã å¨æ¬ä¾ä¸­ï¼ä½ ä»æ¯ä¸ä¸ªå¿«ç§ä¸­ç§»é¤äºä¸ä¸ªå«ä½ passwords.txt çæä»¶ï¼æ è®ºå®æ¯å¦å­å¨ã å¦ææ³è¦ç§»é¤ææå¶ç¶æäº¤çç¼è¾å¨å¤ä»½æä»¶ï¼å¯ä»¥è¿è¡ç±»ä¼¼ git filter-branch --tree-filter 'rm -f *~' head çå½ä»¤ã\n\næåå°å¯ä»¥çå° git éåæ ä¸æäº¤ç¶åç§»å¨åæ¯æéã éå¸¸ä¸ä¸ªå¥½çæ³æ³æ¯å¨ä¸ä¸ªæµè¯åæ¯ä¸­åè¿ä»¶äºï¼ç¶åå½ä½ å³å®æç»ç»ææ¯çæ­£æ³è¦çï¼å¯ä»¥ç¡¬éç½® master åæ¯ã ä¸ºäºè®© filter-branch å¨ææåæ¯ä¸è¿è¡ï¼å¯ä»¥ç»å½ä»¤ä¼ é --all éé¡¹ã\n\n\n# ä½¿ä¸ä¸ªå­ç®å½åä¸ºæ°çæ ¹ç®å½\n\nåè®¾å·²ç»ä»å¦ä¸ä¸ªæºä»£ç æ§å¶ç³»ç»ä¸­å¯¼å¥ï¼å¹¶ä¸æå ä¸ªæ²¡æä¹çå­ç®å½ï¼trunkãtags ç­ç­ï¼ã å¦ææ³è¦è®© trunk å­ç®å½ä½ä¸ºæ¯ä¸ä¸ªæäº¤çæ°çé¡¹ç®æ ¹ç®å½ï¼filter-branch ä¹å¯ä»¥å¸®å©ä½ é£ä¹åï¼\n\n$ git filter-branch --subdirectory-filter trunk head\nrewrite 856f0bf61e41a27326cdae8f09fe708d679f596f (12/12)\nref 'refs/heads/master' was rewritten\n\n\n1\n2\n3\n\n\nç°å¨æ°é¡¹ç®æ ¹ç®å½æ¯ trunk å­ç®å½äºã git ä¼èªå¨ç§»é¤ææä¸å½±åå­ç®å½çæäº¤ã\n\n\n# å¨å±ä¿®æ¹é®ç®±å°å\n\nå¦ä¸ä¸ªå¸¸è§çæå½¢æ¯å¨ä½ å¼å§å·¥ä½æ¶å¿è®°è¿è¡ git config æ¥è®¾ç½®ä½ çåå­ä¸é®ç®±å°åï¼ æèä½ æ³è¦å¼æºä¸ä¸ªé¡¹ç®å¹¶ä¸ä¿®æ¹ææä½ çå·¥ä½é®ç®±å°åä¸ºä½ çä¸ªäººé®ç®±å°åã ä»»ä½æå½¢ä¸ï¼ä½ ä¹å¯ä»¥éè¿ filter-branch æ¥ä¸æ¬¡æ§ä¿®æ¹å¤ä¸ªæäº¤ä¸­çé®ç®±å°åã éè¦å°å¿çæ¯åªä¿®æ¹ä½ èªå·±çé®ç®±å°åï¼æä»¥ä½ ä½¿ç¨ --commit-filterï¼\n\n$ git filter-branch --commit-filter '\n        if [ \"$git_author_email\" = \"schacon@localhost\" ];\n        then\n                git_author_name=\"scott chacon\";\n                git_author_email=\"schacon@example.com\";\n                git commit-tree \"$@\";\n        else\n                git commit-tree \"$@\";\n        fi' head\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nè¿ä¼éåå¹¶éåæ¯ä¸ä¸ªæäº¤æ¥åå«ä½ çæ°é®ç®±å°åã å ä¸ºæäº¤åå«äºå®ä»¬ç¶æäº¤ç sha-1 æ ¡éªåï¼è¿ä¸ªå½ä»¤ä¼ä¿®æ¹ä½ çåå²ä¸­çæ¯ä¸ä¸ªæäº¤ç sha-1 æ ¡éªåï¼ èä¸ä»ä»åªæ¯é£äºå¹éé®ç®±å°åçæäº¤ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Gitåæ¯-åæ¯åç",frontmatter:{title:"Gitåæ¯-åæ¯åç",date:"2020-11-18T17:43:57.000Z",permalink:"/pages/4bef1a/",categories:["ãGitãå­¦ä¹ ç¬è®°"],tags:["Git"]},regularPath:"/%E3%80%8AGit%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20.%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/20.Git%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E5%8E%9F%E7%90%86.html",relativePath:"ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/20.Gitåæ¯-åæ¯åç.md",key:"v-59177494",path:"/pages/4bef1a/",headers:[{level:3,title:"é¦æ¬¡æäº¤",slug:"é¦æ¬¡æäº¤",normalizedTitle:"é¦æ¬¡æäº¤",charIndex:130},{level:3,title:"åæ¬¡æäº¤",slug:"åæ¬¡æäº¤",normalizedTitle:"åæ¬¡æäº¤",charIndex:823},{level:3,title:"Git çåæ¯",slug:"git-çåæ¯",normalizedTitle:"git çåæ¯",charIndex:896},{level:3,title:"åå»ºåæ¯",slug:"åå»ºåæ¯",normalizedTitle:"åå»ºåæ¯",charIndex:1088},{level:3,title:"å½ååæ¯çæé",slug:"å½ååæ¯çæé",normalizedTitle:"å½ååæ¯çæé",charIndex:1252},{level:3,title:"æ¥çå½åæå¨åæ¯",slug:"æ¥çå½åæå¨åæ¯",normalizedTitle:"æ¥çå½åæå¨åæ¯",charIndex:1432},{level:3,title:"åæ¯åæ¢",slug:"åæ¯åæ¢",normalizedTitle:"åæ¯åæ¢",charIndex:1771},{level:3,title:"åå»ºåæ¯åæ¶åæ¢",slug:"åå»ºåæ¯åæ¶åæ¢",normalizedTitle:"åå»ºåæ¯åæ¶åæ¢",charIndex:3223}],headersStr:"é¦æ¬¡æäº¤ åæ¬¡æäº¤ Git çåæ¯ åå»ºåæ¯ å½ååæ¯çæé æ¥çå½åæå¨åæ¯ åæ¯åæ¢ åå»ºåæ¯åæ¶åæ¢",content:"# Gitåæ¯-åæ¯åç\n\nGit å¤çåæ¯çæ¹å¼å¯è°æ¯é¾ä»¥ç½®ä¿¡çè½»éï¼åå»ºæ°åæ¯è¿ä¸æä½å ä¹è½å¨ç¬é´å®æï¼å¹¶ä¸å¨ä¸ååæ¯ä¹é´çåæ¢æä½ä¹æ¯ä¸æ ·ä¾¿æ·ã ä¸è®¸å¤å¶å®çæ¬æ§å¶ç³»ç»ä¸åï¼Git é¼å±å¨å·¥ä½æµç¨ä¸­é¢ç¹å°ä½¿ç¨åæ¯ä¸åå¹¶ï¼åªæä¸å¤©ä¹åè¿è¡è®¸å¤æ¬¡ã\n\n\n# é¦æ¬¡æäº¤\n\nå¨è¿è¡æäº¤æä½æ¶ï¼Git ä¼ä¿å­ä¸ä¸ªæäº¤å¯¹è±¡ï¼commit objectï¼ã\n\nåè®¾ç°å¨æä¸ä¸ªå·¥ä½ç®å½ï¼éé¢åå«äºä¸ä¸ªå°è¦è¢«æå­åæäº¤çæä»¶ã æå­æä½ä¼ä¸ºæ¯ä¸ä¸ªæä»¶è®¡ç®æ ¡éªåï¼ä½¿ç¨ SHA-1 åå¸ç®æ³ï¼ï¼ç¶åä¼æå½åçæ¬çæä»¶å¿«ç§ä¿å­å° Git ä»åºä¸­ ï¼Git ä½¿ç¨ blob å¯¹è±¡æ¥ä¿å­å®ä»¬ï¼ï¼æç»å°æ ¡éªåå å¥å°æå­åºåç­å¾æäº¤ï¼\n\n$ git add README test.rb LICENSE\n$ git commit -m 'The initial commit of my project'\n\n\n1\n2\n\n\nå½ä½¿ç¨ git commit è¿è¡æäº¤æä½æ¶ï¼Git ä¼åè®¡ç®æ¯ä¸ä¸ªå­ç®å½ï¼æ¬ä¾ä¸­åªæé¡¹ç®æ ¹ç®å½ï¼çæ ¡éªåï¼ ç¶åå¨ Git ä»åºä¸­è¿äºæ ¡éªåä¿å­ä¸ºæ å¯¹è±¡ãéåï¼Git ä¾¿ä¼åå»ºä¸ä¸ªæäº¤å¯¹è±¡ï¼ å®é¤äºåå«ä¸é¢æå°çé£äºä¿¡æ¯å¤ï¼è¿åå«æåè¿ä¸ªæ å¯¹è±¡ï¼é¡¹ç®æ ¹ç®å½ï¼çæéã å¦æ­¤ä¸æ¥ï¼Git å°±å¯ä»¥å¨éè¦çæ¶åéç°æ­¤æ¬¡ä¿å­çå¿«ç§ã\n\nç°å¨ï¼Git ä»åºä¸­æäºä¸ªå¯¹è±¡ï¼ä¸ä¸ª blob å¯¹è±¡ï¼ä¿å­çæä»¶å¿«ç§ï¼ãä¸ä¸ª æ å¯¹è±¡ ï¼è®°å½çç®å½ç»æå blob å¯¹è±¡ç´¢å¼ï¼ä»¥åä¸ä¸ª æäº¤å¯¹è±¡ï¼åå«çæååè¿°æ å¯¹è±¡çæéåæææäº¤ä¿¡æ¯ï¼ã\n\n\n\nå¾1. é¦æ¬¡æäº¤å¯¹è±¡åå¶æ ç»æ â²\n\n# å°ç»ï¼\n\n 1. git add å å¥æå­æä½ï¼ä¼ä¸ºæ¯ä¸ªæä»¶åå»ºè®¡ç®æ ¡éªåï¼ä»¥åæ¯ä¸ªæä»¶å¯¹åºçæä»¶å¿«ç§ï¼blobå¯¹è±¡ï¼ã\n\n 2. git commit æäº¤æä½ï¼è®¡ç®å­ç®å½æè·ç®å½çæ ¡éªå ä¿å­ä¸ºæ å¯¹è±¡ãéåï¼åå»ºä¸ä¸ªæäº¤å¯¹è±¡ï¼åå«çæåæ å¯¹è±¡çæéåæææäº¤ä¿¡æ¯ã\n\n\n# åæ¬¡æäº¤\n\nåäºä¿®æ¹ååæ¬¡æäº¤ï¼é£ä¹è¿æ¬¡äº§ççæäº¤å¯¹è±¡ä¼åå«ä¸ä¸ªæåä¸æ¬¡æäº¤å¯¹è±¡ï¼ç¶å¯¹è±¡ï¼çæéã\n\n\n\nå¾2. æäº¤å¯¹è±¡åå¶ç¶å¯¹è±¡ â²\n\n\n# Git çåæ¯\n\nGit çåæ¯ï¼å¶å®æ¬è´¨ä¸ä»ä»æ¯æåæäº¤å¯¹è±¡çå¯åæéã Git çé»è®¤åæ¯åå­æ¯ masterã å¨å¤æ¬¡æäº¤æä½ä¹åï¼ä½ å¶å®å·²ç»æä¸ä¸ªæåæåé£ä¸ªæäº¤å¯¹è±¡ç master åæ¯ã master åæ¯æéä¼å¨æ¯æ¬¡æäº¤æ¶èªå¨ååç§»å¨ã\n\n> Git ç master åæ¯å¹¶ä¸æ¯ä¸ä¸ªç¹æ®åæ¯ã å®å°±è·å¶å®åæ¯å®å¨æ²¡æåºå«ã\n\n\n\nå¾3. åæ¯åå¶æäº¤åå² â²\n\n\n# åå»ºåæ¯\n\nGit æ¯æä¹åå»ºæ°åæ¯çå¢ï¼ å¾ç®åï¼å®åªæ¯ä¸ºä½ åå»ºäºä¸ä¸ªå¯ä»¥ç§»å¨çæ°çæéã æ¯å¦ï¼åå»ºä¸ä¸ª testing åæ¯ï¼ ä½ éè¦ä½¿ç¨ git branch å½ä»¤ï¼\n\n$ git branch testing\n\n\n1\n\n\nè¿ä¼å¨å½åæå¨çæäº¤å¯¹è±¡ä¸åå»ºä¸ä¸ªæéã\n\n\n\nå¾4. ä¸¤ä¸ªæåç¸åæäº¤åå²çåæ¯ â²\n\n\n# å½ååæ¯çæé\n\nGit æ¯æä¹ç¥éå½åå¨åªä¸ä¸ªåæ¯ä¸å¢ï¼ å¾ç®åï¼å®æä¸ä¸ªåä¸º HEAD çç¹æ®æéï¼æåå½åæå¨çæ¬å°åæ¯ï¼è¯æ³¨ï¼å° HEAD æ³è±¡ä¸ºå½ååæ¯çå«åï¼ã å¨æ¬ä¾ä¸­ï¼ä½ ä»ç¶å¨ master åæ¯ä¸ã å ä¸º git branch å½ä»¤ä»ä» åå»º ä¸ä¸ªæ°åæ¯ï¼å¹¶ä¸ä¼èªå¨åæ¢å°æ°åæ¯ä¸­å»ã\n\n\n\nå¾5. HEAD æåå½åæå¨çåæ¯ â²\n\n\n# æ¥çå½åæå¨åæ¯\n\nä½ å¯ä»¥ç®åå°ä½¿ç¨ git log å½ä»¤æ¥çåä¸ªåæ¯å½åææçå¯¹è±¡ã æä¾è¿ä¸åè½çåæ°æ¯ --decorateã\n\n$ git log --oneline --decorate\nf30ab (HEAD -> master, testing) add feature # f30abæäº¤å¯¹è±¡ (HEADå½åæå¨åæ¯ -> masteråæ¯ï¼testing åæ¯)\n34ac2 Fixed bug # 34ac2 æäº¤å¯¹è±¡\n98ca9 The initial commit of my project # 98ca9 æäº¤å¯¹è±¡\n\n\n1\n2\n3\n4\n\n\næ­£å¦ä½ æè§ï¼å½å master å testing åæ¯åæåæ ¡éªåä»¥ f30ab å¼å¤´çæäº¤å¯¹è±¡ã\n\n\n# åæ¯åæ¢\n\n$ git checkout testing  # git checkout <åæ¯å>\n\n\n1\n\n\nè¿æ · HEAD å°±æå testing åæ¯äºã\n\n\n\nå¾6. HEAD æåå½åæå¨çåæ¯ â²\n\né£ä¹ï¼è¿æ ·çå®ç°æ¹å¼ä¼ç»æä»¬å¸¦æ¥ä»ä¹å¥½å¤å¢ï¼ ç°å¨ä¸å¦¨åæäº¤ä¸æ¬¡ï¼\n\n$ vim test.rb\n$ git commit -a -m 'made a change'\n\n\n1\n2\n\n\n\n\nå¾7. HEAD åæ¯éçæäº¤æä½èªå¨ååç§»å¨ â²\n\nå¦å¾æç¤ºï¼ä½ ç testing åæ¯ååç§»å¨äºï¼ä½æ¯ master åæ¯å´æ²¡æï¼å®ä»ç¶æåè¿è¡ git checkout æ¶ææçå¯¹è±¡ã è¿å°±æææäºï¼ç°å¨æä»¬åæ¢å master åæ¯ççï¼\n\n$ git checkout master\n\n\n1\n\n\n\n\nå¾8. æ£åºæ¶ HEAD éä¹ç§»å¨ â²\n\nè¿æ¡å½ä»¤åäºä¸¤ä»¶äºã ä¸æ¯ä½¿ HEAD æå master åæ¯ï¼äºæ¯å°å·¥ä½ç®å½æ¢å¤æ master åæ¯ææåçå¿«ç§åå®¹ã ä¹å°±æ¯è¯´ï¼ä½ ç°å¨åä¿®æ¹çè¯ï¼é¡¹ç®å°å§äºä¸ä¸ªè¾æ§ççæ¬ã æ¬è´¨ä¸æ¥è®²ï¼è¿å°±æ¯å¿½ç¥ testing åæ¯æåçä¿®æ¹ï¼ä»¥ä¾¿äºåå¦ä¸ä¸ªæ¹åè¿è¡å¼åã\n\næä»¬ä¸å¦¨åç¨å¾®åäºä¿®æ¹å¹¶æäº¤ï¼\n\n$ vim test.rb\n$ git commit -a -m 'made other changes'\n\n\n1\n2\n\n\nç°å¨ï¼è¿ä¸ªé¡¹ç®çæäº¤åå²å·²ç»äº§çäºååï¼åè§ é¡¹ç®åååå²ï¼ã å ä¸ºåæä½ åå»ºäºä¸ä¸ªæ°åæ¯ï¼å¹¶åæ¢è¿å»è¿è¡äºä¸äºå·¥ä½ï¼éåååæ¢å master åæ¯è¿è¡äºå¦å¤ä¸äºå·¥ä½ã ä¸è¿°ä¸¤æ¬¡æ¹å¨éå¯¹çæ¯ä¸ååæ¯ï¼ä½ å¯ä»¥å¨ä¸ååæ¯é´ä¸æ­å°æ¥ååæ¢åå·¥ä½ï¼å¹¶å¨æ¶æºæçæ¶å°å®ä»¬åå¹¶èµ·æ¥ã èææè¿äºå·¥ä½ï¼ä½ éè¦çå½ä»¤åªæ branchãcheckout å commitã\n\n\n\nå¾9. é¡¹ç®åååå² â²\n\nä½ å¯ä»¥ç®åå°ä½¿ç¨ git log å½ä»¤æ¥çåååå²ã è¿è¡ git log --oneline --decorate --graph --all ï¼å®ä¼è¾åºä½ çæäº¤åå²ãåä¸ªåæ¯çæåä»¥åé¡¹ç®çåæ¯ååæåµã\n\n$ git log --oneline --decorate --graph --all\n* c2b9e (HEAD, master) made other changes\n| * 87ab2 (testing) made a change\n|/\n* f30ab add feature\n* 34ac2 fixed bug\n* 98ca9 initial commit of my project\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nç±äº Git çåæ¯å®è´¨ä¸ä»æ¯åå«ææå¯¹è±¡æ ¡éªåï¼é¿åº¦ä¸º 40 ç SHA-1 å¼å­ç¬¦ä¸²ï¼çæä»¶ï¼æä»¥å®çåå»ºåéæ¯é½å¼å¸¸é«æã åå»ºä¸ä¸ªæ°åæ¯å°±ç¸å½äºå¾ä¸ä¸ªæä»¶ä¸­åå¥ 41 ä¸ªå­èï¼40 ä¸ªå­ç¬¦å 1 ä¸ªæ¢è¡ç¬¦ï¼ï¼å¦æ­¤çç®åè½ä¸å¿«åï¼\n\nè¿ä¸è¿å»å¤§å¤æ°çæ¬æ§å¶ç³»ç»å½¢æäºé²æçå¯¹æ¯ï¼å®ä»¬å¨åå»ºåæ¯æ¶ï¼å°ææçé¡¹ç®æä»¶é½å¤å¶ä¸éï¼å¹¶ä¿å­å°ä¸ä¸ªç¹å®çç®å½ã å®æè¿æ ·ç¹ççè¿ç¨éå¸¸éè¦å¥½å ç§éï¼ææ¶çè³éè¦å¥½å åéãæéæ¶é´çé¿ç­ï¼å®å¨åå³äºé¡¹ç®çè§æ¨¡ã èå¨ Git ä¸­ï¼ä»»ä½è§æ¨¡çé¡¹ç®é½è½å¨ç¬é´åå»ºæ°åæ¯ã åæ¶ï¼ç±äºæ¯æ¬¡æäº¤é½ä¼è®°å½ç¶å¯¹è±¡ï¼æä»¥å¯»æ¾æ°å½çåå¹¶åºç¡ï¼è¯æ³¨ï¼å³å±åç¥åï¼ä¹æ¯åæ ·çç®ååé«æã è¿äºé«æçç¹æ§ä½¿å¾ Git é¼å±å¼åäººåé¢ç¹å°åå»ºåä½¿ç¨åæ¯ã\n\n\n# åå»ºåæ¯åæ¶åæ¢\n\néå¸¸æä»¬ä¼å¨åå»ºä¸ä¸ªæ°åæ¯åç«å³åæ¢è¿å»ï¼å¯ä»¥ä½¿ç¨å¦ä¸å½ä»¤ï¼\n\ngit checkout -b <newbranchname>\n\n\n1\n",normalizedContent:"# gitåæ¯-åæ¯åç\n\ngit å¤çåæ¯çæ¹å¼å¯è°æ¯é¾ä»¥ç½®ä¿¡çè½»éï¼åå»ºæ°åæ¯è¿ä¸æä½å ä¹è½å¨ç¬é´å®æï¼å¹¶ä¸å¨ä¸ååæ¯ä¹é´çåæ¢æä½ä¹æ¯ä¸æ ·ä¾¿æ·ã ä¸è®¸å¤å¶å®çæ¬æ§å¶ç³»ç»ä¸åï¼git é¼å±å¨å·¥ä½æµç¨ä¸­é¢ç¹å°ä½¿ç¨åæ¯ä¸åå¹¶ï¼åªæä¸å¤©ä¹åè¿è¡è®¸å¤æ¬¡ã\n\n\n# é¦æ¬¡æäº¤\n\nå¨è¿è¡æäº¤æä½æ¶ï¼git ä¼ä¿å­ä¸ä¸ªæäº¤å¯¹è±¡ï¼commit objectï¼ã\n\nåè®¾ç°å¨æä¸ä¸ªå·¥ä½ç®å½ï¼éé¢åå«äºä¸ä¸ªå°è¦è¢«æå­åæäº¤çæä»¶ã æå­æä½ä¼ä¸ºæ¯ä¸ä¸ªæä»¶è®¡ç®æ ¡éªåï¼ä½¿ç¨ sha-1 åå¸ç®æ³ï¼ï¼ç¶åä¼æå½åçæ¬çæä»¶å¿«ç§ä¿å­å° git ä»åºä¸­ ï¼git ä½¿ç¨ blob å¯¹è±¡æ¥ä¿å­å®ä»¬ï¼ï¼æç»å°æ ¡éªåå å¥å°æå­åºåç­å¾æäº¤ï¼\n\n$ git add readme test.rb license\n$ git commit -m 'the initial commit of my project'\n\n\n1\n2\n\n\nå½ä½¿ç¨ git commit è¿è¡æäº¤æä½æ¶ï¼git ä¼åè®¡ç®æ¯ä¸ä¸ªå­ç®å½ï¼æ¬ä¾ä¸­åªæé¡¹ç®æ ¹ç®å½ï¼çæ ¡éªåï¼ ç¶åå¨ git ä»åºä¸­è¿äºæ ¡éªåä¿å­ä¸ºæ å¯¹è±¡ãéåï¼git ä¾¿ä¼åå»ºä¸ä¸ªæäº¤å¯¹è±¡ï¼ å®é¤äºåå«ä¸é¢æå°çé£äºä¿¡æ¯å¤ï¼è¿åå«æåè¿ä¸ªæ å¯¹è±¡ï¼é¡¹ç®æ ¹ç®å½ï¼çæéã å¦æ­¤ä¸æ¥ï¼git å°±å¯ä»¥å¨éè¦çæ¶åéç°æ­¤æ¬¡ä¿å­çå¿«ç§ã\n\nç°å¨ï¼git ä»åºä¸­æäºä¸ªå¯¹è±¡ï¼ä¸ä¸ª blob å¯¹è±¡ï¼ä¿å­çæä»¶å¿«ç§ï¼ãä¸ä¸ª æ å¯¹è±¡ ï¼è®°å½çç®å½ç»æå blob å¯¹è±¡ç´¢å¼ï¼ä»¥åä¸ä¸ª æäº¤å¯¹è±¡ï¼åå«çæååè¿°æ å¯¹è±¡çæéåæææäº¤ä¿¡æ¯ï¼ã\n\n\n\nå¾1. é¦æ¬¡æäº¤å¯¹è±¡åå¶æ ç»æ â²\n\n# å°ç»ï¼\n\n 1. git add å å¥æå­æä½ï¼ä¼ä¸ºæ¯ä¸ªæä»¶åå»ºè®¡ç®æ ¡éªåï¼ä»¥åæ¯ä¸ªæä»¶å¯¹åºçæä»¶å¿«ç§ï¼blobå¯¹è±¡ï¼ã\n\n 2. git commit æäº¤æä½ï¼è®¡ç®å­ç®å½æè·ç®å½çæ ¡éªå ä¿å­ä¸ºæ å¯¹è±¡ãéåï¼åå»ºä¸ä¸ªæäº¤å¯¹è±¡ï¼åå«çæåæ å¯¹è±¡çæéåæææäº¤ä¿¡æ¯ã\n\n\n# åæ¬¡æäº¤\n\nåäºä¿®æ¹ååæ¬¡æäº¤ï¼é£ä¹è¿æ¬¡äº§ççæäº¤å¯¹è±¡ä¼åå«ä¸ä¸ªæåä¸æ¬¡æäº¤å¯¹è±¡ï¼ç¶å¯¹è±¡ï¼çæéã\n\n\n\nå¾2. æäº¤å¯¹è±¡åå¶ç¶å¯¹è±¡ â²\n\n\n# git çåæ¯\n\ngit çåæ¯ï¼å¶å®æ¬è´¨ä¸ä»ä»æ¯æåæäº¤å¯¹è±¡çå¯åæéã git çé»è®¤åæ¯åå­æ¯ masterã å¨å¤æ¬¡æäº¤æä½ä¹åï¼ä½ å¶å®å·²ç»æä¸ä¸ªæåæåé£ä¸ªæäº¤å¯¹è±¡ç master åæ¯ã master åæ¯æéä¼å¨æ¯æ¬¡æäº¤æ¶èªå¨ååç§»å¨ã\n\n> git ç master åæ¯å¹¶ä¸æ¯ä¸ä¸ªç¹æ®åæ¯ã å®å°±è·å¶å®åæ¯å®å¨æ²¡æåºå«ã\n\n\n\nå¾3. åæ¯åå¶æäº¤åå² â²\n\n\n# åå»ºåæ¯\n\ngit æ¯æä¹åå»ºæ°åæ¯çå¢ï¼ å¾ç®åï¼å®åªæ¯ä¸ºä½ åå»ºäºä¸ä¸ªå¯ä»¥ç§»å¨çæ°çæéã æ¯å¦ï¼åå»ºä¸ä¸ª testing åæ¯ï¼ ä½ éè¦ä½¿ç¨ git branch å½ä»¤ï¼\n\n$ git branch testing\n\n\n1\n\n\nè¿ä¼å¨å½åæå¨çæäº¤å¯¹è±¡ä¸åå»ºä¸ä¸ªæéã\n\n\n\nå¾4. ä¸¤ä¸ªæåç¸åæäº¤åå²çåæ¯ â²\n\n\n# å½ååæ¯çæé\n\ngit æ¯æä¹ç¥éå½åå¨åªä¸ä¸ªåæ¯ä¸å¢ï¼ å¾ç®åï¼å®æä¸ä¸ªåä¸º head çç¹æ®æéï¼æåå½åæå¨çæ¬å°åæ¯ï¼è¯æ³¨ï¼å° head æ³è±¡ä¸ºå½ååæ¯çå«åï¼ã å¨æ¬ä¾ä¸­ï¼ä½ ä»ç¶å¨ master åæ¯ä¸ã å ä¸º git branch å½ä»¤ä»ä» åå»º ä¸ä¸ªæ°åæ¯ï¼å¹¶ä¸ä¼èªå¨åæ¢å°æ°åæ¯ä¸­å»ã\n\n\n\nå¾5. head æåå½åæå¨çåæ¯ â²\n\n\n# æ¥çå½åæå¨åæ¯\n\nä½ å¯ä»¥ç®åå°ä½¿ç¨ git log å½ä»¤æ¥çåä¸ªåæ¯å½åææçå¯¹è±¡ã æä¾è¿ä¸åè½çåæ°æ¯ --decorateã\n\n$ git log --oneline --decorate\nf30ab (head -> master, testing) add feature # f30abæäº¤å¯¹è±¡ (headå½åæå¨åæ¯ -> masteråæ¯ï¼testing åæ¯)\n34ac2 fixed bug # 34ac2 æäº¤å¯¹è±¡\n98ca9 the initial commit of my project # 98ca9 æäº¤å¯¹è±¡\n\n\n1\n2\n3\n4\n\n\næ­£å¦ä½ æè§ï¼å½å master å testing åæ¯åæåæ ¡éªåä»¥ f30ab å¼å¤´çæäº¤å¯¹è±¡ã\n\n\n# åæ¯åæ¢\n\n$ git checkout testing  # git checkout <åæ¯å>\n\n\n1\n\n\nè¿æ · head å°±æå testing åæ¯äºã\n\n\n\nå¾6. head æåå½åæå¨çåæ¯ â²\n\né£ä¹ï¼è¿æ ·çå®ç°æ¹å¼ä¼ç»æä»¬å¸¦æ¥ä»ä¹å¥½å¤å¢ï¼ ç°å¨ä¸å¦¨åæäº¤ä¸æ¬¡ï¼\n\n$ vim test.rb\n$ git commit -a -m 'made a change'\n\n\n1\n2\n\n\n\n\nå¾7. head åæ¯éçæäº¤æä½èªå¨ååç§»å¨ â²\n\nå¦å¾æç¤ºï¼ä½ ç testing åæ¯ååç§»å¨äºï¼ä½æ¯ master åæ¯å´æ²¡æï¼å®ä»ç¶æåè¿è¡ git checkout æ¶ææçå¯¹è±¡ã è¿å°±æææäºï¼ç°å¨æä»¬åæ¢å master åæ¯ççï¼\n\n$ git checkout master\n\n\n1\n\n\n\n\nå¾8. æ£åºæ¶ head éä¹ç§»å¨ â²\n\nè¿æ¡å½ä»¤åäºä¸¤ä»¶äºã ä¸æ¯ä½¿ head æå master åæ¯ï¼äºæ¯å°å·¥ä½ç®å½æ¢å¤æ master åæ¯ææåçå¿«ç§åå®¹ã ä¹å°±æ¯è¯´ï¼ä½ ç°å¨åä¿®æ¹çè¯ï¼é¡¹ç®å°å§äºä¸ä¸ªè¾æ§ççæ¬ã æ¬è´¨ä¸æ¥è®²ï¼è¿å°±æ¯å¿½ç¥ testing åæ¯æåçä¿®æ¹ï¼ä»¥ä¾¿äºåå¦ä¸ä¸ªæ¹åè¿è¡å¼åã\n\næä»¬ä¸å¦¨åç¨å¾®åäºä¿®æ¹å¹¶æäº¤ï¼\n\n$ vim test.rb\n$ git commit -a -m 'made other changes'\n\n\n1\n2\n\n\nç°å¨ï¼è¿ä¸ªé¡¹ç®çæäº¤åå²å·²ç»äº§çäºååï¼åè§ é¡¹ç®åååå²ï¼ã å ä¸ºåæä½ åå»ºäºä¸ä¸ªæ°åæ¯ï¼å¹¶åæ¢è¿å»è¿è¡äºä¸äºå·¥ä½ï¼éåååæ¢å master åæ¯è¿è¡äºå¦å¤ä¸äºå·¥ä½ã ä¸è¿°ä¸¤æ¬¡æ¹å¨éå¯¹çæ¯ä¸ååæ¯ï¼ä½ å¯ä»¥å¨ä¸ååæ¯é´ä¸æ­å°æ¥ååæ¢åå·¥ä½ï¼å¹¶å¨æ¶æºæçæ¶å°å®ä»¬åå¹¶èµ·æ¥ã èææè¿äºå·¥ä½ï¼ä½ éè¦çå½ä»¤åªæ branchãcheckout å commitã\n\n\n\nå¾9. é¡¹ç®åååå² â²\n\nä½ å¯ä»¥ç®åå°ä½¿ç¨ git log å½ä»¤æ¥çåååå²ã è¿è¡ git log --oneline --decorate --graph --all ï¼å®ä¼è¾åºä½ çæäº¤åå²ãåä¸ªåæ¯çæåä»¥åé¡¹ç®çåæ¯ååæåµã\n\n$ git log --oneline --decorate --graph --all\n* c2b9e (head, master) made other changes\n| * 87ab2 (testing) made a change\n|/\n* f30ab add feature\n* 34ac2 fixed bug\n* 98ca9 initial commit of my project\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nç±äº git çåæ¯å®è´¨ä¸ä»æ¯åå«ææå¯¹è±¡æ ¡éªåï¼é¿åº¦ä¸º 40 ç sha-1 å¼å­ç¬¦ä¸²ï¼çæä»¶ï¼æä»¥å®çåå»ºåéæ¯é½å¼å¸¸é«æã åå»ºä¸ä¸ªæ°åæ¯å°±ç¸å½äºå¾ä¸ä¸ªæä»¶ä¸­åå¥ 41 ä¸ªå­èï¼40 ä¸ªå­ç¬¦å 1 ä¸ªæ¢è¡ç¬¦ï¼ï¼å¦æ­¤çç®åè½ä¸å¿«åï¼\n\nè¿ä¸è¿å»å¤§å¤æ°çæ¬æ§å¶ç³»ç»å½¢æäºé²æçå¯¹æ¯ï¼å®ä»¬å¨åå»ºåæ¯æ¶ï¼å°ææçé¡¹ç®æä»¶é½å¤å¶ä¸éï¼å¹¶ä¿å­å°ä¸ä¸ªç¹å®çç®å½ã å®æè¿æ ·ç¹ççè¿ç¨éå¸¸éè¦å¥½å ç§éï¼ææ¶çè³éè¦å¥½å åéãæéæ¶é´çé¿ç­ï¼å®å¨åå³äºé¡¹ç®çè§æ¨¡ã èå¨ git ä¸­ï¼ä»»ä½è§æ¨¡çé¡¹ç®é½è½å¨ç¬é´åå»ºæ°åæ¯ã åæ¶ï¼ç±äºæ¯æ¬¡æäº¤é½ä¼è®°å½ç¶å¯¹è±¡ï¼æä»¥å¯»æ¾æ°å½çåå¹¶åºç¡ï¼è¯æ³¨ï¼å³å±åç¥åï¼ä¹æ¯åæ ·çç®ååé«æã è¿äºé«æçç¹æ§ä½¿å¾ git é¼å±å¼åäººåé¢ç¹å°åå»ºåä½¿ç¨åæ¯ã\n\n\n# åå»ºåæ¯åæ¶åæ¢\n\néå¸¸æä»¬ä¼å¨åå»ºä¸ä¸ªæ°åæ¯åç«å³åæ¢è¿å»ï¼å¯ä»¥ä½¿ç¨å¦ä¸å½ä»¤ï¼\n\ngit checkout -b <newbranchname>\n\n\n1\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Gitåæ¯çæ°å»ºä¸åå¹¶-åæ¯æä½",frontmatter:{title:"Gitåæ¯çæ°å»ºä¸åå¹¶-åæ¯æä½",date:"2020-11-18T17:43:57.000Z",permalink:"/pages/ea5a8c/",categories:["ãGitãå­¦ä¹ ç¬è®°"],tags:["Git"]},regularPath:"/%E3%80%8AGit%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20.%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/30.Git%E5%88%86%E6%94%AF%E7%9A%84%E6%96%B0%E5%BB%BA%E4%B8%8E%E5%90%88%E5%B9%B6-%E5%88%86%E6%94%AF%E6%93%8D%E4%BD%9C.html",relativePath:"ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/30.Gitåæ¯çæ°å»ºä¸åå¹¶-åæ¯æä½.md",key:"v-7c3437ac",path:"/pages/ea5a8c/",headers:[{level:3,title:"åå»ºåæ¯å¹¶åæ¢",slug:"åå»ºåæ¯å¹¶åæ¢",normalizedTitle:"åå»ºåæ¯å¹¶åæ¢",charIndex:45},{level:3,title:"åæ¢åæ¯",slug:"åæ¢åæ¯",normalizedTitle:"åæ¢åæ¯",charIndex:187},{level:3,title:"åå¹¶åæ¯",slug:"åå¹¶åæ¯",normalizedTitle:"åå¹¶åæ¯",charIndex:575},{level:3,title:"å é¤åæ¯",slug:"å é¤åæ¯",normalizedTitle:"å é¤åæ¯",charIndex:666},{level:3,title:"å¤æ¬¡æäº¤ä¹ååå¹¶åæ¯",slug:"å¤æ¬¡æäº¤ä¹ååå¹¶åæ¯",normalizedTitle:"å¤æ¬¡æäº¤ä¹ååå¹¶åæ¯",charIndex:781},{level:3,title:"éå°å²çªæ¶çåæ¯åå¹¶",slug:"éå°å²çªæ¶çåæ¯åå¹¶",normalizedTitle:"éå°å²çªæ¶çåæ¯åå¹¶",charIndex:1123}],headersStr:"åå»ºåæ¯å¹¶åæ¢ åæ¢åæ¯ åå¹¶åæ¯ å é¤åæ¯ å¤æ¬¡æäº¤ä¹ååå¹¶åæ¯ éå°å²çªæ¶çåæ¯åå¹¶",content:"# Gitåæ¯çæ°å»ºä¸åå¹¶-åæ¯æä½\n\nææ¡£ï¼Git åæ¯ - åæ¯çæ°å»ºä¸åå¹¶\n\n\n# åå»ºåæ¯å¹¶åæ¢\n\næ­¤æ¶æä¸ä¸ªéæ±éè¦å¨æ°çåæ¯iss53ä¸å·¥ä½ï¼\n\n$ git checkout -b iss53  # bè¡¨ç¤ºbranch\n\n\n1\n\n\nå®æ¯ä¸é¢ä¸¤æ¡å½ä»¤çç®åï¼\n\n$ git branch iss53\n$ git checkout iss53\n\n\n1\n2\n\n\n\n# åæ¢åæ¯\n\nçªç¶æä¸ä¸ªç´§æ¥é®é¢è¦è§£å³ï¼éè¦å¨åæ¥çmasteråæ¯è¿è¡ä¿®å¤ï¼\n\n$ git checkout master\n\n\n1\n\n\nå¨åæ¢å°masterä¹åï¼éè¦iss53åæ¯ä¿æå¥½ä¸ä¸ªå¹²åçç¶æï¼ä¿®æ¹é½å·²æäº¤ï¼ã\n\næ³¨æï¼åæ¢åæ¯Git ä¼éç½®ä½ çå·¥ä½ç®å½ã\n\n> checkout ä¸­æå«ä¹ âæ£åºâï¼checkout <branch> æ£åºåæ¯ => æ£åºæå®åæ¯çä»£ç  => éç½®å·¥ä½ç®å½å¹¶åæ¢åæ¯ã\n\næ¥ä¸æ¥ï¼ä½ è¦ä¿®å¤è¿ä¸ªç´§æ¥é®é¢ã å»ºç«ä¸ä¸ª hotfix åæ¯ï¼å¨è¯¥åæ¯ä¸å·¥ä½ç´å°é®é¢è§£å³ï¼\n\n$ git checkout -b hotfix\n\n# ä¸­é´è¿ç¨å¨hotfixä¸ä¿®æ¹äºä»£ç å¹¶æäº¤\n$ echo 'test' > ./hotfix.txt\n$ git add .\n$ git commit -m 'fixed'\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# åå¹¶åæ¯\n\n$ git checkout master # é¦åååmasteråæ¯\n$ git merge hotfix # æ hotfix åæ¯åå¹¶è¿æ¥\n\n\n1\n2\n\n\n\n# å é¤åæ¯\n\n$ git branch -d hotfix # dè¡¨ç¤ºdelete\n\n# ç¶åååiss53ç»§ç»­å·¥ä½\n$ git checkout iss53\n\n\n1\n2\n3\n4\n\n\næ³¨æå é¤åæ¯æ¯å¨ branch å½ä»¤ä¸\n\n\n# å¤æ¬¡æäº¤ä¹ååå¹¶åæ¯\n\nåè®¾ä½ å·²ç»ä¿®æ­£äº #53 é®é¢ï¼æç®åå¹¶å°masteråæ¯ï¼\n\n$ git checkout master\n$ git merga iss53\n\n\n1\n2\n\n\nè¿çä¼¼åä¹åçåå¹¶åºå«ä¸å¤§ãæ­¤æ¶ä½ çå¼ååå²ä»ä¸ä¸ªæ´æ©çå°æ¹å¼å§ååå¼æ¥ï¼divergedï¼ã å ä¸ºï¼master åæ¯æå¨æäº¤å¹¶ä¸æ¯ iss53 åæ¯æå¨æäº¤çç´æ¥ç¥åï¼Git ä¸å¾ä¸åä¸äºé¢å¤çå·¥ä½ã åºç°è¿ç§æåµçæ¶åï¼Git ä¼ä½¿ç¨ä¸¤ä¸ªåæ¯çæ«ç«¯ææçå¿«ç§ä»¥åè¿ä¸¤ä¸ªåæ¯çå¬å±ç¥åï¼åä¸ä¸ªç®åçä¸æ¹åå¹¶ã\n\nåä¹åå°åæ¯æéååæ¨è¿æä¸åçæ¯ï¼Git å°æ­¤æ¬¡ä¸æ¹åå¹¶çç»æåäºä¸ä¸ªæ°çå¿«ç§å¹¶ä¸èªå¨åå»ºä¸ä¸ªæ°çæäº¤æåå®ã è¿ä¸ªè¢«ç§°ä½ä¸æ¬¡åå¹¶æäº¤ï¼å®çç¹å«ä¹å¤å¨äºä»æä¸æ­¢ä¸ä¸ªç¶æäº¤ã\n\n\n# éå°å²çªæ¶çåæ¯åå¹¶\n\nå¦æä½ å¨ä¸¤ä¸ªä¸åçåæ¯ä¸­ï¼å¯¹åä¸ä¸ªæä»¶çåä¸ä¸ªé¨åè¿è¡äºä¸åçä¿®æ¹ï¼Git å°±æ²¡æ³å¹²åçåå¹¶å®ä»¬ï¼å°±äº§çäºå²çªã\n\nåå¹¶è¿ç¨ä¸­åºç°CONFLICTæåï¼è¡¨ç¤ºæå²çª\n\n$ git merge iss53\nAuto-merging index.html\nCONFLICT (content): Merge conflict in index.html\nAutomatic merge failed; fix conflicts and then commit the result.\n\n\n1\n2\n3\n4\n\n\nä½¿ç¨git statusæ¥çæªåå¹¶ç¶æã\n\nä»»ä½å åå«åå¹¶å²çªèæå¾è§£å³çæä»¶ï¼é½ä¼ä»¥æªåå¹¶ç¶ææ è¯åºæ¥ã Git ä¼å¨æå²çªçæä»¶ä¸­å å¥æ åçå²çªè§£å³æ è®°ï¼è¿æ ·ä½ å¯ä»¥æå¼è¿äºåå«å²çªçæä»¶ç¶åæå¨è§£å³å²çªã åºç°å²çªçæä»¶ä¼åå«ä¸äºç¹æ®åºæ®µï¼çèµ·æ¥åä¸é¢è¿ä¸ªæ ·å­ï¼\n\n<<<<<<< HEAD:index.html\n<div id=\"footer\">contact : email.support@github.com</div>\n=======\n<div id=\"footer\">\n please contact us at support@github.com\n</div>\n>>>>>>> iss53:index.html\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä½ éè¦æå¨è§£å³å²çªï¼è§£å³äºæææä»¶éçå²çªä¹åï¼å¯¹æ¯ä¸ªæä»¶ä½¿ç¨ git add å½ä»¤æ¥å°å¶æ è®°ä¸ºå²çªå·²è§£å³ã ä¸æ¦æå­è¿äºåæ¬æå²çªçæä»¶ï¼Git å°±ä¼å°å®ä»¬æ è®°ä¸ºå²çªå·²è§£å³ã\n\nå¦æä½ å¯¹ç»ææå°æ»¡æï¼å¹¶ä¸ç¡®å®ä¹åæå²çªççæä»¶é½å·²ç»æå­äºï¼è¿æ¶ä½ å¯ä»¥è¾å¥ git commit æ¥å®æåå¹¶æäº¤ã",normalizedContent:"# gitåæ¯çæ°å»ºä¸åå¹¶-åæ¯æä½\n\nææ¡£ï¼git åæ¯ - åæ¯çæ°å»ºä¸åå¹¶\n\n\n# åå»ºåæ¯å¹¶åæ¢\n\næ­¤æ¶æä¸ä¸ªéæ±éè¦å¨æ°çåæ¯iss53ä¸å·¥ä½ï¼\n\n$ git checkout -b iss53  # bè¡¨ç¤ºbranch\n\n\n1\n\n\nå®æ¯ä¸é¢ä¸¤æ¡å½ä»¤çç®åï¼\n\n$ git branch iss53\n$ git checkout iss53\n\n\n1\n2\n\n\n\n# åæ¢åæ¯\n\nçªç¶æä¸ä¸ªç´§æ¥é®é¢è¦è§£å³ï¼éè¦å¨åæ¥çmasteråæ¯è¿è¡ä¿®å¤ï¼\n\n$ git checkout master\n\n\n1\n\n\nå¨åæ¢å°masterä¹åï¼éè¦iss53åæ¯ä¿æå¥½ä¸ä¸ªå¹²åçç¶æï¼ä¿®æ¹é½å·²æäº¤ï¼ã\n\næ³¨æï¼åæ¢åæ¯git ä¼éç½®ä½ çå·¥ä½ç®å½ã\n\n> checkout ä¸­æå«ä¹ âæ£åºâï¼checkout <branch> æ£åºåæ¯ => æ£åºæå®åæ¯çä»£ç  => éç½®å·¥ä½ç®å½å¹¶åæ¢åæ¯ã\n\næ¥ä¸æ¥ï¼ä½ è¦ä¿®å¤è¿ä¸ªç´§æ¥é®é¢ã å»ºç«ä¸ä¸ª hotfix åæ¯ï¼å¨è¯¥åæ¯ä¸å·¥ä½ç´å°é®é¢è§£å³ï¼\n\n$ git checkout -b hotfix\n\n# ä¸­é´è¿ç¨å¨hotfixä¸ä¿®æ¹äºä»£ç å¹¶æäº¤\n$ echo 'test' > ./hotfix.txt\n$ git add .\n$ git commit -m 'fixed'\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# åå¹¶åæ¯\n\n$ git checkout master # é¦åååmasteråæ¯\n$ git merge hotfix # æ hotfix åæ¯åå¹¶è¿æ¥\n\n\n1\n2\n\n\n\n# å é¤åæ¯\n\n$ git branch -d hotfix # dè¡¨ç¤ºdelete\n\n# ç¶åååiss53ç»§ç»­å·¥ä½\n$ git checkout iss53\n\n\n1\n2\n3\n4\n\n\næ³¨æå é¤åæ¯æ¯å¨ branch å½ä»¤ä¸\n\n\n# å¤æ¬¡æäº¤ä¹ååå¹¶åæ¯\n\nåè®¾ä½ å·²ç»ä¿®æ­£äº #53 é®é¢ï¼æç®åå¹¶å°masteråæ¯ï¼\n\n$ git checkout master\n$ git merga iss53\n\n\n1\n2\n\n\nè¿çä¼¼åä¹åçåå¹¶åºå«ä¸å¤§ãæ­¤æ¶ä½ çå¼ååå²ä»ä¸ä¸ªæ´æ©çå°æ¹å¼å§ååå¼æ¥ï¼divergedï¼ã å ä¸ºï¼master åæ¯æå¨æäº¤å¹¶ä¸æ¯ iss53 åæ¯æå¨æäº¤çç´æ¥ç¥åï¼git ä¸å¾ä¸åä¸äºé¢å¤çå·¥ä½ã åºç°è¿ç§æåµçæ¶åï¼git ä¼ä½¿ç¨ä¸¤ä¸ªåæ¯çæ«ç«¯ææçå¿«ç§ä»¥åè¿ä¸¤ä¸ªåæ¯çå¬å±ç¥åï¼åä¸ä¸ªç®åçä¸æ¹åå¹¶ã\n\nåä¹åå°åæ¯æéååæ¨è¿æä¸åçæ¯ï¼git å°æ­¤æ¬¡ä¸æ¹åå¹¶çç»æåäºä¸ä¸ªæ°çå¿«ç§å¹¶ä¸èªå¨åå»ºä¸ä¸ªæ°çæäº¤æåå®ã è¿ä¸ªè¢«ç§°ä½ä¸æ¬¡åå¹¶æäº¤ï¼å®çç¹å«ä¹å¤å¨äºä»æä¸æ­¢ä¸ä¸ªç¶æäº¤ã\n\n\n# éå°å²çªæ¶çåæ¯åå¹¶\n\nå¦æä½ å¨ä¸¤ä¸ªä¸åçåæ¯ä¸­ï¼å¯¹åä¸ä¸ªæä»¶çåä¸ä¸ªé¨åè¿è¡äºä¸åçä¿®æ¹ï¼git å°±æ²¡æ³å¹²åçåå¹¶å®ä»¬ï¼å°±äº§çäºå²çªã\n\nåå¹¶è¿ç¨ä¸­åºç°conflictæåï¼è¡¨ç¤ºæå²çª\n\n$ git merge iss53\nauto-merging index.html\nconflict (content): merge conflict in index.html\nautomatic merge failed; fix conflicts and then commit the result.\n\n\n1\n2\n3\n4\n\n\nä½¿ç¨git statusæ¥çæªåå¹¶ç¶æã\n\nä»»ä½å åå«åå¹¶å²çªèæå¾è§£å³çæä»¶ï¼é½ä¼ä»¥æªåå¹¶ç¶ææ è¯åºæ¥ã git ä¼å¨æå²çªçæä»¶ä¸­å å¥æ åçå²çªè§£å³æ è®°ï¼è¿æ ·ä½ å¯ä»¥æå¼è¿äºåå«å²çªçæä»¶ç¶åæå¨è§£å³å²çªã åºç°å²çªçæä»¶ä¼åå«ä¸äºç¹æ®åºæ®µï¼çèµ·æ¥åä¸é¢è¿ä¸ªæ ·å­ï¼\n\n<<<<<<< head:index.html\n<div id=\"footer\">contact : email.support@github.com</div>\n=======\n<div id=\"footer\">\n please contact us at support@github.com\n</div>\n>>>>>>> iss53:index.html\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä½ éè¦æå¨è§£å³å²çªï¼è§£å³äºæææä»¶éçå²çªä¹åï¼å¯¹æ¯ä¸ªæä»¶ä½¿ç¨ git add å½ä»¤æ¥å°å¶æ è®°ä¸ºå²çªå·²è§£å³ã ä¸æ¦æå­è¿äºåæ¬æå²çªçæä»¶ï¼git å°±ä¼å°å®ä»¬æ è®°ä¸ºå²çªå·²è§£å³ã\n\nå¦æä½ å¯¹ç»ææå°æ»¡æï¼å¹¶ä¸ç¡®å®ä¹åæå²çªççæä»¶é½å·²ç»æå­äºï¼è¿æ¶ä½ å¯ä»¥è¾å¥ git commit æ¥å®æåå¹¶æäº¤ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Gitåæ¯ç®¡ç-æ¥çåæ¯",frontmatter:{title:"Gitåæ¯ç®¡ç-æ¥çåæ¯",date:"2020-11-18T17:43:57.000Z",permalink:"/pages/a399b3/",categories:["ãGitãå­¦ä¹ ç¬è®°"],tags:["Git"]},regularPath:"/%E3%80%8AGit%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20.%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/40.Git%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86-%E6%9F%A5%E7%9C%8B%E5%88%86%E6%94%AF.html",relativePath:"ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/40.Gitåæ¯ç®¡ç-æ¥çåæ¯.md",key:"v-60ad1438",path:"/pages/a399b3/",headers:[{level:3,title:"æ¥çåæ¯",slug:"æ¥çåæ¯",normalizedTitle:"æ¥çåæ¯",charIndex:10},{level:3,title:"æ¥çæ¯ä¸ªåæ¯çæåæäº¤",slug:"æ¥çæ¯ä¸ªåæ¯çæåæäº¤",normalizedTitle:"æ¥çæ¯ä¸ªåæ¯çæåæäº¤",charIndex:152},{level:3,title:"æ¥çå·²(æª)åå¹¶çåæ¯",slug:"æ¥çå·²-æª-åå¹¶çåæ¯",normalizedTitle:"æ¥çå·²(æª)åå¹¶çåæ¯",charIndex:297}],headersStr:"æ¥çåæ¯ æ¥çæ¯ä¸ªåæ¯çæåæäº¤ æ¥çå·²(æª)åå¹¶çåæ¯",content:"# Gitåæ¯ç®¡ç-æ¥çåæ¯\n\n\n# æ¥çåæ¯\n\n$ git branch\n  iss53\n* master  # å¸¦æå·*è¡¨ç¤ºå½åæå¨åæ¯\n  testing\n\n\n1\n2\n3\n4\n\n\ngit branch å½ä»¤ä¸åªæ¯å¯ä»¥åå»ºä¸å é¤åæ¯ã å¦æä¸å ä»»ä½åæ°è¿è¡å®ï¼ä¼å¾å°å½åææåæ¯çä¸ä¸ªåè¡¨ã\n\n\n# æ¥çæ¯ä¸ªåæ¯çæåæäº¤\n\n$ git branch -v\n  iss53   93b412c fix javascript issue\n* master  7a98805 Merge branch 'iss53'\n  testing 782fd34 test\n\n\n1\n2\n3\n4\n\n\n\n# æ¥çå·²(æª)åå¹¶çåæ¯\n\n--merged ä¸ --no-merged è¿ä¸¤ä¸ªéé¡¹å¯ä»¥æ¥çåªäºåæ¯å·²ç»åå¹¶ææªåå¹¶å° å½å åæ¯ã\n\n$ git branch --merged # æ¥çå·²åå¹¶åæ¯åè¡¨\n  iss53\n* master\n\n\n1\n2\n3\n\n\nä¸é¢åè¡¨ä¸­åæ¯åå­åæ²¡æ * å·çåæ¯éå¸¸å¯ä»¥ä½¿ç¨ git branch -d å é¤æï¼\n\n$ git branch --no-merged # æ¥çæªåå¹¶çåæ¯åè¡¨\n  testing\n\n\n1\n2\n\n\nä¸é¢æ¾ç¤ºæªåå¹¶çåæ¯ï¼å°è¯ä½¿ç¨ git branch -d å½ä»¤å é¤å®æ¶ä¼å¤±è´¥ï¼\n\n$ git branch -d testing\nerror: The branch 'testing' is not fully merged.\nIf you are sure you want to delete it, run 'git branch -D testing'.\n\n\n1\n2\n3\n\n\nå¼ºå¶å é¤æªåå¹¶çåæ¯:\n\n$ git branch -D testing\n\n\n1\n\n\n# æ¥çæå®åæ¯çå·²(æª)åå¹¶çåæ¯\n\nä¸é¢æè¿°çéé¡¹ --merged å --no-merged ä¼å¨æ²¡æç»å®æäº¤æåæ¯åä½ä¸ºåæ°æ¶ï¼ åå«ååºå·²åå¹¶ææªåå¹¶å° å½å åæ¯çåæ¯ã\n\nä½ æ»æ¯å¯ä»¥æä¾ä¸ä¸ªéå çåæ°æ¥æ¥çå¶å®åæ¯çåå¹¶ç¶æèä¸å¿æ£åºå®ä»¬ã ä¾å¦ï¼å°æªåå¹¶å° testing åæ¯çæåªäºï¼\n\n$ git branch --no-merged testing\n  topicA\n  featureB\n\n\n1\n2\n3\n",normalizedContent:"# gitåæ¯ç®¡ç-æ¥çåæ¯\n\n\n# æ¥çåæ¯\n\n$ git branch\n  iss53\n* master  # å¸¦æå·*è¡¨ç¤ºå½åæå¨åæ¯\n  testing\n\n\n1\n2\n3\n4\n\n\ngit branch å½ä»¤ä¸åªæ¯å¯ä»¥åå»ºä¸å é¤åæ¯ã å¦æä¸å ä»»ä½åæ°è¿è¡å®ï¼ä¼å¾å°å½åææåæ¯çä¸ä¸ªåè¡¨ã\n\n\n# æ¥çæ¯ä¸ªåæ¯çæåæäº¤\n\n$ git branch -v\n  iss53   93b412c fix javascript issue\n* master  7a98805 merge branch 'iss53'\n  testing 782fd34 test\n\n\n1\n2\n3\n4\n\n\n\n# æ¥çå·²(æª)åå¹¶çåæ¯\n\n--merged ä¸ --no-merged è¿ä¸¤ä¸ªéé¡¹å¯ä»¥æ¥çåªäºåæ¯å·²ç»åå¹¶ææªåå¹¶å° å½å åæ¯ã\n\n$ git branch --merged # æ¥çå·²åå¹¶åæ¯åè¡¨\n  iss53\n* master\n\n\n1\n2\n3\n\n\nä¸é¢åè¡¨ä¸­åæ¯åå­åæ²¡æ * å·çåæ¯éå¸¸å¯ä»¥ä½¿ç¨ git branch -d å é¤æï¼\n\n$ git branch --no-merged # æ¥çæªåå¹¶çåæ¯åè¡¨\n  testing\n\n\n1\n2\n\n\nä¸é¢æ¾ç¤ºæªåå¹¶çåæ¯ï¼å°è¯ä½¿ç¨ git branch -d å½ä»¤å é¤å®æ¶ä¼å¤±è´¥ï¼\n\n$ git branch -d testing\nerror: the branch 'testing' is not fully merged.\nif you are sure you want to delete it, run 'git branch -d testing'.\n\n\n1\n2\n3\n\n\nå¼ºå¶å é¤æªåå¹¶çåæ¯:\n\n$ git branch -d testing\n\n\n1\n\n\n# æ¥çæå®åæ¯çå·²(æª)åå¹¶çåæ¯\n\nä¸é¢æè¿°çéé¡¹ --merged å --no-merged ä¼å¨æ²¡æç»å®æäº¤æåæ¯åä½ä¸ºåæ°æ¶ï¼ åå«ååºå·²åå¹¶ææªåå¹¶å° å½å åæ¯çåæ¯ã\n\nä½ æ»æ¯å¯ä»¥æä¾ä¸ä¸ªéå çåæ°æ¥æ¥çå¶å®åæ¯çåå¹¶ç¶æèä¸å¿æ£åºå®ä»¬ã ä¾å¦ï¼å°æªåå¹¶å° testing åæ¯çæåªäºï¼\n\n$ git branch --no-merged testing\n  topica\n  featureb\n\n\n1\n2\n3\n",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Gitåæ¯å¼åå·¥ä½æµ",frontmatter:{title:"Gitåæ¯å¼åå·¥ä½æµ",date:"2020-11-18T17:43:57.000Z",permalink:"/pages/49ee30/",categories:["ãGitãå­¦ä¹ ç¬è®°"],tags:["Git"]},regularPath:"/%E3%80%8AGit%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20.%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/50.Git%E5%88%86%E6%94%AF%E5%BC%80%E5%8F%91%E5%B7%A5%E4%BD%9C%E6%B5%81.html",relativePath:"ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/50.Gitåæ¯å¼åå·¥ä½æµ.md",key:"v-42d161dc",path:"/pages/49ee30/",headers:[{level:3,title:"é¿æåæ¯",slug:"é¿æåæ¯",normalizedTitle:"é¿æåæ¯",charIndex:32},{level:3,title:"ä¸»é¢åæ¯ (ç­æåæ¯)",slug:"ä¸»é¢åæ¯-ç­æåæ¯",normalizedTitle:"ä¸»é¢åæ¯ (ç­æåæ¯)",charIndex:625}],headersStr:"é¿æåæ¯ ä¸»é¢åæ¯ (ç­æåæ¯)",content:"# Gitåæ¯å¼åå·¥ä½æµ\n\nææ¡£ï¼Gitåæ¯å¼åå·¥ä½æµ\n\n\n# é¿æåæ¯\n\nå ä¸º Git ä½¿ç¨ç®åçä¸æ¹åå¹¶ï¼æä»¥å°±ç®å¨ä¸æ®µè¾é¿çæ¶é´åï¼åå¤æä¸ä¸ªåæ¯åå¹¶å¥å¦ä¸ä¸ªåæ¯ï¼ä¹ä¸æ¯ä»ä¹é¾äºã ä¹å°±æ¯è¯´ï¼å¨æ´ä¸ªé¡¹ç®å¼åå¨æçä¸åé¶æ®µï¼ä½ å¯ä»¥åæ¶æ¥æå¤ä¸ªå¼æ¾çåæ¯ï¼ä½ å¯ä»¥å®æå°ææäºä¸»é¢åæ¯åå¹¶å¥å¶ä»åæ¯ä¸­ã\n\nè®¸å¤ä½¿ç¨ Git çå¼åèé½åæ¬¢ä½¿ç¨è¿ç§æ¹å¼æ¥å·¥ä½ï¼æ¯å¦åªå¨ master åæ¯ä¸ä¿çå®å¨ç¨³å®çä»£ç ï¼å¼åè¿ç¨å¨devåæ¯ï¼å¼åå®æåå¹¶å¥teståæ¯è¿è¡æµè¯ï¼éè¿æµè¯çç¨³å®ä»£ç æå¹¶å¥masteråæ¯ä¸­ã\n\ndevåteståæ¯ä¸éè¦ä¿æç»å¯¹ç¨³å®ï¼ä½å¨testéè¿æµè¯è¾¾å°ç¨³å®ç¶æï¼å°±å¯ä»¥è¢«åå¹¶å¥masteråæ¯ã\n\näºå®ä¸æä»¬åæè®¨è®ºçï¼æ¯éçä½ çæäº¤èä¸æ­å³ç§»çæéã ç¨³å®åæ¯(master)çæéæ»æ¯å¨æäº¤åå²ä¸­è½åä¸å¤§æªï¼èåæ²¿åæ¯(devætest)çæéå¾å¾æ¯è¾é åã\n\nä½ å¯ä»¥ç¨è¿ç§æ¹æ³ç»´æ¤ä¸åå±æ¬¡çç¨³å®æ§ã ä¸äºå¤§åé¡¹ç®è¿æä¸ä¸ª proposedï¼å»ºè®®ï¼ æ pu: proposed updatesï¼å»ºè®®æ´æ°ï¼åæ¯ï¼å®å¯è½å åå«ä¸äºä¸æççåå®¹èä¸è½è¿å¥master åæ¯ã è¿ä¹åçç®çæ¯ä½¿ä½ çåæ¯å·æä¸åçº§å«çç¨³å®æ§ï¼å½å®ä»¬å·æä¸å®ç¨åº¦çç¨³å®æ§åï¼åæå®ä»¬åå¹¶å¥å·ææ´é«çº§å«ç¨³å®æ§çåæ¯ä¸­ã åæ¬¡å¼ºè°ä¸ä¸ï¼ä½¿ç¨å¤ä¸ªé¿æåæ¯çæ¹æ³å¹¶éå¿è¦ï¼ä½æ¯è¿ä¹åéå¸¸å¾æå¸®å©ï¼å°¤å¶æ¯å½ä½ å¨ä¸ä¸ªéå¸¸åºå¤§æèå¤æçé¡¹ç®ä¸­å·¥ä½æ¶ã\n\n\n# ä¸»é¢åæ¯ (ç­æåæ¯)\n\nä¸»é¢åæ¯å¯¹ä»»ä½è§æ¨¡çé¡¹ç®é½éç¨ã ä¸»é¢åæ¯æ¯ä¸ç§ç­æåæ¯ï¼å®è¢«ç¨æ¥å®ç°åä¸ç¹æ§æå¶ç¸å³å·¥ä½ã\n\nä½ å·²ç»å¨ä¸ä¸èä¸­ä½ åå»ºç iss53 å hotfix ä¸»é¢åæ¯ä¸­çå°è¿è¿ç§ç¨æ³ã ä½ å¨ä¸ä¸èç¨å°çä¸»é¢åæ¯ï¼iss53 å hotfix åæ¯ï¼ä¸­æäº¤äºä¸äºæ´æ°ï¼å¹¶ä¸å¨å®ä»¬åå¹¶å¥ä¸»å¹²åæ¯ä¹åï¼ä½ åå é¤äºå®ä»¬ã è¿é¡¹ææ¯è½ä½¿ä½ å¿«éå¹¶ä¸å®æ´å°è¿è¡ä¸ä¸æåæ¢ï¼context-switchï¼ââå ä¸ºä½ çå·¥ä½è¢«åæ£å°ä¸åçæµæ°´çº¿ä¸­ï¼å¨ä¸åçæµæ°´çº¿ä¸­æ¯ä¸ªåæ¯é½ä»ä¸å¶ç®æ ç¹æ§ç¸å³ï¼å æ­¤ï¼å¨åä»£ç å®¡æ¥ä¹ç±»çå·¥ä½çæ¶åå°±è½æ´å å®¹æå°çåºä½ åäºåªäºæ¹å¨ã ä½ å¯ä»¥æååºçæ¹å¨å¨ä¸»é¢åæ¯ä¸­ä¿çå åéãå å¤©çè³å ä¸ªæï¼ç­å®ä»¬æçä¹åååå¹¶ï¼èä¸ç¨å¨ä¹å®ä»¬å»ºç«çé¡ºåºæå·¥ä½è¿åº¦ã\n\nèèè¿æ ·ä¸ä¸ªä¾å­ï¼ä½ å¨ master åæ¯ä¸å·¥ä½å° C1ï¼è¿æ¶ä¸ºäºè§£å³ä¸ä¸ªé®é¢èæ°å»º iss91 åæ¯ï¼å¨ iss91 åæ¯ä¸å·¥ä½å° C4ï¼ç¶èå¯¹äºé£ä¸ªé®é¢ä½ åæäºæ°çæ³æ³ï¼äºæ¯ä½ åæ°å»ºä¸ä¸ª iss91v2 åæ¯è¯å¾ç¨å¦ä¸ç§æ¹æ³è§£å³é£ä¸ªé®é¢ï¼æ¥çä½ åå° master åæ¯å·¥ä½äºä¸ä¼å¿ï¼ä½ åååºäºä¸ä¸ªä¸å¤ªç¡®å®çæ³æ³ï¼ä½ ä¾¿å¨ C10 çæ¶åæ°å»ºä¸ä¸ª dumbidea åæ¯ï¼å¹¶å¨ä¸é¢åäºå®éªã ä½ çæäº¤åå²çèµ·æ¥åä¸é¢è¿ä¸ªæ ·å­ï¼\n\n\n\nå¾1. æ¥æå¤ä¸ªä¸»é¢åæ¯çæäº¤åå² â²\n\nç°å¨ï¼æä»¬åè®¾ä¸¤ä»¶äºæï¼ä½ å³å®ä½¿ç¨ç¬¬äºä¸ªæ¹æ¡æ¥è§£å³é£ä¸ªé®é¢ï¼å³ä½¿ç¨å¨ iss91v2 åæ¯ä¸­æ¹æ¡ã å¦å¤ï¼ä½ å° dumbidea åæ¯æ¿ç»ä½ çåäºçè¿ä¹åï¼ç»æåç°è¿æ¯ä¸ªæäººä¹ä¸¾ã è¿æ¶ä½ å¯ä»¥æå¼ iss91 åæ¯ï¼å³ä¸¢å¼ C5 å C6 æäº¤ï¼ï¼ç¶åæå¦å¤ä¸¤ä¸ªåæ¯åå¹¶å¥ä¸»å¹²åæ¯ã æç»ä½ çæäº¤åå²çèµ·æ¥åä¸é¢è¿ä¸ªæ ·å­ï¼\n\n\n\nå¾2. åå¹¶äº dumbidea å iss91v2 åæ¯ä¹åçæäº¤åå² â²\n\næä»¬å°ä¼å¨ åå¸å¼ Git ä¸­åä½ æ­ç¤ºæ´å¤æå³åæ¯å·¥ä½æµçç»èï¼ å æ­¤ï¼è¯·ç¡®ä¿ä½ éè¯»å®é£ä¸ªç« èä¹åï¼åæ¥å³å®ä½ çä¸ä¸ªé¡¹ç®è¦ä½¿ç¨ä»ä¹æ ·çåæ¯ç­ç¥ï¼branching schemeï¼ã\n\nè¯·ç¢è®°ï¼å½ä½ åè¿ä¹å¤æä½çæ¶åï¼è¿äºåæ¯å¨é¨é½å­äºæ¬å°ã å½ä½ æ°å»ºååå¹¶åæ¯çæ¶åï¼ææè¿ä¸åé½åªåçå¨ä½ æ¬å°ç Git çæ¬åºä¸­ ââ æ²¡æä¸æå¡å¨åçäº¤äºã",normalizedContent:"# gitåæ¯å¼åå·¥ä½æµ\n\nææ¡£ï¼gitåæ¯å¼åå·¥ä½æµ\n\n\n# é¿æåæ¯\n\nå ä¸º git ä½¿ç¨ç®åçä¸æ¹åå¹¶ï¼æä»¥å°±ç®å¨ä¸æ®µè¾é¿çæ¶é´åï¼åå¤æä¸ä¸ªåæ¯åå¹¶å¥å¦ä¸ä¸ªåæ¯ï¼ä¹ä¸æ¯ä»ä¹é¾äºã ä¹å°±æ¯è¯´ï¼å¨æ´ä¸ªé¡¹ç®å¼åå¨æçä¸åé¶æ®µï¼ä½ å¯ä»¥åæ¶æ¥æå¤ä¸ªå¼æ¾çåæ¯ï¼ä½ å¯ä»¥å®æå°ææäºä¸»é¢åæ¯åå¹¶å¥å¶ä»åæ¯ä¸­ã\n\nè®¸å¤ä½¿ç¨ git çå¼åèé½åæ¬¢ä½¿ç¨è¿ç§æ¹å¼æ¥å·¥ä½ï¼æ¯å¦åªå¨ master åæ¯ä¸ä¿çå®å¨ç¨³å®çä»£ç ï¼å¼åè¿ç¨å¨devåæ¯ï¼å¼åå®æåå¹¶å¥teståæ¯è¿è¡æµè¯ï¼éè¿æµè¯çç¨³å®ä»£ç æå¹¶å¥masteråæ¯ä¸­ã\n\ndevåteståæ¯ä¸éè¦ä¿æç»å¯¹ç¨³å®ï¼ä½å¨testéè¿æµè¯è¾¾å°ç¨³å®ç¶æï¼å°±å¯ä»¥è¢«åå¹¶å¥masteråæ¯ã\n\näºå®ä¸æä»¬åæè®¨è®ºçï¼æ¯éçä½ çæäº¤èä¸æ­å³ç§»çæéã ç¨³å®åæ¯(master)çæéæ»æ¯å¨æäº¤åå²ä¸­è½åä¸å¤§æªï¼èåæ²¿åæ¯(devætest)çæéå¾å¾æ¯è¾é åã\n\nä½ å¯ä»¥ç¨è¿ç§æ¹æ³ç»´æ¤ä¸åå±æ¬¡çç¨³å®æ§ã ä¸äºå¤§åé¡¹ç®è¿æä¸ä¸ª proposedï¼å»ºè®®ï¼ æ pu: proposed updatesï¼å»ºè®®æ´æ°ï¼åæ¯ï¼å®å¯è½å åå«ä¸äºä¸æççåå®¹èä¸è½è¿å¥master åæ¯ã è¿ä¹åçç®çæ¯ä½¿ä½ çåæ¯å·æä¸åçº§å«çç¨³å®æ§ï¼å½å®ä»¬å·æä¸å®ç¨åº¦çç¨³å®æ§åï¼åæå®ä»¬åå¹¶å¥å·ææ´é«çº§å«ç¨³å®æ§çåæ¯ä¸­ã åæ¬¡å¼ºè°ä¸ä¸ï¼ä½¿ç¨å¤ä¸ªé¿æåæ¯çæ¹æ³å¹¶éå¿è¦ï¼ä½æ¯è¿ä¹åéå¸¸å¾æå¸®å©ï¼å°¤å¶æ¯å½ä½ å¨ä¸ä¸ªéå¸¸åºå¤§æèå¤æçé¡¹ç®ä¸­å·¥ä½æ¶ã\n\n\n# ä¸»é¢åæ¯ (ç­æåæ¯)\n\nä¸»é¢åæ¯å¯¹ä»»ä½è§æ¨¡çé¡¹ç®é½éç¨ã ä¸»é¢åæ¯æ¯ä¸ç§ç­æåæ¯ï¼å®è¢«ç¨æ¥å®ç°åä¸ç¹æ§æå¶ç¸å³å·¥ä½ã\n\nä½ å·²ç»å¨ä¸ä¸èä¸­ä½ åå»ºç iss53 å hotfix ä¸»é¢åæ¯ä¸­çå°è¿è¿ç§ç¨æ³ã ä½ å¨ä¸ä¸èç¨å°çä¸»é¢åæ¯ï¼iss53 å hotfix åæ¯ï¼ä¸­æäº¤äºä¸äºæ´æ°ï¼å¹¶ä¸å¨å®ä»¬åå¹¶å¥ä¸»å¹²åæ¯ä¹åï¼ä½ åå é¤äºå®ä»¬ã è¿é¡¹ææ¯è½ä½¿ä½ å¿«éå¹¶ä¸å®æ´å°è¿è¡ä¸ä¸æåæ¢ï¼context-switchï¼ââå ä¸ºä½ çå·¥ä½è¢«åæ£å°ä¸åçæµæ°´çº¿ä¸­ï¼å¨ä¸åçæµæ°´çº¿ä¸­æ¯ä¸ªåæ¯é½ä»ä¸å¶ç®æ ç¹æ§ç¸å³ï¼å æ­¤ï¼å¨åä»£ç å®¡æ¥ä¹ç±»çå·¥ä½çæ¶åå°±è½æ´å å®¹æå°çåºä½ åäºåªäºæ¹å¨ã ä½ å¯ä»¥æååºçæ¹å¨å¨ä¸»é¢åæ¯ä¸­ä¿çå åéãå å¤©çè³å ä¸ªæï¼ç­å®ä»¬æçä¹åååå¹¶ï¼èä¸ç¨å¨ä¹å®ä»¬å»ºç«çé¡ºåºæå·¥ä½è¿åº¦ã\n\nèèè¿æ ·ä¸ä¸ªä¾å­ï¼ä½ å¨ master åæ¯ä¸å·¥ä½å° c1ï¼è¿æ¶ä¸ºäºè§£å³ä¸ä¸ªé®é¢èæ°å»º iss91 åæ¯ï¼å¨ iss91 åæ¯ä¸å·¥ä½å° c4ï¼ç¶èå¯¹äºé£ä¸ªé®é¢ä½ åæäºæ°çæ³æ³ï¼äºæ¯ä½ åæ°å»ºä¸ä¸ª iss91v2 åæ¯è¯å¾ç¨å¦ä¸ç§æ¹æ³è§£å³é£ä¸ªé®é¢ï¼æ¥çä½ åå° master åæ¯å·¥ä½äºä¸ä¼å¿ï¼ä½ åååºäºä¸ä¸ªä¸å¤ªç¡®å®çæ³æ³ï¼ä½ ä¾¿å¨ c10 çæ¶åæ°å»ºä¸ä¸ª dumbidea åæ¯ï¼å¹¶å¨ä¸é¢åäºå®éªã ä½ çæäº¤åå²çèµ·æ¥åä¸é¢è¿ä¸ªæ ·å­ï¼\n\n\n\nå¾1. æ¥æå¤ä¸ªä¸»é¢åæ¯çæäº¤åå² â²\n\nç°å¨ï¼æä»¬åè®¾ä¸¤ä»¶äºæï¼ä½ å³å®ä½¿ç¨ç¬¬äºä¸ªæ¹æ¡æ¥è§£å³é£ä¸ªé®é¢ï¼å³ä½¿ç¨å¨ iss91v2 åæ¯ä¸­æ¹æ¡ã å¦å¤ï¼ä½ å° dumbidea åæ¯æ¿ç»ä½ çåäºçè¿ä¹åï¼ç»æåç°è¿æ¯ä¸ªæäººä¹ä¸¾ã è¿æ¶ä½ å¯ä»¥æå¼ iss91 åæ¯ï¼å³ä¸¢å¼ c5 å c6 æäº¤ï¼ï¼ç¶åæå¦å¤ä¸¤ä¸ªåæ¯åå¹¶å¥ä¸»å¹²åæ¯ã æç»ä½ çæäº¤åå²çèµ·æ¥åä¸é¢è¿ä¸ªæ ·å­ï¼\n\n\n\nå¾2. åå¹¶äº dumbidea å iss91v2 åæ¯ä¹åçæäº¤åå² â²\n\næä»¬å°ä¼å¨ åå¸å¼ git ä¸­åä½ æ­ç¤ºæ´å¤æå³åæ¯å·¥ä½æµçç»èï¼ å æ­¤ï¼è¯·ç¡®ä¿ä½ éè¯»å®é£ä¸ªç« èä¹åï¼åæ¥å³å®ä½ çä¸ä¸ªé¡¹ç®è¦ä½¿ç¨ä»ä¹æ ·çåæ¯ç­ç¥ï¼branching schemeï¼ã\n\nè¯·ç¢è®°ï¼å½ä½ åè¿ä¹å¤æä½çæ¶åï¼è¿äºåæ¯å¨é¨é½å­äºæ¬å°ã å½ä½ æ°å»ºååå¹¶åæ¯çæ¶åï¼ææè¿ä¸åé½åªåçå¨ä½ æ¬å°ç git çæ¬åºä¸­ ââ æ²¡æä¸æå¡å¨åçäº¤äºã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Gitå·¥å·-éç½®æ­å¯",frontmatter:{title:"Gitå·¥å·-éç½®æ­å¯",date:"2020-11-18T17:43:57.000Z",permalink:"/pages/d9e9c6/",categories:["ãGitãå­¦ä¹ ç¬è®°"],tags:["Git"]},regularPath:"/%E3%80%8AGit%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20.%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/110.Git%E5%B7%A5%E5%85%B7-%E9%87%8D%E7%BD%AE%E6%8F%AD%E5%AF%86.html",relativePath:"ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/110.Gitå·¥å·-éç½®æ­å¯.md",key:"v-92c363a2",path:"/pages/d9e9c6/",headers:[{level:2,title:"ä¸æ£µæ ",slug:"ä¸æ£µæ ",normalizedTitle:"ä¸æ£µæ ",charIndex:147},{level:3,title:"HEAD",slug:"head",normalizedTitle:"head",charIndex:348},{level:3,title:"ç´¢å¼",slug:"ç´¢å¼",normalizedTitle:"ç´¢å¼",charIndex:257},{level:3,title:"å·¥ä½ç®å½",slug:"å·¥ä½ç®å½",normalizedTitle:"å·¥ä½ç®å½",charIndex:1116},{level:2,title:"å·¥ä½æµç¨",slug:"å·¥ä½æµç¨",normalizedTitle:"å·¥ä½æµç¨",charIndex:1764},{level:2,title:"éç½®çä½ç¨",slug:"éç½®çä½ç¨",normalizedTitle:"éç½®çä½ç¨",charIndex:2573},{level:3,title:"ç¬¬ 1 æ­¥ï¼ç§»å¨ HEAD",slug:"ç¬¬-1-æ­¥-ç§»å¨-head",normalizedTitle:"ç¬¬ 1 æ­¥ï¼ç§»å¨ head",charIndex:2720},{level:3,title:"ç¬¬ 2 æ­¥ï¼æ´æ°ç´¢å¼ï¼--mixedï¼",slug:"ç¬¬-2-æ­¥-æ´æ°ç´¢å¼-mixed",normalizedTitle:"ç¬¬ 2 æ­¥ï¼æ´æ°ç´¢å¼ï¼--mixedï¼",charIndex:3207},{level:3,title:"ç¬¬ 3 æ­¥ï¼æ´æ°å·¥ä½ç®å½ï¼--hardï¼",slug:"ç¬¬-3-æ­¥-æ´æ°å·¥ä½ç®å½-hard",normalizedTitle:"ç¬¬ 3 æ­¥ï¼æ´æ°å·¥ä½ç®å½ï¼--hardï¼",charIndex:3507},{level:3,title:"åé¡¾",slug:"åé¡¾",normalizedTitle:"åé¡¾",charIndex:3867},{level:2,title:"éè¿è·¯å¾æ¥éç½®",slug:"éè¿è·¯å¾æ¥éç½®",normalizedTitle:"éè¿è·¯å¾æ¥éç½®",charIndex:4002},{level:2,title:"åç¼©",slug:"åç¼©",normalizedTitle:"åç¼©",charIndex:4855},{level:2,title:"æ£åº",slug:"æ£åº",normalizedTitle:"æ£åº",charIndex:1113},{level:3,title:"ä¸å¸¦è·¯å¾",slug:"ä¸å¸¦è·¯å¾",normalizedTitle:"ä¸å¸¦è·¯å¾",charIndex:5428},{level:3,title:"å¸¦è·¯å¾",slug:"å¸¦è·¯å¾",normalizedTitle:"å¸¦è·¯å¾",charIndex:5429},{level:2,title:"æ»ç»",slug:"æ»ç»",normalizedTitle:"æ»ç»",charIndex:6348}],headersStr:"ä¸æ£µæ  HEAD ç´¢å¼ å·¥ä½ç®å½ å·¥ä½æµç¨ éç½®çä½ç¨ ç¬¬ 1 æ­¥ï¼ç§»å¨ HEAD ç¬¬ 2 æ­¥ï¼æ´æ°ç´¢å¼ï¼--mixedï¼ ç¬¬ 3 æ­¥ï¼æ´æ°å·¥ä½ç®å½ï¼--hardï¼ åé¡¾ éè¿è·¯å¾æ¥éç½® åç¼© æ£åº ä¸å¸¦è·¯å¾ å¸¦è·¯å¾ æ»ç»",content:"# Git å·¥å· - éç½®æ­å¯\n\nå¨ç»§ç»­äºè§£æ´ä¸ä¸çå·¥å·åï¼æä»¬åæ¢è®¨ä¸ä¸ Git ç reset å checkout å½ä»¤ã å¨åéç Git å½ä»¤ä¸­ï¼è¿ä¸¤ä¸ªæ¯æè®©äººå°æçã å®ä»¬è½åå¾å¤äºæï¼æä»¥çèµ·æ¥æä»¬å¾é¾çæ­£å°çè§£å¹¶æ°å½å°è¿ç¨å®ä»¬ã éå¯¹è¿ä¸ç¹ï¼æä»¬åæ¥åä¸ä¸ªç®åçæ¯å»ã\n\n\n# ä¸æ£µæ \n\nçè§£ reset å checkout çæç®æ¹æ³ï¼å°±æ¯ä»¥ Git çæç»´æ¡æ¶ï¼å°å¶ä½ä¸ºåå®¹ç®¡çå¨ï¼æ¥ç®¡çä¸æ£µä¸åçæ ã âæ â å¨æä»¬è¿éçå®éæææ¯ âæä»¶çéåâï¼èä¸æ¯æç¹å®çæ°æ®ç»æã ï¼å¨æäºæåµä¸ç´¢å¼çèµ·æ¥å¹¶ä¸åä¸æ£µæ ï¼ä¸è¿æä»¬ç°å¨çç®çæ¯ç¨ç®åçæ¹å¼æèå®ãï¼\n\nGit ä½ä¸ºä¸ä¸ªç³»ç»ï¼æ¯ä»¥å®çä¸è¬æä½æ¥ç®¡çå¹¶æçºµè¿ä¸æ£µæ çï¼\n\næ                    ç¨é\nHEAD                ä¸ä¸æ¬¡æäº¤çå¿«ç§ï¼ä¸ä¸æ¬¡æäº¤çç¶ç»ç¹\nIndex               é¢æçä¸ä¸æ¬¡æäº¤çå¿«ç§\nWorking Directory   æ²ç\n\n\n# HEAD\n\nHEAD æ¯å½ååæ¯å¼ç¨çæéï¼å®æ»æ¯æåè¯¥åæ¯ä¸çæåä¸æ¬¡æäº¤ã è¿è¡¨ç¤º HEAD å°æ¯ä¸ä¸æ¬¡æäº¤çç¶ç»ç¹ã éå¸¸ï¼çè§£ HEAD çæç®æ¹å¼ï¼å°±æ¯å°å®çå è¯¥åæ¯ä¸çæåä¸æ¬¡æäº¤ çå¿«ç§ã\n\nå¶å®ï¼æ¥çå¿«ç§çæ ·å­å¾å®¹æã ä¸ä¾å°±æ¾ç¤ºäº HEAD å¿«ç§å®éçç®å½åè¡¨ï¼ä»¥åå¶ä¸­æ¯ä¸ªæä»¶ç SHA-1 æ ¡éªåï¼\n\n$ git cat-file -p HEAD\ntree cfda3bf379e4f8dba8717dee55aab78aef7f4daf\nauthor Scott Chacon  1301511835 -0700\ncommitter Scott Chacon  1301511835 -0700\n\ninitial commit\n\n$ git ls-tree -r HEAD\n100644 blob a906cb2a4a904a152...   README\n100644 blob 8f94139338f9404f2...   Rakefile\n040000 tree 99f1a6d12cb4b6f19...   lib\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nGit ç cat-file å ls-tree æ¯åºå±å½ä»¤ï¼å®ä»¬ä¸è¬ç¨äºåºå±å·¥ä½ï¼å¨æ¥å¸¸å·¥ä½ä¸­å¹¶ä¸ä½¿ç¨ã ä¸è¿å®ä»¬è½å¸®å©æä»¬äºè§£å°åºåçäºä»ä¹ã\n\n\n# ç´¢å¼\n\nç´¢å¼æ¯ä½ ç é¢æçä¸ä¸æ¬¡æäº¤ã æä»¬ä¹ä¼å°è¿ä¸ªæ¦å¿µå¼ç¨ä¸º Git çâæå­åºâï¼è¿å°±æ¯å½ä½ è¿è¡ git commit æ¶ Git çèµ·æ¥çæ ·å­ã\n\nGit å°ä¸ä¸æ¬¡æ£åºå°å·¥ä½ç®å½ä¸­çæææä»¶å¡«åå°ç´¢å¼åºï¼å®ä»¬çèµ·æ¥å°±åæåè¢«æ£åºæ¶çæ ·å­ã ä¹åä½ ä¼å°å¶ä¸­ä¸äºæä»¶æ¿æ¢ä¸ºæ°çæ¬ï¼æ¥çéè¿ git commit å°å®ä»¬è½¬æ¢ä¸ºæ æ¥ç¨ä½æ°çæäº¤ã\n\n$ git ls-files -s\n100644 a906cb2a4a904a152e80877d4088654daad0c859 0\tREADME\n100644 8f94139338f9404f26296befa88755fc2598c289 0\tRakefile\n100644 47c6340d6459e05787f644c2447d2595f5d3a54b 0\tlib/simplegit.rb\n\n\n1\n2\n3\n4\n\n\nåè¯´ä¸æ¬¡ï¼æä»¬å¨è¿éåç¨å°äº git ls-files è¿ä¸ªå¹åçå½ä»¤ï¼å®ä¼æ¾ç¤ºåºç´¢å¼å½åçæ ·å­ã\n\nç¡®åæ¥è¯´ï¼ç´¢å¼å¨ææ¯ä¸å¹¶éæ ç»æï¼å®å¶å®æ¯ä»¥æå¹³çæ¸åå®ç°çãä¸è¿å¯¹æä»¬èè¨ï¼æå®å½åæ å°±å¤äºã\n\n\n# å·¥ä½ç®å½\n\næåï¼ä½ å°±æäºèªå·±ç å·¥ä½ç®å½ï¼éå¸¸ä¹å« å·¥ä½åºï¼ã å¦å¤ä¸¤æ£µæ ä»¥ä¸ç§é«æä½å¹¶ä¸ç´è§çæ¹å¼ï¼å°å®ä»¬çåå®¹å­å¨å¨ .git æä»¶å¤¹ä¸­ã å·¥ä½ç®å½ä¼å°å®ä»¬è§£åä¸ºå®éçæä»¶ä»¥ä¾¿ç¼è¾ã ä½ å¯ä»¥æå·¥ä½ç®å½å½å æ²çãå¨ä½ å°ä¿®æ¹æäº¤å°æå­åºå¹¶è®°å½å°åå²ä¹åï¼å¯ä»¥éææ´æ¹ã\n\n$ tree\n.\nâââ README\nâââ Rakefile\nâââ lib\n    âââ simplegit.rb\n\n1 directory, 3 files\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# å·¥ä½æµç¨\n\nç»å¸ç Git å·¥ä½æµç¨æ¯éè¿æçºµè¿ä¸ä¸ªåºåæ¥ä»¥æ´å è¿ç»­çç¶æè®°å½é¡¹ç®å¿«ç§çã\n\n\n\nè®©æä»¬æ¥å¯è§åè¿ä¸ªè¿ç¨ï¼åè®¾æä»¬è¿å¥å°ä¸ä¸ªæ°ç®å½ï¼å¶ä¸­æä¸ä¸ªæä»¶ã æä»¬ç§°å¶ä¸ºè¯¥æä»¶ç v1 çæ¬ï¼å°å®æ è®°ä¸ºèè²ã ç°å¨è¿è¡ git initï¼è¿ä¼åå»ºä¸ä¸ª Git ä»åºï¼å¶ä¸­ç HEAD å¼ç¨æåæªåå»ºç master åæ¯ã\n\n\n\næ­¤æ¶ï¼åªæå·¥ä½ç®å½æåå®¹ã\n\nç°å¨æä»¬æ³è¦æäº¤è¿ä¸ªæä»¶ï¼æä»¥ç¨ git add æ¥è·åå·¥ä½ç®å½ä¸­çåå®¹ï¼å¹¶å°å¶å¤å¶å°ç´¢å¼ä¸­ã\n\n\n\næ¥çè¿è¡ git commitï¼å®ä¼åå¾ç´¢å¼ä¸­çåå®¹å¹¶å°å®ä¿å­ä¸ºä¸ä¸ªæ°¸ä¹çå¿«ç§ï¼ ç¶ååå»ºä¸ä¸ªæåè¯¥å¿«ç§çæäº¤å¯¹è±¡ï¼æåæ´æ° master æ¥æåæ¬æ¬¡æäº¤ã\n\n\n\næ­¤æ¶å¦ææä»¬è¿è¡ git statusï¼ä¼åç°æ²¡æä»»ä½æ¹å¨ï¼å ä¸ºç°å¨ä¸æ£µæ å®å¨ç¸åã\n\nç°å¨æä»¬æ³è¦å¯¹æä»¶è¿è¡ä¿®æ¹ç¶åæäº¤å®ã æä»¬å°ä¼ç»ååæ ·çè¿ç¨ï¼é¦åå¨å·¥ä½ç®å½ä¸­ä¿®æ¹æä»¶ã æä»¬ç§°å¶ä¸ºè¯¥æä»¶ç v2 çæ¬ï¼å¹¶å°å®æ è®°ä¸ºçº¢è²ã\n\n\n\nå¦æç°å¨è¿è¡ git statusï¼æä»¬ä¼çå°æä»¶æ¾ç¤ºå¨ âChanges not staged for commitâ ä¸é¢å¹¶è¢«æ è®°ä¸ºçº¢è²ï¼å ä¸ºè¯¥æ¡ç®å¨ç´¢å¼ä¸å·¥ä½ç®å½ä¹é´å­å¨ä¸åã æ¥çæä»¬è¿è¡ git add æ¥å°å®æå­å°ç´¢å¼ä¸­ã\n\n\n\næ­¤æ¶ï¼ç±äºç´¢å¼å HEAD ä¸åï¼è¥è¿è¡ git status çè¯å°±ä¼çå° âChanges to be committedâ ä¸çè¯¥æä»¶åä¸ºç»¿è² ââä¹å°±æ¯è¯´ï¼ç°å¨é¢æçä¸ä¸æ¬¡æäº¤ä¸ä¸ä¸æ¬¡æäº¤ä¸åã æåï¼æä»¬è¿è¡ git commit æ¥å®ææäº¤ã\n\n\n\nç°å¨è¿è¡ git status ä¼æ²¡æè¾åºï¼å ä¸ºä¸æ£µæ ååå¾ç¸åäºã\n\nåæ¢åæ¯æåéçè¿ç¨ä¹ç±»ä¼¼ã å½æ£åºä¸ä¸ªåæ¯æ¶ï¼å®ä¼ä¿®æ¹ HEAD æåæ°çåæ¯å¼ç¨ï¼å° ç´¢å¼ å¡«åä¸ºè¯¥æ¬¡æäº¤çå¿«ç§ï¼ ç¶åå° ç´¢å¼ çåå®¹å¤å¶å° å·¥ä½ç®å½ ä¸­ã\n\n\n# éç½®çä½ç¨\n\nå¨ä»¥ä¸ææ¯ä¸­è§å¯ reset å½ä»¤ä¼æ´ææä¹ã\n\nä¸ºäºæ¼ç¤ºè¿äºä¾å­ï¼åè®¾æä»¬åæ¬¡ä¿®æ¹äº file.txt æä»¶å¹¶ç¬¬ä¸æ¬¡æäº¤å®ã ç°å¨çåå²çèµ·æ¥æ¯è¿æ ·çï¼\n\n\n\nè®©æä»¬è·ç reset ççå®é½åäºä»ä¹ã å®ä»¥ä¸ç§ç®åå¯é¢è§çæ¹å¼ç´æ¥æçºµè¿ä¸æ£µæ ã å®åäºä¸ä¸ªåºæ¬æä½ã\n\n\n# ç¬¬ 1 æ­¥ï¼ç§»å¨ HEAD\n\nreset åçç¬¬ä¸ä»¶äºæ¯ç§»å¨ HEAD çæåã è¿ä¸æ¹å HEAD èªèº«ä¸åï¼checkout æåçï¼ï¼reset ç§»å¨ HEAD æåçåæ¯ã è¿æå³çå¦æ HEAD è®¾ç½®ä¸º master åæ¯ï¼ä¾å¦ï¼ä½ æ­£å¨ master åæ¯ä¸ï¼ï¼ è¿è¡ git reset 9e5e6a4 å°ä¼ä½¿ master æå 9e5e6a4ã\n\n\n\næ è®ºä½ è°ç¨äºä½ç§å½¢å¼çå¸¦æä¸ä¸ªæäº¤ç resetï¼å®é¦åé½ä¼å°è¯è¿æ ·åã ä½¿ç¨ reset --softï¼å®å°ä»ä»åå¨é£å¿ã\n\nç°å¨çä¸ç¼ä¸å¾ï¼çè§£ä¸ä¸åççäºæï¼å®æ¬è´¨ä¸æ¯æ¤éäºä¸ä¸æ¬¡ git commit å½ä»¤ã å½ä½ å¨è¿è¡ git commit æ¶ï¼Git ä¼åå»ºä¸ä¸ªæ°çæäº¤ï¼å¹¶ç§»å¨ HEAD ææåçåæ¯æ¥ä½¿å¶æåè¯¥æäº¤ã å½ä½ å°å® reset å HEAD~ï¼HEAD çç¶ç»ç¹ï¼æ¶ï¼å¶å®å°±æ¯æè¯¥åæ¯ç§»å¨ååæ¥çä½ç½®ï¼èä¸ä¼æ¹åç´¢å¼åå·¥ä½ç®å½ã ç°å¨ä½ å¯ä»¥æ´æ°ç´¢å¼å¹¶åæ¬¡è¿è¡ git commit æ¥å®æ git commit --amend æè¦åçäºæäºï¼è§ ä¿®æ¹æåä¸æ¬¡æäº¤ï¼ã\n\n\n# ç¬¬ 2 æ­¥ï¼æ´æ°ç´¢å¼ï¼--mixedï¼\n\næ³¨æï¼å¦æä½ ç°å¨è¿è¡ git status çè¯ï¼å°±ä¼çå°æ°ç HEAD åä»¥ç»¿è²æ åºçå®åç´¢å¼ä¹é´çåºå«ã\n\næ¥ä¸æ¥ï¼reset ä¼ç¨ HEAD æåçå½åå¿«ç§çåå®¹æ¥æ´æ°ç´¢å¼ã\n\n\n\nå¦ææå® --mixed éé¡¹ï¼reset å°ä¼å¨è¿æ¶åæ­¢ã è¿ä¹æ¯é»è®¤è¡ä¸ºï¼æä»¥å¦ææ²¡ææå®ä»»ä½éé¡¹ï¼å¨æ¬ä¾ä¸­åªæ¯ git reset HEAD~ï¼ï¼è¿å°±æ¯å½ä»¤å°ä¼åæ­¢çå°æ¹ã\n\nç°å¨åçä¸ç¼ä¸å¾ï¼çè§£ä¸ä¸åççäºæï¼å®ä¾ç¶ä¼æ¤éä¸ä¸æ¬¡ æäº¤ï¼ä½è¿ä¼ åæ¶æå­ ææçä¸è¥¿ã äºæ¯ï¼æä»¬åæ»å°äºææ git add å git commit çå½ä»¤æ§è¡ä¹åã\n\n\n# ç¬¬ 3 æ­¥ï¼æ´æ°å·¥ä½ç®å½ï¼--hardï¼\n\nreset è¦åççç¬¬ä¸ä»¶äºæå°±æ¯è®©å·¥ä½ç®å½çèµ·æ¥åç´¢å¼ã å¦æä½¿ç¨ --hard éé¡¹ï¼å®å°ä¼ç»§ç»­è¿ä¸æ­¥ã\n\n\n\nç°å¨è®©æä»¬åæ³ä¸ä¸åæåççäºæã ä½ æ¤éäºæåçæäº¤ãgit add å git commit å½ä»¤ ä»¥å å·¥ä½ç®å½ä¸­çææå·¥ä½ã\n\nå¿é¡»æ³¨æï¼--hard æ è®°æ¯ reset å½ä»¤å¯ä¸çå±é©ç¨æ³ï¼å®ä¹æ¯ Git ä¼çæ­£å°éæ¯æ°æ®çä»æçå ä¸ªæä½ä¹ä¸ã å¶ä»ä»»ä½å½¢å¼ç reset è°ç¨é½å¯ä»¥è½»æ¾æ¤æ¶ï¼ä½æ¯ --hard éé¡¹ä¸è½ï¼å ä¸ºå®å¼ºå¶è¦çäºå·¥ä½ç®å½ä¸­çæä»¶ã å¨è¿ç§ç¹æ®æåµä¸ï¼æä»¬ç Git æ°æ®åºä¸­çä¸ä¸ªæäº¤åè¿çæè¯¥æä»¶ç v3 çæ¬ï¼ æä»¬å¯ä»¥éè¿ reflog æ¥æ¾åå®ãä½æ¯è¥è¯¥æä»¶è¿æªæäº¤ï¼Git ä»ä¼è¦çå®ä»èå¯¼è´æ æ³æ¢å¤ã\n\n\n# åé¡¾\n\nreset å½ä»¤ä¼ä»¥ç¹å®çé¡ºåºéåè¿ä¸æ£µæ ï¼å¨ä½ æå®ä»¥ä¸éé¡¹æ¶åæ­¢ï¼\n\n 1. ç§»å¨ HEAD åæ¯çæå ï¼è¥æå®äº --softï¼åå°æ­¤åæ­¢ï¼\n 2. ä½¿ç´¢å¼çèµ·æ¥å HEAD ï¼è¥æªæå® --hardï¼åå°æ­¤åæ­¢ï¼\n 3. ä½¿å·¥ä½ç®å½çèµ·æ¥åç´¢å¼\n\n\n# éè¿è·¯å¾æ¥éç½®\n\nåé¢è®²è¿°äº reset åºæ¬å½¢å¼çè¡ä¸ºï¼ä¸è¿ä½ è¿å¯ä»¥ç»å®æä¾ä¸ä¸ªä½ç¨è·¯å¾ã è¥æå®äºä¸ä¸ªè·¯å¾ï¼reset å°ä¼è·³è¿ç¬¬ 1 æ­¥ï¼å¹¶ä¸å°å®çä½ç¨èå´éå®ä¸ºæå®çæä»¶ææä»¶éåã è¿æ ·åèªç¶æå®çéçï¼å ä¸º HEAD åªæ¯ä¸ä¸ªæéï¼ä½ æ æ³è®©å®åæ¶æåä¸¤ä¸ªæäº¤ä¸­åèªçä¸é¨åã ä¸è¿ç´¢å¼åå·¥ä½ç®å½ å¯ä»¥é¨åæ´æ°ï¼æä»¥éç½®ä¼ç»§ç»­è¿è¡ç¬¬ 2ã3 æ­¥ã\n\nç°å¨ï¼åå¦æä»¬è¿è¡ git reset file.txt ï¼è¿å¶å®æ¯ git reset --mixed HEAD file.txt çç®åå½¢å¼ï¼å ä¸ºä½ æ¢æ²¡ææå®ä¸ä¸ªæäº¤ç SHA-1 æåæ¯ï¼ä¹æ²¡ææå® --soft æ --hardï¼ï¼å®ä¼ï¼\n\n 1. ç§»å¨ HEAD åæ¯çæå ï¼å·²è·³è¿ï¼\n 2. è®©ç´¢å¼çèµ·æ¥å HEAD ï¼å°æ­¤å¤åæ­¢ï¼\n\næä»¥å®æ¬è´¨ä¸åªæ¯å° file.txt ä» HEAD å¤å¶å°ç´¢å¼ä¸­ã\n\n\n\nå®è¿æ åæ¶æå­æä»¶ çå®éææã å¦ææä»¬æ¥çè¯¥å½ä»¤çç¤ºæå¾ï¼ç¶ååæ³æ³ git add æåçäºï¼å°±ä¼åç°å®ä»¬æ­£å¥½ç¸åã\n\n\n\nè¿å°±æ¯ä¸ºä»ä¹ git status å½ä»¤çè¾åºä¼å»ºè®®è¿è¡æ­¤å½ä»¤æ¥åæ¶æå­ä¸ä¸ªæä»¶ã ï¼æ¥ç åæ¶æå­çæä»¶ æ¥äºè§£æ´å¤ãï¼\n\næä»¬å¯ä»¥ä¸è®© Git ä» HEAD æåæ°æ®ï¼èæ¯éè¿å·ä½æå®ä¸ä¸ªæäº¤æ¥æåè¯¥æä»¶çå¯¹åºçæ¬ã æä»¬åªéè¿è¡ç±»ä¼¼äº git reset eb43bf file.txt çå½ä»¤å³å¯ã\n\n\n\nå®å¶å®åäºåæ ·çäºæï¼ä¹å°±æ¯æå·¥ä½ç®å½ä¸­çæä»¶æ¢å¤å° v1 çæ¬ï¼è¿è¡ git add æ·»å å®ï¼ ç¶ååå°å®æ¢å¤å° v3 çæ¬ï¼åªæ¯ä¸ç¨ççè¿ä¸éè¿äºæ­¥éª¤ï¼ã å¦ææä»¬ç°å¨è¿è¡ git commitï¼å®å°±ä¼è®°å½ä¸æ¡âå°è¯¥æä»¶æ¢å¤å° v1 çæ¬âçæ´æ¹ï¼ å°½ç®¡æä»¬å¹¶æªå¨å·¥ä½ç®å½ä¸­çæ­£å°åæ¬¡æ¥æå®ã\n\nè¿æä¸ç¹å git add ä¸æ ·ï¼å°±æ¯ reset å½ä»¤ä¹å¯ä»¥æ¥åä¸ä¸ª --patch éé¡¹æ¥ä¸åä¸åå°åæ¶æå­çåå®¹ã è¿æ ·ä½ å°±å¯ä»¥æ ¹æ®éæ©æ¥åæ¶æå­ææ¢å¤åå®¹äºã\n\n\n# åç¼©\n\næä»¬æ¥ççå¦ä½å©ç¨è¿ç§æ°çåè½æ¥åä¸äºæè¶£çäºæââåç¼©æäº¤ã\n\nåè®¾ä½ çä¸ç³»åæäº¤ä¿¡æ¯ä¸­æ âoops.ââWIPâ å âforgot this fileâï¼ èªæçä½ å°±è½ä½¿ç¨ reset æ¥è½»æ¾å¿«éå°å°å®ä»¬åç¼©æåä¸ªæäº¤ï¼ä¹æ¾åºä½ çèªæã ï¼åç¼©æäº¤ å±ç¤ºäºå¦ä¸ç§æ¹å¼ï¼ä¸è¿å¨æ¬ä¾ä¸­ç¨ reset æ´ç®åãï¼\n\nåè®¾ä½ æä¸ä¸ªé¡¹ç®ï¼ç¬¬ä¸æ¬¡æäº¤ä¸­æä¸ä¸ªæä»¶ï¼ç¬¬äºæ¬¡æäº¤å¢å äºä¸ä¸ªæ°çæä»¶å¹¶ä¿®æ¹äºç¬¬ä¸ä¸ªæä»¶ï¼ç¬¬ä¸æ¬¡æäº¤åæ¬¡ä¿®æ¹äºç¬¬ä¸ä¸ªæä»¶ã ç±äºç¬¬äºæ¬¡æäº¤æ¯ä¸ä¸ªæªå®æçå·¥ä½ï¼å æ­¤ä½ æ³è¦åç¼©å®ã\n\n\n\né£ä¹å¯ä»¥è¿è¡ git reset --soft HEAD~2 æ¥å° HEAD åæ¯ç§»å¨å°ä¸ä¸ªæ§ä¸ç¹çæäº¤ä¸ï¼å³ä½ æ³è¦ä¿ççæè¿çæäº¤ï¼ï¼\n\n\n\nç¶ååªéåæ¬¡è¿è¡ git commitï¼\n\n\n\nç°å¨ä½ å¯ä»¥æ¥çå¯å°è¾¾çåå²ï¼å³å°ä¼æ¨éçåå²ï¼ç°å¨çèµ·æ¥æä¸ª v1 ç file-a.txt çæäº¤ï¼ æ¥çç¬¬äºä¸ªæäº¤å° file-a.txt ä¿®æ¹æäº v3 çå¹¶å¢å äº file-b.txtã åå« v2 çæ¬çæä»¶å·²ç»ä¸å¨åå²ä¸­äºã\n\n\n# æ£åº\n\næåï¼ä½ å¤§æ¦è¿æ³ç¥é checkout å reset ä¹é´çåºå«ã å reset ä¸æ ·ï¼checkout ä¹æçºµä¸æ£µæ ï¼ä¸è¿å®æä¸ç¹ä¸åï¼è¿åå³äºä½ æ¯å¦ä¼ ç»è¯¥å½ä»¤ä¸ä¸ªæä»¶è·¯å¾ã\n\n\n# ä¸å¸¦è·¯å¾\n\nè¿è¡ git checkout [branch] ä¸è¿è¡ git reset --hard [branch] éå¸¸ç¸ä¼¼ï¼å®ä¼æ´æ°ææä¸æ£µæ ä½¿å¶çèµ·æ¥å [branch]ï¼ä¸è¿æä¸¤ç¹éè¦çåºå«ã\n\né¦åä¸åäº reset --hardï¼checkout å¯¹å·¥ä½ç®å½æ¯å®å¨çï¼å®ä¼éè¿æ£æ¥æ¥ç¡®ä¿ä¸ä¼å°å·²æ´æ¹çæä»¶å¼ä¸¢ã å¶å®å®è¿æ´èªæä¸äºãå®ä¼å¨å·¥ä½ç®å½ä¸­åè¯çç®ååå¹¶ä¸ä¸ï¼è¿æ ·ææ_è¿æªä¿®æ¹è¿ç_æä»¶é½ä¼è¢«æ´æ°ã è reset --hard åä¼ä¸åæ£æ¥å°±å¨é¢å°æ¿æ¢ææä¸è¥¿ã\n\nç¬¬äºä¸ªéè¦çåºå«æ¯ checkout å¦ä½æ´æ° HEADã reset ä¼ç§»å¨ HEAD åæ¯çæåï¼è checkout åªä¼ç§»å¨ HEAD èªèº«æ¥æåå¦ä¸ä¸ªåæ¯ã\n\nä¾å¦ï¼åè®¾æä»¬æ master å develop åæ¯ï¼å®ä»¬åå«æåä¸åçæäº¤ï¼æä»¬ç°å¨å¨ develop ä¸ï¼æä»¥ HEAD æåå®ï¼ã å¦ææä»¬è¿è¡ git reset masterï¼é£ä¹ develop èªèº«ç°å¨ä¼å master æååä¸ä¸ªæäº¤ã èå¦ææä»¬è¿è¡ git checkout master çè¯ï¼develop ä¸ä¼ç§»å¨ï¼HEAD èªèº«ä¼ç§»å¨ã ç°å¨ HEAD å°ä¼æå masterã\n\næä»¥ï¼è½ç¶å¨è¿ä¸¤ç§æåµä¸æä»¬é½ç§»å¨ HEAD ä½¿å¶æåäºæäº¤ Aï¼ä½_åæ³_æ¯éå¸¸ä¸åçã reset ä¼ç§»å¨ HEAD åæ¯çæåï¼è checkout åç§»å¨ HEAD èªèº«ã\n\n\n\n\n# å¸¦è·¯å¾\n\nè¿è¡ checkout çå¦ä¸ç§æ¹å¼å°±æ¯æå®ä¸ä¸ªæä»¶è·¯å¾ï¼è¿ä¼å reset ä¸æ ·ä¸ä¼ç§»å¨ HEADã å®å°±å git reset [branch] file é£æ ·ç¨è¯¥æ¬¡æäº¤ä¸­çé£ä¸ªæä»¶æ¥æ´æ°ç´¢å¼ï¼ä½æ¯å®ä¹ä¼è¦çå·¥ä½ç®å½ä¸­å¯¹åºçæä»¶ã å®å°±åæ¯ git reset --hard [branch] fileï¼å¦æ reset åè®¸ä½ è¿æ ·è¿è¡çè¯ï¼ï¼ è¿æ ·å¯¹å·¥ä½ç®å½å¹¶ä¸å®å¨ï¼å®ä¹ä¸ä¼ç§»å¨ HEADã\n\næ­¤å¤ï¼å git reset å git add ä¸æ ·ï¼checkout ä¹æ¥åä¸ä¸ª --patch éé¡¹ï¼åè®¸ä½ æ ¹æ®éæ©ä¸åä¸åå°æ¢å¤æä»¶åå®¹ã\n\n\n# æ»ç»\n\nå¸æä½ ç°å¨çæå¹¶çè§£äº reset å½ä»¤ï¼ä¸è¿å³äºå®å checkout ä¹é´çåºå«ï¼ä½ å¯è½è¿æ¯ä¼æç¹å°æï¼æ¯ç«ä¸å¤ªå¯è½è®°ä½ä¸åè°ç¨çææè§åã\n\nä¸é¢çéæ¥è¡¨ååºäºå½ä»¤å¯¹æ çå½±åã âHEADâ ä¸åä¸­ç âREFâ è¡¨ç¤ºè¯¥å½ä»¤ç§»å¨äº HEAD æåçåæ¯å¼ç¨ï¼è âHEADâ åè¡¨ç¤ºåªç§»å¨äº HEAD èªèº«ã ç¹å«æ³¨æ WD Safe? ä¸åââå¦æå®æ è®°ä¸º NOï¼é£ä¹è¿è¡è¯¥å½ä»¤ä¹åè¯·èèä¸ä¸ã\n\n                            HEAD   INDEX   WORKDIR   WD SAFE?\nCommit Level                                         \nreset --soft [commit]       REF    NO      NO        YES\nreset [commit]              REF    YES     NO        YES\nreset --hard [commit]       REF    YES     YES       NO\ncheckout <commit>           HEAD   YES     YES       YES\nFile Level                                           \nreset [commit] <paths>      NO     YES     NO        YES\ncheckout [commit] <paths>   NO     YES     YES       NO",normalizedContent:"# git å·¥å· - éç½®æ­å¯\n\nå¨ç»§ç»­äºè§£æ´ä¸ä¸çå·¥å·åï¼æä»¬åæ¢è®¨ä¸ä¸ git ç reset å checkout å½ä»¤ã å¨åéç git å½ä»¤ä¸­ï¼è¿ä¸¤ä¸ªæ¯æè®©äººå°æçã å®ä»¬è½åå¾å¤äºæï¼æä»¥çèµ·æ¥æä»¬å¾é¾çæ­£å°çè§£å¹¶æ°å½å°è¿ç¨å®ä»¬ã éå¯¹è¿ä¸ç¹ï¼æä»¬åæ¥åä¸ä¸ªç®åçæ¯å»ã\n\n\n# ä¸æ£µæ \n\nçè§£ reset å checkout çæç®æ¹æ³ï¼å°±æ¯ä»¥ git çæç»´æ¡æ¶ï¼å°å¶ä½ä¸ºåå®¹ç®¡çå¨ï¼æ¥ç®¡çä¸æ£µä¸åçæ ã âæ â å¨æä»¬è¿éçå®éæææ¯ âæä»¶çéåâï¼èä¸æ¯æç¹å®çæ°æ®ç»æã ï¼å¨æäºæåµä¸ç´¢å¼çèµ·æ¥å¹¶ä¸åä¸æ£µæ ï¼ä¸è¿æä»¬ç°å¨çç®çæ¯ç¨ç®åçæ¹å¼æèå®ãï¼\n\ngit ä½ä¸ºä¸ä¸ªç³»ç»ï¼æ¯ä»¥å®çä¸è¬æä½æ¥ç®¡çå¹¶æçºµè¿ä¸æ£µæ çï¼\n\næ                    ç¨é\nhead                ä¸ä¸æ¬¡æäº¤çå¿«ç§ï¼ä¸ä¸æ¬¡æäº¤çç¶ç»ç¹\nindex               é¢æçä¸ä¸æ¬¡æäº¤çå¿«ç§\nworking directory   æ²ç\n\n\n# head\n\nhead æ¯å½ååæ¯å¼ç¨çæéï¼å®æ»æ¯æåè¯¥åæ¯ä¸çæåä¸æ¬¡æäº¤ã è¿è¡¨ç¤º head å°æ¯ä¸ä¸æ¬¡æäº¤çç¶ç»ç¹ã éå¸¸ï¼çè§£ head çæç®æ¹å¼ï¼å°±æ¯å°å®çå è¯¥åæ¯ä¸çæåä¸æ¬¡æäº¤ çå¿«ç§ã\n\nå¶å®ï¼æ¥çå¿«ç§çæ ·å­å¾å®¹æã ä¸ä¾å°±æ¾ç¤ºäº head å¿«ç§å®éçç®å½åè¡¨ï¼ä»¥åå¶ä¸­æ¯ä¸ªæä»¶ç sha-1 æ ¡éªåï¼\n\n$ git cat-file -p head\ntree cfda3bf379e4f8dba8717dee55aab78aef7f4daf\nauthor scott chacon  1301511835 -0700\ncommitter scott chacon  1301511835 -0700\n\ninitial commit\n\n$ git ls-tree -r head\n100644 blob a906cb2a4a904a152...   readme\n100644 blob 8f94139338f9404f2...   rakefile\n040000 tree 99f1a6d12cb4b6f19...   lib\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\ngit ç cat-file å ls-tree æ¯åºå±å½ä»¤ï¼å®ä»¬ä¸è¬ç¨äºåºå±å·¥ä½ï¼å¨æ¥å¸¸å·¥ä½ä¸­å¹¶ä¸ä½¿ç¨ã ä¸è¿å®ä»¬è½å¸®å©æä»¬äºè§£å°åºåçäºä»ä¹ã\n\n\n# ç´¢å¼\n\nç´¢å¼æ¯ä½ ç é¢æçä¸ä¸æ¬¡æäº¤ã æä»¬ä¹ä¼å°è¿ä¸ªæ¦å¿µå¼ç¨ä¸º git çâæå­åºâï¼è¿å°±æ¯å½ä½ è¿è¡ git commit æ¶ git çèµ·æ¥çæ ·å­ã\n\ngit å°ä¸ä¸æ¬¡æ£åºå°å·¥ä½ç®å½ä¸­çæææä»¶å¡«åå°ç´¢å¼åºï¼å®ä»¬çèµ·æ¥å°±åæåè¢«æ£åºæ¶çæ ·å­ã ä¹åä½ ä¼å°å¶ä¸­ä¸äºæä»¶æ¿æ¢ä¸ºæ°çæ¬ï¼æ¥çéè¿ git commit å°å®ä»¬è½¬æ¢ä¸ºæ æ¥ç¨ä½æ°çæäº¤ã\n\n$ git ls-files -s\n100644 a906cb2a4a904a152e80877d4088654daad0c859 0\treadme\n100644 8f94139338f9404f26296befa88755fc2598c289 0\trakefile\n100644 47c6340d6459e05787f644c2447d2595f5d3a54b 0\tlib/simplegit.rb\n\n\n1\n2\n3\n4\n\n\nåè¯´ä¸æ¬¡ï¼æä»¬å¨è¿éåç¨å°äº git ls-files è¿ä¸ªå¹åçå½ä»¤ï¼å®ä¼æ¾ç¤ºåºç´¢å¼å½åçæ ·å­ã\n\nç¡®åæ¥è¯´ï¼ç´¢å¼å¨ææ¯ä¸å¹¶éæ ç»æï¼å®å¶å®æ¯ä»¥æå¹³çæ¸åå®ç°çãä¸è¿å¯¹æä»¬èè¨ï¼æå®å½åæ å°±å¤äºã\n\n\n# å·¥ä½ç®å½\n\næåï¼ä½ å°±æäºèªå·±ç å·¥ä½ç®å½ï¼éå¸¸ä¹å« å·¥ä½åºï¼ã å¦å¤ä¸¤æ£µæ ä»¥ä¸ç§é«æä½å¹¶ä¸ç´è§çæ¹å¼ï¼å°å®ä»¬çåå®¹å­å¨å¨ .git æä»¶å¤¹ä¸­ã å·¥ä½ç®å½ä¼å°å®ä»¬è§£åä¸ºå®éçæä»¶ä»¥ä¾¿ç¼è¾ã ä½ å¯ä»¥æå·¥ä½ç®å½å½å æ²çãå¨ä½ å°ä¿®æ¹æäº¤å°æå­åºå¹¶è®°å½å°åå²ä¹åï¼å¯ä»¥éææ´æ¹ã\n\n$ tree\n.\nâââ readme\nâââ rakefile\nâââ lib\n    âââ simplegit.rb\n\n1 directory, 3 files\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# å·¥ä½æµç¨\n\nç»å¸ç git å·¥ä½æµç¨æ¯éè¿æçºµè¿ä¸ä¸ªåºåæ¥ä»¥æ´å è¿ç»­çç¶æè®°å½é¡¹ç®å¿«ç§çã\n\n\n\nè®©æä»¬æ¥å¯è§åè¿ä¸ªè¿ç¨ï¼åè®¾æä»¬è¿å¥å°ä¸ä¸ªæ°ç®å½ï¼å¶ä¸­æä¸ä¸ªæä»¶ã æä»¬ç§°å¶ä¸ºè¯¥æä»¶ç v1 çæ¬ï¼å°å®æ è®°ä¸ºèè²ã ç°å¨è¿è¡ git initï¼è¿ä¼åå»ºä¸ä¸ª git ä»åºï¼å¶ä¸­ç head å¼ç¨æåæªåå»ºç master åæ¯ã\n\n\n\næ­¤æ¶ï¼åªæå·¥ä½ç®å½æåå®¹ã\n\nç°å¨æä»¬æ³è¦æäº¤è¿ä¸ªæä»¶ï¼æä»¥ç¨ git add æ¥è·åå·¥ä½ç®å½ä¸­çåå®¹ï¼å¹¶å°å¶å¤å¶å°ç´¢å¼ä¸­ã\n\n\n\næ¥çè¿è¡ git commitï¼å®ä¼åå¾ç´¢å¼ä¸­çåå®¹å¹¶å°å®ä¿å­ä¸ºä¸ä¸ªæ°¸ä¹çå¿«ç§ï¼ ç¶ååå»ºä¸ä¸ªæåè¯¥å¿«ç§çæäº¤å¯¹è±¡ï¼æåæ´æ° master æ¥æåæ¬æ¬¡æäº¤ã\n\n\n\næ­¤æ¶å¦ææä»¬è¿è¡ git statusï¼ä¼åç°æ²¡æä»»ä½æ¹å¨ï¼å ä¸ºç°å¨ä¸æ£µæ å®å¨ç¸åã\n\nç°å¨æä»¬æ³è¦å¯¹æä»¶è¿è¡ä¿®æ¹ç¶åæäº¤å®ã æä»¬å°ä¼ç»ååæ ·çè¿ç¨ï¼é¦åå¨å·¥ä½ç®å½ä¸­ä¿®æ¹æä»¶ã æä»¬ç§°å¶ä¸ºè¯¥æä»¶ç v2 çæ¬ï¼å¹¶å°å®æ è®°ä¸ºçº¢è²ã\n\n\n\nå¦æç°å¨è¿è¡ git statusï¼æä»¬ä¼çå°æä»¶æ¾ç¤ºå¨ âchanges not staged for commitâ ä¸é¢å¹¶è¢«æ è®°ä¸ºçº¢è²ï¼å ä¸ºè¯¥æ¡ç®å¨ç´¢å¼ä¸å·¥ä½ç®å½ä¹é´å­å¨ä¸åã æ¥çæä»¬è¿è¡ git add æ¥å°å®æå­å°ç´¢å¼ä¸­ã\n\n\n\næ­¤æ¶ï¼ç±äºç´¢å¼å head ä¸åï¼è¥è¿è¡ git status çè¯å°±ä¼çå° âchanges to be committedâ ä¸çè¯¥æä»¶åä¸ºç»¿è² ââä¹å°±æ¯è¯´ï¼ç°å¨é¢æçä¸ä¸æ¬¡æäº¤ä¸ä¸ä¸æ¬¡æäº¤ä¸åã æåï¼æä»¬è¿è¡ git commit æ¥å®ææäº¤ã\n\n\n\nç°å¨è¿è¡ git status ä¼æ²¡æè¾åºï¼å ä¸ºä¸æ£µæ ååå¾ç¸åäºã\n\nåæ¢åæ¯æåéçè¿ç¨ä¹ç±»ä¼¼ã å½æ£åºä¸ä¸ªåæ¯æ¶ï¼å®ä¼ä¿®æ¹ head æåæ°çåæ¯å¼ç¨ï¼å° ç´¢å¼ å¡«åä¸ºè¯¥æ¬¡æäº¤çå¿«ç§ï¼ ç¶åå° ç´¢å¼ çåå®¹å¤å¶å° å·¥ä½ç®å½ ä¸­ã\n\n\n# éç½®çä½ç¨\n\nå¨ä»¥ä¸ææ¯ä¸­è§å¯ reset å½ä»¤ä¼æ´ææä¹ã\n\nä¸ºäºæ¼ç¤ºè¿äºä¾å­ï¼åè®¾æä»¬åæ¬¡ä¿®æ¹äº file.txt æä»¶å¹¶ç¬¬ä¸æ¬¡æäº¤å®ã ç°å¨çåå²çèµ·æ¥æ¯è¿æ ·çï¼\n\n\n\nè®©æä»¬è·ç reset ççå®é½åäºä»ä¹ã å®ä»¥ä¸ç§ç®åå¯é¢è§çæ¹å¼ç´æ¥æçºµè¿ä¸æ£µæ ã å®åäºä¸ä¸ªåºæ¬æä½ã\n\n\n# ç¬¬ 1 æ­¥ï¼ç§»å¨ head\n\nreset åçç¬¬ä¸ä»¶äºæ¯ç§»å¨ head çæåã è¿ä¸æ¹å head èªèº«ä¸åï¼checkout æåçï¼ï¼reset ç§»å¨ head æåçåæ¯ã è¿æå³çå¦æ head è®¾ç½®ä¸º master åæ¯ï¼ä¾å¦ï¼ä½ æ­£å¨ master åæ¯ä¸ï¼ï¼ è¿è¡ git reset 9e5e6a4 å°ä¼ä½¿ master æå 9e5e6a4ã\n\n\n\næ è®ºä½ è°ç¨äºä½ç§å½¢å¼çå¸¦æä¸ä¸ªæäº¤ç resetï¼å®é¦åé½ä¼å°è¯è¿æ ·åã ä½¿ç¨ reset --softï¼å®å°ä»ä»åå¨é£å¿ã\n\nç°å¨çä¸ç¼ä¸å¾ï¼çè§£ä¸ä¸åççäºæï¼å®æ¬è´¨ä¸æ¯æ¤éäºä¸ä¸æ¬¡ git commit å½ä»¤ã å½ä½ å¨è¿è¡ git commit æ¶ï¼git ä¼åå»ºä¸ä¸ªæ°çæäº¤ï¼å¹¶ç§»å¨ head ææåçåæ¯æ¥ä½¿å¶æåè¯¥æäº¤ã å½ä½ å°å® reset å head~ï¼head çç¶ç»ç¹ï¼æ¶ï¼å¶å®å°±æ¯æè¯¥åæ¯ç§»å¨ååæ¥çä½ç½®ï¼èä¸ä¼æ¹åç´¢å¼åå·¥ä½ç®å½ã ç°å¨ä½ å¯ä»¥æ´æ°ç´¢å¼å¹¶åæ¬¡è¿è¡ git commit æ¥å®æ git commit --amend æè¦åçäºæäºï¼è§ ä¿®æ¹æåä¸æ¬¡æäº¤ï¼ã\n\n\n# ç¬¬ 2 æ­¥ï¼æ´æ°ç´¢å¼ï¼--mixedï¼\n\næ³¨æï¼å¦æä½ ç°å¨è¿è¡ git status çè¯ï¼å°±ä¼çå°æ°ç head åä»¥ç»¿è²æ åºçå®åç´¢å¼ä¹é´çåºå«ã\n\næ¥ä¸æ¥ï¼reset ä¼ç¨ head æåçå½åå¿«ç§çåå®¹æ¥æ´æ°ç´¢å¼ã\n\n\n\nå¦ææå® --mixed éé¡¹ï¼reset å°ä¼å¨è¿æ¶åæ­¢ã è¿ä¹æ¯é»è®¤è¡ä¸ºï¼æä»¥å¦ææ²¡ææå®ä»»ä½éé¡¹ï¼å¨æ¬ä¾ä¸­åªæ¯ git reset head~ï¼ï¼è¿å°±æ¯å½ä»¤å°ä¼åæ­¢çå°æ¹ã\n\nç°å¨åçä¸ç¼ä¸å¾ï¼çè§£ä¸ä¸åççäºæï¼å®ä¾ç¶ä¼æ¤éä¸ä¸æ¬¡ æäº¤ï¼ä½è¿ä¼ åæ¶æå­ ææçä¸è¥¿ã äºæ¯ï¼æä»¬åæ»å°äºææ git add å git commit çå½ä»¤æ§è¡ä¹åã\n\n\n# ç¬¬ 3 æ­¥ï¼æ´æ°å·¥ä½ç®å½ï¼--hardï¼\n\nreset è¦åççç¬¬ä¸ä»¶äºæå°±æ¯è®©å·¥ä½ç®å½çèµ·æ¥åç´¢å¼ã å¦æä½¿ç¨ --hard éé¡¹ï¼å®å°ä¼ç»§ç»­è¿ä¸æ­¥ã\n\n\n\nç°å¨è®©æä»¬åæ³ä¸ä¸åæåççäºæã ä½ æ¤éäºæåçæäº¤ãgit add å git commit å½ä»¤ ä»¥å å·¥ä½ç®å½ä¸­çææå·¥ä½ã\n\nå¿é¡»æ³¨æï¼--hard æ è®°æ¯ reset å½ä»¤å¯ä¸çå±é©ç¨æ³ï¼å®ä¹æ¯ git ä¼çæ­£å°éæ¯æ°æ®çä»æçå ä¸ªæä½ä¹ä¸ã å¶ä»ä»»ä½å½¢å¼ç reset è°ç¨é½å¯ä»¥è½»æ¾æ¤æ¶ï¼ä½æ¯ --hard éé¡¹ä¸è½ï¼å ä¸ºå®å¼ºå¶è¦çäºå·¥ä½ç®å½ä¸­çæä»¶ã å¨è¿ç§ç¹æ®æåµä¸ï¼æä»¬ç git æ°æ®åºä¸­çä¸ä¸ªæäº¤åè¿çæè¯¥æä»¶ç v3 çæ¬ï¼ æä»¬å¯ä»¥éè¿ reflog æ¥æ¾åå®ãä½æ¯è¥è¯¥æä»¶è¿æªæäº¤ï¼git ä»ä¼è¦çå®ä»èå¯¼è´æ æ³æ¢å¤ã\n\n\n# åé¡¾\n\nreset å½ä»¤ä¼ä»¥ç¹å®çé¡ºåºéåè¿ä¸æ£µæ ï¼å¨ä½ æå®ä»¥ä¸éé¡¹æ¶åæ­¢ï¼\n\n 1. ç§»å¨ head åæ¯çæå ï¼è¥æå®äº --softï¼åå°æ­¤åæ­¢ï¼\n 2. ä½¿ç´¢å¼çèµ·æ¥å head ï¼è¥æªæå® --hardï¼åå°æ­¤åæ­¢ï¼\n 3. ä½¿å·¥ä½ç®å½çèµ·æ¥åç´¢å¼\n\n\n# éè¿è·¯å¾æ¥éç½®\n\nåé¢è®²è¿°äº reset åºæ¬å½¢å¼çè¡ä¸ºï¼ä¸è¿ä½ è¿å¯ä»¥ç»å®æä¾ä¸ä¸ªä½ç¨è·¯å¾ã è¥æå®äºä¸ä¸ªè·¯å¾ï¼reset å°ä¼è·³è¿ç¬¬ 1 æ­¥ï¼å¹¶ä¸å°å®çä½ç¨èå´éå®ä¸ºæå®çæä»¶ææä»¶éåã è¿æ ·åèªç¶æå®çéçï¼å ä¸º head åªæ¯ä¸ä¸ªæéï¼ä½ æ æ³è®©å®åæ¶æåä¸¤ä¸ªæäº¤ä¸­åèªçä¸é¨åã ä¸è¿ç´¢å¼åå·¥ä½ç®å½ å¯ä»¥é¨åæ´æ°ï¼æä»¥éç½®ä¼ç»§ç»­è¿è¡ç¬¬ 2ã3 æ­¥ã\n\nç°å¨ï¼åå¦æä»¬è¿è¡ git reset file.txt ï¼è¿å¶å®æ¯ git reset --mixed head file.txt çç®åå½¢å¼ï¼å ä¸ºä½ æ¢æ²¡ææå®ä¸ä¸ªæäº¤ç sha-1 æåæ¯ï¼ä¹æ²¡ææå® --soft æ --hardï¼ï¼å®ä¼ï¼\n\n 1. ç§»å¨ head åæ¯çæå ï¼å·²è·³è¿ï¼\n 2. è®©ç´¢å¼çèµ·æ¥å head ï¼å°æ­¤å¤åæ­¢ï¼\n\næä»¥å®æ¬è´¨ä¸åªæ¯å° file.txt ä» head å¤å¶å°ç´¢å¼ä¸­ã\n\n\n\nå®è¿æ åæ¶æå­æä»¶ çå®éææã å¦ææä»¬æ¥çè¯¥å½ä»¤çç¤ºæå¾ï¼ç¶ååæ³æ³ git add æåçäºï¼å°±ä¼åç°å®ä»¬æ­£å¥½ç¸åã\n\n\n\nè¿å°±æ¯ä¸ºä»ä¹ git status å½ä»¤çè¾åºä¼å»ºè®®è¿è¡æ­¤å½ä»¤æ¥åæ¶æå­ä¸ä¸ªæä»¶ã ï¼æ¥ç åæ¶æå­çæä»¶ æ¥äºè§£æ´å¤ãï¼\n\næä»¬å¯ä»¥ä¸è®© git ä» head æåæ°æ®ï¼èæ¯éè¿å·ä½æå®ä¸ä¸ªæäº¤æ¥æåè¯¥æä»¶çå¯¹åºçæ¬ã æä»¬åªéè¿è¡ç±»ä¼¼äº git reset eb43bf file.txt çå½ä»¤å³å¯ã\n\n\n\nå®å¶å®åäºåæ ·çäºæï¼ä¹å°±æ¯æå·¥ä½ç®å½ä¸­çæä»¶æ¢å¤å° v1 çæ¬ï¼è¿è¡ git add æ·»å å®ï¼ ç¶ååå°å®æ¢å¤å° v3 çæ¬ï¼åªæ¯ä¸ç¨ççè¿ä¸éè¿äºæ­¥éª¤ï¼ã å¦ææä»¬ç°å¨è¿è¡ git commitï¼å®å°±ä¼è®°å½ä¸æ¡âå°è¯¥æä»¶æ¢å¤å° v1 çæ¬âçæ´æ¹ï¼ å°½ç®¡æä»¬å¹¶æªå¨å·¥ä½ç®å½ä¸­çæ­£å°åæ¬¡æ¥æå®ã\n\nè¿æä¸ç¹å git add ä¸æ ·ï¼å°±æ¯ reset å½ä»¤ä¹å¯ä»¥æ¥åä¸ä¸ª --patch éé¡¹æ¥ä¸åä¸åå°åæ¶æå­çåå®¹ã è¿æ ·ä½ å°±å¯ä»¥æ ¹æ®éæ©æ¥åæ¶æå­ææ¢å¤åå®¹äºã\n\n\n# åç¼©\n\næä»¬æ¥ççå¦ä½å©ç¨è¿ç§æ°çåè½æ¥åä¸äºæè¶£çäºæââåç¼©æäº¤ã\n\nåè®¾ä½ çä¸ç³»åæäº¤ä¿¡æ¯ä¸­æ âoops.ââwipâ å âforgot this fileâï¼ èªæçä½ å°±è½ä½¿ç¨ reset æ¥è½»æ¾å¿«éå°å°å®ä»¬åç¼©æåä¸ªæäº¤ï¼ä¹æ¾åºä½ çèªæã ï¼åç¼©æäº¤ å±ç¤ºäºå¦ä¸ç§æ¹å¼ï¼ä¸è¿å¨æ¬ä¾ä¸­ç¨ reset æ´ç®åãï¼\n\nåè®¾ä½ æä¸ä¸ªé¡¹ç®ï¼ç¬¬ä¸æ¬¡æäº¤ä¸­æä¸ä¸ªæä»¶ï¼ç¬¬äºæ¬¡æäº¤å¢å äºä¸ä¸ªæ°çæä»¶å¹¶ä¿®æ¹äºç¬¬ä¸ä¸ªæä»¶ï¼ç¬¬ä¸æ¬¡æäº¤åæ¬¡ä¿®æ¹äºç¬¬ä¸ä¸ªæä»¶ã ç±äºç¬¬äºæ¬¡æäº¤æ¯ä¸ä¸ªæªå®æçå·¥ä½ï¼å æ­¤ä½ æ³è¦åç¼©å®ã\n\n\n\né£ä¹å¯ä»¥è¿è¡ git reset --soft head~2 æ¥å° head åæ¯ç§»å¨å°ä¸ä¸ªæ§ä¸ç¹çæäº¤ä¸ï¼å³ä½ æ³è¦ä¿ççæè¿çæäº¤ï¼ï¼\n\n\n\nç¶ååªéåæ¬¡è¿è¡ git commitï¼\n\n\n\nç°å¨ä½ å¯ä»¥æ¥çå¯å°è¾¾çåå²ï¼å³å°ä¼æ¨éçåå²ï¼ç°å¨çèµ·æ¥æä¸ª v1 ç file-a.txt çæäº¤ï¼ æ¥çç¬¬äºä¸ªæäº¤å° file-a.txt ä¿®æ¹æäº v3 çå¹¶å¢å äº file-b.txtã åå« v2 çæ¬çæä»¶å·²ç»ä¸å¨åå²ä¸­äºã\n\n\n# æ£åº\n\næåï¼ä½ å¤§æ¦è¿æ³ç¥é checkout å reset ä¹é´çåºå«ã å reset ä¸æ ·ï¼checkout ä¹æçºµä¸æ£µæ ï¼ä¸è¿å®æä¸ç¹ä¸åï¼è¿åå³äºä½ æ¯å¦ä¼ ç»è¯¥å½ä»¤ä¸ä¸ªæä»¶è·¯å¾ã\n\n\n# ä¸å¸¦è·¯å¾\n\nè¿è¡ git checkout [branch] ä¸è¿è¡ git reset --hard [branch] éå¸¸ç¸ä¼¼ï¼å®ä¼æ´æ°ææä¸æ£µæ ä½¿å¶çèµ·æ¥å [branch]ï¼ä¸è¿æä¸¤ç¹éè¦çåºå«ã\n\né¦åä¸åäº reset --hardï¼checkout å¯¹å·¥ä½ç®å½æ¯å®å¨çï¼å®ä¼éè¿æ£æ¥æ¥ç¡®ä¿ä¸ä¼å°å·²æ´æ¹çæä»¶å¼ä¸¢ã å¶å®å®è¿æ´èªæä¸äºãå®ä¼å¨å·¥ä½ç®å½ä¸­åè¯çç®ååå¹¶ä¸ä¸ï¼è¿æ ·ææ_è¿æªä¿®æ¹è¿ç_æä»¶é½ä¼è¢«æ´æ°ã è reset --hard åä¼ä¸åæ£æ¥å°±å¨é¢å°æ¿æ¢ææä¸è¥¿ã\n\nç¬¬äºä¸ªéè¦çåºå«æ¯ checkout å¦ä½æ´æ° headã reset ä¼ç§»å¨ head åæ¯çæåï¼è checkout åªä¼ç§»å¨ head èªèº«æ¥æåå¦ä¸ä¸ªåæ¯ã\n\nä¾å¦ï¼åè®¾æä»¬æ master å develop åæ¯ï¼å®ä»¬åå«æåä¸åçæäº¤ï¼æä»¬ç°å¨å¨ develop ä¸ï¼æä»¥ head æåå®ï¼ã å¦ææä»¬è¿è¡ git reset masterï¼é£ä¹ develop èªèº«ç°å¨ä¼å master æååä¸ä¸ªæäº¤ã èå¦ææä»¬è¿è¡ git checkout master çè¯ï¼develop ä¸ä¼ç§»å¨ï¼head èªèº«ä¼ç§»å¨ã ç°å¨ head å°ä¼æå masterã\n\næä»¥ï¼è½ç¶å¨è¿ä¸¤ç§æåµä¸æä»¬é½ç§»å¨ head ä½¿å¶æåäºæäº¤ aï¼ä½_åæ³_æ¯éå¸¸ä¸åçã reset ä¼ç§»å¨ head åæ¯çæåï¼è checkout åç§»å¨ head èªèº«ã\n\n\n\n\n# å¸¦è·¯å¾\n\nè¿è¡ checkout çå¦ä¸ç§æ¹å¼å°±æ¯æå®ä¸ä¸ªæä»¶è·¯å¾ï¼è¿ä¼å reset ä¸æ ·ä¸ä¼ç§»å¨ headã å®å°±å git reset [branch] file é£æ ·ç¨è¯¥æ¬¡æäº¤ä¸­çé£ä¸ªæä»¶æ¥æ´æ°ç´¢å¼ï¼ä½æ¯å®ä¹ä¼è¦çå·¥ä½ç®å½ä¸­å¯¹åºçæä»¶ã å®å°±åæ¯ git reset --hard [branch] fileï¼å¦æ reset åè®¸ä½ è¿æ ·è¿è¡çè¯ï¼ï¼ è¿æ ·å¯¹å·¥ä½ç®å½å¹¶ä¸å®å¨ï¼å®ä¹ä¸ä¼ç§»å¨ headã\n\næ­¤å¤ï¼å git reset å git add ä¸æ ·ï¼checkout ä¹æ¥åä¸ä¸ª --patch éé¡¹ï¼åè®¸ä½ æ ¹æ®éæ©ä¸åä¸åå°æ¢å¤æä»¶åå®¹ã\n\n\n# æ»ç»\n\nå¸æä½ ç°å¨çæå¹¶çè§£äº reset å½ä»¤ï¼ä¸è¿å³äºå®å checkout ä¹é´çåºå«ï¼ä½ å¯è½è¿æ¯ä¼æç¹å°æï¼æ¯ç«ä¸å¤ªå¯è½è®°ä½ä¸åè°ç¨çææè§åã\n\nä¸é¢çéæ¥è¡¨ååºäºå½ä»¤å¯¹æ çå½±åã âheadâ ä¸åä¸­ç ârefâ è¡¨ç¤ºè¯¥å½ä»¤ç§»å¨äº head æåçåæ¯å¼ç¨ï¼è âheadâ åè¡¨ç¤ºåªç§»å¨äº head èªèº«ã ç¹å«æ³¨æ wd safe? ä¸åââå¦æå®æ è®°ä¸º noï¼é£ä¹è¿è¡è¯¥å½ä»¤ä¹åè¯·èèä¸ä¸ã\n\n                            head   index   workdir   wd safe?\ncommit level                                         \nreset --soft [commit]       ref    no      no        yes\nreset [commit]              ref    yes     no        yes\nreset --hard [commit]       ref    yes     yes       no\ncheckout <commit>           head   yes     yes       yes\nfile level                                           \nreset [commit] <paths>      no     yes     no        yes\ncheckout [commit] <paths>   no     yes     yes       no",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Gitåæ¯-è¿ç¨åæ¯",frontmatter:{title:"Gitåæ¯-è¿ç¨åæ¯",date:"2020-11-18T17:43:57.000Z",permalink:"/pages/574d62/",categories:["ãGitãå­¦ä¹ ç¬è®°"],tags:["Git"]},regularPath:"/%E3%80%8AGit%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20.%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/60.Git%E5%88%86%E6%94%AF-%E8%BF%9C%E7%A8%8B%E5%88%86%E6%94%AF.html",relativePath:"ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/60.Gitåæ¯-è¿ç¨åæ¯.md",key:"v-1d730a99",path:"/pages/574d62/",headers:[{level:3,title:"æ¥çè¿ç¨å¼ç¨åè¡¨ä¸ä¿¡æ¯",slug:"æ¥çè¿ç¨å¼ç¨åè¡¨ä¸ä¿¡æ¯",normalizedTitle:"æ¥çè¿ç¨å¼ç¨åè¡¨ä¸ä¿¡æ¯",charIndex:71},{level:3,title:"è¿ç¨è·è¸ªåæ¯",slug:"è¿ç¨è·è¸ªåæ¯",normalizedTitle:"è¿ç¨è·è¸ªåæ¯",charIndex:184},{level:3,title:"æ¨é",slug:"æ¨é",normalizedTitle:"æ¨é",charIndex:432},{level:3,title:"è·è¸ªåæ¯",slug:"è·è¸ªåæ¯",normalizedTitle:"è·è¸ªåæ¯",charIndex:186},{level:3,title:"æ¥çè·è¸ªåæ¯",slug:"æ¥çè·è¸ªåæ¯",normalizedTitle:"æ¥çè·è¸ªåæ¯",charIndex:5263},{level:3,title:"æå",slug:"æå",normalizedTitle:"æå",charIndex:605},{level:3,title:"å é¤è¿ç¨åæ¯",slug:"å é¤è¿ç¨åæ¯",normalizedTitle:"å é¤è¿ç¨åæ¯",charIndex:6361}],headersStr:"æ¥çè¿ç¨å¼ç¨åè¡¨ä¸ä¿¡æ¯ è¿ç¨è·è¸ªåæ¯ æ¨é è·è¸ªåæ¯ æ¥çè·è¸ªåæ¯ æå å é¤è¿ç¨åæ¯",content:"# Gitåæ¯-è¿ç¨åæ¯\n\nè¿ç¨å¼ç¨æ¯å¯¹è¿ç¨ä»åºçå¼ç¨ï¼æéï¼ï¼åæ¬åæ¯ãæ ç­¾ç­ç­ã\n\n> è¿ç¨åæ¯æ¬è´¨ä¸ä¹æ¯ä¸ä¸ªæéï¼æåè¿ç¨å°å\n\n\n# æ¥çè¿ç¨å¼ç¨åè¡¨ä¸ä¿¡æ¯\n\ngit ls-remote <remote> # è¿ç¨å¼ç¨çå®æ´åè¡¨\ngit remote show <remote> # è¿ç¨åæ¯çæ´å¤ä¿¡æ¯\n\n\n1\n2\n\n\nä¸é¢ä¸¤è¡å½ä»¤æ¯è¾å°ç¨ï¼æ´å¸¸è§çåæ³æ¯å©ç¨è¿ç¨è·è¸ªåæ¯ã\n\n\n# è¿ç¨è·è¸ªåæ¯\n\nè¿ç¨è·è¸ªåæ¯æ¯è¿ç¨åæ¯ç¶æçå¼ç¨ãå®ä»¬æ¯ä½ æ æ³ç§»å¨çæ¬å°å¼ç¨ãä¸æ¦ä½ è¿è¡äºç½ç»éä¿¡ï¼ Git å°±ä¼ä¸ºä½ ç§»å¨å®ä»¬ä»¥ç²¾ç¡®åæ è¿ç¨ä»åºçç¶æãè¯·å°å®ä»¬çåä¹¦ç­¾ï¼ è¿æ ·å¯ä»¥æéä½ è¯¥åæ¯å¨è¿ç¨ä»åºä¸­çä½ç½®å°±æ¯ä½ æåä¸æ¬¡è¿æ¥å°å®ä»¬çä½ç½®ã\n\nå®ä»¬ä»¥ <remote>/<branch> çå½¢å¼å½åã ä¾å¦ï¼å¦æä½ æ³è¦æ¥çæåä¸æ¬¡ä¸è¿ç¨ä»åº origin éä¿¡æ¶ master åæ¯çç¶æï¼ä½ å¯ä»¥æ¥ç origin/master åæ¯ã ä½ ä¸åäºåä½è§£å³ä¸ä¸ªé®é¢å¹¶ä¸ä»ä»¬æ¨éäºä¸ä¸ª iss53 åæ¯ï¼ä½ å¯è½æèªå·±çæ¬å° iss53 åæ¯ï¼ ç¶èå¨æå¡å¨ä¸çåæ¯ä¼ä»¥ origin/iss53 æ¥è¡¨ç¤ºã\n\nè¿å¯è½æä¸ç¹å¿é¾ä»¥çè§£ï¼è®©æä»¬æ¥çä¸ä¸ªä¾å­ã åè®¾ä½ çç½ç»éæä¸ä¸ªå¨ git.ourcompany.com ç Git æå¡å¨ã å¦æä½ ä»è¿éåéï¼Git ç clone å½ä»¤ä¼ä¸ºä½ èªå¨å°å¶å½åä¸º originï¼æåå®çæææ°æ®ï¼ åå»ºä¸ä¸ªæåå®ç master åæ¯çæéï¼å¹¶ä¸å¨æ¬å°å°å¶å½åä¸º origin/masterã Git ä¹ä¼ç»ä½ ä¸ä¸ªä¸ origin ç master åæ¯å¨æååä¸ä¸ªå°æ¹çæ¬å° master åæ¯ï¼è¿æ ·ä½ å°±æå·¥ä½çåºç¡ã\n\nç¬è®°ï¼ä»è¿ç¨åéä¸æ¥çä»åºæä¸ä¸ªå«origin/masterçè¿ç¨è·è¸ªåæ¯ å ä¸ä¸ªæ¬å°çmasteråæ¯\n\n> ç¬è®°ï¼âoriginâ å¹¶æ ç¹æ®å«ä¹è¿ç¨ä»åºåå­ âoriginâ ä¸åæ¯åå­ âmasterâ ä¸æ ·ï¼å¨ Git ä¸­å¹¶æ²¡æä»»ä½ç¹å«çå«ä¹ä¸æ ·ã åæ¶ âmasterâ æ¯å½ä½ è¿è¡ git init æ¶é»è®¤çèµ·å§åæ¯åå­ï¼åå ä»ä»æ¯å®çå¹¿æ³ä½¿ç¨ï¼ âoriginâ æ¯å½ä½ è¿è¡ git clone æ¶é»è®¤çè¿ç¨ä»åºåå­ã å¦æä½ è¿è¡ git clone -o booyahï¼é£ä¹ä½ é»è®¤çè¿ç¨åæ¯åå­å°ä¼æ¯ booyah/masterã\n\n\n\nå¾1. åéä¹åçæå¡å¨ä¸æ¬å°ä»åº â²\n\nå¦æä½ å¨æ¬å°ç master åæ¯åäºä¸äºå·¥ä½ï¼å¨åä¸æ®µæ¶é´åæå¶ä»äººæ¨éæäº¤å° git.ourcompany.com å¹¶ä¸æ´æ°äºå®ç master åæ¯ï¼è¿å°±æ¯è¯´ä½ ä»¬çæäº¤åå²å·²èµ°åä¸åçæ¹åã å³ä¾¿è¿æ ·ï¼åªè¦ä½ ä¿æä¸ä¸ origin æå¡å¨è¿æ¥ï¼å¹¶æåæ°æ®ï¼ï¼ä½ ç origin/master æéå°±ä¸ä¼ç§»å¨ã\n\n\n\nå¾2. æ¬å°ä¸è¿ç¨çå·¥ä½å¯ä»¥åå â²\n\nå¦æè¦ä¸ç»å®çè¿ç¨ä»åºåæ­¥æ°æ®ï¼è¿è¡ git fetch <remote> å½ä»¤ï¼å¨æ¬ä¾ä¸­ä¸º git fetch originï¼ã è¿ä¸ªå½ä»¤æ¥æ¾ âoriginâ æ¯åªä¸ä¸ªæå¡å¨ï¼å¨æ¬ä¾ä¸­ï¼å®æ¯ git.ourcompany.comï¼ï¼ ä»ä¸­æåæ¬å°æ²¡æçæ°æ®ï¼å¹¶ä¸æ´æ°æ¬å°æ°æ®åºï¼ç§»å¨ origin/master æéå°æ´æ°ä¹åçä½ç½®ã\n\n\n\nå¾3. git fetch æ´æ°ä½ çè¿ç¨è·è¸ªåæ¯ â²\n\nç¬è®°: æ¬å°ç master åæ¯ å¯è½ å è¿ç¨è·è¸ªåæ¯ origin/master åå\n\nä¸ºäºæ¼ç¤ºæå¤ä¸ªè¿ç¨ä»åºä¸è¿ç¨åæ¯çæåµï¼æä»¬åå®ä½ æå¦ä¸ä¸ªåé¨ Git æå¡å¨ï¼ä»æå¡äºä½ çæä¸ªææ·å¼åå¢éã è¿ä¸ªæå¡å¨ä½äº git.team1.ourcompany.comã ä½ å¯ä»¥è¿è¡ git remote add å½ä»¤æ·»å ä¸ä¸ªæ°çè¿ç¨ä»åºå¼ç¨å°å½åçé¡¹ç®ï¼è¿ä¸ªå½ä»¤æä»¬ä¼å¨ Git åºç¡ ä¸­è¯¦ç»è¯´æã å°è¿ä¸ªè¿ç¨ä»åºå½åä¸º teamoneï¼å°å¶ä½ä¸ºå®æ´ URL çç¼©åãè¿ç¨ä»åºåæ¬è´¨ä¸æ¯è¿ç¨URLçç¼©å\n\n\n\nå¾4. æ·»å å¦ä¸ä¸ªè¿ç¨ä»åº â²\n\nç°å¨ï¼å¯ä»¥è¿è¡ git fetch teamone æ¥æåè¿ç¨ä»åº teamone æèæ¬å°æ²¡æçæ°æ®ã å ä¸ºé£å°æå¡å¨ä¸ç°æçæ°æ®æ¯ origin æå¡å¨ä¸çä¸ä¸ªå­éï¼ æä»¥ Git å¹¶ä¸ä¼æåæ°æ®èæ¯ä¼è®¾ç½®è¿ç¨è·è¸ªåæ¯ teamone/master æå teamone ç master åæ¯ã\n\n\n\nå¾5. è¿ç¨è·è¸ªåæ¯ teamone/master â²\n\n\n# æ¨é\n\nå½ä½ æ³è¦å¬å¼åäº«ä¸ä¸ªåæ¯æ¶ï¼éè¦å°å¶æ¨éå°æåå¥æéçè¿ç¨ä»åºä¸ã æ¬å°çåæ¯å¹¶ä¸ä¼èªå¨ä¸è¿ç¨ä»åºåæ­¥ââä½ å¿é¡»æ¾å¼å°æ¨éæ³è¦åäº«çåæ¯ã è¿æ ·ï¼ä½ å°±å¯ä»¥æä¸æ¿æåäº«çåå®¹æ¾å°ç§äººåæ¯ä¸ï¼èå°éè¦åå«äººåä½çåå®¹æ¨éå°å¬å¼åæ¯ã\n\nå¦æå¸æåå«äººä¸èµ·å¨åä¸º serverfix çåæ¯ä¸å·¥ä½ï¼ä½ å¯ä»¥åæ¨éç¬¬ä¸ä¸ªåæ¯é£æ ·æ¨éå®ã è¿è¡ git push <remote> <branch>:\n\n$ git push origin serverfix\nCounting objects: 24, done.\nDelta compression using up to 8 threads.\nCompressing objects: 100% (15/15), done.\nWriting objects: 100% (24/24), 1.91 KiB | 0 bytes/s, done.\nTotal 24 (delta 2), reused 0 (delta 0)\nTo https://github.com/schacon/simplegit\n * [new branch]      serverfix -> serverfix\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nè¿éæäºå·¥ä½è¢«ç®åäºã Git èªå¨å° serverfix åæ¯åå­å±å¼ä¸º refs/heads/serverfix:refs/heads/serverfixï¼ é£æå³çï¼âæ¨éæ¬å°ç serverfix åæ¯æ¥æ´æ°è¿ç¨ä»åºä¸ç serverfix åæ¯ãâ æä»¬å°ä¼è¯¦ç»å­¦ä¹  Git åé¨åç ç refs/heads/ é¨åï¼ ä½æ¯ç°å¨å¯ä»¥åæå®æ¾å¨å¿ãä½ ä¹å¯ä»¥è¿è¡ git push origin serverfix:serverfixï¼ å®ä¼ååæ ·çäºââä¹å°±æ¯è¯´âæ¨éæ¬å°ç serverfix åæ¯ï¼å°å¶ä½ä¸ºè¿ç¨ä»åºç serverfix åæ¯â å¯ä»¥éè¿è¿ç§æ ¼å¼æ¥æ¨éæ¬å°åæ¯å°ä¸ä¸ªå½åä¸ç¸åçè¿ç¨åæ¯ã\n\n# éå½åè¿ç¨ä»åºä¸çåæ¯å\n\nå¦æå¹¶ä¸æ³è®©è¿ç¨ä»åºä¸çåæ¯å«å serverfixï¼å¯ä»¥è¿è¡ git push origin serverfix:awesomebranch æ¥å°æ¬å°ç serverfix åæ¯æ¨éå°è¿ç¨ä»åºä¸ç awesomebranch åæ¯ã\n\nNOTE   å¦ä½é¿åæ¯æ¬¡è¾å¥å¯ç å¦æä½ æ­£å¨ä½¿ç¨ HTTPS URL æ¥æ¨éï¼GIT æå¡å¨ä¼è¯¢é®ç¨æ·åä¸å¯ç ã\n       é»è®¤æåµä¸å®ä¼å¨ç»ç«¯ä¸­æç¤ºæå¡å¨æ¯å¦åè®¸ä½ è¿è¡æ¨éãå¦æä¸æ³å¨æ¯ä¸æ¬¡æ¨éæ¶é½è¾å¥ç¨æ·åä¸å¯ç ï¼ä½ å¯ä»¥è®¾ç½®ä¸ä¸ª\n       âCREDENTIAL CACHEâã æç®åçæ¹å¼å°±æ¯å°å¶ä¿å­å¨åå­ä¸­å åéï¼å¯ä»¥ç®åå°è¿è¡ GIT CONFIG\n       --GLOBAL CREDENTIAL.HELPER CACHE æ¥è®¾ç½®å®ãæ³è¦äºè§£æ´å¤å³äºä¸åéªè¯ç¼å­çå¯ç¨éé¡¹ï¼æ¥ç\n       å­è¯å­å¨ã\n       \n\nä¸ä¸æ¬¡å¶ä»åä½èä»æå¡å¨ä¸æåæ°æ®æ¶ï¼ä»ä»¬ä¼å¨æ¬å°çæä¸ä¸ªè¿ç¨åæ¯ origin/serverfixï¼æåæå¡å¨ç serverfix åæ¯çå¼ç¨ï¼\n\n$ git fetch origin\nremote: Counting objects: 7, done.\nremote: Compressing objects: 100% (2/2), done.\nremote: Total 3 (delta 0), reused 3 (delta 0)\nUnpacking objects: 100% (3/3), done.\nFrom https://github.com/schacon/simplegit\n * [new branch]      serverfix    -> origin/serverfix\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¦ç¹å«æ³¨æçä¸ç¹æ¯å½æåå°æ°çè¿ç¨è·è¸ªåæ¯æ¶ï¼æ¬å°ä¸ä¼èªå¨çæä¸ä»½å¯ç¼è¾çå¯æ¬ï¼æ·è´ï¼ã æ¢ä¸å¥è¯è¯´ï¼è¿ç§æåµä¸ï¼ä¸ä¼æä¸ä¸ªæ°ç serverfix åæ¯ââåªæä¸ä¸ªä¸å¯ä»¥ä¿®æ¹ç origin/serverfix æéã\n\nå¯ä»¥è¿è¡ git merge origin/serverfix å°è¿äºå·¥ä½åå¹¶å°å½åæå¨çåæ¯ã å¦ææ³è¦å¨èªå·±ç serverfix åæ¯ä¸å·¥ä½ï¼å¯ä»¥å°å¶å»ºç«å¨è¿ç¨è·è¸ªåæ¯ä¹ä¸ï¼\n\n$ git checkout -b serverfix origin/serverfix\nBranch serverfix set up to track remote branch serverfix from origin.\nSwitched to a new branch 'serverfix'\n\n\n1\n2\n3\n\n\nè¿ä¼ç»ä½ ä¸ä¸ªç¨äºå·¥ä½çæ¬å°åæ¯ï¼å¹¶ä¸èµ·ç¹ä½äº origin/serverfixã\n\n\n# è·è¸ªåæ¯\n\nä»ä¸ä¸ªè¿ç¨è·è¸ªåæ¯æ£åºä¸ä¸ªæ¬å°åæ¯ä¼èªå¨åå»ºæè°çâè·è¸ªåæ¯âï¼å®è·è¸ªçåæ¯å«åâä¸æ¸¸åæ¯âï¼ã è·è¸ªåæ¯æ¯ä¸è¿ç¨åæ¯æç´æ¥å³ç³»çæ¬å°åæ¯ã å¦æå¨ä¸ä¸ªè·è¸ªåæ¯ä¸è¾å¥ git pullï¼Git è½èªå¨å°è¯å«å»åªä¸ªæå¡å¨ä¸æåãåå¹¶å°åªä¸ªåæ¯ã\n\nå½åéä¸ä¸ªä»åºæ¶ï¼å®éå¸¸ä¼èªå¨å°åå»ºä¸ä¸ªè·è¸ª origin/master ç master åæ¯ã ç¶èï¼å¦æä½ æ¿æçè¯å¯ä»¥è®¾ç½®å¶ä»çè·è¸ªåæ¯ï¼ææ¯ä¸ä¸ªå¨å¶ä»è¿ç¨ä»åºä¸çè·è¸ªåæ¯ï¼åæèä¸è·è¸ª master åæ¯ã æç®åçå®ä¾å°±æ¯åä¹åçå°çé£æ ·ï¼è¿è¡ git checkout -b <branch> <remote>/<branch>ã è¿æ¯ä¸ä¸ªååå¸¸ç¨çæä½æä»¥ Git æä¾äº --track å¿«æ·æ¹å¼ï¼\n\n$ git checkout --track origin/serverfix\nBranch serverfix set up to track remote branch serverfix from origin.\nSwitched to a new branch 'serverfix'\n\n\n1\n2\n3\n\n\nç±äºè¿ä¸ªæä½å¤ªå¸¸ç¨äºï¼è¯¥æ·å¾æ¬èº«è¿æä¸ä¸ªæ·å¾ã å¦æä½ å°è¯æ£åºçåæ¯ (a) ä¸å­å¨ä¸ (b) åå¥½åªæä¸ä¸ªåå­ä¸ä¹å¹éçè¿ç¨åæ¯ï¼é£ä¹ Git å°±ä¼ä¸ºä½ åå»ºä¸ä¸ªè·è¸ªåæ¯ï¼\n\n$ git checkout serverfix\nBranch serverfix set up to track remote branch serverfix from origin.\nSwitched to a new branch 'serverfix'\n\n\n1\n2\n3\n\n\nå¦ææ³è¦å°æ¬å°åæ¯ä¸è¿ç¨åæ¯è®¾ç½®ä¸ºä¸åçåå­ï¼ä½ å¯ä»¥è½»æ¾å°ä½¿ç¨ä¸ä¸ä¸ªå½ä»¤å¢å ä¸ä¸ªä¸ååå­çæ¬å°åæ¯ï¼\n\n$ git checkout -b sf origin/serverfix\nBranch sf set up to track remote branch serverfix from origin.\nSwitched to a new branch 'sf'\n\n\n1\n2\n3\n\n\nç°å¨ï¼æ¬å°åæ¯ sf ä¼èªå¨ä» origin/serverfix æåã\n\nè®¾ç½®å·²æçæ¬å°åæ¯è·è¸ªä¸ä¸ªååæåä¸æ¥çè¿ç¨åæ¯ï¼æèæ³è¦ä¿®æ¹æ­£å¨è·è¸ªçä¸æ¸¸åæ¯ï¼ ä½ å¯ä»¥å¨ä»»ææ¶é´ä½¿ç¨ -u æ --set-upstream-to éé¡¹è¿è¡ git branch æ¥æ¾å¼å°è®¾ç½®ã\n\n$ git branch -u origin/serverfix\nBranch serverfix set up to track remote branch serverfix from origin.\n\n\n1\n2\n\n\nNOTE   ä¸æ¸¸å¿«æ·æ¹å¼å½è®¾ç½®å¥½è·è¸ªåæ¯åï¼å¯ä»¥éè¿ç®å @{UPSTREAM} æ @{U} æ¥å¼ç¨å®çä¸æ¸¸åæ¯ã æä»¥å¨\n       MASTER åæ¯æ¶å¹¶ä¸å®æ­£å¨è·è¸ª ORIGIN/MASTER æ¶ï¼å¦ææ¿æçè¯å¯ä»¥ä½¿ç¨ GIT MERGE @{U}\n       æ¥åä»£ GIT MERGE ORIGIN/MASTERã\n       \n\n\n# æ¥çè·è¸ªåæ¯\n\nå¦ææ³è¦æ¥çè®¾ç½®çææè·è¸ªåæ¯ï¼å¯ä»¥ä½¿ç¨ git branch ç -vv éé¡¹ã è¿ä¼å°ææçæ¬å°åæ¯ååºæ¥å¹¶ä¸åå«æ´å¤çä¿¡æ¯ï¼å¦æ¯ä¸ä¸ªåæ¯æ­£å¨è·è¸ªåªä¸ªè¿ç¨åæ¯ä¸æ¬å°åæ¯æ¯å¦æ¯é¢åãè½åææ¯é½æã\n\n$ git branch -vv\n  iss53     7e424c3 [origin/iss53: ahead 2] forgot the brackets\n  master    1ae2a45 [origin/master] deploying index fix\n* serverfix f8674d9 [teamone/server-fix-good: ahead 3, behind 1] this should do it\n  testing   5ea463a trying something new\n\n\n1\n2\n3\n4\n5\n\n\nè¿éå¯ä»¥çå° iss53 åæ¯æ­£å¨è·è¸ª origin/iss53 å¹¶ä¸ âaheadâ æ¯ 2ï¼æå³çæ¬å°æä¸¤ä¸ªæäº¤è¿æ²¡ææ¨éå°æå¡å¨ä¸ã ä¹è½çå° master åæ¯æ­£å¨è·è¸ª origin/master åæ¯å¹¶ä¸æ¯ææ°çã æ¥ä¸æ¥å¯ä»¥çå° serverfix åæ¯æ­£å¨è·è¸ª teamone æå¡å¨ä¸ç server-fix-good åæ¯å¹¶ä¸é¢å 3 è½å 1ï¼ æå³çæå¡å¨ä¸æä¸æ¬¡æäº¤è¿æ²¡æåå¹¶å¥åæ¶æ¬å°æä¸æ¬¡æäº¤è¿æ²¡ææ¨éã æåçå° testing åæ¯å¹¶æ²¡æè·è¸ªä»»ä½è¿ç¨åæ¯ã\n\néè¦éç¹æ³¨æçä¸ç¹æ¯è¿äºæ°å­çå¼æ¥èªäºä½ ä»æ¯ä¸ªæå¡å¨ä¸æåä¸æ¬¡æåçæ°æ®ã è¿ä¸ªå½ä»¤å¹¶æ²¡æè¿æ¥æå¡å¨ï¼å®åªä¼åè¯ä½ å³äºæ¬å°ç¼å­çæå¡å¨æ°æ®ã å¦ææ³è¦ç»è®¡ææ°çé¢åä¸è½åæ°å­ï¼éè¦å¨è¿è¡æ­¤å½ä»¤åæåææçè¿ç¨ä»åºã å¯ä»¥åè¿æ ·åï¼\n\n$ git fetch --all; git branch -vv\n\n\n1\n\n\n\n# æå\n\nå½ git fetch å½ä»¤ä»æå¡å¨ä¸æåæ¬å°æ²¡æçæ°æ®æ¶ï¼å®å¹¶ä¸ä¼ä¿®æ¹å·¥ä½ç®å½ä¸­çåå®¹ã å®åªä¼è·åæ°æ®ç¶åè®©ä½ èªå·±åå¹¶ã ç¶èï¼æä¸ä¸ªå½ä»¤å«ä½ git pull å¨å¤§å¤æ°æåµä¸å®çå«ä¹æ¯ä¸ä¸ª git fetch ç´§æ¥çä¸ä¸ª git merge å½ä»¤ã å¦ææä¸ä¸ªåä¹åç« èä¸­æ¼ç¤ºçè®¾ç½®å¥½çè·è¸ªåæ¯ï¼ä¸ç®¡å®æ¯æ¾å¼å°è®¾ç½®è¿æ¯éè¿ clone æ checkout å½ä»¤ä¸ºä½ åå»ºçï¼git pull é½ä¼æ¥æ¾å½ååæ¯æè·è¸ªçæå¡å¨ä¸åæ¯ï¼ ä»æå¡å¨ä¸æåæ°æ®ç¶åå°è¯åå¹¶å¥é£ä¸ªè¿ç¨åæ¯ã\n\nç±äº git pull çé­æ³ç»å¸¸ä»¤äººå°ææä»¥éå¸¸åç¬æ¾å¼å°ä½¿ç¨ fetch ä¸ merge å½ä»¤ä¼æ´å¥½ä¸äºã\n\n\n# å é¤è¿ç¨åæ¯\n\nåè®¾ä½ å·²ç»éè¿è¿ç¨åæ¯åå®ææçå·¥ä½äºââä¹å°±æ¯è¯´ä½ åä½ çåä½èå·²ç»å®æäºä¸ä¸ªç¹æ§ï¼ å¹¶ä¸å°å¶åå¹¶å°äºè¿ç¨ä»åºç master åæ¯ï¼æä»»ä½å¶ä»ç¨³å®ä»£ç åæ¯ï¼ã å¯ä»¥è¿è¡å¸¦æ --delete éé¡¹ç git push å½ä»¤æ¥å é¤ä¸ä¸ªè¿ç¨åæ¯ã å¦ææ³è¦ä»æå¡å¨ä¸å é¤ serverfix åæ¯ï¼è¿è¡ä¸é¢çå½ä»¤ï¼\n\n$ git push origin --delete serverfix\nTo https://github.com/schacon/simplegit\n - [deleted]         serverfix\n\n\n1\n2\n3\n\n\nåºæ¬ä¸è¿ä¸ªå½ä»¤åçåªæ¯ä»æå¡å¨ä¸ç§»é¤è¿ä¸ªæéã Git æå¡å¨éå¸¸ä¼ä¿çæ°æ®ä¸æ®µæ¶é´ç´å°åå¾åæ¶è¿è¡ï¼æä»¥å¦æä¸å°å¿å é¤æäºï¼éå¸¸æ¯å¾å®¹ææ¢å¤çã",normalizedContent:"# gitåæ¯-è¿ç¨åæ¯\n\nè¿ç¨å¼ç¨æ¯å¯¹è¿ç¨ä»åºçå¼ç¨ï¼æéï¼ï¼åæ¬åæ¯ãæ ç­¾ç­ç­ã\n\n> è¿ç¨åæ¯æ¬è´¨ä¸ä¹æ¯ä¸ä¸ªæéï¼æåè¿ç¨å°å\n\n\n# æ¥çè¿ç¨å¼ç¨åè¡¨ä¸ä¿¡æ¯\n\ngit ls-remote <remote> # è¿ç¨å¼ç¨çå®æ´åè¡¨\ngit remote show <remote> # è¿ç¨åæ¯çæ´å¤ä¿¡æ¯\n\n\n1\n2\n\n\nä¸é¢ä¸¤è¡å½ä»¤æ¯è¾å°ç¨ï¼æ´å¸¸è§çåæ³æ¯å©ç¨è¿ç¨è·è¸ªåæ¯ã\n\n\n# è¿ç¨è·è¸ªåæ¯\n\nè¿ç¨è·è¸ªåæ¯æ¯è¿ç¨åæ¯ç¶æçå¼ç¨ãå®ä»¬æ¯ä½ æ æ³ç§»å¨çæ¬å°å¼ç¨ãä¸æ¦ä½ è¿è¡äºç½ç»éä¿¡ï¼ git å°±ä¼ä¸ºä½ ç§»å¨å®ä»¬ä»¥ç²¾ç¡®åæ è¿ç¨ä»åºçç¶æãè¯·å°å®ä»¬çåä¹¦ç­¾ï¼ è¿æ ·å¯ä»¥æéä½ è¯¥åæ¯å¨è¿ç¨ä»åºä¸­çä½ç½®å°±æ¯ä½ æåä¸æ¬¡è¿æ¥å°å®ä»¬çä½ç½®ã\n\nå®ä»¬ä»¥ <remote>/<branch> çå½¢å¼å½åã ä¾å¦ï¼å¦æä½ æ³è¦æ¥çæåä¸æ¬¡ä¸è¿ç¨ä»åº origin éä¿¡æ¶ master åæ¯çç¶æï¼ä½ å¯ä»¥æ¥ç origin/master åæ¯ã ä½ ä¸åäºåä½è§£å³ä¸ä¸ªé®é¢å¹¶ä¸ä»ä»¬æ¨éäºä¸ä¸ª iss53 åæ¯ï¼ä½ å¯è½æèªå·±çæ¬å° iss53 åæ¯ï¼ ç¶èå¨æå¡å¨ä¸çåæ¯ä¼ä»¥ origin/iss53 æ¥è¡¨ç¤ºã\n\nè¿å¯è½æä¸ç¹å¿é¾ä»¥çè§£ï¼è®©æä»¬æ¥çä¸ä¸ªä¾å­ã åè®¾ä½ çç½ç»éæä¸ä¸ªå¨ git.ourcompany.com ç git æå¡å¨ã å¦æä½ ä»è¿éåéï¼git ç clone å½ä»¤ä¼ä¸ºä½ èªå¨å°å¶å½åä¸º originï¼æåå®çæææ°æ®ï¼ åå»ºä¸ä¸ªæåå®ç master åæ¯çæéï¼å¹¶ä¸å¨æ¬å°å°å¶å½åä¸º origin/masterã git ä¹ä¼ç»ä½ ä¸ä¸ªä¸ origin ç master åæ¯å¨æååä¸ä¸ªå°æ¹çæ¬å° master åæ¯ï¼è¿æ ·ä½ å°±æå·¥ä½çåºç¡ã\n\nç¬è®°ï¼ä»è¿ç¨åéä¸æ¥çä»åºæä¸ä¸ªå«origin/masterçè¿ç¨è·è¸ªåæ¯ å ä¸ä¸ªæ¬å°çmasteråæ¯\n\n> ç¬è®°ï¼âoriginâ å¹¶æ ç¹æ®å«ä¹è¿ç¨ä»åºåå­ âoriginâ ä¸åæ¯åå­ âmasterâ ä¸æ ·ï¼å¨ git ä¸­å¹¶æ²¡æä»»ä½ç¹å«çå«ä¹ä¸æ ·ã åæ¶ âmasterâ æ¯å½ä½ è¿è¡ git init æ¶é»è®¤çèµ·å§åæ¯åå­ï¼åå ä»ä»æ¯å®çå¹¿æ³ä½¿ç¨ï¼ âoriginâ æ¯å½ä½ è¿è¡ git clone æ¶é»è®¤çè¿ç¨ä»åºåå­ã å¦æä½ è¿è¡ git clone -o booyahï¼é£ä¹ä½ é»è®¤çè¿ç¨åæ¯åå­å°ä¼æ¯ booyah/masterã\n\n\n\nå¾1. åéä¹åçæå¡å¨ä¸æ¬å°ä»åº â²\n\nå¦æä½ å¨æ¬å°ç master åæ¯åäºä¸äºå·¥ä½ï¼å¨åä¸æ®µæ¶é´åæå¶ä»äººæ¨éæäº¤å° git.ourcompany.com å¹¶ä¸æ´æ°äºå®ç master åæ¯ï¼è¿å°±æ¯è¯´ä½ ä»¬çæäº¤åå²å·²èµ°åä¸åçæ¹åã å³ä¾¿è¿æ ·ï¼åªè¦ä½ ä¿æä¸ä¸ origin æå¡å¨è¿æ¥ï¼å¹¶æåæ°æ®ï¼ï¼ä½ ç origin/master æéå°±ä¸ä¼ç§»å¨ã\n\n\n\nå¾2. æ¬å°ä¸è¿ç¨çå·¥ä½å¯ä»¥åå â²\n\nå¦æè¦ä¸ç»å®çè¿ç¨ä»åºåæ­¥æ°æ®ï¼è¿è¡ git fetch <remote> å½ä»¤ï¼å¨æ¬ä¾ä¸­ä¸º git fetch originï¼ã è¿ä¸ªå½ä»¤æ¥æ¾ âoriginâ æ¯åªä¸ä¸ªæå¡å¨ï¼å¨æ¬ä¾ä¸­ï¼å®æ¯ git.ourcompany.comï¼ï¼ ä»ä¸­æåæ¬å°æ²¡æçæ°æ®ï¼å¹¶ä¸æ´æ°æ¬å°æ°æ®åºï¼ç§»å¨ origin/master æéå°æ´æ°ä¹åçä½ç½®ã\n\n\n\nå¾3. git fetch æ´æ°ä½ çè¿ç¨è·è¸ªåæ¯ â²\n\nç¬è®°: æ¬å°ç master åæ¯ å¯è½ å è¿ç¨è·è¸ªåæ¯ origin/master åå\n\nä¸ºäºæ¼ç¤ºæå¤ä¸ªè¿ç¨ä»åºä¸è¿ç¨åæ¯çæåµï¼æä»¬åå®ä½ æå¦ä¸ä¸ªåé¨ git æå¡å¨ï¼ä»æå¡äºä½ çæä¸ªææ·å¼åå¢éã è¿ä¸ªæå¡å¨ä½äº git.team1.ourcompany.comã ä½ å¯ä»¥è¿è¡ git remote add å½ä»¤æ·»å ä¸ä¸ªæ°çè¿ç¨ä»åºå¼ç¨å°å½åçé¡¹ç®ï¼è¿ä¸ªå½ä»¤æä»¬ä¼å¨ git åºç¡ ä¸­è¯¦ç»è¯´æã å°è¿ä¸ªè¿ç¨ä»åºå½åä¸º teamoneï¼å°å¶ä½ä¸ºå®æ´ url çç¼©åãè¿ç¨ä»åºåæ¬è´¨ä¸æ¯è¿ç¨urlçç¼©å\n\n\n\nå¾4. æ·»å å¦ä¸ä¸ªè¿ç¨ä»åº â²\n\nç°å¨ï¼å¯ä»¥è¿è¡ git fetch teamone æ¥æåè¿ç¨ä»åº teamone æèæ¬å°æ²¡æçæ°æ®ã å ä¸ºé£å°æå¡å¨ä¸ç°æçæ°æ®æ¯ origin æå¡å¨ä¸çä¸ä¸ªå­éï¼ æä»¥ git å¹¶ä¸ä¼æåæ°æ®èæ¯ä¼è®¾ç½®è¿ç¨è·è¸ªåæ¯ teamone/master æå teamone ç master åæ¯ã\n\n\n\nå¾5. è¿ç¨è·è¸ªåæ¯ teamone/master â²\n\n\n# æ¨é\n\nå½ä½ æ³è¦å¬å¼åäº«ä¸ä¸ªåæ¯æ¶ï¼éè¦å°å¶æ¨éå°æåå¥æéçè¿ç¨ä»åºä¸ã æ¬å°çåæ¯å¹¶ä¸ä¼èªå¨ä¸è¿ç¨ä»åºåæ­¥ââä½ å¿é¡»æ¾å¼å°æ¨éæ³è¦åäº«çåæ¯ã è¿æ ·ï¼ä½ å°±å¯ä»¥æä¸æ¿æåäº«çåå®¹æ¾å°ç§äººåæ¯ä¸ï¼èå°éè¦åå«äººåä½çåå®¹æ¨éå°å¬å¼åæ¯ã\n\nå¦æå¸æåå«äººä¸èµ·å¨åä¸º serverfix çåæ¯ä¸å·¥ä½ï¼ä½ å¯ä»¥åæ¨éç¬¬ä¸ä¸ªåæ¯é£æ ·æ¨éå®ã è¿è¡ git push <remote> <branch>:\n\n$ git push origin serverfix\ncounting objects: 24, done.\ndelta compression using up to 8 threads.\ncompressing objects: 100% (15/15), done.\nwriting objects: 100% (24/24), 1.91 kib | 0 bytes/s, done.\ntotal 24 (delta 2), reused 0 (delta 0)\nto https://github.com/schacon/simplegit\n * [new branch]      serverfix -> serverfix\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nè¿éæäºå·¥ä½è¢«ç®åäºã git èªå¨å° serverfix åæ¯åå­å±å¼ä¸º refs/heads/serverfix:refs/heads/serverfixï¼ é£æå³çï¼âæ¨éæ¬å°ç serverfix åæ¯æ¥æ´æ°è¿ç¨ä»åºä¸ç serverfix åæ¯ãâ æä»¬å°ä¼è¯¦ç»å­¦ä¹  git åé¨åç ç refs/heads/ é¨åï¼ ä½æ¯ç°å¨å¯ä»¥åæå®æ¾å¨å¿ãä½ ä¹å¯ä»¥è¿è¡ git push origin serverfix:serverfixï¼ å®ä¼ååæ ·çäºââä¹å°±æ¯è¯´âæ¨éæ¬å°ç serverfix åæ¯ï¼å°å¶ä½ä¸ºè¿ç¨ä»åºç serverfix åæ¯â å¯ä»¥éè¿è¿ç§æ ¼å¼æ¥æ¨éæ¬å°åæ¯å°ä¸ä¸ªå½åä¸ç¸åçè¿ç¨åæ¯ã\n\n# éå½åè¿ç¨ä»åºä¸çåæ¯å\n\nå¦æå¹¶ä¸æ³è®©è¿ç¨ä»åºä¸çåæ¯å«å serverfixï¼å¯ä»¥è¿è¡ git push origin serverfix:awesomebranch æ¥å°æ¬å°ç serverfix åæ¯æ¨éå°è¿ç¨ä»åºä¸ç awesomebranch åæ¯ã\n\nnote   å¦ä½é¿åæ¯æ¬¡è¾å¥å¯ç å¦æä½ æ­£å¨ä½¿ç¨ https url æ¥æ¨éï¼git æå¡å¨ä¼è¯¢é®ç¨æ·åä¸å¯ç ã\n       é»è®¤æåµä¸å®ä¼å¨ç»ç«¯ä¸­æç¤ºæå¡å¨æ¯å¦åè®¸ä½ è¿è¡æ¨éãå¦æä¸æ³å¨æ¯ä¸æ¬¡æ¨éæ¶é½è¾å¥ç¨æ·åä¸å¯ç ï¼ä½ å¯ä»¥è®¾ç½®ä¸ä¸ª\n       âcredential cacheâã æç®åçæ¹å¼å°±æ¯å°å¶ä¿å­å¨åå­ä¸­å åéï¼å¯ä»¥ç®åå°è¿è¡ git config\n       --global credential.helper cache æ¥è®¾ç½®å®ãæ³è¦äºè§£æ´å¤å³äºä¸åéªè¯ç¼å­çå¯ç¨éé¡¹ï¼æ¥ç\n       å­è¯å­å¨ã\n       \n\nä¸ä¸æ¬¡å¶ä»åä½èä»æå¡å¨ä¸æåæ°æ®æ¶ï¼ä»ä»¬ä¼å¨æ¬å°çæä¸ä¸ªè¿ç¨åæ¯ origin/serverfixï¼æåæå¡å¨ç serverfix åæ¯çå¼ç¨ï¼\n\n$ git fetch origin\nremote: counting objects: 7, done.\nremote: compressing objects: 100% (2/2), done.\nremote: total 3 (delta 0), reused 3 (delta 0)\nunpacking objects: 100% (3/3), done.\nfrom https://github.com/schacon/simplegit\n * [new branch]      serverfix    -> origin/serverfix\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nè¦ç¹å«æ³¨æçä¸ç¹æ¯å½æåå°æ°çè¿ç¨è·è¸ªåæ¯æ¶ï¼æ¬å°ä¸ä¼èªå¨çæä¸ä»½å¯ç¼è¾çå¯æ¬ï¼æ·è´ï¼ã æ¢ä¸å¥è¯è¯´ï¼è¿ç§æåµä¸ï¼ä¸ä¼æä¸ä¸ªæ°ç serverfix åæ¯ââåªæä¸ä¸ªä¸å¯ä»¥ä¿®æ¹ç origin/serverfix æéã\n\nå¯ä»¥è¿è¡ git merge origin/serverfix å°è¿äºå·¥ä½åå¹¶å°å½åæå¨çåæ¯ã å¦ææ³è¦å¨èªå·±ç serverfix åæ¯ä¸å·¥ä½ï¼å¯ä»¥å°å¶å»ºç«å¨è¿ç¨è·è¸ªåæ¯ä¹ä¸ï¼\n\n$ git checkout -b serverfix origin/serverfix\nbranch serverfix set up to track remote branch serverfix from origin.\nswitched to a new branch 'serverfix'\n\n\n1\n2\n3\n\n\nè¿ä¼ç»ä½ ä¸ä¸ªç¨äºå·¥ä½çæ¬å°åæ¯ï¼å¹¶ä¸èµ·ç¹ä½äº origin/serverfixã\n\n\n# è·è¸ªåæ¯\n\nä»ä¸ä¸ªè¿ç¨è·è¸ªåæ¯æ£åºä¸ä¸ªæ¬å°åæ¯ä¼èªå¨åå»ºæè°çâè·è¸ªåæ¯âï¼å®è·è¸ªçåæ¯å«åâä¸æ¸¸åæ¯âï¼ã è·è¸ªåæ¯æ¯ä¸è¿ç¨åæ¯æç´æ¥å³ç³»çæ¬å°åæ¯ã å¦æå¨ä¸ä¸ªè·è¸ªåæ¯ä¸è¾å¥ git pullï¼git è½èªå¨å°è¯å«å»åªä¸ªæå¡å¨ä¸æåãåå¹¶å°åªä¸ªåæ¯ã\n\nå½åéä¸ä¸ªä»åºæ¶ï¼å®éå¸¸ä¼èªå¨å°åå»ºä¸ä¸ªè·è¸ª origin/master ç master åæ¯ã ç¶èï¼å¦æä½ æ¿æçè¯å¯ä»¥è®¾ç½®å¶ä»çè·è¸ªåæ¯ï¼ææ¯ä¸ä¸ªå¨å¶ä»è¿ç¨ä»åºä¸çè·è¸ªåæ¯ï¼åæèä¸è·è¸ª master åæ¯ã æç®åçå®ä¾å°±æ¯åä¹åçå°çé£æ ·ï¼è¿è¡ git checkout -b <branch> <remote>/<branch>ã è¿æ¯ä¸ä¸ªååå¸¸ç¨çæä½æä»¥ git æä¾äº --track å¿«æ·æ¹å¼ï¼\n\n$ git checkout --track origin/serverfix\nbranch serverfix set up to track remote branch serverfix from origin.\nswitched to a new branch 'serverfix'\n\n\n1\n2\n3\n\n\nç±äºè¿ä¸ªæä½å¤ªå¸¸ç¨äºï¼è¯¥æ·å¾æ¬èº«è¿æä¸ä¸ªæ·å¾ã å¦æä½ å°è¯æ£åºçåæ¯ (a) ä¸å­å¨ä¸ (b) åå¥½åªæä¸ä¸ªåå­ä¸ä¹å¹éçè¿ç¨åæ¯ï¼é£ä¹ git å°±ä¼ä¸ºä½ åå»ºä¸ä¸ªè·è¸ªåæ¯ï¼\n\n$ git checkout serverfix\nbranch serverfix set up to track remote branch serverfix from origin.\nswitched to a new branch 'serverfix'\n\n\n1\n2\n3\n\n\nå¦ææ³è¦å°æ¬å°åæ¯ä¸è¿ç¨åæ¯è®¾ç½®ä¸ºä¸åçåå­ï¼ä½ å¯ä»¥è½»æ¾å°ä½¿ç¨ä¸ä¸ä¸ªå½ä»¤å¢å ä¸ä¸ªä¸ååå­çæ¬å°åæ¯ï¼\n\n$ git checkout -b sf origin/serverfix\nbranch sf set up to track remote branch serverfix from origin.\nswitched to a new branch 'sf'\n\n\n1\n2\n3\n\n\nç°å¨ï¼æ¬å°åæ¯ sf ä¼èªå¨ä» origin/serverfix æåã\n\nè®¾ç½®å·²æçæ¬å°åæ¯è·è¸ªä¸ä¸ªååæåä¸æ¥çè¿ç¨åæ¯ï¼æèæ³è¦ä¿®æ¹æ­£å¨è·è¸ªçä¸æ¸¸åæ¯ï¼ ä½ å¯ä»¥å¨ä»»ææ¶é´ä½¿ç¨ -u æ --set-upstream-to éé¡¹è¿è¡ git branch æ¥æ¾å¼å°è®¾ç½®ã\n\n$ git branch -u origin/serverfix\nbranch serverfix set up to track remote branch serverfix from origin.\n\n\n1\n2\n\n\nnote   ä¸æ¸¸å¿«æ·æ¹å¼å½è®¾ç½®å¥½è·è¸ªåæ¯åï¼å¯ä»¥éè¿ç®å @{upstream} æ @{u} æ¥å¼ç¨å®çä¸æ¸¸åæ¯ã æä»¥å¨\n       master åæ¯æ¶å¹¶ä¸å®æ­£å¨è·è¸ª origin/master æ¶ï¼å¦ææ¿æçè¯å¯ä»¥ä½¿ç¨ git merge @{u}\n       æ¥åä»£ git merge origin/masterã\n       \n\n\n# æ¥çè·è¸ªåæ¯\n\nå¦ææ³è¦æ¥çè®¾ç½®çææè·è¸ªåæ¯ï¼å¯ä»¥ä½¿ç¨ git branch ç -vv éé¡¹ã è¿ä¼å°ææçæ¬å°åæ¯ååºæ¥å¹¶ä¸åå«æ´å¤çä¿¡æ¯ï¼å¦æ¯ä¸ä¸ªåæ¯æ­£å¨è·è¸ªåªä¸ªè¿ç¨åæ¯ä¸æ¬å°åæ¯æ¯å¦æ¯é¢åãè½åææ¯é½æã\n\n$ git branch -vv\n  iss53     7e424c3 [origin/iss53: ahead 2] forgot the brackets\n  master    1ae2a45 [origin/master] deploying index fix\n* serverfix f8674d9 [teamone/server-fix-good: ahead 3, behind 1] this should do it\n  testing   5ea463a trying something new\n\n\n1\n2\n3\n4\n5\n\n\nè¿éå¯ä»¥çå° iss53 åæ¯æ­£å¨è·è¸ª origin/iss53 å¹¶ä¸ âaheadâ æ¯ 2ï¼æå³çæ¬å°æä¸¤ä¸ªæäº¤è¿æ²¡ææ¨éå°æå¡å¨ä¸ã ä¹è½çå° master åæ¯æ­£å¨è·è¸ª origin/master åæ¯å¹¶ä¸æ¯ææ°çã æ¥ä¸æ¥å¯ä»¥çå° serverfix åæ¯æ­£å¨è·è¸ª teamone æå¡å¨ä¸ç server-fix-good åæ¯å¹¶ä¸é¢å 3 è½å 1ï¼ æå³çæå¡å¨ä¸æä¸æ¬¡æäº¤è¿æ²¡æåå¹¶å¥åæ¶æ¬å°æä¸æ¬¡æäº¤è¿æ²¡ææ¨éã æåçå° testing åæ¯å¹¶æ²¡æè·è¸ªä»»ä½è¿ç¨åæ¯ã\n\néè¦éç¹æ³¨æçä¸ç¹æ¯è¿äºæ°å­çå¼æ¥èªäºä½ ä»æ¯ä¸ªæå¡å¨ä¸æåä¸æ¬¡æåçæ°æ®ã è¿ä¸ªå½ä»¤å¹¶æ²¡æè¿æ¥æå¡å¨ï¼å®åªä¼åè¯ä½ å³äºæ¬å°ç¼å­çæå¡å¨æ°æ®ã å¦ææ³è¦ç»è®¡ææ°çé¢åä¸è½åæ°å­ï¼éè¦å¨è¿è¡æ­¤å½ä»¤åæåææçè¿ç¨ä»åºã å¯ä»¥åè¿æ ·åï¼\n\n$ git fetch --all; git branch -vv\n\n\n1\n\n\n\n# æå\n\nå½ git fetch å½ä»¤ä»æå¡å¨ä¸æåæ¬å°æ²¡æçæ°æ®æ¶ï¼å®å¹¶ä¸ä¼ä¿®æ¹å·¥ä½ç®å½ä¸­çåå®¹ã å®åªä¼è·åæ°æ®ç¶åè®©ä½ èªå·±åå¹¶ã ç¶èï¼æä¸ä¸ªå½ä»¤å«ä½ git pull å¨å¤§å¤æ°æåµä¸å®çå«ä¹æ¯ä¸ä¸ª git fetch ç´§æ¥çä¸ä¸ª git merge å½ä»¤ã å¦ææä¸ä¸ªåä¹åç« èä¸­æ¼ç¤ºçè®¾ç½®å¥½çè·è¸ªåæ¯ï¼ä¸ç®¡å®æ¯æ¾å¼å°è®¾ç½®è¿æ¯éè¿ clone æ checkout å½ä»¤ä¸ºä½ åå»ºçï¼git pull é½ä¼æ¥æ¾å½ååæ¯æè·è¸ªçæå¡å¨ä¸åæ¯ï¼ ä»æå¡å¨ä¸æåæ°æ®ç¶åå°è¯åå¹¶å¥é£ä¸ªè¿ç¨åæ¯ã\n\nç±äº git pull çé­æ³ç»å¸¸ä»¤äººå°ææä»¥éå¸¸åç¬æ¾å¼å°ä½¿ç¨ fetch ä¸ merge å½ä»¤ä¼æ´å¥½ä¸äºã\n\n\n# å é¤è¿ç¨åæ¯\n\nåè®¾ä½ å·²ç»éè¿è¿ç¨åæ¯åå®ææçå·¥ä½äºââä¹å°±æ¯è¯´ä½ åä½ çåä½èå·²ç»å®æäºä¸ä¸ªç¹æ§ï¼ å¹¶ä¸å°å¶åå¹¶å°äºè¿ç¨ä»åºç master åæ¯ï¼æä»»ä½å¶ä»ç¨³å®ä»£ç åæ¯ï¼ã å¯ä»¥è¿è¡å¸¦æ --delete éé¡¹ç git push å½ä»¤æ¥å é¤ä¸ä¸ªè¿ç¨åæ¯ã å¦ææ³è¦ä»æå¡å¨ä¸å é¤ serverfix åæ¯ï¼è¿è¡ä¸é¢çå½ä»¤ï¼\n\n$ git push origin --delete serverfix\nto https://github.com/schacon/simplegit\n - [deleted]         serverfix\n\n\n1\n2\n3\n\n\nåºæ¬ä¸è¿ä¸ªå½ä»¤åçåªæ¯ä»æå¡å¨ä¸ç§»é¤è¿ä¸ªæéã git æå¡å¨éå¸¸ä¼ä¿çæ°æ®ä¸æ®µæ¶é´ç´å°åå¾åæ¶è¿è¡ï¼æä»¥å¦æä¸å°å¿å é¤æäºï¼éå¸¸æ¯å¾å®¹ææ¢å¤çã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Gitå·¥å·-æ¥çä¿®è®¢çæ¬",frontmatter:{title:"Gitå·¥å·-æ¥çä¿®è®¢çæ¬",date:"2020-11-18T17:43:57.000Z",permalink:"/pages/c984d1/",categories:["ãGitãå­¦ä¹ ç¬è®°"],tags:["Git"]},regularPath:"/%E3%80%8AGit%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20.%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/80.Git%E5%B7%A5%E5%85%B7-%E6%9F%A5%E7%9C%8B%E4%BF%AE%E8%AE%A2%E7%89%88%E6%9C%AC.html",relativePath:"ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/80.Gitå·¥å·-æ¥çä¿®è®¢çæ¬.md",key:"v-34d42a50",path:"/pages/c984d1/",headers:[{level:2,title:"åä¸ªä¿®è®¢çæ¬",slug:"åä¸ªä¿®è®¢çæ¬",normalizedTitle:"åä¸ªä¿®è®¢çæ¬",charIndex:91},{level:2,title:"ç®ç­ç SHA-1",slug:"ç®ç­ç-sha-1",normalizedTitle:"ç®ç­ç sha-1",charIndex:181},{level:3,title:"æ¥çç»å®SHA-1å¼çæäº¤",slug:"æ¥çç»å®sha-1å¼çæäº¤",normalizedTitle:"æ¥çç»å®sha-1å¼çæäº¤",charIndex:956},{level:2,title:"åæ¯å¼ç¨",slug:"åæ¯å¼ç¨",normalizedTitle:"åæ¯å¼ç¨",charIndex:2177},{level:3,title:"æ¥çæåä¸æ¬¡æäº¤",slug:"æ¥çæåä¸æ¬¡æäº¤",normalizedTitle:"æ¥çæåä¸æ¬¡æäº¤",charIndex:2252},{level:2,title:"å¼ç¨æ¥å¿",slug:"å¼ç¨æ¥å¿",normalizedTitle:"å¼ç¨æ¥å¿",charIndex:2696},{level:3,title:"HEADçæååå²",slug:"headçæååå²",normalizedTitle:"headçæååå²",charIndex:2705},{level:2,title:"ç¥åå¼ç¨",slug:"ç¥åå¼ç¨",normalizedTitle:"ç¥åå¼ç¨",charIndex:4613},{level:2,title:"æäº¤åºé´",slug:"æäº¤åºé´",normalizedTitle:"æäº¤åºé´",charIndex:6634},{level:3,title:"åç¹",slug:"åç¹",normalizedTitle:"åç¹",charIndex:6735},{level:3,title:"å¤ç¹",slug:"å¤ç¹",normalizedTitle:"å¤ç¹",charIndex:7606},{level:3,title:"ä¸ç¹",slug:"ä¸ç¹",normalizedTitle:"ä¸ç¹",charIndex:8032}],headersStr:"åä¸ªä¿®è®¢çæ¬ ç®ç­ç SHA-1 æ¥çç»å®SHA-1å¼çæäº¤ åæ¯å¼ç¨ æ¥çæåä¸æ¬¡æäº¤ å¼ç¨æ¥å¿ HEADçæååå² ç¥åå¼ç¨ æäº¤åºé´ åç¹ å¤ç¹ ä¸ç¹",content:"# Gitå·¥å·-æ¥çä¿®è®¢çæ¬\n\nGit è½å¤ä»¥å¤ç§æ¹å¼æ¥æå®åä¸ªæäº¤ãä¸ç»æäº¤ãæèä¸å®èå´åçæäº¤ã äºè§£å®ä»¬å¹¶ä¸æ¯å¿éçï¼ä½æ¯äºè§£ä¸ä¸æ»æ²¡åå¤ã\n\nä¿®è®¢çæ¬æçæ¯ï¼æäº¤\n\n\n# åä¸ªä¿®è®¢çæ¬\n\nä½ å¯ä»¥éè¿ä»»æä¸ä¸ªæäº¤ç 40 ä¸ªå­ç¬¦çå®æ´ SHA-1 æ£åå¼æ¥æå®å®ï¼ ä¸è¿è¿æå¾å¤æ´äººæ§åçæ¹å¼æ¥ååæ ·çäºæãæ¬èå°ä¼ä»ç»è·ååä¸ªæäº¤çå¤ç§æ¹æ³ã\n\n\n# ç®ç­ç SHA-1\n\nGit ååæºè½ï¼ä½ åªéè¦æä¾ SHA-1 çåå ä¸ªå­ç¬¦å°±å¯ä»¥è·å¾å¯¹åºçé£æ¬¡æäº¤ï¼ å½ç¶ä½ æä¾ç SHA-1 å­ç¬¦æ°éä¸å¾å°äº 4 ä¸ªï¼å¹¶ä¸æ²¡ææ­§ä¹ââä¹å°±æ¯è¯´ï¼ å½åå¯¹è±¡æ°æ®åºä¸­æ²¡æå¶å®å¯¹è±¡ä»¥è¿æ®µ SHA-1 å¼å¤´ã\n\nä¾å¦ï¼è¦æ¥çä½ ç¥éå¶ä¸­æ·»å äºæä¸ªåè½çæäº¤ï¼é¦åè¿è¡ git log å½ä»¤æ¥å®ä½è¯¥æäº¤ï¼\n\n$ git log\ncommit 734713bc047d87bf7eac9674765ae793478c50d3\nAuthor: Scott Chacon <schacon@gmail.com>\nDate:   Fri Jan 2 18:32:33 2009 -0800\n\n    fixed refs handling, added gc auto, updated tests\n\ncommit d921970aadf03b3cf0e71becdaab3147ba71cdef\nMerge: 1c002dd... 35cfb2b...\nAuthor: Scott Chacon <schacon@gmail.com>\nDate:   Thu Dec 11 15:08:43 2008 -0800\n\n    Merge commit 'phedders/rdocs'\n\ncommit 1c002dd4b536e7479fe34593e72e6c6c1819e53b\nAuthor: Scott Chacon <schacon@gmail.com>\nDate:   Thu Dec 11 14:58:32 2008 -0800\n\n    added some blame and merge stuff\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n# æ¥çç»å®SHA-1å¼çæäº¤\n\nå¨æ¬ä¾ä¸­ï¼åè®¾ä½ æ³è¦çæäº¤å¶ SHA-1 ä»¥ 1c002dd.... å¼å¤´ï¼ é£ä¹ä½ å¯ä»¥ç¨å¦ä¸å ç§ git show çåä½æ¥æ£è§è¯¥æäº¤ï¼åè®¾ç®ç­ççæ¬æ²¡ææ­§ä¹ï¼ï¼\n\n$ git show 1c002dd4b536e7479fe34593e72e6c6c1819e53b\n$ git show 1c002dd4b536e7479f\n$ git show 1c002d\n\n\n1\n2\n3\n\n\nGit å¯ä»¥ä¸º SHA-1 å¼çæåºç®ç­ä¸å¯ä¸çç¼©åã å¦æä½ å¨ git log åå ä¸ --abbrev-commit åæ°ï¼è¾åºç»æéå°±ä¼æ¾ç¤ºç®ç­ä¸å¯ä¸çå¼ï¼ é»è®¤ä½¿ç¨ä¸ä¸ªå­ç¬¦ï¼ä¸è¿ææ¶ä¸ºäºé¿å SHA-1 çæ­§ä¹ï¼ä¼å¢å å­ç¬¦æ°ï¼\n\n$ git log --abbrev-commit --pretty=oneline\nca82a6d changed the version number\n085bb3b removed unnecessary test code\na11bef0 first commit\n\n\n1\n2\n3\n4\n\n\néå¸¸ 8 å° 10 ä¸ªå­ç¬¦å°±å·²ç»è¶³å¤å¨ä¸ä¸ªé¡¹ç®ä¸­é¿å SHA-1 çæ­§ä¹ã ä¾å¦ï¼å° 2019 å¹´ 2 æä¸ºæ­¢ï¼Linux åæ ¸è¿ä¸ªç¸å½å¤§ç Git é¡¹ç®ï¼ å¶å¯¹è±¡æ°æ®åºä¸­æè¶è¿ 875,000 ä¸ªæäº¤ï¼åå«ä¸ç¾ä¸ä¸ªå¯¹è±¡ï¼ä¹åªéè¦å 12 ä¸ªå­ç¬¦å°±è½ä¿è¯å¯ä¸æ§ã\n\nNOTE   å³äº SHA-1 çç®ç­è¯´æè®¸å¤äººè§å¾ä»ä»¬çä»åºéæå¯è½åºç°ä¸¤ä¸ªä¸åçå¯¹è±¡å¶ SHA-1 å¼ç¸åã\n       ç¶åå¢ï¼å¦æä½ ççåä»åºéæäº¤äºä¸ä¸ªå¯¹è±¡ï¼å®è·ä¹åçæä¸ª ä¸å å¯¹è±¡ç SHA-1 å¼ç¸åï¼ GIT\n       ä¼åç°è¯¥å¯¹è±¡çæ£åå¼å·²ç»å­å¨äºä»åºéäºï¼äºæ¯å°±ä¼è®¤ä¸ºè¯¥å¯¹è±¡è¢«åå¥ï¼ç¶åç´æ¥ä½¿ç¨å®ã\n       å¦æä¹åä½ æ³æ£åºé£ä¸ªå¯¹è±¡æ¶ï¼ä½ å°å¾å°ååé£ä¸ªå¯¹è±¡çæ°æ®ãä½æ¯è¿ç§æåµåççæ¦çååæ¸ºå°ã SHA-1 æè¦é¿åº¦æ¯ 20\n       å­èï¼ä¹å°±æ¯ 160 ä½ã 2^80 ä¸ªéæºåå¸å¯¹è±¡ææ 50% çæ¦çåºç°ä¸æ¬¡å²çª ï¼è®¡ç®å²çªæºççå¬å¼æ¯ P =\n       (N(N-1)/2) * (1/2^160)) ï¼ã 2^80 æ¯ 1.2 X\n       10^24ï¼ä¹å°±æ¯ä¸äº¿äº¿äº¿ï¼è¿æ¯å°çä¸æ²ç²æ»æ°ç 1200 åãä¸¾ä¾è¯´ä¸ä¸ææ ·æè½äº§çä¸æ¬¡ SHA-1 å²çªã\n       å¦æå°çä¸ 65 äº¿ä¸ªäººç±»é½å¨ç¼ç¨ï¼æ¯äººæ¯ç§é½å¨äº§çç­ä»·äºæ´ä¸ª LINUX åæ ¸åå²ï¼650 ä¸ä¸ª GIT\n       å¯¹è±¡ï¼çä»£ç ï¼ å¹¶å°ä¹æäº¤å°ä¸ä¸ªå·¨å¤§ç GIT ä»åºéé¢ï¼è¿æ ·æç»­ä¸¤å¹´çæ¶é´æä¼äº§çè¶³å¤çå¯¹è±¡ï¼ ä½¿å¶æ¥æ 50%\n       çæ¦çäº§çä¸æ¬¡ SHA-1 å¯¹è±¡å²çªï¼ è¿æ¯ä½ ç¼ç¨å¢éçæååä¸ä¸ªæä¸å¨äºä¸ç¸å¹²çæå¤ä¸­è¢«ç¼è¢­å»å¹¶ææ­»çæºçè¿è¦å°ã\n       \n\n\n# åæ¯å¼ç¨\n\nå¼ç¨ç¹å®æäº¤çä¸ç§ç´æ¥æ¹æ³æ¯ï¼è¥å®æ¯ä¸ä¸ªåæ¯çé¡¶ç«¯çæäº¤ï¼ é£ä¹å¯ä»¥å¨ä»»ä½éè¦å¼ç¨è¯¥æäº¤ç Git å½ä»¤ä¸­ç´æ¥ä½¿ç¨è¯¥åæ¯çåç§°ã\n\n\n# æ¥çæåä¸æ¬¡æäº¤\n\nä¾å¦ï¼ä½ æ³è¦æ¥çä¸ä¸ªåæ¯çæåä¸æ¬¡æäº¤çå¯¹è±¡ï¼åè®¾ topic1 åæ¯æåæäº¤ ca82a6d... ï¼ é£ä¹ä»¥ä¸çå½ä»¤æ¯ç­ä»·çï¼\n\n$ git show ca82a6dff817ec66f44342007202690a93763949\n$ git show topic1  # topic1æ¯åæ¯å\n\n\n1\n2\n\n\nå¦æä½ æ³ç¥éæä¸ªåæ¯æååªä¸ªç¹å®ç SHA-1ï¼æèæ³çä»»ä½ä¸ä¸ªä¾å­ä¸­è¢«ç®åç SHA-1ï¼ ä½ å¯ä»¥ä½¿ç¨ä¸ä¸ªå«å rev-parse ç Git æ¢æµå·¥å·ã ä½ å¯ä»¥å¨ Git åé¨åç ä¸­æ¥çæ´å¤å³äºæ¢æµå·¥å·çä¿¡æ¯ã ç®åæ¥è¯´ï¼rev-parse æ¯ä¸ºäºåºå±æä½èä¸æ¯æ¥å¸¸æä½è®¾è®¡çã ä¸è¿ï¼ææ¶ä½ æ³ç Git ç°å¨å°åºå¤äºä»ä¹ç¶ææ¶ï¼å®å¯è½ä¼å¾æç¨ã ä½ å¯ä»¥å¨ä½ çåæ¯ä¸æ§è¡ rev-parse\n\n$ git rev-parse topic1\nca82a6dff817ec66f44342007202690a93763949\n\n\n1\n2\n\n\n\n# å¼ç¨æ¥å¿\n\n\n# HEADçæååå²\n\nå½ä½ å¨å·¥ä½æ¶ï¼ Git ä¼å¨åå°ä¿å­ä¸ä¸ªå¼ç¨æ¥å¿ï¼reflogï¼ï¼ å¼ç¨æ¥å¿è®°å½äºæè¿å ä¸ªæä½ ç HEAD ååæ¯å¼ç¨ææåçåå²ã\n\nä½ å¯ä»¥ä½¿ç¨ git reflog æ¥æ¥çå¼ç¨æ¥å¿\n\n$ git reflog\n734713b HEAD@{0}: commit: fixed refs handling, added gc auto, updated\nd921970 HEAD@{1}: merge phedders/rdocs: Merge made by the 'recursive' strategy.\n1c002dd HEAD@{2}: commit: added some blame and merge stuff\n1c36188 HEAD@{3}: rebase -i (squash): updating HEAD\n95df984 HEAD@{4}: commit: # This is a combination of two commits.\n1c36188 HEAD@{5}: rebase -i (squash): updating HEAD\n7e05da5 HEAD@{6}: rebase -i (pick): updating HEAD\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næ¯å½ä½ ç HEAD ææåçä½ç½®åçäºååï¼Git å°±ä¼å°è¿ä¸ªä¿¡æ¯å­å¨å°å¼ç¨æ¥å¿è¿ä¸ªåå²è®°å½éã ä½ ä¹å¯ä»¥éè¿ reflog æ°æ®æ¥è·åä¹åçæäº¤åå²ã å¦æä½ æ³æ¥çä»åºä¸­ HEAD å¨äºæ¬¡åçææåçæäº¤ï¼ä½ å¯ä»¥ä½¿ç¨ @{n} æ¥å¼ç¨ reflog ä¸­è¾åºçæäº¤è®°å½ã\n\n$ git show HEAD@{5}\n\n\n1\n\n\nä½ åæ ·å¯ä»¥ä½¿ç¨è¿ä¸ªè¯­æ³æ¥æ¥çæä¸ªåæ¯å¨ä¸å®æ¶é´åçä½ç½®ã ä¾å¦ï¼æ¥çä½ ç master åæ¯å¨æ¨å¤©çæ¶åæåäºåªä¸ªæäº¤ï¼ä½ å¯ä»¥è¾å¥\n\n$ git show master@{yesterday}\n\n\n1\n\n\nå°±ä¼æ¾ç¤ºæ¨å¤© master åæ¯çé¡¶ç«¯æåäºåªä¸ªæäº¤ã è¿ä¸ªæ¹æ³åªå¯¹è¿å¨ä½ å¼ç¨æ¥å¿éçæ°æ®æç¨ï¼æä»¥ä¸è½ç¨æ¥æ¥å¥½å ä¸ªæä¹åçæäº¤ã\n\nå¯ä»¥è¿è¡ git log -g æ¥æ¥çç±»ä¼¼äº git log è¾åºæ ¼å¼çå¼ç¨æ¥å¿ä¿¡æ¯ï¼\n\n$ git log -g master\ncommit 734713bc047d87bf7eac9674765ae793478c50d3\nReflog: master@{0} (Scott Chacon <schacon@gmail.com>)\nReflog message: commit: fixed refs handling, added gc auto, updated\nAuthor: Scott Chacon <schacon@gmail.com>\nDate:   Fri Jan 2 18:32:33 2009 -0800\n\n    fixed refs handling, added gc auto, updated tests\n\ncommit d921970aadf03b3cf0e71becdaab3147ba71cdef\nReflog: master@{1} (Scott Chacon <schacon@gmail.com>)\nReflog message: merge phedders/rdocs: Merge made by recursive.\nAuthor: Scott Chacon <schacon@gmail.com>\nDate:   Thu Dec 11 15:08:43 2008 -0800\n\n    Merge commit 'phedders/rdocs'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nå¼å¾æ³¨æçæ¯ï¼å¼ç¨æ¥å¿åªå­å¨äºæ¬å°ä»åºï¼å®åªæ¯ä¸ä¸ªè®°å½ä½ å¨ èªå·± çä»åºéåè¿ä»ä¹çæ¥å¿ã å¶ä»äººæ·è´çä»åºéçå¼ç¨æ¥å¿ä¸ä¼åä½ çç¸åï¼èä½ æ°åéä¸ä¸ªä»åºçæ¶åï¼å¼ç¨æ¥å¿æ¯ç©ºçï¼å ä¸ºä½ å¨ä»åºéè¿æ²¡ææä½ã git show HEAD@{2.months.ago} è¿æ¡å½ä»¤åªæå¨ä½ åéäºä¸ä¸ªé¡¹ç®è³å°ä¸¤ä¸ªææ¶æä¼æ¾ç¤ºå¹éçæäº¤ââ å¦æä½ åååéäºä»åºï¼é£ä¹å®å°ä¸ä¼æä»»ä½ç»æè¿åã\n\nTIP   å°å¼ç¨æ¥å¿æ³ä½ GIT çç SHELL åå²è®°å½å¦æä½ æ UNIX æè LINUX çèæ¯ï¼ä¸å¦¨å°å¼ç¨æ¥å¿æ³ä½\n      GIT çç SHELL åå²è®°å½ï¼ éç¹å¨äºä»ä¸ä½ åä½ çä¼è¯ç¸å³ï¼èä¸ä»äººæ å³ã\n      \n\n\n# ç¥åå¼ç¨\n\nç¥åå¼ç¨æ¯å¦ä¸ç§ææä¸ä¸ªæäº¤çæ¹å¼ã å¦æä½ å¨å¼ç¨çå°¾é¨å ä¸ä¸ä¸ª ^ï¼è±å­ç¬¦ï¼ï¼ Git ä¼å°å¶è§£æä¸ºè¯¥å¼ç¨çä¸ä¸ä¸ªæäº¤ã åè®¾ä½ çæäº¤åå²æ¯ï¼\n\n$ git log --pretty=format:'%h %s' --graph\n* 734713b fixed refs handling, added gc auto, updated tests\n*   d921970 Merge commit 'phedders/rdocs'\n|\\\n| * 35cfb2b Some rdoc changes\n* | 1c002dd added some blame and merge stuff\n|/\n* 1c36188 ignore *.gem\n* 9b29157 add open3_detach to gemspec file list\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä½ å¯ä»¥ä½¿ç¨ HEAD^ æ¥æ¥çä¸ä¸ä¸ªæäº¤ï¼ä¹å°±æ¯ âHEAD çç¶æäº¤âï¼\n\n$ git show HEAD^\ncommit d921970aadf03b3cf0e71becdaab3147ba71cdef\nMerge: 1c002dd... 35cfb2b...\nAuthor: Scott Chacon <schacon@gmail.com>\nDate:   Thu Dec 11 15:08:43 2008 -0800\n\n    Merge commit 'phedders/rdocs'\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nNOTE   å¨ WINDOWS ä¸è½¬ä¹è±å­ç¬¦å¨ WINDOWS ç CMD.EXE ä¸­ï¼^ æ¯ä¸ä¸ªç¹æ®å­ç¬¦ï¼å æ­¤éè¦åºå«å¯¹å¾ã\n       ä½ å¯ä»¥ååå®æèå°æäº¤å¼ç¨æ¾å¨å¼å·ä¸­ï¼$ GIT SHOW HEAD^ # å¨ WINDOWS ä¸æ æ³å·¥ä½ $ GIT\n       SHOW HEAD^^ # å¯ä»¥ $ GIT SHOW \"HEAD^\" # å¯ä»¥\n       \n\nä½ ä¹å¯ä»¥å¨ ^ åé¢æ·»å ä¸ä¸ªæ°å­æ¥æææ³è¦ åªä¸ä¸ª ç¶æäº¤ââä¾å¦ d921970^2 ä»£è¡¨ âd921970 çç¬¬äºç¶æäº¤â è¿ä¸ªè¯­æ³åªéç¨äºåå¹¶çæäº¤ï¼å ä¸ºåå¹¶æäº¤ä¼æå¤ä¸ªç¶æäº¤ã åå¹¶æäº¤çç¬¬ä¸ç¶æäº¤æ¯ä½ åå¹¶æ¶æå¨åæ¯ï¼éå¸¸ä¸º masterï¼ï¼èç¬¬äºç¶æäº¤æ¯ä½ æåå¹¶çåæ¯ï¼ä¾å¦ topicï¼ï¼\n\n$ git show d921970^\ncommit 1c002dd4b536e7479fe34593e72e6c6c1819e53b\nAuthor: Scott Chacon <schacon@gmail.com>\nDate:   Thu Dec 11 14:58:32 2008 -0800\n\n    added some blame and merge stuff\n\n$ git show d921970^2\ncommit 35cfb2b795a55793d7cc56a6cc2060b4bb732548\nAuthor: Paul Hedderly <paul+git@mjr.org>\nDate:   Wed Dec 10 22:22:03 2008 +0000\n\n    Some rdoc changes\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nå¦ä¸ç§ææç¥åæäº¤çæ¹æ³æ¯ ~ï¼æ³¢æµªå·ï¼ã åæ ·æ¯æåç¬¬ä¸ç¶æäº¤ï¼å æ­¤ HEAD~ å HEAD^ æ¯ç­ä»·çã èåºå«å¨äºä½ å¨åé¢å æ°å­çæ¶åã HEAD~2 ä»£è¡¨âç¬¬ä¸ç¶æäº¤çç¬¬ä¸ç¶æäº¤âï¼ä¹å°±æ¯âç¥ç¶æäº¤âââGit ä¼æ ¹æ®ä½ æå®çæ¬¡æ°è·åå¯¹åºçç¬¬ä¸ç¶æäº¤ã ä¾å¦ï¼å¨ä¹åçååºçæäº¤åå²ä¸­ï¼HEAD~3 å°±æ¯\n\n$ git show HEAD~3\ncommit 1c3618887afb5fbcbea25b7c013f4e2114448b8d\nAuthor: Tom Preston-Werner <tom@mojombo.com>\nDate:   Fri Nov 7 13:47:59 2008 -0500\n\n    ignore *.gem\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¹å¯ä»¥åæ HEAD~~~ï¼ä¹æ¯ç¬¬ä¸ç¶æäº¤çç¬¬ä¸ç¶æäº¤çç¬¬ä¸ç¶æäº¤ï¼\n\n$ git show HEAD~~~\ncommit 1c3618887afb5fbcbea25b7c013f4e2114448b8d\nAuthor: Tom Preston-Werner <tom@mojombo.com>\nDate:   Fri Nov 7 13:47:59 2008 -0500\n\n    ignore *.gem\n\n\n1\n2\n3\n4\n5\n6\n\n\nä½ ä¹å¯ä»¥ç»åä½¿ç¨è¿ä¸¤ä¸ªè¯­æ³ââä½ å¯ä»¥éè¿ HEAD~3^2 æ¥åå¾ä¹åå¼ç¨çç¬¬äºç¶æäº¤ï¼åè®¾å®æ¯ä¸ä¸ªåå¹¶æäº¤ï¼ã\n\n\n# æäº¤åºé´\n\nä½ å·²ç»å­¦ä¼å¦ä½åæ¬¡çæäº¤ï¼ç°å¨æ¥ççå¦ä½ææä¸å®åºé´çæäº¤ã å½ä½ æå¾å¤åæ¯æ¶ï¼è¿å¯¹ç®¡çä½ çåæ¯æ¶ååæç¨ï¼ ä½ å¯ä»¥ç¨æäº¤åºé´æ¥è§£å³âè¿ä¸ªåæ¯è¿æåªäºæäº¤å°æªåå¹¶å°ä¸»åæ¯ï¼âçé®é¢\n\n\n# åç¹\n\næå¸¸ç¨çæææäº¤åºé´è¯­æ³æ¯åç¹ã è¿ç§è¯­æ³å¯ä»¥è®© Git éåºå¨ä¸ä¸ªåæ¯ä¸­èä¸å¨å¦ä¸ä¸ªåæ¯ä¸­çæäº¤ã ä¾å¦ï¼ä½ æå¦ä¸çæäº¤åå² Example history for range selection.\n\n\n\nFigure 137. Example history for range selection.\n\nä½ æ³è¦æ¥ç experiment åæ¯ä¸­è¿æåªäºæäº¤å°æªè¢«åå¹¶å¥ master åæ¯ã ä½ å¯ä»¥ä½¿ç¨ master..experiment æ¥è®© Git æ¾ç¤ºè¿äºæäº¤ãä¹å°±æ¯âå¨ experiment åæ¯ä¸­èä¸å¨ master åæ¯ä¸­çæäº¤âã ä¸ºäºä½¿ä¾å­ç®åæäºï¼æä½¿ç¨äºç¤ºæå¾ä¸­æäº¤å¯¹è±¡çå­æ¯æ¥ä»£æ¿çå®æ¥å¿çè¾åºï¼æä»¥ä¼æ¾ç¤ºï¼\n\n$ git log master..experiment\nD\nC\n\n\n1\n2\n3\n\n\nåè¿æ¥ï¼å¦æä½ æ³æ¥çå¨ master åæ¯ä¸­èä¸å¨ experiment åæ¯ä¸­çæäº¤ï¼ä½ åªè¦äº¤æ¢åæ¯åå³å¯ã experiment..master ä¼æ¾ç¤ºå¨ master åæ¯ä¸­èä¸å¨ experiment åæ¯ä¸­çæäº¤ï¼\n\n$ git log experiment..master\nF\nE\n\n\n1\n2\n3\n\n\n# æ¥çå³å°æ¨éå°è¿ç«¯çåå®¹\n\nè¿å¯ä»¥è®©ä½ ä¿æ experiment åæ¯è·éææ°çè¿åº¦ä»¥åæ¥çä½ å³å°åå¹¶çåå®¹ã å¦ä¸ä¸ªå¸¸ç¨çåºæ¯æ¯æ¥çä½ å³å°æ¨éå°è¿ç«¯çåå®¹ï¼\n\n$ git log origin/master..HEAD\n\n\n1\n\n\nè¿ä¸ªå½ä»¤ä¼è¾åºå¨ä½ å½ååæ¯ä¸­èä¸å¨è¿ç¨ origin ä¸­çæäº¤ã å¦æä½ æ§è¡ git push å¹¶ä¸ä½ çå½ååæ¯æ­£å¨è·è¸ª origin/masterï¼ç± git log origin/master..HEAD æè¾åºçæäº¤å°±æ¯ä¼è¢«ä¼ è¾å°è¿ç«¯æå¡å¨çæäº¤ãå¦æä½ çç©ºäºå¶ä¸­çä¸è¾¹ï¼ Git ä¼é»è®¤ä¸º HEADã ä¾å¦ï¼ git log origin/master.. å°ä¼è¾åºä¸ä¹åä¾å­ç¸åçç»æ ââ Git ä½¿ç¨ HEAD æ¥ä»£æ¿çç©ºçä¸è¾¹ã\n\n\n# å¤ç¹\n\nåç¹è¯­æ³å¾å¥½ç¨ï¼ä½ææ¶åä½ å¯è½éè¦ä¸¤ä¸ªä»¥ä¸çåæ¯æè½ç¡®å®ä½ æéè¦çä¿®è®¢ï¼ æ¯å¦æ¥çåªäºæäº¤æ¯è¢«åå«å¨æäºåæ¯ä¸­çä¸ä¸ªï¼ä½æ¯ä¸å¨ä½ å½åçåæ¯ä¸ã Git åè®¸ä½ å¨ä»»æå¼ç¨åå ä¸ ^ å­ç¬¦æè --not æ¥ææä½ ä¸å¸ææäº¤è¢«åå«å¶ä¸­çåæ¯ã å æ­¤ä¸åä¸ä¸ªå½ä»¤æ¯ç­ä»·çï¼\n\n$ git log refA..refB\n$ git log ^refA refB\n$ git log refB --not refA\n\n\n1\n2\n3\n\n\nè¿ä¸ªè¯­æ³å¾å¥½ç¨ï¼å ä¸ºä½ å¯ä»¥å¨æ¥è¯¢ä¸­æå®è¶è¿ä¸¤ä¸ªçå¼ç¨ï¼è¿æ¯åç¹è¯­æ³æ æ³å®ç°çã æ¯å¦ï¼ä½ æ³æ¥çææè¢« refA æ refB åå«çä½æ¯ä¸è¢« refC åå«çæäº¤ï¼ä½ å¯ä»¥ä½¿ç¨ä»¥ä¸ä»»æä¸ä¸ªå½ä»¤ï¼\n\n$ git log refA refB ^refC\n$ git log refA refB --not refC\n\n\n1\n2\n\n\nè¿å°±ææäºä¸ä¸ªååå¼ºå¤§çä¿®è®¢æ¥è¯¢ç³»ç»ï¼ä½ å¯ä»¥éè¿å®æ¥æ¥çä½ çåæ¯éåå«äºåªäºä¸è¥¿ã\n\n\n# ä¸ç¹\n\næåä¸ç§ä¸»è¦çåºé´éæ©è¯­æ³æ¯ä¸ç¹ï¼è¿ä¸ªè¯­æ³å¯ä»¥éæ©åºè¢«ä¸¤ä¸ªå¼ç¨ ä¹ä¸ åå«ä½åä¸è¢«ä¸¤èåæ¶åå«çæäº¤ã åççä¹ååç¹ä¾å­ä¸­çæäº¤åå²ã å¦æä½ æ³ç master æè experiment ä¸­åå«çä½ä¸æ¯ä¸¤èå±æçæäº¤ï¼ä½ å¯ä»¥æ§è¡ï¼\n\n$ git log master...experiment\nF\nE\nD\nC\n\n\n1\n2\n3\n4\n5\n\n\nè¿åéå¸¸ log ææ¥ææåºçè¾åºä¸æ ·ï¼ä»ä»ç»åºäº4ä¸ªæäº¤çä¿¡æ¯ã\n\nè¿ç§æå½¢ä¸ï¼log å½ä»¤çä¸ä¸ªå¸¸ç¨åæ°æ¯ --left-rightï¼å®ä¼æ¾ç¤ºæ¯ä¸ªæäº¤å°åºå¤äºåªä¸ä¾§çåæ¯ã è¿ä¼è®©è¾åºæ°æ®æ´å æ¸æ°ã\n\n$ git log --left-right master...experiment\n< F\n< E\n> D\n> C\n\n\n1\n2\n3\n4\n5\n\n\næäºè¿äºå·¥å·ï¼ä½ å°±å¯ä»¥ååæ¹ä¾¿å°æ¥çä½  Git ä»åºä¸­çæäº¤ã",normalizedContent:"# gitå·¥å·-æ¥çä¿®è®¢çæ¬\n\ngit è½å¤ä»¥å¤ç§æ¹å¼æ¥æå®åä¸ªæäº¤ãä¸ç»æäº¤ãæèä¸å®èå´åçæäº¤ã äºè§£å®ä»¬å¹¶ä¸æ¯å¿éçï¼ä½æ¯äºè§£ä¸ä¸æ»æ²¡åå¤ã\n\nä¿®è®¢çæ¬æçæ¯ï¼æäº¤\n\n\n# åä¸ªä¿®è®¢çæ¬\n\nä½ å¯ä»¥éè¿ä»»æä¸ä¸ªæäº¤ç 40 ä¸ªå­ç¬¦çå®æ´ sha-1 æ£åå¼æ¥æå®å®ï¼ ä¸è¿è¿æå¾å¤æ´äººæ§åçæ¹å¼æ¥ååæ ·çäºæãæ¬èå°ä¼ä»ç»è·ååä¸ªæäº¤çå¤ç§æ¹æ³ã\n\n\n# ç®ç­ç sha-1\n\ngit ååæºè½ï¼ä½ åªéè¦æä¾ sha-1 çåå ä¸ªå­ç¬¦å°±å¯ä»¥è·å¾å¯¹åºçé£æ¬¡æäº¤ï¼ å½ç¶ä½ æä¾ç sha-1 å­ç¬¦æ°éä¸å¾å°äº 4 ä¸ªï¼å¹¶ä¸æ²¡ææ­§ä¹ââä¹å°±æ¯è¯´ï¼ å½åå¯¹è±¡æ°æ®åºä¸­æ²¡æå¶å®å¯¹è±¡ä»¥è¿æ®µ sha-1 å¼å¤´ã\n\nä¾å¦ï¼è¦æ¥çä½ ç¥éå¶ä¸­æ·»å äºæä¸ªåè½çæäº¤ï¼é¦åè¿è¡ git log å½ä»¤æ¥å®ä½è¯¥æäº¤ï¼\n\n$ git log\ncommit 734713bc047d87bf7eac9674765ae793478c50d3\nauthor: scott chacon <schacon@gmail.com>\ndate:   fri jan 2 18:32:33 2009 -0800\n\n    fixed refs handling, added gc auto, updated tests\n\ncommit d921970aadf03b3cf0e71becdaab3147ba71cdef\nmerge: 1c002dd... 35cfb2b...\nauthor: scott chacon <schacon@gmail.com>\ndate:   thu dec 11 15:08:43 2008 -0800\n\n    merge commit 'phedders/rdocs'\n\ncommit 1c002dd4b536e7479fe34593e72e6c6c1819e53b\nauthor: scott chacon <schacon@gmail.com>\ndate:   thu dec 11 14:58:32 2008 -0800\n\n    added some blame and merge stuff\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n# æ¥çç»å®sha-1å¼çæäº¤\n\nå¨æ¬ä¾ä¸­ï¼åè®¾ä½ æ³è¦çæäº¤å¶ sha-1 ä»¥ 1c002dd.... å¼å¤´ï¼ é£ä¹ä½ å¯ä»¥ç¨å¦ä¸å ç§ git show çåä½æ¥æ£è§è¯¥æäº¤ï¼åè®¾ç®ç­ççæ¬æ²¡ææ­§ä¹ï¼ï¼\n\n$ git show 1c002dd4b536e7479fe34593e72e6c6c1819e53b\n$ git show 1c002dd4b536e7479f\n$ git show 1c002d\n\n\n1\n2\n3\n\n\ngit å¯ä»¥ä¸º sha-1 å¼çæåºç®ç­ä¸å¯ä¸çç¼©åã å¦æä½ å¨ git log åå ä¸ --abbrev-commit åæ°ï¼è¾åºç»æéå°±ä¼æ¾ç¤ºç®ç­ä¸å¯ä¸çå¼ï¼ é»è®¤ä½¿ç¨ä¸ä¸ªå­ç¬¦ï¼ä¸è¿ææ¶ä¸ºäºé¿å sha-1 çæ­§ä¹ï¼ä¼å¢å å­ç¬¦æ°ï¼\n\n$ git log --abbrev-commit --pretty=oneline\nca82a6d changed the version number\n085bb3b removed unnecessary test code\na11bef0 first commit\n\n\n1\n2\n3\n4\n\n\néå¸¸ 8 å° 10 ä¸ªå­ç¬¦å°±å·²ç»è¶³å¤å¨ä¸ä¸ªé¡¹ç®ä¸­é¿å sha-1 çæ­§ä¹ã ä¾å¦ï¼å° 2019 å¹´ 2 æä¸ºæ­¢ï¼linux åæ ¸è¿ä¸ªç¸å½å¤§ç git é¡¹ç®ï¼ å¶å¯¹è±¡æ°æ®åºä¸­æè¶è¿ 875,000 ä¸ªæäº¤ï¼åå«ä¸ç¾ä¸ä¸ªå¯¹è±¡ï¼ä¹åªéè¦å 12 ä¸ªå­ç¬¦å°±è½ä¿è¯å¯ä¸æ§ã\n\nnote   å³äº sha-1 çç®ç­è¯´æè®¸å¤äººè§å¾ä»ä»¬çä»åºéæå¯è½åºç°ä¸¤ä¸ªä¸åçå¯¹è±¡å¶ sha-1 å¼ç¸åã\n       ç¶åå¢ï¼å¦æä½ ççåä»åºéæäº¤äºä¸ä¸ªå¯¹è±¡ï¼å®è·ä¹åçæä¸ª ä¸å å¯¹è±¡ç sha-1 å¼ç¸åï¼ git\n       ä¼åç°è¯¥å¯¹è±¡çæ£åå¼å·²ç»å­å¨äºä»åºéäºï¼äºæ¯å°±ä¼è®¤ä¸ºè¯¥å¯¹è±¡è¢«åå¥ï¼ç¶åç´æ¥ä½¿ç¨å®ã\n       å¦æä¹åä½ æ³æ£åºé£ä¸ªå¯¹è±¡æ¶ï¼ä½ å°å¾å°ååé£ä¸ªå¯¹è±¡çæ°æ®ãä½æ¯è¿ç§æåµåççæ¦çååæ¸ºå°ã sha-1 æè¦é¿åº¦æ¯ 20\n       å­èï¼ä¹å°±æ¯ 160 ä½ã 2^80 ä¸ªéæºåå¸å¯¹è±¡ææ 50% çæ¦çåºç°ä¸æ¬¡å²çª ï¼è®¡ç®å²çªæºççå¬å¼æ¯ p =\n       (n(n-1)/2) * (1/2^160)) ï¼ã 2^80 æ¯ 1.2 x\n       10^24ï¼ä¹å°±æ¯ä¸äº¿äº¿äº¿ï¼è¿æ¯å°çä¸æ²ç²æ»æ°ç 1200 åãä¸¾ä¾è¯´ä¸ä¸ææ ·æè½äº§çä¸æ¬¡ sha-1 å²çªã\n       å¦æå°çä¸ 65 äº¿ä¸ªäººç±»é½å¨ç¼ç¨ï¼æ¯äººæ¯ç§é½å¨äº§çç­ä»·äºæ´ä¸ª linux åæ ¸åå²ï¼650 ä¸ä¸ª git\n       å¯¹è±¡ï¼çä»£ç ï¼ å¹¶å°ä¹æäº¤å°ä¸ä¸ªå·¨å¤§ç git ä»åºéé¢ï¼è¿æ ·æç»­ä¸¤å¹´çæ¶é´æä¼äº§çè¶³å¤çå¯¹è±¡ï¼ ä½¿å¶æ¥æ 50%\n       çæ¦çäº§çä¸æ¬¡ sha-1 å¯¹è±¡å²çªï¼ è¿æ¯ä½ ç¼ç¨å¢éçæååä¸ä¸ªæä¸å¨äºä¸ç¸å¹²çæå¤ä¸­è¢«ç¼è¢­å»å¹¶ææ­»çæºçè¿è¦å°ã\n       \n\n\n# åæ¯å¼ç¨\n\nå¼ç¨ç¹å®æäº¤çä¸ç§ç´æ¥æ¹æ³æ¯ï¼è¥å®æ¯ä¸ä¸ªåæ¯çé¡¶ç«¯çæäº¤ï¼ é£ä¹å¯ä»¥å¨ä»»ä½éè¦å¼ç¨è¯¥æäº¤ç git å½ä»¤ä¸­ç´æ¥ä½¿ç¨è¯¥åæ¯çåç§°ã\n\n\n# æ¥çæåä¸æ¬¡æäº¤\n\nä¾å¦ï¼ä½ æ³è¦æ¥çä¸ä¸ªåæ¯çæåä¸æ¬¡æäº¤çå¯¹è±¡ï¼åè®¾ topic1 åæ¯æåæäº¤ ca82a6d... ï¼ é£ä¹ä»¥ä¸çå½ä»¤æ¯ç­ä»·çï¼\n\n$ git show ca82a6dff817ec66f44342007202690a93763949\n$ git show topic1  # topic1æ¯åæ¯å\n\n\n1\n2\n\n\nå¦æä½ æ³ç¥éæä¸ªåæ¯æååªä¸ªç¹å®ç sha-1ï¼æèæ³çä»»ä½ä¸ä¸ªä¾å­ä¸­è¢«ç®åç sha-1ï¼ ä½ å¯ä»¥ä½¿ç¨ä¸ä¸ªå«å rev-parse ç git æ¢æµå·¥å·ã ä½ å¯ä»¥å¨ git åé¨åç ä¸­æ¥çæ´å¤å³äºæ¢æµå·¥å·çä¿¡æ¯ã ç®åæ¥è¯´ï¼rev-parse æ¯ä¸ºäºåºå±æä½èä¸æ¯æ¥å¸¸æä½è®¾è®¡çã ä¸è¿ï¼ææ¶ä½ æ³ç git ç°å¨å°åºå¤äºä»ä¹ç¶ææ¶ï¼å®å¯è½ä¼å¾æç¨ã ä½ å¯ä»¥å¨ä½ çåæ¯ä¸æ§è¡ rev-parse\n\n$ git rev-parse topic1\nca82a6dff817ec66f44342007202690a93763949\n\n\n1\n2\n\n\n\n# å¼ç¨æ¥å¿\n\n\n# headçæååå²\n\nå½ä½ å¨å·¥ä½æ¶ï¼ git ä¼å¨åå°ä¿å­ä¸ä¸ªå¼ç¨æ¥å¿ï¼reflogï¼ï¼ å¼ç¨æ¥å¿è®°å½äºæè¿å ä¸ªæä½ ç head ååæ¯å¼ç¨ææåçåå²ã\n\nä½ å¯ä»¥ä½¿ç¨ git reflog æ¥æ¥çå¼ç¨æ¥å¿\n\n$ git reflog\n734713b head@{0}: commit: fixed refs handling, added gc auto, updated\nd921970 head@{1}: merge phedders/rdocs: merge made by the 'recursive' strategy.\n1c002dd head@{2}: commit: added some blame and merge stuff\n1c36188 head@{3}: rebase -i (squash): updating head\n95df984 head@{4}: commit: # this is a combination of two commits.\n1c36188 head@{5}: rebase -i (squash): updating head\n7e05da5 head@{6}: rebase -i (pick): updating head\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næ¯å½ä½ ç head ææåçä½ç½®åçäºååï¼git å°±ä¼å°è¿ä¸ªä¿¡æ¯å­å¨å°å¼ç¨æ¥å¿è¿ä¸ªåå²è®°å½éã ä½ ä¹å¯ä»¥éè¿ reflog æ°æ®æ¥è·åä¹åçæäº¤åå²ã å¦æä½ æ³æ¥çä»åºä¸­ head å¨äºæ¬¡åçææåçæäº¤ï¼ä½ å¯ä»¥ä½¿ç¨ @{n} æ¥å¼ç¨ reflog ä¸­è¾åºçæäº¤è®°å½ã\n\n$ git show head@{5}\n\n\n1\n\n\nä½ åæ ·å¯ä»¥ä½¿ç¨è¿ä¸ªè¯­æ³æ¥æ¥çæä¸ªåæ¯å¨ä¸å®æ¶é´åçä½ç½®ã ä¾å¦ï¼æ¥çä½ ç master åæ¯å¨æ¨å¤©çæ¶åæåäºåªä¸ªæäº¤ï¼ä½ å¯ä»¥è¾å¥\n\n$ git show master@{yesterday}\n\n\n1\n\n\nå°±ä¼æ¾ç¤ºæ¨å¤© master åæ¯çé¡¶ç«¯æåäºåªä¸ªæäº¤ã è¿ä¸ªæ¹æ³åªå¯¹è¿å¨ä½ å¼ç¨æ¥å¿éçæ°æ®æç¨ï¼æä»¥ä¸è½ç¨æ¥æ¥å¥½å ä¸ªæä¹åçæäº¤ã\n\nå¯ä»¥è¿è¡ git log -g æ¥æ¥çç±»ä¼¼äº git log è¾åºæ ¼å¼çå¼ç¨æ¥å¿ä¿¡æ¯ï¼\n\n$ git log -g master\ncommit 734713bc047d87bf7eac9674765ae793478c50d3\nreflog: master@{0} (scott chacon <schacon@gmail.com>)\nreflog message: commit: fixed refs handling, added gc auto, updated\nauthor: scott chacon <schacon@gmail.com>\ndate:   fri jan 2 18:32:33 2009 -0800\n\n    fixed refs handling, added gc auto, updated tests\n\ncommit d921970aadf03b3cf0e71becdaab3147ba71cdef\nreflog: master@{1} (scott chacon <schacon@gmail.com>)\nreflog message: merge phedders/rdocs: merge made by recursive.\nauthor: scott chacon <schacon@gmail.com>\ndate:   thu dec 11 15:08:43 2008 -0800\n\n    merge commit 'phedders/rdocs'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nå¼å¾æ³¨æçæ¯ï¼å¼ç¨æ¥å¿åªå­å¨äºæ¬å°ä»åºï¼å®åªæ¯ä¸ä¸ªè®°å½ä½ å¨ èªå·± çä»åºéåè¿ä»ä¹çæ¥å¿ã å¶ä»äººæ·è´çä»åºéçå¼ç¨æ¥å¿ä¸ä¼åä½ çç¸åï¼èä½ æ°åéä¸ä¸ªä»åºçæ¶åï¼å¼ç¨æ¥å¿æ¯ç©ºçï¼å ä¸ºä½ å¨ä»åºéè¿æ²¡ææä½ã git show head@{2.months.ago} è¿æ¡å½ä»¤åªæå¨ä½ åéäºä¸ä¸ªé¡¹ç®è³å°ä¸¤ä¸ªææ¶æä¼æ¾ç¤ºå¹éçæäº¤ââ å¦æä½ åååéäºä»åºï¼é£ä¹å®å°ä¸ä¼æä»»ä½ç»æè¿åã\n\ntip   å°å¼ç¨æ¥å¿æ³ä½ git çç shell åå²è®°å½å¦æä½ æ unix æè linux çèæ¯ï¼ä¸å¦¨å°å¼ç¨æ¥å¿æ³ä½\n      git çç shell åå²è®°å½ï¼ éç¹å¨äºä»ä¸ä½ åä½ çä¼è¯ç¸å³ï¼èä¸ä»äººæ å³ã\n      \n\n\n# ç¥åå¼ç¨\n\nç¥åå¼ç¨æ¯å¦ä¸ç§ææä¸ä¸ªæäº¤çæ¹å¼ã å¦æä½ å¨å¼ç¨çå°¾é¨å ä¸ä¸ä¸ª ^ï¼è±å­ç¬¦ï¼ï¼ git ä¼å°å¶è§£æä¸ºè¯¥å¼ç¨çä¸ä¸ä¸ªæäº¤ã åè®¾ä½ çæäº¤åå²æ¯ï¼\n\n$ git log --pretty=format:'%h %s' --graph\n* 734713b fixed refs handling, added gc auto, updated tests\n*   d921970 merge commit 'phedders/rdocs'\n|\\\n| * 35cfb2b some rdoc changes\n* | 1c002dd added some blame and merge stuff\n|/\n* 1c36188 ignore *.gem\n* 9b29157 add open3_detach to gemspec file list\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä½ å¯ä»¥ä½¿ç¨ head^ æ¥æ¥çä¸ä¸ä¸ªæäº¤ï¼ä¹å°±æ¯ âhead çç¶æäº¤âï¼\n\n$ git show head^\ncommit d921970aadf03b3cf0e71becdaab3147ba71cdef\nmerge: 1c002dd... 35cfb2b...\nauthor: scott chacon <schacon@gmail.com>\ndate:   thu dec 11 15:08:43 2008 -0800\n\n    merge commit 'phedders/rdocs'\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nnote   å¨ windows ä¸è½¬ä¹è±å­ç¬¦å¨ windows ç cmd.exe ä¸­ï¼^ æ¯ä¸ä¸ªç¹æ®å­ç¬¦ï¼å æ­¤éè¦åºå«å¯¹å¾ã\n       ä½ å¯ä»¥ååå®æèå°æäº¤å¼ç¨æ¾å¨å¼å·ä¸­ï¼$ git show head^ # å¨ windows ä¸æ æ³å·¥ä½ $ git\n       show head^^ # å¯ä»¥ $ git show \"head^\" # å¯ä»¥\n       \n\nä½ ä¹å¯ä»¥å¨ ^ åé¢æ·»å ä¸ä¸ªæ°å­æ¥æææ³è¦ åªä¸ä¸ª ç¶æäº¤ââä¾å¦ d921970^2 ä»£è¡¨ âd921970 çç¬¬äºç¶æäº¤â è¿ä¸ªè¯­æ³åªéç¨äºåå¹¶çæäº¤ï¼å ä¸ºåå¹¶æäº¤ä¼æå¤ä¸ªç¶æäº¤ã åå¹¶æäº¤çç¬¬ä¸ç¶æäº¤æ¯ä½ åå¹¶æ¶æå¨åæ¯ï¼éå¸¸ä¸º masterï¼ï¼èç¬¬äºç¶æäº¤æ¯ä½ æåå¹¶çåæ¯ï¼ä¾å¦ topicï¼ï¼\n\n$ git show d921970^\ncommit 1c002dd4b536e7479fe34593e72e6c6c1819e53b\nauthor: scott chacon <schacon@gmail.com>\ndate:   thu dec 11 14:58:32 2008 -0800\n\n    added some blame and merge stuff\n\n$ git show d921970^2\ncommit 35cfb2b795a55793d7cc56a6cc2060b4bb732548\nauthor: paul hedderly <paul+git@mjr.org>\ndate:   wed dec 10 22:22:03 2008 +0000\n\n    some rdoc changes\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nå¦ä¸ç§ææç¥åæäº¤çæ¹æ³æ¯ ~ï¼æ³¢æµªå·ï¼ã åæ ·æ¯æåç¬¬ä¸ç¶æäº¤ï¼å æ­¤ head~ å head^ æ¯ç­ä»·çã èåºå«å¨äºä½ å¨åé¢å æ°å­çæ¶åã head~2 ä»£è¡¨âç¬¬ä¸ç¶æäº¤çç¬¬ä¸ç¶æäº¤âï¼ä¹å°±æ¯âç¥ç¶æäº¤âââgit ä¼æ ¹æ®ä½ æå®çæ¬¡æ°è·åå¯¹åºçç¬¬ä¸ç¶æäº¤ã ä¾å¦ï¼å¨ä¹åçååºçæäº¤åå²ä¸­ï¼head~3 å°±æ¯\n\n$ git show head~3\ncommit 1c3618887afb5fbcbea25b7c013f4e2114448b8d\nauthor: tom preston-werner <tom@mojombo.com>\ndate:   fri nov 7 13:47:59 2008 -0500\n\n    ignore *.gem\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¹å¯ä»¥åæ head~~~ï¼ä¹æ¯ç¬¬ä¸ç¶æäº¤çç¬¬ä¸ç¶æäº¤çç¬¬ä¸ç¶æäº¤ï¼\n\n$ git show head~~~\ncommit 1c3618887afb5fbcbea25b7c013f4e2114448b8d\nauthor: tom preston-werner <tom@mojombo.com>\ndate:   fri nov 7 13:47:59 2008 -0500\n\n    ignore *.gem\n\n\n1\n2\n3\n4\n5\n6\n\n\nä½ ä¹å¯ä»¥ç»åä½¿ç¨è¿ä¸¤ä¸ªè¯­æ³ââä½ å¯ä»¥éè¿ head~3^2 æ¥åå¾ä¹åå¼ç¨çç¬¬äºç¶æäº¤ï¼åè®¾å®æ¯ä¸ä¸ªåå¹¶æäº¤ï¼ã\n\n\n# æäº¤åºé´\n\nä½ å·²ç»å­¦ä¼å¦ä½åæ¬¡çæäº¤ï¼ç°å¨æ¥ççå¦ä½ææä¸å®åºé´çæäº¤ã å½ä½ æå¾å¤åæ¯æ¶ï¼è¿å¯¹ç®¡çä½ çåæ¯æ¶ååæç¨ï¼ ä½ å¯ä»¥ç¨æäº¤åºé´æ¥è§£å³âè¿ä¸ªåæ¯è¿æåªäºæäº¤å°æªåå¹¶å°ä¸»åæ¯ï¼âçé®é¢\n\n\n# åç¹\n\næå¸¸ç¨çæææäº¤åºé´è¯­æ³æ¯åç¹ã è¿ç§è¯­æ³å¯ä»¥è®© git éåºå¨ä¸ä¸ªåæ¯ä¸­èä¸å¨å¦ä¸ä¸ªåæ¯ä¸­çæäº¤ã ä¾å¦ï¼ä½ æå¦ä¸çæäº¤åå² example history for range selection.\n\n\n\nfigure 137. example history for range selection.\n\nä½ æ³è¦æ¥ç experiment åæ¯ä¸­è¿æåªäºæäº¤å°æªè¢«åå¹¶å¥ master åæ¯ã ä½ å¯ä»¥ä½¿ç¨ master..experiment æ¥è®© git æ¾ç¤ºè¿äºæäº¤ãä¹å°±æ¯âå¨ experiment åæ¯ä¸­èä¸å¨ master åæ¯ä¸­çæäº¤âã ä¸ºäºä½¿ä¾å­ç®åæäºï¼æä½¿ç¨äºç¤ºæå¾ä¸­æäº¤å¯¹è±¡çå­æ¯æ¥ä»£æ¿çå®æ¥å¿çè¾åºï¼æä»¥ä¼æ¾ç¤ºï¼\n\n$ git log master..experiment\nd\nc\n\n\n1\n2\n3\n\n\nåè¿æ¥ï¼å¦æä½ æ³æ¥çå¨ master åæ¯ä¸­èä¸å¨ experiment åæ¯ä¸­çæäº¤ï¼ä½ åªè¦äº¤æ¢åæ¯åå³å¯ã experiment..master ä¼æ¾ç¤ºå¨ master åæ¯ä¸­èä¸å¨ experiment åæ¯ä¸­çæäº¤ï¼\n\n$ git log experiment..master\nf\ne\n\n\n1\n2\n3\n\n\n# æ¥çå³å°æ¨éå°è¿ç«¯çåå®¹\n\nè¿å¯ä»¥è®©ä½ ä¿æ experiment åæ¯è·éææ°çè¿åº¦ä»¥åæ¥çä½ å³å°åå¹¶çåå®¹ã å¦ä¸ä¸ªå¸¸ç¨çåºæ¯æ¯æ¥çä½ å³å°æ¨éå°è¿ç«¯çåå®¹ï¼\n\n$ git log origin/master..head\n\n\n1\n\n\nè¿ä¸ªå½ä»¤ä¼è¾åºå¨ä½ å½ååæ¯ä¸­èä¸å¨è¿ç¨ origin ä¸­çæäº¤ã å¦æä½ æ§è¡ git push å¹¶ä¸ä½ çå½ååæ¯æ­£å¨è·è¸ª origin/masterï¼ç± git log origin/master..head æè¾åºçæäº¤å°±æ¯ä¼è¢«ä¼ è¾å°è¿ç«¯æå¡å¨çæäº¤ãå¦æä½ çç©ºäºå¶ä¸­çä¸è¾¹ï¼ git ä¼é»è®¤ä¸º headã ä¾å¦ï¼ git log origin/master.. å°ä¼è¾åºä¸ä¹åä¾å­ç¸åçç»æ ââ git ä½¿ç¨ head æ¥ä»£æ¿çç©ºçä¸è¾¹ã\n\n\n# å¤ç¹\n\nåç¹è¯­æ³å¾å¥½ç¨ï¼ä½ææ¶åä½ å¯è½éè¦ä¸¤ä¸ªä»¥ä¸çåæ¯æè½ç¡®å®ä½ æéè¦çä¿®è®¢ï¼ æ¯å¦æ¥çåªäºæäº¤æ¯è¢«åå«å¨æäºåæ¯ä¸­çä¸ä¸ªï¼ä½æ¯ä¸å¨ä½ å½åçåæ¯ä¸ã git åè®¸ä½ å¨ä»»æå¼ç¨åå ä¸ ^ å­ç¬¦æè --not æ¥ææä½ ä¸å¸ææäº¤è¢«åå«å¶ä¸­çåæ¯ã å æ­¤ä¸åä¸ä¸ªå½ä»¤æ¯ç­ä»·çï¼\n\n$ git log refa..refb\n$ git log ^refa refb\n$ git log refb --not refa\n\n\n1\n2\n3\n\n\nè¿ä¸ªè¯­æ³å¾å¥½ç¨ï¼å ä¸ºä½ å¯ä»¥å¨æ¥è¯¢ä¸­æå®è¶è¿ä¸¤ä¸ªçå¼ç¨ï¼è¿æ¯åç¹è¯­æ³æ æ³å®ç°çã æ¯å¦ï¼ä½ æ³æ¥çææè¢« refa æ refb åå«çä½æ¯ä¸è¢« refc åå«çæäº¤ï¼ä½ å¯ä»¥ä½¿ç¨ä»¥ä¸ä»»æä¸ä¸ªå½ä»¤ï¼\n\n$ git log refa refb ^refc\n$ git log refa refb --not refc\n\n\n1\n2\n\n\nè¿å°±ææäºä¸ä¸ªååå¼ºå¤§çä¿®è®¢æ¥è¯¢ç³»ç»ï¼ä½ å¯ä»¥éè¿å®æ¥æ¥çä½ çåæ¯éåå«äºåªäºä¸è¥¿ã\n\n\n# ä¸ç¹\n\næåä¸ç§ä¸»è¦çåºé´éæ©è¯­æ³æ¯ä¸ç¹ï¼è¿ä¸ªè¯­æ³å¯ä»¥éæ©åºè¢«ä¸¤ä¸ªå¼ç¨ ä¹ä¸ åå«ä½åä¸è¢«ä¸¤èåæ¶åå«çæäº¤ã åççä¹ååç¹ä¾å­ä¸­çæäº¤åå²ã å¦æä½ æ³ç master æè experiment ä¸­åå«çä½ä¸æ¯ä¸¤èå±æçæäº¤ï¼ä½ å¯ä»¥æ§è¡ï¼\n\n$ git log master...experiment\nf\ne\nd\nc\n\n\n1\n2\n3\n4\n5\n\n\nè¿åéå¸¸ log ææ¥ææåºçè¾åºä¸æ ·ï¼ä»ä»ç»åºäº4ä¸ªæäº¤çä¿¡æ¯ã\n\nè¿ç§æå½¢ä¸ï¼log å½ä»¤çä¸ä¸ªå¸¸ç¨åæ°æ¯ --left-rightï¼å®ä¼æ¾ç¤ºæ¯ä¸ªæäº¤å°åºå¤äºåªä¸ä¾§çåæ¯ã è¿ä¼è®©è¾åºæ°æ®æ´å æ¸æ°ã\n\n$ git log --left-right master...experiment\n< f\n< e\n> d\n> c\n\n\n1\n2\n3\n4\n5\n\n\næäºè¿äºå·¥å·ï¼ä½ å°±å¯ä»¥ååæ¹ä¾¿å°æ¥çä½  git ä»åºä¸­çæäº¤ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Gitåæ¯-ååº",frontmatter:{title:"Gitåæ¯-ååº",date:"2020-11-18T17:43:57.000Z",permalink:"/pages/3a3247/",categories:["ãGitãå­¦ä¹ ç¬è®°"],tags:["Git"]},regularPath:"/%E3%80%8AGit%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20.%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/70.Git%E5%88%86%E6%94%AF-%E5%8F%98%E5%9F%BA.html",relativePath:"ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/70.Gitåæ¯-ååº.md",key:"v-546fd54a",path:"/pages/3a3247/",headers:[{level:2,title:"ååºçåºæ¬æä½",slug:"ååºçåºæ¬æä½",normalizedTitle:"ååºçåºæ¬æä½",charIndex:117},{level:3,title:"æ¦å¿µ",slug:"æ¦å¿µ",normalizedTitle:"æ¦å¿µ",charIndex:312},{level:3,title:"åç",slug:"åç",normalizedTitle:"åç",charIndex:728},{level:3,title:"æ­¥éª¤",slug:"æ­¥éª¤",normalizedTitle:"æ­¥éª¤",charIndex:1138},{level:3,title:"ä¼ç¹",slug:"ä¼ç¹",normalizedTitle:"ä¼ç¹",charIndex:1701},{level:2,title:"æ´æè¶£çååºä¾å­",slug:"æ´æè¶£çååºä¾å­",normalizedTitle:"æ´æè¶£çååºä¾å­",charIndex:1727},{level:3,title:"æ´æè¶£çååºä¾å­",slug:"æ´æè¶£çååºä¾å­-2",normalizedTitle:"æ´æè¶£çååºä¾å­",charIndex:1727},{level:3,title:"--ontoéé¡¹",slug:"ontoéé¡¹",normalizedTitle:"--ontoéé¡¹",charIndex:2530},{level:3,title:"çå»ååæ¢å°æºåæ¯çæ­¥éª¤",slug:"çå»ååæ¢å°æºåæ¯çæ­¥éª¤",normalizedTitle:"çå»ååæ¢å°æºåæ¯çæ­¥éª¤",charIndex:2762},{level:2,title:"ååºçé£é©",slug:"ååºçé£é©",normalizedTitle:"ååºçé£é©",charIndex:3415},{level:3,title:"éç§çå¾",slug:"éç§çå¾",normalizedTitle:"éç§çå¾",charIndex:3425},{level:3,title:"ååºçå®è´¨",slug:"ååºçå®è´¨",normalizedTitle:"ååºçå®è´¨",charIndex:3615},{level:2,title:"ç¨ååºè§£å³ååº",slug:"ç¨ååºè§£å³ååº",normalizedTitle:"ç¨ååºè§£å³ååº",charIndex:4412},{level:2,title:"ååº vs. åå¹¶",slug:"ååº-vs-åå¹¶",normalizedTitle:"ååº vs. åå¹¶",charIndex:5550}],headersStr:"ååºçåºæ¬æä½ æ¦å¿µ åç æ­¥éª¤ ä¼ç¹ æ´æè¶£çååºä¾å­ æ´æè¶£çååºä¾å­ --ontoéé¡¹ çå»ååæ¢å°æºåæ¯çæ­¥éª¤ ååºçé£é© éç§çå¾ ååºçå®è´¨ ç¨ååºè§£å³ååº ååº vs. åå¹¶",content:"# Gitåæ¯-ååº\n\nå¨ Git ä¸­æ´åæ¥èªä¸ååæ¯çä¿®æ¹ä¸»è¦æä¸¤ç§æ¹æ³ï¼merge ä»¥å rebaseã å¨æ¬èä¸­æä»¬å°å­¦ä¹ ä»ä¹æ¯âååºâï¼ææ ·ä½¿ç¨âååºâï¼å¹¶å°å±ç¤ºè¯¥æä½çæè³ä¹å¤ï¼ä»¥åæåºå¨ä½ç§æåµä¸ä½ åºé¿åä½¿ç¨å®ã\n\n\n# ååºçåºæ¬æä½\n\nè¯·åé¡¾ä¹åå¨ åæ¯çåå¹¶ ä¸­çä¸ä¸ªä¾å­ï¼ä½ ä¼çå°å¼åä»»å¡ååå°ä¸¤ä¸ªä¸ååæ¯ï¼ååèªæäº¤äºæ´æ°ã\n\n\n\nå¾0. ååçæäº¤åå² â²\n\nä¹åä»ç»è¿ï¼æ´ååæ¯æå®¹æçæ¹æ³æ¯ merge å½ä»¤ã å®ä¼æä¸¤ä¸ªåæ¯çææ°å¿«ç§ï¼C3 å C4ï¼ä»¥åäºèæè¿çå±åç¥åï¼C2ï¼è¿è¡ä¸æ¹åå¹¶ï¼åå¹¶çç»ææ¯çæä¸ä¸ªæ°çå¿«ç§ï¼å¹¶æäº¤ï¼ã\n\n\n\nå¾1. éè¿åå¹¶æä½æ¥æ´åååçåå² â²\n\n\n# æ¦å¿µ\n\nååºå°±æ¯ï¼å°æä¸åæ¯ä¸çææä¿®æ¹å¤å¶å°å¦ä¸åæ¯ä¸\n\né¤äºmergeï¼è¿æä¸ç§æ¹æ³ï¼ä½ å¯ä»¥æåå¨ C4 ä¸­å¼å¥çè¡¥ä¸åä¿®æ¹ï¼ç¶åå¨ C3 çåºç¡ä¸åºç¨ä¸æ¬¡ã å¨ Git ä¸­ï¼è¿ç§æä½å°±å«å ååºï¼rebaseï¼ã ä½ å¯ä»¥ä½¿ç¨ rebase å½ä»¤å°æäº¤å°æä¸åæ¯ä¸çææä¿®æ¹é½ç§»å°å¦ä¸åæ¯ä¸ï¼å°±å¥½åâéæ°æ­æ¾âä¸æ ·ã\n\nå¨è¿ä¸ªä¾å­ä¸­ï¼ä½ å¯ä»¥æ£åº experiment åæ¯ï¼ç¶åå°å®ååºå° master åæ¯ä¸ï¼\n\n$ git checkout experiment\n$ git rebase master # å°experimentä¸çä¿®æ¹ååºå°masteråæ¯ä¸ï¼å°experimentçæäº¤ç§»å¨å°masterä¸ãï¼\nFirst, rewinding head to replay your work on top of it...\nApplying: added staged command\n\n\n1\n2\n3\n4\n\n\nå®çåçæ¯é¦åæ¾å°è¿ä¸¤ä¸ªåæ¯ï¼å³å½ååæ¯ experimentãååºæä½çç®æ åºåºåæ¯ masterï¼ çæè¿å±åç¥å C2ï¼ç¶åå¯¹æ¯å½ååæ¯ç¸å¯¹äºè¯¥ç¥åçåæ¬¡æäº¤ï¼æåç¸åºçä¿®æ¹å¹¶å­ä¸ºä¸´æ¶æä»¶ï¼ ç¶åå°å½ååæ¯æåç®æ åºåº C3, æåä»¥æ­¤å°ä¹åå¦å­ä¸ºä¸´æ¶æä»¶çä¿®æ¹ä¾åºåºç¨ã ï¼è¯æ³¨ï¼åæäº commit idï¼ä»¥ä¾¿çè§£ï¼ä¸åï¼\n\n\n# åç\n\n 1. æ¾å°å½ååæ¯åç®æ åæ¯çæè¿å±åç¥å\n\n 2. å¯¹æ¯å½ååæ¯ç¸å¯¹äºè¯¥å±åç¥åçåæ¬¡æäº¤\n\n 3. æåç¸åºçä¿®æ¹å¹¶å­ä¸ºä¸´æ¶æä»¶\n\n 4. å°å½ååæ¯æåç®æ åæ¯\n\n 5. å°ä¹åä¸´æ¶æä»¶çä¿®æ¹ä¾åºåºç¨\n\n\n\nå¾2.å° C4 ä¸­çä¿®æ¹ååºå° C3 ä¸ â²\n\nç°å¨åå° master åæ¯ï¼è¿è¡ä¸æ¬¡å¿«è¿åå¹¶ã\n\n$ git checkout master\n$ git merge experiment\n\n\n1\n2\n\n\n\n\nå¾3.master åæ¯çå¿«è¿åå¹¶ â²\n\n\n# æ­¥éª¤\n\nåæ£åºæºåæ¯ï¼å°æºåæ¯çä¿®æ¹ååºå°ç®æ åæ¯ãååç®æ åæ¯ï¼è¿è¡ä¸æ¬¡å¿«è¿åå¹¶\n\n# ç¤ºæï¼\ngit checkout <æºåæ¯>\ngit (æºåæ¯çä¿®æ¹)rebase(å°) <ç®æ åæ¯>\ngit checkout <ç®æ åæ¯>\ngit merge <æºåæ¯>\n\n\n1\n2\n3\n4\n5\n\n\næ­¤æ¶ï¼C4' æåçå¿«ç§å°±å the merge example ä¸­ C5 æåçå¿«ç§ä¸æ¨¡ä¸æ ·äºã è¿ä¸¤ç§æ´åæ¹æ³çæç»ç»ææ²¡æä»»ä½åºå«ï¼ä½æ¯ ååºä½¿å¾æäº¤åå²æ´å æ´æ´ã ä½ å¨æ¥çä¸ä¸ªç»è¿ååºçåæ¯çåå²è®°å½æ¶ä¼åç°ï¼å°½ç®¡å®éçå¼åå·¥ä½æ¯å¹¶è¡çï¼ ä½å®ä»¬çä¸å»å°±åæ¯ä¸²è¡çä¸æ ·ï¼æäº¤åå²æ¯ä¸æ¡ç´çº¿æ²¡æååã\n\nä¸è¬æä»¬è¿æ ·åçç®çæ¯ä¸ºäºç¡®ä¿å¨åè¿ç¨åæ¯æ¨éæ¶è½ä¿ææäº¤åå²çæ´æ´ââä¾å¦åæä¸ªå¶ä»äººç»´æ¤çé¡¹ç®è´¡ç®ä»£ç æ¶ã å¨è¿ç§æåµä¸ï¼ä½ é¦åå¨èªå·±çåæ¯éè¿è¡å¼åï¼å½å¼åå®ææ¶ä½ éè¦åå°ä½ çä»£ç ååºå° origin/master ä¸ï¼ç¶åååä¸»é¡¹ç®æäº¤ä¿®æ¹ã è¿æ ·çè¯ï¼è¯¥é¡¹ç®çç»´æ¤èå°±ä¸åéè¦è¿è¡æ´åå·¥ä½ï¼åªéè¦å¿«è¿åå¹¶ä¾¿å¯ã\n\nè¯·æ³¨æï¼æ è®ºæ¯éè¿ååºï¼è¿æ¯éè¿ä¸æ¹åå¹¶ï¼æ´åçæç»ç»æææåçå¿«ç§å§ç»æ¯ä¸æ ·çï¼åªä¸è¿æäº¤åå²ä¸åç½¢äºã ååºæ¯å°ä¸ç³»åæäº¤æç§åææ¬¡åºä¾æ¬¡åºç¨å°å¦ä¸åæ¯ä¸ï¼èåå¹¶æ¯ææç»ç»æåå¨ä¸èµ·ã\n\n\n# ä¼ç¹\n\nååºçä¼ç¹ï¼ ä½¿æäº¤è®°å½æ´å æ´æ´ã\n\n\n# æ´æè¶£çååºä¾å­\n\nå¨å¯¹ä¸¤ä¸ªåæ¯è¿è¡ååºæ¶ï¼æçæçâéæ¾âå¹¶ä¸ä¸å®è¦å¨ç®æ åæ¯ä¸åºç¨ï¼ä½ ä¹å¯ä»¥æå®å¦å¤çä¸ä¸ªåæ¯è¿è¡åºç¨ã å°±å ä»ä¸ä¸ªä¸»é¢åæ¯éåååºä¸ä¸ªä¸»é¢åæ¯çæäº¤åå² ä¸­çä¾å­é£æ ·ã ä½ åå»ºäºä¸ä¸ªä¸»é¢åæ¯ serverï¼ä¸ºæå¡ç«¯æ·»å äºä¸äºåè½ï¼æäº¤äº C3 å C4ã ç¶åä» C3 ä¸åå»ºäºä¸»é¢åæ¯ clientï¼ä¸ºå®¢æ·ç«¯æ·»å äºä¸äºåè½ï¼æäº¤äº C8 å C9ã æåï¼ä½ åå° server åæ¯ï¼åæäº¤äº C10ã\n\n\n# æ´æè¶£çååºä¾å­\n\nå¨å¯¹ä¸¤ä¸ªåæ¯è¿è¡ååºæ¶ï¼æçæçâéæ¾âå¹¶ä¸ä¸å®è¦å¨ç®æ åæ¯ä¸åºç¨ï¼ä½ ä¹å¯ä»¥æå®å¦å¤çä¸ä¸ªåæ¯è¿è¡åºç¨ã å°±å ä»ä¸ä¸ªä¸»é¢åæ¯éåååºä¸ä¸ªä¸»é¢åæ¯çæäº¤åå² ä¸­çä¾å­é£æ ·ã ä½ åå»ºäºä¸ä¸ªä¸»é¢åæ¯ serverï¼ä¸ºæå¡ç«¯æ·»å äºä¸äºåè½ï¼æäº¤äº C3 å C4ã ç¶åä» C3 ä¸åå»ºäºä¸»é¢åæ¯ clientï¼ä¸ºå®¢æ·ç«¯æ·»å äºä¸äºåè½ï¼æäº¤äº C8 å C9ã æåï¼ä½ åå° server åæ¯ï¼åæäº¤äº C10ã\n\n\n\nå¾4.ä»ä¸ä¸ªä¸»é¢åæ¯éåååºä¸ä¸ªä¸»é¢åæ¯çæäº¤åå² â²\n\nåè®¾ä½ å¸æå° client ä¸­çä¿®æ¹åå¹¶å°ä¸»åæ¯å¹¶åå¸ï¼ä½ææ¶å¹¶ä¸æ³åå¹¶ server ä¸­çä¿®æ¹ï¼ å ä¸ºå®ä»¬è¿éè¦ç»è¿æ´å¨é¢çæµè¯ãè¿æ¶ï¼ä½ å°±å¯ä»¥ä½¿ç¨ git rebase å½ä»¤ç --onto éé¡¹ï¼ éä¸­å¨ client åæ¯éä½ä¸å¨ server åæ¯éçä¿®æ¹ï¼å³ C8 å C9ï¼ï¼å°å®ä»¬å¨ master åæ¯ä¸éæ¾ï¼\n\n$ git rebase --onto master server client\n\n\n1\n\n\nä»¥ä¸å½ä»¤çæææ¯ï¼âååº client åæ¯ï¼æ¾åºå®ä» server åæ¯åæ­§ä¹åçè¡¥ä¸ï¼ ç¶åæè¿äºè¡¥ä¸å¨ master åæ¯ä¸éæ¾ä¸éï¼è®© client çèµ·æ¥åç´æ¥åºäº master ä¿®æ¹ä¸æ ·âãè¿çè§£èµ·æ¥æä¸ç¹å¤æï¼ä¸è¿ææéå¸¸é·ã\n\n\n# --ontoéé¡¹\n\néä¸­Cåæ¯ä¸­çä½ä¸å¨Båæ¯éçä¿®æ¹ï¼åºç¨å°Aåæ¯ã\n\n\n\nå¾5.æªåä¸»é¢åæ¯ä¸çå¦ä¸ä¸ªä¸»é¢åæ¯ï¼ç¶åååºå°å¶ä»åæ¯ â²\n\nç°å¨å¯ä»¥å¿«è¿åå¹¶ master åæ¯äºãï¼å¦å¾ å¿«è¿åå¹¶ master åæ¯ï¼ä½¿ä¹åå«æ¥èª client åæ¯çä¿®æ¹ï¼ï¼\n\n$ git checkout master\n$ git merge client\n\n\n1\n2\n\n\n\n\nå¾6.å¿«è¿åå¹¶ `master` åæ¯ï¼ä½¿ä¹åå«æ¥èª `client` åæ¯çä¿®æ¹ â²\n\n\n# çå»ååæ¢å°æºåæ¯çæ­¥éª¤\n\ngit rebase <ç®æ (å½å)åæ¯> <æºåæ¯> # å°æºåæ¯ååºå°ç®æ åæ¯ãæ§è¡æ­¤å½ä»¤åä¼èªå¨åæ¢å°æºåæ¯\ngit checkout <ç®æ åæ¯>\ngit merge <æºåæ¯>\n\n\n1\n2\n3\n\n\næ³¨æï¼ä½¿ç¨è¿ä¸ªæ¹æ³è¦ç¡®ä¿æºåæ¯ä¸çä»£ç æ¯ææ°çã\n\næ¥ä¸æ¥ä½ å³å®å° server åæ¯ä¸­çä¿®æ¹ä¹æ´åè¿æ¥ã ä½¿ç¨ git rebase <basebranch> <topicbranch> å½ä»¤å¯ä»¥ç´æ¥å°ä¸»é¢åæ¯ ï¼å³æ¬ä¾ä¸­ç serverï¼ååºå°ç®æ åæ¯ï¼å³ masterï¼ä¸ã è¿æ ·åè½çå»ä½ ååæ¢å° server åæ¯ï¼åå¯¹å¶æ§è¡ååºå½ä»¤çå¤ä¸ªæ­¥éª¤ã\n\n$ git rebase master server\n\n\n1\n\n\nå¦å¾ å° server ä¸­çä¿®æ¹ååºå° master ä¸ æç¤ºï¼server ä¸­çä»£ç è¢«âç»­âå°äº master åé¢ã\n\n\n\nå¾7.å° `server` ä¸­çä¿®æ¹ååºå° `master` ä¸ â²\n\nç¶åå°±å¯ä»¥å¿«è¿åå¹¶ä¸»åæ¯ master äºï¼\n\n$ git checkout master\n$ git merge server\n\n\n1\n2\n\n\nè³æ­¤ï¼client å server åæ¯ä¸­çä¿®æ¹é½å·²ç»æ´åå°ä¸»åæ¯éäºï¼ ä½ å¯ä»¥å é¤è¿ä¸¤ä¸ªåæ¯ï¼æç»æäº¤åå²ä¼åæå¾ æç»çæäº¤åå² ä¸­çæ ·å­ï¼\n\n$ git branch -d client\n$ git branch -d server\n\n\n1\n2\n\n\n\n\nå¾8. æç»çæäº¤åå² â²\n\n\n# ååºçé£é©\n\n\n# éç§çå¾\n\nåï¼å¥å¦çååºä¹å¹¶éå®ç¾æ ç¼ºï¼è¦ç¨å®å¾éµå®ä¸æ¡ååï¼\n\nå¦ææäº¤å­å¨äºä½ çä»åºä¹å¤ï¼èå«äººå¯è½åºäºè¿äºæäº¤è¿è¡å¼åï¼é£ä¹ä¸è¦æ§è¡ååºã\n\nå¦æä½ éµå¾ªè¿æ¡éç§çå¾ï¼å°±ä¸ä¼åºå·®éã å¦åï¼äººæ°ç¾¤ä¼ä¼ä»æ¨ä½ ï¼ä½ çæååå®¶äººä¹ä¼å²ç¬ä½ ï¼å¾å¼ä½ ã\n\næç¤º\n\nä¾å¦ï¼å ä¸ªäººåæ¶å¨ä¸ä¸ªä¸»é¢åæ¯ä¸è¿è¡å¼ååæäº¤æ¶ï¼ä½ ä¸è¦ä¸­éæ§è¡ååºï¼åªæå¨å¤§å®¶é½å®æå·¥ä½ä¹åæå¯ä»¥æ§è¡ååºã\n\n\n# ååºçå®è´¨\n\nååºæä½çå®è´¨æ¯ä¸¢å¼ä¸äºç°æçæäº¤ï¼ç¶åç¸åºå°æ°å»ºä¸äºåå®¹ä¸æ ·ä½å®éä¸ä¸åçæäº¤ã å¦æä½ å·²ç»å°æäº¤æ¨éè³æä¸ªä»åºï¼èå¶ä»äººä¹å·²ç»ä»è¯¥ä»åºæåæäº¤å¹¶è¿è¡äºåç»­å·¥ä½ï¼æ­¤æ¶ï¼å¦æä½ ç¨ git rebase å½ä»¤éæ°æ´çäºæäº¤å¹¶åæ¬¡æ¨éï¼ä½ çåä¼´å æ­¤å°ä¸å¾ä¸åæ¬¡å°ä»ä»¬æå¤´çå·¥ä½ä¸ä½ çæäº¤è¿è¡æ´åï¼å¦ææ¥ä¸æ¥ä½ è¿è¦æåå¹¶æ´åä»ä»¬ä¿®æ¹è¿çæäº¤ï¼äºæå°±ä¼åå¾ä¸å¢ç³ã\n\nè®©æä»¬æ¥çä¸ä¸ªå¨å¬å¼çä»åºä¸æ§è¡ååºæä½æå¸¦æ¥çé®é¢ã åè®¾ä½ ä»ä¸ä¸ªä¸­å¤®æå¡å¨åéç¶åå¨å®çåºç¡ä¸è¿è¡äºä¸äºå¼åã ä½ çæäº¤åå²å¦å¾æç¤ºï¼\n\n\n\nå¾9. åéä¸ä¸ªä»åºï¼ç¶åå¨å®çåºç¡ä¸è¿è¡äºä¸äºå¼å â²\n\nç¶åï¼æäººååä¸­å¤®æå¡å¨æäº¤äºä¸äºä¿®æ¹ï¼å¶ä¸­è¿åæ¬ä¸æ¬¡åå¹¶ã ä½ æåäºè¿äºå¨è¿ç¨åæ¯ä¸çä¿®æ¹ï¼å¹¶å°å¶åå¹¶å°ä½ æ¬å°çå¼ååæ¯ï¼ç¶åä½ çæäº¤åå²å°±ä¼åæè¿æ ·ï¼\n\n\n\nå¾10. æåå«äººçæäº¤ï¼åå¹¶å°èªå·±çå¼ååæ¯ â²\n\næ¥ä¸æ¥ï¼è¿ä¸ªäººåå³å®æåå¹¶æä½åæ»ï¼æ¹ç¨ååºï¼ç»§èåç¨ git push --force å½ä»¤è¦çäºæå¡å¨ä¸çæäº¤åå²ã ä¹åä½ ä»æå¡å¨æåæ´æ°ï¼ä¼åç°å¤åºæ¥ä¸äºæ°çæäº¤ã\n\n\n\nå¾11. æäººæ¨éäºç»è¿ååºçæäº¤ï¼å¹¶ä¸¢å¼äºä½ çæ¬å°å¼åæåºäºçä¸äºæäº¤ â²\n\nç»æå°±æ¯ä½ ä»¬ä¸¤äººçå¤å¢é½ååå°´å°¬ã å¦æä½ æ§è¡ git pull å½ä»¤ï¼ä½ å°åå¹¶æ¥èªä¸¤æ¡æäº¤åå²çåå®¹ï¼çæä¸ä¸ªæ°çåå¹¶æäº¤ï¼æç»ä»åºä¼å¦å¾æç¤ºï¼\n\n\n\nå¾12. ä½ å°ç¸åçåå®¹ååå¹¶äºä¸æ¬¡ï¼çæäºä¸ä¸ªæ°çæäº¤ â²\n\næ­¤æ¶å¦æä½ æ§è¡ git log å½ä»¤ï¼ä½ ä¼åç°æä¸¤ä¸ªæäº¤çä½èãæ¥æãæ¥å¿å±ç¶æ¯ä¸æ ·çï¼è¿ä¼ä»¤äººæå°æ··ä¹±ã æ­¤å¤ï¼å¦æä½ å°è¿ä¸å åæ¨éå°æå¡å¨ä¸ï¼ä½ å®éä¸æ¯å°é£äºå·²ç»è¢«ååºæå¼çæäº¤åæ¾äºåæ¥ï¼è¿ä¼ä»¤äººæå°æ´å æ··ä¹±ã å¾ææ¾å¯¹æ¹å¹¶ä¸æ³å¨æäº¤åå²ä¸­çå° C4 å C6ï¼å ä¸ºä¹åå°±æ¯ä»æè¿ä¸¤ä¸ªæäº¤éè¿ååºä¸¢å¼çã\n\n\n# ç¨ååºè§£å³ååº\n\nå¦æä½  çç é­éäºç±»ä¼¼çå¤å¢ï¼Git è¿æä¸äºé«çº§é­æ³å¯ä»¥å¸®å°ä½ ã å¦æå¢éä¸­çæäººå¼ºå¶æ¨éå¹¶è¦çäºä¸äºä½ æåºäºçæäº¤ï¼ä½ éè¦åçå°±æ¯æ£æ¥ä½ åäºåªäºä¿®æ¹ï¼ä»¥åä»ä»¬è¦çäºåªäºä¿®æ¹ã\n\nå®éä¸ï¼Git é¤äºå¯¹æ´ä¸ªæäº¤è®¡ç® SHA-1 æ ¡éªåä»¥å¤ï¼ä¹å¯¹æ¬æ¬¡æäº¤æå¼å¥çä¿®æ¹è®¡ç®äºæ ¡éªåââå³ âpatch-idâã\n\nå¦æä½ æåè¢«è¦çè¿çæ´æ°å¹¶å°ä½ æå¤´çå·¥ä½åºäºæ­¤è¿è¡ååºçè¯ï¼ä¸è¬æåµä¸ Git é½è½æååè¾¨åºåªäºæ¯ä½ çä¿®æ¹ï¼å¹¶æå®ä»¬åºç¨å°æ°åæ¯ä¸ã\n\nä¸¾ä¸ªä¾å­ï¼å¦æéå°åé¢æå°ç æäººæ¨éäºç»è¿ååºçæäº¤ï¼å¹¶ä¸¢å¼äºä½ çæ¬å°å¼åæåºäºçä¸äºæäº¤ é£ç§æå¢ï¼å¦ææä»¬ä¸æ¯æ§è¡åå¹¶ï¼èæ¯æ§è¡ git rebase teamone/master, Git å°ä¼ï¼\n\n * æ£æ¥åªäºæäº¤æ¯æä»¬çåæ¯ä¸ç¬æçï¼C2ï¼C3ï¼C4ï¼C6ï¼C7ï¼\n * æ£æ¥å¶ä¸­åªäºæäº¤ä¸æ¯åå¹¶æä½çç»æï¼C2ï¼C3ï¼C4ï¼\n * æ£æ¥åªäºæäº¤å¨å¯¹æ¹è¦çæ´æ°æ¶å¹¶æ²¡æè¢«çº³å¥ç®æ åæ¯ï¼åªæ C2 å C3ï¼å ä¸º C4 å¶å®å°±æ¯ C4'ï¼\n * ææ¥å°çè¿äºæäº¤åºç¨å¨ teamone/master ä¸é¢\n\nä»èæä»¬å°å¾å°ä¸ ä½ å°ç¸åçåå®¹ååå¹¶äºä¸æ¬¡ï¼çæäºä¸ä¸ªæ°çæäº¤ ä¸­ä¸åçç»æï¼å¦å¾ å¨ä¸ä¸ªè¢«ååºç¶åå¼ºå¶æ¨éçåæ¯ä¸åæ¬¡æ§è¡ååº æç¤ºã\n\n\n\nå¾13. å¨ä¸ä¸ªè¢«ååºç¶åå¼ºå¶æ¨éçåæ¯ä¸åæ¬¡æ§è¡ååº â²\n\nè¦æ³ä¸è¿°æ¹æ¡ææï¼è¿éè¦å¯¹æ¹å¨ååºæ¶ç¡®ä¿ C4' å C4 æ¯å ä¹ä¸æ ·çã å¦åååºæä½å°æ æ³è¯å«ï¼å¹¶æ°å»ºå¦ä¸ä¸ªç±»ä¼¼ C4 çè¡¥ä¸ï¼èè¿ä¸ªè¡¥ä¸å¾å¯è½æ æ³æ´æ´çæ´åå¥åå²ï¼å ä¸ºè¡¥ä¸ä¸­çä¿®æ¹å·²ç»å­å¨äºæä¸ªå°æ¹äºï¼ã\n\nå¨æ¬ä¾ä¸­å¦ä¸ç§ç®åçæ¹æ³æ¯ä½¿ç¨ git pull --rebase å½ä»¤èä¸æ¯ç´æ¥ git pullã åæèä½ å¯ä»¥èªå·±æå¨å®æè¿ä¸ªè¿ç¨ï¼å git fetchï¼å git rebase teamone/masterã\n\nå¦æä½ ä¹ æ¯ä½¿ç¨ git pull ï¼åæ¶åå¸æé»è®¤ä½¿ç¨éé¡¹ --rebaseï¼ä½ å¯ä»¥æ§è¡è¿æ¡è¯­å¥ git config --global pull.rebase true æ¥æ´æ¹ pull.rebase çé»è®¤éç½®ã\n\nå¦æä½ åªå¯¹ä¸ä¼ç¦»å¼ä½ çµèçæäº¤æ§è¡ååºï¼é£å°±ä¸ä¼æäºã å¦æä½ å¯¹å·²ç»æ¨éè¿çæäº¤æ§è¡ååºï¼ä½å«äººæ²¡æåºäºå®çæäº¤ï¼é£ä¹ä¹ä¸ä¼æäºã å¦æä½ å¯¹å·²ç»æ¨éè³å±ç¨ä»åºçæäº¤ä¸æ§è¡ååºå½ä»¤ï¼å¹¶å æ­¤ä¸¢å¤±äºä¸äºå«äººçå¼åæåºäºçæäº¤ï¼ é£ä½ å°±æå¤§éº»ç¦äºï¼ä½ çåäºä¹ä¼å æ­¤éè§ä½ ã\n\nå¦æä½ æä½ çåäºå¨æäºæå½¢ä¸å³æè¦è¿ä¹åï¼è¯·ä¸å®è¦éç¥æ¯ä¸ªäººæ§è¡ git pull --rebase å½ä»¤ï¼è¿æ ·å°½ç®¡ä¸è½é¿åä¼¤çï¼ä½è½ææç¼è§£ã\n\n\n# ååº vs. åå¹¶\n\nè³æ­¤ï¼ä½ å·²å¨å®æä¸­å­¦ä¹ äºååºååå¹¶çç¨æ³ï¼ä½ ä¸å®ä¼æ³é®ï¼å°åºåªç§æ¹å¼æ´å¥½ã å¨åç­è¿ä¸ªé®é¢ä¹åï¼è®©æä»¬éåä¸æ­¥ï¼æ³è®¨è®ºä¸ä¸æäº¤åå²å°åºæå³çä»ä¹ã\n\næä¸ç§è§ç¹è®¤ä¸ºï¼ä»åºçæäº¤åå²å³æ¯ è®°å½å®éåçè¿ä»ä¹ã å®æ¯éå¯¹åå²çææ¡£ï¼æ¬èº«å°±æä»·å¼ï¼ä¸è½ä¹±æ¹ã ä»è¿ä¸ªè§åº¦çæ¥ï¼æ¹åæäº¤åå²æ¯ä¸ç§äºµæ¸ï¼ä½ ä½¿ç¨ è°è¨ æ©çäºå®éåçè¿çäºæã å¦æç±åå¹¶äº§ççæäº¤åå²æ¯ä¸å¢ç³æä¹åï¼ æ¢ç¶äºå®å°±æ¯å¦æ­¤ï¼é£ä¹è¿äºçè¿¹å°±åºè¯¥è¢«ä¿çä¸æ¥ï¼è®©åäººè½å¤æ¥éã\n\nå¦ä¸ç§è§ç¹åæ­£å¥½ç¸åï¼ä»ä»¬è®¤ä¸ºæäº¤åå²æ¯ é¡¹ç®è¿ç¨ä¸­åççäºã æ²¡äººä¼åºçä¸æ¬ä¹¦çç¬¬ä¸çèç¨¿ï¼è½¯ä»¶ç»´æ¤æåä¹æ¯éè¦åå¤ä¿®è®¢æè½æ¹ä¾¿ä½¿ç¨ã æè¿ä¸è§ç¹çäººä¼ä½¿ç¨ rebase å filter-branch ç­å·¥å·æ¥ç¼åæäºï¼æä¹æ¹ä¾¿åæ¥çè¯»èå°±æä¹åã\n\nç°å¨ï¼è®©æä»¬åå°ä¹åçé®é¢ä¸æ¥ï¼å°åºåå¹¶è¿æ¯ååºå¥½ï¼å¸æä½ è½æç½ï¼è¿å¹¶æ²¡æä¸ä¸ªç®åçç­æ¡ã Git æ¯ä¸ä¸ªéå¸¸å¼ºå¤§çå·¥å·ï¼å®åè®¸ä½ å¯¹æäº¤åå²åè®¸å¤äºæï¼ä½æ¯ä¸ªå¢éãæ¯ä¸ªé¡¹ç®å¯¹æ­¤çéæ±å¹¶ä¸ç¸åã æ¢ç¶ä½ å·²ç»åå«å­¦ä¹ äºä¸¤èçç¨æ³ï¼ç¸ä¿¡ä½ è½å¤æ ¹æ®å®éæåµä½åºææºçéæ©ã\n\næ»çååæ¯ï¼åªå¯¹å°æªæ¨éæåäº«ç»å«äººçæ¬å°ä¿®æ¹æ§è¡ååºæä½æ¸çåå²ï¼ ä»ä¸å¯¹å·²æ¨éè³å«å¤çæäº¤æ§è¡ååºæä½ï¼è¿æ ·ï¼ä½ æè½äº«åå°ä¸¤ç§æ¹å¼å¸¦æ¥çä¾¿å©ã",normalizedContent:"# gitåæ¯-ååº\n\nå¨ git ä¸­æ´åæ¥èªä¸ååæ¯çä¿®æ¹ä¸»è¦æä¸¤ç§æ¹æ³ï¼merge ä»¥å rebaseã å¨æ¬èä¸­æä»¬å°å­¦ä¹ ä»ä¹æ¯âååºâï¼ææ ·ä½¿ç¨âååºâï¼å¹¶å°å±ç¤ºè¯¥æä½çæè³ä¹å¤ï¼ä»¥åæåºå¨ä½ç§æåµä¸ä½ åºé¿åä½¿ç¨å®ã\n\n\n# ååºçåºæ¬æä½\n\nè¯·åé¡¾ä¹åå¨ åæ¯çåå¹¶ ä¸­çä¸ä¸ªä¾å­ï¼ä½ ä¼çå°å¼åä»»å¡ååå°ä¸¤ä¸ªä¸ååæ¯ï¼ååèªæäº¤äºæ´æ°ã\n\n\n\nå¾0. ååçæäº¤åå² â²\n\nä¹åä»ç»è¿ï¼æ´ååæ¯æå®¹æçæ¹æ³æ¯ merge å½ä»¤ã å®ä¼æä¸¤ä¸ªåæ¯çææ°å¿«ç§ï¼c3 å c4ï¼ä»¥åäºèæè¿çå±åç¥åï¼c2ï¼è¿è¡ä¸æ¹åå¹¶ï¼åå¹¶çç»ææ¯çæä¸ä¸ªæ°çå¿«ç§ï¼å¹¶æäº¤ï¼ã\n\n\n\nå¾1. éè¿åå¹¶æä½æ¥æ´åååçåå² â²\n\n\n# æ¦å¿µ\n\nååºå°±æ¯ï¼å°æä¸åæ¯ä¸çææä¿®æ¹å¤å¶å°å¦ä¸åæ¯ä¸\n\né¤äºmergeï¼è¿æä¸ç§æ¹æ³ï¼ä½ å¯ä»¥æåå¨ c4 ä¸­å¼å¥çè¡¥ä¸åä¿®æ¹ï¼ç¶åå¨ c3 çåºç¡ä¸åºç¨ä¸æ¬¡ã å¨ git ä¸­ï¼è¿ç§æä½å°±å«å ååºï¼rebaseï¼ã ä½ å¯ä»¥ä½¿ç¨ rebase å½ä»¤å°æäº¤å°æä¸åæ¯ä¸çææä¿®æ¹é½ç§»å°å¦ä¸åæ¯ä¸ï¼å°±å¥½åâéæ°æ­æ¾âä¸æ ·ã\n\nå¨è¿ä¸ªä¾å­ä¸­ï¼ä½ å¯ä»¥æ£åº experiment åæ¯ï¼ç¶åå°å®ååºå° master åæ¯ä¸ï¼\n\n$ git checkout experiment\n$ git rebase master # å°experimentä¸çä¿®æ¹ååºå°masteråæ¯ä¸ï¼å°experimentçæäº¤ç§»å¨å°masterä¸ãï¼\nfirst, rewinding head to replay your work on top of it...\napplying: added staged command\n\n\n1\n2\n3\n4\n\n\nå®çåçæ¯é¦åæ¾å°è¿ä¸¤ä¸ªåæ¯ï¼å³å½ååæ¯ experimentãååºæä½çç®æ åºåºåæ¯ masterï¼ çæè¿å±åç¥å c2ï¼ç¶åå¯¹æ¯å½ååæ¯ç¸å¯¹äºè¯¥ç¥åçåæ¬¡æäº¤ï¼æåç¸åºçä¿®æ¹å¹¶å­ä¸ºä¸´æ¶æä»¶ï¼ ç¶åå°å½ååæ¯æåç®æ åºåº c3, æåä»¥æ­¤å°ä¹åå¦å­ä¸ºä¸´æ¶æä»¶çä¿®æ¹ä¾åºåºç¨ã ï¼è¯æ³¨ï¼åæäº commit idï¼ä»¥ä¾¿çè§£ï¼ä¸åï¼\n\n\n# åç\n\n 1. æ¾å°å½ååæ¯åç®æ åæ¯çæè¿å±åç¥å\n\n 2. å¯¹æ¯å½ååæ¯ç¸å¯¹äºè¯¥å±åç¥åçåæ¬¡æäº¤\n\n 3. æåç¸åºçä¿®æ¹å¹¶å­ä¸ºä¸´æ¶æä»¶\n\n 4. å°å½ååæ¯æåç®æ åæ¯\n\n 5. å°ä¹åä¸´æ¶æä»¶çä¿®æ¹ä¾åºåºç¨\n\n\n\nå¾2.å° c4 ä¸­çä¿®æ¹ååºå° c3 ä¸ â²\n\nç°å¨åå° master åæ¯ï¼è¿è¡ä¸æ¬¡å¿«è¿åå¹¶ã\n\n$ git checkout master\n$ git merge experiment\n\n\n1\n2\n\n\n\n\nå¾3.master åæ¯çå¿«è¿åå¹¶ â²\n\n\n# æ­¥éª¤\n\nåæ£åºæºåæ¯ï¼å°æºåæ¯çä¿®æ¹ååºå°ç®æ åæ¯ãååç®æ åæ¯ï¼è¿è¡ä¸æ¬¡å¿«è¿åå¹¶\n\n# ç¤ºæï¼\ngit checkout <æºåæ¯>\ngit (æºåæ¯çä¿®æ¹)rebase(å°) <ç®æ åæ¯>\ngit checkout <ç®æ åæ¯>\ngit merge <æºåæ¯>\n\n\n1\n2\n3\n4\n5\n\n\næ­¤æ¶ï¼c4' æåçå¿«ç§å°±å the merge example ä¸­ c5 æåçå¿«ç§ä¸æ¨¡ä¸æ ·äºã è¿ä¸¤ç§æ´åæ¹æ³çæç»ç»ææ²¡æä»»ä½åºå«ï¼ä½æ¯ ååºä½¿å¾æäº¤åå²æ´å æ´æ´ã ä½ å¨æ¥çä¸ä¸ªç»è¿ååºçåæ¯çåå²è®°å½æ¶ä¼åç°ï¼å°½ç®¡å®éçå¼åå·¥ä½æ¯å¹¶è¡çï¼ ä½å®ä»¬çä¸å»å°±åæ¯ä¸²è¡çä¸æ ·ï¼æäº¤åå²æ¯ä¸æ¡ç´çº¿æ²¡æååã\n\nä¸è¬æä»¬è¿æ ·åçç®çæ¯ä¸ºäºç¡®ä¿å¨åè¿ç¨åæ¯æ¨éæ¶è½ä¿ææäº¤åå²çæ´æ´ââä¾å¦åæä¸ªå¶ä»äººç»´æ¤çé¡¹ç®è´¡ç®ä»£ç æ¶ã å¨è¿ç§æåµä¸ï¼ä½ é¦åå¨èªå·±çåæ¯éè¿è¡å¼åï¼å½å¼åå®ææ¶ä½ éè¦åå°ä½ çä»£ç ååºå° origin/master ä¸ï¼ç¶åååä¸»é¡¹ç®æäº¤ä¿®æ¹ã è¿æ ·çè¯ï¼è¯¥é¡¹ç®çç»´æ¤èå°±ä¸åéè¦è¿è¡æ´åå·¥ä½ï¼åªéè¦å¿«è¿åå¹¶ä¾¿å¯ã\n\nè¯·æ³¨æï¼æ è®ºæ¯éè¿ååºï¼è¿æ¯éè¿ä¸æ¹åå¹¶ï¼æ´åçæç»ç»æææåçå¿«ç§å§ç»æ¯ä¸æ ·çï¼åªä¸è¿æäº¤åå²ä¸åç½¢äºã ååºæ¯å°ä¸ç³»åæäº¤æç§åææ¬¡åºä¾æ¬¡åºç¨å°å¦ä¸åæ¯ä¸ï¼èåå¹¶æ¯ææç»ç»æåå¨ä¸èµ·ã\n\n\n# ä¼ç¹\n\nååºçä¼ç¹ï¼ ä½¿æäº¤è®°å½æ´å æ´æ´ã\n\n\n# æ´æè¶£çååºä¾å­\n\nå¨å¯¹ä¸¤ä¸ªåæ¯è¿è¡ååºæ¶ï¼æçæçâéæ¾âå¹¶ä¸ä¸å®è¦å¨ç®æ åæ¯ä¸åºç¨ï¼ä½ ä¹å¯ä»¥æå®å¦å¤çä¸ä¸ªåæ¯è¿è¡åºç¨ã å°±å ä»ä¸ä¸ªä¸»é¢åæ¯éåååºä¸ä¸ªä¸»é¢åæ¯çæäº¤åå² ä¸­çä¾å­é£æ ·ã ä½ åå»ºäºä¸ä¸ªä¸»é¢åæ¯ serverï¼ä¸ºæå¡ç«¯æ·»å äºä¸äºåè½ï¼æäº¤äº c3 å c4ã ç¶åä» c3 ä¸åå»ºäºä¸»é¢åæ¯ clientï¼ä¸ºå®¢æ·ç«¯æ·»å äºä¸äºåè½ï¼æäº¤äº c8 å c9ã æåï¼ä½ åå° server åæ¯ï¼åæäº¤äº c10ã\n\n\n# æ´æè¶£çååºä¾å­\n\nå¨å¯¹ä¸¤ä¸ªåæ¯è¿è¡ååºæ¶ï¼æçæçâéæ¾âå¹¶ä¸ä¸å®è¦å¨ç®æ åæ¯ä¸åºç¨ï¼ä½ ä¹å¯ä»¥æå®å¦å¤çä¸ä¸ªåæ¯è¿è¡åºç¨ã å°±å ä»ä¸ä¸ªä¸»é¢åæ¯éåååºä¸ä¸ªä¸»é¢åæ¯çæäº¤åå² ä¸­çä¾å­é£æ ·ã ä½ åå»ºäºä¸ä¸ªä¸»é¢åæ¯ serverï¼ä¸ºæå¡ç«¯æ·»å äºä¸äºåè½ï¼æäº¤äº c3 å c4ã ç¶åä» c3 ä¸åå»ºäºä¸»é¢åæ¯ clientï¼ä¸ºå®¢æ·ç«¯æ·»å äºä¸äºåè½ï¼æäº¤äº c8 å c9ã æåï¼ä½ åå° server åæ¯ï¼åæäº¤äº c10ã\n\n\n\nå¾4.ä»ä¸ä¸ªä¸»é¢åæ¯éåååºä¸ä¸ªä¸»é¢åæ¯çæäº¤åå² â²\n\nåè®¾ä½ å¸æå° client ä¸­çä¿®æ¹åå¹¶å°ä¸»åæ¯å¹¶åå¸ï¼ä½ææ¶å¹¶ä¸æ³åå¹¶ server ä¸­çä¿®æ¹ï¼ å ä¸ºå®ä»¬è¿éè¦ç»è¿æ´å¨é¢çæµè¯ãè¿æ¶ï¼ä½ å°±å¯ä»¥ä½¿ç¨ git rebase å½ä»¤ç --onto éé¡¹ï¼ éä¸­å¨ client åæ¯éä½ä¸å¨ server åæ¯éçä¿®æ¹ï¼å³ c8 å c9ï¼ï¼å°å®ä»¬å¨ master åæ¯ä¸éæ¾ï¼\n\n$ git rebase --onto master server client\n\n\n1\n\n\nä»¥ä¸å½ä»¤çæææ¯ï¼âååº client åæ¯ï¼æ¾åºå®ä» server åæ¯åæ­§ä¹åçè¡¥ä¸ï¼ ç¶åæè¿äºè¡¥ä¸å¨ master åæ¯ä¸éæ¾ä¸éï¼è®© client çèµ·æ¥åç´æ¥åºäº master ä¿®æ¹ä¸æ ·âãè¿çè§£èµ·æ¥æä¸ç¹å¤æï¼ä¸è¿ææéå¸¸é·ã\n\n\n# --ontoéé¡¹\n\néä¸­cåæ¯ä¸­çä½ä¸å¨båæ¯éçä¿®æ¹ï¼åºç¨å°aåæ¯ã\n\n\n\nå¾5.æªåä¸»é¢åæ¯ä¸çå¦ä¸ä¸ªä¸»é¢åæ¯ï¼ç¶åååºå°å¶ä»åæ¯ â²\n\nç°å¨å¯ä»¥å¿«è¿åå¹¶ master åæ¯äºãï¼å¦å¾ å¿«è¿åå¹¶ master åæ¯ï¼ä½¿ä¹åå«æ¥èª client åæ¯çä¿®æ¹ï¼ï¼\n\n$ git checkout master\n$ git merge client\n\n\n1\n2\n\n\n\n\nå¾6.å¿«è¿åå¹¶ `master` åæ¯ï¼ä½¿ä¹åå«æ¥èª `client` åæ¯çä¿®æ¹ â²\n\n\n# çå»ååæ¢å°æºåæ¯çæ­¥éª¤\n\ngit rebase <ç®æ (å½å)åæ¯> <æºåæ¯> # å°æºåæ¯ååºå°ç®æ åæ¯ãæ§è¡æ­¤å½ä»¤åä¼èªå¨åæ¢å°æºåæ¯\ngit checkout <ç®æ åæ¯>\ngit merge <æºåæ¯>\n\n\n1\n2\n3\n\n\næ³¨æï¼ä½¿ç¨è¿ä¸ªæ¹æ³è¦ç¡®ä¿æºåæ¯ä¸çä»£ç æ¯ææ°çã\n\næ¥ä¸æ¥ä½ å³å®å° server åæ¯ä¸­çä¿®æ¹ä¹æ´åè¿æ¥ã ä½¿ç¨ git rebase <basebranch> <topicbranch> å½ä»¤å¯ä»¥ç´æ¥å°ä¸»é¢åæ¯ ï¼å³æ¬ä¾ä¸­ç serverï¼ååºå°ç®æ åæ¯ï¼å³ masterï¼ä¸ã è¿æ ·åè½çå»ä½ ååæ¢å° server åæ¯ï¼åå¯¹å¶æ§è¡ååºå½ä»¤çå¤ä¸ªæ­¥éª¤ã\n\n$ git rebase master server\n\n\n1\n\n\nå¦å¾ å° server ä¸­çä¿®æ¹ååºå° master ä¸ æç¤ºï¼server ä¸­çä»£ç è¢«âç»­âå°äº master åé¢ã\n\n\n\nå¾7.å° `server` ä¸­çä¿®æ¹ååºå° `master` ä¸ â²\n\nç¶åå°±å¯ä»¥å¿«è¿åå¹¶ä¸»åæ¯ master äºï¼\n\n$ git checkout master\n$ git merge server\n\n\n1\n2\n\n\nè³æ­¤ï¼client å server åæ¯ä¸­çä¿®æ¹é½å·²ç»æ´åå°ä¸»åæ¯éäºï¼ ä½ å¯ä»¥å é¤è¿ä¸¤ä¸ªåæ¯ï¼æç»æäº¤åå²ä¼åæå¾ æç»çæäº¤åå² ä¸­çæ ·å­ï¼\n\n$ git branch -d client\n$ git branch -d server\n\n\n1\n2\n\n\n\n\nå¾8. æç»çæäº¤åå² â²\n\n\n# ååºçé£é©\n\n\n# éç§çå¾\n\nåï¼å¥å¦çååºä¹å¹¶éå®ç¾æ ç¼ºï¼è¦ç¨å®å¾éµå®ä¸æ¡ååï¼\n\nå¦ææäº¤å­å¨äºä½ çä»åºä¹å¤ï¼èå«äººå¯è½åºäºè¿äºæäº¤è¿è¡å¼åï¼é£ä¹ä¸è¦æ§è¡ååºã\n\nå¦æä½ éµå¾ªè¿æ¡éç§çå¾ï¼å°±ä¸ä¼åºå·®éã å¦åï¼äººæ°ç¾¤ä¼ä¼ä»æ¨ä½ ï¼ä½ çæååå®¶äººä¹ä¼å²ç¬ä½ ï¼å¾å¼ä½ ã\n\næç¤º\n\nä¾å¦ï¼å ä¸ªäººåæ¶å¨ä¸ä¸ªä¸»é¢åæ¯ä¸è¿è¡å¼ååæäº¤æ¶ï¼ä½ ä¸è¦ä¸­éæ§è¡ååºï¼åªæå¨å¤§å®¶é½å®æå·¥ä½ä¹åæå¯ä»¥æ§è¡ååºã\n\n\n# ååºçå®è´¨\n\nååºæä½çå®è´¨æ¯ä¸¢å¼ä¸äºç°æçæäº¤ï¼ç¶åç¸åºå°æ°å»ºä¸äºåå®¹ä¸æ ·ä½å®éä¸ä¸åçæäº¤ã å¦æä½ å·²ç»å°æäº¤æ¨éè³æä¸ªä»åºï¼èå¶ä»äººä¹å·²ç»ä»è¯¥ä»åºæåæäº¤å¹¶è¿è¡äºåç»­å·¥ä½ï¼æ­¤æ¶ï¼å¦æä½ ç¨ git rebase å½ä»¤éæ°æ´çäºæäº¤å¹¶åæ¬¡æ¨éï¼ä½ çåä¼´å æ­¤å°ä¸å¾ä¸åæ¬¡å°ä»ä»¬æå¤´çå·¥ä½ä¸ä½ çæäº¤è¿è¡æ´åï¼å¦ææ¥ä¸æ¥ä½ è¿è¦æåå¹¶æ´åä»ä»¬ä¿®æ¹è¿çæäº¤ï¼äºæå°±ä¼åå¾ä¸å¢ç³ã\n\nè®©æä»¬æ¥çä¸ä¸ªå¨å¬å¼çä»åºä¸æ§è¡ååºæä½æå¸¦æ¥çé®é¢ã åè®¾ä½ ä»ä¸ä¸ªä¸­å¤®æå¡å¨åéç¶åå¨å®çåºç¡ä¸è¿è¡äºä¸äºå¼åã ä½ çæäº¤åå²å¦å¾æç¤ºï¼\n\n\n\nå¾9. åéä¸ä¸ªä»åºï¼ç¶åå¨å®çåºç¡ä¸è¿è¡äºä¸äºå¼å â²\n\nç¶åï¼æäººååä¸­å¤®æå¡å¨æäº¤äºä¸äºä¿®æ¹ï¼å¶ä¸­è¿åæ¬ä¸æ¬¡åå¹¶ã ä½ æåäºè¿äºå¨è¿ç¨åæ¯ä¸çä¿®æ¹ï¼å¹¶å°å¶åå¹¶å°ä½ æ¬å°çå¼ååæ¯ï¼ç¶åä½ çæäº¤åå²å°±ä¼åæè¿æ ·ï¼\n\n\n\nå¾10. æåå«äººçæäº¤ï¼åå¹¶å°èªå·±çå¼ååæ¯ â²\n\næ¥ä¸æ¥ï¼è¿ä¸ªäººåå³å®æåå¹¶æä½åæ»ï¼æ¹ç¨ååºï¼ç»§èåç¨ git push --force å½ä»¤è¦çäºæå¡å¨ä¸çæäº¤åå²ã ä¹åä½ ä»æå¡å¨æåæ´æ°ï¼ä¼åç°å¤åºæ¥ä¸äºæ°çæäº¤ã\n\n\n\nå¾11. æäººæ¨éäºç»è¿ååºçæäº¤ï¼å¹¶ä¸¢å¼äºä½ çæ¬å°å¼åæåºäºçä¸äºæäº¤ â²\n\nç»æå°±æ¯ä½ ä»¬ä¸¤äººçå¤å¢é½ååå°´å°¬ã å¦æä½ æ§è¡ git pull å½ä»¤ï¼ä½ å°åå¹¶æ¥èªä¸¤æ¡æäº¤åå²çåå®¹ï¼çæä¸ä¸ªæ°çåå¹¶æäº¤ï¼æç»ä»åºä¼å¦å¾æç¤ºï¼\n\n\n\nå¾12. ä½ å°ç¸åçåå®¹ååå¹¶äºä¸æ¬¡ï¼çæäºä¸ä¸ªæ°çæäº¤ â²\n\næ­¤æ¶å¦æä½ æ§è¡ git log å½ä»¤ï¼ä½ ä¼åç°æä¸¤ä¸ªæäº¤çä½èãæ¥æãæ¥å¿å±ç¶æ¯ä¸æ ·çï¼è¿ä¼ä»¤äººæå°æ··ä¹±ã æ­¤å¤ï¼å¦æä½ å°è¿ä¸å åæ¨éå°æå¡å¨ä¸ï¼ä½ å®éä¸æ¯å°é£äºå·²ç»è¢«ååºæå¼çæäº¤åæ¾äºåæ¥ï¼è¿ä¼ä»¤äººæå°æ´å æ··ä¹±ã å¾ææ¾å¯¹æ¹å¹¶ä¸æ³å¨æäº¤åå²ä¸­çå° c4 å c6ï¼å ä¸ºä¹åå°±æ¯ä»æè¿ä¸¤ä¸ªæäº¤éè¿ååºä¸¢å¼çã\n\n\n# ç¨ååºè§£å³ååº\n\nå¦æä½  çç é­éäºç±»ä¼¼çå¤å¢ï¼git è¿æä¸äºé«çº§é­æ³å¯ä»¥å¸®å°ä½ ã å¦æå¢éä¸­çæäººå¼ºå¶æ¨éå¹¶è¦çäºä¸äºä½ æåºäºçæäº¤ï¼ä½ éè¦åçå°±æ¯æ£æ¥ä½ åäºåªäºä¿®æ¹ï¼ä»¥åä»ä»¬è¦çäºåªäºä¿®æ¹ã\n\nå®éä¸ï¼git é¤äºå¯¹æ´ä¸ªæäº¤è®¡ç® sha-1 æ ¡éªåä»¥å¤ï¼ä¹å¯¹æ¬æ¬¡æäº¤æå¼å¥çä¿®æ¹è®¡ç®äºæ ¡éªåââå³ âpatch-idâã\n\nå¦æä½ æåè¢«è¦çè¿çæ´æ°å¹¶å°ä½ æå¤´çå·¥ä½åºäºæ­¤è¿è¡ååºçè¯ï¼ä¸è¬æåµä¸ git é½è½æååè¾¨åºåªäºæ¯ä½ çä¿®æ¹ï¼å¹¶æå®ä»¬åºç¨å°æ°åæ¯ä¸ã\n\nä¸¾ä¸ªä¾å­ï¼å¦æéå°åé¢æå°ç æäººæ¨éäºç»è¿ååºçæäº¤ï¼å¹¶ä¸¢å¼äºä½ çæ¬å°å¼åæåºäºçä¸äºæäº¤ é£ç§æå¢ï¼å¦ææä»¬ä¸æ¯æ§è¡åå¹¶ï¼èæ¯æ§è¡ git rebase teamone/master, git å°ä¼ï¼\n\n * æ£æ¥åªäºæäº¤æ¯æä»¬çåæ¯ä¸ç¬æçï¼c2ï¼c3ï¼c4ï¼c6ï¼c7ï¼\n * æ£æ¥å¶ä¸­åªäºæäº¤ä¸æ¯åå¹¶æä½çç»æï¼c2ï¼c3ï¼c4ï¼\n * æ£æ¥åªäºæäº¤å¨å¯¹æ¹è¦çæ´æ°æ¶å¹¶æ²¡æè¢«çº³å¥ç®æ åæ¯ï¼åªæ c2 å c3ï¼å ä¸º c4 å¶å®å°±æ¯ c4'ï¼\n * ææ¥å°çè¿äºæäº¤åºç¨å¨ teamone/master ä¸é¢\n\nä»èæä»¬å°å¾å°ä¸ ä½ å°ç¸åçåå®¹ååå¹¶äºä¸æ¬¡ï¼çæäºä¸ä¸ªæ°çæäº¤ ä¸­ä¸åçç»æï¼å¦å¾ å¨ä¸ä¸ªè¢«ååºç¶åå¼ºå¶æ¨éçåæ¯ä¸åæ¬¡æ§è¡ååº æç¤ºã\n\n\n\nå¾13. å¨ä¸ä¸ªè¢«ååºç¶åå¼ºå¶æ¨éçåæ¯ä¸åæ¬¡æ§è¡ååº â²\n\nè¦æ³ä¸è¿°æ¹æ¡ææï¼è¿éè¦å¯¹æ¹å¨ååºæ¶ç¡®ä¿ c4' å c4 æ¯å ä¹ä¸æ ·çã å¦åååºæä½å°æ æ³è¯å«ï¼å¹¶æ°å»ºå¦ä¸ä¸ªç±»ä¼¼ c4 çè¡¥ä¸ï¼èè¿ä¸ªè¡¥ä¸å¾å¯è½æ æ³æ´æ´çæ´åå¥åå²ï¼å ä¸ºè¡¥ä¸ä¸­çä¿®æ¹å·²ç»å­å¨äºæä¸ªå°æ¹äºï¼ã\n\nå¨æ¬ä¾ä¸­å¦ä¸ç§ç®åçæ¹æ³æ¯ä½¿ç¨ git pull --rebase å½ä»¤èä¸æ¯ç´æ¥ git pullã åæèä½ å¯ä»¥èªå·±æå¨å®æè¿ä¸ªè¿ç¨ï¼å git fetchï¼å git rebase teamone/masterã\n\nå¦æä½ ä¹ æ¯ä½¿ç¨ git pull ï¼åæ¶åå¸æé»è®¤ä½¿ç¨éé¡¹ --rebaseï¼ä½ å¯ä»¥æ§è¡è¿æ¡è¯­å¥ git config --global pull.rebase true æ¥æ´æ¹ pull.rebase çé»è®¤éç½®ã\n\nå¦æä½ åªå¯¹ä¸ä¼ç¦»å¼ä½ çµèçæäº¤æ§è¡ååºï¼é£å°±ä¸ä¼æäºã å¦æä½ å¯¹å·²ç»æ¨éè¿çæäº¤æ§è¡ååºï¼ä½å«äººæ²¡æåºäºå®çæäº¤ï¼é£ä¹ä¹ä¸ä¼æäºã å¦æä½ å¯¹å·²ç»æ¨éè³å±ç¨ä»åºçæäº¤ä¸æ§è¡ååºå½ä»¤ï¼å¹¶å æ­¤ä¸¢å¤±äºä¸äºå«äººçå¼åæåºäºçæäº¤ï¼ é£ä½ å°±æå¤§éº»ç¦äºï¼ä½ çåäºä¹ä¼å æ­¤éè§ä½ ã\n\nå¦æä½ æä½ çåäºå¨æäºæå½¢ä¸å³æè¦è¿ä¹åï¼è¯·ä¸å®è¦éç¥æ¯ä¸ªäººæ§è¡ git pull --rebase å½ä»¤ï¼è¿æ ·å°½ç®¡ä¸è½é¿åä¼¤çï¼ä½è½ææç¼è§£ã\n\n\n# ååº vs. åå¹¶\n\nè³æ­¤ï¼ä½ å·²å¨å®æä¸­å­¦ä¹ äºååºååå¹¶çç¨æ³ï¼ä½ ä¸å®ä¼æ³é®ï¼å°åºåªç§æ¹å¼æ´å¥½ã å¨åç­è¿ä¸ªé®é¢ä¹åï¼è®©æä»¬éåä¸æ­¥ï¼æ³è®¨è®ºä¸ä¸æäº¤åå²å°åºæå³çä»ä¹ã\n\næä¸ç§è§ç¹è®¤ä¸ºï¼ä»åºçæäº¤åå²å³æ¯ è®°å½å®éåçè¿ä»ä¹ã å®æ¯éå¯¹åå²çææ¡£ï¼æ¬èº«å°±æä»·å¼ï¼ä¸è½ä¹±æ¹ã ä»è¿ä¸ªè§åº¦çæ¥ï¼æ¹åæäº¤åå²æ¯ä¸ç§äºµæ¸ï¼ä½ ä½¿ç¨ è°è¨ æ©çäºå®éåçè¿çäºæã å¦æç±åå¹¶äº§ççæäº¤åå²æ¯ä¸å¢ç³æä¹åï¼ æ¢ç¶äºå®å°±æ¯å¦æ­¤ï¼é£ä¹è¿äºçè¿¹å°±åºè¯¥è¢«ä¿çä¸æ¥ï¼è®©åäººè½å¤æ¥éã\n\nå¦ä¸ç§è§ç¹åæ­£å¥½ç¸åï¼ä»ä»¬è®¤ä¸ºæäº¤åå²æ¯ é¡¹ç®è¿ç¨ä¸­åççäºã æ²¡äººä¼åºçä¸æ¬ä¹¦çç¬¬ä¸çèç¨¿ï¼è½¯ä»¶ç»´æ¤æåä¹æ¯éè¦åå¤ä¿®è®¢æè½æ¹ä¾¿ä½¿ç¨ã æè¿ä¸è§ç¹çäººä¼ä½¿ç¨ rebase å filter-branch ç­å·¥å·æ¥ç¼åæäºï¼æä¹æ¹ä¾¿åæ¥çè¯»èå°±æä¹åã\n\nç°å¨ï¼è®©æä»¬åå°ä¹åçé®é¢ä¸æ¥ï¼å°åºåå¹¶è¿æ¯ååºå¥½ï¼å¸æä½ è½æç½ï¼è¿å¹¶æ²¡æä¸ä¸ªç®åçç­æ¡ã git æ¯ä¸ä¸ªéå¸¸å¼ºå¤§çå·¥å·ï¼å®åè®¸ä½ å¯¹æäº¤åå²åè®¸å¤äºæï¼ä½æ¯ä¸ªå¢éãæ¯ä¸ªé¡¹ç®å¯¹æ­¤çéæ±å¹¶ä¸ç¸åã æ¢ç¶ä½ å·²ç»åå«å­¦ä¹ äºä¸¤èçç¨æ³ï¼ç¸ä¿¡ä½ è½å¤æ ¹æ®å®éæåµä½åºææºçéæ©ã\n\næ»çååæ¯ï¼åªå¯¹å°æªæ¨éæåäº«ç»å«äººçæ¬å°ä¿®æ¹æ§è¡ååºæä½æ¸çåå²ï¼ ä»ä¸å¯¹å·²æ¨éè³å«å¤çæäº¤æ§è¡ååºæä½ï¼è¿æ ·ï¼ä½ æè½äº«åå°ä¸¤ç§æ¹å¼å¸¦æ¥çä¾¿å©ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Gitå·¥å·-äº¤äºå¼æå­",frontmatter:{title:"Gitå·¥å·-äº¤äºå¼æå­",date:"2020-11-18T17:43:57.000Z",permalink:"/pages/76d859/",categories:["ãGitãå­¦ä¹ ç¬è®°"],tags:["Git"]},regularPath:"/%E3%80%8AGit%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20.%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/90.Git%E5%B7%A5%E5%85%B7-%E4%BA%A4%E4%BA%92%E5%BC%8F%E6%9A%82%E5%AD%98.html",relativePath:"ãGitãå­¦ä¹ ç¬è®°/20.ææ¡£ç¬è®°/90.Gitå·¥å·-äº¤äºå¼æå­.md",key:"v-03537083",path:"/pages/76d859/",headers:[{level:2,title:"æå­ä¸åæ¶æå­æä»¶",slug:"æå­ä¸åæ¶æå­æä»¶",normalizedTitle:"æå­ä¸åæ¶æå­æä»¶",charIndex:751},{level:2,title:"æå­è¡¥ä¸",slug:"æå­è¡¥ä¸",normalizedTitle:"æå­è¡¥ä¸",charIndex:3468}],headersStr:"æå­ä¸åæ¶æå­æä»¶ æå­è¡¥ä¸",content:'# Gitå·¥å·-äº¤äºå¼æå­\n\næ¬èä¸­çå ä¸ªäº¤äºå¼ Git å½ä»¤å¯ä»¥å¸®å©ä½ å°æä»¶çç¹å®é¨åç»åææäº¤ã å½ä½ å¨ä¿®æ¹äºå¤§éæä»¶åï¼å¸æè¿äºæ¹å¨è½æåä¸ºè¥å¹²æäº¤èä¸æ¯æ··æå¨ä¸èµ·æä¸ºä¸ä¸ªæäº¤æ¶ï¼è¿å ä¸ªå·¥å·ä¼éå¸¸æç¨ã éè¿è¿ç§æ¹å¼ï¼å¯ä»¥ç¡®ä¿æäº¤æ¯é»è¾ä¸ç¬ç«çåæ´éï¼åæ¶ä¹ä¼ä½¿å¶ä»å¼åèå¨ä¸ä½ å·¥ä½æ¶å¾å®¹æå°å®¡æ ¸ã å¦æè¿è¡ git add æ¶ä½¿ç¨ -i æè --interactive éé¡¹ï¼Git å°ä¼è¿å¥ä¸ä¸ªäº¤äºå¼ç»ç«¯æ¨¡å¼ï¼æ¾ç¤ºç±»ä¼¼ä¸é¢çä¸è¥¿ï¼\n\n$ git add -i\n           staged     unstaged path\n  1:    unchanged        +0/-1 TODO\n  2:    unchanged        +1/-1 index.html\n  3:    unchanged        +5/-1 lib/simplegit.rb\n\n*** Commands ***\n  1: [s]tatus     2: [u]pdate      3: [r]evert     4: [a]dd untracked\n  5: [p]atch      6: [d]iff        7: [q]uit       8: [h]elp\nWhat now>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¯ä»¥çå°è¿ä¸ªå½ä»¤ä»¥åå¹³æ¶éå¸¸ä¸åçè§å¾æ¾ç¤ºäºæå­åºââåºæ¬ä¸ä¸ git status æ¯ç¸åçä¿¡æ¯ï¼ä½æ¯æ´ç®ææ¼è¦ä¸äºã å®å°æå­çä¿®æ¹åå¨å·¦ä¾§ï¼æªæå­çä¿®æ¹åå¨å³ä¾§ã\n\nå¨è¿ååºååæ¯âCommandsâå½ä»¤åºåã å¨è¿éä½ å¯ä»¥åä¸äºå·¥ä½ï¼åæ¬æå­æä»¶ãåæ¶æå­æä»¶ãæå­æä»¶çä¸é¨åãæ·»å æªè¢«è¿½è¸ªçæä»¶ãæ¾ç¤ºæå­åå®¹çåºå«ã\n\n\n# æå­ä¸åæ¶æå­æä»¶\n\nå¦æå¨ What now> æç¤ºç¬¦åé®å¥ u æ 2ï¼æ´æ°ï¼ï¼å®ä¼é®ä½ æ³è¦æå­åªä¸ªæä»¶ï¼\n\nWhat now> u\n           staged     unstaged path\n  1:    unchanged        +0/-1 TODO\n  2:    unchanged        +1/-1 index.html\n  3:    unchanged        +5/-1 lib/simplegit.rb\nUpdate>>\n\n\n1\n2\n3\n4\n5\n6\n\n\nè¦æå­ TODO å index.html æä»¶ï¼å¯ä»¥è¾å¥æ°å­ï¼\n\nUpdate>> 1,2\n           staged     unstaged path\n* 1:    unchanged        +0/-1 TODO\n* 2:    unchanged        +1/-1 index.html\n  3:    unchanged        +5/-1 lib/simplegit.rb\nUpdate>>\n\n\n1\n2\n3\n4\n5\n6\n\n\næ¯ä¸ªæä»¶åé¢ç * æå³çéä¸­çæä»¶å°ä¼è¢«æå­ã å¦æå¨ Update>> æç¤ºç¬¦åä¸è¾å¥ä»»ä½ä¸è¥¿å¹¶ç´æ¥æåè½¦ï¼Git å°ä¼æå­ä¹åéæ©çæä»¶ï¼\n\nUpdate>>\nupdated 2 paths\n\n*** Commands ***\n  1: [s]tatus     2: [u]pdate      3: [r]evert     4: [a]dd untracked\n  5: [p]atch      6: [d]iff        7: [q]uit       8: [h]elp\nWhat now> s\n           staged     unstaged path\n  1:        +0/-1      nothing TODO\n  2:        +1/-1      nothing index.html\n  3:    unchanged        +5/-1 lib/simplegit.rb\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nç°å¨å¯ä»¥çå° TODO ä¸ index.html æä»¶å·²ç»è¢«æå­è simplegit.rb æä»¶è¿æªè¢«æå­ã å¦æè¿æ¶æ³è¦åæ¶æå­ TODO æä»¶ï¼ä½¿ç¨ r æ 3ï¼æ¤æ¶ï¼éé¡¹ï¼\n\n*** Commands ***\n  1: [s]tatus     2: [u]pdate      3: [r]evert     4: [a]dd untracked\n  5: [p]atch      6: [d]iff        7: [q]uit       8: [h]elp\nWhat now> r\n           staged     unstaged path\n  1:        +0/-1      nothing TODO\n  2:        +1/-1      nothing index.html\n  3:    unchanged        +5/-1 lib/simplegit.rb\nRevert>> 1\n           staged     unstaged path\n* 1:        +0/-1      nothing TODO\n  2:        +1/-1      nothing index.html\n  3:    unchanged        +5/-1 lib/simplegit.rb\nRevert>> [enter]\nreverted one path\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nåæ¬¡æ¥ç Git ç¶æï¼å¯ä»¥çå°å·²ç»åæ¶æå­ TODO æä»¶ï¼\n\n*** Commands ***\n  1: [s]tatus     2: [u]pdate      3: [r]evert     4: [a]dd untracked\n  5: [p]atch      6: [d]iff        7: [q]uit       8: [h]elp\nWhat now> s\n           staged     unstaged path\n  1:    unchanged        +0/-1 TODO\n  2:        +1/-1      nothing index.html\n  3:    unchanged        +5/-1 lib/simplegit.rb\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¦ææ³è¦æ¥çå·²æå­åå®¹çåºå«ï¼å¯ä»¥ä½¿ç¨ d æ 6ï¼åºå«ï¼å½ä»¤ã å®ä¼æ¾ç¤ºæå­æä»¶çä¸ä¸ªåè¡¨ï¼å¯ä»¥ä»ä¸­éæ©æ³è¦æ¥ççæå­åºå«ã è¿è·ä½ å¨å½ä»¤è¡æå® git diff --cached éå¸¸ç¸ä¼¼ï¼\n\n*** Commands ***\n  1: [s]tatus     2: [u]pdate      3: [r]evert     4: [a]dd untracked\n  5: [p]atch      6: [d]iff        7: [q]uit       8: [h]elp\nWhat now> d\n           staged     unstaged path\n  1:        +1/-1      nothing index.html\nReview diff>> 1\ndiff --git a/index.html b/index.html\nindex 4d07108..4335f49 100644\n--- a/index.html\n+++ b/index.html\n@@ -16,7 +16,7 @@ Date Finder\n\n <p id="out">...</p>\n\n-<div id="footer">contact : support@github.com</div>\n+<div id="footer">contact : email.support@github.com</div>\n\n <script type="text/javascript">\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\néè¿è¿äºåºæ¬å½ä»¤ï¼å¯ä»¥ä½¿ç¨äº¤äºå¼æ·»å æ¨¡å¼æ¥è½»æ¾å°å¤çæå­åºã\n\n\n# æå­è¡¥ä¸\n\nGit ä¹å¯ä»¥æå­æä»¶çç¹å®é¨åã ä¾å¦ï¼å¦æå¨ simplegit.rb æä»¶ä¸­åäºä¸¤å¤ä¿®æ¹ï¼ä½åªæ³è¦æå­å¶ä¸­çä¸ä¸ªèä¸æ¯å¦ä¸ä¸ªï¼Git ä¼å¸®ä½ è½»æ¾å°å®æã å¨åä¸ä¸èä¸æ ·çäº¤äºå¼æç¤ºç¬¦ä¸­ï¼è¾å¥ p æ 5ï¼è¡¥ä¸ï¼ã Git ä¼è¯¢é®ä½ æ³è¦é¨åæå­åªäºæä»¶ï¼ç¶åï¼å¯¹å·²éæ©æä»¶çæ¯ä¸ä¸ªé¨åï¼å®é½ä¼ä¸ä¸ªä¸ªå°æ¾ç¤ºæä»¶åºå«å¹¶è¯¢é®ä½ æ¯å¦æ³è¦æå­å®ä»¬ï¼\n\ndiff --git a/lib/simplegit.rb b/lib/simplegit.rb\nindex dd5ecc4..57399e0 100644\n--- a/lib/simplegit.rb\n+++ b/lib/simplegit.rb\n@@ -22,7 +22,7 @@ class SimpleGit\n   end\n\n   def log(treeish = \'master\')\n-    command("git log -n 25 #{treeish}")\n+    command("git log -n 30 #{treeish}")\n   end\n\n   def blame(path)\nStage this hunk [y,n,a,d,/,j,J,g,e,?]?\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nè¿æ¶æå¾å¤éé¡¹ã è¾å¥ ? æ¾ç¤ºææå¯ä»¥ä½¿ç¨çå½ä»¤åè¡¨ï¼\n\nStage this hunk [y,n,a,d,/,j,J,g,e,?]? ?\ny - stage this hunk\nn - do not stage this hunk\na - stage this and all the remaining hunks in the file\nd - do not stage this hunk nor any of the remaining hunks in the file\ng - select a hunk to go to\n/ - search for a hunk matching the given regex\nj - leave this hunk undecided, see next undecided hunk\nJ - leave this hunk undecided, see next hunk\nk - leave this hunk undecided, see previous undecided hunk\nK - leave this hunk undecided, see previous hunk\ns - split the current hunk into smaller hunks\ne - manually edit the current hunk\n? - print help\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\néå¸¸æåµä¸å¯ä»¥è¾å¥ y æ n æ¥éæ©æ¯å¦è¦æå­æ¯ä¸ä¸ªåºåï¼ å½ç¶ï¼æå­ç¹å®æä»¶ä¸­çææé¨åæä¸ºä¹åçéæ©è·³è¿ä¸ä¸ªåºåä¹æ¯éå¸¸æç¨çã å¦æä½ åªæå­æä»¶çä¸é¨åï¼ç¶æè¾åºå¯è½ä¼åä¸é¢è¿æ ·ï¼\n\nWhat now> 1\n           staged     unstaged path\n  1:    unchanged        +0/-1 TODO\n  2:        +1/-1      nothing index.html\n  3:        +1/-1        +4/-0 lib/simplegit.rb\n\n\n1\n2\n3\n4\n5\n\n\nsimplegit.rb æä»¶çç¶æå¾æè¶£ã å®æ¾ç¤ºåºè¥å¹²è¡è¢«æå­ä¸è¥å¹²è¡æªè¢«æå­ã å·²ç»é¨åå°æå­äºè¿ä¸ªæä»¶ã å¨è¿æ¶ï¼å¯ä»¥éåºäº¤äºå¼æ·»å èæ¬å¹¶ä¸è¿è¡ git commit æ¥æäº¤é¨åæå­çæä»¶ã\n\nä¹å¯ä»¥ä¸å¿å¨äº¤äºå¼æ·»å æ¨¡å¼ä¸­åé¨åæä»¶æå­ââå¯ä»¥å¨å½ä»¤è¡ä¸­ä½¿ç¨ git add -p æ git add --patch æ¥å¯å¨åæ ·çèæ¬ã\n\næ´è¿ä¸æ­¥å°ï¼å¯ä»¥ä½¿ç¨ git reset --patch å½ä»¤çè¡¥ä¸æ¨¡å¼æ¥é¨åéç½®æä»¶ï¼ éè¿ git checkout --patch å½ä»¤æ¥é¨åæ£åºæä»¶ä¸ git stash save --patch å½ä»¤æ¥é¨åæå­æä»¶ã æä»¬å°ä¼å¨æ¥è§¦è¿äºå½ä»¤çé«çº§ä½¿ç¨æ¹æ³æ¶äºè§£æ´å¤è¯¦ç»ä¿¡æ¯ã',normalizedContent:'# gitå·¥å·-äº¤äºå¼æå­\n\næ¬èä¸­çå ä¸ªäº¤äºå¼ git å½ä»¤å¯ä»¥å¸®å©ä½ å°æä»¶çç¹å®é¨åç»åææäº¤ã å½ä½ å¨ä¿®æ¹äºå¤§éæä»¶åï¼å¸æè¿äºæ¹å¨è½æåä¸ºè¥å¹²æäº¤èä¸æ¯æ··æå¨ä¸èµ·æä¸ºä¸ä¸ªæäº¤æ¶ï¼è¿å ä¸ªå·¥å·ä¼éå¸¸æç¨ã éè¿è¿ç§æ¹å¼ï¼å¯ä»¥ç¡®ä¿æäº¤æ¯é»è¾ä¸ç¬ç«çåæ´éï¼åæ¶ä¹ä¼ä½¿å¶ä»å¼åèå¨ä¸ä½ å·¥ä½æ¶å¾å®¹æå°å®¡æ ¸ã å¦æè¿è¡ git add æ¶ä½¿ç¨ -i æè --interactive éé¡¹ï¼git å°ä¼è¿å¥ä¸ä¸ªäº¤äºå¼ç»ç«¯æ¨¡å¼ï¼æ¾ç¤ºç±»ä¼¼ä¸é¢çä¸è¥¿ï¼\n\n$ git add -i\n           staged     unstaged path\n  1:    unchanged        +0/-1 todo\n  2:    unchanged        +1/-1 index.html\n  3:    unchanged        +5/-1 lib/simplegit.rb\n\n*** commands ***\n  1: [s]tatus     2: [u]pdate      3: [r]evert     4: [a]dd untracked\n  5: [p]atch      6: [d]iff        7: [q]uit       8: [h]elp\nwhat now>\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¯ä»¥çå°è¿ä¸ªå½ä»¤ä»¥åå¹³æ¶éå¸¸ä¸åçè§å¾æ¾ç¤ºäºæå­åºââåºæ¬ä¸ä¸ git status æ¯ç¸åçä¿¡æ¯ï¼ä½æ¯æ´ç®ææ¼è¦ä¸äºã å®å°æå­çä¿®æ¹åå¨å·¦ä¾§ï¼æªæå­çä¿®æ¹åå¨å³ä¾§ã\n\nå¨è¿ååºååæ¯âcommandsâå½ä»¤åºåã å¨è¿éä½ å¯ä»¥åä¸äºå·¥ä½ï¼åæ¬æå­æä»¶ãåæ¶æå­æä»¶ãæå­æä»¶çä¸é¨åãæ·»å æªè¢«è¿½è¸ªçæä»¶ãæ¾ç¤ºæå­åå®¹çåºå«ã\n\n\n# æå­ä¸åæ¶æå­æä»¶\n\nå¦æå¨ what now> æç¤ºç¬¦åé®å¥ u æ 2ï¼æ´æ°ï¼ï¼å®ä¼é®ä½ æ³è¦æå­åªä¸ªæä»¶ï¼\n\nwhat now> u\n           staged     unstaged path\n  1:    unchanged        +0/-1 todo\n  2:    unchanged        +1/-1 index.html\n  3:    unchanged        +5/-1 lib/simplegit.rb\nupdate>>\n\n\n1\n2\n3\n4\n5\n6\n\n\nè¦æå­ todo å index.html æä»¶ï¼å¯ä»¥è¾å¥æ°å­ï¼\n\nupdate>> 1,2\n           staged     unstaged path\n* 1:    unchanged        +0/-1 todo\n* 2:    unchanged        +1/-1 index.html\n  3:    unchanged        +5/-1 lib/simplegit.rb\nupdate>>\n\n\n1\n2\n3\n4\n5\n6\n\n\næ¯ä¸ªæä»¶åé¢ç * æå³çéä¸­çæä»¶å°ä¼è¢«æå­ã å¦æå¨ update>> æç¤ºç¬¦åä¸è¾å¥ä»»ä½ä¸è¥¿å¹¶ç´æ¥æåè½¦ï¼git å°ä¼æå­ä¹åéæ©çæä»¶ï¼\n\nupdate>>\nupdated 2 paths\n\n*** commands ***\n  1: [s]tatus     2: [u]pdate      3: [r]evert     4: [a]dd untracked\n  5: [p]atch      6: [d]iff        7: [q]uit       8: [h]elp\nwhat now> s\n           staged     unstaged path\n  1:        +0/-1      nothing todo\n  2:        +1/-1      nothing index.html\n  3:    unchanged        +5/-1 lib/simplegit.rb\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nç°å¨å¯ä»¥çå° todo ä¸ index.html æä»¶å·²ç»è¢«æå­è simplegit.rb æä»¶è¿æªè¢«æå­ã å¦æè¿æ¶æ³è¦åæ¶æå­ todo æä»¶ï¼ä½¿ç¨ r æ 3ï¼æ¤æ¶ï¼éé¡¹ï¼\n\n*** commands ***\n  1: [s]tatus     2: [u]pdate      3: [r]evert     4: [a]dd untracked\n  5: [p]atch      6: [d]iff        7: [q]uit       8: [h]elp\nwhat now> r\n           staged     unstaged path\n  1:        +0/-1      nothing todo\n  2:        +1/-1      nothing index.html\n  3:    unchanged        +5/-1 lib/simplegit.rb\nrevert>> 1\n           staged     unstaged path\n* 1:        +0/-1      nothing todo\n  2:        +1/-1      nothing index.html\n  3:    unchanged        +5/-1 lib/simplegit.rb\nrevert>> [enter]\nreverted one path\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nåæ¬¡æ¥ç git ç¶æï¼å¯ä»¥çå°å·²ç»åæ¶æå­ todo æä»¶ï¼\n\n*** commands ***\n  1: [s]tatus     2: [u]pdate      3: [r]evert     4: [a]dd untracked\n  5: [p]atch      6: [d]iff        7: [q]uit       8: [h]elp\nwhat now> s\n           staged     unstaged path\n  1:    unchanged        +0/-1 todo\n  2:        +1/-1      nothing index.html\n  3:    unchanged        +5/-1 lib/simplegit.rb\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¦ææ³è¦æ¥çå·²æå­åå®¹çåºå«ï¼å¯ä»¥ä½¿ç¨ d æ 6ï¼åºå«ï¼å½ä»¤ã å®ä¼æ¾ç¤ºæå­æä»¶çä¸ä¸ªåè¡¨ï¼å¯ä»¥ä»ä¸­éæ©æ³è¦æ¥ççæå­åºå«ã è¿è·ä½ å¨å½ä»¤è¡æå® git diff --cached éå¸¸ç¸ä¼¼ï¼\n\n*** commands ***\n  1: [s]tatus     2: [u]pdate      3: [r]evert     4: [a]dd untracked\n  5: [p]atch      6: [d]iff        7: [q]uit       8: [h]elp\nwhat now> d\n           staged     unstaged path\n  1:        +1/-1      nothing index.html\nreview diff>> 1\ndiff --git a/index.html b/index.html\nindex 4d07108..4335f49 100644\n--- a/index.html\n+++ b/index.html\n@@ -16,7 +16,7 @@ date finder\n\n <p id="out">...</p>\n\n-<div id="footer">contact : support@github.com</div>\n+<div id="footer">contact : email.support@github.com</div>\n\n <script type="text/javascript">\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\néè¿è¿äºåºæ¬å½ä»¤ï¼å¯ä»¥ä½¿ç¨äº¤äºå¼æ·»å æ¨¡å¼æ¥è½»æ¾å°å¤çæå­åºã\n\n\n# æå­è¡¥ä¸\n\ngit ä¹å¯ä»¥æå­æä»¶çç¹å®é¨åã ä¾å¦ï¼å¦æå¨ simplegit.rb æä»¶ä¸­åäºä¸¤å¤ä¿®æ¹ï¼ä½åªæ³è¦æå­å¶ä¸­çä¸ä¸ªèä¸æ¯å¦ä¸ä¸ªï¼git ä¼å¸®ä½ è½»æ¾å°å®æã å¨åä¸ä¸èä¸æ ·çäº¤äºå¼æç¤ºç¬¦ä¸­ï¼è¾å¥ p æ 5ï¼è¡¥ä¸ï¼ã git ä¼è¯¢é®ä½ æ³è¦é¨åæå­åªäºæä»¶ï¼ç¶åï¼å¯¹å·²éæ©æä»¶çæ¯ä¸ä¸ªé¨åï¼å®é½ä¼ä¸ä¸ªä¸ªå°æ¾ç¤ºæä»¶åºå«å¹¶è¯¢é®ä½ æ¯å¦æ³è¦æå­å®ä»¬ï¼\n\ndiff --git a/lib/simplegit.rb b/lib/simplegit.rb\nindex dd5ecc4..57399e0 100644\n--- a/lib/simplegit.rb\n+++ b/lib/simplegit.rb\n@@ -22,7 +22,7 @@ class simplegit\n   end\n\n   def log(treeish = \'master\')\n-    command("git log -n 25 #{treeish}")\n+    command("git log -n 30 #{treeish}")\n   end\n\n   def blame(path)\nstage this hunk [y,n,a,d,/,j,j,g,e,?]?\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nè¿æ¶æå¾å¤éé¡¹ã è¾å¥ ? æ¾ç¤ºææå¯ä»¥ä½¿ç¨çå½ä»¤åè¡¨ï¼\n\nstage this hunk [y,n,a,d,/,j,j,g,e,?]? ?\ny - stage this hunk\nn - do not stage this hunk\na - stage this and all the remaining hunks in the file\nd - do not stage this hunk nor any of the remaining hunks in the file\ng - select a hunk to go to\n/ - search for a hunk matching the given regex\nj - leave this hunk undecided, see next undecided hunk\nj - leave this hunk undecided, see next hunk\nk - leave this hunk undecided, see previous undecided hunk\nk - leave this hunk undecided, see previous hunk\ns - split the current hunk into smaller hunks\ne - manually edit the current hunk\n? - print help\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\néå¸¸æåµä¸å¯ä»¥è¾å¥ y æ n æ¥éæ©æ¯å¦è¦æå­æ¯ä¸ä¸ªåºåï¼ å½ç¶ï¼æå­ç¹å®æä»¶ä¸­çææé¨åæä¸ºä¹åçéæ©è·³è¿ä¸ä¸ªåºåä¹æ¯éå¸¸æç¨çã å¦æä½ åªæå­æä»¶çä¸é¨åï¼ç¶æè¾åºå¯è½ä¼åä¸é¢è¿æ ·ï¼\n\nwhat now> 1\n           staged     unstaged path\n  1:    unchanged        +0/-1 todo\n  2:        +1/-1      nothing index.html\n  3:        +1/-1        +4/-0 lib/simplegit.rb\n\n\n1\n2\n3\n4\n5\n\n\nsimplegit.rb æä»¶çç¶æå¾æè¶£ã å®æ¾ç¤ºåºè¥å¹²è¡è¢«æå­ä¸è¥å¹²è¡æªè¢«æå­ã å·²ç»é¨åå°æå­äºè¿ä¸ªæä»¶ã å¨è¿æ¶ï¼å¯ä»¥éåºäº¤äºå¼æ·»å èæ¬å¹¶ä¸è¿è¡ git commit æ¥æäº¤é¨åæå­çæä»¶ã\n\nä¹å¯ä»¥ä¸å¿å¨äº¤äºå¼æ·»å æ¨¡å¼ä¸­åé¨åæä»¶æå­ââå¯ä»¥å¨å½ä»¤è¡ä¸­ä½¿ç¨ git add -p æ git add --patch æ¥å¯å¨åæ ·çèæ¬ã\n\næ´è¿ä¸æ­¥å°ï¼å¯ä»¥ä½¿ç¨ git reset --patch å½ä»¤çè¡¥ä¸æ¨¡å¼æ¥é¨åéç½®æä»¶ï¼ éè¿ git checkout --patch å½ä»¤æ¥é¨åæ£åºæä»¶ä¸ git stash save --patch å½ä»¤æ¥é¨åæå­æä»¶ã æä»¬å°ä¼å¨æ¥è§¦è¿äºå½ä»¤çé«çº§ä½¿ç¨æ¹æ³æ¶äºè§£æ´å¤è¯¦ç»ä¿¡æ¯ã',charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Promise å¯¹è±¡",frontmatter:{title:"Promise å¯¹è±¡",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/2810ae8985e9bd52",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/16.Promise%20%E5%AF%B9%E8%B1%A1.html",relativePath:"ãES6 æç¨ãç¬è®°/16.Promise å¯¹è±¡.md",key:"v-51ad7edb",path:"/pages/2810ae8985e9bd52/",headers:[{level:2,title:"Promise çå«ä¹",slug:"promise-çå«ä¹",normalizedTitle:"promise çå«ä¹",charIndex:17},{level:2,title:"åºæ¬ç¨æ³",slug:"åºæ¬ç¨æ³",normalizedTitle:"åºæ¬ç¨æ³",charIndex:983},{level:2,title:"Promise.prototype.then()",slug:"promise-prototype-then",normalizedTitle:"promise.prototype.then()",charIndex:5345},{level:2,title:"Promise.prototype.catch()",slug:"promise-prototype-catch",normalizedTitle:"promise.prototype.catch()",charIndex:6481},{level:2,title:"Promise.prototype.finally()",slug:"promise-prototype-finally",normalizedTitle:"promise.prototype.finally()",charIndex:11971},{level:2,title:"Promise.all()",slug:"promise-all",normalizedTitle:"promise.all()",charIndex:13396},{level:2,title:"Promise.race()",slug:"promise-race",normalizedTitle:"promise.race()",charIndex:15679},{level:2,title:"Promise.allSettled()",slug:"promise-allsettled",normalizedTitle:"promise.allsettled()",charIndex:16366},{level:2,title:"Promise.any()",slug:"promise-any",normalizedTitle:"promise.any()",charIndex:18215},{level:2,title:"Promise.resolve()",slug:"promise-resolve",normalizedTitle:"promise.resolve()",charIndex:10831},{level:2,title:"Promise.reject()",slug:"promise-reject",normalizedTitle:"promise.reject()",charIndex:21651},{level:2,title:"åºç¨",slug:"åºç¨",normalizedTitle:"åºç¨",charIndex:22310},{level:3,title:"å è½½å¾ç",slug:"å è½½å¾ç",normalizedTitle:"å è½½å¾ç",charIndex:2470},{level:3,title:"Generator å½æ°ä¸ Promise çç»å",slug:"generator-å½æ°ä¸-promise-çç»å",normalizedTitle:"generator å½æ°ä¸ promise çç»å",charIndex:22601},{level:2,title:"Promise.try()",slug:"promise-try",normalizedTitle:"promise.try()",charIndex:23393}],excerpt:'<h1 id="promise-å¯¹è±¡"><a class="header-anchor" href="#promise-å¯¹è±¡">#</a> Promise å¯¹è±¡</h1>\n<h2 id="promise-çå«ä¹"><a class="header-anchor" href="#promise-çå«ä¹">#</a> Promise çå«ä¹</h2>\n<p>Promise æ¯å¼æ­¥ç¼ç¨çä¸ç§è§£å³æ¹æ¡ï¼æ¯ä¼ ç»çè§£å³æ¹æ¡ââåè°å½æ°åäºä»¶ââæ´åçåæ´å¼ºå¤§ãå®ç±ç¤¾åºææ©æåºåå®ç°ï¼ES6 å°å¶åè¿äºè¯­è¨æ åï¼ç»ä¸äºç¨æ³ï¼åçæä¾äº<code>Promise</code>å¯¹è±¡ã</p>\n',headersStr:"Promise çå«ä¹ åºæ¬ç¨æ³ Promise.prototype.then() Promise.prototype.catch() Promise.prototype.finally() Promise.all() Promise.race() Promise.allSettled() Promise.any() Promise.resolve() Promise.reject() åºç¨ å è½½å¾ç Generator å½æ°ä¸ Promise çç»å Promise.try()",content:"# Promise å¯¹è±¡\n\n\n# Promise çå«ä¹\n\nPromise æ¯å¼æ­¥ç¼ç¨çä¸ç§è§£å³æ¹æ¡ï¼æ¯ä¼ ç»çè§£å³æ¹æ¡ââåè°å½æ°åäºä»¶ââæ´åçåæ´å¼ºå¤§ãå®ç±ç¤¾åºææ©æåºåå®ç°ï¼ES6 å°å¶åè¿äºè¯­è¨æ åï¼ç»ä¸äºç¨æ³ï¼åçæä¾äºPromiseå¯¹è±¡ã æè°Promiseï¼ç®åè¯´å°±æ¯ä¸ä¸ªå®¹å¨ï¼éé¢ä¿å­çæä¸ªæªæ¥æä¼ç»æçäºä»¶ï¼éå¸¸æ¯ä¸ä¸ªå¼æ­¥æä½ï¼çç»æãä»è¯­æ³ä¸è¯´ï¼Promise æ¯ä¸ä¸ªå¯¹è±¡ï¼ä»å®å¯ä»¥è·åå¼æ­¥æä½çæ¶æ¯ãPromise æä¾ç»ä¸ç APIï¼åç§å¼æ­¥æä½é½å¯ä»¥ç¨åæ ·çæ¹æ³è¿è¡å¤çã\n\nPromiseå¯¹è±¡æä»¥ä¸ä¸¤ä¸ªç¹ç¹ã\n\nï¼1ï¼å¯¹è±¡çç¶æä¸åå¤çå½±åãPromiseå¯¹è±¡ä»£è¡¨ä¸ä¸ªå¼æ­¥æä½ï¼æä¸ç§ç¶æï¼pendingï¼è¿è¡ä¸­ï¼ãfulfilledï¼å·²æåï¼årejectedï¼å·²å¤±è´¥ï¼ãåªæå¼æ­¥æä½çç»æï¼å¯ä»¥å³å®å½åæ¯åªä¸ç§ç¶æï¼ä»»ä½å¶ä»æä½é½æ æ³æ¹åè¿ä¸ªç¶æãè¿ä¹æ¯Promiseè¿ä¸ªåå­çç±æ¥ï¼å®çè±è¯­ææå°±æ¯âæ¿è¯ºâï¼è¡¨ç¤ºå¶ä»ææ®µæ æ³æ¹åã\n\nï¼2ï¼ä¸æ¦ç¶ææ¹åï¼å°±ä¸ä¼ååï¼ä»»ä½æ¶åé½å¯ä»¥å¾å°è¿ä¸ªç»æãPromiseå¯¹è±¡çç¶ææ¹åï¼åªæä¸¤ç§å¯è½ï¼ä»pendingåä¸ºfulfilledåä»pendingåä¸ºrejectedãåªè¦è¿ä¸¤ç§æåµåçï¼ç¶æå°±ååºäºï¼ä¸ä¼ååäºï¼ä¼ä¸ç´ä¿æè¿ä¸ªç»æï¼è¿æ¶å°±ç§°ä¸º resolvedï¼å·²å®åï¼ãå¦ææ¹åå·²ç»åçäºï¼ä½ åå¯¹Promiseå¯¹è±¡æ·»å åè°å½æ°ï¼ä¹ä¼ç«å³å¾å°è¿ä¸ªç»æãè¿ä¸äºä»¶ï¼Eventï¼å®å¨ä¸åï¼äºä»¶çç¹ç¹æ¯ï¼å¦æä½ éè¿äºå®ï¼åå»çå¬ï¼æ¯å¾ä¸å°ç»æçã\n\næ³¨æï¼ä¸ºäºè¡ææ¹ä¾¿ï¼æ¬ç« åé¢çresolvedç»ä¸åªæfulfilledç¶æï¼ä¸åå«rejectedç¶æã\n\næäºPromiseå¯¹è±¡ï¼å°±å¯ä»¥å°å¼æ­¥æä½ä»¥åæ­¥æä½çæµç¨è¡¨è¾¾åºæ¥ï¼é¿åäºå±å±åµå¥çåè°å½æ°ãæ­¤å¤ï¼Promiseå¯¹è±¡æä¾ç»ä¸çæ¥å£ï¼ä½¿å¾æ§å¶å¼æ­¥æä½æ´å å®¹æã\n\nPromiseä¹æä¸äºç¼ºç¹ãé¦åï¼æ æ³åæ¶Promiseï¼ä¸æ¦æ°å»ºå®å°±ä¼ç«å³æ§è¡ï¼æ æ³ä¸­éåæ¶ãå¶æ¬¡ï¼å¦æä¸è®¾ç½®åè°å½æ°ï¼Promiseåé¨æåºçéè¯¯ï¼ä¸ä¼ååºå°å¤é¨ãç¬¬ä¸ï¼å½å¤äºpendingç¶ææ¶ï¼æ æ³å¾ç¥ç®åè¿å±å°åªä¸ä¸ªé¶æ®µï¼ååå¼å§è¿æ¯å³å°å®æï¼ã\n\nå¦ææäºäºä»¶ä¸æ­å°åå¤åçï¼ä¸è¬æ¥è¯´ï¼ä½¿ç¨ Stream æ¨¡å¼æ¯æ¯é¨ç½²Promiseæ´å¥½çéæ©ã\n\n\n# åºæ¬ç¨æ³\n\nES6 è§å®ï¼Promiseå¯¹è±¡æ¯ä¸ä¸ªæé å½æ°ï¼ç¨æ¥çæPromiseå®ä¾ã\n\nä¸é¢ä»£ç åé äºä¸ä¸ªPromiseå®ä¾ã\n\nconst promise = new Promise(function(resolve, reject) {\n  // ... some code\n\n  if (/* å¼æ­¥æä½æå */){\n    resolve(value);\n  } else {\n    reject(error);\n  }\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nPromiseæé å½æ°æ¥åä¸ä¸ªå½æ°ä½ä¸ºåæ°ï¼è¯¥å½æ°çä¸¤ä¸ªåæ°åå«æ¯resolveårejectãå®ä»¬æ¯ä¸¤ä¸ªå½æ°ï¼ç± JavaScript å¼ææä¾ï¼ä¸ç¨èªå·±é¨ç½²ã\n\nresolveå½æ°çä½ç¨æ¯ï¼å°Promiseå¯¹è±¡çç¶æä»âæªå®æâåä¸ºâæåâï¼å³ä» pending åä¸º resolvedï¼ï¼å¨å¼æ­¥æä½æåæ¶è°ç¨ï¼å¹¶å°å¼æ­¥æä½çç»æï¼ä½ä¸ºåæ°ä¼ éåºå»ï¼rejectå½æ°çä½ç¨æ¯ï¼å°Promiseå¯¹è±¡çç¶æä»âæªå®æâåä¸ºâå¤±è´¥âï¼å³ä» pending åä¸º rejectedï¼ï¼å¨å¼æ­¥æä½å¤±è´¥æ¶è°ç¨ï¼å¹¶å°å¼æ­¥æä½æ¥åºçéè¯¯ï¼ä½ä¸ºåæ°ä¼ éåºå»ã\n\nPromiseå®ä¾çæä»¥åï¼å¯ä»¥ç¨thenæ¹æ³åå«æå®resolvedç¶æårejectedç¶æçåè°å½æ°ã\n\npromise.then(function(value) {\n  // success\n}, function(error) {\n  // failure\n});\n\n\n1\n2\n3\n4\n5\n\n\nthenæ¹æ³å¯ä»¥æ¥åä¸¤ä¸ªåè°å½æ°ä½ä¸ºåæ°ãç¬¬ä¸ä¸ªåè°å½æ°æ¯Promiseå¯¹è±¡çç¶æåä¸ºresolvedæ¶è°ç¨ï¼ç¬¬äºä¸ªåè°å½æ°æ¯Promiseå¯¹è±¡çç¶æåä¸ºrejectedæ¶è°ç¨ãå¶ä¸­ï¼ç¬¬äºä¸ªå½æ°æ¯å¯éçï¼ä¸ä¸å®è¦æä¾ãè¿ä¸¤ä¸ªå½æ°é½æ¥åPromiseå¯¹è±¡ä¼ åºçå¼ä½ä¸ºåæ°ã\n\nä¸é¢æ¯ä¸ä¸ªPromiseå¯¹è±¡çç®åä¾å­ã\n\nfunction timeout(ms) {\n  return new Promise((resolve, reject) => {\n    setTimeout(resolve, ms, 'done');\n  });\n}\n\ntimeout(100).then((value) => {\n  console.log(value);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼timeoutæ¹æ³è¿åä¸ä¸ªPromiseå®ä¾ï¼è¡¨ç¤ºä¸æ®µæ¶é´ä»¥åæä¼åççç»æãè¿äºæå®çæ¶é´ï¼msåæ°ï¼ä»¥åï¼Promiseå®ä¾çç¶æåä¸ºresolvedï¼å°±ä¼è§¦åthenæ¹æ³ç»å®çåè°å½æ°ã\n\nPromise æ°å»ºåå°±ä¼ç«å³æ§è¡ã\n\nlet promise = new Promise(function(resolve, reject) {\n  console.log('Promise');\n  resolve();\n});\n\npromise.then(function() {\n  console.log('resolved.');\n});\n\nconsole.log('Hi!');\n\n// Promise\n// Hi!\n// resolved\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼Promise æ°å»ºåç«å³æ§è¡ï¼æä»¥é¦åè¾åºçæ¯Promiseãç¶åï¼thenæ¹æ³æå®çåè°å½æ°ï¼å°å¨å½åèæ¬ææåæ­¥ä»»å¡æ§è¡å®æä¼æ§è¡ï¼æä»¥resolvedæåè¾åºã\n\nä¸é¢æ¯å¼æ­¥å è½½å¾ççä¾å­ã\n\nfunction loadImageAsync(url) {\n  return new Promise(function(resolve, reject) {\n    const image = new Image();\n\n    image.onload = function() {\n      resolve(image);\n    };\n\n    image.onerror = function() {\n      reject(new Error('Could not load image at ' + url));\n    };\n\n    image.src = url;\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼ä½¿ç¨Promiseåè£äºä¸ä¸ªå¾çå è½½çå¼æ­¥æä½ãå¦æå è½½æåï¼å°±è°ç¨resolveæ¹æ³ï¼å¦åå°±è°ç¨rejectæ¹æ³ã\n\nä¸é¢æ¯ä¸ä¸ªç¨Promiseå¯¹è±¡å®ç°ç Ajax æä½çä¾å­ã\n\nconst getJSON = function(url) {\n  const promise = new Promise(function(resolve, reject){\n    const handler = function() {\n      if (this.readyState !== 4) {\n        return;\n      }\n      if (this.status === 200) {\n        resolve(this.response);\n      } else {\n        reject(new Error(this.statusText));\n      }\n    };\n    const client = new XMLHttpRequest();\n    client.open(\"GET\", url);\n    client.onreadystatechange = handler;\n    client.responseType = \"json\";\n    client.setRequestHeader(\"Accept\", \"application/json\");\n    client.send();\n\n  });\n\n  return promise;\n};\n\ngetJSON(\"/posts.json\").then(function(json) {\n  console.log('Contents: ' + json);\n}, function(error) {\n  console.error('åºéäº', error);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nä¸é¢ä»£ç ä¸­ï¼getJSONæ¯å¯¹ XMLHttpRequest å¯¹è±¡çå°è£ï¼ç¨äºååºä¸ä¸ªéå¯¹ JSON æ°æ®ç HTTP è¯·æ±ï¼å¹¶ä¸è¿åä¸ä¸ªPromiseå¯¹è±¡ãéè¦æ³¨æçæ¯ï¼å¨getJSONåé¨ï¼resolveå½æ°årejectå½æ°è°ç¨æ¶ï¼é½å¸¦æåæ°ã\n\nå¦æè°ç¨resolveå½æ°årejectå½æ°æ¶å¸¦æåæ°ï¼é£ä¹å®ä»¬çåæ°ä¼è¢«ä¼ éç»åè°å½æ°ãrejectå½æ°çåæ°éå¸¸æ¯Errorå¯¹è±¡çå®ä¾ï¼è¡¨ç¤ºæåºçéè¯¯ï¼resolveå½æ°çåæ°é¤äºæ­£å¸¸çå¼ä»¥å¤ï¼è¿å¯è½æ¯å¦ä¸ä¸ª Promise å®ä¾ï¼æ¯å¦åä¸é¢è¿æ ·ã\n\nconst p1 = new Promise(function (resolve, reject) {\n  // ...\n});\n\nconst p2 = new Promise(function (resolve, reject) {\n  // ...\n  resolve(p1);\n})\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼p1åp2é½æ¯ Promise çå®ä¾ï¼ä½æ¯p2çresolveæ¹æ³å°p1ä½ä¸ºåæ°ï¼å³ä¸ä¸ªå¼æ­¥æä½çç»ææ¯è¿åå¦ä¸ä¸ªå¼æ­¥æä½ã\n\næ³¨æï¼è¿æ¶p1çç¶æå°±ä¼ä¼ éç»p2ï¼ä¹å°±æ¯è¯´ï¼p1çç¶æå³å®äºp2çç¶æãå¦æp1çç¶ææ¯pendingï¼é£ä¹p2çåè°å½æ°å°±ä¼ç­å¾p1çç¶ææ¹åï¼å¦æp1çç¶æå·²ç»æ¯resolvedæèrejectedï¼é£ä¹p2çåè°å½æ°å°ä¼ç«å»æ§è¡ã\n\nconst p1 = new Promise(function (resolve, reject) {\n  setTimeout(() => reject(new Error('fail')), 3000)\n})\n\nconst p2 = new Promise(function (resolve, reject) {\n  setTimeout(() => resolve(p1), 1000)\n})\n\np2\n  .then(result => console.log(result))\n  .catch(error => console.log(error))\n// Error: fail\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼p1æ¯ä¸ä¸ª Promiseï¼3 ç§ä¹ååä¸ºrejectedãp2çç¶æå¨ 1 ç§ä¹åæ¹åï¼resolveæ¹æ³è¿åçæ¯p1ãç±äºp2è¿åçæ¯å¦ä¸ä¸ª Promiseï¼å¯¼è´p2èªå·±çç¶ææ æäºï¼ç±p1çç¶æå³å®p2çç¶æãæä»¥ï¼åé¢çthenè¯­å¥é½åæéå¯¹åèï¼p1ï¼ãåè¿äº 2 ç§ï¼p1åä¸ºrejectedï¼å¯¼è´è§¦åcatchæ¹æ³æå®çåè°å½æ°ã\n\næ³¨æï¼è°ç¨resolveærejectå¹¶ä¸ä¼ç»ç» Promise çåæ°å½æ°çæ§è¡ã\n\nnew Promise((resolve, reject) => {\n  resolve(1);\n  console.log(2);\n}).then(r => {\n  console.log(r);\n});\n// 2\n// 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼è°ç¨resolve(1)ä»¥åï¼åé¢çconsole.log(2)è¿æ¯ä¼æ§è¡ï¼å¹¶ä¸ä¼é¦åæå°åºæ¥ãè¿æ¯å ä¸ºç«å³ resolved ç Promise æ¯å¨æ¬è½®äºä»¶å¾ªç¯çæ«å°¾æ§è¡ï¼æ»æ¯æäºæ¬è½®å¾ªç¯çåæ­¥ä»»å¡ã\n\nä¸è¬æ¥è¯´ï¼è°ç¨resolveærejectä»¥åï¼Promise çä½¿å½å°±å®æäºï¼åç»§æä½åºè¯¥æ¾å°thenæ¹æ³éé¢ï¼èä¸åºè¯¥ç´æ¥åå¨resolveærejectçåé¢ãæä»¥ï¼æå¥½å¨å®ä»¬åé¢å ä¸returnè¯­å¥ï¼è¿æ ·å°±ä¸ä¼ææå¤ã\n\nnew Promise((resolve, reject) => {\n  return resolve(1);\n  // åé¢çè¯­å¥ä¸ä¼æ§è¡\n  console.log(2);\n})\n\n\n1\n2\n3\n4\n5\n\n\n\n# Promise.prototype.then()\n\nPromise å®ä¾å·æthenæ¹æ³ï¼ä¹å°±æ¯è¯´ï¼thenæ¹æ³æ¯å®ä¹å¨ååå¯¹è±¡Promise.prototypeä¸çãå®çä½ç¨æ¯ä¸º Promise å®ä¾æ·»å ç¶ææ¹åæ¶çåè°å½æ°ãåé¢è¯´è¿ï¼thenæ¹æ³çç¬¬ä¸ä¸ªåæ°æ¯resolvedç¶æçåè°å½æ°ï¼ç¬¬äºä¸ªåæ°ï¼å¯éï¼æ¯rejectedç¶æçåè°å½æ°ã\n\nthenæ¹æ³è¿åçæ¯ä¸ä¸ªæ°çPromiseå®ä¾ï¼æ³¨æï¼ä¸æ¯åæ¥é£ä¸ªPromiseå®ä¾ï¼ãå æ­¤å¯ä»¥éç¨é¾å¼åæ³ï¼å³thenæ¹æ³åé¢åè°ç¨å¦ä¸ä¸ªthenæ¹æ³ã\n\ngetJSON(\"/posts.json\").then(function(json) {\n  return json.post;\n}).then(function(post) { // è¿éçpostæ¯åé¢ä¸ä¸ªthenè¿åçåæ°\n  // ...\n});\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çä»£ç ä½¿ç¨thenæ¹æ³ï¼ä¾æ¬¡æå®äºä¸¤ä¸ªåè°å½æ°ãç¬¬ä¸ä¸ªåè°å½æ°å®æä»¥åï¼ä¼å°è¿åç»æä½ä¸ºåæ°ï¼ä¼ å¥ç¬¬äºä¸ªåè°å½æ°ã\n\néç¨é¾å¼çthenï¼å¯ä»¥æå®ä¸ç»æç§æ¬¡åºè°ç¨çåè°å½æ°ãè¿æ¶ï¼åä¸ä¸ªåè°å½æ°ï¼æå¯è½è¿åçè¿æ¯ä¸ä¸ªPromiseå¯¹è±¡ï¼å³æå¼æ­¥æä½ï¼ï¼è¿æ¶åä¸ä¸ªåè°å½æ°ï¼å°±ä¼ç­å¾è¯¥Promiseå¯¹è±¡çç¶æåçååï¼æä¼è¢«è°ç¨ã\n\ngetJSON(\"/post/1.json\").then(function(post) {\n  return getJSON(post.commentURL);\n}).then(function (comments) {\n  console.log(\"resolved: \", comments);\n}, function (err){\n  console.log(\"rejected: \", err);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬ä¸ä¸ªthenæ¹æ³æå®çåè°å½æ°ï¼è¿åçæ¯å¦ä¸ä¸ªPromiseå¯¹è±¡ãè¿æ¶ï¼ç¬¬äºä¸ªthenæ¹æ³æå®çåè°å½æ°ï¼å°±ä¼ç­å¾è¿ä¸ªæ°çPromiseå¯¹è±¡ç¶æåçååãå¦æåä¸ºresolvedï¼å°±è°ç¨ç¬¬ä¸ä¸ªåè°å½æ°ï¼å¦æç¶æåä¸ºrejectedï¼å°±è°ç¨ç¬¬äºä¸ªåè°å½æ°ã\n\nå¦æéç¨ç®­å¤´å½æ°ï¼ä¸é¢çä»£ç å¯ä»¥åå¾æ´ç®æ´ã\n\ngetJSON(\"/post/1.json\").then(\n  post => getJSON(post.commentURL)\n).then(\n  comments => console.log(\"resolved: \", comments),\n  err => console.log(\"rejected: \", err)\n);\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# Promise.prototype.catch()\n\nPromise.prototype.catchæ¹æ³æ¯.then(null, rejection)æ.then(undefined, rejection)çå«åï¼ç¨äºæå®åçéè¯¯æ¶çåè°å½æ°ã\n\ngetJSON('/posts.json').then(function(posts) {\n  // ...\n}).catch(function(error) {\n  // å¤ç getJSON å åä¸ä¸ªåè°å½æ°è¿è¡æ¶åççéè¯¯\n  console.log('åçéè¯¯ï¼', error);\n});\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼getJSONæ¹æ³è¿åä¸ä¸ª Promise å¯¹è±¡ï¼å¦æè¯¥å¯¹è±¡ç¶æåä¸ºresolvedï¼åä¼è°ç¨thenæ¹æ³æå®çåè°å½æ°ï¼å¦æå¼æ­¥æä½æåºéè¯¯ï¼ç¶æå°±ä¼åä¸ºrejectedï¼å°±ä¼è°ç¨catchæ¹æ³æå®çåè°å½æ°ï¼å¤çè¿ä¸ªéè¯¯ãå¦å¤ï¼thenæ¹æ³æå®çåè°å½æ°ï¼å¦æè¿è¡ä¸­æåºéè¯¯ï¼ä¹ä¼è¢«catchæ¹æ³æè·ã\n\np.then((val) => console.log('fulfilled:', val))\n  .catch((err) => console.log('rejected', err));\n\n// ç­åäº\np.then((val) => console.log('fulfilled:', val))\n  .then(null, (err) => console.log(\"rejected:\", err));\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nconst promise = new Promise(function(resolve, reject) {\n  throw new Error('test');\n});\npromise.catch(function(error) {\n  console.log(error);\n});\n// Error: test\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼promiseæåºä¸ä¸ªéè¯¯ï¼å°±è¢«catchæ¹æ³æå®çåè°å½æ°æè·ãæ³¨æï¼ä¸é¢çåæ³ä¸ä¸é¢ä¸¤ç§åæ³æ¯ç­ä»·çã\n\n// åæ³ä¸\nconst promise = new Promise(function(resolve, reject) {\n  try {\n    throw new Error('test');\n  } catch(e) {\n    reject(e);\n  }\n});\npromise.catch(function(error) {\n  console.log(error);\n});\n\n// åæ³äº\nconst promise = new Promise(function(resolve, reject) {\n  reject(new Error('test'));\n});\npromise.catch(function(error) {\n  console.log(error);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\næ¯è¾ä¸é¢ä¸¤ç§åæ³ï¼å¯ä»¥åç°rejectæ¹æ³çä½ç¨ï¼ç­åäºæåºéè¯¯ã\n\nå¦æ Promise ç¶æå·²ç»åæresolvedï¼åæåºéè¯¯æ¯æ æçã\n\nconst promise = new Promise(function(resolve, reject) {\n  resolve('ok');\n  throw new Error('test');\n});\npromise\n  .then(function(value) { console.log(value) })\n  .catch(function(error) { console.log(error) });\n// ok\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼Promise å¨resolveè¯­å¥åé¢ï¼åæåºéè¯¯ï¼ä¸ä¼è¢«æè·ï¼ç­äºæ²¡ææåºãå ä¸º Promise çç¶æä¸æ¦æ¹åï¼å°±æ°¸ä¹ä¿æè¯¥ç¶æï¼ä¸ä¼ååäºã\n\nPromise å¯¹è±¡çéè¯¯å·æâåæ³¡âæ§è´¨ï¼ä¼ä¸ç´ååä¼ éï¼ç´å°è¢«æè·ä¸ºæ­¢ãä¹å°±æ¯è¯´ï¼éè¯¯æ»æ¯ä¼è¢«ä¸ä¸ä¸ªcatchè¯­å¥æè·ã\n\ngetJSON('/post/1.json').then(function(post) {\n  return getJSON(post.commentURL);\n}).then(function(comments) {\n  // some code\n}).catch(function(error) {\n  // å¤çåé¢ä¸ä¸ªPromiseäº§ççéè¯¯\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸å±æä¸ä¸ª Promise å¯¹è±¡ï¼ä¸ä¸ªç±getJSONäº§çï¼ä¸¤ä¸ªç±thenäº§çãå®ä»¬ä¹ä¸­ä»»ä½ä¸ä¸ªæåºçéè¯¯ï¼é½ä¼è¢«æåä¸ä¸ªcatchæè·ã\n\nä¸è¬æ¥è¯´ï¼ä¸è¦å¨thenæ¹æ³éé¢å®ä¹ Reject ç¶æçåè°å½æ°ï¼å³thençç¬¬äºä¸ªåæ°ï¼ï¼æ»æ¯ä½¿ç¨catchæ¹æ³ã\n\n// bad\npromise\n  .then(function(data) {\n    // success\n  }, function(err) {\n    // error\n  });\n\n// good\npromise\n  .then(function(data) { //cb\n    // success\n  })\n  .catch(function(err) {\n    // error\n  });\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬äºç§åæ³è¦å¥½äºç¬¬ä¸ç§åæ³ï¼çç±æ¯ç¬¬äºç§åæ³å¯ä»¥æè·åé¢thenæ¹æ³æ§è¡ä¸­çéè¯¯ï¼ä¹æ´æ¥è¿åæ­¥çåæ³ï¼try/catchï¼ãå æ­¤ï¼å»ºè®®æ»æ¯ä½¿ç¨catchæ¹æ³ï¼èä¸ä½¿ç¨thenæ¹æ³çç¬¬äºä¸ªåæ°ã\n\nè·ä¼ ç»çtry/catchä»£ç åä¸åçæ¯ï¼å¦ææ²¡æä½¿ç¨catchæ¹æ³æå®éè¯¯å¤ççåè°å½æ°ï¼Promise å¯¹è±¡æåºçéè¯¯ä¸ä¼ä¼ éå°å¤å±ä»£ç ï¼å³ä¸ä¼æä»»ä½ååºã\n\nconst someAsyncThing = function() {\n  return new Promise(function(resolve, reject) {\n    // ä¸é¢ä¸è¡ä¼æ¥éï¼å ä¸ºxæ²¡æå£°æ\n    resolve(x + 2);\n  });\n};\n\nsomeAsyncThing().then(function() {\n  console.log('everything is great');\n});\n\nsetTimeout(() => { console.log(123) }, 2000);\n// Uncaught (in promise) ReferenceError: x is not defined // æ¥éå´ä¸éåºè¿ç¨\n// 123\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼someAsyncThingå½æ°äº§çç Promise å¯¹è±¡ï¼åé¨æè¯­æ³éè¯¯ãæµè§å¨è¿è¡å°è¿ä¸è¡ï¼ä¼æå°åºéè¯¯æç¤ºReferenceError: x is not definedï¼ä½æ¯ä¸ä¼éåºè¿ç¨ãç»æ­¢èæ¬æ§è¡ï¼2 ç§ä¹åè¿æ¯ä¼è¾åº123ãè¿å°±æ¯è¯´ï¼Promise åé¨çéè¯¯ä¸ä¼å½±åå° Promise å¤é¨çä»£ç ï¼éä¿çè¯´æ³å°±æ¯âPromise ä¼åæéè¯¯âã\n\nè¿ä¸ªèæ¬æ¾å¨æå¡å¨æ§è¡ï¼éåºç å°±æ¯0ï¼å³è¡¨ç¤ºæ§è¡æåï¼ãä¸è¿ï¼Node æä¸ä¸ªunhandledRejectionäºä»¶ï¼ä¸é¨çå¬æªæè·çrejectéè¯¯ï¼ä¸é¢çèæ¬ä¼è§¦åè¿ä¸ªäºä»¶ççå¬å½æ°ï¼å¯ä»¥å¨çå¬å½æ°éé¢æåºéè¯¯ã\n\nprocess.on('unhandledRejection', function (err, p) {\n  throw err;\n});\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼unhandledRejectionäºä»¶ççå¬å½æ°æä¸¤ä¸ªåæ°ï¼ç¬¬ä¸ä¸ªæ¯éè¯¯å¯¹è±¡ï¼ç¬¬äºä¸ªæ¯æ¥éç Promise å®ä¾ï¼å®å¯ä»¥ç¨æ¥äºè§£åçéè¯¯çç¯å¢ä¿¡æ¯ã\n\næ³¨æï¼Node æè®¡åå¨æªæ¥åºé¤unhandledRejectionäºä»¶ãå¦æ Promise åé¨ææªæè·çéè¯¯ï¼ä¼ç´æ¥ç»æ­¢è¿ç¨ï¼å¹¶ä¸è¿ç¨çéåºç ä¸ä¸º 0ã\n\nåçä¸é¢çä¾å­ã\n\nconst promise = new Promise(function (resolve, reject) {\n  resolve('ok');\n  setTimeout(function () { throw new Error('test') }, 0)\n});\npromise.then(function (value) { console.log(value) });\n// ok\n// Uncaught Error: test\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼Promise æå®å¨ä¸ä¸è½®âäºä»¶å¾ªç¯âåæåºéè¯¯ãå°äºé£ä¸ªæ¶åï¼Promise çè¿è¡å·²ç»ç»æäºï¼æä»¥è¿ä¸ªéè¯¯æ¯å¨ Promise å½æ°ä½å¤æåºçï¼ä¼åæ³¡å°æå¤å±ï¼æäºæªæè·çéè¯¯ã\n\nä¸è¬æ»æ¯å»ºè®®ï¼Promise å¯¹è±¡åé¢è¦è·catchæ¹æ³ï¼è¿æ ·å¯ä»¥å¤ç Promise åé¨åççéè¯¯ãcatchæ¹æ³è¿åçè¿æ¯ä¸ä¸ª Promise å¯¹è±¡ï¼å æ­¤åé¢è¿å¯ä»¥æ¥çè°ç¨thenæ¹æ³ã\n\nconst someAsyncThing = function() {\n  return new Promise(function(resolve, reject) {\n    // ä¸é¢ä¸è¡ä¼æ¥éï¼å ä¸ºxæ²¡æå£°æ\n    resolve(x + 2);\n  });\n};\n\nsomeAsyncThing()\n.catch(function(error) {\n  console.log('oh no', error);\n})\n.then(function() {\n  console.log('carry on');\n});\n// oh no [ReferenceError: x is not defined]\n// carry on\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç è¿è¡å®catchæ¹æ³æå®çåè°å½æ°ï¼ä¼æ¥çè¿è¡åé¢é£ä¸ªthenæ¹æ³æå®çåè°å½æ°ãå¦ææ²¡ææ¥éï¼åä¼è·³è¿catchæ¹æ³ã\n\nPromise.resolve()\n.catch(function(error) {\n  console.log('oh no', error);\n})\n.then(function() {\n  console.log('carry on');\n});\n// carry on\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢çä»£ç å ä¸ºæ²¡ææ¥éï¼è·³è¿äºcatchæ¹æ³ï¼ç´æ¥æ§è¡åé¢çthenæ¹æ³ãæ­¤æ¶ï¼è¦æ¯thenæ¹æ³éé¢æ¥éï¼å°±ä¸åé¢çcatchæ å³äºã\n\ncatchæ¹æ³ä¹ä¸­ï¼è¿è½åæåºéè¯¯ã\n\nconst someAsyncThing = function() {\n  return new Promise(function(resolve, reject) {\n    // ä¸é¢ä¸è¡ä¼æ¥éï¼å ä¸ºxæ²¡æå£°æ\n    resolve(x + 2);\n  });\n};\n\nsomeAsyncThing().then(function() {\n  return someOtherAsyncThing();\n}).catch(function(error) {\n  console.log('oh no', error);\n  // ä¸é¢ä¸è¡ä¼æ¥éï¼å ä¸º y æ²¡æå£°æ\n  y + 2;\n}).then(function() {\n  console.log('carry on');\n});\n// oh no [ReferenceError: x is not defined]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼catchæ¹æ³æåºä¸ä¸ªéè¯¯ï¼å ä¸ºåé¢æ²¡æå«çcatchæ¹æ³äºï¼å¯¼è´è¿ä¸ªéè¯¯ä¸ä¼è¢«æè·ï¼ä¹ä¸ä¼ä¼ éå°å¤å±ãå¦ææ¹åä¸ä¸ï¼ç»æå°±ä¸ä¸æ ·äºã\n\nsomeAsyncThing().then(function() {\n  return someOtherAsyncThing();\n}).catch(function(error) {\n  console.log('oh no', error);\n  // ä¸é¢ä¸è¡ä¼æ¥éï¼å ä¸ºyæ²¡æå£°æ\n  y + 2;\n}).catch(function(error) {\n  console.log('carry on', error);\n});\n// oh no [ReferenceError: x is not defined]\n// carry on [ReferenceError: y is not defined]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬äºä¸ªcatchæ¹æ³ç¨æ¥æè·åä¸ä¸ªcatchæ¹æ³æåºçéè¯¯ã\n\n\n# Promise.prototype.finally()\n\nfinallyæ¹æ³ç¨äºæå®ä¸ç®¡ Promise å¯¹è±¡æåç¶æå¦ä½ï¼é½ä¼æ§è¡çæä½ãè¯¥æ¹æ³æ¯ ES2018 å¼å¥æ åçã\n\npromise\n.then(result => {Â·Â·Â·})\n.catch(error => {Â·Â·Â·})\n.finally(() => {Â·Â·Â·});\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸ç®¡promiseæåçç¶æï¼å¨æ§è¡å®thenæcatchæå®çåè°å½æ°ä»¥åï¼é½ä¼æ§è¡finallyæ¹æ³æå®çåè°å½æ°ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ï¼æå¡å¨ä½¿ç¨ Promise å¤çè¯·æ±ï¼ç¶åä½¿ç¨finallyæ¹æ³å³ææå¡å¨ã\n\nserver.listen(port)\n  .then(function () {\n    // ...\n  })\n  .finally(server.stop);\n\n\n1\n2\n3\n4\n5\n\n\nfinallyæ¹æ³çåè°å½æ°ä¸æ¥åä»»ä½åæ°ï¼è¿æå³çæ²¡æåæ³ç¥éï¼åé¢ç Promise ç¶æå°åºæ¯fulfilledè¿æ¯rejectedãè¿è¡¨æï¼finallyæ¹æ³éé¢çæä½ï¼åºè¯¥æ¯ä¸ç¶ææ å³çï¼ä¸ä¾èµäº Promise çæ§è¡ç»æã\n\nfinallyæ¬è´¨ä¸æ¯thenæ¹æ³çç¹ä¾ã\n\npromise\n.finally(() => {\n  // è¯­å¥\n});\n\n// ç­åäº\npromise\n.then(\n  result => {\n    // è¯­å¥\n    return result;\n  },\n  error => {\n    // è¯­å¥\n    throw error;\n  }\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æä¸ä½¿ç¨finallyæ¹æ³ï¼åæ ·çè¯­å¥éè¦ä¸ºæååå¤±è´¥ä¸¤ç§æåµååä¸æ¬¡ãæäºfinallyæ¹æ³ï¼ååªéè¦åä¸æ¬¡ã\n\nå®çå®ç°ä¹å¾ç®åã\n\nPromise.prototype.finally = function (callback) {\n  let P = this.constructor;\n  return this.then(\n    value  => P.resolve(callback()).then(() => value),\n    reason => P.resolve(callback()).then(() => { throw reason })\n  );\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸ç®¡åé¢ç Promise æ¯fulfilledè¿æ¯rejectedï¼é½ä¼æ§è¡åè°å½æ°callbackã\n\nä»ä¸é¢çå®ç°è¿å¯ä»¥çå°ï¼finallyæ¹æ³æ»æ¯ä¼è¿ååæ¥çå¼ã\n\n// resolve çå¼æ¯ undefined\nPromise.resolve(2).then(() => {}, () => {})\n\n// resolve çå¼æ¯ 2\nPromise.resolve(2).finally(() => {})\n\n// reject çå¼æ¯ undefined\nPromise.reject(3).then(() => {}, () => {})\n\n// reject çå¼æ¯ 3\nPromise.reject(3).finally(() => {})\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# Promise.all()\n\nPromise.all()æ¹æ³ç¨äºå°å¤ä¸ª Promise å®ä¾ï¼åè£æä¸ä¸ªæ°ç Promise å®ä¾ã\n\nconst p = Promise.all([p1, p2, p3]);\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼Promise.all()æ¹æ³æ¥åä¸ä¸ªæ°ç»ä½ä¸ºåæ°ï¼p1ãp2ãp3é½æ¯ Promise å®ä¾ï¼å¦æä¸æ¯ï¼å°±ä¼åè°ç¨ä¸é¢è®²å°çPromise.resolveæ¹æ³ï¼å°åæ°è½¬ä¸º Promise å®ä¾ï¼åè¿ä¸æ­¥å¤çãå¦å¤ï¼Promise.all()æ¹æ³çåæ°å¯ä»¥ä¸æ¯æ°ç»ï¼ä½å¿é¡»å·æ Iterator æ¥å£ï¼ä¸è¿åçæ¯ä¸ªæåé½æ¯ Promise å®ä¾ã\n\npçç¶æç±p1ãp2ãp3å³å®ï¼åæä¸¤ç§æåµã\n\nï¼1ï¼åªæp1ãp2ãp3çç¶æé½åæfulfilledï¼pçç¶ææä¼åæfulfilledï¼æ­¤æ¶p1ãp2ãp3çè¿åå¼ç»æä¸ä¸ªæ°ç»ï¼ä¼ éç»pçåè°å½æ°ã\n\nï¼2ï¼åªè¦p1ãp2ãp3ä¹ä¸­æä¸ä¸ªè¢«rejectedï¼pçç¶æå°±åærejectedï¼æ­¤æ¶ç¬¬ä¸ä¸ªè¢«rejectçå®ä¾çè¿åå¼ï¼ä¼ä¼ éç»pçåè°å½æ°ã\n\nä¸é¢æ¯ä¸ä¸ªå·ä½çä¾å­ã\n\n// çæä¸ä¸ªPromiseå¯¹è±¡çæ°ç»\nconst promises = [2, 3, 5, 7, 11, 13].map(function (id) {\n  return getJSON('/post/' + id + \".json\");\n});\n\nPromise.all(promises).then(function (posts) {\n  // ...\n}).catch(function(reason){\n  // ...\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼promisesæ¯åå« 6 ä¸ª Promise å®ä¾çæ°ç»ï¼åªæè¿ 6 ä¸ªå®ä¾çç¶æé½åæfulfilledï¼æèå¶ä¸­æä¸ä¸ªåä¸ºrejectedï¼æä¼è°ç¨Promise.allæ¹æ³åé¢çåè°å½æ°ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nconst databasePromise = connectDatabase();\n\nconst booksPromise = databasePromise\n  .then(findAllBooks);\n\nconst userPromise = databasePromise\n  .then(getCurrentUser);\n\nPromise.all([\n  booksPromise,\n  userPromise\n])\n.then(([books, user]) => pickTopRecommendations(books, user));\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼booksPromiseåuserPromiseæ¯ä¸¤ä¸ªå¼æ­¥æä½ï¼åªæç­å°å®ä»¬çç»æé½è¿åäºï¼æä¼è§¦åpickTopRecommendationsè¿ä¸ªåè°å½æ°ã\n\næ³¨æï¼å¦æä½ä¸ºåæ°ç Promise å®ä¾ï¼èªå·±å®ä¹äºcatchæ¹æ³ï¼é£ä¹å®ä¸æ¦è¢«rejectedï¼å¹¶ä¸ä¼è§¦åPromise.all()çcatchæ¹æ³ã\n\nconst p1 = new Promise((resolve, reject) => {\n  resolve('hello');\n})\n.then(result => result)\n.catch(e => e);\n\nconst p2 = new Promise((resolve, reject) => {\n  throw new Error('æ¥éäº');\n})\n.then(result => result)\n.catch(e => e);\n\nPromise.all([p1, p2])\n.then(result => console.log(result))\n.catch(e => console.log(e));\n// [\"hello\", Error: æ¥éäº]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼p1ä¼resolvedï¼p2é¦åä¼rejectedï¼ä½æ¯p2æèªå·±çcatchæ¹æ³ï¼è¯¥æ¹æ³è¿åçæ¯ä¸ä¸ªæ°ç Promise å®ä¾ï¼p2æåçå®éä¸æ¯è¿ä¸ªå®ä¾ãè¯¥å®ä¾æ§è¡å®catchæ¹æ³åï¼ä¹ä¼åæresolvedï¼å¯¼è´Promise.all()æ¹æ³åæ°éé¢çä¸¤ä¸ªå®ä¾é½ä¼resolvedï¼å æ­¤ä¼è°ç¨thenæ¹æ³æå®çåè°å½æ°ï¼èä¸ä¼è°ç¨catchæ¹æ³æå®çåè°å½æ°ã\n\nå¦æp2æ²¡æèªå·±çcatchæ¹æ³ï¼å°±ä¼è°ç¨Promise.all()çcatchæ¹æ³ã\n\nconst p1 = new Promise((resolve, reject) => {\n  resolve('hello');\n})\n.then(result => result);\n\nconst p2 = new Promise((resolve, reject) => {\n  throw new Error('æ¥éäº');\n})\n.then(result => result);\n\nPromise.all([p1, p2])\n.then(result => console.log(result))\n.catch(e => console.log(e));\n// Error: æ¥éäº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# Promise.race()\n\nPromise.race()æ¹æ³åæ ·æ¯å°å¤ä¸ª Promise å®ä¾ï¼åè£æä¸ä¸ªæ°ç Promise å®ä¾ã\n\nconst p = Promise.race([p1, p2, p3]);\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼åªè¦p1ãp2ãp3ä¹ä¸­æä¸ä¸ªå®ä¾çåæ¹åç¶æï¼pçç¶æå°±è·çæ¹åãé£ä¸ªçåæ¹åç Promise å®ä¾çè¿åå¼ï¼å°±ä¼ éç»pçåè°å½æ°ã\n\nPromise.race()æ¹æ³çåæ°ä¸Promise.all()æ¹æ³ä¸æ ·ï¼å¦æä¸æ¯ Promise å®ä¾ï¼å°±ä¼åè°ç¨ä¸é¢è®²å°çPromise.resolve()æ¹æ³ï¼å°åæ°è½¬ä¸º Promise å®ä¾ï¼åè¿ä¸æ­¥å¤çã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ï¼å¦ææå®æ¶é´åæ²¡æè·å¾ç»æï¼å°±å° Promise çç¶æåä¸ºrejectï¼å¦ååä¸ºresolveã\n\nconst p = Promise.race([\n  fetch('/resource-that-may-take-a-while'),\n  new Promise(function (resolve, reject) {\n    setTimeout(() => reject(new Error('request timeout')), 5000)\n  })\n]);\n\np\n.then(console.log)\n.catch(console.error);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æ 5 ç§ä¹åfetchæ¹æ³æ æ³è¿åç»æï¼åépçç¶æå°±ä¼åä¸ºrejectedï¼ä»èè§¦åcatchæ¹æ³æå®çåè°å½æ°ã\n\n\n# Promise.allSettled()\n\nPromise.allSettled()æ¹æ³æ¥åä¸ç» Promise å®ä¾ä½ä¸ºåæ°ï¼åè£æä¸ä¸ªæ°ç Promise å®ä¾ãåªæç­å°ææè¿äºåæ°å®ä¾é½è¿åç»æï¼ä¸ç®¡æ¯fulfilledè¿æ¯rejectedï¼åè£å®ä¾æä¼ç»æãè¯¥æ¹æ³ç± ES2020 å¼å¥ã\n\nconst promises = [\n  fetch('/api-1'),\n  fetch('/api-2'),\n  fetch('/api-3'),\n];\n\nawait Promise.allSettled(promises);\nremoveLoadingIndicator();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç å¯¹æå¡å¨ååºä¸ä¸ªè¯·æ±ï¼ç­å°ä¸ä¸ªè¯·æ±é½ç»æï¼ä¸ç®¡è¯·æ±æåè¿æ¯å¤±è´¥ï¼å è½½çæ»å¨å¾æ å°±ä¼æ¶å¤±ã\n\n**è¯¥æ¹æ³è¿åçæ°ç Promise å®ä¾ï¼ä¸æ¦ç»æï¼ç¶ææ»æ¯fulfilledï¼ä¸ä¼åærejectedã**ç¶æåæfulfilledåï¼Promise ççå¬å½æ°æ¥æ¶å°çåæ°æ¯ä¸ä¸ªæ°ç»ï¼æ¯ä¸ªæåå¯¹åºä¸ä¸ªä¼ å¥Promise.allSettled()ç Promise å®ä¾ã\n\nconst resolved = Promise.resolve(42);\nconst rejected = Promise.reject(-1);\n\nconst allSettledPromise = Promise.allSettled([resolved, rejected]);\n\nallSettledPromise.then(function (results) {\n  console.log(results);\n});\n// [\n//    { status: 'fulfilled', value: 42 },\n//    { status: 'rejected', reason: -1 }\n// ]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼Promise.allSettled()çè¿åå¼allSettledPromiseï¼ç¶æåªå¯è½åæfulfilledãå®ççå¬å½æ°æ¥æ¶å°çåæ°æ¯æ°ç»resultsãè¯¥æ°ç»çæ¯ä¸ªæåé½æ¯ä¸ä¸ªå¯¹è±¡ï¼å¯¹åºä¼ å¥Promise.allSettled()çä¸¤ä¸ª Promise å®ä¾ãæ¯ä¸ªå¯¹è±¡é½æstatuså±æ§ï¼è¯¥å±æ§çå¼åªå¯è½æ¯å­ç¬¦ä¸²fulfilledæå­ç¬¦ä¸²rejectedãfulfilledæ¶ï¼å¯¹è±¡ævalueå±æ§ï¼rejectedæ¶æreasonå±æ§ï¼å¯¹åºä¸¤ç§ç¶æçè¿åå¼ã\n\nä¸é¢æ¯è¿åå¼ç¨æ³çä¾å­ã\n\nconst promises = [ fetch('index.html'), fetch('https://does-not-exist/') ];\nconst results = await Promise.allSettled(promises);\n\n// è¿æ»¤åºæåçè¯·æ±\nconst successfulPromises = results.filter(p => p.status === 'fulfilled');\n\n// è¿æ»¤åºå¤±è´¥çè¯·æ±ï¼å¹¶è¾åºåå \nconst errors = results\n  .filter(p => p.status === 'rejected')\n  .map(p => p.reason);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nææ¶åï¼æä»¬ä¸å³å¿å¼æ­¥æä½çç»æï¼åªå³å¿è¿äºæä½ææ²¡æç»æãè¿æ¶ï¼Promise.allSettled()æ¹æ³å°±å¾æç¨ãå¦ææ²¡æè¿ä¸ªæ¹æ³ï¼æ³è¦ç¡®ä¿æææä½é½ç»æï¼å°±å¾éº»ç¦ãPromise.all()æ¹æ³æ æ³åå°è¿ä¸ç¹ã\n\nconst urls = [ /* ... */ ];\nconst requests = urls.map(x => fetch(x));\n\ntry {\n  await Promise.all(requests);\n  console.log('ææè¯·æ±é½æåã');\n} catch {\n  console.log('è³å°ä¸ä¸ªè¯·æ±å¤±è´¥ï¼å¶ä»è¯·æ±å¯è½è¿æ²¡ç»æã');\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼Promise.all()æ æ³ç¡®å®ææè¯·æ±é½ç»æãæ³è¦è¾¾å°è¿ä¸ªç®çï¼åèµ·æ¥å¾éº»ç¦ï¼æäºPromise.allSettled()ï¼è¿å°±å¾å®¹æäºã\n\n\n# Promise.any()\n\n**Promise.any()æ¹æ³æ¥åä¸ç» Promise å®ä¾ä½ä¸ºåæ°ï¼åè£æä¸ä¸ªæ°ç Promise å®ä¾ãåªè¦åæ°å®ä¾æä¸ä¸ªåæfulfilledç¶æï¼åè£å®ä¾å°±ä¼åæfulfilledç¶æï¼å¦æææåæ°å®ä¾é½åærejectedç¶æï¼åè£å®ä¾å°±ä¼åærejectedç¶æã**è¯¥æ¹æ³ç®åæ¯ä¸ä¸ªç¬¬ä¸é¶æ®µçææ¡ ã\n\nPromise.any()è·Promise.race()æ¹æ³å¾åï¼åªæä¸ç¹ä¸åï¼å°±æ¯ä¸ä¼å ä¸ºæä¸ª Promise åærejectedç¶æèç»æã\n\nconst promises = [\n  fetch('/endpoint-a').then(() => 'a'),\n  fetch('/endpoint-b').then(() => 'b'),\n  fetch('/endpoint-c').then(() => 'c'),\n];\ntry {\n  const first = await Promise.any(promises);\n  console.log(first);\n} catch (error) {\n  console.log(error);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼Promise.any()æ¹æ³çåæ°æ°ç»åå«ä¸ä¸ª Promise æä½ãå¶ä¸­åªè¦æä¸ä¸ªåæfulfilledï¼Promise.any()è¿åç Promise å¯¹è±¡å°±åæfulfilledãå¦æææä¸ä¸ªæä½é½åærejectedï¼é£ä¹å°±ä¼awaitå½ä»¤å°±ä¼æåºéè¯¯ã\n\nPromise.any()æåºçéè¯¯ï¼ä¸æ¯ä¸ä¸ªä¸è¬çéè¯¯ï¼èæ¯ä¸ä¸ª AggregateError å®ä¾ãå®ç¸å½äºä¸ä¸ªæ°ç»ï¼æ¯ä¸ªæåå¯¹åºä¸ä¸ªè¢«rejectedçæä½ææåºçéè¯¯ãä¸é¢æ¯ AggregateError çå®ç°ç¤ºä¾ã\n\nnew AggregateError() extends Array -> AggregateError\n\nconst err = new AggregateError();\nerr.push(new Error(\"first error\"));\nerr.push(new Error(\"second error\"));\nthrow err;\n\n\n1\n2\n3\n4\n5\n6\n\n\nææéè¯¯æ¶ï¼å¦æä¸ç¨try...catchç»æå await å½ä»¤ï¼å¯ä»¥åä¸é¢è¿æ ·åã\n\nPromise.any(promises).then(\n  (first) => {\n    // Any of the promises was fulfilled.\n  },\n  (error) => {\n    // All of the promises were rejected.\n  }\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nvar resolved = Promise.resolve(42);\nvar rejected = Promise.reject(-1);\nvar alsoRejected = Promise.reject(Infinity);\n\nPromise.any([resolved, rejected, alsoRejected]).then(function (result) {\n  console.log(result); // 42\n});\n\nPromise.any([rejected, alsoRejected]).catch(function (results) {\n  console.log(results); // [-1, Infinity]\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# Promise.resolve()\n\nææ¶éè¦å°ç°æå¯¹è±¡è½¬ä¸º Promise å¯¹è±¡ï¼Promise.resolve()æ¹æ³å°±èµ·å°è¿ä¸ªä½ç¨ã\n\nconst jsPromise = Promise.resolve($.ajax('/whatever.json'));\n\n\n1\n\n\nä¸é¢ä»£ç å° jQuery çæçdeferredå¯¹è±¡ï¼è½¬ä¸ºä¸ä¸ªæ°ç Promise å¯¹è±¡ã\n\nPromise.resolve()ç­ä»·äºä¸é¢çåæ³ã\n\nPromise.resolve('foo')\n// ç­ä»·äº\nnew Promise(resolve => resolve('foo'))\n\n\n1\n2\n3\n\n\nPromise.resolveæ¹æ³çåæ°åæåç§æåµã\n\nï¼1ï¼åæ°æ¯ä¸ä¸ª Promise å®ä¾\n\nå¦æåæ°æ¯ Promise å®ä¾ï¼é£ä¹Promise.resolveå°ä¸åä»»ä½ä¿®æ¹ãåå°ä¸å¨å°è¿åè¿ä¸ªå®ä¾ã\n\nï¼2ï¼åæ°æ¯ä¸ä¸ªthenableå¯¹è±¡\n\nthenableå¯¹è±¡æçæ¯å·æthenæ¹æ³çå¯¹è±¡ï¼æ¯å¦ä¸é¢è¿ä¸ªå¯¹è±¡ã\n\nlet thenable = {\n  then: function(resolve, reject) {\n    resolve(42);\n  }\n};\n\n\n1\n2\n3\n4\n5\n\n\nPromise.resolveæ¹æ³ä¼å°è¿ä¸ªå¯¹è±¡è½¬ä¸º Promise å¯¹è±¡ï¼ç¶åå°±ç«å³æ§è¡thenableå¯¹è±¡çthenæ¹æ³ã\n\nlet thenable = {\n  then: function(resolve, reject) {\n    resolve(42);\n  }\n};\n\nlet p1 = Promise.resolve(thenable);\np1.then(function(value) {\n  console.log(value);  // 42\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼thenableå¯¹è±¡çthenæ¹æ³æ§è¡åï¼å¯¹è±¡p1çç¶æå°±åä¸ºresolvedï¼ä»èç«å³æ§è¡æåé£ä¸ªthenæ¹æ³æå®çåè°å½æ°ï¼è¾åº 42ã\n\nï¼3ï¼åæ°ä¸æ¯å·æthenæ¹æ³çå¯¹è±¡ï¼ææ ¹æ¬å°±ä¸æ¯å¯¹è±¡\n\nå¦æåæ°æ¯ä¸ä¸ªåå§å¼ï¼æèæ¯ä¸ä¸ªä¸å·æthenæ¹æ³çå¯¹è±¡ï¼åPromise.resolveæ¹æ³è¿åä¸ä¸ªæ°ç Promise å¯¹è±¡ï¼ç¶æä¸ºresolvedã\n\nconst p = Promise.resolve('Hello');\n\np.then(function (s){\n  console.log(s)\n});\n// Hello\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çæä¸ä¸ªæ°ç Promise å¯¹è±¡çå®ä¾pãç±äºå­ç¬¦ä¸²Helloä¸å±äºå¼æ­¥æä½ï¼å¤æ­æ¹æ³æ¯å­ç¬¦ä¸²å¯¹è±¡ä¸å·æ then æ¹æ³ï¼ï¼è¿å Promise å®ä¾çç¶æä»ä¸çæå°±æ¯resolvedï¼æä»¥åè°å½æ°ä¼ç«å³æ§è¡ãPromise.resolveæ¹æ³çåæ°ï¼ä¼åæ¶ä¼ ç»åè°å½æ°ã\n\nï¼4ï¼ä¸å¸¦æä»»ä½åæ°\n\nPromise.resolve()æ¹æ³åè®¸è°ç¨æ¶ä¸å¸¦åæ°ï¼ç´æ¥è¿åä¸ä¸ªresolvedç¶æç Promise å¯¹è±¡ã\n\næä»¥ï¼å¦æå¸æå¾å°ä¸ä¸ª Promise å¯¹è±¡ï¼æ¯è¾æ¹ä¾¿çæ¹æ³å°±æ¯ç´æ¥è°ç¨Promise.resolve()æ¹æ³ã\n\nconst p = Promise.resolve();\n\np.then(function () {\n  // ...\n});\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç çåépå°±æ¯ä¸ä¸ª Promise å¯¹è±¡ã\n\néè¦æ³¨æçæ¯ï¼ç«å³resolve()ç Promise å¯¹è±¡ï¼æ¯å¨æ¬è½®âäºä»¶å¾ªç¯âï¼event loopï¼çç»ææ¶æ§è¡ï¼èä¸æ¯å¨ä¸ä¸è½®âäºä»¶å¾ªç¯âçå¼å§æ¶ã\n\nsetTimeout(function () {\n  console.log('three');\n}, 0);\n\nPromise.resolve().then(function () {\n  console.log('two');\n});\n\nconsole.log('one');\n\n// one\n// two\n// three\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼setTimeout(fn, 0)å¨ä¸ä¸è½®âäºä»¶å¾ªç¯âå¼å§æ¶æ§è¡ï¼Promise.resolve()å¨æ¬è½®âäºä»¶å¾ªç¯âç»ææ¶æ§è¡ï¼console.log('one')åæ¯ç«å³æ§è¡ï¼å æ­¤æåè¾åºã\n\n\n# Promise.reject()\n\nPromise.reject(reason)æ¹æ³ä¹ä¼è¿åä¸ä¸ªæ°ç Promise å®ä¾ï¼è¯¥å®ä¾çç¶æä¸ºrejectedã\n\nconst p = Promise.reject('åºéäº');\n// ç­åäº\nconst p = new Promise((resolve, reject) => reject('åºéäº'))\n\np.then(null, function (s) {\n  console.log(s)\n});\n// åºéäº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç çæä¸ä¸ª Promise å¯¹è±¡çå®ä¾pï¼ç¶æä¸ºrejectedï¼åè°å½æ°ä¼ç«å³æ§è¡ã\n\næ³¨æï¼Promise.reject()æ¹æ³çåæ°ï¼ä¼åå°ä¸å¨å°ä½ä¸ºrejectççç±ï¼åæåç»­æ¹æ³çåæ°ãè¿ä¸ç¹ä¸Promise.resolveæ¹æ³ä¸ä¸è´ã\n\nconst thenable = {\n  then(resolve, reject) {\n    reject('åºéäº');\n  }\n};\n\nPromise.reject(thenable)\n.catch(e => {\n  console.log(e === thenable)\n})\n// true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼Promise.rejectæ¹æ³çåæ°æ¯ä¸ä¸ªthenableå¯¹è±¡ï¼æ§è¡ä»¥åï¼åé¢catchæ¹æ³çåæ°ä¸æ¯rejectæåºçâåºéäºâè¿ä¸ªå­ç¬¦ä¸²ï¼èæ¯thenableå¯¹è±¡ã\n\n\n# åºç¨\n\n\n# å è½½å¾ç\n\næä»¬å¯ä»¥å°å¾ççå è½½åæä¸ä¸ªPromiseï¼ä¸æ¦å è½½å®æï¼Promiseçç¶æå°±åçååã\n\nconst preloadImage = function (path) {\n  return new Promise(function (resolve, reject) {\n    const image = new Image();\n    image.onload  = resolve;\n    image.onerror = reject;\n    image.src = path;\n  });\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# Generator å½æ°ä¸ Promise çç»å\n\nä½¿ç¨ Generator å½æ°ç®¡çæµç¨ï¼éå°å¼æ­¥æä½çæ¶åï¼éå¸¸è¿åä¸ä¸ªPromiseå¯¹è±¡ã\n\nfunction getFoo () {\n  return new Promise(function (resolve, reject){\n    resolve('foo');\n  });\n}\n\nconst g = function* () {\n  try {\n    const foo = yield getFoo();\n    console.log(foo);\n  } catch (e) {\n    console.log(e);\n  }\n};\n\nfunction run (generator) {\n  const it = generator();\n\n  function go(result) {\n    if (result.done) return result.value;\n\n    return result.value.then(function (value) {\n      return go(it.next(value));\n    }, function (error) {\n      return go(it.throw(error));\n    });\n  }\n\n  go(it.next());\n}\n\nrun(g);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n\n\nä¸é¢ä»£ç ç Generator å½æ°gä¹ä¸­ï¼æä¸ä¸ªå¼æ­¥æä½getFooï¼å®è¿åçå°±æ¯ä¸ä¸ªPromiseå¯¹è±¡ãå½æ°runç¨æ¥å¤çè¿ä¸ªPromiseå¯¹è±¡ï¼å¹¶è°ç¨ä¸ä¸ä¸ªnextæ¹æ³ã\n\n\n# Promise.try()\n\nå®éå¼åä¸­ï¼ç»å¸¸éå°ä¸ç§æåµï¼ä¸ç¥éæèä¸æ³åºåï¼å½æ°fæ¯åæ­¥å½æ°è¿æ¯å¼æ­¥æä½ï¼ä½æ¯æ³ç¨ Promise æ¥å¤çå®ãå ä¸ºè¿æ ·å°±å¯ä»¥ä¸ç®¡fæ¯å¦åå«å¼æ­¥æä½ï¼é½ç¨thenæ¹æ³æå®ä¸ä¸æ­¥æµç¨ï¼ç¨catchæ¹æ³å¤çfæåºçéè¯¯ãä¸è¬å°±ä¼éç¨ä¸é¢çåæ³ã\n\nPromise.resolve().then(f)\n\n\n1\n\n\nä¸é¢çåæ³æä¸ä¸ªç¼ºç¹ï¼å°±æ¯å¦æfæ¯åæ­¥å½æ°ï¼é£ä¹å®ä¼å¨æ¬è½®äºä»¶å¾ªç¯çæ«å°¾æ§è¡ã\n\nconst f = () => console.log('now');\nPromise.resolve().then(f);\nconsole.log('next');\n// next\n// now\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fæ¯åæ­¥çï¼ä½æ¯ç¨ Promise åè£äºä»¥åï¼å°±åæå¼æ­¥æ§è¡äºã\n\né£ä¹ææ²¡æä¸ç§æ¹æ³ï¼è®©åæ­¥å½æ°åæ­¥æ§è¡ï¼å¼æ­¥å½æ°å¼æ­¥æ§è¡ï¼å¹¶ä¸è®©å®ä»¬å·æç»ä¸ç API å¢ï¼åç­æ¯å¯ä»¥çï¼å¹¶ä¸è¿æä¸¤ç§åæ³ãç¬¬ä¸ç§åæ³æ¯ç¨asyncå½æ°æ¥åã\n\nconst f = () => console.log('now');\n(async () => f())();\nconsole.log('next');\n// now\n// next\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬äºè¡æ¯ä¸ä¸ªç«å³æ§è¡çå¿åå½æ°ï¼ä¼ç«å³æ§è¡éé¢çasyncå½æ°ï¼å æ­¤å¦æfæ¯åæ­¥çï¼å°±ä¼å¾å°åæ­¥çç»æï¼å¦æfæ¯å¼æ­¥çï¼å°±å¯ä»¥ç¨thenæå®ä¸ä¸æ­¥ï¼å°±åä¸é¢çåæ³ã\n\n(async () => f())()\n.then(...)\n\n\n1\n2\n\n\néè¦æ³¨æçæ¯ï¼async () => f()ä¼åæf()æåºçéè¯¯ãæä»¥ï¼å¦ææ³æè·éè¯¯ï¼è¦ä½¿ç¨promise.catchæ¹æ³ã\n\n(async () => f())()\n.then(...)\n.catch(...)\n\n\n1\n2\n3\n\n\nç¬¬äºç§åæ³æ¯ä½¿ç¨new Promise()ã\n\nconst f = () => console.log('now');\n(\n  () => new Promise(\n    resolve => resolve(f())\n  )\n)();\nconsole.log('next');\n// now\n// next\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¹æ¯ä½¿ç¨ç«å³æ§è¡çå¿åå½æ°ï¼æ§è¡new Promise()ãè¿ç§æåµä¸ï¼åæ­¥å½æ°ä¹æ¯åæ­¥æ§è¡çã\n\né´äºè¿æ¯ä¸ä¸ªå¾å¸¸è§çéæ±ï¼æä»¥ç°å¨æä¸ä¸ªææ¡ï¼æä¾Promise.tryæ¹æ³æ¿ä»£ä¸é¢çåæ³ã\n\nconst f = () => console.log('now');\nPromise.try(f);\nconsole.log('next');\n// now\n// next\n\n\n1\n2\n3\n4\n5\n\n\näºå®ä¸ï¼Promise.tryå­å¨å·²ä¹ï¼Promise åºBluebirdãQåwhenï¼æ©å°±æä¾äºè¿ä¸ªæ¹æ³ã\n\nç±äºPromise.tryä¸ºæææä½æä¾äºç»ä¸çå¤çæºå¶ï¼æä»¥å¦ææ³ç¨thenæ¹æ³ç®¡çæµç¨ï¼æå¥½é½ç¨Promise.tryåè£ä¸ä¸ãè¿æ ·æè®¸å¤å¥½å¤ï¼å¶ä¸­ä¸ç¹å°±æ¯å¯ä»¥æ´å¥½å°ç®¡çå¼å¸¸ã\n\nfunction getUsername(userId) {\n  return database.users.get({id: userId})\n  .then(function(user) {\n    return user.name;\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼database.users.get()è¿åä¸ä¸ª Promise å¯¹è±¡ï¼å¦ææåºå¼æ­¥éè¯¯ï¼å¯ä»¥ç¨catchæ¹æ³æè·ï¼å°±åä¸é¢è¿æ ·åã\n\ndatabase.users.get({id: userId})\n.then(...)\n.catch(...)\n\n\n1\n2\n3\n\n\nä½æ¯database.users.get()å¯è½è¿ä¼æåºåæ­¥éè¯¯ï¼æ¯å¦æ°æ®åºè¿æ¥éè¯¯ï¼å·ä½è¦çå®ç°æ¹æ³ï¼ï¼è¿æ¶ä½ å°±ä¸å¾ä¸ç¨try...catchå»æè·ã\n\ntry {\n  database.users.get({id: userId})\n  .then(...)\n  .catch(...)\n} catch (e) {\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢è¿æ ·çåæ³å°±å¾ç¬¨æäºï¼è¿æ¶å°±å¯ä»¥ç»ä¸ç¨promise.catch()æè·ææåæ­¥åå¼æ­¥çéè¯¯ã\n\nPromise.try(() => database.users.get({id: userId}))\n  .then(...)\n  .catch(...)\n\n\n1\n2\n3\n\n\näºå®ä¸ï¼Promise.tryå°±æ¯æ¨¡ætryä»£ç åï¼å°±åpromise.catchæ¨¡æçæ¯catchä»£ç åã",normalizedContent:"# promise å¯¹è±¡\n\n\n# promise çå«ä¹\n\npromise æ¯å¼æ­¥ç¼ç¨çä¸ç§è§£å³æ¹æ¡ï¼æ¯ä¼ ç»çè§£å³æ¹æ¡ââåè°å½æ°åäºä»¶ââæ´åçåæ´å¼ºå¤§ãå®ç±ç¤¾åºææ©æåºåå®ç°ï¼es6 å°å¶åè¿äºè¯­è¨æ åï¼ç»ä¸äºç¨æ³ï¼åçæä¾äºpromiseå¯¹è±¡ã æè°promiseï¼ç®åè¯´å°±æ¯ä¸ä¸ªå®¹å¨ï¼éé¢ä¿å­çæä¸ªæªæ¥æä¼ç»æçäºä»¶ï¼éå¸¸æ¯ä¸ä¸ªå¼æ­¥æä½ï¼çç»æãä»è¯­æ³ä¸è¯´ï¼promise æ¯ä¸ä¸ªå¯¹è±¡ï¼ä»å®å¯ä»¥è·åå¼æ­¥æä½çæ¶æ¯ãpromise æä¾ç»ä¸ç apiï¼åç§å¼æ­¥æä½é½å¯ä»¥ç¨åæ ·çæ¹æ³è¿è¡å¤çã\n\npromiseå¯¹è±¡æä»¥ä¸ä¸¤ä¸ªç¹ç¹ã\n\nï¼1ï¼å¯¹è±¡çç¶æä¸åå¤çå½±åãpromiseå¯¹è±¡ä»£è¡¨ä¸ä¸ªå¼æ­¥æä½ï¼æä¸ç§ç¶æï¼pendingï¼è¿è¡ä¸­ï¼ãfulfilledï¼å·²æåï¼årejectedï¼å·²å¤±è´¥ï¼ãåªæå¼æ­¥æä½çç»æï¼å¯ä»¥å³å®å½åæ¯åªä¸ç§ç¶æï¼ä»»ä½å¶ä»æä½é½æ æ³æ¹åè¿ä¸ªç¶æãè¿ä¹æ¯promiseè¿ä¸ªåå­çç±æ¥ï¼å®çè±è¯­ææå°±æ¯âæ¿è¯ºâï¼è¡¨ç¤ºå¶ä»ææ®µæ æ³æ¹åã\n\nï¼2ï¼ä¸æ¦ç¶ææ¹åï¼å°±ä¸ä¼ååï¼ä»»ä½æ¶åé½å¯ä»¥å¾å°è¿ä¸ªç»æãpromiseå¯¹è±¡çç¶ææ¹åï¼åªæä¸¤ç§å¯è½ï¼ä»pendingåä¸ºfulfilledåä»pendingåä¸ºrejectedãåªè¦è¿ä¸¤ç§æåµåçï¼ç¶æå°±ååºäºï¼ä¸ä¼ååäºï¼ä¼ä¸ç´ä¿æè¿ä¸ªç»æï¼è¿æ¶å°±ç§°ä¸º resolvedï¼å·²å®åï¼ãå¦ææ¹åå·²ç»åçäºï¼ä½ åå¯¹promiseå¯¹è±¡æ·»å åè°å½æ°ï¼ä¹ä¼ç«å³å¾å°è¿ä¸ªç»æãè¿ä¸äºä»¶ï¼eventï¼å®å¨ä¸åï¼äºä»¶çç¹ç¹æ¯ï¼å¦æä½ éè¿äºå®ï¼åå»çå¬ï¼æ¯å¾ä¸å°ç»æçã\n\næ³¨æï¼ä¸ºäºè¡ææ¹ä¾¿ï¼æ¬ç« åé¢çresolvedç»ä¸åªæfulfilledç¶æï¼ä¸åå«rejectedç¶æã\n\næäºpromiseå¯¹è±¡ï¼å°±å¯ä»¥å°å¼æ­¥æä½ä»¥åæ­¥æä½çæµç¨è¡¨è¾¾åºæ¥ï¼é¿åäºå±å±åµå¥çåè°å½æ°ãæ­¤å¤ï¼promiseå¯¹è±¡æä¾ç»ä¸çæ¥å£ï¼ä½¿å¾æ§å¶å¼æ­¥æä½æ´å å®¹æã\n\npromiseä¹æä¸äºç¼ºç¹ãé¦åï¼æ æ³åæ¶promiseï¼ä¸æ¦æ°å»ºå®å°±ä¼ç«å³æ§è¡ï¼æ æ³ä¸­éåæ¶ãå¶æ¬¡ï¼å¦æä¸è®¾ç½®åè°å½æ°ï¼promiseåé¨æåºçéè¯¯ï¼ä¸ä¼ååºå°å¤é¨ãç¬¬ä¸ï¼å½å¤äºpendingç¶ææ¶ï¼æ æ³å¾ç¥ç®åè¿å±å°åªä¸ä¸ªé¶æ®µï¼ååå¼å§è¿æ¯å³å°å®æï¼ã\n\nå¦ææäºäºä»¶ä¸æ­å°åå¤åçï¼ä¸è¬æ¥è¯´ï¼ä½¿ç¨ stream æ¨¡å¼æ¯æ¯é¨ç½²promiseæ´å¥½çéæ©ã\n\n\n# åºæ¬ç¨æ³\n\nes6 è§å®ï¼promiseå¯¹è±¡æ¯ä¸ä¸ªæé å½æ°ï¼ç¨æ¥çæpromiseå®ä¾ã\n\nä¸é¢ä»£ç åé äºä¸ä¸ªpromiseå®ä¾ã\n\nconst promise = new promise(function(resolve, reject) {\n  // ... some code\n\n  if (/* å¼æ­¥æä½æå */){\n    resolve(value);\n  } else {\n    reject(error);\n  }\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\npromiseæé å½æ°æ¥åä¸ä¸ªå½æ°ä½ä¸ºåæ°ï¼è¯¥å½æ°çä¸¤ä¸ªåæ°åå«æ¯resolveårejectãå®ä»¬æ¯ä¸¤ä¸ªå½æ°ï¼ç± javascript å¼ææä¾ï¼ä¸ç¨èªå·±é¨ç½²ã\n\nresolveå½æ°çä½ç¨æ¯ï¼å°promiseå¯¹è±¡çç¶æä»âæªå®æâåä¸ºâæåâï¼å³ä» pending åä¸º resolvedï¼ï¼å¨å¼æ­¥æä½æåæ¶è°ç¨ï¼å¹¶å°å¼æ­¥æä½çç»æï¼ä½ä¸ºåæ°ä¼ éåºå»ï¼rejectå½æ°çä½ç¨æ¯ï¼å°promiseå¯¹è±¡çç¶æä»âæªå®æâåä¸ºâå¤±è´¥âï¼å³ä» pending åä¸º rejectedï¼ï¼å¨å¼æ­¥æä½å¤±è´¥æ¶è°ç¨ï¼å¹¶å°å¼æ­¥æä½æ¥åºçéè¯¯ï¼ä½ä¸ºåæ°ä¼ éåºå»ã\n\npromiseå®ä¾çæä»¥åï¼å¯ä»¥ç¨thenæ¹æ³åå«æå®resolvedç¶æårejectedç¶æçåè°å½æ°ã\n\npromise.then(function(value) {\n  // success\n}, function(error) {\n  // failure\n});\n\n\n1\n2\n3\n4\n5\n\n\nthenæ¹æ³å¯ä»¥æ¥åä¸¤ä¸ªåè°å½æ°ä½ä¸ºåæ°ãç¬¬ä¸ä¸ªåè°å½æ°æ¯promiseå¯¹è±¡çç¶æåä¸ºresolvedæ¶è°ç¨ï¼ç¬¬äºä¸ªåè°å½æ°æ¯promiseå¯¹è±¡çç¶æåä¸ºrejectedæ¶è°ç¨ãå¶ä¸­ï¼ç¬¬äºä¸ªå½æ°æ¯å¯éçï¼ä¸ä¸å®è¦æä¾ãè¿ä¸¤ä¸ªå½æ°é½æ¥åpromiseå¯¹è±¡ä¼ åºçå¼ä½ä¸ºåæ°ã\n\nä¸é¢æ¯ä¸ä¸ªpromiseå¯¹è±¡çç®åä¾å­ã\n\nfunction timeout(ms) {\n  return new promise((resolve, reject) => {\n    settimeout(resolve, ms, 'done');\n  });\n}\n\ntimeout(100).then((value) => {\n  console.log(value);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼timeoutæ¹æ³è¿åä¸ä¸ªpromiseå®ä¾ï¼è¡¨ç¤ºä¸æ®µæ¶é´ä»¥åæä¼åççç»æãè¿äºæå®çæ¶é´ï¼msåæ°ï¼ä»¥åï¼promiseå®ä¾çç¶æåä¸ºresolvedï¼å°±ä¼è§¦åthenæ¹æ³ç»å®çåè°å½æ°ã\n\npromise æ°å»ºåå°±ä¼ç«å³æ§è¡ã\n\nlet promise = new promise(function(resolve, reject) {\n  console.log('promise');\n  resolve();\n});\n\npromise.then(function() {\n  console.log('resolved.');\n});\n\nconsole.log('hi!');\n\n// promise\n// hi!\n// resolved\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼promise æ°å»ºåç«å³æ§è¡ï¼æä»¥é¦åè¾åºçæ¯promiseãç¶åï¼thenæ¹æ³æå®çåè°å½æ°ï¼å°å¨å½åèæ¬ææåæ­¥ä»»å¡æ§è¡å®æä¼æ§è¡ï¼æä»¥resolvedæåè¾åºã\n\nä¸é¢æ¯å¼æ­¥å è½½å¾ççä¾å­ã\n\nfunction loadimageasync(url) {\n  return new promise(function(resolve, reject) {\n    const image = new image();\n\n    image.onload = function() {\n      resolve(image);\n    };\n\n    image.onerror = function() {\n      reject(new error('could not load image at ' + url));\n    };\n\n    image.src = url;\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼ä½¿ç¨promiseåè£äºä¸ä¸ªå¾çå è½½çå¼æ­¥æä½ãå¦æå è½½æåï¼å°±è°ç¨resolveæ¹æ³ï¼å¦åå°±è°ç¨rejectæ¹æ³ã\n\nä¸é¢æ¯ä¸ä¸ªç¨promiseå¯¹è±¡å®ç°ç ajax æä½çä¾å­ã\n\nconst getjson = function(url) {\n  const promise = new promise(function(resolve, reject){\n    const handler = function() {\n      if (this.readystate !== 4) {\n        return;\n      }\n      if (this.status === 200) {\n        resolve(this.response);\n      } else {\n        reject(new error(this.statustext));\n      }\n    };\n    const client = new xmlhttprequest();\n    client.open(\"get\", url);\n    client.onreadystatechange = handler;\n    client.responsetype = \"json\";\n    client.setrequestheader(\"accept\", \"application/json\");\n    client.send();\n\n  });\n\n  return promise;\n};\n\ngetjson(\"/posts.json\").then(function(json) {\n  console.log('contents: ' + json);\n}, function(error) {\n  console.error('åºéäº', error);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nä¸é¢ä»£ç ä¸­ï¼getjsonæ¯å¯¹ xmlhttprequest å¯¹è±¡çå°è£ï¼ç¨äºååºä¸ä¸ªéå¯¹ json æ°æ®ç http è¯·æ±ï¼å¹¶ä¸è¿åä¸ä¸ªpromiseå¯¹è±¡ãéè¦æ³¨æçæ¯ï¼å¨getjsonåé¨ï¼resolveå½æ°årejectå½æ°è°ç¨æ¶ï¼é½å¸¦æåæ°ã\n\nå¦æè°ç¨resolveå½æ°årejectå½æ°æ¶å¸¦æåæ°ï¼é£ä¹å®ä»¬çåæ°ä¼è¢«ä¼ éç»åè°å½æ°ãrejectå½æ°çåæ°éå¸¸æ¯errorå¯¹è±¡çå®ä¾ï¼è¡¨ç¤ºæåºçéè¯¯ï¼resolveå½æ°çåæ°é¤äºæ­£å¸¸çå¼ä»¥å¤ï¼è¿å¯è½æ¯å¦ä¸ä¸ª promise å®ä¾ï¼æ¯å¦åä¸é¢è¿æ ·ã\n\nconst p1 = new promise(function (resolve, reject) {\n  // ...\n});\n\nconst p2 = new promise(function (resolve, reject) {\n  // ...\n  resolve(p1);\n})\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼p1åp2é½æ¯ promise çå®ä¾ï¼ä½æ¯p2çresolveæ¹æ³å°p1ä½ä¸ºåæ°ï¼å³ä¸ä¸ªå¼æ­¥æä½çç»ææ¯è¿åå¦ä¸ä¸ªå¼æ­¥æä½ã\n\næ³¨æï¼è¿æ¶p1çç¶æå°±ä¼ä¼ éç»p2ï¼ä¹å°±æ¯è¯´ï¼p1çç¶æå³å®äºp2çç¶æãå¦æp1çç¶ææ¯pendingï¼é£ä¹p2çåè°å½æ°å°±ä¼ç­å¾p1çç¶ææ¹åï¼å¦æp1çç¶æå·²ç»æ¯resolvedæèrejectedï¼é£ä¹p2çåè°å½æ°å°ä¼ç«å»æ§è¡ã\n\nconst p1 = new promise(function (resolve, reject) {\n  settimeout(() => reject(new error('fail')), 3000)\n})\n\nconst p2 = new promise(function (resolve, reject) {\n  settimeout(() => resolve(p1), 1000)\n})\n\np2\n  .then(result => console.log(result))\n  .catch(error => console.log(error))\n// error: fail\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼p1æ¯ä¸ä¸ª promiseï¼3 ç§ä¹ååä¸ºrejectedãp2çç¶æå¨ 1 ç§ä¹åæ¹åï¼resolveæ¹æ³è¿åçæ¯p1ãç±äºp2è¿åçæ¯å¦ä¸ä¸ª promiseï¼å¯¼è´p2èªå·±çç¶ææ æäºï¼ç±p1çç¶æå³å®p2çç¶æãæä»¥ï¼åé¢çthenè¯­å¥é½åæéå¯¹åèï¼p1ï¼ãåè¿äº 2 ç§ï¼p1åä¸ºrejectedï¼å¯¼è´è§¦åcatchæ¹æ³æå®çåè°å½æ°ã\n\næ³¨æï¼è°ç¨resolveærejectå¹¶ä¸ä¼ç»ç» promise çåæ°å½æ°çæ§è¡ã\n\nnew promise((resolve, reject) => {\n  resolve(1);\n  console.log(2);\n}).then(r => {\n  console.log(r);\n});\n// 2\n// 1\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼è°ç¨resolve(1)ä»¥åï¼åé¢çconsole.log(2)è¿æ¯ä¼æ§è¡ï¼å¹¶ä¸ä¼é¦åæå°åºæ¥ãè¿æ¯å ä¸ºç«å³ resolved ç promise æ¯å¨æ¬è½®äºä»¶å¾ªç¯çæ«å°¾æ§è¡ï¼æ»æ¯æäºæ¬è½®å¾ªç¯çåæ­¥ä»»å¡ã\n\nä¸è¬æ¥è¯´ï¼è°ç¨resolveærejectä»¥åï¼promise çä½¿å½å°±å®æäºï¼åç»§æä½åºè¯¥æ¾å°thenæ¹æ³éé¢ï¼èä¸åºè¯¥ç´æ¥åå¨resolveærejectçåé¢ãæä»¥ï¼æå¥½å¨å®ä»¬åé¢å ä¸returnè¯­å¥ï¼è¿æ ·å°±ä¸ä¼ææå¤ã\n\nnew promise((resolve, reject) => {\n  return resolve(1);\n  // åé¢çè¯­å¥ä¸ä¼æ§è¡\n  console.log(2);\n})\n\n\n1\n2\n3\n4\n5\n\n\n\n# promise.prototype.then()\n\npromise å®ä¾å·æthenæ¹æ³ï¼ä¹å°±æ¯è¯´ï¼thenæ¹æ³æ¯å®ä¹å¨ååå¯¹è±¡promise.prototypeä¸çãå®çä½ç¨æ¯ä¸º promise å®ä¾æ·»å ç¶ææ¹åæ¶çåè°å½æ°ãåé¢è¯´è¿ï¼thenæ¹æ³çç¬¬ä¸ä¸ªåæ°æ¯resolvedç¶æçåè°å½æ°ï¼ç¬¬äºä¸ªåæ°ï¼å¯éï¼æ¯rejectedç¶æçåè°å½æ°ã\n\nthenæ¹æ³è¿åçæ¯ä¸ä¸ªæ°çpromiseå®ä¾ï¼æ³¨æï¼ä¸æ¯åæ¥é£ä¸ªpromiseå®ä¾ï¼ãå æ­¤å¯ä»¥éç¨é¾å¼åæ³ï¼å³thenæ¹æ³åé¢åè°ç¨å¦ä¸ä¸ªthenæ¹æ³ã\n\ngetjson(\"/posts.json\").then(function(json) {\n  return json.post;\n}).then(function(post) { // è¿éçpostæ¯åé¢ä¸ä¸ªthenè¿åçåæ°\n  // ...\n});\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çä»£ç ä½¿ç¨thenæ¹æ³ï¼ä¾æ¬¡æå®äºä¸¤ä¸ªåè°å½æ°ãç¬¬ä¸ä¸ªåè°å½æ°å®æä»¥åï¼ä¼å°è¿åç»æä½ä¸ºåæ°ï¼ä¼ å¥ç¬¬äºä¸ªåè°å½æ°ã\n\néç¨é¾å¼çthenï¼å¯ä»¥æå®ä¸ç»æç§æ¬¡åºè°ç¨çåè°å½æ°ãè¿æ¶ï¼åä¸ä¸ªåè°å½æ°ï¼æå¯è½è¿åçè¿æ¯ä¸ä¸ªpromiseå¯¹è±¡ï¼å³æå¼æ­¥æä½ï¼ï¼è¿æ¶åä¸ä¸ªåè°å½æ°ï¼å°±ä¼ç­å¾è¯¥promiseå¯¹è±¡çç¶æåçååï¼æä¼è¢«è°ç¨ã\n\ngetjson(\"/post/1.json\").then(function(post) {\n  return getjson(post.commenturl);\n}).then(function (comments) {\n  console.log(\"resolved: \", comments);\n}, function (err){\n  console.log(\"rejected: \", err);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬ä¸ä¸ªthenæ¹æ³æå®çåè°å½æ°ï¼è¿åçæ¯å¦ä¸ä¸ªpromiseå¯¹è±¡ãè¿æ¶ï¼ç¬¬äºä¸ªthenæ¹æ³æå®çåè°å½æ°ï¼å°±ä¼ç­å¾è¿ä¸ªæ°çpromiseå¯¹è±¡ç¶æåçååãå¦æåä¸ºresolvedï¼å°±è°ç¨ç¬¬ä¸ä¸ªåè°å½æ°ï¼å¦æç¶æåä¸ºrejectedï¼å°±è°ç¨ç¬¬äºä¸ªåè°å½æ°ã\n\nå¦æéç¨ç®­å¤´å½æ°ï¼ä¸é¢çä»£ç å¯ä»¥åå¾æ´ç®æ´ã\n\ngetjson(\"/post/1.json\").then(\n  post => getjson(post.commenturl)\n).then(\n  comments => console.log(\"resolved: \", comments),\n  err => console.log(\"rejected: \", err)\n);\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n# promise.prototype.catch()\n\npromise.prototype.catchæ¹æ³æ¯.then(null, rejection)æ.then(undefined, rejection)çå«åï¼ç¨äºæå®åçéè¯¯æ¶çåè°å½æ°ã\n\ngetjson('/posts.json').then(function(posts) {\n  // ...\n}).catch(function(error) {\n  // å¤ç getjson å åä¸ä¸ªåè°å½æ°è¿è¡æ¶åççéè¯¯\n  console.log('åçéè¯¯ï¼', error);\n});\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼getjsonæ¹æ³è¿åä¸ä¸ª promise å¯¹è±¡ï¼å¦æè¯¥å¯¹è±¡ç¶æåä¸ºresolvedï¼åä¼è°ç¨thenæ¹æ³æå®çåè°å½æ°ï¼å¦æå¼æ­¥æä½æåºéè¯¯ï¼ç¶æå°±ä¼åä¸ºrejectedï¼å°±ä¼è°ç¨catchæ¹æ³æå®çåè°å½æ°ï¼å¤çè¿ä¸ªéè¯¯ãå¦å¤ï¼thenæ¹æ³æå®çåè°å½æ°ï¼å¦æè¿è¡ä¸­æåºéè¯¯ï¼ä¹ä¼è¢«catchæ¹æ³æè·ã\n\np.then((val) => console.log('fulfilled:', val))\n  .catch((err) => console.log('rejected', err));\n\n// ç­åäº\np.then((val) => console.log('fulfilled:', val))\n  .then(null, (err) => console.log(\"rejected:\", err));\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nconst promise = new promise(function(resolve, reject) {\n  throw new error('test');\n});\npromise.catch(function(error) {\n  console.log(error);\n});\n// error: test\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼promiseæåºä¸ä¸ªéè¯¯ï¼å°±è¢«catchæ¹æ³æå®çåè°å½æ°æè·ãæ³¨æï¼ä¸é¢çåæ³ä¸ä¸é¢ä¸¤ç§åæ³æ¯ç­ä»·çã\n\n// åæ³ä¸\nconst promise = new promise(function(resolve, reject) {\n  try {\n    throw new error('test');\n  } catch(e) {\n    reject(e);\n  }\n});\npromise.catch(function(error) {\n  console.log(error);\n});\n\n// åæ³äº\nconst promise = new promise(function(resolve, reject) {\n  reject(new error('test'));\n});\npromise.catch(function(error) {\n  console.log(error);\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\næ¯è¾ä¸é¢ä¸¤ç§åæ³ï¼å¯ä»¥åç°rejectæ¹æ³çä½ç¨ï¼ç­åäºæåºéè¯¯ã\n\nå¦æ promise ç¶æå·²ç»åæresolvedï¼åæåºéè¯¯æ¯æ æçã\n\nconst promise = new promise(function(resolve, reject) {\n  resolve('ok');\n  throw new error('test');\n});\npromise\n  .then(function(value) { console.log(value) })\n  .catch(function(error) { console.log(error) });\n// ok\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç ä¸­ï¼promise å¨resolveè¯­å¥åé¢ï¼åæåºéè¯¯ï¼ä¸ä¼è¢«æè·ï¼ç­äºæ²¡ææåºãå ä¸º promise çç¶æä¸æ¦æ¹åï¼å°±æ°¸ä¹ä¿æè¯¥ç¶æï¼ä¸ä¼ååäºã\n\npromise å¯¹è±¡çéè¯¯å·æâåæ³¡âæ§è´¨ï¼ä¼ä¸ç´ååä¼ éï¼ç´å°è¢«æè·ä¸ºæ­¢ãä¹å°±æ¯è¯´ï¼éè¯¯æ»æ¯ä¼è¢«ä¸ä¸ä¸ªcatchè¯­å¥æè·ã\n\ngetjson('/post/1.json').then(function(post) {\n  return getjson(post.commenturl);\n}).then(function(comments) {\n  // some code\n}).catch(function(error) {\n  // å¤çåé¢ä¸ä¸ªpromiseäº§ççéè¯¯\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸å±æä¸ä¸ª promise å¯¹è±¡ï¼ä¸ä¸ªç±getjsonäº§çï¼ä¸¤ä¸ªç±thenäº§çãå®ä»¬ä¹ä¸­ä»»ä½ä¸ä¸ªæåºçéè¯¯ï¼é½ä¼è¢«æåä¸ä¸ªcatchæè·ã\n\nä¸è¬æ¥è¯´ï¼ä¸è¦å¨thenæ¹æ³éé¢å®ä¹ reject ç¶æçåè°å½æ°ï¼å³thençç¬¬äºä¸ªåæ°ï¼ï¼æ»æ¯ä½¿ç¨catchæ¹æ³ã\n\n// bad\npromise\n  .then(function(data) {\n    // success\n  }, function(err) {\n    // error\n  });\n\n// good\npromise\n  .then(function(data) { //cb\n    // success\n  })\n  .catch(function(err) {\n    // error\n  });\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬äºç§åæ³è¦å¥½äºç¬¬ä¸ç§åæ³ï¼çç±æ¯ç¬¬äºç§åæ³å¯ä»¥æè·åé¢thenæ¹æ³æ§è¡ä¸­çéè¯¯ï¼ä¹æ´æ¥è¿åæ­¥çåæ³ï¼try/catchï¼ãå æ­¤ï¼å»ºè®®æ»æ¯ä½¿ç¨catchæ¹æ³ï¼èä¸ä½¿ç¨thenæ¹æ³çç¬¬äºä¸ªåæ°ã\n\nè·ä¼ ç»çtry/catchä»£ç åä¸åçæ¯ï¼å¦ææ²¡æä½¿ç¨catchæ¹æ³æå®éè¯¯å¤ççåè°å½æ°ï¼promise å¯¹è±¡æåºçéè¯¯ä¸ä¼ä¼ éå°å¤å±ä»£ç ï¼å³ä¸ä¼æä»»ä½ååºã\n\nconst someasyncthing = function() {\n  return new promise(function(resolve, reject) {\n    // ä¸é¢ä¸è¡ä¼æ¥éï¼å ä¸ºxæ²¡æå£°æ\n    resolve(x + 2);\n  });\n};\n\nsomeasyncthing().then(function() {\n  console.log('everything is great');\n});\n\nsettimeout(() => { console.log(123) }, 2000);\n// uncaught (in promise) referenceerror: x is not defined // æ¥éå´ä¸éåºè¿ç¨\n// 123\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä¸é¢ä»£ç ä¸­ï¼someasyncthingå½æ°äº§çç promise å¯¹è±¡ï¼åé¨æè¯­æ³éè¯¯ãæµè§å¨è¿è¡å°è¿ä¸è¡ï¼ä¼æå°åºéè¯¯æç¤ºreferenceerror: x is not definedï¼ä½æ¯ä¸ä¼éåºè¿ç¨ãç»æ­¢èæ¬æ§è¡ï¼2 ç§ä¹åè¿æ¯ä¼è¾åº123ãè¿å°±æ¯è¯´ï¼promise åé¨çéè¯¯ä¸ä¼å½±åå° promise å¤é¨çä»£ç ï¼éä¿çè¯´æ³å°±æ¯âpromise ä¼åæéè¯¯âã\n\nè¿ä¸ªèæ¬æ¾å¨æå¡å¨æ§è¡ï¼éåºç å°±æ¯0ï¼å³è¡¨ç¤ºæ§è¡æåï¼ãä¸è¿ï¼node æä¸ä¸ªunhandledrejectionäºä»¶ï¼ä¸é¨çå¬æªæè·çrejectéè¯¯ï¼ä¸é¢çèæ¬ä¼è§¦åè¿ä¸ªäºä»¶ççå¬å½æ°ï¼å¯ä»¥å¨çå¬å½æ°éé¢æåºéè¯¯ã\n\nprocess.on('unhandledrejection', function (err, p) {\n  throw err;\n});\n\n\n1\n2\n3\n\n\nä¸é¢ä»£ç ä¸­ï¼unhandledrejectionäºä»¶ççå¬å½æ°æä¸¤ä¸ªåæ°ï¼ç¬¬ä¸ä¸ªæ¯éè¯¯å¯¹è±¡ï¼ç¬¬äºä¸ªæ¯æ¥éç promise å®ä¾ï¼å®å¯ä»¥ç¨æ¥äºè§£åçéè¯¯çç¯å¢ä¿¡æ¯ã\n\næ³¨æï¼node æè®¡åå¨æªæ¥åºé¤unhandledrejectionäºä»¶ãå¦æ promise åé¨ææªæè·çéè¯¯ï¼ä¼ç´æ¥ç»æ­¢è¿ç¨ï¼å¹¶ä¸è¿ç¨çéåºç ä¸ä¸º 0ã\n\nåçä¸é¢çä¾å­ã\n\nconst promise = new promise(function (resolve, reject) {\n  resolve('ok');\n  settimeout(function () { throw new error('test') }, 0)\n});\npromise.then(function (value) { console.log(value) });\n// ok\n// uncaught error: test\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼promise æå®å¨ä¸ä¸è½®âäºä»¶å¾ªç¯âåæåºéè¯¯ãå°äºé£ä¸ªæ¶åï¼promise çè¿è¡å·²ç»ç»æäºï¼æä»¥è¿ä¸ªéè¯¯æ¯å¨ promise å½æ°ä½å¤æåºçï¼ä¼åæ³¡å°æå¤å±ï¼æäºæªæè·çéè¯¯ã\n\nä¸è¬æ»æ¯å»ºè®®ï¼promise å¯¹è±¡åé¢è¦è·catchæ¹æ³ï¼è¿æ ·å¯ä»¥å¤ç promise åé¨åççéè¯¯ãcatchæ¹æ³è¿åçè¿æ¯ä¸ä¸ª promise å¯¹è±¡ï¼å æ­¤åé¢è¿å¯ä»¥æ¥çè°ç¨thenæ¹æ³ã\n\nconst someasyncthing = function() {\n  return new promise(function(resolve, reject) {\n    // ä¸é¢ä¸è¡ä¼æ¥éï¼å ä¸ºxæ²¡æå£°æ\n    resolve(x + 2);\n  });\n};\n\nsomeasyncthing()\n.catch(function(error) {\n  console.log('oh no', error);\n})\n.then(function() {\n  console.log('carry on');\n});\n// oh no [referenceerror: x is not defined]\n// carry on\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç è¿è¡å®catchæ¹æ³æå®çåè°å½æ°ï¼ä¼æ¥çè¿è¡åé¢é£ä¸ªthenæ¹æ³æå®çåè°å½æ°ãå¦ææ²¡ææ¥éï¼åä¼è·³è¿catchæ¹æ³ã\n\npromise.resolve()\n.catch(function(error) {\n  console.log('oh no', error);\n})\n.then(function() {\n  console.log('carry on');\n});\n// carry on\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢çä»£ç å ä¸ºæ²¡ææ¥éï¼è·³è¿äºcatchæ¹æ³ï¼ç´æ¥æ§è¡åé¢çthenæ¹æ³ãæ­¤æ¶ï¼è¦æ¯thenæ¹æ³éé¢æ¥éï¼å°±ä¸åé¢çcatchæ å³äºã\n\ncatchæ¹æ³ä¹ä¸­ï¼è¿è½åæåºéè¯¯ã\n\nconst someasyncthing = function() {\n  return new promise(function(resolve, reject) {\n    // ä¸é¢ä¸è¡ä¼æ¥éï¼å ä¸ºxæ²¡æå£°æ\n    resolve(x + 2);\n  });\n};\n\nsomeasyncthing().then(function() {\n  return someotherasyncthing();\n}).catch(function(error) {\n  console.log('oh no', error);\n  // ä¸é¢ä¸è¡ä¼æ¥éï¼å ä¸º y æ²¡æå£°æ\n  y + 2;\n}).then(function() {\n  console.log('carry on');\n});\n// oh no [referenceerror: x is not defined]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼catchæ¹æ³æåºä¸ä¸ªéè¯¯ï¼å ä¸ºåé¢æ²¡æå«çcatchæ¹æ³äºï¼å¯¼è´è¿ä¸ªéè¯¯ä¸ä¼è¢«æè·ï¼ä¹ä¸ä¼ä¼ éå°å¤å±ãå¦ææ¹åä¸ä¸ï¼ç»æå°±ä¸ä¸æ ·äºã\n\nsomeasyncthing().then(function() {\n  return someotherasyncthing();\n}).catch(function(error) {\n  console.log('oh no', error);\n  // ä¸é¢ä¸è¡ä¼æ¥éï¼å ä¸ºyæ²¡æå£°æ\n  y + 2;\n}).catch(function(error) {\n  console.log('carry on', error);\n});\n// oh no [referenceerror: x is not defined]\n// carry on [referenceerror: y is not defined]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬äºä¸ªcatchæ¹æ³ç¨æ¥æè·åä¸ä¸ªcatchæ¹æ³æåºçéè¯¯ã\n\n\n# promise.prototype.finally()\n\nfinallyæ¹æ³ç¨äºæå®ä¸ç®¡ promise å¯¹è±¡æåç¶æå¦ä½ï¼é½ä¼æ§è¡çæä½ãè¯¥æ¹æ³æ¯ es2018 å¼å¥æ åçã\n\npromise\n.then(result => {Â·Â·Â·})\n.catch(error => {Â·Â·Â·})\n.finally(() => {Â·Â·Â·});\n\n\n1\n2\n3\n4\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸ç®¡promiseæåçç¶æï¼å¨æ§è¡å®thenæcatchæå®çåè°å½æ°ä»¥åï¼é½ä¼æ§è¡finallyæ¹æ³æå®çåè°å½æ°ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ï¼æå¡å¨ä½¿ç¨ promise å¤çè¯·æ±ï¼ç¶åä½¿ç¨finallyæ¹æ³å³ææå¡å¨ã\n\nserver.listen(port)\n  .then(function () {\n    // ...\n  })\n  .finally(server.stop);\n\n\n1\n2\n3\n4\n5\n\n\nfinallyæ¹æ³çåè°å½æ°ä¸æ¥åä»»ä½åæ°ï¼è¿æå³çæ²¡æåæ³ç¥éï¼åé¢ç promise ç¶æå°åºæ¯fulfilledè¿æ¯rejectedãè¿è¡¨æï¼finallyæ¹æ³éé¢çæä½ï¼åºè¯¥æ¯ä¸ç¶ææ å³çï¼ä¸ä¾èµäº promise çæ§è¡ç»æã\n\nfinallyæ¬è´¨ä¸æ¯thenæ¹æ³çç¹ä¾ã\n\npromise\n.finally(() => {\n  // è¯­å¥\n});\n\n// ç­åäº\npromise\n.then(\n  result => {\n    // è¯­å¥\n    return result;\n  },\n  error => {\n    // è¯­å¥\n    throw error;\n  }\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æä¸ä½¿ç¨finallyæ¹æ³ï¼åæ ·çè¯­å¥éè¦ä¸ºæååå¤±è´¥ä¸¤ç§æåµååä¸æ¬¡ãæäºfinallyæ¹æ³ï¼ååªéè¦åä¸æ¬¡ã\n\nå®çå®ç°ä¹å¾ç®åã\n\npromise.prototype.finally = function (callback) {\n  let p = this.constructor;\n  return this.then(\n    value  => p.resolve(callback()).then(() => value),\n    reason => p.resolve(callback()).then(() => { throw reason })\n  );\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼ä¸ç®¡åé¢ç promise æ¯fulfilledè¿æ¯rejectedï¼é½ä¼æ§è¡åè°å½æ°callbackã\n\nä»ä¸é¢çå®ç°è¿å¯ä»¥çå°ï¼finallyæ¹æ³æ»æ¯ä¼è¿ååæ¥çå¼ã\n\n// resolve çå¼æ¯ undefined\npromise.resolve(2).then(() => {}, () => {})\n\n// resolve çå¼æ¯ 2\npromise.resolve(2).finally(() => {})\n\n// reject çå¼æ¯ undefined\npromise.reject(3).then(() => {}, () => {})\n\n// reject çå¼æ¯ 3\npromise.reject(3).finally(() => {})\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# promise.all()\n\npromise.all()æ¹æ³ç¨äºå°å¤ä¸ª promise å®ä¾ï¼åè£æä¸ä¸ªæ°ç promise å®ä¾ã\n\nconst p = promise.all([p1, p2, p3]);\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼promise.all()æ¹æ³æ¥åä¸ä¸ªæ°ç»ä½ä¸ºåæ°ï¼p1ãp2ãp3é½æ¯ promise å®ä¾ï¼å¦æä¸æ¯ï¼å°±ä¼åè°ç¨ä¸é¢è®²å°çpromise.resolveæ¹æ³ï¼å°åæ°è½¬ä¸º promise å®ä¾ï¼åè¿ä¸æ­¥å¤çãå¦å¤ï¼promise.all()æ¹æ³çåæ°å¯ä»¥ä¸æ¯æ°ç»ï¼ä½å¿é¡»å·æ iterator æ¥å£ï¼ä¸è¿åçæ¯ä¸ªæåé½æ¯ promise å®ä¾ã\n\npçç¶æç±p1ãp2ãp3å³å®ï¼åæä¸¤ç§æåµã\n\nï¼1ï¼åªæp1ãp2ãp3çç¶æé½åæfulfilledï¼pçç¶ææä¼åæfulfilledï¼æ­¤æ¶p1ãp2ãp3çè¿åå¼ç»æä¸ä¸ªæ°ç»ï¼ä¼ éç»pçåè°å½æ°ã\n\nï¼2ï¼åªè¦p1ãp2ãp3ä¹ä¸­æä¸ä¸ªè¢«rejectedï¼pçç¶æå°±åærejectedï¼æ­¤æ¶ç¬¬ä¸ä¸ªè¢«rejectçå®ä¾çè¿åå¼ï¼ä¼ä¼ éç»pçåè°å½æ°ã\n\nä¸é¢æ¯ä¸ä¸ªå·ä½çä¾å­ã\n\n// çæä¸ä¸ªpromiseå¯¹è±¡çæ°ç»\nconst promises = [2, 3, 5, 7, 11, 13].map(function (id) {\n  return getjson('/post/' + id + \".json\");\n});\n\npromise.all(promises).then(function (posts) {\n  // ...\n}).catch(function(reason){\n  // ...\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼promisesæ¯åå« 6 ä¸ª promise å®ä¾çæ°ç»ï¼åªæè¿ 6 ä¸ªå®ä¾çç¶æé½åæfulfilledï¼æèå¶ä¸­æä¸ä¸ªåä¸ºrejectedï¼æä¼è°ç¨promise.allæ¹æ³åé¢çåè°å½æ°ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¾å­ã\n\nconst databasepromise = connectdatabase();\n\nconst bookspromise = databasepromise\n  .then(findallbooks);\n\nconst userpromise = databasepromise\n  .then(getcurrentuser);\n\npromise.all([\n  bookspromise,\n  userpromise\n])\n.then(([books, user]) => picktoprecommendations(books, user));\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼bookspromiseåuserpromiseæ¯ä¸¤ä¸ªå¼æ­¥æä½ï¼åªæç­å°å®ä»¬çç»æé½è¿åäºï¼æä¼è§¦åpicktoprecommendationsè¿ä¸ªåè°å½æ°ã\n\næ³¨æï¼å¦æä½ä¸ºåæ°ç promise å®ä¾ï¼èªå·±å®ä¹äºcatchæ¹æ³ï¼é£ä¹å®ä¸æ¦è¢«rejectedï¼å¹¶ä¸ä¼è§¦åpromise.all()çcatchæ¹æ³ã\n\nconst p1 = new promise((resolve, reject) => {\n  resolve('hello');\n})\n.then(result => result)\n.catch(e => e);\n\nconst p2 = new promise((resolve, reject) => {\n  throw new error('æ¥éäº');\n})\n.then(result => result)\n.catch(e => e);\n\npromise.all([p1, p2])\n.then(result => console.log(result))\n.catch(e => console.log(e));\n// [\"hello\", error: æ¥éäº]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç ä¸­ï¼p1ä¼resolvedï¼p2é¦åä¼rejectedï¼ä½æ¯p2æèªå·±çcatchæ¹æ³ï¼è¯¥æ¹æ³è¿åçæ¯ä¸ä¸ªæ°ç promise å®ä¾ï¼p2æåçå®éä¸æ¯è¿ä¸ªå®ä¾ãè¯¥å®ä¾æ§è¡å®catchæ¹æ³åï¼ä¹ä¼åæresolvedï¼å¯¼è´promise.all()æ¹æ³åæ°éé¢çä¸¤ä¸ªå®ä¾é½ä¼resolvedï¼å æ­¤ä¼è°ç¨thenæ¹æ³æå®çåè°å½æ°ï¼èä¸ä¼è°ç¨catchæ¹æ³æå®çåè°å½æ°ã\n\nå¦æp2æ²¡æèªå·±çcatchæ¹æ³ï¼å°±ä¼è°ç¨promise.all()çcatchæ¹æ³ã\n\nconst p1 = new promise((resolve, reject) => {\n  resolve('hello');\n})\n.then(result => result);\n\nconst p2 = new promise((resolve, reject) => {\n  throw new error('æ¥éäº');\n})\n.then(result => result);\n\npromise.all([p1, p2])\n.then(result => console.log(result))\n.catch(e => console.log(e));\n// error: æ¥éäº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n# promise.race()\n\npromise.race()æ¹æ³åæ ·æ¯å°å¤ä¸ª promise å®ä¾ï¼åè£æä¸ä¸ªæ°ç promise å®ä¾ã\n\nconst p = promise.race([p1, p2, p3]);\n\n\n1\n\n\nä¸é¢ä»£ç ä¸­ï¼åªè¦p1ãp2ãp3ä¹ä¸­æä¸ä¸ªå®ä¾çåæ¹åç¶æï¼pçç¶æå°±è·çæ¹åãé£ä¸ªçåæ¹åç promise å®ä¾çè¿åå¼ï¼å°±ä¼ éç»pçåè°å½æ°ã\n\npromise.race()æ¹æ³çåæ°ä¸promise.all()æ¹æ³ä¸æ ·ï¼å¦æä¸æ¯ promise å®ä¾ï¼å°±ä¼åè°ç¨ä¸é¢è®²å°çpromise.resolve()æ¹æ³ï¼å°åæ°è½¬ä¸º promise å®ä¾ï¼åè¿ä¸æ­¥å¤çã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ï¼å¦ææå®æ¶é´åæ²¡æè·å¾ç»æï¼å°±å° promise çç¶æåä¸ºrejectï¼å¦ååä¸ºresolveã\n\nconst p = promise.race([\n  fetch('/resource-that-may-take-a-while'),\n  new promise(function (resolve, reject) {\n    settimeout(() => reject(new error('request timeout')), 5000)\n  })\n]);\n\np\n.then(console.log)\n.catch(console.error);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼å¦æ 5 ç§ä¹åfetchæ¹æ³æ æ³è¿åç»æï¼åépçç¶æå°±ä¼åä¸ºrejectedï¼ä»èè§¦åcatchæ¹æ³æå®çåè°å½æ°ã\n\n\n# promise.allsettled()\n\npromise.allsettled()æ¹æ³æ¥åä¸ç» promise å®ä¾ä½ä¸ºåæ°ï¼åè£æä¸ä¸ªæ°ç promise å®ä¾ãåªæç­å°ææè¿äºåæ°å®ä¾é½è¿åç»æï¼ä¸ç®¡æ¯fulfilledè¿æ¯rejectedï¼åè£å®ä¾æä¼ç»æãè¯¥æ¹æ³ç± es2020 å¼å¥ã\n\nconst promises = [\n  fetch('/api-1'),\n  fetch('/api-2'),\n  fetch('/api-3'),\n];\n\nawait promise.allsettled(promises);\nremoveloadingindicator();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç å¯¹æå¡å¨ååºä¸ä¸ªè¯·æ±ï¼ç­å°ä¸ä¸ªè¯·æ±é½ç»æï¼ä¸ç®¡è¯·æ±æåè¿æ¯å¤±è´¥ï¼å è½½çæ»å¨å¾æ å°±ä¼æ¶å¤±ã\n\n**è¯¥æ¹æ³è¿åçæ°ç promise å®ä¾ï¼ä¸æ¦ç»æï¼ç¶ææ»æ¯fulfilledï¼ä¸ä¼åærejectedã**ç¶æåæfulfilledåï¼promise ççå¬å½æ°æ¥æ¶å°çåæ°æ¯ä¸ä¸ªæ°ç»ï¼æ¯ä¸ªæåå¯¹åºä¸ä¸ªä¼ å¥promise.allsettled()ç promise å®ä¾ã\n\nconst resolved = promise.resolve(42);\nconst rejected = promise.reject(-1);\n\nconst allsettledpromise = promise.allsettled([resolved, rejected]);\n\nallsettledpromise.then(function (results) {\n  console.log(results);\n});\n// [\n//    { status: 'fulfilled', value: 42 },\n//    { status: 'rejected', reason: -1 }\n// ]\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼promise.allsettled()çè¿åå¼allsettledpromiseï¼ç¶æåªå¯è½åæfulfilledãå®ççå¬å½æ°æ¥æ¶å°çåæ°æ¯æ°ç»resultsãè¯¥æ°ç»çæ¯ä¸ªæåé½æ¯ä¸ä¸ªå¯¹è±¡ï¼å¯¹åºä¼ å¥promise.allsettled()çä¸¤ä¸ª promise å®ä¾ãæ¯ä¸ªå¯¹è±¡é½æstatuså±æ§ï¼è¯¥å±æ§çå¼åªå¯è½æ¯å­ç¬¦ä¸²fulfilledæå­ç¬¦ä¸²rejectedãfulfilledæ¶ï¼å¯¹è±¡ævalueå±æ§ï¼rejectedæ¶æreasonå±æ§ï¼å¯¹åºä¸¤ç§ç¶æçè¿åå¼ã\n\nä¸é¢æ¯è¿åå¼ç¨æ³çä¾å­ã\n\nconst promises = [ fetch('index.html'), fetch('https://does-not-exist/') ];\nconst results = await promise.allsettled(promises);\n\n// è¿æ»¤åºæåçè¯·æ±\nconst successfulpromises = results.filter(p => p.status === 'fulfilled');\n\n// è¿æ»¤åºå¤±è´¥çè¯·æ±ï¼å¹¶è¾åºåå \nconst errors = results\n  .filter(p => p.status === 'rejected')\n  .map(p => p.reason);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nææ¶åï¼æä»¬ä¸å³å¿å¼æ­¥æä½çç»æï¼åªå³å¿è¿äºæä½ææ²¡æç»æãè¿æ¶ï¼promise.allsettled()æ¹æ³å°±å¾æç¨ãå¦ææ²¡æè¿ä¸ªæ¹æ³ï¼æ³è¦ç¡®ä¿æææä½é½ç»æï¼å°±å¾éº»ç¦ãpromise.all()æ¹æ³æ æ³åå°è¿ä¸ç¹ã\n\nconst urls = [ /* ... */ ];\nconst requests = urls.map(x => fetch(x));\n\ntry {\n  await promise.all(requests);\n  console.log('ææè¯·æ±é½æåã');\n} catch {\n  console.log('è³å°ä¸ä¸ªè¯·æ±å¤±è´¥ï¼å¶ä»è¯·æ±å¯è½è¿æ²¡ç»æã');\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼promise.all()æ æ³ç¡®å®ææè¯·æ±é½ç»æãæ³è¦è¾¾å°è¿ä¸ªç®çï¼åèµ·æ¥å¾éº»ç¦ï¼æäºpromise.allsettled()ï¼è¿å°±å¾å®¹æäºã\n\n\n# promise.any()\n\n**promise.any()æ¹æ³æ¥åä¸ç» promise å®ä¾ä½ä¸ºåæ°ï¼åè£æä¸ä¸ªæ°ç promise å®ä¾ãåªè¦åæ°å®ä¾æä¸ä¸ªåæfulfilledç¶æï¼åè£å®ä¾å°±ä¼åæfulfilledç¶æï¼å¦æææåæ°å®ä¾é½åærejectedç¶æï¼åè£å®ä¾å°±ä¼åærejectedç¶æã**è¯¥æ¹æ³ç®åæ¯ä¸ä¸ªç¬¬ä¸é¶æ®µçææ¡ ã\n\npromise.any()è·promise.race()æ¹æ³å¾åï¼åªæä¸ç¹ä¸åï¼å°±æ¯ä¸ä¼å ä¸ºæä¸ª promise åærejectedç¶æèç»æã\n\nconst promises = [\n  fetch('/endpoint-a').then(() => 'a'),\n  fetch('/endpoint-b').then(() => 'b'),\n  fetch('/endpoint-c').then(() => 'c'),\n];\ntry {\n  const first = await promise.any(promises);\n  console.log(first);\n} catch (error) {\n  console.log(error);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼promise.any()æ¹æ³çåæ°æ°ç»åå«ä¸ä¸ª promise æä½ãå¶ä¸­åªè¦æä¸ä¸ªåæfulfilledï¼promise.any()è¿åç promise å¯¹è±¡å°±åæfulfilledãå¦æææä¸ä¸ªæä½é½åærejectedï¼é£ä¹å°±ä¼awaitå½ä»¤å°±ä¼æåºéè¯¯ã\n\npromise.any()æåºçéè¯¯ï¼ä¸æ¯ä¸ä¸ªä¸è¬çéè¯¯ï¼èæ¯ä¸ä¸ª aggregateerror å®ä¾ãå®ç¸å½äºä¸ä¸ªæ°ç»ï¼æ¯ä¸ªæåå¯¹åºä¸ä¸ªè¢«rejectedçæä½ææåºçéè¯¯ãä¸é¢æ¯ aggregateerror çå®ç°ç¤ºä¾ã\n\nnew aggregateerror() extends array -> aggregateerror\n\nconst err = new aggregateerror();\nerr.push(new error(\"first error\"));\nerr.push(new error(\"second error\"));\nthrow err;\n\n\n1\n2\n3\n4\n5\n6\n\n\nææéè¯¯æ¶ï¼å¦æä¸ç¨try...catchç»æå await å½ä»¤ï¼å¯ä»¥åä¸é¢è¿æ ·åã\n\npromise.any(promises).then(\n  (first) => {\n    // any of the promises was fulfilled.\n  },\n  (error) => {\n    // all of the promises were rejected.\n  }\n);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nvar resolved = promise.resolve(42);\nvar rejected = promise.reject(-1);\nvar alsorejected = promise.reject(infinity);\n\npromise.any([resolved, rejected, alsorejected]).then(function (result) {\n  console.log(result); // 42\n});\n\npromise.any([rejected, alsorejected]).catch(function (results) {\n  console.log(results); // [-1, infinity]\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# promise.resolve()\n\nææ¶éè¦å°ç°æå¯¹è±¡è½¬ä¸º promise å¯¹è±¡ï¼promise.resolve()æ¹æ³å°±èµ·å°è¿ä¸ªä½ç¨ã\n\nconst jspromise = promise.resolve($.ajax('/whatever.json'));\n\n\n1\n\n\nä¸é¢ä»£ç å° jquery çæçdeferredå¯¹è±¡ï¼è½¬ä¸ºä¸ä¸ªæ°ç promise å¯¹è±¡ã\n\npromise.resolve()ç­ä»·äºä¸é¢çåæ³ã\n\npromise.resolve('foo')\n// ç­ä»·äº\nnew promise(resolve => resolve('foo'))\n\n\n1\n2\n3\n\n\npromise.resolveæ¹æ³çåæ°åæåç§æåµã\n\nï¼1ï¼åæ°æ¯ä¸ä¸ª promise å®ä¾\n\nå¦æåæ°æ¯ promise å®ä¾ï¼é£ä¹promise.resolveå°ä¸åä»»ä½ä¿®æ¹ãåå°ä¸å¨å°è¿åè¿ä¸ªå®ä¾ã\n\nï¼2ï¼åæ°æ¯ä¸ä¸ªthenableå¯¹è±¡\n\nthenableå¯¹è±¡æçæ¯å·æthenæ¹æ³çå¯¹è±¡ï¼æ¯å¦ä¸é¢è¿ä¸ªå¯¹è±¡ã\n\nlet thenable = {\n  then: function(resolve, reject) {\n    resolve(42);\n  }\n};\n\n\n1\n2\n3\n4\n5\n\n\npromise.resolveæ¹æ³ä¼å°è¿ä¸ªå¯¹è±¡è½¬ä¸º promise å¯¹è±¡ï¼ç¶åå°±ç«å³æ§è¡thenableå¯¹è±¡çthenæ¹æ³ã\n\nlet thenable = {\n  then: function(resolve, reject) {\n    resolve(42);\n  }\n};\n\nlet p1 = promise.resolve(thenable);\np1.then(function(value) {\n  console.log(value);  // 42\n});\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼thenableå¯¹è±¡çthenæ¹æ³æ§è¡åï¼å¯¹è±¡p1çç¶æå°±åä¸ºresolvedï¼ä»èç«å³æ§è¡æåé£ä¸ªthenæ¹æ³æå®çåè°å½æ°ï¼è¾åº 42ã\n\nï¼3ï¼åæ°ä¸æ¯å·æthenæ¹æ³çå¯¹è±¡ï¼ææ ¹æ¬å°±ä¸æ¯å¯¹è±¡\n\nå¦æåæ°æ¯ä¸ä¸ªåå§å¼ï¼æèæ¯ä¸ä¸ªä¸å·æthenæ¹æ³çå¯¹è±¡ï¼åpromise.resolveæ¹æ³è¿åä¸ä¸ªæ°ç promise å¯¹è±¡ï¼ç¶æä¸ºresolvedã\n\nconst p = promise.resolve('hello');\n\np.then(function (s){\n  console.log(s)\n});\n// hello\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç çæä¸ä¸ªæ°ç promise å¯¹è±¡çå®ä¾pãç±äºå­ç¬¦ä¸²helloä¸å±äºå¼æ­¥æä½ï¼å¤æ­æ¹æ³æ¯å­ç¬¦ä¸²å¯¹è±¡ä¸å·æ then æ¹æ³ï¼ï¼è¿å promise å®ä¾çç¶æä»ä¸çæå°±æ¯resolvedï¼æä»¥åè°å½æ°ä¼ç«å³æ§è¡ãpromise.resolveæ¹æ³çåæ°ï¼ä¼åæ¶ä¼ ç»åè°å½æ°ã\n\nï¼4ï¼ä¸å¸¦æä»»ä½åæ°\n\npromise.resolve()æ¹æ³åè®¸è°ç¨æ¶ä¸å¸¦åæ°ï¼ç´æ¥è¿åä¸ä¸ªresolvedç¶æç promise å¯¹è±¡ã\n\næä»¥ï¼å¦æå¸æå¾å°ä¸ä¸ª promise å¯¹è±¡ï¼æ¯è¾æ¹ä¾¿çæ¹æ³å°±æ¯ç´æ¥è°ç¨promise.resolve()æ¹æ³ã\n\nconst p = promise.resolve();\n\np.then(function () {\n  // ...\n});\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç çåépå°±æ¯ä¸ä¸ª promise å¯¹è±¡ã\n\néè¦æ³¨æçæ¯ï¼ç«å³resolve()ç promise å¯¹è±¡ï¼æ¯å¨æ¬è½®âäºä»¶å¾ªç¯âï¼event loopï¼çç»ææ¶æ§è¡ï¼èä¸æ¯å¨ä¸ä¸è½®âäºä»¶å¾ªç¯âçå¼å§æ¶ã\n\nsettimeout(function () {\n  console.log('three');\n}, 0);\n\npromise.resolve().then(function () {\n  console.log('two');\n});\n\nconsole.log('one');\n\n// one\n// two\n// three\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¸é¢ä»£ç ä¸­ï¼settimeout(fn, 0)å¨ä¸ä¸è½®âäºä»¶å¾ªç¯âå¼å§æ¶æ§è¡ï¼promise.resolve()å¨æ¬è½®âäºä»¶å¾ªç¯âç»ææ¶æ§è¡ï¼console.log('one')åæ¯ç«å³æ§è¡ï¼å æ­¤æåè¾åºã\n\n\n# promise.reject()\n\npromise.reject(reason)æ¹æ³ä¹ä¼è¿åä¸ä¸ªæ°ç promise å®ä¾ï¼è¯¥å®ä¾çç¶æä¸ºrejectedã\n\nconst p = promise.reject('åºéäº');\n// ç­åäº\nconst p = new promise((resolve, reject) => reject('åºéäº'))\n\np.then(null, function (s) {\n  console.log(s)\n});\n// åºéäº\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç çæä¸ä¸ª promise å¯¹è±¡çå®ä¾pï¼ç¶æä¸ºrejectedï¼åè°å½æ°ä¼ç«å³æ§è¡ã\n\næ³¨æï¼promise.reject()æ¹æ³çåæ°ï¼ä¼åå°ä¸å¨å°ä½ä¸ºrejectççç±ï¼åæåç»­æ¹æ³çåæ°ãè¿ä¸ç¹ä¸promise.resolveæ¹æ³ä¸ä¸è´ã\n\nconst thenable = {\n  then(resolve, reject) {\n    reject('åºéäº');\n  }\n};\n\npromise.reject(thenable)\n.catch(e => {\n  console.log(e === thenable)\n})\n// true\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼promise.rejectæ¹æ³çåæ°æ¯ä¸ä¸ªthenableå¯¹è±¡ï¼æ§è¡ä»¥åï¼åé¢catchæ¹æ³çåæ°ä¸æ¯rejectæåºçâåºéäºâè¿ä¸ªå­ç¬¦ä¸²ï¼èæ¯thenableå¯¹è±¡ã\n\n\n# åºç¨\n\n\n# å è½½å¾ç\n\næä»¬å¯ä»¥å°å¾ççå è½½åæä¸ä¸ªpromiseï¼ä¸æ¦å è½½å®æï¼promiseçç¶æå°±åçååã\n\nconst preloadimage = function (path) {\n  return new promise(function (resolve, reject) {\n    const image = new image();\n    image.onload  = resolve;\n    image.onerror = reject;\n    image.src = path;\n  });\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n\n# generator å½æ°ä¸ promise çç»å\n\nä½¿ç¨ generator å½æ°ç®¡çæµç¨ï¼éå°å¼æ­¥æä½çæ¶åï¼éå¸¸è¿åä¸ä¸ªpromiseå¯¹è±¡ã\n\nfunction getfoo () {\n  return new promise(function (resolve, reject){\n    resolve('foo');\n  });\n}\n\nconst g = function* () {\n  try {\n    const foo = yield getfoo();\n    console.log(foo);\n  } catch (e) {\n    console.log(e);\n  }\n};\n\nfunction run (generator) {\n  const it = generator();\n\n  function go(result) {\n    if (result.done) return result.value;\n\n    return result.value.then(function (value) {\n      return go(it.next(value));\n    }, function (error) {\n      return go(it.throw(error));\n    });\n  }\n\n  go(it.next());\n}\n\nrun(g);\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n\n\nä¸é¢ä»£ç ç generator å½æ°gä¹ä¸­ï¼æä¸ä¸ªå¼æ­¥æä½getfooï¼å®è¿åçå°±æ¯ä¸ä¸ªpromiseå¯¹è±¡ãå½æ°runç¨æ¥å¤çè¿ä¸ªpromiseå¯¹è±¡ï¼å¹¶è°ç¨ä¸ä¸ä¸ªnextæ¹æ³ã\n\n\n# promise.try()\n\nå®éå¼åä¸­ï¼ç»å¸¸éå°ä¸ç§æåµï¼ä¸ç¥éæèä¸æ³åºåï¼å½æ°fæ¯åæ­¥å½æ°è¿æ¯å¼æ­¥æä½ï¼ä½æ¯æ³ç¨ promise æ¥å¤çå®ãå ä¸ºè¿æ ·å°±å¯ä»¥ä¸ç®¡fæ¯å¦åå«å¼æ­¥æä½ï¼é½ç¨thenæ¹æ³æå®ä¸ä¸æ­¥æµç¨ï¼ç¨catchæ¹æ³å¤çfæåºçéè¯¯ãä¸è¬å°±ä¼éç¨ä¸é¢çåæ³ã\n\npromise.resolve().then(f)\n\n\n1\n\n\nä¸é¢çåæ³æä¸ä¸ªç¼ºç¹ï¼å°±æ¯å¦æfæ¯åæ­¥å½æ°ï¼é£ä¹å®ä¼å¨æ¬è½®äºä»¶å¾ªç¯çæ«å°¾æ§è¡ã\n\nconst f = () => console.log('now');\npromise.resolve().then(f);\nconsole.log('next');\n// next\n// now\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°fæ¯åæ­¥çï¼ä½æ¯ç¨ promise åè£äºä»¥åï¼å°±åæå¼æ­¥æ§è¡äºã\n\né£ä¹ææ²¡æä¸ç§æ¹æ³ï¼è®©åæ­¥å½æ°åæ­¥æ§è¡ï¼å¼æ­¥å½æ°å¼æ­¥æ§è¡ï¼å¹¶ä¸è®©å®ä»¬å·æç»ä¸ç api å¢ï¼åç­æ¯å¯ä»¥çï¼å¹¶ä¸è¿æä¸¤ç§åæ³ãç¬¬ä¸ç§åæ³æ¯ç¨asyncå½æ°æ¥åã\n\nconst f = () => console.log('now');\n(async () => f())();\nconsole.log('next');\n// now\n// next\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬äºè¡æ¯ä¸ä¸ªç«å³æ§è¡çå¿åå½æ°ï¼ä¼ç«å³æ§è¡éé¢çasyncå½æ°ï¼å æ­¤å¦æfæ¯åæ­¥çï¼å°±ä¼å¾å°åæ­¥çç»æï¼å¦æfæ¯å¼æ­¥çï¼å°±å¯ä»¥ç¨thenæå®ä¸ä¸æ­¥ï¼å°±åä¸é¢çåæ³ã\n\n(async () => f())()\n.then(...)\n\n\n1\n2\n\n\néè¦æ³¨æçæ¯ï¼async () => f()ä¼åæf()æåºçéè¯¯ãæä»¥ï¼å¦ææ³æè·éè¯¯ï¼è¦ä½¿ç¨promise.catchæ¹æ³ã\n\n(async () => f())()\n.then(...)\n.catch(...)\n\n\n1\n2\n3\n\n\nç¬¬äºç§åæ³æ¯ä½¿ç¨new promise()ã\n\nconst f = () => console.log('now');\n(\n  () => new promise(\n    resolve => resolve(f())\n  )\n)();\nconsole.log('next');\n// now\n// next\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¹æ¯ä½¿ç¨ç«å³æ§è¡çå¿åå½æ°ï¼æ§è¡new promise()ãè¿ç§æåµä¸ï¼åæ­¥å½æ°ä¹æ¯åæ­¥æ§è¡çã\n\né´äºè¿æ¯ä¸ä¸ªå¾å¸¸è§çéæ±ï¼æä»¥ç°å¨æä¸ä¸ªææ¡ï¼æä¾promise.tryæ¹æ³æ¿ä»£ä¸é¢çåæ³ã\n\nconst f = () => console.log('now');\npromise.try(f);\nconsole.log('next');\n// now\n// next\n\n\n1\n2\n3\n4\n5\n\n\näºå®ä¸ï¼promise.tryå­å¨å·²ä¹ï¼promise åºbluebirdãqåwhenï¼æ©å°±æä¾äºè¿ä¸ªæ¹æ³ã\n\nç±äºpromise.tryä¸ºæææä½æä¾äºç»ä¸çå¤çæºå¶ï¼æä»¥å¦ææ³ç¨thenæ¹æ³ç®¡çæµç¨ï¼æå¥½é½ç¨promise.tryåè£ä¸ä¸ãè¿æ ·æè®¸å¤å¥½å¤ï¼å¶ä¸­ä¸ç¹å°±æ¯å¯ä»¥æ´å¥½å°ç®¡çå¼å¸¸ã\n\nfunction getusername(userid) {\n  return database.users.get({id: userid})\n  .then(function(user) {\n    return user.name;\n  });\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nä¸é¢ä»£ç ä¸­ï¼database.users.get()è¿åä¸ä¸ª promise å¯¹è±¡ï¼å¦ææåºå¼æ­¥éè¯¯ï¼å¯ä»¥ç¨catchæ¹æ³æè·ï¼å°±åä¸é¢è¿æ ·åã\n\ndatabase.users.get({id: userid})\n.then(...)\n.catch(...)\n\n\n1\n2\n3\n\n\nä½æ¯database.users.get()å¯è½è¿ä¼æåºåæ­¥éè¯¯ï¼æ¯å¦æ°æ®åºè¿æ¥éè¯¯ï¼å·ä½è¦çå®ç°æ¹æ³ï¼ï¼è¿æ¶ä½ å°±ä¸å¾ä¸ç¨try...catchå»æè·ã\n\ntry {\n  database.users.get({id: userid})\n  .then(...)\n  .catch(...)\n} catch (e) {\n  // ...\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢è¿æ ·çåæ³å°±å¾ç¬¨æäºï¼è¿æ¶å°±å¯ä»¥ç»ä¸ç¨promise.catch()æè·ææåæ­¥åå¼æ­¥çéè¯¯ã\n\npromise.try(() => database.users.get({id: userid}))\n  .then(...)\n  .catch(...)\n\n\n1\n2\n3\n\n\näºå®ä¸ï¼promise.tryå°±æ¯æ¨¡ætryä»£ç åï¼å°±åpromise.catchæ¨¡æçæ¯catchä»£ç åã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3},{title:"Iterator å for-of å¾ªç¯",frontmatter:{title:"Iterator å for-of å¾ªç¯",date:"2020-02-09T16:00:29.000Z",permalink:"/pages/48df907ad3570f3d",author:"é®ä¸å³°",categories:["ãES6 æç¨ãç¬è®°"],tags:["ES6"]},regularPath:"/%E3%80%8AES6%20%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0/17.Iterator%20%E5%92%8C%20for-of%20%E5%BE%AA%E7%8E%AF.html",relativePath:"ãES6 æç¨ãç¬è®°/17.Iterator å for-of å¾ªç¯.md",key:"v-584aa1ec",path:"/pages/48df907ad3570f3d/",headers:[{level:2,title:"Iteratorï¼éåå¨ï¼çæ¦å¿µ",slug:"iterator-éåå¨-çæ¦å¿µ",normalizedTitle:"iteratorï¼éåå¨ï¼çæ¦å¿µ",charIndex:29},{level:2,title:"é»è®¤ Iterator æ¥å£",slug:"é»è®¤-iterator-æ¥å£",normalizedTitle:"é»è®¤ iterator æ¥å£",charIndex:2535},{level:2,title:"è°ç¨ Iterator æ¥å£çåºå",slug:"è°ç¨-iterator-æ¥å£çåºå",normalizedTitle:"è°ç¨ iterator æ¥å£çåºå",charIndex:7665},{level:2,title:"å­ç¬¦ä¸²ç Iterator æ¥å£",slug:"å­ç¬¦ä¸²ç-iterator-æ¥å£",normalizedTitle:"å­ç¬¦ä¸²ç iterator æ¥å£",charIndex:8984},{level:2,title:"Iterator æ¥å£ä¸ Generator å½æ°",slug:"iterator-æ¥å£ä¸-generator-å½æ°",normalizedTitle:"iterator æ¥å£ä¸ generator å½æ°",charIndex:9908},{level:2,title:"éåå¨å¯¹è±¡ç return()ï¼throw()",slug:"éåå¨å¯¹è±¡ç-return-throw",normalizedTitle:"éåå¨å¯¹è±¡ç return()ï¼throw()",charIndex:10406},{level:2,title:"for...of å¾ªç¯",slug:"for-of-å¾ªç¯",normalizedTitle:"for...of å¾ªç¯",charIndex:13},{level:3,title:"æ°ç»",slug:"æ°ç»",normalizedTitle:"æ°ç»",charIndex:76},{level:3,title:"Set å Map ç»æ",slug:"set-å-map-ç»æ",normalizedTitle:"set å map ç»æ",charIndex:11619},{level:3,title:"è®¡ç®çæçæ°æ®ç»æ",slug:"è®¡ç®çæçæ°æ®ç»æ",normalizedTitle:"è®¡ç®çæçæ°æ®ç»æ",charIndex:13812},{level:3,title:"ç±»ä¼¼æ°ç»çå¯¹è±¡",slug:"ç±»ä¼¼æ°ç»çå¯¹è±¡",normalizedTitle:"ç±»ä¼¼æ°ç»çå¯¹è±¡",charIndex:6199},{level:3,title:"å¯¹è±¡",slug:"å¯¹è±¡",normalizedTitle:"å¯¹è±¡",charIndex:86},{level:3,title:"ä¸å¶ä»éåè¯­æ³çæ¯è¾",slug:"ä¸å¶ä»éåè¯­æ³çæ¯è¾",normalizedTitle:"ä¸å¶ä»éåè¯­æ³çæ¯è¾",charIndex:15951}],excerpt:'<h1 id="iterator-å-for-of-å¾ªç¯"><a class="header-anchor" href="#iterator-å-for-of-å¾ªç¯">#</a> Iterator å for...of å¾ªç¯</h1>\n<h2 id="iterator-éåå¨-çæ¦å¿µ"><a class="header-anchor" href="#iterator-éåå¨-çæ¦å¿µ">#</a> Iteratorï¼éåå¨ï¼çæ¦å¿µ</h2>\n<p>JavaScript åæçè¡¨ç¤ºâéåâçæ°æ®ç»æï¼ä¸»è¦æ¯æ°ç»ï¼<code>Array</code>ï¼åå¯¹è±¡ï¼<code>Object</code>ï¼ï¼ES6 åæ·»å äº<code>Map</code>å<code>Set</code>ãè¿æ ·å°±æäºåç§æ°æ®éåï¼ç¨æ·è¿å¯ä»¥ç»åä½¿ç¨å®ä»¬ï¼å®ä¹èªå·±çæ°æ®ç»æï¼æ¯å¦æ°ç»çæåæ¯<code>Map</code>ï¼<code>Map</code>çæåæ¯å¯¹è±¡ãè¿æ ·å°±éè¦ä¸ç§ç»ä¸çæ¥å£æºå¶ï¼æ¥å¤çææä¸åçæ°æ®ç»æã</p>\n',headersStr:"Iteratorï¼éåå¨ï¼çæ¦å¿µ é»è®¤ Iterator æ¥å£ è°ç¨ Iterator æ¥å£çåºå å­ç¬¦ä¸²ç Iterator æ¥å£ Iterator æ¥å£ä¸ Generator å½æ° éåå¨å¯¹è±¡ç return()ï¼throw() for...of å¾ªç¯ æ°ç» Set å Map ç»æ è®¡ç®çæçæ°æ®ç»æ ç±»ä¼¼æ°ç»çå¯¹è±¡ å¯¹è±¡ ä¸å¶ä»éåè¯­æ³çæ¯è¾",content:"# Iterator å for...of å¾ªç¯\n\n\n# Iteratorï¼éåå¨ï¼çæ¦å¿µ\n\nJavaScript åæçè¡¨ç¤ºâéåâçæ°æ®ç»æï¼ä¸»è¦æ¯æ°ç»ï¼Arrayï¼åå¯¹è±¡ï¼Objectï¼ï¼ES6 åæ·»å äºMapåSetãè¿æ ·å°±æäºåç§æ°æ®éåï¼ç¨æ·è¿å¯ä»¥ç»åä½¿ç¨å®ä»¬ï¼å®ä¹èªå·±çæ°æ®ç»æï¼æ¯å¦æ°ç»çæåæ¯Mapï¼Mapçæåæ¯å¯¹è±¡ãè¿æ ·å°±éè¦ä¸ç§ç»ä¸çæ¥å£æºå¶ï¼æ¥å¤çææä¸åçæ°æ®ç»æã éåå¨ï¼Iteratorï¼å°±æ¯è¿æ ·ä¸ç§æºå¶ãå®æ¯ä¸ç§æ¥å£ï¼ä¸ºåç§ä¸åçæ°æ®ç»ææä¾ç»ä¸çè®¿é®æºå¶ãä»»ä½æ°æ®ç»æåªè¦é¨ç½² Iterator æ¥å£ï¼å°±å¯ä»¥å®æéåæä½ï¼å³ä¾æ¬¡å¤çè¯¥æ°æ®ç»æçæææåï¼ã\n\nIterator çä½ç¨æä¸ä¸ªï¼ä¸æ¯ä¸ºåç§æ°æ®ç»æï¼æä¾ä¸ä¸ªç»ä¸çãç®ä¾¿çè®¿é®æ¥å£ï¼äºæ¯ä½¿å¾æ°æ®ç»æçæåè½å¤ææç§æ¬¡åºæåï¼ä¸æ¯ ES6 åé äºä¸ç§æ°çéåå½ä»¤for...ofå¾ªç¯ï¼Iterator æ¥å£ä¸»è¦ä¾for...ofæ¶è´¹ã\n\nIterator çéåè¿ç¨æ¯è¿æ ·çã\n\nï¼1ï¼åå»ºä¸ä¸ªæéå¯¹è±¡ï¼æåå½åæ°æ®ç»æçèµ·å§ä½ç½®ãä¹å°±æ¯è¯´ï¼éåå¨å¯¹è±¡æ¬è´¨ä¸ï¼å°±æ¯ä¸ä¸ªæéå¯¹è±¡ã\n\nï¼2ï¼ç¬¬ä¸æ¬¡è°ç¨æéå¯¹è±¡çnextæ¹æ³ï¼å¯ä»¥å°æéæåæ°æ®ç»æçç¬¬ä¸ä¸ªæåã\n\nï¼3ï¼ç¬¬äºæ¬¡è°ç¨æéå¯¹è±¡çnextæ¹æ³ï¼æéå°±æåæ°æ®ç»æçç¬¬äºä¸ªæåã\n\nï¼4ï¼ä¸æ­è°ç¨æéå¯¹è±¡çnextæ¹æ³ï¼ç´å°å®æåæ°æ®ç»æçç»æä½ç½®ã\n\næ¯ä¸æ¬¡è°ç¨nextæ¹æ³ï¼é½ä¼è¿åæ°æ®ç»æçå½åæåçä¿¡æ¯ãå·ä½æ¥è¯´ï¼å°±æ¯è¿åä¸ä¸ªåå«valueådoneä¸¤ä¸ªå±æ§çå¯¹è±¡ãå¶ä¸­ï¼valueå±æ§æ¯å½åæåçå¼ï¼doneå±æ§æ¯ä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºéåæ¯å¦ç»æã\n\nä¸é¢æ¯ä¸ä¸ªæ¨¡ænextæ¹æ³è¿åå¼çä¾å­ã\n\nvar it = makeIterator(['a', 'b']);\n\nit.next() // { value: \"a\", done: false }\nit.next() // { value: \"b\", done: false }\nit.next() // { value: undefined, done: true }\n\nfunction makeIterator(array) {\n  var nextIndex = 0;\n  return {\n    next: function() {\n      return nextIndex < array.length ?\n        {value: array[nextIndex++], done: false} :\n        {value: undefined, done: true};\n    }\n  };\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç å®ä¹äºä¸ä¸ªmakeIteratorå½æ°ï¼å®æ¯ä¸ä¸ªéåå¨çæå½æ°ï¼ä½ç¨å°±æ¯è¿åä¸ä¸ªéåå¨å¯¹è±¡ãå¯¹æ°ç»['a', 'b']æ§è¡è¿ä¸ªå½æ°ï¼å°±ä¼è¿åè¯¥æ°ç»çéåå¨å¯¹è±¡ï¼å³æéå¯¹è±¡ï¼itã\n\næéå¯¹è±¡çnextæ¹æ³ï¼ç¨æ¥ç§»å¨æéãå¼å§æ¶ï¼æéæåæ°ç»çå¼å§ä½ç½®ãç¶åï¼æ¯æ¬¡è°ç¨nextæ¹æ³ï¼æéå°±ä¼æåæ°ç»çä¸ä¸ä¸ªæåãç¬¬ä¸æ¬¡è°ç¨ï¼æåaï¼ç¬¬äºæ¬¡è°ç¨ï¼æåbã\n\nnextæ¹æ³è¿åä¸ä¸ªå¯¹è±¡ï¼è¡¨ç¤ºå½åæ°æ®æåçä¿¡æ¯ãè¿ä¸ªå¯¹è±¡å·ævalueådoneä¸¤ä¸ªå±æ§ï¼valueå±æ§è¿åå½åä½ç½®çæåï¼doneå±æ§æ¯ä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºéåæ¯å¦ç»æï¼å³æ¯å¦è¿æå¿è¦åä¸æ¬¡è°ç¨nextæ¹æ³ã\n\næ»ä¹ï¼è°ç¨æéå¯¹è±¡çnextæ¹æ³ï¼å°±å¯ä»¥éåäºåç»å®çæ°æ®ç»æã\n\nå¯¹äºéåå¨å¯¹è±¡æ¥è¯´ï¼done: falseåvalue: undefinedå±æ§é½æ¯å¯ä»¥çç¥çï¼å æ­¤ä¸é¢çmakeIteratorå½æ°å¯ä»¥ç®åæä¸é¢çå½¢å¼ã\n\nfunction makeIterator(array) {\n  var nextIndex = 0;\n  return {\n    next: function() {\n      return nextIndex < array.length ?\n        {value: array[nextIndex++]} :\n        {done: true};\n    }\n  };\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nç±äº Iterator åªæ¯ææ¥å£è§æ ¼å å°æ°æ®ç»æä¹ä¸ï¼æä»¥ï¼éåå¨ä¸å®æéåçé£ä¸ªæ°æ®ç»æï¼å®éä¸æ¯åå¼çï¼å®å¨å¯ä»¥ååºæ²¡æå¯¹åºæ°æ®ç»æçéåå¨å¯¹è±¡ï¼æèè¯´ç¨éåå¨å¯¹è±¡æ¨¡æåºæ°æ®ç»æãä¸é¢æ¯ä¸ä¸ªæ éè¿è¡çéåå¨å¯¹è±¡çä¾å­ã\n\nvar it = idMaker();\n\nit.next().value // 0\nit.next().value // 1\nit.next().value // 2\n// ...\n\nfunction idMaker() {\n  var index = 0;\n\n  return {\n    next: function() {\n      return {value: index++, done: false};\n    }\n  };\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢çä¾å­ä¸­ï¼éåå¨çæå½æ°idMakerï¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼å³æéå¯¹è±¡ï¼ãä½æ¯å¹¶æ²¡æå¯¹åºçæ°æ®ç»æï¼æèè¯´ï¼éåå¨å¯¹è±¡èªå·±æè¿°äºä¸ä¸ªæ°æ®ç»æåºæ¥ã\n\nå¦æä½¿ç¨ TypeScript çåæ³ï¼éåå¨æ¥å£ï¼Iterableï¼ãæéå¯¹è±¡ï¼Iteratorï¼ånextæ¹æ³è¿åå¼çè§æ ¼å¯ä»¥æè¿°å¦ä¸ã\n\ninterface Iterable {\n  [Symbol.iterator]() : Iterator,\n}\n\ninterface Iterator {\n  next(value?: any) : IterationResult,\n}\n\ninterface IterationResult {\n  value: any,\n  done: boolean,\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n\n# é»è®¤ Iterator æ¥å£\n\nIterator æ¥å£çç®çï¼å°±æ¯ä¸ºæææ°æ®ç»æï¼æä¾äºä¸ç§ç»ä¸çè®¿é®æºå¶ï¼å³for...ofå¾ªç¯ï¼è¯¦è§ä¸æï¼ãå½ä½¿ç¨for...ofå¾ªç¯éåæç§æ°æ®ç»ææ¶ï¼è¯¥å¾ªç¯ä¼èªå¨å»å¯»æ¾ Iterator æ¥å£ã\n\nä¸ç§æ°æ®ç»æåªè¦é¨ç½²äº Iterator æ¥å£ï¼æä»¬å°±ç§°è¿ç§æ°æ®ç»ææ¯âå¯éåçâï¼iterableï¼ã\n\nES6 è§å®ï¼é»è®¤ç Iterator æ¥å£é¨ç½²å¨æ°æ®ç»æçSymbol.iteratorå±æ§ï¼æèè¯´ï¼ä¸ä¸ªæ°æ®ç»æåªè¦å·æSymbol.iteratorå±æ§ï¼å°±å¯ä»¥è®¤ä¸ºæ¯âå¯éåçâï¼iterableï¼ãSymbol.iteratorå±æ§æ¬èº«æ¯ä¸ä¸ªå½æ°ï¼å°±æ¯å½åæ°æ®ç»æé»è®¤çéåå¨çæå½æ°ãæ§è¡è¿ä¸ªå½æ°ï¼å°±ä¼è¿åä¸ä¸ªéåå¨ãè³äºå±æ§åSymbol.iteratorï¼å®æ¯ä¸ä¸ªè¡¨è¾¾å¼ï¼è¿åSymbolå¯¹è±¡çiteratorå±æ§ï¼è¿æ¯ä¸ä¸ªé¢å®ä¹å¥½çãç±»åä¸º Symbol çç¹æ®å¼ï¼æä»¥è¦æ¾å¨æ¹æ¬å·åï¼åè§ãSymbolãä¸ç« ï¼ã\n\nconst obj = {\n  [Symbol.iterator] : function () {\n    return {\n      next: function () {\n        return {\n          value: 1,\n          done: true\n        };\n      }\n    };\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯¹è±¡objæ¯å¯éåçï¼iterableï¼ï¼å ä¸ºå·æSymbol.iteratorå±æ§ãæ§è¡è¿ä¸ªå±æ§ï¼ä¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ãè¯¥å¯¹è±¡çæ ¹æ¬ç¹å¾å°±æ¯å·ænextæ¹æ³ãæ¯æ¬¡è°ç¨nextæ¹æ³ï¼é½ä¼è¿åä¸ä¸ªä»£è¡¨å½åæåçä¿¡æ¯å¯¹è±¡ï¼å·ævalueådoneä¸¤ä¸ªå±æ§ã\n\nES6 çæäºæ°æ®ç»æåçå·å¤ Iterator æ¥å£ï¼æ¯å¦æ°ç»ï¼ï¼å³ä¸ç¨ä»»ä½å¤çï¼å°±å¯ä»¥è¢«for...ofå¾ªç¯éåãåå å¨äºï¼è¿äºæ°æ®ç»æåçé¨ç½²äºSymbol.iteratorå±æ§ï¼è¯¦è§ä¸æï¼ï¼å¦å¤ä¸äºæ°æ®ç»ææ²¡æï¼æ¯å¦å¯¹è±¡ï¼ãå¡æ¯é¨ç½²äºSymbol.iteratorå±æ§çæ°æ®ç»æï¼å°±ç§°ä¸ºé¨ç½²äºéåå¨æ¥å£ãè°ç¨è¿ä¸ªæ¥å£ï¼å°±ä¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ã\n\nåçå·å¤ Iterator æ¥å£çæ°æ®ç»æå¦ä¸ã\n\n * Array\n * Map\n * Set\n * String\n * TypedArray\n * å½æ°ç arguments å¯¹è±¡\n * NodeList å¯¹è±¡\n\nä¸é¢çä¾å­æ¯æ°ç»çSymbol.iteratorå±æ§ã\n\nlet arr = ['a', 'b', 'c'];\nlet iter = arr[Symbol.iterator]();\n\niter.next() // { value: 'a', done: false }\niter.next() // { value: 'b', done: false }\niter.next() // { value: 'c', done: false }\niter.next() // { value: undefined, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åéarræ¯ä¸ä¸ªæ°ç»ï¼åçå°±å·æéåå¨æ¥å£ï¼é¨ç½²å¨arrçSymbol.iteratorå±æ§ä¸é¢ãæä»¥ï¼è°ç¨è¿ä¸ªå±æ§ï¼å°±å¾å°éåå¨å¯¹è±¡ã\n\nå¯¹äºåçé¨ç½² Iterator æ¥å£çæ°æ®ç»æï¼ä¸ç¨èªå·±åéåå¨çæå½æ°ï¼for...ofå¾ªç¯ä¼èªå¨éåå®ä»¬ãé¤æ­¤ä¹å¤ï¼å¶ä»æ°æ®ç»æï¼ä¸»è¦æ¯å¯¹è±¡ï¼ç Iterator æ¥å£ï¼é½éè¦èªå·±å¨Symbol.iteratorå±æ§ä¸é¢é¨ç½²ï¼è¿æ ·æä¼è¢«for...ofå¾ªç¯éåã\n\nå¯¹è±¡ï¼Objectï¼ä¹æä»¥æ²¡æé»è®¤é¨ç½² Iterator æ¥å£ï¼æ¯å ä¸ºå¯¹è±¡çåªä¸ªå±æ§åéåï¼åªä¸ªå±æ§åéåæ¯ä¸ç¡®å®çï¼éè¦å¼åèæå¨æå®ãæ¬è´¨ä¸ï¼éåå¨æ¯ä¸ç§çº¿æ§å¤çï¼å¯¹äºä»»ä½éçº¿æ§çæ°æ®ç»æï¼é¨ç½²éåå¨æ¥å£ï¼å°±ç­äºé¨ç½²ä¸ç§çº¿æ§è½¬æ¢ãä¸è¿ï¼ä¸¥æ ¼å°è¯´ï¼å¯¹è±¡é¨ç½²éåå¨æ¥å£å¹¶ä¸æ¯å¾å¿è¦ï¼å ä¸ºè¿æ¶å¯¹è±¡å®éä¸è¢«å½ä½ Map ç»æä½¿ç¨ï¼ES5 æ²¡æ Map ç»æï¼è ES6 åçæä¾äºã\n\nä¸ä¸ªå¯¹è±¡å¦æè¦å·å¤å¯è¢«for...ofå¾ªç¯è°ç¨ç Iterator æ¥å£ï¼å°±å¿é¡»å¨Symbol.iteratorçå±æ§ä¸é¨ç½²éåå¨çææ¹æ³ï¼ååé¾ä¸çå¯¹è±¡å·æè¯¥æ¹æ³ä¹å¯ï¼ã\n\nclass RangeIterator {\n  constructor(start, stop) {\n    this.value = start;\n    this.stop = stop;\n  }\n\n  [Symbol.iterator]() { return this; }\n\n  next() {\n    var value = this.value;\n    if (value < this.stop) {\n      this.value++;\n      return {done: false, value: value};\n    }\n    return {done: true, value: undefined};\n  }\n}\n\nfunction range(start, stop) {\n  return new RangeIterator(start, stop);\n}\n\nfor (var value of range(0, 3)) {\n  console.log(value); // 0, 1, 2\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nä¸é¢ä»£ç æ¯ä¸ä¸ªç±»é¨ç½² Iterator æ¥å£çåæ³ãSymbol.iteratorå±æ§å¯¹åºä¸ä¸ªå½æ°ï¼æ§è¡åè¿åå½åå¯¹è±¡çéåå¨å¯¹è±¡ã\n\nä¸é¢æ¯éè¿éåå¨å®ç°æéç»æçä¾å­ã\n\nfunction Obj(value) {\n  this.value = value;\n  this.next = null;\n}\n\nObj.prototype[Symbol.iterator] = function() {\n  var iterator = { next: next };\n\n  var current = this;\n\n  function next() {\n    if (current) {\n      var value = current.value;\n      current = current.next;\n      return { done: false, value: value };\n    } else {\n      return { done: true };\n    }\n  }\n  return iterator;\n}\n\nvar one = new Obj(1);\nvar two = new Obj(2);\nvar three = new Obj(3);\n\none.next = two;\ntwo.next = three;\n\nfor (var i of one){\n  console.log(i); // 1, 2, 3\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n\n\nä¸é¢ä»£ç é¦åå¨æé å½æ°çååé¾ä¸é¨ç½²Symbol.iteratoræ¹æ³ï¼è°ç¨è¯¥æ¹æ³ä¼è¿åéåå¨å¯¹è±¡iteratorï¼è°ç¨è¯¥å¯¹è±¡çnextæ¹æ³ï¼å¨è¿åä¸ä¸ªå¼çåæ¶ï¼èªå¨å°åé¨æéç§»å°ä¸ä¸ä¸ªå®ä¾ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¸ºå¯¹è±¡æ·»å  Iterator æ¥å£çä¾å­ã\n\nlet obj = {\n  data: [ 'hello', 'world' ],\n  [Symbol.iterator]() {\n    const self = this;\n    let index = 0;\n    return {\n      next() {\n        if (index < self.data.length) {\n          return {\n            value: self.data[index++],\n            done: false\n          };\n        } else {\n          return { value: undefined, done: true };\n        }\n      }\n    };\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nå¯¹äºç±»ä¼¼æ°ç»çå¯¹è±¡ï¼å­å¨æ°å¼é®åålengthå±æ§ï¼ï¼é¨ç½² Iterator æ¥å£ï¼æä¸ä¸ªç®ä¾¿æ¹æ³ï¼å°±æ¯Symbol.iteratoræ¹æ³ç´æ¥å¼ç¨æ°ç»ç Iterator æ¥å£ã\n\nNodeList.prototype[Symbol.iterator] = Array.prototype[Symbol.iterator];\n// æè\nNodeList.prototype[Symbol.iterator] = [][Symbol.iterator];\n\n[...document.querySelectorAll('div')] // å¯ä»¥æ§è¡äº\n\n\n1\n2\n3\n4\n5\n\n\nNodeList å¯¹è±¡æ¯ç±»ä¼¼æ°ç»çå¯¹è±¡ï¼æ¬æ¥å°±å·æéåæ¥å£ï¼å¯ä»¥ç´æ¥éåãä¸é¢ä»£ç ä¸­ï¼æä»¬å°å®çéåæ¥å£æ¹ææ°ç»çSymbol.iteratorå±æ§ï¼å¯ä»¥çå°æ²¡æä»»ä½å½±åã\n\nä¸é¢æ¯å¦ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡è°ç¨æ°ç»çSymbol.iteratoræ¹æ³çä¾å­ã\n\nlet iterable = {\n  0: 'a',\n  1: 'b',\n  2: 'c',\n  length: 3,\n  [Symbol.iterator]: Array.prototype[Symbol.iterator]\n};\nfor (let item of iterable) {\n  console.log(item); // 'a', 'b', 'c'\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\næ³¨æï¼æ®éå¯¹è±¡é¨ç½²æ°ç»çSymbol.iteratoræ¹æ³ï¼å¹¶æ ææã\n\nlet iterable = {\n  a: 'a',\n  b: 'b',\n  c: 'c',\n  length: 3,\n  [Symbol.iterator]: Array.prototype[Symbol.iterator]\n};\nfor (let item of iterable) {\n  console.log(item); // undefined, undefined, undefined\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¦æSymbol.iteratoræ¹æ³å¯¹åºçä¸æ¯éåå¨çæå½æ°ï¼å³ä¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼ï¼è§£éå¼æå°ä¼æ¥éã\n\nvar obj = {};\n\nobj[Symbol.iterator] = () => 1;\n\n[...obj] // TypeError: [] is not a function\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼åéobjçSymbol.iteratoræ¹æ³å¯¹åºçä¸æ¯éåå¨çæå½æ°ï¼å æ­¤æ¥éã\n\næäºéåå¨æ¥å£ï¼æ°æ®ç»æå°±å¯ä»¥ç¨for...ofå¾ªç¯éåï¼è¯¦è§ä¸æï¼ï¼ä¹å¯ä»¥ä½¿ç¨whileå¾ªç¯éåã\n\nvar $iterator = ITERABLE[Symbol.iterator]();\nvar $result = $iterator.next();\nwhile (!$result.done) {\n  var x = $result.value;\n  // ...\n  $result = $iterator.next();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼ITERABLEä»£è¡¨æç§å¯éåçæ°æ®ç»æï¼$iteratoræ¯å®çéåå¨å¯¹è±¡ãéåå¨å¯¹è±¡æ¯æ¬¡ç§»å¨æéï¼nextæ¹æ³ï¼ï¼é½æ£æ¥ä¸ä¸è¿åå¼çdoneå±æ§ï¼å¦æéåè¿æ²¡ç»æï¼å°±ç§»å¨éåå¨å¯¹è±¡çæéå°ä¸ä¸æ­¥ï¼nextæ¹æ³ï¼ï¼ä¸æ­å¾ªç¯ã\n\n\n# è°ç¨ Iterator æ¥å£çåºå\n\næä¸äºåºåä¼é»è®¤è°ç¨ Iterator æ¥å£ï¼å³Symbol.iteratoræ¹æ³ï¼ï¼é¤äºä¸æä¼ä»ç»çfor...ofå¾ªç¯ï¼è¿æå ä¸ªå«çåºåã\n\nï¼1ï¼è§£æèµå¼\n\nå¯¹æ°ç»å Set ç»æè¿è¡è§£æèµå¼æ¶ï¼ä¼é»è®¤è°ç¨Symbol.iteratoræ¹æ³ã\n\nlet set = new Set().add('a').add('b').add('c');\n\nlet [x,y] = set;\n// x='a'; y='b'\n\nlet [first, ...rest] = set;\n// first='a'; rest=['b','c'];\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nï¼2ï¼æ©å±è¿ç®ç¬¦\n\næ©å±è¿ç®ç¬¦ï¼...ï¼ä¹ä¼è°ç¨é»è®¤ç Iterator æ¥å£ã\n\n// ä¾ä¸\nvar str = 'hello';\n[...str] //  ['h','e','l','l','o']\n\n// ä¾äº\nlet arr = ['b', 'c'];\n['a', ...arr, 'd']\n// ['a', 'b', 'c', 'd']\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç çæ©å±è¿ç®ç¬¦åé¨å°±è°ç¨ Iterator æ¥å£ã\n\nå®éä¸ï¼è¿æä¾äºä¸ç§ç®ä¾¿æºå¶ï¼å¯ä»¥å°ä»»ä½é¨ç½²äº Iterator æ¥å£çæ°æ®ç»æï¼è½¬ä¸ºæ°ç»ãä¹å°±æ¯è¯´ï¼åªè¦æä¸ªæ°æ®ç»æé¨ç½²äº Iterator æ¥å£ï¼å°±å¯ä»¥å¯¹å®ä½¿ç¨æ©å±è¿ç®ç¬¦ï¼å°å¶è½¬ä¸ºæ°ç»ã\n\nlet arr = [...iterable];\n\n\n1\n\n\nï¼3ï¼yield*\n\nyield*åé¢è·çæ¯ä¸ä¸ªå¯éåçç»æï¼å®ä¼è°ç¨è¯¥ç»æçéåå¨æ¥å£ã\n\nlet generator = function* () {\n  yield 1;\n  yield* [2,3,4];\n  yield 5;\n};\n\nvar iterator = generator();\n\niterator.next() // { value: 1, done: false }\niterator.next() // { value: 2, done: false }\niterator.next() // { value: 3, done: false }\niterator.next() // { value: 4, done: false }\niterator.next() // { value: 5, done: false }\niterator.next() // { value: undefined, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nï¼4ï¼å¶ä»åºå\n\nç±äºæ°ç»çéåä¼è°ç¨éåå¨æ¥å£ï¼æä»¥ä»»ä½æ¥åæ°ç»ä½ä¸ºåæ°çåºåï¼å¶å®é½è°ç¨äºéåå¨æ¥å£ãä¸é¢æ¯ä¸äºä¾å­ã\n\n * for...of\n * Array.from()\n * Map(), Set(), WeakMap(), WeakSet()ï¼æ¯å¦new Map([['a',1],['b',2]])ï¼\n * Promise.all()\n * Promise.race()\n\n\n# å­ç¬¦ä¸²ç Iterator æ¥å£\n\nå­ç¬¦ä¸²æ¯ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ï¼ä¹åçå·æ Iterator æ¥å£ã\n\nvar someString = \"hi\";\ntypeof someString[Symbol.iterator]\n// \"function\"\n\nvar iterator = someString[Symbol.iterator]();\n\niterator.next()  // { value: \"h\", done: false }\niterator.next()  // { value: \"i\", done: false }\niterator.next()  // { value: undefined, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼è°ç¨Symbol.iteratoræ¹æ³è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼å¨è¿ä¸ªéåå¨ä¸å¯ä»¥è°ç¨ next æ¹æ³ï¼å®ç°å¯¹äºå­ç¬¦ä¸²çéåã\n\nå¯ä»¥è¦çåççSymbol.iteratoræ¹æ³ï¼è¾¾å°ä¿®æ¹éåå¨è¡ä¸ºçç®çã\n\nvar str = new String(\"hi\");\n\n[...str] // [\"h\", \"i\"]\n\nstr[Symbol.iterator] = function() {\n  return {\n    next: function() {\n      if (this._first) {\n        this._first = false;\n        return { value: \"bye\", done: false };\n      } else {\n        return { done: true };\n      }\n    },\n    _first: true\n  };\n};\n\n[...str] // [\"bye\"]\nstr // \"hi\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç¬¦ä¸² str çSymbol.iteratoræ¹æ³è¢«ä¿®æ¹äºï¼æä»¥æ©å±è¿ç®ç¬¦ï¼...ï¼è¿åçå¼åæäºbyeï¼èå­ç¬¦ä¸²æ¬èº«è¿æ¯hiã\n\n\n# Iterator æ¥å£ä¸ Generator å½æ°\n\nSymbol.iteratoræ¹æ³çæç®åå®ç°ï¼è¿æ¯ä½¿ç¨ä¸ä¸ç« è¦ä»ç»ç Generator å½æ°ã\n\nlet myIterable = {\n  [Symbol.iterator]: function* () {\n    yield 1;\n    yield 2;\n    yield 3;\n  }\n}\n[...myIterable] // [1, 2, 3]\n\n// æèéç¨ä¸é¢çç®æ´åæ³\n\nlet obj = {\n  * [Symbol.iterator]() {\n    yield 'hello';\n    yield 'world';\n  }\n};\n\nfor (let x of obj) {\n  console.log(x);\n}\n// \"hello\"\n// \"world\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nä¸é¢ä»£ç ä¸­ï¼Symbol.iteratoræ¹æ³å ä¹ä¸ç¨é¨ç½²ä»»ä½ä»£ç ï¼åªè¦ç¨ yield å½ä»¤ç»åºæ¯ä¸æ­¥çè¿åå¼å³å¯ã\n\n\n# éåå¨å¯¹è±¡ç return()ï¼throw()\n\néåå¨å¯¹è±¡é¤äºå·ænextæ¹æ³ï¼è¿å¯ä»¥å·æreturnæ¹æ³åthrowæ¹æ³ãå¦æä½ èªå·±åéåå¨å¯¹è±¡çæå½æ°ï¼é£ä¹nextæ¹æ³æ¯å¿é¡»é¨ç½²çï¼returnæ¹æ³åthrowæ¹æ³æ¯å¦é¨ç½²æ¯å¯éçã\n\nreturnæ¹æ³çä½¿ç¨åºåæ¯ï¼å¦æfor...ofå¾ªç¯æåéåºï¼éå¸¸æ¯å ä¸ºåºéï¼æèæbreakè¯­å¥ï¼ï¼å°±ä¼è°ç¨returnæ¹æ³ãå¦æä¸ä¸ªå¯¹è±¡å¨å®æéååï¼éè¦æ¸çæéæ¾èµæºï¼å°±å¯ä»¥é¨ç½²returnæ¹æ³ã\n\nfunction readLinesSync(file) {\n  return {\n    [Symbol.iterator]() {\n      return {\n        next() {\n          return { done: false };\n        },\n        return() {\n          file.close();\n          return { done: true };\n        }\n      };\n    },\n  };\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°readLinesSyncæ¥åä¸ä¸ªæä»¶å¯¹è±¡ä½ä¸ºåæ°ï¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼å¶ä¸­é¤äºnextæ¹æ³ï¼è¿é¨ç½²äºreturnæ¹æ³ãä¸é¢çä¸¤ç§æåµï¼é½ä¼è§¦åæ§è¡returnæ¹æ³ã\n\n// æåµä¸\nfor (let line of readLinesSync(fileName)) {\n  console.log(line);\n  break;\n}\n\n// æåµäº\nfor (let line of readLinesSync(fileName)) {\n  console.log(line);\n  throw new Error();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼æåµä¸è¾åºæä»¶çç¬¬ä¸è¡ä»¥åï¼å°±ä¼æ§è¡returnæ¹æ³ï¼å³é­è¿ä¸ªæä»¶ï¼æåµäºä¼å¨æ§è¡returnæ¹æ³å³é­æä»¶ä¹åï¼åæåºéè¯¯ã\n\næ³¨æï¼returnæ¹æ³å¿é¡»è¿åä¸ä¸ªå¯¹è±¡ï¼è¿æ¯ Generator è§æ ¼å³å®çã\n\nthrowæ¹æ³ä¸»è¦æ¯éå Generator å½æ°ä½¿ç¨ï¼ä¸è¬çéåå¨å¯¹è±¡ç¨ä¸å°è¿ä¸ªæ¹æ³ãè¯·åéãGenerator å½æ°ãä¸ç« ã\n\n\n# for...of å¾ªç¯\n\nES6 åé´ C++ãJavaãC# å Python è¯­è¨ï¼å¼å¥äºfor...ofå¾ªç¯ï¼ä½ä¸ºéåæææ°æ®ç»æçç»ä¸çæ¹æ³ã\n\nä¸ä¸ªæ°æ®ç»æåªè¦é¨ç½²äºSymbol.iteratorå±æ§ï¼å°±è¢«è§ä¸ºå·æ iterator æ¥å£ï¼å°±å¯ä»¥ç¨for...ofå¾ªç¯éåå®çæåãä¹å°±æ¯è¯´ï¼for...ofå¾ªç¯åé¨è°ç¨çæ¯æ°æ®ç»æçSymbol.iteratoræ¹æ³ã\n\nfor...ofå¾ªç¯å¯ä»¥ä½¿ç¨çèå´åæ¬æ°ç»ãSet å Map ç»æãæäºç±»ä¼¼æ°ç»çå¯¹è±¡ï¼æ¯å¦argumentså¯¹è±¡ãDOM NodeList å¯¹è±¡ï¼ãåæç Generator å¯¹è±¡ï¼ä»¥åå­ç¬¦ä¸²ã\n\n\n# æ°ç»\n\næ°ç»åçå·å¤iteratoræ¥å£ï¼å³é»è®¤é¨ç½²äºSymbol.iteratorå±æ§ï¼ï¼for...ofå¾ªç¯æ¬è´¨ä¸å°±æ¯è°ç¨è¿ä¸ªæ¥å£äº§ççéåå¨ï¼å¯ä»¥ç¨ä¸é¢çä»£ç è¯æã\n\nconst arr = ['red', 'green', 'blue'];\n\nfor(let v of arr) {\n  console.log(v); // red green blue\n}\n\nconst obj = {};\nobj[Symbol.iterator] = arr[Symbol.iterator].bind(arr);\n\nfor(let v of obj) {\n  console.log(v); // red green blue\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼ç©ºå¯¹è±¡objé¨ç½²äºæ°ç»arrçSymbol.iteratorå±æ§ï¼ç»æobjçfor...ofå¾ªç¯ï¼äº§çäºä¸arrå®å¨ä¸æ ·çç»æã\n\nfor...ofå¾ªç¯å¯ä»¥ä»£æ¿æ°ç»å®ä¾çforEachæ¹æ³ã\n\nconst arr = ['red', 'green', 'blue'];\n\narr.forEach(function (element, index) {\n  console.log(element); // red green blue\n  console.log(index);   // 0 1 2\n});\n\n\n1\n2\n3\n4\n5\n6\n\n\nJavaScript åæç**for...inå¾ªç¯ï¼åªè½è·å¾å¯¹è±¡çé®å**ï¼ä¸è½ç´æ¥è·åé®å¼ãES6 æä¾for...ofå¾ªç¯ï¼åè®¸éåè·å¾é®å¼ã\n\nvar arr = ['a', 'b', 'c', 'd'];\n\nfor (let a in arr) {\n  console.log(a); // 0 1 2 3\n}\n\nfor (let a of arr) {\n  console.log(a); // a b c d\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç è¡¨æï¼for...inå¾ªç¯è¯»åé®åï¼for...ofå¾ªç¯è¯»åé®å¼ãå¦æè¦éè¿for...ofå¾ªç¯ï¼è·åæ°ç»çç´¢å¼ï¼å¯ä»¥åå©æ°ç»å®ä¾çentriesæ¹æ³åkeysæ¹æ³ï¼åè§ãæ°ç»çæ©å±ãä¸ç« ï¼ã\n\nfor...ofå¾ªç¯è°ç¨éåå¨æ¥å£ï¼æ°ç»çéåå¨æ¥å£åªè¿åå·ææ°å­ç´¢å¼çå±æ§ãè¿ä¸ç¹è·for...inå¾ªç¯ä¹ä¸ä¸æ ·ã\n\nlet arr = [3, 5, 7];\narr.foo = 'hello';\n\nfor (let i in arr) {\n  console.log(i); // \"0\", \"1\", \"2\", \"foo\"\n}\n\nfor (let i of arr) {\n  console.log(i); //  \"3\", \"5\", \"7\"\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼for...ofå¾ªç¯ä¸ä¼è¿åæ°ç»arrçfooå±æ§ã\n\n\n# Set å Map ç»æ\n\nSet å Map ç»æä¹åçå·æ Iterator æ¥å£ï¼å¯ä»¥ç´æ¥ä½¿ç¨for...ofå¾ªç¯ã\n\nvar engines = new Set([\"Gecko\", \"Trident\", \"Webkit\", \"Webkit\"]);\nfor (var e of engines) {\n  console.log(e);\n}\n// Gecko\n// Trident\n// Webkit\n\nvar es6 = new Map();\nes6.set(\"edition\", 6);\nes6.set(\"committee\", \"TC39\");\nes6.set(\"standard\", \"ECMA-262\");\nfor (var [name, value] of es6) {\n  console.log(name + \": \" + value);\n}\n// edition: 6\n// committee: TC39\n// standard: ECMA-262\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä¸é¢ä»£ç æ¼ç¤ºäºå¦ä½éå Set ç»æå Map ç»æãå¼å¾æ³¨æçå°æ¹æä¸¤ä¸ªï¼é¦åï¼éåçé¡ºåºæ¯æç§åä¸ªæåè¢«æ·»å è¿æ°æ®ç»æçé¡ºåºãå¶æ¬¡ï¼Set ç»æéåæ¶ï¼è¿åçæ¯ä¸ä¸ªå¼ï¼è Map ç»æéåæ¶ï¼è¿åçæ¯ä¸ä¸ªæ°ç»ï¼è¯¥æ°ç»çä¸¤ä¸ªæååå«ä¸ºå½å Map æåçé®ååé®å¼ã\n\nlet map = new Map().set('a', 1).set('b', 2);\nfor (let pair of map) {\n  console.log(pair);\n}\n// ['a', 1]\n// ['b', 2]\n\nfor (let [key, value] of map) {\n  console.log(key + ' : ' + value);\n}\n// a : 1\n// b : 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n\n# è®¡ç®çæçæ°æ®ç»æ\n\næäºæ°æ®ç»ææ¯å¨ç°ææ°æ®ç»æçåºç¡ä¸ï¼è®¡ç®çæçãæ¯å¦ï¼ES6 çæ°ç»ãSetãMap é½é¨ç½²äºä»¥ä¸ä¸ä¸ªæ¹æ³ï¼è°ç¨åé½è¿åéåå¨å¯¹è±¡ã\n\n * entries() è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼ç¨æ¥éå[é®å, é®å¼]ç»æçæ°ç»ãå¯¹äºæ°ç»ï¼é®åå°±æ¯ç´¢å¼å¼ï¼å¯¹äº Setï¼é®åä¸é®å¼ç¸åãMap ç»æç Iterator æ¥å£ï¼é»è®¤å°±æ¯è°ç¨entriesæ¹æ³ã\n * keys() è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼ç¨æ¥éåææçé®åã\n * values() è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼ç¨æ¥éåææçé®å¼ã\n\nè¿ä¸ä¸ªæ¹æ³è°ç¨åçæçéåå¨å¯¹è±¡ï¼æéåçé½æ¯è®¡ç®çæçæ°æ®ç»æã\n\nlet arr = ['a', 'b', 'c'];\nfor (let pair of arr.entries()) {\n  console.log(pair);\n}\n// [0, 'a']\n// [1, 'b']\n// [2, 'c']\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# ç±»ä¼¼æ°ç»çå¯¹è±¡\n\nç±»ä¼¼æ°ç»çå¯¹è±¡åæ¬å¥½å ç±»ãä¸é¢æ¯for...ofå¾ªç¯ç¨äºå­ç¬¦ä¸²ãDOM NodeList å¯¹è±¡ãargumentså¯¹è±¡çä¾å­ã\n\n// å­ç¬¦ä¸²\nlet str = \"hello\";\n\nfor (let s of str) {\n  console.log(s); // h e l l o\n}\n\n// DOM NodeListå¯¹è±¡\nlet paras = document.querySelectorAll(\"p\");\n\nfor (let p of paras) {\n  p.classList.add(\"test\");\n}\n\n// argumentså¯¹è±¡\nfunction printArgs() {\n  for (let x of arguments) {\n    console.log(x);\n  }\n}\nprintArgs('a', 'b');\n// 'a'\n// 'b'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nå¯¹äºå­ç¬¦ä¸²æ¥è¯´ï¼for...ofå¾ªç¯è¿æä¸ä¸ªç¹ç¹ï¼å°±æ¯ä¼æ­£ç¡®è¯å« 32 ä½ UTF-16 å­ç¬¦ã\n\nfor (let x of 'a\\uD83D\\uDC0A') {\n  console.log(x);\n}\n// 'a'\n// '\\uD83D\\uDC0A'\n\n\n1\n2\n3\n4\n5\n\n\nå¹¶ä¸æ¯ææç±»ä¼¼æ°ç»çå¯¹è±¡é½å·æ Iterator æ¥å£ï¼ä¸ä¸ªç®ä¾¿çè§£å³æ¹æ³ï¼å°±æ¯ä½¿ç¨Array.fromæ¹æ³å°å¶è½¬ä¸ºæ°ç»ã\n\nlet arrayLike = { length: 2, 0: 'a', 1: 'b' };\n\n// æ¥é\nfor (let x of arrayLike) {\n  console.log(x);\n}\n\n// æ­£ç¡®\nfor (let x of Array.from(arrayLike)) {\n  console.log(x);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# å¯¹è±¡\n\nå¯¹äºæ®éçå¯¹è±¡ï¼for...ofç»æä¸è½ç´æ¥ä½¿ç¨ï¼ä¼æ¥éï¼å¿é¡»é¨ç½²äº Iterator æ¥å£åæè½ä½¿ç¨ãä½æ¯ï¼è¿æ ·æåµä¸ï¼for...inå¾ªç¯ä¾ç¶å¯ä»¥ç¨æ¥éåé®åã\n\nlet es6 = {\n  edition: 6,\n  committee: \"TC39\",\n  standard: \"ECMA-262\"\n};\n\nfor (let e in es6) {\n  console.log(e);\n}\n// edition\n// committee\n// standard\n\nfor (let e of es6) {\n  console.log(e);\n}\n// TypeError: es6[Symbol.iterator] is not a function\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼å¯¹äºæ®éçå¯¹è±¡ï¼for...inå¾ªç¯å¯ä»¥éåé®åï¼for...ofå¾ªç¯ä¼æ¥éã\n\nä¸ç§è§£å³æ¹æ³æ¯ï¼ä½¿ç¨Object.keysæ¹æ³å°å¯¹è±¡çé®åçæä¸ä¸ªæ°ç»ï¼ç¶åéåè¿ä¸ªæ°ç»ã\n\nfor (var key of Object.keys(someObject)) {\n  console.log(key + ': ' + someObject[key]);\n}\n\n\n1\n2\n3\n\n\nå¦ä¸ä¸ªæ¹æ³æ¯ä½¿ç¨ Generator å½æ°å°å¯¹è±¡éæ°åè£ä¸ä¸ã\n\nfunction* entries(obj) {\n  for (let key of Object.keys(obj)) {\n    yield [key, obj[key]];\n  }\n}\n\nfor (let [key, value] of entries(obj)) {\n  console.log(key, '->', value);\n}\n// a -> 1\n// b -> 2\n// c -> 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n\n# ä¸å¶ä»éåè¯­æ³çæ¯è¾\n\nä»¥æ°ç»ä¸ºä¾ï¼JavaScript æä¾å¤ç§éåè¯­æ³ãæåå§çåæ³å°±æ¯forå¾ªç¯ã\n\nfor (var index = 0; index < myArray.length; index++) {\n  console.log(myArray[index]);\n}\n\n\n1\n2\n3\n\n\nè¿ç§åæ³æ¯è¾éº»ç¦ï¼å æ­¤æ°ç»æä¾åç½®çforEachæ¹æ³ã\n\nmyArray.forEach(function (value) {\n  console.log(value);\n});\n\n\n1\n2\n3\n\n\nè¿ç§åæ³çé®é¢å¨äºï¼æ æ³ä¸­éè·³åºforEachå¾ªç¯ï¼breakå½ä»¤æreturnå½ä»¤é½ä¸è½å¥æã\n\nfor...inå¾ªç¯å¯ä»¥éåæ°ç»çé®åã\n\nfor (var index in myArray) {\n  console.log(myArray[index]);\n}\n\n\n1\n2\n3\n\n\nfor...inå¾ªç¯æå ä¸ªç¼ºç¹ã\n\n * æ°ç»çé®åæ¯æ°å­ï¼ä½æ¯for...inå¾ªç¯æ¯ä»¥å­ç¬¦ä¸²ä½ä¸ºé®åâ0âãâ1âãâ2âç­ç­ã\n * for...inå¾ªç¯ä¸ä»éåæ°å­é®åï¼è¿ä¼éåæå¨æ·»å çå¶ä»é®ï¼çè³åæ¬ååé¾ä¸çé®ã\n * æäºæåµä¸ï¼for...inå¾ªç¯ä¼ä»¥ä»»æé¡ºåºéåé®åã\n\næ»ä¹ï¼for...inå¾ªç¯ä¸»è¦æ¯ä¸ºéåå¯¹è±¡èè®¾è®¡çï¼ä¸éç¨äºéåæ°ç»ã\n\nfor...ofå¾ªç¯ç¸æ¯ä¸é¢å ç§åæ³ï¼æä¸äºæ¾èçä¼ç¹ã\n\nfor (let value of myArray) {\n  console.log(value);\n}\n\n\n1\n2\n3\n\n * æçåfor...inä¸æ ·çç®æ´è¯­æ³ï¼ä½æ¯æ²¡æfor...iné£äºç¼ºç¹ã\n * ä¸åäºforEachæ¹æ³ï¼å®å¯ä»¥ä¸breakãcontinueåreturnéåä½¿ç¨ã\n * æä¾äºéåæææ°æ®ç»æçç»ä¸æä½æ¥å£ã\n\nä¸é¢æ¯ä¸ä¸ªä½¿ç¨ break è¯­å¥ï¼è·³åºfor...ofå¾ªç¯çä¾å­ã\n\nfor (var n of fibonacci) {\n  if (n > 1000)\n    break;\n  console.log(n);\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çä¾å­ï¼ä¼è¾åºææ³¢çº³å¥æ°åå°äºç­äº 1000 çé¡¹ãå¦æå½åé¡¹å¤§äº 1000ï¼å°±ä¼ä½¿ç¨breakè¯­å¥è·³åºfor...ofå¾ªç¯ã",normalizedContent:"# iterator å for...of å¾ªç¯\n\n\n# iteratorï¼éåå¨ï¼çæ¦å¿µ\n\njavascript åæçè¡¨ç¤ºâéåâçæ°æ®ç»æï¼ä¸»è¦æ¯æ°ç»ï¼arrayï¼åå¯¹è±¡ï¼objectï¼ï¼es6 åæ·»å äºmapåsetãè¿æ ·å°±æäºåç§æ°æ®éåï¼ç¨æ·è¿å¯ä»¥ç»åä½¿ç¨å®ä»¬ï¼å®ä¹èªå·±çæ°æ®ç»æï¼æ¯å¦æ°ç»çæåæ¯mapï¼mapçæåæ¯å¯¹è±¡ãè¿æ ·å°±éè¦ä¸ç§ç»ä¸çæ¥å£æºå¶ï¼æ¥å¤çææä¸åçæ°æ®ç»æã éåå¨ï¼iteratorï¼å°±æ¯è¿æ ·ä¸ç§æºå¶ãå®æ¯ä¸ç§æ¥å£ï¼ä¸ºåç§ä¸åçæ°æ®ç»ææä¾ç»ä¸çè®¿é®æºå¶ãä»»ä½æ°æ®ç»æåªè¦é¨ç½² iterator æ¥å£ï¼å°±å¯ä»¥å®æéåæä½ï¼å³ä¾æ¬¡å¤çè¯¥æ°æ®ç»æçæææåï¼ã\n\niterator çä½ç¨æä¸ä¸ªï¼ä¸æ¯ä¸ºåç§æ°æ®ç»æï¼æä¾ä¸ä¸ªç»ä¸çãç®ä¾¿çè®¿é®æ¥å£ï¼äºæ¯ä½¿å¾æ°æ®ç»æçæåè½å¤ææç§æ¬¡åºæåï¼ä¸æ¯ es6 åé äºä¸ç§æ°çéåå½ä»¤for...ofå¾ªç¯ï¼iterator æ¥å£ä¸»è¦ä¾for...ofæ¶è´¹ã\n\niterator çéåè¿ç¨æ¯è¿æ ·çã\n\nï¼1ï¼åå»ºä¸ä¸ªæéå¯¹è±¡ï¼æåå½åæ°æ®ç»æçèµ·å§ä½ç½®ãä¹å°±æ¯è¯´ï¼éåå¨å¯¹è±¡æ¬è´¨ä¸ï¼å°±æ¯ä¸ä¸ªæéå¯¹è±¡ã\n\nï¼2ï¼ç¬¬ä¸æ¬¡è°ç¨æéå¯¹è±¡çnextæ¹æ³ï¼å¯ä»¥å°æéæåæ°æ®ç»æçç¬¬ä¸ä¸ªæåã\n\nï¼3ï¼ç¬¬äºæ¬¡è°ç¨æéå¯¹è±¡çnextæ¹æ³ï¼æéå°±æåæ°æ®ç»æçç¬¬äºä¸ªæåã\n\nï¼4ï¼ä¸æ­è°ç¨æéå¯¹è±¡çnextæ¹æ³ï¼ç´å°å®æåæ°æ®ç»æçç»æä½ç½®ã\n\næ¯ä¸æ¬¡è°ç¨nextæ¹æ³ï¼é½ä¼è¿åæ°æ®ç»æçå½åæåçä¿¡æ¯ãå·ä½æ¥è¯´ï¼å°±æ¯è¿åä¸ä¸ªåå«valueådoneä¸¤ä¸ªå±æ§çå¯¹è±¡ãå¶ä¸­ï¼valueå±æ§æ¯å½åæåçå¼ï¼doneå±æ§æ¯ä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºéåæ¯å¦ç»æã\n\nä¸é¢æ¯ä¸ä¸ªæ¨¡ænextæ¹æ³è¿åå¼çä¾å­ã\n\nvar it = makeiterator(['a', 'b']);\n\nit.next() // { value: \"a\", done: false }\nit.next() // { value: \"b\", done: false }\nit.next() // { value: undefined, done: true }\n\nfunction makeiterator(array) {\n  var nextindex = 0;\n  return {\n    next: function() {\n      return nextindex < array.length ?\n        {value: array[nextindex++], done: false} :\n        {value: undefined, done: true};\n    }\n  };\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢ä»£ç å®ä¹äºä¸ä¸ªmakeiteratorå½æ°ï¼å®æ¯ä¸ä¸ªéåå¨çæå½æ°ï¼ä½ç¨å°±æ¯è¿åä¸ä¸ªéåå¨å¯¹è±¡ãå¯¹æ°ç»['a', 'b']æ§è¡è¿ä¸ªå½æ°ï¼å°±ä¼è¿åè¯¥æ°ç»çéåå¨å¯¹è±¡ï¼å³æéå¯¹è±¡ï¼itã\n\næéå¯¹è±¡çnextæ¹æ³ï¼ç¨æ¥ç§»å¨æéãå¼å§æ¶ï¼æéæåæ°ç»çå¼å§ä½ç½®ãç¶åï¼æ¯æ¬¡è°ç¨nextæ¹æ³ï¼æéå°±ä¼æåæ°ç»çä¸ä¸ä¸ªæåãç¬¬ä¸æ¬¡è°ç¨ï¼æåaï¼ç¬¬äºæ¬¡è°ç¨ï¼æåbã\n\nnextæ¹æ³è¿åä¸ä¸ªå¯¹è±¡ï¼è¡¨ç¤ºå½åæ°æ®æåçä¿¡æ¯ãè¿ä¸ªå¯¹è±¡å·ævalueådoneä¸¤ä¸ªå±æ§ï¼valueå±æ§è¿åå½åä½ç½®çæåï¼doneå±æ§æ¯ä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºéåæ¯å¦ç»æï¼å³æ¯å¦è¿æå¿è¦åä¸æ¬¡è°ç¨nextæ¹æ³ã\n\næ»ä¹ï¼è°ç¨æéå¯¹è±¡çnextæ¹æ³ï¼å°±å¯ä»¥éåäºåç»å®çæ°æ®ç»æã\n\nå¯¹äºéåå¨å¯¹è±¡æ¥è¯´ï¼done: falseåvalue: undefinedå±æ§é½æ¯å¯ä»¥çç¥çï¼å æ­¤ä¸é¢çmakeiteratorå½æ°å¯ä»¥ç®åæä¸é¢çå½¢å¼ã\n\nfunction makeiterator(array) {\n  var nextindex = 0;\n  return {\n    next: function() {\n      return nextindex < array.length ?\n        {value: array[nextindex++]} :\n        {done: true};\n    }\n  };\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nç±äº iterator åªæ¯ææ¥å£è§æ ¼å å°æ°æ®ç»æä¹ä¸ï¼æä»¥ï¼éåå¨ä¸å®æéåçé£ä¸ªæ°æ®ç»æï¼å®éä¸æ¯åå¼çï¼å®å¨å¯ä»¥ååºæ²¡æå¯¹åºæ°æ®ç»æçéåå¨å¯¹è±¡ï¼æèè¯´ç¨éåå¨å¯¹è±¡æ¨¡æåºæ°æ®ç»æãä¸é¢æ¯ä¸ä¸ªæ éè¿è¡çéåå¨å¯¹è±¡çä¾å­ã\n\nvar it = idmaker();\n\nit.next().value // 0\nit.next().value // 1\nit.next().value // 2\n// ...\n\nfunction idmaker() {\n  var index = 0;\n\n  return {\n    next: function() {\n      return {value: index++, done: false};\n    }\n  };\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nä¸é¢çä¾å­ä¸­ï¼éåå¨çæå½æ°idmakerï¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼å³æéå¯¹è±¡ï¼ãä½æ¯å¹¶æ²¡æå¯¹åºçæ°æ®ç»æï¼æèè¯´ï¼éåå¨å¯¹è±¡èªå·±æè¿°äºä¸ä¸ªæ°æ®ç»æåºæ¥ã\n\nå¦æä½¿ç¨ typescript çåæ³ï¼éåå¨æ¥å£ï¼iterableï¼ãæéå¯¹è±¡ï¼iteratorï¼ånextæ¹æ³è¿åå¼çè§æ ¼å¯ä»¥æè¿°å¦ä¸ã\n\ninterface iterable {\n  [symbol.iterator]() : iterator,\n}\n\ninterface iterator {\n  next(value?: any) : iterationresult,\n}\n\ninterface iterationresult {\n  value: any,\n  done: boolean,\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n\n# é»è®¤ iterator æ¥å£\n\niterator æ¥å£çç®çï¼å°±æ¯ä¸ºæææ°æ®ç»æï¼æä¾äºä¸ç§ç»ä¸çè®¿é®æºå¶ï¼å³for...ofå¾ªç¯ï¼è¯¦è§ä¸æï¼ãå½ä½¿ç¨for...ofå¾ªç¯éåæç§æ°æ®ç»ææ¶ï¼è¯¥å¾ªç¯ä¼èªå¨å»å¯»æ¾ iterator æ¥å£ã\n\nä¸ç§æ°æ®ç»æåªè¦é¨ç½²äº iterator æ¥å£ï¼æä»¬å°±ç§°è¿ç§æ°æ®ç»ææ¯âå¯éåçâï¼iterableï¼ã\n\nes6 è§å®ï¼é»è®¤ç iterator æ¥å£é¨ç½²å¨æ°æ®ç»æçsymbol.iteratorå±æ§ï¼æèè¯´ï¼ä¸ä¸ªæ°æ®ç»æåªè¦å·æsymbol.iteratorå±æ§ï¼å°±å¯ä»¥è®¤ä¸ºæ¯âå¯éåçâï¼iterableï¼ãsymbol.iteratorå±æ§æ¬èº«æ¯ä¸ä¸ªå½æ°ï¼å°±æ¯å½åæ°æ®ç»æé»è®¤çéåå¨çæå½æ°ãæ§è¡è¿ä¸ªå½æ°ï¼å°±ä¼è¿åä¸ä¸ªéåå¨ãè³äºå±æ§åsymbol.iteratorï¼å®æ¯ä¸ä¸ªè¡¨è¾¾å¼ï¼è¿åsymbolå¯¹è±¡çiteratorå±æ§ï¼è¿æ¯ä¸ä¸ªé¢å®ä¹å¥½çãç±»åä¸º symbol çç¹æ®å¼ï¼æä»¥è¦æ¾å¨æ¹æ¬å·åï¼åè§ãsymbolãä¸ç« ï¼ã\n\nconst obj = {\n  [symbol.iterator] : function () {\n    return {\n      next: function () {\n        return {\n          value: 1,\n          done: true\n        };\n      }\n    };\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼å¯¹è±¡objæ¯å¯éåçï¼iterableï¼ï¼å ä¸ºå·æsymbol.iteratorå±æ§ãæ§è¡è¿ä¸ªå±æ§ï¼ä¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ãè¯¥å¯¹è±¡çæ ¹æ¬ç¹å¾å°±æ¯å·ænextæ¹æ³ãæ¯æ¬¡è°ç¨nextæ¹æ³ï¼é½ä¼è¿åä¸ä¸ªä»£è¡¨å½åæåçä¿¡æ¯å¯¹è±¡ï¼å·ævalueådoneä¸¤ä¸ªå±æ§ã\n\nes6 çæäºæ°æ®ç»æåçå·å¤ iterator æ¥å£ï¼æ¯å¦æ°ç»ï¼ï¼å³ä¸ç¨ä»»ä½å¤çï¼å°±å¯ä»¥è¢«for...ofå¾ªç¯éåãåå å¨äºï¼è¿äºæ°æ®ç»æåçé¨ç½²äºsymbol.iteratorå±æ§ï¼è¯¦è§ä¸æï¼ï¼å¦å¤ä¸äºæ°æ®ç»ææ²¡æï¼æ¯å¦å¯¹è±¡ï¼ãå¡æ¯é¨ç½²äºsymbol.iteratorå±æ§çæ°æ®ç»æï¼å°±ç§°ä¸ºé¨ç½²äºéåå¨æ¥å£ãè°ç¨è¿ä¸ªæ¥å£ï¼å°±ä¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ã\n\nåçå·å¤ iterator æ¥å£çæ°æ®ç»æå¦ä¸ã\n\n * array\n * map\n * set\n * string\n * typedarray\n * å½æ°ç arguments å¯¹è±¡\n * nodelist å¯¹è±¡\n\nä¸é¢çä¾å­æ¯æ°ç»çsymbol.iteratorå±æ§ã\n\nlet arr = ['a', 'b', 'c'];\nlet iter = arr[symbol.iterator]();\n\niter.next() // { value: 'a', done: false }\niter.next() // { value: 'b', done: false }\niter.next() // { value: 'c', done: false }\niter.next() // { value: undefined, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼åéarræ¯ä¸ä¸ªæ°ç»ï¼åçå°±å·æéåå¨æ¥å£ï¼é¨ç½²å¨arrçsymbol.iteratorå±æ§ä¸é¢ãæä»¥ï¼è°ç¨è¿ä¸ªå±æ§ï¼å°±å¾å°éåå¨å¯¹è±¡ã\n\nå¯¹äºåçé¨ç½² iterator æ¥å£çæ°æ®ç»æï¼ä¸ç¨èªå·±åéåå¨çæå½æ°ï¼for...ofå¾ªç¯ä¼èªå¨éåå®ä»¬ãé¤æ­¤ä¹å¤ï¼å¶ä»æ°æ®ç»æï¼ä¸»è¦æ¯å¯¹è±¡ï¼ç iterator æ¥å£ï¼é½éè¦èªå·±å¨symbol.iteratorå±æ§ä¸é¢é¨ç½²ï¼è¿æ ·æä¼è¢«for...ofå¾ªç¯éåã\n\nå¯¹è±¡ï¼objectï¼ä¹æä»¥æ²¡æé»è®¤é¨ç½² iterator æ¥å£ï¼æ¯å ä¸ºå¯¹è±¡çåªä¸ªå±æ§åéåï¼åªä¸ªå±æ§åéåæ¯ä¸ç¡®å®çï¼éè¦å¼åèæå¨æå®ãæ¬è´¨ä¸ï¼éåå¨æ¯ä¸ç§çº¿æ§å¤çï¼å¯¹äºä»»ä½éçº¿æ§çæ°æ®ç»æï¼é¨ç½²éåå¨æ¥å£ï¼å°±ç­äºé¨ç½²ä¸ç§çº¿æ§è½¬æ¢ãä¸è¿ï¼ä¸¥æ ¼å°è¯´ï¼å¯¹è±¡é¨ç½²éåå¨æ¥å£å¹¶ä¸æ¯å¾å¿è¦ï¼å ä¸ºè¿æ¶å¯¹è±¡å®éä¸è¢«å½ä½ map ç»æä½¿ç¨ï¼es5 æ²¡æ map ç»æï¼è es6 åçæä¾äºã\n\nä¸ä¸ªå¯¹è±¡å¦æè¦å·å¤å¯è¢«for...ofå¾ªç¯è°ç¨ç iterator æ¥å£ï¼å°±å¿é¡»å¨symbol.iteratorçå±æ§ä¸é¨ç½²éåå¨çææ¹æ³ï¼ååé¾ä¸çå¯¹è±¡å·æè¯¥æ¹æ³ä¹å¯ï¼ã\n\nclass rangeiterator {\n  constructor(start, stop) {\n    this.value = start;\n    this.stop = stop;\n  }\n\n  [symbol.iterator]() { return this; }\n\n  next() {\n    var value = this.value;\n    if (value < this.stop) {\n      this.value++;\n      return {done: false, value: value};\n    }\n    return {done: true, value: undefined};\n  }\n}\n\nfunction range(start, stop) {\n  return new rangeiterator(start, stop);\n}\n\nfor (var value of range(0, 3)) {\n  console.log(value); // 0, 1, 2\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nä¸é¢ä»£ç æ¯ä¸ä¸ªç±»é¨ç½² iterator æ¥å£çåæ³ãsymbol.iteratorå±æ§å¯¹åºä¸ä¸ªå½æ°ï¼æ§è¡åè¿åå½åå¯¹è±¡çéåå¨å¯¹è±¡ã\n\nä¸é¢æ¯éè¿éåå¨å®ç°æéç»æçä¾å­ã\n\nfunction obj(value) {\n  this.value = value;\n  this.next = null;\n}\n\nobj.prototype[symbol.iterator] = function() {\n  var iterator = { next: next };\n\n  var current = this;\n\n  function next() {\n    if (current) {\n      var value = current.value;\n      current = current.next;\n      return { done: false, value: value };\n    } else {\n      return { done: true };\n    }\n  }\n  return iterator;\n}\n\nvar one = new obj(1);\nvar two = new obj(2);\nvar three = new obj(3);\n\none.next = two;\ntwo.next = three;\n\nfor (var i of one){\n  console.log(i); // 1, 2, 3\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n\n\nä¸é¢ä»£ç é¦åå¨æé å½æ°çååé¾ä¸é¨ç½²symbol.iteratoræ¹æ³ï¼è°ç¨è¯¥æ¹æ³ä¼è¿åéåå¨å¯¹è±¡iteratorï¼è°ç¨è¯¥å¯¹è±¡çnextæ¹æ³ï¼å¨è¿åä¸ä¸ªå¼çåæ¶ï¼èªå¨å°åé¨æéç§»å°ä¸ä¸ä¸ªå®ä¾ã\n\nä¸é¢æ¯å¦ä¸ä¸ªä¸ºå¯¹è±¡æ·»å  iterator æ¥å£çä¾å­ã\n\nlet obj = {\n  data: [ 'hello', 'world' ],\n  [symbol.iterator]() {\n    const self = this;\n    let index = 0;\n    return {\n      next() {\n        if (index < self.data.length) {\n          return {\n            value: self.data[index++],\n            done: false\n          };\n        } else {\n          return { value: undefined, done: true };\n        }\n      }\n    };\n  }\n};\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nå¯¹äºç±»ä¼¼æ°ç»çå¯¹è±¡ï¼å­å¨æ°å¼é®åålengthå±æ§ï¼ï¼é¨ç½² iterator æ¥å£ï¼æä¸ä¸ªç®ä¾¿æ¹æ³ï¼å°±æ¯symbol.iteratoræ¹æ³ç´æ¥å¼ç¨æ°ç»ç iterator æ¥å£ã\n\nnodelist.prototype[symbol.iterator] = array.prototype[symbol.iterator];\n// æè\nnodelist.prototype[symbol.iterator] = [][symbol.iterator];\n\n[...document.queryselectorall('div')] // å¯ä»¥æ§è¡äº\n\n\n1\n2\n3\n4\n5\n\n\nnodelist å¯¹è±¡æ¯ç±»ä¼¼æ°ç»çå¯¹è±¡ï¼æ¬æ¥å°±å·æéåæ¥å£ï¼å¯ä»¥ç´æ¥éåãä¸é¢ä»£ç ä¸­ï¼æä»¬å°å®çéåæ¥å£æ¹ææ°ç»çsymbol.iteratorå±æ§ï¼å¯ä»¥çå°æ²¡æä»»ä½å½±åã\n\nä¸é¢æ¯å¦ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡è°ç¨æ°ç»çsymbol.iteratoræ¹æ³çä¾å­ã\n\nlet iterable = {\n  0: 'a',\n  1: 'b',\n  2: 'c',\n  length: 3,\n  [symbol.iterator]: array.prototype[symbol.iterator]\n};\nfor (let item of iterable) {\n  console.log(item); // 'a', 'b', 'c'\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\næ³¨æï¼æ®éå¯¹è±¡é¨ç½²æ°ç»çsymbol.iteratoræ¹æ³ï¼å¹¶æ ææã\n\nlet iterable = {\n  a: 'a',\n  b: 'b',\n  c: 'c',\n  length: 3,\n  [symbol.iterator]: array.prototype[symbol.iterator]\n};\nfor (let item of iterable) {\n  console.log(item); // undefined, undefined, undefined\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¦æsymbol.iteratoræ¹æ³å¯¹åºçä¸æ¯éåå¨çæå½æ°ï¼å³ä¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼ï¼è§£éå¼æå°ä¼æ¥éã\n\nvar obj = {};\n\nobj[symbol.iterator] = () => 1;\n\n[...obj] // typeerror: [] is not a function\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢ä»£ç ä¸­ï¼åéobjçsymbol.iteratoræ¹æ³å¯¹åºçä¸æ¯éåå¨çæå½æ°ï¼å æ­¤æ¥éã\n\næäºéåå¨æ¥å£ï¼æ°æ®ç»æå°±å¯ä»¥ç¨for...ofå¾ªç¯éåï¼è¯¦è§ä¸æï¼ï¼ä¹å¯ä»¥ä½¿ç¨whileå¾ªç¯éåã\n\nvar $iterator = iterable[symbol.iterator]();\nvar $result = $iterator.next();\nwhile (!$result.done) {\n  var x = $result.value;\n  // ...\n  $result = $iterator.next();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä¸é¢ä»£ç ä¸­ï¼iterableä»£è¡¨æç§å¯éåçæ°æ®ç»æï¼$iteratoræ¯å®çéåå¨å¯¹è±¡ãéåå¨å¯¹è±¡æ¯æ¬¡ç§»å¨æéï¼nextæ¹æ³ï¼ï¼é½æ£æ¥ä¸ä¸è¿åå¼çdoneå±æ§ï¼å¦æéåè¿æ²¡ç»æï¼å°±ç§»å¨éåå¨å¯¹è±¡çæéå°ä¸ä¸æ­¥ï¼nextæ¹æ³ï¼ï¼ä¸æ­å¾ªç¯ã\n\n\n# è°ç¨ iterator æ¥å£çåºå\n\næä¸äºåºåä¼é»è®¤è°ç¨ iterator æ¥å£ï¼å³symbol.iteratoræ¹æ³ï¼ï¼é¤äºä¸æä¼ä»ç»çfor...ofå¾ªç¯ï¼è¿æå ä¸ªå«çåºåã\n\nï¼1ï¼è§£æèµå¼\n\nå¯¹æ°ç»å set ç»æè¿è¡è§£æèµå¼æ¶ï¼ä¼é»è®¤è°ç¨symbol.iteratoræ¹æ³ã\n\nlet set = new set().add('a').add('b').add('c');\n\nlet [x,y] = set;\n// x='a'; y='b'\n\nlet [first, ...rest] = set;\n// first='a'; rest=['b','c'];\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nï¼2ï¼æ©å±è¿ç®ç¬¦\n\næ©å±è¿ç®ç¬¦ï¼...ï¼ä¹ä¼è°ç¨é»è®¤ç iterator æ¥å£ã\n\n// ä¾ä¸\nvar str = 'hello';\n[...str] //  ['h','e','l','l','o']\n\n// ä¾äº\nlet arr = ['b', 'c'];\n['a', ...arr, 'd']\n// ['a', 'b', 'c', 'd']\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nä¸é¢ä»£ç çæ©å±è¿ç®ç¬¦åé¨å°±è°ç¨ iterator æ¥å£ã\n\nå®éä¸ï¼è¿æä¾äºä¸ç§ç®ä¾¿æºå¶ï¼å¯ä»¥å°ä»»ä½é¨ç½²äº iterator æ¥å£çæ°æ®ç»æï¼è½¬ä¸ºæ°ç»ãä¹å°±æ¯è¯´ï¼åªè¦æä¸ªæ°æ®ç»æé¨ç½²äº iterator æ¥å£ï¼å°±å¯ä»¥å¯¹å®ä½¿ç¨æ©å±è¿ç®ç¬¦ï¼å°å¶è½¬ä¸ºæ°ç»ã\n\nlet arr = [...iterable];\n\n\n1\n\n\nï¼3ï¼yield*\n\nyield*åé¢è·çæ¯ä¸ä¸ªå¯éåçç»æï¼å®ä¼è°ç¨è¯¥ç»æçéåå¨æ¥å£ã\n\nlet generator = function* () {\n  yield 1;\n  yield* [2,3,4];\n  yield 5;\n};\n\nvar iterator = generator();\n\niterator.next() // { value: 1, done: false }\niterator.next() // { value: 2, done: false }\niterator.next() // { value: 3, done: false }\niterator.next() // { value: 4, done: false }\niterator.next() // { value: 5, done: false }\niterator.next() // { value: undefined, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nï¼4ï¼å¶ä»åºå\n\nç±äºæ°ç»çéåä¼è°ç¨éåå¨æ¥å£ï¼æä»¥ä»»ä½æ¥åæ°ç»ä½ä¸ºåæ°çåºåï¼å¶å®é½è°ç¨äºéåå¨æ¥å£ãä¸é¢æ¯ä¸äºä¾å­ã\n\n * for...of\n * array.from()\n * map(), set(), weakmap(), weakset()ï¼æ¯å¦new map([['a',1],['b',2]])ï¼\n * promise.all()\n * promise.race()\n\n\n# å­ç¬¦ä¸²ç iterator æ¥å£\n\nå­ç¬¦ä¸²æ¯ä¸ä¸ªç±»ä¼¼æ°ç»çå¯¹è±¡ï¼ä¹åçå·æ iterator æ¥å£ã\n\nvar somestring = \"hi\";\ntypeof somestring[symbol.iterator]\n// \"function\"\n\nvar iterator = somestring[symbol.iterator]();\n\niterator.next()  // { value: \"h\", done: false }\niterator.next()  // { value: \"i\", done: false }\niterator.next()  // { value: undefined, done: true }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç ä¸­ï¼è°ç¨symbol.iteratoræ¹æ³è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼å¨è¿ä¸ªéåå¨ä¸å¯ä»¥è°ç¨ next æ¹æ³ï¼å®ç°å¯¹äºå­ç¬¦ä¸²çéåã\n\nå¯ä»¥è¦çåççsymbol.iteratoræ¹æ³ï¼è¾¾å°ä¿®æ¹éåå¨è¡ä¸ºçç®çã\n\nvar str = new string(\"hi\");\n\n[...str] // [\"h\", \"i\"]\n\nstr[symbol.iterator] = function() {\n  return {\n    next: function() {\n      if (this._first) {\n        this._first = false;\n        return { value: \"bye\", done: false };\n      } else {\n        return { done: true };\n      }\n    },\n    _first: true\n  };\n};\n\n[...str] // [\"bye\"]\nstr // \"hi\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¸é¢ä»£ç ä¸­ï¼å­ç¬¦ä¸² str çsymbol.iteratoræ¹æ³è¢«ä¿®æ¹äºï¼æä»¥æ©å±è¿ç®ç¬¦ï¼...ï¼è¿åçå¼åæäºbyeï¼èå­ç¬¦ä¸²æ¬èº«è¿æ¯hiã\n\n\n# iterator æ¥å£ä¸ generator å½æ°\n\nsymbol.iteratoræ¹æ³çæç®åå®ç°ï¼è¿æ¯ä½¿ç¨ä¸ä¸ç« è¦ä»ç»ç generator å½æ°ã\n\nlet myiterable = {\n  [symbol.iterator]: function* () {\n    yield 1;\n    yield 2;\n    yield 3;\n  }\n}\n[...myiterable] // [1, 2, 3]\n\n// æèéç¨ä¸é¢çç®æ´åæ³\n\nlet obj = {\n  * [symbol.iterator]() {\n    yield 'hello';\n    yield 'world';\n  }\n};\n\nfor (let x of obj) {\n  console.log(x);\n}\n// \"hello\"\n// \"world\"\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nä¸é¢ä»£ç ä¸­ï¼symbol.iteratoræ¹æ³å ä¹ä¸ç¨é¨ç½²ä»»ä½ä»£ç ï¼åªè¦ç¨ yield å½ä»¤ç»åºæ¯ä¸æ­¥çè¿åå¼å³å¯ã\n\n\n# éåå¨å¯¹è±¡ç return()ï¼throw()\n\néåå¨å¯¹è±¡é¤äºå·ænextæ¹æ³ï¼è¿å¯ä»¥å·æreturnæ¹æ³åthrowæ¹æ³ãå¦æä½ èªå·±åéåå¨å¯¹è±¡çæå½æ°ï¼é£ä¹nextæ¹æ³æ¯å¿é¡»é¨ç½²çï¼returnæ¹æ³åthrowæ¹æ³æ¯å¦é¨ç½²æ¯å¯éçã\n\nreturnæ¹æ³çä½¿ç¨åºåæ¯ï¼å¦æfor...ofå¾ªç¯æåéåºï¼éå¸¸æ¯å ä¸ºåºéï¼æèæbreakè¯­å¥ï¼ï¼å°±ä¼è°ç¨returnæ¹æ³ãå¦æä¸ä¸ªå¯¹è±¡å¨å®æéååï¼éè¦æ¸çæéæ¾èµæºï¼å°±å¯ä»¥é¨ç½²returnæ¹æ³ã\n\nfunction readlinessync(file) {\n  return {\n    [symbol.iterator]() {\n      return {\n        next() {\n          return { done: false };\n        },\n        return() {\n          file.close();\n          return { done: true };\n        }\n      };\n    },\n  };\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nä¸é¢ä»£ç ä¸­ï¼å½æ°readlinessyncæ¥åä¸ä¸ªæä»¶å¯¹è±¡ä½ä¸ºåæ°ï¼è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼å¶ä¸­é¤äºnextæ¹æ³ï¼è¿é¨ç½²äºreturnæ¹æ³ãä¸é¢çä¸¤ç§æåµï¼é½ä¼è§¦åæ§è¡returnæ¹æ³ã\n\n// æåµä¸\nfor (let line of readlinessync(filename)) {\n  console.log(line);\n  break;\n}\n\n// æåµäº\nfor (let line of readlinessync(filename)) {\n  console.log(line);\n  throw new error();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸é¢ä»£ç ä¸­ï¼æåµä¸è¾åºæä»¶çç¬¬ä¸è¡ä»¥åï¼å°±ä¼æ§è¡returnæ¹æ³ï¼å³é­è¿ä¸ªæä»¶ï¼æåµäºä¼å¨æ§è¡returnæ¹æ³å³é­æä»¶ä¹åï¼åæåºéè¯¯ã\n\næ³¨æï¼returnæ¹æ³å¿é¡»è¿åä¸ä¸ªå¯¹è±¡ï¼è¿æ¯ generator è§æ ¼å³å®çã\n\nthrowæ¹æ³ä¸»è¦æ¯éå generator å½æ°ä½¿ç¨ï¼ä¸è¬çéåå¨å¯¹è±¡ç¨ä¸å°è¿ä¸ªæ¹æ³ãè¯·åéãgenerator å½æ°ãä¸ç« ã\n\n\n# for...of å¾ªç¯\n\nes6 åé´ c++ãjavaãc# å python è¯­è¨ï¼å¼å¥äºfor...ofå¾ªç¯ï¼ä½ä¸ºéåæææ°æ®ç»æçç»ä¸çæ¹æ³ã\n\nä¸ä¸ªæ°æ®ç»æåªè¦é¨ç½²äºsymbol.iteratorå±æ§ï¼å°±è¢«è§ä¸ºå·æ iterator æ¥å£ï¼å°±å¯ä»¥ç¨for...ofå¾ªç¯éåå®çæåãä¹å°±æ¯è¯´ï¼for...ofå¾ªç¯åé¨è°ç¨çæ¯æ°æ®ç»æçsymbol.iteratoræ¹æ³ã\n\nfor...ofå¾ªç¯å¯ä»¥ä½¿ç¨çèå´åæ¬æ°ç»ãset å map ç»æãæäºç±»ä¼¼æ°ç»çå¯¹è±¡ï¼æ¯å¦argumentså¯¹è±¡ãdom nodelist å¯¹è±¡ï¼ãåæç generator å¯¹è±¡ï¼ä»¥åå­ç¬¦ä¸²ã\n\n\n# æ°ç»\n\næ°ç»åçå·å¤iteratoræ¥å£ï¼å³é»è®¤é¨ç½²äºsymbol.iteratorå±æ§ï¼ï¼for...ofå¾ªç¯æ¬è´¨ä¸å°±æ¯è°ç¨è¿ä¸ªæ¥å£äº§ççéåå¨ï¼å¯ä»¥ç¨ä¸é¢çä»£ç è¯æã\n\nconst arr = ['red', 'green', 'blue'];\n\nfor(let v of arr) {\n  console.log(v); // red green blue\n}\n\nconst obj = {};\nobj[symbol.iterator] = arr[symbol.iterator].bind(arr);\n\nfor(let v of obj) {\n  console.log(v); // red green blue\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸é¢ä»£ç ä¸­ï¼ç©ºå¯¹è±¡objé¨ç½²äºæ°ç»arrçsymbol.iteratorå±æ§ï¼ç»æobjçfor...ofå¾ªç¯ï¼äº§çäºä¸arrå®å¨ä¸æ ·çç»æã\n\nfor...ofå¾ªç¯å¯ä»¥ä»£æ¿æ°ç»å®ä¾çforeachæ¹æ³ã\n\nconst arr = ['red', 'green', 'blue'];\n\narr.foreach(function (element, index) {\n  console.log(element); // red green blue\n  console.log(index);   // 0 1 2\n});\n\n\n1\n2\n3\n4\n5\n6\n\n\njavascript åæç**for...inå¾ªç¯ï¼åªè½è·å¾å¯¹è±¡çé®å**ï¼ä¸è½ç´æ¥è·åé®å¼ães6 æä¾for...ofå¾ªç¯ï¼åè®¸éåè·å¾é®å¼ã\n\nvar arr = ['a', 'b', 'c', 'd'];\n\nfor (let a in arr) {\n  console.log(a); // 0 1 2 3\n}\n\nfor (let a of arr) {\n  console.log(a); // a b c d\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nä¸é¢ä»£ç è¡¨æï¼for...inå¾ªç¯è¯»åé®åï¼for...ofå¾ªç¯è¯»åé®å¼ãå¦æè¦éè¿for...ofå¾ªç¯ï¼è·åæ°ç»çç´¢å¼ï¼å¯ä»¥åå©æ°ç»å®ä¾çentriesæ¹æ³åkeysæ¹æ³ï¼åè§ãæ°ç»çæ©å±ãä¸ç« ï¼ã\n\nfor...ofå¾ªç¯è°ç¨éåå¨æ¥å£ï¼æ°ç»çéåå¨æ¥å£åªè¿åå·ææ°å­ç´¢å¼çå±æ§ãè¿ä¸ç¹è·for...inå¾ªç¯ä¹ä¸ä¸æ ·ã\n\nlet arr = [3, 5, 7];\narr.foo = 'hello';\n\nfor (let i in arr) {\n  console.log(i); // \"0\", \"1\", \"2\", \"foo\"\n}\n\nfor (let i of arr) {\n  console.log(i); //  \"3\", \"5\", \"7\"\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nä¸é¢ä»£ç ä¸­ï¼for...ofå¾ªç¯ä¸ä¼è¿åæ°ç»arrçfooå±æ§ã\n\n\n# set å map ç»æ\n\nset å map ç»æä¹åçå·æ iterator æ¥å£ï¼å¯ä»¥ç´æ¥ä½¿ç¨for...ofå¾ªç¯ã\n\nvar engines = new set([\"gecko\", \"trident\", \"webkit\", \"webkit\"]);\nfor (var e of engines) {\n  console.log(e);\n}\n// gecko\n// trident\n// webkit\n\nvar es6 = new map();\nes6.set(\"edition\", 6);\nes6.set(\"committee\", \"tc39\");\nes6.set(\"standard\", \"ecma-262\");\nfor (var [name, value] of es6) {\n  console.log(name + \": \" + value);\n}\n// edition: 6\n// committee: tc39\n// standard: ecma-262\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nä¸é¢ä»£ç æ¼ç¤ºäºå¦ä½éå set ç»æå map ç»æãå¼å¾æ³¨æçå°æ¹æä¸¤ä¸ªï¼é¦åï¼éåçé¡ºåºæ¯æç§åä¸ªæåè¢«æ·»å è¿æ°æ®ç»æçé¡ºåºãå¶æ¬¡ï¼set ç»æéåæ¶ï¼è¿åçæ¯ä¸ä¸ªå¼ï¼è map ç»æéåæ¶ï¼è¿åçæ¯ä¸ä¸ªæ°ç»ï¼è¯¥æ°ç»çä¸¤ä¸ªæååå«ä¸ºå½å map æåçé®ååé®å¼ã\n\nlet map = new map().set('a', 1).set('b', 2);\nfor (let pair of map) {\n  console.log(pair);\n}\n// ['a', 1]\n// ['b', 2]\n\nfor (let [key, value] of map) {\n  console.log(key + ' : ' + value);\n}\n// a : 1\n// b : 2\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n\n# è®¡ç®çæçæ°æ®ç»æ\n\næäºæ°æ®ç»ææ¯å¨ç°ææ°æ®ç»æçåºç¡ä¸ï¼è®¡ç®çæçãæ¯å¦ï¼es6 çæ°ç»ãsetãmap é½é¨ç½²äºä»¥ä¸ä¸ä¸ªæ¹æ³ï¼è°ç¨åé½è¿åéåå¨å¯¹è±¡ã\n\n * entries() è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼ç¨æ¥éå[é®å, é®å¼]ç»æçæ°ç»ãå¯¹äºæ°ç»ï¼é®åå°±æ¯ç´¢å¼å¼ï¼å¯¹äº setï¼é®åä¸é®å¼ç¸åãmap ç»æç iterator æ¥å£ï¼é»è®¤å°±æ¯è°ç¨entriesæ¹æ³ã\n * keys() è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼ç¨æ¥éåææçé®åã\n * values() è¿åä¸ä¸ªéåå¨å¯¹è±¡ï¼ç¨æ¥éåææçé®å¼ã\n\nè¿ä¸ä¸ªæ¹æ³è°ç¨åçæçéåå¨å¯¹è±¡ï¼æéåçé½æ¯è®¡ç®çæçæ°æ®ç»æã\n\nlet arr = ['a', 'b', 'c'];\nfor (let pair of arr.entries()) {\n  console.log(pair);\n}\n// [0, 'a']\n// [1, 'b']\n// [2, 'c']\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n# ç±»ä¼¼æ°ç»çå¯¹è±¡\n\nç±»ä¼¼æ°ç»çå¯¹è±¡åæ¬å¥½å ç±»ãä¸é¢æ¯for...ofå¾ªç¯ç¨äºå­ç¬¦ä¸²ãdom nodelist å¯¹è±¡ãargumentså¯¹è±¡çä¾å­ã\n\n// å­ç¬¦ä¸²\nlet str = \"hello\";\n\nfor (let s of str) {\n  console.log(s); // h e l l o\n}\n\n// dom nodelistå¯¹è±¡\nlet paras = document.queryselectorall(\"p\");\n\nfor (let p of paras) {\n  p.classlist.add(\"test\");\n}\n\n// argumentså¯¹è±¡\nfunction printargs() {\n  for (let x of arguments) {\n    console.log(x);\n  }\n}\nprintargs('a', 'b');\n// 'a'\n// 'b'\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nå¯¹äºå­ç¬¦ä¸²æ¥è¯´ï¼for...ofå¾ªç¯è¿æä¸ä¸ªç¹ç¹ï¼å°±æ¯ä¼æ­£ç¡®è¯å« 32 ä½ utf-16 å­ç¬¦ã\n\nfor (let x of 'a\\ud83d\\udc0a') {\n  console.log(x);\n}\n// 'a'\n// '\\ud83d\\udc0a'\n\n\n1\n2\n3\n4\n5\n\n\nå¹¶ä¸æ¯ææç±»ä¼¼æ°ç»çå¯¹è±¡é½å·æ iterator æ¥å£ï¼ä¸ä¸ªç®ä¾¿çè§£å³æ¹æ³ï¼å°±æ¯ä½¿ç¨array.fromæ¹æ³å°å¶è½¬ä¸ºæ°ç»ã\n\nlet arraylike = { length: 2, 0: 'a', 1: 'b' };\n\n// æ¥é\nfor (let x of arraylike) {\n  console.log(x);\n}\n\n// æ­£ç¡®\nfor (let x of array.from(arraylike)) {\n  console.log(x);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# å¯¹è±¡\n\nå¯¹äºæ®éçå¯¹è±¡ï¼for...ofç»æä¸è½ç´æ¥ä½¿ç¨ï¼ä¼æ¥éï¼å¿é¡»é¨ç½²äº iterator æ¥å£åæè½ä½¿ç¨ãä½æ¯ï¼è¿æ ·æåµä¸ï¼for...inå¾ªç¯ä¾ç¶å¯ä»¥ç¨æ¥éåé®åã\n\nlet es6 = {\n  edition: 6,\n  committee: \"tc39\",\n  standard: \"ecma-262\"\n};\n\nfor (let e in es6) {\n  console.log(e);\n}\n// edition\n// committee\n// standard\n\nfor (let e of es6) {\n  console.log(e);\n}\n// typeerror: es6[symbol.iterator] is not a function\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\nä¸é¢ä»£ç è¡¨ç¤ºï¼å¯¹äºæ®éçå¯¹è±¡ï¼for...inå¾ªç¯å¯ä»¥éåé®åï¼for...ofå¾ªç¯ä¼æ¥éã\n\nä¸ç§è§£å³æ¹æ³æ¯ï¼ä½¿ç¨object.keysæ¹æ³å°å¯¹è±¡çé®åçæä¸ä¸ªæ°ç»ï¼ç¶åéåè¿ä¸ªæ°ç»ã\n\nfor (var key of object.keys(someobject)) {\n  console.log(key + ': ' + someobject[key]);\n}\n\n\n1\n2\n3\n\n\nå¦ä¸ä¸ªæ¹æ³æ¯ä½¿ç¨ generator å½æ°å°å¯¹è±¡éæ°åè£ä¸ä¸ã\n\nfunction* entries(obj) {\n  for (let key of object.keys(obj)) {\n    yield [key, obj[key]];\n  }\n}\n\nfor (let [key, value] of entries(obj)) {\n  console.log(key, '->', value);\n}\n// a -> 1\n// b -> 2\n// c -> 3\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n\n# ä¸å¶ä»éåè¯­æ³çæ¯è¾\n\nä»¥æ°ç»ä¸ºä¾ï¼javascript æä¾å¤ç§éåè¯­æ³ãæåå§çåæ³å°±æ¯forå¾ªç¯ã\n\nfor (var index = 0; index < myarray.length; index++) {\n  console.log(myarray[index]);\n}\n\n\n1\n2\n3\n\n\nè¿ç§åæ³æ¯è¾éº»ç¦ï¼å æ­¤æ°ç»æä¾åç½®çforeachæ¹æ³ã\n\nmyarray.foreach(function (value) {\n  console.log(value);\n});\n\n\n1\n2\n3\n\n\nè¿ç§åæ³çé®é¢å¨äºï¼æ æ³ä¸­éè·³åºforeachå¾ªç¯ï¼breakå½ä»¤æreturnå½ä»¤é½ä¸è½å¥æã\n\nfor...inå¾ªç¯å¯ä»¥éåæ°ç»çé®åã\n\nfor (var index in myarray) {\n  console.log(myarray[index]);\n}\n\n\n1\n2\n3\n\n\nfor...inå¾ªç¯æå ä¸ªç¼ºç¹ã\n\n * æ°ç»çé®åæ¯æ°å­ï¼ä½æ¯for...inå¾ªç¯æ¯ä»¥å­ç¬¦ä¸²ä½ä¸ºé®åâ0âãâ1âãâ2âç­ç­ã\n * for...inå¾ªç¯ä¸ä»éåæ°å­é®åï¼è¿ä¼éåæå¨æ·»å çå¶ä»é®ï¼çè³åæ¬ååé¾ä¸çé®ã\n * æäºæåµä¸ï¼for...inå¾ªç¯ä¼ä»¥ä»»æé¡ºåºéåé®åã\n\næ»ä¹ï¼for...inå¾ªç¯ä¸»è¦æ¯ä¸ºéåå¯¹è±¡èè®¾è®¡çï¼ä¸éç¨äºéåæ°ç»ã\n\nfor...ofå¾ªç¯ç¸æ¯ä¸é¢å ç§åæ³ï¼æä¸äºæ¾èçä¼ç¹ã\n\nfor (let value of myarray) {\n  console.log(value);\n}\n\n\n1\n2\n3\n\n * æçåfor...inä¸æ ·çç®æ´è¯­æ³ï¼ä½æ¯æ²¡æfor...iné£äºç¼ºç¹ã\n * ä¸åäºforeachæ¹æ³ï¼å®å¯ä»¥ä¸breakãcontinueåreturnéåä½¿ç¨ã\n * æä¾äºéåæææ°æ®ç»æçç»ä¸æä½æ¥å£ã\n\nä¸é¢æ¯ä¸ä¸ªä½¿ç¨ break è¯­å¥ï¼è·³åºfor...ofå¾ªç¯çä¾å­ã\n\nfor (var n of fibonacci) {\n  if (n > 1000)\n    break;\n  console.log(n);\n}\n\n\n1\n2\n3\n4\n5\n\n\nä¸é¢çä¾å­ï¼ä¼è¾åºææ³¢çº³å¥æ°åå°äºç­äº 1000 çé¡¹ãå¦æå½åé¡¹å¤§äº 1000ï¼å°±ä¼ä½¿ç¨breakè¯­å¥è·³åºfor...ofå¾ªç¯ã",charsets:{cjk:!0},lastUpdated:"2022/02/04, 14:06:01",lastUpdatedTimestamp:1643983561e3}],themeConfig:{nav:[{text:"é¦é¡µ",link:"/"},{text:"Java",items:[{text:"Javaåºç¡",link:"/java/"},{text:"Javaé«çº§",items:[{text:"Javaå¹¶å",link:"/note/es6/"},{text:"Javaèææº",link:"/note/es6/"},{text:"JDKæ°ç¹æ§",link:"/note/es6/"}]},{text:"Java Web",link:"/note/es6/"},{text:"æ°æ®ç»æä¸ç®æ³",link:"/note/es6/"},{text:"è®¡ç®æºç½ç»",link:"/note/es6/"}]},{text:"æ¡æ¶",items:[{text:"Spring",link:"/back-end/"},{text:"Spring MVC",link:"/back-end/"},{text:"Spring Boot",link:"/back-end/"},{text:"Spring Cloud",link:"/back-end/"},{text:"Spring Cloud Alibaba",link:"/back-end/"},{text:"Spring Security",link:"/pages/c55839/"},{text:"Mybatis",link:"/back-end/"},{text:"Mybatis Plus",link:"/back-end/"},{text:"Mysql",link:"/back-end/"},{text:"Redis",link:"/back-end/"},{text:"Zookeeper",link:"/back-end/"},{text:"Dubbo",link:"/back-end/"},{text:"Kafka",link:"/back-end/"},{text:"Apollo",link:"/back-end/"},{text:"å¤§æ°æ®",link:"/back-end/",items:[{text:"Hbase",link:"/pages/261b24/"},{text:"Spark",link:"/pages/c55839/"},{text:"ClickHouse",link:"/note/git/"}]}]},{text:"åç«¯",link:"/front-end/",items:[{text:"HTML",link:"/back-end/"},{text:"Javascript",link:"/back-end/"},{text:"CSS",link:"/back-end/"},{text:"ES6",link:"/back-end/"},{text:"Nodejs",link:"/back-end/"},{text:"Webpack",link:"/back-end/"},{text:"Vue",link:"/back-end/",items:[{text:"Vue Router",link:"/pages/8309a5b876fc95e3/"},{text:"Vuex",link:"/pages/0a83b083bdf257cb/"},{text:"ES6",link:"/note/es6/"}]}]},{text:"æ¶æ",link:"/design/",items:[{text:"è®¾è®¡æ¨¡å¼",link:"/back-end/"}]},{text:"è¿ç»´",link:"/operation/",items:[{text:"Linux",link:"/back-end/"},{text:"Shellèæ¬",link:"/back-end/"},{text:"Docker",link:"/back-end/"},{text:"Kubernetes",link:"/back-end/"}]},{text:"å·¥å·",link:"/tools/",items:[{text:"Maven",link:"/back-end/"},{text:"SVN",link:"/back-end/"},{text:"Git",link:"/back-end/"},{text:"Idea",link:"/back-end/"},{text:"Windows",link:"/back-end/"}]},{text:"é¢è¯",link:"/interview/",items:[{text:"æ°æ®ç»æä¸ç®æ³",link:"/back-end/"},{text:"Java",link:"/pages/bbda94/"},{text:"æ¡æ¶",link:"/back-end/"},{text:"åå¸å¼",link:"/back-end/"}]},{text:"æ´å¤",link:"/technology/",items:[{text:"ææ¯ææ¡£",link:"/pages/9a7ee40fc232253e/"},{text:"GitHubæå·§",link:"/pages/4c778760be26d8b3/"},{text:"Nodejs",link:"/pages/117708e0af7f0bd9/"},{text:"åå®¢æ­å»º",link:"/pages/41f87d890d0a02af/"}]},{text:"ç´¢å¼",link:"/archives/",items:[{text:"åç±»",link:"/categories/"},{text:"æ ç­¾",link:"/tags/"},{text:"å½æ¡£",link:"/archives/"}]}],sidebarDepth:2,logo:"/img/logo.png",repo:"xugaoyi/vuepress-theme-vdoing",searchMaxSuggestions:10,lastUpdated:"ä¸æ¬¡æ´æ°",docsDir:"docs",editLinks:!0,editLinkText:"ç¼è¾",sidebar:{"/00.ç®å½é¡µ/":[["50.é¢è¯.md","é¢è¯","/interview"]],catalogue:{"é¢è¯":"/interview","ãES6 æç¨ãç¬è®°":"/note/es6/"},"/05.Java/":[{title:"Javaåºç¡",collapsable:!0,children:[["05.Javaåºç¡/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/8a3d2e/"]]},{title:"Javaå¹¶å",collapsable:!0,children:[["10.Javaå¹¶å/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/616956/"]]},{title:"Javaèææº",collapsable:!0,children:[["15.Javaèææº/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/14d613/"]]},{title:"JDKæ°ç¹æ§",collapsable:!0,children:[["20.JDKæ°ç¹æ§/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/101235/"]]},{title:"Java Web",collapsable:!0,children:[["25.Java Web/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/b9843d/"]]},{title:"æ°æ®ç»æåç®æ³",collapsable:!0,children:[["30.æ°æ®ç»æåç®æ³/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/48f257/"]]},{title:"è®¡ç®æºç½ç»",collapsable:!0,children:[["35.è®¡ç®æºç½ç»/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/f9d65e/"]]}],"/10.æ¡æ¶/":[{title:"Spring",collapsable:!0,children:[["05.Spring/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/d4d364/"]]},{title:"Spring MVC",collapsable:!0,children:[["10.Spring MVC/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/72f279/"]]},{title:"Spring Boot",collapsable:!0,children:[["15.Spring Boot/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/815499/"]]},{title:"Spring Cloud",collapsable:!0,children:[["20.Spring Cloud/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/82b6d4/"]]},{title:"Spring Cloud Alibaba",collapsable:!0,children:[["21.Spring Cloud Alibaba/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/075df8/"]]},{title:"Spring Security",collapsable:!0,children:[["25.Spring Security/01.ãèå¾ãSpring Security(ä¸) ââ Architecture Overview.md","ãèå¾ãSpring Security(ä¸) ââ Architecture Overview","/pages/c55839/"],["25.Spring Security/02.ãèå¾ãSpring Security(äº) ââ Guides.md","ãèå¾ãSpring Security(äº) ââ Guides","/pages/188a19/"],["25.Spring Security/03.ãèå¾ãSpring Security(ä¸) ââ æ ¸å¿éç½®è§£è¯».md","ãèå¾ãSpring Security(ä¸) ââ æ ¸å¿éç½®è§£è¯»","/pages/9327fd/"],["25.Spring Security/04.ãèå¾ãSpring Security(å) ââ æ ¸å¿è¿æ»¤å¨æºç åæ.md","ãèå¾ãSpring Security(å) ââ æ ¸å¿è¿æ»¤å¨æºç åæ","/pages/bb2ce5/"],["25.Spring Security/05.ãèå¾ãSpring Security(äº) ââ å¨æå®ç°ä¸ä¸ª IP_Login.md","ãèå¾ãSpring Security(äº) ââ å¨æå®ç°ä¸ä¸ª IP_Login","/pages/754b42/"],["25.Spring Security/06.ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼ä¸ï¼.md","ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼ä¸ï¼","/pages/79202c/"],["25.Spring Security/07.ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼äºï¼.md","ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼äºï¼","/pages/3e6453/"],["25.Spring Security/08.ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼ä¸ï¼.md","ãèå¾ãä»é¶å¼å§ç Spring Security OAuth2ï¼ä¸ï¼","/pages/202614/"],["25.Spring Security/09.ãèå¾ãè¯¥å¦ä½è®¾è®¡ä½ ç PasswordEncoder.md","ãèå¾ãè¯¥å¦ä½è®¾è®¡ä½ ç PasswordEncoder","/pages/9be0a1/"],["25.Spring Security/10.Spring Security å¥é¨ç¯.md","Spring Security å¥é¨ç¯","/pages/605664/"]]},{title:"Mybatis",collapsable:!0,children:[["30.Mybatis/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/d07b16/"]]},{title:"Mybatis Plus",collapsable:!0,children:[["35.Mybatis Plus/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/d35a9e/"]]},{title:"Redis",collapsable:!0,children:[["40.Redis/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/b8166d/"],["40.Redis/20.å¸éè¿æ»¤å¨.md","å¸éè¿æ»¤å¨","/pages/d09904/"]]},{title:"Mysql",collapsable:!0,children:[{title:"SQL",collapsable:!0,children:[["45.Mysql/05.SQL/05.EXISTSï¼NOT EXISTS ï¼ è¯­å¥.md","EXISTSï¼NOT EXISTS ï¼ è¯­å¥","/pages/ee8f7b/"]]}]},{title:"Zookeeper",collapsable:!0,children:[["50.Zookeeper/10.å®ä¾è¯¦è§£ZooKeeper ZABåè®®ãåå¸å¼éä¸é¢å¯¼éä¸¾.md","å®ä¾è¯¦è§£ZooKeeper ZABåè®®ãåå¸å¼éä¸é¢å¯¼éä¸¾","/pages/bc1a45/"]]},{title:"Dubbo",collapsable:!0,children:[["55.Dubbo/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/017da3/"]]},{title:"Kafka",collapsable:!0,children:[["60.Kafka/01.Kafkaåæºçå®è£.md","Kafkaåæºçå®è£","/pages/e5e3af/"],["60.Kafka/10.kafkaå½ä»¤æ´ç.md","kafkaå½ä»¤æ´ç","/pages/bc987c/"],["60.Kafka/20.kafkaå®¢æ·ç«¯ç¤ºä¾ä»£ç .md","kafkaå®¢æ·ç«¯ç¤ºä¾ä»£ç ","/pages/4975ea/"]]},{title:"Apollo",collapsable:!0,children:[["65.Apollo/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/fb3719/"]]},{title:"å¤§æ°æ®",collapsable:!0,children:[{title:"Hbase",collapsable:!0,children:[["70.å¤§æ°æ®/05.Hbase/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/7f0c55/"]]},{title:"Spark",collapsable:!0,children:[["70.å¤§æ°æ®/10.Spark/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/466af9/"]]},{title:"ClickHouse",collapsable:!0,children:[["70.å¤§æ°æ®/15.ClickHouse/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/d96f04/"]]}]}],"/100.å¶ä»/":[{title:"ææ¯ææ¡£",collapsable:!0,children:[["01.ææ¯ææ¡£/01.Gitä½¿ç¨æå.md","Gitä½¿ç¨æå","/pages/9a7ee40fc232253e"],["01.ææ¯ææ¡£/02.Markdownä½¿ç¨æç¨.md","Markdownä½¿ç¨æç¨","/pages/ad247c4332211551"],["01.ææ¯ææ¡£/03.npmå¸¸ç¨å½ä»¤.md","npmå¸¸ç¨å½ä»¤","/pages/61f2f95fd7da14fd"],["01.ææ¯ææ¡£/10.npm packageJsonå±æ§è¯¦è§£.md","npm packageJsonå±æ§è¯¦è§£","/pages/dec4f3f00e71a312"],["01.ææ¯ææ¡£/15.yamlè¯­è¨æç¨.md","yamlè¯­è¨æç¨","/pages/4e8444e2d534d14f"]]},{title:"GitHubæå·§",collapsable:!0,children:[["02.GitHubæå·§/01.GitHubé«çº§æç´¢æå·§.md","GitHubé«çº§æç´¢æå·§","/pages/4c778760be26d8b3"],["02.GitHubæå·§/02.GitHub Actions å®ç°èªå¨é¨ç½²éæåå®¢.md","GitHub Actions å®ç°èªå¨é¨ç½²éæåå®¢","/pages/6b9d359ec5aa5019"],["02.GitHubæå·§/03.GitHub Actions å®æ¶è¿è¡ä»£ç ï¼æ¯å¤©å®æ¶ç¾åº¦é¾æ¥æ¨é.md","GitHub Actions å®æ¶è¿è¡ä»£ç ï¼æ¯å¤©å®æ¶ç¾åº¦é¾æ¥æ¨é","/pages/f44d2f9ad04ab8d3"],["02.GitHubæå·§/10.GitHubå éä¸è½½é¡¹ç®çæ¹æ³.md","GitHubå éä¸è½½é¡¹ç®çæ¹æ³","/pages/95331c6a9613faf8"]]},{title:"Nodejs",collapsable:!0,children:[["03.Nodejs/01.nodejséå½è¯»åæææä»¶.md","nodejséå½è¯»åæææä»¶","/pages/117708e0af7f0bd9"]]},{title:"åå®¢æ­å»º",collapsable:!0,children:[["04.åå®¢æ­å»º/01.è§£å³ç¾åº¦æ æ³æ¶å½æ­å»ºå¨GitHubä¸çä¸ªäººåå®¢çé®é¢.md","è§£å³ç¾åº¦æ æ³æ¶å½æ­å»ºå¨GitHubä¸çä¸ªäººåå®¢çé®é¢","/pages/41f87d890d0a02af"],["04.åå®¢æ­å»º/02.ä½¿ç¨Gitalkå®ç°éæåå®¢æ åå°è¯è®ºç³»ç».md","ä½¿ç¨Gitalkå®ç°éæåå®¢æ åå°è¯è®ºç³»ç»","/pages/1da0bf9a988eafe5"],["04.åå®¢æ­å»º/03.GitHub + jsDelivr + TinyPNG+ PicGo æé ç¨³å®å¿«éãé«æåè´¹å¾åº.md","GitHub + jsDelivr + TinyPNG+ PicGo æé ç¨³å®å¿«éãé«æåè´¹å¾åº","/pages/a5f73af5185fdf0a"],["04.åå®¢æ­å»º/10.vdoingä¸»é¢ææå¾.md","vdoingä¸»é¢ææå¾","/pages/d557b9a89a215d2e"]]}],"/15.åç«¯/":[{title:"HTML",collapsable:!0,children:[["05.HTML/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/f1cf70/"]]},{title:"JavaScript",collapsable:!0,children:[["10.JavaScript/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/b0cbfe/"]]},{title:"CSS",collapsable:!0,children:[["15.CSS/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/1b9d03/"]]},{title:"ES6",collapsable:!0,children:[["20.ES6/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/f94942/"]]},{title:"Nodejs",collapsable:!0,children:[["25.Nodejs/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/6397c2/"]]},{title:"Webpack",collapsable:!0,children:[["30.Webpack/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/3a3093/"]]},{title:"Vue",collapsable:!0,children:[{title:"Vue Router",collapsable:!0,children:[["35.Vue/05.Vue Router/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/45f613/"]]},{title:"Vuex",collapsable:!0,children:[["35.Vue/10.Vuex/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/8b11e8/"]]}]},{title:"å­¦ä¹ ç¬è®°",collapsable:!0,children:[["40.å­¦ä¹ ç¬è®°/10.ãES6 æç¨ãç¬è®°.md","ãES6 æç¨ãç¬è®°","/note/es6/"]]}],"/20.æ¶æ/":[{title:"è®¾è®¡æ¨¡å¼",collapsable:!0,children:[["05.è®¾è®¡æ¨¡å¼/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/1cbc1f/"]]}],"/25.è¿ç»´/":[{title:"Linux",collapsable:!0,children:[["05.Linux/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/be47c5/"]]},{title:"Shellèæ¬",collapsable:!0,children:[["10.Shellèæ¬/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/48ee28/"]]},{title:"Tomcat",collapsable:!0,children:[["40.Tomcat/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/c0a158/"]]},{title:"Nginx",collapsable:!0,children:[["45.Nginx/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/22279f/"]]},{title:"Docker",collapsable:!0,children:[["50.Docker/01.Docker åçº§ç¯.md","Docker åçº§ç¯","/pages/261b24/"],["50.Docker/02.Docker ä¸­çº§ç¯.md","Docker ä¸­çº§ç¯","/pages/5ca863/"],["50.Docker/03.Docker é«çº§å®è·µç¯.md","Docker é«çº§å®è·µç¯","/pages/a24e91/"],["50.Docker/04.Docker ç½ç»æ¨¡å¼åå®¹å¨é´éä¿¡.md","Docker ç½ç»æ¨¡å¼åå®¹å¨é´éä¿¡","/pages/8a7664/"],["50.Docker/05.Docker æ­å»º Redis Cluster éç¾¤.md","Docker æ­å»º Redis Cluster éç¾¤","/pages/457953/"]]},{title:"kubernetes",collapsable:!0,children:[["60.kubernetes/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/1b1528/"]]}],"/30.å·¥å·/":[{title:"maven",collapsable:!0,children:[["05.maven/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/2c13c2/"]]},{title:"svn",collapsable:!0,children:[["10.svn/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/2ec465/"]]},{title:"git",collapsable:!0,children:[["15.git/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/657a34/"]]},{title:"idea",collapsable:!0,children:[["20.idea/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/891624/"]]},{title:"windows",collapsable:!0,children:[["25.windows/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/df2d8d/"]]}],"/35.é¢è¯/":[{title:"Java",collapsable:!0,children:[{title:"Javaåºç¡",collapsable:!0,children:[["05.Java/05.Javaåºç¡/05.Java åºç¡.md","Java åºç¡","/pages/bbda94/"],["05.Java/05.Javaåºç¡/10.Java å®¹å¨.md","Java å®¹å¨","/pages/17acab/"],["05.Java/05.Javaåºç¡/15.Java IO.md","Java IO","/pages/5859c4/"],["05.Java/05.Javaåºç¡/30.JDK å¨æä»£ç.md","JDK å¨æä»£ç","/pages/e5ea78/"]]}]},{title:"Java Web",collapsable:!0,children:[["10.Java Web/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/14fc4f/"]]},{title:"æ¡æ¶åç",collapsable:!0,children:[["15.æ¡æ¶åç/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/1ca50c/"]]},{title:"æ°æ®åº",collapsable:!0,children:[["20.æ°æ®åº/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/6678f4/"]]},{title:"è®¾è®¡æ¨¡å¼",collapsable:!0,children:[["25.è®¾è®¡æ¨¡å¼/10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/ddeaf7/"]]},{title:"è®¡ç®æºåºç¡",collapsable:!0,children:[["30.è®¡ç®æºåºç¡/10.IO æ¨¡å.md","IO æ¨¡å","/pages/bc7c50/"]]}],"/40.æ´å¤/":[["10.Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£.md","Redisé«çº§å®¢æ·ç«¯Lettuceè¯¦è§£","/pages/bdd0da/"]],"/ãES6 æç¨ãç¬è®°/":[["01.ECMAScript 6 ç®ä».md","ECMAScript 6 ç®ä»","/pages/f344d070a1031ef7"],["02.let å const å½ä»¤.md","let å const å½ä»¤","/pages/c1edd70a6b7c7872"],["03.åéçè§£æèµå¼.md","åéçè§£æèµå¼","/pages/b1ab10a62f7564da"],["04.å­ç¬¦ä¸²çæ©å±.md","å­ç¬¦ä¸²çæ©å±","/pages/ca89eca8adeba5f4"],["05.å­ç¬¦ä¸²çæ°å¢æ¹æ³.md","å­ç¬¦ä¸²çæ°å¢æ¹æ³","/pages/a650b4a0ebfc9350"],["06.æ­£åçæ©å±.md","æ­£åçæ©å±","/pages/0473261a6ab0ee8c"],["07.æ°å¼çæ©å±.md","æ°å¼çæ©å±","/pages/5dfea9a0f2d1a392"],["08.å½æ°çæ©å±.md","å½æ°çæ©å±","/pages/8ed309d668b20264"],["09.æ°ç»çæ©å±.md","æ°ç»çæ©å±","/pages/e34009d60d8bc4b2"],["10.å¯¹è±¡çæ©å±.md","å¯¹è±¡çæ©å±","/pages/b5e3e0a0ff6e9c25"],["11.å¯¹è±¡çæ°å¢æ¹æ³.md","å¯¹è±¡çæ°å¢æ¹æ³","/pages/e85e68947502cf90"],["12.Symbol.md","Symbol","/pages/02c86eb2792f3262"],["13.Set å Map æ°æ®ç»æ.md","Set å Map æ°æ®ç»æ","/pages/0c21dae358fca16b"],["14.Proxy.md","Proxy","/pages/f56ec2ab97d60483"],["15.Reflect.md","Reflect","/pages/74de3e45e4491e95"],["16.Promise å¯¹è±¡.md","Promise å¯¹è±¡","/pages/2810ae8985e9bd52"],["17.Iterator å for-of å¾ªç¯.md","Iterator å for-of å¾ªç¯","/pages/48df907ad3570f3d"],["18.Generator å½æ°çè¯­æ³.md","Generator å½æ°çè¯­æ³","/pages/718b48ed9ce0adce"],["19.Generator å½æ°çå¼æ­¥åºç¨.md","Generator å½æ°çå¼æ­¥åºç¨","/pages/75af7031eb66847b"],["20.async å½æ°.md","async å½æ°","/pages/3777253e65bac487"],["21.Class çåºæ¬è¯­æ³.md","Class çåºæ¬è¯­æ³","/pages/e831e1593c82bbe0"],["22.Class çç»§æ¿.md","Class çç»§æ¿","/pages/83f8c3a0cd87dd83"],["23.Module çè¯­æ³.md","Module çè¯­æ³","/pages/efe2fb04eb8ac5fb"],["24.Module çå è½½å®ç°.md","Module çå è½½å®ç°","/pages/a79ca2e64ceae213"],["25.ç¼ç¨é£æ ¼.md","ç¼ç¨é£æ ¼","/pages/984bf549204bb266"],["26.è¯»æ ECMAScript è§æ ¼.md","è¯»æ ECMAScript è§æ ¼","/pages/32c35f7651d6e58e"],["27.å¼æ­¥éåå¨.md","å¼æ­¥éåå¨","/pages/16121351be68691b"],["28.ArrayBuffer.md","ArrayBuffer","/pages/a2ba314746bfdbdd"],["29.ææ°ææ¡.md","ææ°ææ¡","/pages/7188882b8d65af1b"],["30.è£é¥°å¨.md","è£é¥°å¨","/pages/e97bc1e5626b082c"],["31.å½æ°å¼ç¼ç¨.md","å½æ°å¼ç¼ç¨","/pages/1cf50330655efc69"],["32.Mixin.md","Mixin","/pages/6a8e2dc558da1b39"],["33.SIMD.md","SIMD","/pages/8e8f80f69b775a56"],["34.åèé¾æ¥.md","åèé¾æ¥","/pages/ea6f3b870f6dab69"]],"/ãGitãå­¦ä¹ ç¬è®°/":[{title:"æå",collapsable:!0,children:[["10.æå/00.å¸¸ç¨Gitå½ä»¤æ¸å.md","å¸¸ç¨Gitå½ä»¤æ¸å","/pages/8292d8/"],["10.æå/03.Gitååºåå¹¶.md","Gitååºåå¹¶","/pages/c10281/"],["10.æå/06.Gitå½ä»¤æç»´å¯¼å¾.md","Gitå½ä»¤æç»´å¯¼å¾","/pages/4cbc21/"],["10.æå/07.æ¹åç§å¤§è®¡ç®æºç½ç».md","æ¹åç§å¤§è®¡ç®æºç½ç»","/pages/4bdb82/"]]},{title:"ææ¡£ç¬è®°",collapsable:!0,children:[["20.ææ¡£ç¬è®°/10.Gitåºç¡ä¸å½ä»¤.md","Gitåºç¡ä¸å½ä»¤","/pages/635088/"],["20.ææ¡£ç¬è®°/20.Gitåæ¯-åæ¯åç.md","Gitåæ¯-åæ¯åç","/pages/4bef1a/"],["20.ææ¡£ç¬è®°/30.Gitåæ¯çæ°å»ºä¸åå¹¶-åæ¯æä½.md","Gitåæ¯çæ°å»ºä¸åå¹¶-åæ¯æä½","/pages/ea5a8c/"],["20.ææ¡£ç¬è®°/40.Gitåæ¯ç®¡ç-æ¥çåæ¯.md","Gitåæ¯ç®¡ç-æ¥çåæ¯","/pages/a399b3/"],["20.ææ¡£ç¬è®°/50.Gitåæ¯å¼åå·¥ä½æµ.md","Gitåæ¯å¼åå·¥ä½æµ","/pages/49ee30/"],["20.ææ¡£ç¬è®°/60.Gitåæ¯-è¿ç¨åæ¯.md","Gitåæ¯-è¿ç¨åæ¯","/pages/574d62/"],["20.ææ¡£ç¬è®°/70.Gitåæ¯-ååº.md","Gitåæ¯-ååº","/pages/3a3247/"],["20.ææ¡£ç¬è®°/80.Gitå·¥å·-æ¥çä¿®è®¢çæ¬.md","Gitå·¥å·-æ¥çä¿®è®¢çæ¬","/pages/c984d1/"],["20.ææ¡£ç¬è®°/90.Gitå·¥å·-äº¤äºå¼æå­.md","Gitå·¥å·-äº¤äºå¼æå­","/pages/76d859/"],["20.ææ¡£ç¬è®°/100.Gitå·¥å·-éååå².md","Gitå·¥å·-éååå²","/pages/1832fe/"],["20.ææ¡£ç¬è®°/110.Gitå·¥å·-éç½®æ­å¯.md","Gitå·¥å·-éç½®æ­å¯","/pages/d9e9c6/"]]}]},author:{name:"xugaoyi",link:"https://github.com/xugaoyi"},blogger:{avatar:"https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200103123203.jpg",name:"Evan Xu",slogan:"åç«¯ççå°å­¦ç"},social:{icons:[{iconClass:"icon-youjian",title:"åé®ä»¶",link:"mailto:894072666@qq.com"},{iconClass:"icon-github",title:"GitHub",link:"https://github.com/xugaoyi"},{iconClass:"icon-erji",title:"å¬é³ä¹",link:"https://music.163.com/#/playlist?id=755597173"}]},footer:{createYear:2019,copyrightInfo:'Evan Xu | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a>'},htmlModules:{homeSidebarB:'<div style="padding: 0.95rem">\n    <p style="\n      color: var(--textColor);\n      opacity: 0.9;\n      font-size: 20px;\n      font-weight: bold;\n      margin: 0 0 8px 0;\n    ">å¬ä¼å·</p>\n    <img src="https://cdn.jsdelivr.net/gh/xugaoyi/image_store@master/blog/æ«ç _æç´¢èåä¼ æ­æ ·å¼-æ åè²ç.1wp8gd1mhjhc.jpg"  style="width:100%;" />\n    <p>\n    æè¶£ç ç©¶ç¤¾ï¼è¿éæ<a href="https://game.xugaoyi.com" arget="_blank" > FCå¨çº¿æ¨¡æå¨(å°é¸ç) <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼è¿ææ´å¤å¥½ç©çç­çä½ å»æ¢ç´¢~\n    </br></br>\n    å³æ³¨å¬ä¼å·ï¼åå¤[<b>åç«¯èµæº</b>]ï¼å¯è·å <a href="https://game.xugaoyi.com" arget="_blank" >åç«¯å­¦ä¹ èµæº<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>\n    </p>\n    </div>'}},locales:{"/":{lang:"zh-CN",title:"Evan's blog",description:"webåç«¯ææ¯åå®¢,ä¸æ³¨webåç«¯å­¦ä¹ ä¸æ»ç»ãJavaScript,js,ES6,TypeScript,vue,React,python,css3,html5,Node,git,githubç­ææ¯æç« ã",path:"/"}}},ll=(t(155),t(212),t(143),t(222)),cl=t(223),ul=(t(374),t(236),t(43));var dl={computed:{$filterPosts:function(){return this.$site.pages.filter((function(n){var e=n.frontmatter,t=e.pageComponent,r=e.article,o=e.home;return!(t||!1===r||!0===o)}))},$sortPosts:function(){return(n=this.$filterPosts).sort((function(n,e){var t=n.frontmatter.sticky,r=e.frontmatter.sticky;return t&&r?t==r?Object(ul.a)(n,e):t-r:t&&!r?-1:!t&&r?1:Object(ul.a)(n,e)})),n;var n},$sortPostsByDate:function(){return(n=this.$filterPosts).sort((function(n,e){return Object(ul.a)(n,e)})),n;var n},$groupPosts:function(){return function(n){for(var e={},t={},r=function(r,o){var a=n[r].frontmatter,i=a.categories,s=a.tags;"array"===Object(ul.n)(i)&&i.forEach((function(t){t&&(e[t]||(e[t]=[]),e[t].push(n[r]))})),"array"===Object(ul.n)(s)&&s.forEach((function(e){e&&(t[e]||(t[e]=[]),t[e].push(n[r]))}))},o=0,a=n.length;o<a;o++)r(o);return{categories:e,tags:t}}(this.$sortPosts)},$categoriesAndTags:function(){return function(n){var e=[],t=[];for(var r in n.categories)e.push({key:r,length:n.categories[r].length});for(var o in n.tags)t.push({key:o,length:n.tags[o].length});return{categories:e,tags:t}}(this.$groupPosts)}}};Mo.component(ll.default),Mo.component(cl.default);function pl(n){return n.toString().padStart(2,"0")}t(378);Mo.component("Badge",(function(){return Promise.all([t.e(0),t.e(3)]).then(t.bind(null,626))})),Mo.component("CodeBlock",(function(){return Promise.resolve().then(t.bind(null,222))})),Mo.component("CodeGroup",(function(){return Promise.resolve().then(t.bind(null,223))}));t(379);var ml,fl,hl=t(50),gl=(t(382),t(137),t(221)),bl=t.n(gl),yl=t(102);"valine"===(fl="gitalk")?t.e(148).then(t.t.bind(null,480,7)).then((function(n){return n.default})):"gitalk"===fl&&Promise.all([t.e(0),t.e(147)]).then(t.t.bind(null,481,7)).then((function(){return t.e(146).then(t.t.bind(null,482,7))})).then((function(n){return ml=n.default}));function vl(n,e){var t={};return Reflect.ownKeys(n).forEach((function(r){if("string"==typeof n[r])try{t[r]=bl.a.render(n[r],e)}catch(e){console.warn('Comment config option error at key named "'.concat(r,'"')),console.warn("More info: ".concat(e.message)),t[r]=n[r]}else t[r]=n[r]})),t}console.log('How to use "'.concat("gitalk",'" in ').concat(yl.name,"@v").concat(yl.version,":"),yl.homepage);var xl={render:function(n,e){var t=document.createElement("div");t.id=e,document.querySelector("main.page").appendChild(t),new ml(vl({clientID:"a6e1355287947096b88b",clientSecret:"f0e77d070fabfcd5af95bebb82b2d574d7248d71",repo:"blog-gitalk-comment",owner:"xugaoyi",admin:["xugaoyi"],pagerDirection:"last",id:"<%- (frontmatter.permalink || frontmatter.to.path).slice(-16) %>",title:"ãè¯è®ºã<%- frontmatter.title %>",labels:["Gitalk","Comment"],body:"é¡µé¢ï¼<%- window.location.origin + (frontmatter.to.path || window.location.pathname) %>"},{frontmatter:n})).render(e)},clear:function(n){var e=document.querySelector("#".concat(n));return e&&e.remove(),!0}},wl=null;function kl(n){return xl.clear("vuepress-plugin-comment")}function Sl(n){return!1!==n.comment&&!1!==n.comments}function jl(n){if(clearTimeout(wl),document.querySelector("main.page"))return xl.render(n,"vuepress-plugin-comment");wl=setTimeout((function(){return jl(n)}),200)}var El={mounted:function(){var n=this;wl=setTimeout((function(){var e=Object(hl.a)({to:{},from:{}},n.$frontmatter);kl()&&Sl(e)&&jl(e)}),1e3),this.$router.afterEach((function(e,t){if(!e||!t||e.path!==t.path){var r=Object(hl.a)({to:e,from:t},n.$frontmatter);kl()&&Sl(r)&&jl(r)}}))}},Al=Object(ol.a)(El,(function(){var n=this.$createElement;return(this._self._c||n)("div")}),[],!1,null,null,null).exports,Il=[function(n){n.Vue,n.options,n.router,n.siteData},function(n){var e=n.Vue,t=(n.options,n.router,n.siteData);t.pages.map((function(n){var e=n.frontmatter,r=e.date,o=e.author;"string"==typeof r&&"Z"===r.charAt(r.length-1)&&(n.frontmatter.date=function(n){n instanceof Date||(n=new Date(n));return"".concat(n.getUTCFullYear(),"-").concat(pl(n.getUTCMonth()+1),"-").concat(pl(n.getUTCDate())," ").concat(pl(n.getUTCHours()),":").concat(pl(n.getUTCMinutes()),":").concat(pl(n.getUTCSeconds()))}(r)),o?n.author=o:t.themeConfig.author&&(n.author=t.themeConfig.author)})),e.mixin(dl)},{},function(n){n.Vue.mixin({computed:{$dataBlock:function(){return this.$options.__data__block__}}})},{},{},function(n){n.router;"undefined"!=typeof window&&function(){var n=document.createElement("script"),e=window.location.protocol.split(":")[0];n.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(n,t)}()},function(n){var e=n.router;"undefined"!=typeof window&&(window._hmt=window._hmt||[],function(){var n=document.createElement("script");n.src="https://hm.baidu.com/hm.js?503f098e7e5b3a5b5d8c5fc2938af002";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(n,e)}(),e.afterEach((function(n){_hmt.push(["_trackPageview",n.fullPath])})))},function(n){n.Vue.component("Comment",Al)}],Tl=["Comment"];t(215);function zl(n,e){return(zl=Object.setPrototypeOf||function(n,e){return n.__proto__=e,n})(n,e)}t(216);function _l(n){return(_l=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function Cl(n,e){if(e&&("object"===Ai(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n)}function Pl(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}();return function(){var t,r=_l(n);if(e){var o=_l(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return Cl(this,t)}}var Ol=function(n){!function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&zl(n,e)}(t,n);var e=Pl(t);function t(){return cs(this,t),e.apply(this,arguments)}return ds(t)}(function(){function n(){cs(this,n),this.store=new Mo({data:{state:{}}})}return ds(n,[{key:"$get",value:function(n){return this.store.state[n]}},{key:"$set",value:function(n,e){Mo.set(this.store.state,n,e)}},{key:"$emit",value:function(){var n;(n=this.store).$emit.apply(n,arguments)}},{key:"$on",value:function(){var n;(n=this.store).$on.apply(n,arguments)}}]),n}());Object.assign(Ol.prototype,{getPageAsyncComponent:$i,getLayoutAsyncComponent:Gi,getAsyncComponent:Ui,getVueComponent:Hi});var Ml={install:function(n){var e=new Ol;n.$vuepress=e,n.prototype.$vuepress=e}};function Dl(n){n.beforeEach((function(e,t,r){if(Rl(n,e.path))r();else if(/(\/|\.html)$/.test(e.path))if(/\/$/.test(e.path)){var o=e.path.replace(/\/$/,"")+".html";Rl(n,o)?r(o):r()}else r();else{var a=e.path+"/",i=e.path+".html";Rl(n,i)?r(i):Rl(n,a)?r(a):r()}}))}function Rl(n,e){var t=e.toLowerCase();return n.options.routes.some((function(n){return n.path.toLowerCase()===t}))}var Bl={props:{pageKey:String,slotKey:{type:String,default:"default"}},render:function(n){var e=this.pageKey||this.$parent.$page.key;return Wi("pageKey",e),Mo.component(e)||Mo.component(e,$i(e)),Mo.component(e)?n(e):n("")}},Ll={functional:!0,props:{slotKey:String,required:!0},render:function(n,e){var t=e.props,r=e.slots;return n("div",{class:["content__".concat(t.slotKey)]},r()[t.slotKey])}},Nl={computed:{openInNewWindowTitle:function(){return this.$themeLocaleConfig.openNewWindowText||"(opens new window)"}}},Fl=(t(387),t(388),Object(ol.a)(Nl,(function(){var n=this.$createElement,e=this._self._c||n;return e("span",[e("svg",{staticClass:"icon outbound",attrs:{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15"}},[e("path",{attrs:{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}}),this._v(" "),e("polygon",{attrs:{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"}})]),this._v(" "),e("span",{staticClass:"sr-only"},[this._v(this._s(this.openInNewWindowTitle))])])}),[],!1,null,null,null).exports);function ql(){return(ql=Object(r.a)(regeneratorRuntime.mark((function n(e){var t,r,o,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t="undefined"!=typeof window&&window.__VUEPRESS_ROUTER_BASE__?window.__VUEPRESS_ROUTER_BASE__:sl.routerBase||sl.base,Dl(r=new ji({base:t,mode:"history",fallback:!1,routes:il,scrollBehavior:function(n,e,t){return t||(n.hash?!Mo.$vuepress.$get("disableScrollBehavior")&&{selector:decodeURIComponent(n.hash)}:{x:0,y:0})}})),o={},n.prev=4,n.next=7,Promise.all(Il.filter((function(n){return"function"==typeof n})).map((function(n){return n({Vue:Mo,options:o,router:r,siteData:sl,isServer:e})})));case 7:n.next=12;break;case 9:n.prev=9,n.t0=n.catch(4),console.error(n.t0);case 12:return a=new Mo(Object.assign(o,{router:r,render:function(n){return n("div",{attrs:{id:"app"}},[n("RouterView",{ref:"layout"}),n("div",{class:"global-ui"},Tl.map((function(e){return n(e)})))])}})),n.abrupt("return",{app:a,router:r});case 14:case"end":return n.stop()}}),n,null,[[4,9]])})))).apply(this,arguments)}Mo.config.productionTip=!1,Mo.use(ji),Mo.use(Ml),Mo.mixin(function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Mo;Ei(e),t.$vuepress.$set("siteData",e);var r=n(t.$vuepress.$get("siteData")),o=new r,a=Object.getOwnPropertyDescriptors(Object.getPrototypeOf(o)),i={};return Object.keys(a).reduce((function(n,e){return e.startsWith("$")&&(n[e]=a[e].get),n}),i),{computed:i}}((function(n){return function(){function e(){cs(this,e)}return ds(e,[{key:"setPage",value:function(n){this.__page=n}},{key:"$site",get:function(){return n}},{key:"$themeConfig",get:function(){return this.$site.themeConfig}},{key:"$frontmatter",get:function(){return this.$page.frontmatter}},{key:"$localeConfig",get:function(){var n,e,t=this.$site.locales,r=void 0===t?{}:t;for(var o in r)"/"===o?e=r[o]:0===this.$page.path.indexOf(o)&&(n=r[o]);return n||e||{}}},{key:"$siteTitle",get:function(){return this.$localeConfig.title||this.$site.title||""}},{key:"$canonicalUrl",get:function(){var n=this.$page.frontmatter.canonicalUrl;return"string"==typeof n&&n}},{key:"$title",get:function(){var n=this.$page,e=this.$page.frontmatter.metaTitle;if("string"==typeof e)return e;var t=this.$siteTitle,r=n.frontmatter.home?null:n.frontmatter.title||n.title;return t?r?r+" | "+t:t:r||"VuePress"}},{key:"$description",get:function(){var n=function(n){if(n){var e=n.filter((function(n){return"description"===n.name}))[0];if(e)return e.content}}(this.$page.frontmatter.meta);return n||(this.$page.frontmatter.description||this.$localeConfig.description||this.$site.description||"")}},{key:"$lang",get:function(){return this.$page.frontmatter.lang||this.$localeConfig.lang||"en-US"}},{key:"$localePath",get:function(){return this.$localeConfig.path||"/"}},{key:"$themeLocaleConfig",get:function(){return(this.$site.themeConfig.locales||{})[this.$localePath]||{}}},{key:"$page",get:function(){return this.__page?this.__page:function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.path.toLowerCase()===e.toLowerCase())return r}return{path:"",frontmatter:{}}}(this.$site.pages,this.$route.path)}}]),e}()}),sl)),Mo.component("Content",Bl),Mo.component("ContentSlotsDistributor",Ll),Mo.component("OutboundLink",Fl),Mo.component("ClientOnly",{functional:!0,render:function(n,e){var t=e.parent,r=e.children;if(t._isMounted)return r;t.$once("hook:mounted",(function(){t.$forceUpdate()}))}}),Mo.component("Layout",Gi("Layout")),Mo.component("NotFound",Gi("NotFound")),Mo.prototype.$withBase=function(n){var e=this.$site.base;return"/"===n.charAt(0)?e+n.slice(1):n},window.__VUEPRESS__={version:"1.9.5",hash:"d10d15c"},function(n){return ql.apply(this,arguments)}(!1).then((function(n){var e=n.app;n.router.onReady((function(){e.$mount("#app")}))}))}]);