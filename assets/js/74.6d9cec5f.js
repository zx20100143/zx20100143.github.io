(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{554:function(s,a,t){"use strict";t.r(a);var e=t(20),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("ä½¿ç”¨ Docker æ­å»º Redis Clusterï¼Œæœ€é‡è¦çš„ç¯èŠ‚å°±æ˜¯å®¹å™¨é€šä¿¡çš„é—®é¢˜ï¼Œè¿™ä¸€å—æˆ‘ä»¬åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­å·²ç»ç»™å¤§å®¶è§£å†³äº†ã€Š"),t("a",{attrs:{href:"https://xie.infoq.cn/article/97355a6e7ac01bce8532d5ff5",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker ç½‘ç»œæ¨¡å¼è¯¦è§£åŠå®¹å™¨é—´ç½‘ç»œé€šä¿¡"),t("OutboundLink")],1),s._v("ã€‹ï¼Œæœ¬ç¯‡æ–‡ç« ä¸»è¦ç»ƒä¹ ä½¿ç”¨å¤šä¸ªå®¹å™¨å®Œæˆ Redis Cluster é›†ç¾¤ç¯å¢ƒçš„æ­å»ºï¼Œé¡ºä¾¿ä¸ºå­¦ä¹  Docker Compose é“ºé“ºè·¯ã€‚ä¿—è¯è¯´æ²¡æœ‰å¯¹æ¯”å°±æ²¡æœ‰ä¼¤å®³ï¼Œé€šè¿‡å¯¹æ¯”æ‰èƒ½æ„Ÿå—åˆ° Docker Compose çš„å¥½å¤„ ğŸ˜„ã€‚")]),s._v(" "),t("p",[s._v("å…³äº Redis Cluster é›†ç¾¤æ›´å¤šçš„å†…å®¹è¯·é˜…è¯»ã€Š"),t("a",{attrs:{href:"https://xie.infoq.cn/article/fe070dcadf891d3d641132c36",target:"_blank",rel:"noopener noreferrer"}},[s._v("æœ€é€šä¿—æ˜“æ‡‚çš„ Redis æ¶æ„æ¨¡å¼è¯¦è§£"),t("OutboundLink")],1),s._v("ã€‹ã€‚")]),s._v(" "),t("p",[s._v("æŒ‰ç…§ Redis å®˜ç½‘ï¼šhttps://redis.io/topics/cluster-tutorial çš„æç¤ºï¼Œä¸ºäº†ä½¿ Docker ä¸ Redis Cluster å…¼å®¹ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ Docker çš„ "),t("code",[s._v("host")]),s._v(" ç½‘ç»œæ¨¡å¼ã€‚")]),s._v(" "),t("p",[t("code",[s._v("host")]),s._v(" ç½‘ç»œæ¨¡å¼éœ€è¦åœ¨åˆ›å»ºå®¹å™¨æ—¶é€šè¿‡å‚æ•° "),t("code",[s._v("--net host")]),s._v(" æˆ–è€… "),t("code",[s._v("--network host")]),s._v(" æŒ‡å®šï¼Œ"),t("code",[s._v("host")]),s._v(" ç½‘ç»œæ¨¡å¼å¯ä»¥è®©"),t("strong",[s._v("å®¹å™¨å…±äº«å®¿ä¸»æœºç½‘ç»œæ ˆ")]),s._v("ï¼Œå®¹å™¨å°†ä¸ä¼šè™šæ‹Ÿå‡ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®è‡ªå·±çš„ IP ç­‰ï¼Œè€Œæ˜¯ä½¿ç”¨å®¿ä¸»æœºçš„ IP å’Œç«¯å£ã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/85/853745170f0475425dc6b2743c9963c4.png",alt:"img"}})]),s._v(" "),t("h2",{attrs:{id:"ç¯å¢ƒ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¯å¢ƒ"}},[s._v("#")]),s._v(" ç¯å¢ƒ")]),s._v(" "),t("p",[s._v("ä¸ºäº†è®©ç¯å¢ƒæ›´åŠ çœŸå®ï¼Œæœ¬æ–‡ä½¿ç”¨"),t("strong",[s._v("å¤šæœº")]),s._v("ç¯å¢ƒï¼š")]),s._v(" "),t("ul",[t("li",[t("p",[t("code",[s._v("192.168.10.10")])])]),s._v(" "),t("li",[t("p",[t("code",[s._v("192.168.10.11")])])])]),s._v(" "),t("p",[s._v("æ¯å°æœºå™¨æ‰€ä½¿ç”¨çš„åŸºç¡€è®¾æ–½ç¯å¢ƒå¦‚ä¸‹ï¼š")]),s._v(" "),t("ul",[t("li",[t("p",[t("code",[s._v("CentOS 7.8.2003")])])]),s._v(" "),t("li",[t("p",[t("code",[s._v("Docker version 19.03.12")])])])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/03/0309ecfc01393c56c1e87247cc673c77.png",alt:"img"}})]),s._v(" "),t("h2",{attrs:{id:"æ­å»º"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ­å»º"}},[s._v("#")]),s._v(" æ­å»º")]),s._v(" "),t("p",[s._v("æ•´ä½“æ­å»ºæ­¥éª¤ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("ä¸‹è½½ Redis é•œåƒï¼ˆå…¶å®è¿™æ­¥å¯ä»¥çœç•¥ï¼Œå› ä¸ºåˆ›å»ºå®¹å™¨æ—¶ï¼Œå¦‚æœæœ¬åœ°é•œåƒä¸å­˜åœ¨ï¼Œå°±ä¼šå»è¿œç¨‹æ‹‰å–ï¼‰ï¼›")])]),s._v(" "),t("li",[t("p",[s._v("ç¼–å†™ Redis é…ç½®æ–‡ä»¶ï¼›")])]),s._v(" "),t("li",[t("p",[s._v("åˆ›å»º Redis å®¹å™¨ï¼›")])]),s._v(" "),t("li",[t("p",[s._v("åˆ›å»º Redis Cluster é›†ç¾¤ã€‚")])])]),s._v(" "),t("h3",{attrs:{id:"ç¼–å†™-redis-é…ç½®æ–‡ä»¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¼–å†™-redis-é…ç½®æ–‡ä»¶"}},[s._v("#")]),s._v(" ç¼–å†™ Redis é…ç½®æ–‡ä»¶")]),s._v(" "),t("h4",{attrs:{id:"åˆ›å»ºç›®å½•åŠæ–‡ä»¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºç›®å½•åŠæ–‡ä»¶"}},[s._v("#")]),s._v(" åˆ›å»ºç›®å½•åŠæ–‡ä»¶")]),s._v(" "),t("p",[s._v("åˆ†åˆ«åœ¨ "),t("code",[s._v("192.168.10.10")]),s._v(" å’Œ "),t("code",[s._v("192.168.10.11")]),s._v(" ä¸¤å°æœºå™¨ä¸Šæ‰§è¡Œä»¥ä¸‹æ“ä½œã€‚")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ›å»ºç›®å½•")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /usr/local/docker-redis/redis-cluster\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ‡æ¢è‡³æŒ‡å®šç›®å½•")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/docker-redis/redis-cluster/\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ç¼–å†™ redis-cluster.tmpl æ–‡ä»¶")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" redis-cluster.tmpl\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h4",{attrs:{id:"ç¼–å†™é…ç½®æ–‡ä»¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¼–å†™é…ç½®æ–‡ä»¶"}},[s._v("#")]),s._v(" ç¼–å†™é…ç½®æ–‡ä»¶")]),s._v(" "),t("p",[t("code",[s._v("192.168.10.10")]),s._v(" æœºå™¨çš„ "),t("code",[s._v("redis-cluster.tmpl")]),s._v(" æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("port "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PORT}")]),s._v("\nrequirepass "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nmasterauth "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nprotected-mode no\ndaemonize no\nappendonly "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-enabled "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-config-file nodes.conf\ncluster-node-timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15000")]),s._v("\ncluster-announce-ip "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10\ncluster-announce-port "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PORT}")]),s._v("\ncluster-announce-bus-port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PORT}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[t("code",[s._v("192.168.10.11")]),s._v(" æœºå™¨çš„ "),t("code",[s._v("redis-cluster.tmpl")]),s._v(" æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("port "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PORT}")]),s._v("\nrequirepass "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nmasterauth "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nprotected-mode no\ndaemonize no\nappendonly "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-enabled "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-config-file nodes.conf\ncluster-node-timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15000")]),s._v("\ncluster-announce-ip "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10\ncluster-announce-port "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PORT}")]),s._v("\ncluster-announce-bus-port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PORT}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("ul",[t("li",[t("p",[t("code",[s._v("port")]),s._v("ï¼šèŠ‚ç‚¹ç«¯å£ï¼›")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("requirepass")]),s._v("ï¼šæ·»åŠ è®¿é—®è®¤è¯ï¼›")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("masterauth")]),s._v("ï¼šå¦‚æœä¸»èŠ‚ç‚¹å¼€å¯äº†è®¿é—®è®¤è¯ï¼Œä»èŠ‚ç‚¹è®¿é—®ä¸»èŠ‚ç‚¹éœ€è¦è®¤è¯ï¼›")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("protected-mode")]),s._v("ï¼šä¿æŠ¤æ¨¡å¼ï¼Œé»˜è®¤å€¼ yesï¼Œå³å¼€å¯ã€‚å¼€å¯ä¿æŠ¤æ¨¡å¼ä»¥åï¼Œéœ€é…ç½® "),t("code",[s._v("bind ip")]),s._v(" æˆ–è€…è®¾ç½®è®¿é—®å¯†ç ï¼›å…³é—­ä¿æŠ¤æ¨¡å¼ï¼Œå¤–éƒ¨ç½‘ç»œå¯ä»¥ç›´æ¥è®¿é—®ï¼›")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("daemonize")]),s._v("ï¼šæ˜¯å¦ä»¥å®ˆæŠ¤çº¿ç¨‹çš„æ–¹å¼å¯åŠ¨ï¼ˆåå°å¯åŠ¨ï¼‰ï¼Œé»˜è®¤ noï¼›")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("appendonly")]),s._v("ï¼šæ˜¯å¦å¼€å¯ AOF æŒä¹…åŒ–æ¨¡å¼ï¼Œé»˜è®¤ noï¼›")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("cluster-enabled")]),s._v("ï¼šæ˜¯å¦å¼€å¯é›†ç¾¤æ¨¡å¼ï¼Œé»˜è®¤ noï¼›")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("cluster-config-file")]),s._v("ï¼šé›†ç¾¤èŠ‚ç‚¹ä¿¡æ¯æ–‡ä»¶ï¼›")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("cluster-node-timeout")]),s._v("ï¼šé›†ç¾¤èŠ‚ç‚¹è¿æ¥è¶…æ—¶æ—¶é—´ï¼›")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("cluster-announce-ip")]),s._v("ï¼šé›†ç¾¤èŠ‚ç‚¹ IPï¼Œå¡«å†™å®¿ä¸»æœºçš„ IPï¼›")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("cluster-announce-port")]),s._v("ï¼šé›†ç¾¤èŠ‚ç‚¹æ˜ å°„ç«¯å£ï¼›")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("cluster-announce-bus-port")]),s._v("ï¼šé›†ç¾¤èŠ‚ç‚¹æ€»çº¿ç«¯å£ã€‚")])])]),s._v(" "),t("blockquote",[t("p",[s._v("æ¯ä¸ª Redis é›†ç¾¤èŠ‚ç‚¹éƒ½éœ€è¦æ‰“å¼€"),t("strong",[s._v("ä¸¤ä¸ª TCP è¿æ¥")]),s._v("ã€‚ä¸€ä¸ªç”¨äºä¸ºå®¢æˆ·ç«¯æä¾›æœåŠ¡çš„æ­£å¸¸ Redis TCP ç«¯å£ï¼Œä¾‹å¦‚ 6379ã€‚è¿˜æœ‰ä¸€ä¸ªåŸºäº 6379 ç«¯å£åŠ  10000 çš„ç«¯å£ï¼Œæ¯”å¦‚ 16379ã€‚")])]),s._v(" "),t("blockquote",[t("p",[s._v("ç¬¬äºŒä¸ªç«¯å£ç”¨äºé›†ç¾¤æ€»çº¿ï¼Œè¿™æ˜¯ä¸€ä¸ªä½¿ç”¨äºŒè¿›åˆ¶åè®®çš„èŠ‚ç‚¹åˆ°èŠ‚ç‚¹é€šä¿¡é€šé“ã€‚èŠ‚ç‚¹ä½¿ç”¨é›†ç¾¤æ€»çº¿è¿›è¡Œæ•…éšœæ£€æµ‹ã€é…ç½®æ›´æ–°ã€æ•…éšœè½¬ç§»æˆæƒç­‰ç­‰ã€‚å®¢æˆ·ç«¯æ°¸è¿œä¸è¦å°è¯•ä¸é›†ç¾¤æ€»çº¿ç«¯å£é€šä¿¡ï¼Œä¸æ­£å¸¸çš„ Redis å‘½ä»¤ç«¯å£é€šä¿¡å³å¯ï¼Œä½†æ˜¯è¯·ç¡®ä¿é˜²ç«å¢™ä¸­çš„è¿™ä¸¤ä¸ªç«¯å£éƒ½å·²ç»æ‰“å¼€ï¼Œå¦åˆ™ Redis é›†ç¾¤èŠ‚ç‚¹å°†æ— æ³•é€šä¿¡ã€‚")])]),s._v(" "),t("p",[s._v("åœ¨ "),t("code",[s._v("192.168.10.10")]),s._v(" æœºå™¨çš„ "),t("code",[s._v("redis-cluster")]),s._v(" ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("port")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6371")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6373")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("/conf "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PORT")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v(" envsubst "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" redis-cluster.tmpl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("/conf/redis.conf "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("/data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("åœ¨ "),t("code",[s._v("192.168.10.11")]),s._v(" æœºå™¨çš„ "),t("code",[s._v("redis-cluster")]),s._v(" ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("port")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6374")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6376")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("/conf "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PORT")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v(" envsubst "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" redis-cluster.tmpl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("/conf/redis.conf "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("/data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("ä¸Šé¢ä¸¤æ®µ shell for è¯­å¥ï¼Œæ„æ€å°±æ˜¯å¾ªç¯åˆ›å»º 6371 ~ 6376 ç›¸å…³çš„ç›®å½•åŠæ–‡ä»¶ã€‚")]),s._v(" "),t("p",[s._v("åœ¨ "),t("code",[s._v("192.168.10.10")]),s._v(" æœºå™¨æ‰§è¡ŒæŸ¥çœ‹å‘½ä»¤ç»“æœå¦‚ä¸‹ï¼Œå¦‚æœæ²¡æœ‰ "),t("code",[s._v("tree")]),s._v(" å‘½ä»¤å…ˆå®‰è£… "),t("code",[s._v("yum install -y tree")]),s._v("ã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/de/deef87b922ecb7bef310c9935b2d50c9.png",alt:"img"}})]),s._v(" "),t("p",[s._v("åœ¨ "),t("code",[s._v("192.168.10.11")]),s._v(" æœºå™¨æ‰§è¡ŒæŸ¥çœ‹å‘½ä»¤ç»“æœå¦‚ä¸‹ã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/32/3270fddfb150fa9d1c8ff6e46025a822.png",alt:"img"}})]),s._v(" "),t("p",[s._v("ä»¥ä¸‹å†…å®¹ä¸ºæ¯ä¸ªèŠ‚ç‚¹çš„é…ç½®æ–‡ä»¶è¯¦ç»†ä¿¡æ¯ã€‚")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost redis-cluster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /usr/local/docker-redis/redis-cluster/637{1..3}/conf/redis.conf")]),s._v("\nport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6371")]),s._v("\nrequirepass "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nmasterauth "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nprotected-mode no\ndaemonize no\nappendonly "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-enabled "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-config-file nodes.conf\ncluster-node-timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15000")]),s._v("\ncluster-announce-ip "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10\ncluster-announce-port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6371")]),s._v("\ncluster-announce-bus-port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16371")]),s._v("\n\nport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6372")]),s._v("\nrequirepass "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nmasterauth "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nprotected-mode no\ndaemonize no\nappendonly "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-enabled "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-config-file nodes.conf\ncluster-node-timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15000")]),s._v("\ncluster-announce-ip "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10\ncluster-announce-port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6372")]),s._v("\ncluster-announce-bus-port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16372")]),s._v("\n\nport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6373")]),s._v("\nrequirepass "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nmasterauth "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nprotected-mode no\ndaemonize no\nappendonly "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-enabled "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-config-file nodes.conf\ncluster-node-timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15000")]),s._v("\ncluster-announce-ip "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10\ncluster-announce-port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6373")]),s._v("\ncluster-announce-bus-port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16373")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost redis-cluster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /usr/local/docker-redis/redis-cluster/637{4..6}/conf/redis.conf")]),s._v("\nport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6374")]),s._v("\nrequirepass "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nmasterauth "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nprotected-mode no\ndaemonize no\nappendonly "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-enabled "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-config-file nodes.conf\ncluster-node-timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15000")]),s._v("\ncluster-announce-ip "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11\ncluster-announce-port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6374")]),s._v("\ncluster-announce-bus-port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16374")]),s._v("\n\nport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6375")]),s._v("\nrequirepass "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nmasterauth "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nprotected-mode no\ndaemonize no\nappendonly "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-enabled "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-config-file nodes.conf\ncluster-node-timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15000")]),s._v("\ncluster-announce-ip "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11\ncluster-announce-port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6375")]),s._v("\ncluster-announce-bus-port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16375")]),s._v("\n\nport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6376")]),s._v("\nrequirepass "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nmasterauth "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("\nprotected-mode no\ndaemonize no\nappendonly "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-enabled "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\ncluster-config-file nodes.conf\ncluster-node-timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15000")]),s._v("\ncluster-announce-ip "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11\ncluster-announce-port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6376")]),s._v("\ncluster-announce-bus-port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16376")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br")])]),t("h3",{attrs:{id:"åˆ›å»º-redis-å®¹å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»º-redis-å®¹å™¨"}},[s._v("#")]),s._v(" åˆ›å»º Redis å®¹å™¨")]),s._v(" "),t("h4",{attrs:{id:"åˆ›å»ºå®¹å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºå®¹å™¨"}},[s._v("#")]),s._v(" åˆ›å»ºå®¹å™¨")]),s._v(" "),t("p",[s._v("å°†å®¿ä¸»æœºçš„ "),t("code",[s._v("6371 ~ 6376")]),s._v(" ä¹‹é—´çš„ç«¯å£ä¸ 6 ä¸ª Redis å®¹å™¨æ˜ å°„ï¼Œå¹¶å°†å®¿ä¸»æœºçš„ç›®å½•ä¸å®¹å™¨å†…çš„ç›®å½•è¿›è¡Œæ˜ å°„ï¼ˆç›®å½•æŒ‚è½½ï¼‰ã€‚è®°å¾—æŒ‡å®šç½‘ç»œæ¨¡å¼ï¼Œä½¿ç”¨ "),t("code",[s._v("host")]),s._v(" ç½‘ç»œæ¨¡å¼ã€‚")]),s._v(" "),t("p",[s._v("åœ¨ "),t("code",[s._v("192.168.10.10")]),s._v(" æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("port")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6371")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6373")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -di --restart always --name redis-"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v(" --net "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -v /usr/local/docker-redis/redis-cluster/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("/conf/redis.conf:/usr/local/etc/redis/redis.conf "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -v /usr/local/docker-redis/redis-cluster/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("/data:/data "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  redis redis-server /usr/local/etc/redis/redis.conf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("åœ¨ "),t("code",[s._v("192.168.10.11")]),s._v(" æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("port")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6374")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6376")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -di --restart always --name redis-"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v(" --net "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -v /usr/local/docker-redis/redis-cluster/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("/conf/redis.conf:/usr/local/etc/redis/redis.conf "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -v /usr/local/docker-redis/redis-cluster/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("/data:/data "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  redis redis-server /usr/local/etc/redis/redis.conf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("åœ¨ "),t("code",[s._v("192.168.10.10")]),s._v(" æœºå™¨æ‰§è¡Œ "),t("code",[s._v("docker ps -n 3")]),s._v(" æŸ¥çœ‹å®¹å™¨æ˜¯å¦åˆ›å»ºæˆåŠŸã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/76/76da732ac4cb08792c74c0465bc094c4.png",alt:"img"}})]),s._v(" "),t("p",[s._v("åœ¨ "),t("code",[s._v("192.168.10.11")]),s._v(" æœºå™¨æ‰§è¡Œ "),t("code",[s._v("docker ps -n 3")]),s._v(" æŸ¥çœ‹å®¹å™¨æ˜¯å¦åˆ›å»ºæˆåŠŸã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/db/dbb04889b514ffd1f0c542e316fb1899.png",alt:"img"}})]),s._v(" "),t("h3",{attrs:{id:"åˆ›å»º-redis-cluster-é›†ç¾¤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»º-redis-cluster-é›†ç¾¤"}},[s._v("#")]),s._v(" åˆ›å»º Redis Cluster é›†ç¾¤")]),s._v(" "),t("p",[s._v("éšä¾¿è¿›å…¥ä¸€ä¸ªå®¹å™¨èŠ‚ç‚¹ï¼Œå¹¶è¿›å…¥ "),t("code",[s._v("/usr/local/bin/")]),s._v(" ç›®å½•ï¼š")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¿›å…¥å®¹å™¨")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it redis-6371 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ‡æ¢è‡³æŒ‡å®šç›®å½•")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/bin/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®ç° Redis Cluster é›†ç¾¤çš„åˆ›å»ºã€‚")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("redis-cli -a "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v(" --cluster create "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10:6371 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10:6372 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10:6373 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11:6374 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11:6375 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11:6376 --cluster-replicas "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("å‡ºç°é€‰æ‹©æç¤ºä¿¡æ¯ï¼Œè¾“å…¥ "),t("strong",[s._v("yes")]),s._v("ï¼Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/c7/c7cf58473d1ecea9f5b925b9de5a38f6.png",alt:"img"}})]),s._v(" "),t("p",[s._v("é›†ç¾¤åˆ›å»ºæˆåŠŸå¦‚ä¸‹ï¼š")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/dc/dcc8671ab41d1647d62ff288db56581b.png",alt:"img"}})]),s._v(" "),t("p",[s._v("ä»¥ä¸‹å†…å®¹æ˜¯åˆ›å»ºé›†ç¾¤æ—¶è¿”å›çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸¤å¹…å›¾ä¸­çš„æ‰€æœ‰å†…å®¹ã€‚")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@localhost:/usr/local/bin"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis-cli -a 1234 --cluster create 192.168.10.10:6371 192.168.10.10:6372 192.168.10.10:6373 192.168.10.11:6374 192.168.10.11:6375 192.168.10.11:6376 --cluster-replicas 1")]),s._v("\nWarning: Using a password with "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-a'")]),s._v(" or "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-u'")]),s._v(" option on the "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" line interface may not be safe.\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Performing "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("hash")]),s._v(" slots allocation on "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" nodes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nMaster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Slots "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" - "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5460")]),s._v("\nMaster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Slots "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5461")]),s._v(" - "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10922")]),s._v("\nMaster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Slots "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10923")]),s._v(" - "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16383")]),s._v("\nAdding replica "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11:6376 to "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10:6371\nAdding replica "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10:6373 to "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11:6374\nAdding replica "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11:6375 to "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10:6372\nM: 299cf79ddafc83dced27f628f1f82dac483fbc4e "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10:6371\n   slots:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("-5460"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5461")]),s._v(" slots"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" master\nM: ac805b90b6e20e26dc4268454bb2855beea6cc19 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10:6372\n   slots:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10923")]),s._v("-16383"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5461")]),s._v(" slots"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" master\nS: db35494fcc5db0c88d27da7885c817e6cdcc9373 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10:6373\n   replicates 7013270480d37eeab79b9cd0272e934d4548136a\nM: 7013270480d37eeab79b9cd0272e934d4548136a "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11:6374\n   slots:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5461")]),s._v("-10922"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5462")]),s._v(" slots"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" master\nS: 8435e1b0d51f2690c5f94f9a5682a4ac34e94326 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11:6375\n   replicates ac805b90b6e20e26dc4268454bb2855beea6cc19\nS: 7b13c16fa6fe8e13cdc0b4846b87edffed55c62e "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11:6376\n   replicates 299cf79ddafc83dced27f628f1f82dac483fbc4e\nCan I "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" the above configuration? "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yes'")]),s._v(" to accept"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Nodes configuration updated\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Assign a different config epoch to each "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Sending CLUSTER MEET messages to "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" the cluster\nWaiting "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the cluster to "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Performing Cluster Check "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("using "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10:6371"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nM: 299cf79ddafc83dced27f628f1f82dac483fbc4e "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10:6371\n   slots:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("-5460"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5461")]),s._v(" slots"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" master\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" additional replica"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nS: 8435e1b0d51f2690c5f94f9a5682a4ac34e94326 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11:6375\n   slots: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" slots"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" slave\n   replicates ac805b90b6e20e26dc4268454bb2855beea6cc19\nS: db35494fcc5db0c88d27da7885c817e6cdcc9373 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10:6373\n   slots: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" slots"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" slave\n   replicates 7013270480d37eeab79b9cd0272e934d4548136a\nS: 7b13c16fa6fe8e13cdc0b4846b87edffed55c62e "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11:6376\n   slots: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" slots"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" slave\n   replicates 299cf79ddafc83dced27f628f1f82dac483fbc4e\nM: 7013270480d37eeab79b9cd0272e934d4548136a "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11:6374\n   slots:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5461")]),s._v("-10922"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5462")]),s._v(" slots"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" master\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" additional replica"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nM: ac805b90b6e20e26dc4268454bb2855beea6cc19 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10:6372\n   slots:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10923")]),s._v("-16383"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5461")]),s._v(" slots"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" master\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" additional replica"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" All nodes agree about slots configuration.\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Check "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" slots"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Check slots coverage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" All "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16384")]),s._v(" slots covered.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br")])]),t("p",[s._v("è‡³æ­¤ä¸€ä¸ªé«˜å¯ç”¨çš„ Redis Cluster é›†ç¾¤æ­å»ºå®Œæˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¯¥é›†ç¾¤ä¸­åŒ…å« 6 ä¸ª Redis èŠ‚ç‚¹ï¼Œ3 ä¸» 3 ä»ã€‚ä¸‰ä¸ªä¸»èŠ‚ç‚¹ä¼šåˆ†é…æ§½ï¼Œå¤„ç†å®¢æˆ·ç«¯çš„å‘½ä»¤è¯·æ±‚ï¼Œè€Œä»èŠ‚ç‚¹å¯ç”¨åœ¨ä¸»èŠ‚ç‚¹æ•…éšœåï¼Œé¡¶æ›¿ä¸»èŠ‚ç‚¹ã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/27/27ad2d63da3a5939ff37f79c0baa3f49.png",alt:"img"}})]),s._v(" "),t("h2",{attrs:{id:"æŸ¥çœ‹é›†ç¾¤çŠ¶æ€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æŸ¥çœ‹é›†ç¾¤çŠ¶æ€"}},[s._v("#")]),s._v(" æŸ¥çœ‹é›†ç¾¤çŠ¶æ€")]),s._v(" "),t("p",[s._v("æˆ‘ä»¬å…ˆè¿›å…¥å®¹å™¨ï¼Œç„¶åé€šè¿‡ä¸€äº›é›†ç¾¤å¸¸ç”¨çš„å‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹é›†ç¾¤çš„çŠ¶æ€ã€‚")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¿›å…¥å®¹å™¨")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it redis-6371 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ‡æ¢è‡³æŒ‡å®šç›®å½•")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/bin/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"æ£€æŸ¥é›†ç¾¤çŠ¶æ€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ£€æŸ¥é›†ç¾¤çŠ¶æ€"}},[s._v("#")]),s._v(" æ£€æŸ¥é›†ç¾¤çŠ¶æ€")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("redis-cli -a "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v(" --cluster check "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11:6375\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/38/380c3a75203f3be959ca0dc97bdb9af6.png",alt:"img"}})]),s._v(" "),t("h3",{attrs:{id:"æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯å’ŒèŠ‚ç‚¹ä¿¡æ¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯å’ŒèŠ‚ç‚¹ä¿¡æ¯"}},[s._v("#")]),s._v(" æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯å’ŒèŠ‚ç‚¹ä¿¡æ¯")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¿æ¥è‡³é›†ç¾¤æŸä¸ªèŠ‚ç‚¹")]),s._v("\nredis-cli -c -a "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v(" -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.11 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6376")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯")]),s._v("\ncluster info\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æŸ¥çœ‹é›†ç¾¤ç»“ç‚¹ä¿¡æ¯")]),s._v("\ncluster nodes\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/b9/b9446bb132c290dd0914002e945918c7.png",alt:"img"}})]),s._v(" "),t("h3",{attrs:{id:"set-get"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#set-get"}},[s._v("#")]),s._v(" SET/GET")]),s._v(" "),t("p",[s._v("åœ¨ 6371 èŠ‚ç‚¹ä¸­æ‰§è¡Œå†™å…¥å’Œè¯»å–ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¿›å…¥å®¹å™¨å¹¶è¿æ¥è‡³é›†ç¾¤æŸä¸ªèŠ‚ç‚¹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it redis-6371 /usr/local/bin/redis-cli -c -a "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v(" -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6371")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å†™å…¥æ•°æ®")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" name mrhelloworld\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" aaa "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("111")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" bbb "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("222")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¯»å–æ•°æ®")]),s._v("\nget name\nget aaa\nget bbb\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/22/22fcd3fcaf114acdf4088a37f52d4739.png",alt:"img"}})]),s._v(" "),t("p",[s._v("åˆ«ç€æ€¥ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ä¸Šå›¾ä¸­çš„æ“ä½œè¿‡ç¨‹ï¼š")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("é¦–å…ˆè¿›å…¥å®¹å™¨å¹¶è¿æ¥è‡³é›†ç¾¤æŸä¸ªèŠ‚ç‚¹ï¼›")])]),s._v(" "),t("li",[t("p",[s._v("ç„¶åæ‰§è¡Œ"),t("strong",[s._v("ç¬¬ä¸€ä¸ª")]),s._v(" set å‘½ä»¤ "),t("code",[s._v("set name mrhelloworld")]),s._v("ï¼Œ"),t("code",[s._v("name")]),s._v(" é”®æ ¹æ®å“ˆå¸Œå‡½æ•°è¿ç®—ä»¥åå¾—åˆ°çš„å€¼ä¸º "),t("code",[s._v("[5798]")]),s._v("ã€‚å½“å‰é›†ç¾¤ç¯å¢ƒçš„æ§½åˆ†é…æƒ…å†µä¸ºï¼š"),t("code",[s._v("[0-5460] 6371 èŠ‚ç‚¹")]),s._v("ï¼Œ"),t("code",[s._v("[5461-10922] 6374 èŠ‚ç‚¹")]),s._v("ï¼Œ"),t("code",[s._v("[10923-16383] 6372 èŠ‚ç‚¹")]),s._v("ï¼Œæ‰€ä»¥è¯¥é”®çš„å­˜å‚¨å°±è¢«åˆ†é…åˆ°äº† "),t("strong",[s._v("6374")]),s._v(" èŠ‚ç‚¹ä¸Šï¼›")])]),s._v(" "),t("li",[t("p",[s._v("å†æ¥çœ‹"),t("strong",[s._v("ç¬¬äºŒä¸ª")]),s._v(" set å‘½ä»¤ "),t("code",[s._v("set aaa")]),s._v("ï¼Œè¿™é‡Œå¤§å®¶å¯èƒ½ä¼šæœ‰ä¸€äº›ç–‘é—®ï¼Œä¸ºä»€ä¹ˆçœ‹ä¸åˆ° "),t("code",[s._v("aaa")]),s._v(" é”®æ ¹æ®å“ˆå¸Œå‡½æ•°è¿ç®—ä»¥åå¾—åˆ°çš„å€¼ï¼Ÿå› ä¸ºåˆšæ‰é‡å®šå‘è‡³ "),t("strong",[s._v("6374")]),s._v(" èŠ‚ç‚¹æ’å…¥äº†æ•°æ®ï¼Œæ­¤æ—¶å¦‚æœè¿˜æœ‰æ•°æ®æ’å…¥ï¼Œæ­£å¥½é”®æ ¹æ®å“ˆå¸Œå‡½æ•°è¿ç®—ä»¥åå¾—åˆ°çš„å€¼ä¹Ÿè¿˜åœ¨è¯¥èŠ‚ç‚¹çš„èŒƒå›´å†…ï¼Œé‚£ä¹ˆç›´æ¥æ’å…¥æ•°æ®å³å¯ï¼›")])]),s._v(" "),t("li",[t("p",[s._v("æ¥ç€æ˜¯"),t("strong",[s._v("ç¬¬ä¸‰ä¸ª")]),s._v(" set å‘½ä»¤ "),t("code",[s._v("set bbb")]),s._v("ï¼Œ"),t("code",[s._v("bbb")]),s._v(" é”®æ ¹æ®å“ˆå¸Œå‡½æ•°è¿ç®—ä»¥åå¾—åˆ°çš„å€¼ä¸º "),t("code",[s._v("[5287]")]),s._v("ï¼Œæ‰€ä»¥è¯¥é”®çš„å­˜å‚¨å°±è¢«åˆ†é…åˆ°äº† "),t("strong",[s._v("6371")]),s._v(" èŠ‚ç‚¹ä¸Šï¼›")])]),s._v(" "),t("li",[t("p",[s._v("ç„¶åæ˜¯è¯»å–æ“ä½œï¼Œ"),t("strong",[s._v("ç¬¬å››ä¸ª")]),s._v("å‘½ä»¤ "),t("code",[s._v("get name")]),s._v("ï¼Œ"),t("code",[s._v("name")]),s._v(" é”®æ ¹æ®å“ˆå¸Œå‡½æ•°è¿ç®—ä»¥åå¾—åˆ°çš„å€¼ä¸º "),t("code",[s._v("[5798]")]),s._v("ï¼Œè¢«é‡å®šå‘è‡³ "),t("strong",[s._v("6374")]),s._v(" èŠ‚ç‚¹è¯»å–ï¼›")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("ç¬¬äº”ä¸ª")]),s._v("å‘½ä»¤ "),t("code",[s._v("get aaa")]),s._v("ï¼Œ"),t("code",[s._v("aaa")]),s._v(" é”®æ ¹æ®å“ˆå¸Œå‡½æ•°è¿ç®—ä»¥åå¾—åˆ°çš„å€¼ä¹Ÿåœ¨ "),t("strong",[s._v("6374")]),s._v(" èŠ‚ç‚¹ï¼Œç›´æ¥è¯»å–ï¼›")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("ç¬¬å…­ä¸ª")]),s._v("å‘½ä»¤ "),t("code",[s._v("get bbb")]),s._v("ï¼Œ"),t("code",[s._v("bbb")]),s._v(" é”®æ ¹æ®å“ˆå¸Œå‡½æ•°è¿ç®—ä»¥åå¾—åˆ°çš„å€¼ä¸º "),t("code",[s._v("[5287]")]),s._v("ï¼Œè¢«é‡å®šå‘è‡³ "),t("strong",[s._v("6371")]),s._v(" èŠ‚ç‚¹è¯»å–ã€‚")])])]),s._v(" "),t("p",[s._v("é€šè¿‡ä»¥ä¸Šæ“ä½œæˆ‘ä»¬å¾—çŸ¥ "),t("code",[s._v("name")]),s._v(" é”®çš„å­˜å‚¨è¢«åˆ†é…åˆ°äº† 6374 èŠ‚ç‚¹ï¼Œå¦‚æœç›´æ¥è¿æ¥ 6374 èŠ‚ç‚¹å¹¶è·å–è¯¥å€¼ä¼šæ€ä¹ˆæ ·ï¼Ÿæ²¡é”™ï¼Œä¸éœ€è¦é‡å®šå‘èŠ‚ç‚¹ï¼Œå› ä¸ºæ•°æ®å°±åœ¨è¯¥èŠ‚ç‚¹ï¼Œæ‰€ä»¥ç›´æ¥è¯»å–è¿”å›ã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/2e/2e60fc44016d5c31017c54bb8449b711.png",alt:"img"}})]),s._v(" "),t("h2",{attrs:{id:"å®¢æˆ·ç«¯è¿æ¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å®¢æˆ·ç«¯è¿æ¥"}},[s._v("#")]),s._v(" å®¢æˆ·ç«¯è¿æ¥")]),s._v(" "),t("p",[s._v("æœ€åæ¥ä¸€æ³¢å®¢æˆ·ç«¯è¿æ¥æ“ä½œï¼Œéšä¾¿å“ªä¸ªèŠ‚ç‚¹ï¼Œçœ‹çœ‹å¯å¦é€šè¿‡å¤–éƒ¨è®¿é—® Redis Cluster é›†ç¾¤ã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/c4/c428ca8697221393de63bd3beb228b14.png",alt:"img"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/8e/8e61f525269508e86a873c5bedc45f07.png",alt:"img"}})]),s._v(" "),t("p",[s._v("è‡³æ­¤ä½¿ç”¨å¤šæœºç¯å¢ƒå¤šä¸ªå®¹å™¨æ­å»º Redis Cluster é›†ç¾¤ç¯å¢ƒå°±åˆ°è¿™é‡Œï¼Œå…¶å®æ•´ä½“æ­å»ºè¿‡ç¨‹ä¸ç®—ç‰¹åˆ«éº»çƒ¦ï¼Œå› ä¸ºï¼š")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("åˆ›å»º Redis é›†ç¾¤éœ€è¦ç”¨åˆ° Rubyï¼Œå¦åˆ™å°±å¾—è‡ªå·±å…³è”èŠ‚ç‚¹æ„å»ºé›†ç¾¤ï¼Œè‡ªå·±åˆ†é…æ§½ï¼›")])]),s._v(" "),t("li",[t("p",[s._v("å¦‚æœä½¿ç”¨ Ruby æ„å»º Redis é›†ç¾¤ï¼Œå°±éœ€è¦å®‰è£… Ruby ç¯å¢ƒï¼›")])]),s._v(" "),t("li",[t("p",[s._v("è€Œ Redis ä» 5 ç‰ˆæœ¬å¼€å§‹å¯ä»¥ç›´æ¥ä½¿ç”¨ "),t("code",[s._v("redis-cli")]),s._v(" å‘½ä»¤åˆ›å»ºé›†ç¾¤äº†ï¼Œå°±çœå»äº†å¾ˆå¤šéº»çƒ¦äº‹ï¼›")])]),s._v(" "),t("li",[t("p",[s._v("æˆ‘ä»¬è¿˜ä½¿ç”¨äº† shell for å¾ªç¯è¯­å¥ç®€åŒ–äº†æ„å»ºè¿‡ç¨‹ï¼Œå¦åˆ™é‚£äº›è¯­å¥ä¸€æ¡æ¡æ‰§è¡Œä¹Ÿå¤Ÿä½ é—¹å¿ƒçš„ã€‚")])])]),s._v(" "),t("p",[s._v("ç»¼ä¸Šæ‰€è¿°ï¼Œæœ‰æ²¡æœ‰æ›´ç®€å•çš„åŠæ³•å‘¢ï¼Ÿå½“ç„¶æœ‰äº†ï¼Œä¸ç„¶æˆ‘åœ¨è¿™è·Ÿä½ å–ä»€ä¹ˆå…³å­ã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://static001.geekbang.org/infoq/0a/0a75c5102479dbd2d534fdcdbba0f41d.jpeg?x-oss-process=image/resize,p_80/auto-orient,1",alt:"img"}})]),s._v(" "),t("p",[s._v("Docker Compose å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åé¢æˆ‘ä»¬å…ˆå­¦ä¹ ä¸€ä¸‹ä»€ä¹ˆæ˜¯ Docker Composeï¼Œç„¶åä½¿ç”¨ Docker Compose å†æ¥æ­å»ºä¸€é Redis Cluster é›†ç¾¤ç¯å¢ƒï¼Œæ„Ÿå—æ„Ÿå—è¿™å‰åçš„åŒºåˆ«ã€‚")]),s._v(" "),t("p",[s._v("[]: https://xie.infoq.cn/article/a5536b928edd12beb32fcabf9")])])}),[],!1,null,null,null);a.default=n.exports}}]);